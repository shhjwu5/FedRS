  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2133, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.521, 'compress@10': 0.1474, 'time@10': 9.1532}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2133, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.521, 'compress@10': 0.1474, 'time@10': 9.1532}:  10%|█         | 1/10 [00:04<00:41,  4.62s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1523, 'hit_ratio@10': 0.5229, 'ndcg@10': 0.5867, 'compress@10': 0.1382, 'time@10': 8.0508}:  10%|█         | 1/10 [00:11<00:41,  4.62s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1523, 'hit_ratio@10': 0.5229, 'ndcg@10': 0.5867, 'compress@10': 0.1382, 'time@10': 8.0508}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8672, 'hit_ratio@10': 0.3962, 'ndcg@10': 0.3911, 'compress@10': 0.1683, 'time@10': 6.3624}:  20%|██        | 2/10 [00:13<00:48,  6.01s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8672, 'hit_ratio@10': 0.3962, 'ndcg@10': 0.3911, 'compress@10': 0.1683, 'time@10': 6.3624}:  30%|███       | 3/10 [00:13<00:27,  3.97s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6839, 'hit_ratio@10': 0.4757, 'ndcg@10': 0.4349, 'compress@10': 0.1593, 'time@10': 6.3273}:  30%|███       | 3/10 [00:19<00:27,  3.97s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6839, 'hit_ratio@10': 0.4757, 'ndcg@10': 0.4349, 'compress@10': 0.1593, 'time@10': 6.3273}:  40%|████      | 4/10 [00:19<00:29,  4.87s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5662, 'hit_ratio@10': 0.5446, 'ndcg@10': 0.496, 'compress@10': 0.151, 'time@10': 9.6069}:  40%|████      | 4/10 [00:30<00:29,  4.87s/it]  {'epoch': 0, 'num_users': 5.8, 'loss': 0.5662, 'hit_ratio@10': 0.5446, 'ndcg@10': 0.496, 'compress@10': 0.151, 'time@10': 9.6069}:  50%|█████     | 5/10 [00:30<00:36,  7.23s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4864, 'hit_ratio@10': 0.5723, 'ndcg@10': 0.5412, 'compress@10': 0.1459, 'time@10': 9.7054}:  50%|█████     | 5/10 [00:41<00:36,  7.23s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4864, 'hit_ratio@10': 0.5723, 'ndcg@10': 0.5412, 'compress@10': 0.1459, 'time@10': 9.7054}:  60%|██████    | 6/10 [00:41<00:33,  8.25s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4359, 'hit_ratio@10': 0.5763, 'ndcg@10': 0.541, 'compress@10': 0.1445, 'time@10': 9.8879}:  60%|██████    | 6/10 [00:46<00:33,  8.25s/it] {'epoch': 0, 'num_users': 6.2857, 'loss': 0.4359, 'hit_ratio@10': 0.5763, 'ndcg@10': 0.541, 'compress@10': 0.1445, 'time@10': 9.8879}:  70%|███████   | 7/10 [00:46<00:22,  7.36s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3881, 'hit_ratio@10': 0.6185, 'ndcg@10': 0.5699, 'compress@10': 0.1421, 'time@10': 9.6289}:  70%|███████   | 7/10 [00:54<00:22,  7.36s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3881, 'hit_ratio@10': 0.6185, 'ndcg@10': 0.5699, 'compress@10': 0.1421, 'time@10': 9.6289}:  80%|████████  | 8/10 [00:54<00:15,  7.52s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3524, 'hit_ratio@10': 0.6324, 'ndcg@10': 0.6058, 'compress@10': 0.1403, 'time@10': 10.2983}:  80%|████████  | 8/10 [01:02<00:15,  7.52s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3524, 'hit_ratio@10': 0.6324, 'ndcg@10': 0.6058, 'compress@10': 0.1403, 'time@10': 10.2983}:  90%|█████████ | 9/10 [01:02<00:07,  7.63s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3227, 'hit_ratio@10': 0.6623, 'ndcg@10': 0.6287, 'compress@10': 0.1383, 'time@10': 10.2574}:  90%|█████████ | 9/10 [01:12<00:07,  7.63s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.3227, 'hit_ratio@10': 0.6623, 'ndcg@10': 0.6287, 'compress@10': 0.1383, 'time@10': 10.2574}: 100%|██████████| 10/10 [01:12<00:00,  8.34s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3227, 'hit_ratio@10': 0.6623, 'ndcg@10': 0.6287, 'compress@10': 0.1383, 'time@10': 10.2574}: 100%|██████████| 10/10 [01:12<00:00,  7.22s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.3226673969042988
Avg hit ratio: 0.6623055414685296
Avg ndcg: 0.6286683752964499
Avg compression ratio: 0.13830989461144683
Avg train time: 10.257368469238282
Std train time: 5.22048707811779
[0.55, 0.05, 0.55, 0.55, 0.55, 0.05, 0.55, 0.05, 0.05, 0.05]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0543, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8361, 'compress@10': 0.5737, 'time@10': 8.68}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0543, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8361, 'compress@10': 0.5737, 'time@10': 8.68}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0538, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8431, 'compress@10': 0.3272, 'time@10': 7.6534}:  10%|█         | 1/10 [00:11<00:39,  4.38s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0538, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8431, 'compress@10': 0.3272, 'time@10': 7.6534}:  20%|██        | 2/10 [00:11<00:45,  5.72s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0466, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.8019, 'compress@10': 0.4229, 'time@10': 6.1209}:  20%|██        | 2/10 [00:12<00:45,  5.72s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0466, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.8019, 'compress@10': 0.4229, 'time@10': 6.1209}:  30%|███       | 3/10 [00:12<00:26,  3.82s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0474, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8122, 'compress@10': 0.4587, 'time@10': 6.2198}:  30%|███       | 3/10 [00:19<00:26,  3.82s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0474, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8122, 'compress@10': 0.4587, 'time@10': 6.2198}:  40%|████      | 4/10 [00:19<00:29,  4.90s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0556, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8069, 'compress@10': 0.4787, 'time@10': 9.3376}:  40%|████      | 4/10 [00:30<00:29,  4.90s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0556, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8069, 'compress@10': 0.4787, 'time@10': 9.3376}:  50%|█████     | 5/10 [00:30<00:35,  7.08s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0591, 'hit_ratio@10': 0.7823, 'ndcg@10': 0.8078, 'compress@10': 0.4108, 'time@10': 9.4484}:  50%|█████     | 5/10 [00:40<00:35,  7.08s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0591, 'hit_ratio@10': 0.7823, 'ndcg@10': 0.8078, 'compress@10': 0.4108, 'time@10': 9.4484}:  60%|██████    | 6/10 [00:40<00:32,  8.09s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0569, 'hit_ratio@10': 0.8077, 'ndcg@10': 0.8173, 'compress@10': 0.4333, 'time@10': 9.7863}:  60%|██████    | 6/10 [00:46<00:32,  8.09s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0569, 'hit_ratio@10': 0.8077, 'ndcg@10': 0.8173, 'compress@10': 0.4333, 'time@10': 9.7863}:  70%|███████   | 7/10 [00:46<00:22,  7.38s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0545, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8245, 'compress@10': 0.3887, 'time@10': 9.4885}:  70%|███████   | 7/10 [00:53<00:22,  7.38s/it]  {'epoch': 1, 'num_users': 6.125, 'loss': 0.0545, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8245, 'compress@10': 0.3887, 'time@10': 9.4885}:  80%|████████  | 8/10 [00:53<00:14,  7.41s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0524, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8344, 'compress@10': 0.3541, 'time@10': 9.9271}:  80%|████████  | 8/10 [01:00<00:14,  7.41s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0524, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8344, 'compress@10': 0.3541, 'time@10': 9.9271}:  90%|█████████ | 9/10 [01:00<00:07,  7.20s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0519, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8355, 'compress@10': 0.3259, 'time@10': 9.9065}:  90%|█████████ | 9/10 [01:10<00:07,  7.20s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0519, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8355, 'compress@10': 0.3259, 'time@10': 9.9065}: 100%|██████████| 10/10 [01:10<00:00,  7.99s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0519, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8355, 'compress@10': 0.3259, 'time@10': 9.9065}: 100%|██████████| 10/10 [01:10<00:00,  7.01s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05185253444845787
Avg hit ratio: 0.8214123676738279
Avg ndcg: 0.8355392413828466
Avg compression ratio: 0.3258710112794617
Avg train time: 9.90654456615448
Std train time: 4.84503265701042
[0.7000000000000001, 0.36666666666666664, 0.3666666666666667, 0.7000000000000001, 0.7000000000000001, 0.36666666666666664, 0.3666666666666667, 0.03333333333333334, 0.03333333333333334, 0.03333333333333334]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8463, 'compress@10': 0.7158, 'time@10': 8.7621}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8463, 'compress@10': 0.7158, 'time@10': 8.7621}:  10%|█         | 1/10 [00:04<00:39,  4.42s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0504, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8545, 'compress@10': 0.5514, 'time@10': 7.8866}:  10%|█         | 1/10 [00:11<00:39,  4.42s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0504, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8545, 'compress@10': 0.5514, 'time@10': 7.8866}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0353, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8532, 'compress@10': 0.52, 'time@10': 6.3774}:  20%|██        | 2/10 [00:13<00:47,  5.97s/it]  {'epoch': 2, 'num_users': 5.0, 'loss': 0.0353, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8532, 'compress@10': 0.52, 'time@10': 6.3774}:  30%|███       | 3/10 [00:13<00:28,  4.03s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.039, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.851, 'compress@10': 0.5677, 'time@10': 6.4247}:  30%|███       | 3/10 [00:19<00:28,  4.03s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.039, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.851, 'compress@10': 0.5677, 'time@10': 6.4247}:  40%|████      | 4/10 [00:19<00:30,  5.04s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0486, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8383, 'compress@10': 0.5953, 'time@10': 9.0203}:  40%|████      | 4/10 [00:29<00:30,  5.04s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0486, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8383, 'compress@10': 0.5953, 'time@10': 9.0203}:  50%|█████     | 5/10 [00:29<00:33,  6.74s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0529, 'hit_ratio@10': 0.7911, 'ndcg@10': 0.8347, 'compress@10': 0.5596, 'time@10': 9.2461}:  50%|█████     | 5/10 [00:39<00:33,  6.74s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0529, 'hit_ratio@10': 0.7911, 'ndcg@10': 0.8347, 'compress@10': 0.5596, 'time@10': 9.2461}:  60%|██████    | 6/10 [00:39<00:31,  7.99s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0513, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8384, 'compress@10': 0.5356, 'time@10': 9.5438}:  60%|██████    | 6/10 [00:45<00:31,  7.99s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0513, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8384, 'compress@10': 0.5356, 'time@10': 9.5438}:  70%|███████   | 7/10 [00:45<00:21,  7.24s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0511, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.844, 'compress@10': 0.4763, 'time@10': 9.3039}:  70%|███████   | 7/10 [00:53<00:21,  7.24s/it]  {'epoch': 2, 'num_users': 6.125, 'loss': 0.0511, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.844, 'compress@10': 0.4763, 'time@10': 9.3039}:  80%|████████  | 8/10 [00:53<00:14,  7.38s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8514, 'compress@10': 0.4302, 'time@10': 9.6928}:  80%|████████  | 8/10 [00:59<00:14,  7.38s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8514, 'compress@10': 0.4302, 'time@10': 9.6928}:  90%|█████████ | 9/10 [00:59<00:07,  7.08s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.833, 'ndcg@10': 0.8516, 'compress@10': 0.3927, 'time@10': 9.689}:  90%|█████████ | 9/10 [01:09<00:07,  7.08s/it]     {'epoch': 2, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.833, 'ndcg@10': 0.8516, 'compress@10': 0.3927, 'time@10': 9.689}: 100%|██████████| 10/10 [01:09<00:00,  7.89s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.833, 'ndcg@10': 0.8516, 'compress@10': 0.3927, 'time@10': 9.689}: 100%|██████████| 10/10 [01:09<00:00,  6.94s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.05010064462405271
Avg hit ratio: 0.8329742268672659
Avg ndcg: 0.8516019389581195
Avg compression ratio: 0.3926705506854379
Avg train time: 9.688998103141785
Std train time: 4.115042662010913
[0.525, 0.5249999999999999, 0.275, 0.775, 0.775, 0.5249999999999999, 0.275, 0.275, 0.025000000000000005, 0.025000000000000005]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8544, 'compress@10': 0.55, 'time@10': 8.6915}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8544, 'compress@10': 0.55, 'time@10': 8.6915}:  10%|█         | 1/10 [00:04<00:39,  4.39s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0494, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.855, 'compress@10': 0.5452, 'time@10': 8.0071}:  10%|█         | 1/10 [00:11<00:39,  4.39s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0494, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.855, 'compress@10': 0.5452, 'time@10': 8.0071}:  20%|██        | 2/10 [00:11<00:49,  6.14s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8557, 'compress@10': 0.4896, 'time@10': 6.5399}:  20%|██        | 2/10 [00:13<00:49,  6.14s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8557, 'compress@10': 0.4896, 'time@10': 6.5399}:  30%|███       | 3/10 [00:13<00:29,  4.17s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8496, 'compress@10': 0.563, 'time@10': 6.5072}:  30%|███       | 3/10 [00:20<00:29,  4.17s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8496, 'compress@10': 0.563, 'time@10': 6.5072}:  40%|████      | 4/10 [00:20<00:30,  5.07s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8374, 'compress@10': 0.6063, 'time@10': 8.6292}:  40%|████      | 4/10 [00:28<00:30,  5.07s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8374, 'compress@10': 0.6063, 'time@10': 8.6292}:  50%|█████     | 5/10 [00:28<00:31,  6.34s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0513, 'hit_ratio@10': 0.778, 'ndcg@10': 0.8352, 'compress@10': 0.5945, 'time@10': 9.0111}:  50%|█████     | 5/10 [00:39<00:31,  6.34s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0513, 'hit_ratio@10': 0.778, 'ndcg@10': 0.8352, 'compress@10': 0.5945, 'time@10': 9.0111}:  60%|██████    | 6/10 [00:39<00:31,  7.91s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.804, 'ndcg@10': 0.8371, 'compress@10': 0.553, 'time@10': 9.2269}:  60%|██████    | 6/10 [00:44<00:31,  7.91s/it] {'epoch': 3, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.804, 'ndcg@10': 0.8371, 'compress@10': 0.553, 'time@10': 9.2269}:  70%|███████   | 7/10 [00:44<00:21,  7.06s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0518, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8401, 'compress@10': 0.5208, 'time@10': 9.0964}:  70%|███████   | 7/10 [00:53<00:21,  7.06s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0518, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8401, 'compress@10': 0.5208, 'time@10': 9.0964}:  80%|████████  | 8/10 [00:53<00:14,  7.43s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8481, 'compress@10': 0.4688, 'time@10': 9.5402}:  80%|████████  | 8/10 [00:59<00:14,  7.43s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8481, 'compress@10': 0.4688, 'time@10': 9.5402}:  90%|█████████ | 9/10 [00:59<00:07,  7.16s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8485, 'compress@10': 0.4267, 'time@10': 9.5318}:  90%|█████████ | 9/10 [01:09<00:07,  7.16s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8485, 'compress@10': 0.4267, 'time@10': 9.5318}: 100%|██████████| 10/10 [01:09<00:00,  7.88s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8485, 'compress@10': 0.4267, 'time@10': 9.5318}: 100%|██████████| 10/10 [01:09<00:00,  6.92s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.04969214389174981
Avg hit ratio: 0.824555709900362
Avg ndcg: 0.8485121092795719
Avg compression ratio: 0.4266715980681943
Avg train time: 9.531779766082764
Std train time: 3.541238860335058
[0.42000000000000004, 0.6199999999999999, 0.22000000000000003, 0.8200000000000001, 0.8200000000000001, 0.6199999999999999, 0.22000000000000003, 0.42000000000000004, 0.020000000000000004, 0.020000000000000004]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8551, 'compress@10': 0.4505, 'time@10': 8.7079}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8551, 'compress@10': 0.4505, 'time@10': 8.7079}:  10%|█         | 1/10 [00:04<00:39,  4.39s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0494, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.863, 'compress@10': 0.5414, 'time@10': 8.0092}:  10%|█         | 1/10 [00:11<00:39,  4.39s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0494, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.863, 'compress@10': 0.5414, 'time@10': 8.0092}:  20%|██        | 2/10 [00:11<00:49,  6.13s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.861, 'compress@10': 0.4714, 'time@10': 6.4724}:  20%|██        | 2/10 [00:13<00:49,  6.13s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.861, 'compress@10': 0.4714, 'time@10': 6.4724}:  30%|███       | 3/10 [00:13<00:28,  4.13s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8541, 'compress@10': 0.5602, 'time@10': 6.4616}:  30%|███       | 3/10 [00:19<00:28,  4.13s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8541, 'compress@10': 0.5602, 'time@10': 6.4616}:  40%|████      | 4/10 [00:19<00:30,  5.06s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0477, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8398, 'compress@10': 0.6128, 'time@10': 7.9732}:  40%|████      | 4/10 [00:27<00:30,  5.06s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0477, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8398, 'compress@10': 0.6128, 'time@10': 7.9732}:  50%|█████     | 5/10 [00:27<00:28,  5.77s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0508, 'hit_ratio@10': 0.7914, 'ndcg@10': 0.8372, 'compress@10': 0.6154, 'time@10': 8.4298}:  50%|█████     | 5/10 [00:37<00:28,  5.77s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0508, 'hit_ratio@10': 0.7914, 'ndcg@10': 0.8372, 'compress@10': 0.6154, 'time@10': 8.4298}:  60%|██████    | 6/10 [00:37<00:29,  7.47s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0505, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.8375, 'compress@10': 0.5634, 'time@10': 8.7377}:  60%|██████    | 6/10 [00:43<00:29,  7.47s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0505, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.8375, 'compress@10': 0.5634, 'time@10': 8.7377}:  70%|███████   | 7/10 [00:43<00:20,  6.77s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0513, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8455, 'compress@10': 0.5476, 'time@10': 8.6661}:  70%|███████   | 7/10 [00:51<00:20,  6.77s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0513, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8455, 'compress@10': 0.5476, 'time@10': 8.6661}:  80%|████████  | 8/10 [00:51<00:14,  7.23s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.854, 'compress@10': 0.492, 'time@10': 9.1837}:  80%|████████  | 8/10 [00:58<00:14,  7.23s/it] {'epoch': 4, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.854, 'compress@10': 0.492, 'time@10': 9.1837}:  90%|█████████ | 9/10 [00:58<00:07,  7.06s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8541, 'compress@10': 0.4471, 'time@10': 9.2009}:  90%|█████████ | 9/10 [01:07<00:07,  7.06s/it] {'epoch': 4, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8541, 'compress@10': 0.4471, 'time@10': 9.2009}: 100%|██████████| 10/10 [01:07<00:00,  7.78s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8541, 'compress@10': 0.4471, 'time@10': 9.2009}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.049704322403708236
Avg hit ratio: 0.8382858686305207
Avg ndcg: 0.8541399697173109
Avg compression ratio: 0.4470731955093144
Avg train time: 9.200887036323547
Std train time: 3.011336626569882
[0.35000000000000003, 0.6833333333333332, 0.18333333333333335, 0.8500000000000001, 0.8500000000000001, 0.6833333333333332, 0.18333333333333335, 0.5166666666666667, 0.01666666666666667, 0.01666666666666667]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.3842, 'time@10': 9.0876}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.3842, 'time@10': 9.0876}:  10%|█         | 1/10 [00:04<00:41,  4.58s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8658, 'compress@10': 0.5389, 'time@10': 8.3552}:  10%|█         | 1/10 [00:12<00:41,  4.58s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8658, 'compress@10': 0.5389, 'time@10': 8.3552}:  20%|██        | 2/10 [00:12<00:51,  6.40s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8629, 'compress@10': 0.4593, 'time@10': 6.9794}:  20%|██        | 2/10 [00:14<00:51,  6.40s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8629, 'compress@10': 0.4593, 'time@10': 6.9794}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8589, 'compress@10': 0.5583, 'time@10': 6.8516}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8589, 'compress@10': 0.5583, 'time@10': 6.8516}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8436, 'compress@10': 0.6172, 'time@10': 8.247}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it] {'epoch': 5, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8436, 'compress@10': 0.6172, 'time@10': 8.247}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0486, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.8414, 'compress@10': 0.6294, 'time@10': 8.6679}:  50%|█████     | 5/10 [00:38<00:29,  5.89s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0486, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.8414, 'compress@10': 0.6294, 'time@10': 8.6679}:  60%|██████    | 6/10 [00:38<00:30,  7.56s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.048, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.8444, 'compress@10': 0.5704, 'time@10': 8.8997}:  60%|██████    | 6/10 [00:43<00:30,  7.56s/it] {'epoch': 5, 'num_users': 6.2857, 'loss': 0.048, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.8444, 'compress@10': 0.5704, 'time@10': 8.8997}:  70%|███████   | 7/10 [00:43<00:20,  6.79s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0479, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.8513, 'compress@10': 0.5654, 'time@10': 8.7787}:  70%|███████   | 7/10 [00:51<00:20,  6.79s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0479, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.8513, 'compress@10': 0.5654, 'time@10': 8.7787}:  80%|████████  | 8/10 [00:51<00:14,  7.16s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0481, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8579, 'compress@10': 0.5075, 'time@10': 9.1941}:  80%|████████  | 8/10 [00:58<00:14,  7.16s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0481, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8579, 'compress@10': 0.5075, 'time@10': 9.1941}:  90%|█████████ | 9/10 [00:58<00:06,  6.89s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0474, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8579, 'compress@10': 0.4607, 'time@10': 9.1531}:  90%|█████████ | 9/10 [01:06<00:06,  6.89s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0474, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8579, 'compress@10': 0.4607, 'time@10': 9.1531}: 100%|██████████| 10/10 [01:06<00:00,  7.49s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0474, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8579, 'compress@10': 0.4607, 'time@10': 9.1531}: 100%|██████████| 10/10 [01:06<00:00,  6.70s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.047420924680314926
Avg hit ratio: 0.8460795194241714
Avg ndcg: 0.8579454867427719
Avg compression ratio: 0.4606732742762449
Avg train time: 9.153116846084595
Std train time: 2.6931864284912317
[0.30000000000000004, 0.7285714285714285, 0.15714285714285717, 0.8714285714285716, 0.8714285714285716, 0.7285714285714285, 0.15714285714285717, 0.4428571428571429, 0.15714285714285714, 0.014285714285714289]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0464, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.862, 'compress@10': 0.3368, 'time@10': 8.5632}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0464, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.862, 'compress@10': 0.3368, 'time@10': 8.5632}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8594, 'compress@10': 0.5371, 'time@10': 7.7822}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8594, 'compress@10': 0.5371, 'time@10': 7.7822}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8586, 'compress@10': 0.4506, 'time@10': 6.6266}:  20%|██        | 2/10 [00:13<00:47,  5.92s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8586, 'compress@10': 0.4506, 'time@10': 6.6266}:  30%|███       | 3/10 [00:13<00:29,  4.22s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8608, 'compress@10': 0.5569, 'time@10': 6.4935}:  30%|███       | 3/10 [00:19<00:29,  4.22s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8608, 'compress@10': 0.5569, 'time@10': 6.4935}:  40%|████      | 4/10 [00:19<00:29,  4.97s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0447, 'hit_ratio@10': 0.7968, 'ndcg@10': 0.8448, 'compress@10': 0.6203, 'time@10': 7.94}:  40%|████      | 4/10 [00:26<00:29,  4.97s/it] {'epoch': 6, 'num_users': 5.8, 'loss': 0.0447, 'hit_ratio@10': 0.7968, 'ndcg@10': 0.8448, 'compress@10': 0.6203, 'time@10': 7.94}:  50%|█████     | 5/10 [00:26<00:28,  5.67s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0468, 'hit_ratio@10': 0.8047, 'ndcg@10': 0.8434, 'compress@10': 0.6394, 'time@10': 8.3477}:  50%|█████     | 5/10 [00:37<00:28,  5.67s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0468, 'hit_ratio@10': 0.8047, 'ndcg@10': 0.8434, 'compress@10': 0.6394, 'time@10': 8.3477}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0456, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8457, 'compress@10': 0.5753, 'time@10': 8.6071}:  60%|██████    | 6/10 [00:42<00:29,  7.29s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0456, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8457, 'compress@10': 0.5753, 'time@10': 8.6071}:  70%|███████   | 7/10 [00:42<00:19,  6.58s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0453, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8515, 'compress@10': 0.5607, 'time@10': 8.5165}:  70%|███████   | 7/10 [00:50<00:19,  6.58s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0453, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8515, 'compress@10': 0.5607, 'time@10': 8.5165}:  80%|████████  | 8/10 [00:50<00:14,  7.00s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.044, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.859, 'compress@10': 0.5186, 'time@10': 9.066}:  80%|████████  | 8/10 [00:56<00:14,  7.00s/it]  {'epoch': 6, 'num_users': 6.3333, 'loss': 0.044, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.859, 'compress@10': 0.5186, 'time@10': 9.066}:  90%|█████████ | 9/10 [00:56<00:06,  6.93s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0433, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8595, 'compress@10': 0.4704, 'time@10': 9.0129}:  90%|█████████ | 9/10 [01:05<00:06,  6.93s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0433, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8595, 'compress@10': 0.4704, 'time@10': 9.0129}: 100%|██████████| 10/10 [01:05<00:00,  7.44s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0433, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8595, 'compress@10': 0.4704, 'time@10': 9.0129}: 100%|██████████| 10/10 [01:05<00:00,  6.54s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04325540608988884
Avg hit ratio: 0.837730313074965
Avg ndcg: 0.8595447008661257
Avg compression ratio: 0.4703868337662877
Avg train time: 9.01292052268982
Std train time: 2.8558317823558803
[0.38750000000000007, 0.7625, 0.1375, 0.8875000000000001, 0.8875000000000001, 0.7625, 0.1375, 0.3875, 0.1375, 0.012500000000000002]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8429, 'compress@10': 0.4197, 'time@10': 8.2929}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8429, 'compress@10': 0.4197, 'time@10': 8.2929}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8532, 'compress@10': 0.5949, 'time@10': 7.6786}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it] {'epoch': 7, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8532, 'compress@10': 0.5949, 'time@10': 7.6786}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8545, 'compress@10': 0.4835, 'time@10': 6.5787}:  20%|██        | 2/10 [00:13<00:47,  5.90s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8545, 'compress@10': 0.4835, 'time@10': 6.5787}:  30%|███       | 3/10 [00:13<00:29,  4.22s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8578, 'compress@10': 0.5855, 'time@10': 6.5101}:  30%|███       | 3/10 [00:19<00:29,  4.22s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8578, 'compress@10': 0.5855, 'time@10': 6.5101}:  40%|████      | 4/10 [00:19<00:30,  5.06s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0434, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8445, 'compress@10': 0.6464, 'time@10': 7.8374}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0434, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8445, 'compress@10': 0.6464, 'time@10': 7.8374}:  50%|█████     | 5/10 [00:26<00:28,  5.62s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.045, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8442, 'compress@10': 0.6666, 'time@10': 8.2227}:  50%|█████     | 5/10 [00:36<00:28,  5.62s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.045, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8442, 'compress@10': 0.6666, 'time@10': 8.2227}:  60%|██████    | 6/10 [00:36<00:28,  7.17s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.044, 'hit_ratio@10': 0.872, 'ndcg@10': 0.849, 'compress@10': 0.5959, 'time@10': 8.533}:  60%|██████    | 6/10 [00:41<00:28,  7.17s/it]   {'epoch': 7, 'num_users': 6.2857, 'loss': 0.044, 'hit_ratio@10': 0.872, 'ndcg@10': 0.849, 'compress@10': 0.5959, 'time@10': 8.533}:  70%|███████   | 7/10 [00:41<00:19,  6.54s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0441, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.8517, 'compress@10': 0.5721, 'time@10': 8.4184}:  70%|███████   | 7/10 [00:49<00:19,  6.54s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0441, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.8517, 'compress@10': 0.5721, 'time@10': 8.4184}:  80%|████████  | 8/10 [00:49<00:13,  6.90s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0429, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8602, 'compress@10': 0.5265, 'time@10': 8.8801}:  80%|████████  | 8/10 [00:55<00:13,  6.90s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0429, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8602, 'compress@10': 0.5265, 'time@10': 8.8801}:  90%|█████████ | 9/10 [00:55<00:06,  6.72s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0422, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.8612, 'compress@10': 0.4774, 'time@10': 8.8511}:  90%|█████████ | 9/10 [01:04<00:06,  6.72s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0422, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.8612, 'compress@10': 0.4774, 'time@10': 8.8511}: 100%|██████████| 10/10 [01:04<00:00,  7.31s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0422, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.8612, 'compress@10': 0.4774, 'time@10': 8.8511}: 100%|██████████| 10/10 [01:04<00:00,  6.45s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.042172248280213945
Avg hit ratio: 0.869298157417003
Avg ndcg: 0.8612368402564247
Avg compression ratio: 0.477373820410413
Avg train time: 8.851133584976196
Std train time: 2.606838455858639
[0.4555555555555556, 0.6777777777777777, 0.12222222222222223, 0.9, 0.9, 0.7888888888888889, 0.12222222222222223, 0.4555555555555556, 0.12222222222222223, 0.011111111111111113]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8786, 'compress@10': 0.4842, 'time@10': 8.3617}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8786, 'compress@10': 0.4842, 'time@10': 8.3617}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0415, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8799, 'compress@10': 0.5862, 'time@10': 7.6807}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it] {'epoch': 8, 'num_users': 7.0, 'loss': 0.0415, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8799, 'compress@10': 0.5862, 'time@10': 7.6807}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8723, 'compress@10': 0.4733, 'time@10': 6.7949}:  20%|██        | 2/10 [00:13<00:47,  5.88s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8723, 'compress@10': 0.4733, 'time@10': 6.7949}:  30%|███       | 3/10 [00:13<00:30,  4.36s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8743, 'compress@10': 0.5809, 'time@10': 6.5995}:  30%|███       | 3/10 [00:19<00:30,  4.36s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8743, 'compress@10': 0.5809, 'time@10': 6.5995}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0411, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8582, 'compress@10': 0.6451, 'time@10': 7.9854}:  40%|████      | 4/10 [00:26<00:30,  5.03s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0411, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8582, 'compress@10': 0.6451, 'time@10': 7.9854}:  50%|█████     | 5/10 [00:26<00:28,  5.67s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0421, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8565, 'compress@10': 0.6699, 'time@10': 8.377}:  50%|█████     | 5/10 [00:37<00:28,  5.67s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0421, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8565, 'compress@10': 0.6699, 'time@10': 8.377}:  60%|██████    | 6/10 [00:37<00:29,  7.27s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0412, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8581, 'compress@10': 0.5966, 'time@10': 8.6544}:  60%|██████    | 6/10 [00:42<00:29,  7.27s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0412, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8581, 'compress@10': 0.5966, 'time@10': 8.6544}:  70%|███████   | 7/10 [00:42<00:19,  6.59s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0415, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8577, 'compress@10': 0.5809, 'time@10': 8.542}:  70%|███████   | 7/10 [00:50<00:19,  6.59s/it]  {'epoch': 8, 'num_users': 6.125, 'loss': 0.0415, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8577, 'compress@10': 0.5809, 'time@10': 8.542}:  80%|████████  | 8/10 [00:50<00:13,  6.97s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0412, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8665, 'compress@10': 0.5328, 'time@10': 9.0164}:  80%|████████  | 8/10 [00:56<00:13,  6.97s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0412, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8665, 'compress@10': 0.5328, 'time@10': 9.0164}:  90%|█████████ | 9/10 [00:56<00:06,  6.81s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0403, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8685, 'compress@10': 0.4828, 'time@10': 8.9663}:  90%|█████████ | 9/10 [01:05<00:06,  6.81s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0403, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8685, 'compress@10': 0.4828, 'time@10': 8.9663}: 100%|██████████| 10/10 [01:05<00:00,  7.35s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0403, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8685, 'compress@10': 0.4828, 'time@10': 8.9663}: 100%|██████████| 10/10 [01:05<00:00,  6.50s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04034319794444793
Avg hit ratio: 0.8629489510677966
Avg ndcg: 0.8684607654048708
Avg compression ratio: 0.48284642243609477
Avg train time: 8.966326117515564
Std train time: 2.635765130280661
[0.51, 0.6099999999999999, 0.11000000000000001, 0.91, 0.91, 0.8099999999999999, 0.11000000000000001, 0.51, 0.11000000000000001, 0.010000000000000002]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8411, 'compress@10': 0.5358, 'time@10': 8.3107}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8411, 'compress@10': 0.5358, 'time@10': 8.3107}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8641, 'compress@10': 0.5792, 'time@10': 7.7292}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8641, 'compress@10': 0.5792, 'time@10': 7.7292}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8618, 'compress@10': 0.4652, 'time@10': 6.7862}:  20%|██        | 2/10 [00:13<00:47,  5.95s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8618, 'compress@10': 0.4652, 'time@10': 6.7862}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8648, 'compress@10': 0.5772, 'time@10': 6.638}:  30%|███       | 3/10 [00:20<00:30,  4.37s/it]  {'epoch': 9, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8648, 'compress@10': 0.5772, 'time@10': 6.638}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.04, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8518, 'compress@10': 0.6441, 'time@10': 8.0477}:  40%|████      | 4/10 [00:26<00:30,  5.10s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.04, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8518, 'compress@10': 0.6441, 'time@10': 8.0477}:  50%|█████     | 5/10 [00:26<00:28,  5.75s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0405, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.853, 'compress@10': 0.6724, 'time@10': 8.4298}:  50%|█████     | 5/10 [00:37<00:28,  5.75s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0405, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.853, 'compress@10': 0.6724, 'time@10': 8.4298}:  60%|██████    | 6/10 [00:37<00:29,  7.33s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0398, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8589, 'compress@10': 0.5972, 'time@10': 8.7816}:  60%|██████    | 6/10 [00:42<00:29,  7.33s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0398, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8589, 'compress@10': 0.5972, 'time@10': 8.7816}:  70%|███████   | 7/10 [00:42<00:20,  6.73s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0399, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8585, 'compress@10': 0.588, 'time@10': 8.6651}:  70%|███████   | 7/10 [00:50<00:20,  6.73s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0399, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8585, 'compress@10': 0.588, 'time@10': 8.6651}:  80%|████████  | 8/10 [00:50<00:14,  7.10s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0399, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8751, 'compress@10': 0.5377, 'time@10': 9.2044}:  80%|████████  | 8/10 [00:57<00:14,  7.10s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0399, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8751, 'compress@10': 0.5377, 'time@10': 9.2044}:  90%|█████████ | 9/10 [00:57<00:07,  7.01s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0393, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8765, 'compress@10': 0.4872, 'time@10': 9.1361}:  90%|█████████ | 9/10 [01:06<00:07,  7.01s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0393, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8765, 'compress@10': 0.4872, 'time@10': 9.1361}: 100%|██████████| 10/10 [01:06<00:00,  7.49s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0393, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8765, 'compress@10': 0.4872, 'time@10': 9.1361}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03932081515459466
Avg hit ratio: 0.8737106426868737
Avg ndcg: 0.8765020667417609
Avg compression ratio: 0.4872251420441991
Avg train time: 9.13606584072113
Std train time: 2.78779850833501
[0.5545454545454546, 0.5545454545454545, 0.1, 0.9181818181818182, 0.9181818181818182, 0.8272727272727273, 0.1, 0.5545454545454546, 0.1, 0.009090909090909092]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8696, 'compress@10': 0.578, 'time@10': 8.3095}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8696, 'compress@10': 0.578, 'time@10': 8.3095}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0376, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8714, 'compress@10': 0.5734, 'time@10': 7.7399}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0376, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8714, 'compress@10': 0.5734, 'time@10': 7.7399}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8667, 'compress@10': 0.4585, 'time@10': 6.9149}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8667, 'compress@10': 0.4585, 'time@10': 6.9149}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8703, 'compress@10': 0.5741, 'time@10': 6.7104}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8703, 'compress@10': 0.5741, 'time@10': 6.7104}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0379, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8571, 'compress@10': 0.6433, 'time@10': 8.1422}:  40%|████      | 4/10 [00:27<00:30,  5.12s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0379, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8571, 'compress@10': 0.6433, 'time@10': 8.1422}:  50%|█████     | 5/10 [00:27<00:28,  5.79s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0382, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8586, 'compress@10': 0.6746, 'time@10': 8.4507}:  50%|█████     | 5/10 [00:37<00:28,  5.79s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0382, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8586, 'compress@10': 0.6746, 'time@10': 8.4507}:  60%|██████    | 6/10 [00:37<00:28,  7.23s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0383, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8603, 'compress@10': 0.5976, 'time@10': 8.748}:  60%|██████    | 6/10 [00:42<00:28,  7.23s/it] {'epoch': 10, 'num_users': 6.2857, 'loss': 0.0383, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8603, 'compress@10': 0.5976, 'time@10': 8.748}:  70%|███████   | 7/10 [00:42<00:19,  6.60s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0374, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8625, 'compress@10': 0.5938, 'time@10': 8.6498}:  70%|███████   | 7/10 [00:50<00:19,  6.60s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0374, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8625, 'compress@10': 0.5938, 'time@10': 8.6498}:  80%|████████  | 8/10 [00:50<00:14,  7.05s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0388, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8884, 'compress@10': 0.5418, 'time@10': 9.1187}:  80%|████████  | 8/10 [00:56<00:14,  7.05s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0388, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8884, 'compress@10': 0.5418, 'time@10': 9.1187}:  90%|█████████ | 9/10 [00:56<00:06,  6.87s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.038, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.888, 'compress@10': 0.4908, 'time@10': 9.058}:  90%|█████████ | 9/10 [01:05<00:06,  6.87s/it]      {'epoch': 10, 'num_users': 6.3, 'loss': 0.038, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.888, 'compress@10': 0.4908, 'time@10': 9.058}: 100%|██████████| 10/10 [01:05<00:00,  7.39s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.038, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.888, 'compress@10': 0.4908, 'time@10': 9.058}: 100%|██████████| 10/10 [01:05<00:00,  6.55s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03803297065163882
Avg hit ratio: 0.8715903419349939
Avg ndcg: 0.8879702179567628
Avg compression ratio: 0.49080818861893005
Avg train time: 9.058006691932679
Std train time: 2.6362635235260825
[0.5916666666666667, 0.5083333333333333, 0.09166666666666667, 0.925, 0.925, 0.8416666666666667, 0.09166666666666667, 0.5083333333333333, 0.175, 0.008333333333333335]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8705, 'compress@10': 0.6132, 'time@10': 8.2357}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8705, 'compress@10': 0.6132, 'time@10': 8.2357}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0378, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8725, 'compress@10': 0.5687, 'time@10': 7.6445}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0378, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8725, 'compress@10': 0.5687, 'time@10': 7.6445}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8674, 'compress@10': 0.4529, 'time@10': 6.8514}:  20%|██        | 2/10 [00:13<00:47,  5.88s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8674, 'compress@10': 0.4529, 'time@10': 6.8514}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8714, 'compress@10': 0.5716, 'time@10': 6.6655}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8714, 'compress@10': 0.5716, 'time@10': 6.6655}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0367, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8585, 'compress@10': 0.6426, 'time@10': 8.067}:  40%|████      | 4/10 [00:26<00:30,  5.10s/it] {'epoch': 11, 'num_users': 5.8, 'loss': 0.0367, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8585, 'compress@10': 0.6426, 'time@10': 8.067}:  50%|█████     | 5/10 [00:26<00:28,  5.74s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0366, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8608, 'compress@10': 0.6764, 'time@10': 8.4215}:  50%|█████     | 5/10 [00:37<00:28,  5.74s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0366, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8608, 'compress@10': 0.6764, 'time@10': 8.4215}:  60%|██████    | 6/10 [00:37<00:29,  7.27s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0356, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8656, 'compress@10': 0.598, 'time@10': 8.7278}:  60%|██████    | 6/10 [00:42<00:29,  7.27s/it]  {'epoch': 11, 'num_users': 6.2857, 'loss': 0.0356, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8656, 'compress@10': 0.598, 'time@10': 8.7278}:  70%|███████   | 7/10 [00:42<00:19,  6.63s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.034, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.8698, 'compress@10': 0.5886, 'time@10': 8.6041}:  70%|███████   | 7/10 [00:50<00:19,  6.63s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.034, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.8698, 'compress@10': 0.5886, 'time@10': 8.6041}:  80%|████████  | 8/10 [00:50<00:13,  6.99s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0361, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8898, 'compress@10': 0.5452, 'time@10': 9.1617}:  80%|████████  | 8/10 [00:57<00:13,  6.99s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0361, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8898, 'compress@10': 0.5452, 'time@10': 9.1617}:  90%|█████████ | 9/10 [00:57<00:06,  6.95s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0351, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.892, 'compress@10': 0.4938, 'time@10': 9.1081}:  90%|█████████ | 9/10 [01:05<00:06,  6.95s/it]    {'epoch': 11, 'num_users': 6.3, 'loss': 0.0351, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.892, 'compress@10': 0.4938, 'time@10': 9.1081}: 100%|██████████| 10/10 [01:05<00:00,  7.48s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0351, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.892, 'compress@10': 0.4938, 'time@10': 9.1081}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03513262442210234
Avg hit ratio: 0.883836928587353
Avg ndcg: 0.8919679565362177
Avg compression ratio: 0.49379545917389045
Avg train time: 9.108112335205078
Std train time: 2.7456338217374374
[0.6230769230769231, 0.5461538461538461, 0.08461538461538462, 0.9307692307692308, 0.9307692307692308, 0.7769230769230769, 0.08461538461538462, 0.46923076923076923, 0.23846153846153845, 0.007692307692307694]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8625, 'compress@10': 0.6429, 'time@10': 8.4315}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8625, 'compress@10': 0.6429, 'time@10': 8.4315}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.037, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8762, 'compress@10': 0.6019, 'time@10': 7.7742}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it] {'epoch': 12, 'num_users': 7.0, 'loss': 0.037, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8762, 'compress@10': 0.6019, 'time@10': 7.7742}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8699, 'compress@10': 0.473, 'time@10': 6.9135}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8699, 'compress@10': 0.473, 'time@10': 6.9135}:  30%|███       | 3/10 [00:14<00:31,  4.44s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8722, 'compress@10': 0.5881, 'time@10': 6.6763}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8722, 'compress@10': 0.5881, 'time@10': 6.6763}:  40%|████      | 4/10 [00:20<00:30,  5.06s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0352, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8595, 'compress@10': 0.6569, 'time@10': 7.9414}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0352, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8595, 'compress@10': 0.6569, 'time@10': 7.9414}:  50%|█████     | 5/10 [00:26<00:27,  5.59s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.035, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8619, 'compress@10': 0.6777, 'time@10': 8.3099}:  50%|█████     | 5/10 [00:36<00:27,  5.59s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.035, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8619, 'compress@10': 0.6777, 'time@10': 8.3099}:  60%|██████    | 6/10 [00:36<00:28,  7.15s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8673, 'compress@10': 0.5982, 'time@10': 8.6564}:  60%|██████    | 6/10 [00:42<00:28,  7.15s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8673, 'compress@10': 0.5982, 'time@10': 8.6564}:  70%|███████   | 7/10 [00:42<00:19,  6.58s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0331, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8723, 'compress@10': 0.584, 'time@10': 8.5479}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it]  {'epoch': 12, 'num_users': 6.125, 'loss': 0.0331, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8723, 'compress@10': 0.584, 'time@10': 8.5479}:  80%|████████  | 8/10 [00:49<00:13,  6.98s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0333, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8772, 'compress@10': 0.548, 'time@10': 9.0619}:  80%|████████  | 8/10 [00:56<00:13,  6.98s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0333, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8772, 'compress@10': 0.548, 'time@10': 9.0619}:  90%|█████████ | 9/10 [00:56<00:06,  6.87s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.8792, 'compress@10': 0.4962, 'time@10': 8.9964}:  90%|█████████ | 9/10 [01:05<00:06,  6.87s/it] {'epoch': 12, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.8792, 'compress@10': 0.4962, 'time@10': 8.9964}: 100%|██████████| 10/10 [01:05<00:00,  7.35s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.8792, 'compress@10': 0.4962, 'time@10': 8.9964}: 100%|██████████| 10/10 [01:05<00:00,  6.51s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.033186458823115814
Avg hit ratio: 0.8811141514588033
Avg ndcg: 0.879218531192382
Avg compression ratio: 0.4962443296349939
Avg train time: 8.996412444114686
Std train time: 2.591841403863692
[0.65, 0.5071428571428571, 0.07857142857142857, 0.9357142857142857, 0.9357142857142857, 0.7928571428571429, 0.07857142857142857, 0.4357142857142857, 0.2928571428571428, 0.007142857142857144]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8291, 'compress@10': 0.6684, 'time@10': 8.5125}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8291, 'compress@10': 0.6684, 'time@10': 8.5125}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.863, 'compress@10': 0.5957, 'time@10': 7.7893}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it] {'epoch': 13, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.863, 'compress@10': 0.5957, 'time@10': 7.7893}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.861, 'compress@10': 0.4672, 'time@10': 6.8977}:  20%|██        | 2/10 [00:13<00:47,  5.95s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.861, 'compress@10': 0.4672, 'time@10': 6.8977}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8673, 'compress@10': 0.5849, 'time@10': 6.677}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]  {'epoch': 13, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8673, 'compress@10': 0.5849, 'time@10': 6.677}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0359, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8569, 'compress@10': 0.6553, 'time@10': 8.1052}:  40%|████      | 4/10 [00:27<00:30,  5.10s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0359, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8569, 'compress@10': 0.6553, 'time@10': 8.1052}:  50%|█████     | 5/10 [00:27<00:28,  5.76s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0371, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8582, 'compress@10': 0.679, 'time@10': 8.4608}:  50%|█████     | 5/10 [00:37<00:28,  5.76s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0371, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8582, 'compress@10': 0.679, 'time@10': 8.4608}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0369, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.862, 'compress@10': 0.5985, 'time@10': 8.7598}:  60%|██████    | 6/10 [00:42<00:29,  7.30s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0369, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.862, 'compress@10': 0.5985, 'time@10': 8.7598}:  70%|███████   | 7/10 [00:42<00:19,  6.65s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0354, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8678, 'compress@10': 0.5802, 'time@10': 8.6536}:  70%|███████   | 7/10 [00:50<00:19,  6.65s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0354, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8678, 'compress@10': 0.5802, 'time@10': 8.6536}:  80%|████████  | 8/10 [00:50<00:14,  7.06s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0337, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8743, 'compress@10': 0.5505, 'time@10': 9.217}:  80%|████████  | 8/10 [00:57<00:14,  7.06s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0337, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8743, 'compress@10': 0.5505, 'time@10': 9.217}:  90%|█████████ | 9/10 [00:57<00:07,  7.01s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0319, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8804, 'compress@10': 0.4984, 'time@10': 9.1532}:  90%|█████████ | 9/10 [01:06<00:07,  7.01s/it]  {'epoch': 13, 'num_users': 6.3, 'loss': 0.0319, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8804, 'compress@10': 0.4984, 'time@10': 9.1532}: 100%|██████████| 10/10 [01:06<00:00,  7.51s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0319, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8804, 'compress@10': 0.4984, 'time@10': 9.1532}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03185111812695395
Avg hit ratio: 0.8811646565093085
Avg ndcg: 0.8804499020237708
Avg compression ratio: 0.4984145297709334
Avg train time: 9.153245043754577
Std train time: 2.8036024824776473
[0.6733333333333333, 0.47333333333333333, 0.07333333333333333, 0.9400000000000001, 0.9400000000000001, 0.8066666666666668, 0.14, 0.4066666666666667, 0.2733333333333333, 0.006666666666666668]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0344, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8684, 'compress@10': 0.6905, 'time@10': 8.5078}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0344, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8684, 'compress@10': 0.6905, 'time@10': 8.5078}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8814, 'compress@10': 0.5904, 'time@10': 7.7962}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it] {'epoch': 14, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8814, 'compress@10': 0.5904, 'time@10': 7.7962}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8733, 'compress@10': 0.4622, 'time@10': 6.9593}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8733, 'compress@10': 0.4622, 'time@10': 6.9593}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8758, 'compress@10': 0.5822, 'time@10': 6.7103}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8758, 'compress@10': 0.5822, 'time@10': 6.7103}:  40%|████      | 4/10 [00:20<00:30,  5.07s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0313, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8646, 'compress@10': 0.654, 'time@10': 8.0049}:  40%|████      | 4/10 [00:26<00:30,  5.07s/it] {'epoch': 14, 'num_users': 5.8, 'loss': 0.0313, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8646, 'compress@10': 0.654, 'time@10': 8.0049}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8724, 'compress@10': 0.6801, 'time@10': 8.3595}:  50%|█████     | 5/10 [00:36<00:28,  5.63s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8724, 'compress@10': 0.6801, 'time@10': 8.3595}:  60%|██████    | 6/10 [00:36<00:28,  7.17s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0319, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8747, 'compress@10': 0.6079, 'time@10': 8.6933}:  60%|██████    | 6/10 [00:42<00:28,  7.17s/it] {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0319, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8747, 'compress@10': 0.6079, 'time@10': 8.6933}:  70%|███████   | 7/10 [00:42<00:19,  6.59s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0306, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.8805, 'compress@10': 0.5849, 'time@10': 8.5895}:  70%|███████   | 7/10 [00:50<00:19,  6.59s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0306, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.8805, 'compress@10': 0.5849, 'time@10': 8.5895}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0297, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.8873, 'compress@10': 0.5526, 'time@10': 9.128}:  80%|████████  | 8/10 [00:56<00:14,  7.01s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0297, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.8873, 'compress@10': 0.5526, 'time@10': 9.128}:  90%|█████████ | 9/10 [00:56<00:06,  6.93s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.8867, 'compress@10': 0.5002, 'time@10': 9.0567}:  90%|█████████ | 9/10 [01:05<00:06,  6.93s/it]  {'epoch': 14, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.8867, 'compress@10': 0.5002, 'time@10': 9.0567}: 100%|██████████| 10/10 [01:05<00:00,  7.40s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.8867, 'compress@10': 0.5002, 'time@10': 9.0567}: 100%|██████████| 10/10 [01:05<00:00,  6.54s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.02977826876254645
Avg hit ratio: 0.8943643223405532
Avg ndcg: 0.8867482176699202
Avg compression ratio: 0.5002217974013327
Avg train time: 9.056687188148498
Std train time: 2.6433085132113177
[0.69375, 0.44375, 0.06875, 0.9437500000000001, 0.9437500000000001, 0.8187500000000001, 0.13125, 0.38125000000000003, 0.25625, 0.06875]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0366, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.876, 'compress@10': 0.7099, 'time@10': 8.3108}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0366, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.876, 'compress@10': 0.7099, 'time@10': 8.3108}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8913, 'compress@10': 0.5858, 'time@10': 7.7534}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8913, 'compress@10': 0.5858, 'time@10': 7.7534}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8799, 'compress@10': 0.4578, 'time@10': 6.9152}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8799, 'compress@10': 0.4578, 'time@10': 6.9152}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8841, 'compress@10': 0.5798, 'time@10': 6.6897}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8841, 'compress@10': 0.5798, 'time@10': 6.6897}:  40%|████      | 4/10 [00:20<00:30,  5.09s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0306, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8736, 'compress@10': 0.6528, 'time@10': 8.0376}:  40%|████      | 4/10 [00:26<00:30,  5.09s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0306, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8736, 'compress@10': 0.6528, 'time@10': 8.0376}:  50%|█████     | 5/10 [00:26<00:28,  5.69s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0294, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8794, 'compress@10': 0.6811, 'time@10': 8.4053}:  50%|█████     | 5/10 [00:37<00:28,  5.69s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0294, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8794, 'compress@10': 0.6811, 'time@10': 8.4053}:  60%|██████    | 6/10 [00:37<00:29,  7.25s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.029, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8831, 'compress@10': 0.6075, 'time@10': 8.7823}:  60%|██████    | 6/10 [00:42<00:29,  7.25s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.029, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8831, 'compress@10': 0.6075, 'time@10': 8.7823}:  70%|███████   | 7/10 [00:42<00:20,  6.70s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0283, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.8863, 'compress@10': 0.5815, 'time@10': 8.6787}:  70%|███████   | 7/10 [00:50<00:20,  6.70s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0283, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.8863, 'compress@10': 0.5815, 'time@10': 8.6787}:  80%|████████  | 8/10 [00:50<00:14,  7.11s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.872, 'ndcg@10': 0.8934, 'compress@10': 0.5477, 'time@10': 9.2591}:  80%|████████  | 8/10 [00:57<00:14,  7.11s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.872, 'ndcg@10': 0.8934, 'compress@10': 0.5477, 'time@10': 9.2591}:  90%|█████████ | 9/10 [00:57<00:07,  7.08s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.8979, 'compress@10': 0.5019, 'time@10': 9.2028}:  90%|█████████ | 9/10 [01:06<00:07,  7.08s/it]  {'epoch': 15, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.8979, 'compress@10': 0.5019, 'time@10': 9.2028}: 100%|██████████| 10/10 [01:06<00:00,  7.59s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.8979, 'compress@10': 0.5019, 'time@10': 9.2028}: 100%|██████████| 10/10 [01:06<00:00,  6.65s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.02679709958625462
Avg hit ratio: 0.8825670873175119
Avg ndcg: 0.8979119639385006
Avg compression ratio: 0.5019086392389782
Avg train time: 9.20279881954193
Std train time: 2.773916114031318
[0.711764705882353, 0.4764705882352941, 0.06470588235294118, 0.9470588235294118, 0.9470588235294118, 0.7705882352941177, 0.12352941176470589, 0.35882352941176476, 0.3, 0.06470588235294118]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8667, 'compress@10': 0.7269, 'time@10': 8.5829}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8667, 'compress@10': 0.7269, 'time@10': 8.5829}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0341, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8879, 'compress@10': 0.6101, 'time@10': 7.7887}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0341, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8879, 'compress@10': 0.6101, 'time@10': 7.7887}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8776, 'compress@10': 0.4729, 'time@10': 6.8124}:  20%|██        | 2/10 [00:13<00:47,  5.92s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8776, 'compress@10': 0.4729, 'time@10': 6.8124}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.884, 'compress@10': 0.5919, 'time@10': 6.6521}:  30%|███       | 3/10 [00:20<00:30,  4.34s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.884, 'compress@10': 0.5919, 'time@10': 6.6521}:  40%|████      | 4/10 [00:20<00:30,  5.08s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0303, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8744, 'compress@10': 0.6631, 'time@10': 7.953}:  40%|████      | 4/10 [00:26<00:30,  5.08s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0303, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8744, 'compress@10': 0.6631, 'time@10': 7.953}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0301, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8799, 'compress@10': 0.6819, 'time@10': 8.3003}:  50%|█████     | 5/10 [00:36<00:28,  5.63s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0301, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8799, 'compress@10': 0.6819, 'time@10': 8.3003}:  60%|██████    | 6/10 [00:36<00:28,  7.14s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0308, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8803, 'compress@10': 0.6071, 'time@10': 8.6298}:  60%|██████    | 6/10 [00:42<00:28,  7.14s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0308, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8803, 'compress@10': 0.6071, 'time@10': 8.6298}:  70%|███████   | 7/10 [00:42<00:19,  6.55s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0298, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8824, 'compress@10': 0.5784, 'time@10': 8.5073}:  70%|███████   | 7/10 [00:49<00:19,  6.55s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0298, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8824, 'compress@10': 0.5784, 'time@10': 8.5073}:  80%|████████  | 8/10 [00:49<00:13,  6.91s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.03, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8986, 'compress@10': 0.5497, 'time@10': 9.0388}:  80%|████████  | 8/10 [00:56<00:13,  6.91s/it] {'epoch': 16, 'num_users': 6.3333, 'loss': 0.03, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8986, 'compress@10': 0.5497, 'time@10': 9.0388}:  90%|█████████ | 9/10 [00:56<00:06,  6.84s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8983, 'compress@10': 0.5033, 'time@10': 9.0048}:  90%|█████████ | 9/10 [01:05<00:06,  6.84s/it] {'epoch': 16, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8983, 'compress@10': 0.5033, 'time@10': 9.0048}: 100%|██████████| 10/10 [01:05<00:00,  7.43s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8983, 'compress@10': 0.5033, 'time@10': 9.0048}: 100%|██████████| 10/10 [01:05<00:00,  6.52s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.030220211869215485
Avg hit ratio: 0.8854242301746547
Avg ndcg: 0.898266163815757
Avg compression ratio: 0.5033038094805474
Avg train time: 9.004838347434998
Std train time: 2.656979903522506
[0.7277777777777779, 0.44999999999999996, 0.061111111111111116, 0.9500000000000001, 0.9500000000000001, 0.7277777777777779, 0.17222222222222222, 0.33888888888888896, 0.2833333333333333, 0.11666666666666667]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.874, 'compress@10': 0.7421, 'time@10': 8.5211}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.874, 'compress@10': 0.7421, 'time@10': 8.5211}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8979, 'compress@10': 0.6049, 'time@10': 7.7274}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8979, 'compress@10': 0.6049, 'time@10': 7.7274}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8843, 'compress@10': 0.4684, 'time@10': 6.8991}:  20%|██        | 2/10 [00:13<00:46,  5.87s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8843, 'compress@10': 0.4684, 'time@10': 6.8991}:  30%|███       | 3/10 [00:13<00:30,  4.40s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8895, 'compress@10': 0.5892, 'time@10': 6.6731}:  30%|███       | 3/10 [00:19<00:30,  4.40s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8895, 'compress@10': 0.5892, 'time@10': 6.6731}:  40%|████      | 4/10 [00:19<00:30,  5.05s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0272, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8794, 'compress@10': 0.6616, 'time@10': 8.0411}:  40%|████      | 4/10 [00:26<00:30,  5.05s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0272, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8794, 'compress@10': 0.6616, 'time@10': 8.0411}:  50%|█████     | 5/10 [00:26<00:28,  5.68s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0285, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8869, 'compress@10': 0.6736, 'time@10': 8.4059}:  50%|█████     | 5/10 [00:37<00:28,  5.68s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0285, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8869, 'compress@10': 0.6736, 'time@10': 8.4059}:  60%|██████    | 6/10 [00:37<00:28,  7.24s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.028, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8875, 'compress@10': 0.6067, 'time@10': 8.7692}:  60%|██████    | 6/10 [00:42<00:28,  7.24s/it] {'epoch': 17, 'num_users': 6.2857, 'loss': 0.028, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8875, 'compress@10': 0.6067, 'time@10': 8.7692}:  70%|███████   | 7/10 [00:42<00:20,  6.67s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0273, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8909, 'compress@10': 0.5756, 'time@10': 8.5945}:  70%|███████   | 7/10 [00:49<00:20,  6.67s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0273, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8909, 'compress@10': 0.5756, 'time@10': 8.5945}:  80%|████████  | 8/10 [00:49<00:13,  6.91s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0286, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9137, 'compress@10': 0.5454, 'time@10': 9.2058}:  80%|████████  | 8/10 [00:57<00:13,  6.91s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0286, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9137, 'compress@10': 0.5454, 'time@10': 9.2058}:  90%|█████████ | 9/10 [00:57<00:06,  6.96s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9162, 'compress@10': 0.5045, 'time@10': 9.2247}:  90%|█████████ | 9/10 [01:06<00:06,  6.96s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9162, 'compress@10': 0.5045, 'time@10': 9.2247}: 100%|██████████| 10/10 [01:06<00:00,  7.72s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9162, 'compress@10': 0.5045, 'time@10': 9.2247}: 100%|██████████| 10/10 [01:06<00:00,  6.65s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02766077371354094
Avg hit ratio: 0.8882813730317975
Avg ndcg: 0.9162215496095257
Avg compression ratio: 0.5045323548561561
Avg train time: 9.224714708328246
Std train time: 2.8565201382237855
[0.7421052631578948, 0.42631578947368415, 0.05789473684210527, 0.9526315789473685, 0.9526315789473685, 0.7421052631578948, 0.1631578947368421, 0.3210526315789474, 0.32105263157894737, 0.11052631578947368]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8827, 'compress@10': 0.7557, 'time@10': 8.2811}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8827, 'compress@10': 0.7557, 'time@10': 8.2811}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9092, 'compress@10': 0.6002, 'time@10': 7.7565}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9092, 'compress@10': 0.6002, 'time@10': 7.7565}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8918, 'compress@10': 0.4643, 'time@10': 6.8901}:  20%|██        | 2/10 [00:14<00:47,  6.00s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8918, 'compress@10': 0.4643, 'time@10': 6.8901}:  30%|███       | 3/10 [00:14<00:31,  4.45s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8952, 'compress@10': 0.5868, 'time@10': 6.7287}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8952, 'compress@10': 0.5868, 'time@10': 6.7287}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8859, 'compress@10': 0.6602, 'time@10': 8.0471}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8859, 'compress@10': 0.6602, 'time@10': 8.0471}:  50%|█████     | 5/10 [00:27<00:28,  5.73s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0244, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.8937, 'compress@10': 0.6748, 'time@10': 8.4269}:  50%|█████     | 5/10 [00:37<00:28,  5.73s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0244, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.8937, 'compress@10': 0.6748, 'time@10': 8.4269}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0243, 'hit_ratio@10': 0.886, 'ndcg@10': 0.8976, 'compress@10': 0.6065, 'time@10': 8.7148}:  60%|██████    | 6/10 [00:42<00:29,  7.30s/it] {'epoch': 18, 'num_users': 6.2857, 'loss': 0.0243, 'hit_ratio@10': 0.886, 'ndcg@10': 0.8976, 'compress@10': 0.6065, 'time@10': 8.7148}:  70%|███████   | 7/10 [00:42<00:19,  6.63s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0233, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9024, 'compress@10': 0.5732, 'time@10': 8.5509}:  70%|███████   | 7/10 [00:50<00:19,  6.63s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0233, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9024, 'compress@10': 0.5732, 'time@10': 8.5509}:  80%|████████  | 8/10 [00:50<00:13,  6.89s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0256, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.923, 'compress@10': 0.5474, 'time@10': 9.2085}:  80%|████████  | 8/10 [00:57<00:13,  6.89s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0256, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.923, 'compress@10': 0.5474, 'time@10': 9.2085}:  90%|█████████ | 9/10 [00:57<00:07,  7.01s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0246, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9258, 'compress@10': 0.5057, 'time@10': 9.2185}:  90%|█████████ | 9/10 [01:06<00:07,  7.01s/it]  {'epoch': 18, 'num_users': 6.3, 'loss': 0.0246, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9258, 'compress@10': 0.5057, 'time@10': 9.2185}: 100%|██████████| 10/10 [01:06<00:00,  7.73s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0246, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9258, 'compress@10': 0.5057, 'time@10': 9.2185}: 100%|██████████| 10/10 [01:06<00:00,  6.67s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.0246247302283263
Avg hit ratio: 0.8893381817201851
Avg ndcg: 0.9258411673726764
Avg compression ratio: 0.5056980785053365
Avg train time: 9.218475770950317
Std train time: 2.838653034458879
[0.7550000000000001, 0.4049999999999999, 0.05500000000000001, 0.9550000000000001, 0.9550000000000001, 0.7050000000000001, 0.20500000000000002, 0.30500000000000005, 0.355, 0.105]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8827, 'compress@10': 0.7679, 'time@10': 8.5077}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8827, 'compress@10': 0.7679, 'time@10': 8.5077}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9049, 'compress@10': 0.596, 'time@10': 7.7774}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it] {'epoch': 19, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9049, 'compress@10': 0.596, 'time@10': 7.7774}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.889, 'compress@10': 0.4607, 'time@10': 6.8944}:  20%|██        | 2/10 [00:13<00:47,  5.93s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.889, 'compress@10': 0.4607, 'time@10': 6.8944}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8925, 'compress@10': 0.5847, 'time@10': 6.6892}:  30%|███       | 3/10 [00:20<00:30,  4.41s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8925, 'compress@10': 0.5847, 'time@10': 6.6892}:  40%|████      | 4/10 [00:20<00:30,  5.08s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8851, 'compress@10': 0.6589, 'time@10': 8.0656}:  40%|████      | 4/10 [00:26<00:30,  5.08s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8851, 'compress@10': 0.6589, 'time@10': 8.0656}:  50%|█████     | 5/10 [00:26<00:28,  5.71s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0242, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8939, 'compress@10': 0.6677, 'time@10': 8.4302}:  50%|█████     | 5/10 [00:37<00:28,  5.71s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0242, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8939, 'compress@10': 0.6677, 'time@10': 8.4302}:  60%|██████    | 6/10 [00:37<00:29,  7.27s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0249, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.8937, 'compress@10': 0.6061, 'time@10': 8.7834}:  60%|██████    | 6/10 [00:42<00:29,  7.27s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0249, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.8937, 'compress@10': 0.6061, 'time@10': 8.7834}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0242, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.8954, 'compress@10': 0.571, 'time@10': 8.6404}:  70%|███████   | 7/10 [00:50<00:20,  6.69s/it]  {'epoch': 19, 'num_users': 6.125, 'loss': 0.0242, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.8954, 'compress@10': 0.571, 'time@10': 8.6404}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0243, 'hit_ratio@10': 0.885, 'ndcg@10': 0.901, 'compress@10': 0.549, 'time@10': 9.2643}:  80%|████████  | 8/10 [00:57<00:14,  7.01s/it] {'epoch': 19, 'num_users': 6.3333, 'loss': 0.0243, 'hit_ratio@10': 0.885, 'ndcg@10': 0.901, 'compress@10': 0.549, 'time@10': 9.2643}:  90%|█████████ | 9/10 [00:57<00:07,  7.06s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0246, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9009, 'compress@10': 0.5067, 'time@10': 9.2945}:  90%|█████████ | 9/10 [01:07<00:07,  7.06s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0246, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9009, 'compress@10': 0.5067, 'time@10': 9.2945}: 100%|██████████| 10/10 [01:07<00:00,  7.84s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0246, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9009, 'compress@10': 0.5067, 'time@10': 9.2945}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.024568787583368546
Avg hit ratio: 0.8941953245773279
Avg ndcg: 0.9009410689299452
Avg compression ratio: 0.5066570966056003
Avg train time: 9.294516444206238
Std train time: 2.8742906555212064
[0.7666666666666668, 0.3857142857142856, 0.05238095238095239, 0.9571428571428572, 0.9571428571428572, 0.6714285714285715, 0.24285714285714288, 0.2904761904761905, 0.33809523809523806, 0.14761904761904762]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8838, 'compress@10': 0.7789, 'time@10': 8.3656}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8838, 'compress@10': 0.7789, 'time@10': 8.3656}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9128, 'compress@10': 0.5922, 'time@10': 7.7287}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9128, 'compress@10': 0.5922, 'time@10': 7.7287}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8943, 'compress@10': 0.4574, 'time@10': 6.9569}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8943, 'compress@10': 0.4574, 'time@10': 6.9569}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9002, 'compress@10': 0.5827, 'time@10': 6.6751}:  30%|███       | 3/10 [00:19<00:31,  4.48s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9002, 'compress@10': 0.5827, 'time@10': 6.6751}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8928, 'compress@10': 0.6578, 'time@10': 7.9636}:  40%|████      | 4/10 [00:26<00:30,  5.02s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8928, 'compress@10': 0.6578, 'time@10': 7.9636}:  50%|█████     | 5/10 [00:26<00:27,  5.59s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0258, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9033, 'compress@10': 0.6613, 'time@10': 8.3482}:  50%|█████     | 5/10 [00:36<00:27,  5.59s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0258, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9033, 'compress@10': 0.6613, 'time@10': 8.3482}:  60%|██████    | 6/10 [00:36<00:28,  7.20s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0246, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9055, 'compress@10': 0.6058, 'time@10': 8.645}:  60%|██████    | 6/10 [00:42<00:28,  7.20s/it] {'epoch': 20, 'num_users': 6.2857, 'loss': 0.0246, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9055, 'compress@10': 0.6058, 'time@10': 8.645}:  70%|███████   | 7/10 [00:42<00:19,  6.56s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9065, 'compress@10': 0.5689, 'time@10': 8.4877}:  70%|███████   | 7/10 [00:49<00:19,  6.56s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9065, 'compress@10': 0.5689, 'time@10': 8.4877}:  80%|████████  | 8/10 [00:49<00:13,  6.84s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.023, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9119, 'compress@10': 0.5454, 'time@10': 9.0753}:  80%|████████  | 8/10 [00:56<00:13,  6.84s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.023, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9119, 'compress@10': 0.5454, 'time@10': 9.0753}:  90%|█████████ | 9/10 [00:56<00:06,  6.86s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9185, 'compress@10': 0.5076, 'time@10': 9.0951}:  90%|█████████ | 9/10 [01:05<00:06,  6.86s/it]  {'epoch': 20, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9185, 'compress@10': 0.5076, 'time@10': 9.0951}: 100%|██████████| 10/10 [01:05<00:00,  7.62s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9185, 'compress@10': 0.5076, 'time@10': 9.0951}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.021237952850897152
Avg hit ratio: 0.9006238960058994
Avg ndcg: 0.9185254744491779
Avg compression ratio: 0.5075519950133576
Avg train time: 9.095059251785278
Std train time: 2.701053785989632
[0.7772727272727274, 0.4136363636363635, 0.05000000000000001, 0.9590909090909091, 0.9590909090909091, 0.6863636363636364, 0.23181818181818184, 0.2772727272727273, 0.3227272727272727, 0.1409090909090909]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8837, 'compress@10': 0.789, 'time@10': 8.4975}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8837, 'compress@10': 0.789, 'time@10': 8.4975}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9182, 'compress@10': 0.6108, 'time@10': 7.7575}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9182, 'compress@10': 0.6108, 'time@10': 7.7575}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8978, 'compress@10': 0.4691, 'time@10': 6.9377}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8978, 'compress@10': 0.4691, 'time@10': 6.9377}:  30%|███       | 3/10 [00:14<00:31,  4.44s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9061, 'compress@10': 0.5919, 'time@10': 6.7054}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9061, 'compress@10': 0.5919, 'time@10': 6.7054}:  40%|████      | 4/10 [00:20<00:30,  5.07s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0206, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8992, 'compress@10': 0.6655, 'time@10': 7.9888}:  40%|████      | 4/10 [00:26<00:30,  5.07s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0206, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8992, 'compress@10': 0.6655, 'time@10': 7.9888}:  50%|█████     | 5/10 [00:26<00:28,  5.62s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0192, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.9071, 'compress@10': 0.6702, 'time@10': 8.3679}:  50%|█████     | 5/10 [00:36<00:28,  5.62s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0192, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.9071, 'compress@10': 0.6702, 'time@10': 8.3679}:  60%|██████    | 6/10 [00:36<00:28,  7.22s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0199, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9082, 'compress@10': 0.6119, 'time@10': 8.6625}:  60%|██████    | 6/10 [00:42<00:28,  7.22s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0199, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9082, 'compress@10': 0.6119, 'time@10': 8.6625}:  70%|███████   | 7/10 [00:42<00:19,  6.58s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9133, 'compress@10': 0.5727, 'time@10': 8.5155}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9133, 'compress@10': 0.5727, 'time@10': 8.5155}:  80%|████████  | 8/10 [00:49<00:13,  6.88s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0198, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.9211, 'compress@10': 0.5471, 'time@10': 9.078}:  80%|████████  | 8/10 [00:56<00:13,  6.88s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0198, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.9211, 'compress@10': 0.5471, 'time@10': 9.078}:  90%|█████████ | 9/10 [00:56<00:06,  6.86s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9209, 'compress@10': 0.5084, 'time@10': 9.0977}:  90%|█████████ | 9/10 [01:05<00:06,  6.86s/it]  {'epoch': 21, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9209, 'compress@10': 0.5084, 'time@10': 9.0977}: 100%|██████████| 10/10 [01:05<00:00,  7.62s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9209, 'compress@10': 0.5084, 'time@10': 9.0977}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.021292208549279518
Avg hit ratio: 0.8784016737836773
Avg ndcg: 0.9209467738032711
Avg compression ratio: 0.508400663825789
Avg train time: 9.097734498977662
Std train time: 2.6590005033893793
[0.7869565217391306, 0.39565217391304336, 0.04782608695652175, 0.9173913043478261, 0.9608695652173913, 0.6565217391304348, 0.26521739130434785, 0.26521739130434785, 0.3521739130434782, 0.1782608695652174]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8887, 'compress@10': 0.7982, 'time@10': 8.3871}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8887, 'compress@10': 0.7982, 'time@10': 8.3871}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9209, 'compress@10': 0.6066, 'time@10': 7.7535}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9209, 'compress@10': 0.6066, 'time@10': 7.7535}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.8996, 'compress@10': 0.4657, 'time@10': 7.0165}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.8996, 'compress@10': 0.4657, 'time@10': 7.0165}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8012, 'ndcg@10': 0.907, 'compress@10': 0.5794, 'time@10': 6.7635}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8012, 'ndcg@10': 0.907, 'compress@10': 0.5794, 'time@10': 6.7635}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0185, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.9018, 'compress@10': 0.6558, 'time@10': 8.0771}:  40%|████      | 4/10 [00:26<00:30,  5.12s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0185, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.9018, 'compress@10': 0.6558, 'time@10': 8.0771}:  50%|█████     | 5/10 [00:26<00:28,  5.69s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9112, 'compress@10': 0.6572, 'time@10': 8.4632}:  50%|█████     | 5/10 [00:37<00:28,  5.69s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9112, 'compress@10': 0.6572, 'time@10': 8.4632}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0186, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9096, 'compress@10': 0.6054, 'time@10': 8.79}:  60%|██████    | 6/10 [00:42<00:29,  7.30s/it]  {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0186, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9096, 'compress@10': 0.6054, 'time@10': 8.79}:  70%|███████   | 7/10 [00:42<00:20,  6.68s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9094, 'compress@10': 0.5655, 'time@10': 8.6611}:  70%|███████   | 7/10 [00:50<00:20,  6.68s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9094, 'compress@10': 0.5655, 'time@10': 8.6611}:  80%|████████  | 8/10 [00:50<00:14,  7.16s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9286, 'compress@10': 0.5439, 'time@10': 9.2114}:  80%|████████  | 8/10 [00:57<00:14,  7.16s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9286, 'compress@10': 0.5439, 'time@10': 9.2114}:  90%|█████████ | 9/10 [00:57<00:07,  7.06s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9328, 'compress@10': 0.5092, 'time@10': 9.2335}:  90%|█████████ | 9/10 [01:07<00:07,  7.06s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9328, 'compress@10': 0.5092, 'time@10': 9.2335}: 100%|██████████| 10/10 [01:07<00:00,  7.80s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9328, 'compress@10': 0.5092, 'time@10': 9.2335}: 100%|██████████| 10/10 [01:07<00:00,  6.73s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.02037907183290345
Avg hit ratio: 0.8745409466971437
Avg ndcg: 0.9328400800318404
Avg compression ratio: 0.5091712455120203
Avg train time: 9.233502507209778
Std train time: 2.66597679236383
[0.7958333333333334, 0.37916666666666654, 0.045833333333333344, 0.9208333333333334, 0.9625, 0.6291666666666667, 0.29583333333333334, 0.2541666666666667, 0.37916666666666665, 0.17083333333333334]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8929, 'compress@10': 0.8066, 'time@10': 8.2022}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8929, 'compress@10': 0.8066, 'time@10': 8.2022}:  10%|█         | 1/10 [00:04<00:37,  4.14s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9187, 'compress@10': 0.6029, 'time@10': 7.6138}:  10%|█         | 1/10 [00:11<00:37,  4.14s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9187, 'compress@10': 0.6029, 'time@10': 7.6138}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8982, 'compress@10': 0.4626, 'time@10': 6.8363}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8982, 'compress@10': 0.4626, 'time@10': 6.8363}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9041, 'compress@10': 0.5779, 'time@10': 6.6297}:  30%|███       | 3/10 [00:19<00:30,  4.41s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9041, 'compress@10': 0.5779, 'time@10': 6.6297}:  40%|████      | 4/10 [00:19<00:30,  5.05s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.021, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.9002, 'compress@10': 0.655, 'time@10': 7.9472}:  40%|████      | 4/10 [00:26<00:30,  5.05s/it]  {'epoch': 23, 'num_users': 5.8, 'loss': 0.021, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.9002, 'compress@10': 0.655, 'time@10': 7.9472}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0234, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9128, 'compress@10': 0.652, 'time@10': 8.3389}:  50%|█████     | 5/10 [00:36<00:28,  5.63s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0234, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9128, 'compress@10': 0.652, 'time@10': 8.3389}:  60%|██████    | 6/10 [00:36<00:28,  7.23s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0219, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9166, 'compress@10': 0.6052, 'time@10': 8.6862}:  60%|██████    | 6/10 [00:42<00:28,  7.23s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0219, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9166, 'compress@10': 0.6052, 'time@10': 8.6862}:  70%|███████   | 7/10 [00:42<00:19,  6.64s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0221, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9128, 'compress@10': 0.564, 'time@10': 8.4977}:  70%|███████   | 7/10 [00:49<00:19,  6.64s/it]  {'epoch': 23, 'num_users': 6.125, 'loss': 0.0221, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9128, 'compress@10': 0.564, 'time@10': 8.4977}:  80%|████████  | 8/10 [00:49<00:13,  6.82s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0229, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9126, 'compress@10': 0.5454, 'time@10': 9.082}:  80%|████████  | 8/10 [00:56<00:13,  6.82s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0229, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9126, 'compress@10': 0.5454, 'time@10': 9.082}:  90%|█████████ | 9/10 [00:56<00:06,  6.85s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0215, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9185, 'compress@10': 0.5098, 'time@10': 9.1093}:  90%|█████████ | 9/10 [01:05<00:06,  6.85s/it]  {'epoch': 23, 'num_users': 6.3, 'loss': 0.0215, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9185, 'compress@10': 0.5098, 'time@10': 9.1093}: 100%|██████████| 10/10 [01:05<00:00,  7.64s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0215, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9185, 'compress@10': 0.5098, 'time@10': 9.1093}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.021522538212701836
Avg hit ratio: 0.8916838038400009
Avg ndcg: 0.9184924193408779
Avg compression ratio: 0.5098255804626075
Avg train time: 9.109326791763305
Std train time: 2.7542240701990965
[0.804, 0.3639999999999999, 0.04400000000000001, 0.924, 0.964, 0.644, 0.28400000000000003, 0.24400000000000005, 0.40399999999999997, 0.164]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8967, 'compress@10': 0.8143, 'time@10': 8.5242}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8967, 'compress@10': 0.8143, 'time@10': 8.5242}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9331, 'compress@10': 0.5994, 'time@10': 7.7981}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it] {'epoch': 24, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9331, 'compress@10': 0.5994, 'time@10': 7.7981}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9078, 'compress@10': 0.4598, 'time@10': 6.9356}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9078, 'compress@10': 0.4598, 'time@10': 6.9356}:  30%|███       | 3/10 [00:14<00:31,  4.44s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9161, 'compress@10': 0.5765, 'time@10': 6.6904}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9161, 'compress@10': 0.5765, 'time@10': 6.6904}:  40%|████      | 4/10 [00:20<00:30,  5.06s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9099, 'compress@10': 0.6542, 'time@10': 7.957}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it]  {'epoch': 24, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9099, 'compress@10': 0.6542, 'time@10': 7.957}:  50%|█████     | 5/10 [00:26<00:27,  5.59s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9191, 'compress@10': 0.6538, 'time@10': 8.3551}:  50%|█████     | 5/10 [00:36<00:27,  5.59s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9191, 'compress@10': 0.6538, 'time@10': 8.3551}:  60%|██████    | 6/10 [00:36<00:28,  7.22s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0187, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9194, 'compress@10': 0.605, 'time@10': 8.728}:  60%|██████    | 6/10 [00:42<00:28,  7.22s/it]  {'epoch': 24, 'num_users': 6.2857, 'loss': 0.0187, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9194, 'compress@10': 0.605, 'time@10': 8.728}:  70%|███████   | 7/10 [00:42<00:19,  6.67s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0171, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9234, 'compress@10': 0.5626, 'time@10': 8.5614}:  70%|███████   | 7/10 [00:49<00:19,  6.67s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0171, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9234, 'compress@10': 0.5626, 'time@10': 8.5614}:  80%|████████  | 8/10 [00:49<00:13,  6.91s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0167, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9284, 'compress@10': 0.5469, 'time@10': 9.1561}:  80%|████████  | 8/10 [00:56<00:13,  6.91s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0167, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9284, 'compress@10': 0.5469, 'time@10': 9.1561}:  90%|█████████ | 9/10 [00:56<00:06,  6.94s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9278, 'compress@10': 0.5105, 'time@10': 9.1648}:  90%|█████████ | 9/10 [01:06<00:06,  6.94s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9278, 'compress@10': 0.5105, 'time@10': 9.1648}: 100%|██████████| 10/10 [01:06<00:00,  7.66s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9278, 'compress@10': 0.5105, 'time@10': 9.1648}: 100%|██████████| 10/10 [01:06<00:00,  6.62s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.018892243570452695
Avg hit ratio: 0.8983511687331722
Avg ndcg: 0.9277882641663371
Avg compression ratio: 0.5104988988627145
Avg train time: 9.164819073677062
Std train time: 2.755812820708004
[0.8115384615384615, 0.38846153846153836, 0.04230769230769232, 0.8884615384615385, 0.9653846153846154, 0.6192307692307693, 0.31153846153846154, 0.23461538461538467, 0.3884615384615384, 0.19615384615384615]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9014, 'compress@10': 0.8214, 'time@10': 8.3869}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9014, 'compress@10': 0.8214, 'time@10': 8.3869}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9311, 'compress@10': 0.6148, 'time@10': 7.7423}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9311, 'compress@10': 0.6148, 'time@10': 7.7423}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9064, 'compress@10': 0.4696, 'time@10': 6.948}:  20%|██        | 2/10 [00:14<00:47,  5.94s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9064, 'compress@10': 0.4696, 'time@10': 6.948}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9174, 'compress@10': 0.5753, 'time@10': 6.758}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9174, 'compress@10': 0.5753, 'time@10': 6.758}:  40%|████      | 4/10 [00:20<00:30,  5.16s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.9118, 'compress@10': 0.6535, 'time@10': 8.0515}:  40%|████      | 4/10 [00:26<00:30,  5.16s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.9118, 'compress@10': 0.6535, 'time@10': 8.0515}:  50%|█████     | 5/10 [00:26<00:28,  5.70s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0141, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9211, 'compress@10': 0.6492, 'time@10': 8.4156}:  50%|█████     | 5/10 [00:37<00:28,  5.70s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0141, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9211, 'compress@10': 0.6492, 'time@10': 8.4156}:  60%|██████    | 6/10 [00:37<00:29,  7.25s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9203, 'compress@10': 0.6049, 'time@10': 8.7685}:  60%|██████    | 6/10 [00:42<00:29,  7.25s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9203, 'compress@10': 0.6049, 'time@10': 8.7685}:  70%|███████   | 7/10 [00:42<00:20,  6.67s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9192, 'compress@10': 0.5613, 'time@10': 8.58}:  70%|███████   | 7/10 [00:50<00:20,  6.67s/it]   {'epoch': 25, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9192, 'compress@10': 0.5613, 'time@10': 8.58}:  80%|████████  | 8/10 [00:50<00:13,  6.87s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9266, 'compress@10': 0.544, 'time@10': 9.1927}:  80%|████████  | 8/10 [00:57<00:13,  6.87s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9266, 'compress@10': 0.544, 'time@10': 9.1927}:  90%|█████████ | 9/10 [00:57<00:06,  6.94s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9314, 'compress@10': 0.5111, 'time@10': 9.1993}:  90%|█████████ | 9/10 [01:06<00:06,  6.94s/it] {'epoch': 25, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9314, 'compress@10': 0.5111, 'time@10': 9.1993}: 100%|██████████| 10/10 [01:06<00:00,  7.67s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9314, 'compress@10': 0.5111, 'time@10': 9.1993}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.015853816520107755
Avg hit ratio: 0.8781354167432266
Avg ndcg: 0.9313562490828623
Avg compression ratio: 0.5110872100040239
Avg train time: 9.199342679977416
Std train time: 2.7702145807144096
[0.8185185185185185, 0.37407407407407395, 0.04074074074074075, 0.8925925925925926, 0.9666666666666667, 0.5962962962962963, 0.337037037037037, 0.22592592592592597, 0.4111111111111111, 0.18888888888888888]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0217, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9031, 'compress@10': 0.8281, 'time@10': 8.2362}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0217, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9031, 'compress@10': 0.8281, 'time@10': 8.2362}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9278, 'compress@10': 0.6112, 'time@10': 7.6525}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9278, 'compress@10': 0.6112, 'time@10': 7.6525}:  20%|██        | 2/10 [00:11<00:47,  5.89s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9042, 'compress@10': 0.4667, 'time@10': 6.8903}:  20%|██        | 2/10 [00:13<00:47,  5.89s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9042, 'compress@10': 0.4667, 'time@10': 6.8903}:  30%|███       | 3/10 [00:13<00:31,  4.44s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9157, 'compress@10': 0.5741, 'time@10': 6.6844}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9157, 'compress@10': 0.5741, 'time@10': 6.6844}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9112, 'compress@10': 0.6528, 'time@10': 7.9998}:  40%|████      | 4/10 [00:26<00:30,  5.10s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9112, 'compress@10': 0.6528, 'time@10': 7.9998}:  50%|█████     | 5/10 [00:26<00:28,  5.66s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0202, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9246, 'compress@10': 0.6448, 'time@10': 8.4166}:  50%|█████     | 5/10 [00:37<00:28,  5.66s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0202, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9246, 'compress@10': 0.6448, 'time@10': 8.4166}:  60%|██████    | 6/10 [00:37<00:29,  7.32s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9276, 'compress@10': 0.6047, 'time@10': 8.8082}:  60%|██████    | 6/10 [00:42<00:29,  7.32s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9276, 'compress@10': 0.6047, 'time@10': 8.8082}:  70%|███████   | 7/10 [00:42<00:20,  6.77s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0191, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9263, 'compress@10': 0.5601, 'time@10': 8.6282}:  70%|███████   | 7/10 [00:50<00:20,  6.77s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0191, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9263, 'compress@10': 0.5601, 'time@10': 8.6282}:  80%|████████  | 8/10 [00:50<00:13,  6.97s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0204, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9304, 'compress@10': 0.5454, 'time@10': 9.2344}:  80%|████████  | 8/10 [00:57<00:13,  6.97s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0204, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9304, 'compress@10': 0.5454, 'time@10': 9.2344}:  90%|█████████ | 9/10 [00:57<00:07,  7.00s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9333, 'compress@10': 0.5116, 'time@10': 9.2379}:  90%|█████████ | 9/10 [01:06<00:07,  7.00s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9333, 'compress@10': 0.5116, 'time@10': 9.2379}: 100%|██████████| 10/10 [01:06<00:00,  7.71s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9333, 'compress@10': 0.5116, 'time@10': 9.2379}: 100%|██████████| 10/10 [01:06<00:00,  6.67s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.020872548596069913
Avg hit ratio: 0.894563988171798
Avg ndcg: 0.9333116741720477
Avg compression ratio: 0.5115975502250669
Avg train time: 9.237944412231446
Std train time: 2.814215898346389
[0.7892857142857143, 0.3607142857142856, 0.0392857142857143, 0.8607142857142858, 0.9678571428571429, 0.6107142857142858, 0.325, 0.2535714285714286, 0.4321428571428571, 0.21785714285714286]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9136, 'compress@10': 0.8004, 'time@10': 8.8244}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9136, 'compress@10': 0.8004, 'time@10': 8.8244}:  10%|█         | 1/10 [00:04<00:40,  4.45s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9382, 'compress@10': 0.5909, 'time@10': 7.8729}:  10%|█         | 1/10 [00:11<00:40,  4.45s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9382, 'compress@10': 0.5909, 'time@10': 7.8729}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9112, 'compress@10': 0.4527, 'time@10': 7.0129}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9112, 'compress@10': 0.4527, 'time@10': 7.0129}:  30%|███       | 3/10 [00:14<00:31,  4.44s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9214, 'compress@10': 0.556, 'time@10': 6.8123}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]  {'epoch': 27, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9214, 'compress@10': 0.556, 'time@10': 6.8123}:  40%|████      | 4/10 [00:20<00:30,  5.16s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0163, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9179, 'compress@10': 0.6385, 'time@10': 8.089}:  40%|████      | 4/10 [00:26<00:30,  5.16s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0163, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9179, 'compress@10': 0.6385, 'time@10': 8.089}:  50%|█████     | 5/10 [00:26<00:28,  5.69s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9269, 'compress@10': 0.6353, 'time@10': 8.4583}:  50%|█████     | 5/10 [00:37<00:28,  5.69s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9269, 'compress@10': 0.6353, 'time@10': 8.4583}:  60%|██████    | 6/10 [00:37<00:29,  7.27s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0157, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9282, 'compress@10': 0.5948, 'time@10': 8.8142}:  60%|██████    | 6/10 [00:42<00:29,  7.27s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0157, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9282, 'compress@10': 0.5948, 'time@10': 8.8142}:  70%|███████   | 7/10 [00:42<00:20,  6.70s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9318, 'compress@10': 0.5548, 'time@10': 8.6525}:  70%|███████   | 7/10 [00:50<00:20,  6.70s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9318, 'compress@10': 0.5548, 'time@10': 8.6525}:  80%|████████  | 8/10 [00:50<00:13,  6.97s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9342, 'compress@10': 0.543, 'time@10': 9.2532}:  80%|████████  | 8/10 [00:57<00:13,  6.97s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9342, 'compress@10': 0.543, 'time@10': 9.2532}:  90%|█████████ | 9/10 [00:57<00:07,  7.00s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9377, 'compress@10': 0.5123, 'time@10': 9.2472}:  90%|█████████ | 9/10 [01:06<00:07,  7.00s/it]  {'epoch': 27, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9377, 'compress@10': 0.5123, 'time@10': 9.2472}: 100%|██████████| 10/10 [01:06<00:00,  7.69s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9377, 'compress@10': 0.5123, 'time@10': 9.2472}: 100%|██████████| 10/10 [01:06<00:00,  6.67s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.01571902491123627
Avg hit ratio: 0.8856238960058993
Avg ndcg: 0.9377339099611733
Avg compression ratio: 0.5122672292000197
Avg train time: 9.24724314212799
Std train time: 2.760285947801783
[0.796551724137931, 0.3482758620689654, 0.037931034482758634, 0.8655172413793104, 0.9689655172413794, 0.5896551724137932, 0.34827586206896555, 0.2448275862068966, 0.4172413793103448, 0.24482758620689654]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9174, 'compress@10': 0.8072, 'time@10': 8.2856}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9174, 'compress@10': 0.8072, 'time@10': 8.2856}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9396, 'compress@10': 0.5883, 'time@10': 7.5913}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9396, 'compress@10': 0.5883, 'time@10': 7.5913}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9121, 'compress@10': 0.4506, 'time@10': 6.8969}:  20%|██        | 2/10 [00:13<00:46,  5.80s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9121, 'compress@10': 0.4506, 'time@10': 6.8969}:  30%|███       | 3/10 [00:13<00:31,  4.43s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9219, 'compress@10': 0.5556, 'time@10': 6.7299}:  30%|███       | 3/10 [00:20<00:31,  4.43s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9219, 'compress@10': 0.5556, 'time@10': 6.7299}:  40%|████      | 4/10 [00:20<00:30,  5.16s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9197, 'compress@10': 0.6384, 'time@10': 7.9735}:  40%|████      | 4/10 [00:26<00:30,  5.16s/it] {'epoch': 28, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9197, 'compress@10': 0.6384, 'time@10': 7.9735}:  50%|█████     | 5/10 [00:26<00:28,  5.64s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.929, 'compress@10': 0.6318, 'time@10': 8.3535}:  50%|█████     | 5/10 [00:36<00:28,  5.64s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.929, 'compress@10': 0.6318, 'time@10': 8.3535}:  60%|██████    | 6/10 [00:36<00:28,  7.22s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9266, 'compress@10': 0.595, 'time@10': 8.7008}:  60%|██████    | 6/10 [00:42<00:28,  7.22s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9266, 'compress@10': 0.595, 'time@10': 8.7008}:  70%|███████   | 7/10 [00:42<00:19,  6.64s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9234, 'compress@10': 0.5539, 'time@10': 8.5105}:  70%|███████   | 7/10 [00:49<00:19,  6.64s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9234, 'compress@10': 0.5539, 'time@10': 8.5105}:  80%|████████  | 8/10 [00:49<00:13,  6.82s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9286, 'compress@10': 0.5406, 'time@10': 9.1113}:  80%|████████  | 8/10 [00:56<00:13,  6.82s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9286, 'compress@10': 0.5406, 'time@10': 9.1113}:  90%|█████████ | 9/10 [00:56<00:06,  6.88s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9333, 'compress@10': 0.5127, 'time@10': 9.1194}:  90%|█████████ | 9/10 [01:05<00:06,  6.88s/it]  {'epoch': 28, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9333, 'compress@10': 0.5127, 'time@10': 9.1194}: 100%|██████████| 10/10 [01:05<00:00,  7.60s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9333, 'compress@10': 0.5127, 'time@10': 9.1194}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.013594965944597092
Avg hit ratio: 0.8969096102916136
Avg ndcg: 0.9333341126011556
Avg compression ratio: 0.5127215355416802
Avg train time: 9.119430589675904
Std train time: 2.693379674762041
[0.8033333333333332, 0.33666666666666656, 0.03666666666666668, 0.8700000000000001, 0.9700000000000001, 0.5700000000000001, 0.37000000000000005, 0.27, 0.40333333333333327, 0.23666666666666666]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9174, 'compress@10': 0.8137, 'time@10': 8.3785}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9174, 'compress@10': 0.8137, 'time@10': 8.3785}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9433, 'compress@10': 0.5859, 'time@10': 7.6694}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9433, 'compress@10': 0.5859, 'time@10': 7.6694}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9146, 'compress@10': 0.4487, 'time@10': 6.8934}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9146, 'compress@10': 0.4487, 'time@10': 6.8934}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9244, 'compress@10': 0.5552, 'time@10': 6.6496}:  30%|███       | 3/10 [00:19<00:30,  4.42s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9244, 'compress@10': 0.5552, 'time@10': 6.6496}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9225, 'compress@10': 0.6383, 'time@10': 7.9798}:  40%|████      | 4/10 [00:26<00:30,  5.03s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9225, 'compress@10': 0.6383, 'time@10': 7.9798}:  50%|█████     | 5/10 [00:26<00:28,  5.62s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.882, 'ndcg@10': 0.93, 'compress@10': 0.6285, 'time@10': 8.3738}:  50%|█████     | 5/10 [00:36<00:28,  5.62s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.882, 'ndcg@10': 0.93, 'compress@10': 0.6285, 'time@10': 8.3738}:  60%|██████    | 6/10 [00:36<00:28,  7.24s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9321, 'compress@10': 0.5951, 'time@10': 8.7836}:  60%|██████    | 6/10 [00:42<00:28,  7.24s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9321, 'compress@10': 0.5951, 'time@10': 8.7836}:  70%|███████   | 7/10 [00:42<00:20,  6.72s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9329, 'compress@10': 0.5571, 'time@10': 8.6013}:  70%|███████   | 7/10 [00:49<00:20,  6.72s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9329, 'compress@10': 0.5571, 'time@10': 8.6013}:  80%|████████  | 8/10 [00:49<00:13,  6.93s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9365, 'compress@10': 0.5419, 'time@10': 9.2091}:  80%|████████  | 8/10 [00:57<00:13,  6.93s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9365, 'compress@10': 0.5419, 'time@10': 9.2091}:  90%|█████████ | 9/10 [00:57<00:06,  6.97s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9389, 'compress@10': 0.5131, 'time@10': 9.2364}:  90%|█████████ | 9/10 [01:06<00:06,  6.97s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9389, 'compress@10': 0.5131, 'time@10': 9.2364}: 100%|██████████| 10/10 [01:06<00:00,  7.76s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9389, 'compress@10': 0.5131, 'time@10': 9.2364}: 100%|██████████| 10/10 [01:06<00:00,  6.66s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.016224234824044902
Avg hit ratio: 0.8971989088067186
Avg ndcg: 0.938888610927872
Avg compression ratio: 0.5131272709148198
Avg train time: 9.236383080482483
Std train time: 2.8452112537111596
[0.8096774193548386, 0.3258064516129031, 0.03548387096774195, 0.8741935483870968, 0.970967741935484, 0.5516129032258065, 0.3580645161290323, 0.26129032258064516, 0.42258064516129024, 0.26129032258064516]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9174, 'compress@10': 0.8197, 'time@10': 8.4305}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9174, 'compress@10': 0.8197, 'time@10': 8.4305}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9411, 'compress@10': 0.5836, 'time@10': 7.5874}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9411, 'compress@10': 0.5836, 'time@10': 7.5874}:  20%|██        | 2/10 [00:11<00:45,  5.74s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9131, 'compress@10': 0.4468, 'time@10': 6.781}:  20%|██        | 2/10 [00:13<00:45,  5.74s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9131, 'compress@10': 0.4468, 'time@10': 6.781}:  30%|███       | 3/10 [00:13<00:30,  4.31s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.923, 'compress@10': 0.5548, 'time@10': 6.6193}:  30%|███       | 3/10 [00:19<00:30,  4.31s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.923, 'compress@10': 0.5548, 'time@10': 6.6193}:  40%|████      | 4/10 [00:19<00:30,  5.05s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9213, 'compress@10': 0.6381, 'time@10': 7.8497}:  40%|████      | 4/10 [00:26<00:30,  5.05s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9213, 'compress@10': 0.6381, 'time@10': 7.8497}:  50%|█████     | 5/10 [00:26<00:27,  5.54s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.9354, 'compress@10': 0.6254, 'time@10': 8.2616}:  50%|█████     | 5/10 [00:36<00:27,  5.54s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.9354, 'compress@10': 0.6254, 'time@10': 8.2616}:  60%|██████    | 6/10 [00:36<00:28,  7.18s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.9172, 'ndcg@10': 0.9371, 'compress@10': 0.5909, 'time@10': 8.6934}:  60%|██████    | 6/10 [00:42<00:28,  7.18s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.9172, 'ndcg@10': 0.9371, 'compress@10': 0.5909, 'time@10': 8.6934}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.924, 'ndcg@10': 0.9409, 'compress@10': 0.5523, 'time@10': 8.5383}:  70%|███████   | 7/10 [00:49<00:20,  6.69s/it]  {'epoch': 30, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.924, 'ndcg@10': 0.9409, 'compress@10': 0.5523, 'time@10': 8.5383}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9627, 'compress@10': 0.5397, 'time@10': 9.149}:  80%|████████  | 8/10 [00:56<00:13,  6.94s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9627, 'compress@10': 0.5397, 'time@10': 9.149}:  90%|█████████ | 9/10 [00:56<00:06,  6.98s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.9141, 'ndcg@10': 0.9641, 'compress@10': 0.5136, 'time@10': 9.1658}:  90%|█████████ | 9/10 [01:06<00:06,  6.98s/it] {'epoch': 30, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.9141, 'ndcg@10': 0.9641, 'compress@10': 0.5136, 'time@10': 9.1658}: 100%|██████████| 10/10 [01:06<00:00,  7.71s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.9141, 'ndcg@10': 0.9641, 'compress@10': 0.5136, 'time@10': 9.1658}: 100%|██████████| 10/10 [01:06<00:00,  6.62s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.019091914158545532
Avg hit ratio: 0.9140524674344708
Avg ndcg: 0.9640968562804002
Avg compression ratio: 0.513561270073041
Avg train time: 9.165781140327454
Std train time: 2.775903523539831
[0.8156249999999999, 0.3156249999999999, 0.03437500000000002, 0.846875, 0.971875, 0.565625, 0.37812500000000004, 0.253125, 0.44062499999999993, 0.253125]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9197, 'compress@10': 0.8253, 'time@10': 8.1029}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9197, 'compress@10': 0.8253, 'time@10': 8.1029}:  10%|█         | 1/10 [00:04<00:36,  4.09s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9413, 'compress@10': 0.5815, 'time@10': 7.4564}:  10%|█         | 1/10 [00:10<00:36,  4.09s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9413, 'compress@10': 0.5815, 'time@10': 7.4564}:  20%|██        | 2/10 [00:10<00:45,  5.71s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9133, 'compress@10': 0.4451, 'time@10': 6.7224}:  20%|██        | 2/10 [00:13<00:45,  5.71s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9133, 'compress@10': 0.4451, 'time@10': 6.7224}:  30%|███       | 3/10 [00:13<00:30,  4.32s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9233, 'compress@10': 0.5469, 'time@10': 6.5681}:  30%|███       | 3/10 [00:19<00:30,  4.32s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9233, 'compress@10': 0.5469, 'time@10': 6.5681}:  40%|████      | 4/10 [00:19<00:30,  5.04s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9232, 'compress@10': 0.632, 'time@10': 7.8638}:  40%|████      | 4/10 [00:26<00:30,  5.04s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9232, 'compress@10': 0.632, 'time@10': 7.8638}:  50%|█████     | 5/10 [00:26<00:27,  5.59s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.932, 'compress@10': 0.6226, 'time@10': 8.2942}:  50%|█████     | 5/10 [00:36<00:27,  5.59s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.932, 'compress@10': 0.6226, 'time@10': 8.2942}:  60%|██████    | 6/10 [00:36<00:29,  7.25s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9324, 'compress@10': 0.5912, 'time@10': 8.6912}:  60%|██████    | 6/10 [00:42<00:29,  7.25s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9324, 'compress@10': 0.5912, 'time@10': 8.6912}:  70%|███████   | 7/10 [00:42<00:20,  6.70s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9359, 'compress@10': 0.5516, 'time@10': 8.4867}:  70%|███████   | 7/10 [00:49<00:20,  6.70s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9359, 'compress@10': 0.5516, 'time@10': 8.4867}:  80%|████████  | 8/10 [00:49<00:13,  6.83s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.9308, 'compress@10': 0.5411, 'time@10': 9.0923}:  80%|████████  | 8/10 [00:56<00:13,  6.83s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.9308, 'compress@10': 0.5411, 'time@10': 9.0923}:  90%|█████████ | 9/10 [00:56<00:06,  6.88s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9353, 'compress@10': 0.514, 'time@10': 9.1208}:  90%|█████████ | 9/10 [01:05<00:06,  6.88s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9353, 'compress@10': 0.514, 'time@10': 9.1208}: 100%|██████████| 10/10 [01:05<00:00,  7.66s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9353, 'compress@10': 0.514, 'time@10': 9.1208}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.01763623426822481
Avg hit ratio: 0.8953381817201851
Avg ndcg: 0.9352796999670925
Avg compression ratio: 0.5139553865139941
Avg train time: 9.120785522460938
Std train time: 2.8093574999228665
[0.7909090909090909, 0.3060606060606059, 0.03333333333333335, 0.8212121212121213, 0.9727272727272728, 0.5484848484848486, 0.39696969696969703, 0.27575757575757576, 0.4575757575757575, 0.27575757575757576]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9197, 'compress@10': 0.8019, 'time@10': 8.3164}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9197, 'compress@10': 0.8019, 'time@10': 8.3164}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9846, 'compress@10': 0.5652, 'time@10': 7.6093}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9846, 'compress@10': 0.5652, 'time@10': 7.6093}:  20%|██        | 2/10 [00:11<00:46,  5.81s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9421, 'compress@10': 0.4339, 'time@10': 6.8726}:  20%|██        | 2/10 [00:13<00:46,  5.81s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9421, 'compress@10': 0.4339, 'time@10': 6.8726}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9459, 'compress@10': 0.5323, 'time@10': 6.6912}:  30%|███       | 3/10 [00:20<00:30,  4.41s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9459, 'compress@10': 0.5323, 'time@10': 6.6912}:  40%|████      | 4/10 [00:20<00:30,  5.11s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.9415, 'compress@10': 0.6205, 'time@10': 7.9183}:  40%|████      | 4/10 [00:26<00:30,  5.11s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.9415, 'compress@10': 0.6205, 'time@10': 7.9183}:  50%|█████     | 5/10 [00:26<00:27,  5.59s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9464, 'compress@10': 0.6102, 'time@10': 8.3519}:  50%|█████     | 5/10 [00:37<00:27,  5.59s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9464, 'compress@10': 0.6102, 'time@10': 8.3519}:  60%|██████    | 6/10 [00:37<00:29,  7.28s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9468, 'compress@10': 0.5832, 'time@10': 8.7763}:  60%|██████    | 6/10 [00:42<00:29,  7.28s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9468, 'compress@10': 0.5832, 'time@10': 8.7763}:  70%|███████   | 7/10 [00:42<00:20,  6.76s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.953, 'compress@10': 0.5473, 'time@10': 8.6252}:  70%|███████   | 7/10 [00:50<00:20,  6.76s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.953, 'compress@10': 0.5473, 'time@10': 8.6252}:  80%|████████  | 8/10 [00:50<00:14,  7.03s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0148, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9543, 'compress@10': 0.5391, 'time@10': 9.2307}:  80%|████████  | 8/10 [00:57<00:14,  7.03s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0148, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9543, 'compress@10': 0.5391, 'time@10': 9.2307}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9547, 'compress@10': 0.5144, 'time@10': 9.2839}:  90%|█████████ | 9/10 [01:07<00:07,  7.04s/it]    {'epoch': 32, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9547, 'compress@10': 0.5144, 'time@10': 9.2839}: 100%|██████████| 10/10 [01:07<00:00,  7.90s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9547, 'compress@10': 0.5144, 'time@10': 9.2839}: 100%|██████████| 10/10 [01:07<00:00,  6.72s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.015309927558256841
Avg hit ratio: 0.88899614382976
Avg ndcg: 0.9546820194082937
Avg compression ratio: 0.514397951333129
Avg train time: 9.283930683135987
Std train time: 2.755075023082894
[0.7676470588235293, 0.32647058823529396, 0.0323529411764706, 0.8264705882352942, 0.973529411764706, 0.5323529411764707, 0.3852941176470589, 0.29705882352941176, 0.4441176470588235, 0.29705882352941176]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.7799, 'time@10': 8.4353}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.7799, 'time@10': 8.4353}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9513, 'compress@10': 0.564, 'time@10': 7.7}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]    {'epoch': 33, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9513, 'compress@10': 0.564, 'time@10': 7.7}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9199, 'compress@10': 0.4329, 'time@10': 6.9772}:  20%|██        | 2/10 [00:14<00:46,  5.87s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9199, 'compress@10': 0.4329, 'time@10': 6.9772}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.9311, 'compress@10': 0.5328, 'time@10': 6.7678}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.9311, 'compress@10': 0.5328, 'time@10': 6.7678}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.9302, 'compress@10': 0.6211, 'time@10': 7.9935}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.9302, 'compress@10': 0.6211, 'time@10': 7.9935}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9363, 'compress@10': 0.608, 'time@10': 8.3937}:  50%|█████     | 5/10 [00:37<00:28,  5.63s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9363, 'compress@10': 0.608, 'time@10': 8.3937}:  60%|██████    | 6/10 [00:37<00:29,  7.26s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9381, 'compress@10': 0.5797, 'time@10': 8.7759}:  60%|██████    | 6/10 [00:42<00:29,  7.26s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9381, 'compress@10': 0.5797, 'time@10': 8.7759}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.019, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9601, 'compress@10': 0.5469, 'time@10': 8.6333}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.019, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9601, 'compress@10': 0.5469, 'time@10': 8.6333}:  80%|████████  | 8/10 [00:50<00:14,  7.02s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9654, 'compress@10': 0.5372, 'time@10': 9.2503}:  80%|████████  | 8/10 [00:57<00:14,  7.02s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9654, 'compress@10': 0.5372, 'time@10': 9.2503}:  90%|█████████ | 9/10 [00:57<00:07,  7.05s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9665, 'compress@10': 0.5148, 'time@10': 9.2591}:  90%|█████████ | 9/10 [01:06<00:07,  7.05s/it]  {'epoch': 33, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9665, 'compress@10': 0.5148, 'time@10': 9.2591}: 100%|██████████| 10/10 [01:06<00:00,  7.77s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9665, 'compress@10': 0.5148, 'time@10': 9.2591}: 100%|██████████| 10/10 [01:06<00:00,  6.69s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.018202390216842078
Avg hit ratio: 0.8843648074242301
Avg ndcg: 0.9665054150838183
Avg compression ratio: 0.5148166701576604
Avg train time: 9.25912528038025
Std train time: 2.7254766359880915
[0.7742857142857142, 0.317142857142857, 0.03142857142857144, 0.8028571428571429, 0.9742857142857144, 0.5457142857142858, 0.37428571428571433, 0.3171428571428571, 0.45999999999999996, 0.2885714285714286]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.7862, 'time@10': 8.2561}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.7862, 'time@10': 8.2561}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9448, 'compress@10': 0.5627, 'time@10': 7.5341}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9448, 'compress@10': 0.5627, 'time@10': 7.5341}:  20%|██        | 2/10 [00:11<00:45,  5.74s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9155, 'compress@10': 0.4317, 'time@10': 6.8225}:  20%|██        | 2/10 [00:13<00:45,  5.74s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9155, 'compress@10': 0.4317, 'time@10': 6.8225}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9263, 'compress@10': 0.5263, 'time@10': 6.6727}:  30%|███       | 3/10 [00:20<00:30,  4.37s/it]  {'epoch': 34, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9263, 'compress@10': 0.5263, 'time@10': 6.6727}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.9271, 'compress@10': 0.616, 'time@10': 7.9824}:  40%|████      | 4/10 [00:26<00:30,  5.12s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.9271, 'compress@10': 0.616, 'time@10': 7.9824}:  50%|█████     | 5/10 [00:26<00:28,  5.67s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9363, 'compress@10': 0.6059, 'time@10': 8.3908}:  50%|█████     | 5/10 [00:37<00:28,  5.67s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9363, 'compress@10': 0.6059, 'time@10': 8.3908}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0126, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9366, 'compress@10': 0.5764, 'time@10': 8.7367}:  60%|██████    | 6/10 [00:42<00:29,  7.30s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0126, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9366, 'compress@10': 0.5764, 'time@10': 8.7367}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.9383, 'compress@10': 0.5464, 'time@10': 8.6251}:  70%|███████   | 7/10 [00:50<00:20,  6.69s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.9383, 'compress@10': 0.5464, 'time@10': 8.6251}:  80%|████████  | 8/10 [00:50<00:14,  7.07s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9389, 'compress@10': 0.5386, 'time@10': 9.3032}:  80%|████████  | 8/10 [00:57<00:14,  7.07s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9389, 'compress@10': 0.5386, 'time@10': 9.3032}:  90%|█████████ | 9/10 [00:57<00:07,  7.18s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9429, 'compress@10': 0.5152, 'time@10': 9.3255}:  90%|█████████ | 9/10 [01:07<00:07,  7.18s/it]  {'epoch': 34, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9429, 'compress@10': 0.5152, 'time@10': 9.3255}: 100%|██████████| 10/10 [01:07<00:00,  7.91s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9429, 'compress@10': 0.5152, 'time@10': 9.3255}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.014130451629552404
Avg hit ratio: 0.876195324577328
Avg ndcg: 0.942938207383025
Avg compression ratio: 0.5151743134211586
Avg train time: 9.325473737716674
Std train time: 2.8727881377668933
[0.7805555555555556, 0.3083333333333332, 0.030555555555555565, 0.8083333333333335, 0.9750000000000001, 0.5305555555555557, 0.3916666666666667, 0.3083333333333333, 0.475, 0.28055555555555556]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.7921, 'time@10': 8.0404}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.7921, 'time@10': 8.0404}:  10%|█         | 1/10 [00:04<00:36,  4.06s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9529, 'compress@10': 0.5614, 'time@10': 7.3908}:  10%|█         | 1/10 [00:10<00:36,  4.06s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9529, 'compress@10': 0.5614, 'time@10': 7.3908}:  20%|██        | 2/10 [00:10<00:45,  5.66s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.921, 'compress@10': 0.4306, 'time@10': 6.711}:  20%|██        | 2/10 [00:13<00:45,  5.66s/it]  {'epoch': 35, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.921, 'compress@10': 0.4306, 'time@10': 6.711}:  30%|███       | 3/10 [00:13<00:30,  4.32s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.9298, 'compress@10': 0.5267, 'time@10': 6.577}:  30%|███       | 3/10 [00:19<00:30,  4.32s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.9298, 'compress@10': 0.5267, 'time@10': 6.577}:  40%|████      | 4/10 [00:19<00:30,  5.07s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.9287, 'compress@10': 0.6165, 'time@10': 7.8869}:  40%|████      | 4/10 [00:26<00:30,  5.07s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.9287, 'compress@10': 0.6165, 'time@10': 7.8869}:  50%|█████     | 5/10 [00:26<00:28,  5.62s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9392, 'compress@10': 0.6039, 'time@10': 8.2927}:  50%|█████     | 5/10 [00:36<00:28,  5.62s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9392, 'compress@10': 0.6039, 'time@10': 8.2927}:  60%|██████    | 6/10 [00:36<00:28,  7.24s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.941, 'compress@10': 0.5771, 'time@10': 8.6834}:  60%|██████    | 6/10 [00:42<00:28,  7.24s/it]  {'epoch': 35, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.941, 'compress@10': 0.5771, 'time@10': 8.6834}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9444, 'compress@10': 0.5459, 'time@10': 8.5369}:  70%|███████   | 7/10 [00:49<00:20,  6.69s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9444, 'compress@10': 0.5459, 'time@10': 8.5369}:  80%|████████  | 8/10 [00:49<00:13,  6.96s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9466, 'compress@10': 0.5397, 'time@10': 9.2032}:  80%|████████  | 8/10 [00:57<00:13,  6.96s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9466, 'compress@10': 0.5397, 'time@10': 9.2032}:  90%|█████████ | 9/10 [00:57<00:07,  7.07s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9504, 'compress@10': 0.5154, 'time@10': 9.2465}:  90%|█████████ | 9/10 [01:06<00:07,  7.07s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9504, 'compress@10': 0.5154, 'time@10': 9.2465}: 100%|██████████| 10/10 [01:06<00:00,  7.87s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9504, 'compress@10': 0.5154, 'time@10': 9.2465}: 100%|██████████| 10/10 [01:06<00:00,  6.69s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.014524479313895023
Avg hit ratio: 0.8958266609828579
Avg ndcg: 0.950409048049862
Avg compression ratio: 0.515443705889281
Avg train time: 9.246530175209045
Std train time: 2.8781138359757206
[0.7594594594594595, 0.3270270270270269, 0.02972972972972974, 0.8135135135135136, 0.9756756756756758, 0.5432432432432434, 0.38108108108108113, 0.29999999999999993, 0.46216216216216216, 0.3]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.7721, 'time@10': 8.3731}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.7721, 'time@10': 8.3731}:  10%|█         | 1/10 [00:04<00:38,  4.22s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9453, 'compress@10': 0.5604, 'time@10': 7.5977}:  10%|█         | 1/10 [00:11<00:38,  4.22s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9453, 'compress@10': 0.5604, 'time@10': 7.5977}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9159, 'compress@10': 0.4297, 'time@10': 6.8372}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9159, 'compress@10': 0.4297, 'time@10': 6.8372}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.9281, 'compress@10': 0.5273, 'time@10': 6.6946}:  30%|███       | 3/10 [00:20<00:30,  4.37s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.9281, 'compress@10': 0.5273, 'time@10': 6.6946}:  40%|████      | 4/10 [00:20<00:30,  5.13s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9284, 'compress@10': 0.6171, 'time@10': 7.9525}:  40%|████      | 4/10 [00:26<00:30,  5.13s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9284, 'compress@10': 0.6171, 'time@10': 7.9525}:  50%|█████     | 5/10 [00:26<00:28,  5.64s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9347, 'compress@10': 0.6065, 'time@10': 8.3343}:  50%|█████     | 5/10 [00:36<00:28,  5.64s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9347, 'compress@10': 0.6065, 'time@10': 8.3343}:  60%|██████    | 6/10 [00:36<00:28,  7.22s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9366, 'compress@10': 0.5778, 'time@10': 8.7069}:  60%|██████    | 6/10 [00:42<00:28,  7.22s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9366, 'compress@10': 0.5778, 'time@10': 8.7069}:  70%|███████   | 7/10 [00:42<00:19,  6.66s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9621, 'compress@10': 0.5456, 'time@10': 8.5786}:  70%|███████   | 7/10 [00:50<00:19,  6.66s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9621, 'compress@10': 0.5456, 'time@10': 8.5786}:  80%|████████  | 8/10 [00:50<00:13,  7.00s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9715, 'compress@10': 0.538, 'time@10': 9.1832}:  80%|████████  | 8/10 [00:57<00:13,  7.00s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9715, 'compress@10': 0.538, 'time@10': 9.1832}:  90%|█████████ | 9/10 [00:57<00:07,  7.02s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.972, 'compress@10': 0.5158, 'time@10': 9.2379}:  90%|█████████ | 9/10 [01:06<00:07,  7.02s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.972, 'compress@10': 0.5158, 'time@10': 9.2379}: 100%|██████████| 10/10 [01:06<00:00,  7.87s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.972, 'compress@10': 0.5158, 'time@10': 9.2379}: 100%|██████████| 10/10 [01:06<00:00,  6.70s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.014893280508885786
Avg hit ratio: 0.8827933788528016
Avg ndcg: 0.9719989330007113
Avg compression ratio: 0.5158176443644715
Avg train time: 9.237939524650574
Std train time: 2.725288283579304
[0.7657894736842106, 0.3184210526315788, 0.02894736842105264, 0.7921052631578949, 0.9763157894736844, 0.5552631578947369, 0.3710526315789474, 0.3184210526315789, 0.4763157894736842, 0.2921052631578947]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.7781, 'time@10': 8.4009}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.7781, 'time@10': 8.4009}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9448, 'compress@10': 0.5593, 'time@10': 7.6882}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9448, 'compress@10': 0.5593, 'time@10': 7.6882}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9155, 'compress@10': 0.4287, 'time@10': 6.9149}:  20%|██        | 2/10 [00:13<00:46,  5.87s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9155, 'compress@10': 0.4287, 'time@10': 6.9149}:  30%|███       | 3/10 [00:13<00:31,  4.43s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.927, 'compress@10': 0.5214, 'time@10': 6.7664}:  30%|███       | 3/10 [00:20<00:31,  4.43s/it]  {'epoch': 37, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.927, 'compress@10': 0.5214, 'time@10': 6.7664}:  40%|████      | 4/10 [00:20<00:31,  5.19s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.9271, 'compress@10': 0.6125, 'time@10': 8.0167}:  40%|████      | 4/10 [00:26<00:31,  5.19s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.9271, 'compress@10': 0.6125, 'time@10': 8.0167}:  50%|█████     | 5/10 [00:26<00:28,  5.68s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.9345, 'compress@10': 0.6046, 'time@10': 8.4142}:  50%|█████     | 5/10 [00:37<00:28,  5.68s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.9345, 'compress@10': 0.6046, 'time@10': 8.4142}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9409, 'compress@10': 0.5748, 'time@10': 8.7791}:  60%|██████    | 6/10 [00:42<00:29,  7.30s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9409, 'compress@10': 0.5748, 'time@10': 8.7791}:  70%|███████   | 7/10 [00:42<00:20,  6.72s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9457, 'compress@10': 0.5452, 'time@10': 8.6739}:  70%|███████   | 7/10 [00:50<00:20,  6.72s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9457, 'compress@10': 0.5452, 'time@10': 8.6739}:  80%|████████  | 8/10 [00:50<00:14,  7.12s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9394, 'compress@10': 0.5392, 'time@10': 9.2919}:  80%|████████  | 8/10 [00:57<00:14,  7.12s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9394, 'compress@10': 0.5392, 'time@10': 9.2919}:  90%|█████████ | 9/10 [00:57<00:07,  7.13s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.943, 'compress@10': 0.5161, 'time@10': 9.3261}:  90%|█████████ | 9/10 [01:07<00:07,  7.13s/it]    {'epoch': 37, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.943, 'compress@10': 0.5161, 'time@10': 9.3261}: 100%|██████████| 10/10 [01:07<00:00,  7.91s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.943, 'compress@10': 0.5161, 'time@10': 9.3261}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.016626098518483807
Avg hit ratio: 0.8781953245773281
Avg ndcg: 0.9429622077800733
Avg compression ratio: 0.5161212258236383
Avg train time: 9.326116013526917
Std train time: 2.7329385274867444
[0.7461538461538462, 0.31025641025641015, 0.028205128205128212, 0.7717948717948719, 0.9769230769230771, 0.5666666666666668, 0.38717948717948725, 0.3102564102564102, 0.4897435897435897, 0.3102564102564102]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.925, 'compress@10': 0.7595, 'time@10': 8.7196}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.925, 'compress@10': 0.7595, 'time@10': 8.7196}:  10%|█         | 1/10 [00:04<00:39,  4.40s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9723, 'compress@10': 0.546, 'time@10': 7.9036}:  10%|█         | 1/10 [00:11<00:39,  4.40s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9723, 'compress@10': 0.546, 'time@10': 7.9036}:  20%|██        | 2/10 [00:11<00:48,  6.00s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9339, 'compress@10': 0.4197, 'time@10': 7.081}:  20%|██        | 2/10 [00:14<00:48,  6.00s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9339, 'compress@10': 0.4197, 'time@10': 7.081}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9392, 'compress@10': 0.5097, 'time@10': 6.835}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9392, 'compress@10': 0.5097, 'time@10': 6.835}:  40%|████      | 4/10 [00:20<00:30,  5.16s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.938, 'compress@10': 0.6033, 'time@10': 8.0822}:  40%|████      | 4/10 [00:26<00:30,  5.16s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.938, 'compress@10': 0.6033, 'time@10': 8.0822}:  50%|█████     | 5/10 [00:26<00:28,  5.67s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9443, 'compress@10': 0.5988, 'time@10': 8.4351}:  50%|█████     | 5/10 [00:37<00:28,  5.67s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9443, 'compress@10': 0.5988, 'time@10': 8.4351}:  60%|██████    | 6/10 [00:37<00:28,  7.22s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9431, 'compress@10': 0.572, 'time@10': 8.7952}:  60%|██████    | 6/10 [00:42<00:28,  7.22s/it] {'epoch': 38, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9431, 'compress@10': 0.572, 'time@10': 8.7952}:  70%|███████   | 7/10 [00:42<00:19,  6.66s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9452, 'compress@10': 0.5418, 'time@10': 8.6641}:  70%|███████   | 7/10 [00:50<00:19,  6.66s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9452, 'compress@10': 0.5418, 'time@10': 8.6641}:  80%|████████  | 8/10 [00:50<00:14,  7.02s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9475, 'compress@10': 0.5376, 'time@10': 9.3171}:  80%|████████  | 8/10 [00:57<00:14,  7.02s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9475, 'compress@10': 0.5376, 'time@10': 9.3171}:  90%|█████████ | 9/10 [00:57<00:07,  7.11s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9495, 'compress@10': 0.5165, 'time@10': 9.363}:  90%|█████████ | 9/10 [01:07<00:07,  7.11s/it]    {'epoch': 38, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9495, 'compress@10': 0.5165, 'time@10': 9.363}: 100%|██████████| 10/10 [01:07<00:00,  7.94s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9495, 'compress@10': 0.5165, 'time@10': 9.363}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.014440613198505942
Avg hit ratio: 0.8881390009726173
Avg ndcg: 0.9494550370052824
Avg compression ratio: 0.5164561632872771
Avg train time: 9.362972617149353
Std train time: 2.7976456016154274
[0.7275, 0.3274999999999999, 0.027500000000000007, 0.7775000000000002, 0.9775000000000001, 0.5525000000000001, 0.4025000000000001, 0.30249999999999994, 0.4775, 0.32749999999999996]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.931, 'compress@10': 0.7418, 'time@10': 8.423}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.931, 'compress@10': 0.7418, 'time@10': 8.423}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9555, 'compress@10': 0.5455, 'time@10': 7.765}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9555, 'compress@10': 0.5455, 'time@10': 7.765}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9227, 'compress@10': 0.4192, 'time@10': 6.9636}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9227, 'compress@10': 0.4192, 'time@10': 6.9636}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.9326, 'compress@10': 0.5107, 'time@10': 6.7618}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.9326, 'compress@10': 0.5107, 'time@10': 6.7618}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9339, 'compress@10': 0.6042, 'time@10': 8.0121}:  40%|████      | 4/10 [00:26<00:30,  5.15s/it] {'epoch': 39, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9339, 'compress@10': 0.6042, 'time@10': 8.0121}:  50%|█████     | 5/10 [00:26<00:28,  5.65s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9395, 'compress@10': 0.5972, 'time@10': 8.3674}:  50%|█████     | 5/10 [00:37<00:28,  5.65s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9395, 'compress@10': 0.5972, 'time@10': 8.3674}:  60%|██████    | 6/10 [00:37<00:28,  7.19s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9414, 'compress@10': 0.5728, 'time@10': 8.759}:  60%|██████    | 6/10 [00:42<00:28,  7.19s/it] {'epoch': 39, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9414, 'compress@10': 0.5728, 'time@10': 8.759}:  70%|███████   | 7/10 [00:42<00:20,  6.67s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0119, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9452, 'compress@10': 0.5415, 'time@10': 8.6256}:  70%|███████   | 7/10 [00:50<00:20,  6.67s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0119, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9452, 'compress@10': 0.5415, 'time@10': 8.6256}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9475, 'compress@10': 0.5361, 'time@10': 9.2461}:  80%|████████  | 8/10 [00:57<00:14,  7.01s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9475, 'compress@10': 0.5361, 'time@10': 9.2461}:  90%|█████████ | 9/10 [00:57<00:07,  7.05s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9503, 'compress@10': 0.5167, 'time@10': 9.2789}:  90%|█████████ | 9/10 [01:07<00:07,  7.05s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9503, 'compress@10': 0.5167, 'time@10': 9.2789}: 100%|██████████| 10/10 [01:07<00:00,  7.84s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9503, 'compress@10': 0.5167, 'time@10': 9.2789}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.012084897899236106
Avg hit ratio: 0.8885076645670873
Avg ndcg: 0.9503424534049143
Avg compression ratio: 0.5167323222693382
Avg train time: 9.278863835334779
Std train time: 2.7479544231224056
[0.7341463414634146, 0.3195121951219511, 0.026829268292682933, 0.7829268292682928, 0.978048780487805, 0.5634146341463415, 0.39268292682926836, 0.2951219512195121, 0.4902439024390244, 0.31951219512195117]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.931, 'compress@10': 0.7481, 'time@10': 8.608}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.931, 'compress@10': 0.7481, 'time@10': 8.608}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9486, 'compress@10': 0.5448, 'time@10': 7.7734}:  10%|█         | 1/10 [00:11<00:39,  4.34s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9486, 'compress@10': 0.5448, 'time@10': 7.7734}:  20%|██        | 2/10 [00:11<00:47,  5.89s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9181, 'compress@10': 0.4185, 'time@10': 7.0856}:  20%|██        | 2/10 [00:14<00:47,  5.89s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9181, 'compress@10': 0.4185, 'time@10': 7.0856}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.929, 'compress@10': 0.5115, 'time@10': 6.8811}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.929, 'compress@10': 0.5115, 'time@10': 6.8811}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9304, 'compress@10': 0.6049, 'time@10': 8.1271}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9304, 'compress@10': 0.6049, 'time@10': 8.1271}:  50%|█████     | 5/10 [00:27<00:28,  5.72s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.938, 'compress@10': 0.5996, 'time@10': 8.4417}:  50%|█████     | 5/10 [00:37<00:28,  5.72s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.938, 'compress@10': 0.5996, 'time@10': 8.4417}:  60%|██████    | 6/10 [00:37<00:28,  7.19s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9402, 'compress@10': 0.5735, 'time@10': 8.7833}:  60%|██████    | 6/10 [00:42<00:28,  7.19s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9402, 'compress@10': 0.5735, 'time@10': 8.7833}:  70%|███████   | 7/10 [00:42<00:19,  6.62s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9459, 'compress@10': 0.5412, 'time@10': 8.6809}:  70%|███████   | 7/10 [00:50<00:19,  6.62s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9459, 'compress@10': 0.5412, 'time@10': 8.6809}:  80%|████████  | 8/10 [00:50<00:14,  7.06s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9459, 'compress@10': 0.5372, 'time@10': 9.2948}:  80%|████████  | 8/10 [00:57<00:14,  7.06s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9459, 'compress@10': 0.5372, 'time@10': 9.2948}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9491, 'compress@10': 0.517, 'time@10': 9.31}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it]      {'epoch': 40, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9491, 'compress@10': 0.517, 'time@10': 9.31}: 100%|██████████| 10/10 [01:07<00:00,  7.83s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9491, 'compress@10': 0.517, 'time@10': 9.31}: 100%|██████████| 10/10 [01:07<00:00,  6.72s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.011204124735404495
Avg hit ratio: 0.8932183660519823
Avg ndcg: 0.949072128565445
Avg compression ratio: 0.5169735783034339
Avg train time: 9.310041546821594
Std train time: 2.6719279805056444
[0.7404761904761905, 0.3119047619047618, 0.026190476190476198, 0.7880952380952382, 0.9785714285714286, 0.55, 0.3833333333333334, 0.31190476190476185, 0.5023809523809524, 0.31190476190476185]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9335, 'compress@10': 0.7541, 'time@10': 8.3813}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9335, 'compress@10': 0.7541, 'time@10': 8.3813}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9833, 'compress@10': 0.5441, 'time@10': 7.6006}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9833, 'compress@10': 0.5441, 'time@10': 7.6006}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9413, 'compress@10': 0.4178, 'time@10': 6.7949}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9413, 'compress@10': 0.4178, 'time@10': 6.7949}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9452, 'compress@10': 0.5123, 'time@10': 6.6293}:  30%|███       | 3/10 [00:19<00:30,  4.34s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9452, 'compress@10': 0.5123, 'time@10': 6.6293}:  40%|████      | 4/10 [00:19<00:30,  5.06s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.9457, 'compress@10': 0.6056, 'time@10': 7.94}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it]  {'epoch': 41, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.9457, 'compress@10': 0.6056, 'time@10': 7.94}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.9533, 'compress@10': 0.598, 'time@10': 8.3384}:  50%|█████     | 5/10 [00:36<00:28,  5.63s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.9533, 'compress@10': 0.598, 'time@10': 8.3384}:  60%|██████    | 6/10 [00:36<00:28,  7.24s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9536, 'compress@10': 0.5709, 'time@10': 8.7406}:  60%|██████    | 6/10 [00:42<00:28,  7.24s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9536, 'compress@10': 0.5709, 'time@10': 8.7406}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9616, 'compress@10': 0.541, 'time@10': 8.6318}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9616, 'compress@10': 0.541, 'time@10': 8.6318}:  80%|████████  | 8/10 [00:50<00:14,  7.09s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9619, 'compress@10': 0.5383, 'time@10': 9.2584}:  80%|████████  | 8/10 [00:57<00:14,  7.09s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9619, 'compress@10': 0.5383, 'time@10': 9.2584}:  90%|█████████ | 9/10 [00:57<00:07,  7.12s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9627, 'compress@10': 0.5172, 'time@10': 9.3208}:  90%|█████████ | 9/10 [01:07<00:07,  7.12s/it]  {'epoch': 41, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9627, 'compress@10': 0.5172, 'time@10': 9.3208}: 100%|██████████| 10/10 [01:07<00:00,  7.98s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9627, 'compress@10': 0.5172, 'time@10': 9.3208}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.01373807705940636
Avg hit ratio: 0.8845445309265344
Avg ndcg: 0.9626707334870369
Avg compression ratio: 0.5171882778308897
Avg train time: 9.32081868648529
Std train time: 2.839736685519931
[0.7232558139534884, 0.32790697674418595, 0.025581395348837216, 0.7930232558139536, 0.9790697674418606, 0.5604651162790698, 0.3744186046511629, 0.327906976744186, 0.4906976744186046, 0.30465116279069765]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.7378, 'time@10': 8.3901}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.7378, 'time@10': 8.3901}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9451, 'compress@10': 0.5437, 'time@10': 7.592}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9451, 'compress@10': 0.5437, 'time@10': 7.592}:  20%|██        | 2/10 [00:11<00:46,  5.76s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9158, 'compress@10': 0.4174, 'time@10': 6.7754}:  20%|██        | 2/10 [00:13<00:46,  5.76s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9158, 'compress@10': 0.4174, 'time@10': 6.7754}:  30%|███       | 3/10 [00:13<00:30,  4.32s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9274, 'compress@10': 0.5131, 'time@10': 6.5883}:  30%|███       | 3/10 [00:19<00:30,  4.32s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9274, 'compress@10': 0.5131, 'time@10': 6.5883}:  40%|████      | 4/10 [00:19<00:30,  5.06s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9307, 'compress@10': 0.6064, 'time@10': 7.8256}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9307, 'compress@10': 0.6064, 'time@10': 7.8256}:  50%|█████     | 5/10 [00:26<00:27,  5.60s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9383, 'compress@10': 0.6004, 'time@10': 8.2609}:  50%|█████     | 5/10 [00:36<00:27,  5.60s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9383, 'compress@10': 0.6004, 'time@10': 8.2609}:  60%|██████    | 6/10 [00:36<00:29,  7.26s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9405, 'compress@10': 0.5717, 'time@10': 8.6837}:  60%|██████    | 6/10 [00:42<00:29,  7.26s/it] {'epoch': 42, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9405, 'compress@10': 0.5717, 'time@10': 8.6837}:  70%|███████   | 7/10 [00:42<00:20,  6.73s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9672, 'compress@10': 0.5436, 'time@10': 8.5573}:  70%|███████   | 7/10 [00:50<00:20,  6.73s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9672, 'compress@10': 0.5436, 'time@10': 8.5573}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.9809, 'compress@10': 0.5393, 'time@10': 9.1774}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.9809, 'compress@10': 0.5393, 'time@10': 9.1774}:  90%|█████████ | 9/10 [00:57<00:07,  7.06s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9806, 'compress@10': 0.5175, 'time@10': 9.2317}:  90%|█████████ | 9/10 [01:07<00:07,  7.06s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9806, 'compress@10': 0.5175, 'time@10': 9.2317}: 100%|██████████| 10/10 [01:07<00:00,  7.89s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9806, 'compress@10': 0.5175, 'time@10': 9.2317}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.014445049863824267
Avg hit ratio: 0.8931359018269035
Avg ndcg: 0.9805652872326936
Avg compression ratio: 0.517454332163423
Avg train time: 9.231681513786317
Std train time: 2.799232665030934
[0.7068181818181818, 0.3431818181818181, 0.025000000000000005, 0.7977272727272728, 0.9795454545454546, 0.5477272727272727, 0.365909090909091, 0.34318181818181814, 0.5022727272727272, 0.29772727272727273]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9335, 'compress@10': 0.7222, 'time@10': 8.4405}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9335, 'compress@10': 0.7222, 'time@10': 8.4405}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9737, 'compress@10': 0.5433, 'time@10': 7.8166}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9737, 'compress@10': 0.5433, 'time@10': 7.8166}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9349, 'compress@10': 0.417, 'time@10': 6.969}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9349, 'compress@10': 0.417, 'time@10': 6.969}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9415, 'compress@10': 0.514, 'time@10': 6.7938}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9415, 'compress@10': 0.514, 'time@10': 6.7938}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0157, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9427, 'compress@10': 0.6072, 'time@10': 8.1071}:  40%|████      | 4/10 [00:27<00:31,  5.21s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0157, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9427, 'compress@10': 0.6072, 'time@10': 8.1071}:  50%|█████     | 5/10 [00:27<00:28,  5.76s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.952, 'compress@10': 0.5989, 'time@10': 8.4666}:  50%|█████     | 5/10 [00:37<00:28,  5.76s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.952, 'compress@10': 0.5989, 'time@10': 8.4666}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0203, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9542, 'compress@10': 0.5693, 'time@10': 8.8571}:  60%|██████    | 6/10 [00:43<00:29,  7.30s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0203, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9542, 'compress@10': 0.5693, 'time@10': 8.8571}:  70%|███████   | 7/10 [00:43<00:20,  6.76s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9557, 'compress@10': 0.5433, 'time@10': 8.7184}:  70%|███████   | 7/10 [00:50<00:20,  6.76s/it]  {'epoch': 43, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9557, 'compress@10': 0.5433, 'time@10': 8.7184}:  80%|████████  | 8/10 [00:50<00:14,  7.08s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0208, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9483, 'compress@10': 0.5404, 'time@10': 9.3541}:  80%|████████  | 8/10 [00:58<00:14,  7.08s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0208, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9483, 'compress@10': 0.5404, 'time@10': 9.3541}:  90%|█████████ | 9/10 [00:58<00:07,  7.14s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9509, 'compress@10': 0.5177, 'time@10': 9.381}:  90%|█████████ | 9/10 [01:07<00:07,  7.14s/it]     {'epoch': 43, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9509, 'compress@10': 0.5177, 'time@10': 9.381}: 100%|██████████| 10/10 [01:07<00:00,  7.92s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9509, 'compress@10': 0.5177, 'time@10': 9.381}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.020610484503994643
Avg hit ratio: 0.9019735874387825
Avg ndcg: 0.9509403139436238
Avg compression ratio: 0.5176965897409127
Avg train time: 9.380961370468139
Std train time: 2.8366791184722224
[0.6911111111111111, 0.3577777777777777, 0.02444444444444445, 0.7800000000000001, 0.9577777777777778, 0.5577777777777778, 0.3800000000000001, 0.3355555555555555, 0.5133333333333333, 0.31333333333333335]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0057, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.7074, 'time@10': 8.8413}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0057, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.7074, 'time@10': 8.8413}:  10%|█         | 1/10 [00:04<00:40,  4.46s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9592, 'compress@10': 0.5429, 'time@10': 7.9178}:  10%|█         | 1/10 [00:11<00:40,  4.46s/it] {'epoch': 44, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9592, 'compress@10': 0.5429, 'time@10': 7.9178}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9252, 'compress@10': 0.4166, 'time@10': 7.0014}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9252, 'compress@10': 0.4166, 'time@10': 7.0014}:  30%|███       | 3/10 [00:14<00:31,  4.44s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9343, 'compress@10': 0.5094, 'time@10': 6.7758}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9343, 'compress@10': 0.5094, 'time@10': 6.7758}:  40%|████      | 4/10 [00:20<00:30,  5.11s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9376, 'compress@10': 0.5992, 'time@10': 8.0305}:  40%|████      | 4/10 [00:26<00:30,  5.11s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9376, 'compress@10': 0.5992, 'time@10': 8.0305}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.944, 'compress@10': 0.594, 'time@10': 8.3898}:  50%|█████     | 5/10 [00:37<00:28,  5.63s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.944, 'compress@10': 0.594, 'time@10': 8.3898}:  60%|██████    | 6/10 [00:37<00:28,  7.19s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9457, 'compress@10': 0.5669, 'time@10': 8.8047}:  60%|██████    | 6/10 [00:42<00:28,  7.19s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9457, 'compress@10': 0.5669, 'time@10': 8.8047}:  70%|███████   | 7/10 [00:42<00:20,  6.70s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.949, 'compress@10': 0.5404, 'time@10': 8.6753}:  70%|███████   | 7/10 [00:50<00:20,  6.70s/it]  {'epoch': 44, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.949, 'compress@10': 0.5404, 'time@10': 8.6753}:  80%|████████  | 8/10 [00:50<00:14,  7.05s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9516, 'compress@10': 0.5389, 'time@10': 9.2937}:  80%|████████  | 8/10 [00:57<00:14,  7.05s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9516, 'compress@10': 0.5389, 'time@10': 9.2937}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9542, 'compress@10': 0.5179, 'time@10': 9.3087}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9542, 'compress@10': 0.5179, 'time@10': 9.3087}: 100%|██████████| 10/10 [01:07<00:00,  7.83s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9542, 'compress@10': 0.5179, 'time@10': 9.3087}: 100%|██████████| 10/10 [01:07<00:00,  6.72s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.010300716913609785
Avg hit ratio: 0.9066842889236778
Avg ndcg: 0.9541574980014162
Avg compression ratio: 0.5179250297911763
Avg train time: 9.308666253089905
Std train time: 2.800703879636387
[0.6760869565217391, 0.3717391304347825, 0.023913043478260874, 0.7847826086956523, 0.9586956521739131, 0.5456521739130435, 0.37173913043478274, 0.32826086956521733, 0.5239130434782608, 0.3282608695652174]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9271, 'compress@10': 0.6931, 'time@10': 8.5247}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9271, 'compress@10': 0.6931, 'time@10': 8.5247}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9474, 'compress@10': 0.5426, 'time@10': 7.6964}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9474, 'compress@10': 0.5426, 'time@10': 7.6964}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9173, 'compress@10': 0.4162, 'time@10': 6.9213}:  20%|██        | 2/10 [00:13<00:46,  5.83s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9173, 'compress@10': 0.4162, 'time@10': 6.9213}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9286, 'compress@10': 0.5102, 'time@10': 6.7458}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9286, 'compress@10': 0.5102, 'time@10': 6.7458}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9331, 'compress@10': 0.6001, 'time@10': 8.0076}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9331, 'compress@10': 0.6001, 'time@10': 8.0076}:  50%|█████     | 5/10 [00:26<00:28,  5.66s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9407, 'compress@10': 0.5927, 'time@10': 8.3763}:  50%|█████     | 5/10 [00:37<00:28,  5.66s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9407, 'compress@10': 0.5927, 'time@10': 8.3763}:  60%|██████    | 6/10 [00:37<00:28,  7.22s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9426, 'compress@10': 0.5647, 'time@10': 8.8219}:  60%|██████    | 6/10 [00:42<00:28,  7.22s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9426, 'compress@10': 0.5647, 'time@10': 8.8219}:  70%|███████   | 7/10 [00:42<00:20,  6.75s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9503, 'compress@10': 0.5376, 'time@10': 8.6978}:  70%|███████   | 7/10 [00:50<00:20,  6.75s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9503, 'compress@10': 0.5376, 'time@10': 8.6978}:  80%|████████  | 8/10 [00:50<00:14,  7.11s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9502, 'compress@10': 0.5376, 'time@10': 9.3639}:  80%|████████  | 8/10 [00:58<00:14,  7.11s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9502, 'compress@10': 0.5376, 'time@10': 9.3639}:  90%|█████████ | 9/10 [00:58<00:07,  7.19s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9554, 'compress@10': 0.5182, 'time@10': 9.4039}:  90%|█████████ | 9/10 [01:07<00:07,  7.19s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9554, 'compress@10': 0.5182, 'time@10': 9.4039}: 100%|██████████| 10/10 [01:07<00:00,  8.00s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9554, 'compress@10': 0.5182, 'time@10': 9.4039}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.013133421291091768
Avg hit ratio: 0.8844620667014554
Avg ndcg: 0.9554323085458947
Avg compression ratio: 0.5181561413937016
Avg train time: 9.403893184661865
Std train time: 2.873332431971911
[0.6829787234042553, 0.36382978723404247, 0.02340425531914894, 0.7893617021276597, 0.9382978723404255, 0.5340425531914894, 0.3638297872340427, 0.34255319148936164, 0.5340425531914893, 0.3425531914893617]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.6997, 'time@10': 8.4859}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.6997, 'time@10': 8.4859}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9453, 'compress@10': 0.542, 'time@10': 7.8284}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]  {'epoch': 46, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9453, 'compress@10': 0.542, 'time@10': 7.8284}:  20%|██        | 2/10 [00:11<00:48,  6.00s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9159, 'compress@10': 0.4156, 'time@10': 6.9322}:  20%|██        | 2/10 [00:14<00:48,  6.00s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9159, 'compress@10': 0.4156, 'time@10': 6.9322}:  30%|███       | 3/10 [00:14<00:31,  4.45s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9273, 'compress@10': 0.511, 'time@10': 6.7307}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it]  {'epoch': 46, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9273, 'compress@10': 0.511, 'time@10': 6.7307}:  40%|████      | 4/10 [00:20<00:30,  5.13s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.933, 'compress@10': 0.5967, 'time@10': 7.9472}:  40%|████      | 4/10 [00:26<00:30,  5.13s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.933, 'compress@10': 0.5967, 'time@10': 7.9472}:  50%|█████     | 5/10 [00:26<00:28,  5.60s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9398, 'compress@10': 0.588, 'time@10': 8.3509}:  50%|█████     | 5/10 [00:37<00:28,  5.60s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9398, 'compress@10': 0.588, 'time@10': 8.3509}:  60%|██████    | 6/10 [00:37<00:28,  7.24s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9421, 'compress@10': 0.5596, 'time@10': 8.7567}:  60%|██████    | 6/10 [00:42<00:28,  7.24s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9421, 'compress@10': 0.5596, 'time@10': 8.7567}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9441, 'compress@10': 0.5348, 'time@10': 8.6199}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9441, 'compress@10': 0.5348, 'time@10': 8.6199}:  80%|████████  | 8/10 [00:50<00:14,  7.03s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9464, 'compress@10': 0.5362, 'time@10': 9.2261}:  80%|████████  | 8/10 [00:57<00:14,  7.03s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9464, 'compress@10': 0.5362, 'time@10': 9.2261}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9495, 'compress@10': 0.5183, 'time@10': 9.2641}:  90%|█████████ | 9/10 [01:07<00:07,  7.04s/it]     {'epoch': 46, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9495, 'compress@10': 0.5183, 'time@10': 9.2641}: 100%|██████████| 10/10 [01:07<00:00,  7.84s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9495, 'compress@10': 0.5183, 'time@10': 9.2641}: 100%|██████████| 10/10 [01:07<00:00,  6.72s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.010943179896653932
Avg hit ratio: 0.8900370795022747
Avg ndcg: 0.9494906197930414
Avg compression ratio: 0.5183182540536757
Avg train time: 9.26409637928009
Std train time: 2.742393231241681
[0.6895833333333332, 0.3562499999999999, 0.02291666666666667, 0.7937500000000001, 0.9395833333333333, 0.5437500000000001, 0.3562500000000001, 0.35624999999999996, 0.5229166666666666, 0.33541666666666664]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.7059, 'time@10': 8.784}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.7059, 'time@10': 8.784}:  10%|█         | 1/10 [00:04<00:39,  4.43s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9496, 'compress@10': 0.5415, 'time@10': 7.8966}:  10%|█         | 1/10 [00:11<00:39,  4.43s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9496, 'compress@10': 0.5415, 'time@10': 7.8966}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9188, 'compress@10': 0.4151, 'time@10': 7.0476}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9188, 'compress@10': 0.4151, 'time@10': 7.0476}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9295, 'compress@10': 0.5116, 'time@10': 6.8105}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9295, 'compress@10': 0.5116, 'time@10': 6.8105}:  40%|████      | 4/10 [00:20<00:30,  5.13s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9358, 'compress@10': 0.5975, 'time@10': 8.1896}:  40%|████      | 4/10 [00:27<00:30,  5.13s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9358, 'compress@10': 0.5975, 'time@10': 8.1896}:  50%|█████     | 5/10 [00:27<00:28,  5.77s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9425, 'compress@10': 0.5902, 'time@10': 8.5522}:  50%|█████     | 5/10 [00:37<00:28,  5.77s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9425, 'compress@10': 0.5902, 'time@10': 8.5522}:  60%|██████    | 6/10 [00:37<00:29,  7.34s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9449, 'compress@10': 0.5605, 'time@10': 8.9188}:  60%|██████    | 6/10 [00:43<00:29,  7.34s/it] {'epoch': 47, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9449, 'compress@10': 0.5605, 'time@10': 8.9188}:  70%|███████   | 7/10 [00:43<00:20,  6.77s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9628, 'compress@10': 0.5372, 'time@10': 8.7863}:  70%|███████   | 7/10 [00:51<00:20,  6.77s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9628, 'compress@10': 0.5372, 'time@10': 8.7863}:  80%|████████  | 8/10 [00:51<00:14,  7.13s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9647, 'compress@10': 0.5372, 'time@10': 9.3656}:  80%|████████  | 8/10 [00:58<00:14,  7.13s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9647, 'compress@10': 0.5372, 'time@10': 9.3656}:  90%|█████████ | 9/10 [00:58<00:07,  7.10s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9659, 'compress@10': 0.5185, 'time@10': 9.3946}:  90%|█████████ | 9/10 [01:07<00:07,  7.10s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9659, 'compress@10': 0.5185, 'time@10': 9.3946}: 100%|██████████| 10/10 [01:07<00:00,  7.90s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9659, 'compress@10': 0.5185, 'time@10': 9.3946}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.010491011422825497
Avg hit ratio: 0.9041958096610048
Avg ndcg: 0.9658669427238162
Avg compression ratio: 0.5184943980393131
Avg train time: 9.394557332992553
Std train time: 2.8182037709654764
[0.6959183673469387, 0.3489795918367346, 0.022448979591836737, 0.7979591836734694, 0.9408163265306122, 0.5326530612244899, 0.3489795918367348, 0.36938775510204075, 0.5326530612244897, 0.32857142857142857]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.7119, 'time@10': 8.3029}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.7119, 'time@10': 8.3029}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9458, 'compress@10': 0.5409, 'time@10': 7.5486}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it] {'epoch': 48, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9458, 'compress@10': 0.5409, 'time@10': 7.5486}:  20%|██        | 2/10 [00:11<00:45,  5.75s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9162, 'compress@10': 0.4147, 'time@10': 6.8003}:  20%|██        | 2/10 [00:13<00:45,  5.75s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9162, 'compress@10': 0.4147, 'time@10': 6.8003}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9258, 'compress@10': 0.5123, 'time@10': 6.6412}:  30%|███       | 3/10 [00:19<00:30,  4.35s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9258, 'compress@10': 0.5123, 'time@10': 6.6412}:  40%|████      | 4/10 [00:19<00:30,  5.08s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9337, 'compress@10': 0.5982, 'time@10': 7.9029}:  40%|████      | 4/10 [00:26<00:30,  5.08s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9337, 'compress@10': 0.5982, 'time@10': 7.9029}:  50%|█████     | 5/10 [00:26<00:27,  5.60s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9409, 'compress@10': 0.589, 'time@10': 8.322}:  50%|█████     | 5/10 [00:36<00:27,  5.60s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9409, 'compress@10': 0.589, 'time@10': 8.322}:  60%|██████    | 6/10 [00:36<00:28,  7.25s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.942, 'compress@10': 0.5585, 'time@10': 8.7567}:  60%|██████    | 6/10 [00:42<00:28,  7.25s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.942, 'compress@10': 0.5585, 'time@10': 8.7567}:  70%|███████   | 7/10 [00:42<00:20,  6.75s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9706, 'compress@10': 0.5371, 'time@10': 8.6433}:  70%|███████   | 7/10 [00:50<00:20,  6.75s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9706, 'compress@10': 0.5371, 'time@10': 8.6433}:  80%|████████  | 8/10 [00:50<00:14,  7.11s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0165, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9673, 'compress@10': 0.5381, 'time@10': 9.242}:  80%|████████  | 8/10 [00:57<00:14,  7.11s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0165, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9673, 'compress@10': 0.5381, 'time@10': 9.242}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9674, 'compress@10': 0.5186, 'time@10': 9.3071}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9674, 'compress@10': 0.5186, 'time@10': 9.3071}: 100%|██████████| 10/10 [01:07<00:00,  7.97s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9674, 'compress@10': 0.5186, 'time@10': 9.3071}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.01640150286165384
Avg hit ratio: 0.9016049238443127
Avg ndcg: 0.9674222344375879
Avg compression ratio: 0.5186440861924757
Avg train time: 9.307142090797424
Std train time: 2.7704875058741587
[0.6819999999999999, 0.3419999999999999, 0.022000000000000002, 0.802, 0.9219999999999999, 0.542, 0.34200000000000014, 0.38199999999999995, 0.5419999999999999, 0.342]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9291, 'compress@10': 0.6987, 'time@10': 8.387}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9291, 'compress@10': 0.6987, 'time@10': 8.387}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9825, 'compress@10': 0.531, 'time@10': 7.7859}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9825, 'compress@10': 0.531, 'time@10': 7.7859}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9407, 'compress@10': 0.4079, 'time@10': 7.0277}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9407, 'compress@10': 0.4079, 'time@10': 7.0277}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9461, 'compress@10': 0.5082, 'time@10': 6.7776}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9461, 'compress@10': 0.5082, 'time@10': 6.7776}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9497, 'compress@10': 0.5913, 'time@10': 8.0058}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9497, 'compress@10': 0.5913, 'time@10': 8.0058}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.954, 'compress@10': 0.5847, 'time@10': 8.276}:  50%|█████     | 5/10 [00:36<00:28,  5.63s/it] {'epoch': 49, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.954, 'compress@10': 0.5847, 'time@10': 8.276}:  60%|██████    | 6/10 [00:36<00:27,  7.00s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9636, 'compress@10': 0.5538, 'time@10': 8.5942}:  60%|██████    | 6/10 [00:41<00:27,  7.00s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9636, 'compress@10': 0.5538, 'time@10': 8.5942}:  70%|███████   | 7/10 [00:41<00:19,  6.45s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9646, 'compress@10': 0.5346, 'time@10': 8.4757}:  70%|███████   | 7/10 [00:49<00:19,  6.45s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9646, 'compress@10': 0.5346, 'time@10': 8.4757}:  80%|████████  | 8/10 [00:49<00:13,  6.84s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9651, 'compress@10': 0.5368, 'time@10': 8.9667}:  80%|████████  | 8/10 [00:55<00:13,  6.84s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9651, 'compress@10': 0.5368, 'time@10': 8.9667}:  90%|█████████ | 9/10 [00:55<00:06,  6.73s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9694, 'compress@10': 0.5188, 'time@10': 8.9417}:  90%|█████████ | 9/10 [01:04<00:06,  6.73s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9694, 'compress@10': 0.5188, 'time@10': 8.9417}: 100%|██████████| 10/10 [01:04<00:00,  7.35s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9694, 'compress@10': 0.5188, 'time@10': 8.9417}: 100%|██████████| 10/10 [01:04<00:00,  6.47s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.012847781723117338
Avg hit ratio: 0.9099100953752906
Avg ndcg: 0.9694202672339959
Avg compression ratio: 0.5188487047539762
Avg train time: 8.941658782958985
Std train time: 2.444235312412962
[0.6686274509803921, 0.35490196078431363, 0.021568627450980395, 0.8058823529411765, 0.9039215686274509, 0.5313725490196078, 0.35490196078431385, 0.3745098039215686, 0.5509803921568627, 0.35490196078431374]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
