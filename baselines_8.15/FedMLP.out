  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2099, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.5262, 'compress@10': 1.0, 'time@10': 3.4683}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2099, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.5262, 'compress@10': 1.0, 'time@10': 3.4683}:  10%|█         | 1/10 [00:01<00:15,  1.77s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1461, 'hit_ratio@10': 0.6078, 'ndcg@10': 0.6381, 'compress@10': 1.0, 'time@10': 2.6866}:  10%|█         | 1/10 [00:03<00:15,  1.77s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1461, 'hit_ratio@10': 0.6078, 'ndcg@10': 0.6381, 'compress@10': 1.0, 'time@10': 2.6866}:  20%|██        | 2/10 [00:03<00:14,  1.87s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9033, 'hit_ratio@10': 0.5481, 'ndcg@10': 0.4254, 'compress@10': 1.0, 'time@10': 2.0566}:  20%|██        | 2/10 [00:04<00:14,  1.87s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9033, 'hit_ratio@10': 0.5481, 'ndcg@10': 0.4254, 'compress@10': 1.0, 'time@10': 2.0566}:  30%|███       | 3/10 [00:04<00:08,  1.21s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7067, 'hit_ratio@10': 0.5985, 'ndcg@10': 0.4655, 'compress@10': 1.0, 'time@10': 1.9616}:  30%|███       | 3/10 [00:05<00:08,  1.21s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7067, 'hit_ratio@10': 0.5985, 'ndcg@10': 0.4655, 'compress@10': 1.0, 'time@10': 1.9616}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5843, 'hit_ratio@10': 0.6428, 'ndcg@10': 0.5233, 'compress@10': 1.0, 'time@10': 2.9155}:  40%|████      | 4/10 [00:09<00:08,  1.41s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5843, 'hit_ratio@10': 0.6428, 'ndcg@10': 0.5233, 'compress@10': 1.0, 'time@10': 2.9155}:  50%|█████     | 5/10 [00:09<00:10,  2.13s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5015, 'hit_ratio@10': 0.6468, 'ndcg@10': 0.5676, 'compress@10': 1.0, 'time@10': 2.9712}:  50%|█████     | 5/10 [00:12<00:10,  2.13s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5015, 'hit_ratio@10': 0.6468, 'ndcg@10': 0.5676, 'compress@10': 1.0, 'time@10': 2.9712}:  60%|██████    | 6/10 [00:12<00:10,  2.52s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4467, 'hit_ratio@10': 0.6516, 'ndcg@10': 0.5691, 'compress@10': 1.0, 'time@10': 3.0269}:  60%|██████    | 6/10 [00:14<00:10,  2.52s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4467, 'hit_ratio@10': 0.6516, 'ndcg@10': 0.5691, 'compress@10': 1.0, 'time@10': 3.0269}:  70%|███████   | 7/10 [00:14<00:06,  2.26s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3973, 'hit_ratio@10': 0.6844, 'ndcg@10': 0.5953, 'compress@10': 1.0, 'time@10': 2.9444}:  70%|███████   | 7/10 [00:16<00:06,  2.26s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3973, 'hit_ratio@10': 0.6844, 'ndcg@10': 0.5953, 'compress@10': 1.0, 'time@10': 2.9444}:  80%|████████  | 8/10 [00:16<00:04,  2.31s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3593, 'hit_ratio@10': 0.6877, 'ndcg@10': 0.63, 'compress@10': 1.0, 'time@10': 3.1033}:  80%|████████  | 8/10 [00:18<00:04,  2.31s/it] {'epoch': 0, 'num_users': 6.3333, 'loss': 0.3593, 'hit_ratio@10': 0.6877, 'ndcg@10': 0.63, 'compress@10': 1.0, 'time@10': 3.1033}:  90%|█████████ | 9/10 [00:18<00:02,  2.28s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3288, 'hit_ratio@10': 0.7121, 'ndcg@10': 0.6515, 'compress@10': 1.0, 'time@10': 3.0778}:  90%|█████████ | 9/10 [00:21<00:02,  2.28s/it] {'epoch': 0, 'num_users': 6.3, 'loss': 0.3288, 'hit_ratio@10': 0.7121, 'ndcg@10': 0.6515, 'compress@10': 1.0, 'time@10': 3.0778}: 100%|██████████| 10/10 [00:21<00:00,  2.47s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3288, 'hit_ratio@10': 0.7121, 'ndcg@10': 0.6515, 'compress@10': 1.0, 'time@10': 3.0778}: 100%|██████████| 10/10 [00:21<00:00,  2.18s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.3287658676454607
Avg hit ratio: 0.7121247400024988
Avg ndcg: 0.65148379675922
Avg compression ratio: 1.0
Avg train time: 3.0777555465698243
Std train time: 1.5617344183338149
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 2.1815}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 2.1815}:  10%|█         | 1/10 [00:01<00:10,  1.12s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0513, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.85, 'compress@10': 1.0, 'time@10': 2.0746}:  10%|█         | 1/10 [00:03<00:10,  1.12s/it]  {'epoch': 1, 'num_users': 7.0, 'loss': 0.0513, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.85, 'compress@10': 1.0, 'time@10': 2.0746}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 1.6624}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 1.6624}:  30%|███       | 3/10 [00:03<00:07,  1.10s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0406, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8484, 'compress@10': 1.0, 'time@10': 1.7059}:  30%|███       | 3/10 [00:05<00:07,  1.10s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0406, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8484, 'compress@10': 1.0, 'time@10': 1.7059}:  40%|████      | 4/10 [00:05<00:08,  1.40s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0508, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8371, 'compress@10': 1.0, 'time@10': 2.6864}:  40%|████      | 4/10 [00:08<00:08,  1.40s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0508, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8371, 'compress@10': 1.0, 'time@10': 2.6864}:  50%|█████     | 5/10 [00:08<00:10,  2.10s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0563, 'hit_ratio@10': 0.7837, 'ndcg@10': 0.8298, 'compress@10': 1.0, 'time@10': 2.7527}:  50%|█████     | 5/10 [00:11<00:10,  2.10s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0563, 'hit_ratio@10': 0.7837, 'ndcg@10': 0.8298, 'compress@10': 1.0, 'time@10': 2.7527}:  60%|██████    | 6/10 [00:11<00:09,  2.45s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0546, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8338, 'compress@10': 1.0, 'time@10': 2.7997}:  60%|██████    | 6/10 [00:13<00:09,  2.45s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0546, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8338, 'compress@10': 1.0, 'time@10': 2.7997}:  70%|███████   | 7/10 [00:13<00:06,  2.16s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.053, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8393, 'compress@10': 1.0, 'time@10': 2.727}:  70%|███████   | 7/10 [00:15<00:06,  2.16s/it]    {'epoch': 1, 'num_users': 6.125, 'loss': 0.053, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8393, 'compress@10': 1.0, 'time@10': 2.727}:  80%|████████  | 8/10 [00:15<00:04,  2.19s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0532, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 2.9276}:  80%|████████  | 8/10 [00:18<00:04,  2.19s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0532, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 2.9276}:  90%|█████████ | 9/10 [00:18<00:02,  2.22s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0535, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.861, 'compress@10': 1.0, 'time@10': 2.9243}:  90%|█████████ | 9/10 [00:20<00:02,  2.22s/it]    {'epoch': 1, 'num_users': 6.3, 'loss': 0.0535, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.861, 'compress@10': 1.0, 'time@10': 2.9243}: 100%|██████████| 10/10 [00:20<00:00,  2.44s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0535, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.861, 'compress@10': 1.0, 'time@10': 2.9243}: 100%|██████████| 10/10 [00:20<00:00,  2.09s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05349603289144693
Avg hit ratio: 0.8308025096955488
Avg ndcg: 0.8610070125287607
Avg compression ratio: 1.0
Avg train time: 2.924284076690674
Std train time: 1.539833381230027
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8533, 'compress@10': 1.0, 'time@10': 2.3377}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8533, 'compress@10': 1.0, 'time@10': 2.3377}:  10%|█         | 1/10 [00:01<00:10,  1.20s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0512, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8516, 'compress@10': 1.0, 'time@10': 2.2441}:  10%|█         | 1/10 [00:03<00:10,  1.20s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0512, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8516, 'compress@10': 1.0, 'time@10': 2.2441}:  20%|██        | 2/10 [00:03<00:14,  1.78s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0349, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 1.7095}:  20%|██        | 2/10 [00:03<00:14,  1.78s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0349, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 1.7095}:  30%|███       | 3/10 [00:03<00:07,  1.13s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.7481, 'ndcg@10': 0.8509, 'compress@10': 1.0, 'time@10': 1.766}:  30%|███       | 3/10 [00:05<00:07,  1.13s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.7481, 'ndcg@10': 0.8509, 'compress@10': 1.0, 'time@10': 1.766}:  40%|████      | 4/10 [00:05<00:08,  1.46s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0489, 'hit_ratio@10': 0.7664, 'ndcg@10': 0.8369, 'compress@10': 1.0, 'time@10': 2.8075}:  40%|████      | 4/10 [00:09<00:08,  1.46s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0489, 'hit_ratio@10': 0.7664, 'ndcg@10': 0.8369, 'compress@10': 1.0, 'time@10': 2.8075}:  50%|█████     | 5/10 [00:09<00:11,  2.21s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0543, 'hit_ratio@10': 0.7646, 'ndcg@10': 0.8321, 'compress@10': 1.0, 'time@10': 2.8468}:  50%|█████     | 5/10 [00:12<00:11,  2.21s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0543, 'hit_ratio@10': 0.7646, 'ndcg@10': 0.8321, 'compress@10': 1.0, 'time@10': 2.8468}:  60%|██████    | 6/10 [00:12<00:10,  2.50s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0525, 'hit_ratio@10': 0.7925, 'ndcg@10': 0.8355, 'compress@10': 1.0, 'time@10': 2.8817}:  60%|██████    | 6/10 [00:13<00:10,  2.50s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0525, 'hit_ratio@10': 0.7925, 'ndcg@10': 0.8355, 'compress@10': 1.0, 'time@10': 2.8817}:  70%|███████   | 7/10 [00:13<00:06,  2.20s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.8401, 'compress@10': 1.0, 'time@10': 2.8013}:  70%|███████   | 7/10 [00:16<00:06,  2.20s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.8401, 'compress@10': 1.0, 'time@10': 2.8013}:  80%|████████  | 8/10 [00:16<00:04,  2.22s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.7942, 'ndcg@10': 0.8505, 'compress@10': 1.0, 'time@10': 3.0177}:  80%|████████  | 8/10 [00:18<00:04,  2.22s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.7942, 'ndcg@10': 0.8505, 'compress@10': 1.0, 'time@10': 3.0177}:  90%|█████████ | 9/10 [00:18<00:02,  2.28s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.808, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 2.9966}:  90%|█████████ | 9/10 [00:21<00:02,  2.28s/it]    {'epoch': 2, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.808, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 2.9966}: 100%|██████████| 10/10 [00:21<00:00,  2.45s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.808, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 2.9966}: 100%|██████████| 10/10 [00:21<00:00,  2.14s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04930155290997679
Avg hit ratio: 0.8079612398542789
Avg ndcg: 0.8502129504589506
Avg compression ratio: 1.0
Avg train time: 2.996637988090515
Std train time: 1.6533933524880466
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 2.2772}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 2.2772}:  10%|█         | 1/10 [00:01<00:10,  1.17s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8467, 'compress@10': 1.0, 'time@10': 2.1703}:  10%|█         | 1/10 [00:03<00:10,  1.17s/it] {'epoch': 3, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8467, 'compress@10': 1.0, 'time@10': 2.1703}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 1.6855}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 1.6855}:  30%|███       | 3/10 [00:03<00:07,  1.11s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0385, 'hit_ratio@10': 0.7918, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 1.7078}:  30%|███       | 3/10 [00:05<00:07,  1.11s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0385, 'hit_ratio@10': 0.7918, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 1.7078}:  40%|████      | 4/10 [00:05<00:08,  1.38s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0487, 'hit_ratio@10': 0.7975, 'ndcg@10': 0.8357, 'compress@10': 1.0, 'time@10': 2.6207}:  40%|████      | 4/10 [00:08<00:08,  1.38s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0487, 'hit_ratio@10': 0.7975, 'ndcg@10': 0.8357, 'compress@10': 1.0, 'time@10': 2.6207}:  50%|█████     | 5/10 [00:08<00:10,  2.03s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.054, 'hit_ratio@10': 0.7794, 'ndcg@10': 0.831, 'compress@10': 1.0, 'time@10': 2.673}:  50%|█████     | 5/10 [00:11<00:10,  2.03s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.054, 'hit_ratio@10': 0.7794, 'ndcg@10': 0.831, 'compress@10': 1.0, 'time@10': 2.673}:  60%|██████    | 6/10 [00:11<00:09,  2.35s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0523, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8355, 'compress@10': 1.0, 'time@10': 2.7287}:  60%|██████    | 6/10 [00:13<00:09,  2.35s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0523, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8355, 'compress@10': 1.0, 'time@10': 2.7287}:  70%|███████   | 7/10 [00:13<00:06,  2.09s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.8188, 'ndcg@10': 0.84, 'compress@10': 1.0, 'time@10': 2.6573}:  70%|███████   | 7/10 [00:15<00:06,  2.09s/it]   {'epoch': 3, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.8188, 'ndcg@10': 0.84, 'compress@10': 1.0, 'time@10': 2.6573}:  80%|████████  | 8/10 [00:15<00:04,  2.12s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 2.8818}:  80%|████████  | 8/10 [00:17<00:04,  2.12s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 2.8818}:  90%|█████████ | 9/10 [00:17<00:02,  2.20s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0492, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.85, 'compress@10': 1.0, 'time@10': 2.8931}:  90%|█████████ | 9/10 [00:20<00:02,  2.20s/it]     {'epoch': 3, 'num_users': 6.3, 'loss': 0.0492, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.85, 'compress@10': 1.0, 'time@10': 2.8931}: 100%|██████████| 10/10 [00:20<00:00,  2.45s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0492, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.85, 'compress@10': 1.0, 'time@10': 2.8931}: 100%|██████████| 10/10 [00:20<00:00,  2.08s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.04923364012309013
Avg hit ratio: 0.8225203796392252
Avg ndcg: 0.8499683273649478
Avg compression ratio: 1.0
Avg train time: 2.8930985927581787
Std train time: 1.4915074489232305
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8474, 'compress@10': 1.0, 'time@10': 2.2344}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8474, 'compress@10': 1.0, 'time@10': 2.2344}:  10%|█         | 1/10 [00:01<00:10,  1.14s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8418, 'compress@10': 1.0, 'time@10': 2.06}:  10%|█         | 1/10 [00:03<00:10,  1.14s/it]  {'epoch': 4, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8418, 'compress@10': 1.0, 'time@10': 2.06}:  20%|██        | 2/10 [00:03<00:12,  1.60s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8469, 'compress@10': 1.0, 'time@10': 1.6389}:  20%|██        | 2/10 [00:03<00:12,  1.60s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8469, 'compress@10': 1.0, 'time@10': 1.6389}:  30%|███       | 3/10 [00:03<00:07,  1.06s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0371, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 1.6371}:  30%|███       | 3/10 [00:05<00:07,  1.06s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0371, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 1.6371}:  40%|████      | 4/10 [00:05<00:07,  1.30s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.7696, 'ndcg@10': 0.8354, 'compress@10': 1.0, 'time@10': 2.5297}:  40%|████      | 4/10 [00:08<00:07,  1.30s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.7696, 'ndcg@10': 0.8354, 'compress@10': 1.0, 'time@10': 2.5297}:  50%|█████     | 5/10 [00:08<00:09,  1.94s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0523, 'hit_ratio@10': 0.7635, 'ndcg@10': 0.831, 'compress@10': 1.0, 'time@10': 2.5968}:  50%|█████     | 5/10 [00:11<00:09,  1.94s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0523, 'hit_ratio@10': 0.7635, 'ndcg@10': 0.831, 'compress@10': 1.0, 'time@10': 2.5968}:  60%|██████    | 6/10 [00:11<00:09,  2.29s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8359, 'compress@10': 1.0, 'time@10': 2.6907}:  60%|██████    | 6/10 [00:12<00:09,  2.29s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8359, 'compress@10': 1.0, 'time@10': 2.6907}:  70%|███████   | 7/10 [00:12<00:06,  2.08s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.049, 'hit_ratio@10': 0.8105, 'ndcg@10': 0.8372, 'compress@10': 1.0, 'time@10': 2.6537}:  70%|███████   | 7/10 [00:15<00:06,  2.08s/it]  {'epoch': 4, 'num_users': 6.125, 'loss': 0.049, 'hit_ratio@10': 0.8105, 'ndcg@10': 0.8372, 'compress@10': 1.0, 'time@10': 2.6537}:  80%|████████  | 8/10 [00:15<00:04,  2.19s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0476, 'hit_ratio@10': 0.8062, 'ndcg@10': 0.8483, 'compress@10': 1.0, 'time@10': 2.8925}:  80%|████████  | 8/10 [00:17<00:04,  2.19s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0476, 'hit_ratio@10': 0.8062, 'ndcg@10': 0.8483, 'compress@10': 1.0, 'time@10': 2.8925}:  90%|█████████ | 9/10 [00:17<00:02,  2.27s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8485, 'compress@10': 1.0, 'time@10': 2.8592}:  90%|█████████ | 9/10 [00:20<00:02,  2.27s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8485, 'compress@10': 1.0, 'time@10': 2.8592}: 100%|██████████| 10/10 [00:20<00:00,  2.37s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8485, 'compress@10': 1.0, 'time@10': 2.8592}: 100%|██████████| 10/10 [00:20<00:00,  2.03s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04750834403429325
Avg hit ratio: 0.8187390176320568
Avg ndcg: 0.848489449397681
Avg compression ratio: 1.0
Avg train time: 2.8591861486434937
Std train time: 1.4779653896781042
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8486, 'compress@10': 1.0, 'time@10': 2.4572}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8486, 'compress@10': 1.0, 'time@10': 2.4572}:  10%|█         | 1/10 [00:01<00:11,  1.27s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.7657, 'ndcg@10': 0.8611, 'compress@10': 1.0, 'time@10': 2.2436}:  10%|█         | 1/10 [00:03<00:11,  1.27s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.7657, 'ndcg@10': 0.8611, 'compress@10': 1.0, 'time@10': 2.2436}:  20%|██        | 2/10 [00:03<00:13,  1.73s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.7486, 'ndcg@10': 0.8576, 'compress@10': 1.0, 'time@10': 1.721}:  20%|██        | 2/10 [00:03<00:13,  1.73s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.7486, 'ndcg@10': 0.8576, 'compress@10': 1.0, 'time@10': 1.721}:  30%|███       | 3/10 [00:03<00:07,  1.11s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8568, 'compress@10': 1.0, 'time@10': 1.7487}:  30%|███       | 3/10 [00:05<00:07,  1.11s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8568, 'compress@10': 1.0, 'time@10': 1.7487}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.041, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8492, 'compress@10': 1.0, 'time@10': 2.657}:  40%|████      | 4/10 [00:08<00:08,  1.41s/it]  {'epoch': 5, 'num_users': 5.8, 'loss': 0.041, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8492, 'compress@10': 1.0, 'time@10': 2.657}:  50%|█████     | 5/10 [00:08<00:10,  2.05s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0446, 'hit_ratio@10': 0.7946, 'ndcg@10': 0.8455, 'compress@10': 1.0, 'time@10': 2.6995}:  50%|█████     | 5/10 [00:11<00:10,  2.05s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0446, 'hit_ratio@10': 0.7946, 'ndcg@10': 0.8455, 'compress@10': 1.0, 'time@10': 2.6995}:  60%|██████    | 6/10 [00:11<00:09,  2.35s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0433, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8483, 'compress@10': 1.0, 'time@10': 2.7367}:  60%|██████    | 6/10 [00:13<00:09,  2.35s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0433, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8483, 'compress@10': 1.0, 'time@10': 2.7367}:  70%|███████   | 7/10 [00:13<00:06,  2.08s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0418, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 2.6424}:  70%|███████   | 7/10 [00:15<00:06,  2.08s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0418, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 2.6424}:  80%|████████  | 8/10 [00:15<00:04,  2.05s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0404, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8595, 'compress@10': 1.0, 'time@10': 2.8637}:  80%|████████  | 8/10 [00:17<00:04,  2.05s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0404, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8595, 'compress@10': 1.0, 'time@10': 2.8637}:  90%|█████████ | 9/10 [00:17<00:02,  2.15s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0408, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8582, 'compress@10': 1.0, 'time@10': 2.846}:  90%|█████████ | 9/10 [00:20<00:02,  2.15s/it]    {'epoch': 5, 'num_users': 6.3, 'loss': 0.0408, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8582, 'compress@10': 1.0, 'time@10': 2.846}: 100%|██████████| 10/10 [00:20<00:00,  2.33s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0408, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8582, 'compress@10': 1.0, 'time@10': 2.846}: 100%|██████████| 10/10 [00:20<00:00,  2.03s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04080395650241776
Avg hit ratio: 0.8345132111804437
Avg ndcg: 0.8582240084028381
Avg compression ratio: 1.0
Avg train time: 2.8459511518478395
Std train time: 1.4968860520677787
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0432, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 2.1994}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0432, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 2.1994}:  10%|█         | 1/10 [00:01<00:10,  1.13s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0389, 'hit_ratio@10': 0.798, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 1.966}:  10%|█         | 1/10 [00:02<00:10,  1.13s/it]   {'epoch': 6, 'num_users': 7.0, 'loss': 0.0389, 'hit_ratio@10': 0.798, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 1.966}:  20%|██        | 2/10 [00:02<00:12,  1.50s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 1.5313}:  20%|██        | 2/10 [00:03<00:12,  1.50s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 1.5313}:  30%|███       | 3/10 [00:03<00:06,  1.02it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0327, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 1.534}:  30%|███       | 3/10 [00:04<00:06,  1.02it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0327, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 1.534}:  40%|████      | 4/10 [00:04<00:07,  1.21s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0365, 'hit_ratio@10': 0.788, 'ndcg@10': 0.8476, 'compress@10': 1.0, 'time@10': 2.4764}:  40%|████      | 4/10 [00:07<00:07,  1.21s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0365, 'hit_ratio@10': 0.788, 'ndcg@10': 0.8476, 'compress@10': 1.0, 'time@10': 2.4764}:  50%|█████     | 5/10 [00:07<00:09,  1.91s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0375, 'hit_ratio@10': 0.8011, 'ndcg@10': 0.8522, 'compress@10': 1.0, 'time@10': 2.5612}:  50%|█████     | 5/10 [00:10<00:09,  1.91s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0375, 'hit_ratio@10': 0.8011, 'ndcg@10': 0.8522, 'compress@10': 1.0, 'time@10': 2.5612}:  60%|██████    | 6/10 [00:10<00:09,  2.29s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0366, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 2.6661}:  60%|██████    | 6/10 [00:12<00:09,  2.29s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0366, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 2.6661}:  70%|███████   | 7/10 [00:12<00:06,  2.09s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.037, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8607, 'compress@10': 1.0, 'time@10': 2.6221}:  70%|███████   | 7/10 [00:15<00:06,  2.09s/it]  {'epoch': 6, 'num_users': 6.125, 'loss': 0.037, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8607, 'compress@10': 1.0, 'time@10': 2.6221}:  80%|████████  | 8/10 [00:15<00:04,  2.17s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0359, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8679, 'compress@10': 1.0, 'time@10': 2.8145}:  80%|████████  | 8/10 [00:17<00:04,  2.17s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0359, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8679, 'compress@10': 1.0, 'time@10': 2.8145}:  90%|█████████ | 9/10 [00:17<00:02,  2.18s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 2.825}:  90%|█████████ | 9/10 [00:20<00:02,  2.18s/it]    {'epoch': 6, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 2.825}: 100%|██████████| 10/10 [00:20<00:00,  2.42s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 2.825}: 100%|██████████| 10/10 [00:20<00:00,  2.02s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.03582548608913271
Avg hit ratio: 0.8298695859884315
Avg ndcg: 0.8678105345288973
Avg compression ratio: 1.0
Avg train time: 2.824988913536072
Std train time: 1.4988555720877443
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0424, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.844, 'compress@10': 1.0, 'time@10': 2.2947}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0424, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.844, 'compress@10': 1.0, 'time@10': 2.2947}:  10%|█         | 1/10 [00:01<00:10,  1.18s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0404, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 2.1662}:  10%|█         | 1/10 [00:03<00:10,  1.18s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0404, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 2.1662}:  20%|██        | 2/10 [00:03<00:13,  1.70s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0365, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8422, 'compress@10': 1.0, 'time@10': 1.6809}:  20%|██        | 2/10 [00:03<00:13,  1.70s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0365, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8422, 'compress@10': 1.0, 'time@10': 1.6809}:  30%|███       | 3/10 [00:03<00:07,  1.10s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.041, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 1.6704}:  30%|███       | 3/10 [00:05<00:07,  1.10s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.041, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 1.6704}:  40%|████      | 4/10 [00:05<00:07,  1.32s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0428, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8668, 'compress@10': 1.0, 'time@10': 2.5339}:  40%|████      | 4/10 [00:08<00:07,  1.32s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0428, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8668, 'compress@10': 1.0, 'time@10': 2.5339}:  50%|█████     | 5/10 [00:08<00:09,  1.94s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0445, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 2.5803}:  50%|█████     | 5/10 [00:11<00:09,  1.94s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0445, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 2.5803}:  60%|██████    | 6/10 [00:11<00:08,  2.25s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0419, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 2.643}:  60%|██████    | 6/10 [00:12<00:08,  2.25s/it] {'epoch': 7, 'num_users': 6.2857, 'loss': 0.0419, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 2.643}:  70%|███████   | 7/10 [00:12<00:06,  2.02s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0386, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 2.5715}:  70%|███████   | 7/10 [00:14<00:06,  2.02s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0386, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 2.5715}:  80%|████████  | 8/10 [00:14<00:04,  2.04s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0361, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 2.7573}:  80%|████████  | 8/10 [00:16<00:04,  2.04s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0361, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 2.7573}:  90%|█████████ | 9/10 [00:16<00:02,  2.08s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0357, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 2.7399}:  90%|█████████ | 9/10 [00:19<00:02,  2.08s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0357, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 2.7399}: 100%|██████████| 10/10 [00:19<00:00,  2.25s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0357, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 2.7399}: 100%|██████████| 10/10 [00:19<00:00,  1.96s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.035660939227605784
Avg hit ratio: 0.876443900562746
Avg ndcg: 0.8956941334899966
Avg compression ratio: 1.0
Avg train time: 2.7398539543151856
Std train time: 1.39234024437553
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8724, 'compress@10': 1.0, 'time@10': 2.3106}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8724, 'compress@10': 1.0, 'time@10': 2.3106}:  10%|█         | 1/10 [00:01<00:10,  1.18s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8814, 'compress@10': 1.0, 'time@10': 2.1211}:  10%|█         | 1/10 [00:03<00:10,  1.18s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8814, 'compress@10': 1.0, 'time@10': 2.1211}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.7769, 'ndcg@10': 0.8406, 'compress@10': 1.0, 'time@10': 1.6623}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.7769, 'ndcg@10': 0.8406, 'compress@10': 1.0, 'time@10': 1.6623}:  30%|███       | 3/10 [00:03<00:07,  1.07s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8677, 'compress@10': 1.0, 'time@10': 1.6877}:  30%|███       | 3/10 [00:05<00:07,  1.07s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8677, 'compress@10': 1.0, 'time@10': 1.6877}:  40%|████      | 4/10 [00:05<00:08,  1.36s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0367, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8881, 'compress@10': 1.0, 'time@10': 2.6282}:  40%|████      | 4/10 [00:08<00:08,  1.36s/it] {'epoch': 8, 'num_users': 5.8, 'loss': 0.0367, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8881, 'compress@10': 1.0, 'time@10': 2.6282}:  50%|█████     | 5/10 [00:08<00:10,  2.04s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0439, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8858, 'compress@10': 1.0, 'time@10': 2.7031}:  50%|█████     | 5/10 [00:11<00:10,  2.04s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0439, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8858, 'compress@10': 1.0, 'time@10': 2.7031}:  60%|██████    | 6/10 [00:11<00:09,  2.40s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0413, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 2.7331}:  60%|██████    | 6/10 [00:13<00:09,  2.40s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0413, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 2.7331}:  70%|███████   | 7/10 [00:13<00:06,  2.10s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.038, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8996, 'compress@10': 1.0, 'time@10': 2.6519}:  70%|███████   | 7/10 [00:15<00:06,  2.10s/it]  {'epoch': 8, 'num_users': 6.125, 'loss': 0.038, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8996, 'compress@10': 1.0, 'time@10': 2.6519}:  80%|████████  | 8/10 [00:15<00:04,  2.10s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.035, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 2.8314}:  80%|████████  | 8/10 [00:17<00:04,  2.10s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.035, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 2.8314}:  90%|█████████ | 9/10 [00:17<00:02,  2.12s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0414, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 2.8061}:  90%|█████████ | 9/10 [00:20<00:02,  2.12s/it]  {'epoch': 8, 'num_users': 6.3, 'loss': 0.0414, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 2.8061}: 100%|██████████| 10/10 [00:20<00:00,  2.27s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0414, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 2.8061}: 100%|██████████| 10/10 [00:20<00:00,  2.01s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.041402500356931084
Avg hit ratio: 0.8785101120347301
Avg ndcg: 0.8954066594758778
Avg compression ratio: 1.0
Avg train time: 2.806120419502258
Std train time: 1.4827321267653129
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 2.2333}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 2.2333}:  10%|█         | 1/10 [00:01<00:10,  1.16s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0286, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 2.0434}:  10%|█         | 1/10 [00:03<00:10,  1.16s/it] {'epoch': 9, 'num_users': 7.0, 'loss': 0.0286, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 2.0434}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 1.6075}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 1.6075}:  30%|███       | 3/10 [00:03<00:07,  1.05s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.912, 'compress@10': 1.0, 'time@10': 1.6188}:  30%|███       | 3/10 [00:05<00:07,  1.05s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.912, 'compress@10': 1.0, 'time@10': 1.6188}:  40%|████      | 4/10 [00:05<00:07,  1.30s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0381, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9267, 'compress@10': 1.0, 'time@10': 2.6488}:  40%|████      | 4/10 [00:08<00:07,  1.30s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0381, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9267, 'compress@10': 1.0, 'time@10': 2.6488}:  50%|█████     | 5/10 [00:08<00:10,  2.07s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.044, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.9383, 'compress@10': 1.0, 'time@10': 2.6681}:  50%|█████     | 5/10 [00:11<00:10,  2.07s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.044, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.9383, 'compress@10': 1.0, 'time@10': 2.6681}:  60%|██████    | 6/10 [00:11<00:09,  2.32s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9568, 'compress@10': 1.0, 'time@10': 2.7445}:  60%|██████    | 6/10 [00:13<00:09,  2.32s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9568, 'compress@10': 1.0, 'time@10': 2.7445}:  70%|███████   | 7/10 [00:13<00:06,  2.09s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.045, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.9569, 'compress@10': 1.0, 'time@10': 2.6505}:  70%|███████   | 7/10 [00:15<00:06,  2.09s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.045, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.9569, 'compress@10': 1.0, 'time@10': 2.6505}:  80%|████████  | 8/10 [00:15<00:04,  2.07s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0458, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9489, 'compress@10': 1.0, 'time@10': 2.837}:  80%|████████  | 8/10 [00:17<00:04,  2.07s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0458, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9489, 'compress@10': 1.0, 'time@10': 2.837}:  90%|█████████ | 9/10 [00:17<00:02,  2.11s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 2.8116}:  90%|█████████ | 9/10 [00:19<00:02,  2.11s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 2.8116}: 100%|██████████| 10/10 [00:19<00:00,  2.26s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 2.8116}: 100%|██████████| 10/10 [00:19<00:00,  1.98s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.04895282691128295
Avg hit ratio: 0.9064591806985696
Avg ndcg: 0.9497442816253114
Avg compression ratio: 1.0
Avg train time: 2.8116363286972046
Std train time: 1.6045984492913106
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.1037, 'hit_ratio@10': 0.9474, 'ndcg@10': 1.02, 'compress@10': 1.0, 'time@10': 2.3445}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.1037, 'hit_ratio@10': 0.9474, 'ndcg@10': 1.02, 'compress@10': 1.0, 'time@10': 2.3445}:  10%|█         | 1/10 [00:01<00:10,  1.20s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0598, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9822, 'compress@10': 1.0, 'time@10': 2.1614}:  10%|█         | 1/10 [00:03<00:10,  1.20s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0598, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9822, 'compress@10': 1.0, 'time@10': 2.1614}:  20%|██        | 2/10 [00:03<00:13,  1.67s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0422, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9405, 'compress@10': 1.0, 'time@10': 1.665}:  20%|██        | 2/10 [00:03<00:13,  1.67s/it]  {'epoch': 10, 'num_users': 5.0, 'loss': 0.0422, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9405, 'compress@10': 1.0, 'time@10': 1.665}:  30%|███       | 3/10 [00:03<00:07,  1.08s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.945, 'compress@10': 1.0, 'time@10': 1.6609}:  30%|███       | 3/10 [00:05<00:07,  1.08s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.945, 'compress@10': 1.0, 'time@10': 1.6609}:  40%|████      | 4/10 [00:05<00:07,  1.31s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0582, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9668, 'compress@10': 1.0, 'time@10': 2.6052}:  40%|████      | 4/10 [00:08<00:07,  1.31s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0582, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9668, 'compress@10': 1.0, 'time@10': 2.6052}:  50%|█████     | 5/10 [00:08<00:10,  2.00s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0759, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9869, 'compress@10': 1.0, 'time@10': 2.6198}:  50%|█████     | 5/10 [00:11<00:10,  2.00s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0759, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9869, 'compress@10': 1.0, 'time@10': 2.6198}:  60%|██████    | 6/10 [00:11<00:08,  2.25s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0675, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9785, 'compress@10': 1.0, 'time@10': 2.666}:  60%|██████    | 6/10 [00:12<00:08,  2.25s/it] {'epoch': 10, 'num_users': 6.2857, 'loss': 0.0675, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9785, 'compress@10': 1.0, 'time@10': 2.666}:  70%|███████   | 7/10 [00:12<00:06,  2.00s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0636, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9723, 'compress@10': 1.0, 'time@10': 2.5908}:  70%|███████   | 7/10 [00:14<00:06,  2.00s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0636, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9723, 'compress@10': 1.0, 'time@10': 2.5908}:  80%|████████  | 8/10 [00:14<00:04,  2.03s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0585, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9707, 'compress@10': 1.0, 'time@10': 2.7672}:  80%|████████  | 8/10 [00:16<00:04,  2.03s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0585, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9707, 'compress@10': 1.0, 'time@10': 2.7672}:  90%|█████████ | 9/10 [00:16<00:02,  2.06s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.079, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9689, 'compress@10': 1.0, 'time@10': 2.7459}:  90%|█████████ | 9/10 [00:19<00:02,  2.06s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.079, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9689, 'compress@10': 1.0, 'time@10': 2.7459}: 100%|██████████| 10/10 [00:19<00:00,  2.22s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.079, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9689, 'compress@10': 1.0, 'time@10': 2.7459}: 100%|██████████| 10/10 [00:19<00:00,  1.95s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.0789554929863193
Avg hit ratio: 0.8879237806147824
Avg ndcg: 0.9689022721847254
Avg compression ratio: 1.0
Avg train time: 2.7458641290664674
Std train time: 1.4858454223381126
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 1.6153, 'hit_ratio@10': 0.6842, 'ndcg@10': 2.9398, 'compress@10': 1.0, 'time@10': 2.2017}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 1.6153, 'hit_ratio@10': 0.6842, 'ndcg@10': 2.9398, 'compress@10': 1.0, 'time@10': 2.2017}:  10%|█         | 1/10 [00:01<00:10,  1.13s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.8343, 'hit_ratio@10': 0.7615, 'ndcg@10': 1.8878, 'compress@10': 1.0, 'time@10': 2.0455}:  10%|█         | 1/10 [00:03<00:10,  1.13s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.8343, 'hit_ratio@10': 0.7615, 'ndcg@10': 1.8878, 'compress@10': 1.0, 'time@10': 2.0455}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.5577, 'hit_ratio@10': 0.7457, 'ndcg@10': 1.5442, 'compress@10': 1.0, 'time@10': 1.5897}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.5577, 'hit_ratio@10': 0.7457, 'ndcg@10': 1.5442, 'compress@10': 1.0, 'time@10': 1.5897}:  30%|███       | 3/10 [00:03<00:07,  1.03s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.432, 'hit_ratio@10': 0.7736, 'ndcg@10': 1.3705, 'compress@10': 1.0, 'time@10': 1.5954}:  30%|███       | 3/10 [00:05<00:07,  1.03s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.432, 'hit_ratio@10': 0.7736, 'ndcg@10': 1.3705, 'compress@10': 1.0, 'time@10': 1.5954}:  40%|████      | 4/10 [00:05<00:07,  1.28s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.391, 'hit_ratio@10': 0.8109, 'ndcg@10': 1.3257, 'compress@10': 1.0, 'time@10': 2.4782}:  40%|████      | 4/10 [00:08<00:07,  1.28s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.391, 'hit_ratio@10': 0.8109, 'ndcg@10': 1.3257, 'compress@10': 1.0, 'time@10': 2.4782}:  50%|█████     | 5/10 [00:08<00:09,  1.91s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.3305, 'hit_ratio@10': 0.8313, 'ndcg@10': 1.26, 'compress@10': 1.0, 'time@10': 2.5125}:  50%|█████     | 5/10 [00:10<00:09,  1.91s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.3305, 'hit_ratio@10': 0.8313, 'ndcg@10': 1.26, 'compress@10': 1.0, 'time@10': 2.5125}:  60%|██████    | 6/10 [00:10<00:08,  2.18s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.2859, 'hit_ratio@10': 0.844, 'ndcg@10': 1.2128, 'compress@10': 1.0, 'time@10': 2.5741}:  60%|██████    | 6/10 [00:12<00:08,  2.18s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.2859, 'hit_ratio@10': 0.844, 'ndcg@10': 1.2128, 'compress@10': 1.0, 'time@10': 2.5741}:  70%|███████   | 7/10 [00:12<00:05,  1.96s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.2668, 'hit_ratio@10': 0.8563, 'ndcg@10': 1.1629, 'compress@10': 1.0, 'time@10': 2.4948}:  70%|███████   | 7/10 [00:14<00:05,  1.96s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.2668, 'hit_ratio@10': 0.8563, 'ndcg@10': 1.1629, 'compress@10': 1.0, 'time@10': 2.4948}:  80%|████████  | 8/10 [00:14<00:03,  1.96s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.2452, 'hit_ratio@10': 0.8532, 'ndcg@10': 1.1306, 'compress@10': 1.0, 'time@10': 2.6583}:  80%|████████  | 8/10 [00:16<00:03,  1.96s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.2452, 'hit_ratio@10': 0.8532, 'ndcg@10': 1.1306, 'compress@10': 1.0, 'time@10': 2.6583}:  90%|█████████ | 9/10 [00:16<00:01,  1.98s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.2333, 'hit_ratio@10': 0.8634, 'ndcg@10': 1.1273, 'compress@10': 1.0, 'time@10': 2.6709}:  90%|█████████ | 9/10 [00:19<00:01,  1.98s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.2333, 'hit_ratio@10': 0.8634, 'ndcg@10': 1.1273, 'compress@10': 1.0, 'time@10': 2.6709}: 100%|██████████| 10/10 [00:19<00:00,  2.24s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.2333, 'hit_ratio@10': 0.8634, 'ndcg@10': 1.1273, 'compress@10': 1.0, 'time@10': 2.6709}: 100%|██████████| 10/10 [00:19<00:00,  1.91s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.233292460820315
Avg hit ratio: 0.8633656134471075
Avg ndcg: 1.1273133846975378
Avg compression ratio: 1.0
Avg train time: 2.670929789543152
Std train time: 1.3917102222664568
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 3.6093, 'hit_ratio@10': 0.4737, 'ndcg@10': 5.4495, 'compress@10': 1.0, 'time@10': 2.32}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 3.6093, 'hit_ratio@10': 0.4737, 'ndcg@10': 5.4495, 'compress@10': 1.0, 'time@10': 2.32}:  10%|█         | 1/10 [00:01<00:10,  1.21s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 2.2717, 'hit_ratio@10': 0.5433, 'ndcg@10': 3.4933, 'compress@10': 1.0, 'time@10': 2.1015}:  10%|█         | 1/10 [00:03<00:10,  1.21s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 2.2717, 'hit_ratio@10': 0.5433, 'ndcg@10': 3.4933, 'compress@10': 1.0, 'time@10': 2.1015}:  20%|██        | 2/10 [00:03<00:12,  1.62s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 1.5177, 'hit_ratio@10': 0.5527, 'ndcg@10': 2.6146, 'compress@10': 1.0, 'time@10': 1.6137}:  20%|██        | 2/10 [00:03<00:12,  1.62s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 1.5177, 'hit_ratio@10': 0.5527, 'ndcg@10': 2.6146, 'compress@10': 1.0, 'time@10': 1.6137}:  30%|███       | 3/10 [00:03<00:07,  1.04s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 1.3084, 'hit_ratio@10': 0.5931, 'ndcg@10': 2.239, 'compress@10': 1.0, 'time@10': 1.6171}:  30%|███       | 3/10 [00:05<00:07,  1.04s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 1.3084, 'hit_ratio@10': 0.5931, 'ndcg@10': 2.239, 'compress@10': 1.0, 'time@10': 1.6171}:  40%|████      | 4/10 [00:05<00:07,  1.28s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 1.0677, 'hit_ratio@10': 0.6665, 'ndcg@10': 1.9951, 'compress@10': 1.0, 'time@10': 2.5548}:  40%|████      | 4/10 [00:08<00:07,  1.28s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 1.0677, 'hit_ratio@10': 0.6665, 'ndcg@10': 1.9951, 'compress@10': 1.0, 'time@10': 2.5548}:  50%|█████     | 5/10 [00:08<00:09,  1.97s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.9192, 'hit_ratio@10': 0.7072, 'ndcg@10': 1.8248, 'compress@10': 1.0, 'time@10': 2.6264}:  50%|█████     | 5/10 [00:11<00:09,  1.97s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.9192, 'hit_ratio@10': 0.7072, 'ndcg@10': 1.8248, 'compress@10': 1.0, 'time@10': 2.6264}:  60%|██████    | 6/10 [00:11<00:09,  2.32s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.9605, 'hit_ratio@10': 0.6976, 'ndcg@10': 1.8694, 'compress@10': 1.0, 'time@10': 2.6475}:  60%|██████    | 6/10 [00:12<00:09,  2.32s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.9605, 'hit_ratio@10': 0.6976, 'ndcg@10': 1.8694, 'compress@10': 1.0, 'time@10': 2.6475}:  70%|███████   | 7/10 [00:12<00:06,  2.03s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.8466, 'hit_ratio@10': 0.7319, 'ndcg@10': 1.7637, 'compress@10': 1.0, 'time@10': 2.578}:  70%|███████   | 7/10 [00:14<00:06,  2.03s/it]  {'epoch': 12, 'num_users': 6.125, 'loss': 0.8466, 'hit_ratio@10': 0.7319, 'ndcg@10': 1.7637, 'compress@10': 1.0, 'time@10': 2.578}:  80%|████████  | 8/10 [00:14<00:04,  2.06s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.7554, 'hit_ratio@10': 0.7363, 'ndcg@10': 1.6756, 'compress@10': 1.0, 'time@10': 2.7686}:  80%|████████  | 8/10 [00:17<00:04,  2.06s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.7554, 'hit_ratio@10': 0.7363, 'ndcg@10': 1.6756, 'compress@10': 1.0, 'time@10': 2.7686}:  90%|█████████ | 9/10 [00:17<00:02,  2.09s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.684, 'hit_ratio@10': 0.7581, 'ndcg@10': 1.5949, 'compress@10': 1.0, 'time@10': 2.7987}:  90%|█████████ | 9/10 [00:20<00:02,  2.09s/it]    {'epoch': 12, 'num_users': 6.3, 'loss': 0.684, 'hit_ratio@10': 0.7581, 'ndcg@10': 1.5949, 'compress@10': 1.0, 'time@10': 2.7987}: 100%|██████████| 10/10 [00:20<00:00,  2.40s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.684, 'hit_ratio@10': 0.7581, 'ndcg@10': 1.5949, 'compress@10': 1.0, 'time@10': 2.7987}: 100%|██████████| 10/10 [00:20<00:00,  2.01s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.6840470574323244
Avg hit ratio: 0.7580815430560761
Avg ndcg: 1.594851757180975
Avg compression ratio: 1.0
Avg train time: 2.7987473487854
Std train time: 1.4915867951807185
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.3048, 'hit_ratio@10': 0.8947, 'ndcg@10': 1.2464, 'compress@10': 1.0, 'time@10': 2.2757}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.3048, 'hit_ratio@10': 0.8947, 'ndcg@10': 1.2464, 'compress@10': 1.0, 'time@10': 2.2757}:  10%|█         | 1/10 [00:01<00:10,  1.17s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.2486, 'hit_ratio@10': 0.8183, 'ndcg@10': 1.1758, 'compress@10': 1.0, 'time@10': 2.1708}:  10%|█         | 1/10 [00:03<00:10,  1.17s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.2486, 'hit_ratio@10': 0.8183, 'ndcg@10': 1.1758, 'compress@10': 1.0, 'time@10': 2.1708}:  20%|██        | 2/10 [00:03<00:13,  1.71s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.1695, 'hit_ratio@10': 0.7837, 'ndcg@10': 1.0632, 'compress@10': 1.0, 'time@10': 1.6784}:  20%|██        | 2/10 [00:03<00:13,  1.71s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.1695, 'hit_ratio@10': 0.7837, 'ndcg@10': 1.0632, 'compress@10': 1.0, 'time@10': 1.6784}:  30%|███       | 3/10 [00:03<00:07,  1.10s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.4293, 'hit_ratio@10': 0.7752, 'ndcg@10': 1.5118, 'compress@10': 1.0, 'time@10': 1.6773}:  30%|███       | 3/10 [00:05<00:07,  1.10s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.4293, 'hit_ratio@10': 0.7752, 'ndcg@10': 1.5118, 'compress@10': 1.0, 'time@10': 1.6773}:  40%|████      | 4/10 [00:05<00:08,  1.34s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.4533, 'hit_ratio@10': 0.8042, 'ndcg@10': 1.4379, 'compress@10': 1.0, 'time@10': 2.6393}:  40%|████      | 4/10 [00:08<00:08,  1.34s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.4533, 'hit_ratio@10': 0.8042, 'ndcg@10': 1.4379, 'compress@10': 1.0, 'time@10': 2.6393}:  50%|█████     | 5/10 [00:08<00:10,  2.04s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.385, 'hit_ratio@10': 0.8146, 'ndcg@10': 1.3533, 'compress@10': 1.0, 'time@10': 2.6473}:  50%|█████     | 5/10 [00:11<00:10,  2.04s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.385, 'hit_ratio@10': 0.8146, 'ndcg@10': 1.3533, 'compress@10': 1.0, 'time@10': 2.6473}:  60%|██████    | 6/10 [00:11<00:09,  2.27s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.6881, 'hit_ratio@10': 0.7782, 'ndcg@10': 1.651, 'compress@10': 1.0, 'time@10': 2.6663}:  60%|██████    | 6/10 [00:12<00:09,  2.27s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.6881, 'hit_ratio@10': 0.7782, 'ndcg@10': 1.651, 'compress@10': 1.0, 'time@10': 2.6663}:  70%|███████   | 7/10 [00:12<00:05,  1.99s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.611, 'hit_ratio@10': 0.7988, 'ndcg@10': 1.5437, 'compress@10': 1.0, 'time@10': 2.591}:  70%|███████   | 7/10 [00:14<00:05,  1.99s/it]  {'epoch': 13, 'num_users': 6.125, 'loss': 0.611, 'hit_ratio@10': 0.7988, 'ndcg@10': 1.5437, 'compress@10': 1.0, 'time@10': 2.591}:  80%|████████  | 8/10 [00:14<00:04,  2.02s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.5568, 'hit_ratio@10': 0.7831, 'ndcg@10': 1.4625, 'compress@10': 1.0, 'time@10': 2.7664}:  80%|████████  | 8/10 [00:16<00:04,  2.02s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.5568, 'hit_ratio@10': 0.7831, 'ndcg@10': 1.4625, 'compress@10': 1.0, 'time@10': 2.7664}:  90%|█████████ | 9/10 [00:16<00:02,  2.05s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.5092, 'hit_ratio@10': 0.7957, 'ndcg@10': 1.4029, 'compress@10': 1.0, 'time@10': 2.7593}:  90%|█████████ | 9/10 [00:19<00:02,  2.05s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.5092, 'hit_ratio@10': 0.7957, 'ndcg@10': 1.4029, 'compress@10': 1.0, 'time@10': 2.7593}: 100%|██████████| 10/10 [00:19<00:00,  2.26s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.5092, 'hit_ratio@10': 0.7957, 'ndcg@10': 1.4029, 'compress@10': 1.0, 'time@10': 2.7593}: 100%|██████████| 10/10 [00:19<00:00,  1.97s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.5092470660003345
Avg hit ratio: 0.7956715616019522
Avg ndcg: 1.4028662189441854
Avg compression ratio: 1.0
Avg train time: 2.759272313117981
Std train time: 1.5013393717351564
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 1.4904, 'hit_ratio@10': 0.2105, 'ndcg@10': 1.1818, 'compress@10': 1.0, 'time@10': 2.0706}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 1.4904, 'hit_ratio@10': 0.2105, 'ndcg@10': 1.1818, 'compress@10': 1.0, 'time@10': 2.0706}:  10%|█         | 1/10 [00:01<00:09,  1.06s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 1.1112, 'hit_ratio@10': 0.3633, 'ndcg@10': 1.2557, 'compress@10': 1.0, 'time@10': 1.9238}:  10%|█         | 1/10 [00:02<00:09,  1.06s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 1.1112, 'hit_ratio@10': 0.3633, 'ndcg@10': 1.2557, 'compress@10': 1.0, 'time@10': 1.9238}:  20%|██        | 2/10 [00:02<00:11,  1.50s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.831, 'hit_ratio@10': 0.4803, 'ndcg@10': 1.2381, 'compress@10': 1.0, 'time@10': 1.5122}:  20%|██        | 2/10 [00:03<00:11,  1.50s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.831, 'hit_ratio@10': 0.4803, 'ndcg@10': 1.2381, 'compress@10': 1.0, 'time@10': 1.5122}:  30%|███       | 3/10 [00:03<00:06,  1.02it/s]{'epoch': 14, 'num_users': 5.0, 'loss': 0.6469, 'hit_ratio@10': 0.5567, 'ndcg@10': 1.1148, 'compress@10': 1.0, 'time@10': 1.5392}:  30%|███       | 3/10 [00:04<00:06,  1.02it/s]{'epoch': 14, 'num_users': 5.0, 'loss': 0.6469, 'hit_ratio@10': 0.5567, 'ndcg@10': 1.1148, 'compress@10': 1.0, 'time@10': 1.5392}:  40%|████      | 4/10 [00:04<00:07,  1.25s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.6084, 'hit_ratio@10': 0.6213, 'ndcg@10': 1.1299, 'compress@10': 1.0, 'time@10': 2.4439}:  40%|████      | 4/10 [00:07<00:07,  1.25s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.6084, 'hit_ratio@10': 0.6213, 'ndcg@10': 1.1299, 'compress@10': 1.0, 'time@10': 2.4439}:  50%|█████     | 5/10 [00:07<00:09,  1.90s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.564, 'hit_ratio@10': 0.6622, 'ndcg@10': 1.1348, 'compress@10': 1.0, 'time@10': 2.4879}:  50%|█████     | 5/10 [00:10<00:09,  1.90s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.564, 'hit_ratio@10': 0.6622, 'ndcg@10': 1.1348, 'compress@10': 1.0, 'time@10': 2.4879}:  60%|██████    | 6/10 [00:10<00:08,  2.18s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.5952, 'hit_ratio@10': 0.6876, 'ndcg@10': 1.2441, 'compress@10': 1.0, 'time@10': 2.5402}:  60%|██████    | 6/10 [00:12<00:08,  2.18s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.5952, 'hit_ratio@10': 0.6876, 'ndcg@10': 1.2441, 'compress@10': 1.0, 'time@10': 2.5402}:  70%|███████   | 7/10 [00:12<00:05,  1.95s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.5627, 'hit_ratio@10': 0.716, 'ndcg@10': 1.2138, 'compress@10': 1.0, 'time@10': 2.4805}:  70%|███████   | 7/10 [00:14<00:05,  1.95s/it]  {'epoch': 14, 'num_users': 6.125, 'loss': 0.5627, 'hit_ratio@10': 0.716, 'ndcg@10': 1.2138, 'compress@10': 1.0, 'time@10': 2.4805}:  80%|████████  | 8/10 [00:14<00:03,  1.99s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.512, 'hit_ratio@10': 0.7158, 'ndcg@10': 1.1853, 'compress@10': 1.0, 'time@10': 2.6645}:  80%|████████  | 8/10 [00:16<00:03,  1.99s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.512, 'hit_ratio@10': 0.7158, 'ndcg@10': 1.1853, 'compress@10': 1.0, 'time@10': 2.6645}:  90%|█████████ | 9/10 [00:16<00:02,  2.03s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.4709, 'hit_ratio@10': 0.726, 'ndcg@10': 1.1525, 'compress@10': 1.0, 'time@10': 2.6566}:  90%|█████████ | 9/10 [00:18<00:02,  2.03s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.4709, 'hit_ratio@10': 0.726, 'ndcg@10': 1.1525, 'compress@10': 1.0, 'time@10': 2.6566}: 100%|██████████| 10/10 [00:18<00:00,  2.21s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.4709, 'hit_ratio@10': 0.726, 'ndcg@10': 1.1525, 'compress@10': 1.0, 'time@10': 2.6566}: 100%|██████████| 10/10 [00:18<00:00,  1.89s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.4709473427187998
Avg hit ratio: 0.7260075261467451
Avg ndcg: 1.152454674553423
Avg compression ratio: 1.0
Avg train time: 2.6566225051879884
Std train time: 1.423145784377272
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 6.8806, 'hit_ratio@10': 0.4737, 'ndcg@10': 46.6909, 'compress@10': 1.0, 'time@10': 2.1812}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 6.8806, 'hit_ratio@10': 0.4737, 'ndcg@10': 46.6909, 'compress@10': 1.0, 'time@10': 2.1812}:  10%|█         | 1/10 [00:01<00:10,  1.12s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 3.5123, 'hit_ratio@10': 0.6078, 'ndcg@10': 23.8048, 'compress@10': 1.0, 'time@10': 2.0057}:  10%|█         | 1/10 [00:02<00:10,  1.12s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 3.5123, 'hit_ratio@10': 0.6078, 'ndcg@10': 23.8048, 'compress@10': 1.0, 'time@10': 2.0057}:  20%|██        | 2/10 [00:02<00:12,  1.55s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 2.8081, 'hit_ratio@10': 0.4528, 'ndcg@10': 16.5362, 'compress@10': 1.0, 'time@10': 1.5604}:  20%|██        | 2/10 [00:03<00:12,  1.55s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 2.8081, 'hit_ratio@10': 0.4528, 'ndcg@10': 16.5362, 'compress@10': 1.0, 'time@10': 1.5604}:  30%|███       | 3/10 [00:03<00:07,  1.01s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 2.1552, 'hit_ratio@10': 0.536, 'ndcg@10': 12.6385, 'compress@10': 1.0, 'time@10': 1.5703}:  30%|███       | 3/10 [00:04<00:07,  1.01s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 2.1552, 'hit_ratio@10': 0.536, 'ndcg@10': 12.6385, 'compress@10': 1.0, 'time@10': 1.5703}:  40%|████      | 4/10 [00:04<00:07,  1.25s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 1.7878, 'hit_ratio@10': 0.5808, 'ndcg@10': 10.2716, 'compress@10': 1.0, 'time@10': 2.4431}:  40%|████      | 4/10 [00:07<00:07,  1.25s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 1.7878, 'hit_ratio@10': 0.5808, 'ndcg@10': 10.2716, 'compress@10': 1.0, 'time@10': 2.4431}:  50%|█████     | 5/10 [00:07<00:09,  1.88s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 1.5628, 'hit_ratio@10': 0.6211, 'ndcg@10': 8.7453, 'compress@10': 1.0, 'time@10': 2.5004}:  50%|█████     | 5/10 [00:10<00:09,  1.88s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 1.5628, 'hit_ratio@10': 0.6211, 'ndcg@10': 8.7453, 'compress@10': 1.0, 'time@10': 2.5004}:  60%|██████    | 6/10 [00:10<00:08,  2.20s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 1.5827, 'hit_ratio@10': 0.6123, 'ndcg@10': 7.7056, 'compress@10': 1.0, 'time@10': 2.5703}:  60%|██████    | 6/10 [00:12<00:08,  2.20s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 1.5827, 'hit_ratio@10': 0.6123, 'ndcg@10': 7.7056, 'compress@10': 1.0, 'time@10': 2.5703}:  70%|███████   | 7/10 [00:12<00:05,  1.98s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 1.4243, 'hit_ratio@10': 0.6465, 'ndcg@10': 6.8784, 'compress@10': 1.0, 'time@10': 2.5022}:  70%|███████   | 7/10 [00:14<00:05,  1.98s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 1.4243, 'hit_ratio@10': 0.6465, 'ndcg@10': 6.8784, 'compress@10': 1.0, 'time@10': 2.5022}:  80%|████████  | 8/10 [00:14<00:04,  2.00s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 1.3205, 'hit_ratio@10': 0.6572, 'ndcg@10': 6.2609, 'compress@10': 1.0, 'time@10': 2.6872}:  80%|████████  | 8/10 [00:16<00:04,  2.00s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 1.3205, 'hit_ratio@10': 0.6572, 'ndcg@10': 6.2609, 'compress@10': 1.0, 'time@10': 2.6872}:  90%|█████████ | 9/10 [00:16<00:02,  2.04s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 1.2838, 'hit_ratio@10': 0.671, 'ndcg@10': 5.8119, 'compress@10': 1.0, 'time@10': 2.6803}:  90%|█████████ | 9/10 [00:19<00:02,  2.04s/it]    {'epoch': 15, 'num_users': 6.3, 'loss': 1.2838, 'hit_ratio@10': 0.671, 'ndcg@10': 5.8119, 'compress@10': 1.0, 'time@10': 2.6803}: 100%|██████████| 10/10 [00:19<00:00,  2.22s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 1.2838, 'hit_ratio@10': 0.671, 'ndcg@10': 5.8119, 'compress@10': 1.0, 'time@10': 2.6803}: 100%|██████████| 10/10 [00:19<00:00,  1.91s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 1.2838414483561
Avg hit ratio: 0.6710439319216908
Avg ndcg: 5.811906752320693
Avg compression ratio: 1.0
Avg train time: 2.680316686630249
Std train time: 1.3972793156623546
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 1.4162, 'hit_ratio@10': 0.4211, 'ndcg@10': 1.0357, 'compress@10': 1.0, 'time@10': 2.222}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 1.4162, 'hit_ratio@10': 0.4211, 'ndcg@10': 1.0357, 'compress@10': 1.0, 'time@10': 2.222}:  10%|█         | 1/10 [00:01<00:10,  1.14s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 1.0343, 'hit_ratio@10': 0.4363, 'ndcg@10': 1.1257, 'compress@10': 1.0, 'time@10': 2.0336}:  10%|█         | 1/10 [00:03<00:10,  1.14s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 1.0343, 'hit_ratio@10': 0.4363, 'ndcg@10': 1.1257, 'compress@10': 1.0, 'time@10': 2.0336}:  20%|██        | 2/10 [00:03<00:12,  1.58s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.7132, 'hit_ratio@10': 0.4814, 'ndcg@10': 0.9604, 'compress@10': 1.0, 'time@10': 1.5842}:  20%|██        | 2/10 [00:03<00:12,  1.58s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.7132, 'hit_ratio@10': 0.4814, 'ndcg@10': 0.9604, 'compress@10': 1.0, 'time@10': 1.5842}:  30%|███       | 3/10 [00:03<00:07,  1.03s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.661, 'hit_ratio@10': 0.5128, 'ndcg@10': 0.958, 'compress@10': 1.0, 'time@10': 1.5786}:  30%|███       | 3/10 [00:04<00:07,  1.03s/it]  {'epoch': 16, 'num_users': 5.0, 'loss': 0.661, 'hit_ratio@10': 0.5128, 'ndcg@10': 0.958, 'compress@10': 1.0, 'time@10': 1.5786}:  40%|████      | 4/10 [00:04<00:07,  1.25s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.6695, 'hit_ratio@10': 0.5342, 'ndcg@10': 1.0354, 'compress@10': 1.0, 'time@10': 2.4693}:  40%|████      | 4/10 [00:08<00:07,  1.25s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.6695, 'hit_ratio@10': 0.5342, 'ndcg@10': 1.0354, 'compress@10': 1.0, 'time@10': 2.4693}:  50%|█████     | 5/10 [00:08<00:09,  1.90s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.8274, 'hit_ratio@10': 0.5563, 'ndcg@10': 1.2818, 'compress@10': 1.0, 'time@10': 2.5139}:  50%|█████     | 5/10 [00:10<00:09,  1.90s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.8274, 'hit_ratio@10': 0.5563, 'ndcg@10': 1.2818, 'compress@10': 1.0, 'time@10': 2.5139}:  60%|██████    | 6/10 [00:10<00:08,  2.19s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 1.4984, 'hit_ratio@10': 0.5626, 'ndcg@10': 3.3761, 'compress@10': 1.0, 'time@10': 2.5586}:  60%|██████    | 6/10 [00:12<00:08,  2.19s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 1.4984, 'hit_ratio@10': 0.5626, 'ndcg@10': 3.3761, 'compress@10': 1.0, 'time@10': 2.5586}:  70%|███████   | 7/10 [00:12<00:05,  1.95s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 1.3577, 'hit_ratio@10': 0.6065, 'ndcg@10': 3.0586, 'compress@10': 1.0, 'time@10': 2.5028}:  70%|███████   | 7/10 [00:14<00:05,  1.95s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 1.3577, 'hit_ratio@10': 0.6065, 'ndcg@10': 3.0586, 'compress@10': 1.0, 'time@10': 2.5028}:  80%|████████  | 8/10 [00:14<00:04,  2.01s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 1.3997, 'hit_ratio@10': 0.609, 'ndcg@10': 3.0241, 'compress@10': 1.0, 'time@10': 2.7141}:  80%|████████  | 8/10 [00:16<00:04,  2.01s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 1.3997, 'hit_ratio@10': 0.609, 'ndcg@10': 3.0241, 'compress@10': 1.0, 'time@10': 2.7141}:  90%|█████████ | 9/10 [00:16<00:02,  2.08s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 1.5002, 'hit_ratio@10': 0.6049, 'ndcg@10': 3.1391, 'compress@10': 1.0, 'time@10': 2.6968}:  90%|█████████ | 9/10 [00:19<00:02,  2.08s/it]  {'epoch': 16, 'num_users': 6.3, 'loss': 1.5002, 'hit_ratio@10': 0.6049, 'ndcg@10': 3.1391, 'compress@10': 1.0, 'time@10': 2.6968}: 100%|██████████| 10/10 [00:19<00:00,  2.23s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 1.5002, 'hit_ratio@10': 0.6049, 'ndcg@10': 3.1391, 'compress@10': 1.0, 'time@10': 2.6968}: 100%|██████████| 10/10 [00:19<00:00,  1.92s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 1.500174776553991
Avg hit ratio: 0.604894259108181
Avg ndcg: 3.1391396955522484
Avg compression ratio: 1.0
Avg train time: 2.6967704057693482
Std train time: 1.439112785144942
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.3467, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.819, 'compress@10': 1.0, 'time@10': 2.2896}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.3467, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.819, 'compress@10': 1.0, 'time@10': 2.2896}:  10%|█         | 1/10 [00:01<00:10,  1.17s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 2.4099, 'hit_ratio@10': 0.5357, 'ndcg@10': 8.0385, 'compress@10': 1.0, 'time@10': 2.0481}:  10%|█         | 1/10 [00:03<00:10,  1.17s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 2.4099, 'hit_ratio@10': 0.5357, 'ndcg@10': 8.0385, 'compress@10': 1.0, 'time@10': 2.0481}:  20%|██        | 2/10 [00:03<00:12,  1.56s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 3.9369, 'hit_ratio@10': 0.4047, 'ndcg@10': 19.183, 'compress@10': 1.0, 'time@10': 1.5868}:  20%|██        | 2/10 [00:03<00:12,  1.56s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 3.9369, 'hit_ratio@10': 0.4047, 'ndcg@10': 19.183, 'compress@10': 1.0, 'time@10': 1.5868}:  30%|███       | 3/10 [00:03<00:07,  1.01s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 4.2981, 'hit_ratio@10': 0.4732, 'ndcg@10': 18.4028, 'compress@10': 1.0, 'time@10': 1.5906}:  30%|███       | 3/10 [00:04<00:07,  1.01s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 4.2981, 'hit_ratio@10': 0.4732, 'ndcg@10': 18.4028, 'compress@10': 1.0, 'time@10': 1.5906}:  40%|████      | 4/10 [00:04<00:07,  1.26s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 3.5442, 'hit_ratio@10': 0.4905, 'ndcg@10': 14.8596, 'compress@10': 1.0, 'time@10': 2.4685}:  40%|████      | 4/10 [00:08<00:07,  1.26s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 3.5442, 'hit_ratio@10': 0.4905, 'ndcg@10': 14.8596, 'compress@10': 1.0, 'time@10': 2.4685}:  50%|█████     | 5/10 [00:08<00:09,  1.89s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 3.0907, 'hit_ratio@10': 0.5014, 'ndcg@10': 12.5858, 'compress@10': 1.0, 'time@10': 2.528}:  50%|█████     | 5/10 [00:10<00:09,  1.89s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 3.0907, 'hit_ratio@10': 0.5014, 'ndcg@10': 12.5858, 'compress@10': 1.0, 'time@10': 2.528}:  60%|██████    | 6/10 [00:10<00:08,  2.22s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 2.6948, 'hit_ratio@10': 0.4983, 'ndcg@10': 10.875, 'compress@10': 1.0, 'time@10': 2.6199}:  60%|██████    | 6/10 [00:12<00:08,  2.22s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 2.6948, 'hit_ratio@10': 0.4983, 'ndcg@10': 10.875, 'compress@10': 1.0, 'time@10': 2.6199}:  70%|███████   | 7/10 [00:12<00:06,  2.02s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 2.4009, 'hit_ratio@10': 0.536, 'ndcg@10': 9.5887, 'compress@10': 1.0, 'time@10': 2.5383}:  70%|███████   | 7/10 [00:14<00:06,  2.02s/it]  {'epoch': 17, 'num_users': 6.125, 'loss': 2.4009, 'hit_ratio@10': 0.536, 'ndcg@10': 9.5887, 'compress@10': 1.0, 'time@10': 2.5383}:  80%|████████  | 8/10 [00:14<00:04,  2.01s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 2.1912, 'hit_ratio@10': 0.5336, 'ndcg@10': 8.6499, 'compress@10': 1.0, 'time@10': 2.7214}:  80%|████████  | 8/10 [00:16<00:04,  2.01s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 2.1912, 'hit_ratio@10': 0.5336, 'ndcg@10': 8.6499, 'compress@10': 1.0, 'time@10': 2.7214}:  90%|█████████ | 9/10 [00:16<00:02,  2.05s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 2.0804, 'hit_ratio@10': 0.5621, 'ndcg@10': 7.9471, 'compress@10': 1.0, 'time@10': 2.6956}:  90%|█████████ | 9/10 [00:19<00:02,  2.05s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 2.0804, 'hit_ratio@10': 0.5621, 'ndcg@10': 7.9471, 'compress@10': 1.0, 'time@10': 2.6956}: 100%|██████████| 10/10 [00:19<00:00,  2.18s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 2.0804, 'hit_ratio@10': 0.5621, 'ndcg@10': 7.9471, 'compress@10': 1.0, 'time@10': 2.6956}: 100%|██████████| 10/10 [00:19<00:00,  1.91s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 2.0804316133144143
Avg hit ratio: 0.5620758959960998
Avg ndcg: 7.94709808077351
Avg compression ratio: 1.0
Avg train time: 2.6955931425094604
Std train time: 1.4183287110502631
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.2478, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.5033, 'compress@10': 1.0, 'time@10': 2.1867}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.2478, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.5033, 'compress@10': 1.0, 'time@10': 2.1867}:  10%|█         | 1/10 [00:01<00:10,  1.12s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.3559, 'hit_ratio@10': 0.4626, 'ndcg@10': 0.661, 'compress@10': 1.0, 'time@10': 2.0178}:  10%|█         | 1/10 [00:02<00:10,  1.12s/it] {'epoch': 18, 'num_users': 7.0, 'loss': 0.3559, 'hit_ratio@10': 0.4626, 'ndcg@10': 0.661, 'compress@10': 1.0, 'time@10': 2.0178}:  20%|██        | 2/10 [00:02<00:12,  1.57s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.3102, 'hit_ratio@10': 0.3561, 'ndcg@10': 0.6013, 'compress@10': 1.0, 'time@10': 1.5702}:  20%|██        | 2/10 [00:03<00:12,  1.57s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.3102, 'hit_ratio@10': 0.3561, 'ndcg@10': 0.6013, 'compress@10': 1.0, 'time@10': 1.5702}:  30%|███       | 3/10 [00:03<00:07,  1.02s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.4267, 'hit_ratio@10': 0.3831, 'ndcg@10': 0.7571, 'compress@10': 1.0, 'time@10': 1.5657}:  30%|███       | 3/10 [00:04<00:07,  1.02s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.4267, 'hit_ratio@10': 0.3831, 'ndcg@10': 0.7571, 'compress@10': 1.0, 'time@10': 1.5657}:  40%|████      | 4/10 [00:04<00:07,  1.24s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.4182, 'hit_ratio@10': 0.3985, 'ndcg@10': 0.7167, 'compress@10': 1.0, 'time@10': 2.4537}:  40%|████      | 4/10 [00:07<00:07,  1.24s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.4182, 'hit_ratio@10': 0.3985, 'ndcg@10': 0.7167, 'compress@10': 1.0, 'time@10': 2.4537}:  50%|█████     | 5/10 [00:07<00:09,  1.88s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.3876, 'hit_ratio@10': 0.4024, 'ndcg@10': 0.6828, 'compress@10': 1.0, 'time@10': 2.4923}:  50%|█████     | 5/10 [00:10<00:09,  1.88s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.3876, 'hit_ratio@10': 0.4024, 'ndcg@10': 0.6828, 'compress@10': 1.0, 'time@10': 2.4923}:  60%|██████    | 6/10 [00:10<00:08,  2.17s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.3686, 'hit_ratio@10': 0.425, 'ndcg@10': 0.6665, 'compress@10': 1.0, 'time@10': 2.5841}:  60%|██████    | 6/10 [00:12<00:08,  2.17s/it] {'epoch': 18, 'num_users': 6.2857, 'loss': 0.3686, 'hit_ratio@10': 0.425, 'ndcg@10': 0.6665, 'compress@10': 1.0, 'time@10': 2.5841}:  70%|███████   | 7/10 [00:12<00:05,  1.98s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.3562, 'hit_ratio@10': 0.4504, 'ndcg@10': 0.6524, 'compress@10': 1.0, 'time@10': 2.5268}:  70%|███████   | 7/10 [00:14<00:05,  1.98s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.3562, 'hit_ratio@10': 0.4504, 'ndcg@10': 0.6524, 'compress@10': 1.0, 'time@10': 2.5268}:  80%|████████  | 8/10 [00:14<00:04,  2.04s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.3577, 'hit_ratio@10': 0.4385, 'ndcg@10': 0.6446, 'compress@10': 1.0, 'time@10': 2.704}:  80%|████████  | 8/10 [00:16<00:04,  2.04s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.3577, 'hit_ratio@10': 0.4385, 'ndcg@10': 0.6446, 'compress@10': 1.0, 'time@10': 2.704}:  90%|█████████ | 9/10 [00:16<00:02,  2.05s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.3501, 'hit_ratio@10': 0.4378, 'ndcg@10': 0.6327, 'compress@10': 1.0, 'time@10': 2.7085}:  90%|█████████ | 9/10 [00:19<00:02,  2.05s/it]  {'epoch': 18, 'num_users': 6.3, 'loss': 0.3501, 'hit_ratio@10': 0.4378, 'ndcg@10': 0.6327, 'compress@10': 1.0, 'time@10': 2.7085}: 100%|██████████| 10/10 [00:19<00:00,  2.28s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.3501, 'hit_ratio@10': 0.4378, 'ndcg@10': 0.6327, 'compress@10': 1.0, 'time@10': 2.7085}: 100%|██████████| 10/10 [00:19<00:00,  1.93s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.350075939057334
Avg hit ratio: 0.4377908946363956
Avg ndcg: 0.6326545641071879
Avg compression ratio: 1.0
Avg train time: 2.708520698547363
Std train time: 1.4097783004835507
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.3327, 'hit_ratio@10': 0.4211, 'ndcg@10': 0.4797, 'compress@10': 1.0, 'time@10': 2.2632}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.3327, 'hit_ratio@10': 0.4211, 'ndcg@10': 0.4797, 'compress@10': 1.0, 'time@10': 2.2632}:  10%|█         | 1/10 [00:01<00:10,  1.16s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.3232, 'hit_ratio@10': 0.3396, 'ndcg@10': 0.4885, 'compress@10': 1.0, 'time@10': 2.0919}:  10%|█         | 1/10 [00:03<00:10,  1.16s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.3232, 'hit_ratio@10': 0.3396, 'ndcg@10': 0.4885, 'compress@10': 1.0, 'time@10': 2.0919}:  20%|██        | 2/10 [00:03<00:12,  1.62s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.4191, 'hit_ratio@10': 0.3216, 'ndcg@10': 0.5051, 'compress@10': 1.0, 'time@10': 1.6019}:  20%|██        | 2/10 [00:03<00:12,  1.62s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.4191, 'hit_ratio@10': 0.3216, 'ndcg@10': 0.5051, 'compress@10': 1.0, 'time@10': 1.6019}:  30%|███       | 3/10 [00:03<00:07,  1.04s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.4408, 'hit_ratio@10': 0.2859, 'ndcg@10': 0.5247, 'compress@10': 1.0, 'time@10': 1.616}:  30%|███       | 3/10 [00:05<00:07,  1.04s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.4408, 'hit_ratio@10': 0.2859, 'ndcg@10': 0.5247, 'compress@10': 1.0, 'time@10': 1.616}:  40%|████      | 4/10 [00:05<00:07,  1.30s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.4118, 'hit_ratio@10': 0.3127, 'ndcg@10': 0.5118, 'compress@10': 1.0, 'time@10': 2.4948}:  40%|████      | 4/10 [00:08<00:07,  1.30s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.4118, 'hit_ratio@10': 0.3127, 'ndcg@10': 0.5118, 'compress@10': 1.0, 'time@10': 2.4948}:  50%|█████     | 5/10 [00:08<00:09,  1.92s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.384, 'hit_ratio@10': 0.3235, 'ndcg@10': 0.5115, 'compress@10': 1.0, 'time@10': 2.5242}:  50%|█████     | 5/10 [00:10<00:09,  1.92s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.384, 'hit_ratio@10': 0.3235, 'ndcg@10': 0.5115, 'compress@10': 1.0, 'time@10': 2.5242}:  60%|██████    | 6/10 [00:10<00:08,  2.19s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.3792, 'hit_ratio@10': 0.323, 'ndcg@10': 0.5093, 'compress@10': 1.0, 'time@10': 2.5809}:  60%|██████    | 6/10 [00:12<00:08,  2.19s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.3792, 'hit_ratio@10': 0.323, 'ndcg@10': 0.5093, 'compress@10': 1.0, 'time@10': 2.5809}:  70%|███████   | 7/10 [00:12<00:05,  1.96s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.3695, 'hit_ratio@10': 0.3291, 'ndcg@10': 0.508, 'compress@10': 1.0, 'time@10': 2.5069}:  70%|███████   | 7/10 [00:14<00:05,  1.96s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.3695, 'hit_ratio@10': 0.3291, 'ndcg@10': 0.508, 'compress@10': 1.0, 'time@10': 2.5069}:  80%|████████  | 8/10 [00:14<00:03,  1.98s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.3773, 'hit_ratio@10': 0.3433, 'ndcg@10': 0.538, 'compress@10': 1.0, 'time@10': 2.7026}:  80%|████████  | 8/10 [00:16<00:03,  1.98s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.3773, 'hit_ratio@10': 0.3433, 'ndcg@10': 0.538, 'compress@10': 1.0, 'time@10': 2.7026}:  90%|█████████ | 9/10 [00:16<00:02,  2.03s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.3654, 'hit_ratio@10': 0.3362, 'ndcg@10': 0.5315, 'compress@10': 1.0, 'time@10': 2.6855}:  90%|█████████ | 9/10 [00:19<00:02,  2.03s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 0.3654, 'hit_ratio@10': 0.3362, 'ndcg@10': 0.5315, 'compress@10': 1.0, 'time@10': 2.6855}: 100%|██████████| 10/10 [00:19<00:00,  2.20s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.3654, 'hit_ratio@10': 0.3362, 'ndcg@10': 0.5315, 'compress@10': 1.0, 'time@10': 2.6855}: 100%|██████████| 10/10 [00:19<00:00,  1.91s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.36542721961734
Avg hit ratio: 0.33624793410701725
Avg ndcg: 0.5315497775322109
Avg compression ratio: 1.0
Avg train time: 2.6854754447937013
Std train time: 1.4211501914432363
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]/slstore/shihongjian/Federated-Recommendation-Neural-Collaborative-Filtering/metrics.py:20: RuntimeWarning: overflow encountered in power
  dcg_numerator = np.power(2, predicted_recommendation_best_10) - 1
{'epoch': 20, 'num_users': 7.0, 'loss': 0.4111, 'hit_ratio@10': 0.3158, 'ndcg@10': 10.374, 'compress@10': 1.0, 'time@10': 2.2941}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.4111, 'hit_ratio@10': 0.3158, 'ndcg@10': 10.374, 'compress@10': 1.0, 'time@10': 2.2941}:  10%|█         | 1/10 [00:01<00:10,  1.17s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.4246, 'hit_ratio@10': 0.2708, 'ndcg@10': 5.4688, 'compress@10': 1.0, 'time@10': 2.1626}:  10%|█         | 1/10 [00:03<00:10,  1.17s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.4246, 'hit_ratio@10': 0.2708, 'ndcg@10': 5.4688, 'compress@10': 1.0, 'time@10': 2.1626}:  20%|██        | 2/10 [00:03<00:13,  1.70s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.7433, 'hit_ratio@10': 0.2758, 'ndcg@10': 4.0259, 'compress@10': 1.0, 'time@10': 1.6709}:  20%|██        | 2/10 [00:03<00:13,  1.70s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.7433, 'hit_ratio@10': 0.2758, 'ndcg@10': 4.0259, 'compress@10': 1.0, 'time@10': 1.6709}:  30%|███       | 3/10 [00:03<00:07,  1.09s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.666, 'hit_ratio@10': 0.2604, 'ndcg@10': 3.1422, 'compress@10': 1.0, 'time@10': 1.6363}:  30%|███       | 3/10 [00:05<00:07,  1.09s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.666, 'hit_ratio@10': 0.2604, 'ndcg@10': 3.1422, 'compress@10': 1.0, 'time@10': 1.6363}:  40%|████      | 4/10 [00:05<00:07,  1.28s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.6156, 'hit_ratio@10': 0.3123, 'ndcg@10': 2.609, 'compress@10': 1.0, 'time@10': 2.5652}:  40%|████      | 4/10 [00:08<00:07,  1.28s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.6156, 'hit_ratio@10': 0.3123, 'ndcg@10': 2.609, 'compress@10': 1.0, 'time@10': 2.5652}:  50%|█████     | 5/10 [00:08<00:09,  1.96s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.5728, 'hit_ratio@10': 0.301, 'ndcg@10': 2.2635, 'compress@10': 1.0, 'time@10': 2.6069}:  50%|█████     | 5/10 [00:11<00:09,  1.96s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.5728, 'hit_ratio@10': 0.301, 'ndcg@10': 2.2635, 'compress@10': 1.0, 'time@10': 2.6069}:  60%|██████    | 6/10 [00:11<00:09,  2.26s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.5696, 'hit_ratio@10': 0.2751, 'ndcg@10': 2.0199, 'compress@10': 1.0, 'time@10': 2.6637}:  60%|██████    | 6/10 [00:12<00:09,  2.26s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.5696, 'hit_ratio@10': 0.2751, 'ndcg@10': 2.0199, 'compress@10': 1.0, 'time@10': 2.6637}:  70%|███████   | 7/10 [00:12<00:06,  2.02s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.9736, 'hit_ratio@10': 0.2908, 'ndcg@10': 2.607, 'compress@10': 1.0, 'time@10': 2.5865}:  70%|███████   | 7/10 [00:14<00:06,  2.02s/it]  {'epoch': 20, 'num_users': 6.125, 'loss': 0.9736, 'hit_ratio@10': 0.2908, 'ndcg@10': 2.607, 'compress@10': 1.0, 'time@10': 2.5865}:  80%|████████  | 8/10 [00:14<00:04,  2.04s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.9048, 'hit_ratio@10': 0.287, 'ndcg@10': 2.3772, 'compress@10': 1.0, 'time@10': 2.7709}:  80%|████████  | 8/10 [00:16<00:04,  2.04s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.9048, 'hit_ratio@10': 0.287, 'ndcg@10': 2.3772, 'compress@10': 1.0, 'time@10': 2.7709}:  90%|█████████ | 9/10 [00:16<00:02,  2.07s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.8438, 'hit_ratio@10': 0.2833, 'ndcg@10': 2.1991, 'compress@10': 1.0, 'time@10': 2.7425}:  90%|█████████ | 9/10 [00:19<00:02,  2.07s/it]  {'epoch': 20, 'num_users': 6.3, 'loss': 0.8438, 'hit_ratio@10': 0.2833, 'ndcg@10': 2.1991, 'compress@10': 1.0, 'time@10': 2.7425}: 100%|██████████| 10/10 [00:19<00:00,  2.21s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.8438, 'hit_ratio@10': 0.2833, 'ndcg@10': 2.1991, 'compress@10': 1.0, 'time@10': 2.7425}: 100%|██████████| 10/10 [00:19<00:00,  1.95s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.843800112426176
Avg hit ratio: 0.28331832268844154
Avg ndcg: 2.199106227536634
Avg compression ratio: 1.0
Avg train time: 2.7424598932266235
Std train time: 1.4764352486088588
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 1.4271, 'hit_ratio@10': 0.4211, 'ndcg@10': 1.3225, 'compress@10': 1.0, 'time@10': 2.1713}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 1.4271, 'hit_ratio@10': 0.4211, 'ndcg@10': 1.3225, 'compress@10': 1.0, 'time@10': 2.1713}:  10%|█         | 1/10 [00:01<00:10,  1.11s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.8577, 'hit_ratio@10': 0.3234, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 2.0511}:  10%|█         | 1/10 [00:03<00:10,  1.11s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.8577, 'hit_ratio@10': 0.3234, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 2.0511}:  20%|██        | 2/10 [00:03<00:12,  1.61s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 6.701, 'hit_ratio@10': 0.2632, 'ndcg@10': 159.2124, 'compress@10': 1.0, 'time@10': 1.6267}:  20%|██        | 2/10 [00:03<00:12,  1.61s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 6.701, 'hit_ratio@10': 0.2632, 'ndcg@10': 159.2124, 'compress@10': 1.0, 'time@10': 1.6267}:  30%|███       | 3/10 [00:03<00:07,  1.07s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 5.1207, 'hit_ratio@10': 0.2599, 'ndcg@10': 119.5138, 'compress@10': 1.0, 'time@10': 1.6296}:  30%|███       | 3/10 [00:05<00:07,  1.07s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 5.1207, 'hit_ratio@10': 0.2599, 'ndcg@10': 119.5138, 'compress@10': 1.0, 'time@10': 1.6296}:  40%|████      | 4/10 [00:05<00:07,  1.30s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 4.2584, 'hit_ratio@10': 0.2679, 'ndcg@10': 96.7378, 'compress@10': 1.0, 'time@10': 2.4996}:  40%|████      | 4/10 [00:08<00:07,  1.30s/it] {'epoch': 21, 'num_users': 5.8, 'loss': 4.2584, 'hit_ratio@10': 0.2679, 'ndcg@10': 96.7378, 'compress@10': 1.0, 'time@10': 2.4996}:  50%|█████     | 5/10 [00:08<00:09,  1.92s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 3.598, 'hit_ratio@10': 0.264, 'ndcg@10': 80.6894, 'compress@10': 1.0, 'time@10': 2.5609}:  50%|█████     | 5/10 [00:11<00:09,  1.92s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 3.598, 'hit_ratio@10': 0.264, 'ndcg@10': 80.6894, 'compress@10': 1.0, 'time@10': 2.5609}:  60%|██████    | 6/10 [00:11<00:09,  2.25s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 3.1564, 'hit_ratio@10': 0.2549, 'ndcg@10': 69.2393, 'compress@10': 1.0, 'time@10': 2.6325}:  60%|██████    | 6/10 [00:12<00:09,  2.25s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 3.1564, 'hit_ratio@10': 0.2549, 'ndcg@10': 69.2393, 'compress@10': 1.0, 'time@10': 2.6325}:  70%|███████   | 7/10 [00:12<00:06,  2.03s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 2.8016, 'hit_ratio@10': 0.2623, 'ndcg@10': 60.7171, 'compress@10': 1.0, 'time@10': 2.5688}:  70%|███████   | 7/10 [00:14<00:06,  2.03s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 2.8016, 'hit_ratio@10': 0.2623, 'ndcg@10': 60.7171, 'compress@10': 1.0, 'time@10': 2.5688}:  80%|████████  | 8/10 [00:14<00:04,  2.07s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 2.5324, 'hit_ratio@10': 0.2554, 'ndcg@10': 54.034, 'compress@10': 1.0, 'time@10': 2.7591}:  80%|████████  | 8/10 [00:16<00:04,  2.07s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 2.5324, 'hit_ratio@10': 0.2554, 'ndcg@10': 54.034, 'compress@10': 1.0, 'time@10': 2.7591}:  90%|█████████ | 9/10 [00:16<00:02,  2.10s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 2.3106, 'hit_ratio@10': 0.2526, 'ndcg@10': 48.6739, 'compress@10': 1.0, 'time@10': 2.7363}:  90%|█████████ | 9/10 [00:19<00:02,  2.10s/it]  {'epoch': 21, 'num_users': 6.3, 'loss': 2.3106, 'hit_ratio@10': 0.2526, 'ndcg@10': 48.6739, 'compress@10': 1.0, 'time@10': 2.7363}: 100%|██████████| 10/10 [00:19<00:00,  2.24s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 2.3106, 'hit_ratio@10': 0.2526, 'ndcg@10': 48.6739, 'compress@10': 1.0, 'time@10': 2.7363}: 100%|██████████| 10/10 [00:19<00:00,  1.95s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 2.3105905792247
Avg hit ratio: 0.2525719112051879
Avg ndcg: 48.67393402262275
Avg compression ratio: 1.0
Avg train time: 2.7362881898880005
Std train time: 1.394885331050319
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.8627, 'hit_ratio@10': 0.2632, 'ndcg@10': 1.4827, 'compress@10': 1.0, 'time@10': 2.4232}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.8627, 'hit_ratio@10': 0.2632, 'ndcg@10': 1.4827, 'compress@10': 1.0, 'time@10': 2.4232}:  10%|█         | 1/10 [00:01<00:11,  1.24s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.8327, 'hit_ratio@10': 0.2122, 'ndcg@10': 1.1484, 'compress@10': 1.0, 'time@10': 2.1324}:  10%|█         | 1/10 [00:03<00:11,  1.24s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.8327, 'hit_ratio@10': 0.2122, 'ndcg@10': 1.1484, 'compress@10': 1.0, 'time@10': 2.1324}:  20%|██        | 2/10 [00:03<00:12,  1.61s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 99.4966, 'hit_ratio@10': 0.1891, 'ndcg@10': 63556865519070.56, 'compress@10': 1.0, 'time@10': 1.6477}:  20%|██        | 2/10 [00:03<00:12,  1.61s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 99.4966, 'hit_ratio@10': 0.1891, 'ndcg@10': 63556865519070.56, 'compress@10': 1.0, 'time@10': 1.6477}:  30%|███       | 3/10 [00:03<00:07,  1.05s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 74.7212, 'hit_ratio@10': 0.2043, 'ndcg@10': 47667649139303.03, 'compress@10': 1.0, 'time@10': 1.6581}:  30%|███       | 3/10 [00:05<00:07,  1.05s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 74.7212, 'hit_ratio@10': 0.2043, 'ndcg@10': 47667649139303.03, 'compress@10': 1.0, 'time@10': 1.6581}:  40%|████      | 4/10 [00:05<00:07,  1.31s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 59.8585, 'hit_ratio@10': 0.2195, 'ndcg@10': 38134119311442.516, 'compress@10': 1.0, 'time@10': 2.6602}:  40%|████      | 4/10 [00:08<00:07,  1.31s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 59.8585, 'hit_ratio@10': 0.2195, 'ndcg@10': 38134119311442.516, 'compress@10': 1.0, 'time@10': 2.6602}:  50%|█████     | 5/10 [00:08<00:10,  2.05s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 49.9357, 'hit_ratio@10': 0.2236, 'ndcg@10': 31778432759535.5, 'compress@10': 1.0, 'time@10': 2.6586}:  50%|█████     | 5/10 [00:11<00:10,  2.05s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 49.9357, 'hit_ratio@10': 0.2236, 'ndcg@10': 31778432759535.5, 'compress@10': 1.0, 'time@10': 2.6586}:  60%|██████    | 6/10 [00:11<00:09,  2.26s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 48.7298, 'hit_ratio@10': 0.226, 'ndcg@10': 27238656654700.145, 'compress@10': 1.0, 'time@10': 2.7052}:  60%|██████    | 6/10 [00:12<00:09,  2.26s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 48.7298, 'hit_ratio@10': 0.226, 'ndcg@10': 27238656654700.145, 'compress@10': 1.0, 'time@10': 2.7052}:  70%|███████   | 7/10 [00:12<00:06,  2.03s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 45.57, 'hit_ratio@10': 0.212, 'ndcg@10': 23870668121617.51, 'compress@10': 1.0, 'time@10': 2.6142}:  70%|███████   | 7/10 [00:14<00:06,  2.03s/it]    {'epoch': 22, 'num_users': 6.125, 'loss': 45.57, 'hit_ratio@10': 0.212, 'ndcg@10': 23870668121617.51, 'compress@10': 1.0, 'time@10': 2.6142}:  80%|████████  | 8/10 [00:14<00:04,  2.02s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 40.5444, 'hit_ratio@10': 0.2043, 'ndcg@10': 21218371663660.07, 'compress@10': 1.0, 'time@10': 2.7964}:  80%|████████  | 8/10 [00:16<00:04,  2.02s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 40.5444, 'hit_ratio@10': 0.2043, 'ndcg@10': 21218371663660.07, 'compress@10': 1.0, 'time@10': 2.7964}:  90%|█████████ | 9/10 [00:16<00:02,  2.07s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 36.5249, 'hit_ratio@10': 0.2066, 'ndcg@10': 19096534497294.11, 'compress@10': 1.0, 'time@10': 2.7834}:  90%|█████████ | 9/10 [00:19<00:02,  2.07s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 36.5249, 'hit_ratio@10': 0.2066, 'ndcg@10': 19096534497294.11, 'compress@10': 1.0, 'time@10': 2.7834}: 100%|██████████| 10/10 [00:19<00:00,  2.26s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 36.5249, 'hit_ratio@10': 0.2066, 'ndcg@10': 19096534497294.11, 'compress@10': 1.0, 'time@10': 2.7834}: 100%|██████████| 10/10 [00:19<00:00,  1.97s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 36.52491909434973
Avg hit ratio: 0.2066165389034659
Avg ndcg: 19096534497294.11
Avg compression ratio: 1.0
Avg train time: 2.783356022834778
Std train time: 1.5691373496313563
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 1.1113, 'hit_ratio@10': 0.2105, 'ndcg@10': 1.2704, 'compress@10': 1.0, 'time@10': 2.1644}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 1.1113, 'hit_ratio@10': 0.2105, 'ndcg@10': 1.2704, 'compress@10': 1.0, 'time@10': 2.1644}:  10%|█         | 1/10 [00:01<00:09,  1.11s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 6.6318, 'hit_ratio@10': 0.2343, 'ndcg@10': 2881.3634, 'compress@10': 1.0, 'time@10': 2.0027}:  10%|█         | 1/10 [00:02<00:09,  1.11s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 6.6318, 'hit_ratio@10': 0.2343, 'ndcg@10': 2881.3634, 'compress@10': 1.0, 'time@10': 2.0027}:  20%|██        | 2/10 [00:02<00:12,  1.56s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 17327.818, 'hit_ratio@10': 0.1562, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5609}:  20%|██        | 2/10 [00:03<00:12,  1.56s/it]   {'epoch': 23, 'num_users': 5.0, 'loss': 17327.818, 'hit_ratio@10': 0.1562, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5609}:  30%|███       | 3/10 [00:03<00:07,  1.01s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 12995.9579, 'hit_ratio@10': 0.1796, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5765}:  30%|███       | 3/10 [00:04<00:07,  1.01s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 12995.9579, 'hit_ratio@10': 0.1796, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5765}:  40%|████      | 4/10 [00:04<00:07,  1.27s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 10396.83, 'hit_ratio@10': 0.2077, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5238}:  40%|████      | 4/10 [00:08<00:07,  1.27s/it]  {'epoch': 23, 'num_users': 5.8, 'loss': 10396.83, 'hit_ratio@10': 0.2077, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5238}:  50%|█████     | 5/10 [00:08<00:09,  1.97s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 8664.0749, 'hit_ratio@10': 0.2138, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5552}:  50%|█████     | 5/10 [00:10<00:09,  1.97s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 8664.0749, 'hit_ratio@10': 0.2138, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5552}:  60%|██████    | 6/10 [00:10<00:08,  2.23s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 7426.3994, 'hit_ratio@10': 0.2119, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6174}:  60%|██████    | 6/10 [00:12<00:08,  2.23s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 7426.3994, 'hit_ratio@10': 0.2119, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6174}:  70%|███████   | 7/10 [00:12<00:05,  2.00s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 6500.074, 'hit_ratio@10': 0.2175, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5395}:  70%|███████   | 7/10 [00:14<00:05,  2.00s/it]  {'epoch': 23, 'num_users': 6.125, 'loss': 6500.074, 'hit_ratio@10': 0.2175, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5395}:  80%|████████  | 8/10 [00:14<00:04,  2.01s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 5777.9054, 'hit_ratio@10': 0.2124, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7339}:  80%|████████  | 8/10 [00:16<00:04,  2.01s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 5777.9054, 'hit_ratio@10': 0.2124, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7339}:  90%|█████████ | 9/10 [00:16<00:02,  2.06s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 5211.1834, 'hit_ratio@10': 0.2116, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7106}:  90%|█████████ | 9/10 [00:19<00:02,  2.06s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 5211.1834, 'hit_ratio@10': 0.2116, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7106}: 100%|██████████| 10/10 [00:19<00:00,  2.20s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 5211.1834, 'hit_ratio@10': 0.2116, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7106}: 100%|██████████| 10/10 [00:19<00:00,  1.92s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 5211.183415782608
Avg hit ratio: 0.21161521594798333
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.710571360588074
Std train time: 1.4991445207744805
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 1.7784, 'hit_ratio@10': 0.2105, 'ndcg@10': 31.9651, 'compress@10': 1.0, 'time@10': 2.343}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 1.7784, 'hit_ratio@10': 0.2105, 'ndcg@10': 31.9651, 'compress@10': 1.0, 'time@10': 2.343}:  10%|█         | 1/10 [00:01<00:10,  1.20s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 3.1698, 'hit_ratio@10': 0.2182, 'ndcg@10': 23.875, 'compress@10': 1.0, 'time@10': 2.1376}:  10%|█         | 1/10 [00:03<00:10,  1.20s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 3.1698, 'hit_ratio@10': 0.2182, 'ndcg@10': 23.875, 'compress@10': 1.0, 'time@10': 2.1376}:  20%|██        | 2/10 [00:03<00:13,  1.65s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 397.5863, 'hit_ratio@10': 0.1931, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6761}:  20%|██        | 2/10 [00:03<00:13,  1.65s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 397.5863, 'hit_ratio@10': 0.1931, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6761}:  30%|███       | 3/10 [00:03<00:07,  1.08s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 298.2907, 'hit_ratio@10': 0.2073, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6702}:  30%|███       | 3/10 [00:05<00:07,  1.08s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 298.2907, 'hit_ratio@10': 0.2073, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6702}:  40%|████      | 4/10 [00:05<00:07,  1.32s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 238.741, 'hit_ratio@10': 0.2298, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5649}:  40%|████      | 4/10 [00:08<00:07,  1.32s/it] {'epoch': 24, 'num_users': 5.8, 'loss': 238.741, 'hit_ratio@10': 0.2298, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5649}:  50%|█████     | 5/10 [00:08<00:09,  1.96s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 199.0025, 'hit_ratio@10': 0.2323, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5963}:  50%|█████     | 5/10 [00:11<00:09,  1.96s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 199.0025, 'hit_ratio@10': 0.2323, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5963}:  60%|██████    | 6/10 [00:11<00:08,  2.24s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 170.6225, 'hit_ratio@10': 0.2334, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6516}:  60%|██████    | 6/10 [00:12<00:08,  2.24s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 170.6225, 'hit_ratio@10': 0.2334, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6516}:  70%|███████   | 7/10 [00:12<00:06,  2.00s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 149.5214, 'hit_ratio@10': 0.2435, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5598}:  70%|███████   | 7/10 [00:14<00:06,  2.00s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 149.5214, 'hit_ratio@10': 0.2435, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5598}:  80%|████████  | 8/10 [00:14<00:03,  1.99s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 133.1723, 'hit_ratio@10': 0.2355, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7453}:  80%|████████  | 8/10 [00:16<00:03,  1.99s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 133.1723, 'hit_ratio@10': 0.2355, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7453}:  90%|█████████ | 9/10 [00:16<00:02,  2.04s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 119.8811, 'hit_ratio@10': 0.2324, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.725}:  90%|█████████ | 9/10 [00:19<00:02,  2.04s/it]    {'epoch': 24, 'num_users': 6.3, 'loss': 119.8811, 'hit_ratio@10': 0.2324, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.725}: 100%|██████████| 10/10 [00:19<00:00,  2.20s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 119.8811, 'hit_ratio@10': 0.2324, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.725}: 100%|██████████| 10/10 [00:19<00:00,  1.93s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 119.88113990382408
Avg hit ratio: 0.2323894094963704
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.724999117851257
Std train time: 1.4322957093710547
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 293.124, 'hit_ratio@10': 0.0526, 'ndcg@10': 67825140108.3162, 'compress@10': 1.0, 'time@10': 2.1469}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 293.124, 'hit_ratio@10': 0.0526, 'ndcg@10': 67825140108.3162, 'compress@10': 1.0, 'time@10': 2.1469}:  10%|█         | 1/10 [00:01<00:09,  1.10s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 152.6716, 'hit_ratio@10': 0.1231, 'ndcg@10': 33912575178.8661, 'compress@10': 1.0, 'time@10': 2.0197}:  10%|█         | 1/10 [00:03<00:09,  1.10s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 152.6716, 'hit_ratio@10': 0.1231, 'ndcg@10': 33912575178.8661, 'compress@10': 1.0, 'time@10': 2.0197}:  20%|██        | 2/10 [00:03<00:12,  1.58s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 370.8439, 'hit_ratio@10': 0.0821, 'ndcg@10': 3.5633030484737865e+27, 'compress@10': 1.0, 'time@10': 1.5915}:  20%|██        | 2/10 [00:03<00:12,  1.58s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 370.8439, 'hit_ratio@10': 0.0821, 'ndcg@10': 3.5633030484737865e+27, 'compress@10': 1.0, 'time@10': 1.5915}:  30%|███       | 3/10 [00:03<00:07,  1.04s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 278.2269, 'hit_ratio@10': 0.124, 'ndcg@10': 2.67247728635534e+27, 'compress@10': 1.0, 'time@10': 1.5938}:  30%|███       | 3/10 [00:05<00:07,  1.04s/it]   {'epoch': 25, 'num_users': 5.0, 'loss': 278.2269, 'hit_ratio@10': 0.124, 'ndcg@10': 2.67247728635534e+27, 'compress@10': 1.0, 'time@10': 1.5938}:  40%|████      | 4/10 [00:05<00:07,  1.28s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 222.6437, 'hit_ratio@10': 0.1632, 'ndcg@10': 2.1379818290842722e+27, 'compress@10': 1.0, 'time@10': 2.5374}:  40%|████      | 4/10 [00:08<00:07,  1.28s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 222.6437, 'hit_ratio@10': 0.1632, 'ndcg@10': 2.1379818290842722e+27, 'compress@10': 1.0, 'time@10': 2.5374}:  50%|█████     | 5/10 [00:08<00:09,  1.97s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 185.5903, 'hit_ratio@10': 0.1768, 'ndcg@10': 1.7816515242368932e+27, 'compress@10': 1.0, 'time@10': 2.5823}:  50%|█████     | 5/10 [00:11<00:09,  1.97s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 185.5903, 'hit_ratio@10': 0.1768, 'ndcg@10': 1.7816515242368932e+27, 'compress@10': 1.0, 'time@10': 2.5823}:  60%|██████    | 6/10 [00:11<00:09,  2.26s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 159.1225, 'hit_ratio@10': 0.1801, 'ndcg@10': 1.527129877917337e+27, 'compress@10': 1.0, 'time@10': 2.6315}:  60%|██████    | 6/10 [00:12<00:09,  2.26s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 159.1225, 'hit_ratio@10': 0.1801, 'ndcg@10': 1.527129877917337e+27, 'compress@10': 1.0, 'time@10': 2.6315}:  70%|███████   | 7/10 [00:12<00:06,  2.01s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 310.1744, 'hit_ratio@10': 0.1861, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5657}:  70%|███████   | 7/10 [00:14<00:06,  2.01s/it]                   {'epoch': 25, 'num_users': 6.125, 'loss': 310.1744, 'hit_ratio@10': 0.1861, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5657}:  80%|████████  | 8/10 [00:14<00:04,  2.05s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 276.2468, 'hit_ratio@10': 0.175, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7379}:  80%|████████  | 8/10 [00:16<00:04,  2.05s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 276.2468, 'hit_ratio@10': 0.175, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7379}:  90%|█████████ | 9/10 [00:16<00:02,  2.06s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 305.0896, 'hit_ratio@10': 0.1689, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7182}:  90%|█████████ | 9/10 [00:19<00:02,  2.06s/it]  {'epoch': 25, 'num_users': 6.3, 'loss': 305.0896, 'hit_ratio@10': 0.1689, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7182}: 100%|██████████| 10/10 [00:19<00:00,  2.22s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 305.0896, 'hit_ratio@10': 0.1689, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7182}: 100%|██████████| 10/10 [00:19<00:00,  1.94s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 305.08963969815983
Avg hit ratio: 0.1688546488410665
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7181921005249023
Std train time: 1.466729151854809
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 11.4009, 'hit_ratio@10': 0.1579, 'ndcg@10': 58.4662, 'compress@10': 1.0, 'time@10': 2.1966}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 11.4009, 'hit_ratio@10': 0.1579, 'ndcg@10': 58.4662, 'compress@10': 1.0, 'time@10': 2.1966}:  10%|█         | 1/10 [00:01<00:10,  1.12s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 24.3829, 'hit_ratio@10': 0.208, 'ndcg@10': 29178.8544, 'compress@10': 1.0, 'time@10': 2.0419}:  10%|█         | 1/10 [00:03<00:10,  1.12s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 24.3829, 'hit_ratio@10': 0.208, 'ndcg@10': 29178.8544, 'compress@10': 1.0, 'time@10': 2.0419}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 1266689.0467, 'hit_ratio@10': 0.1387, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5948}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 1266689.0467, 'hit_ratio@10': 0.1387, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5948}:  30%|███       | 3/10 [00:03<00:07,  1.04s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 950016.8889, 'hit_ratio@10': 0.1665, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5928}:  30%|███       | 3/10 [00:05<00:07,  1.04s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 950016.8889, 'hit_ratio@10': 0.1665, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5928}:  40%|████      | 4/10 [00:05<00:07,  1.27s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 761637.9563, 'hit_ratio@10': 0.1692, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5015}:  40%|████      | 4/10 [00:08<00:07,  1.27s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 761637.9563, 'hit_ratio@10': 0.1692, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5015}:  50%|█████     | 5/10 [00:08<00:09,  1.93s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 634698.3469, 'hit_ratio@10': 0.1817, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5468}:  50%|█████     | 5/10 [00:10<00:09,  1.93s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 634698.3469, 'hit_ratio@10': 0.1817, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5468}:  60%|██████    | 6/10 [00:10<00:08,  2.23s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 544027.3055, 'hit_ratio@10': 0.1786, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.596}:  60%|██████    | 6/10 [00:12<00:08,  2.23s/it] {'epoch': 26, 'num_users': 6.2857, 'loss': 544027.3055, 'hit_ratio@10': 0.1786, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.596}:  70%|███████   | 7/10 [00:12<00:05,  1.98s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 476024.2827, 'hit_ratio@10': 0.1813, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5226}:  70%|███████   | 7/10 [00:14<00:05,  1.98s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 476024.2827, 'hit_ratio@10': 0.1813, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5226}:  80%|████████  | 8/10 [00:14<00:04,  2.00s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 423154.5538, 'hit_ratio@10': 0.1739, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7182}:  80%|████████  | 8/10 [00:16<00:04,  2.00s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 423154.5538, 'hit_ratio@10': 0.1739, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7182}:  90%|█████████ | 9/10 [00:16<00:02,  2.05s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 380839.1249, 'hit_ratio@10': 0.1769, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7271}:  90%|█████████ | 9/10 [00:19<00:02,  2.05s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 380839.1249, 'hit_ratio@10': 0.1769, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7271}: 100%|██████████| 10/10 [00:19<00:00,  2.30s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 380839.1249, 'hit_ratio@10': 0.1769, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7271}: 100%|██████████| 10/10 [00:19<00:00,  1.95s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 380839.1248905695
Avg hit ratio: 0.17692348662467508
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7270875930786134
Std train time: 1.4486310736154406
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 732.0926, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1542}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 732.0926, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1542}:  10%|█         | 1/10 [00:01<00:09,  1.10s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 408.9055, 'hit_ratio@10': 0.1333, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9628}:  10%|█         | 1/10 [00:02<00:09,  1.10s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 408.9055, 'hit_ratio@10': 0.1333, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9628}:  20%|██        | 2/10 [00:02<00:12,  1.51s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 515.8337, 'hit_ratio@10': 0.1365, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.529}:  20%|██        | 2/10 [00:03<00:12,  1.51s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 515.8337, 'hit_ratio@10': 0.1365, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.529}:  30%|███       | 3/10 [00:03<00:06,  1.02it/s]{'epoch': 27, 'num_users': 5.0, 'loss': 386.9699, 'hit_ratio@10': 0.1649, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.545}:  30%|███       | 3/10 [00:04<00:06,  1.02it/s]{'epoch': 27, 'num_users': 5.0, 'loss': 386.9699, 'hit_ratio@10': 0.1649, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.545}:  40%|████      | 4/10 [00:04<00:07,  1.24s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 309.6386, 'hit_ratio@10': 0.1959, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4626}:  40%|████      | 4/10 [00:07<00:07,  1.24s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 309.6386, 'hit_ratio@10': 0.1959, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4626}:  50%|█████     | 5/10 [00:07<00:09,  1.92s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 258.0877, 'hit_ratio@10': 0.204, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.533}:  50%|█████     | 5/10 [00:10<00:09,  1.92s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 258.0877, 'hit_ratio@10': 0.204, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.533}:  60%|██████    | 6/10 [00:10<00:09,  2.25s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 221.2639, 'hit_ratio@10': 0.1977, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5833}:  60%|██████    | 6/10 [00:12<00:09,  2.25s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 221.2639, 'hit_ratio@10': 0.1977, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5833}:  70%|███████   | 7/10 [00:12<00:05,  2.00s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 2392.9518, 'hit_ratio@10': 0.1944, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5045}:  70%|███████   | 7/10 [00:14<00:05,  2.00s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 2392.9518, 'hit_ratio@10': 0.1944, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5045}:  80%|████████  | 8/10 [00:14<00:03,  1.99s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 2130.1279, 'hit_ratio@10': 0.1855, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6895}:  80%|████████  | 8/10 [00:16<00:03,  1.99s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 2130.1279, 'hit_ratio@10': 0.1855, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6895}:  90%|█████████ | 9/10 [00:16<00:02,  2.03s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 1917.3739, 'hit_ratio@10': 0.1874, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6756}:  90%|█████████ | 9/10 [00:19<00:02,  2.03s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 1917.3739, 'hit_ratio@10': 0.1874, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6756}: 100%|██████████| 10/10 [00:19<00:00,  2.20s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 1917.3739, 'hit_ratio@10': 0.1874, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6756}: 100%|██████████| 10/10 [00:19<00:00,  1.91s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 1917.373933703161
Avg hit ratio: 0.18741148080367095
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.6756491661071777
Std train time: 1.4536310244395387
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 4306.2265, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2118}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 4306.2265, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2118}:  10%|█         | 1/10 [00:01<00:10,  1.13s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 26443.3912, 'hit_ratio@10': 0.1333, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0579}:  10%|█         | 1/10 [00:03<00:10,  1.13s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 26443.3912, 'hit_ratio@10': 0.1333, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0579}:  20%|██        | 2/10 [00:03<00:12,  1.60s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 42569.156, 'hit_ratio@10': 0.1365, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6144}:  20%|██        | 2/10 [00:03<00:12,  1.60s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 42569.156, 'hit_ratio@10': 0.1365, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6144}:  30%|███       | 3/10 [00:03<00:07,  1.05s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 31926.9617, 'hit_ratio@10': 0.1649, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6207}:  30%|███       | 3/10 [00:05<00:07,  1.05s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 31926.9617, 'hit_ratio@10': 0.1649, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6207}:  40%|████      | 4/10 [00:05<00:07,  1.29s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 37066.6091, 'hit_ratio@10': 0.1679, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5059}:  40%|████      | 4/10 [00:08<00:07,  1.29s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 37066.6091, 'hit_ratio@10': 0.1679, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5059}:  50%|█████     | 5/10 [00:08<00:09,  1.93s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 30888.893, 'hit_ratio@10': 0.1806, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5316}:  50%|█████     | 5/10 [00:10<00:09,  1.93s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 30888.893, 'hit_ratio@10': 0.1806, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5316}:  60%|██████    | 6/10 [00:10<00:08,  2.19s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 26476.3643, 'hit_ratio@10': 0.1777, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6074}:  60%|██████    | 6/10 [00:12<00:08,  2.19s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 26476.3643, 'hit_ratio@10': 0.1777, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6074}:  70%|███████   | 7/10 [00:12<00:05,  1.98s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 23246.0215, 'hit_ratio@10': 0.1769, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.531}:  70%|███████   | 7/10 [00:14<00:05,  1.98s/it]  {'epoch': 28, 'num_users': 6.125, 'loss': 23246.0215, 'hit_ratio@10': 0.1769, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.531}:  80%|████████  | 8/10 [00:14<00:03,  1.99s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 20686.824, 'hit_ratio@10': 0.1763, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7163}:  80%|████████  | 8/10 [00:16<00:03,  1.99s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 20686.824, 'hit_ratio@10': 0.1763, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7163}:  90%|█████████ | 9/10 [00:16<00:02,  2.04s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 18618.1695, 'hit_ratio@10': 0.1791, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7002}:  90%|█████████ | 9/10 [00:19<00:02,  2.04s/it]  {'epoch': 28, 'num_users': 6.3, 'loss': 18618.1695, 'hit_ratio@10': 0.1791, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7002}: 100%|██████████| 10/10 [00:19<00:00,  2.20s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 18618.1695, 'hit_ratio@10': 0.1791, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7002}: 100%|██████████| 10/10 [00:19<00:00,  1.92s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 18618.16953262493
Avg hit ratio: 0.17912576651795667
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7002026796340943
Std train time: 1.4136282108208096
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 79442.5538, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1688}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 79442.5538, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1688}:  10%|█         | 1/10 [00:01<00:10,  1.11s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 39721.6099, 'hit_ratio@10': 0.107, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0384}:  10%|█         | 1/10 [00:03<00:10,  1.11s/it] {'epoch': 29, 'num_users': 7.0, 'loss': 39721.6099, 'hit_ratio@10': 0.107, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0384}:  20%|██        | 2/10 [00:03<00:12,  1.60s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 63954.9207, 'hit_ratio@10': 0.0713, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5963}:  20%|██        | 2/10 [00:03<00:12,  1.60s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 63954.9207, 'hit_ratio@10': 0.0713, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5963}:  30%|███       | 3/10 [00:03<00:07,  1.05s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 47966.2944, 'hit_ratio@10': 0.116, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5824}:  30%|███       | 3/10 [00:05<00:07,  1.05s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 47966.2944, 'hit_ratio@10': 0.116, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5824}:  40%|████      | 4/10 [00:05<00:07,  1.25s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 38373.1009, 'hit_ratio@10': 0.1568, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.488}:  40%|████      | 4/10 [00:08<00:07,  1.25s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 38373.1009, 'hit_ratio@10': 0.1568, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.488}:  50%|█████     | 5/10 [00:08<00:09,  1.91s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 31977.6417, 'hit_ratio@10': 0.1714, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5195}:  50%|█████     | 5/10 [00:10<00:09,  1.91s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 31977.6417, 'hit_ratio@10': 0.1714, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5195}:  60%|██████    | 6/10 [00:10<00:08,  2.18s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 27409.452, 'hit_ratio@10': 0.1698, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5933}:  60%|██████    | 6/10 [00:12<00:08,  2.18s/it] {'epoch': 29, 'num_users': 6.2857, 'loss': 27409.452, 'hit_ratio@10': 0.1698, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5933}:  70%|███████   | 7/10 [00:12<00:05,  1.97s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 23983.3049, 'hit_ratio@10': 0.1843, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5246}:  70%|███████   | 7/10 [00:14<00:05,  1.97s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 23983.3049, 'hit_ratio@10': 0.1843, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5246}:  80%|████████  | 8/10 [00:14<00:04,  2.00s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 55200.3449, 'hit_ratio@10': 0.1733, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7145}:  80%|████████  | 8/10 [00:16<00:04,  2.00s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 55200.3449, 'hit_ratio@10': 0.1733, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7145}:  90%|█████████ | 9/10 [00:16<00:02,  2.05s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 49680.41, 'hit_ratio@10': 0.1764, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7267}:  90%|█████████ | 9/10 [00:19<00:02,  2.05s/it]     {'epoch': 29, 'num_users': 6.3, 'loss': 49680.41, 'hit_ratio@10': 0.1764, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7267}: 100%|██████████| 10/10 [00:19<00:00,  2.30s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 49680.41, 'hit_ratio@10': 0.1764, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7267}: 100%|██████████| 10/10 [00:19<00:00,  1.94s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 49680.40996330697
Avg hit ratio: 0.1764340371946484
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7266764640808105
Std train time: 1.4402165693017366
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 2817.3128, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1157}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 2817.3128, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1157}:  10%|█         | 1/10 [00:01<00:09,  1.08s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 4651.0776, 'hit_ratio@10': 0.1859, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9881}:  10%|█         | 1/10 [00:02<00:09,  1.08s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 4651.0776, 'hit_ratio@10': 0.1859, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9881}:  20%|██        | 2/10 [00:02<00:12,  1.57s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 285138.9948, 'hit_ratio@10': 0.1239, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5552}:  20%|██        | 2/10 [00:03<00:12,  1.57s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 285138.9948, 'hit_ratio@10': 0.1239, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5552}:  30%|███       | 3/10 [00:03<00:07,  1.03s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 213854.7832, 'hit_ratio@10': 0.1465, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5784}:  30%|███       | 3/10 [00:05<00:07,  1.03s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 213854.7832, 'hit_ratio@10': 0.1465, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5784}:  40%|████      | 4/10 [00:05<00:07,  1.29s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 171084.4119, 'hit_ratio@10': 0.1692, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4793}:  40%|████      | 4/10 [00:08<00:07,  1.29s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 171084.4119, 'hit_ratio@10': 0.1692, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4793}:  50%|█████     | 5/10 [00:08<00:09,  1.93s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 142570.3929, 'hit_ratio@10': 0.1818, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5239}:  50%|█████     | 5/10 [00:10<00:09,  1.93s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 142570.3929, 'hit_ratio@10': 0.1818, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5239}:  60%|██████    | 6/10 [00:10<00:08,  2.22s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 122203.3246, 'hit_ratio@10': 0.1786, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5716}:  60%|██████    | 6/10 [00:12<00:08,  2.22s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 122203.3246, 'hit_ratio@10': 0.1786, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5716}:  70%|███████   | 7/10 [00:12<00:05,  1.97s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 106928.0911, 'hit_ratio@10': 0.1885, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5042}:  70%|███████   | 7/10 [00:14<00:05,  1.97s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 106928.0911, 'hit_ratio@10': 0.1885, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5042}:  80%|████████  | 8/10 [00:14<00:03,  2.00s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 95589.6435, 'hit_ratio@10': 0.1707, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7333}:  80%|████████  | 8/10 [00:16<00:03,  2.00s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 95589.6435, 'hit_ratio@10': 0.1707, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7333}:  90%|█████████ | 9/10 [00:16<00:02,  2.10s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 86030.7069, 'hit_ratio@10': 0.1741, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7148}:  90%|█████████ | 9/10 [00:19<00:02,  2.10s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 86030.7069, 'hit_ratio@10': 0.1741, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7148}: 100%|██████████| 10/10 [00:19<00:00,  2.25s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 86030.7069, 'hit_ratio@10': 0.1741, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7148}: 100%|██████████| 10/10 [00:19<00:00,  1.93s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 86030.70687616264
Avg hit ratio: 0.1740806537360018
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7148104429244997
Std train time: 1.4702415017415085
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 607891.4301, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1485}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 607891.4301, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1485}:  10%|█         | 1/10 [00:01<00:09,  1.10s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 303945.8658, 'hit_ratio@10': 0.1112, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9854}:  10%|█         | 1/10 [00:02<00:09,  1.10s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 303945.8658, 'hit_ratio@10': 0.1112, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9854}:  20%|██        | 2/10 [00:02<00:12,  1.54s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 348348.4821, 'hit_ratio@10': 0.0741, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5408}:  20%|██        | 2/10 [00:03<00:12,  1.54s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 348348.4821, 'hit_ratio@10': 0.0741, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5408}:  30%|███       | 3/10 [00:03<00:06,  1.00it/s]{'epoch': 31, 'num_users': 5.0, 'loss': 261261.4577, 'hit_ratio@10': 0.1181, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5564}:  30%|███       | 3/10 [00:04<00:06,  1.00it/s]{'epoch': 31, 'num_users': 5.0, 'loss': 261261.4577, 'hit_ratio@10': 0.1181, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5564}:  40%|████      | 4/10 [00:04<00:07,  1.25s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 209009.2278, 'hit_ratio@10': 0.1585, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5031}:  40%|████      | 4/10 [00:08<00:07,  1.25s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 209009.2278, 'hit_ratio@10': 0.1585, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5031}:  50%|█████     | 5/10 [00:08<00:09,  1.94s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 174174.4296, 'hit_ratio@10': 0.1728, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5925}:  50%|█████     | 5/10 [00:11<00:09,  1.94s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 174174.4296, 'hit_ratio@10': 0.1728, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5925}:  60%|██████    | 6/10 [00:11<00:09,  2.32s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 149292.4496, 'hit_ratio@10': 0.171, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6292}:  60%|██████    | 6/10 [00:12<00:09,  2.32s/it] {'epoch': 31, 'num_users': 6.2857, 'loss': 149292.4496, 'hit_ratio@10': 0.171, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6292}:  70%|███████   | 7/10 [00:12<00:06,  2.04s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 130630.9326, 'hit_ratio@10': 0.1853, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5593}:  70%|███████   | 7/10 [00:14<00:06,  2.04s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 130630.9326, 'hit_ratio@10': 0.1853, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5593}:  80%|████████  | 8/10 [00:14<00:04,  2.06s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 136713.8444, 'hit_ratio@10': 0.1679, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7714}:  80%|████████  | 8/10 [00:17<00:04,  2.06s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 136713.8444, 'hit_ratio@10': 0.1679, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7714}:  90%|█████████ | 9/10 [00:17<00:02,  2.13s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 946388.4724, 'hit_ratio@10': 0.1602, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7506}:  90%|█████████ | 9/10 [00:19<00:02,  2.13s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 946388.4724, 'hit_ratio@10': 0.1602, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7506}: 100%|██████████| 10/10 [00:19<00:00,  2.27s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 946388.4724, 'hit_ratio@10': 0.1602, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7506}: 100%|██████████| 10/10 [00:19<00:00,  1.96s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 946388.4724373845
Avg hit ratio: 0.16020501155136127
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7505995512008665
Std train time: 1.5170907028114304
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 70848.0883, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3766}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 70848.0883, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3766}:  10%|█         | 1/10 [00:01<00:10,  1.21s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 35429.0131, 'hit_ratio@10': 0.0688, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.09}:  10%|█         | 1/10 [00:03<00:10,  1.21s/it]  {'epoch': 32, 'num_users': 7.0, 'loss': 35429.0131, 'hit_ratio@10': 0.0688, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.09}:  20%|██        | 2/10 [00:03<00:12,  1.58s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 13911222.3897, 'hit_ratio@10': 0.0458, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.619}:  20%|██        | 2/10 [00:03<00:12,  1.58s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 13911222.3897, 'hit_ratio@10': 0.0458, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.619}:  30%|███       | 3/10 [00:03<00:07,  1.02s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 10433418.117, 'hit_ratio@10': 0.088, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6176}:  30%|███       | 3/10 [00:05<00:07,  1.02s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 10433418.117, 'hit_ratio@10': 0.088, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6176}:  40%|████      | 4/10 [00:05<00:07,  1.27s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 8346736.6586, 'hit_ratio@10': 0.1224, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.584}:  40%|████      | 4/10 [00:08<00:07,  1.27s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 8346736.6586, 'hit_ratio@10': 0.1224, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.584}:  50%|█████     | 5/10 [00:08<00:09,  1.98s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 6955615.7719, 'hit_ratio@10': 0.1242, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6053}:  50%|█████     | 5/10 [00:11<00:09,  1.98s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 6955615.7719, 'hit_ratio@10': 0.1242, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6053}:  60%|██████    | 6/10 [00:11<00:08,  2.24s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 5961956.7725, 'hit_ratio@10': 0.1293, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.672}:  60%|██████    | 6/10 [00:12<00:08,  2.24s/it] {'epoch': 32, 'num_users': 6.2857, 'loss': 5961956.7725, 'hit_ratio@10': 0.1293, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.672}:  70%|███████   | 7/10 [00:12<00:06,  2.02s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 5216714.0738, 'hit_ratio@10': 0.131, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5898}:  70%|███████   | 7/10 [00:14<00:06,  2.02s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 5216714.0738, 'hit_ratio@10': 0.131, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5898}:  80%|████████  | 8/10 [00:14<00:04,  2.03s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 4644126.1206, 'hit_ratio@10': 0.1291, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8072}:  80%|████████  | 8/10 [00:16<00:04,  2.03s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 4644126.1206, 'hit_ratio@10': 0.1291, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8072}:  90%|█████████ | 9/10 [00:16<00:02,  2.11s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 4179713.5519, 'hit_ratio@10': 0.1367, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7922}:  90%|█████████ | 9/10 [00:19<00:02,  2.11s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 4179713.5519, 'hit_ratio@10': 0.1367, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7922}: 100%|██████████| 10/10 [00:19<00:00,  2.29s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 4179713.5519, 'hit_ratio@10': 0.1367, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7922}: 100%|██████████| 10/10 [00:19<00:00,  1.96s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 4179713.551863088
Avg hit ratio: 0.13668285817182252
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.792219376564026
Std train time: 1.5547680802238697
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 234782728.7105, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3721}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 234782728.7105, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3721}:  10%|█         | 1/10 [00:01<00:10,  1.21s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 117391364.5286, 'hit_ratio@10': 0.0586, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1017}:  10%|█         | 1/10 [00:03<00:10,  1.21s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 117391364.5286, 'hit_ratio@10': 0.0586, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1017}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 78311909.9648, 'hit_ratio@10': 0.0867, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6187}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 78311909.9648, 'hit_ratio@10': 0.0867, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6187}:  30%|███       | 3/10 [00:03<00:07,  1.03s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 58733932.8663, 'hit_ratio@10': 0.1275, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6075}:  30%|███       | 3/10 [00:05<00:07,  1.03s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 58733932.8663, 'hit_ratio@10': 0.1275, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6075}:  40%|████      | 4/10 [00:05<00:07,  1.25s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 46987146.4138, 'hit_ratio@10': 0.166, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5191}:  40%|████      | 4/10 [00:08<00:07,  1.25s/it] {'epoch': 33, 'num_users': 5.8, 'loss': 46987146.4138, 'hit_ratio@10': 0.166, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5191}:  50%|█████     | 5/10 [00:08<00:09,  1.92s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 39155955.4064, 'hit_ratio@10': 0.1791, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5644}:  50%|█████     | 5/10 [00:10<00:09,  1.92s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 39155955.4064, 'hit_ratio@10': 0.1791, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5644}:  60%|██████    | 6/10 [00:10<00:08,  2.23s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 33562248.1683, 'hit_ratio@10': 0.1706, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6281}:  60%|██████    | 6/10 [00:12<00:08,  2.23s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 33562248.1683, 'hit_ratio@10': 0.1706, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6281}:  70%|███████   | 7/10 [00:12<00:06,  2.00s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 29366967.1904, 'hit_ratio@10': 0.185, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5479}:  70%|███████   | 7/10 [00:14<00:06,  2.00s/it]  {'epoch': 33, 'num_users': 6.125, 'loss': 29366967.1904, 'hit_ratio@10': 0.185, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5479}:  80%|████████  | 8/10 [00:14<00:04,  2.00s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 26103972.8331, 'hit_ratio@10': 0.1708, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7292}:  80%|████████  | 8/10 [00:16<00:04,  2.00s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 26103972.8331, 'hit_ratio@10': 0.1708, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7292}:  90%|█████████ | 9/10 [00:16<00:02,  2.04s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 23494073.5297, 'hit_ratio@10': 0.1628, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7174}:  90%|█████████ | 9/10 [00:19<00:02,  2.04s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 23494073.5297, 'hit_ratio@10': 0.1628, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7174}: 100%|██████████| 10/10 [00:19<00:00,  2.22s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 23494073.5297, 'hit_ratio@10': 0.1628, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7174}: 100%|██████████| 10/10 [00:19<00:00,  1.93s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 23494073.529742964
Avg hit ratio: 0.16282155290474473
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7174439907073973
Std train time: 1.453984391695549
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 3154850.9836, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1961}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 3154850.9836, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1961}:  10%|█         | 1/10 [00:01<00:10,  1.12s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 1577705.959, 'hit_ratio@10': 0.0688, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0424}:  10%|█         | 1/10 [00:03<00:10,  1.12s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 1577705.959, 'hit_ratio@10': 0.0688, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0424}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 214195281.8774, 'hit_ratio@10': 0.0935, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6239}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 214195281.8774, 'hit_ratio@10': 0.0935, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6239}:  30%|███       | 3/10 [00:03<00:07,  1.06s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 160646462.6424, 'hit_ratio@10': 0.1147, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6564}:  30%|███       | 3/10 [00:05<00:07,  1.06s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 160646462.6424, 'hit_ratio@10': 0.1147, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6564}:  40%|████      | 4/10 [00:05<00:08,  1.34s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 192051232.0088, 'hit_ratio@10': 0.1278, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5931}:  40%|████      | 4/10 [00:08<00:08,  1.34s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 192051232.0088, 'hit_ratio@10': 0.1278, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5931}:  50%|█████     | 5/10 [00:08<00:10,  2.01s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 167730158.6683, 'hit_ratio@10': 0.1213, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6165}:  50%|█████     | 5/10 [00:11<00:10,  2.01s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 167730158.6683, 'hit_ratio@10': 0.1213, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6165}:  60%|██████    | 6/10 [00:11<00:09,  2.27s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 143768712.5132, 'hit_ratio@10': 0.1211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7122}:  60%|██████    | 6/10 [00:12<00:09,  2.27s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 143768712.5132, 'hit_ratio@10': 0.1211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7122}:  70%|███████   | 7/10 [00:12<00:06,  2.07s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 125797629.9843, 'hit_ratio@10': 0.1203, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6453}:  70%|███████   | 7/10 [00:15<00:06,  2.07s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 125797629.9843, 'hit_ratio@10': 0.1203, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6453}:  80%|████████  | 8/10 [00:15<00:04,  2.11s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 111820115.5981, 'hit_ratio@10': 0.1228, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8398}:  80%|████████  | 8/10 [00:17<00:04,  2.11s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 111820115.5981, 'hit_ratio@10': 0.1228, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8398}:  90%|█████████ | 9/10 [00:17<00:02,  2.15s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 100638104.128, 'hit_ratio@10': 0.131, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8398}:  90%|█████████ | 9/10 [00:20<00:02,  2.15s/it]     {'epoch': 34, 'num_users': 6.3, 'loss': 100638104.128, 'hit_ratio@10': 0.131, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8398}: 100%|██████████| 10/10 [00:20<00:00,  2.38s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 100638104.128, 'hit_ratio@10': 0.131, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8398}: 100%|██████████| 10/10 [00:20<00:00,  2.02s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 100638104.12802298
Avg hit ratio: 0.1309526994416638
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.839775037765503
Std train time: 1.4844871236190178
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 37218993.7763, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2035}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 37218993.7763, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2035}:  10%|█         | 1/10 [00:01<00:10,  1.13s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 18609497.1232, 'hit_ratio@10': 0.1112, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0435}:  10%|█         | 1/10 [00:03<00:10,  1.13s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 18609497.1232, 'hit_ratio@10': 0.1112, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0435}:  20%|██        | 2/10 [00:03<00:12,  1.60s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 12466278.7207, 'hit_ratio@10': 0.0741, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5921}:  20%|██        | 2/10 [00:03<00:12,  1.60s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 12466278.7207, 'hit_ratio@10': 0.0741, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5921}:  30%|███       | 3/10 [00:03<00:07,  1.04s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 9349711.4169, 'hit_ratio@10': 0.1092, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6072}:  30%|███       | 3/10 [00:05<00:07,  1.04s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 9349711.4169, 'hit_ratio@10': 0.1092, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6072}:  40%|████      | 4/10 [00:05<00:07,  1.29s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 7479769.2384, 'hit_ratio@10': 0.1513, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5645}:  40%|████      | 4/10 [00:08<00:07,  1.29s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 7479769.2384, 'hit_ratio@10': 0.1513, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5645}:  50%|█████     | 5/10 [00:08<00:09,  1.99s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 6233141.2267, 'hit_ratio@10': 0.1669, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6185}:  50%|█████     | 5/10 [00:11<00:09,  1.99s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 6233141.2267, 'hit_ratio@10': 0.1669, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6185}:  60%|██████    | 6/10 [00:11<00:09,  2.30s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 5342706.4234, 'hit_ratio@10': 0.1544, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6752}:  60%|██████    | 6/10 [00:12<00:09,  2.30s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 5342706.4234, 'hit_ratio@10': 0.1544, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6752}:  70%|███████   | 7/10 [00:12<00:06,  2.05s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 4674868.2662, 'hit_ratio@10': 0.1709, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5993}:  70%|███████   | 7/10 [00:14<00:06,  2.05s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 4674868.2662, 'hit_ratio@10': 0.1709, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5993}:  80%|████████  | 8/10 [00:14<00:04,  2.07s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 4155479.6223, 'hit_ratio@10': 0.1646, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7779}:  80%|████████  | 8/10 [00:17<00:04,  2.07s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 4155479.6223, 'hit_ratio@10': 0.1646, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7779}:  90%|█████████ | 9/10 [00:17<00:02,  2.09s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 175074150.4457, 'hit_ratio@10': 0.1595, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7563}:  90%|█████████ | 9/10 [00:19<00:02,  2.09s/it] {'epoch': 35, 'num_users': 6.3, 'loss': 175074150.4457, 'hit_ratio@10': 0.1595, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7563}: 100%|██████████| 10/10 [00:19<00:00,  2.25s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 175074150.4457, 'hit_ratio@10': 0.1595, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7563}: 100%|██████████| 10/10 [00:19<00:00,  1.96s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 175074150.44571725
Avg hit ratio: 0.15947773882408856
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7563383102416994
Std train time: 1.4996130070949611
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 282456.1974, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4144}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 282456.1974, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4144}:  10%|█         | 1/10 [00:01<00:11,  1.24s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 141499.0506, 'hit_ratio@10': 0.0849, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2169}:  10%|█         | 1/10 [00:03<00:11,  1.24s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 141499.0506, 'hit_ratio@10': 0.0849, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2169}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 2917658529.2719, 'hit_ratio@10': 0.1042, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6945}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 2917658529.2719, 'hit_ratio@10': 0.1042, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6945}:  30%|███       | 3/10 [00:03<00:07,  1.09s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 2188248411.421, 'hit_ratio@10': 0.1228, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6543}:  30%|███       | 3/10 [00:05<00:07,  1.09s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 2188248411.421, 'hit_ratio@10': 0.1228, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6543}:  40%|████      | 4/10 [00:05<00:07,  1.28s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 2801159803.2343, 'hit_ratio@10': 0.1342, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5588}:  40%|████      | 4/10 [00:08<00:07,  1.28s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 2801159803.2343, 'hit_ratio@10': 0.1342, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5588}:  50%|█████     | 5/10 [00:08<00:09,  1.94s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 3837957204.1242, 'hit_ratio@10': 0.1378, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5706}:  50%|█████     | 5/10 [00:10<00:09,  1.94s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 3837957204.1242, 'hit_ratio@10': 0.1378, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5706}:  60%|██████    | 6/10 [00:10<00:08,  2.19s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 3294265295.3, 'hit_ratio@10': 0.1295, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6235}:  60%|██████    | 6/10 [00:12<00:08,  2.19s/it]   {'epoch': 36, 'num_users': 6.2857, 'loss': 3294265295.3, 'hit_ratio@10': 0.1295, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6235}:  70%|███████   | 7/10 [00:12<00:05,  1.96s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 2884910112.1029, 'hit_ratio@10': 0.1276, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5444}:  70%|███████   | 7/10 [00:14<00:05,  1.96s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 2884910112.1029, 'hit_ratio@10': 0.1276, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5444}:  80%|████████  | 8/10 [00:14<00:03,  1.98s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 2564364544.6509, 'hit_ratio@10': 0.1293, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.713}:  80%|████████  | 8/10 [00:16<00:03,  1.98s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 2564364544.6509, 'hit_ratio@10': 0.1293, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.713}:  90%|█████████ | 9/10 [00:16<00:02,  2.00s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 2307928090.7471, 'hit_ratio@10': 0.1368, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7039}:  90%|█████████ | 9/10 [00:19<00:02,  2.00s/it]  {'epoch': 36, 'num_users': 6.3, 'loss': 2307928090.7471, 'hit_ratio@10': 0.1368, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7039}: 100%|██████████| 10/10 [00:19<00:00,  2.20s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 2307928090.7471, 'hit_ratio@10': 0.1368, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7039}: 100%|██████████| 10/10 [00:19<00:00,  1.92s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 2307928090.7470784
Avg hit ratio: 0.13684517255994336
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7038946390151977
Std train time: 1.4360026155057892
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 8147661.6949, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2167}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 8147661.6949, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2167}:  10%|█         | 1/10 [00:01<00:10,  1.13s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 4073837.6114, 'hit_ratio@10': 0.0586, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0669}:  10%|█         | 1/10 [00:03<00:10,  1.13s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 4073837.6114, 'hit_ratio@10': 0.0586, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0669}:  20%|██        | 2/10 [00:03<00:12,  1.61s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 87949730.8838, 'hit_ratio@10': 0.039, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6063}:  20%|██        | 2/10 [00:03<00:12,  1.61s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 87949730.8838, 'hit_ratio@10': 0.039, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6063}:  30%|███       | 3/10 [00:03<00:07,  1.04s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 65962352.2269, 'hit_ratio@10': 0.0382, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6041}:  30%|███       | 3/10 [00:05<00:07,  1.04s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 65962352.2269, 'hit_ratio@10': 0.0382, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6041}:  40%|████      | 4/10 [00:05<00:07,  1.27s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 52769899.0175, 'hit_ratio@10': 0.0826, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5367}:  40%|████      | 4/10 [00:08<00:07,  1.27s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 52769899.0175, 'hit_ratio@10': 0.0826, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5367}:  50%|█████     | 5/10 [00:08<00:09,  1.95s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 43974917.9549, 'hit_ratio@10': 0.1058, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5672}:  50%|█████     | 5/10 [00:10<00:09,  1.95s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 43974917.9549, 'hit_ratio@10': 0.1058, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5672}:  60%|██████    | 6/10 [00:10<00:08,  2.22s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 37692855.119, 'hit_ratio@10': 0.1022, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6145}:  60%|██████    | 6/10 [00:12<00:08,  2.22s/it] {'epoch': 37, 'num_users': 6.2857, 'loss': 37692855.119, 'hit_ratio@10': 0.1022, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6145}:  70%|███████   | 7/10 [00:12<00:05,  1.99s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 32981250.6503, 'hit_ratio@10': 0.1108, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5467}:  70%|███████   | 7/10 [00:14<00:05,  1.99s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 32981250.6503, 'hit_ratio@10': 0.1108, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5467}:  80%|████████  | 8/10 [00:14<00:04,  2.03s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 29317070.5634, 'hit_ratio@10': 0.1049, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7556}:  80%|████████  | 8/10 [00:16<00:04,  2.03s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 29317070.5634, 'hit_ratio@10': 0.1049, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7556}:  90%|█████████ | 9/10 [00:16<00:02,  2.09s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 26385386.2785, 'hit_ratio@10': 0.108, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7342}:  90%|█████████ | 9/10 [00:19<00:02,  2.09s/it]    {'epoch': 37, 'num_users': 6.3, 'loss': 26385386.2785, 'hit_ratio@10': 0.108, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7342}: 100%|██████████| 10/10 [00:19<00:00,  2.24s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 26385386.2785, 'hit_ratio@10': 0.108, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7342}: 100%|██████████| 10/10 [00:19<00:00,  1.94s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 26385386.27848666
Avg hit ratio: 0.10800192808511992
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.734179949760437
Std train time: 1.4924804931873006
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 568830275.5066, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4176}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 568830275.5066, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4176}:  10%|█         | 1/10 [00:01<00:11,  1.24s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 284417663.852, 'hit_ratio@10': 0.0951, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1593}:  10%|█         | 1/10 [00:03<00:11,  1.24s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 284417663.852, 'hit_ratio@10': 0.0951, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1593}:  20%|██        | 2/10 [00:03<00:13,  1.66s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 22884560664.2823, 'hit_ratio@10': 0.111, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7195}:  20%|██        | 2/10 [00:03<00:13,  1.66s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 22884560664.2823, 'hit_ratio@10': 0.111, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7195}:  30%|███       | 3/10 [00:03<00:07,  1.10s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 17163421015.3879, 'hit_ratio@10': 0.119, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6966}:  30%|███       | 3/10 [00:05<00:07,  1.10s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 17163421015.3879, 'hit_ratio@10': 0.119, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6966}:  40%|████      | 4/10 [00:05<00:07,  1.32s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 13731405865.5535, 'hit_ratio@10': 0.1232, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7235}:  40%|████      | 4/10 [00:08<00:07,  1.32s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 13731405865.5535, 'hit_ratio@10': 0.1232, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7235}:  50%|█████     | 5/10 [00:08<00:10,  2.09s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 12067494375.1344, 'hit_ratio@10': 0.1249, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7231}:  50%|█████     | 5/10 [00:11<00:10,  2.09s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 12067494375.1344, 'hit_ratio@10': 0.1249, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7231}:  60%|██████    | 6/10 [00:11<00:09,  2.31s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 10343566841.4605, 'hit_ratio@10': 0.1242, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7575}:  60%|██████    | 6/10 [00:12<00:09,  2.31s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 10343566841.4605, 'hit_ratio@10': 0.1242, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7575}:  70%|███████   | 7/10 [00:12<00:06,  2.05s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 9050622049.3788, 'hit_ratio@10': 0.1337, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6527}:  70%|███████   | 7/10 [00:14<00:06,  2.05s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 9050622049.3788, 'hit_ratio@10': 0.1337, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6527}:  80%|████████  | 8/10 [00:14<00:04,  2.02s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 8044997380.3379, 'hit_ratio@10': 0.1347, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8304}:  80%|████████  | 8/10 [00:17<00:04,  2.02s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 8044997380.3379, 'hit_ratio@10': 0.1347, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8304}:  90%|█████████ | 9/10 [00:17<00:02,  2.06s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 7240497648.592, 'hit_ratio@10': 0.128, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8034}:  90%|█████████ | 9/10 [00:19<00:02,  2.06s/it]     {'epoch': 38, 'num_users': 6.3, 'loss': 7240497648.592, 'hit_ratio@10': 0.128, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8034}: 100%|██████████| 10/10 [00:19<00:00,  2.22s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 7240497648.592, 'hit_ratio@10': 0.128, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8034}: 100%|██████████| 10/10 [00:19<00:00,  1.97s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 7240497648.591955
Avg hit ratio: 0.1280239381444814
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.8033702611923217
Std train time: 1.5935035996931404
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 17397657866.1053, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2723}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 17397657866.1053, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2723}:  10%|█         | 1/10 [00:01<00:10,  1.16s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 8698828974.2983, 'hit_ratio@10': 0.1112, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1133}:  10%|█         | 1/10 [00:03<00:10,  1.16s/it] {'epoch': 39, 'num_users': 7.0, 'loss': 8698828974.2983, 'hit_ratio@10': 0.1112, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1133}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 5800684935.4444, 'hit_ratio@10': 0.0741, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.633}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 5800684935.4444, 'hit_ratio@10': 0.0741, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.633}:  30%|███       | 3/10 [00:03<00:07,  1.06s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 4350514587.2209, 'hit_ratio@10': 0.0913, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6197}:  30%|███       | 3/10 [00:05<00:07,  1.06s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 4350514587.2209, 'hit_ratio@10': 0.0913, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6197}:  40%|████      | 4/10 [00:05<00:07,  1.28s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 3480411755.2044, 'hit_ratio@10': 0.1091, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5609}:  40%|████      | 4/10 [00:08<00:07,  1.28s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 3480411755.2044, 'hit_ratio@10': 0.1091, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5609}:  50%|█████     | 5/10 [00:08<00:09,  1.97s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 2900343153.4406, 'hit_ratio@10': 0.1205, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5829}:  50%|█████     | 5/10 [00:11<00:09,  1.97s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 2900343153.4406, 'hit_ratio@10': 0.1205, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5829}:  60%|██████    | 6/10 [00:11<00:08,  2.22s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 2486009603.4645, 'hit_ratio@10': 0.1204, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6369}:  60%|██████    | 6/10 [00:12<00:08,  2.22s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 2486009603.4645, 'hit_ratio@10': 0.1204, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6369}:  70%|███████   | 7/10 [00:12<00:05,  1.99s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 2175258406.3334, 'hit_ratio@10': 0.1411, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5585}:  70%|███████   | 7/10 [00:14<00:05,  1.99s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 2175258406.3334, 'hit_ratio@10': 0.1411, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5585}:  80%|████████  | 8/10 [00:14<00:04,  2.00s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 1933569610.3259, 'hit_ratio@10': 0.1318, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7325}:  80%|████████  | 8/10 [00:16<00:04,  2.00s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 1933569610.3259, 'hit_ratio@10': 0.1318, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7325}:  90%|█████████ | 9/10 [00:16<00:02,  2.03s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 1740215541.002, 'hit_ratio@10': 0.1277, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7151}:  90%|█████████ | 9/10 [00:19<00:02,  2.03s/it]    {'epoch': 39, 'num_users': 6.3, 'loss': 1740215541.002, 'hit_ratio@10': 0.1277, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7151}: 100%|██████████| 10/10 [00:19<00:00,  2.20s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 1740215541.002, 'hit_ratio@10': 0.1277, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7151}: 100%|██████████| 10/10 [00:19<00:00,  1.92s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 1740215541.0019917
Avg hit ratio: 0.12768120202755176
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.715093970298767
Std train time: 1.4780614833561125
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 12797256378.1053, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1478}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 12797256378.1053, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1478}:  10%|█         | 1/10 [00:01<00:09,  1.10s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 6398686607.7392, 'hit_ratio@10': 0.0586, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9591}:  10%|█         | 1/10 [00:02<00:09,  1.10s/it] {'epoch': 40, 'num_users': 7.0, 'loss': 6398686607.7392, 'hit_ratio@10': 0.0586, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9591}:  20%|██        | 2/10 [00:02<00:12,  1.51s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 441197504193.35, 'hit_ratio@10': 0.0867, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5262}:  20%|██        | 2/10 [00:03<00:12,  1.51s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 441197504193.35, 'hit_ratio@10': 0.0867, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5262}:  30%|███       | 3/10 [00:03<00:06,  1.02it/s]{'epoch': 40, 'num_users': 5.0, 'loss': 330898171590.5038, 'hit_ratio@10': 0.1007, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5432}:  30%|███       | 3/10 [00:04<00:06,  1.02it/s]{'epoch': 40, 'num_users': 5.0, 'loss': 330898171590.5038, 'hit_ratio@10': 0.1007, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5432}:  40%|████      | 4/10 [00:04<00:07,  1.24s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 461336314821.4751, 'hit_ratio@10': 0.1086, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.514}:  40%|████      | 4/10 [00:08<00:07,  1.24s/it] {'epoch': 40, 'num_users': 5.8, 'loss': 461336314821.4751, 'hit_ratio@10': 0.1086, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.514}:  50%|█████     | 5/10 [00:08<00:09,  1.95s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 384501906001.6893, 'hit_ratio@10': 0.1127, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5608}:  50%|█████     | 5/10 [00:10<00:09,  1.95s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 384501906001.6893, 'hit_ratio@10': 0.1127, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5608}:  60%|██████    | 6/10 [00:10<00:08,  2.25s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 329573133805.0779, 'hit_ratio@10': 0.0966, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6001}:  60%|██████    | 6/10 [00:12<00:08,  2.25s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 329573133805.0779, 'hit_ratio@10': 0.0966, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6001}:  70%|███████   | 7/10 [00:12<00:05,  1.99s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 288376502094.041, 'hit_ratio@10': 0.1024, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5403}:  70%|███████   | 7/10 [00:14<00:05,  1.99s/it]  {'epoch': 40, 'num_users': 6.125, 'loss': 288376502094.041, 'hit_ratio@10': 0.1024, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5403}:  80%|████████  | 8/10 [00:14<00:04,  2.04s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 256334668638.2262, 'hit_ratio@10': 0.1005, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7767}:  80%|████████  | 8/10 [00:16<00:04,  2.04s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 256334668638.2262, 'hit_ratio@10': 0.1005, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7767}:  90%|█████████ | 9/10 [00:16<00:02,  2.15s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 230701201874.0022, 'hit_ratio@10': 0.1064, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7522}:  90%|█████████ | 9/10 [00:19<00:02,  2.15s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 230701201874.0022, 'hit_ratio@10': 0.1064, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7522}: 100%|██████████| 10/10 [00:19<00:00,  2.28s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 230701201874.0022, 'hit_ratio@10': 0.1064, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7522}: 100%|██████████| 10/10 [00:19<00:00,  1.95s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 230701201874.00214
Avg hit ratio: 0.10638576646895832
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7522427558898928
Std train time: 1.5638896351971763
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 46403.0255, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3261}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 46403.0255, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3261}:  10%|█         | 1/10 [00:01<00:10,  1.20s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 27778.704, 'hit_ratio@10': 0.0951, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0761}:  10%|█         | 1/10 [00:03<00:10,  1.20s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 27778.704, 'hit_ratio@10': 0.0951, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0761}:  20%|██        | 2/10 [00:03<00:12,  1.58s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 2881432551.8979, 'hit_ratio@10': 0.111, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6075}:  20%|██        | 2/10 [00:03<00:12,  1.58s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 2881432551.8979, 'hit_ratio@10': 0.111, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6075}:  30%|███       | 3/10 [00:03<00:07,  1.03s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 2161076860.3842, 'hit_ratio@10': 0.1368, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6226}:  30%|███       | 3/10 [00:05<00:07,  1.03s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 2161076860.3842, 'hit_ratio@10': 0.1368, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6226}:  40%|████      | 4/10 [00:05<00:07,  1.29s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 1728862012.2322, 'hit_ratio@10': 0.1615, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5265}:  40%|████      | 4/10 [00:08<00:07,  1.29s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 1728862012.2322, 'hit_ratio@10': 0.1615, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5265}:  50%|█████     | 5/10 [00:08<00:09,  1.95s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 1440718682.2229, 'hit_ratio@10': 0.1531, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5667}:  50%|█████     | 5/10 [00:11<00:09,  1.95s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 1440718682.2229, 'hit_ratio@10': 0.1531, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5667}:  60%|██████    | 6/10 [00:11<00:08,  2.24s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 1234921073.6468, 'hit_ratio@10': 0.1426, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6163}:  60%|██████    | 6/10 [00:12<00:08,  2.24s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 1234921073.6468, 'hit_ratio@10': 0.1426, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6163}:  70%|███████   | 7/10 [00:12<00:05,  1.99s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 1080556326.6572, 'hit_ratio@10': 0.1319, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5586}:  70%|███████   | 7/10 [00:14<00:05,  1.99s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 1080556326.6572, 'hit_ratio@10': 0.1319, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5586}:  80%|████████  | 8/10 [00:14<00:04,  2.05s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 960514844.3991, 'hit_ratio@10': 0.1332, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.783}:  80%|████████  | 8/10 [00:17<00:04,  2.05s/it] {'epoch': 41, 'num_users': 6.3333, 'loss': 960514844.3991, 'hit_ratio@10': 0.1332, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.783}:  90%|█████████ | 9/10 [00:17<00:02,  2.14s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 864463364.438, 'hit_ratio@10': 0.1403, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7597}:  90%|█████████ | 9/10 [00:19<00:02,  2.14s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 864463364.438, 'hit_ratio@10': 0.1403, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7597}: 100%|██████████| 10/10 [00:19<00:00,  2.27s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 864463364.438, 'hit_ratio@10': 0.1403, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7597}: 100%|██████████| 10/10 [00:19<00:00,  1.96s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 864463364.4379851
Avg hit ratio: 0.1402952224157657
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7596889972686767
Std train time: 1.4765226043385582
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 182604701.8816, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3594}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 182604701.8816, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3594}:  10%|█         | 1/10 [00:01<00:11,  1.22s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 2112456538756.6182, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1482}:  10%|█         | 1/10 [00:03<00:11,  1.22s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 2112456538756.6182, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1482}:  20%|██        | 2/10 [00:03<00:13,  1.66s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 7974271704542.508, 'hit_ratio@10': 0.0827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6746}:  20%|██        | 2/10 [00:03<00:13,  1.66s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 7974271704542.508, 'hit_ratio@10': 0.0827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6746}:  30%|███       | 3/10 [00:03<00:07,  1.08s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 5982704466102.452, 'hit_ratio@10': 0.0799, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6557}:  30%|███       | 3/10 [00:05<00:07,  1.08s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 5982704466102.452, 'hit_ratio@10': 0.0799, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6557}:  40%|████      | 4/10 [00:05<00:07,  1.30s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 4786164712135.263, 'hit_ratio@10': 0.0959, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5551}:  40%|████      | 4/10 [00:08<00:07,  1.30s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 4786164712135.263, 'hit_ratio@10': 0.0959, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5551}:  50%|█████     | 5/10 [00:08<00:09,  1.95s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 3988474259930.27, 'hit_ratio@10': 0.1021, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.596}:  50%|█████     | 5/10 [00:11<00:09,  1.95s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 3988474259930.27, 'hit_ratio@10': 0.1021, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.596}:  60%|██████    | 6/10 [00:11<00:08,  2.25s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 3418692657717.47, 'hit_ratio@10': 0.1047, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.642}:  60%|██████    | 6/10 [00:12<00:08,  2.25s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 3418692657717.47, 'hit_ratio@10': 0.1047, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.642}:  70%|███████   | 7/10 [00:12<00:05,  2.00s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 3007350075266.2153, 'hit_ratio@10': 0.1023, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5649}:  70%|███████   | 7/10 [00:14<00:05,  2.00s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 3007350075266.2153, 'hit_ratio@10': 0.1023, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5649}:  80%|████████  | 8/10 [00:14<00:04,  2.02s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 2673200067738.9497, 'hit_ratio@10': 0.091, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7652}:  80%|████████  | 8/10 [00:16<00:04,  2.02s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 2673200067738.9497, 'hit_ratio@10': 0.091, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7652}:  90%|█████████ | 9/10 [00:16<00:02,  2.08s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 2405880060965.3896, 'hit_ratio@10': 0.1023, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7501}:  90%|█████████ | 9/10 [00:19<00:02,  2.08s/it]  {'epoch': 42, 'num_users': 6.3, 'loss': 2405880060965.3896, 'hit_ratio@10': 0.1023, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7501}: 100%|██████████| 10/10 [00:19<00:00,  2.25s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 2405880060965.3896, 'hit_ratio@10': 0.1023, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7501}: 100%|██████████| 10/10 [00:19<00:00,  1.96s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 2405880060965.389
Avg hit ratio: 0.10231419457735247
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7501132488250732
Std train time: 1.449035216962213
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 451863.0699, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3723}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 451863.0699, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3723}:  10%|█         | 1/10 [00:01<00:10,  1.21s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 297277.0269, 'hit_ratio@10': 0.0789, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.081}:  10%|█         | 1/10 [00:03<00:10,  1.21s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 297277.0269, 'hit_ratio@10': 0.0789, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.081}:  20%|██        | 2/10 [00:03<00:12,  1.57s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 7278526114.5894, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.641}:  20%|██        | 2/10 [00:03<00:12,  1.57s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 7278526114.5894, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.641}:  30%|███       | 3/10 [00:03<00:07,  1.04s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 5458926186.5333, 'hit_ratio@10': 0.0752, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6389}:  30%|███       | 3/10 [00:05<00:07,  1.04s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 5458926186.5333, 'hit_ratio@10': 0.0752, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6389}:  40%|████      | 4/10 [00:05<00:07,  1.28s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 4367140949.8018, 'hit_ratio@10': 0.1242, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5445}:  40%|████      | 4/10 [00:08<00:07,  1.28s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 4367140949.8018, 'hit_ratio@10': 0.1242, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5445}:  50%|█████     | 5/10 [00:08<00:09,  1.94s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 3639284125.4259, 'hit_ratio@10': 0.1442, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5752}:  50%|█████     | 5/10 [00:10<00:09,  1.94s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 3639284125.4259, 'hit_ratio@10': 0.1442, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5752}:  60%|██████    | 6/10 [00:10<00:08,  2.22s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 3119455938.733, 'hit_ratio@10': 0.135, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.622}:  60%|██████    | 6/10 [00:12<00:08,  2.22s/it]   {'epoch': 43, 'num_users': 6.2857, 'loss': 3119455938.733, 'hit_ratio@10': 0.135, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.622}:  70%|███████   | 7/10 [00:12<00:05,  1.98s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 2729548575.683, 'hit_ratio@10': 0.136, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5749}:  70%|███████   | 7/10 [00:14<00:05,  1.98s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 2729548575.683, 'hit_ratio@10': 0.136, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5749}:  80%|████████  | 8/10 [00:14<00:04,  2.07s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 2426265401.0528, 'hit_ratio@10': 0.1368, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8004}:  80%|████████  | 8/10 [00:17<00:04,  2.07s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 2426265401.0528, 'hit_ratio@10': 0.1368, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8004}:  90%|█████████ | 9/10 [00:17<00:02,  2.15s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 4894910371325.82, 'hit_ratio@10': 0.1299, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7869}:  90%|█████████ | 9/10 [00:19<00:02,  2.15s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 4894910371325.82, 'hit_ratio@10': 0.1299, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7869}: 100%|██████████| 10/10 [00:19<00:00,  2.32s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 4894910371325.82, 'hit_ratio@10': 0.1299, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7869}: 100%|██████████| 10/10 [00:19<00:00,  1.97s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 4894910371325.82
Avg hit ratio: 0.1299092428039796
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.786934328079224
Std train time: 1.4716137822828192
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 519573363.6184, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1284}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 519573363.6184, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1284}:  10%|█         | 1/10 [00:01<00:09,  1.09s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 260721102.7201, 'hit_ratio@10': 0.0263, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0132}:  10%|█         | 1/10 [00:03<00:09,  1.09s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 260721102.7201, 'hit_ratio@10': 0.0263, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0132}:  20%|██        | 2/10 [00:03<00:12,  1.58s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 23298047525757.62, 'hit_ratio@10': 0.0175, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5654}:  20%|██        | 2/10 [00:03<00:12,  1.58s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 23298047525757.62, 'hit_ratio@10': 0.0175, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5654}:  30%|███       | 3/10 [00:03<00:07,  1.02s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 17473535644319.096, 'hit_ratio@10': 0.0757, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6031}:  30%|███       | 3/10 [00:05<00:07,  1.02s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 17473535644319.096, 'hit_ratio@10': 0.0757, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6031}:  40%|████      | 4/10 [00:05<00:07,  1.31s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 13979738548543.88, 'hit_ratio@10': 0.0965, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5342}:  40%|████      | 4/10 [00:08<00:07,  1.31s/it] {'epoch': 44, 'num_users': 5.8, 'loss': 13979738548543.88, 'hit_ratio@10': 0.0965, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5342}:  50%|█████     | 5/10 [00:08<00:09,  1.98s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 11663728008362.322, 'hit_ratio@10': 0.0953, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5673}:  50%|█████     | 5/10 [00:11<00:09,  1.98s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 11663728008362.322, 'hit_ratio@10': 0.0953, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5673}:  60%|██████    | 6/10 [00:11<00:08,  2.25s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 9997482323245.213, 'hit_ratio@10': 0.0988, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6424}:  60%|██████    | 6/10 [00:12<00:08,  2.25s/it] {'epoch': 44, 'num_users': 6.2857, 'loss': 9997482323245.213, 'hit_ratio@10': 0.0988, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6424}:  70%|███████   | 7/10 [00:12<00:06,  2.03s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 8747797032839.879, 'hit_ratio@10': 0.1222, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5577}:  70%|███████   | 7/10 [00:14<00:06,  2.03s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 8747797032839.879, 'hit_ratio@10': 0.1222, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5577}:  80%|████████  | 8/10 [00:14<00:04,  2.02s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 7775819598074.855, 'hit_ratio@10': 0.1149, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7687}:  80%|████████  | 8/10 [00:16<00:04,  2.02s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 7775819598074.855, 'hit_ratio@10': 0.1149, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7687}:  90%|█████████ | 9/10 [00:16<00:02,  2.09s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 6998237638267.705, 'hit_ratio@10': 0.1239, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7554}:  90%|█████████ | 9/10 [00:19<00:02,  2.09s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 6998237638267.705, 'hit_ratio@10': 0.1239, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7554}: 100%|██████████| 10/10 [00:19<00:00,  2.27s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 6998237638267.705, 'hit_ratio@10': 0.1239, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7554}: 100%|██████████| 10/10 [00:19<00:00,  1.95s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 6998237638267.705
Avg hit ratio: 0.12389230652388547
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7554317712783813
Std train time: 1.499334208376874
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 2800296.5329, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1975}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 2800296.5329, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1975}:  10%|█         | 1/10 [00:01<00:10,  1.13s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 1526866.8852, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0571}:  10%|█         | 1/10 [00:03<00:10,  1.13s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 1526866.8852, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0571}:  20%|██        | 2/10 [00:03<00:12,  1.61s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 4519144186.3044, 'hit_ratio@10': 0.0827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6053}:  20%|██        | 2/10 [00:03<00:12,  1.61s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 4519144186.3044, 'hit_ratio@10': 0.0827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6053}:  30%|███       | 3/10 [00:03<00:07,  1.05s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 3389395452.8581, 'hit_ratio@10': 0.1245, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6266}:  30%|███       | 3/10 [00:05<00:07,  1.05s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 3389395452.8581, 'hit_ratio@10': 0.1245, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6266}:  40%|████      | 4/10 [00:05<00:07,  1.31s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 2711567692.1273, 'hit_ratio@10': 0.1356, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5978}:  40%|████      | 4/10 [00:08<00:07,  1.31s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 2711567692.1273, 'hit_ratio@10': 0.1356, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5978}:  50%|█████     | 5/10 [00:08<00:10,  2.02s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 2259639744.0295, 'hit_ratio@10': 0.1538, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6199}:  50%|█████     | 5/10 [00:11<00:10,  2.02s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 2259639744.0295, 'hit_ratio@10': 0.1538, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6199}:  60%|██████    | 6/10 [00:11<00:09,  2.27s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 1937172454.6387, 'hit_ratio@10': 0.1432, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6827}:  60%|██████    | 6/10 [00:12<00:09,  2.27s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 1937172454.6387, 'hit_ratio@10': 0.1432, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6827}:  70%|███████   | 7/10 [00:12<00:06,  2.04s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 1695025898.1262, 'hit_ratio@10': 0.161, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6022}:  70%|███████   | 7/10 [00:14<00:06,  2.04s/it]  {'epoch': 45, 'num_users': 6.125, 'loss': 1695025898.1262, 'hit_ratio@10': 0.161, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6022}:  80%|████████  | 8/10 [00:14<00:04,  2.05s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 1506836974.7111, 'hit_ratio@10': 0.1558, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.793}:  80%|████████  | 8/10 [00:17<00:04,  2.05s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 1506836974.7111, 'hit_ratio@10': 0.1558, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.793}:  90%|█████████ | 9/10 [00:17<00:02,  2.09s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 1356203922.3145, 'hit_ratio@10': 0.1516, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7752}:  90%|█████████ | 9/10 [00:19<00:02,  2.09s/it]  {'epoch': 45, 'num_users': 6.3, 'loss': 1356203922.3145, 'hit_ratio@10': 0.1516, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7752}: 100%|██████████| 10/10 [00:19<00:00,  2.26s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 1356203922.3145, 'hit_ratio@10': 0.1516, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7752}: 100%|██████████| 10/10 [00:19<00:00,  1.97s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 1356203922.3145332
Avg hit ratio: 0.15162011088326877
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.775195908546448
Std train time: 1.527296314622806
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 4249238.9539, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2239}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 4249238.9539, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2239}:  10%|█         | 1/10 [00:01<00:10,  1.14s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 8416313.3731, 'hit_ratio@10': 0.0263, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0695}:  10%|█         | 1/10 [00:03<00:10,  1.14s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 8416313.3731, 'hit_ratio@10': 0.0263, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0695}:  20%|██        | 2/10 [00:03<00:12,  1.61s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 1243491754.8202, 'hit_ratio@10': 0.0652, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6034}:  20%|██        | 2/10 [00:03<00:12,  1.61s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 1243491754.8202, 'hit_ratio@10': 0.0652, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6034}:  30%|███       | 3/10 [00:03<00:07,  1.04s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 932618816.9942, 'hit_ratio@10': 0.1114, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5855}:  30%|███       | 3/10 [00:05<00:07,  1.04s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 932618816.9942, 'hit_ratio@10': 0.1114, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5855}:  40%|████      | 4/10 [00:05<00:07,  1.25s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 746095054.1702, 'hit_ratio@10': 0.1531, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5351}:  40%|████      | 4/10 [00:08<00:07,  1.25s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 746095054.1702, 'hit_ratio@10': 0.1531, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5351}:  50%|█████     | 5/10 [00:08<00:09,  1.95s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 622227479.47, 'hit_ratio@10': 0.1424, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6106}:  50%|█████     | 5/10 [00:11<00:09,  1.95s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 622227479.47, 'hit_ratio@10': 0.1424, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6106}:  60%|██████    | 6/10 [00:11<00:09,  2.32s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 533337840.0123, 'hit_ratio@10': 0.1449, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6675}:  60%|██████    | 6/10 [00:12<00:09,  2.32s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 533337840.0123, 'hit_ratio@10': 0.1449, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6675}:  70%|███████   | 7/10 [00:12<00:06,  2.06s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 466842900.4467, 'hit_ratio@10': 0.1518, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5901}:  70%|███████   | 7/10 [00:14<00:06,  2.06s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 466842900.4467, 'hit_ratio@10': 0.1518, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5901}:  80%|████████  | 8/10 [00:14<00:04,  2.07s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 417218453.2716, 'hit_ratio@10': 0.1445, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7797}:  80%|████████  | 8/10 [00:17<00:04,  2.07s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 417218453.2716, 'hit_ratio@10': 0.1445, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7797}:  90%|█████████ | 9/10 [00:17<00:02,  2.10s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 400752876.9689, 'hit_ratio@10': 0.1459, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7646}:  90%|█████████ | 9/10 [00:19<00:02,  2.10s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 400752876.9689, 'hit_ratio@10': 0.1459, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7646}: 100%|██████████| 10/10 [00:19<00:00,  2.27s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 400752876.9689, 'hit_ratio@10': 0.1459, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7646}: 100%|██████████| 10/10 [00:19<00:00,  1.97s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 400752876.96890223
Avg hit ratio: 0.1459182805498595
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.76464958190918
Std train time: 1.5045426583531003
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 1097986960.8421, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2854}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 1097986960.8421, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2854}:  10%|█         | 1/10 [00:01<00:10,  1.17s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 549940816.9665, 'hit_ratio@10': 0.0688, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0913}:  10%|█         | 1/10 [00:03<00:10,  1.17s/it] {'epoch': 47, 'num_users': 7.0, 'loss': 549940816.9665, 'hit_ratio@10': 0.0688, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0913}:  20%|██        | 2/10 [00:03<00:13,  1.63s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 25829064635445.98, 'hit_ratio@10': 0.0458, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6319}:  20%|██        | 2/10 [00:03<00:13,  1.63s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 25829064635445.98, 'hit_ratio@10': 0.0458, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6319}:  30%|███       | 3/10 [00:03<00:07,  1.06s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 19371811022097.035, 'hit_ratio@10': 0.0701, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6298}:  30%|███       | 3/10 [00:05<00:07,  1.06s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 19371811022097.035, 'hit_ratio@10': 0.0701, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6298}:  40%|████      | 4/10 [00:05<00:07,  1.29s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 15497526210702.434, 'hit_ratio@10': 0.0961, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5339}:  40%|████      | 4/10 [00:08<00:07,  1.29s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 15497526210702.434, 'hit_ratio@10': 0.0961, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5339}:  50%|█████     | 5/10 [00:08<00:09,  1.95s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 12914637999708.639, 'hit_ratio@10': 0.1134, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6094}:  50%|█████     | 5/10 [00:11<00:09,  1.95s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 12914637999708.639, 'hit_ratio@10': 0.1134, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6094}:  60%|██████    | 6/10 [00:11<00:09,  2.31s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 11069690576876.45, 'hit_ratio@10': 0.1029, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6588}:  60%|██████    | 6/10 [00:12<00:09,  2.31s/it] {'epoch': 47, 'num_users': 6.2857, 'loss': 11069690576876.45, 'hit_ratio@10': 0.1029, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6588}:  70%|███████   | 7/10 [00:12<00:06,  2.05s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 9685987793147.393, 'hit_ratio@10': 0.1079, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5844}:  70%|███████   | 7/10 [00:14<00:06,  2.05s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 9685987793147.393, 'hit_ratio@10': 0.1079, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5844}:  80%|████████  | 8/10 [00:14<00:04,  2.06s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 8609770362634.139, 'hit_ratio@10': 0.1023, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7607}:  80%|████████  | 8/10 [00:16<00:04,  2.06s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 8609770362634.139, 'hit_ratio@10': 0.1023, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7607}:  90%|█████████ | 9/10 [00:16<00:02,  2.08s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 7748793326371.06, 'hit_ratio@10': 0.1125, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7482}:  90%|█████████ | 9/10 [00:19<00:02,  2.08s/it]    {'epoch': 47, 'num_users': 6.3, 'loss': 7748793326371.06, 'hit_ratio@10': 0.1125, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7482}: 100%|██████████| 10/10 [00:19<00:00,  2.26s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 7748793326371.06, 'hit_ratio@10': 0.1125, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7482}: 100%|██████████| 10/10 [00:19<00:00,  1.97s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 7748793326371.061
Avg hit ratio: 0.11249238198134633
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7481814861297607
Std train time: 1.4325861768808499
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 25608055.3158, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1427}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 25608055.3158, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1427}:  10%|█         | 1/10 [00:01<00:09,  1.10s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 19298507.9683, 'hit_ratio@10': 0.0424, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9878}:  10%|█         | 1/10 [00:02<00:09,  1.10s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 19298507.9683, 'hit_ratio@10': 0.0424, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9878}:  20%|██        | 2/10 [00:02<00:12,  1.55s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 13018466878.836, 'hit_ratio@10': 0.0283, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5354}:  20%|██        | 2/10 [00:03<00:12,  1.55s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 13018466878.836, 'hit_ratio@10': 0.0283, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5354}:  30%|███       | 3/10 [00:03<00:06,  1.00it/s]{'epoch': 48, 'num_users': 5.0, 'loss': 9767445291.4118, 'hit_ratio@10': 0.0659, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5653}:  30%|███       | 3/10 [00:04<00:06,  1.00it/s]{'epoch': 48, 'num_users': 5.0, 'loss': 9767445291.4118, 'hit_ratio@10': 0.0659, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5653}:  40%|████      | 4/10 [00:04<00:07,  1.27s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 7813956233.7033, 'hit_ratio@10': 0.1167, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5503}:  40%|████      | 4/10 [00:08<00:07,  1.27s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 7813956233.7033, 'hit_ratio@10': 0.1167, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5503}:  50%|█████     | 5/10 [00:08<00:09,  1.99s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 6511630195.3435, 'hit_ratio@10': 0.138, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.57}:  50%|█████     | 5/10 [00:10<00:09,  1.99s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 6511630195.3435, 'hit_ratio@10': 0.138, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.57}:  60%|██████    | 6/10 [00:10<00:08,  2.23s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 5585998997.6545, 'hit_ratio@10': 0.1354, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6147}:  60%|██████    | 6/10 [00:12<00:08,  2.23s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 5585998997.6545, 'hit_ratio@10': 0.1354, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6147}:  70%|███████   | 7/10 [00:12<00:05,  1.98s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 4887749123.2664, 'hit_ratio@10': 0.1542, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5412}:  70%|███████   | 7/10 [00:14<00:05,  1.98s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 4887749123.2664, 'hit_ratio@10': 0.1542, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5412}:  80%|████████  | 8/10 [00:14<00:04,  2.01s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 4358780090.4271, 'hit_ratio@10': 0.1402, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7247}:  80%|████████  | 8/10 [00:16<00:04,  2.01s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 4358780090.4271, 'hit_ratio@10': 0.1402, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7247}:  90%|█████████ | 9/10 [00:16<00:02,  2.04s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 3922902081.7189, 'hit_ratio@10': 0.1467, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7115}:  90%|█████████ | 9/10 [00:19<00:02,  2.04s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 3922902081.7189, 'hit_ratio@10': 0.1467, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7115}: 100%|██████████| 10/10 [00:19<00:00,  2.22s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 3922902081.7189, 'hit_ratio@10': 0.1467, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7115}: 100%|██████████| 10/10 [00:19<00:00,  1.92s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 3922902081.718858
Avg hit ratio: 0.14667366853105393
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7115381956100464
Std train time: 1.533972392371437
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 3291866260.8421, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4177}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 3291866260.8421, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4177}:  10%|█         | 1/10 [00:01<00:11,  1.24s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 1741186407.3077, 'hit_ratio@10': 0.0424, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1551}:  10%|█         | 1/10 [00:03<00:11,  1.24s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 1741186407.3077, 'hit_ratio@10': 0.0424, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1551}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 7162140899177.444, 'hit_ratio@10': 0.0759, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6605}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 7162140899177.444, 'hit_ratio@10': 0.0759, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6605}:  30%|███       | 3/10 [00:03<00:07,  1.06s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 5372648258646.654, 'hit_ratio@10': 0.0748, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6352}:  30%|███       | 3/10 [00:05<00:07,  1.06s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 5372648258646.654, 'hit_ratio@10': 0.0748, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6352}:  40%|████      | 4/10 [00:05<00:07,  1.27s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 4298134713277.0166, 'hit_ratio@10': 0.1158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5316}:  40%|████      | 4/10 [00:08<00:07,  1.27s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 4298134713277.0166, 'hit_ratio@10': 0.1158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5316}:  50%|█████     | 5/10 [00:08<00:09,  1.93s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 3582319775979.617, 'hit_ratio@10': 0.1262, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5616}:  50%|█████     | 5/10 [00:10<00:09,  1.93s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 3582319775979.617, 'hit_ratio@10': 0.1262, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5616}:  60%|██████    | 6/10 [00:10<00:08,  2.20s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 3070652609860.212, 'hit_ratio@10': 0.1081, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.604}:  60%|██████    | 6/10 [00:12<00:08,  2.20s/it] {'epoch': 49, 'num_users': 6.2857, 'loss': 3070652609860.212, 'hit_ratio@10': 0.1081, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.604}:  70%|███████   | 7/10 [00:12<00:05,  1.96s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 2686821033628.004, 'hit_ratio@10': 0.1303, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5604}:  70%|███████   | 7/10 [00:14<00:05,  1.96s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 2686821033628.004, 'hit_ratio@10': 0.1303, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5604}:  80%|████████  | 8/10 [00:14<00:04,  2.06s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 3038454519868122.0, 'hit_ratio@10': 0.1159, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7309}:  80%|████████  | 8/10 [00:16<00:04,  2.06s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 3038454519868122.0, 'hit_ratio@10': 0.1159, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7309}:  90%|█████████ | 9/10 [00:16<00:02,  2.07s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 2734610099832981.5, 'hit_ratio@10': 0.1134, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7003}:  90%|█████████ | 9/10 [00:19<00:02,  2.07s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 2734610099832981.5, 'hit_ratio@10': 0.1134, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7003}: 100%|██████████| 10/10 [00:19<00:00,  2.18s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 2734610099832981.5, 'hit_ratio@10': 0.1134, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7003}: 100%|██████████| 10/10 [00:19<00:00,  1.92s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 2734610099832981.5
Avg hit ratio: 0.1133576512150366
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.700255823135376
Std train time: 1.4166901107151046
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
