  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 2.6237, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 0.6, 'time@10': 3.0528}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 2.6237, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 0.6, 'time@10': 3.0528}:  10%|█         | 1/10 [00:01<00:14,  1.58s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 2.7386, 'hit_ratio@10': 0.0556, 'ndcg@10': 0.0, 'compress@10': 0.5778, 'time@10': 2.5568}:  10%|█         | 1/10 [00:03<00:14,  1.58s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 2.7386, 'hit_ratio@10': 0.0556, 'ndcg@10': 0.0, 'compress@10': 0.5778, 'time@10': 2.5568}:  20%|██        | 2/10 [00:03<00:15,  1.89s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 2.3096, 'hit_ratio@10': 0.037, 'ndcg@10': 0.0, 'compress@10': 0.6352, 'time@10': 1.8827}:  20%|██        | 2/10 [00:03<00:15,  1.89s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 2.3096, 'hit_ratio@10': 0.037, 'ndcg@10': 0.0, 'compress@10': 0.6352, 'time@10': 1.8827}:  30%|███       | 3/10 [00:03<00:08,  1.16s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 2.4464, 'hit_ratio@10': 0.059, 'ndcg@10': 0.0, 'compress@10': 0.617, 'time@10': 1.8469}:  30%|███       | 3/10 [00:05<00:08,  1.16s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 2.4464, 'hit_ratio@10': 0.059, 'ndcg@10': 0.0, 'compress@10': 0.617, 'time@10': 1.8469}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 2.2186, 'hit_ratio@10': 0.078, 'ndcg@10': 0.0075, 'compress@10': 0.6013, 'time@10': 2.7078}:  40%|████      | 4/10 [00:08<00:08,  1.41s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 2.2186, 'hit_ratio@10': 0.078, 'ndcg@10': 0.0075, 'compress@10': 0.6013, 'time@10': 2.7078}:  50%|█████     | 5/10 [00:08<00:10,  2.02s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 2.2123, 'hit_ratio@10': 0.0928, 'ndcg@10': 0.0111, 'compress@10': 0.5914, 'time@10': 2.7062}:  50%|█████     | 5/10 [00:11<00:10,  2.02s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 2.2123, 'hit_ratio@10': 0.0928, 'ndcg@10': 0.0111, 'compress@10': 0.5914, 'time@10': 2.7062}:  60%|██████    | 6/10 [00:11<00:09,  2.27s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 2.2783, 'hit_ratio@10': 0.0795, 'ndcg@10': 0.0096, 'compress@10': 0.5885, 'time@10': 2.7501}:  60%|██████    | 6/10 [00:13<00:09,  2.27s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 2.2783, 'hit_ratio@10': 0.0795, 'ndcg@10': 0.0096, 'compress@10': 0.5885, 'time@10': 2.7501}:  70%|███████   | 7/10 [00:13<00:06,  2.03s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 2.227, 'hit_ratio@10': 0.0696, 'ndcg@10': 0.0089, 'compress@10': 0.5837, 'time@10': 2.6842}:  70%|███████   | 7/10 [00:15<00:06,  2.03s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 2.227, 'hit_ratio@10': 0.0696, 'ndcg@10': 0.0089, 'compress@10': 0.5837, 'time@10': 2.6842}:  80%|████████  | 8/10 [00:15<00:04,  2.10s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 2.3402, 'hit_ratio@10': 0.0989, 'ndcg@10': 0.0079, 'compress@10': 0.5806, 'time@10': 2.8316}:  80%|████████  | 8/10 [00:17<00:04,  2.10s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 2.3402, 'hit_ratio@10': 0.0989, 'ndcg@10': 0.0079, 'compress@10': 0.5806, 'time@10': 2.8316}:  90%|█████████ | 9/10 [00:17<00:02,  2.08s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 2.3045, 'hit_ratio@10': 0.0973, 'ndcg@10': 0.0101, 'compress@10': 0.5767, 'time@10': 2.8186}:  90%|█████████ | 9/10 [00:20<00:02,  2.08s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 2.3045, 'hit_ratio@10': 0.0973, 'ndcg@10': 0.0101, 'compress@10': 0.5767, 'time@10': 2.8186}: 100%|██████████| 10/10 [00:20<00:00,  2.29s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 2.3045, 'hit_ratio@10': 0.0973, 'ndcg@10': 0.0101, 'compress@10': 0.5767, 'time@10': 2.8186}: 100%|██████████| 10/10 [00:20<00:00,  2.02s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 2.304527674224205
Avg hit ratio: 0.09732905982905983
Avg ndcg: 0.010078125464300945
Avg compression ratio: 0.576681005860223
Avg train time: 2.818600082397461
Std train time: 1.4128556242955252
[0.75, 0.75, 0.25, 0.75, 0.25, 0.25, 0.75, 0.25, 0.75, 0.25]
[10, 10, 11, 10, 9, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 1.5767, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0258, 'compress@10': 0.8, 'time@10': 1.8588}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 1.5767, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0258, 'compress@10': 0.8, 'time@10': 1.8588}:  10%|█         | 1/10 [00:00<00:08,  1.03it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.8695, 'hit_ratio@10': 0.0556, 'ndcg@10': 0.2999, 'compress@10': 0.7889, 'time@10': 1.8807}:  10%|█         | 1/10 [00:02<00:08,  1.03it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.8695, 'hit_ratio@10': 0.0556, 'ndcg@10': 0.2999, 'compress@10': 0.7889, 'time@10': 1.8807}:  20%|██        | 2/10 [00:02<00:12,  1.54s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.9856, 'hit_ratio@10': 0.037, 'ndcg@10': 0.1999, 'compress@10': 0.7343, 'time@10': 1.4297}:  20%|██        | 2/10 [00:03<00:12,  1.54s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.9856, 'hit_ratio@10': 0.037, 'ndcg@10': 0.1999, 'compress@10': 0.7343, 'time@10': 1.4297}:  30%|███       | 3/10 [00:03<00:06,  1.03it/s]{'epoch': 1, 'num_users': 5.0, 'loss': 0.7949, 'hit_ratio@10': 0.059, 'ndcg@10': 0.2391, 'compress@10': 0.746, 'time@10': 1.4758}:  30%|███       | 3/10 [00:04<00:06,  1.03it/s] {'epoch': 1, 'num_users': 5.0, 'loss': 0.7949, 'hit_ratio@10': 0.059, 'ndcg@10': 0.2391, 'compress@10': 0.746, 'time@10': 1.4758}:  40%|████      | 4/10 [00:04<00:07,  1.24s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.6686, 'hit_ratio@10': 0.0934, 'ndcg@10': 0.2704, 'compress@10': 0.6583, 'time@10': 2.2652}:  40%|████      | 4/10 [00:07<00:07,  1.24s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.6686, 'hit_ratio@10': 0.0934, 'ndcg@10': 0.2704, 'compress@10': 0.6583, 'time@10': 2.2652}:  50%|█████     | 5/10 [00:07<00:08,  1.79s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.5797, 'hit_ratio@10': 0.1056, 'ndcg@10': 0.3073, 'compress@10': 0.6007, 'time@10': 2.3303}:  50%|█████     | 5/10 [00:10<00:08,  1.79s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.5797, 'hit_ratio@10': 0.1056, 'ndcg@10': 0.3073, 'compress@10': 0.6007, 'time@10': 2.3303}:  60%|██████    | 6/10 [00:10<00:08,  2.09s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.5662, 'hit_ratio@10': 0.1313, 'ndcg@10': 0.286, 'compress@10': 0.6271, 'time@10': 2.396}:  60%|██████    | 6/10 [00:11<00:08,  2.09s/it]  {'epoch': 1, 'num_users': 6.2857, 'loss': 0.5662, 'hit_ratio@10': 0.1313, 'ndcg@10': 0.286, 'compress@10': 0.6271, 'time@10': 2.396}:  70%|███████   | 7/10 [00:11<00:05,  1.88s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.512, 'hit_ratio@10': 0.1399, 'ndcg@10': 0.2952, 'compress@10': 0.5894, 'time@10': 2.3738}:  70%|███████   | 7/10 [00:13<00:05,  1.88s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.512, 'hit_ratio@10': 0.1399, 'ndcg@10': 0.2952, 'compress@10': 0.5894, 'time@10': 2.3738}:  80%|████████  | 8/10 [00:13<00:03,  2.00s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.4743, 'hit_ratio@10': 0.1491, 'ndcg@10': 0.3435, 'compress@10': 0.6103, 'time@10': 2.5591}:  80%|████████  | 8/10 [00:16<00:03,  2.00s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.4743, 'hit_ratio@10': 0.1491, 'ndcg@10': 0.3435, 'compress@10': 0.6103, 'time@10': 2.5591}:  90%|█████████ | 9/10 [00:16<00:02,  2.02s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.4385, 'hit_ratio@10': 0.1841, 'ndcg@10': 0.3542, 'compress@10': 0.5805, 'time@10': 2.5775}:  90%|█████████ | 9/10 [00:18<00:02,  2.02s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.4385, 'hit_ratio@10': 0.1841, 'ndcg@10': 0.3542, 'compress@10': 0.5805, 'time@10': 2.5775}: 100%|██████████| 10/10 [00:18<00:00,  2.25s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.4385, 'hit_ratio@10': 0.1841, 'ndcg@10': 0.3542, 'compress@10': 0.5805, 'time@10': 2.5775}: 100%|██████████| 10/10 [00:18<00:00,  1.88s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.43852315752347415
Avg hit ratio: 0.18414835164835167
Avg ndcg: 0.3542011654641493
Avg compression ratio: 0.5805187415584504
Avg train time: 2.5775479555130003
Std train time: 1.2863626772506964
[0.8333333333333334, 0.5, 0.5, 0.8333333333333334, 0.16666666666666669, 0.16666666666666669, 0.8333333333333334, 0.16666666666666669, 0.8333333333333334, 0.16666666666666669]
[10, 10, 12, 10, 8, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.1406, 'hit_ratio@10': 0.2, 'ndcg@10': 0.4735, 'compress@10': 0.8667, 'time@10': 1.8955}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.1406, 'hit_ratio@10': 0.2, 'ndcg@10': 0.4735, 'compress@10': 0.8667, 'time@10': 1.8955}:  10%|█         | 1/10 [00:00<00:08,  1.02it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.1116, 'hit_ratio@10': 0.2111, 'ndcg@10': 0.5346, 'compress@10': 0.7111, 'time@10': 1.9807}:  10%|█         | 1/10 [00:03<00:08,  1.02it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.1116, 'hit_ratio@10': 0.2111, 'ndcg@10': 0.5346, 'compress@10': 0.7111, 'time@10': 1.9807}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.2451, 'hit_ratio@10': 0.1407, 'ndcg@10': 0.3775, 'compress@10': 0.7241, 'time@10': 1.5128}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.2451, 'hit_ratio@10': 0.1407, 'ndcg@10': 0.3775, 'compress@10': 0.7241, 'time@10': 1.5128}:  30%|███       | 3/10 [00:03<00:07,  1.04s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.2083, 'hit_ratio@10': 0.1681, 'ndcg@10': 0.4288, 'compress@10': 0.7566, 'time@10': 1.5532}:  30%|███       | 3/10 [00:05<00:07,  1.04s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.2083, 'hit_ratio@10': 0.1681, 'ndcg@10': 0.4288, 'compress@10': 0.7566, 'time@10': 1.5532}:  40%|████      | 4/10 [00:05<00:07,  1.31s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.1891, 'hit_ratio@10': 0.196, 'ndcg@10': 0.4512, 'compress@10': 0.6514, 'time@10': 2.1985}:  40%|████      | 4/10 [00:07<00:07,  1.31s/it] {'epoch': 2, 'num_users': 5.8, 'loss': 0.1891, 'hit_ratio@10': 0.196, 'ndcg@10': 0.4512, 'compress@10': 0.6514, 'time@10': 2.1985}:  50%|█████     | 5/10 [00:07<00:08,  1.71s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.173, 'hit_ratio@10': 0.1911, 'ndcg@10': 0.4875, 'compress@10': 0.5822, 'time@10': 2.2789}:  50%|█████     | 5/10 [00:10<00:08,  1.71s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.173, 'hit_ratio@10': 0.1911, 'ndcg@10': 0.4875, 'compress@10': 0.5822, 'time@10': 2.2789}:  60%|██████    | 6/10 [00:10<00:08,  2.06s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.161, 'hit_ratio@10': 0.2046, 'ndcg@10': 0.4925, 'compress@10': 0.6215, 'time@10': 2.3552}:  60%|██████    | 6/10 [00:11<00:08,  2.06s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.161, 'hit_ratio@10': 0.2046, 'ndcg@10': 0.4925, 'compress@10': 0.6215, 'time@10': 2.3552}:  70%|███████   | 7/10 [00:11<00:05,  1.85s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.1487, 'hit_ratio@10': 0.2415, 'ndcg@10': 0.4955, 'compress@10': 0.575, 'time@10': 2.3321}:  70%|███████   | 7/10 [00:13<00:05,  1.85s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.1487, 'hit_ratio@10': 0.2415, 'ndcg@10': 0.4955, 'compress@10': 0.575, 'time@10': 2.3321}:  80%|████████  | 8/10 [00:13<00:03,  1.97s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.141, 'hit_ratio@10': 0.2394, 'ndcg@10': 0.5203, 'compress@10': 0.6058, 'time@10': 2.517}:  80%|████████  | 8/10 [00:15<00:03,  1.97s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.141, 'hit_ratio@10': 0.2394, 'ndcg@10': 0.5203, 'compress@10': 0.6058, 'time@10': 2.517}:  90%|█████████ | 9/10 [00:15<00:01,  1.99s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.1338, 'hit_ratio@10': 0.2655, 'ndcg@10': 0.529, 'compress@10': 0.5688, 'time@10': 2.5309}:  90%|█████████ | 9/10 [00:18<00:01,  1.99s/it]  {'epoch': 2, 'num_users': 6.3, 'loss': 0.1338, 'hit_ratio@10': 0.2655, 'ndcg@10': 0.529, 'compress@10': 0.5688, 'time@10': 2.5309}: 100%|██████████| 10/10 [00:18<00:00,  2.21s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.1338, 'hit_ratio@10': 0.2655, 'ndcg@10': 0.529, 'compress@10': 0.5688, 'time@10': 2.5309}: 100%|██████████| 10/10 [00:18<00:00,  1.87s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.1337829186507388
Avg hit ratio: 0.26545177045177043
Avg ndcg: 0.5290246503707128
Avg compression ratio: 0.5688351428756201
Avg train time: 2.530923295021057
Std train time: 1.1235072110246846
[0.875, 0.375, 0.625, 0.875, 0.375, 0.375, 0.625, 0.125, 0.625, 0.125]
[10, 10, 13, 10, 7, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0929, 'hit_ratio@10': 0.4, 'ndcg@10': 0.5251, 'compress@10': 0.9, 'time@10': 1.8569}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0929, 'hit_ratio@10': 0.4, 'ndcg@10': 0.5251, 'compress@10': 0.9, 'time@10': 1.8569}:  10%|█         | 1/10 [00:00<00:08,  1.04it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0786, 'hit_ratio@10': 0.3667, 'ndcg@10': 0.6309, 'compress@10': 0.6722, 'time@10': 1.9367}:  10%|█         | 1/10 [00:03<00:08,  1.04it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0786, 'hit_ratio@10': 0.3667, 'ndcg@10': 0.6309, 'compress@10': 0.6722, 'time@10': 1.9367}:  20%|██        | 2/10 [00:03<00:12,  1.60s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.1141, 'hit_ratio@10': 0.2444, 'ndcg@10': 0.4703, 'compress@10': 0.719, 'time@10': 1.4999}:  20%|██        | 2/10 [00:03<00:12,  1.60s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.1141, 'hit_ratio@10': 0.2444, 'ndcg@10': 0.4703, 'compress@10': 0.719, 'time@10': 1.4999}:  30%|███       | 3/10 [00:03<00:07,  1.03s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.1022, 'hit_ratio@10': 0.2771, 'ndcg@10': 0.5238, 'compress@10': 0.7619, 'time@10': 1.5382}:  30%|███       | 3/10 [00:05<00:07,  1.03s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.1022, 'hit_ratio@10': 0.2771, 'ndcg@10': 0.5238, 'compress@10': 0.7619, 'time@10': 1.5382}:  40%|████      | 4/10 [00:05<00:07,  1.29s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.1036, 'hit_ratio@10': 0.2832, 'ndcg@10': 0.5328, 'compress@10': 0.6941, 'time@10': 2.0811}:  40%|████      | 4/10 [00:07<00:07,  1.29s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.1036, 'hit_ratio@10': 0.2832, 'ndcg@10': 0.5328, 'compress@10': 0.6941, 'time@10': 2.0811}:  50%|█████     | 5/10 [00:07<00:08,  1.61s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0991, 'hit_ratio@10': 0.2638, 'ndcg@10': 0.5658, 'compress@10': 0.6496, 'time@10': 2.1964}:  50%|█████     | 5/10 [00:10<00:08,  1.61s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0991, 'hit_ratio@10': 0.2638, 'ndcg@10': 0.5658, 'compress@10': 0.6496, 'time@10': 2.1964}:  60%|██████    | 6/10 [00:10<00:08,  2.07s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0939, 'hit_ratio@10': 0.3077, 'ndcg@10': 0.5767, 'compress@10': 0.6538, 'time@10': 2.3076}:  60%|██████    | 6/10 [00:11<00:08,  2.07s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0939, 'hit_ratio@10': 0.3077, 'ndcg@10': 0.5767, 'compress@10': 0.6538, 'time@10': 2.3076}:  70%|███████   | 7/10 [00:11<00:05,  1.89s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0885, 'hit_ratio@10': 0.3318, 'ndcg@10': 0.5799, 'compress@10': 0.5986, 'time@10': 2.282}:  70%|███████   | 7/10 [00:13<00:05,  1.89s/it]  {'epoch': 3, 'num_users': 6.125, 'loss': 0.0885, 'hit_ratio@10': 0.3318, 'ndcg@10': 0.5799, 'compress@10': 0.5986, 'time@10': 2.282}:  80%|████████  | 8/10 [00:13<00:03,  1.97s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0843, 'hit_ratio@10': 0.3072, 'ndcg@10': 0.6076, 'compress@10': 0.6062, 'time@10': 2.4737}:  80%|████████  | 8/10 [00:15<00:03,  1.97s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0843, 'hit_ratio@10': 0.3072, 'ndcg@10': 0.6076, 'compress@10': 0.6062, 'time@10': 2.4737}:  90%|█████████ | 9/10 [00:15<00:01,  1.99s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0807, 'hit_ratio@10': 0.3349, 'ndcg@10': 0.62, 'compress@10': 0.5653, 'time@10': 2.487}:  90%|█████████ | 9/10 [00:18<00:01,  1.99s/it]      {'epoch': 3, 'num_users': 6.3, 'loss': 0.0807, 'hit_ratio@10': 0.3349, 'ndcg@10': 0.62, 'compress@10': 0.5653, 'time@10': 2.487}: 100%|██████████| 10/10 [00:18<00:00,  2.19s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0807, 'hit_ratio@10': 0.3349, 'ndcg@10': 0.62, 'compress@10': 0.5653, 'time@10': 2.487}: 100%|██████████| 10/10 [00:18<00:00,  1.85s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.08070737252730573
Avg hit ratio: 0.33485653235653234
Avg ndcg: 0.6199862137132003
Avg compression ratio: 0.5653360595332143
Avg train time: 2.486954426765442
Std train time: 1.0337672189207434
[0.9, 0.3, 0.7, 0.9, 0.5, 0.5, 0.5, 0.1, 0.5, 0.1]
[10, 10, 14, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0709, 'hit_ratio@10': 0.4, 'ndcg@10': 0.562, 'compress@10': 0.92, 'time@10': 1.829}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0709, 'hit_ratio@10': 0.4, 'ndcg@10': 0.562, 'compress@10': 0.92, 'time@10': 1.829}:  10%|█         | 1/10 [00:00<00:08,  1.05it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0619, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.6729, 'compress@10': 0.6489, 'time@10': 1.9008}:  10%|█         | 1/10 [00:02<00:08,  1.05it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0619, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.6729, 'compress@10': 0.6489, 'time@10': 1.9008}:  20%|██        | 2/10 [00:02<00:12,  1.57s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.071, 'hit_ratio@10': 0.2074, 'ndcg@10': 0.528, 'compress@10': 0.7159, 'time@10': 1.4991}:  20%|██        | 2/10 [00:03<00:12,  1.57s/it]  {'epoch': 4, 'num_users': 5.0, 'loss': 0.071, 'hit_ratio@10': 0.2074, 'ndcg@10': 0.528, 'compress@10': 0.7159, 'time@10': 1.4991}:  30%|███       | 3/10 [00:03<00:07,  1.03s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0649, 'hit_ratio@10': 0.2181, 'ndcg@10': 0.5868, 'compress@10': 0.7651, 'time@10': 1.5274}:  30%|███       | 3/10 [00:04<00:07,  1.03s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0649, 'hit_ratio@10': 0.2181, 'ndcg@10': 0.5868, 'compress@10': 0.7651, 'time@10': 1.5274}:  40%|████      | 4/10 [00:04<00:07,  1.27s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0721, 'hit_ratio@10': 0.236, 'ndcg@10': 0.5909, 'compress@10': 0.7197, 'time@10': 1.9404}:  40%|████      | 4/10 [00:06<00:07,  1.27s/it] {'epoch': 4, 'num_users': 5.8, 'loss': 0.0721, 'hit_ratio@10': 0.236, 'ndcg@10': 0.5909, 'compress@10': 0.7197, 'time@10': 1.9404}:  50%|█████     | 5/10 [00:06<00:07,  1.48s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0714, 'hit_ratio@10': 0.2244, 'ndcg@10': 0.6145, 'compress@10': 0.6901, 'time@10': 2.0807}:  50%|█████     | 5/10 [00:09<00:07,  1.48s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0714, 'hit_ratio@10': 0.2244, 'ndcg@10': 0.6145, 'compress@10': 0.6901, 'time@10': 2.0807}:  60%|██████    | 6/10 [00:09<00:07,  1.93s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0677, 'hit_ratio@10': 0.274, 'ndcg@10': 0.6293, 'compress@10': 0.6731, 'time@10': 2.2294}:  60%|██████    | 6/10 [00:11<00:07,  1.93s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.0677, 'hit_ratio@10': 0.274, 'ndcg@10': 0.6293, 'compress@10': 0.6731, 'time@10': 2.2294}:  70%|███████   | 7/10 [00:11<00:05,  1.82s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0645, 'hit_ratio@10': 0.3273, 'ndcg@10': 0.6326, 'compress@10': 0.6127, 'time@10': 2.2108}:  70%|███████   | 7/10 [00:13<00:05,  1.82s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0645, 'hit_ratio@10': 0.3273, 'ndcg@10': 0.6326, 'compress@10': 0.6127, 'time@10': 2.2108}:  80%|████████  | 8/10 [00:13<00:03,  1.92s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0612, 'hit_ratio@10': 0.3032, 'ndcg@10': 0.6561, 'compress@10': 0.6064, 'time@10': 2.4104}:  80%|████████  | 8/10 [00:15<00:03,  1.92s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0612, 'hit_ratio@10': 0.3032, 'ndcg@10': 0.6561, 'compress@10': 0.6064, 'time@10': 2.4104}:  90%|█████████ | 9/10 [00:15<00:01,  1.95s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0595, 'hit_ratio@10': 0.3229, 'ndcg@10': 0.6665, 'compress@10': 0.5632, 'time@10': 2.4411}:  90%|█████████ | 9/10 [00:18<00:01,  1.95s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0595, 'hit_ratio@10': 0.3229, 'ndcg@10': 0.6665, 'compress@10': 0.5632, 'time@10': 2.4411}: 100%|██████████| 10/10 [00:18<00:00,  2.20s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0595, 'hit_ratio@10': 0.3229, 'ndcg@10': 0.6665, 'compress@10': 0.5632, 'time@10': 2.4411}: 100%|██████████| 10/10 [00:18<00:00,  1.82s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.05946443136347065
Avg hit ratio: 0.3229120879120879
Avg ndcg: 0.6665241263232023
Avg compression ratio: 0.5632373754769764
Avg train time: 2.4410574674606322
Std train time: 0.9429496654118951
[0.9166666666666667, 0.41666666666666663, 0.75, 0.75, 0.5833333333333334, 0.5833333333333334, 0.4166666666666667, 0.08333333333333334, 0.4166666666666667, 0.08333333333333334]
[10, 10, 15, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0542, 'hit_ratio@10': 0.4, 'ndcg@10': 0.6299, 'compress@10': 0.9333, 'time@10': 1.9021}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0542, 'hit_ratio@10': 0.4, 'ndcg@10': 0.6299, 'compress@10': 0.9333, 'time@10': 1.9021}:  10%|█         | 1/10 [00:00<00:08,  1.01it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0511, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7126, 'compress@10': 0.7074, 'time@10': 1.9511}:  10%|█         | 1/10 [00:03<00:08,  1.01it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0511, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7126, 'compress@10': 0.7074, 'time@10': 1.9511}:  20%|██        | 2/10 [00:03<00:12,  1.60s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0505, 'hit_ratio@10': 0.2074, 'ndcg@10': 0.5779, 'compress@10': 0.7633, 'time@10': 1.533}:  20%|██        | 2/10 [00:03<00:12,  1.60s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0505, 'hit_ratio@10': 0.2074, 'ndcg@10': 0.5779, 'compress@10': 0.7633, 'time@10': 1.533}:  30%|███       | 3/10 [00:03<00:07,  1.05s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0478, 'hit_ratio@10': 0.2181, 'ndcg@10': 0.6344, 'compress@10': 0.7678, 'time@10': 1.5738}:  30%|███       | 3/10 [00:05<00:07,  1.05s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0478, 'hit_ratio@10': 0.2181, 'ndcg@10': 0.6344, 'compress@10': 0.7678, 'time@10': 1.5738}:  40%|████      | 4/10 [00:05<00:07,  1.32s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0561, 'hit_ratio@10': 0.2514, 'ndcg@10': 0.6357, 'compress@10': 0.7373, 'time@10': 2.0486}:  40%|████      | 4/10 [00:07<00:07,  1.32s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0561, 'hit_ratio@10': 0.2514, 'ndcg@10': 0.6357, 'compress@10': 0.7373, 'time@10': 2.0486}:  50%|█████     | 5/10 [00:07<00:07,  1.57s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0576, 'hit_ratio@10': 0.265, 'ndcg@10': 0.656, 'compress@10': 0.7174, 'time@10': 2.1763}:  50%|█████     | 5/10 [00:10<00:07,  1.57s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0576, 'hit_ratio@10': 0.265, 'ndcg@10': 0.656, 'compress@10': 0.7174, 'time@10': 2.1763}:  60%|██████    | 6/10 [00:10<00:08,  2.00s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0547, 'hit_ratio@10': 0.3088, 'ndcg@10': 0.6694, 'compress@10': 0.6864, 'time@10': 2.2968}:  60%|██████    | 6/10 [00:11<00:08,  2.00s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0547, 'hit_ratio@10': 0.3088, 'ndcg@10': 0.6694, 'compress@10': 0.6864, 'time@10': 2.2968}:  70%|███████   | 7/10 [00:11<00:05,  1.85s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0526, 'hit_ratio@10': 0.3577, 'ndcg@10': 0.6743, 'compress@10': 0.6224, 'time@10': 2.2763}:  70%|███████   | 7/10 [00:13<00:05,  1.85s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0526, 'hit_ratio@10': 0.3577, 'ndcg@10': 0.6743, 'compress@10': 0.6224, 'time@10': 2.2763}:  80%|████████  | 8/10 [00:13<00:03,  1.95s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.3426, 'ndcg@10': 0.6927, 'compress@10': 0.6068, 'time@10': 2.4806}:  80%|████████  | 8/10 [00:15<00:03,  1.95s/it] {'epoch': 5, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.3426, 'ndcg@10': 0.6927, 'compress@10': 0.6068, 'time@10': 2.4806}:  90%|█████████ | 9/10 [00:15<00:01,  2.00s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.3417, 'ndcg@10': 0.6996, 'compress@10': 0.5621, 'time@10': 2.4896}:  90%|█████████ | 9/10 [00:18<00:01,  2.00s/it]  {'epoch': 5, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.3417, 'ndcg@10': 0.6996, 'compress@10': 0.5621, 'time@10': 2.4896}: 100%|██████████| 10/10 [00:18<00:00,  2.19s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.3417, 'ndcg@10': 0.6996, 'compress@10': 0.5621, 'time@10': 2.4896}: 100%|██████████| 10/10 [00:18<00:00,  1.84s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.049005695338143765
Avg hit ratio: 0.34171550671550677
Avg ndcg: 0.6996151965855031
Avg compression ratio: 0.5620698039259155
Avg train time: 2.4895590782165526
Std train time: 0.9858102060954657
[0.9285714285714286, 0.5, 0.7857142857142857, 0.6428571428571429, 0.6428571428571429, 0.6428571428571429, 0.35714285714285715, 0.07142857142857144, 0.35714285714285715, 0.07142857142857144]
[10, 10, 16, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0436, 'hit_ratio@10': 0.4, 'ndcg@10': 0.6859, 'compress@10': 0.9428, 'time@10': 1.8675}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0436, 'hit_ratio@10': 0.4, 'ndcg@10': 0.6859, 'compress@10': 0.9428, 'time@10': 1.8675}:  10%|█         | 1/10 [00:00<00:08,  1.03it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7406, 'compress@10': 0.7492, 'time@10': 1.9245}:  10%|█         | 1/10 [00:02<00:08,  1.03it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7406, 'compress@10': 0.7492, 'time@10': 1.9245}:  20%|██        | 2/10 [00:02<00:12,  1.59s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0401, 'hit_ratio@10': 0.2074, 'ndcg@10': 0.6005, 'compress@10': 0.7971, 'time@10': 1.5593}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0401, 'hit_ratio@10': 0.2074, 'ndcg@10': 0.6005, 'compress@10': 0.7971, 'time@10': 1.5593}:  30%|███       | 3/10 [00:03<00:07,  1.07s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0394, 'hit_ratio@10': 0.1868, 'ndcg@10': 0.6524, 'compress@10': 0.7697, 'time@10': 1.5897}:  30%|███       | 3/10 [00:05<00:07,  1.07s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0394, 'hit_ratio@10': 0.1868, 'ndcg@10': 0.6524, 'compress@10': 0.7697, 'time@10': 1.5897}:  40%|████      | 4/10 [00:05<00:07,  1.32s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0482, 'hit_ratio@10': 0.2264, 'ndcg@10': 0.6568, 'compress@10': 0.7498, 'time@10': 1.9937}:  40%|████      | 4/10 [00:06<00:07,  1.32s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0482, 'hit_ratio@10': 0.2264, 'ndcg@10': 0.6568, 'compress@10': 0.7498, 'time@10': 1.9937}:  50%|█████     | 5/10 [00:06<00:07,  1.51s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0507, 'hit_ratio@10': 0.2442, 'ndcg@10': 0.6749, 'compress@10': 0.7369, 'time@10': 2.1106}:  50%|█████     | 5/10 [00:09<00:07,  1.51s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0507, 'hit_ratio@10': 0.2442, 'ndcg@10': 0.6749, 'compress@10': 0.7369, 'time@10': 2.1106}:  60%|██████    | 6/10 [00:09<00:07,  1.92s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0483, 'hit_ratio@10': 0.2705, 'ndcg@10': 0.6879, 'compress@10': 0.6958, 'time@10': 2.2375}:  60%|██████    | 6/10 [00:11<00:07,  1.92s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0483, 'hit_ratio@10': 0.2705, 'ndcg@10': 0.6879, 'compress@10': 0.6958, 'time@10': 2.2375}:  70%|███████   | 7/10 [00:11<00:05,  1.80s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0467, 'hit_ratio@10': 0.3242, 'ndcg@10': 0.6944, 'compress@10': 0.6294, 'time@10': 2.2277}:  70%|███████   | 7/10 [00:13<00:05,  1.80s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0467, 'hit_ratio@10': 0.3242, 'ndcg@10': 0.6944, 'compress@10': 0.6294, 'time@10': 2.2277}:  80%|████████  | 8/10 [00:13<00:03,  1.92s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0445, 'hit_ratio@10': 0.3005, 'ndcg@10': 0.7119, 'compress@10': 0.6071, 'time@10': 2.4407}:  80%|████████  | 8/10 [00:15<00:03,  1.92s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0445, 'hit_ratio@10': 0.3005, 'ndcg@10': 0.7119, 'compress@10': 0.6071, 'time@10': 2.4407}:  90%|█████████ | 9/10 [00:15<00:01,  1.98s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0439, 'hit_ratio@10': 0.3122, 'ndcg@10': 0.7182, 'compress@10': 0.5612, 'time@10': 2.4533}:  90%|█████████ | 9/10 [00:18<00:01,  1.98s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0439, 'hit_ratio@10': 0.3122, 'ndcg@10': 0.7182, 'compress@10': 0.5612, 'time@10': 2.4533}: 100%|██████████| 10/10 [00:18<00:00,  2.17s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0439, 'hit_ratio@10': 0.3122, 'ndcg@10': 0.7182, 'compress@10': 0.5612, 'time@10': 2.4533}: 100%|██████████| 10/10 [00:18<00:00,  1.82s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04393817901083692
Avg hit ratio: 0.31215201465201464
Avg ndcg: 0.7182088453582446
Avg compression ratio: 0.5612346256130872
Avg train time: 2.453289341926575
Std train time: 0.9196017300785814
[0.9375, 0.5625, 0.6875, 0.5625, 0.6875, 0.6875, 0.3125, 0.06250000000000001, 0.3125, 0.1875]
[10, 10, 17, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7269, 'compress@10': 0.95, 'time@10': 2.0141}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7269, 'compress@10': 0.95, 'time@10': 2.0141}:  10%|█         | 1/10 [00:01<00:09,  1.04s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7674, 'compress@10': 0.7806, 'time@10': 2.015}:  10%|█         | 1/10 [00:03<00:09,  1.04s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7674, 'compress@10': 0.7806, 'time@10': 2.015}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6183, 'compress@10': 0.8016, 'time@10': 1.6494}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6183, 'compress@10': 0.8016, 'time@10': 1.6494}:  30%|███       | 3/10 [00:03<00:07,  1.11s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0349, 'hit_ratio@10': 0.3118, 'ndcg@10': 0.6658, 'compress@10': 0.7555, 'time@10': 1.6818}:  30%|███       | 3/10 [00:05<00:07,  1.11s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0349, 'hit_ratio@10': 0.3118, 'ndcg@10': 0.6658, 'compress@10': 0.7555, 'time@10': 1.6818}:  40%|████      | 4/10 [00:05<00:08,  1.39s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.044, 'hit_ratio@10': 0.3418, 'ndcg@10': 0.6712, 'compress@10': 0.7467, 'time@10': 2.0787}:  40%|████      | 4/10 [00:07<00:08,  1.39s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.044, 'hit_ratio@10': 0.3418, 'ndcg@10': 0.6712, 'compress@10': 0.7467, 'time@10': 2.0787}:  50%|█████     | 5/10 [00:07<00:07,  1.56s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0471, 'hit_ratio@10': 0.3403, 'ndcg@10': 0.6863, 'compress@10': 0.7412, 'time@10': 2.1728}:  50%|█████     | 5/10 [00:09<00:07,  1.56s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0471, 'hit_ratio@10': 0.3403, 'ndcg@10': 0.6863, 'compress@10': 0.7412, 'time@10': 2.1728}:  60%|██████    | 6/10 [00:09<00:07,  1.94s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.045, 'hit_ratio@10': 0.3734, 'ndcg@10': 0.6961, 'compress@10': 0.694, 'time@10': 2.3036}:  60%|██████    | 6/10 [00:11<00:07,  1.94s/it]  {'epoch': 7, 'num_users': 6.2857, 'loss': 0.045, 'hit_ratio@10': 0.3734, 'ndcg@10': 0.6961, 'compress@10': 0.694, 'time@10': 2.3036}:  70%|███████   | 7/10 [00:11<00:05,  1.83s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0436, 'hit_ratio@10': 0.4142, 'ndcg@10': 0.7025, 'compress@10': 0.6268, 'time@10': 2.278}:  70%|███████   | 7/10 [00:13<00:05,  1.83s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0436, 'hit_ratio@10': 0.4142, 'ndcg@10': 0.7025, 'compress@10': 0.6268, 'time@10': 2.278}:  80%|████████  | 8/10 [00:13<00:03,  1.92s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0417, 'hit_ratio@10': 0.3805, 'ndcg@10': 0.7182, 'compress@10': 0.6003, 'time@10': 2.4806}:  80%|████████  | 8/10 [00:15<00:03,  1.92s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0417, 'hit_ratio@10': 0.3805, 'ndcg@10': 0.7182, 'compress@10': 0.6003, 'time@10': 2.4806}:  90%|█████████ | 9/10 [00:15<00:01,  1.98s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0413, 'hit_ratio@10': 0.3841, 'ndcg@10': 0.7239, 'compress@10': 0.5658, 'time@10': 2.4971}:  90%|█████████ | 9/10 [00:18<00:01,  1.98s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0413, 'hit_ratio@10': 0.3841, 'ndcg@10': 0.7239, 'compress@10': 0.5658, 'time@10': 2.4971}: 100%|██████████| 10/10 [00:18<00:00,  2.19s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0413, 'hit_ratio@10': 0.3841, 'ndcg@10': 0.7239, 'compress@10': 0.5658, 'time@10': 2.4971}: 100%|██████████| 10/10 [00:18<00:00,  1.84s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04132046540014182
Avg hit ratio: 0.3841300366300366
Avg ndcg: 0.7238969147431916
Avg compression ratio: 0.5658165983031976
Avg train time: 2.497084641456604
Std train time: 0.8924528598548248
[0.9444444444444444, 0.6111111111111112, 0.6111111111111112, 0.5, 0.7222222222222222, 0.7222222222222222, 0.2777777777777778, 0.055555555555555566, 0.2777777777777778, 0.2777777777777778]
[10, 10, 18, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0357, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7269, 'compress@10': 0.9555, 'time@10': 1.9194}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0357, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7269, 'compress@10': 0.9555, 'time@10': 1.9194}:  10%|█         | 1/10 [00:00<00:08,  1.00it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.7619, 'compress@10': 0.8049, 'time@10': 1.9448}:  10%|█         | 1/10 [00:03<00:08,  1.00it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.7619, 'compress@10': 0.8049, 'time@10': 1.9448}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.337, 'ndcg@10': 0.6147, 'compress@10': 0.8051, 'time@10': 1.5788}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.337, 'ndcg@10': 0.6147, 'compress@10': 0.8051, 'time@10': 1.5788}:  30%|███       | 3/10 [00:03<00:07,  1.07s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.2528, 'ndcg@10': 0.6631, 'compress@10': 0.7445, 'time@10': 1.6291}:  30%|███       | 3/10 [00:05<00:07,  1.07s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.2528, 'ndcg@10': 0.6631, 'compress@10': 0.7445, 'time@10': 1.6291}:  40%|████      | 4/10 [00:05<00:08,  1.37s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0416, 'hit_ratio@10': 0.2791, 'ndcg@10': 0.6717, 'compress@10': 0.7443, 'time@10': 2.0392}:  40%|████      | 4/10 [00:07<00:08,  1.37s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0416, 'hit_ratio@10': 0.2791, 'ndcg@10': 0.6717, 'compress@10': 0.7443, 'time@10': 2.0392}:  50%|█████     | 5/10 [00:07<00:07,  1.55s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.045, 'hit_ratio@10': 0.2882, 'ndcg@10': 0.6867, 'compress@10': 0.7445, 'time@10': 2.164}:  50%|█████     | 5/10 [00:09<00:07,  1.55s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.045, 'hit_ratio@10': 0.2882, 'ndcg@10': 0.6867, 'compress@10': 0.7445, 'time@10': 2.164}:  60%|██████    | 6/10 [00:09<00:07,  1.98s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0432, 'hit_ratio@10': 0.3286, 'ndcg@10': 0.6953, 'compress@10': 0.6925, 'time@10': 2.2964}:  60%|██████    | 6/10 [00:11<00:07,  1.98s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0432, 'hit_ratio@10': 0.3286, 'ndcg@10': 0.6953, 'compress@10': 0.6925, 'time@10': 2.2964}:  70%|███████   | 7/10 [00:11<00:05,  1.86s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0419, 'hit_ratio@10': 0.3751, 'ndcg@10': 0.7021, 'compress@10': 0.6247, 'time@10': 2.2686}:  70%|███████   | 7/10 [00:13<00:05,  1.86s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0419, 'hit_ratio@10': 0.3751, 'ndcg@10': 0.7021, 'compress@10': 0.6247, 'time@10': 2.2686}:  80%|████████  | 8/10 [00:13<00:03,  1.94s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0401, 'hit_ratio@10': 0.3457, 'ndcg@10': 0.7179, 'compress@10': 0.5951, 'time@10': 2.4583}:  80%|████████  | 8/10 [00:15<00:03,  1.94s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0401, 'hit_ratio@10': 0.3457, 'ndcg@10': 0.7179, 'compress@10': 0.5951, 'time@10': 2.4583}:  90%|█████████ | 9/10 [00:15<00:01,  1.96s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0399, 'hit_ratio@10': 0.3528, 'ndcg@10': 0.7236, 'compress@10': 0.5694, 'time@10': 2.4908}:  90%|█████████ | 9/10 [00:18<00:01,  1.96s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0399, 'hit_ratio@10': 0.3528, 'ndcg@10': 0.7236, 'compress@10': 0.5694, 'time@10': 2.4908}: 100%|██████████| 10/10 [00:18<00:00,  2.23s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0399, 'hit_ratio@10': 0.3528, 'ndcg@10': 0.7236, 'compress@10': 0.5694, 'time@10': 2.4908}: 100%|██████████| 10/10 [00:18<00:00,  1.85s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.03986185609036091
Avg hit ratio: 0.35282661782661784
Avg ndcg: 0.7235909224463656
Avg compression ratio: 0.5693813657127458
Avg train time: 2.490754795074463
Std train time: 0.9018499073564216
[0.85, 0.65, 0.55, 0.55, 0.75, 0.75, 0.25, 0.05000000000000001, 0.25, 0.35]
[10, 10, 19, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7366, 'compress@10': 0.88, 'time@10': 1.9649}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7366, 'compress@10': 0.88, 'time@10': 1.9649}:  10%|█         | 1/10 [00:01<00:09,  1.02s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0391, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.7668, 'compress@10': 0.7844, 'time@10': 1.9981}:  10%|█         | 1/10 [00:03<00:09,  1.02s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0391, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.7668, 'compress@10': 0.7844, 'time@10': 1.9981}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.337, 'ndcg@10': 0.6223, 'compress@10': 0.7813, 'time@10': 1.652}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]  {'epoch': 9, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.337, 'ndcg@10': 0.6223, 'compress@10': 0.7813, 'time@10': 1.652}:  30%|███       | 3/10 [00:03<00:07,  1.12s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.2528, 'ndcg@10': 0.6688, 'compress@10': 0.7375, 'time@10': 1.6649}:  30%|███       | 3/10 [00:05<00:07,  1.12s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.2528, 'ndcg@10': 0.6688, 'compress@10': 0.7375, 'time@10': 1.6649}:  40%|████      | 4/10 [00:05<00:08,  1.37s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0401, 'hit_ratio@10': 0.2638, 'ndcg@10': 0.6801, 'compress@10': 0.7439, 'time@10': 2.0657}:  40%|████      | 4/10 [00:07<00:08,  1.37s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0401, 'hit_ratio@10': 0.2638, 'ndcg@10': 0.6801, 'compress@10': 0.7439, 'time@10': 2.0657}:  50%|█████     | 5/10 [00:07<00:07,  1.55s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0437, 'hit_ratio@10': 0.2892, 'ndcg@10': 0.6935, 'compress@10': 0.7484, 'time@10': 2.1671}:  50%|█████     | 5/10 [00:09<00:07,  1.55s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0437, 'hit_ratio@10': 0.2892, 'ndcg@10': 0.6935, 'compress@10': 0.7484, 'time@10': 2.1671}:  60%|██████    | 6/10 [00:09<00:07,  1.94s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0419, 'hit_ratio@10': 0.2887, 'ndcg@10': 0.7012, 'compress@10': 0.6925, 'time@10': 2.2675}:  60%|██████    | 6/10 [00:11<00:07,  1.94s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0419, 'hit_ratio@10': 0.2887, 'ndcg@10': 0.7012, 'compress@10': 0.6925, 'time@10': 2.2675}:  70%|███████   | 7/10 [00:11<00:05,  1.79s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0408, 'hit_ratio@10': 0.3401, 'ndcg@10': 0.7057, 'compress@10': 0.624, 'time@10': 2.235}:  70%|███████   | 7/10 [00:13<00:05,  1.79s/it]   {'epoch': 9, 'num_users': 6.125, 'loss': 0.0408, 'hit_ratio@10': 0.3401, 'ndcg@10': 0.7057, 'compress@10': 0.624, 'time@10': 2.235}:  80%|████████  | 8/10 [00:13<00:03,  1.87s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.039, 'hit_ratio@10': 0.327, 'ndcg@10': 0.7211, 'compress@10': 0.5917, 'time@10': 2.4321}:  80%|████████  | 8/10 [00:15<00:03,  1.87s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.039, 'hit_ratio@10': 0.327, 'ndcg@10': 0.7211, 'compress@10': 0.5917, 'time@10': 2.4321}:  90%|█████████ | 9/10 [00:15<00:01,  1.93s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0389, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7268, 'compress@10': 0.573, 'time@10': 2.4489}:  90%|█████████ | 9/10 [00:18<00:01,  1.93s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0389, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7268, 'compress@10': 0.573, 'time@10': 2.4489}: 100%|██████████| 10/10 [00:18<00:00,  2.15s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0389, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7268, 'compress@10': 0.573, 'time@10': 2.4489}: 100%|██████████| 10/10 [00:18<00:00,  1.81s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03888516279034686
Avg hit ratio: 0.336007326007326
Avg ndcg: 0.7267846328842726
Avg compression ratio: 0.5729821027250862
Avg train time: 2.4489426136016847
Std train time: 0.8688612304338764
[0.7727272727272727, 0.6818181818181819, 0.5, 0.5909090909090909, 0.7727272727272727, 0.7727272727272727, 0.22727272727272727, 0.04545454545454546, 0.22727272727272727, 0.40909090909090906]
[10, 10, 20, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0334, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7366, 'compress@10': 0.8182, 'time@10': 2.029}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0334, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7366, 'compress@10': 0.8182, 'time@10': 2.029}:  10%|█         | 1/10 [00:01<00:09,  1.05s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.7668, 'compress@10': 0.7677, 'time@10': 2.0169}:  10%|█         | 1/10 [00:03<00:09,  1.05s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.7668, 'compress@10': 0.7677, 'time@10': 2.0169}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.337, 'ndcg@10': 0.6353, 'compress@10': 0.7618, 'time@10': 1.6658}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.337, 'ndcg@10': 0.6353, 'compress@10': 0.7618, 'time@10': 1.6658}:  30%|███       | 3/10 [00:03<00:07,  1.13s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.2528, 'ndcg@10': 0.6785, 'compress@10': 0.7318, 'time@10': 1.6924}:  30%|███       | 3/10 [00:05<00:07,  1.13s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.2528, 'ndcg@10': 0.6785, 'compress@10': 0.7318, 'time@10': 1.6924}:  40%|████      | 4/10 [00:05<00:08,  1.40s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0391, 'hit_ratio@10': 0.2791, 'ndcg@10': 0.6882, 'compress@10': 0.7435, 'time@10': 2.0757}:  40%|████      | 4/10 [00:07<00:08,  1.40s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0391, 'hit_ratio@10': 0.2791, 'ndcg@10': 0.6882, 'compress@10': 0.7435, 'time@10': 2.0757}:  50%|█████     | 5/10 [00:07<00:07,  1.56s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0427, 'hit_ratio@10': 0.3021, 'ndcg@10': 0.7002, 'compress@10': 0.7515, 'time@10': 2.2089}:  50%|█████     | 5/10 [00:10<00:07,  1.56s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0427, 'hit_ratio@10': 0.3021, 'ndcg@10': 0.7002, 'compress@10': 0.7515, 'time@10': 2.2089}:  60%|██████    | 6/10 [00:10<00:08,  2.02s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.041, 'hit_ratio@10': 0.2793, 'ndcg@10': 0.707, 'compress@10': 0.6924, 'time@10': 2.3249}:  60%|██████    | 6/10 [00:11<00:08,  2.02s/it]  {'epoch': 10, 'num_users': 6.2857, 'loss': 0.041, 'hit_ratio@10': 0.2793, 'ndcg@10': 0.707, 'compress@10': 0.6924, 'time@10': 2.3249}:  70%|███████   | 7/10 [00:11<00:05,  1.86s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.04, 'hit_ratio@10': 0.3319, 'ndcg@10': 0.7108, 'compress@10': 0.6235, 'time@10': 2.2972}:  70%|███████   | 7/10 [00:13<00:05,  1.86s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.04, 'hit_ratio@10': 0.3319, 'ndcg@10': 0.7108, 'compress@10': 0.6235, 'time@10': 2.2972}:  80%|████████  | 8/10 [00:13<00:03,  1.95s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0383, 'hit_ratio@10': 0.3197, 'ndcg@10': 0.7255, 'compress@10': 0.589, 'time@10': 2.4742}:  80%|████████  | 8/10 [00:15<00:03,  1.95s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0383, 'hit_ratio@10': 0.3197, 'ndcg@10': 0.7255, 'compress@10': 0.589, 'time@10': 2.4742}:  90%|█████████ | 9/10 [00:15<00:01,  1.96s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0382, 'hit_ratio@10': 0.3294, 'ndcg@10': 0.7311, 'compress@10': 0.5759, 'time@10': 2.4968}:  90%|█████████ | 9/10 [00:18<00:01,  1.96s/it]  {'epoch': 10, 'num_users': 6.3, 'loss': 0.0382, 'hit_ratio@10': 0.3294, 'ndcg@10': 0.7311, 'compress@10': 0.5759, 'time@10': 2.4968}: 100%|██████████| 10/10 [00:18<00:00,  2.20s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0382, 'hit_ratio@10': 0.3294, 'ndcg@10': 0.7311, 'compress@10': 0.5759, 'time@10': 2.4968}: 100%|██████████| 10/10 [00:18<00:00,  1.86s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03819132930127807
Avg hit ratio: 0.3294139194139194
Avg ndcg: 0.7310966118289854
Avg compression ratio: 0.575928255659511
Avg train time: 2.4968196868896486
Std train time: 0.8442776194216718
[0.7083333333333333, 0.7083333333333334, 0.4583333333333333, 0.625, 0.7916666666666666, 0.7916666666666666, 0.20833333333333331, 0.04166666666666667, 0.20833333333333331, 0.4583333333333333]
[10, 10, 21, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0327, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7278, 'compress@10': 0.7667, 'time@10': 1.9516}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0327, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7278, 'compress@10': 0.7667, 'time@10': 1.9516}:  10%|█         | 1/10 [00:01<00:09,  1.01s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.7624, 'compress@10': 0.7537, 'time@10': 2.0063}:  10%|█         | 1/10 [00:03<00:09,  1.01s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.7624, 'compress@10': 0.7537, 'time@10': 2.0063}:  20%|██        | 2/10 [00:03<00:13,  1.65s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.027, 'hit_ratio@10': 0.337, 'ndcg@10': 0.6749, 'compress@10': 0.7455, 'time@10': 1.6617}:  20%|██        | 2/10 [00:03<00:13,  1.65s/it]  {'epoch': 11, 'num_users': 5.0, 'loss': 0.027, 'hit_ratio@10': 0.337, 'ndcg@10': 0.6749, 'compress@10': 0.7455, 'time@10': 1.6617}:  30%|███       | 3/10 [00:03<00:07,  1.14s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.284, 'ndcg@10': 0.7093, 'compress@10': 0.7271, 'time@10': 1.6965}:  30%|███       | 3/10 [00:05<00:07,  1.14s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.284, 'ndcg@10': 0.7093, 'compress@10': 0.7271, 'time@10': 1.6965}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0384, 'hit_ratio@10': 0.2888, 'ndcg@10': 0.7128, 'compress@10': 0.7432, 'time@10': 2.0922}:  40%|████      | 4/10 [00:07<00:08,  1.41s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0384, 'hit_ratio@10': 0.2888, 'ndcg@10': 0.7128, 'compress@10': 0.7432, 'time@10': 2.0922}:  50%|█████     | 5/10 [00:07<00:07,  1.58s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.042, 'hit_ratio@10': 0.2962, 'ndcg@10': 0.7214, 'compress@10': 0.7542, 'time@10': 2.1978}:  50%|█████     | 5/10 [00:10<00:07,  1.58s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.042, 'hit_ratio@10': 0.2962, 'ndcg@10': 0.7214, 'compress@10': 0.7542, 'time@10': 2.1978}:  60%|██████    | 6/10 [00:10<00:07,  1.98s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0404, 'hit_ratio@10': 0.2947, 'ndcg@10': 0.7251, 'compress@10': 0.6924, 'time@10': 2.2949}:  60%|██████    | 6/10 [00:11<00:07,  1.98s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0404, 'hit_ratio@10': 0.2947, 'ndcg@10': 0.7251, 'compress@10': 0.6924, 'time@10': 2.2949}:  70%|███████   | 7/10 [00:11<00:05,  1.82s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0393, 'hit_ratio@10': 0.3454, 'ndcg@10': 0.7266, 'compress@10': 0.623, 'time@10': 2.2689}:  70%|███████   | 7/10 [00:13<00:05,  1.82s/it]  {'epoch': 11, 'num_users': 6.125, 'loss': 0.0393, 'hit_ratio@10': 0.3454, 'ndcg@10': 0.7266, 'compress@10': 0.623, 'time@10': 2.2689}:  80%|████████  | 8/10 [00:13<00:03,  1.91s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0377, 'hit_ratio@10': 0.344, 'ndcg@10': 0.7396, 'compress@10': 0.5867, 'time@10': 2.4543}:  80%|████████  | 8/10 [00:15<00:03,  1.91s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0377, 'hit_ratio@10': 0.344, 'ndcg@10': 0.7396, 'compress@10': 0.5867, 'time@10': 2.4543}:  90%|█████████ | 9/10 [00:15<00:01,  1.94s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0377, 'hit_ratio@10': 0.343, 'ndcg@10': 0.7438, 'compress@10': 0.5784, 'time@10': 2.4812}:  90%|█████████ | 9/10 [00:18<00:01,  1.94s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0377, 'hit_ratio@10': 0.343, 'ndcg@10': 0.7438, 'compress@10': 0.5784, 'time@10': 2.4812}: 100%|██████████| 10/10 [00:18<00:00,  2.20s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0377, 'hit_ratio@10': 0.343, 'ndcg@10': 0.7438, 'compress@10': 0.5784, 'time@10': 2.4812}: 100%|██████████| 10/10 [00:18<00:00,  1.85s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03765267943226538
Avg hit ratio: 0.3429517704517705
Avg ndcg: 0.7437964106917353
Avg compression ratio: 0.5783833317382213
Avg train time: 2.481183123588562
Std train time: 0.8468220713686833
[0.6538461538461537, 0.7307692307692308, 0.4230769230769231, 0.6538461538461539, 0.8076923076923077, 0.8076923076923077, 0.1923076923076923, 0.038461538461538464, 0.1923076923076923, 0.5]
[10, 10, 22, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.7231, 'time@10': 2.0849}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.7231, 'time@10': 2.0849}:  10%|█         | 1/10 [00:01<00:09,  1.08s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0374, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.7738, 'compress@10': 0.7419, 'time@10': 2.0882}:  10%|█         | 1/10 [00:03<00:09,  1.08s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0374, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.7738, 'compress@10': 0.7419, 'time@10': 2.0882}:  20%|██        | 2/10 [00:03<00:13,  1.70s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.337, 'ndcg@10': 0.6825, 'compress@10': 0.7318, 'time@10': 1.754}:  20%|██        | 2/10 [00:03<00:13,  1.70s/it]  {'epoch': 12, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.337, 'ndcg@10': 0.6825, 'compress@10': 0.7318, 'time@10': 1.754}:  30%|███       | 3/10 [00:03<00:08,  1.19s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.284, 'ndcg@10': 0.7149, 'compress@10': 0.7231, 'time@10': 1.7609}:  30%|███       | 3/10 [00:05<00:08,  1.19s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.284, 'ndcg@10': 0.7149, 'compress@10': 0.7231, 'time@10': 1.7609}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0378, 'hit_ratio@10': 0.2888, 'ndcg@10': 0.7171, 'compress@10': 0.743, 'time@10': 2.1426}:  40%|████      | 4/10 [00:07<00:08,  1.44s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0378, 'hit_ratio@10': 0.2888, 'ndcg@10': 0.7171, 'compress@10': 0.743, 'time@10': 2.1426}:  50%|█████     | 5/10 [00:07<00:07,  1.59s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0414, 'hit_ratio@10': 0.3101, 'ndcg@10': 0.7264, 'compress@10': 0.7564, 'time@10': 2.2522}:  50%|█████     | 5/10 [00:10<00:07,  1.59s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0414, 'hit_ratio@10': 0.3101, 'ndcg@10': 0.7264, 'compress@10': 0.7564, 'time@10': 2.2522}:  60%|██████    | 6/10 [00:10<00:08,  2.02s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0399, 'hit_ratio@10': 0.2862, 'ndcg@10': 0.7293, 'compress@10': 0.6923, 'time@10': 2.3393}:  60%|██████    | 6/10 [00:11<00:08,  2.02s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0399, 'hit_ratio@10': 0.2862, 'ndcg@10': 0.7293, 'compress@10': 0.6923, 'time@10': 2.3393}:  70%|███████   | 7/10 [00:11<00:05,  1.84s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0388, 'hit_ratio@10': 0.3379, 'ndcg@10': 0.7303, 'compress@10': 0.6226, 'time@10': 2.3104}:  70%|███████   | 7/10 [00:13<00:05,  1.84s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0388, 'hit_ratio@10': 0.3379, 'ndcg@10': 0.7303, 'compress@10': 0.6226, 'time@10': 2.3104}:  80%|████████  | 8/10 [00:13<00:03,  1.93s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0372, 'hit_ratio@10': 0.3251, 'ndcg@10': 0.7429, 'compress@10': 0.5848, 'time@10': 2.5085}:  80%|████████  | 8/10 [00:16<00:03,  1.93s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0372, 'hit_ratio@10': 0.3251, 'ndcg@10': 0.7429, 'compress@10': 0.5848, 'time@10': 2.5085}:  90%|█████████ | 9/10 [00:16<00:01,  1.98s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0372, 'hit_ratio@10': 0.3259, 'ndcg@10': 0.7474, 'compress@10': 0.5805, 'time@10': 2.548}:  90%|█████████ | 9/10 [00:18<00:01,  1.98s/it]    {'epoch': 12, 'num_users': 6.3, 'loss': 0.0372, 'hit_ratio@10': 0.3259, 'ndcg@10': 0.7474, 'compress@10': 0.5805, 'time@10': 2.548}: 100%|██████████| 10/10 [00:18<00:00,  2.28s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0372, 'hit_ratio@10': 0.3259, 'ndcg@10': 0.7474, 'compress@10': 0.5805, 'time@10': 2.548}: 100%|██████████| 10/10 [00:18<00:00,  1.90s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.037188405939565475
Avg hit ratio: 0.3258882783882784
Avg ndcg: 0.7473730473598881
Avg compression ratio: 0.5804618756403472
Avg train time: 2.5480069160461425
Std train time: 0.8530087280473259
[0.6071428571428571, 0.7500000000000001, 0.39285714285714285, 0.6785714285714286, 0.8214285714285714, 0.8214285714285714, 0.17857142857142855, 0.03571428571428572, 0.17857142857142855, 0.5357142857142857]
[10, 10, 23, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.6857, 'time@10': 2.0876}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.6857, 'time@10': 2.0876}:  10%|█         | 1/10 [00:01<00:09,  1.08s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.037, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.7317, 'time@10': 2.0396}:  10%|█         | 1/10 [00:03<00:09,  1.08s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.037, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.7317, 'time@10': 2.0396}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.72, 'time@10': 1.7206}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.72, 'time@10': 1.7206}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7197, 'time@10': 1.7244}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7197, 'time@10': 1.7244}:  40%|████      | 4/10 [00:05<00:08,  1.40s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0373, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7188, 'compress@10': 0.7428, 'time@10': 2.0857}:  40%|████      | 4/10 [00:07<00:08,  1.40s/it] {'epoch': 13, 'num_users': 5.8, 'loss': 0.0373, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7188, 'compress@10': 0.7428, 'time@10': 2.0857}:  50%|█████     | 5/10 [00:07<00:07,  1.55s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0409, 'hit_ratio@10': 0.3494, 'ndcg@10': 0.7277, 'compress@10': 0.7584, 'time@10': 2.1969}:  50%|█████     | 5/10 [00:10<00:07,  1.55s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0409, 'hit_ratio@10': 0.3494, 'ndcg@10': 0.7277, 'compress@10': 0.7584, 'time@10': 2.1969}:  60%|██████    | 6/10 [00:10<00:07,  1.98s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0394, 'hit_ratio@10': 0.3199, 'ndcg@10': 0.7305, 'compress@10': 0.6923, 'time@10': 2.3046}:  60%|██████    | 6/10 [00:11<00:07,  1.98s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0394, 'hit_ratio@10': 0.3199, 'ndcg@10': 0.7305, 'compress@10': 0.6923, 'time@10': 2.3046}:  70%|███████   | 7/10 [00:11<00:05,  1.83s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0383, 'hit_ratio@10': 0.3674, 'ndcg@10': 0.7322, 'compress@10': 0.6223, 'time@10': 2.2842}:  70%|███████   | 7/10 [00:13<00:05,  1.83s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0383, 'hit_ratio@10': 0.3674, 'ndcg@10': 0.7322, 'compress@10': 0.6223, 'time@10': 2.2842}:  80%|████████  | 8/10 [00:13<00:03,  1.94s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0367, 'hit_ratio@10': 0.3513, 'ndcg@10': 0.7446, 'compress@10': 0.5831, 'time@10': 2.4708}:  80%|████████  | 8/10 [00:15<00:03,  1.94s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0367, 'hit_ratio@10': 0.3513, 'ndcg@10': 0.7446, 'compress@10': 0.5831, 'time@10': 2.4708}:  90%|█████████ | 9/10 [00:15<00:01,  1.96s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0368, 'hit_ratio@10': 0.3495, 'ndcg@10': 0.7493, 'compress@10': 0.5822, 'time@10': 2.5066}:  90%|█████████ | 9/10 [00:18<00:01,  1.96s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0368, 'hit_ratio@10': 0.3495, 'ndcg@10': 0.7493, 'compress@10': 0.5822, 'time@10': 2.5066}: 100%|██████████| 10/10 [00:18<00:00,  2.24s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0368, 'hit_ratio@10': 0.3495, 'ndcg@10': 0.7493, 'compress@10': 0.5822, 'time@10': 2.5066}: 100%|██████████| 10/10 [00:18<00:00,  1.87s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03678336540818151
Avg hit ratio: 0.3494993894993895
Avg ndcg: 0.7492791139627982
Avg compression ratio: 0.5822439730090517
Avg train time: 2.5066236019134522
Std train time: 0.8202670196176254
[0.5666666666666667, 0.7666666666666667, 0.36666666666666664, 0.7000000000000001, 0.8333333333333333, 0.8333333333333333, 0.16666666666666666, 0.03333333333333334, 0.16666666666666666, 0.5666666666666667]
[10, 10, 24, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.6533, 'time@10': 2.0922}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.6533, 'time@10': 2.0922}:  10%|█         | 1/10 [00:01<00:09,  1.08s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0366, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.723, 'time@10': 2.0299}:  10%|█         | 1/10 [00:03<00:09,  1.08s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0366, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.723, 'time@10': 2.0299}:  20%|██        | 2/10 [00:03<00:13,  1.63s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.7097, 'time@10': 1.7203}:  20%|██        | 2/10 [00:03<00:13,  1.63s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.7097, 'time@10': 1.7203}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.3118, 'ndcg@10': 0.7149, 'compress@10': 0.7167, 'time@10': 1.7502}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.3118, 'ndcg@10': 0.7149, 'compress@10': 0.7167, 'time@10': 1.7502}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0369, 'hit_ratio@10': 0.311, 'ndcg@10': 0.7183, 'compress@10': 0.7426, 'time@10': 2.1294}:  40%|████      | 4/10 [00:07<00:08,  1.44s/it] {'epoch': 14, 'num_users': 5.8, 'loss': 0.0369, 'hit_ratio@10': 0.311, 'ndcg@10': 0.7183, 'compress@10': 0.7426, 'time@10': 2.1294}:  50%|█████     | 5/10 [00:07<00:07,  1.59s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0405, 'hit_ratio@10': 0.3147, 'ndcg@10': 0.7275, 'compress@10': 0.76, 'time@10': 2.2148}:  50%|█████     | 5/10 [00:10<00:07,  1.59s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0405, 'hit_ratio@10': 0.3147, 'ndcg@10': 0.7275, 'compress@10': 0.76, 'time@10': 2.2148}:  60%|██████    | 6/10 [00:10<00:07,  1.96s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0389, 'hit_ratio@10': 0.2902, 'ndcg@10': 0.7303, 'compress@10': 0.6923, 'time@10': 2.293}:  60%|██████    | 6/10 [00:11<00:07,  1.96s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0389, 'hit_ratio@10': 0.2902, 'ndcg@10': 0.7303, 'compress@10': 0.6923, 'time@10': 2.293}:  70%|███████   | 7/10 [00:11<00:05,  1.78s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0379, 'hit_ratio@10': 0.3414, 'ndcg@10': 0.734, 'compress@10': 0.622, 'time@10': 2.2819}:  70%|███████   | 7/10 [00:13<00:05,  1.78s/it]  {'epoch': 14, 'num_users': 6.125, 'loss': 0.0379, 'hit_ratio@10': 0.3414, 'ndcg@10': 0.734, 'compress@10': 0.622, 'time@10': 2.2819}:  80%|████████  | 8/10 [00:13<00:03,  1.93s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0363, 'hit_ratio@10': 0.3281, 'ndcg@10': 0.7462, 'compress@10': 0.5817, 'time@10': 2.4689}:  80%|████████  | 8/10 [00:15<00:03,  1.93s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0363, 'hit_ratio@10': 0.3281, 'ndcg@10': 0.7462, 'compress@10': 0.5817, 'time@10': 2.4689}:  90%|█████████ | 9/10 [00:15<00:01,  1.96s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0364, 'hit_ratio@10': 0.337, 'ndcg@10': 0.7507, 'compress@10': 0.5838, 'time@10': 2.4983}:  90%|█████████ | 9/10 [00:18<00:01,  1.96s/it]    {'epoch': 14, 'num_users': 6.3, 'loss': 0.0364, 'hit_ratio@10': 0.337, 'ndcg@10': 0.7507, 'compress@10': 0.5838, 'time@10': 2.4983}: 100%|██████████| 10/10 [00:18<00:00,  2.22s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0364, 'hit_ratio@10': 0.337, 'ndcg@10': 0.7507, 'compress@10': 0.5838, 'time@10': 2.4983}: 100%|██████████| 10/10 [00:18<00:00,  1.86s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.03636274603077794
Avg hit ratio: 0.33699938949938946
Avg ndcg: 0.7506770881640742
Avg compression ratio: 0.5837860187976842
Avg train time: 2.4982561111450194
Std train time: 0.8092708423799152
[0.53125, 0.78125, 0.34375, 0.7187500000000001, 0.8437499999999999, 0.8437499999999999, 0.15625, 0.03125000000000001, 0.15625, 0.59375]
[10, 10, 25, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.625, 'time@10': 2.203}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.625, 'time@10': 2.203}:  10%|█         | 1/10 [00:01<00:10,  1.14s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0362, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.7153, 'time@10': 2.0872}:  10%|█         | 1/10 [00:03<00:10,  1.14s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0362, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.7153, 'time@10': 2.0872}:  20%|██        | 2/10 [00:03<00:13,  1.65s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.7008, 'time@10': 1.7944}:  20%|██        | 2/10 [00:03<00:13,  1.65s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.7008, 'time@10': 1.7944}:  30%|███       | 3/10 [00:03<00:08,  1.19s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7141, 'time@10': 1.7816}:  30%|███       | 3/10 [00:05<00:08,  1.19s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7141, 'time@10': 1.7816}:  40%|████      | 4/10 [00:05<00:08,  1.43s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0365, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7183, 'compress@10': 0.7424, 'time@10': 2.1406}:  40%|████      | 4/10 [00:07<00:08,  1.43s/it] {'epoch': 15, 'num_users': 5.8, 'loss': 0.0365, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7183, 'compress@10': 0.7424, 'time@10': 2.1406}:  50%|█████     | 5/10 [00:07<00:07,  1.57s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.04, 'hit_ratio@10': 0.3217, 'ndcg@10': 0.7282, 'compress@10': 0.7615, 'time@10': 2.2549}:  50%|█████     | 5/10 [00:10<00:07,  1.57s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.04, 'hit_ratio@10': 0.3217, 'ndcg@10': 0.7282, 'compress@10': 0.7615, 'time@10': 2.2549}:  60%|██████    | 6/10 [00:10<00:08,  2.02s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0385, 'hit_ratio@10': 0.2757, 'ndcg@10': 0.7309, 'compress@10': 0.6922, 'time@10': 2.3377}:  60%|██████    | 6/10 [00:11<00:08,  2.02s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0385, 'hit_ratio@10': 0.2757, 'ndcg@10': 0.7309, 'compress@10': 0.6922, 'time@10': 2.3377}:  70%|███████   | 7/10 [00:11<00:05,  1.83s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0375, 'hit_ratio@10': 0.3287, 'ndcg@10': 0.7347, 'compress@10': 0.6217, 'time@10': 2.306}:  70%|███████   | 7/10 [00:13<00:05,  1.83s/it]  {'epoch': 15, 'num_users': 6.125, 'loss': 0.0375, 'hit_ratio@10': 0.3287, 'ndcg@10': 0.7347, 'compress@10': 0.6217, 'time@10': 2.306}:  80%|████████  | 8/10 [00:13<00:03,  1.92s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0359, 'hit_ratio@10': 0.3169, 'ndcg@10': 0.7468, 'compress@10': 0.5804, 'time@10': 2.4599}:  80%|████████  | 8/10 [00:15<00:03,  1.92s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0359, 'hit_ratio@10': 0.3169, 'ndcg@10': 0.7468, 'compress@10': 0.5804, 'time@10': 2.4599}:  90%|█████████ | 9/10 [00:15<00:01,  1.91s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0359, 'hit_ratio@10': 0.3185, 'ndcg@10': 0.7517, 'compress@10': 0.5851, 'time@10': 2.4915}:  90%|█████████ | 9/10 [00:18<00:01,  1.91s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0359, 'hit_ratio@10': 0.3185, 'ndcg@10': 0.7517, 'compress@10': 0.5851, 'time@10': 2.4915}: 100%|██████████| 10/10 [00:18<00:00,  2.19s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0359, 'hit_ratio@10': 0.3185, 'ndcg@10': 0.7517, 'compress@10': 0.5851, 'time@10': 2.4915}: 100%|██████████| 10/10 [00:18<00:00,  1.86s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.035936753877787705
Avg hit ratio: 0.31854700854700857
Avg ndcg: 0.751747421930862
Avg compression ratio: 0.5851360541370144
Avg train time: 2.491507816314697
Std train time: 0.751891528179201
[0.5, 0.7941176470588235, 0.3235294117647059, 0.7352941176470589, 0.8529411764705881, 0.8529411764705881, 0.14705882352941177, 0.02941176470588236, 0.14705882352941177, 0.6176470588235294]
[10, 10, 26, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.6, 'time@10': 1.998}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.6, 'time@10': 1.998}:  10%|█         | 1/10 [00:01<00:09,  1.03s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.7085, 'time@10': 2.0308}:  10%|█         | 1/10 [00:03<00:09,  1.03s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.7085, 'time@10': 2.0308}:  20%|██        | 2/10 [00:03<00:13,  1.66s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6929, 'time@10': 1.7895}:  20%|██        | 2/10 [00:03<00:13,  1.66s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6929, 'time@10': 1.7895}:  30%|███       | 3/10 [00:03<00:08,  1.22s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7118, 'time@10': 1.7825}:  30%|███       | 3/10 [00:05<00:08,  1.22s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7118, 'time@10': 1.7825}:  40%|████      | 4/10 [00:05<00:08,  1.45s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0361, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7183, 'compress@10': 0.7423, 'time@10': 2.1436}:  40%|████      | 4/10 [00:07<00:08,  1.45s/it] {'epoch': 16, 'num_users': 5.8, 'loss': 0.0361, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7183, 'compress@10': 0.7423, 'time@10': 2.1436}:  50%|█████     | 5/10 [00:07<00:07,  1.59s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0395, 'hit_ratio@10': 0.3078, 'ndcg@10': 0.7282, 'compress@10': 0.7628, 'time@10': 2.2552}:  50%|█████     | 5/10 [00:10<00:07,  1.59s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0395, 'hit_ratio@10': 0.3078, 'ndcg@10': 0.7282, 'compress@10': 0.7628, 'time@10': 2.2552}:  60%|██████    | 6/10 [00:10<00:08,  2.02s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0381, 'hit_ratio@10': 0.2638, 'ndcg@10': 0.7309, 'compress@10': 0.6922, 'time@10': 2.3513}:  60%|██████    | 6/10 [00:11<00:08,  2.02s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0381, 'hit_ratio@10': 0.2638, 'ndcg@10': 0.7309, 'compress@10': 0.6922, 'time@10': 2.3513}:  70%|███████   | 7/10 [00:11<00:05,  1.85s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.037, 'hit_ratio@10': 0.3183, 'ndcg@10': 0.7352, 'compress@10': 0.6215, 'time@10': 2.3165}:  70%|███████   | 7/10 [00:13<00:05,  1.85s/it]  {'epoch': 16, 'num_users': 6.125, 'loss': 0.037, 'hit_ratio@10': 0.3183, 'ndcg@10': 0.7352, 'compress@10': 0.6215, 'time@10': 2.3165}:  80%|████████  | 8/10 [00:13<00:03,  1.93s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0354, 'hit_ratio@10': 0.3076, 'ndcg@10': 0.7473, 'compress@10': 0.5793, 'time@10': 2.4805}:  80%|████████  | 8/10 [00:15<00:03,  1.93s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0354, 'hit_ratio@10': 0.3076, 'ndcg@10': 0.7473, 'compress@10': 0.5793, 'time@10': 2.4805}:  90%|█████████ | 9/10 [00:15<00:01,  1.93s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0355, 'hit_ratio@10': 0.3185, 'ndcg@10': 0.7522, 'compress@10': 0.5863, 'time@10': 2.5121}:  90%|█████████ | 9/10 [00:18<00:01,  1.93s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0355, 'hit_ratio@10': 0.3185, 'ndcg@10': 0.7522, 'compress@10': 0.5863, 'time@10': 2.5121}: 100%|██████████| 10/10 [00:18<00:00,  2.21s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0355, 'hit_ratio@10': 0.3185, 'ndcg@10': 0.7522, 'compress@10': 0.5863, 'time@10': 2.5121}: 100%|██████████| 10/10 [00:18<00:00,  1.87s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.03553468921982544
Avg hit ratio: 0.3185470085470085
Avg ndcg: 0.7521520581578488
Avg compression ratio: 0.5863278764860207
Avg train time: 2.512084150314331
Std train time: 0.7626195338464498
[0.4722222222222222, 0.8055555555555555, 0.3055555555555556, 0.75, 0.8611111111111109, 0.8611111111111109, 0.1388888888888889, 0.027777777777777783, 0.1388888888888889, 0.638888888888889]
[10, 10, 27, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.5778, 'time@10': 1.9815}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.5778, 'time@10': 1.9815}:  10%|█         | 1/10 [00:01<00:09,  1.03s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0354, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.7025, 'time@10': 1.9874}:  10%|█         | 1/10 [00:03<00:09,  1.03s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0354, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.7025, 'time@10': 1.9874}:  20%|██        | 2/10 [00:03<00:12,  1.62s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6859, 'time@10': 1.7337}:  20%|██        | 2/10 [00:03<00:12,  1.62s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6859, 'time@10': 1.7337}:  30%|███       | 3/10 [00:03<00:08,  1.17s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7097, 'time@10': 1.7579}:  30%|███       | 3/10 [00:05<00:08,  1.17s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7097, 'time@10': 1.7579}:  40%|████      | 4/10 [00:05<00:08,  1.45s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0357, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7183, 'compress@10': 0.7421, 'time@10': 2.1814}:  40%|████      | 4/10 [00:07<00:08,  1.45s/it] {'epoch': 17, 'num_users': 5.8, 'loss': 0.0357, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7183, 'compress@10': 0.7421, 'time@10': 2.1814}:  50%|█████     | 5/10 [00:07<00:08,  1.64s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.039, 'hit_ratio@10': 0.3078, 'ndcg@10': 0.7288, 'compress@10': 0.7639, 'time@10': 2.2691}:  50%|█████     | 5/10 [00:10<00:08,  1.64s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.039, 'hit_ratio@10': 0.3078, 'ndcg@10': 0.7288, 'compress@10': 0.7639, 'time@10': 2.2691}:  60%|██████    | 6/10 [00:10<00:08,  2.01s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0376, 'hit_ratio@10': 0.2638, 'ndcg@10': 0.7314, 'compress@10': 0.6922, 'time@10': 2.3572}:  60%|██████    | 6/10 [00:11<00:08,  2.01s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0376, 'hit_ratio@10': 0.2638, 'ndcg@10': 0.7314, 'compress@10': 0.6922, 'time@10': 2.3572}:  70%|███████   | 7/10 [00:11<00:05,  1.84s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0366, 'hit_ratio@10': 0.3183, 'ndcg@10': 0.7357, 'compress@10': 0.6213, 'time@10': 2.3298}:  70%|███████   | 7/10 [00:13<00:05,  1.84s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0366, 'hit_ratio@10': 0.3183, 'ndcg@10': 0.7357, 'compress@10': 0.6213, 'time@10': 2.3298}:  80%|████████  | 8/10 [00:13<00:03,  1.95s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.035, 'hit_ratio@10': 0.3076, 'ndcg@10': 0.7477, 'compress@10': 0.5783, 'time@10': 2.493}:  80%|████████  | 8/10 [00:15<00:03,  1.95s/it] {'epoch': 17, 'num_users': 6.3333, 'loss': 0.035, 'hit_ratio@10': 0.3076, 'ndcg@10': 0.7477, 'compress@10': 0.5783, 'time@10': 2.493}:  90%|█████████ | 9/10 [00:15<00:01,  1.95s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.3185, 'ndcg@10': 0.7525, 'compress@10': 0.5874, 'time@10': 2.5165}:  90%|█████████ | 9/10 [00:18<00:01,  1.95s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.3185, 'ndcg@10': 0.7525, 'compress@10': 0.5874, 'time@10': 2.5165}: 100%|██████████| 10/10 [00:18<00:00,  2.20s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.3185, 'ndcg@10': 0.7525, 'compress@10': 0.5874, 'time@10': 2.5165}: 100%|██████████| 10/10 [00:18<00:00,  1.87s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.035043261473514005
Avg hit ratio: 0.3185470085470085
Avg ndcg: 0.7525182651154471
Avg compression ratio: 0.587387993088622
Avg train time: 2.516549301147461
Std train time: 0.8090477818664907
[0.4473684210526316, 0.8157894736842104, 0.2894736842105263, 0.7631578947368421, 0.8684210526315788, 0.8684210526315788, 0.13157894736842105, 0.026315789473684216, 0.13157894736842105, 0.6578947368421053]
[10, 10, 28, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.5579, 'time@10': 2.0644}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.5579, 'time@10': 2.0644}:  10%|█         | 1/10 [00:01<00:09,  1.07s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.035, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6971, 'time@10': 2.0123}:  10%|█         | 1/10 [00:03<00:09,  1.07s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.035, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6971, 'time@10': 2.0123}:  20%|██        | 2/10 [00:03<00:12,  1.62s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6796, 'time@10': 1.7689}:  20%|██        | 2/10 [00:03<00:12,  1.62s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6796, 'time@10': 1.7689}:  30%|███       | 3/10 [00:03<00:08,  1.19s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7079, 'time@10': 1.7546}:  30%|███       | 3/10 [00:05<00:08,  1.19s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7079, 'time@10': 1.7546}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0353, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7183, 'compress@10': 0.742, 'time@10': 2.1366}:  40%|████      | 4/10 [00:07<00:08,  1.41s/it] {'epoch': 18, 'num_users': 5.8, 'loss': 0.0353, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7183, 'compress@10': 0.742, 'time@10': 2.1366}:  50%|█████     | 5/10 [00:07<00:07,  1.57s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0385, 'hit_ratio@10': 0.3078, 'ndcg@10': 0.7293, 'compress@10': 0.7649, 'time@10': 2.2205}:  50%|█████     | 5/10 [00:10<00:07,  1.57s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0385, 'hit_ratio@10': 0.3078, 'ndcg@10': 0.7293, 'compress@10': 0.7649, 'time@10': 2.2205}:  60%|██████    | 6/10 [00:10<00:07,  1.95s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0371, 'hit_ratio@10': 0.2638, 'ndcg@10': 0.7318, 'compress@10': 0.6922, 'time@10': 2.3103}:  60%|██████    | 6/10 [00:11<00:07,  1.95s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0371, 'hit_ratio@10': 0.2638, 'ndcg@10': 0.7318, 'compress@10': 0.6922, 'time@10': 2.3103}:  70%|███████   | 7/10 [00:11<00:05,  1.79s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0361, 'hit_ratio@10': 0.3183, 'ndcg@10': 0.7363, 'compress@10': 0.6211, 'time@10': 2.279}:  70%|███████   | 7/10 [00:13<00:05,  1.79s/it]  {'epoch': 18, 'num_users': 6.125, 'loss': 0.0361, 'hit_ratio@10': 0.3183, 'ndcg@10': 0.7363, 'compress@10': 0.6211, 'time@10': 2.279}:  80%|████████  | 8/10 [00:13<00:03,  1.89s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0345, 'hit_ratio@10': 0.3076, 'ndcg@10': 0.7482, 'compress@10': 0.5774, 'time@10': 2.4405}:  80%|████████  | 8/10 [00:15<00:03,  1.89s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0345, 'hit_ratio@10': 0.3076, 'ndcg@10': 0.7482, 'compress@10': 0.5774, 'time@10': 2.4405}:  90%|█████████ | 9/10 [00:15<00:01,  1.98s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0346, 'hit_ratio@10': 0.3269, 'ndcg@10': 0.753, 'compress@10': 0.5883, 'time@10': 2.4663}:  90%|█████████ | 9/10 [00:18<00:01,  1.98s/it]    {'epoch': 18, 'num_users': 6.3, 'loss': 0.0346, 'hit_ratio@10': 0.3269, 'ndcg@10': 0.753, 'compress@10': 0.5883, 'time@10': 2.4663}: 100%|██████████| 10/10 [00:18<00:00,  2.21s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0346, 'hit_ratio@10': 0.3269, 'ndcg@10': 0.753, 'compress@10': 0.5883, 'time@10': 2.4663}: 100%|██████████| 10/10 [00:18<00:00,  1.85s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.03458857028721234
Avg hit ratio: 0.3268803418803419
Avg ndcg: 0.7529812291647313
Avg compression ratio: 0.5883346467224542
Avg train time: 2.4663251399993897
Std train time: 0.7631494740389846
[0.425, 0.8249999999999998, 0.275, 0.775, 0.8749999999999998, 0.8749999999999998, 0.125, 0.025000000000000005, 0.125, 0.675]
[10, 10, 29, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0298, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.54, 'time@10': 2.2206}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0298, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.54, 'time@10': 2.2206}:  10%|█         | 1/10 [00:01<00:10,  1.15s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6922, 'time@10': 2.1086}:  10%|█         | 1/10 [00:03<00:10,  1.15s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6922, 'time@10': 2.1086}:  20%|██        | 2/10 [00:03<00:13,  1.67s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.674, 'time@10': 1.8469}:  20%|██        | 2/10 [00:03<00:13,  1.67s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.674, 'time@10': 1.8469}:  30%|███       | 3/10 [00:03<00:08,  1.23s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7063, 'time@10': 1.8106}:  30%|███       | 3/10 [00:05<00:08,  1.23s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7063, 'time@10': 1.8106}:  40%|████      | 4/10 [00:05<00:08,  1.43s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0349, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7188, 'compress@10': 0.7419, 'time@10': 2.1742}:  40%|████      | 4/10 [00:07<00:08,  1.43s/it] {'epoch': 19, 'num_users': 5.8, 'loss': 0.0349, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7188, 'compress@10': 0.7419, 'time@10': 2.1742}:  50%|█████     | 5/10 [00:07<00:07,  1.58s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0379, 'hit_ratio@10': 0.3217, 'ndcg@10': 0.7303, 'compress@10': 0.7658, 'time@10': 2.2569}:  50%|█████     | 5/10 [00:10<00:07,  1.58s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0379, 'hit_ratio@10': 0.3217, 'ndcg@10': 0.7303, 'compress@10': 0.7658, 'time@10': 2.2569}:  60%|██████    | 6/10 [00:10<00:07,  1.96s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0366, 'hit_ratio@10': 0.2757, 'ndcg@10': 0.7328, 'compress@10': 0.6922, 'time@10': 2.3411}:  60%|██████    | 6/10 [00:11<00:07,  1.96s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0366, 'hit_ratio@10': 0.2757, 'ndcg@10': 0.7328, 'compress@10': 0.6922, 'time@10': 2.3411}:  70%|███████   | 7/10 [00:11<00:05,  1.80s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0355, 'hit_ratio@10': 0.3287, 'ndcg@10': 0.7371, 'compress@10': 0.6209, 'time@10': 2.3137}:  70%|███████   | 7/10 [00:13<00:05,  1.80s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0355, 'hit_ratio@10': 0.3287, 'ndcg@10': 0.7371, 'compress@10': 0.6209, 'time@10': 2.3137}:  80%|████████  | 8/10 [00:13<00:03,  1.91s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.034, 'hit_ratio@10': 0.3169, 'ndcg@10': 0.7489, 'compress@10': 0.5766, 'time@10': 2.468}:  80%|████████  | 8/10 [00:15<00:03,  1.91s/it] {'epoch': 19, 'num_users': 6.3333, 'loss': 0.034, 'hit_ratio@10': 0.3169, 'ndcg@10': 0.7489, 'compress@10': 0.5766, 'time@10': 2.468}:  90%|█████████ | 9/10 [00:15<00:01,  1.91s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.034, 'hit_ratio@10': 0.3352, 'ndcg@10': 0.7536, 'compress@10': 0.5892, 'time@10': 2.4999}:  90%|█████████ | 9/10 [00:18<00:01,  1.91s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 0.034, 'hit_ratio@10': 0.3352, 'ndcg@10': 0.7536, 'compress@10': 0.5892, 'time@10': 2.4999}: 100%|██████████| 10/10 [00:18<00:00,  2.19s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.034, 'hit_ratio@10': 0.3352, 'ndcg@10': 0.7536, 'compress@10': 0.5892, 'time@10': 2.4999}: 100%|██████████| 10/10 [00:18<00:00,  1.85s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.03401217492733956
Avg hit ratio: 0.33521367521367523
Avg ndcg: 0.7536230935791506
Avg compression ratio: 0.5891872011765074
Avg train time: 2.499907946586609
Std train time: 0.7381148607714481
[0.40476190476190477, 0.8333333333333331, 0.2619047619047619, 0.7857142857142857, 0.8809523809523807, 0.8809523809523807, 0.11904761904761904, 0.023809523809523815, 0.11904761904761904, 0.6904761904761905]
[10, 10, 30, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.5238, 'time@10': 1.99}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.5238, 'time@10': 1.99}:  10%|█         | 1/10 [00:01<00:09,  1.03s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0341, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6878, 'time@10': 1.966}:  10%|█         | 1/10 [00:03<00:09,  1.03s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0341, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6878, 'time@10': 1.966}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6689, 'time@10': 1.7694}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6689, 'time@10': 1.7694}:  30%|███       | 3/10 [00:03<00:08,  1.19s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7048, 'time@10': 1.751}:  30%|███       | 3/10 [00:05<00:08,  1.19s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7048, 'time@10': 1.751}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0344, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7188, 'compress@10': 0.7418, 'time@10': 2.1008}:  40%|████      | 4/10 [00:07<00:08,  1.41s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0344, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7188, 'compress@10': 0.7418, 'time@10': 2.1008}:  50%|█████     | 5/10 [00:07<00:07,  1.54s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0374, 'hit_ratio@10': 0.3217, 'ndcg@10': 0.7303, 'compress@10': 0.7667, 'time@10': 2.2013}:  50%|█████     | 5/10 [00:09<00:07,  1.54s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0374, 'hit_ratio@10': 0.3217, 'ndcg@10': 0.7303, 'compress@10': 0.7667, 'time@10': 2.2013}:  60%|██████    | 6/10 [00:09<00:07,  1.95s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0361, 'hit_ratio@10': 0.2757, 'ndcg@10': 0.7328, 'compress@10': 0.6921, 'time@10': 2.3101}:  60%|██████    | 6/10 [00:11<00:07,  1.95s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0361, 'hit_ratio@10': 0.2757, 'ndcg@10': 0.7328, 'compress@10': 0.6921, 'time@10': 2.3101}:  70%|███████   | 7/10 [00:11<00:05,  1.81s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.035, 'hit_ratio@10': 0.3287, 'ndcg@10': 0.7371, 'compress@10': 0.6208, 'time@10': 2.2811}:  70%|███████   | 7/10 [00:13<00:05,  1.81s/it]  {'epoch': 20, 'num_users': 6.125, 'loss': 0.035, 'hit_ratio@10': 0.3287, 'ndcg@10': 0.7371, 'compress@10': 0.6208, 'time@10': 2.2811}:  80%|████████  | 8/10 [00:13<00:03,  1.91s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0334, 'hit_ratio@10': 0.3169, 'ndcg@10': 0.7489, 'compress@10': 0.5759, 'time@10': 2.4377}:  80%|████████  | 8/10 [00:15<00:03,  1.91s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0334, 'hit_ratio@10': 0.3169, 'ndcg@10': 0.7489, 'compress@10': 0.5759, 'time@10': 2.4377}:  90%|█████████ | 9/10 [00:15<00:01,  1.90s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0335, 'hit_ratio@10': 0.3269, 'ndcg@10': 0.7545, 'compress@10': 0.59, 'time@10': 2.4736}:  90%|█████████ | 9/10 [00:18<00:01,  1.90s/it]     {'epoch': 20, 'num_users': 6.3, 'loss': 0.0335, 'hit_ratio@10': 0.3269, 'ndcg@10': 0.7545, 'compress@10': 0.59, 'time@10': 2.4736}: 100%|██████████| 10/10 [00:18<00:00,  2.19s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0335, 'hit_ratio@10': 0.3269, 'ndcg@10': 0.7545, 'compress@10': 0.59, 'time@10': 2.4736}: 100%|██████████| 10/10 [00:18<00:00,  1.83s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.033511976121404004
Avg hit ratio: 0.3268803418803419
Avg ndcg: 0.7545041010953596
Avg compression ratio: 0.5899595180329649
Avg train time: 2.4735828399658204
Std train time: 0.7357270137053168
[0.38636363636363635, 0.8409090909090907, 0.25, 0.7954545454545454, 0.8863636363636361, 0.8863636363636361, 0.11363636363636363, 0.02272727272727273, 0.11363636363636363, 0.7045454545454546]
[10, 10, 31, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.5091, 'time@10': 2.1048}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.5091, 'time@10': 2.1048}:  10%|█         | 1/10 [00:01<00:09,  1.09s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0336, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6838, 'time@10': 2.0481}:  10%|█         | 1/10 [00:03<00:09,  1.09s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0336, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6838, 'time@10': 2.0481}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6642, 'time@10': 1.8619}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6642, 'time@10': 1.8619}:  30%|███       | 3/10 [00:03<00:08,  1.25s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7034, 'time@10': 1.8438}:  30%|███       | 3/10 [00:05<00:08,  1.25s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7034, 'time@10': 1.8438}:  40%|████      | 4/10 [00:05<00:08,  1.48s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.034, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7183, 'compress@10': 0.7418, 'time@10': 2.1439}:  40%|████      | 4/10 [00:07<00:08,  1.48s/it]  {'epoch': 21, 'num_users': 5.8, 'loss': 0.034, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7183, 'compress@10': 0.7418, 'time@10': 2.1439}:  50%|█████     | 5/10 [00:07<00:07,  1.56s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0369, 'hit_ratio@10': 0.3494, 'ndcg@10': 0.7307, 'compress@10': 0.7674, 'time@10': 2.2631}:  50%|█████     | 5/10 [00:10<00:07,  1.56s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0369, 'hit_ratio@10': 0.3494, 'ndcg@10': 0.7307, 'compress@10': 0.7674, 'time@10': 2.2631}:  60%|██████    | 6/10 [00:10<00:08,  2.01s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0356, 'hit_ratio@10': 0.2995, 'ndcg@10': 0.7331, 'compress@10': 0.6921, 'time@10': 2.3687}:  60%|██████    | 6/10 [00:11<00:08,  2.01s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0356, 'hit_ratio@10': 0.2995, 'ndcg@10': 0.7331, 'compress@10': 0.6921, 'time@10': 2.3687}:  70%|███████   | 7/10 [00:11<00:05,  1.86s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0345, 'hit_ratio@10': 0.3496, 'ndcg@10': 0.7373, 'compress@10': 0.6207, 'time@10': 2.3416}:  70%|███████   | 7/10 [00:14<00:05,  1.86s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0345, 'hit_ratio@10': 0.3496, 'ndcg@10': 0.7373, 'compress@10': 0.6207, 'time@10': 2.3416}:  80%|████████  | 8/10 [00:14<00:03,  1.96s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0329, 'hit_ratio@10': 0.3354, 'ndcg@10': 0.7491, 'compress@10': 0.5753, 'time@10': 2.515}:  80%|████████  | 8/10 [00:16<00:03,  1.96s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0329, 'hit_ratio@10': 0.3354, 'ndcg@10': 0.7491, 'compress@10': 0.5753, 'time@10': 2.515}:  90%|█████████ | 9/10 [00:16<00:01,  1.97s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.033, 'hit_ratio@10': 0.3435, 'ndcg@10': 0.7557, 'compress@10': 0.5907, 'time@10': 2.532}:  90%|█████████ | 9/10 [00:18<00:01,  1.97s/it]    {'epoch': 21, 'num_users': 6.3, 'loss': 0.033, 'hit_ratio@10': 0.3435, 'ndcg@10': 0.7557, 'compress@10': 0.5907, 'time@10': 2.532}: 100%|██████████| 10/10 [00:18<00:00,  2.20s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.033, 'hit_ratio@10': 0.3435, 'ndcg@10': 0.7557, 'compress@10': 0.5907, 'time@10': 2.532}: 100%|██████████| 10/10 [00:18<00:00,  1.88s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.03296463421950462
Avg hit ratio: 0.34354700854700854
Avg ndcg: 0.7556597171211303
Avg compression ratio: 0.5906596160372799
Avg train time: 2.53204402923584
Std train time: 0.7174938471770648
[0.3695652173913043, 0.8478260869565215, 0.2391304347826087, 0.8043478260869564, 0.8913043478260867, 0.8913043478260867, 0.10869565217391304, 0.02173913043478261, 0.10869565217391304, 0.7173913043478262]
[10, 10, 31, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.029, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.4957, 'time@10': 1.9652}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.029, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.4957, 'time@10': 1.9652}:  10%|█         | 1/10 [00:01<00:09,  1.02s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6802, 'time@10': 1.972}:  10%|█         | 1/10 [00:03<00:09,  1.02s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6802, 'time@10': 1.972}:  20%|██        | 2/10 [00:03<00:12,  1.61s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.66, 'time@10': 1.7828}:  20%|██        | 2/10 [00:03<00:12,  1.61s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.66, 'time@10': 1.7828}:  30%|███       | 3/10 [00:03<00:08,  1.21s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0245, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7022, 'time@10': 1.7718}:  30%|███       | 3/10 [00:05<00:08,  1.21s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0245, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7022, 'time@10': 1.7718}:  40%|████      | 4/10 [00:05<00:08,  1.43s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0335, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7188, 'compress@10': 0.7417, 'time@10': 2.1241}:  40%|████      | 4/10 [00:07<00:08,  1.43s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.0335, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7188, 'compress@10': 0.7417, 'time@10': 2.1241}:  50%|█████     | 5/10 [00:07<00:07,  1.57s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.037, 'hit_ratio@10': 0.3217, 'ndcg@10': 0.731, 'compress@10': 0.7681, 'time@10': 2.2095}:  50%|█████     | 5/10 [00:10<00:07,  1.57s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.037, 'hit_ratio@10': 0.3217, 'ndcg@10': 0.731, 'compress@10': 0.7681, 'time@10': 2.2095}:  60%|██████    | 6/10 [00:10<00:07,  1.94s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0356, 'hit_ratio@10': 0.2961, 'ndcg@10': 0.7333, 'compress@10': 0.6921, 'time@10': 2.2865}:  60%|██████    | 6/10 [00:11<00:07,  1.94s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0356, 'hit_ratio@10': 0.2961, 'ndcg@10': 0.7333, 'compress@10': 0.6921, 'time@10': 2.2865}:  70%|███████   | 7/10 [00:11<00:05,  1.77s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0345, 'hit_ratio@10': 0.3466, 'ndcg@10': 0.7392, 'compress@10': 0.6205, 'time@10': 2.2627}:  70%|███████   | 7/10 [00:13<00:05,  1.77s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0345, 'hit_ratio@10': 0.3466, 'ndcg@10': 0.7392, 'compress@10': 0.6205, 'time@10': 2.2627}:  80%|████████  | 8/10 [00:13<00:03,  1.88s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0328, 'hit_ratio@10': 0.3328, 'ndcg@10': 0.7517, 'compress@10': 0.5747, 'time@10': 2.4244}:  80%|████████  | 8/10 [00:15<00:03,  1.88s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0328, 'hit_ratio@10': 0.3328, 'ndcg@10': 0.7517, 'compress@10': 0.5747, 'time@10': 2.4244}:  90%|█████████ | 9/10 [00:15<00:01,  1.89s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0328, 'hit_ratio@10': 0.3412, 'ndcg@10': 0.7587, 'compress@10': 0.5913, 'time@10': 2.4515}:  90%|█████████ | 9/10 [00:18<00:01,  1.89s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0328, 'hit_ratio@10': 0.3412, 'ndcg@10': 0.7587, 'compress@10': 0.5913, 'time@10': 2.4515}: 100%|██████████| 10/10 [00:18<00:00,  2.15s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0328, 'hit_ratio@10': 0.3412, 'ndcg@10': 0.7587, 'compress@10': 0.5913, 'time@10': 2.4515}: 100%|██████████| 10/10 [00:18<00:00,  1.82s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.03282260145329937
Avg hit ratio: 0.34116605616605616
Avg ndcg: 0.75866949786592
Avg compression ratio: 0.5913021126798421
Avg train time: 2.4515150785446167
Std train time: 0.7173553451264157
[0.35416666666666663, 0.8541666666666664, 0.22916666666666669, 0.8124999999999999, 0.895833333333333, 0.895833333333333, 0.10416666666666666, 0.020833333333333336, 0.10416666666666666, 0.7291666666666667]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.4833, 'time@10': 1.9089}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.4833, 'time@10': 1.9089}:  10%|█         | 1/10 [00:00<00:08,  1.01it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0326, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6768, 'time@10': 1.9404}:  10%|█         | 1/10 [00:02<00:08,  1.01it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0326, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6768, 'time@10': 1.9404}:  20%|██        | 2/10 [00:02<00:12,  1.59s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0222, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6561, 'time@10': 1.8123}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0222, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6561, 'time@10': 1.8123}:  30%|███       | 3/10 [00:03<00:08,  1.23s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7011, 'time@10': 1.8108}:  30%|███       | 3/10 [00:05<00:08,  1.23s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7011, 'time@10': 1.8108}:  40%|████      | 4/10 [00:05<00:08,  1.48s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.033, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7211, 'compress@10': 0.7416, 'time@10': 2.1262}:  40%|████      | 4/10 [00:07<00:08,  1.48s/it]  {'epoch': 23, 'num_users': 5.8, 'loss': 0.033, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7211, 'compress@10': 0.7416, 'time@10': 2.1262}:  50%|█████     | 5/10 [00:07<00:07,  1.57s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0358, 'hit_ratio@10': 0.3355, 'ndcg@10': 0.7309, 'compress@10': 0.7688, 'time@10': 2.2058}:  50%|█████     | 5/10 [00:10<00:07,  1.57s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0358, 'hit_ratio@10': 0.3355, 'ndcg@10': 0.7309, 'compress@10': 0.7688, 'time@10': 2.2058}:  60%|██████    | 6/10 [00:10<00:07,  1.93s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.2876, 'ndcg@10': 0.7341, 'compress@10': 0.6921, 'time@10': 2.3052}:  60%|██████    | 6/10 [00:11<00:07,  1.93s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.2876, 'ndcg@10': 0.7341, 'compress@10': 0.6921, 'time@10': 2.3052}:  70%|███████   | 7/10 [00:11<00:05,  1.79s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0334, 'hit_ratio@10': 0.3392, 'ndcg@10': 0.7398, 'compress@10': 0.6204, 'time@10': 2.2824}:  70%|███████   | 7/10 [00:13<00:05,  1.79s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0334, 'hit_ratio@10': 0.3392, 'ndcg@10': 0.7398, 'compress@10': 0.6204, 'time@10': 2.2824}:  80%|████████  | 8/10 [00:13<00:03,  1.91s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0319, 'hit_ratio@10': 0.3262, 'ndcg@10': 0.7523, 'compress@10': 0.5741, 'time@10': 2.4545}:  80%|████████  | 8/10 [00:15<00:03,  1.91s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0319, 'hit_ratio@10': 0.3262, 'ndcg@10': 0.7523, 'compress@10': 0.5741, 'time@10': 2.4545}:  90%|█████████ | 9/10 [00:15<00:01,  1.92s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.3352, 'ndcg@10': 0.7592, 'compress@10': 0.5919, 'time@10': 2.4834}:  90%|█████████ | 9/10 [00:18<00:01,  1.92s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.3352, 'ndcg@10': 0.7592, 'compress@10': 0.5919, 'time@10': 2.4834}: 100%|██████████| 10/10 [00:18<00:00,  2.19s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.3352, 'ndcg@10': 0.7592, 'compress@10': 0.5919, 'time@10': 2.4834}: 100%|██████████| 10/10 [00:18<00:00,  1.84s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.03182638430639008
Avg hit ratio: 0.33521367521367523
Avg ndcg: 0.7591964143257156
Avg compression ratio: 0.5918888232347548
Avg train time: 2.4833667516708373
Std train time: 0.7022352116043125
[0.33999999999999997, 0.8599999999999998, 0.22000000000000003, 0.8199999999999998, 0.8999999999999997, 0.8999999999999997, 0.09999999999999999, 0.020000000000000004, 0.09999999999999999, 0.7400000000000001]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.472, 'time@10': 1.9745}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.472, 'time@10': 1.9745}:  10%|█         | 1/10 [00:01<00:09,  1.02s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6738, 'time@10': 1.9394}:  10%|█         | 1/10 [00:02<00:09,  1.02s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6738, 'time@10': 1.9394}:  20%|██        | 2/10 [00:02<00:12,  1.56s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6525, 'time@10': 1.8052}:  20%|██        | 2/10 [00:03<00:12,  1.56s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6525, 'time@10': 1.8052}:  30%|███       | 3/10 [00:03<00:08,  1.22s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7, 'time@10': 1.7922}:  30%|███       | 3/10 [00:05<00:08,  1.22s/it]   {'epoch': 24, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7149, 'compress@10': 0.7, 'time@10': 1.7922}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0326, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7205, 'compress@10': 0.7415, 'time@10': 2.1161}:  40%|████      | 4/10 [00:07<00:08,  1.44s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0326, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7205, 'compress@10': 0.7415, 'time@10': 2.1161}:  50%|█████     | 5/10 [00:07<00:07,  1.55s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.035, 'hit_ratio@10': 0.3494, 'ndcg@10': 0.7326, 'compress@10': 0.7693, 'time@10': 2.1865}:  50%|█████     | 5/10 [00:09<00:07,  1.55s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.035, 'hit_ratio@10': 0.3494, 'ndcg@10': 0.7326, 'compress@10': 0.7693, 'time@10': 2.1865}:  60%|██████    | 6/10 [00:09<00:07,  1.90s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0338, 'hit_ratio@10': 0.3403, 'ndcg@10': 0.7378, 'compress@10': 0.6921, 'time@10': 2.2846}:  60%|██████    | 6/10 [00:11<00:07,  1.90s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0338, 'hit_ratio@10': 0.3403, 'ndcg@10': 0.7378, 'compress@10': 0.6921, 'time@10': 2.2846}:  70%|███████   | 7/10 [00:11<00:05,  1.76s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0327, 'hit_ratio@10': 0.3853, 'ndcg@10': 0.7431, 'compress@10': 0.6203, 'time@10': 2.2672}:  70%|███████   | 7/10 [00:13<00:05,  1.76s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0327, 'hit_ratio@10': 0.3853, 'ndcg@10': 0.7431, 'compress@10': 0.6203, 'time@10': 2.2672}:  80%|████████  | 8/10 [00:13<00:03,  1.89s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0312, 'hit_ratio@10': 0.3672, 'ndcg@10': 0.7552, 'compress@10': 0.5736, 'time@10': 2.4573}:  80%|████████  | 8/10 [00:15<00:03,  1.89s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0312, 'hit_ratio@10': 0.3672, 'ndcg@10': 0.7552, 'compress@10': 0.5736, 'time@10': 2.4573}:  90%|█████████ | 9/10 [00:15<00:01,  1.93s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0311, 'hit_ratio@10': 0.3721, 'ndcg@10': 0.7624, 'compress@10': 0.5924, 'time@10': 2.4851}:  90%|█████████ | 9/10 [00:18<00:01,  1.93s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0311, 'hit_ratio@10': 0.3721, 'ndcg@10': 0.7624, 'compress@10': 0.5924, 'time@10': 2.4851}: 100%|██████████| 10/10 [00:18<00:00,  2.20s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0311, 'hit_ratio@10': 0.3721, 'ndcg@10': 0.7624, 'compress@10': 0.5924, 'time@10': 2.4851}: 100%|██████████| 10/10 [00:18<00:00,  1.83s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.031149945208951785
Avg hit ratio: 0.3721184371184371
Avg ndcg: 0.7624062364592082
Avg compression ratio: 0.5924287744941956
Avg train time: 2.485073375701904
Std train time: 0.7384669297410339
[0.32692307692307687, 0.8653846153846152, 0.21153846153846156, 0.8269230769230768, 0.9038461538461535, 0.9038461538461535, 0.09615384615384615, 0.019230769230769235, 0.09615384615384615, 0.7500000000000001]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.4615, 'time@10': 2.0573}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.4615, 'time@10': 2.0573}:  10%|█         | 1/10 [00:01<00:09,  1.07s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6709, 'time@10': 1.9357}:  10%|█         | 1/10 [00:02<00:09,  1.07s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6709, 'time@10': 1.9357}:  20%|██        | 2/10 [00:02<00:12,  1.53s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6492, 'time@10': 1.7825}:  20%|██        | 2/10 [00:03<00:12,  1.53s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6492, 'time@10': 1.7825}:  30%|███       | 3/10 [00:03<00:08,  1.18s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7162, 'compress@10': 0.699, 'time@10': 1.7758}:  30%|███       | 3/10 [00:05<00:08,  1.18s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7162, 'compress@10': 0.699, 'time@10': 1.7758}:  40%|████      | 4/10 [00:05<00:08,  1.42s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.032, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7224, 'compress@10': 0.7415, 'time@10': 2.1049}:  40%|████      | 4/10 [00:07<00:08,  1.42s/it] {'epoch': 25, 'num_users': 5.8, 'loss': 0.032, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7224, 'compress@10': 0.7415, 'time@10': 2.1049}:  50%|█████     | 5/10 [00:07<00:07,  1.54s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0345, 'hit_ratio@10': 0.3494, 'ndcg@10': 0.7357, 'compress@10': 0.7699, 'time@10': 2.1676}:  50%|█████     | 5/10 [00:09<00:07,  1.54s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0345, 'hit_ratio@10': 0.3494, 'ndcg@10': 0.7357, 'compress@10': 0.7699, 'time@10': 2.1676}:  60%|██████    | 6/10 [00:09<00:07,  1.87s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.3403, 'ndcg@10': 0.7405, 'compress@10': 0.6921, 'time@10': 2.2657}:  60%|██████    | 6/10 [00:11<00:07,  1.87s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.3403, 'ndcg@10': 0.7405, 'compress@10': 0.6921, 'time@10': 2.2657}:  70%|███████   | 7/10 [00:11<00:05,  1.74s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0321, 'hit_ratio@10': 0.3853, 'ndcg@10': 0.7455, 'compress@10': 0.6202, 'time@10': 2.2536}:  70%|███████   | 7/10 [00:13<00:05,  1.74s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0321, 'hit_ratio@10': 0.3853, 'ndcg@10': 0.7455, 'compress@10': 0.6202, 'time@10': 2.2536}:  80%|████████  | 8/10 [00:13<00:03,  1.89s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0306, 'hit_ratio@10': 0.3672, 'ndcg@10': 0.7573, 'compress@10': 0.5732, 'time@10': 2.4489}:  80%|████████  | 8/10 [00:15<00:03,  1.89s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0306, 'hit_ratio@10': 0.3672, 'ndcg@10': 0.7573, 'compress@10': 0.5732, 'time@10': 2.4489}:  90%|█████████ | 9/10 [00:15<00:01,  1.94s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.3721, 'ndcg@10': 0.7636, 'compress@10': 0.5929, 'time@10': 2.4768}:  90%|█████████ | 9/10 [00:18<00:01,  1.94s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.3721, 'ndcg@10': 0.7636, 'compress@10': 0.5929, 'time@10': 2.4768}: 100%|██████████| 10/10 [00:18<00:00,  2.19s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.3721, 'ndcg@10': 0.7636, 'compress@10': 0.5929, 'time@10': 2.4768}: 100%|██████████| 10/10 [00:18<00:00,  1.82s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.030400991256079278
Avg hit ratio: 0.3721184371184371
Avg ndcg: 0.7636029134362261
Avg compression ratio: 0.5929281553830064
Avg train time: 2.476814341545105
Std train time: 0.7539555874099684
[0.31481481481481477, 0.8703703703703702, 0.20370370370370372, 0.8333333333333331, 0.9074074074074071, 0.9074074074074071, 0.09259259259259259, 0.018518518518518524, 0.09259259259259259, 0.7592592592592594]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.4519, 'time@10': 2.0527}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.4519, 'time@10': 2.0527}:  10%|█         | 1/10 [00:01<00:09,  1.06s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6683, 'time@10': 1.957}:  10%|█         | 1/10 [00:02<00:09,  1.06s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7738, 'compress@10': 0.6683, 'time@10': 1.957}:  20%|██        | 2/10 [00:02<00:12,  1.56s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6462, 'time@10': 1.8071}:  20%|██        | 2/10 [00:03<00:12,  1.56s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6825, 'compress@10': 0.6462, 'time@10': 1.8071}:  30%|███       | 3/10 [00:03<00:08,  1.21s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7176, 'compress@10': 0.6982, 'time@10': 1.8034}:  30%|███       | 3/10 [00:05<00:08,  1.21s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7176, 'compress@10': 0.6982, 'time@10': 1.8034}:  40%|████      | 4/10 [00:05<00:08,  1.45s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0315, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7227, 'compress@10': 0.7414, 'time@10': 2.1041}:  40%|████      | 4/10 [00:07<00:08,  1.45s/it] {'epoch': 26, 'num_users': 5.8, 'loss': 0.0315, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7227, 'compress@10': 0.7414, 'time@10': 2.1041}:  50%|█████     | 5/10 [00:07<00:07,  1.54s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.034, 'hit_ratio@10': 0.3355, 'ndcg@10': 0.735, 'compress@10': 0.7704, 'time@10': 2.1628}:  50%|█████     | 5/10 [00:09<00:07,  1.54s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.034, 'hit_ratio@10': 0.3355, 'ndcg@10': 0.735, 'compress@10': 0.7704, 'time@10': 2.1628}:  60%|██████    | 6/10 [00:09<00:07,  1.86s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0328, 'hit_ratio@10': 0.3284, 'ndcg@10': 0.7399, 'compress@10': 0.6921, 'time@10': 2.2802}:  60%|██████    | 6/10 [00:11<00:07,  1.86s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0328, 'hit_ratio@10': 0.3284, 'ndcg@10': 0.7399, 'compress@10': 0.6921, 'time@10': 2.2802}:  70%|███████   | 7/10 [00:11<00:05,  1.75s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.3749, 'ndcg@10': 0.7453, 'compress@10': 0.6201, 'time@10': 2.2578}:  70%|███████   | 7/10 [00:13<00:05,  1.75s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.3749, 'ndcg@10': 0.7453, 'compress@10': 0.6201, 'time@10': 2.2578}:  80%|████████  | 8/10 [00:13<00:03,  1.88s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0301, 'hit_ratio@10': 0.3703, 'ndcg@10': 0.7585, 'compress@10': 0.5727, 'time@10': 2.4363}:  80%|████████  | 8/10 [00:15<00:03,  1.88s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0301, 'hit_ratio@10': 0.3703, 'ndcg@10': 0.7585, 'compress@10': 0.5727, 'time@10': 2.4363}:  90%|█████████ | 9/10 [00:15<00:01,  1.90s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.3666, 'ndcg@10': 0.7648, 'compress@10': 0.5934, 'time@10': 2.4574}:  90%|█████████ | 9/10 [00:18<00:01,  1.90s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.3666, 'ndcg@10': 0.7648, 'compress@10': 0.5934, 'time@10': 2.4574}: 100%|██████████| 10/10 [00:18<00:00,  2.15s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.3666, 'ndcg@10': 0.7648, 'compress@10': 0.5934, 'time@10': 2.4574}: 100%|██████████| 10/10 [00:18<00:00,  1.81s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.02972888300562066
Avg hit ratio: 0.3665628815628816
Avg ndcg: 0.7647516977515589
Avg compression ratio: 0.5933884928747785
Avg train time: 2.4573786735534666
Std train time: 0.7073951567793322
[0.33928571428571425, 0.8749999999999999, 0.19642857142857145, 0.8392857142857141, 0.9107142857142855, 0.9107142857142855, 0.08928571428571427, 0.017857142857142863, 0.08928571428571427, 0.7321428571428573]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.4714, 'time@10': 2.085}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.4714, 'time@10': 2.085}:  10%|█         | 1/10 [00:01<00:09,  1.09s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7762, 'compress@10': 0.6802, 'time@10': 1.9659}:  10%|█         | 1/10 [00:02<00:09,  1.09s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7762, 'compress@10': 0.6802, 'time@10': 1.9659}:  20%|██        | 2/10 [00:02<00:12,  1.56s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6841, 'compress@10': 0.6528, 'time@10': 1.8565}:  20%|██        | 2/10 [00:03<00:12,  1.56s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6841, 'compress@10': 0.6528, 'time@10': 1.8565}:  30%|███       | 3/10 [00:03<00:08,  1.24s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0224, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7188, 'compress@10': 0.7045, 'time@10': 1.78}:  30%|███       | 3/10 [00:05<00:08,  1.24s/it]  {'epoch': 27, 'num_users': 5.0, 'loss': 0.0224, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7188, 'compress@10': 0.7045, 'time@10': 1.78}:  40%|████      | 4/10 [00:05<00:08,  1.38s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.031, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7228, 'compress@10': 0.7471, 'time@10': 2.0711}:  40%|████      | 4/10 [00:07<00:08,  1.38s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.031, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7228, 'compress@10': 0.7471, 'time@10': 2.0711}:  50%|█████     | 5/10 [00:07<00:07,  1.48s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0332, 'hit_ratio@10': 0.3355, 'ndcg@10': 0.7351, 'compress@10': 0.7756, 'time@10': 2.1259}:  50%|█████     | 5/10 [00:09<00:07,  1.48s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0332, 'hit_ratio@10': 0.3355, 'ndcg@10': 0.7351, 'compress@10': 0.7756, 'time@10': 2.1259}:  60%|██████    | 6/10 [00:09<00:07,  1.80s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0321, 'hit_ratio@10': 0.3284, 'ndcg@10': 0.7399, 'compress@10': 0.6961, 'time@10': 2.2292}:  60%|██████    | 6/10 [00:10<00:07,  1.80s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0321, 'hit_ratio@10': 0.3284, 'ndcg@10': 0.7399, 'compress@10': 0.6961, 'time@10': 2.2292}:  70%|███████   | 7/10 [00:10<00:05,  1.69s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0309, 'hit_ratio@10': 0.3749, 'ndcg@10': 0.7454, 'compress@10': 0.6236, 'time@10': 2.2212}:  70%|███████   | 7/10 [00:13<00:05,  1.69s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0309, 'hit_ratio@10': 0.3749, 'ndcg@10': 0.7454, 'compress@10': 0.6236, 'time@10': 2.2212}:  80%|████████  | 8/10 [00:13<00:03,  1.85s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0294, 'hit_ratio@10': 0.3703, 'ndcg@10': 0.7586, 'compress@10': 0.5755, 'time@10': 2.4199}:  80%|████████  | 8/10 [00:15<00:03,  1.85s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0294, 'hit_ratio@10': 0.3703, 'ndcg@10': 0.7586, 'compress@10': 0.5755, 'time@10': 2.4199}:  90%|█████████ | 9/10 [00:15<00:01,  1.91s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.3666, 'ndcg@10': 0.7655, 'compress@10': 0.5934, 'time@10': 2.444}:  90%|█████████ | 9/10 [00:17<00:01,  1.91s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.3666, 'ndcg@10': 0.7655, 'compress@10': 0.5934, 'time@10': 2.444}: 100%|██████████| 10/10 [00:17<00:00,  2.16s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.3666, 'ndcg@10': 0.7655, 'compress@10': 0.5934, 'time@10': 2.444}: 100%|██████████| 10/10 [00:17<00:00,  1.79s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.029112681782700944
Avg hit ratio: 0.3665628815628816
Avg ndcg: 0.7654957232546338
Avg compression ratio: 0.593402306291119
Avg train time: 2.4440463542938233
Std train time: 0.7281580086853819
[0.3620689655172413, 0.8793103448275861, 0.18965517241379312, 0.8448275862068964, 0.9137931034482756, 0.9137931034482756, 0.08620689655172413, 0.017241379310344834, 0.08620689655172413, 0.7068965517241381]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.4897, 'time@10': 1.9844}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.4897, 'time@10': 1.9844}:  10%|█         | 1/10 [00:01<00:09,  1.04s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0299, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7762, 'compress@10': 0.6912, 'time@10': 1.9112}:  10%|█         | 1/10 [00:02<00:09,  1.04s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0299, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7762, 'compress@10': 0.6912, 'time@10': 1.9112}:  20%|██        | 2/10 [00:02<00:12,  1.53s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6841, 'compress@10': 0.6591, 'time@10': 1.7875}:  20%|██        | 2/10 [00:03<00:12,  1.53s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6841, 'compress@10': 0.6591, 'time@10': 1.7875}:  30%|███       | 3/10 [00:03<00:08,  1.21s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7206, 'compress@10': 0.7104, 'time@10': 1.7373}:  30%|███       | 3/10 [00:05<00:08,  1.21s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7206, 'compress@10': 0.7104, 'time@10': 1.7373}:  40%|████      | 4/10 [00:05<00:08,  1.37s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0305, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7251, 'compress@10': 0.7524, 'time@10': 2.0526}:  40%|████      | 4/10 [00:07<00:08,  1.37s/it] {'epoch': 28, 'num_users': 5.8, 'loss': 0.0305, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7251, 'compress@10': 0.7524, 'time@10': 2.0526}:  50%|█████     | 5/10 [00:07<00:07,  1.49s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0325, 'hit_ratio@10': 0.3494, 'ndcg@10': 0.737, 'compress@10': 0.7805, 'time@10': 2.1079}:  50%|█████     | 5/10 [00:09<00:07,  1.49s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0325, 'hit_ratio@10': 0.3494, 'ndcg@10': 0.737, 'compress@10': 0.7805, 'time@10': 2.1079}:  60%|██████    | 6/10 [00:09<00:07,  1.80s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0314, 'hit_ratio@10': 0.3403, 'ndcg@10': 0.7416, 'compress@10': 0.6999, 'time@10': 2.2184}:  60%|██████    | 6/10 [00:10<00:07,  1.80s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0314, 'hit_ratio@10': 0.3403, 'ndcg@10': 0.7416, 'compress@10': 0.6999, 'time@10': 2.2184}:  70%|███████   | 7/10 [00:10<00:05,  1.70s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0302, 'hit_ratio@10': 0.3853, 'ndcg@10': 0.7482, 'compress@10': 0.6269, 'time@10': 2.2036}:  70%|███████   | 7/10 [00:13<00:05,  1.70s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0302, 'hit_ratio@10': 0.3853, 'ndcg@10': 0.7482, 'compress@10': 0.6269, 'time@10': 2.2036}:  80%|████████  | 8/10 [00:13<00:03,  1.84s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0288, 'hit_ratio@10': 0.3795, 'ndcg@10': 0.7611, 'compress@10': 0.5781, 'time@10': 2.3935}:  80%|████████  | 8/10 [00:15<00:03,  1.84s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0288, 'hit_ratio@10': 0.3795, 'ndcg@10': 0.7611, 'compress@10': 0.5781, 'time@10': 2.3935}:  90%|█████████ | 9/10 [00:15<00:01,  1.89s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0287, 'hit_ratio@10': 0.3832, 'ndcg@10': 0.7688, 'compress@10': 0.5934, 'time@10': 2.4269}:  90%|█████████ | 9/10 [00:17<00:01,  1.89s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0287, 'hit_ratio@10': 0.3832, 'ndcg@10': 0.7688, 'compress@10': 0.5934, 'time@10': 2.4269}: 100%|██████████| 10/10 [00:17<00:00,  2.16s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0287, 'hit_ratio@10': 0.3832, 'ndcg@10': 0.7688, 'compress@10': 0.5934, 'time@10': 2.4269}: 100%|██████████| 10/10 [00:17<00:00,  1.78s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.028724693451119387
Avg hit ratio: 0.38322954822954824
Avg ndcg: 0.768849134379444
Avg compression ratio: 0.5934126654478821
Avg train time: 2.426854729652405
Std train time: 0.7372413225169484
[0.3833333333333333, 0.8833333333333332, 0.18333333333333335, 0.8166666666666664, 0.9166666666666664, 0.9166666666666664, 0.08333333333333333, 0.016666666666666673, 0.08333333333333333, 0.7166666666666669]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.5067, 'time@10': 2.1217}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.5067, 'time@10': 2.1217}:  10%|█         | 1/10 [00:01<00:09,  1.10s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7785, 'compress@10': 0.7015, 'time@10': 1.9912}:  10%|█         | 1/10 [00:02<00:09,  1.10s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7785, 'compress@10': 0.7015, 'time@10': 1.9912}:  20%|██        | 2/10 [00:02<00:12,  1.57s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6856, 'compress@10': 0.6649, 'time@10': 1.8559}:  20%|██        | 2/10 [00:03<00:12,  1.57s/it]  {'epoch': 29, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6856, 'compress@10': 0.6649, 'time@10': 1.8559}:  30%|███       | 3/10 [00:03<00:08,  1.23s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7217, 'compress@10': 0.7085, 'time@10': 1.8072}:  30%|███       | 3/10 [00:05<00:08,  1.23s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7217, 'compress@10': 0.7085, 'time@10': 1.8072}:  40%|████      | 4/10 [00:05<00:08,  1.42s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.336, 'ndcg@10': 0.726, 'compress@10': 0.7515, 'time@10': 2.1435}:  40%|████      | 4/10 [00:07<00:08,  1.42s/it]  {'epoch': 29, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.336, 'ndcg@10': 0.726, 'compress@10': 0.7515, 'time@10': 2.1435}:  50%|█████     | 5/10 [00:07<00:07,  1.55s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0318, 'hit_ratio@10': 0.3355, 'ndcg@10': 0.7383, 'compress@10': 0.7801, 'time@10': 2.1971}:  50%|█████     | 5/10 [00:09<00:07,  1.55s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0318, 'hit_ratio@10': 0.3355, 'ndcg@10': 0.7383, 'compress@10': 0.7801, 'time@10': 2.1971}:  60%|██████    | 6/10 [00:09<00:07,  1.88s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0307, 'hit_ratio@10': 0.308, 'ndcg@10': 0.7427, 'compress@10': 0.6993, 'time@10': 2.3014}:  60%|██████    | 6/10 [00:11<00:07,  1.88s/it] {'epoch': 29, 'num_users': 6.2857, 'loss': 0.0307, 'hit_ratio@10': 0.308, 'ndcg@10': 0.7427, 'compress@10': 0.6993, 'time@10': 2.3014}:  70%|███████   | 7/10 [00:11<00:05,  1.76s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0295, 'hit_ratio@10': 0.357, 'ndcg@10': 0.7492, 'compress@10': 0.6263, 'time@10': 2.2789}:  70%|███████   | 7/10 [00:13<00:05,  1.76s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0295, 'hit_ratio@10': 0.357, 'ndcg@10': 0.7492, 'compress@10': 0.6263, 'time@10': 2.2789}:  80%|████████  | 8/10 [00:13<00:03,  1.88s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.3544, 'ndcg@10': 0.762, 'compress@10': 0.5773, 'time@10': 2.4536}:  80%|████████  | 8/10 [00:15<00:03,  1.88s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.3544, 'ndcg@10': 0.762, 'compress@10': 0.5773, 'time@10': 2.4536}:  90%|█████████ | 9/10 [00:15<00:01,  1.91s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.3523, 'ndcg@10': 0.7697, 'compress@10': 0.5936, 'time@10': 2.4716}:  90%|█████████ | 9/10 [00:18<00:01,  1.91s/it]  {'epoch': 29, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.3523, 'ndcg@10': 0.7697, 'compress@10': 0.5936, 'time@10': 2.4716}: 100%|██████████| 10/10 [00:18<00:00,  2.14s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.3523, 'ndcg@10': 0.7697, 'compress@10': 0.5936, 'time@10': 2.4716}: 100%|██████████| 10/10 [00:18<00:00,  1.81s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.027726717917049604
Avg hit ratio: 0.3522771672771673
Avg ndcg: 0.7697348781268429
Avg compression ratio: 0.5935628674624394
Avg train time: 2.4715950965881346
Std train time: 0.7234615592961904
[0.4032258064516129, 0.8870967741935483, 0.1774193548387097, 0.8225806451612901, 0.9193548387096772, 0.9193548387096772, 0.08064516129032258, 0.016129032258064523, 0.08064516129032258, 0.6935483870967745]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.5226, 'time@10': 2.0013}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7506, 'compress@10': 0.5226, 'time@10': 2.0013}:  10%|█         | 1/10 [00:01<00:09,  1.04s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7785, 'compress@10': 0.7111, 'time@10': 1.9299}:  10%|█         | 1/10 [00:02<00:09,  1.04s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7785, 'compress@10': 0.7111, 'time@10': 1.9299}:  20%|██        | 2/10 [00:02<00:12,  1.54s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6856, 'compress@10': 0.6703, 'time@10': 1.794}:  20%|██        | 2/10 [00:03<00:12,  1.54s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6856, 'compress@10': 0.6703, 'time@10': 1.794}:  30%|███       | 3/10 [00:03<00:08,  1.20s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7217, 'compress@10': 0.7139, 'time@10': 1.7299}:  30%|███       | 3/10 [00:05<00:08,  1.20s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7217, 'compress@10': 0.7139, 'time@10': 1.7299}:  40%|████      | 4/10 [00:05<00:08,  1.35s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.3206, 'ndcg@10': 0.726, 'compress@10': 0.7562, 'time@10': 2.054}:  40%|████      | 4/10 [00:07<00:08,  1.35s/it] {'epoch': 30, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.3206, 'ndcg@10': 0.726, 'compress@10': 0.7562, 'time@10': 2.054}:  50%|█████     | 5/10 [00:07<00:07,  1.49s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0312, 'hit_ratio@10': 0.3366, 'ndcg@10': 0.7395, 'compress@10': 0.7845, 'time@10': 2.1148}:  50%|█████     | 5/10 [00:09<00:07,  1.49s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0312, 'hit_ratio@10': 0.3366, 'ndcg@10': 0.7395, 'compress@10': 0.7845, 'time@10': 2.1148}:  60%|██████    | 6/10 [00:09<00:07,  1.82s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0301, 'hit_ratio@10': 0.3089, 'ndcg@10': 0.7444, 'compress@10': 0.7028, 'time@10': 2.2343}:  60%|██████    | 6/10 [00:11<00:07,  1.82s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0301, 'hit_ratio@10': 0.3089, 'ndcg@10': 0.7444, 'compress@10': 0.7028, 'time@10': 2.2343}:  70%|███████   | 7/10 [00:11<00:05,  1.72s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.3578, 'ndcg@10': 0.7519, 'compress@10': 0.6292, 'time@10': 2.2237}:  70%|███████   | 7/10 [00:13<00:05,  1.72s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.3578, 'ndcg@10': 0.7519, 'compress@10': 0.6292, 'time@10': 2.2237}:  80%|████████  | 8/10 [00:13<00:03,  1.87s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0275, 'hit_ratio@10': 0.3551, 'ndcg@10': 0.7644, 'compress@10': 0.5796, 'time@10': 2.4263}:  80%|████████  | 8/10 [00:15<00:03,  1.87s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0275, 'hit_ratio@10': 0.3551, 'ndcg@10': 0.7644, 'compress@10': 0.5796, 'time@10': 2.4263}:  90%|█████████ | 9/10 [00:15<00:01,  1.93s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.3613, 'ndcg@10': 0.7738, 'compress@10': 0.5936, 'time@10': 2.4536}:  90%|█████████ | 9/10 [00:17<00:01,  1.93s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.3613, 'ndcg@10': 0.7738, 'compress@10': 0.5936, 'time@10': 2.4536}: 100%|██████████| 10/10 [00:17<00:00,  2.18s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.3613, 'ndcg@10': 0.7738, 'compress@10': 0.5936, 'time@10': 2.4536}: 100%|██████████| 10/10 [00:17<00:00,  1.80s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.02689126351323452
Avg hit ratio: 0.36125152625152623
Avg ndcg: 0.7737810993407731
Avg compression ratio: 0.5935680007778099
Avg train time: 2.4536131858825683
Std train time: 0.7752805946233743
[0.421875, 0.8906249999999999, 0.171875, 0.8281249999999998, 0.9218749999999998, 0.9218749999999998, 0.078125, 0.015625000000000007, 0.078125, 0.6718750000000002]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0263, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7594, 'compress@10': 0.5375, 'time@10': 2.0579}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0263, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7594, 'compress@10': 0.5375, 'time@10': 2.0579}:  10%|█         | 1/10 [00:01<00:09,  1.07s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0281, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7912, 'compress@10': 0.7201, 'time@10': 1.9604}:  10%|█         | 1/10 [00:02<00:09,  1.07s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0281, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7912, 'compress@10': 0.7201, 'time@10': 1.9604}:  20%|██        | 2/10 [00:02<00:12,  1.57s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6941, 'compress@10': 0.6754, 'time@10': 1.8251}:  20%|██        | 2/10 [00:03<00:12,  1.57s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6941, 'compress@10': 0.6754, 'time@10': 1.8251}:  30%|███       | 3/10 [00:03<00:08,  1.22s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7281, 'compress@10': 0.719, 'time@10': 1.7733}:  30%|███       | 3/10 [00:05<00:08,  1.22s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7281, 'compress@10': 0.719, 'time@10': 1.7733}:  40%|████      | 4/10 [00:05<00:08,  1.39s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0288, 'hit_ratio@10': 0.3206, 'ndcg@10': 0.7317, 'compress@10': 0.7607, 'time@10': 2.0923}:  40%|████      | 4/10 [00:07<00:08,  1.39s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0288, 'hit_ratio@10': 0.3206, 'ndcg@10': 0.7317, 'compress@10': 0.7607, 'time@10': 2.0923}:  50%|█████     | 5/10 [00:07<00:07,  1.51s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0305, 'hit_ratio@10': 0.3227, 'ndcg@10': 0.7442, 'compress@10': 0.7887, 'time@10': 2.155}:  50%|█████     | 5/10 [00:09<00:07,  1.51s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0305, 'hit_ratio@10': 0.3227, 'ndcg@10': 0.7442, 'compress@10': 0.7887, 'time@10': 2.155}:  60%|██████    | 6/10 [00:09<00:07,  1.85s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0294, 'hit_ratio@10': 0.297, 'ndcg@10': 0.7484, 'compress@10': 0.706, 'time@10': 2.2724}:  60%|██████    | 6/10 [00:11<00:07,  1.85s/it] {'epoch': 31, 'num_users': 6.2857, 'loss': 0.0294, 'hit_ratio@10': 0.297, 'ndcg@10': 0.7484, 'compress@10': 0.706, 'time@10': 2.2724}:  70%|███████   | 7/10 [00:11<00:05,  1.75s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0282, 'hit_ratio@10': 0.3474, 'ndcg@10': 0.7563, 'compress@10': 0.632, 'time@10': 2.254}:  70%|███████   | 7/10 [00:13<00:05,  1.75s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0282, 'hit_ratio@10': 0.3474, 'ndcg@10': 0.7563, 'compress@10': 0.632, 'time@10': 2.254}:  80%|████████  | 8/10 [00:13<00:03,  1.88s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.3458, 'ndcg@10': 0.7683, 'compress@10': 0.5818, 'time@10': 2.4528}:  80%|████████  | 8/10 [00:15<00:03,  1.88s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.3458, 'ndcg@10': 0.7683, 'compress@10': 0.5818, 'time@10': 2.4528}:  90%|█████████ | 9/10 [00:15<00:01,  1.93s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0262, 'hit_ratio@10': 0.3613, 'ndcg@10': 0.777, 'compress@10': 0.5936, 'time@10': 2.4752}:  90%|█████████ | 9/10 [00:18<00:01,  1.93s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 0.0262, 'hit_ratio@10': 0.3613, 'ndcg@10': 0.777, 'compress@10': 0.5936, 'time@10': 2.4752}: 100%|██████████| 10/10 [00:18<00:00,  2.17s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0262, 'hit_ratio@10': 0.3613, 'ndcg@10': 0.777, 'compress@10': 0.5936, 'time@10': 2.4752}: 100%|██████████| 10/10 [00:18<00:00,  1.81s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.02622137181966887
Avg hit ratio: 0.36125152625152623
Avg ndcg: 0.7769971660185342
Avg compression ratio: 0.5935730516409299
Avg train time: 2.475184369087219
Std train time: 0.7617307854631225
[0.4393939393939394, 0.8939393939393938, 0.16666666666666666, 0.8333333333333331, 0.924242424242424, 0.924242424242424, 0.07575757575757576, 0.015151515151515159, 0.07575757575757576, 0.6515151515151517]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0259, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7594, 'compress@10': 0.5515, 'time@10': 2.0209}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0259, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7594, 'compress@10': 0.5515, 'time@10': 2.0209}:  10%|█         | 1/10 [00:01<00:09,  1.05s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7912, 'compress@10': 0.7286, 'time@10': 1.9108}:  10%|█         | 1/10 [00:02<00:09,  1.05s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7912, 'compress@10': 0.7286, 'time@10': 1.9108}:  20%|██        | 2/10 [00:02<00:12,  1.51s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6941, 'compress@10': 0.6802, 'time@10': 1.7869}:  20%|██        | 2/10 [00:03<00:12,  1.51s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6941, 'compress@10': 0.6802, 'time@10': 1.7869}:  30%|███       | 3/10 [00:03<00:08,  1.19s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7296, 'compress@10': 0.7237, 'time@10': 1.7396}:  30%|███       | 3/10 [00:05<00:08,  1.19s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7296, 'compress@10': 0.7237, 'time@10': 1.7396}:  40%|████      | 4/10 [00:05<00:08,  1.36s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0282, 'hit_ratio@10': 0.3206, 'ndcg@10': 0.7329, 'compress@10': 0.765, 'time@10': 2.0625}:  40%|████      | 4/10 [00:07<00:08,  1.36s/it] {'epoch': 32, 'num_users': 5.8, 'loss': 0.0282, 'hit_ratio@10': 0.3206, 'ndcg@10': 0.7329, 'compress@10': 0.765, 'time@10': 2.0625}:  50%|█████     | 5/10 [00:07<00:07,  1.49s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0297, 'hit_ratio@10': 0.3227, 'ndcg@10': 0.7452, 'compress@10': 0.7926, 'time@10': 2.1282}:  50%|█████     | 5/10 [00:09<00:07,  1.49s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0297, 'hit_ratio@10': 0.3227, 'ndcg@10': 0.7452, 'compress@10': 0.7926, 'time@10': 2.1282}:  60%|██████    | 6/10 [00:09<00:07,  1.83s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0286, 'hit_ratio@10': 0.297, 'ndcg@10': 0.75, 'compress@10': 0.709, 'time@10': 2.2386}:  60%|██████    | 6/10 [00:11<00:07,  1.83s/it]    {'epoch': 32, 'num_users': 6.2857, 'loss': 0.0286, 'hit_ratio@10': 0.297, 'ndcg@10': 0.75, 'compress@10': 0.709, 'time@10': 2.2386}:  70%|███████   | 7/10 [00:11<00:05,  1.72s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0274, 'hit_ratio@10': 0.3474, 'ndcg@10': 0.7577, 'compress@10': 0.6346, 'time@10': 2.218}:  70%|███████   | 7/10 [00:13<00:05,  1.72s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0274, 'hit_ratio@10': 0.3474, 'ndcg@10': 0.7577, 'compress@10': 0.6346, 'time@10': 2.218}:  80%|████████  | 8/10 [00:13<00:03,  1.84s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0261, 'hit_ratio@10': 0.3458, 'ndcg@10': 0.7695, 'compress@10': 0.5839, 'time@10': 2.4127}:  80%|████████  | 8/10 [00:15<00:03,  1.84s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0261, 'hit_ratio@10': 0.3458, 'ndcg@10': 0.7695, 'compress@10': 0.5839, 'time@10': 2.4127}:  90%|█████████ | 9/10 [00:15<00:01,  1.90s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.3529, 'ndcg@10': 0.7766, 'compress@10': 0.5936, 'time@10': 2.4381}:  90%|█████████ | 9/10 [00:17<00:01,  1.90s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.3529, 'ndcg@10': 0.7766, 'compress@10': 0.5936, 'time@10': 2.4381}: 100%|██████████| 10/10 [00:17<00:00,  2.15s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.3529, 'ndcg@10': 0.7766, 'compress@10': 0.5936, 'time@10': 2.4381}: 100%|██████████| 10/10 [00:17<00:00,  1.78s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.025548449991261234
Avg hit ratio: 0.35291819291819293
Avg ndcg: 0.7766209857837063
Avg compression ratio: 0.5935765267982147
Avg train time: 2.4380544900894163
Std train time: 0.7537573691872456
[0.45588235294117646, 0.8970588235294117, 0.16176470588235292, 0.8382352941176469, 0.9264705882352938, 0.9264705882352938, 0.07352941176470588, 0.014705882352941183, 0.07352941176470588, 0.6323529411764708]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0256, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7594, 'compress@10': 0.5647, 'time@10': 2.0383}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0256, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7594, 'compress@10': 0.5647, 'time@10': 2.0383}:  10%|█         | 1/10 [00:01<00:09,  1.05s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7912, 'compress@10': 0.7366, 'time@10': 1.9661}:  10%|█         | 1/10 [00:02<00:09,  1.05s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7912, 'compress@10': 0.7366, 'time@10': 1.9661}:  20%|██        | 2/10 [00:02<00:12,  1.57s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6941, 'compress@10': 0.6847, 'time@10': 1.8184}:  20%|██        | 2/10 [00:03<00:12,  1.57s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6941, 'compress@10': 0.6847, 'time@10': 1.8184}:  30%|███       | 3/10 [00:03<00:08,  1.22s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7307, 'compress@10': 0.7281, 'time@10': 1.7643}:  30%|███       | 3/10 [00:05<00:08,  1.22s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7307, 'compress@10': 0.7281, 'time@10': 1.7643}:  40%|████      | 4/10 [00:05<00:08,  1.38s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0276, 'hit_ratio@10': 0.3206, 'ndcg@10': 0.7344, 'compress@10': 0.7689, 'time@10': 2.0965}:  40%|████      | 4/10 [00:07<00:08,  1.38s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0276, 'hit_ratio@10': 0.3206, 'ndcg@10': 0.7344, 'compress@10': 0.7689, 'time@10': 2.0965}:  50%|█████     | 5/10 [00:07<00:07,  1.52s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0289, 'hit_ratio@10': 0.3227, 'ndcg@10': 0.747, 'compress@10': 0.7962, 'time@10': 2.1671}:  50%|█████     | 5/10 [00:09<00:07,  1.52s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0289, 'hit_ratio@10': 0.3227, 'ndcg@10': 0.747, 'compress@10': 0.7962, 'time@10': 2.1671}:  60%|██████    | 6/10 [00:09<00:07,  1.87s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0279, 'hit_ratio@10': 0.297, 'ndcg@10': 0.7515, 'compress@10': 0.7119, 'time@10': 2.2539}:  60%|██████    | 6/10 [00:11<00:07,  1.87s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0279, 'hit_ratio@10': 0.297, 'ndcg@10': 0.7515, 'compress@10': 0.7119, 'time@10': 2.2539}:  70%|███████   | 7/10 [00:11<00:05,  1.72s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0267, 'hit_ratio@10': 0.3474, 'ndcg@10': 0.759, 'compress@10': 0.637, 'time@10': 2.2286}:  70%|███████   | 7/10 [00:13<00:05,  1.72s/it]  {'epoch': 33, 'num_users': 6.125, 'loss': 0.0267, 'hit_ratio@10': 0.3474, 'ndcg@10': 0.759, 'compress@10': 0.637, 'time@10': 2.2286}:  80%|████████  | 8/10 [00:13<00:03,  1.84s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0254, 'hit_ratio@10': 0.3458, 'ndcg@10': 0.7707, 'compress@10': 0.5859, 'time@10': 2.4225}:  80%|████████  | 8/10 [00:15<00:03,  1.84s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0254, 'hit_ratio@10': 0.3458, 'ndcg@10': 0.7707, 'compress@10': 0.5859, 'time@10': 2.4225}:  90%|█████████ | 9/10 [00:15<00:01,  1.90s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.3613, 'ndcg@10': 0.7795, 'compress@10': 0.5936, 'time@10': 2.4581}:  90%|█████████ | 9/10 [00:18<00:01,  1.90s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.3613, 'ndcg@10': 0.7795, 'compress@10': 0.5936, 'time@10': 2.4581}: 100%|██████████| 10/10 [00:18<00:00,  2.19s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.3613, 'ndcg@10': 0.7795, 'compress@10': 0.5936, 'time@10': 2.4581}: 100%|██████████| 10/10 [00:18<00:00,  1.81s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.024740946504465955
Avg hit ratio: 0.36125152625152623
Avg ndcg: 0.7794585900363744
Avg compression ratio: 0.5935808627412829
Avg train time: 2.458065891265869
Std train time: 0.7554410449875667
[0.4714285714285714, 0.8999999999999999, 0.1571428571428571, 0.8428571428571426, 0.9285714285714283, 0.9285714285714283, 0.07142857142857142, 0.014285714285714292, 0.07142857142857142, 0.6142857142857144]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7594, 'compress@10': 0.5771, 'time@10': 2.1578}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7594, 'compress@10': 0.5771, 'time@10': 2.1578}:  10%|█         | 1/10 [00:01<00:10,  1.12s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7912, 'compress@10': 0.7441, 'time@10': 2.0867}:  10%|█         | 1/10 [00:03<00:10,  1.12s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7912, 'compress@10': 0.7441, 'time@10': 2.0867}:  20%|██        | 2/10 [00:03<00:13,  1.67s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6941, 'compress@10': 0.6889, 'time@10': 1.8929}:  20%|██        | 2/10 [00:03<00:13,  1.67s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6941, 'compress@10': 0.6889, 'time@10': 1.8929}:  30%|███       | 3/10 [00:03<00:08,  1.27s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7307, 'compress@10': 0.7323, 'time@10': 1.8337}:  30%|███       | 3/10 [00:05<00:08,  1.27s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7307, 'compress@10': 0.7323, 'time@10': 1.8337}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.027, 'hit_ratio@10': 0.3206, 'ndcg@10': 0.7319, 'compress@10': 0.7727, 'time@10': 2.1505}:  40%|████      | 4/10 [00:07<00:08,  1.44s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 0.027, 'hit_ratio@10': 0.3206, 'ndcg@10': 0.7319, 'compress@10': 0.7727, 'time@10': 2.1505}:  50%|█████     | 5/10 [00:07<00:07,  1.55s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0283, 'hit_ratio@10': 0.3088, 'ndcg@10': 0.7449, 'compress@10': 0.7996, 'time@10': 2.2121}:  50%|█████     | 5/10 [00:09<00:07,  1.55s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0283, 'hit_ratio@10': 0.3088, 'ndcg@10': 0.7449, 'compress@10': 0.7996, 'time@10': 2.2121}:  60%|██████    | 6/10 [00:09<00:07,  1.89s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0273, 'hit_ratio@10': 0.2851, 'ndcg@10': 0.7498, 'compress@10': 0.7146, 'time@10': 2.3151}:  60%|██████    | 6/10 [00:11<00:07,  1.89s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0273, 'hit_ratio@10': 0.2851, 'ndcg@10': 0.7498, 'compress@10': 0.7146, 'time@10': 2.3151}:  70%|███████   | 7/10 [00:11<00:05,  1.77s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0261, 'hit_ratio@10': 0.337, 'ndcg@10': 0.7575, 'compress@10': 0.6394, 'time@10': 2.3115}:  70%|███████   | 7/10 [00:13<00:05,  1.77s/it]  {'epoch': 34, 'num_users': 6.125, 'loss': 0.0261, 'hit_ratio@10': 0.337, 'ndcg@10': 0.7575, 'compress@10': 0.6394, 'time@10': 2.3115}:  80%|████████  | 8/10 [00:13<00:03,  1.94s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.3366, 'ndcg@10': 0.7694, 'compress@10': 0.5877, 'time@10': 2.4816}:  80%|████████  | 8/10 [00:15<00:03,  1.94s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.3366, 'ndcg@10': 0.7694, 'compress@10': 0.5877, 'time@10': 2.4816}:  90%|█████████ | 9/10 [00:15<00:01,  1.95s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.3613, 'ndcg@10': 0.779, 'compress@10': 0.5936, 'time@10': 2.5109}:  90%|█████████ | 9/10 [00:18<00:01,  1.95s/it]    {'epoch': 34, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.3613, 'ndcg@10': 0.779, 'compress@10': 0.5936, 'time@10': 2.5109}: 100%|██████████| 10/10 [00:18<00:00,  2.22s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.3613, 'ndcg@10': 0.779, 'compress@10': 0.5936, 'time@10': 2.5109}: 100%|██████████| 10/10 [00:18<00:00,  1.86s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.0247328663219741
Avg hit ratio: 0.3612515262515263
Avg ndcg: 0.7789845519543175
Avg compression ratio: 0.5935856714004354
Avg train time: 2.510876727104187
Std train time: 0.7075697603173139
[0.4861111111111111, 0.9027777777777777, 0.15277777777777773, 0.8194444444444442, 0.9305555555555552, 0.9305555555555552, 0.06944444444444445, 0.013888888888888895, 0.06944444444444445, 0.6250000000000001]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7594, 'compress@10': 0.5889, 'time@10': 2.0699}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7594, 'compress@10': 0.5889, 'time@10': 2.0699}:  10%|█         | 1/10 [00:01<00:09,  1.07s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7933, 'compress@10': 0.7512, 'time@10': 1.9732}:  10%|█         | 1/10 [00:02<00:09,  1.07s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7933, 'compress@10': 0.7512, 'time@10': 1.9732}:  20%|██        | 2/10 [00:02<00:12,  1.57s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6955, 'compress@10': 0.6929, 'time@10': 1.8193}:  20%|██        | 2/10 [00:03<00:12,  1.57s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6955, 'compress@10': 0.6929, 'time@10': 1.8193}:  30%|███       | 3/10 [00:03<00:08,  1.21s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7318, 'compress@10': 0.7302, 'time@10': 1.7715}:  30%|███       | 3/10 [00:05<00:08,  1.21s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7318, 'compress@10': 0.7302, 'time@10': 1.7715}:  40%|████      | 4/10 [00:05<00:08,  1.39s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0264, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7358, 'compress@10': 0.7713, 'time@10': 2.0883}:  40%|████      | 4/10 [00:07<00:08,  1.39s/it] {'epoch': 35, 'num_users': 5.8, 'loss': 0.0264, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7358, 'compress@10': 0.7713, 'time@10': 2.0883}:  50%|█████     | 5/10 [00:07<00:07,  1.51s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0274, 'hit_ratio@10': 0.3217, 'ndcg@10': 0.7487, 'compress@10': 0.7988, 'time@10': 2.1711}:  50%|█████     | 5/10 [00:09<00:07,  1.51s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0274, 'hit_ratio@10': 0.3217, 'ndcg@10': 0.7487, 'compress@10': 0.7988, 'time@10': 2.1711}:  60%|██████    | 6/10 [00:09<00:07,  1.89s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0265, 'hit_ratio@10': 0.2961, 'ndcg@10': 0.7531, 'compress@10': 0.7136, 'time@10': 2.2812}:  60%|██████    | 6/10 [00:11<00:07,  1.89s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0265, 'hit_ratio@10': 0.2961, 'ndcg@10': 0.7531, 'compress@10': 0.7136, 'time@10': 2.2812}:  70%|███████   | 7/10 [00:11<00:05,  1.79s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0252, 'hit_ratio@10': 0.3466, 'ndcg@10': 0.7603, 'compress@10': 0.6385, 'time@10': 2.2605}:  70%|███████   | 7/10 [00:13<00:05,  1.79s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0252, 'hit_ratio@10': 0.3466, 'ndcg@10': 0.7603, 'compress@10': 0.6385, 'time@10': 2.2605}:  80%|████████  | 8/10 [00:13<00:03,  1.91s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.024, 'hit_ratio@10': 0.3451, 'ndcg@10': 0.7719, 'compress@10': 0.5868, 'time@10': 2.4455}:  80%|████████  | 8/10 [00:15<00:03,  1.91s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.024, 'hit_ratio@10': 0.3451, 'ndcg@10': 0.7719, 'compress@10': 0.5868, 'time@10': 2.4455}:  90%|█████████ | 9/10 [00:15<00:01,  1.94s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.3523, 'ndcg@10': 0.7823, 'compress@10': 0.5937, 'time@10': 2.4757}:  90%|█████████ | 9/10 [00:18<00:01,  1.94s/it]  {'epoch': 35, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.3523, 'ndcg@10': 0.7823, 'compress@10': 0.5937, 'time@10': 2.4757}: 100%|██████████| 10/10 [00:18<00:00,  2.20s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.3523, 'ndcg@10': 0.7823, 'compress@10': 0.5937, 'time@10': 2.4757}: 100%|██████████| 10/10 [00:18<00:00,  1.83s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.023599692879751284
Avg hit ratio: 0.3522771672771673
Avg ndcg: 0.7823248299497203
Avg compression ratio: 0.5937056081368155
Avg train time: 2.4756866455078126
Std train time: 0.7402818574000974
[0.5, 0.9054054054054053, 0.1486486486486486, 0.8243243243243241, 0.9324324324324321, 0.9324324324324321, 0.06756756756756757, 0.01351351351351352, 0.06756756756756757, 0.6081081081081082]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7594, 'compress@10': 0.6, 'time@10': 1.9895}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7594, 'compress@10': 0.6, 'time@10': 1.9895}:  10%|█         | 1/10 [00:01<00:09,  1.03s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7933, 'compress@10': 0.758, 'time@10': 1.9299}:  10%|█         | 1/10 [00:02<00:09,  1.03s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7933, 'compress@10': 0.758, 'time@10': 1.9299}:  20%|██        | 2/10 [00:02<00:12,  1.55s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6955, 'compress@10': 0.6967, 'time@10': 1.8189}:  20%|██        | 2/10 [00:03<00:12,  1.55s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6955, 'compress@10': 0.6967, 'time@10': 1.8189}:  30%|███       | 3/10 [00:03<00:08,  1.22s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7318, 'compress@10': 0.7341, 'time@10': 1.7912}:  30%|███       | 3/10 [00:05<00:08,  1.22s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7318, 'compress@10': 0.7341, 'time@10': 1.7912}:  40%|████      | 4/10 [00:05<00:08,  1.43s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7352, 'compress@10': 0.7748, 'time@10': 2.1329}:  40%|████      | 4/10 [00:07<00:08,  1.43s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.336, 'ndcg@10': 0.7352, 'compress@10': 0.7748, 'time@10': 2.1329}:  50%|█████     | 5/10 [00:07<00:07,  1.56s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0265, 'hit_ratio@10': 0.3217, 'ndcg@10': 0.7502, 'compress@10': 0.802, 'time@10': 2.1913}:  50%|█████     | 5/10 [00:09<00:07,  1.56s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0265, 'hit_ratio@10': 0.3217, 'ndcg@10': 0.7502, 'compress@10': 0.802, 'time@10': 2.1913}:  60%|██████    | 6/10 [00:09<00:07,  1.88s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0256, 'hit_ratio@10': 0.2961, 'ndcg@10': 0.7544, 'compress@10': 0.7161, 'time@10': 2.2911}:  60%|██████    | 6/10 [00:11<00:07,  1.88s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0256, 'hit_ratio@10': 0.2961, 'ndcg@10': 0.7544, 'compress@10': 0.7161, 'time@10': 2.2911}:  70%|███████   | 7/10 [00:11<00:05,  1.75s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0244, 'hit_ratio@10': 0.3466, 'ndcg@10': 0.7615, 'compress@10': 0.6406, 'time@10': 2.2722}:  70%|███████   | 7/10 [00:13<00:05,  1.75s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0244, 'hit_ratio@10': 0.3466, 'ndcg@10': 0.7615, 'compress@10': 0.6406, 'time@10': 2.2722}:  80%|████████  | 8/10 [00:13<00:03,  1.89s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0232, 'hit_ratio@10': 0.3451, 'ndcg@10': 0.7729, 'compress@10': 0.5885, 'time@10': 2.4558}:  80%|████████  | 8/10 [00:15<00:03,  1.89s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0232, 'hit_ratio@10': 0.3451, 'ndcg@10': 0.7729, 'compress@10': 0.5885, 'time@10': 2.4558}:  90%|█████████ | 9/10 [00:15<00:01,  1.92s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.3523, 'ndcg@10': 0.7821, 'compress@10': 0.5937, 'time@10': 2.4862}:  90%|█████████ | 9/10 [00:18<00:01,  1.92s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.3523, 'ndcg@10': 0.7821, 'compress@10': 0.5937, 'time@10': 2.4862}: 100%|██████████| 10/10 [00:18<00:00,  2.19s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.3523, 'ndcg@10': 0.7821, 'compress@10': 0.5937, 'time@10': 2.4862}: 100%|██████████| 10/10 [00:18<00:00,  1.83s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.02251379835373587
Avg hit ratio: 0.3522771672771673
Avg ndcg: 0.7820566285325883
Avg compression ratio: 0.5937058900793849
Avg train time: 2.486209511756897
Std train time: 0.7400127109063102
[0.5131578947368421, 0.9078947368421051, 0.1447368421052631, 0.8289473684210524, 0.9342105263157892, 0.9342105263157892, 0.06578947368421054, 0.013157894736842111, 0.06578947368421054, 0.5921052631578948]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7594, 'compress@10': 0.6105, 'time@10': 2.1728}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7594, 'compress@10': 0.6105, 'time@10': 2.1728}:  10%|█         | 1/10 [00:01<00:10,  1.12s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7933, 'compress@10': 0.7643, 'time@10': 2.0266}:  10%|█         | 1/10 [00:03<00:10,  1.12s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.7933, 'compress@10': 0.7643, 'time@10': 2.0266}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6955, 'compress@10': 0.7003, 'time@10': 1.8606}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.6955, 'compress@10': 0.7003, 'time@10': 1.8606}:  30%|███       | 3/10 [00:03<00:08,  1.23s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7318, 'compress@10': 0.7378, 'time@10': 1.8081}:  30%|███       | 3/10 [00:05<00:08,  1.23s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7318, 'compress@10': 0.7378, 'time@10': 1.8081}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0251, 'hit_ratio@10': 0.3514, 'ndcg@10': 0.7359, 'compress@10': 0.7781, 'time@10': 2.1194}:  40%|████      | 4/10 [00:07<00:08,  1.41s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0251, 'hit_ratio@10': 0.3514, 'ndcg@10': 0.7359, 'compress@10': 0.7781, 'time@10': 2.1194}:  50%|█████     | 5/10 [00:07<00:07,  1.52s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0256, 'hit_ratio@10': 0.3345, 'ndcg@10': 0.7514, 'compress@10': 0.805, 'time@10': 2.18}:  50%|█████     | 5/10 [00:09<00:07,  1.52s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0256, 'hit_ratio@10': 0.3345, 'ndcg@10': 0.7514, 'compress@10': 0.805, 'time@10': 2.18}:  60%|██████    | 6/10 [00:09<00:07,  1.86s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0248, 'hit_ratio@10': 0.3071, 'ndcg@10': 0.7553, 'compress@10': 0.7185, 'time@10': 2.2697}:  60%|██████    | 6/10 [00:11<00:07,  1.86s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0248, 'hit_ratio@10': 0.3071, 'ndcg@10': 0.7553, 'compress@10': 0.7185, 'time@10': 2.2697}:  70%|███████   | 7/10 [00:11<00:05,  1.72s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0236, 'hit_ratio@10': 0.3562, 'ndcg@10': 0.7628, 'compress@10': 0.6427, 'time@10': 2.2458}:  70%|███████   | 7/10 [00:13<00:05,  1.72s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0236, 'hit_ratio@10': 0.3562, 'ndcg@10': 0.7628, 'compress@10': 0.6427, 'time@10': 2.2458}:  80%|████████  | 8/10 [00:13<00:03,  1.85s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0224, 'hit_ratio@10': 0.3537, 'ndcg@10': 0.774, 'compress@10': 0.5901, 'time@10': 2.4273}:  80%|████████  | 8/10 [00:15<00:03,  1.85s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0224, 'hit_ratio@10': 0.3537, 'ndcg@10': 0.774, 'compress@10': 0.5901, 'time@10': 2.4273}:  90%|█████████ | 9/10 [00:15<00:01,  1.89s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.3683, 'ndcg@10': 0.7832, 'compress@10': 0.5937, 'time@10': 2.4511}:  90%|█████████ | 9/10 [00:17<00:01,  1.89s/it]  {'epoch': 37, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.3683, 'ndcg@10': 0.7832, 'compress@10': 0.5937, 'time@10': 2.4511}: 100%|██████████| 10/10 [00:17<00:00,  2.14s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.3683, 'ndcg@10': 0.7832, 'compress@10': 0.5937, 'time@10': 2.4511}: 100%|██████████| 10/10 [00:17<00:00,  1.80s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.021909667967400206
Avg hit ratio: 0.36830280830280826
Avg ndcg: 0.7832477149886584
Avg compression ratio: 0.5937065593229882
Avg train time: 2.4510940074920655
Std train time: 0.7128962879848043
[0.5256410256410257, 0.9102564102564101, 0.14102564102564097, 0.8333333333333331, 0.9358974358974356, 0.9358974358974356, 0.06410256410256411, 0.012820512820512827, 0.06410256410256411, 0.576923076923077]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0237, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.6205, 'time@10': 2.0939}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0237, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.6205, 'time@10': 2.0939}:  10%|█         | 1/10 [00:01<00:09,  1.08s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.8008, 'compress@10': 0.7704, 'time@10': 1.9727}:  10%|█         | 1/10 [00:02<00:09,  1.08s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.8008, 'compress@10': 0.7704, 'time@10': 1.9727}:  20%|██        | 2/10 [00:02<00:12,  1.56s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.7005, 'compress@10': 0.7037, 'time@10': 1.827}:  20%|██        | 2/10 [00:03<00:12,  1.56s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.7005, 'compress@10': 0.7037, 'time@10': 1.827}:  30%|███       | 3/10 [00:03<00:08,  1.22s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7355, 'compress@10': 0.7413, 'time@10': 1.7838}:  30%|███       | 3/10 [00:05<00:08,  1.22s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7355, 'compress@10': 0.7413, 'time@10': 1.7838}:  40%|████      | 4/10 [00:05<00:08,  1.40s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0245, 'hit_ratio@10': 0.3668, 'ndcg@10': 0.7389, 'compress@10': 0.7812, 'time@10': 2.1097}:  40%|████      | 4/10 [00:07<00:08,  1.40s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0245, 'hit_ratio@10': 0.3668, 'ndcg@10': 0.7389, 'compress@10': 0.7812, 'time@10': 2.1097}:  50%|█████     | 5/10 [00:07<00:07,  1.53s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0248, 'hit_ratio@10': 0.3473, 'ndcg@10': 0.7557, 'compress@10': 0.8079, 'time@10': 2.1836}:  50%|█████     | 5/10 [00:09<00:07,  1.53s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0248, 'hit_ratio@10': 0.3473, 'ndcg@10': 0.7557, 'compress@10': 0.8079, 'time@10': 2.1836}:  60%|██████    | 6/10 [00:09<00:07,  1.89s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.024, 'hit_ratio@10': 0.3181, 'ndcg@10': 0.759, 'compress@10': 0.7207, 'time@10': 2.2879}:  60%|██████    | 6/10 [00:11<00:07,  1.89s/it]  {'epoch': 38, 'num_users': 6.2857, 'loss': 0.024, 'hit_ratio@10': 0.3181, 'ndcg@10': 0.759, 'compress@10': 0.7207, 'time@10': 2.2879}:  70%|███████   | 7/10 [00:11<00:05,  1.76s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0229, 'hit_ratio@10': 0.3658, 'ndcg@10': 0.7664, 'compress@10': 0.6446, 'time@10': 2.2797}:  70%|███████   | 7/10 [00:13<00:05,  1.76s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0229, 'hit_ratio@10': 0.3658, 'ndcg@10': 0.7664, 'compress@10': 0.6446, 'time@10': 2.2797}:  80%|████████  | 8/10 [00:13<00:03,  1.92s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0217, 'hit_ratio@10': 0.3499, 'ndcg@10': 0.7773, 'compress@10': 0.5917, 'time@10': 2.4862}:  80%|████████  | 8/10 [00:15<00:03,  1.92s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0217, 'hit_ratio@10': 0.3499, 'ndcg@10': 0.7773, 'compress@10': 0.5917, 'time@10': 2.4862}:  90%|█████████ | 9/10 [00:15<00:01,  1.99s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.3732, 'ndcg@10': 0.7843, 'compress@10': 0.5937, 'time@10': 2.5111}:  90%|█████████ | 9/10 [00:18<00:01,  1.99s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.3732, 'ndcg@10': 0.7843, 'compress@10': 0.5937, 'time@10': 2.5111}: 100%|██████████| 10/10 [00:18<00:00,  2.23s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.3732, 'ndcg@10': 0.7843, 'compress@10': 0.5937, 'time@10': 2.5111}: 100%|██████████| 10/10 [00:18<00:00,  1.85s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.021626633745444747
Avg hit ratio: 0.3732173382173382
Avg ndcg: 0.7843400757767103
Avg compression ratio: 0.593706254629914
Avg train time: 2.51106743812561
Std train time: 0.7780719709869922
[0.5375, 0.9124999999999999, 0.13749999999999996, 0.8124999999999998, 0.9374999999999997, 0.9374999999999997, 0.06250000000000001, 0.012500000000000006, 0.06250000000000001, 0.5875]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.63, 'time@10': 2.0138}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.63, 'time@10': 2.0138}:  10%|█         | 1/10 [00:01<00:09,  1.06s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.8008, 'compress@10': 0.7761, 'time@10': 1.9415}:  10%|█         | 1/10 [00:02<00:09,  1.06s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.8008, 'compress@10': 0.7761, 'time@10': 1.9415}:  20%|██        | 2/10 [00:02<00:12,  1.56s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.337, 'ndcg@10': 0.7005, 'compress@10': 0.707, 'time@10': 1.7921}:  20%|██        | 2/10 [00:03<00:12,  1.56s/it]  {'epoch': 39, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.337, 'ndcg@10': 0.7005, 'compress@10': 0.707, 'time@10': 1.7921}:  30%|███       | 3/10 [00:03<00:08,  1.21s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.3465, 'ndcg@10': 0.7355, 'compress@10': 0.7392, 'time@10': 1.7598}:  30%|███       | 3/10 [00:05<00:08,  1.21s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.3465, 'ndcg@10': 0.7355, 'compress@10': 0.7392, 'time@10': 1.7598}:  40%|████      | 4/10 [00:05<00:08,  1.40s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0239, 'hit_ratio@10': 0.3695, 'ndcg@10': 0.74, 'compress@10': 0.7798, 'time@10': 2.1029}:  40%|████      | 4/10 [00:07<00:08,  1.40s/it]  {'epoch': 39, 'num_users': 5.8, 'loss': 0.0239, 'hit_ratio@10': 0.3695, 'ndcg@10': 0.74, 'compress@10': 0.7798, 'time@10': 2.1029}:  50%|█████     | 5/10 [00:07<00:07,  1.54s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0241, 'hit_ratio@10': 0.3774, 'ndcg@10': 0.7566, 'compress@10': 0.807, 'time@10': 2.1695}:  50%|█████     | 5/10 [00:09<00:07,  1.54s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0241, 'hit_ratio@10': 0.3774, 'ndcg@10': 0.7566, 'compress@10': 0.807, 'time@10': 2.1695}:  60%|██████    | 6/10 [00:09<00:07,  1.88s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0233, 'hit_ratio@10': 0.3439, 'ndcg@10': 0.7621, 'compress@10': 0.7198, 'time@10': 2.2598}:  60%|██████    | 6/10 [00:11<00:07,  1.88s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0233, 'hit_ratio@10': 0.3439, 'ndcg@10': 0.7621, 'compress@10': 0.7198, 'time@10': 2.2598}:  70%|███████   | 7/10 [00:11<00:05,  1.73s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0222, 'hit_ratio@10': 0.3884, 'ndcg@10': 0.7691, 'compress@10': 0.6437, 'time@10': 2.244}:  70%|███████   | 7/10 [00:13<00:05,  1.73s/it]  {'epoch': 39, 'num_users': 6.125, 'loss': 0.0222, 'hit_ratio@10': 0.3884, 'ndcg@10': 0.7691, 'compress@10': 0.6437, 'time@10': 2.244}:  80%|████████  | 8/10 [00:13<00:03,  1.87s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0211, 'hit_ratio@10': 0.3699, 'ndcg@10': 0.7797, 'compress@10': 0.5907, 'time@10': 2.4249}:  80%|████████  | 8/10 [00:15<00:03,  1.87s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0211, 'hit_ratio@10': 0.3699, 'ndcg@10': 0.7797, 'compress@10': 0.5907, 'time@10': 2.4249}:  90%|█████████ | 9/10 [00:15<00:01,  1.90s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.3913, 'ndcg@10': 0.7883, 'compress@10': 0.5938, 'time@10': 2.4477}:  90%|█████████ | 9/10 [00:18<00:01,  1.90s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.3913, 'ndcg@10': 0.7883, 'compress@10': 0.5938, 'time@10': 2.4477}: 100%|██████████| 10/10 [00:18<00:00,  2.15s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.3913, 'ndcg@10': 0.7883, 'compress@10': 0.5938, 'time@10': 2.4477}: 100%|██████████| 10/10 [00:18<00:00,  1.81s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.02056933704133956
Avg hit ratio: 0.3912728937728938
Avg ndcg: 0.7883215730455879
Avg compression ratio: 0.5938125178477043
Avg train time: 2.447749066352844
Std train time: 0.7352514107930596
[0.548780487804878, 0.9146341463414633, 0.1341463414634146, 0.8170731707317072, 0.9390243902439022, 0.9390243902439022, 0.060975609756097573, 0.012195121951219518, 0.060975609756097573, 0.5731707317073171]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.639, 'time@10': 2.0116}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.639, 'time@10': 2.0116}:  10%|█         | 1/10 [00:01<00:09,  1.04s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.8089, 'compress@10': 0.7816, 'time@10': 1.942}:  10%|█         | 1/10 [00:02<00:09,  1.04s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.8089, 'compress@10': 0.7816, 'time@10': 1.942}:  20%|██        | 2/10 [00:02<00:12,  1.56s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.337, 'ndcg@10': 0.7059, 'compress@10': 0.7101, 'time@10': 1.8413}:  20%|██        | 2/10 [00:03<00:12,  1.56s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.337, 'ndcg@10': 0.7059, 'compress@10': 0.7101, 'time@10': 1.8413}:  30%|███       | 3/10 [00:03<00:08,  1.24s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.3465, 'ndcg@10': 0.7396, 'compress@10': 0.7425, 'time@10': 1.7882}:  30%|███       | 3/10 [00:05<00:08,  1.24s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.3465, 'ndcg@10': 0.7396, 'compress@10': 0.7425, 'time@10': 1.7882}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0233, 'hit_ratio@10': 0.3695, 'ndcg@10': 0.7433, 'compress@10': 0.7828, 'time@10': 2.1146}:  40%|████      | 4/10 [00:07<00:08,  1.41s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0233, 'hit_ratio@10': 0.3695, 'ndcg@10': 0.7433, 'compress@10': 0.7828, 'time@10': 2.1146}:  50%|█████     | 5/10 [00:07<00:07,  1.53s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0235, 'hit_ratio@10': 0.3913, 'ndcg@10': 0.7588, 'compress@10': 0.8097, 'time@10': 2.1844}:  50%|█████     | 5/10 [00:09<00:07,  1.53s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0235, 'hit_ratio@10': 0.3913, 'ndcg@10': 0.7588, 'compress@10': 0.8097, 'time@10': 2.1844}:  60%|██████    | 6/10 [00:09<00:07,  1.88s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0227, 'hit_ratio@10': 0.3762, 'ndcg@10': 0.764, 'compress@10': 0.7219, 'time@10': 2.277}:  60%|██████    | 6/10 [00:11<00:07,  1.88s/it]  {'epoch': 40, 'num_users': 6.2857, 'loss': 0.0227, 'hit_ratio@10': 0.3762, 'ndcg@10': 0.764, 'compress@10': 0.7219, 'time@10': 2.277}:  70%|███████   | 7/10 [00:11<00:05,  1.74s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0216, 'hit_ratio@10': 0.4167, 'ndcg@10': 0.7708, 'compress@10': 0.6455, 'time@10': 2.2535}:  70%|███████   | 7/10 [00:13<00:05,  1.74s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0216, 'hit_ratio@10': 0.4167, 'ndcg@10': 0.7708, 'compress@10': 0.6455, 'time@10': 2.2535}:  80%|████████  | 8/10 [00:13<00:03,  1.87s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.3951, 'ndcg@10': 0.7812, 'compress@10': 0.5922, 'time@10': 2.4366}:  80%|████████  | 8/10 [00:15<00:03,  1.87s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.3951, 'ndcg@10': 0.7812, 'compress@10': 0.5922, 'time@10': 2.4366}:  90%|█████████ | 9/10 [00:15<00:01,  1.91s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.4056, 'ndcg@10': 0.7907, 'compress@10': 0.5938, 'time@10': 2.4648}:  90%|█████████ | 9/10 [00:18<00:01,  1.91s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.4056, 'ndcg@10': 0.7907, 'compress@10': 0.5938, 'time@10': 2.4648}: 100%|██████████| 10/10 [00:18<00:00,  2.17s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.4056, 'ndcg@10': 0.7907, 'compress@10': 0.5938, 'time@10': 2.4648}: 100%|██████████| 10/10 [00:18<00:00,  1.82s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.019946689686950604
Avg hit ratio: 0.4055586080586081
Avg ndcg: 0.7906739511239731
Avg compression ratio: 0.593809484904632
Avg train time: 2.4648343086242677
Std train time: 0.7251188593526464
[0.5595238095238094, 0.9166666666666666, 0.1309523809523809, 0.8214285714285713, 0.9404761904761902, 0.9404761904761902, 0.059523809523809534, 0.011904761904761911, 0.059523809523809534, 0.5595238095238095]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.6476, 'time@10': 1.9563}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.6476, 'time@10': 1.9563}:  10%|█         | 1/10 [00:01<00:09,  1.01s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0217, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.8132, 'compress@10': 0.7868, 'time@10': 1.9153}:  10%|█         | 1/10 [00:02<00:09,  1.01s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0217, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.8132, 'compress@10': 0.7868, 'time@10': 1.9153}:  20%|██        | 2/10 [00:02<00:12,  1.54s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.337, 'ndcg@10': 0.7088, 'compress@10': 0.713, 'time@10': 1.8095}:  20%|██        | 2/10 [00:03<00:12,  1.54s/it]  {'epoch': 41, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.337, 'ndcg@10': 0.7088, 'compress@10': 0.713, 'time@10': 1.8095}:  30%|███       | 3/10 [00:03<00:08,  1.23s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.3465, 'ndcg@10': 0.7417, 'compress@10': 0.7457, 'time@10': 1.7701}:  30%|███       | 3/10 [00:05<00:08,  1.23s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.3465, 'ndcg@10': 0.7417, 'compress@10': 0.7457, 'time@10': 1.7701}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0227, 'hit_ratio@10': 0.3695, 'ndcg@10': 0.745, 'compress@10': 0.7856, 'time@10': 2.1181}:  40%|████      | 4/10 [00:07<00:08,  1.41s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 0.0227, 'hit_ratio@10': 0.3695, 'ndcg@10': 0.745, 'compress@10': 0.7856, 'time@10': 2.1181}:  50%|█████     | 5/10 [00:07<00:07,  1.55s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0229, 'hit_ratio@10': 0.3913, 'ndcg@10': 0.7613, 'compress@10': 0.8122, 'time@10': 2.2047}:  50%|█████     | 5/10 [00:09<00:07,  1.55s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0229, 'hit_ratio@10': 0.3913, 'ndcg@10': 0.7613, 'compress@10': 0.8122, 'time@10': 2.2047}:  60%|██████    | 6/10 [00:09<00:07,  1.93s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0221, 'hit_ratio@10': 0.3762, 'ndcg@10': 0.7668, 'compress@10': 0.7239, 'time@10': 2.3136}:  60%|██████    | 6/10 [00:11<00:07,  1.93s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0221, 'hit_ratio@10': 0.3762, 'ndcg@10': 0.7668, 'compress@10': 0.7239, 'time@10': 2.3136}:  70%|███████   | 7/10 [00:11<00:05,  1.80s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.021, 'hit_ratio@10': 0.4167, 'ndcg@10': 0.7735, 'compress@10': 0.6472, 'time@10': 2.2835}:  70%|███████   | 7/10 [00:13<00:05,  1.80s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.021, 'hit_ratio@10': 0.4167, 'ndcg@10': 0.7735, 'compress@10': 0.6472, 'time@10': 2.2835}:  80%|████████  | 8/10 [00:13<00:03,  1.90s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0199, 'hit_ratio@10': 0.3951, 'ndcg@10': 0.7836, 'compress@10': 0.5935, 'time@10': 2.454}:  80%|████████  | 8/10 [00:15<00:03,  1.90s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0199, 'hit_ratio@10': 0.3951, 'ndcg@10': 0.7836, 'compress@10': 0.5935, 'time@10': 2.454}:  90%|█████████ | 9/10 [00:15<00:01,  1.91s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.4139, 'ndcg@10': 0.7934, 'compress@10': 0.5938, 'time@10': 2.4855}:  90%|█████████ | 9/10 [00:18<00:01,  1.91s/it]  {'epoch': 41, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.4139, 'ndcg@10': 0.7934, 'compress@10': 0.5938, 'time@10': 2.4855}: 100%|██████████| 10/10 [00:18<00:00,  2.19s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.4139, 'ndcg@10': 0.7934, 'compress@10': 0.5938, 'time@10': 2.4855}: 100%|██████████| 10/10 [00:18<00:00,  1.83s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.019445988422268783
Avg hit ratio: 0.4138919413919414
Avg ndcg: 0.7933502048128436
Avg compression ratio: 0.5938079561419235
Avg train time: 2.485506558418274
Std train time: 0.7393262257866946
[0.569767441860465, 0.9186046511627907, 0.127906976744186, 0.8255813953488371, 0.9418604651162789, 0.9418604651162789, 0.05813953488372094, 0.011627906976744193, 0.05813953488372094, 0.5465116279069767]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.6558, 'time@10': 2.0055}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.6558, 'time@10': 2.0055}:  10%|█         | 1/10 [00:01<00:09,  1.04s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.8132, 'compress@10': 0.7917, 'time@10': 1.9736}:  10%|█         | 1/10 [00:03<00:09,  1.04s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.8132, 'compress@10': 0.7917, 'time@10': 1.9736}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.337, 'ndcg@10': 0.7088, 'compress@10': 0.7158, 'time@10': 1.8476}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.337, 'ndcg@10': 0.7088, 'compress@10': 0.7158, 'time@10': 1.8476}:  30%|███       | 3/10 [00:03<00:08,  1.25s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.3153, 'ndcg@10': 0.7417, 'compress@10': 0.7487, 'time@10': 1.8125}:  30%|███       | 3/10 [00:05<00:08,  1.25s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.3153, 'ndcg@10': 0.7417, 'compress@10': 0.7487, 'time@10': 1.8125}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0222, 'hit_ratio@10': 0.3445, 'ndcg@10': 0.745, 'compress@10': 0.7882, 'time@10': 2.1651}:  40%|████      | 4/10 [00:07<00:08,  1.44s/it] {'epoch': 42, 'num_users': 5.8, 'loss': 0.0222, 'hit_ratio@10': 0.3445, 'ndcg@10': 0.745, 'compress@10': 0.7882, 'time@10': 2.1651}:  50%|█████     | 5/10 [00:07<00:07,  1.58s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0223, 'hit_ratio@10': 0.3704, 'ndcg@10': 0.7613, 'compress@10': 0.8146, 'time@10': 2.2202}:  50%|█████     | 5/10 [00:09<00:07,  1.58s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0223, 'hit_ratio@10': 0.3704, 'ndcg@10': 0.7613, 'compress@10': 0.8146, 'time@10': 2.2202}:  60%|██████    | 6/10 [00:09<00:07,  1.91s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0215, 'hit_ratio@10': 0.3583, 'ndcg@10': 0.7672, 'compress@10': 0.7258, 'time@10': 2.3104}:  60%|██████    | 6/10 [00:11<00:07,  1.91s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0215, 'hit_ratio@10': 0.3583, 'ndcg@10': 0.7672, 'compress@10': 0.7258, 'time@10': 2.3104}:  70%|███████   | 7/10 [00:11<00:05,  1.76s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0204, 'hit_ratio@10': 0.401, 'ndcg@10': 0.7757, 'compress@10': 0.6489, 'time@10': 2.2847}:  70%|███████   | 7/10 [00:13<00:05,  1.76s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.0204, 'hit_ratio@10': 0.401, 'ndcg@10': 0.7757, 'compress@10': 0.6489, 'time@10': 2.2847}:  80%|████████  | 8/10 [00:13<00:03,  1.89s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0194, 'hit_ratio@10': 0.3688, 'ndcg@10': 0.7856, 'compress@10': 0.5949, 'time@10': 2.4669}:  80%|████████  | 8/10 [00:15<00:03,  1.89s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0194, 'hit_ratio@10': 0.3688, 'ndcg@10': 0.7856, 'compress@10': 0.5949, 'time@10': 2.4669}:  90%|█████████ | 9/10 [00:15<00:01,  1.92s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.3903, 'ndcg@10': 0.7946, 'compress@10': 0.5938, 'time@10': 2.4971}:  90%|█████████ | 9/10 [00:18<00:01,  1.92s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.3903, 'ndcg@10': 0.7946, 'compress@10': 0.5938, 'time@10': 2.4971}: 100%|██████████| 10/10 [00:18<00:00,  2.20s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.3903, 'ndcg@10': 0.7946, 'compress@10': 0.5938, 'time@10': 2.4971}: 100%|██████████| 10/10 [00:18<00:00,  1.84s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.01901470102566227
Avg hit ratio: 0.3902808302808303
Avg ndcg: 0.794627169022214
Avg compression ratio: 0.5938053702589543
Avg train time: 2.4970908880233766
Std train time: 0.7441540203558926
[0.5795454545454545, 0.9204545454545454, 0.12499999999999994, 0.8068181818181818, 0.943181818181818, 0.943181818181818, 0.07954545454545456, 0.011363636363636371, 0.05681818181818183, 0.5340909090909091]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.6636, 'time@10': 2.0031}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.6636, 'time@10': 2.0031}:  10%|█         | 1/10 [00:01<00:09,  1.04s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.8132, 'compress@10': 0.7965, 'time@10': 1.954}:  10%|█         | 1/10 [00:02<00:09,  1.04s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.8132, 'compress@10': 0.7965, 'time@10': 1.954}:  20%|██        | 2/10 [00:02<00:12,  1.57s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.7088, 'compress@10': 0.7185, 'time@10': 1.7931}:  20%|██        | 2/10 [00:03<00:12,  1.57s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.7088, 'compress@10': 0.7185, 'time@10': 1.7931}:  30%|███       | 3/10 [00:03<00:08,  1.21s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7417, 'compress@10': 0.7466, 'time@10': 1.7929}:  30%|███       | 3/10 [00:05<00:08,  1.21s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.3431, 'ndcg@10': 0.7417, 'compress@10': 0.7466, 'time@10': 1.7929}:  40%|████      | 4/10 [00:05<00:08,  1.45s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0217, 'hit_ratio@10': 0.3668, 'ndcg@10': 0.7463, 'compress@10': 0.7868, 'time@10': 2.1528}:  40%|████      | 4/10 [00:07<00:08,  1.45s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0217, 'hit_ratio@10': 0.3668, 'ndcg@10': 0.7463, 'compress@10': 0.7868, 'time@10': 2.1528}:  50%|█████     | 5/10 [00:07<00:07,  1.59s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0218, 'hit_ratio@10': 0.389, 'ndcg@10': 0.7631, 'compress@10': 0.8136, 'time@10': 2.2265}:  50%|█████     | 5/10 [00:10<00:07,  1.59s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0218, 'hit_ratio@10': 0.389, 'ndcg@10': 0.7631, 'compress@10': 0.8136, 'time@10': 2.2265}:  60%|██████    | 6/10 [00:10<00:07,  1.94s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.021, 'hit_ratio@10': 0.3742, 'ndcg@10': 0.7688, 'compress@10': 0.7276, 'time@10': 2.3178}:  60%|██████    | 6/10 [00:11<00:07,  1.94s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.021, 'hit_ratio@10': 0.3742, 'ndcg@10': 0.7688, 'compress@10': 0.7276, 'time@10': 2.3178}:  70%|███████   | 7/10 [00:11<00:05,  1.79s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.4149, 'ndcg@10': 0.7776, 'compress@10': 0.6504, 'time@10': 2.2894}:  70%|███████   | 7/10 [00:13<00:05,  1.79s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.4149, 'ndcg@10': 0.7776, 'compress@10': 0.6504, 'time@10': 2.2894}:  80%|████████  | 8/10 [00:13<00:03,  1.90s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.3935, 'ndcg@10': 0.7873, 'compress@10': 0.5961, 'time@10': 2.4638}:  80%|████████  | 8/10 [00:15<00:03,  1.90s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.3935, 'ndcg@10': 0.7873, 'compress@10': 0.5961, 'time@10': 2.4638}:  90%|█████████ | 9/10 [00:15<00:01,  1.92s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.4042, 'ndcg@10': 0.7966, 'compress@10': 0.5938, 'time@10': 2.4895}:  90%|█████████ | 9/10 [00:18<00:01,  1.92s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.4042, 'ndcg@10': 0.7966, 'compress@10': 0.5938, 'time@10': 2.4895}: 100%|██████████| 10/10 [00:18<00:00,  2.18s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.4042, 'ndcg@10': 0.7966, 'compress@10': 0.5938, 'time@10': 2.4895}: 100%|██████████| 10/10 [00:18<00:00,  1.84s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.018313308881629277
Avg hit ratio: 0.40416971916971917
Avg ndcg: 0.7966269432726771
Avg compression ratio: 0.5937636966827656
Avg train time: 2.4894630193710325
Std train time: 0.7455913061955818
[0.5888888888888888, 0.9222222222222222, 0.12222222222222216, 0.7888888888888889, 0.9444444444444443, 0.9444444444444443, 0.1, 0.011111111111111118, 0.055555555555555566, 0.5222222222222221]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.6711, 'time@10': 2.0044}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.6711, 'time@10': 2.0044}:  10%|█         | 1/10 [00:01<00:09,  1.04s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.8132, 'compress@10': 0.801, 'time@10': 1.9622}:  10%|█         | 1/10 [00:02<00:09,  1.04s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.8132, 'compress@10': 0.801, 'time@10': 1.9622}:  20%|██        | 2/10 [00:02<00:12,  1.58s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.7088, 'compress@10': 0.721, 'time@10': 1.816}:  20%|██        | 2/10 [00:03<00:12,  1.58s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.7088, 'compress@10': 0.721, 'time@10': 1.816}:  30%|███       | 3/10 [00:03<00:08,  1.22s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.3118, 'ndcg@10': 0.7417, 'compress@10': 0.7446, 'time@10': 1.7785}:  30%|███       | 3/10 [00:05<00:08,  1.22s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.3118, 'ndcg@10': 0.7417, 'compress@10': 0.7446, 'time@10': 1.7785}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0211, 'hit_ratio@10': 0.3418, 'ndcg@10': 0.7468, 'compress@10': 0.7854, 'time@10': 2.0926}:  40%|████      | 4/10 [00:07<00:08,  1.41s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0211, 'hit_ratio@10': 0.3418, 'ndcg@10': 0.7468, 'compress@10': 0.7854, 'time@10': 2.0926}:  50%|█████     | 5/10 [00:07<00:07,  1.52s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0213, 'hit_ratio@10': 0.3681, 'ndcg@10': 0.7635, 'compress@10': 0.8127, 'time@10': 2.1684}:  50%|█████     | 5/10 [00:09<00:07,  1.52s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0213, 'hit_ratio@10': 0.3681, 'ndcg@10': 0.7635, 'compress@10': 0.8127, 'time@10': 2.1684}:  60%|██████    | 6/10 [00:09<00:07,  1.88s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0205, 'hit_ratio@10': 0.3359, 'ndcg@10': 0.7691, 'compress@10': 0.7292, 'time@10': 2.2872}:  60%|██████    | 6/10 [00:11<00:07,  1.88s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0205, 'hit_ratio@10': 0.3359, 'ndcg@10': 0.7691, 'compress@10': 0.7292, 'time@10': 2.2872}:  70%|███████   | 7/10 [00:11<00:05,  1.77s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0194, 'hit_ratio@10': 0.3815, 'ndcg@10': 0.7791, 'compress@10': 0.6518, 'time@10': 2.2682}:  70%|███████   | 7/10 [00:13<00:05,  1.77s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0194, 'hit_ratio@10': 0.3815, 'ndcg@10': 0.7791, 'compress@10': 0.6518, 'time@10': 2.2682}:  80%|████████  | 8/10 [00:13<00:03,  1.90s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0184, 'hit_ratio@10': 0.3638, 'ndcg@10': 0.7885, 'compress@10': 0.5972, 'time@10': 2.4623}:  80%|████████  | 8/10 [00:15<00:03,  1.90s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0184, 'hit_ratio@10': 0.3638, 'ndcg@10': 0.7885, 'compress@10': 0.5972, 'time@10': 2.4623}:  90%|█████████ | 9/10 [00:15<00:01,  1.94s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.3774, 'ndcg@10': 0.7981, 'compress@10': 0.5937, 'time@10': 2.4934}:  90%|█████████ | 9/10 [00:18<00:01,  1.94s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.3774, 'ndcg@10': 0.7981, 'compress@10': 0.5937, 'time@10': 2.4934}: 100%|██████████| 10/10 [00:18<00:00,  2.21s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.3774, 'ndcg@10': 0.7981, 'compress@10': 0.5937, 'time@10': 2.4934}: 100%|██████████| 10/10 [00:18<00:00,  1.84s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.01778115355018788
Avg hit ratio: 0.37738400488400486
Avg ndcg: 0.7980688182326745
Avg compression ratio: 0.5937227374827205
Avg train time: 2.493397068977356
Std train time: 0.7555589642679039
[0.5978260869565216, 0.9239130434782609, 0.1195652173913043, 0.7717391304347826, 0.9456521739130433, 0.9456521739130433, 0.11956521739130435, 0.010869565217391311, 0.054347826086956534, 0.5108695652173912]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.6783, 'time@10': 2.1927}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.6783, 'time@10': 2.1927}:  10%|█         | 1/10 [00:01<00:10,  1.13s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.8132, 'compress@10': 0.8053, 'time@10': 2.0547}:  10%|█         | 1/10 [00:03<00:10,  1.13s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.8132, 'compress@10': 0.8053, 'time@10': 2.0547}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.7088, 'compress@10': 0.7235, 'time@10': 1.8878}:  20%|██        | 2/10 [00:03<00:13,  1.64s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.7088, 'compress@10': 0.7235, 'time@10': 1.8878}:  30%|███       | 3/10 [00:03<00:08,  1.26s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.3118, 'ndcg@10': 0.7417, 'compress@10': 0.7427, 'time@10': 1.8339}:  30%|███       | 3/10 [00:05<00:08,  1.26s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.3118, 'ndcg@10': 0.7417, 'compress@10': 0.7427, 'time@10': 1.8339}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0206, 'hit_ratio@10': 0.3418, 'ndcg@10': 0.7468, 'compress@10': 0.7841, 'time@10': 2.1986}:  40%|████      | 4/10 [00:07<00:08,  1.44s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0206, 'hit_ratio@10': 0.3418, 'ndcg@10': 0.7468, 'compress@10': 0.7841, 'time@10': 2.1986}:  50%|█████     | 5/10 [00:07<00:07,  1.59s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0206, 'hit_ratio@10': 0.3681, 'ndcg@10': 0.7642, 'compress@10': 0.8118, 'time@10': 2.2529}:  50%|█████     | 5/10 [00:10<00:07,  1.59s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0206, 'hit_ratio@10': 0.3681, 'ndcg@10': 0.7642, 'compress@10': 0.8118, 'time@10': 2.2529}:  60%|██████    | 6/10 [00:10<00:07,  1.92s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0199, 'hit_ratio@10': 0.3564, 'ndcg@10': 0.7697, 'compress@10': 0.7309, 'time@10': 2.3337}:  60%|██████    | 6/10 [00:11<00:07,  1.92s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0199, 'hit_ratio@10': 0.3564, 'ndcg@10': 0.7697, 'compress@10': 0.7309, 'time@10': 2.3337}:  70%|███████   | 7/10 [00:11<00:05,  1.77s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.3993, 'ndcg@10': 0.7796, 'compress@10': 0.6532, 'time@10': 2.2981}:  70%|███████   | 7/10 [00:13<00:05,  1.77s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.3993, 'ndcg@10': 0.7796, 'compress@10': 0.6532, 'time@10': 2.2981}:  80%|████████  | 8/10 [00:13<00:03,  1.87s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.3796, 'ndcg@10': 0.789, 'compress@10': 0.5984, 'time@10': 2.5038}:  80%|████████  | 8/10 [00:15<00:03,  1.87s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.3796, 'ndcg@10': 0.789, 'compress@10': 0.5984, 'time@10': 2.5038}:  90%|█████████ | 9/10 [00:15<00:01,  1.94s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7985, 'compress@10': 0.5937, 'time@10': 2.531}:  90%|█████████ | 9/10 [00:18<00:01,  1.94s/it]      {'epoch': 45, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7985, 'compress@10': 0.5937, 'time@10': 2.531}: 100%|██████████| 10/10 [00:18<00:00,  2.22s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7985, 'compress@10': 0.5937, 'time@10': 2.531}: 100%|██████████| 10/10 [00:18<00:00,  1.85s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.017331156252987995
Avg hit ratio: 0.40000305250305246
Avg ndcg: 0.798476510122436
Avg compression ratio: 0.5936835594021093
Avg train time: 2.530981683731079
Std train time: 0.8029320179326181
[0.6063829787234042, 0.925531914893617, 0.11702127659574463, 0.7553191489361702, 0.9468085106382977, 0.9468085106382977, 0.13829787234042554, 0.010638297872340432, 0.05319148936170214, 0.49999999999999994]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.6851, 'time@10': 1.986}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.6851, 'time@10': 1.986}:  10%|█         | 1/10 [00:01<00:09,  1.03s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.8132, 'compress@10': 0.8094, 'time@10': 1.9107}:  10%|█         | 1/10 [00:02<00:09,  1.03s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.8132, 'compress@10': 0.8094, 'time@10': 1.9107}:  20%|██        | 2/10 [00:02<00:12,  1.52s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.7088, 'compress@10': 0.7258, 'time@10': 1.8011}:  20%|██        | 2/10 [00:03<00:12,  1.52s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.7088, 'compress@10': 0.7258, 'time@10': 1.8011}:  30%|███       | 3/10 [00:03<00:08,  1.21s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.3118, 'ndcg@10': 0.7417, 'compress@10': 0.7408, 'time@10': 1.77}:  30%|███       | 3/10 [00:05<00:08,  1.21s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.3118, 'ndcg@10': 0.7417, 'compress@10': 0.7408, 'time@10': 1.77}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.3418, 'ndcg@10': 0.7473, 'compress@10': 0.7828, 'time@10': 2.1042}:  40%|████      | 4/10 [00:07<00:08,  1.41s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.3418, 'ndcg@10': 0.7473, 'compress@10': 0.7828, 'time@10': 2.1042}:  50%|█████     | 5/10 [00:07<00:07,  1.53s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.02, 'hit_ratio@10': 0.3681, 'ndcg@10': 0.7646, 'compress@10': 0.8109, 'time@10': 2.1764}:  50%|█████     | 5/10 [00:09<00:07,  1.53s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.02, 'hit_ratio@10': 0.3681, 'ndcg@10': 0.7646, 'compress@10': 0.8109, 'time@10': 2.1764}:  60%|██████    | 6/10 [00:09<00:07,  1.89s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0193, 'hit_ratio@10': 0.3359, 'ndcg@10': 0.7716, 'compress@10': 0.7324, 'time@10': 2.2804}:  60%|██████    | 6/10 [00:11<00:07,  1.89s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0193, 'hit_ratio@10': 0.3359, 'ndcg@10': 0.7716, 'compress@10': 0.7324, 'time@10': 2.2804}:  70%|███████   | 7/10 [00:11<00:05,  1.76s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0182, 'hit_ratio@10': 0.3815, 'ndcg@10': 0.7818, 'compress@10': 0.6546, 'time@10': 2.2641}:  70%|███████   | 7/10 [00:13<00:05,  1.76s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0182, 'hit_ratio@10': 0.3815, 'ndcg@10': 0.7818, 'compress@10': 0.6546, 'time@10': 2.2641}:  80%|████████  | 8/10 [00:13<00:03,  1.89s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.3638, 'ndcg@10': 0.791, 'compress@10': 0.5994, 'time@10': 2.4303}:  80%|████████  | 8/10 [00:15<00:03,  1.89s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.3638, 'ndcg@10': 0.791, 'compress@10': 0.5994, 'time@10': 2.4303}:  90%|█████████ | 9/10 [00:15<00:01,  1.90s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.3774, 'ndcg@10': 0.8003, 'compress@10': 0.5936, 'time@10': 2.4615}:  90%|█████████ | 9/10 [00:18<00:01,  1.90s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.3774, 'ndcg@10': 0.8003, 'compress@10': 0.5936, 'time@10': 2.4615}: 100%|██████████| 10/10 [00:18<00:00,  2.17s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.3774, 'ndcg@10': 0.8003, 'compress@10': 0.5936, 'time@10': 2.4615}: 100%|██████████| 10/10 [00:18<00:00,  1.81s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.017043866852175564
Avg hit ratio: 0.37738400488400486
Avg ndcg: 0.8002526550073987
Avg compression ratio: 0.5936470444315887
Avg train time: 2.461530590057373
Std train time: 0.7094179938118229
[0.6145833333333333, 0.9270833333333333, 0.11458333333333329, 0.7395833333333334, 0.9479166666666665, 0.9479166666666665, 0.13541666666666669, 0.010416666666666673, 0.05208333333333335, 0.5104166666666666]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.6917, 'time@10': 2.0409}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.6917, 'time@10': 2.0409}:  10%|█         | 1/10 [00:01<00:09,  1.06s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.8132, 'compress@10': 0.8134, 'time@10': 1.9861}:  10%|█         | 1/10 [00:03<00:09,  1.06s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.8132, 'compress@10': 0.8134, 'time@10': 1.9861}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.7088, 'compress@10': 0.728, 'time@10': 1.8453}:  20%|██        | 2/10 [00:03<00:12,  1.59s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.7088, 'compress@10': 0.728, 'time@10': 1.8453}:  30%|███       | 3/10 [00:03<00:08,  1.24s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.3118, 'ndcg@10': 0.7417, 'compress@10': 0.7391, 'time@10': 1.7978}:  30%|███       | 3/10 [00:05<00:08,  1.24s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.3118, 'ndcg@10': 0.7417, 'compress@10': 0.7391, 'time@10': 1.7978}:  40%|████      | 4/10 [00:05<00:08,  1.42s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.3418, 'ndcg@10': 0.7473, 'compress@10': 0.7816, 'time@10': 2.1757}:  40%|████      | 4/10 [00:07<00:08,  1.42s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.3418, 'ndcg@10': 0.7473, 'compress@10': 0.7816, 'time@10': 2.1757}:  50%|█████     | 5/10 [00:07<00:07,  1.58s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0195, 'hit_ratio@10': 0.3681, 'ndcg@10': 0.7656, 'compress@10': 0.8101, 'time@10': 2.2312}:  50%|█████     | 5/10 [00:09<00:07,  1.58s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0195, 'hit_ratio@10': 0.3681, 'ndcg@10': 0.7656, 'compress@10': 0.8101, 'time@10': 2.2312}:  60%|██████    | 6/10 [00:09<00:07,  1.91s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0188, 'hit_ratio@10': 0.3564, 'ndcg@10': 0.7724, 'compress@10': 0.7313, 'time@10': 2.3244}:  60%|██████    | 6/10 [00:11<00:07,  1.91s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0188, 'hit_ratio@10': 0.3564, 'ndcg@10': 0.7724, 'compress@10': 0.7313, 'time@10': 2.3244}:  70%|███████   | 7/10 [00:11<00:05,  1.77s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.3993, 'ndcg@10': 0.7836, 'compress@10': 0.6536, 'time@10': 2.2886}:  70%|███████   | 7/10 [00:13<00:05,  1.77s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.3993, 'ndcg@10': 0.7836, 'compress@10': 0.6536, 'time@10': 2.2886}:  80%|████████  | 8/10 [00:13<00:03,  1.87s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0167, 'hit_ratio@10': 0.3796, 'ndcg@10': 0.7925, 'compress@10': 0.5985, 'time@10': 2.4559}:  80%|████████  | 8/10 [00:15<00:03,  1.87s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0167, 'hit_ratio@10': 0.3796, 'ndcg@10': 0.7925, 'compress@10': 0.5985, 'time@10': 2.4559}:  90%|█████████ | 9/10 [00:15<00:01,  1.89s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8019, 'compress@10': 0.5937, 'time@10': 2.484}:  90%|█████████ | 9/10 [00:18<00:01,  1.89s/it]       {'epoch': 47, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8019, 'compress@10': 0.5937, 'time@10': 2.484}: 100%|██████████| 10/10 [00:18<00:00,  2.16s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8019, 'compress@10': 0.5937, 'time@10': 2.484}: 100%|██████████| 10/10 [00:18<00:00,  1.82s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.016147630935181186
Avg hit ratio: 0.40000305250305246
Avg ndcg: 0.8019335752060501
Avg compression ratio: 0.5937358400258048
Avg train time: 2.4839513063430787
Std train time: 0.7499885051766272
[0.6224489795918366, 0.9285714285714285, 0.11224489795918363, 0.7244897959183674, 0.9489795918367345, 0.9489795918367345, 0.15306122448979592, 0.010204081632653067, 0.05102040816326532, 0.49999999999999994]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.698, 'time@10': 1.9861}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.698, 'time@10': 1.9861}:  10%|█         | 1/10 [00:01<00:09,  1.03s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.8132, 'compress@10': 0.8172, 'time@10': 1.9534}:  10%|█         | 1/10 [00:02<00:09,  1.03s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.3111, 'ndcg@10': 0.8132, 'compress@10': 0.8172, 'time@10': 1.9534}:  20%|██        | 2/10 [00:02<00:12,  1.57s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.7088, 'compress@10': 0.7302, 'time@10': 1.8174}:  20%|██        | 2/10 [00:03<00:12,  1.57s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.7088, 'compress@10': 0.7302, 'time@10': 1.8174}:  30%|███       | 3/10 [00:03<00:08,  1.22s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.3118, 'ndcg@10': 0.7433, 'compress@10': 0.7374, 'time@10': 1.7703}:  30%|███       | 3/10 [00:05<00:08,  1.22s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.3118, 'ndcg@10': 0.7433, 'compress@10': 0.7374, 'time@10': 1.7703}:  40%|████      | 4/10 [00:05<00:08,  1.40s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0191, 'hit_ratio@10': 0.3418, 'ndcg@10': 0.7485, 'compress@10': 0.7805, 'time@10': 2.1376}:  40%|████      | 4/10 [00:07<00:08,  1.40s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0191, 'hit_ratio@10': 0.3418, 'ndcg@10': 0.7485, 'compress@10': 0.7805, 'time@10': 2.1376}:  50%|█████     | 5/10 [00:07<00:07,  1.56s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0189, 'hit_ratio@10': 0.3681, 'ndcg@10': 0.7679, 'compress@10': 0.8093, 'time@10': 2.2102}:  50%|█████     | 5/10 [00:09<00:07,  1.56s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0189, 'hit_ratio@10': 0.3681, 'ndcg@10': 0.7679, 'compress@10': 0.8093, 'time@10': 2.2102}:  60%|██████    | 6/10 [00:09<00:07,  1.91s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0182, 'hit_ratio@10': 0.3564, 'ndcg@10': 0.7743, 'compress@10': 0.7328, 'time@10': 2.2917}:  60%|██████    | 6/10 [00:11<00:07,  1.91s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0182, 'hit_ratio@10': 0.3564, 'ndcg@10': 0.7743, 'compress@10': 0.7328, 'time@10': 2.2917}:  70%|███████   | 7/10 [00:11<00:05,  1.75s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.3993, 'ndcg@10': 0.7853, 'compress@10': 0.6549, 'time@10': 2.2614}:  70%|███████   | 7/10 [00:13<00:05,  1.75s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.3993, 'ndcg@10': 0.7853, 'compress@10': 0.6549, 'time@10': 2.2614}:  80%|████████  | 8/10 [00:13<00:03,  1.86s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.3796, 'ndcg@10': 0.7945, 'compress@10': 0.5995, 'time@10': 2.4354}:  80%|████████  | 8/10 [00:15<00:03,  1.86s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.3796, 'ndcg@10': 0.7945, 'compress@10': 0.5995, 'time@10': 2.4354}:  90%|█████████ | 9/10 [00:15<00:01,  1.89s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.3917, 'ndcg@10': 0.804, 'compress@10': 0.5937, 'time@10': 2.4696}:  90%|█████████ | 9/10 [00:18<00:01,  1.89s/it]    {'epoch': 48, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.3917, 'ndcg@10': 0.804, 'compress@10': 0.5937, 'time@10': 2.4696}: 100%|██████████| 10/10 [00:18<00:00,  2.18s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.3917, 'ndcg@10': 0.804, 'compress@10': 0.5937, 'time@10': 2.4696}: 100%|██████████| 10/10 [00:18<00:00,  1.82s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.015588717752334438
Avg hit ratio: 0.39166971916971915
Avg ndcg: 0.8040245619959935
Avg compression ratio: 0.5936994723195577
Avg train time: 2.4695555925369264
Std train time: 0.7491839398323294
[0.6299999999999999, 0.9299999999999999, 0.10999999999999996, 0.7100000000000001, 0.9499999999999998, 0.9499999999999998, 0.17, 0.010000000000000005, 0.05000000000000002, 0.48999999999999994]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.704, 'time@10': 2.0662}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.4, 'ndcg@10': 0.7707, 'compress@10': 0.704, 'time@10': 2.0662}:  10%|█         | 1/10 [00:01<00:09,  1.07s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.8132, 'compress@10': 0.8209, 'time@10': 1.9548}:  10%|█         | 1/10 [00:02<00:09,  1.07s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.2556, 'ndcg@10': 0.8132, 'compress@10': 0.8209, 'time@10': 1.9548}:  20%|██        | 2/10 [00:02<00:12,  1.55s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.337, 'ndcg@10': 0.7088, 'compress@10': 0.7323, 'time@10': 1.779}:  20%|██        | 2/10 [00:03<00:12,  1.55s/it]   {'epoch': 49, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.337, 'ndcg@10': 0.7088, 'compress@10': 0.7323, 'time@10': 1.779}:  30%|███       | 3/10 [00:03<00:08,  1.18s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.284, 'ndcg@10': 0.7433, 'compress@10': 0.7358, 'time@10': 1.7484}:  30%|███       | 3/10 [00:05<00:08,  1.18s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.284, 'ndcg@10': 0.7433, 'compress@10': 0.7358, 'time@10': 1.7484}:  40%|████      | 4/10 [00:05<00:08,  1.38s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0186, 'hit_ratio@10': 0.3195, 'ndcg@10': 0.7497, 'compress@10': 0.7794, 'time@10': 2.0708}:  40%|████      | 4/10 [00:07<00:08,  1.38s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0186, 'hit_ratio@10': 0.3195, 'ndcg@10': 0.7497, 'compress@10': 0.7794, 'time@10': 2.0708}:  50%|█████     | 5/10 [00:07<00:07,  1.50s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0185, 'hit_ratio@10': 0.3357, 'ndcg@10': 0.7688, 'compress@10': 0.8085, 'time@10': 2.1545}:  50%|█████     | 5/10 [00:09<00:07,  1.50s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0185, 'hit_ratio@10': 0.3357, 'ndcg@10': 0.7688, 'compress@10': 0.8085, 'time@10': 2.1545}:  60%|██████    | 6/10 [00:09<00:07,  1.88s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.3286, 'ndcg@10': 0.776, 'compress@10': 0.7342, 'time@10': 2.3721}:  60%|██████    | 6/10 [00:11<00:07,  1.88s/it] {'epoch': 49, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.3286, 'ndcg@10': 0.776, 'compress@10': 0.7342, 'time@10': 2.3721}:  70%|███████   | 7/10 [00:11<00:05,  1.88s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0167, 'hit_ratio@10': 0.375, 'ndcg@10': 0.7867, 'compress@10': 0.6561, 'time@10': 2.3318}:  70%|███████   | 7/10 [00:13<00:05,  1.88s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0167, 'hit_ratio@10': 0.375, 'ndcg@10': 0.7867, 'compress@10': 0.6561, 'time@10': 2.3318}:  80%|████████  | 8/10 [00:13<00:03,  1.95s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.358, 'ndcg@10': 0.7959, 'compress@10': 0.6005, 'time@10': 2.5251}:  80%|████████  | 8/10 [00:15<00:03,  1.95s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.358, 'ndcg@10': 0.7959, 'compress@10': 0.6005, 'time@10': 2.5251}:  90%|█████████ | 9/10 [00:15<00:01,  1.99s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.3722, 'ndcg@10': 0.8062, 'compress@10': 0.5937, 'time@10': 2.5484}:  90%|█████████ | 9/10 [00:18<00:01,  1.99s/it]  {'epoch': 49, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.3722, 'ndcg@10': 0.8062, 'compress@10': 0.5937, 'time@10': 2.5484}: 100%|██████████| 10/10 [00:18<00:00,  2.24s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.3722, 'ndcg@10': 0.8062, 'compress@10': 0.5937, 'time@10': 2.5484}: 100%|██████████| 10/10 [00:18<00:00,  1.86s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.015397284892663444
Avg hit ratio: 0.3722252747252747
Avg ndcg: 0.8061628239781815
Avg compression ratio: 0.5936634989895303
Avg train time: 2.548380470275879
Std train time: 0.8561015716485799
[0.6372549019607842, 0.9313725490196078, 0.10784313725490192, 0.6960784313725491, 0.9509803921568626, 0.9509803921568626, 0.18627450980392157, 0.009803921568627456, 0.04901960784313727, 0.48039215686274506]
[10, 10, 32, 10, 6, 10, 10, 10, 10, 10]
