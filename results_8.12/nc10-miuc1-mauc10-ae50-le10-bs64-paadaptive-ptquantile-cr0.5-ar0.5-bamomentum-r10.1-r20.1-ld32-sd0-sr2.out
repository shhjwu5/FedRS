  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0629, 'hit_ratio@10': 0.973, 'ndcg@10': 0.8642, 'compress@10': 0.5135, 'time@10': 18.178}:   0%|          | 0/10 [00:09<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0629, 'hit_ratio@10': 0.973, 'ndcg@10': 0.8642, 'compress@10': 0.5135, 'time@10': 18.178}:  10%|█         | 1/10 [00:09<01:22,  9.13s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0613, 'hit_ratio@10': 0.9619, 'ndcg@10': 0.8721, 'compress@10': 0.5109, 'time@10': 16.0921}:  10%|█         | 1/10 [00:23<01:22,  9.13s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0613, 'hit_ratio@10': 0.9619, 'ndcg@10': 0.8721, 'compress@10': 0.5109, 'time@10': 16.0921}:  20%|██        | 2/10 [00:23<01:36, 12.02s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.1509, 'hit_ratio@10': 0.927, 'ndcg@10': 0.6878, 'compress@10': 0.5191, 'time@10': 12.7122}:  20%|██        | 2/10 [00:26<01:36, 12.02s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.1509, 'hit_ratio@10': 0.927, 'ndcg@10': 0.6878, 'compress@10': 0.5191, 'time@10': 12.7122}:  30%|███       | 3/10 [00:26<00:55,  7.91s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.1278, 'hit_ratio@10': 0.9313, 'ndcg@10': 0.7416, 'compress@10': 0.5167, 'time@10': 12.6624}:  30%|███       | 3/10 [00:38<00:55,  7.91s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.1278, 'hit_ratio@10': 0.9313, 'ndcg@10': 0.7416, 'compress@10': 0.5167, 'time@10': 12.6624}:  40%|████      | 4/10 [00:38<00:58,  9.74s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.1205, 'hit_ratio@10': 0.941, 'ndcg@10': 0.7608, 'compress@10': 0.5143, 'time@10': 19.4468}:  40%|████      | 4/10 [01:02<00:58,  9.74s/it] {'epoch': 0, 'num_users': 5.8, 'loss': 0.1205, 'hit_ratio@10': 0.941, 'ndcg@10': 0.7608, 'compress@10': 0.5143, 'time@10': 19.4468}:  50%|█████     | 5/10 [01:02<01:13, 14.64s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.1146, 'hit_ratio@10': 0.9396, 'ndcg@10': 0.7766, 'compress@10': 0.5129, 'time@10': 19.6516}:  50%|█████     | 5/10 [01:22<01:13, 14.64s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.1146, 'hit_ratio@10': 0.9396, 'ndcg@10': 0.7766, 'compress@10': 0.5129, 'time@10': 19.6516}:  60%|██████    | 6/10 [01:22<01:06, 16.71s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.1051, 'hit_ratio@10': 0.9393, 'ndcg@10': 0.7969, 'compress@10': 0.5125, 'time@10': 20.0641}:  60%|██████    | 6/10 [01:34<01:06, 16.71s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.1051, 'hit_ratio@10': 0.9393, 'ndcg@10': 0.7969, 'compress@10': 0.5125, 'time@10': 20.0641}:  70%|███████   | 7/10 [01:34<00:44, 14.94s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.0975, 'hit_ratio@10': 0.9433, 'ndcg@10': 0.8107, 'compress@10': 0.5119, 'time@10': 19.5357}:  70%|███████   | 7/10 [01:49<00:44, 14.94s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.0975, 'hit_ratio@10': 0.9433, 'ndcg@10': 0.8107, 'compress@10': 0.5119, 'time@10': 19.5357}:  80%|████████  | 8/10 [01:49<00:30, 15.24s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.0911, 'hit_ratio@10': 0.9463, 'ndcg@10': 0.8254, 'compress@10': 0.5114, 'time@10': 20.845}:  80%|████████  | 8/10 [02:05<00:30, 15.24s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.0911, 'hit_ratio@10': 0.9463, 'ndcg@10': 0.8254, 'compress@10': 0.5114, 'time@10': 20.845}:  90%|█████████ | 9/10 [02:05<00:15, 15.38s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.0874, 'hit_ratio@10': 0.9471, 'ndcg@10': 0.832, 'compress@10': 0.5108, 'time@10': 20.8167}:  90%|█████████ | 9/10 [02:26<00:15, 15.38s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.0874, 'hit_ratio@10': 0.9471, 'ndcg@10': 0.832, 'compress@10': 0.5108, 'time@10': 20.8167}: 100%|██████████| 10/10 [02:26<00:00, 16.99s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.0874, 'hit_ratio@10': 0.9471, 'ndcg@10': 0.832, 'compress@10': 0.5108, 'time@10': 20.8167}: 100%|██████████| 10/10 [02:26<00:00, 14.63s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.08737792253768674
Avg hit ratio: 0.9470971397182744
Avg ndcg: 0.8319737622533051
Avg compression ratio: 0.5108131499166777
Avg train time: 20.816711831092835
Std train time: 10.702230084155811
[0.75, 0.75, 0.75, 0.25, 0.75, 0.75, 0.25, 0.25, 0.25, 0.25]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0515, 'hit_ratio@10': 0.9459, 'ndcg@10': 0.9057, 'compress@10': 0.7568, 'time@10': 16.5877}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0515, 'hit_ratio@10': 0.9459, 'ndcg@10': 0.9057, 'compress@10': 0.7568, 'time@10': 16.5877}:  10%|█         | 1/10 [00:08<01:14,  8.33s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0535, 'hit_ratio@10': 0.9484, 'ndcg@10': 0.8915, 'compress@10': 0.7554, 'time@10': 15.2367}:  10%|█         | 1/10 [00:22<01:14,  8.33s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0535, 'hit_ratio@10': 0.9484, 'ndcg@10': 0.8915, 'compress@10': 0.7554, 'time@10': 15.2367}:  20%|██        | 2/10 [00:22<01:32, 11.62s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.9418, 'ndcg@10': 0.9038, 'compress@10': 0.7596, 'time@10': 12.311}:  20%|██        | 2/10 [00:25<01:32, 11.62s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.9418, 'ndcg@10': 0.9038, 'compress@10': 0.7596, 'time@10': 12.311}:  30%|███       | 3/10 [00:25<00:54,  7.81s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.041, 'hit_ratio@10': 0.9424, 'ndcg@10': 0.9021, 'compress@10': 0.6356, 'time@10': 12.3786}:  30%|███       | 3/10 [00:38<00:54,  7.81s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.041, 'hit_ratio@10': 0.9424, 'ndcg@10': 0.9021, 'compress@10': 0.6356, 'time@10': 12.3786}:  40%|████      | 4/10 [00:38<00:58,  9.71s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0487, 'hit_ratio@10': 0.9499, 'ndcg@10': 0.891, 'compress@10': 0.659, 'time@10': 18.1201}:  40%|████      | 4/10 [00:58<00:58,  9.71s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 0.0487, 'hit_ratio@10': 0.9499, 'ndcg@10': 0.891, 'compress@10': 0.659, 'time@10': 18.1201}:  50%|█████     | 5/10 [00:58<01:08, 13.63s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0526, 'hit_ratio@10': 0.9508, 'ndcg@10': 0.8868, 'compress@10': 0.6747, 'time@10': 18.5156}:  50%|█████     | 5/10 [01:19<01:08, 13.63s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0526, 'hit_ratio@10': 0.9508, 'ndcg@10': 0.8868, 'compress@10': 0.6747, 'time@10': 18.5156}:  60%|██████    | 6/10 [01:19<01:03, 15.97s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0519, 'hit_ratio@10': 0.9489, 'ndcg@10': 0.8875, 'compress@10': 0.6162, 'time@10': 18.9698}:  60%|██████    | 6/10 [01:30<01:03, 15.97s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0519, 'hit_ratio@10': 0.9489, 'ndcg@10': 0.8875, 'compress@10': 0.6162, 'time@10': 18.9698}:  70%|███████   | 7/10 [01:30<00:42, 14.31s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0528, 'hit_ratio@10': 0.9535, 'ndcg@10': 0.8897, 'compress@10': 0.5718, 'time@10': 18.6068}:  70%|███████   | 7/10 [01:46<00:42, 14.31s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0528, 'hit_ratio@10': 0.9535, 'ndcg@10': 0.8897, 'compress@10': 0.5718, 'time@10': 18.6068}:  80%|████████  | 8/10 [01:46<00:29, 14.88s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0556, 'hit_ratio@10': 0.9537, 'ndcg@10': 0.891, 'compress@10': 0.5373, 'time@10': 19.5788}:  80%|████████  | 8/10 [01:59<00:29, 14.88s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0556, 'hit_ratio@10': 0.9537, 'ndcg@10': 0.891, 'compress@10': 0.5373, 'time@10': 19.5788}:  90%|█████████ | 9/10 [01:59<00:14, 14.52s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0552, 'hit_ratio@10': 0.956, 'ndcg@10': 0.8922, 'compress@10': 0.5094, 'time@10': 19.6028}:  90%|█████████ | 9/10 [02:19<00:14, 14.52s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0552, 'hit_ratio@10': 0.956, 'ndcg@10': 0.8922, 'compress@10': 0.5094, 'time@10': 19.6028}: 100%|██████████| 10/10 [02:19<00:00, 16.17s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0552, 'hit_ratio@10': 0.956, 'ndcg@10': 0.8922, 'compress@10': 0.5094, 'time@10': 19.6028}: 100%|██████████| 10/10 [02:19<00:00, 13.98s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05515196580760542
Avg hit ratio: 0.9560139504912779
Avg ndcg: 0.892233061863952
Avg compression ratio: 0.5094118311461565
Avg train time: 19.602768063545227
Std train time: 8.962029354327148
[0.5, 0.8333333333333334, 0.5, 0.16666666666666669, 0.8333333333333334, 0.8333333333333334, 0.16666666666666669, 0.5, 0.5, 0.16666666666666669]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.9459, 'ndcg@10': 0.8829, 'compress@10': 0.5135, 'time@10': 17.1478}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.9459, 'ndcg@10': 0.8829, 'compress@10': 0.5135, 'time@10': 17.1478}:  10%|█         | 1/10 [00:08<01:17,  8.61s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0523, 'hit_ratio@10': 0.9484, 'ndcg@10': 0.8866, 'compress@10': 0.6748, 'time@10': 15.4766}:  10%|█         | 1/10 [00:22<01:17,  8.61s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0523, 'hit_ratio@10': 0.9484, 'ndcg@10': 0.8866, 'compress@10': 0.6748, 'time@10': 15.4766}:  20%|██        | 2/10 [00:22<01:33, 11.69s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.9418, 'ndcg@10': 0.9006, 'compress@10': 0.6284, 'time@10': 12.7879}:  20%|██        | 2/10 [00:26<01:33, 11.69s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.9418, 'ndcg@10': 0.9006, 'compress@10': 0.6284, 'time@10': 12.7879}:  30%|███       | 3/10 [00:26<00:56,  8.06s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0403, 'hit_ratio@10': 0.9424, 'ndcg@10': 0.8969, 'compress@10': 0.5168, 'time@10': 12.6426}:  30%|███       | 3/10 [00:38<00:56,  8.06s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0403, 'hit_ratio@10': 0.9424, 'ndcg@10': 0.8969, 'compress@10': 0.5168, 'time@10': 12.6426}:  40%|████      | 4/10 [00:38<00:58,  9.71s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0474, 'hit_ratio@10': 0.9499, 'ndcg@10': 0.8863, 'compress@10': 0.5805, 'time@10': 17.3669}:  40%|████      | 4/10 [00:56<00:58,  9.71s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0474, 'hit_ratio@10': 0.9499, 'ndcg@10': 0.8863, 'compress@10': 0.5805, 'time@10': 17.3669}:  50%|█████     | 5/10 [00:56<01:03, 12.76s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0501, 'hit_ratio@10': 0.9508, 'ndcg@10': 0.8842, 'compress@10': 0.6229, 'time@10': 17.8224}:  50%|█████     | 5/10 [01:16<01:03, 12.76s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0501, 'hit_ratio@10': 0.9508, 'ndcg@10': 0.8842, 'compress@10': 0.6229, 'time@10': 17.8224}:  60%|██████    | 6/10 [01:16<01:01, 15.27s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0503, 'hit_ratio@10': 0.9519, 'ndcg@10': 0.8873, 'compress@10': 0.5602, 'time@10': 18.2694}:  60%|██████    | 6/10 [01:27<01:01, 15.27s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0503, 'hit_ratio@10': 0.9519, 'ndcg@10': 0.8873, 'compress@10': 0.5602, 'time@10': 18.2694}:  70%|███████   | 7/10 [01:27<00:41, 13.71s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.9561, 'ndcg@10': 0.8887, 'compress@10': 0.5536, 'time@10': 17.9731}:  70%|███████   | 7/10 [01:43<00:41, 13.71s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.9561, 'ndcg@10': 0.8887, 'compress@10': 0.5536, 'time@10': 17.9731}:  80%|████████  | 8/10 [01:43<00:28, 14.42s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0527, 'hit_ratio@10': 0.956, 'ndcg@10': 0.8904, 'compress@10': 0.5485, 'time@10': 19.1459}:  80%|████████  | 8/10 [01:57<00:28, 14.42s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0527, 'hit_ratio@10': 0.956, 'ndcg@10': 0.8904, 'compress@10': 0.5485, 'time@10': 19.1459}:  90%|█████████ | 9/10 [01:57<00:14, 14.38s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0524, 'hit_ratio@10': 0.9581, 'ndcg@10': 0.8928, 'compress@10': 0.5112, 'time@10': 19.2267}:  90%|█████████ | 9/10 [02:17<00:14, 14.38s/it]  {'epoch': 2, 'num_users': 6.3, 'loss': 0.0524, 'hit_ratio@10': 0.9581, 'ndcg@10': 0.8928, 'compress@10': 0.5112, 'time@10': 19.2267}: 100%|██████████| 10/10 [02:17<00:00, 16.12s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0524, 'hit_ratio@10': 0.9581, 'ndcg@10': 0.8928, 'compress@10': 0.5112, 'time@10': 19.2267}: 100%|██████████| 10/10 [02:17<00:00, 13.75s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.0524101752501307
Avg hit ratio: 0.9580972838246113
Avg ndcg: 0.892761708240321
Avg compression ratio: 0.5112459608074671
Avg train time: 19.22670030593872
Std train time: 7.840534719241209
[0.375, 0.875, 0.375, 0.375, 0.875, 0.875, 0.125, 0.375, 0.625, 0.125]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9047, 'compress@10': 0.3919, 'time@10': 17.0943}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9047, 'compress@10': 0.3919, 'time@10': 17.0943}:  10%|█         | 1/10 [00:08<01:17,  8.58s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.9619, 'ndcg@10': 0.9014, 'compress@10': 0.6345, 'time@10': 15.4723}:  10%|█         | 1/10 [00:22<01:17,  8.58s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.9619, 'ndcg@10': 0.9014, 'compress@10': 0.6345, 'time@10': 15.4723}:  20%|██        | 2/10 [00:22<01:33, 11.70s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.9508, 'ndcg@10': 0.9105, 'compress@10': 0.5629, 'time@10': 12.9177}:  20%|██        | 2/10 [00:26<01:33, 11.70s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.9508, 'ndcg@10': 0.9105, 'compress@10': 0.5629, 'time@10': 12.9177}:  30%|███       | 3/10 [00:26<00:57,  8.16s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.9538, 'ndcg@10': 0.9065, 'compress@10': 0.5188, 'time@10': 12.7749}:  30%|███       | 3/10 [00:38<00:57,  8.16s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.9538, 'ndcg@10': 0.9065, 'compress@10': 0.5188, 'time@10': 12.7749}:  40%|████      | 4/10 [00:38<00:58,  9.83s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0452, 'hit_ratio@10': 0.959, 'ndcg@10': 0.8935, 'compress@10': 0.5903, 'time@10': 16.2442}:  40%|████      | 4/10 [00:53<00:58,  9.83s/it] {'epoch': 3, 'num_users': 5.8, 'loss': 0.0452, 'hit_ratio@10': 0.959, 'ndcg@10': 0.8935, 'compress@10': 0.5903, 'time@10': 16.2442}:  50%|█████     | 5/10 [00:53<00:58, 11.73s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0472, 'hit_ratio@10': 0.9602, 'ndcg@10': 0.8914, 'compress@10': 0.638, 'time@10': 16.9356}:  50%|█████     | 5/10 [01:14<00:58, 11.73s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0472, 'hit_ratio@10': 0.9602, 'ndcg@10': 0.8914, 'compress@10': 0.638, 'time@10': 16.9356}:  60%|██████    | 6/10 [01:14<00:58, 14.69s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0472, 'hit_ratio@10': 0.957, 'ndcg@10': 0.8923, 'compress@10': 0.5673, 'time@10': 17.5777}:  60%|██████    | 6/10 [01:25<00:58, 14.69s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0472, 'hit_ratio@10': 0.957, 'ndcg@10': 0.8923, 'compress@10': 0.5673, 'time@10': 17.5777}:  70%|███████   | 7/10 [01:25<00:40, 13.40s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0473, 'hit_ratio@10': 0.9606, 'ndcg@10': 0.8927, 'compress@10': 0.5444, 'time@10': 17.3697}:  70%|███████   | 7/10 [01:41<00:40, 13.40s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0473, 'hit_ratio@10': 0.9606, 'ndcg@10': 0.8927, 'compress@10': 0.5444, 'time@10': 17.3697}:  80%|████████  | 8/10 [01:41<00:28, 14.21s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0485, 'hit_ratio@10': 0.9616, 'ndcg@10': 0.8957, 'compress@10': 0.554, 'time@10': 18.5813}:  80%|████████  | 8/10 [01:55<00:28, 14.21s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0485, 'hit_ratio@10': 0.9616, 'ndcg@10': 0.8957, 'compress@10': 0.554, 'time@10': 18.5813}:  90%|█████████ | 9/10 [01:55<00:14, 14.20s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0476, 'hit_ratio@10': 0.9632, 'ndcg@10': 0.8982, 'compress@10': 0.5121, 'time@10': 18.6961}:  90%|█████████ | 9/10 [02:14<00:14, 14.20s/it]  {'epoch': 3, 'num_users': 6.3, 'loss': 0.0476, 'hit_ratio@10': 0.9632, 'ndcg@10': 0.8982, 'compress@10': 0.5121, 'time@10': 18.6961}: 100%|██████████| 10/10 [02:14<00:00, 15.92s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0476, 'hit_ratio@10': 0.9632, 'ndcg@10': 0.8982, 'compress@10': 0.5121, 'time@10': 18.6961}: 100%|██████████| 10/10 [02:14<00:00, 13.50s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.04758471599974734
Avg hit ratio: 0.9631846378648834
Avg ndcg: 0.89818093294072
Avg compression ratio: 0.5120623755131467
Avg train time: 18.69608602523804
Std train time: 6.529541355592344
[0.3, 0.9, 0.3, 0.5, 0.9, 0.9, 0.1, 0.3, 0.7, 0.1]
[10, 10, 14, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9106, 'compress@10': 0.3189, 'time@10': 16.9537}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9106, 'compress@10': 0.3189, 'time@10': 16.9537}:  10%|█         | 1/10 [00:08<01:16,  8.51s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.9619, 'ndcg@10': 0.9075, 'compress@10': 0.6103, 'time@10': 15.4242}:  10%|█         | 1/10 [00:22<01:16,  8.51s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.9619, 'ndcg@10': 0.9075, 'compress@10': 0.6103, 'time@10': 15.4242}:  20%|██        | 2/10 [00:22<01:33, 11.70s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0331, 'hit_ratio@10': 0.9508, 'ndcg@10': 0.9145, 'compress@10': 0.5235, 'time@10': 13.1161}:  20%|██        | 2/10 [00:26<01:33, 11.70s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0331, 'hit_ratio@10': 0.9508, 'ndcg@10': 0.9145, 'compress@10': 0.5235, 'time@10': 13.1161}:  30%|███       | 3/10 [00:26<00:58,  8.32s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.9585, 'ndcg@10': 0.9132, 'compress@10': 0.52, 'time@10': 12.9445}:  30%|███       | 3/10 [00:39<00:58,  8.32s/it]  {'epoch': 4, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.9585, 'ndcg@10': 0.9132, 'compress@10': 0.52, 'time@10': 12.9445}:  40%|████      | 4/10 [00:39<00:59,  9.95s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0438, 'hit_ratio@10': 0.9627, 'ndcg@10': 0.8996, 'compress@10': 0.5962, 'time@10': 16.3889}:  40%|████      | 4/10 [00:54<00:59,  9.95s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0438, 'hit_ratio@10': 0.9627, 'ndcg@10': 0.8996, 'compress@10': 0.5962, 'time@10': 16.3889}:  50%|█████     | 5/10 [00:54<00:59, 11.82s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.045, 'hit_ratio@10': 0.9652, 'ndcg@10': 0.8972, 'compress@10': 0.647, 'time@10': 16.8658}:  50%|█████     | 5/10 [01:13<00:59, 11.82s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.045, 'hit_ratio@10': 0.9652, 'ndcg@10': 0.8972, 'compress@10': 0.647, 'time@10': 16.8658}:  60%|██████    | 6/10 [01:13<00:57, 14.36s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0451, 'hit_ratio@10': 0.9642, 'ndcg@10': 0.8994, 'compress@10': 0.5715, 'time@10': 17.5144}:  60%|██████    | 6/10 [01:24<00:57, 14.36s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0451, 'hit_ratio@10': 0.9642, 'ndcg@10': 0.8994, 'compress@10': 0.5715, 'time@10': 17.5144}:  70%|███████   | 7/10 [01:24<00:39, 13.17s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0448, 'hit_ratio@10': 0.9669, 'ndcg@10': 0.8994, 'compress@10': 0.5389, 'time@10': 17.3468}:  70%|███████   | 7/10 [01:40<00:39, 13.17s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0448, 'hit_ratio@10': 0.9669, 'ndcg@10': 0.8994, 'compress@10': 0.5389, 'time@10': 17.3468}:  80%|████████  | 8/10 [01:40<00:28, 14.14s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.045, 'hit_ratio@10': 0.9689, 'ndcg@10': 0.9081, 'compress@10': 0.5573, 'time@10': 18.604}:  80%|████████  | 8/10 [01:54<00:28, 14.14s/it] {'epoch': 4, 'num_users': 6.3333, 'loss': 0.045, 'hit_ratio@10': 0.9689, 'ndcg@10': 0.9081, 'compress@10': 0.5573, 'time@10': 18.604}:  90%|█████████ | 9/10 [01:54<00:14, 14.21s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0431, 'hit_ratio@10': 0.9686, 'ndcg@10': 0.9114, 'compress@10': 0.5126, 'time@10': 18.7247}:  90%|█████████ | 9/10 [02:14<00:14, 14.21s/it] {'epoch': 4, 'num_users': 6.3, 'loss': 0.0431, 'hit_ratio@10': 0.9686, 'ndcg@10': 0.9114, 'compress@10': 0.5126, 'time@10': 18.7247}: 100%|██████████| 10/10 [02:14<00:00, 15.95s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0431, 'hit_ratio@10': 0.9686, 'ndcg@10': 0.9114, 'compress@10': 0.5126, 'time@10': 18.7247}: 100%|██████████| 10/10 [02:14<00:00, 13.48s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.043067841061484244
Avg hit ratio: 0.9685995922327558
Avg ndcg: 0.9113669269245388
Avg compression ratio: 0.5125521638309093
Avg train time: 18.724675941467286
Std train time: 6.445526283293965
[0.41666666666666663, 0.9166666666666667, 0.25, 0.5833333333333334, 0.9166666666666667, 0.9166666666666667, 0.08333333333333334, 0.25, 0.5833333333333333, 0.08333333333333334]
[10, 10, 15, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9019, 'compress@10': 0.4324, 'time@10': 17.2744}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9019, 'compress@10': 0.4324, 'time@10': 17.2744}:  10%|█         | 1/10 [00:08<01:18,  8.68s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.9701, 'ndcg@10': 0.9063, 'compress@10': 0.6752, 'time@10': 15.4852}:  10%|█         | 1/10 [00:22<01:18,  8.68s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.9701, 'ndcg@10': 0.9063, 'compress@10': 0.6752, 'time@10': 15.4852}:  20%|██        | 2/10 [00:22<01:33, 11.65s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.9563, 'ndcg@10': 0.9137, 'compress@10': 0.5513, 'time@10': 13.3036}:  20%|██        | 2/10 [00:26<01:33, 11.65s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.9563, 'ndcg@10': 0.9137, 'compress@10': 0.5513, 'time@10': 13.3036}:  30%|███       | 3/10 [00:26<00:58,  8.39s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0346, 'hit_ratio@10': 0.9626, 'ndcg@10': 0.9122, 'compress@10': 0.5613, 'time@10': 13.0361}:  30%|███       | 3/10 [00:39<00:58,  8.39s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0346, 'hit_ratio@10': 0.9626, 'ndcg@10': 0.9122, 'compress@10': 0.5613, 'time@10': 13.0361}:  40%|████      | 4/10 [00:39<00:59,  9.92s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0402, 'hit_ratio@10': 0.966, 'ndcg@10': 0.9008, 'compress@10': 0.6325, 'time@10': 16.3589}:  40%|████      | 4/10 [00:54<00:59,  9.92s/it] {'epoch': 5, 'num_users': 5.8, 'loss': 0.0402, 'hit_ratio@10': 0.966, 'ndcg@10': 0.9008, 'compress@10': 0.6325, 'time@10': 16.3589}:  50%|█████     | 5/10 [00:54<00:58, 11.70s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0407, 'hit_ratio@10': 0.9679, 'ndcg@10': 0.9, 'compress@10': 0.68, 'time@10': 16.8683}:  50%|█████     | 5/10 [01:13<00:58, 11.70s/it] {'epoch': 5, 'num_users': 6.1667, 'loss': 0.0407, 'hit_ratio@10': 0.9679, 'ndcg@10': 0.9, 'compress@10': 0.68, 'time@10': 16.8683}:  60%|██████    | 6/10 [01:13<00:57, 14.34s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0399, 'hit_ratio@10': 0.9666, 'ndcg@10': 0.9032, 'compress@10': 0.5975, 'time@10': 17.5406}:  60%|██████    | 6/10 [01:24<00:57, 14.34s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0399, 'hit_ratio@10': 0.9666, 'ndcg@10': 0.9032, 'compress@10': 0.5975, 'time@10': 17.5406}:  70%|███████   | 7/10 [01:24<00:39, 13.19s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0397, 'hit_ratio@10': 0.9689, 'ndcg@10': 0.9065, 'compress@10': 0.5554, 'time@10': 17.3075}:  70%|███████   | 7/10 [01:40<00:39, 13.19s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0397, 'hit_ratio@10': 0.9689, 'ndcg@10': 0.9065, 'compress@10': 0.5554, 'time@10': 17.3075}:  80%|████████  | 8/10 [01:40<00:27, 14.00s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.9707, 'ndcg@10': 0.9124, 'compress@10': 0.5592, 'time@10': 18.4552}:  80%|████████  | 8/10 [01:53<00:27, 14.00s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.9707, 'ndcg@10': 0.9124, 'compress@10': 0.5592, 'time@10': 18.4552}:  90%|█████████ | 9/10 [01:53<00:13, 13.96s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.039, 'hit_ratio@10': 0.9714, 'ndcg@10': 0.9153, 'compress@10': 0.5127, 'time@10': 18.6011}:  90%|█████████ | 9/10 [02:13<00:13, 13.96s/it]    {'epoch': 5, 'num_users': 6.3, 'loss': 0.039, 'hit_ratio@10': 0.9714, 'ndcg@10': 0.9153, 'compress@10': 0.5127, 'time@10': 18.6011}: 100%|██████████| 10/10 [02:13<00:00, 15.81s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.039, 'hit_ratio@10': 0.9714, 'ndcg@10': 0.9153, 'compress@10': 0.5127, 'time@10': 18.6011}: 100%|██████████| 10/10 [02:13<00:00, 13.39s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.03900078913965503
Avg hit ratio: 0.9713753001314144
Avg ndcg: 0.9153319543370811
Avg compression ratio: 0.5126762439842193
Avg train time: 18.601111674308775
Std train time: 6.190244448387458
[0.5, 0.9285714285714286, 0.2142857142857143, 0.5, 0.9285714285714286, 0.9285714285714286, 0.07142857142857144, 0.2142857142857143, 0.6428571428571428, 0.07142857142857144]
[10, 10, 16, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.973, 'ndcg@10': 0.901, 'compress@10': 0.5135, 'time@10': 17.1876}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.973, 'ndcg@10': 0.901, 'compress@10': 0.5135, 'time@10': 17.1876}:  10%|█         | 1/10 [00:08<01:17,  8.63s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9112, 'compress@10': 0.7216, 'time@10': 15.4896}:  10%|█         | 1/10 [00:22<01:17,  8.63s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9112, 'compress@10': 0.7216, 'time@10': 15.4896}:  20%|██        | 2/10 [00:22<01:33, 11.69s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.917, 'compress@10': 0.5712, 'time@10': 13.4943}:  20%|██        | 2/10 [00:27<01:33, 11.69s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.917, 'compress@10': 0.5712, 'time@10': 13.4943}:  30%|███       | 3/10 [00:27<00:59,  8.54s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.915, 'compress@10': 0.5557, 'time@10': 13.2658}:  30%|███       | 3/10 [00:39<00:59,  8.54s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.915, 'compress@10': 0.5557, 'time@10': 13.2658}:  40%|████      | 4/10 [00:39<01:00, 10.15s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0397, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9042, 'compress@10': 0.6304, 'time@10': 16.7305}:  40%|████      | 4/10 [00:55<01:00, 10.15s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0397, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9042, 'compress@10': 0.6304, 'time@10': 16.7305}:  50%|█████     | 5/10 [00:55<01:00, 12.02s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0392, 'hit_ratio@10': 0.9707, 'ndcg@10': 0.9061, 'compress@10': 0.6803, 'time@10': 17.2623}:  50%|█████     | 5/10 [01:15<01:00, 12.02s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0392, 'hit_ratio@10': 0.9707, 'ndcg@10': 0.9061, 'compress@10': 0.6803, 'time@10': 17.2623}:  60%|██████    | 6/10 [01:15<00:58, 14.72s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0384, 'hit_ratio@10': 0.9689, 'ndcg@10': 0.9073, 'compress@10': 0.596, 'time@10': 17.7604}:  60%|██████    | 6/10 [01:25<00:58, 14.72s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.0384, 'hit_ratio@10': 0.9689, 'ndcg@10': 0.9073, 'compress@10': 0.596, 'time@10': 17.7604}:  70%|███████   | 7/10 [01:25<00:39, 13.31s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.039, 'hit_ratio@10': 0.971, 'ndcg@10': 0.9126, 'compress@10': 0.5497, 'time@10': 17.5212}:  70%|███████   | 7/10 [01:41<00:39, 13.31s/it]  {'epoch': 6, 'num_users': 6.125, 'loss': 0.039, 'hit_ratio@10': 0.971, 'ndcg@10': 0.9126, 'compress@10': 0.5497, 'time@10': 17.5212}:  80%|████████  | 8/10 [01:41<00:28, 14.13s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0393, 'hit_ratio@10': 0.9725, 'ndcg@10': 0.9194, 'compress@10': 0.5607, 'time@10': 18.6122}:  80%|████████  | 8/10 [01:55<00:28, 14.13s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0393, 'hit_ratio@10': 0.9725, 'ndcg@10': 0.9194, 'compress@10': 0.5607, 'time@10': 18.6122}:  90%|█████████ | 9/10 [01:55<00:13, 14.00s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.038, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9215, 'compress@10': 0.5128, 'time@10': 18.6912}:  90%|█████████ | 9/10 [02:14<00:13, 14.00s/it]     {'epoch': 6, 'num_users': 6.3, 'loss': 0.038, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9215, 'compress@10': 0.5128, 'time@10': 18.6912}: 100%|██████████| 10/10 [02:14<00:00, 15.68s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.038, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9215, 'compress@10': 0.5128, 'time@10': 18.6912}: 100%|██████████| 10/10 [02:14<00:00, 13.46s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.037977535586141656
Avg hit ratio: 0.9730146443937097
Avg ndcg: 0.9215401693434002
Avg compression ratio: 0.5128165933836335
Avg train time: 18.69124698638916
Std train time: 6.154061769105772
[0.5625, 0.9375, 0.1875, 0.4375, 0.9375, 0.8125, 0.06250000000000001, 0.3125, 0.6875, 0.06250000000000001]
[10, 10, 17, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0535, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9302, 'compress@10': 0.5743, 'time@10': 16.5958}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0535, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9302, 'compress@10': 0.5743, 'time@10': 16.5958}:  10%|█         | 1/10 [00:08<01:15,  8.34s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9256, 'compress@10': 0.7564, 'time@10': 15.0977}:  10%|█         | 1/10 [00:21<01:15,  8.34s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9256, 'compress@10': 0.7564, 'time@10': 15.0977}:  20%|██        | 2/10 [00:21<01:31, 11.46s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9266, 'compress@10': 0.5861, 'time@10': 13.238}:  20%|██        | 2/10 [00:26<01:31, 11.46s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9266, 'compress@10': 0.5861, 'time@10': 13.238}:  30%|███       | 3/10 [00:26<00:58,  8.42s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9251, 'compress@10': 0.5516, 'time@10': 13.017}:  30%|███       | 3/10 [00:39<00:58,  8.42s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9251, 'compress@10': 0.5516, 'time@10': 13.017}:  40%|████      | 4/10 [00:39<00:59,  9.99s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.036, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9132, 'compress@10': 0.6289, 'time@10': 16.4877}:  40%|████      | 4/10 [00:54<00:59,  9.99s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.036, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9132, 'compress@10': 0.6289, 'time@10': 16.4877}:  50%|█████     | 5/10 [00:54<00:59, 11.87s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0356, 'hit_ratio@10': 0.9707, 'ndcg@10': 0.9162, 'compress@10': 0.6598, 'time@10': 17.132}:  50%|█████     | 5/10 [01:14<00:59, 11.87s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0356, 'hit_ratio@10': 0.9707, 'ndcg@10': 0.9162, 'compress@10': 0.6598, 'time@10': 17.132}:  60%|██████    | 6/10 [01:14<00:59, 14.77s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0351, 'hit_ratio@10': 0.9689, 'ndcg@10': 0.9161, 'compress@10': 0.5773, 'time@10': 17.578}:  60%|██████    | 6/10 [01:24<00:59, 14.77s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0351, 'hit_ratio@10': 0.9689, 'ndcg@10': 0.9161, 'compress@10': 0.5773, 'time@10': 17.578}:  70%|███████   | 7/10 [01:24<00:39, 13.26s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.036, 'hit_ratio@10': 0.971, 'ndcg@10': 0.9217, 'compress@10': 0.5454, 'time@10': 17.3393}:  70%|███████   | 7/10 [01:40<00:39, 13.26s/it]  {'epoch': 7, 'num_users': 6.125, 'loss': 0.036, 'hit_ratio@10': 0.971, 'ndcg@10': 0.9217, 'compress@10': 0.5454, 'time@10': 17.3393}:  80%|████████  | 8/10 [01:40<00:28, 14.04s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0368, 'hit_ratio@10': 0.9725, 'ndcg@10': 0.9226, 'compress@10': 0.5617, 'time@10': 18.466}:  80%|████████  | 8/10 [01:54<00:28, 14.04s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0368, 'hit_ratio@10': 0.9725, 'ndcg@10': 0.9226, 'compress@10': 0.5617, 'time@10': 18.466}:  90%|█████████ | 9/10 [01:54<00:13, 13.96s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0356, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9248, 'compress@10': 0.5129, 'time@10': 18.5658}:  90%|█████████ | 9/10 [02:13<00:13, 13.96s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0356, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9248, 'compress@10': 0.5129, 'time@10': 18.5658}: 100%|██████████| 10/10 [02:13<00:00, 15.67s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0356, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9248, 'compress@10': 0.5129, 'time@10': 18.5658}: 100%|██████████| 10/10 [02:13<00:00, 13.39s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.03557937226071072
Avg hit ratio: 0.9730146443937097
Avg ndcg: 0.9248466057801101
Avg compression ratio: 0.5128823374793929
Avg train time: 18.565780901908873
Std train time: 6.189152182217421
[0.6111111111111112, 0.9444444444444444, 0.16666666666666666, 0.3888888888888889, 0.9444444444444444, 0.7222222222222222, 0.055555555555555566, 0.3888888888888889, 0.7222222222222222, 0.055555555555555566]
[10, 10, 18, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.973, 'ndcg@10': 0.8931, 'compress@10': 0.6216, 'time@10': 16.6317}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.973, 'ndcg@10': 0.8931, 'compress@10': 0.6216, 'time@10': 16.6317}:  10%|█         | 1/10 [00:08<01:15,  8.35s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0393, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9125, 'compress@10': 0.7835, 'time@10': 15.0247}:  10%|█         | 1/10 [00:21<01:15,  8.35s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0393, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9125, 'compress@10': 0.7835, 'time@10': 15.0247}:  20%|██        | 2/10 [00:21<01:30, 11.35s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9178, 'compress@10': 0.5977, 'time@10': 13.4653}:  20%|██        | 2/10 [00:27<01:30, 11.35s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9178, 'compress@10': 0.5977, 'time@10': 13.4653}:  30%|███       | 3/10 [00:27<00:59,  8.55s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9232, 'compress@10': 0.5483, 'time@10': 13.176}:  30%|███       | 3/10 [00:39<00:59,  8.55s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9232, 'compress@10': 0.5483, 'time@10': 13.176}:  40%|████      | 4/10 [00:39<01:00, 10.05s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0322, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9182, 'compress@10': 0.6277, 'time@10': 16.7751}:  40%|████      | 4/10 [00:54<01:00, 10.05s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0322, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9182, 'compress@10': 0.6277, 'time@10': 16.7751}:  50%|█████     | 5/10 [00:54<01:00, 12.06s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.9707, 'ndcg@10': 0.9229, 'compress@10': 0.6439, 'time@10': 17.3713}:  50%|█████     | 5/10 [01:15<01:00, 12.06s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.9707, 'ndcg@10': 0.9229, 'compress@10': 0.6439, 'time@10': 17.3713}:  60%|██████    | 6/10 [01:15<00:59, 14.89s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.032, 'hit_ratio@10': 0.9719, 'ndcg@10': 0.9229, 'compress@10': 0.5627, 'time@10': 17.7114}:  60%|██████    | 6/10 [01:25<00:59, 14.89s/it] {'epoch': 8, 'num_users': 6.2857, 'loss': 0.032, 'hit_ratio@10': 0.9719, 'ndcg@10': 0.9229, 'compress@10': 0.5627, 'time@10': 17.7114}:  70%|███████   | 7/10 [01:25<00:39, 13.26s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0334, 'hit_ratio@10': 0.9736, 'ndcg@10': 0.9267, 'compress@10': 0.5421, 'time@10': 17.4665}:  70%|███████   | 7/10 [01:41<00:39, 13.26s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0334, 'hit_ratio@10': 0.9736, 'ndcg@10': 0.9267, 'compress@10': 0.5421, 'time@10': 17.4665}:  80%|████████  | 8/10 [01:41<00:28, 14.07s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0338, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9304, 'compress@10': 0.5626, 'time@10': 18.5846}:  80%|████████  | 8/10 [01:54<00:28, 14.07s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0338, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9304, 'compress@10': 0.5626, 'time@10': 18.5846}:  90%|█████████ | 9/10 [01:54<00:13, 13.99s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9331, 'compress@10': 0.5129, 'time@10': 18.6044}:  90%|█████████ | 9/10 [02:13<00:13, 13.99s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9331, 'compress@10': 0.5129, 'time@10': 18.6044}: 100%|██████████| 10/10 [02:13<00:00, 15.48s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9331, 'compress@10': 0.5129, 'time@10': 18.6044}: 100%|██████████| 10/10 [02:13<00:00, 13.37s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.03239093975834637
Avg hit ratio: 0.9762343413634065
Avg ndcg: 0.9331227154491997
Avg compression ratio: 0.5129340220444235
Avg train time: 18.60442521572113
Std train time: 6.235111339393312
[0.65, 0.85, 0.15, 0.45, 0.95, 0.65, 0.05000000000000001, 0.45, 0.75, 0.05000000000000001]
[10, 10, 19, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0494, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9451, 'compress@10': 0.6595, 'time@10': 16.5253}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0494, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9451, 'compress@10': 0.6595, 'time@10': 16.5253}:  10%|█         | 1/10 [00:08<01:14,  8.30s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9524, 'compress@10': 0.7559, 'time@10': 15.0921}:  10%|█         | 1/10 [00:21<01:14,  8.30s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9524, 'compress@10': 0.7559, 'time@10': 15.0921}:  20%|██        | 2/10 [00:21<01:31, 11.47s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9445, 'compress@10': 0.5742, 'time@10': 13.5342}:  20%|██        | 2/10 [00:27<01:31, 11.47s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9445, 'compress@10': 0.5742, 'time@10': 13.5342}:  30%|███       | 3/10 [00:27<01:00,  8.63s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9411, 'compress@10': 0.5457, 'time@10': 13.1571}:  30%|███       | 3/10 [00:39<01:00,  8.63s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9411, 'compress@10': 0.5457, 'time@10': 13.1571}:  40%|████      | 4/10 [00:39<00:59,  9.99s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0301, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9365, 'compress@10': 0.6267, 'time@10': 16.6299}:  40%|████      | 4/10 [00:54<00:59,  9.99s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0301, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9365, 'compress@10': 0.6267, 'time@10': 16.6299}:  50%|█████     | 5/10 [00:54<00:59, 11.90s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0301, 'hit_ratio@10': 0.9707, 'ndcg@10': 0.9421, 'compress@10': 0.6312, 'time@10': 17.2685}:  50%|█████     | 5/10 [01:15<00:59, 11.90s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0301, 'hit_ratio@10': 0.9707, 'ndcg@10': 0.9421, 'compress@10': 0.6312, 'time@10': 17.2685}:  60%|██████    | 6/10 [01:15<00:59, 14.82s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.9689, 'ndcg@10': 0.9403, 'compress@10': 0.551, 'time@10': 17.6588}:  60%|██████    | 6/10 [01:25<00:59, 14.82s/it] {'epoch': 9, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.9689, 'ndcg@10': 0.9403, 'compress@10': 0.551, 'time@10': 17.6588}:  70%|███████   | 7/10 [01:25<00:39, 13.26s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0307, 'hit_ratio@10': 0.971, 'ndcg@10': 0.9407, 'compress@10': 0.5394, 'time@10': 17.4115}:  70%|███████   | 7/10 [01:40<00:39, 13.26s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0307, 'hit_ratio@10': 0.971, 'ndcg@10': 0.9407, 'compress@10': 0.5394, 'time@10': 17.4115}:  80%|████████  | 8/10 [01:40<00:28, 14.04s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0308, 'hit_ratio@10': 0.9709, 'ndcg@10': 0.941, 'compress@10': 0.5632, 'time@10': 18.5363}:  80%|████████  | 8/10 [01:54<00:28, 14.04s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0308, 'hit_ratio@10': 0.9709, 'ndcg@10': 0.941, 'compress@10': 0.5632, 'time@10': 18.5363}:  90%|█████████ | 9/10 [01:54<00:13, 13.97s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.03, 'hit_ratio@10': 0.9727, 'ndcg@10': 0.9424, 'compress@10': 0.513, 'time@10': 18.4947}:  90%|█████████ | 9/10 [02:12<00:13, 13.97s/it]     {'epoch': 9, 'num_users': 6.3, 'loss': 0.03, 'hit_ratio@10': 0.9727, 'ndcg@10': 0.9424, 'compress@10': 0.513, 'time@10': 18.4947}: 100%|██████████| 10/10 [02:12<00:00, 15.26s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.03, 'hit_ratio@10': 0.9727, 'ndcg@10': 0.9424, 'compress@10': 0.513, 'time@10': 18.4947}: 100%|██████████| 10/10 [02:12<00:00, 13.28s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03003462278427162
Avg hit ratio: 0.9726584707166405
Avg ndcg: 0.9424350660961667
Avg compression ratio: 0.5129520393068177
Avg train time: 18.494725584983826
Std train time: 6.122828132467618
[0.6818181818181819, 0.7727272727272727, 0.13636363636363635, 0.5, 0.9545454545454545, 0.5909090909090909, 0.04545454545454546, 0.5, 0.7727272727272727, 0.04545454545454546]
[10, 10, 19, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9146, 'compress@10': 0.6904, 'time@10': 16.3529}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9146, 'compress@10': 0.6904, 'time@10': 16.3529}:  10%|█         | 1/10 [00:08<01:13,  8.21s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0443, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9631, 'compress@10': 0.7334, 'time@10': 15.0354}:  10%|█         | 1/10 [00:21<01:13,  8.21s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0443, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9631, 'compress@10': 0.7334, 'time@10': 15.0354}:  20%|██        | 2/10 [00:21<01:31, 11.47s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9516, 'compress@10': 0.555, 'time@10': 13.4467}:  20%|██        | 2/10 [00:27<01:31, 11.47s/it]   {'epoch': 10, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9516, 'compress@10': 0.555, 'time@10': 13.4467}:  30%|███       | 3/10 [00:27<01:00,  8.60s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9457, 'compress@10': 0.5435, 'time@10': 13.1415}:  30%|███       | 3/10 [00:39<01:00,  8.60s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9457, 'compress@10': 0.5435, 'time@10': 13.1415}:  40%|████      | 4/10 [00:39<01:00, 10.04s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0319, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.941, 'compress@10': 0.6258, 'time@10': 16.6414}:  40%|████      | 4/10 [00:54<01:00, 10.04s/it] {'epoch': 10, 'num_users': 5.8, 'loss': 0.0319, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.941, 'compress@10': 0.6258, 'time@10': 16.6414}:  50%|█████     | 5/10 [00:54<00:59, 11.96s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0322, 'hit_ratio@10': 0.9707, 'ndcg@10': 0.9483, 'compress@10': 0.6208, 'time@10': 17.2896}:  50%|█████     | 5/10 [01:15<00:59, 11.96s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0322, 'hit_ratio@10': 0.9707, 'ndcg@10': 0.9483, 'compress@10': 0.6208, 'time@10': 17.2896}:  60%|██████    | 6/10 [01:15<00:59, 14.89s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0316, 'hit_ratio@10': 0.9719, 'ndcg@10': 0.9439, 'compress@10': 0.5414, 'time@10': 17.6756}:  60%|██████    | 6/10 [01:25<00:59, 14.89s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0316, 'hit_ratio@10': 0.9719, 'ndcg@10': 0.9439, 'compress@10': 0.5414, 'time@10': 17.6756}:  70%|███████   | 7/10 [01:25<00:39, 13.30s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0324, 'hit_ratio@10': 0.9736, 'ndcg@10': 0.942, 'compress@10': 0.5372, 'time@10': 17.4608}:  70%|███████   | 7/10 [01:41<00:39, 13.30s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.0324, 'hit_ratio@10': 0.9736, 'ndcg@10': 0.942, 'compress@10': 0.5372, 'time@10': 17.4608}:  80%|████████  | 8/10 [01:41<00:28, 14.16s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0325, 'hit_ratio@10': 0.9732, 'ndcg@10': 0.946, 'compress@10': 0.5637, 'time@10': 18.5965}:  80%|████████  | 8/10 [01:55<00:28, 14.16s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0325, 'hit_ratio@10': 0.9732, 'ndcg@10': 0.946, 'compress@10': 0.5637, 'time@10': 18.5965}:  90%|█████████ | 9/10 [01:55<00:14, 14.07s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0319, 'hit_ratio@10': 0.9747, 'ndcg@10': 0.945, 'compress@10': 0.513, 'time@10': 18.6036}:  90%|█████████ | 9/10 [02:13<00:14, 14.07s/it]    {'epoch': 10, 'num_users': 6.3, 'loss': 0.0319, 'hit_ratio@10': 0.9747, 'ndcg@10': 0.945, 'compress@10': 0.513, 'time@10': 18.6036}: 100%|██████████| 10/10 [02:13<00:00, 15.50s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0319, 'hit_ratio@10': 0.9747, 'ndcg@10': 0.945, 'compress@10': 0.513, 'time@10': 18.6036}: 100%|██████████| 10/10 [02:13<00:00, 13.39s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03190627274620469
Avg hit ratio: 0.9747418040499737
Avg ndcg: 0.945027963764524
Avg compression ratio: 0.5129661077088354
Avg train time: 18.60362617969513
Std train time: 6.15653437440396
[0.7083333333333334, 0.7916666666666666, 0.12499999999999999, 0.5416666666666666, 0.8749999999999999, 0.625, 0.04166666666666667, 0.5416666666666666, 0.7083333333333333, 0.04166666666666667]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0389, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9428, 'compress@10': 0.7162, 'time@10': 16.349}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0389, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9428, 'compress@10': 0.7162, 'time@10': 16.349}:  10%|█         | 1/10 [00:08<01:13,  8.21s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.04, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9493, 'compress@10': 0.7556, 'time@10': 14.9486}:  10%|█         | 1/10 [00:21<01:13,  8.21s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.04, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9493, 'compress@10': 0.7556, 'time@10': 14.9486}:  20%|██        | 2/10 [00:21<01:30, 11.37s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9424, 'compress@10': 0.5663, 'time@10': 13.5973}:  20%|██        | 2/10 [00:27<01:30, 11.37s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9424, 'compress@10': 0.5663, 'time@10': 13.5973}:  30%|███       | 3/10 [00:27<01:00,  8.68s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.937, 'compress@10': 0.5622, 'time@10': 13.2889}:  30%|███       | 3/10 [00:39<01:00,  8.68s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.937, 'compress@10': 0.5622, 'time@10': 13.2889}:  40%|████      | 4/10 [00:39<01:00, 10.15s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0301, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9378, 'compress@10': 0.625, 'time@10': 16.8468}:  40%|████      | 4/10 [00:55<01:00, 10.15s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0301, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9378, 'compress@10': 0.625, 'time@10': 16.8468}:  50%|█████     | 5/10 [00:55<01:00, 12.11s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0315, 'hit_ratio@10': 0.9723, 'ndcg@10': 0.9436, 'compress@10': 0.6257, 'time@10': 17.4658}:  50%|█████     | 5/10 [01:15<01:00, 12.11s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0315, 'hit_ratio@10': 0.9723, 'ndcg@10': 0.9436, 'compress@10': 0.6257, 'time@10': 17.4658}:  60%|██████    | 6/10 [01:15<00:59, 14.99s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0299, 'hit_ratio@10': 0.9733, 'ndcg@10': 0.9436, 'compress@10': 0.5451, 'time@10': 17.8071}:  60%|██████    | 6/10 [01:25<00:59, 14.99s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0299, 'hit_ratio@10': 0.9733, 'ndcg@10': 0.9436, 'compress@10': 0.5451, 'time@10': 17.8071}:  70%|███████   | 7/10 [01:25<00:40, 13.35s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0312, 'hit_ratio@10': 0.9748, 'ndcg@10': 0.9448, 'compress@10': 0.5455, 'time@10': 17.5418}:  70%|███████   | 7/10 [01:41<00:40, 13.35s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0312, 'hit_ratio@10': 0.9748, 'ndcg@10': 0.9448, 'compress@10': 0.5455, 'time@10': 17.5418}:  80%|████████  | 8/10 [01:41<00:28, 14.10s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.031, 'hit_ratio@10': 0.9743, 'ndcg@10': 0.9459, 'compress@10': 0.5641, 'time@10': 18.6397}:  80%|████████  | 8/10 [01:55<00:28, 14.10s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.031, 'hit_ratio@10': 0.9743, 'ndcg@10': 0.9459, 'compress@10': 0.5641, 'time@10': 18.6397}:  90%|█████████ | 9/10 [01:55<00:13, 13.99s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0299, 'hit_ratio@10': 0.9758, 'ndcg@10': 0.9485, 'compress@10': 0.513, 'time@10': 18.6239}:  90%|█████████ | 9/10 [02:13<00:13, 13.99s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0299, 'hit_ratio@10': 0.9758, 'ndcg@10': 0.9485, 'compress@10': 0.513, 'time@10': 18.6239}: 100%|██████████| 10/10 [02:13<00:00, 15.39s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0299, 'hit_ratio@10': 0.9758, 'ndcg@10': 0.9485, 'compress@10': 0.513, 'time@10': 18.6239}: 100%|██████████| 10/10 [02:13<00:00, 13.38s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.029946335111405327
Avg hit ratio: 0.9757519050600747
Avg ndcg: 0.9484889810935198
Avg compression ratio: 0.512956721327603
Avg train time: 18.623925805091858
Std train time: 6.134675169402879
[0.7307692307692308, 0.8076923076923077, 0.11538461538461538, 0.49999999999999994, 0.8846153846153845, 0.6538461538461539, 0.038461538461538464, 0.5769230769230769, 0.6538461538461537, 0.038461538461538464]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9106, 'compress@10': 0.738, 'time@10': 16.5614}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9106, 'compress@10': 0.738, 'time@10': 16.5614}:  10%|█         | 1/10 [00:08<01:14,  8.32s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0299, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9343, 'compress@10': 0.7744, 'time@10': 15.0697}:  10%|█         | 1/10 [00:21<01:14,  8.32s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0299, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9343, 'compress@10': 0.7744, 'time@10': 15.0697}:  20%|██        | 2/10 [00:21<01:31, 11.43s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9324, 'compress@10': 0.5758, 'time@10': 13.6625}:  20%|██        | 2/10 [00:27<01:31, 11.43s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9324, 'compress@10': 0.5758, 'time@10': 13.6625}:  30%|███       | 3/10 [00:27<01:00,  8.71s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9337, 'compress@10': 0.5592, 'time@10': 13.2967}:  30%|███       | 3/10 [00:39<01:00,  8.71s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9337, 'compress@10': 0.5592, 'time@10': 13.2967}:  40%|████      | 4/10 [00:39<01:00, 10.10s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9343, 'compress@10': 0.6245, 'time@10': 16.7524}:  40%|████      | 4/10 [00:54<01:00, 10.10s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9343, 'compress@10': 0.6245, 'time@10': 16.7524}:  50%|█████     | 5/10 [00:54<00:59, 11.98s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.024, 'hit_ratio@10': 0.9723, 'ndcg@10': 0.9426, 'compress@10': 0.63, 'time@10': 17.411}:  50%|█████     | 5/10 [01:15<00:59, 11.98s/it] {'epoch': 12, 'num_users': 6.1667, 'loss': 0.024, 'hit_ratio@10': 0.9723, 'ndcg@10': 0.9426, 'compress@10': 0.63, 'time@10': 17.411}:  60%|██████    | 6/10 [01:15<00:59, 14.96s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.025, 'hit_ratio@10': 0.9733, 'ndcg@10': 0.9419, 'compress@10': 0.5484, 'time@10': 17.7951}:  60%|██████    | 6/10 [01:25<00:59, 14.96s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.025, 'hit_ratio@10': 0.9733, 'ndcg@10': 0.9419, 'compress@10': 0.5484, 'time@10': 17.7951}:  70%|███████   | 7/10 [01:25<00:40, 13.37s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0262, 'hit_ratio@10': 0.9748, 'ndcg@10': 0.9368, 'compress@10': 0.5527, 'time@10': 17.5518}:  70%|███████   | 7/10 [01:41<00:40, 13.37s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0262, 'hit_ratio@10': 0.9748, 'ndcg@10': 0.9368, 'compress@10': 0.5527, 'time@10': 17.5518}:  80%|████████  | 8/10 [01:41<00:28, 14.18s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0269, 'hit_ratio@10': 0.9743, 'ndcg@10': 0.9432, 'compress@10': 0.5645, 'time@10': 18.6346}:  80%|████████  | 8/10 [01:55<00:28, 14.18s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0269, 'hit_ratio@10': 0.9743, 'ndcg@10': 0.9432, 'compress@10': 0.5645, 'time@10': 18.6346}:  90%|█████████ | 9/10 [01:55<00:14, 14.02s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.9758, 'ndcg@10': 0.9417, 'compress@10': 0.513, 'time@10': 18.6103}:  90%|█████████ | 9/10 [02:13<00:14, 14.02s/it]    {'epoch': 12, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.9758, 'ndcg@10': 0.9417, 'compress@10': 0.513, 'time@10': 18.6103}: 100%|██████████| 10/10 [02:13<00:00, 15.39s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.9758, 'ndcg@10': 0.9417, 'compress@10': 0.513, 'time@10': 18.6103}: 100%|██████████| 10/10 [02:13<00:00, 13.38s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.02858085078717243
Avg hit ratio: 0.9757519050600747
Avg ndcg: 0.9416593060841908
Avg compression ratio: 0.5130164046156303
Avg train time: 18.610340809822084
Std train time: 6.0313778978871015
[0.7500000000000001, 0.75, 0.10714285714285714, 0.5357142857142857, 0.8214285714285713, 0.6071428571428572, 0.03571428571428572, 0.6071428571428571, 0.6785714285714285, 0.10714285714285715]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.973, 'ndcg@10': 0.981, 'compress@10': 0.7568, 'time@10': 16.4567}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.973, 'ndcg@10': 0.981, 'compress@10': 0.7568, 'time@10': 16.4567}:  10%|█         | 1/10 [00:08<01:14,  8.27s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9878, 'compress@10': 0.7554, 'time@10': 15.0018}:  10%|█         | 1/10 [00:21<01:14,  8.27s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9878, 'compress@10': 0.7554, 'time@10': 15.0018}:  20%|██        | 2/10 [00:21<01:31, 11.39s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.968, 'compress@10': 0.5606, 'time@10': 13.7669}:  20%|██        | 2/10 [00:27<01:31, 11.39s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.968, 'compress@10': 0.5606, 'time@10': 13.7669}:  30%|███       | 3/10 [00:27<01:01,  8.80s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9587, 'compress@10': 0.5565, 'time@10': 13.332}:  30%|███       | 3/10 [00:39<01:01,  8.80s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9587, 'compress@10': 0.5565, 'time@10': 13.332}:  40%|████      | 4/10 [00:39<01:00, 10.09s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0284, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9546, 'compress@10': 0.6099, 'time@10': 16.9339}:  40%|████      | 4/10 [00:55<01:00, 10.09s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0284, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9546, 'compress@10': 0.6099, 'time@10': 16.9339}:  50%|█████     | 5/10 [00:55<01:00, 12.11s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0276, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9611, 'compress@10': 0.6101, 'time@10': 17.4905}:  50%|█████     | 5/10 [01:15<01:00, 12.11s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0276, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9611, 'compress@10': 0.6101, 'time@10': 17.4905}:  60%|██████    | 6/10 [01:15<00:59, 14.90s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0264, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9589, 'compress@10': 0.531, 'time@10': 17.8376}:  60%|██████    | 6/10 [01:25<00:59, 14.90s/it] {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0264, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9589, 'compress@10': 0.531, 'time@10': 17.8376}:  70%|███████   | 7/10 [01:25<00:39, 13.30s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9551, 'compress@10': 0.5412, 'time@10': 17.5323}:  70%|███████   | 7/10 [01:41<00:39, 13.30s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9551, 'compress@10': 0.5412, 'time@10': 17.5323}:  80%|████████  | 8/10 [01:41<00:27, 13.98s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0287, 'hit_ratio@10': 0.9756, 'ndcg@10': 0.9586, 'compress@10': 0.557, 'time@10': 18.5401}:  80%|████████  | 8/10 [01:54<00:27, 13.98s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0287, 'hit_ratio@10': 0.9756, 'ndcg@10': 0.9586, 'compress@10': 0.557, 'time@10': 18.5401}:  90%|█████████ | 9/10 [01:54<00:13, 13.78s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.9769, 'ndcg@10': 0.9604, 'compress@10': 0.513, 'time@10': 18.5158}:  90%|█████████ | 9/10 [02:12<00:13, 13.78s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.9769, 'ndcg@10': 0.9604, 'compress@10': 0.513, 'time@10': 18.5158}: 100%|██████████| 10/10 [02:12<00:00, 15.18s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.9769, 'ndcg@10': 0.9604, 'compress@10': 0.513, 'time@10': 18.5158}: 100%|██████████| 10/10 [02:12<00:00, 13.27s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.0292583784984925
Avg hit ratio: 0.9768755005656926
Avg ndcg: 0.9604375965581173
Avg compression ratio: 0.5130160204670171
Avg train time: 18.515751934051515
Std train time: 6.065331325649348
[0.7666666666666667, 0.7666666666666667, 0.09999999999999999, 0.5, 0.7666666666666665, 0.5666666666666668, 0.03333333333333334, 0.6333333333333333, 0.7, 0.16666666666666669]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9337, 'compress@10': 0.773, 'time@10': 15.8678}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9337, 'compress@10': 0.773, 'time@10': 15.8678}:  10%|█         | 1/10 [00:07<01:11,  7.97s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9626, 'compress@10': 0.7717, 'time@10': 14.6482}:  10%|█         | 1/10 [00:21<01:11,  7.97s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9626, 'compress@10': 0.7717, 'time@10': 14.6482}:  20%|██        | 2/10 [00:21<01:29, 11.20s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9512, 'compress@10': 0.5692, 'time@10': 13.4187}:  20%|██        | 2/10 [00:26<01:29, 11.20s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9512, 'compress@10': 0.5692, 'time@10': 13.4187}:  30%|███       | 3/10 [00:26<01:00,  8.61s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9517, 'compress@10': 0.5542, 'time@10': 13.0965}:  30%|███       | 3/10 [00:39<01:00,  8.61s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9517, 'compress@10': 0.5542, 'time@10': 13.0965}:  40%|████      | 4/10 [00:39<01:00, 10.02s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0247, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9496, 'compress@10': 0.5972, 'time@10': 15.7728}:  40%|████      | 4/10 [00:52<01:00, 10.02s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0247, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9496, 'compress@10': 0.5972, 'time@10': 15.7728}:  50%|█████     | 5/10 [00:52<00:55, 11.19s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0267, 'hit_ratio@10': 0.9725, 'ndcg@10': 0.9542, 'compress@10': 0.5929, 'time@10': 16.4807}:  50%|█████     | 5/10 [01:12<00:55, 11.19s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0267, 'hit_ratio@10': 0.9725, 'ndcg@10': 0.9542, 'compress@10': 0.5929, 'time@10': 16.4807}:  60%|██████    | 6/10 [01:12<00:56, 14.21s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0263, 'hit_ratio@10': 0.9735, 'ndcg@10': 0.9522, 'compress@10': 0.5159, 'time@10': 16.9719}:  60%|██████    | 6/10 [01:22<00:56, 14.21s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0263, 'hit_ratio@10': 0.9735, 'ndcg@10': 0.9522, 'compress@10': 0.5159, 'time@10': 16.9719}:  70%|███████   | 7/10 [01:22<00:38, 12.83s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0273, 'hit_ratio@10': 0.975, 'ndcg@10': 0.9457, 'compress@10': 0.5312, 'time@10': 16.7516}:  70%|███████   | 7/10 [01:37<00:38, 12.83s/it]  {'epoch': 14, 'num_users': 6.125, 'loss': 0.0273, 'hit_ratio@10': 0.975, 'ndcg@10': 0.9457, 'compress@10': 0.5312, 'time@10': 16.7516}:  80%|████████  | 8/10 [01:37<00:27, 13.60s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.9761, 'ndcg@10': 0.9533, 'compress@10': 0.5505, 'time@10': 17.8631}:  80%|████████  | 8/10 [01:51<00:27, 13.60s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.9761, 'ndcg@10': 0.9533, 'compress@10': 0.5505, 'time@10': 17.8631}:  90%|█████████ | 9/10 [01:51<00:13, 13.54s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.9774, 'ndcg@10': 0.9588, 'compress@10': 0.513, 'time@10': 17.9547}:  90%|█████████ | 9/10 [02:09<00:13, 13.54s/it]    {'epoch': 14, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.9774, 'ndcg@10': 0.9588, 'compress@10': 0.513, 'time@10': 17.9547}: 100%|██████████| 10/10 [02:09<00:00, 15.17s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.9774, 'ndcg@10': 0.9588, 'compress@10': 0.513, 'time@10': 17.9547}: 100%|██████████| 10/10 [02:09<00:00, 12.99s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.028326118070501848
Avg hit ratio: 0.9773579368690246
Avg ndcg: 0.9588439517282369
Avg compression ratio: 0.5130269033728977
Avg train time: 17.95472733974457
Std train time: 5.235933031074175
[0.78125, 0.78125, 0.09374999999999999, 0.46875, 0.7187499999999999, 0.5937500000000001, 0.03125000000000001, 0.65625, 0.65625, 0.21875]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9538, 'compress@10': 0.7872, 'time@10': 15.7901}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9538, 'compress@10': 0.7872, 'time@10': 15.7901}:  10%|█         | 1/10 [00:07<01:11,  7.93s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9601, 'compress@10': 0.786, 'time@10': 14.5823}:  10%|█         | 1/10 [00:21<01:11,  7.93s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9601, 'compress@10': 0.786, 'time@10': 14.5823}:  20%|██        | 2/10 [00:21<01:29, 11.16s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9496, 'compress@10': 0.5768, 'time@10': 13.2569}:  20%|██        | 2/10 [00:26<01:29, 11.16s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9496, 'compress@10': 0.5768, 'time@10': 13.2569}:  30%|███       | 3/10 [00:26<00:59,  8.50s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9528, 'compress@10': 0.5523, 'time@10': 12.9291}:  30%|███       | 3/10 [00:38<00:59,  8.50s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9528, 'compress@10': 0.5523, 'time@10': 12.9291}:  40%|████      | 4/10 [00:38<00:59,  9.89s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9512, 'compress@10': 0.5861, 'time@10': 15.7385}:  40%|████      | 4/10 [00:52<00:59,  9.89s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9512, 'compress@10': 0.5861, 'time@10': 15.7385}:  50%|█████     | 5/10 [00:52<00:55, 11.20s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0218, 'hit_ratio@10': 0.9725, 'ndcg@10': 0.9556, 'compress@10': 0.5882, 'time@10': 16.4929}:  50%|█████     | 5/10 [01:12<00:55, 11.20s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0218, 'hit_ratio@10': 0.9725, 'ndcg@10': 0.9556, 'compress@10': 0.5882, 'time@10': 16.4929}:  60%|██████    | 6/10 [01:12<00:57, 14.30s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.9735, 'ndcg@10': 0.956, 'compress@10': 0.5115, 'time@10': 17.0536}:  60%|██████    | 6/10 [01:22<00:57, 14.30s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.9735, 'ndcg@10': 0.956, 'compress@10': 0.5115, 'time@10': 17.0536}:  70%|███████   | 7/10 [01:22<00:38, 12.97s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0232, 'hit_ratio@10': 0.975, 'ndcg@10': 0.9565, 'compress@10': 0.5302, 'time@10': 16.8079}:  70%|███████   | 7/10 [01:37<00:38, 12.97s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0232, 'hit_ratio@10': 0.975, 'ndcg@10': 0.9565, 'compress@10': 0.5302, 'time@10': 16.8079}:  80%|████████  | 8/10 [01:37<00:27, 13.66s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.9761, 'ndcg@10': 0.9594, 'compress@10': 0.5448, 'time@10': 17.974}:  80%|████████  | 8/10 [01:51<00:27, 13.66s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.9761, 'ndcg@10': 0.9594, 'compress@10': 0.5448, 'time@10': 17.974}:  90%|█████████ | 9/10 [01:51<00:13, 13.67s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.9774, 'ndcg@10': 0.9631, 'compress@10': 0.5131, 'time@10': 18.0426}:  90%|█████████ | 9/10 [02:10<00:13, 13.67s/it]  {'epoch': 15, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.9774, 'ndcg@10': 0.9631, 'compress@10': 0.5131, 'time@10': 18.0426}: 100%|██████████| 10/10 [02:10<00:00, 15.22s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.9774, 'ndcg@10': 0.9631, 'compress@10': 0.5131, 'time@10': 18.0426}: 100%|██████████| 10/10 [02:10<00:00, 13.03s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.026408594903422435
Avg hit ratio: 0.9773579368690246
Avg ndcg: 0.9631182696236948
Avg compression ratio: 0.5130611902642083
Avg train time: 18.042615175247192
Std train time: 5.518902663722718
[0.7941176470588235, 0.7352941176470589, 0.08823529411764705, 0.4411764705882353, 0.676470588235294, 0.6176470588235295, 0.02941176470588236, 0.6764705882352942, 0.6764705882352942, 0.2647058823529412]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0339, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9469, 'compress@10': 0.7997, 'time@10': 16.7735}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0339, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9469, 'compress@10': 0.7997, 'time@10': 16.7735}:  10%|█         | 1/10 [00:08<01:15,  8.42s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9779, 'compress@10': 0.7696, 'time@10': 15.0343}:  10%|█         | 1/10 [00:21<01:15,  8.42s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9779, 'compress@10': 0.7696, 'time@10': 15.0343}:  20%|██        | 2/10 [00:21<01:30, 11.31s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9615, 'compress@10': 0.5642, 'time@10': 13.6127}:  20%|██        | 2/10 [00:27<01:30, 11.31s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9615, 'compress@10': 0.5642, 'time@10': 13.6127}:  30%|███       | 3/10 [00:27<01:00,  8.62s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9602, 'compress@10': 0.536, 'time@10': 13.1724}:  30%|███       | 3/10 [00:39<01:00,  8.62s/it]  {'epoch': 16, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9602, 'compress@10': 0.536, 'time@10': 13.1724}:  40%|████      | 4/10 [00:39<00:59,  9.91s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9558, 'compress@10': 0.5648, 'time@10': 15.8439}:  40%|████      | 4/10 [00:52<00:59,  9.91s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9558, 'compress@10': 0.5648, 'time@10': 15.8439}:  50%|█████     | 5/10 [00:52<00:55, 11.13s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0234, 'hit_ratio@10': 0.9725, 'ndcg@10': 0.9609, 'compress@10': 0.5743, 'time@10': 16.4811}:  50%|█████     | 5/10 [01:12<00:55, 11.13s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0234, 'hit_ratio@10': 0.9725, 'ndcg@10': 0.9609, 'compress@10': 0.5743, 'time@10': 16.4811}:  60%|██████    | 6/10 [01:12<00:56, 14.05s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0232, 'hit_ratio@10': 0.9735, 'ndcg@10': 0.9604, 'compress@10': 0.4994, 'time@10': 16.9262}:  60%|██████    | 6/10 [01:21<00:56, 14.05s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0232, 'hit_ratio@10': 0.9735, 'ndcg@10': 0.9604, 'compress@10': 0.4994, 'time@10': 16.9262}:  70%|███████   | 7/10 [01:21<00:38, 12.67s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0243, 'hit_ratio@10': 0.975, 'ndcg@10': 0.9605, 'compress@10': 0.5221, 'time@10': 16.7409}:  70%|███████   | 7/10 [01:37<00:38, 12.67s/it]  {'epoch': 16, 'num_users': 6.125, 'loss': 0.0243, 'hit_ratio@10': 0.975, 'ndcg@10': 0.9605, 'compress@10': 0.5221, 'time@10': 16.7409}:  80%|████████  | 8/10 [01:37<00:27, 13.57s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.9761, 'ndcg@10': 0.9611, 'compress@10': 0.5398, 'time@10': 17.8978}:  80%|████████  | 8/10 [01:51<00:27, 13.57s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.9761, 'ndcg@10': 0.9611, 'compress@10': 0.5398, 'time@10': 17.8978}:  90%|█████████ | 9/10 [01:51<00:13, 13.58s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0249, 'hit_ratio@10': 0.9774, 'ndcg@10': 0.9666, 'compress@10': 0.5131, 'time@10': 18.0496}:  90%|█████████ | 9/10 [02:10<00:13, 13.58s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0249, 'hit_ratio@10': 0.9774, 'ndcg@10': 0.9666, 'compress@10': 0.5131, 'time@10': 18.0496}: 100%|██████████| 10/10 [02:10<00:00, 15.39s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0249, 'hit_ratio@10': 0.9774, 'ndcg@10': 0.9666, 'compress@10': 0.5131, 'time@10': 18.0496}: 100%|██████████| 10/10 [02:10<00:00, 13.05s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.02487640867083459
Avg hit ratio: 0.9773579368690246
Avg ndcg: 0.9665820572391353
Avg compression ratio: 0.5130991689430471
Avg train time: 18.049642157554626
Std train time: 5.3301775943837635
[0.8055555555555555, 0.75, 0.08333333333333333, 0.4722222222222222, 0.6388888888888888, 0.5833333333333335, 0.027777777777777783, 0.6944444444444445, 0.638888888888889, 0.3055555555555556]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9267, 'compress@10': 0.8108, 'time@10': 16.2742}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9267, 'compress@10': 0.8108, 'time@10': 16.2742}:  10%|█         | 1/10 [00:08<01:13,  8.18s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0217, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9441, 'compress@10': 0.7824, 'time@10': 14.8634}:  10%|█         | 1/10 [00:21<01:13,  8.18s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0217, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9441, 'compress@10': 0.7824, 'time@10': 14.8634}:  20%|██        | 2/10 [00:21<01:30, 11.30s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.939, 'compress@10': 0.5712, 'time@10': 13.4976}:  20%|██        | 2/10 [00:27<01:30, 11.30s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.939, 'compress@10': 0.5712, 'time@10': 13.4976}:  30%|███       | 3/10 [00:27<01:00,  8.62s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9456, 'compress@10': 0.5489, 'time@10': 13.073}:  30%|███       | 3/10 [00:38<01:00,  8.62s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9456, 'compress@10': 0.5489, 'time@10': 13.073}:  40%|████      | 4/10 [00:38<00:59,  9.89s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9466, 'compress@10': 0.5676, 'time@10': 15.6568}:  40%|████      | 4/10 [00:51<00:59,  9.89s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9466, 'compress@10': 0.5676, 'time@10': 15.6568}:  50%|█████     | 5/10 [00:51<00:55, 11.02s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0204, 'hit_ratio@10': 0.9725, 'ndcg@10': 0.9506, 'compress@10': 0.571, 'time@10': 16.3939}:  50%|█████     | 5/10 [01:12<00:55, 11.02s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0204, 'hit_ratio@10': 0.9725, 'ndcg@10': 0.9506, 'compress@10': 0.571, 'time@10': 16.3939}:  60%|██████    | 6/10 [01:12<00:56, 14.11s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0196, 'hit_ratio@10': 0.9735, 'ndcg@10': 0.9523, 'compress@10': 0.4963, 'time@10': 16.9094}:  60%|██████    | 6/10 [01:22<00:56, 14.11s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0196, 'hit_ratio@10': 0.9735, 'ndcg@10': 0.9523, 'compress@10': 0.4963, 'time@10': 16.9094}:  70%|███████   | 7/10 [01:22<00:38, 12.78s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.975, 'ndcg@10': 0.9551, 'compress@10': 0.5216, 'time@10': 16.7186}:  70%|███████   | 7/10 [01:37<00:38, 12.78s/it]  {'epoch': 17, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.975, 'ndcg@10': 0.9551, 'compress@10': 0.5216, 'time@10': 16.7186}:  80%|████████  | 8/10 [01:37<00:27, 13.63s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0229, 'hit_ratio@10': 0.9761, 'ndcg@10': 0.9562, 'compress@10': 0.5353, 'time@10': 17.847}:  80%|████████  | 8/10 [01:51<00:27, 13.63s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0229, 'hit_ratio@10': 0.9761, 'ndcg@10': 0.9562, 'compress@10': 0.5353, 'time@10': 17.847}:  90%|█████████ | 9/10 [01:51<00:13, 13.58s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.9774, 'ndcg@10': 0.9641, 'compress@10': 0.5131, 'time@10': 18.0148}:  90%|█████████ | 9/10 [02:10<00:13, 13.58s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.9774, 'ndcg@10': 0.9641, 'compress@10': 0.5131, 'time@10': 18.0148}: 100%|██████████| 10/10 [02:10<00:00, 15.43s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.9774, 'ndcg@10': 0.9641, 'compress@10': 0.5131, 'time@10': 18.0148}: 100%|██████████| 10/10 [02:10<00:00, 13.06s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.023248240427650963
Avg hit ratio: 0.9773579368690246
Avg ndcg: 0.9640552591903067
Avg compression ratio: 0.5130880379218642
Avg train time: 18.014838790893556
Std train time: 5.239853693344188
[0.763157894736842, 0.7631578947368421, 0.07894736842105263, 0.4473684210526316, 0.6052631578947368, 0.605263157894737, 0.026315789473684216, 0.7105263157894738, 0.6578947368421053, 0.34210526315789475]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9962, 'compress@10': 0.7696, 'time@10': 16.0258}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9962, 'compress@10': 0.7696, 'time@10': 16.0258}:  10%|█         | 1/10 [00:08<01:12,  8.06s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0368, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9979, 'compress@10': 0.7683, 'time@10': 14.727}:  10%|█         | 1/10 [00:21<01:12,  8.06s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0368, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9979, 'compress@10': 0.7683, 'time@10': 14.727}:  20%|██        | 2/10 [00:21<01:29, 11.24s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9748, 'compress@10': 0.5604, 'time@10': 13.5748}:  20%|██        | 2/10 [00:27<01:29, 11.24s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9748, 'compress@10': 0.5604, 'time@10': 13.5748}:  30%|███       | 3/10 [00:27<01:00,  8.70s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9734, 'compress@10': 0.5347, 'time@10': 13.2068}:  30%|███       | 3/10 [00:39<01:00,  8.70s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9734, 'compress@10': 0.5347, 'time@10': 13.2068}:  40%|████      | 4/10 [00:39<01:00, 10.06s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0217, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9705, 'compress@10': 0.5496, 'time@10': 15.8134}:  40%|████      | 4/10 [00:52<01:00, 10.06s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0217, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9705, 'compress@10': 0.5496, 'time@10': 15.8134}:  50%|█████     | 5/10 [00:52<00:55, 11.18s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0213, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.97, 'compress@10': 0.5596, 'time@10': 16.4804}:  50%|█████     | 5/10 [01:12<00:55, 11.18s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0213, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.97, 'compress@10': 0.5596, 'time@10': 16.4804}:  60%|██████    | 6/10 [01:12<00:56, 14.13s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0214, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9684, 'compress@10': 0.4864, 'time@10': 17.0035}:  60%|██████    | 6/10 [01:22<00:56, 14.13s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0214, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9684, 'compress@10': 0.4864, 'time@10': 17.0035}:  70%|███████   | 7/10 [01:22<00:38, 12.81s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0227, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.969, 'compress@10': 0.5149, 'time@10': 16.7811}:  70%|███████   | 7/10 [01:37<00:38, 12.81s/it]  {'epoch': 18, 'num_users': 6.125, 'loss': 0.0227, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.969, 'compress@10': 0.5149, 'time@10': 16.7811}:  80%|████████  | 8/10 [01:37<00:27, 13.59s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9701, 'compress@10': 0.5314, 'time@10': 17.9435}:  80%|████████  | 8/10 [01:51<00:27, 13.59s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9701, 'compress@10': 0.5314, 'time@10': 17.9435}:  90%|█████████ | 9/10 [01:51<00:13, 13.61s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9769, 'compress@10': 0.5132, 'time@10': 18.0798}:  90%|█████████ | 9/10 [02:10<00:13, 13.61s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9769, 'compress@10': 0.5132, 'time@10': 18.0798}: 100%|██████████| 10/10 [02:10<00:00, 15.38s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9769, 'compress@10': 0.5132, 'time@10': 18.0798}: 100%|██████████| 10/10 [02:10<00:00, 13.07s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.02280235857920522
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9768721324239322
Avg compression ratio: 0.5131772955171104
Avg train time: 18.07979588508606
Std train time: 5.248112555736407
[0.7749999999999999, 0.775, 0.075, 0.425, 0.575, 0.5750000000000001, 0.07500000000000001, 0.7250000000000001, 0.625, 0.375]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0275, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9353, 'compress@10': 0.7811, 'time@10': 15.8883}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0275, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9353, 'compress@10': 0.7811, 'time@10': 15.8883}:  10%|█         | 1/10 [00:07<01:11,  7.98s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9529, 'compress@10': 0.7799, 'time@10': 14.5992}:  10%|█         | 1/10 [00:21<01:11,  7.98s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9529, 'compress@10': 0.7799, 'time@10': 14.5992}:  20%|██        | 2/10 [00:21<01:29, 11.14s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9448, 'compress@10': 0.5669, 'time@10': 13.4304}:  20%|██        | 2/10 [00:26<01:29, 11.14s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9448, 'compress@10': 0.5669, 'time@10': 13.4304}:  30%|███       | 3/10 [00:26<01:00,  8.60s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9497, 'compress@10': 0.5341, 'time@10': 13.092}:  30%|███       | 3/10 [00:39<01:00,  8.60s/it]  {'epoch': 19, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9497, 'compress@10': 0.5341, 'time@10': 13.092}:  40%|████      | 4/10 [00:39<00:59,  9.99s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9516, 'compress@10': 0.5432, 'time@10': 15.8327}:  40%|████      | 4/10 [00:52<00:59,  9.99s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9516, 'compress@10': 0.5432, 'time@10': 15.8327}:  50%|█████     | 5/10 [00:52<00:56, 11.23s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0194, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9501, 'compress@10': 0.5493, 'time@10': 16.5568}:  50%|█████     | 5/10 [01:12<00:56, 11.23s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0194, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9501, 'compress@10': 0.5493, 'time@10': 16.5568}:  60%|██████    | 6/10 [01:12<00:57, 14.29s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9524, 'compress@10': 0.4843, 'time@10': 17.0881}:  60%|██████    | 6/10 [01:22<00:57, 14.29s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9524, 'compress@10': 0.4843, 'time@10': 17.0881}:  70%|███████   | 7/10 [01:22<00:38, 12.94s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0197, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9551, 'compress@10': 0.5148, 'time@10': 16.8498}:  70%|███████   | 7/10 [01:38<00:38, 12.94s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0197, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9551, 'compress@10': 0.5148, 'time@10': 16.8498}:  80%|████████  | 8/10 [01:38<00:27, 13.67s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9605, 'compress@10': 0.5277, 'time@10': 17.9684}:  80%|████████  | 8/10 [01:51<00:27, 13.67s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9605, 'compress@10': 0.5277, 'time@10': 17.9684}:  90%|█████████ | 9/10 [01:51<00:13, 13.61s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9649, 'compress@10': 0.5131, 'time@10': 18.1473}:  90%|█████████ | 9/10 [02:11<00:13, 13.61s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9649, 'compress@10': 0.5131, 'time@10': 18.1473}: 100%|██████████| 10/10 [02:11<00:00, 15.52s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9649, 'compress@10': 0.5131, 'time@10': 18.1473}: 100%|██████████| 10/10 [02:11<00:00, 13.14s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.021186278161450682
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.964865639146559
Avg compression ratio: 0.5131489758235275
Avg train time: 18.147284269332886
Std train time: 5.355835370941011
[0.7857142857142856, 0.7380952380952381, 0.07142857142857142, 0.40476190476190477, 0.5476190476190476, 0.5952380952380953, 0.07142857142857144, 0.7380952380952381, 0.6428571428571429, 0.40476190476190477]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.973, 'ndcg@10': 0.934, 'compress@10': 0.7915, 'time@10': 15.6651}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.973, 'ndcg@10': 0.934, 'compress@10': 0.7915, 'time@10': 15.6651}:  10%|█         | 1/10 [00:07<01:10,  7.87s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9617, 'compress@10': 0.7669, 'time@10': 14.3775}:  10%|█         | 1/10 [00:20<01:10,  7.87s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9617, 'compress@10': 0.7669, 'time@10': 14.3775}:  20%|██        | 2/10 [00:20<01:27, 10.96s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9507, 'compress@10': 0.5572, 'time@10': 13.3805}:  20%|██        | 2/10 [00:26<01:27, 10.96s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9507, 'compress@10': 0.5572, 'time@10': 13.3805}:  30%|███       | 3/10 [00:26<01:00,  8.57s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9558, 'compress@10': 0.5219, 'time@10': 13.0438}:  30%|███       | 3/10 [00:38<01:00,  8.57s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9558, 'compress@10': 0.5219, 'time@10': 13.0438}:  40%|████      | 4/10 [00:38<00:59,  9.95s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9534, 'compress@10': 0.5279, 'time@10': 15.7842}:  40%|████      | 4/10 [00:52<00:59,  9.95s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9534, 'compress@10': 0.5279, 'time@10': 15.7842}:  50%|█████     | 5/10 [00:52<00:56, 11.20s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9565, 'compress@10': 0.5399, 'time@10': 16.4815}:  50%|█████     | 5/10 [01:12<00:56, 11.20s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9565, 'compress@10': 0.5399, 'time@10': 16.4815}:  60%|██████    | 6/10 [01:12<00:56, 14.19s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9566, 'compress@10': 0.4757, 'time@10': 17.071}:  60%|██████    | 6/10 [01:22<00:56, 14.19s/it] {'epoch': 20, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9566, 'compress@10': 0.4757, 'time@10': 17.071}:  70%|███████   | 7/10 [01:22<00:38, 12.93s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0202, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9596, 'compress@10': 0.509, 'time@10': 16.8597}:  70%|███████   | 7/10 [01:37<00:38, 12.93s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0202, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9596, 'compress@10': 0.509, 'time@10': 16.8597}:  80%|████████  | 8/10 [01:37<00:27, 13.73s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.962, 'compress@10': 0.5245, 'time@10': 17.9783}:  80%|████████  | 8/10 [01:51<00:27, 13.73s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.962, 'compress@10': 0.5245, 'time@10': 17.9783}:  90%|█████████ | 9/10 [01:51<00:13, 13.65s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9681, 'compress@10': 0.5132, 'time@10': 18.1482}:  90%|█████████ | 9/10 [02:11<00:13, 13.65s/it]  {'epoch': 20, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9681, 'compress@10': 0.5132, 'time@10': 18.1482}: 100%|██████████| 10/10 [02:11<00:00, 15.53s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9681, 'compress@10': 0.5132, 'time@10': 18.1482}: 100%|██████████| 10/10 [02:11<00:00, 13.12s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.02037814955862502
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9681308896746152
Avg compression ratio: 0.5131766563209845
Avg train time: 18.14819142818451
Std train time: 5.3404885557747015
[0.7499999999999999, 0.75, 0.06818181818181818, 0.38636363636363635, 0.5227272727272727, 0.6136363636363638, 0.11363636363636365, 0.75, 0.6136363636363636, 0.4318181818181818]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9595, 'compress@10': 0.7568, 'time@10': 15.6174}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9595, 'compress@10': 0.7568, 'time@10': 15.6174}:  10%|█         | 1/10 [00:07<01:10,  7.85s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.967, 'compress@10': 0.7554, 'time@10': 14.4536}:  10%|█         | 1/10 [00:21<01:10,  7.85s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.967, 'compress@10': 0.7554, 'time@10': 14.4536}:  20%|██        | 2/10 [00:21<01:28, 11.07s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9542, 'compress@10': 0.5485, 'time@10': 13.4089}:  20%|██        | 2/10 [00:26<01:28, 11.07s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9542, 'compress@10': 0.5485, 'time@10': 13.4089}:  30%|███       | 3/10 [00:26<01:00,  8.62s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9597, 'compress@10': 0.5108, 'time@10': 13.0814}:  30%|███       | 3/10 [00:39<01:00,  8.62s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9597, 'compress@10': 0.5108, 'time@10': 13.0814}:  40%|████      | 4/10 [00:39<01:00, 10.01s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9601, 'compress@10': 0.5142, 'time@10': 15.8454}:  40%|████      | 4/10 [00:52<01:00, 10.01s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9601, 'compress@10': 0.5142, 'time@10': 15.8454}:  50%|█████     | 5/10 [00:52<00:56, 11.26s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9631, 'compress@10': 0.5315, 'time@10': 16.5288}:  50%|█████     | 5/10 [01:12<00:56, 11.26s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9631, 'compress@10': 0.5315, 'time@10': 16.5288}:  60%|██████    | 6/10 [01:12<00:56, 14.23s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0157, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9638, 'compress@10': 0.4744, 'time@10': 17.1865}:  60%|██████    | 6/10 [01:23<00:56, 14.23s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0157, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9638, 'compress@10': 0.4744, 'time@10': 17.1865}:  70%|███████   | 7/10 [01:23<00:39, 13.04s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.964, 'compress@10': 0.5093, 'time@10': 16.9184}:  70%|███████   | 7/10 [01:38<00:39, 13.04s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.964, 'compress@10': 0.5093, 'time@10': 16.9184}:  80%|████████  | 8/10 [01:38<00:27, 13.69s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0219, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9627, 'compress@10': 0.5216, 'time@10': 18.078}:  80%|████████  | 8/10 [01:51<00:27, 13.69s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0219, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9627, 'compress@10': 0.5216, 'time@10': 18.078}:  90%|█████████ | 9/10 [01:51<00:13, 13.70s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9673, 'compress@10': 0.5132, 'time@10': 18.2842}:  90%|█████████ | 9/10 [02:12<00:13, 13.70s/it]  {'epoch': 21, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9673, 'compress@10': 0.5132, 'time@10': 18.2842}: 100%|██████████| 10/10 [02:12<00:00, 15.70s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9673, 'compress@10': 0.5132, 'time@10': 18.2842}: 100%|██████████| 10/10 [02:12<00:00, 13.20s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.022050029604878695
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9673348055614792
Avg compression ratio: 0.513224810275809
Avg train time: 18.28419840335846
Std train time: 5.478848724463884
[0.7608695652173912, 0.717391304347826, 0.06521739130434782, 0.3695652173913043, 0.5, 0.6304347826086958, 0.10869565217391305, 0.7608695652173914, 0.6304347826086957, 0.4565217391304348]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9156, 'compress@10': 0.7673, 'time@10': 15.4503}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9156, 'compress@10': 0.7673, 'time@10': 15.4503}:  10%|█         | 1/10 [00:07<01:09,  7.76s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9492, 'compress@10': 0.7447, 'time@10': 13.9434}:  10%|█         | 1/10 [00:20<01:09,  7.76s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9492, 'compress@10': 0.7447, 'time@10': 13.9434}:  20%|██        | 2/10 [00:20<01:24, 10.53s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9423, 'compress@10': 0.5404, 'time@10': 13.014}:  20%|██        | 2/10 [00:25<01:24, 10.53s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9423, 'compress@10': 0.5404, 'time@10': 13.014}:  30%|███       | 3/10 [00:25<00:58,  8.29s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9506, 'compress@10': 0.5006, 'time@10': 12.8122}:  30%|███       | 3/10 [00:38<00:58,  8.29s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9506, 'compress@10': 0.5006, 'time@10': 12.8122}:  40%|████      | 4/10 [00:38<00:59,  9.85s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9548, 'compress@10': 0.5015, 'time@10': 15.6884}:  40%|████      | 4/10 [00:51<00:59,  9.85s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9548, 'compress@10': 0.5015, 'time@10': 15.6884}:  50%|█████     | 5/10 [00:51<00:56, 11.22s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9582, 'compress@10': 0.5237, 'time@10': 16.3915}:  50%|█████     | 5/10 [01:11<00:56, 11.22s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9582, 'compress@10': 0.5237, 'time@10': 16.3915}:  60%|██████    | 6/10 [01:11<00:56, 14.18s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0175, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9597, 'compress@10': 0.4671, 'time@10': 17.0245}:  60%|██████    | 6/10 [01:22<00:56, 14.18s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0175, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9597, 'compress@10': 0.4671, 'time@10': 17.0245}:  70%|███████   | 7/10 [01:22<00:38, 12.96s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.96, 'compress@10': 0.5042, 'time@10': 16.7877}:  70%|███████   | 7/10 [01:37<00:38, 12.96s/it]   {'epoch': 22, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.96, 'compress@10': 0.5042, 'time@10': 16.7877}:  80%|████████  | 8/10 [01:37<00:27, 13.67s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9623, 'compress@10': 0.5189, 'time@10': 17.8727}:  80%|████████  | 8/10 [01:50<00:27, 13.67s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9623, 'compress@10': 0.5189, 'time@10': 17.8727}:  90%|█████████ | 9/10 [01:50<00:13, 13.56s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9681, 'compress@10': 0.5132, 'time@10': 18.0503}:  90%|█████████ | 9/10 [02:10<00:13, 13.56s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9681, 'compress@10': 0.5132, 'time@10': 18.0503}: 100%|██████████| 10/10 [02:10<00:00, 15.45s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9681, 'compress@10': 0.5132, 'time@10': 18.0503}: 100%|██████████| 10/10 [02:10<00:00, 13.03s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.01877939269174004
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9680993986820857
Avg compression ratio: 0.5132439571369659
Avg train time: 18.050285077095033
Std train time: 5.4595186320303055
[0.7708333333333333, 0.7291666666666666, 0.0625, 0.35416666666666663, 0.4791666666666667, 0.6458333333333335, 0.10416666666666667, 0.7708333333333334, 0.6041666666666667, 0.4791666666666667]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0346, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9838, 'compress@10': 0.777, 'time@10': 14.9904}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0346, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9838, 'compress@10': 0.777, 'time@10': 14.9904}:  10%|█         | 1/10 [00:07<01:07,  7.53s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0237, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9806, 'compress@10': 0.7553, 'time@10': 13.7513}:  10%|█         | 1/10 [00:20<01:07,  7.53s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0237, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9806, 'compress@10': 0.7553, 'time@10': 13.7513}:  20%|██        | 2/10 [00:20<01:23, 10.48s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9632, 'compress@10': 0.5467, 'time@10': 12.9477}:  20%|██        | 2/10 [00:25<01:23, 10.48s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9632, 'compress@10': 0.5467, 'time@10': 12.9477}:  30%|███       | 3/10 [00:25<00:58,  8.30s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9669, 'compress@10': 0.5015, 'time@10': 12.7321}:  30%|███       | 3/10 [00:37<00:58,  8.30s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9669, 'compress@10': 0.5015, 'time@10': 12.7321}:  40%|████      | 4/10 [00:37<00:58,  9.81s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9686, 'compress@10': 0.4981, 'time@10': 15.501}:  40%|████      | 4/10 [00:51<00:58,  9.81s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9686, 'compress@10': 0.4981, 'time@10': 15.501}:  50%|█████     | 5/10 [00:51<00:55, 11.08s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0156, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9722, 'compress@10': 0.5234, 'time@10': 16.2803}:  50%|█████     | 5/10 [01:11<00:55, 11.08s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0156, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9722, 'compress@10': 0.5234, 'time@10': 16.2803}:  60%|██████    | 6/10 [01:11<00:56, 14.19s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0151, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9721, 'compress@10': 0.4662, 'time@10': 16.8899}:  60%|██████    | 6/10 [01:21<00:56, 14.19s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0151, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9721, 'compress@10': 0.4662, 'time@10': 16.8899}:  70%|███████   | 7/10 [01:21<00:38, 12.92s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9718, 'compress@10': 0.5047, 'time@10': 16.6789}:  70%|███████   | 7/10 [01:37<00:38, 12.92s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9718, 'compress@10': 0.5047, 'time@10': 16.6789}:  80%|████████  | 8/10 [01:37<00:27, 13.66s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9773, 'compress@10': 0.5164, 'time@10': 17.7482}:  80%|████████  | 8/10 [01:50<00:27, 13.66s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9773, 'compress@10': 0.5164, 'time@10': 17.7482}:  90%|█████████ | 9/10 [01:50<00:13, 13.52s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9788, 'compress@10': 0.5133, 'time@10': 17.9357}:  90%|█████████ | 9/10 [02:09<00:13, 13.52s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9788, 'compress@10': 0.5133, 'time@10': 17.9357}: 100%|██████████| 10/10 [02:09<00:00, 15.41s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9788, 'compress@10': 0.5133, 'time@10': 17.9357}: 100%|██████████| 10/10 [02:09<00:00, 12.99s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.019361822521897956
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9788247964266503
Avg compression ratio: 0.5132555117104227
Avg train time: 17.935717129707335
Std train time: 5.316342470280073
[0.7799999999999999, 0.7, 0.06, 0.37999999999999995, 0.46, 0.6600000000000001, 0.1, 0.78, 0.6200000000000001, 0.46]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9583, 'compress@10': 0.7859, 'time@10': 15.2028}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9583, 'compress@10': 0.7859, 'time@10': 15.2028}:  10%|█         | 1/10 [00:07<01:08,  7.65s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9743, 'compress@10': 0.7454, 'time@10': 14.1887}:  10%|█         | 1/10 [00:20<01:08,  7.65s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9743, 'compress@10': 0.7454, 'time@10': 14.1887}:  20%|██        | 2/10 [00:20<01:27, 10.92s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.959, 'compress@10': 0.5393, 'time@10': 13.0692}:  20%|██        | 2/10 [00:26<01:27, 10.92s/it]  {'epoch': 24, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.959, 'compress@10': 0.5393, 'time@10': 13.0692}:  30%|███       | 3/10 [00:26<00:58,  8.42s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9637, 'compress@10': 0.5024, 'time@10': 12.8309}:  30%|███       | 3/10 [00:38<00:58,  8.42s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9637, 'compress@10': 0.5024, 'time@10': 12.8309}:  40%|████      | 4/10 [00:38<00:59,  9.90s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9656, 'compress@10': 0.495, 'time@10': 15.7136}:  40%|████      | 4/10 [00:52<00:59,  9.90s/it] {'epoch': 24, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9656, 'compress@10': 0.495, 'time@10': 15.7136}:  50%|█████     | 5/10 [00:52<00:56, 11.25s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9678, 'compress@10': 0.5231, 'time@10': 16.4479}:  50%|█████     | 5/10 [01:12<00:56, 11.25s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9678, 'compress@10': 0.5231, 'time@10': 16.4479}:  60%|██████    | 6/10 [01:12<00:57, 14.28s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9674, 'compress@10': 0.4654, 'time@10': 16.9866}:  60%|██████    | 6/10 [01:22<00:57, 14.28s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9674, 'compress@10': 0.4654, 'time@10': 16.9866}:  70%|███████   | 7/10 [01:22<00:38, 12.93s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9658, 'compress@10': 0.5051, 'time@10': 16.7383}:  70%|███████   | 7/10 [01:37<00:38, 12.93s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9658, 'compress@10': 0.5051, 'time@10': 16.7383}:  80%|████████  | 8/10 [01:37<00:27, 13.60s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9675, 'compress@10': 0.5185, 'time@10': 17.8109}:  80%|████████  | 8/10 [01:50<00:27, 13.60s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9675, 'compress@10': 0.5185, 'time@10': 17.8109}:  90%|█████████ | 9/10 [01:50<00:13, 13.49s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9735, 'compress@10': 0.5132, 'time@10': 18.006}:  90%|█████████ | 9/10 [02:10<00:13, 13.49s/it]    {'epoch': 24, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9735, 'compress@10': 0.5132, 'time@10': 18.006}: 100%|██████████| 10/10 [02:10<00:00, 15.43s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9735, 'compress@10': 0.5132, 'time@10': 18.006}: 100%|██████████| 10/10 [02:10<00:00, 13.05s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.018223104756423737
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9734741837641104
Avg compression ratio: 0.5132469608602019
Avg train time: 18.00603563785553
Std train time: 5.4271369092040045
[0.7884615384615383, 0.7115384615384615, 0.05769230769230769, 0.3653846153846153, 0.44230769230769235, 0.6730769230769232, 0.09615384615384616, 0.7884615384615384, 0.5961538461538463, 0.4807692307692308]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0097, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9427, 'compress@10': 0.7942, 'time@10': 15.1063}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0097, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9427, 'compress@10': 0.7942, 'time@10': 15.1063}:  10%|█         | 1/10 [00:07<01:08,  7.59s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.961, 'compress@10': 0.7552, 'time@10': 14.1152}:  10%|█         | 1/10 [00:20<01:08,  7.59s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.961, 'compress@10': 0.7552, 'time@10': 14.1152}:  20%|██        | 2/10 [00:20<01:26, 10.87s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9502, 'compress@10': 0.5451, 'time@10': 12.9221}:  20%|██        | 2/10 [00:26<01:26, 10.87s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9502, 'compress@10': 0.5451, 'time@10': 12.9221}:  30%|███       | 3/10 [00:26<00:58,  8.33s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9575, 'compress@10': 0.5031, 'time@10': 12.7655}:  30%|███       | 3/10 [00:38<00:58,  8.33s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9575, 'compress@10': 0.5031, 'time@10': 12.7655}:  40%|████      | 4/10 [00:38<00:59,  9.91s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.96, 'compress@10': 0.4921, 'time@10': 15.7094}:  40%|████      | 4/10 [00:52<00:59,  9.91s/it]  {'epoch': 25, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.96, 'compress@10': 0.4921, 'time@10': 15.7094}:  50%|█████     | 5/10 [00:52<00:56, 11.30s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9631, 'compress@10': 0.5229, 'time@10': 16.4173}:  50%|█████     | 5/10 [01:12<00:56, 11.30s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9631, 'compress@10': 0.5229, 'time@10': 16.4173}:  60%|██████    | 6/10 [01:12<00:57, 14.26s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9648, 'compress@10': 0.4646, 'time@10': 16.8624}:  60%|██████    | 6/10 [01:21<00:57, 14.26s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9648, 'compress@10': 0.4646, 'time@10': 16.8624}:  70%|███████   | 7/10 [01:21<00:38, 12.80s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9635, 'compress@10': 0.5055, 'time@10': 16.5856}:  70%|███████   | 7/10 [01:36<00:38, 12.80s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9635, 'compress@10': 0.5055, 'time@10': 16.5856}:  80%|████████  | 8/10 [01:36<00:26, 13.40s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9707, 'compress@10': 0.5162, 'time@10': 17.586}:  80%|████████  | 8/10 [01:49<00:26, 13.40s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9707, 'compress@10': 0.5162, 'time@10': 17.586}:  90%|█████████ | 9/10 [01:49<00:13, 13.22s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9723, 'compress@10': 0.5133, 'time@10': 17.704}:  90%|█████████ | 9/10 [02:08<00:13, 13.22s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9723, 'compress@10': 0.5133, 'time@10': 17.704}: 100%|██████████| 10/10 [02:08<00:00, 14.95s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9723, 'compress@10': 0.5133, 'time@10': 17.704}: 100%|██████████| 10/10 [02:08<00:00, 12.83s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.014838308408679423
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9723033757055383
Avg compression ratio: 0.5132596906668465
Avg train time: 17.704047799110413
Std train time: 5.339330254401843
[0.7592592592592591, 0.6851851851851851, 0.05555555555555555, 0.38888888888888884, 0.462962962962963, 0.6851851851851853, 0.0925925925925926, 0.7962962962962963, 0.6111111111111112, 0.46296296296296297]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.973, 'ndcg@10': 0.954, 'compress@10': 0.7658, 'time@10': 14.6466}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.973, 'ndcg@10': 0.954, 'compress@10': 0.7658, 'time@10': 14.6466}:  10%|█         | 1/10 [00:07<01:06,  7.36s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9673, 'compress@10': 0.728, 'time@10': 13.5026}:  10%|█         | 1/10 [00:19<01:06,  7.36s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9673, 'compress@10': 0.728, 'time@10': 13.5026}:  20%|██        | 2/10 [00:19<01:22, 10.32s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.9379, 'ndcg@10': 0.9544, 'compress@10': 0.5264, 'time@10': 12.458}:  20%|██        | 2/10 [00:24<01:22, 10.32s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.9379, 'ndcg@10': 0.9544, 'compress@10': 0.5264, 'time@10': 12.458}:  30%|███       | 3/10 [00:24<00:55,  7.99s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.9488, 'ndcg@10': 0.9604, 'compress@10': 0.4948, 'time@10': 12.1456}:  30%|███       | 3/10 [00:36<00:55,  7.99s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.9488, 'ndcg@10': 0.9604, 'compress@10': 0.4948, 'time@10': 12.1456}:  40%|████      | 4/10 [00:36<00:55,  9.28s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.957, 'ndcg@10': 0.9639, 'compress@10': 0.4895, 'time@10': 14.8298}:  40%|████      | 4/10 [00:49<00:55,  9.28s/it] {'epoch': 26, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.957, 'ndcg@10': 0.9639, 'compress@10': 0.4895, 'time@10': 14.8298}:  50%|█████     | 5/10 [00:49<00:52, 10.55s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.9623, 'ndcg@10': 0.9663, 'compress@10': 0.5227, 'time@10': 15.5303}:  50%|█████     | 5/10 [01:08<00:52, 10.55s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.9623, 'ndcg@10': 0.9663, 'compress@10': 0.5227, 'time@10': 15.5303}:  60%|██████    | 6/10 [01:08<00:53, 13.45s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0151, 'hit_ratio@10': 0.9647, 'ndcg@10': 0.9673, 'compress@10': 0.464, 'time@10': 16.0477}:  60%|██████    | 6/10 [01:17<00:53, 13.45s/it] {'epoch': 26, 'num_users': 6.2857, 'loss': 0.0151, 'hit_ratio@10': 0.9647, 'ndcg@10': 0.9673, 'compress@10': 0.464, 'time@10': 16.0477}:  70%|███████   | 7/10 [01:17<00:36, 12.21s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.9673, 'ndcg@10': 0.9674, 'compress@10': 0.5059, 'time@10': 15.8002}:  70%|███████   | 7/10 [01:31<00:36, 12.21s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.9673, 'ndcg@10': 0.9674, 'compress@10': 0.5059, 'time@10': 15.8002}:  80%|████████  | 8/10 [01:31<00:25, 12.81s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.969, 'compress@10': 0.5182, 'time@10': 16.8861}:  80%|████████  | 8/10 [01:44<00:25, 12.81s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.969, 'compress@10': 0.5182, 'time@10': 16.8861}:  90%|█████████ | 9/10 [01:44<00:12, 12.81s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.9712, 'ndcg@10': 0.9736, 'compress@10': 0.5133, 'time@10': 17.0636}:  90%|█████████ | 9/10 [02:03<00:12, 12.81s/it]  {'epoch': 26, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.9712, 'ndcg@10': 0.9736, 'compress@10': 0.5133, 'time@10': 17.0636}: 100%|██████████| 10/10 [02:03<00:00, 14.63s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.9712, 'ndcg@10': 0.9736, 'compress@10': 0.5133, 'time@10': 17.0636}: 100%|██████████| 10/10 [02:03<00:00, 12.34s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.01649326684451951
Avg hit ratio: 0.9712251807362684
Avg ndcg: 0.9735955473596443
Avg compression ratio: 0.5133150334101787
Avg train time: 17.063635420799255
Std train time: 5.211272197675367
[0.732142857142857, 0.6964285714285714, 0.05357142857142857, 0.37499999999999994, 0.4464285714285715, 0.6964285714285716, 0.125, 0.8035714285714286, 0.5892857142857143, 0.48214285714285715]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9508, 'compress@10': 0.7394, 'time@10': 15.008}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9508, 'compress@10': 0.7394, 'time@10': 15.008}:  10%|█         | 1/10 [00:07<01:07,  7.54s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9657, 'compress@10': 0.7204, 'time@10': 13.7509}:  10%|█         | 1/10 [00:20<01:07,  7.54s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9657, 'compress@10': 0.7204, 'time@10': 13.7509}:  20%|██        | 2/10 [00:20<01:23, 10.48s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9533, 'compress@10': 0.5206, 'time@10': 12.7588}:  20%|██        | 2/10 [00:25<01:23, 10.48s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9533, 'compress@10': 0.5206, 'time@10': 12.7588}:  30%|███       | 3/10 [00:25<00:57,  8.17s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9603, 'compress@10': 0.4871, 'time@10': 12.4288}:  30%|███       | 3/10 [00:36<00:57,  8.17s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9603, 'compress@10': 0.4871, 'time@10': 12.4288}:  40%|████      | 4/10 [00:36<00:56,  9.48s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9646, 'compress@10': 0.4801, 'time@10': 15.0749}:  40%|████      | 4/10 [00:49<00:56,  9.48s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9646, 'compress@10': 0.4801, 'time@10': 15.0749}:  50%|█████     | 5/10 [00:49<00:53, 10.70s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9674, 'compress@10': 0.5167, 'time@10': 15.7115}:  50%|█████     | 5/10 [01:08<00:53, 10.70s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9674, 'compress@10': 0.5167, 'time@10': 15.7115}:  60%|██████    | 6/10 [01:08<00:54, 13.50s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9685, 'compress@10': 0.4634, 'time@10': 16.2208}:  60%|██████    | 6/10 [01:18<00:54, 13.50s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9685, 'compress@10': 0.4634, 'time@10': 16.2208}:  70%|███████   | 7/10 [01:18<00:36, 12.25s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9655, 'compress@10': 0.5062, 'time@10': 15.9434}:  70%|███████   | 7/10 [01:32<00:36, 12.25s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9655, 'compress@10': 0.5062, 'time@10': 15.9434}:  80%|████████  | 8/10 [01:32<00:25, 12.82s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0148, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9672, 'compress@10': 0.5162, 'time@10': 17.0489}:  80%|████████  | 8/10 [01:45<00:25, 12.82s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0148, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9672, 'compress@10': 0.5162, 'time@10': 17.0489}:  90%|█████████ | 9/10 [01:45<00:12, 12.87s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9694, 'compress@10': 0.5133, 'time@10': 17.2104}:  90%|█████████ | 9/10 [02:04<00:12, 12.87s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9694, 'compress@10': 0.5133, 'time@10': 17.2104}: 100%|██████████| 10/10 [02:04<00:00, 14.67s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9694, 'compress@10': 0.5133, 'time@10': 17.2104}: 100%|██████████| 10/10 [02:04<00:00, 12.42s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.013844097251015736
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9693586625161899
Avg compression ratio: 0.5133436736731907
Avg train time: 17.21042444705963
Std train time: 5.177993154679629
[0.7413793103448274, 0.6724137931034483, 0.05172413793103448, 0.396551724137931, 0.4310344827586208, 0.7068965517241381, 0.1206896551724138, 0.810344827586207, 0.603448275862069, 0.46551724137931033]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9464, 'compress@10': 0.7484, 'time@10': 15.0115}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9464, 'compress@10': 0.7484, 'time@10': 15.0115}:  10%|█         | 1/10 [00:07<01:07,  7.54s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9604, 'compress@10': 0.7131, 'time@10': 13.8428}:  10%|█         | 1/10 [00:20<01:07,  7.54s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9604, 'compress@10': 0.7131, 'time@10': 13.8428}:  20%|██        | 2/10 [00:20<01:24, 10.58s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9498, 'compress@10': 0.5152, 'time@10': 12.9535}:  20%|██        | 2/10 [00:25<01:24, 10.58s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9498, 'compress@10': 0.5152, 'time@10': 12.9535}:  30%|███       | 3/10 [00:25<00:58,  8.32s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9577, 'compress@10': 0.4883, 'time@10': 12.5648}:  30%|███       | 3/10 [00:37<00:58,  8.32s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9577, 'compress@10': 0.4883, 'time@10': 12.5648}:  40%|████      | 4/10 [00:37<00:57,  9.55s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.015, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9585, 'compress@10': 0.478, 'time@10': 15.1985}:  40%|████      | 4/10 [00:50<00:57,  9.55s/it] {'epoch': 28, 'num_users': 5.8, 'loss': 0.015, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9585, 'compress@10': 0.478, 'time@10': 15.1985}:  50%|█████     | 5/10 [00:50<00:53, 10.76s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9614, 'compress@10': 0.5167, 'time@10': 15.8859}:  50%|█████     | 5/10 [01:09<00:53, 10.76s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9614, 'compress@10': 0.5167, 'time@10': 15.8859}:  60%|██████    | 6/10 [01:09<00:54, 13.69s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.016, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.964, 'compress@10': 0.4628, 'time@10': 16.5031}:  60%|██████    | 6/10 [01:19<00:54, 13.69s/it]  {'epoch': 28, 'num_users': 6.2857, 'loss': 0.016, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.964, 'compress@10': 0.4628, 'time@10': 16.5031}:  70%|███████   | 7/10 [01:19<00:37, 12.53s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0173, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9685, 'compress@10': 0.5065, 'time@10': 16.199}:  70%|███████   | 7/10 [01:33<00:37, 12.53s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0173, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9685, 'compress@10': 0.5065, 'time@10': 16.199}:  80%|████████  | 8/10 [01:33<00:26, 13.03s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.97, 'compress@10': 0.518, 'time@10': 17.1933}:  80%|████████  | 8/10 [01:46<00:26, 13.03s/it]  {'epoch': 28, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.97, 'compress@10': 0.518, 'time@10': 17.1933}:  90%|█████████ | 9/10 [01:46<00:12, 12.90s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9755, 'compress@10': 0.5133, 'time@10': 17.3499}:  90%|█████████ | 9/10 [02:05<00:12, 12.90s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9755, 'compress@10': 0.5133, 'time@10': 17.3499}: 100%|██████████| 10/10 [02:05<00:00, 14.72s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9755, 'compress@10': 0.5133, 'time@10': 17.3499}: 100%|██████████| 10/10 [02:05<00:00, 12.52s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.01643498279924848
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9755456857039031
Avg compression ratio: 0.5133344381423786
Avg train time: 17.349858713150024
Std train time: 5.067118381703931
[0.7166666666666665, 0.6833333333333333, 0.05, 0.41666666666666663, 0.41666666666666674, 0.7166666666666669, 0.11666666666666667, 0.8166666666666668, 0.5833333333333334, 0.48333333333333334]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.973, 'ndcg@10': 0.957, 'compress@10': 0.7243, 'time@10': 14.7432}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.973, 'ndcg@10': 0.957, 'compress@10': 0.7243, 'time@10': 14.7432}:  10%|█         | 1/10 [00:07<01:06,  7.41s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9692, 'compress@10': 0.7064, 'time@10': 13.4641}:  10%|█         | 1/10 [00:19<01:06,  7.41s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9692, 'compress@10': 0.7064, 'time@10': 13.4641}:  20%|██        | 2/10 [00:19<01:21, 10.24s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9557, 'compress@10': 0.5102, 'time@10': 12.7171}:  20%|██        | 2/10 [00:25<01:21, 10.24s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9557, 'compress@10': 0.5102, 'time@10': 12.7171}:  30%|███       | 3/10 [00:25<00:57,  8.14s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9618, 'compress@10': 0.4895, 'time@10': 12.4086}:  30%|███       | 3/10 [00:36<00:57,  8.14s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9618, 'compress@10': 0.4895, 'time@10': 12.4086}:  40%|████      | 4/10 [00:36<00:56,  9.48s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.966, 'compress@10': 0.4761, 'time@10': 15.1397}:  40%|████      | 4/10 [00:49<00:56,  9.48s/it] {'epoch': 29, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.966, 'compress@10': 0.4761, 'time@10': 15.1397}:  50%|█████     | 5/10 [00:49<00:53, 10.77s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0079, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9696, 'compress@10': 0.5168, 'time@10': 15.7409}:  50%|█████     | 5/10 [01:08<00:53, 10.77s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0079, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9696, 'compress@10': 0.5168, 'time@10': 15.7409}:  60%|██████    | 6/10 [01:08<00:53, 13.50s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9703, 'compress@10': 0.4622, 'time@10': 16.2621}:  60%|██████    | 6/10 [01:18<00:53, 13.50s/it] {'epoch': 29, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9703, 'compress@10': 0.4622, 'time@10': 16.2621}:  70%|███████   | 7/10 [01:18<00:36, 12.27s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9697, 'compress@10': 0.5069, 'time@10': 15.9741}:  70%|███████   | 7/10 [01:32<00:36, 12.27s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9697, 'compress@10': 0.5069, 'time@10': 15.9741}:  80%|████████  | 8/10 [01:32<00:25, 12.82s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9715, 'compress@10': 0.5161, 'time@10': 17.0103}:  80%|████████  | 8/10 [01:45<00:25, 12.82s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9715, 'compress@10': 0.5161, 'time@10': 17.0103}:  90%|█████████ | 9/10 [01:45<00:12, 12.78s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9732, 'compress@10': 0.5134, 'time@10': 17.1872}:  90%|█████████ | 9/10 [02:03<00:12, 12.78s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9732, 'compress@10': 0.5134, 'time@10': 17.1872}: 100%|██████████| 10/10 [02:03<00:00, 14.64s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9732, 'compress@10': 0.5134, 'time@10': 17.1872}: 100%|██████████| 10/10 [02:03<00:00, 12.39s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.011143286538368269
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9732412111312817
Avg compression ratio: 0.5133723701971487
Avg train time: 17.187199783325195
Std train time: 5.137707283206623
[0.725806451612903, 0.6612903225806451, 0.048387096774193554, 0.4354838709677419, 0.435483870967742, 0.6935483870967745, 0.11290322580645161, 0.8225806451612904, 0.5967741935483871, 0.467741935483871]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9556, 'compress@10': 0.7332, 'time@10': 15.3235}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9556, 'compress@10': 0.7332, 'time@10': 15.3235}:  10%|█         | 1/10 [00:07<01:09,  7.70s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9588, 'compress@10': 0.7, 'time@10': 13.8783}:  10%|█         | 1/10 [00:20<01:09,  7.70s/it]  {'epoch': 30, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9588, 'compress@10': 0.7, 'time@10': 13.8783}:  20%|██        | 2/10 [00:20<01:24, 10.51s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9487, 'compress@10': 0.5055, 'time@10': 12.8995}:  20%|██        | 2/10 [00:25<01:24, 10.51s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9487, 'compress@10': 0.5055, 'time@10': 12.8995}:  30%|███       | 3/10 [00:25<00:57,  8.22s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.957, 'compress@10': 0.4906, 'time@10': 12.5698}:  30%|███       | 3/10 [00:37<00:57,  8.22s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.957, 'compress@10': 0.4906, 'time@10': 12.5698}:  40%|████      | 4/10 [00:37<00:57,  9.56s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9623, 'compress@10': 0.4807, 'time@10': 15.1569}:  40%|████      | 4/10 [00:50<00:57,  9.56s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9623, 'compress@10': 0.4807, 'time@10': 15.1569}:  50%|█████     | 5/10 [00:50<00:53, 10.73s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9663, 'compress@10': 0.5168, 'time@10': 15.7495}:  50%|█████     | 5/10 [01:08<00:53, 10.73s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9663, 'compress@10': 0.5168, 'time@10': 15.7495}:  60%|██████    | 6/10 [01:08<00:53, 13.45s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9685, 'compress@10': 0.4617, 'time@10': 16.2766}:  60%|██████    | 6/10 [01:18<00:53, 13.45s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9685, 'compress@10': 0.4617, 'time@10': 16.2766}:  70%|███████   | 7/10 [01:18<00:36, 12.25s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9688, 'compress@10': 0.5071, 'time@10': 16.0313}:  70%|███████   | 7/10 [01:32<00:36, 12.25s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9688, 'compress@10': 0.5071, 'time@10': 16.0313}:  80%|████████  | 8/10 [01:32<00:25, 12.92s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9704, 'compress@10': 0.5178, 'time@10': 17.0471}:  80%|████████  | 8/10 [01:45<00:25, 12.92s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9704, 'compress@10': 0.5178, 'time@10': 17.0471}:  90%|█████████ | 9/10 [01:45<00:12, 12.82s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.974, 'compress@10': 0.5134, 'time@10': 17.2193}:  90%|█████████ | 9/10 [02:04<00:12, 12.82s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.974, 'compress@10': 0.5134, 'time@10': 17.2193}: 100%|██████████| 10/10 [02:04<00:00, 14.67s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.974, 'compress@10': 0.5134, 'time@10': 17.2193}: 100%|██████████| 10/10 [02:04<00:00, 12.44s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.01493315332999962
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9740116383100534
Avg compression ratio: 0.5133623639377694
Avg train time: 17.219302821159364
Std train time: 4.976127751465679
[0.7031249999999998, 0.671875, 0.04687500000000001, 0.45312499999999994, 0.42187500000000006, 0.7031250000000002, 0.109375, 0.828125, 0.578125, 0.484375]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9784, 'compress@10': 0.7111, 'time@10': 14.6915}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9784, 'compress@10': 0.7111, 'time@10': 14.6915}:  10%|█         | 1/10 [00:07<01:06,  7.38s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9799, 'compress@10': 0.6942, 'time@10': 13.5695}:  10%|█         | 1/10 [00:19<01:06,  7.38s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9799, 'compress@10': 0.6942, 'time@10': 13.5695}:  20%|██        | 2/10 [00:19<01:23, 10.39s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9628, 'compress@10': 0.5011, 'time@10': 12.7381}:  20%|██        | 2/10 [00:25<01:23, 10.39s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9628, 'compress@10': 0.5011, 'time@10': 12.7381}:  30%|███       | 3/10 [00:25<00:57,  8.19s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9675, 'compress@10': 0.4916, 'time@10': 12.411}:  30%|███       | 3/10 [00:36<00:57,  8.19s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9675, 'compress@10': 0.4916, 'time@10': 12.411}:  40%|████      | 4/10 [00:36<00:56,  9.48s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9705, 'compress@10': 0.4789, 'time@10': 15.0022}:  40%|████      | 4/10 [00:49<00:56,  9.48s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9705, 'compress@10': 0.4789, 'time@10': 15.0022}:  50%|█████     | 5/10 [00:49<00:53, 10.65s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9735, 'compress@10': 0.5168, 'time@10': 15.6294}:  50%|█████     | 5/10 [01:08<00:53, 10.65s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9735, 'compress@10': 0.5168, 'time@10': 15.6294}:  60%|██████    | 6/10 [01:08<00:53, 13.42s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9742, 'compress@10': 0.4612, 'time@10': 16.1975}:  60%|██████    | 6/10 [01:18<00:53, 13.42s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9742, 'compress@10': 0.4612, 'time@10': 16.1975}:  70%|███████   | 7/10 [01:18<00:36, 12.25s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9747, 'compress@10': 0.5074, 'time@10': 15.8919}:  70%|███████   | 7/10 [01:32<00:36, 12.25s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9747, 'compress@10': 0.5074, 'time@10': 15.8919}:  80%|████████  | 8/10 [01:32<00:25, 12.74s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9739, 'compress@10': 0.516, 'time@10': 17.0095}:  80%|████████  | 8/10 [01:45<00:25, 12.74s/it] {'epoch': 31, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9739, 'compress@10': 0.516, 'time@10': 17.0095}:  90%|█████████ | 9/10 [01:45<00:12, 12.83s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9754, 'compress@10': 0.5134, 'time@10': 17.1934}:  90%|█████████ | 9/10 [02:03<00:12, 12.83s/it] {'epoch': 31, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9754, 'compress@10': 0.5134, 'time@10': 17.1934}: 100%|██████████| 10/10 [02:03<00:00, 14.70s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9754, 'compress@10': 0.5134, 'time@10': 17.1934}: 100%|██████████| 10/10 [02:03<00:00, 12.40s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.011327522943426802
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9753560102524912
Avg compression ratio: 0.5133958768802187
Avg train time: 17.19335181713104
Std train time: 5.155566693618682
[0.7121212121212119, 0.6515151515151515, 0.04545454545454546, 0.4696969696969696, 0.43939393939393945, 0.681818181818182, 0.10606060606060606, 0.8333333333333334, 0.5909090909090909, 0.4696969696969697]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9529, 'compress@10': 0.7199, 'time@10': 14.8388}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9529, 'compress@10': 0.7199, 'time@10': 14.8388}:  10%|█         | 1/10 [00:07<01:07,  7.46s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9601, 'compress@10': 0.6886, 'time@10': 13.5623}:  10%|█         | 1/10 [00:19<01:07,  7.46s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9601, 'compress@10': 0.6886, 'time@10': 13.5623}:  20%|██        | 2/10 [00:19<01:22, 10.32s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9496, 'compress@10': 0.4969, 'time@10': 12.5856}:  20%|██        | 2/10 [00:25<01:22, 10.32s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9496, 'compress@10': 0.4969, 'time@10': 12.5856}:  30%|███       | 3/10 [00:25<00:56,  8.05s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9586, 'compress@10': 0.4926, 'time@10': 12.2662}:  30%|███       | 3/10 [00:36<00:56,  8.05s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9586, 'compress@10': 0.4926, 'time@10': 12.2662}:  40%|████      | 4/10 [00:36<00:56,  9.35s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9631, 'compress@10': 0.4831, 'time@10': 14.9911}:  40%|████      | 4/10 [00:49<00:56,  9.35s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9631, 'compress@10': 0.4831, 'time@10': 14.9911}:  50%|█████     | 5/10 [00:49<00:53, 10.66s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0156, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.963, 'compress@10': 0.5168, 'time@10': 15.7441}:  50%|█████     | 5/10 [01:09<00:53, 10.66s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0156, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.963, 'compress@10': 0.5168, 'time@10': 15.7441}:  60%|██████    | 6/10 [01:09<00:54, 13.68s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0148, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9647, 'compress@10': 0.4608, 'time@10': 16.3142}:  60%|██████    | 6/10 [01:18<00:54, 13.68s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0148, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9647, 'compress@10': 0.4608, 'time@10': 16.3142}:  70%|███████   | 7/10 [01:18<00:37, 12.45s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9697, 'compress@10': 0.5076, 'time@10': 16.0034}:  70%|███████   | 7/10 [01:32<00:37, 12.45s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9697, 'compress@10': 0.5076, 'time@10': 16.0034}:  80%|████████  | 8/10 [01:32<00:25, 12.90s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9713, 'compress@10': 0.5176, 'time@10': 17.0617}:  80%|████████  | 8/10 [01:45<00:25, 12.90s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9713, 'compress@10': 0.5176, 'time@10': 17.0617}:  90%|█████████ | 9/10 [01:45<00:12, 12.87s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.974, 'compress@10': 0.5134, 'time@10': 17.2219}:  90%|█████████ | 9/10 [02:04<00:12, 12.87s/it]    {'epoch': 32, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.974, 'compress@10': 0.5134, 'time@10': 17.2219}: 100%|██████████| 10/10 [02:04<00:00, 14.67s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.974, 'compress@10': 0.5134, 'time@10': 17.2219}: 100%|██████████| 10/10 [02:04<00:00, 12.43s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.015293918343007067
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9739768040630674
Avg compression ratio: 0.5133868239354247
Avg train time: 17.221934151649474
Std train time: 5.270178935158065
[0.7205882352941174, 0.6617647058823529, 0.04411764705882354, 0.48529411764705876, 0.42647058823529416, 0.6911764705882355, 0.10294117647058824, 0.8382352941176471, 0.573529411764706, 0.4558823529411765]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9657, 'compress@10': 0.7281, 'time@10': 15.2049}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9657, 'compress@10': 0.7281, 'time@10': 15.2049}:  10%|█         | 1/10 [00:07<01:08,  7.64s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9735, 'compress@10': 0.6977, 'time@10': 13.954}:  10%|█         | 1/10 [00:20<01:08,  7.64s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9735, 'compress@10': 0.6977, 'time@10': 13.954}:  20%|██        | 2/10 [00:20<01:25, 10.64s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9585, 'compress@10': 0.5026, 'time@10': 12.8828}:  20%|██        | 2/10 [00:25<01:25, 10.64s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9585, 'compress@10': 0.5026, 'time@10': 12.8828}:  30%|███       | 3/10 [00:25<00:57,  8.25s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9643, 'compress@10': 0.5007, 'time@10': 12.5363}:  30%|███       | 3/10 [00:37<00:57,  8.25s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9643, 'compress@10': 0.5007, 'time@10': 12.5363}:  40%|████      | 4/10 [00:37<00:57,  9.55s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0054, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9683, 'compress@10': 0.487, 'time@10': 15.1458}:  40%|████      | 4/10 [00:50<00:57,  9.55s/it] {'epoch': 33, 'num_users': 5.8, 'loss': 0.0054, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9683, 'compress@10': 0.487, 'time@10': 15.1458}:  50%|█████     | 5/10 [00:50<00:53, 10.73s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0049, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9716, 'compress@10': 0.5216, 'time@10': 15.761}:  50%|█████     | 5/10 [01:09<00:53, 10.73s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0049, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9716, 'compress@10': 0.5216, 'time@10': 15.761}:  60%|██████    | 6/10 [01:09<00:53, 13.50s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0049, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9726, 'compress@10': 0.4645, 'time@10': 16.3148}:  60%|██████    | 6/10 [01:18<00:53, 13.50s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0049, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9726, 'compress@10': 0.4645, 'time@10': 16.3148}:  70%|███████   | 7/10 [01:18<00:36, 12.31s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0058, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9739, 'compress@10': 0.5115, 'time@10': 16.0143}:  70%|███████   | 7/10 [01:32<00:36, 12.31s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.0058, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9739, 'compress@10': 0.5115, 'time@10': 16.0143}:  80%|████████  | 8/10 [01:32<00:25, 12.83s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0076, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9769, 'compress@10': 0.5191, 'time@10': 17.1082}:  80%|████████  | 8/10 [01:45<00:25, 12.83s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0076, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9769, 'compress@10': 0.5191, 'time@10': 17.1082}:  90%|█████████ | 9/10 [01:45<00:12, 12.87s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0073, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9781, 'compress@10': 0.5134, 'time@10': 17.2689}:  90%|█████████ | 9/10 [02:04<00:12, 12.87s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0073, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9781, 'compress@10': 0.5134, 'time@10': 17.2689}: 100%|██████████| 10/10 [02:04<00:00, 14.69s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0073, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9781, 'compress@10': 0.5134, 'time@10': 17.2689}: 100%|██████████| 10/10 [02:04<00:00, 12.46s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.007306984266324669
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9780964583062494
Avg compression ratio: 0.5133722504811926
Avg train time: 17.268901109695435
Std train time: 5.151844451780563
[0.7285714285714283, 0.6428571428571428, 0.042857142857142864, 0.49999999999999994, 0.4428571428571429, 0.6714285714285716, 0.1, 0.8428571428571429, 0.5857142857142857, 0.4428571428571429]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9604, 'compress@10': 0.7359, 'time@10': 15.298}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9604, 'compress@10': 0.7359, 'time@10': 15.298}:  10%|█         | 1/10 [00:07<01:09,  7.68s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9634, 'compress@10': 0.6923, 'time@10': 13.9381}:  10%|█         | 1/10 [00:20<01:09,  7.68s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9634, 'compress@10': 0.6923, 'time@10': 13.9381}:  20%|██        | 2/10 [00:20<01:24, 10.58s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9518, 'compress@10': 0.4986, 'time@10': 13.0335}:  20%|██        | 2/10 [00:25<01:24, 10.58s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9518, 'compress@10': 0.4986, 'time@10': 13.0335}:  30%|███       | 3/10 [00:25<00:58,  8.34s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9601, 'compress@10': 0.5013, 'time@10': 12.6069}:  30%|███       | 3/10 [00:37<00:58,  8.34s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9601, 'compress@10': 0.5013, 'time@10': 12.6069}:  40%|████      | 4/10 [00:37<00:57,  9.53s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9632, 'compress@10': 0.4907, 'time@10': 15.2683}:  40%|████      | 4/10 [00:50<00:57,  9.53s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9632, 'compress@10': 0.4907, 'time@10': 15.2683}:  50%|█████     | 5/10 [00:50<00:53, 10.78s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9637, 'compress@10': 0.5214, 'time@10': 15.8593}:  50%|█████     | 5/10 [01:09<00:53, 10.78s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9637, 'compress@10': 0.5214, 'time@10': 15.8593}:  60%|██████    | 6/10 [01:09<00:54, 13.52s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9659, 'compress@10': 0.4639, 'time@10': 16.3556}:  60%|██████    | 6/10 [01:18<00:54, 13.52s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9659, 'compress@10': 0.4639, 'time@10': 16.3556}:  70%|███████   | 7/10 [01:18<00:36, 12.27s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9694, 'compress@10': 0.5116, 'time@10': 16.0269}:  70%|███████   | 7/10 [01:32<00:36, 12.27s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9694, 'compress@10': 0.5116, 'time@10': 16.0269}:  80%|████████  | 8/10 [01:32<00:25, 12.75s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9717, 'compress@10': 0.5205, 'time@10': 17.1183}:  80%|████████  | 8/10 [01:45<00:25, 12.75s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9717, 'compress@10': 0.5205, 'time@10': 17.1183}:  90%|█████████ | 9/10 [01:45<00:12, 12.82s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9734, 'compress@10': 0.5134, 'time@10': 17.271}:  90%|█████████ | 9/10 [02:04<00:12, 12.82s/it]    {'epoch': 34, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9734, 'compress@10': 0.5134, 'time@10': 17.271}: 100%|██████████| 10/10 [02:04<00:00, 14.63s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9734, 'compress@10': 0.5134, 'time@10': 17.271}: 100%|██████████| 10/10 [02:04<00:00, 12.43s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.016821939060972128
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9734310779391679
Avg compression ratio: 0.5133634892838662
Avg train time: 17.270952653884887
Std train time: 5.169151711991253
[0.708333333333333, 0.6527777777777777, 0.04166666666666667, 0.5138888888888888, 0.4305555555555556, 0.6805555555555557, 0.09722222222222222, 0.8472222222222222, 0.5972222222222222, 0.4305555555555556]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9644, 'compress@10': 0.7162, 'time@10': 14.8593}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9644, 'compress@10': 0.7162, 'time@10': 14.8593}:  10%|█         | 1/10 [00:07<01:07,  7.47s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9729, 'compress@10': 0.6873, 'time@10': 13.6721}:  10%|█         | 1/10 [00:19<01:07,  7.47s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9729, 'compress@10': 0.6873, 'time@10': 13.6721}:  20%|██        | 2/10 [00:19<01:23, 10.44s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9581, 'compress@10': 0.4949, 'time@10': 12.7208}:  20%|██        | 2/10 [00:25<01:23, 10.44s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9581, 'compress@10': 0.4949, 'time@10': 12.7208}:  30%|███       | 3/10 [00:25<00:57,  8.16s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.964, 'compress@10': 0.5019, 'time@10': 12.3662}:  30%|███       | 3/10 [00:36<00:57,  8.16s/it]  {'epoch': 35, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.964, 'compress@10': 0.5019, 'time@10': 12.3662}:  40%|████      | 4/10 [00:36<00:56,  9.41s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0058, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.968, 'compress@10': 0.4888, 'time@10': 14.9934}:  40%|████      | 4/10 [00:49<00:56,  9.41s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0058, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.968, 'compress@10': 0.4888, 'time@10': 14.9934}:  50%|█████     | 5/10 [00:49<00:53, 10.63s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0055, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9713, 'compress@10': 0.5214, 'time@10': 15.6177}:  50%|█████     | 5/10 [01:08<00:53, 10.63s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0055, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9713, 'compress@10': 0.5214, 'time@10': 15.6177}:  60%|██████    | 6/10 [01:08<00:53, 13.40s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0057, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9725, 'compress@10': 0.4635, 'time@10': 16.2322}:  60%|██████    | 6/10 [01:18<00:53, 13.40s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0057, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9725, 'compress@10': 0.4635, 'time@10': 16.2322}:  70%|███████   | 7/10 [01:18<00:36, 12.29s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0057, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9741, 'compress@10': 0.5117, 'time@10': 15.8223}:  70%|███████   | 7/10 [01:31<00:36, 12.29s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0057, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9741, 'compress@10': 0.5117, 'time@10': 15.8223}:  80%|████████  | 8/10 [01:31<00:25, 12.51s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0063, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.975, 'compress@10': 0.5219, 'time@10': 16.8888}:  80%|████████  | 8/10 [01:44<00:25, 12.51s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0063, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.975, 'compress@10': 0.5219, 'time@10': 16.8888}:  90%|█████████ | 9/10 [01:44<00:12, 12.58s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0061, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9764, 'compress@10': 0.5134, 'time@10': 17.0531}:  90%|█████████ | 9/10 [02:02<00:12, 12.58s/it]  {'epoch': 35, 'num_users': 6.3, 'loss': 0.0061, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9764, 'compress@10': 0.5134, 'time@10': 17.0531}: 100%|██████████| 10/10 [02:02<00:00, 14.43s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0061, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9764, 'compress@10': 0.5134, 'time@10': 17.0531}: 100%|██████████| 10/10 [02:02<00:00, 12.26s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.006096142229501335
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9763640515053618
Avg compression ratio: 0.513384754277335
Avg train time: 17.053111410140993
Std train time: 5.187384073381528
[0.7162162162162159, 0.6351351351351351, 0.04054054054054054, 0.49999999999999994, 0.44594594594594594, 0.6621621621621623, 0.12162162162162163, 0.8513513513513513, 0.6081081081081081, 0.41891891891891897]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9546, 'compress@10': 0.7239, 'time@10': 14.7054}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9546, 'compress@10': 0.7239, 'time@10': 14.7054}:  10%|█         | 1/10 [00:07<01:06,  7.39s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9606, 'compress@10': 0.6825, 'time@10': 13.536}:  10%|█         | 1/10 [00:19<01:06,  7.39s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9606, 'compress@10': 0.6825, 'time@10': 13.536}:  20%|██        | 2/10 [00:19<01:22, 10.34s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9499, 'compress@10': 0.4914, 'time@10': 12.5866}:  20%|██        | 2/10 [00:25<01:22, 10.34s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9499, 'compress@10': 0.4914, 'time@10': 12.5866}:  30%|███       | 3/10 [00:25<00:56,  8.07s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9574, 'compress@10': 0.4958, 'time@10': 12.2842}:  30%|███       | 3/10 [00:36<00:56,  8.07s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9574, 'compress@10': 0.4958, 'time@10': 12.2842}:  40%|████      | 4/10 [00:36<00:56,  9.39s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0131, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9633, 'compress@10': 0.487, 'time@10': 14.8944}:  40%|████      | 4/10 [00:49<00:56,  9.39s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 0.0131, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9633, 'compress@10': 0.487, 'time@10': 14.8944}:  50%|█████     | 5/10 [00:49<00:52, 10.59s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9665, 'compress@10': 0.5168, 'time@10': 15.532}:  50%|█████     | 5/10 [01:08<00:52, 10.59s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9665, 'compress@10': 0.5168, 'time@10': 15.532}:  60%|██████    | 6/10 [01:08<00:53, 13.36s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9692, 'compress@10': 0.463, 'time@10': 16.1801}:  60%|██████    | 6/10 [01:18<00:53, 13.36s/it] {'epoch': 36, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9692, 'compress@10': 0.463, 'time@10': 16.1801}:  70%|███████   | 7/10 [01:18<00:36, 12.29s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9702, 'compress@10': 0.5118, 'time@10': 15.766}:  70%|███████   | 7/10 [01:31<00:36, 12.29s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9702, 'compress@10': 0.5118, 'time@10': 15.766}:  80%|████████  | 8/10 [01:31<00:24, 12.48s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.971, 'compress@10': 0.5231, 'time@10': 16.7756}:  80%|████████  | 8/10 [01:43<00:24, 12.48s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.971, 'compress@10': 0.5231, 'time@10': 16.7756}:  90%|█████████ | 9/10 [01:43<00:12, 12.48s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.973, 'compress@10': 0.5134, 'time@10': 16.9399}:  90%|█████████ | 9/10 [02:01<00:12, 12.48s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.973, 'compress@10': 0.5134, 'time@10': 16.9399}: 100%|██████████| 10/10 [02:01<00:00, 14.32s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.973, 'compress@10': 0.5134, 'time@10': 16.9399}: 100%|██████████| 10/10 [02:01<00:00, 12.19s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.015103995977380876
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9729868886685435
Avg compression ratio: 0.5133706962179232
Avg train time: 16.939889240264893
Std train time: 5.106605434315633
[0.6973684210526313, 0.6447368421052632, 0.03947368421052632, 0.513157894736842, 0.4342105263157895, 0.6710526315789475, 0.11842105263157895, 0.8552631578947368, 0.618421052631579, 0.4078947368421053]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9739, 'compress@10': 0.7055, 'time@10': 15.0061}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9739, 'compress@10': 0.7055, 'time@10': 15.0061}:  10%|█         | 1/10 [00:07<01:07,  7.54s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0058, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9788, 'compress@10': 0.678, 'time@10': 13.642}:  10%|█         | 1/10 [00:19<01:07,  7.54s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0058, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9788, 'compress@10': 0.678, 'time@10': 13.642}:  20%|██        | 2/10 [00:19<01:22, 10.35s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.962, 'compress@10': 0.4881, 'time@10': 12.6906}:  20%|██        | 2/10 [00:25<01:22, 10.35s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.962, 'compress@10': 0.4881, 'time@10': 12.6906}:  30%|███       | 3/10 [00:25<00:56,  8.10s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0037, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9669, 'compress@10': 0.4966, 'time@10': 12.4163}:  30%|███       | 3/10 [00:36<00:56,  8.10s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0037, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9669, 'compress@10': 0.4966, 'time@10': 12.4163}:  40%|████      | 4/10 [00:36<00:56,  9.50s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0046, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9711, 'compress@10': 0.4853, 'time@10': 14.9438}:  40%|████      | 4/10 [00:49<00:56,  9.50s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0046, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9711, 'compress@10': 0.4853, 'time@10': 14.9438}:  50%|█████     | 5/10 [00:49<00:53, 10.60s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0045, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.974, 'compress@10': 0.5168, 'time@10': 15.6247}:  50%|█████     | 5/10 [01:08<00:53, 10.60s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0045, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.974, 'compress@10': 0.5168, 'time@10': 15.6247}:  60%|██████    | 6/10 [01:08<00:53, 13.48s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0047, 'hit_ratio@10': 0.9719, 'ndcg@10': 0.9748, 'compress@10': 0.4625, 'time@10': 16.1106}:  60%|██████    | 6/10 [01:18<00:53, 13.48s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0047, 'hit_ratio@10': 0.9719, 'ndcg@10': 0.9748, 'compress@10': 0.4625, 'time@10': 16.1106}:  70%|███████   | 7/10 [01:18<00:36, 12.20s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0046, 'hit_ratio@10': 0.9736, 'ndcg@10': 0.9761, 'compress@10': 0.5119, 'time@10': 15.6751}:  70%|███████   | 7/10 [01:30<00:36, 12.20s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0046, 'hit_ratio@10': 0.9736, 'ndcg@10': 0.9761, 'compress@10': 0.5119, 'time@10': 15.6751}:  80%|████████  | 8/10 [01:30<00:24, 12.35s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0067, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9769, 'compress@10': 0.5244, 'time@10': 16.7404}:  80%|████████  | 8/10 [01:43<00:24, 12.35s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0067, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9769, 'compress@10': 0.5244, 'time@10': 16.7404}:  90%|█████████ | 9/10 [01:43<00:12, 12.45s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0065, 'hit_ratio@10': 0.9763, 'ndcg@10': 0.978, 'compress@10': 0.5134, 'time@10': 16.9542}:  90%|█████████ | 9/10 [02:02<00:12, 12.45s/it]    {'epoch': 37, 'num_users': 6.3, 'loss': 0.0065, 'hit_ratio@10': 0.9763, 'ndcg@10': 0.978, 'compress@10': 0.5134, 'time@10': 16.9542}: 100%|██████████| 10/10 [02:02<00:00, 14.44s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0065, 'hit_ratio@10': 0.9763, 'ndcg@10': 0.978, 'compress@10': 0.5134, 'time@10': 16.9542}: 100%|██████████| 10/10 [02:02<00:00, 12.23s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.006476752496806949
Avg hit ratio: 0.9762847045457923
Avg ndcg: 0.9780441948295909
Avg compression ratio: 0.5133890896334757
Avg train time: 16.954199504852294
Std train time: 5.080413466476448
[0.7051282051282048, 0.6282051282051282, 0.038461538461538464, 0.49999999999999994, 0.44871794871794873, 0.653846153846154, 0.14102564102564102, 0.8333333333333334, 0.6282051282051282, 0.42307692307692313]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9644, 'compress@10': 0.7131, 'time@10': 15.0183}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9644, 'compress@10': 0.7131, 'time@10': 15.0183}:  10%|█         | 1/10 [00:07<01:07,  7.55s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9645, 'compress@10': 0.6737, 'time@10': 13.9548}:  10%|█         | 1/10 [00:20<01:07,  7.55s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9645, 'compress@10': 0.6737, 'time@10': 13.9548}:  20%|██        | 2/10 [00:20<01:25, 10.71s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9525, 'compress@10': 0.4848, 'time@10': 12.9492}:  20%|██        | 2/10 [00:25<01:25, 10.71s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9525, 'compress@10': 0.4848, 'time@10': 12.9492}:  30%|███       | 3/10 [00:25<00:58,  8.33s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9576, 'compress@10': 0.4909, 'time@10': 12.5367}:  30%|███       | 3/10 [00:37<00:58,  8.33s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9576, 'compress@10': 0.4909, 'time@10': 12.5367}:  40%|████      | 4/10 [00:37<00:57,  9.52s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9637, 'compress@10': 0.4836, 'time@10': 15.022}:  40%|████      | 4/10 [00:49<00:57,  9.52s/it] {'epoch': 38, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9637, 'compress@10': 0.4836, 'time@10': 15.022}:  50%|█████     | 5/10 [00:49<00:53, 10.60s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.968, 'compress@10': 0.5126, 'time@10': 15.6074}:  50%|█████     | 5/10 [01:08<00:53, 10.60s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.968, 'compress@10': 0.5126, 'time@10': 15.6074}:  60%|██████    | 6/10 [01:08<00:53, 13.31s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9696, 'compress@10': 0.4621, 'time@10': 16.1579}:  60%|██████    | 6/10 [01:18<00:53, 13.31s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9696, 'compress@10': 0.4621, 'time@10': 16.1579}:  70%|███████   | 7/10 [01:18<00:36, 12.16s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9698, 'compress@10': 0.5088, 'time@10': 15.9156}:  70%|███████   | 7/10 [01:32<00:36, 12.16s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9698, 'compress@10': 0.5088, 'time@10': 15.9156}:  80%|████████  | 8/10 [01:32<00:25, 12.83s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9753, 'compress@10': 0.5227, 'time@10': 16.9723}:  80%|████████  | 8/10 [01:45<00:25, 12.83s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9753, 'compress@10': 0.5227, 'time@10': 16.9723}:  90%|█████████ | 9/10 [01:45<00:12, 12.80s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9767, 'compress@10': 0.5134, 'time@10': 17.1274}:  90%|█████████ | 9/10 [02:03<00:12, 12.80s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9767, 'compress@10': 0.5134, 'time@10': 17.1274}: 100%|██████████| 10/10 [02:03<00:00, 14.58s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9767, 'compress@10': 0.5134, 'time@10': 17.1274}: 100%|██████████| 10/10 [02:03<00:00, 12.38s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.01447792578027611
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9766946636272973
Avg compression ratio: 0.5133859016593577
Avg train time: 17.127432775497436
Std train time: 4.926951606608907
[0.6874999999999998, 0.6375, 0.037500000000000006, 0.5125, 0.4375, 0.6625000000000001, 0.1375, 0.8375, 0.6375, 0.41250000000000003]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0045, 'hit_ratio@10': 0.973, 'ndcg@10': 0.971, 'compress@10': 0.6959, 'time@10': 14.7719}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0045, 'hit_ratio@10': 0.973, 'ndcg@10': 0.971, 'compress@10': 0.6959, 'time@10': 14.7719}:  10%|█         | 1/10 [00:07<01:06,  7.42s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0032, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9773, 'compress@10': 0.6697, 'time@10': 13.5547}:  10%|█         | 1/10 [00:19<01:06,  7.42s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0032, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9773, 'compress@10': 0.6697, 'time@10': 13.5547}:  20%|██        | 2/10 [00:19<01:22, 10.34s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0025, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9611, 'compress@10': 0.4819, 'time@10': 12.5849}:  20%|██        | 2/10 [00:25<01:22, 10.34s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0025, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9611, 'compress@10': 0.4819, 'time@10': 12.5849}:  30%|███       | 3/10 [00:25<00:56,  8.06s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0023, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9662, 'compress@10': 0.4918, 'time@10': 12.2443}:  30%|███       | 3/10 [00:36<00:56,  8.06s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0023, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9662, 'compress@10': 0.4918, 'time@10': 12.2443}:  40%|████      | 4/10 [00:36<00:55,  9.33s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0038, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9713, 'compress@10': 0.4821, 'time@10': 14.872}:  40%|████      | 4/10 [00:49<00:55,  9.33s/it] {'epoch': 39, 'num_users': 5.8, 'loss': 0.0038, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9713, 'compress@10': 0.4821, 'time@10': 14.872}:  50%|█████     | 5/10 [00:49<00:52, 10.55s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0042, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9742, 'compress@10': 0.5128, 'time@10': 15.5099}:  50%|█████     | 5/10 [01:07<00:52, 10.55s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0042, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9742, 'compress@10': 0.5128, 'time@10': 15.5099}:  60%|██████    | 6/10 [01:07<00:53, 13.33s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0042, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9749, 'compress@10': 0.4617, 'time@10': 16.098}:  60%|██████    | 6/10 [01:17<00:53, 13.33s/it] {'epoch': 39, 'num_users': 6.2857, 'loss': 0.0042, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9749, 'compress@10': 0.4617, 'time@10': 16.098}:  70%|███████   | 7/10 [01:17<00:36, 12.20s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.004, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9762, 'compress@10': 0.509, 'time@10': 15.8143}:  70%|███████   | 7/10 [01:31<00:36, 12.20s/it]  {'epoch': 39, 'num_users': 6.125, 'loss': 0.004, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9762, 'compress@10': 0.509, 'time@10': 15.8143}:  80%|████████  | 8/10 [01:31<00:25, 12.73s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0056, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9775, 'compress@10': 0.5239, 'time@10': 16.8206}:  80%|████████  | 8/10 [01:44<00:25, 12.73s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0056, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9775, 'compress@10': 0.5239, 'time@10': 16.8206}:  90%|█████████ | 9/10 [01:44<00:12, 12.65s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0056, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9786, 'compress@10': 0.5134, 'time@10': 16.9932}:  90%|█████████ | 9/10 [02:02<00:12, 12.65s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0056, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9786, 'compress@10': 0.5134, 'time@10': 16.9932}: 100%|██████████| 10/10 [02:02<00:00, 14.48s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0056, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9786, 'compress@10': 0.5134, 'time@10': 16.9932}: 100%|██████████| 10/10 [02:02<00:00, 12.26s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.0055836611717228505
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9785914061740014
Avg compression ratio: 0.5134013352387493
Avg train time: 16.993178057670594
Std train time: 5.049018699424539
[0.6951219512195119, 0.6219512195121951, 0.03658536585365854, 0.49999999999999994, 0.45121951219512196, 0.6707317073170732, 0.13414634146341464, 0.8170731707317074, 0.646341463414634, 0.426829268292683]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9676, 'compress@10': 0.7034, 'time@10': 14.6865}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9676, 'compress@10': 0.7034, 'time@10': 14.6865}:  10%|█         | 1/10 [00:07<01:06,  7.38s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9679, 'compress@10': 0.6657, 'time@10': 13.6849}:  10%|█         | 1/10 [00:20<01:06,  7.38s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9679, 'compress@10': 0.6657, 'time@10': 13.6849}:  20%|██        | 2/10 [00:20<01:24, 10.52s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.9379, 'ndcg@10': 0.9548, 'compress@10': 0.479, 'time@10': 12.8242}:  20%|██        | 2/10 [00:25<01:24, 10.52s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.9379, 'ndcg@10': 0.9548, 'compress@10': 0.479, 'time@10': 12.8242}:  30%|███       | 3/10 [00:25<00:57,  8.27s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.9488, 'ndcg@10': 0.9597, 'compress@10': 0.4865, 'time@10': 12.4614}:  30%|███       | 3/10 [00:37<00:57,  8.27s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.9488, 'ndcg@10': 0.9597, 'compress@10': 0.4865, 'time@10': 12.4614}:  40%|████      | 4/10 [00:37<00:57,  9.51s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.957, 'ndcg@10': 0.9658, 'compress@10': 0.4806, 'time@10': 14.9246}:  40%|████      | 4/10 [00:49<00:57,  9.51s/it] {'epoch': 40, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.957, 'ndcg@10': 0.9658, 'compress@10': 0.4806, 'time@10': 14.9246}:  50%|█████     | 5/10 [00:49<00:52, 10.56s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.9623, 'ndcg@10': 0.9727, 'compress@10': 0.5129, 'time@10': 15.5753}:  50%|█████     | 5/10 [01:08<00:52, 10.56s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.9623, 'ndcg@10': 0.9727, 'compress@10': 0.5129, 'time@10': 15.5753}:  60%|██████    | 6/10 [01:08<00:53, 13.38s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9738, 'compress@10': 0.4614, 'time@10': 16.1097}:  60%|██████    | 6/10 [01:18<00:53, 13.38s/it] {'epoch': 40, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9738, 'compress@10': 0.4614, 'time@10': 16.1097}:  70%|███████   | 7/10 [01:18<00:36, 12.18s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.9647, 'ndcg@10': 0.973, 'compress@10': 0.5062, 'time@10': 15.8671}:  70%|███████   | 7/10 [01:32<00:36, 12.18s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.9647, 'ndcg@10': 0.973, 'compress@10': 0.5062, 'time@10': 15.8671}:  80%|████████  | 8/10 [01:32<00:25, 12.82s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.967, 'ndcg@10': 0.9744, 'compress@10': 0.5223, 'time@10': 16.8241}:  80%|████████  | 8/10 [01:44<00:25, 12.82s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.967, 'ndcg@10': 0.9744, 'compress@10': 0.5223, 'time@10': 16.8241}:  90%|█████████ | 9/10 [01:44<00:12, 12.65s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9691, 'ndcg@10': 0.9755, 'compress@10': 0.5134, 'time@10': 16.9988}:  90%|█████████ | 9/10 [02:03<00:12, 12.65s/it]  {'epoch': 40, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9691, 'ndcg@10': 0.9755, 'compress@10': 0.5134, 'time@10': 16.9988}: 100%|██████████| 10/10 [02:03<00:00, 14.49s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9691, 'ndcg@10': 0.9755, 'compress@10': 0.5134, 'time@10': 16.9988}: 100%|██████████| 10/10 [02:03<00:00, 12.32s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.013928886595267467
Avg hit ratio: 0.9691418474029352
Avg ndcg: 0.9754544423731508
Avg compression ratio: 0.5134210389982808
Avg train time: 16.99877836704254
Std train time: 4.754549816419406
[0.6785714285714283, 0.6309523809523809, 0.03571428571428572, 0.5119047619047619, 0.44047619047619047, 0.6785714285714286, 0.13095238095238096, 0.8214285714285715, 0.6309523809523808, 0.4404761904761905]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.973, 'ndcg@10': 1.0118, 'compress@10': 0.6873, 'time@10': 15.2185}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.973, 'ndcg@10': 1.0118, 'compress@10': 0.6873, 'time@10': 15.2185}:  10%|█         | 1/10 [00:07<01:08,  7.65s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9977, 'compress@10': 0.6621, 'time@10': 13.885}:  10%|█         | 1/10 [00:20<01:08,  7.65s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9977, 'compress@10': 0.6621, 'time@10': 13.885}:  20%|██        | 2/10 [00:20<01:24, 10.55s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9747, 'compress@10': 0.4763, 'time@10': 12.8796}:  20%|██        | 2/10 [00:25<01:24, 10.55s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9747, 'compress@10': 0.4763, 'time@10': 12.8796}:  30%|███       | 3/10 [00:25<00:57,  8.23s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9764, 'compress@10': 0.4874, 'time@10': 12.5074}:  30%|███       | 3/10 [00:37<00:57,  8.23s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9764, 'compress@10': 0.4874, 'time@10': 12.5074}:  40%|████      | 4/10 [00:37<00:56,  9.49s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0058, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9787, 'compress@10': 0.4792, 'time@10': 15.0996}:  40%|████      | 4/10 [00:49<00:56,  9.49s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0058, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9787, 'compress@10': 0.4792, 'time@10': 15.0996}:  50%|█████     | 5/10 [00:49<00:53, 10.68s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.006, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9806, 'compress@10': 0.513, 'time@10': 15.7326}:  50%|█████     | 5/10 [01:08<00:53, 10.68s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.006, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9806, 'compress@10': 0.513, 'time@10': 15.7326}:  60%|██████    | 6/10 [01:08<00:53, 13.49s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0059, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9804, 'compress@10': 0.461, 'time@10': 16.286}:  60%|██████    | 6/10 [01:18<00:53, 13.49s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0059, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9804, 'compress@10': 0.461, 'time@10': 16.286}:  70%|███████   | 7/10 [01:18<00:36, 12.30s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0055, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9811, 'compress@10': 0.5064, 'time@10': 15.9988}:  70%|███████   | 7/10 [01:32<00:36, 12.30s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0055, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9811, 'compress@10': 0.5064, 'time@10': 15.9988}:  80%|████████  | 8/10 [01:32<00:25, 12.85s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0063, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9824, 'compress@10': 0.5208, 'time@10': 16.9649}:  80%|████████  | 8/10 [01:45<00:25, 12.85s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0063, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9824, 'compress@10': 0.5208, 'time@10': 16.9649}:  90%|█████████ | 9/10 [01:45<00:12, 12.70s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0063, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9833, 'compress@10': 0.5134, 'time@10': 17.132}:  90%|█████████ | 9/10 [02:03<00:12, 12.70s/it]    {'epoch': 41, 'num_users': 6.3, 'loss': 0.0063, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9833, 'compress@10': 0.5134, 'time@10': 17.132}: 100%|██████████| 10/10 [02:03<00:00, 14.54s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0063, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9833, 'compress@10': 0.5134, 'time@10': 17.132}: 100%|██████████| 10/10 [02:03<00:00, 12.38s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.006282200785632382
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9832849925348073
Avg compression ratio: 0.5134453975298051
Avg train time: 17.131978487968446
Std train time: 4.948676912712405
[0.6860465116279066, 0.6162790697674418, 0.034883720930232565, 0.49999999999999994, 0.45348837209302323, 0.686046511627907, 0.12790697674418605, 0.8023255813953489, 0.6395348837209301, 0.4534883720930233]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9422, 'compress@10': 0.6945, 'time@10': 14.7094}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9422, 'compress@10': 0.6945, 'time@10': 14.7094}:  10%|█         | 1/10 [00:07<01:06,  7.39s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9593, 'compress@10': 0.6585, 'time@10': 13.6614}:  10%|█         | 1/10 [00:20<01:06,  7.39s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9593, 'compress@10': 0.6585, 'time@10': 13.6614}:  20%|██        | 2/10 [00:20<01:23, 10.48s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9491, 'compress@10': 0.4736, 'time@10': 12.8142}:  20%|██        | 2/10 [00:25<01:23, 10.48s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9491, 'compress@10': 0.4736, 'time@10': 12.8142}:  30%|███       | 3/10 [00:25<00:57,  8.25s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9557, 'compress@10': 0.4825, 'time@10': 12.4207}:  30%|███       | 3/10 [00:36<00:57,  8.25s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9557, 'compress@10': 0.4825, 'time@10': 12.4207}:  40%|████      | 4/10 [00:36<00:56,  9.45s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0131, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9627, 'compress@10': 0.4778, 'time@10': 14.954}:  40%|████      | 4/10 [00:49<00:56,  9.45s/it] {'epoch': 42, 'num_users': 5.8, 'loss': 0.0131, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9627, 'compress@10': 0.4778, 'time@10': 14.954}:  50%|█████     | 5/10 [00:49<00:52, 10.58s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9662, 'compress@10': 0.5131, 'time@10': 15.557}:  50%|█████     | 5/10 [01:08<00:52, 10.58s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9662, 'compress@10': 0.5131, 'time@10': 15.557}:  60%|██████    | 6/10 [01:08<00:53, 13.36s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.9719, 'ndcg@10': 0.9678, 'compress@10': 0.4607, 'time@10': 16.2549}:  60%|██████    | 6/10 [01:18<00:53, 13.36s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.9719, 'ndcg@10': 0.9678, 'compress@10': 0.4607, 'time@10': 16.2549}:  70%|███████   | 7/10 [01:18<00:37, 12.35s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.9736, 'ndcg@10': 0.9697, 'compress@10': 0.5038, 'time@10': 15.9929}:  70%|███████   | 7/10 [01:32<00:37, 12.35s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.9736, 'ndcg@10': 0.9697, 'compress@10': 0.5038, 'time@10': 15.9929}:  80%|████████  | 8/10 [01:32<00:25, 12.94s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9702, 'compress@10': 0.5194, 'time@10': 17.0189}:  80%|████████  | 8/10 [01:45<00:25, 12.94s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9702, 'compress@10': 0.5194, 'time@10': 17.0189}:  90%|█████████ | 9/10 [01:45<00:12, 12.85s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9763, 'ndcg@10': 0.9717, 'compress@10': 0.5135, 'time@10': 17.1985}:  90%|█████████ | 9/10 [02:04<00:12, 12.85s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9763, 'ndcg@10': 0.9717, 'compress@10': 0.5135, 'time@10': 17.1985}: 100%|██████████| 10/10 [02:04<00:00, 14.70s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9763, 'ndcg@10': 0.9717, 'compress@10': 0.5135, 'time@10': 17.1985}: 100%|██████████| 10/10 [02:04<00:00, 12.42s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.017222144592026985
Avg hit ratio: 0.9762847045457923
Avg ndcg: 0.971720304671237
Avg compression ratio: 0.51346128777614
Avg train time: 17.198515009880065
Std train time: 5.006229854163885
[0.6931818181818179, 0.625, 0.034090909090909095, 0.4886363636363636, 0.4431818181818182, 0.6931818181818182, 0.125, 0.8068181818181819, 0.6477272727272726, 0.44318181818181823]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9644, 'compress@10': 0.7015, 'time@10': 14.7357}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9644, 'compress@10': 0.7015, 'time@10': 14.7357}:  10%|█         | 1/10 [00:07<01:06,  7.42s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0052, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.974, 'compress@10': 0.6663, 'time@10': 13.7295}:  10%|█         | 1/10 [00:20<01:06,  7.42s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0052, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.974, 'compress@10': 0.6663, 'time@10': 13.7295}:  20%|██        | 2/10 [00:20<01:24, 10.56s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0037, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9589, 'compress@10': 0.4786, 'time@10': 12.6371}:  20%|██        | 2/10 [00:25<01:24, 10.56s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0037, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9589, 'compress@10': 0.4786, 'time@10': 12.6371}:  30%|███       | 3/10 [00:25<00:56,  8.14s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0029, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9645, 'compress@10': 0.4835, 'time@10': 12.3678}:  30%|███       | 3/10 [00:37<00:56,  8.14s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0029, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9645, 'compress@10': 0.4835, 'time@10': 12.3678}:  40%|████      | 4/10 [00:37<00:57,  9.51s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0045, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9705, 'compress@10': 0.4765, 'time@10': 15.003}:  40%|████      | 4/10 [00:49<00:57,  9.51s/it] {'epoch': 43, 'num_users': 5.8, 'loss': 0.0045, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9705, 'compress@10': 0.4765, 'time@10': 15.003}:  50%|█████     | 5/10 [00:49<00:53, 10.70s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0047, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9736, 'compress@10': 0.5132, 'time@10': 15.6019}:  50%|█████     | 5/10 [01:08<00:53, 10.70s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0047, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9736, 'compress@10': 0.5132, 'time@10': 15.6019}:  60%|██████    | 6/10 [01:08<00:53, 13.40s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0049, 'hit_ratio@10': 0.9719, 'ndcg@10': 0.9744, 'compress@10': 0.4604, 'time@10': 16.1602}:  60%|██████    | 6/10 [01:18<00:53, 13.40s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0049, 'hit_ratio@10': 0.9719, 'ndcg@10': 0.9744, 'compress@10': 0.4604, 'time@10': 16.1602}:  70%|███████   | 7/10 [01:18<00:36, 12.22s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0045, 'hit_ratio@10': 0.9736, 'ndcg@10': 0.9758, 'compress@10': 0.504, 'time@10': 15.9141}:  70%|███████   | 7/10 [01:32<00:36, 12.22s/it]  {'epoch': 43, 'num_users': 6.125, 'loss': 0.0045, 'hit_ratio@10': 0.9736, 'ndcg@10': 0.9758, 'compress@10': 0.504, 'time@10': 15.9141}:  80%|████████  | 8/10 [01:32<00:25, 12.86s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0047, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9768, 'compress@10': 0.5206, 'time@10': 16.9427}:  80%|████████  | 8/10 [01:45<00:25, 12.86s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0047, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9768, 'compress@10': 0.5206, 'time@10': 16.9427}:  90%|█████████ | 9/10 [01:45<00:12, 12.78s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0048, 'hit_ratio@10': 0.9763, 'ndcg@10': 0.9779, 'compress@10': 0.5135, 'time@10': 17.1365}:  90%|█████████ | 9/10 [02:04<00:12, 12.78s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0048, 'hit_ratio@10': 0.9763, 'ndcg@10': 0.9779, 'compress@10': 0.5135, 'time@10': 17.1365}: 100%|██████████| 10/10 [02:04<00:00, 14.68s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0048, 'hit_ratio@10': 0.9763, 'ndcg@10': 0.9779, 'compress@10': 0.5135, 'time@10': 17.1365}: 100%|██████████| 10/10 [02:04<00:00, 12.41s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.004766250227413314
Avg hit ratio: 0.9762847045457923
Avg ndcg: 0.9779228443152931
Avg compression ratio: 0.5134547178712472
Avg train time: 17.136520266532898
Std train time: 5.0571425158286605
[0.6999999999999997, 0.6111111111111112, 0.03333333333333334, 0.47777777777777775, 0.45555555555555555, 0.7000000000000001, 0.14444444444444443, 0.788888888888889, 0.6333333333333332, 0.4555555555555556]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9747, 'compress@10': 0.7081, 'time@10': 15.1217}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9747, 'compress@10': 0.7081, 'time@10': 15.1217}:  10%|█         | 1/10 [00:07<01:08,  7.60s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9714, 'compress@10': 0.6628, 'time@10': 13.9315}:  10%|█         | 1/10 [00:20<01:08,  7.60s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9714, 'compress@10': 0.6628, 'time@10': 13.9315}:  20%|██        | 2/10 [00:20<01:25, 10.65s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9571, 'compress@10': 0.476, 'time@10': 12.8353}:  20%|██        | 2/10 [00:25<01:25, 10.65s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9571, 'compress@10': 0.476, 'time@10': 12.8353}:  30%|███       | 3/10 [00:25<00:57,  8.23s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9603, 'compress@10': 0.4789, 'time@10': 12.4806}:  30%|███       | 3/10 [00:37<00:57,  8.23s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9603, 'compress@10': 0.4789, 'time@10': 12.4806}:  40%|████      | 4/10 [00:37<00:57,  9.50s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9659, 'compress@10': 0.4753, 'time@10': 14.9816}:  40%|████      | 4/10 [00:49<00:57,  9.50s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9659, 'compress@10': 0.4753, 'time@10': 14.9816}:  50%|█████     | 5/10 [00:49<00:52, 10.59s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9731, 'compress@10': 0.5133, 'time@10': 15.6132}:  50%|█████     | 5/10 [01:08<00:52, 10.59s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9731, 'compress@10': 0.5133, 'time@10': 15.6132}:  60%|██████    | 6/10 [01:08<00:53, 13.39s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.974, 'compress@10': 0.4632, 'time@10': 16.1986}:  60%|██████    | 6/10 [01:18<00:53, 13.39s/it] {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.974, 'compress@10': 0.4632, 'time@10': 16.1986}:  70%|███████   | 7/10 [01:18<00:36, 12.24s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.975, 'compress@10': 0.5043, 'time@10': 15.961}:  70%|███████   | 7/10 [01:32<00:36, 12.24s/it]  {'epoch': 44, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.975, 'compress@10': 0.5043, 'time@10': 15.961}:  80%|████████  | 8/10 [01:32<00:25, 12.91s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9761, 'compress@10': 0.5192, 'time@10': 16.9333}:  80%|████████  | 8/10 [01:45<00:25, 12.91s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9761, 'compress@10': 0.5192, 'time@10': 16.9333}:  90%|█████████ | 9/10 [01:45<00:12, 12.75s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9783, 'compress@10': 0.5135, 'time@10': 17.0835}:  90%|█████████ | 9/10 [02:03<00:12, 12.75s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9783, 'compress@10': 0.5135, 'time@10': 17.0835}: 100%|██████████| 10/10 [02:03<00:00, 14.51s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9783, 'compress@10': 0.5135, 'time@10': 17.0835}: 100%|██████████| 10/10 [02:03<00:00, 12.36s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.013058404379630118
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9783242292131472
Avg compression ratio: 0.5134581525549536
Avg train time: 17.083460927009583
Std train time: 4.860783480845746
[0.6847826086956519, 0.6195652173913044, 0.03260869565217392, 0.48913043478260865, 0.44565217391304346, 0.7065217391304348, 0.14130434782608695, 0.7934782608695653, 0.6195652173913042, 0.4673913043478261]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.973, 'ndcg@10': 0.973, 'compress@10': 0.6933, 'time@10': 15.0803}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.973, 'ndcg@10': 0.973, 'compress@10': 0.6933, 'time@10': 15.0803}:  10%|█         | 1/10 [00:07<01:08,  7.58s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0041, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9783, 'compress@10': 0.6595, 'time@10': 13.8808}:  10%|█         | 1/10 [00:20<01:08,  7.58s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0041, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9783, 'compress@10': 0.6595, 'time@10': 13.8808}:  20%|██        | 2/10 [00:20<01:24, 10.60s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0029, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9617, 'compress@10': 0.4736, 'time@10': 12.8697}:  20%|██        | 2/10 [00:25<01:24, 10.60s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0029, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9617, 'compress@10': 0.4736, 'time@10': 12.8697}:  30%|███       | 3/10 [00:25<00:57,  8.25s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0025, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9667, 'compress@10': 0.4799, 'time@10': 12.486}:  30%|███       | 3/10 [00:37<00:57,  8.25s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.0025, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9667, 'compress@10': 0.4799, 'time@10': 12.486}:  40%|████      | 4/10 [00:37<00:56,  9.48s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0035, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9714, 'compress@10': 0.4741, 'time@10': 15.1277}:  40%|████      | 4/10 [00:50<00:56,  9.48s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0035, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9714, 'compress@10': 0.4741, 'time@10': 15.1277}:  50%|█████     | 5/10 [00:50<00:53, 10.71s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0038, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9743, 'compress@10': 0.5134, 'time@10': 15.7416}:  50%|█████     | 5/10 [01:08<00:53, 10.71s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0038, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9743, 'compress@10': 0.5134, 'time@10': 15.7416}:  60%|██████    | 6/10 [01:08<00:53, 13.48s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0041, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.975, 'compress@10': 0.4628, 'time@10': 16.3417}:  60%|██████    | 6/10 [01:18<00:53, 13.48s/it] {'epoch': 45, 'num_users': 6.2857, 'loss': 0.0041, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.975, 'compress@10': 0.4628, 'time@10': 16.3417}:  70%|███████   | 7/10 [01:18<00:37, 12.34s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0037, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9763, 'compress@10': 0.5045, 'time@10': 16.0418}:  70%|███████   | 7/10 [01:32<00:37, 12.34s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0037, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9763, 'compress@10': 0.5045, 'time@10': 16.0418}:  80%|████████  | 8/10 [01:32<00:25, 12.86s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.006, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9837, 'compress@10': 0.5179, 'time@10': 17.0138}:  80%|████████  | 8/10 [01:45<00:25, 12.86s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.006, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9837, 'compress@10': 0.5179, 'time@10': 17.0138}:  90%|█████████ | 9/10 [01:45<00:12, 12.73s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0061, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9846, 'compress@10': 0.5135, 'time@10': 17.1816}:  90%|█████████ | 9/10 [02:04<00:12, 12.73s/it]  {'epoch': 45, 'num_users': 6.3, 'loss': 0.0061, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9846, 'compress@10': 0.5135, 'time@10': 17.1816}: 100%|██████████| 10/10 [02:04<00:00, 14.58s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0061, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9846, 'compress@10': 0.5135, 'time@10': 17.1816}: 100%|██████████| 10/10 [02:04<00:00, 12.40s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.006094298004732808
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9846111143146636
Avg compression ratio: 0.5134816196321006
Avg train time: 17.181554651260377
Std train time: 5.02370316390821
[0.6914893617021274, 0.6063829787234043, 0.03191489361702128, 0.4787234042553191, 0.4574468085106383, 0.7127659574468085, 0.1382978723404255, 0.7765957446808511, 0.627659574468085, 0.4787234042553192]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9542, 'compress@10': 0.6998, 'time@10': 14.6118}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9542, 'compress@10': 0.6998, 'time@10': 14.6118}:  10%|█         | 1/10 [00:07<01:06,  7.34s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.962, 'compress@10': 0.6563, 'time@10': 13.6055}:  10%|█         | 1/10 [00:19<01:06,  7.34s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.962, 'compress@10': 0.6563, 'time@10': 13.6055}:  20%|██        | 2/10 [00:19<01:23, 10.46s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.9379, 'ndcg@10': 0.9509, 'compress@10': 0.4712, 'time@10': 12.5836}:  20%|██        | 2/10 [00:25<01:23, 10.46s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.9379, 'ndcg@10': 0.9509, 'compress@10': 0.4712, 'time@10': 12.5836}:  30%|███       | 3/10 [00:25<00:56,  8.10s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.9488, 'ndcg@10': 0.9589, 'compress@10': 0.4755, 'time@10': 12.2718}:  30%|███       | 3/10 [00:36<00:56,  8.10s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.9488, 'ndcg@10': 0.9589, 'compress@10': 0.4755, 'time@10': 12.2718}:  40%|████      | 4/10 [00:36<00:56,  9.40s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.957, 'ndcg@10': 0.9641, 'compress@10': 0.473, 'time@10': 14.9426}:  40%|████      | 4/10 [00:49<00:56,  9.40s/it]  {'epoch': 46, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.957, 'ndcg@10': 0.9641, 'compress@10': 0.473, 'time@10': 14.9426}:  50%|█████     | 5/10 [00:49<00:53, 10.64s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.9623, 'ndcg@10': 0.9715, 'compress@10': 0.5135, 'time@10': 15.5682}:  50%|█████     | 5/10 [01:08<00:53, 10.64s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.9623, 'ndcg@10': 0.9715, 'compress@10': 0.5135, 'time@10': 15.5682}:  60%|██████    | 6/10 [01:08<00:53, 13.39s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.9647, 'ndcg@10': 0.9744, 'compress@10': 0.4625, 'time@10': 16.1244}:  60%|██████    | 6/10 [01:18<00:53, 13.39s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.9647, 'ndcg@10': 0.9744, 'compress@10': 0.4625, 'time@10': 16.1244}:  70%|███████   | 7/10 [01:18<00:36, 12.21s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.9673, 'ndcg@10': 0.9744, 'compress@10': 0.5021, 'time@10': 15.8863}:  70%|███████   | 7/10 [01:32<00:36, 12.21s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.9673, 'ndcg@10': 0.9744, 'compress@10': 0.5021, 'time@10': 15.8863}:  80%|████████  | 8/10 [01:32<00:25, 12.86s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9756, 'compress@10': 0.5167, 'time@10': 16.9232}:  80%|████████  | 8/10 [01:44<00:25, 12.86s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.9756, 'compress@10': 0.5167, 'time@10': 16.9232}:  90%|█████████ | 9/10 [01:44<00:12, 12.79s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.9712, 'ndcg@10': 0.9757, 'compress@10': 0.5135, 'time@10': 17.0894}:  90%|█████████ | 9/10 [02:03<00:12, 12.79s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.9712, 'ndcg@10': 0.9757, 'compress@10': 0.5135, 'time@10': 17.0894}: 100%|██████████| 10/10 [02:03<00:00, 14.59s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.9712, 'ndcg@10': 0.9757, 'compress@10': 0.5135, 'time@10': 17.0894}: 100%|██████████| 10/10 [02:03<00:00, 12.35s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.014266016683491733
Avg hit ratio: 0.9712251807362684
Avg ndcg: 0.9757377197401575
Avg compression ratio: 0.513495401296328
Avg train time: 17.089360332489015
Std train time: 5.098226587730362
[0.677083333333333, 0.6145833333333334, 0.03125000000000001, 0.4895833333333333, 0.4479166666666667, 0.71875, 0.13541666666666666, 0.7812500000000001, 0.6145833333333331, 0.48958333333333337]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9747, 'compress@10': 0.6858, 'time@10': 15.0073}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.973, 'ndcg@10': 0.9747, 'compress@10': 0.6858, 'time@10': 15.0073}:  10%|█         | 1/10 [00:07<01:07,  7.54s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0036, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9791, 'compress@10': 0.6533, 'time@10': 14.0058}:  10%|█         | 1/10 [00:20<01:07,  7.54s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0036, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9791, 'compress@10': 0.6533, 'time@10': 14.0058}:  20%|██        | 2/10 [00:20<01:26, 10.78s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0025, 'hit_ratio@10': 0.9379, 'ndcg@10': 0.9623, 'compress@10': 0.469, 'time@10': 13.0833}:  20%|██        | 2/10 [00:26<01:26, 10.78s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0025, 'hit_ratio@10': 0.9379, 'ndcg@10': 0.9623, 'compress@10': 0.469, 'time@10': 13.0833}:  30%|███       | 3/10 [00:26<00:59,  8.44s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.002, 'hit_ratio@10': 0.9488, 'ndcg@10': 0.9671, 'compress@10': 0.4765, 'time@10': 12.6572}:  30%|███       | 3/10 [00:37<00:59,  8.44s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.002, 'hit_ratio@10': 0.9488, 'ndcg@10': 0.9671, 'compress@10': 0.4765, 'time@10': 12.6572}:  40%|████      | 4/10 [00:37<00:57,  9.61s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0031, 'hit_ratio@10': 0.957, 'ndcg@10': 0.9711, 'compress@10': 0.4719, 'time@10': 15.1873}:  40%|████      | 4/10 [00:50<00:57,  9.61s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0031, 'hit_ratio@10': 0.957, 'ndcg@10': 0.9711, 'compress@10': 0.4719, 'time@10': 15.1873}:  50%|█████     | 5/10 [00:50<00:53, 10.72s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0041, 'hit_ratio@10': 0.9623, 'ndcg@10': 0.9742, 'compress@10': 0.5136, 'time@10': 15.7776}:  50%|█████     | 5/10 [01:09<00:53, 10.72s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0041, 'hit_ratio@10': 0.9623, 'ndcg@10': 0.9742, 'compress@10': 0.5136, 'time@10': 15.7776}:  60%|██████    | 6/10 [01:09<00:53, 13.46s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0052, 'hit_ratio@10': 0.9647, 'ndcg@10': 0.9744, 'compress@10': 0.4621, 'time@10': 16.3368}:  60%|██████    | 6/10 [01:18<00:53, 13.46s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0052, 'hit_ratio@10': 0.9647, 'ndcg@10': 0.9744, 'compress@10': 0.4621, 'time@10': 16.3368}:  70%|███████   | 7/10 [01:18<00:36, 12.29s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0047, 'hit_ratio@10': 0.9673, 'ndcg@10': 0.9758, 'compress@10': 0.5024, 'time@10': 16.0493}:  70%|███████   | 7/10 [01:33<00:36, 12.29s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0047, 'hit_ratio@10': 0.9673, 'ndcg@10': 0.9758, 'compress@10': 0.5024, 'time@10': 16.0493}:  80%|████████  | 8/10 [01:33<00:25, 12.86s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0067, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.977, 'compress@10': 0.5155, 'time@10': 17.0804}:  80%|████████  | 8/10 [01:45<00:25, 12.86s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0067, 'hit_ratio@10': 0.9693, 'ndcg@10': 0.977, 'compress@10': 0.5155, 'time@10': 17.0804}:  90%|█████████ | 9/10 [01:45<00:12, 12.81s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0069, 'hit_ratio@10': 0.9712, 'ndcg@10': 0.9775, 'compress@10': 0.5135, 'time@10': 17.2356}:  90%|█████████ | 9/10 [02:04<00:12, 12.81s/it]  {'epoch': 47, 'num_users': 6.3, 'loss': 0.0069, 'hit_ratio@10': 0.9712, 'ndcg@10': 0.9775, 'compress@10': 0.5135, 'time@10': 17.2356}: 100%|██████████| 10/10 [02:04<00:00, 14.62s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0069, 'hit_ratio@10': 0.9712, 'ndcg@10': 0.9775, 'compress@10': 0.5135, 'time@10': 17.2356}: 100%|██████████| 10/10 [02:04<00:00, 12.44s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.0069440171483364024
Avg hit ratio: 0.9712251807362684
Avg ndcg: 0.977466635870474
Avg compression ratio: 0.5135140493784676
Avg train time: 17.235574412345887
Std train time: 4.942197181074989
[0.6632653061224487, 0.6020408163265306, 0.03061224489795919, 0.47959183673469385, 0.45918367346938777, 0.7244897959183674, 0.15306122448979592, 0.7653061224489797, 0.6224489795918365, 0.5]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.004, 'hit_ratio@10': 0.973, 'ndcg@10': 0.973, 'compress@10': 0.6724, 'time@10': 15.2137}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.004, 'hit_ratio@10': 0.973, 'ndcg@10': 0.973, 'compress@10': 0.6724, 'time@10': 15.2137}:  10%|█         | 1/10 [00:07<01:08,  7.64s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.975, 'compress@10': 0.6405, 'time@10': 13.9596}:  10%|█         | 1/10 [00:20<01:08,  7.64s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.975, 'compress@10': 0.6405, 'time@10': 13.9596}:  20%|██        | 2/10 [00:20<01:25, 10.64s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9595, 'compress@10': 0.4603, 'time@10': 12.9647}:  20%|██        | 2/10 [00:25<01:25, 10.64s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9595, 'compress@10': 0.4603, 'time@10': 12.9647}:  30%|███       | 3/10 [00:25<00:58,  8.31s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9648, 'compress@10': 0.4675, 'time@10': 12.5041}:  30%|███       | 3/10 [00:37<00:58,  8.31s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9648, 'compress@10': 0.4675, 'time@10': 12.5041}:  40%|████      | 4/10 [00:37<00:56,  9.43s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9698, 'compress@10': 0.4669, 'time@10': 15.0721}:  40%|████      | 4/10 [00:49<00:56,  9.43s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9698, 'compress@10': 0.4669, 'time@10': 15.0721}:  50%|█████     | 5/10 [00:49<00:53, 10.61s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9778, 'compress@10': 0.5104, 'time@10': 15.6814}:  50%|█████     | 5/10 [01:08<00:53, 10.61s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9778, 'compress@10': 0.5104, 'time@10': 15.6814}:  60%|██████    | 6/10 [01:08<00:53, 13.39s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9814, 'compress@10': 0.4618, 'time@10': 16.254}:  60%|██████    | 6/10 [01:18<00:53, 13.39s/it] {'epoch': 48, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9814, 'compress@10': 0.4618, 'time@10': 16.254}:  70%|███████   | 7/10 [01:18<00:36, 12.24s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9843, 'compress@10': 0.5002, 'time@10': 15.9787}:  70%|███████   | 7/10 [01:32<00:36, 12.24s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9843, 'compress@10': 0.5002, 'time@10': 15.9787}:  80%|████████  | 8/10 [01:32<00:25, 12.83s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9844, 'compress@10': 0.5144, 'time@10': 17.0461}:  80%|████████  | 8/10 [01:45<00:25, 12.83s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.9844, 'compress@10': 0.5144, 'time@10': 17.0461}:  90%|█████████ | 9/10 [01:45<00:12, 12.84s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.985, 'compress@10': 0.5135, 'time@10': 17.2132}:  90%|█████████ | 9/10 [02:04<00:12, 12.84s/it]    {'epoch': 48, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.985, 'compress@10': 0.5135, 'time@10': 17.2132}: 100%|██████████| 10/10 [02:04<00:00, 14.67s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.985, 'compress@10': 0.5135, 'time@10': 17.2132}: 100%|██████████| 10/10 [02:04<00:00, 12.41s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.011463175585819494
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9850432303712928
Avg compression ratio: 0.5135398389300775
Avg train time: 17.213156962394713
Std train time: 5.071626113772757
[0.6499999999999997, 0.61, 0.030000000000000006, 0.49, 0.45, 0.73, 0.17, 0.77, 0.6099999999999998, 0.49]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0023, 'hit_ratio@10': 0.973, 'ndcg@10': 0.973, 'compress@10': 0.6595, 'time@10': 15.229}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0023, 'hit_ratio@10': 0.973, 'ndcg@10': 0.973, 'compress@10': 0.6595, 'time@10': 15.229}:  10%|█         | 1/10 [00:07<01:08,  7.65s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0017, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9783, 'compress@10': 0.6379, 'time@10': 13.8288}:  10%|█         | 1/10 [00:20<01:08,  7.65s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0017, 'hit_ratio@10': 0.9783, 'ndcg@10': 0.9783, 'compress@10': 0.6379, 'time@10': 13.8288}:  20%|██        | 2/10 [00:20<01:23, 10.48s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0012, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9617, 'compress@10': 0.4584, 'time@10': 12.9049}:  20%|██        | 2/10 [00:25<01:23, 10.48s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0012, 'hit_ratio@10': 0.9617, 'ndcg@10': 0.9617, 'compress@10': 0.4584, 'time@10': 12.9049}:  30%|███       | 3/10 [00:25<00:57,  8.24s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0018, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9667, 'compress@10': 0.4686, 'time@10': 12.5153}:  30%|███       | 3/10 [00:37<00:57,  8.24s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0018, 'hit_ratio@10': 0.9667, 'ndcg@10': 0.9667, 'compress@10': 0.4686, 'time@10': 12.5153}:  40%|████      | 4/10 [00:37<00:56,  9.48s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0024, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9713, 'compress@10': 0.466, 'time@10': 15.1057}:  40%|████      | 4/10 [00:49<00:56,  9.48s/it] {'epoch': 49, 'num_users': 5.8, 'loss': 0.0024, 'hit_ratio@10': 0.9713, 'ndcg@10': 0.9713, 'compress@10': 0.466, 'time@10': 15.1057}:  50%|█████     | 5/10 [00:49<00:53, 10.67s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0056, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9798, 'compress@10': 0.5105, 'time@10': 15.7713}:  50%|█████     | 5/10 [01:08<00:53, 10.67s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0056, 'hit_ratio@10': 0.9742, 'ndcg@10': 0.9798, 'compress@10': 0.5105, 'time@10': 15.7713}:  60%|██████    | 6/10 [01:08<00:54, 13.55s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0062, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9806, 'compress@10': 0.4643, 'time@10': 16.3476}:  60%|██████    | 6/10 [01:18<00:54, 13.55s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0062, 'hit_ratio@10': 0.9749, 'ndcg@10': 0.9806, 'compress@10': 0.4643, 'time@10': 16.3476}:  70%|███████   | 7/10 [01:18<00:37, 12.37s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0059, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9812, 'compress@10': 0.503, 'time@10': 16.0541}:  70%|███████   | 7/10 [01:32<00:37, 12.37s/it]  {'epoch': 49, 'num_users': 6.125, 'loss': 0.0059, 'hit_ratio@10': 0.9762, 'ndcg@10': 0.9812, 'compress@10': 0.503, 'time@10': 16.0541}:  80%|████████  | 8/10 [01:32<00:25, 12.90s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0075, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.99, 'compress@10': 0.5155, 'time@10': 17.1156}:  80%|████████  | 8/10 [01:45<00:25, 12.90s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0075, 'hit_ratio@10': 0.9772, 'ndcg@10': 0.99, 'compress@10': 0.5155, 'time@10': 17.1156}:  90%|█████████ | 9/10 [01:45<00:12, 12.88s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9938, 'compress@10': 0.5135, 'time@10': 17.2599}:  90%|█████████ | 9/10 [02:04<00:12, 12.88s/it] {'epoch': 49, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9938, 'compress@10': 0.5135, 'time@10': 17.2599}: 100%|██████████| 10/10 [02:04<00:00, 14.64s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9784, 'ndcg@10': 0.9938, 'compress@10': 0.5135, 'time@10': 17.2599}: 100%|██████████| 10/10 [02:04<00:00, 12.44s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.009247078824223872
Avg hit ratio: 0.9783680378791255
Avg ndcg: 0.9938355830398018
Avg compression ratio: 0.5135372506217345
Avg train time: 17.259906077384947
Std train time: 5.100287944380117
[0.637254901960784, 0.5980392156862745, 0.02941176470588236, 0.4803921568627451, 0.4607843137254902, 0.7352941176470588, 0.18627450980392157, 0.7549019607843137, 0.6176470588235292, 0.5]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
