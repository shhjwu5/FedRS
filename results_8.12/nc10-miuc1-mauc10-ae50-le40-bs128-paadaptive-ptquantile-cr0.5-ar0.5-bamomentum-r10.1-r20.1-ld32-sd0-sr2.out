  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0423, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.856, 'compress@10': 0.5263, 'time@10': 35.4096}:   0%|          | 0/10 [00:17<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0423, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.856, 'compress@10': 0.5263, 'time@10': 35.4096}:  10%|█         | 1/10 [00:17<02:39, 17.75s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0396, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8697, 'compress@10': 0.5212, 'time@10': 31.9015}:  10%|█         | 1/10 [00:46<02:39, 17.75s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0396, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8697, 'compress@10': 0.5212, 'time@10': 31.9015}:  20%|██        | 2/10 [00:46<03:12, 24.03s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8383, 'compress@10': 0.538, 'time@10': 25.0317}:  20%|██        | 2/10 [00:51<03:12, 24.03s/it]  {'epoch': 0, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8383, 'compress@10': 0.538, 'time@10': 25.0317}:  30%|███       | 3/10 [00:51<01:49, 15.65s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.7901, 'ndcg@10': 0.8449, 'compress@10': 0.5329, 'time@10': 25.1565}:  30%|███       | 3/10 [01:17<01:49, 15.65s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.7901, 'ndcg@10': 0.8449, 'compress@10': 0.5329, 'time@10': 25.1565}:  40%|████      | 4/10 [01:17<01:57, 19.57s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.0332, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.8437, 'compress@10': 0.5283, 'time@10': 39.1305}:  40%|████      | 4/10 [02:04<01:57, 19.57s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.0332, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.8437, 'compress@10': 0.5283, 'time@10': 39.1305}:  50%|█████     | 5/10 [02:04<02:28, 29.66s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.0346, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.846, 'compress@10': 0.5255, 'time@10': 39.7385}:  50%|█████     | 5/10 [02:47<02:28, 29.66s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.0346, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.846, 'compress@10': 0.5255, 'time@10': 39.7385}:  60%|██████    | 6/10 [02:47<02:16, 34.14s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8522, 'compress@10': 0.5247, 'time@10': 40.7033}:  60%|██████    | 6/10 [03:11<02:16, 34.14s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8522, 'compress@10': 0.5247, 'time@10': 40.7033}:  70%|███████   | 7/10 [03:11<01:31, 30.59s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.0332, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8565, 'compress@10': 0.5234, 'time@10': 39.6691}:  70%|███████   | 7/10 [03:43<01:31, 30.59s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.0332, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8565, 'compress@10': 0.5234, 'time@10': 39.6691}:  80%|████████  | 8/10 [03:43<01:02, 31.20s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.0323, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8636, 'compress@10': 0.5224, 'time@10': 42.577}:  80%|████████  | 8/10 [04:16<01:02, 31.20s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.0323, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8636, 'compress@10': 0.5224, 'time@10': 42.577}:  90%|█████████ | 9/10 [04:16<00:31, 31.75s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8681, 'compress@10': 0.5213, 'time@10': 42.4249}:  90%|█████████ | 9/10 [04:57<00:31, 31.75s/it]  {'epoch': 0, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8681, 'compress@10': 0.5213, 'time@10': 42.4249}: 100%|██████████| 10/10 [04:57<00:00, 34.63s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8681, 'compress@10': 0.5213, 'time@10': 42.4249}: 100%|██████████| 10/10 [04:57<00:00, 29.76s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.031192439508867097
Avg hit ratio: 0.8481018626723211
Avg ndcg: 0.8680857566315758
Avg compression ratio: 0.5212749006657823
Avg train time: 42.42492618560791
Std train time: 22.213624163983337
[0.75, 0.75, 0.25, 0.75, 0.75, 0.75, 0.25, 0.25, 0.25, 0.25]
[40, 40, 41, 40, 39, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.866, 'compress@10': 0.7632, 'time@10': 33.9168}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.866, 'compress@10': 0.7632, 'time@10': 33.9168}:  10%|█         | 1/10 [00:16<02:32, 16.99s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0348, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8774, 'compress@10': 0.7606, 'time@10': 31.33}:  10%|█         | 1/10 [00:45<02:32, 16.99s/it] {'epoch': 1, 'num_users': 7.0, 'loss': 0.0348, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8774, 'compress@10': 0.7606, 'time@10': 31.33}:  20%|██        | 2/10 [00:45<03:11, 23.93s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8707, 'compress@10': 0.6261, 'time@10': 24.7756}:  20%|██        | 2/10 [00:51<03:11, 23.93s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8707, 'compress@10': 0.6261, 'time@10': 24.7756}:  30%|███       | 3/10 [00:51<01:49, 15.68s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0226, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.884, 'compress@10': 0.6593, 'time@10': 24.8025}:  30%|███       | 3/10 [01:16<01:49, 15.68s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.0226, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.884, 'compress@10': 0.6593, 'time@10': 24.8025}:  40%|████      | 4/10 [01:16<01:55, 19.33s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0229, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8886, 'compress@10': 0.6785, 'time@10': 37.9312}:  40%|████      | 4/10 [02:01<01:55, 19.33s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0229, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8886, 'compress@10': 0.6785, 'time@10': 37.9312}:  50%|█████     | 5/10 [02:01<02:23, 28.68s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0229, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.8921, 'compress@10': 0.6913, 'time@10': 38.5616}:  50%|█████     | 5/10 [02:43<02:23, 28.68s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0229, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.8921, 'compress@10': 0.6913, 'time@10': 38.5616}:  60%|██████    | 6/10 [02:43<02:12, 33.12s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0229, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.8947, 'compress@10': 0.6325, 'time@10': 39.4144}:  60%|██████    | 6/10 [03:05<02:12, 33.12s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0229, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.8947, 'compress@10': 0.6325, 'time@10': 39.4144}:  70%|███████   | 7/10 [03:05<01:28, 29.59s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0216, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.8973, 'compress@10': 0.5874, 'time@10': 38.3625}:  70%|███████   | 7/10 [03:36<01:28, 29.59s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0216, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.8973, 'compress@10': 0.5874, 'time@10': 38.3625}:  80%|████████  | 8/10 [03:36<01:00, 30.05s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0211, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9029, 'compress@10': 0.5523, 'time@10': 41.103}:  80%|████████  | 8/10 [04:08<01:00, 30.05s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0211, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9029, 'compress@10': 0.5523, 'time@10': 41.103}:  90%|█████████ | 9/10 [04:08<00:30, 30.52s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.908, 'compress@10': 0.5238, 'time@10': 41.0812}:  90%|█████████ | 9/10 [04:49<00:30, 30.52s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.908, 'compress@10': 0.5238, 'time@10': 41.0812}: 100%|██████████| 10/10 [04:49<00:00, 33.73s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.908, 'compress@10': 0.5238, 'time@10': 41.0812}: 100%|██████████| 10/10 [04:49<00:00, 28.94s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.02012246091360849
Avg hit ratio: 0.8904662438108957
Avg ndcg: 0.9080033802320969
Avg compression ratio: 0.523772411250926
Avg train time: 41.08124938011169
Std train time: 20.889239919478467
[0.8333333333333334, 0.8333333333333334, 0.16666666666666669, 0.5, 0.8333333333333334, 0.8333333333333334, 0.5, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[40, 40, 42, 40, 38, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0309, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8652, 'compress@10': 0.8421, 'time@10': 33.5657}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0309, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8652, 'compress@10': 0.8421, 'time@10': 33.5657}:  10%|█         | 1/10 [00:16<02:31, 16.82s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0236, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8929, 'compress@10': 0.8404, 'time@10': 30.5656}:  10%|█         | 1/10 [00:44<02:31, 16.82s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0236, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8929, 'compress@10': 0.8404, 'time@10': 30.5656}:  20%|██        | 2/10 [00:44<03:05, 23.16s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.881, 'compress@10': 0.6555, 'time@10': 24.2334}:  20%|██        | 2/10 [00:50<03:05, 23.16s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.881, 'compress@10': 0.6555, 'time@10': 24.2334}:  30%|███       | 3/10 [00:50<01:46, 15.25s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.896, 'compress@10': 0.6211, 'time@10': 24.7073}:  30%|███       | 3/10 [01:16<01:46, 15.25s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.896, 'compress@10': 0.6211, 'time@10': 24.7073}:  40%|████      | 4/10 [01:16<01:57, 19.56s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.901, 'compress@10': 0.6642, 'time@10': 37.3585}:  40%|████      | 4/10 [02:00<01:57, 19.56s/it] {'epoch': 2, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.901, 'compress@10': 0.6642, 'time@10': 37.3585}:  50%|█████     | 5/10 [02:00<02:21, 28.38s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9068, 'compress@10': 0.693, 'time@10': 37.8699}:  50%|█████     | 5/10 [02:40<02:21, 28.38s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9068, 'compress@10': 0.693, 'time@10': 37.8699}:  60%|██████    | 6/10 [02:40<02:09, 32.49s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0161, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9095, 'compress@10': 0.6683, 'time@10': 39.2234}:  60%|██████    | 6/10 [03:04<02:09, 32.49s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0161, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9095, 'compress@10': 0.6683, 'time@10': 39.2234}:  70%|███████   | 7/10 [03:04<01:28, 29.62s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9139, 'compress@10': 0.6086, 'time@10': 38.1548}:  70%|███████   | 7/10 [03:35<01:28, 29.62s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9139, 'compress@10': 0.6086, 'time@10': 38.1548}:  80%|████████  | 8/10 [03:35<00:59, 29.97s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9175, 'compress@10': 0.5621, 'time@10': 40.6923}:  80%|████████  | 8/10 [04:05<00:59, 29.97s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9175, 'compress@10': 0.5621, 'time@10': 40.6923}:  90%|█████████ | 9/10 [04:05<00:30, 30.15s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9224, 'compress@10': 0.5245, 'time@10': 40.5555}:  90%|█████████ | 9/10 [04:45<00:30, 30.15s/it]    {'epoch': 2, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9224, 'compress@10': 0.5245, 'time@10': 40.5555}: 100%|██████████| 10/10 [04:45<00:00, 32.99s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9224, 'compress@10': 0.5245, 'time@10': 40.5555}: 100%|██████████| 10/10 [04:45<00:00, 28.52s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.013970298577792303
Avg hit ratio: 0.90438329450214
Avg ndcg: 0.9223924043853742
Avg compression ratio: 0.5244620744187236
Avg train time: 40.55546762943268
Std train time: 20.190040713858327
[0.875, 0.875, 0.125, 0.625, 0.875, 0.875, 0.375, 0.125, 0.125, 0.125]
[40, 40, 43, 40, 37, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8963, 'compress@10': 0.8816, 'time@10': 32.3547}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8963, 'compress@10': 0.8816, 'time@10': 32.3547}:  10%|█         | 1/10 [00:16<02:25, 16.22s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9247, 'compress@10': 0.8803, 'time@10': 29.7197}:  10%|█         | 1/10 [00:43<02:25, 16.22s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9247, 'compress@10': 0.8803, 'time@10': 29.7197}:  20%|██        | 2/10 [00:43<03:01, 22.63s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.9022, 'compress@10': 0.6702, 'time@10': 23.8277}:  20%|██        | 2/10 [00:49<03:01, 22.63s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.9022, 'compress@10': 0.6702, 'time@10': 23.8277}:  30%|███       | 3/10 [00:49<01:45, 15.07s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9159, 'compress@10': 0.6622, 'time@10': 24.3664}:  30%|███       | 3/10 [01:15<01:45, 15.07s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9159, 'compress@10': 0.6622, 'time@10': 24.3664}:  40%|████      | 4/10 [01:15<01:56, 19.39s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9234, 'compress@10': 0.7053, 'time@10': 36.0851}:  40%|████      | 4/10 [01:56<01:56, 19.39s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9234, 'compress@10': 0.7053, 'time@10': 36.0851}:  50%|█████     | 5/10 [01:56<02:16, 27.37s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9293, 'compress@10': 0.734, 'time@10': 36.7278}:  50%|█████     | 5/10 [02:36<02:16, 27.37s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9293, 'compress@10': 0.734, 'time@10': 36.7278}:  60%|██████    | 6/10 [02:36<02:06, 31.66s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9308, 'compress@10': 0.6863, 'time@10': 38.0665}:  60%|██████    | 6/10 [03:00<02:06, 31.66s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9308, 'compress@10': 0.6863, 'time@10': 38.0665}:  70%|███████   | 7/10 [03:00<01:26, 28.86s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.934, 'compress@10': 0.6193, 'time@10': 37.1519}:  70%|███████   | 7/10 [03:30<01:26, 28.86s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.934, 'compress@10': 0.6193, 'time@10': 37.1519}:  80%|████████  | 8/10 [03:30<00:58, 29.47s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9362, 'compress@10': 0.5671, 'time@10': 39.603}:  80%|████████  | 8/10 [04:00<00:58, 29.47s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9362, 'compress@10': 0.5671, 'time@10': 39.603}:  90%|█████████ | 9/10 [04:00<00:29, 29.52s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9398, 'compress@10': 0.5249, 'time@10': 39.4043}:  90%|█████████ | 9/10 [04:38<00:29, 29.52s/it]  {'epoch': 3, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9398, 'compress@10': 0.5249, 'time@10': 39.4043}: 100%|██████████| 10/10 [04:38<00:00, 32.03s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9398, 'compress@10': 0.5249, 'time@10': 39.4043}: 100%|██████████| 10/10 [04:38<00:00, 27.81s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.01117792572247649
Avg hit ratio: 0.8985865445627755
Avg ndcg: 0.9398254524306979
Avg compression ratio: 0.5249139967813974
Avg train time: 39.40428936481476
Std train time: 18.82259394452007
[0.9, 0.7, 0.1, 0.7, 0.9, 0.7, 0.3, 0.1, 0.3, 0.3]
[40, 40, 44, 40, 36, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8958, 'compress@10': 0.9052, 'time@10': 31.1111}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8958, 'compress@10': 0.9052, 'time@10': 31.1111}:  10%|█         | 1/10 [00:15<02:20, 15.59s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9288, 'compress@10': 0.8075, 'time@10': 29.8482}:  10%|█         | 1/10 [00:44<02:20, 15.59s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9288, 'compress@10': 0.8075, 'time@10': 29.8482}:  20%|██        | 2/10 [00:44<03:06, 23.26s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9049, 'compress@10': 0.6145, 'time@10': 23.9398}:  20%|██        | 2/10 [00:50<03:06, 23.26s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9049, 'compress@10': 0.6145, 'time@10': 23.9398}:  30%|███       | 3/10 [00:50<01:47, 15.42s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9183, 'compress@10': 0.6385, 'time@10': 24.2832}:  30%|███       | 3/10 [01:15<01:47, 15.42s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9183, 'compress@10': 0.6385, 'time@10': 24.2832}:  40%|████      | 4/10 [01:15<01:56, 19.34s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9285, 'compress@10': 0.6912, 'time@10': 35.1499}:  40%|████      | 4/10 [01:55<01:56, 19.34s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9285, 'compress@10': 0.6912, 'time@10': 35.1499}:  50%|█████     | 5/10 [01:55<02:12, 26.56s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9349, 'compress@10': 0.6938, 'time@10': 36.1227}:  50%|█████     | 5/10 [02:36<02:12, 26.56s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9349, 'compress@10': 0.6938, 'time@10': 36.1227}:  60%|██████    | 6/10 [02:36<02:05, 31.48s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9359, 'compress@10': 0.6415, 'time@10': 37.3945}:  60%|██████    | 6/10 [02:58<02:05, 31.48s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9359, 'compress@10': 0.6415, 'time@10': 37.3945}:  70%|███████   | 7/10 [02:58<01:25, 28.56s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0086, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9387, 'compress@10': 0.5771, 'time@10': 36.5509}:  70%|███████   | 7/10 [03:29<01:25, 28.56s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0086, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9387, 'compress@10': 0.5771, 'time@10': 36.5509}:  80%|████████  | 8/10 [03:29<00:58, 29.23s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9415, 'compress@10': 0.5485, 'time@10': 39.3822}:  80%|████████  | 8/10 [04:00<00:58, 29.23s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9415, 'compress@10': 0.5485, 'time@10': 39.3822}:  90%|█████████ | 9/10 [04:00<00:29, 29.81s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.947, 'compress@10': 0.5252, 'time@10': 39.3651}:  90%|█████████ | 9/10 [04:39<00:29, 29.81s/it]    {'epoch': 4, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.947, 'compress@10': 0.5252, 'time@10': 39.3651}: 100%|██████████| 10/10 [04:39<00:00, 32.72s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.947, 'compress@10': 0.5252, 'time@10': 39.3651}: 100%|██████████| 10/10 [04:39<00:00, 27.96s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.009912287809824259
Avg hit ratio: 0.9084846230924329
Avg ndcg: 0.9470340922765276
Avg compression ratio: 0.5252486225520774
Avg train time: 39.365101075172426
Std train time: 18.13583327327168
[0.9166666666666667, 0.5833333333333333, 0.08333333333333334, 0.5833333333333333, 0.9166666666666667, 0.75, 0.41666666666666663, 0.08333333333333334, 0.25, 0.41666666666666663]
[40, 40, 45, 40, 35, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9051, 'compress@10': 0.921, 'time@10': 31.2371}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9051, 'compress@10': 0.921, 'time@10': 31.2371}:  10%|█         | 1/10 [00:15<02:20, 15.66s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0083, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9334, 'compress@10': 0.7589, 'time@10': 30.1219}:  10%|█         | 1/10 [00:44<02:20, 15.66s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0083, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9334, 'compress@10': 0.7589, 'time@10': 30.1219}:  20%|██        | 2/10 [00:44<03:08, 23.53s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.908, 'compress@10': 0.5774, 'time@10': 24.1441}:  20%|██        | 2/10 [00:50<03:08, 23.53s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.908, 'compress@10': 0.5774, 'time@10': 24.1441}:  30%|███       | 3/10 [00:50<01:49, 15.59s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9196, 'compress@10': 0.5826, 'time@10': 24.5784}:  30%|███       | 3/10 [01:16<01:49, 15.59s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9196, 'compress@10': 0.5826, 'time@10': 24.5784}:  40%|████      | 4/10 [01:16<01:58, 19.68s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.006, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9308, 'compress@10': 0.6497, 'time@10': 34.7151}:  40%|████      | 4/10 [01:54<01:58, 19.68s/it] {'epoch': 5, 'num_users': 5.8, 'loss': 0.006, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9308, 'compress@10': 0.6497, 'time@10': 34.7151}:  50%|█████     | 5/10 [01:54<02:10, 26.17s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0067, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9375, 'compress@10': 0.6674, 'time@10': 35.6202}:  50%|█████     | 5/10 [02:34<02:10, 26.17s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0067, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9375, 'compress@10': 0.6674, 'time@10': 35.6202}:  60%|██████    | 6/10 [02:34<02:03, 30.93s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9388, 'compress@10': 0.6349, 'time@10': 37.0405}:  60%|██████    | 6/10 [02:57<02:03, 30.93s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9388, 'compress@10': 0.6349, 'time@10': 37.0405}:  70%|███████   | 7/10 [02:57<01:24, 28.28s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0062, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9424, 'compress@10': 0.5692, 'time@10': 36.2553}:  70%|███████   | 7/10 [03:28<01:24, 28.28s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0062, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9424, 'compress@10': 0.5692, 'time@10': 36.2553}:  80%|████████  | 8/10 [03:28<00:58, 29.08s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.006, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.9448, 'compress@10': 0.5361, 'time@10': 39.091}:  80%|████████  | 8/10 [03:59<00:58, 29.08s/it] {'epoch': 5, 'num_users': 6.3333, 'loss': 0.006, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.9448, 'compress@10': 0.5361, 'time@10': 39.091}:  90%|█████████ | 9/10 [03:59<00:29, 29.66s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9461, 'compress@10': 0.5255, 'time@10': 39.2429}:  90%|█████████ | 9/10 [04:39<00:29, 29.66s/it]  {'epoch': 5, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9461, 'compress@10': 0.5255, 'time@10': 39.2429}: 100%|██████████| 10/10 [04:39<00:00, 33.05s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9461, 'compress@10': 0.5255, 'time@10': 39.2429}: 100%|██████████| 10/10 [04:39<00:00, 27.98s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.009041010046140947
Avg hit ratio: 0.8953192095585983
Avg ndcg: 0.9460530387077689
Avg compression ratio: 0.5255065610991569
Avg train time: 39.24290759563446
Std train time: 17.31793021726519
[0.9285714285714286, 0.49999999999999994, 0.07142857142857144, 0.49999999999999994, 0.9285714285714286, 0.7857142857142857, 0.5, 0.07142857142857144, 0.2142857142857143, 0.5]
[40, 40, 46, 40, 34, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9134, 'compress@10': 0.9323, 'time@10': 31.4}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9134, 'compress@10': 0.9323, 'time@10': 31.4}:  10%|█         | 1/10 [00:15<02:21, 15.75s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.893, 'ndcg@10': 0.94, 'compress@10': 0.7242, 'time@10': 29.9313}:  10%|█         | 1/10 [00:44<02:21, 15.75s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.893, 'ndcg@10': 0.94, 'compress@10': 0.7242, 'time@10': 29.9313}:  20%|██        | 2/10 [00:44<03:06, 23.25s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0044, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9124, 'compress@10': 0.5508, 'time@10': 23.789}:  20%|██        | 2/10 [00:50<03:06, 23.25s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0044, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9124, 'compress@10': 0.5508, 'time@10': 23.789}:  30%|███       | 3/10 [00:50<01:46, 15.28s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0046, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9233, 'compress@10': 0.5426, 'time@10': 24.3068}:  30%|███       | 3/10 [01:15<01:46, 15.28s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0046, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9233, 'compress@10': 0.5426, 'time@10': 24.3068}:  40%|████      | 4/10 [01:15<01:56, 19.47s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0052, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9335, 'compress@10': 0.6201, 'time@10': 34.206}:  40%|████      | 4/10 [01:52<01:56, 19.47s/it] {'epoch': 6, 'num_users': 5.8, 'loss': 0.0052, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9335, 'compress@10': 0.6201, 'time@10': 34.206}:  50%|█████     | 5/10 [01:52<02:08, 25.77s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9469, 'compress@10': 0.6485, 'time@10': 35.0558}:  50%|█████     | 5/10 [02:32<02:08, 25.77s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9469, 'compress@10': 0.6485, 'time@10': 35.0558}:  60%|██████    | 6/10 [02:32<02:01, 30.38s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0067, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9482, 'compress@10': 0.6301, 'time@10': 36.4089}:  60%|██████    | 6/10 [02:54<02:01, 30.38s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0067, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9482, 'compress@10': 0.6301, 'time@10': 36.4089}:  70%|███████   | 7/10 [02:54<01:23, 27.74s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.006, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9511, 'compress@10': 0.5636, 'time@10': 35.5649}:  70%|███████   | 7/10 [03:24<01:23, 27.74s/it]  {'epoch': 6, 'num_users': 6.125, 'loss': 0.006, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9511, 'compress@10': 0.5636, 'time@10': 35.5649}:  80%|████████  | 8/10 [03:24<00:56, 28.36s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0057, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9527, 'compress@10': 0.5273, 'time@10': 38.35}:  80%|████████  | 8/10 [03:54<00:56, 28.36s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0057, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9527, 'compress@10': 0.5273, 'time@10': 38.35}:  90%|█████████ | 9/10 [03:54<00:28, 28.99s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9627, 'compress@10': 0.5257, 'time@10': 38.5259}:  90%|█████████ | 9/10 [04:34<00:28, 28.99s/it]  {'epoch': 6, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9627, 'compress@10': 0.5257, 'time@10': 38.5259}: 100%|██████████| 10/10 [04:34<00:00, 32.43s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9627, 'compress@10': 0.5257, 'time@10': 38.5259}: 100%|██████████| 10/10 [04:34<00:00, 27.47s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.009239653986133408
Avg hit ratio: 0.901033495272884
Avg ndcg: 0.96274665049734
Avg compression ratio: 0.525690170886946
Avg train time: 38.52593433856964
Std train time: 17.010324257840455
[0.9375, 0.43749999999999994, 0.06250000000000001, 0.5625, 0.9375, 0.8125, 0.4375, 0.06250000000000001, 0.1875, 0.5625]
[40, 40, 47, 40, 33, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9344, 'compress@10': 0.9408, 'time@10': 29.9107}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9344, 'compress@10': 0.9408, 'time@10': 29.9107}:  10%|█         | 1/10 [00:14<02:14, 14.99s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0052, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9511, 'compress@10': 0.6982, 'time@10': 28.7457}:  10%|█         | 1/10 [00:42<02:14, 14.99s/it] {'epoch': 7, 'num_users': 7.0, 'loss': 0.0052, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9511, 'compress@10': 0.6982, 'time@10': 28.7457}:  20%|██        | 2/10 [00:42<02:59, 22.42s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0035, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9198, 'compress@10': 0.531, 'time@10': 23.017}:  20%|██        | 2/10 [00:48<02:59, 22.42s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0035, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9198, 'compress@10': 0.531, 'time@10': 23.017}:  30%|███       | 3/10 [00:48<01:43, 14.84s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9309, 'compress@10': 0.5427, 'time@10': 23.5529}:  30%|███       | 3/10 [01:13<01:43, 14.84s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9309, 'compress@10': 0.5427, 'time@10': 23.5529}:  40%|████      | 4/10 [01:13<01:53, 18.93s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0041, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9403, 'compress@10': 0.6219, 'time@10': 32.6437}:  40%|████      | 4/10 [01:48<01:53, 18.93s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0041, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9403, 'compress@10': 0.6219, 'time@10': 32.6437}:  50%|█████     | 5/10 [01:48<02:02, 24.57s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0053, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9465, 'compress@10': 0.6544, 'time@10': 33.7416}:  50%|█████     | 5/10 [02:27<02:02, 24.57s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0053, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9465, 'compress@10': 0.6544, 'time@10': 33.7416}:  60%|██████    | 6/10 [02:27<01:58, 29.57s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.005, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9481, 'compress@10': 0.6266, 'time@10': 35.1967}:  60%|██████    | 6/10 [02:49<01:58, 29.57s/it] {'epoch': 7, 'num_users': 6.2857, 'loss': 0.005, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9481, 'compress@10': 0.6266, 'time@10': 35.1967}:  70%|███████   | 7/10 [02:49<01:21, 27.10s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0044, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.951, 'compress@10': 0.5595, 'time@10': 34.4045}:  70%|███████   | 7/10 [03:18<01:21, 27.10s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0044, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.951, 'compress@10': 0.5595, 'time@10': 34.4045}:  80%|████████  | 8/10 [03:18<00:55, 27.67s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0041, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.953, 'compress@10': 0.5207, 'time@10': 37.2211}:  80%|████████  | 8/10 [03:48<00:55, 27.67s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0041, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.953, 'compress@10': 0.5207, 'time@10': 37.2211}:  90%|█████████ | 9/10 [03:48<00:28, 28.37s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0054, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9561, 'compress@10': 0.5259, 'time@10': 37.5184}:  90%|█████████ | 9/10 [04:28<00:28, 28.37s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0054, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9561, 'compress@10': 0.5259, 'time@10': 37.5184}: 100%|██████████| 10/10 [04:28<00:00, 32.04s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0054, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9561, 'compress@10': 0.5259, 'time@10': 37.5184}: 100%|██████████| 10/10 [04:28<00:00, 26.85s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.005351817798264489
Avg hit ratio: 0.8980334952728839
Avg ndcg: 0.9561064457411204
Avg compression ratio: 0.5258819626173469
Avg train time: 37.51836271286011
Std train time: 16.1099789269963
[0.9444444444444444, 0.38888888888888884, 0.055555555555555566, 0.6111111111111112, 0.9444444444444444, 0.8333333333333334, 0.3888888888888889, 0.055555555555555566, 0.16666666666666666, 0.6111111111111112]
[40, 40, 48, 40, 32, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9404, 'compress@10': 0.9474, 'time@10': 30.5163}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9404, 'compress@10': 0.9474, 'time@10': 30.5163}:  10%|█         | 1/10 [00:15<02:17, 15.30s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0041, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9541, 'compress@10': 0.678, 'time@10': 29.1621}:  10%|█         | 1/10 [00:43<02:17, 15.30s/it] {'epoch': 8, 'num_users': 7.0, 'loss': 0.0041, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9541, 'compress@10': 0.678, 'time@10': 29.1621}:  20%|██        | 2/10 [00:43<03:01, 22.68s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0027, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9217, 'compress@10': 0.5155, 'time@10': 23.273}:  20%|██        | 2/10 [00:48<03:01, 22.68s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0027, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9217, 'compress@10': 0.5155, 'time@10': 23.273}:  30%|███       | 3/10 [00:48<01:44, 14.96s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0024, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9324, 'compress@10': 0.5429, 'time@10': 23.6691}:  30%|███       | 3/10 [01:13<01:44, 14.96s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0024, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9324, 'compress@10': 0.5429, 'time@10': 23.6691}:  40%|████      | 4/10 [01:13<01:53, 18.88s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0035, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.9414, 'compress@10': 0.6234, 'time@10': 32.3441}:  40%|████      | 4/10 [01:47<01:53, 18.88s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0035, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.9414, 'compress@10': 0.6234, 'time@10': 32.3441}:  50%|█████     | 5/10 [01:47<02:00, 24.18s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9504, 'compress@10': 0.659, 'time@10': 33.4203}:  50%|█████     | 5/10 [02:26<02:00, 24.18s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9504, 'compress@10': 0.659, 'time@10': 33.4203}:  60%|██████    | 6/10 [02:26<01:56, 29.16s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9514, 'compress@10': 0.6239, 'time@10': 34.9804}:  60%|██████    | 6/10 [02:48<01:56, 29.16s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9514, 'compress@10': 0.6239, 'time@10': 34.9804}:  70%|███████   | 7/10 [02:48<01:20, 26.89s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0066, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9539, 'compress@10': 0.5562, 'time@10': 34.0395}:  70%|███████   | 7/10 [03:15<01:20, 26.89s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0066, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9539, 'compress@10': 0.5562, 'time@10': 34.0395}:  80%|████████  | 8/10 [03:15<00:54, 27.08s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.006, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9559, 'compress@10': 0.5156, 'time@10': 37.0019}:  80%|████████  | 8/10 [03:46<00:54, 27.08s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.006, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9559, 'compress@10': 0.5156, 'time@10': 37.0019}:  90%|█████████ | 9/10 [03:46<00:28, 28.11s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9698, 'compress@10': 0.526, 'time@10': 37.2689}:  90%|█████████ | 9/10 [04:26<00:28, 28.11s/it]     {'epoch': 8, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9698, 'compress@10': 0.526, 'time@10': 37.2689}: 100%|██████████| 10/10 [04:26<00:00, 31.70s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9698, 'compress@10': 0.526, 'time@10': 37.2689}: 100%|██████████| 10/10 [04:26<00:00, 26.60s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.00899441933718507
Avg hit ratio: 0.8840140380276204
Avg ndcg: 0.9697806192380277
Avg compression ratio: 0.5260308501141723
Avg train time: 37.26886119842529
Std train time: 15.94849191162144
[0.95, 0.35, 0.05000000000000001, 0.55, 0.95, 0.8500000000000001, 0.45, 0.05000000000000001, 0.15, 0.65]
[40, 40, 49, 40, 31, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0048, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9425, 'compress@10': 0.9526, 'time@10': 30.2465}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0048, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9425, 'compress@10': 0.9526, 'time@10': 30.2465}:  10%|█         | 1/10 [00:15<02:16, 15.16s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0028, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9551, 'compress@10': 0.6618, 'time@10': 29.017}:  10%|█         | 1/10 [00:42<02:16, 15.16s/it]  {'epoch': 9, 'num_users': 7.0, 'loss': 0.0028, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9551, 'compress@10': 0.6618, 'time@10': 29.017}:  20%|██        | 2/10 [00:42<03:00, 22.61s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0019, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9225, 'compress@10': 0.5031, 'time@10': 23.404}:  20%|██        | 2/10 [00:49<03:00, 22.61s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0019, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9225, 'compress@10': 0.5031, 'time@10': 23.404}:  30%|███       | 3/10 [00:49<01:45, 15.08s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0016, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9329, 'compress@10': 0.5188, 'time@10': 23.7174}:  30%|███       | 3/10 [01:13<01:45, 15.08s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0016, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9329, 'compress@10': 0.5188, 'time@10': 23.7174}:  40%|████      | 4/10 [01:13<01:53, 18.88s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0021, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9423, 'compress@10': 0.6053, 'time@10': 31.7891}:  40%|████      | 4/10 [01:45<01:53, 18.88s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0021, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9423, 'compress@10': 0.6053, 'time@10': 31.7891}:  50%|█████     | 5/10 [01:45<01:58, 23.64s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0028, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9482, 'compress@10': 0.6466, 'time@10': 32.869}:  50%|█████     | 5/10 [02:24<01:58, 23.64s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0028, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9482, 'compress@10': 0.6466, 'time@10': 32.869}:  60%|██████    | 6/10 [02:24<01:54, 28.62s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0026, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9499, 'compress@10': 0.6217, 'time@10': 34.4225}:  60%|██████    | 6/10 [02:46<01:54, 28.62s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0026, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9499, 'compress@10': 0.6217, 'time@10': 34.4225}:  70%|███████   | 7/10 [02:46<01:19, 26.43s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0023, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9526, 'compress@10': 0.5536, 'time@10': 33.5385}:  70%|███████   | 7/10 [03:13<01:19, 26.43s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0023, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9526, 'compress@10': 0.5536, 'time@10': 33.5385}:  80%|████████  | 8/10 [03:13<00:53, 26.73s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0022, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9547, 'compress@10': 0.5115, 'time@10': 36.4756}:  80%|████████  | 8/10 [03:43<00:53, 26.73s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0022, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9547, 'compress@10': 0.5115, 'time@10': 36.4756}:  90%|█████████ | 9/10 [03:43<00:27, 27.76s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0022, 'hit_ratio@10': 0.898, 'ndcg@10': 0.957, 'compress@10': 0.5261, 'time@10': 36.7752}:  90%|█████████ | 9/10 [04:23<00:27, 27.76s/it]     {'epoch': 9, 'num_users': 6.3, 'loss': 0.0022, 'hit_ratio@10': 0.898, 'ndcg@10': 0.957, 'compress@10': 0.5261, 'time@10': 36.7752}: 100%|██████████| 10/10 [04:23<00:00, 31.39s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0022, 'hit_ratio@10': 0.898, 'ndcg@10': 0.957, 'compress@10': 0.5261, 'time@10': 36.7752}: 100%|██████████| 10/10 [04:23<00:00, 26.30s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.0021524776286040415
Avg hit ratio: 0.8980334952728839
Avg ndcg: 0.9569578391054462
Avg compression ratio: 0.5261071856676873
Avg train time: 36.77516996860504
Std train time: 15.184134228108332
[0.9545454545454545, 0.3181818181818182, 0.04545454545454546, 0.5, 0.9545454545454545, 0.8636363636363638, 0.5, 0.04545454545454546, 0.13636363636363635, 0.6818181818181819]
[40, 40, 50, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0034, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9569, 'time@10': 29.4713}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0034, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9569, 'time@10': 29.4713}:  10%|█         | 1/10 [00:14<02:12, 14.77s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0022, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9576, 'compress@10': 0.6486, 'time@10': 28.3225}:  10%|█         | 1/10 [00:41<02:12, 14.77s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.0022, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9576, 'compress@10': 0.6486, 'time@10': 28.3225}:  20%|██        | 2/10 [00:41<02:56, 22.09s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0015, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9241, 'compress@10': 0.493, 'time@10': 22.7942}:  20%|██        | 2/10 [00:47<02:56, 22.09s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0015, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9241, 'compress@10': 0.493, 'time@10': 22.7942}:  30%|███       | 3/10 [00:47<01:42, 14.70s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0013, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9341, 'compress@10': 0.4992, 'time@10': 23.3093}:  30%|███       | 3/10 [01:12<01:42, 14.70s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0013, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9341, 'compress@10': 0.4992, 'time@10': 23.3093}:  40%|████      | 4/10 [01:12<01:52, 18.72s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0021, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9433, 'compress@10': 0.5904, 'time@10': 30.8906}:  40%|████      | 4/10 [01:43<01:52, 18.72s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0021, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9433, 'compress@10': 0.5904, 'time@10': 30.8906}:  50%|█████     | 5/10 [01:43<01:55, 23.03s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0034, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9527, 'compress@10': 0.6365, 'time@10': 32.0427}:  50%|█████     | 5/10 [02:21<01:55, 23.03s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0034, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9527, 'compress@10': 0.6365, 'time@10': 32.0427}:  60%|██████    | 6/10 [02:21<01:52, 28.07s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0031, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9538, 'compress@10': 0.6198, 'time@10': 34.0042}:  60%|██████    | 6/10 [02:44<01:52, 28.07s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0031, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9538, 'compress@10': 0.6198, 'time@10': 34.0042}:  70%|███████   | 7/10 [02:44<01:19, 26.39s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0027, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.956, 'compress@10': 0.5515, 'time@10': 33.1646}:  70%|███████   | 7/10 [03:11<01:19, 26.39s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.0027, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.956, 'compress@10': 0.5515, 'time@10': 33.1646}:  80%|████████  | 8/10 [03:11<00:53, 26.70s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0025, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9577, 'compress@10': 0.5081, 'time@10': 36.0882}:  80%|████████  | 8/10 [03:41<00:53, 26.70s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0025, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9577, 'compress@10': 0.5081, 'time@10': 36.0882}:  90%|█████████ | 9/10 [03:41<00:27, 27.66s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0047, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9617, 'compress@10': 0.5262, 'time@10': 36.4003}:  90%|█████████ | 9/10 [04:20<00:27, 27.66s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0047, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9617, 'compress@10': 0.5262, 'time@10': 36.4003}: 100%|██████████| 10/10 [04:20<00:00, 31.24s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0047, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9617, 'compress@10': 0.5262, 'time@10': 36.4003}: 100%|██████████| 10/10 [04:20<00:00, 26.06s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.004704835263207432
Avg hit ratio: 0.8815255587649476
Avg ndcg: 0.9617299101824605
Avg compression ratio: 0.5261695924697689
Avg train time: 36.40029833316803
Std train time: 14.845097479272622
[0.9583333333333333, 0.375, 0.04166666666666667, 0.4583333333333333, 0.9583333333333333, 0.8750000000000001, 0.4583333333333333, 0.04166666666666667, 0.12499999999999999, 0.7083333333333334]
[40, 40, 51, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9605, 'time@10': 29.9244}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9605, 'time@10': 29.9244}:  10%|█         | 1/10 [00:14<02:14, 15.00s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0013, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6778, 'time@10': 28.7248}:  10%|█         | 1/10 [00:42<02:14, 15.00s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0013, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6778, 'time@10': 28.7248}:  20%|██        | 2/10 [00:42<02:59, 22.42s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0009, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5114, 'time@10': 23.2372}:  20%|██        | 2/10 [00:48<02:59, 22.42s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0009, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5114, 'time@10': 23.2372}:  30%|███       | 3/10 [00:48<01:45, 15.00s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0008, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9341, 'compress@10': 0.503, 'time@10': 23.6336}:  30%|███       | 3/10 [01:13<01:45, 15.00s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0008, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9341, 'compress@10': 0.503, 'time@10': 23.6336}:  40%|████      | 4/10 [01:13<01:53, 18.89s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0015, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9433, 'compress@10': 0.5942, 'time@10': 31.3942}:  40%|████      | 4/10 [01:44<01:53, 18.89s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0015, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9433, 'compress@10': 0.5942, 'time@10': 31.3942}:  50%|█████     | 5/10 [01:44<01:56, 23.35s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0037, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9487, 'compress@10': 0.6415, 'time@10': 32.4781}:  50%|█████     | 5/10 [02:22<01:56, 23.35s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0037, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9487, 'compress@10': 0.6415, 'time@10': 32.4781}:  60%|██████    | 6/10 [02:22<01:53, 28.31s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0033, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9503, 'compress@10': 0.6184, 'time@10': 34.2678}:  60%|██████    | 6/10 [02:45<01:53, 28.31s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0033, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9503, 'compress@10': 0.6184, 'time@10': 34.2678}:  70%|███████   | 7/10 [02:45<01:19, 26.42s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0029, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.953, 'compress@10': 0.5497, 'time@10': 33.4606}:  70%|███████   | 7/10 [03:13<01:19, 26.42s/it]  {'epoch': 11, 'num_users': 6.125, 'loss': 0.0029, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.953, 'compress@10': 0.5497, 'time@10': 33.4606}:  80%|████████  | 8/10 [03:13<00:53, 26.88s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0026, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.955, 'compress@10': 0.5053, 'time@10': 36.206}:  80%|████████  | 8/10 [03:42<00:53, 26.88s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0026, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.955, 'compress@10': 0.5053, 'time@10': 36.206}:  90%|█████████ | 9/10 [03:42<00:27, 27.58s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0038, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9567, 'compress@10': 0.5263, 'time@10': 36.5362}:  90%|█████████ | 9/10 [04:21<00:27, 27.58s/it]  {'epoch': 11, 'num_users': 6.3, 'loss': 0.0038, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9567, 'compress@10': 0.5263, 'time@10': 36.5362}: 100%|██████████| 10/10 [04:21<00:00, 31.27s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0038, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9567, 'compress@10': 0.5263, 'time@10': 36.5362}: 100%|██████████| 10/10 [04:21<00:00, 26.19s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.003764403007728774
Avg hit ratio: 0.8889577144229097
Avg ndcg: 0.9566523756937212
Avg compression ratio: 0.5262853506310429
Avg train time: 36.53617534637451
Std train time: 14.658668665730369
[0.9615384615384615, 0.4230769230769231, 0.038461538461538464, 0.4230769230769231, 0.9615384615384615, 0.8846153846153847, 0.4230769230769231, 0.038461538461538464, 0.11538461538461538, 0.7307692307692308]
[40, 40, 52, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0017, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9635, 'time@10': 30.1119}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0017, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9635, 'time@10': 30.1119}:  10%|█         | 1/10 [00:15<02:15, 15.09s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0012, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.7026, 'time@10': 28.9001}:  10%|█         | 1/10 [00:42<02:15, 15.09s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0012, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.7026, 'time@10': 28.9001}:  20%|██        | 2/10 [00:42<03:00, 22.53s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0008, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9241, 'compress@10': 0.527, 'time@10': 23.4133}:  20%|██        | 2/10 [00:49<03:00, 22.53s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0008, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9241, 'compress@10': 0.527, 'time@10': 23.4133}:  30%|███       | 3/10 [00:49<01:45, 15.10s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0007, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9341, 'compress@10': 0.5062, 'time@10': 23.7769}:  30%|███       | 3/10 [01:13<01:45, 15.10s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0007, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9341, 'compress@10': 0.5062, 'time@10': 23.7769}:  40%|████      | 4/10 [01:13<01:53, 18.97s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0015, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9433, 'compress@10': 0.5974, 'time@10': 31.3805}:  40%|████      | 4/10 [01:44<01:53, 18.97s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0015, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9433, 'compress@10': 0.5974, 'time@10': 31.3805}:  50%|█████     | 5/10 [01:44<01:56, 23.28s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0017, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9491, 'compress@10': 0.6457, 'time@10': 32.3114}:  50%|█████     | 5/10 [02:21<01:56, 23.28s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0017, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9491, 'compress@10': 0.6457, 'time@10': 32.3114}:  60%|██████    | 6/10 [02:21<01:51, 27.95s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0016, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9506, 'compress@10': 0.6172, 'time@10': 33.8741}:  60%|██████    | 6/10 [02:43<01:51, 27.95s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0016, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9506, 'compress@10': 0.6172, 'time@10': 33.8741}:  70%|███████   | 7/10 [02:43<01:17, 25.90s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0014, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9532, 'compress@10': 0.5483, 'time@10': 32.8618}:  70%|███████   | 7/10 [03:09<01:17, 25.90s/it]  {'epoch': 12, 'num_users': 6.125, 'loss': 0.0014, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9532, 'compress@10': 0.5483, 'time@10': 32.8618}:  80%|████████  | 8/10 [03:09<00:51, 25.87s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0013, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9552, 'compress@10': 0.503, 'time@10': 35.3583}:  80%|████████  | 8/10 [03:37<00:51, 25.87s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0013, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9552, 'compress@10': 0.503, 'time@10': 35.3583}:  90%|█████████ | 9/10 [03:37<00:26, 26.44s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0024, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9584, 'compress@10': 0.5264, 'time@10': 35.5094}:  90%|█████████ | 9/10 [04:14<00:26, 26.44s/it]  {'epoch': 12, 'num_users': 6.3, 'loss': 0.0024, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9584, 'compress@10': 0.5264, 'time@10': 35.5094}: 100%|██████████| 10/10 [04:14<00:00, 29.67s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0024, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9584, 'compress@10': 0.5264, 'time@10': 35.5094}: 100%|██████████| 10/10 [04:14<00:00, 25.40s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.0024231622764616023
Avg hit ratio: 0.9017073303983321
Avg ndcg: 0.9584438620166603
Avg compression ratio: 0.5263852762910581
Avg train time: 35.5094087600708
Std train time: 14.064796294729378
[0.9642857142857142, 0.4642857142857143, 0.03571428571428572, 0.39285714285714285, 0.9642857142857142, 0.8928571428571429, 0.39285714285714285, 0.03571428571428572, 0.10714285714285714, 0.7500000000000001]
[40, 40, 53, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0011, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9661, 'time@10': 28.1241}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0011, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9661, 'time@10': 28.1241}:  10%|█         | 1/10 [00:14<02:06, 14.10s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0009, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9576, 'compress@10': 0.7239, 'time@10': 27.2406}:  10%|█         | 1/10 [00:40<02:06, 14.10s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0009, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9576, 'compress@10': 0.7239, 'time@10': 27.2406}:  20%|██        | 2/10 [00:40<02:50, 21.33s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0006, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9241, 'compress@10': 0.5404, 'time@10': 22.094}:  20%|██        | 2/10 [00:46<02:50, 21.33s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0006, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9241, 'compress@10': 0.5404, 'time@10': 22.094}:  30%|███       | 3/10 [00:46<01:40, 14.30s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0006, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9341, 'compress@10': 0.5089, 'time@10': 22.5192}:  30%|███       | 3/10 [01:10<01:40, 14.30s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0006, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9341, 'compress@10': 0.5089, 'time@10': 22.5192}:  40%|████      | 4/10 [01:10<01:48, 18.06s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0013, 'hit_ratio@10': 0.9076, 'ndcg@10': 0.9433, 'compress@10': 0.6001, 'time@10': 29.4586}:  40%|████      | 4/10 [01:38<01:48, 18.06s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0013, 'hit_ratio@10': 0.9076, 'ndcg@10': 0.9433, 'compress@10': 0.6001, 'time@10': 29.4586}:  50%|█████     | 5/10 [01:38<01:49, 21.88s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9549, 'compress@10': 0.6493, 'time@10': 30.429}:  50%|█████     | 5/10 [02:14<01:49, 21.88s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9549, 'compress@10': 0.6493, 'time@10': 30.429}:  60%|██████    | 6/10 [02:14<01:45, 26.46s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0072, 'hit_ratio@10': 0.9251, 'ndcg@10': 0.9556, 'compress@10': 0.6162, 'time@10': 32.1671}:  60%|██████    | 6/10 [02:35<01:45, 26.46s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0072, 'hit_ratio@10': 0.9251, 'ndcg@10': 0.9556, 'compress@10': 0.6162, 'time@10': 32.1671}:  70%|███████   | 7/10 [02:35<01:14, 24.79s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0063, 'hit_ratio@10': 0.9309, 'ndcg@10': 0.9576, 'compress@10': 0.547, 'time@10': 31.3862}:  70%|███████   | 7/10 [03:01<01:14, 24.79s/it]  {'epoch': 13, 'num_users': 6.125, 'loss': 0.0063, 'hit_ratio@10': 0.9309, 'ndcg@10': 0.9576, 'compress@10': 0.547, 'time@10': 31.3862}:  80%|████████  | 8/10 [03:01<00:50, 25.16s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0056, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9591, 'compress@10': 0.501, 'time@10': 34.0039}:  80%|████████  | 8/10 [03:29<00:50, 25.16s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0056, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9591, 'compress@10': 0.501, 'time@10': 34.0039}:  90%|█████████ | 9/10 [03:29<00:25, 25.90s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0058, 'hit_ratio@10': 0.9196, 'ndcg@10': 0.961, 'compress@10': 0.5265, 'time@10': 34.319}:  90%|█████████ | 9/10 [04:06<00:25, 25.90s/it]    {'epoch': 13, 'num_users': 6.3, 'loss': 0.0058, 'hit_ratio@10': 0.9196, 'ndcg@10': 0.961, 'compress@10': 0.5265, 'time@10': 34.319}: 100%|██████████| 10/10 [04:06<00:00, 29.38s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0058, 'hit_ratio@10': 0.9196, 'ndcg@10': 0.961, 'compress@10': 0.5265, 'time@10': 34.319}: 100%|██████████| 10/10 [04:06<00:00, 24.63s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.005810359524061943
Avg hit ratio: 0.9195875147301293
Avg ndcg: 0.9609565326489855
Avg compression ratio: 0.5264701612293374
Avg train time: 34.31903078556061
Std train time: 13.480785844155157
[0.9666666666666666, 0.5, 0.03333333333333334, 0.36666666666666664, 0.9666666666666666, 0.9, 0.36666666666666664, 0.03333333333333334, 0.09999999999999999, 0.7666666666666667]
[40, 40, 54, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9684, 'time@10': 28.0012}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9684, 'time@10': 28.0012}:  10%|█         | 1/10 [00:14<02:06, 14.04s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9576, 'compress@10': 0.7423, 'time@10': 27.1069}:  10%|█         | 1/10 [00:40<02:06, 14.04s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9576, 'compress@10': 0.7423, 'time@10': 27.1069}:  20%|██        | 2/10 [00:40<02:49, 21.23s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0005, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.9241, 'compress@10': 0.552, 'time@10': 22.2334}:  20%|██        | 2/10 [00:46<02:49, 21.23s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.0005, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.9241, 'compress@10': 0.552, 'time@10': 22.2334}:  30%|███       | 3/10 [00:46<01:41, 14.45s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9341, 'compress@10': 0.5113, 'time@10': 22.5998}:  30%|███       | 3/10 [01:10<01:41, 14.45s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9341, 'compress@10': 0.5113, 'time@10': 22.5998}:  40%|████      | 4/10 [01:10<01:48, 18.12s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0012, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9433, 'compress@10': 0.6025, 'time@10': 29.845}:  40%|████      | 4/10 [01:39<01:48, 18.12s/it]  {'epoch': 14, 'num_users': 5.8, 'loss': 0.0012, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9433, 'compress@10': 0.6025, 'time@10': 29.845}:  50%|█████     | 5/10 [01:39<01:51, 22.21s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0035, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9485, 'compress@10': 0.6525, 'time@10': 30.6999}:  50%|█████     | 5/10 [02:14<01:51, 22.21s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0035, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9485, 'compress@10': 0.6525, 'time@10': 30.6999}:  60%|██████    | 6/10 [02:14<01:46, 26.56s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0031, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9501, 'compress@10': 0.6153, 'time@10': 32.32}:  60%|██████    | 6/10 [02:35<01:46, 26.56s/it] {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0031, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9501, 'compress@10': 0.6153, 'time@10': 32.32}:  70%|███████   | 7/10 [02:35<01:14, 24.76s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0027, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9528, 'compress@10': 0.546, 'time@10': 31.5169}:  70%|███████   | 7/10 [03:01<01:14, 24.76s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0027, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9528, 'compress@10': 0.546, 'time@10': 31.5169}:  80%|████████  | 8/10 [03:01<00:50, 25.13s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0024, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9549, 'compress@10': 0.4993, 'time@10': 33.9544}:  80%|████████  | 8/10 [03:28<00:50, 25.13s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0024, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9549, 'compress@10': 0.4993, 'time@10': 33.9544}:  90%|█████████ | 9/10 [03:28<00:25, 25.64s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0033, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9579, 'compress@10': 0.5265, 'time@10': 34.197}:  90%|█████████ | 9/10 [04:05<00:25, 25.64s/it]    {'epoch': 14, 'num_users': 6.3, 'loss': 0.0033, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9579, 'compress@10': 0.5265, 'time@10': 34.197}: 100%|██████████| 10/10 [04:05<00:00, 28.97s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0033, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9579, 'compress@10': 0.5265, 'time@10': 34.197}: 100%|██████████| 10/10 [04:05<00:00, 24.51s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.0033099279502832326
Avg hit ratio: 0.8937779909206055
Avg ndcg: 0.957895995095841
Avg compression ratio: 0.526542203601986
Avg train time: 34.19697449207306
Std train time: 13.404999587753862
[0.9687499999999999, 0.53125, 0.03125000000000001, 0.34375, 0.9687499999999999, 0.90625, 0.34375, 0.03125000000000001, 0.09374999999999999, 0.78125]
[40, 40, 55, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9704, 'time@10': 28.5989}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9704, 'time@10': 28.5989}:  10%|█         | 1/10 [00:14<02:09, 14.34s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9576, 'compress@10': 0.7584, 'time@10': 27.8456}:  10%|█         | 1/10 [00:41<02:09, 14.34s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9576, 'compress@10': 0.7584, 'time@10': 27.8456}:  20%|██        | 2/10 [00:41<02:54, 21.86s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.9241, 'compress@10': 0.5621, 'time@10': 22.6664}:  20%|██        | 2/10 [00:47<02:54, 21.86s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.9241, 'compress@10': 0.5621, 'time@10': 22.6664}:  30%|███       | 3/10 [00:47<01:42, 14.71s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9341, 'compress@10': 0.5134, 'time@10': 22.9283}:  30%|███       | 3/10 [01:11<01:42, 14.71s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9341, 'compress@10': 0.5134, 'time@10': 22.9283}:  40%|████      | 4/10 [01:11<01:49, 18.28s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0011, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9433, 'compress@10': 0.6046, 'time@10': 29.8865}:  40%|████      | 4/10 [01:40<01:49, 18.28s/it] {'epoch': 15, 'num_users': 5.8, 'loss': 0.0011, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9433, 'compress@10': 0.6046, 'time@10': 29.8865}:  50%|█████     | 5/10 [01:40<01:50, 22.11s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0037, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9508, 'compress@10': 0.6552, 'time@10': 30.7405}:  50%|█████     | 5/10 [02:15<01:50, 22.11s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0037, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9508, 'compress@10': 0.6552, 'time@10': 30.7405}:  60%|██████    | 6/10 [02:15<01:46, 26.51s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0033, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9521, 'compress@10': 0.6145, 'time@10': 32.3588}:  60%|██████    | 6/10 [02:36<01:46, 26.51s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0033, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9521, 'compress@10': 0.6145, 'time@10': 32.3588}:  70%|███████   | 7/10 [02:36<01:14, 24.73s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0029, 'hit_ratio@10': 0.9105, 'ndcg@10': 0.9545, 'compress@10': 0.545, 'time@10': 31.5135}:  70%|███████   | 7/10 [03:02<01:14, 24.73s/it]  {'epoch': 15, 'num_users': 6.125, 'loss': 0.0029, 'hit_ratio@10': 0.9105, 'ndcg@10': 0.9545, 'compress@10': 0.545, 'time@10': 31.5135}:  80%|████████  | 8/10 [03:02<00:50, 25.02s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0026, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9564, 'compress@10': 0.4978, 'time@10': 33.8399}:  80%|████████  | 8/10 [03:28<00:50, 25.02s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0026, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9564, 'compress@10': 0.4978, 'time@10': 33.8399}:  90%|█████████ | 9/10 [03:28<00:25, 25.41s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0039, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9607, 'compress@10': 0.5266, 'time@10': 34.1407}:  90%|█████████ | 9/10 [04:05<00:25, 25.41s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0039, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9607, 'compress@10': 0.5266, 'time@10': 34.1407}: 100%|██████████| 10/10 [04:05<00:00, 28.95s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0039, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9607, 'compress@10': 0.5266, 'time@10': 34.1407}: 100%|██████████| 10/10 [04:05<00:00, 24.52s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.0038824988747501897
Avg hit ratio: 0.900444657587272
Avg ndcg: 0.9607402693501387
Avg compression ratio: 0.526606897312879
Avg train time: 34.140690207481384
Std train time: 13.042058461529315
[0.9117647058823528, 0.5588235294117647, 0.02941176470588236, 0.3235294117647059, 0.9705882352941175, 0.9117647058823529, 0.38235294117647056, 0.02941176470588236, 0.08823529411764705, 0.7941176470588235]
[40, 40, 56, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9164, 'time@10': 28.5333}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9164, 'time@10': 28.5333}:  10%|█         | 1/10 [00:14<02:08, 14.30s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9576, 'compress@10': 0.7447, 'time@10': 27.3004}:  10%|█         | 1/10 [00:40<02:08, 14.30s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9576, 'compress@10': 0.7447, 'time@10': 27.3004}:  20%|██        | 2/10 [00:40<02:49, 21.25s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9241, 'compress@10': 0.5525, 'time@10': 22.4152}:  20%|██        | 2/10 [00:46<02:49, 21.25s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9241, 'compress@10': 0.5525, 'time@10': 22.4152}:  30%|███       | 3/10 [00:46<01:41, 14.46s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.9341, 'compress@10': 0.5013, 'time@10': 22.6521}:  30%|███       | 3/10 [01:10<01:41, 14.46s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.9341, 'compress@10': 0.5013, 'time@10': 22.6521}:  40%|████      | 4/10 [01:10<01:47, 17.99s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0011, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9433, 'compress@10': 0.5953, 'time@10': 29.7362}:  40%|████      | 4/10 [01:39<01:47, 17.99s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0011, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9433, 'compress@10': 0.5953, 'time@10': 29.7362}:  50%|█████     | 5/10 [01:39<01:49, 21.99s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0045, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9516, 'compress@10': 0.6483, 'time@10': 30.562}:  50%|█████     | 5/10 [02:13<01:49, 21.99s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0045, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9516, 'compress@10': 0.6483, 'time@10': 30.562}:  60%|██████    | 6/10 [02:13<01:45, 26.32s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0039, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9528, 'compress@10': 0.6139, 'time@10': 32.2777}:  60%|██████    | 6/10 [02:35<01:45, 26.32s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0039, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9528, 'compress@10': 0.6139, 'time@10': 32.2777}:  70%|███████   | 7/10 [02:35<01:14, 24.69s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0035, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9551, 'compress@10': 0.5443, 'time@10': 31.5016}:  70%|███████   | 7/10 [03:01<01:14, 24.69s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0035, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9551, 'compress@10': 0.5443, 'time@10': 31.5016}:  80%|████████  | 8/10 [03:01<00:50, 25.14s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0031, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.957, 'compress@10': 0.4965, 'time@10': 33.8513}:  80%|████████  | 8/10 [03:27<00:50, 25.14s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0031, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.957, 'compress@10': 0.4965, 'time@10': 33.8513}:  90%|█████████ | 9/10 [03:27<00:25, 25.52s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0039, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9591, 'compress@10': 0.5267, 'time@10': 34.107}:  90%|█████████ | 9/10 [04:04<00:25, 25.52s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0039, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9591, 'compress@10': 0.5267, 'time@10': 34.107}: 100%|██████████| 10/10 [04:04<00:00, 28.89s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0039, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9591, 'compress@10': 0.5267, 'time@10': 34.107}: 100%|██████████| 10/10 [04:04<00:00, 24.42s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.0038562450210699096
Avg hit ratio: 0.8964252003420086
Avg ndcg: 0.959073659128105
Avg compression ratio: 0.5267378997751775
Avg train time: 34.10703876018524
Std train time: 13.159826533396915
[0.9166666666666665, 0.5277777777777778, 0.027777777777777783, 0.3055555555555556, 0.9722222222222221, 0.9166666666666666, 0.41666666666666663, 0.027777777777777783, 0.08333333333333333, 0.8055555555555555]
[40, 40, 57, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.921, 'time@10': 28.4321}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.921, 'time@10': 28.4321}:  10%|█         | 1/10 [00:14<02:08, 14.25s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9576, 'compress@10': 0.732, 'time@10': 27.2256}:  10%|█         | 1/10 [00:40<02:08, 14.25s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9576, 'compress@10': 0.732, 'time@10': 27.2256}:  20%|██        | 2/10 [00:40<02:49, 21.20s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9241, 'compress@10': 0.5436, 'time@10': 22.2923}:  20%|██        | 2/10 [00:46<02:49, 21.20s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9241, 'compress@10': 0.5436, 'time@10': 22.2923}:  30%|███       | 3/10 [00:46<01:40, 14.38s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9341, 'compress@10': 0.4903, 'time@10': 22.5305}:  30%|███       | 3/10 [01:09<01:40, 14.38s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9341, 'compress@10': 0.4903, 'time@10': 22.5305}:  40%|████      | 4/10 [01:09<01:47, 17.89s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9433, 'compress@10': 0.5868, 'time@10': 29.527}:  40%|████      | 4/10 [01:38<01:47, 17.89s/it] {'epoch': 17, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9433, 'compress@10': 0.5868, 'time@10': 29.527}:  50%|█████     | 5/10 [01:38<01:49, 21.82s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0039, 'hit_ratio@10': 0.9106, 'ndcg@10': 0.9498, 'compress@10': 0.6421, 'time@10': 30.3388}:  50%|█████     | 5/10 [02:13<01:49, 21.82s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0039, 'hit_ratio@10': 0.9106, 'ndcg@10': 0.9498, 'compress@10': 0.6421, 'time@10': 30.3388}:  60%|██████    | 6/10 [02:13<01:44, 26.11s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0034, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9513, 'compress@10': 0.6132, 'time@10': 32.1626}:  60%|██████    | 6/10 [02:34<01:44, 26.11s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0034, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9513, 'compress@10': 0.6132, 'time@10': 32.1626}:  70%|███████   | 7/10 [02:34<01:13, 24.64s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.003, 'hit_ratio@10': 0.9244, 'ndcg@10': 0.9538, 'compress@10': 0.5435, 'time@10': 31.3858}:  70%|███████   | 7/10 [03:00<01:13, 24.64s/it]  {'epoch': 17, 'num_users': 6.125, 'loss': 0.003, 'hit_ratio@10': 0.9244, 'ndcg@10': 0.9538, 'compress@10': 0.5435, 'time@10': 31.3858}:  80%|████████  | 8/10 [03:00<00:50, 25.07s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0027, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9558, 'compress@10': 0.4953, 'time@10': 33.7236}:  80%|████████  | 8/10 [03:26<00:50, 25.07s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0027, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9558, 'compress@10': 0.4953, 'time@10': 33.7236}:  90%|█████████ | 9/10 [03:26<00:25, 25.44s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0035, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9578, 'compress@10': 0.5267, 'time@10': 33.989}:  90%|█████████ | 9/10 [04:03<00:25, 25.44s/it]    {'epoch': 17, 'num_users': 6.3, 'loss': 0.0035, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9578, 'compress@10': 0.5267, 'time@10': 33.989}: 100%|██████████| 10/10 [04:03<00:00, 28.83s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0035, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9578, 'compress@10': 0.5267, 'time@10': 33.989}: 100%|██████████| 10/10 [04:03<00:00, 24.33s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.0035306766201629986
Avg hit ratio: 0.9115045654213734
Avg ndcg: 0.9577922607942286
Avg compression ratio: 0.5267402825714622
Avg train time: 33.98899793624878
Std train time: 13.121581689198853
[0.9210526315789472, 0.5, 0.026315789473684216, 0.2894736842105263, 0.9736842105263157, 0.9210526315789473, 0.4473684210526315, 0.026315789473684216, 0.07894736842105263, 0.8157894736842104]
[40, 40, 58, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9252, 'time@10': 27.7524}:   0%|          | 0/10 [00:13<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9252, 'time@10': 27.7524}:  10%|█         | 1/10 [00:13<02:05, 13.91s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.7207, 'time@10': 27.0225}:  10%|█         | 1/10 [00:40<02:05, 13.91s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.7207, 'time@10': 27.0225}:  20%|██        | 2/10 [00:40<02:49, 21.22s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9241, 'compress@10': 0.5356, 'time@10': 22.449}:  20%|██        | 2/10 [00:46<02:49, 21.22s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9241, 'compress@10': 0.5356, 'time@10': 22.449}:  30%|███       | 3/10 [00:46<01:42, 14.58s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9341, 'compress@10': 0.4804, 'time@10': 22.5786}:  30%|███       | 3/10 [01:09<01:42, 14.58s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9341, 'compress@10': 0.4804, 'time@10': 22.5786}:  40%|████      | 4/10 [01:09<01:47, 17.91s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.001, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9433, 'compress@10': 0.5792, 'time@10': 29.5573}:  40%|████      | 4/10 [01:38<01:47, 17.91s/it] {'epoch': 18, 'num_users': 5.8, 'loss': 0.001, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9433, 'compress@10': 0.5792, 'time@10': 29.5573}:  50%|█████     | 5/10 [01:38<01:49, 21.83s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0031, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9517, 'compress@10': 0.6364, 'time@10': 30.388}:  50%|█████     | 5/10 [02:13<01:49, 21.83s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0031, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9517, 'compress@10': 0.6364, 'time@10': 30.388}:  60%|██████    | 6/10 [02:13<01:44, 26.16s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0027, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9529, 'compress@10': 0.6126, 'time@10': 32.0912}:  60%|██████    | 6/10 [02:34<01:44, 26.16s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0027, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9529, 'compress@10': 0.6126, 'time@10': 32.0912}:  70%|███████   | 7/10 [02:34<01:13, 24.54s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0024, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9552, 'compress@10': 0.5428, 'time@10': 31.3307}:  70%|███████   | 7/10 [03:00<01:13, 24.54s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0024, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9552, 'compress@10': 0.5428, 'time@10': 31.3307}:  80%|████████  | 8/10 [03:00<00:50, 25.02s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0021, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.957, 'compress@10': 0.4942, 'time@10': 33.6556}:  80%|████████  | 8/10 [03:26<00:50, 25.02s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0021, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.957, 'compress@10': 0.4942, 'time@10': 33.6556}:  90%|█████████ | 9/10 [03:26<00:25, 25.38s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0031, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9585, 'compress@10': 0.5267, 'time@10': 33.9477}:  90%|█████████ | 9/10 [04:03<00:25, 25.38s/it]  {'epoch': 18, 'num_users': 6.3, 'loss': 0.0031, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9585, 'compress@10': 0.5267, 'time@10': 33.9477}: 100%|██████████| 10/10 [04:03<00:00, 28.85s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0031, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9585, 'compress@10': 0.5267, 'time@10': 33.9477}: 100%|██████████| 10/10 [04:03<00:00, 24.33s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.003122463790306669
Avg hit ratio: 0.8935450160102112
Avg ndcg: 0.9584584900624067
Avg compression ratio: 0.5267433326692148
Avg train time: 33.94770452976227
Std train time: 12.932891761888136
[0.8749999999999999, 0.525, 0.025000000000000005, 0.275, 0.9749999999999999, 0.9249999999999999, 0.475, 0.025000000000000005, 0.075, 0.8249999999999998]
[40, 40, 59, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8816, 'time@10': 30.1441}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8816, 'time@10': 30.1441}:  10%|█         | 1/10 [00:15<02:16, 15.11s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.7109, 'time@10': 28.3677}:  10%|█         | 1/10 [00:41<02:16, 15.11s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.7109, 'time@10': 28.3677}:  20%|██        | 2/10 [00:41<02:55, 21.89s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9241, 'compress@10': 0.5287, 'time@10': 23.3719}:  20%|██        | 2/10 [00:48<02:55, 21.89s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9241, 'compress@10': 0.5287, 'time@10': 23.3719}:  30%|███       | 3/10 [00:48<01:44, 14.97s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9341, 'compress@10': 0.4718, 'time@10': 23.2909}:  30%|███       | 3/10 [01:11<01:44, 14.97s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9341, 'compress@10': 0.4718, 'time@10': 23.2909}:  40%|████      | 4/10 [01:11<01:49, 18.17s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9433, 'compress@10': 0.5725, 'time@10': 30.1205}:  40%|████      | 4/10 [01:40<01:49, 18.17s/it] {'epoch': 19, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9433, 'compress@10': 0.5725, 'time@10': 30.1205}:  50%|█████     | 5/10 [01:40<01:49, 21.99s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0019, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9482, 'compress@10': 0.6315, 'time@10': 30.8656}:  50%|█████     | 5/10 [02:14<01:49, 21.99s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0019, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9482, 'compress@10': 0.6315, 'time@10': 30.8656}:  60%|██████    | 6/10 [02:14<01:45, 26.29s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0017, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9499, 'compress@10': 0.6122, 'time@10': 32.4043}:  60%|██████    | 6/10 [02:35<01:45, 26.29s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0017, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9499, 'compress@10': 0.6122, 'time@10': 32.4043}:  70%|███████   | 7/10 [02:35<01:13, 24.51s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0015, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9526, 'compress@10': 0.5423, 'time@10': 31.567}:  70%|███████   | 7/10 [03:01<01:13, 24.51s/it]  {'epoch': 19, 'num_users': 6.125, 'loss': 0.0015, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9526, 'compress@10': 0.5423, 'time@10': 31.567}:  80%|████████  | 8/10 [03:01<00:49, 24.91s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0014, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9547, 'compress@10': 0.4933, 'time@10': 33.8275}:  80%|████████  | 8/10 [03:27<00:49, 24.91s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0014, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9547, 'compress@10': 0.4933, 'time@10': 33.8275}:  90%|█████████ | 9/10 [03:27<00:25, 25.25s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0021, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9569, 'compress@10': 0.5268, 'time@10': 34.0772}:  90%|█████████ | 9/10 [04:03<00:25, 25.25s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0021, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9569, 'compress@10': 0.5268, 'time@10': 34.0772}: 100%|██████████| 10/10 [04:03<00:00, 28.68s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0021, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9569, 'compress@10': 0.5268, 'time@10': 34.0772}: 100%|██████████| 10/10 [04:03<00:00, 24.39s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.002090044001227247
Avg hit ratio: 0.8853422510332528
Avg ndcg: 0.9569306020337827
Avg compression ratio: 0.5268479951980405
Avg train time: 34.07722895145416
Std train time: 12.719770938986901
[0.8333333333333333, 0.5476190476190477, 0.023809523809523815, 0.2619047619047619, 0.976190476190476, 0.9285714285714285, 0.5, 0.023809523809523815, 0.07142857142857142, 0.8333333333333331]
[40, 40, 60, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8421, 'time@10': 30.2362}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8421, 'time@10': 30.2362}:  10%|█         | 1/10 [00:15<02:16, 15.16s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.7021, 'time@10': 28.3564}:  10%|█         | 1/10 [00:41<02:16, 15.16s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.7021, 'time@10': 28.3564}:  20%|██        | 2/10 [00:41<02:54, 21.84s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5225, 'time@10': 23.3683}:  20%|██        | 2/10 [00:48<02:54, 21.84s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5225, 'time@10': 23.3683}:  30%|███       | 3/10 [00:48<01:44, 14.94s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.464, 'time@10': 23.215}:  30%|███       | 3/10 [01:11<01:44, 14.94s/it]  {'epoch': 20, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.464, 'time@10': 23.215}:  40%|████      | 4/10 [01:11<01:48, 18.04s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9433, 'compress@10': 0.5665, 'time@10': 30.0669}:  40%|████      | 4/10 [01:39<01:48, 18.04s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9433, 'compress@10': 0.5665, 'time@10': 30.0669}:  50%|█████     | 5/10 [01:39<01:49, 21.91s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0013, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9491, 'compress@10': 0.6271, 'time@10': 30.8061}:  50%|█████     | 5/10 [02:14<01:49, 21.91s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0013, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9491, 'compress@10': 0.6271, 'time@10': 30.8061}:  60%|██████    | 6/10 [02:14<01:44, 26.21s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0012, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9506, 'compress@10': 0.6118, 'time@10': 32.4718}:  60%|██████    | 6/10 [02:35<01:44, 26.21s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0012, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9506, 'compress@10': 0.6118, 'time@10': 32.4718}:  70%|███████   | 7/10 [02:35<01:13, 24.59s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.001, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9532, 'compress@10': 0.5418, 'time@10': 31.6156}:  70%|███████   | 7/10 [03:01<01:13, 24.59s/it]  {'epoch': 20, 'num_users': 6.125, 'loss': 0.001, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9532, 'compress@10': 0.5418, 'time@10': 31.6156}:  80%|████████  | 8/10 [03:01<00:49, 24.93s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0009, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9552, 'compress@10': 0.4925, 'time@10': 33.8977}:  80%|████████  | 8/10 [03:27<00:49, 24.93s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0009, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9552, 'compress@10': 0.4925, 'time@10': 33.8977}:  90%|█████████ | 9/10 [03:27<00:25, 25.30s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0014, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9574, 'compress@10': 0.5269, 'time@10': 34.0792}:  90%|█████████ | 9/10 [04:03<00:25, 25.30s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0014, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9574, 'compress@10': 0.5269, 'time@10': 34.0792}: 100%|██████████| 10/10 [04:03<00:00, 28.53s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0014, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9574, 'compress@10': 0.5269, 'time@10': 34.0792}: 100%|██████████| 10/10 [04:03<00:00, 24.33s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.0013670046009332578
Avg hit ratio: 0.8847513652165604
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5269417337117417
Avg train time: 34.079237651824954
Std train time: 12.835697100856516
[0.7954545454545454, 0.5681818181818182, 0.02272727272727273, 0.25, 0.9772727272727272, 0.9318181818181818, 0.5227272727272727, 0.02272727272727273, 0.06818181818181818, 0.8409090909090907]
[40, 40, 61, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8062, 'time@10': 30.1496}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8062, 'time@10': 30.1496}:  10%|█         | 1/10 [00:15<02:16, 15.11s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6942, 'time@10': 28.144}:  10%|█         | 1/10 [00:41<02:16, 15.11s/it] {'epoch': 21, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6942, 'time@10': 28.144}:  20%|██        | 2/10 [00:41<02:52, 21.62s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9241, 'compress@10': 0.5169, 'time@10': 23.3046}:  20%|██        | 2/10 [00:48<02:52, 21.62s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9241, 'compress@10': 0.5169, 'time@10': 23.3046}:  30%|███       | 3/10 [00:48<01:44, 14.88s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9341, 'compress@10': 0.4569, 'time@10': 23.291}:  30%|███       | 3/10 [01:11<01:44, 14.88s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9341, 'compress@10': 0.4569, 'time@10': 23.291}:  40%|████      | 4/10 [01:11<01:49, 18.20s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9433, 'compress@10': 0.561, 'time@10': 30.1277}:  40%|████      | 4/10 [01:40<01:49, 18.20s/it] {'epoch': 21, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9433, 'compress@10': 0.561, 'time@10': 30.1277}:  50%|█████     | 5/10 [01:40<01:50, 22.01s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0028, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9524, 'compress@10': 0.6231, 'time@10': 30.8992}:  50%|█████     | 5/10 [02:15<01:50, 22.01s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0028, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9524, 'compress@10': 0.6231, 'time@10': 30.8992}:  60%|██████    | 6/10 [02:15<01:45, 26.36s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0025, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9535, 'compress@10': 0.6115, 'time@10': 32.4851}:  60%|██████    | 6/10 [02:36<01:45, 26.36s/it] {'epoch': 21, 'num_users': 6.2857, 'loss': 0.0025, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9535, 'compress@10': 0.6115, 'time@10': 32.4851}:  70%|███████   | 7/10 [02:36<01:13, 24.62s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0022, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9557, 'compress@10': 0.5414, 'time@10': 31.6439}:  70%|███████   | 7/10 [03:01<01:13, 24.62s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0022, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9557, 'compress@10': 0.5414, 'time@10': 31.6439}:  80%|████████  | 8/10 [03:01<00:49, 24.99s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.002, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9574, 'compress@10': 0.4918, 'time@10': 33.8568}:  80%|████████  | 8/10 [03:27<00:49, 24.99s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.002, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9574, 'compress@10': 0.4918, 'time@10': 33.8568}:  90%|█████████ | 9/10 [03:27<00:25, 25.25s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0021, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9594, 'compress@10': 0.527, 'time@10': 34.0718}:  90%|█████████ | 9/10 [04:03<00:25, 25.25s/it]    {'epoch': 21, 'num_users': 6.3, 'loss': 0.0021, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9594, 'compress@10': 0.527, 'time@10': 34.0718}: 100%|██████████| 10/10 [04:03<00:00, 28.58s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0021, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9594, 'compress@10': 0.527, 'time@10': 34.0718}: 100%|██████████| 10/10 [04:03<00:00, 24.37s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.002140434356020008
Avg hit ratio: 0.8879771716681735
Avg ndcg: 0.9594295489003191
Avg compression ratio: 0.527026782950762
Avg train time: 34.07183737754822
Std train time: 12.661773296142242
[0.7608695652173912, 0.5869565217391305, 0.02173913043478261, 0.2391304347826087, 0.9782608695652173, 0.9347826086956521, 0.5434782608695652, 0.02173913043478261, 0.06521739130434782, 0.8478260869565215]
[40, 40, 62, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7734, 'time@10': 30.6614}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7734, 'time@10': 30.6614}:  10%|█         | 1/10 [00:15<02:18, 15.37s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6869, 'time@10': 28.2937}:  10%|█         | 1/10 [00:41<02:18, 15.37s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6869, 'time@10': 28.2937}:  20%|██        | 2/10 [00:41<02:52, 21.60s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9241, 'compress@10': 0.5117, 'time@10': 23.4784}:  20%|██        | 2/10 [00:48<02:52, 21.60s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9241, 'compress@10': 0.5117, 'time@10': 23.4784}:  30%|███       | 3/10 [00:48<01:44, 14.92s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9341, 'compress@10': 0.4504, 'time@10': 23.3139}:  30%|███       | 3/10 [01:11<01:44, 14.92s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9341, 'compress@10': 0.4504, 'time@10': 23.3139}:  40%|████      | 4/10 [01:11<01:48, 18.05s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9433, 'compress@10': 0.556, 'time@10': 29.9078}:  40%|████      | 4/10 [01:39<01:48, 18.05s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9433, 'compress@10': 0.556, 'time@10': 29.9078}:  50%|█████     | 5/10 [01:39<01:48, 21.70s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.004, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9544, 'compress@10': 0.6194, 'time@10': 30.6689}:  50%|█████     | 5/10 [02:13<01:48, 21.70s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.004, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9544, 'compress@10': 0.6194, 'time@10': 30.6689}:  60%|██████    | 6/10 [02:13<01:44, 26.06s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0035, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9552, 'compress@10': 0.6112, 'time@10': 32.2417}:  60%|██████    | 6/10 [02:34<01:44, 26.06s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0035, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9552, 'compress@10': 0.6112, 'time@10': 32.2417}:  70%|███████   | 7/10 [02:34<01:13, 24.37s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.003, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9572, 'compress@10': 0.541, 'time@10': 31.4663}:  70%|███████   | 7/10 [03:00<01:13, 24.37s/it]   {'epoch': 22, 'num_users': 6.125, 'loss': 0.003, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9572, 'compress@10': 0.541, 'time@10': 31.4663}:  80%|████████  | 8/10 [03:00<00:49, 24.91s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0027, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9588, 'compress@10': 0.4911, 'time@10': 33.6415}:  80%|████████  | 8/10 [03:26<00:49, 24.91s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0027, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9588, 'compress@10': 0.4911, 'time@10': 33.6415}:  90%|█████████ | 9/10 [03:26<00:25, 25.11s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0028, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9606, 'compress@10': 0.5271, 'time@10': 33.8174}:  90%|█████████ | 9/10 [04:01<00:25, 25.11s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0028, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9606, 'compress@10': 0.5271, 'time@10': 33.8174}: 100%|██████████| 10/10 [04:01<00:00, 28.30s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0028, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9606, 'compress@10': 0.5271, 'time@10': 33.8174}: 100%|██████████| 10/10 [04:01<00:00, 24.18s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.002803065004512102
Avg hit ratio: 0.8961799366451318
Avg ndcg: 0.9606459095818284
Avg compression ratio: 0.5271068208225261
Avg train time: 33.81744763851166
Std train time: 12.323343585916167
[0.7708333333333333, 0.5625, 0.020833333333333336, 0.22916666666666669, 0.9791666666666665, 0.9374999999999999, 0.5625, 0.020833333333333336, 0.0625, 0.8541666666666664]
[40, 40, 63, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7829, 'time@10': 30.1823}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7829, 'time@10': 30.1823}:  10%|█         | 1/10 [00:15<02:16, 15.14s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6797, 'time@10': 28.0749}:  10%|█         | 1/10 [00:41<02:16, 15.14s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6797, 'time@10': 28.0749}:  20%|██        | 2/10 [00:41<02:52, 21.53s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5067, 'time@10': 23.477}:  20%|██        | 2/10 [00:48<02:52, 21.53s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5067, 'time@10': 23.477}:  30%|███       | 3/10 [00:48<01:44, 14.98s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.4442, 'time@10': 23.5009}:  30%|███       | 3/10 [01:11<01:44, 14.98s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.4442, 'time@10': 23.5009}:  40%|████      | 4/10 [01:11<01:50, 18.38s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9433, 'compress@10': 0.5513, 'time@10': 30.0644}:  40%|████      | 4/10 [01:40<01:50, 18.38s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9433, 'compress@10': 0.5513, 'time@10': 30.0644}:  50%|█████     | 5/10 [01:40<01:49, 21.93s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0032, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9515, 'compress@10': 0.6159, 'time@10': 30.8208}:  50%|█████     | 5/10 [02:14<01:49, 21.93s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0032, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9515, 'compress@10': 0.6159, 'time@10': 30.8208}:  60%|██████    | 6/10 [02:14<01:45, 26.25s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0028, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9527, 'compress@10': 0.6108, 'time@10': 32.5224}:  60%|██████    | 6/10 [02:36<01:45, 26.25s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0028, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9527, 'compress@10': 0.6108, 'time@10': 32.5224}:  70%|███████   | 7/10 [02:36<01:13, 24.67s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0025, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.955, 'compress@10': 0.5405, 'time@10': 31.6241}:  70%|███████   | 7/10 [03:01<01:13, 24.67s/it]  {'epoch': 23, 'num_users': 6.125, 'loss': 0.0025, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.955, 'compress@10': 0.5405, 'time@10': 31.6241}:  80%|████████  | 8/10 [03:01<00:49, 24.89s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0022, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9568, 'compress@10': 0.4904, 'time@10': 33.7737}:  80%|████████  | 8/10 [03:27<00:49, 24.89s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0022, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9568, 'compress@10': 0.4904, 'time@10': 33.7737}:  90%|█████████ | 9/10 [03:27<00:25, 25.09s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0023, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9589, 'compress@10': 0.5271, 'time@10': 33.9647}:  90%|█████████ | 9/10 [04:02<00:25, 25.09s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0023, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9589, 'compress@10': 0.5271, 'time@10': 33.9647}: 100%|██████████| 10/10 [04:02<00:00, 28.37s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0023, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9589, 'compress@10': 0.5271, 'time@10': 33.9647}: 100%|██████████| 10/10 [04:02<00:00, 24.28s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.002289879192560936
Avg hit ratio: 0.8876085080737033
Avg ndcg: 0.9588864076541066
Avg compression ratio: 0.5270941860303962
Avg train time: 33.96468653678894
Std train time: 12.31785781440808
[0.7399999999999999, 0.54, 0.020000000000000004, 0.26, 0.9799999999999999, 0.94, 0.58, 0.020000000000000004, 0.06, 0.8599999999999998]
[40, 40, 64, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7537, 'time@10': 30.7772}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7537, 'time@10': 30.7772}:  10%|█         | 1/10 [00:15<02:18, 15.43s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6543, 'time@10': 28.3163}:  10%|█         | 1/10 [00:41<02:18, 15.43s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6543, 'time@10': 28.3163}:  20%|██        | 2/10 [00:41<02:52, 21.58s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9241, 'compress@10': 0.4895, 'time@10': 23.5035}:  20%|██        | 2/10 [00:48<02:52, 21.58s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9241, 'compress@10': 0.4895, 'time@10': 23.5035}:  30%|███       | 3/10 [00:48<01:44, 14.91s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9341, 'compress@10': 0.4387, 'time@10': 23.3992}:  30%|███       | 3/10 [01:11<01:44, 14.91s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9341, 'compress@10': 0.4387, 'time@10': 23.3992}:  40%|████      | 4/10 [01:11<01:48, 18.16s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9433, 'compress@10': 0.5471, 'time@10': 29.9439}:  40%|████      | 4/10 [01:39<01:48, 18.16s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9433, 'compress@10': 0.5471, 'time@10': 29.9439}:  50%|█████     | 5/10 [01:39<01:48, 21.74s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0032, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9522, 'compress@10': 0.6128, 'time@10': 30.6753}:  50%|█████     | 5/10 [02:13<01:48, 21.74s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0032, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9522, 'compress@10': 0.6128, 'time@10': 30.6753}:  60%|██████    | 6/10 [02:13<01:44, 26.04s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0028, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9533, 'compress@10': 0.6105, 'time@10': 32.2812}:  60%|██████    | 6/10 [02:34<01:44, 26.04s/it] {'epoch': 24, 'num_users': 6.2857, 'loss': 0.0028, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9533, 'compress@10': 0.6105, 'time@10': 32.2812}:  70%|███████   | 7/10 [02:34<01:13, 24.39s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0025, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9556, 'compress@10': 0.5402, 'time@10': 31.4479}:  70%|███████   | 7/10 [03:00<01:13, 24.39s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0025, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9556, 'compress@10': 0.5402, 'time@10': 31.4479}:  80%|████████  | 8/10 [03:00<00:49, 24.79s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0022, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9573, 'compress@10': 0.4898, 'time@10': 33.6179}:  80%|████████  | 8/10 [03:26<00:49, 24.79s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0022, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9573, 'compress@10': 0.4898, 'time@10': 33.6179}:  90%|█████████ | 9/10 [03:26<00:25, 25.02s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0022, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.9593, 'compress@10': 0.5271, 'time@10': 33.7517}:  90%|█████████ | 9/10 [04:01<00:25, 25.02s/it]  {'epoch': 24, 'num_users': 6.3, 'loss': 0.0022, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.9593, 'compress@10': 0.5271, 'time@10': 33.7517}: 100%|██████████| 10/10 [04:01<00:00, 28.10s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0022, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.9593, 'compress@10': 0.5271, 'time@10': 33.7517}: 100%|██████████| 10/10 [04:01<00:00, 24.11s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.0022341321153575055
Avg hit ratio: 0.9041164445816399
Avg ndcg: 0.9593144234064439
Avg compression ratio: 0.5271494548389606
Avg train time: 33.751689839363095
Std train time: 12.295421190602893
[0.7115384615384615, 0.5192307692307693, 0.019230769230769235, 0.2884615384615385, 0.9807692307692306, 0.9423076923076923, 0.5961538461538461, 0.019230769230769235, 0.05769230769230769, 0.8653846153846152]
[40, 40, 65, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7267, 'time@10': 30.3284}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7267, 'time@10': 30.3284}:  10%|█         | 1/10 [00:15<02:16, 15.20s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6307, 'time@10': 28.1416}:  10%|█         | 1/10 [00:41<02:16, 15.20s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6307, 'time@10': 28.1416}:  20%|██        | 2/10 [00:41<02:52, 21.55s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9241, 'compress@10': 0.4736, 'time@10': 23.7161}:  20%|██        | 2/10 [00:48<02:52, 21.55s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9241, 'compress@10': 0.4736, 'time@10': 23.7161}:  30%|███       | 3/10 [00:48<01:45, 15.12s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7849, 'ndcg@10': 0.9341, 'compress@10': 0.4337, 'time@10': 23.4614}:  30%|███       | 3/10 [01:11<01:45, 15.12s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7849, 'ndcg@10': 0.9341, 'compress@10': 0.4337, 'time@10': 23.4614}:  40%|████      | 4/10 [01:11<01:48, 18.14s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.824, 'ndcg@10': 0.9433, 'compress@10': 0.5432, 'time@10': 29.8025}:  40%|████      | 4/10 [01:39<01:48, 18.14s/it] {'epoch': 25, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.824, 'ndcg@10': 0.9433, 'compress@10': 0.5432, 'time@10': 29.8025}:  50%|█████     | 5/10 [01:39<01:47, 21.56s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.001, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.9491, 'compress@10': 0.6099, 'time@10': 30.3891}:  50%|█████     | 5/10 [02:12<01:47, 21.56s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.001, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.9491, 'compress@10': 0.6099, 'time@10': 30.3891}:  60%|██████    | 6/10 [02:12<01:42, 25.57s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.001, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9506, 'compress@10': 0.6102, 'time@10': 31.8635}:  60%|██████    | 6/10 [02:32<01:42, 25.57s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.001, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9506, 'compress@10': 0.6102, 'time@10': 31.8635}:  70%|███████   | 7/10 [02:32<01:11, 23.88s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0008, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9532, 'compress@10': 0.5399, 'time@10': 30.9144}:  70%|███████   | 7/10 [02:57<01:11, 23.88s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0008, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9532, 'compress@10': 0.5399, 'time@10': 30.9144}:  80%|████████  | 8/10 [02:57<00:48, 24.01s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0008, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9552, 'compress@10': 0.4893, 'time@10': 32.8293}:  80%|████████  | 8/10 [03:21<00:48, 24.01s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0008, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9552, 'compress@10': 0.4893, 'time@10': 32.8293}:  90%|█████████ | 9/10 [03:21<00:24, 24.05s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0009, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 32.925}:  90%|█████████ | 9/10 [03:55<00:24, 24.05s/it]    {'epoch': 25, 'num_users': 6.3, 'loss': 0.0009, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 32.925}: 100%|██████████| 10/10 [03:55<00:00, 27.07s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0009, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 32.925}: 100%|██████████| 10/10 [03:55<00:00, 23.51s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.0008968929190448147
Avg hit ratio: 0.8704656509308462
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5272014137674852
Avg train time: 32.9249915599823
Std train time: 11.614477901182047
[0.7222222222222221, 0.5, 0.018518518518518524, 0.2777777777777778, 0.9814814814814813, 0.9444444444444444, 0.611111111111111, 0.018518518518518524, 0.05555555555555555, 0.8703703703703702]
[40, 40, 66, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7368, 'time@10': 30.3756}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7368, 'time@10': 30.3756}:  10%|█         | 1/10 [00:15<02:17, 15.30s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6265, 'time@10': 27.7146}:  10%|█         | 1/10 [00:40<02:17, 15.30s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6265, 'time@10': 27.7146}:  20%|██        | 2/10 [00:40<02:48, 21.06s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.4706, 'time@10': 23.218}:  20%|██        | 2/10 [00:47<02:48, 21.06s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.4706, 'time@10': 23.218}:  30%|███       | 3/10 [00:47<01:42, 14.71s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.4288, 'time@10': 22.8971}:  30%|███       | 3/10 [01:09<01:42, 14.71s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.4288, 'time@10': 22.8971}:  40%|████      | 4/10 [01:09<01:45, 17.58s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.001, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9433, 'compress@10': 0.5394, 'time@10': 29.0294}:  40%|████      | 4/10 [01:36<01:45, 17.58s/it] {'epoch': 26, 'num_users': 5.8, 'loss': 0.001, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9433, 'compress@10': 0.5394, 'time@10': 29.0294}:  50%|█████     | 5/10 [01:36<01:44, 20.91s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0026, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.949, 'compress@10': 0.6071, 'time@10': 29.7219}:  50%|█████     | 5/10 [02:09<01:44, 20.91s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0026, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.949, 'compress@10': 0.6071, 'time@10': 29.7219}:  60%|██████    | 6/10 [02:09<01:40, 25.10s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0023, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9506, 'compress@10': 0.6099, 'time@10': 31.2205}:  60%|██████    | 6/10 [02:29<01:40, 25.10s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0023, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9506, 'compress@10': 0.6099, 'time@10': 31.2205}:  70%|███████   | 7/10 [02:29<01:10, 23.48s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.002, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9532, 'compress@10': 0.5395, 'time@10': 30.3574}:  70%|███████   | 7/10 [02:54<01:10, 23.48s/it]  {'epoch': 26, 'num_users': 6.125, 'loss': 0.002, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9532, 'compress@10': 0.5395, 'time@10': 30.3574}:  80%|████████  | 8/10 [02:54<00:47, 23.76s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0018, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9552, 'compress@10': 0.4887, 'time@10': 32.3262}:  80%|████████  | 8/10 [03:18<00:47, 23.76s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0018, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9552, 'compress@10': 0.4887, 'time@10': 32.3262}:  90%|█████████ | 9/10 [03:18<00:23, 23.86s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0017, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 32.4353}:  90%|█████████ | 9/10 [03:51<00:23, 23.86s/it]    {'epoch': 26, 'num_users': 6.3, 'loss': 0.0017, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 32.4353}: 100%|██████████| 10/10 [03:51<00:00, 26.82s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0017, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 32.4353}: 100%|██████████| 10/10 [03:51<00:00, 23.16s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.0017492542378240588
Avg hit ratio: 0.8869735874387826
Avg ndcg: 0.9574398149357043
Avg compression ratio: 0.5271858143650601
Avg train time: 32.43528826236725
Std train time: 11.486450387691423
[0.732142857142857, 0.48214285714285715, 0.017857142857142863, 0.26785714285714285, 0.982142857142857, 0.9464285714285714, 0.6249999999999999, 0.017857142857142863, 0.05357142857142857, 0.8749999999999999]
[40, 40, 67, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7462, 'time@10': 29.6244}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7462, 'time@10': 29.6244}:  10%|█         | 1/10 [00:14<02:13, 14.85s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6225, 'time@10': 27.2353}:  10%|█         | 1/10 [00:39<02:13, 14.85s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6225, 'time@10': 27.2353}:  20%|██        | 2/10 [00:39<02:46, 20.75s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9241, 'compress@10': 0.4678, 'time@10': 22.7958}:  20%|██        | 2/10 [00:46<02:46, 20.75s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9241, 'compress@10': 0.4678, 'time@10': 22.7958}:  30%|███       | 3/10 [00:46<01:41, 14.47s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.7849, 'ndcg@10': 0.9341, 'compress@10': 0.4243, 'time@10': 22.6254}:  30%|███       | 3/10 [01:08<01:41, 14.47s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.7849, 'ndcg@10': 0.9341, 'compress@10': 0.4243, 'time@10': 22.6254}:  40%|████      | 4/10 [01:08<01:45, 17.50s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.824, 'ndcg@10': 0.9433, 'compress@10': 0.5359, 'time@10': 28.9722}:  40%|████      | 4/10 [01:36<01:45, 17.50s/it] {'epoch': 27, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.824, 'ndcg@10': 0.9433, 'compress@10': 0.5359, 'time@10': 28.9722}:  50%|█████     | 5/10 [01:36<01:45, 21.01s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0009, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.9491, 'compress@10': 0.6046, 'time@10': 29.634}:  50%|█████     | 5/10 [02:09<01:45, 21.01s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0009, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.9491, 'compress@10': 0.6046, 'time@10': 29.634}:  60%|██████    | 6/10 [02:09<01:40, 25.08s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0008, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9506, 'compress@10': 0.6096, 'time@10': 31.0862}:  60%|██████    | 6/10 [02:29<01:40, 25.08s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0008, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9506, 'compress@10': 0.6096, 'time@10': 31.0862}:  70%|███████   | 7/10 [02:29<01:10, 23.40s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0007, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9532, 'compress@10': 0.5392, 'time@10': 30.2572}:  70%|███████   | 7/10 [02:53<01:10, 23.40s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0007, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9532, 'compress@10': 0.5392, 'time@10': 30.2572}:  80%|████████  | 8/10 [02:53<00:47, 23.74s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0007, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.9552, 'compress@10': 0.4882, 'time@10': 32.341}:  80%|████████  | 8/10 [03:18<00:47, 23.74s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0007, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.9552, 'compress@10': 0.4882, 'time@10': 32.341}:  90%|█████████ | 9/10 [03:18<00:23, 24.00s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0008, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 32.5214}:  90%|█████████ | 9/10 [03:52<00:23, 24.00s/it]  {'epoch': 27, 'num_users': 6.3, 'loss': 0.0008, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 32.5214}: 100%|██████████| 10/10 [03:52<00:00, 27.14s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0008, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 32.5214}: 100%|██████████| 10/10 [03:52<00:00, 23.22s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.0007658937772750771
Avg hit ratio: 0.8676085080737034
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5271733215255383
Avg train time: 32.52144935131073
Std train time: 11.795924335044386
[0.7413793103448274, 0.46551724137931033, 0.017241379310344834, 0.25862068965517243, 0.982758620689655, 0.9482758620689655, 0.6379310344827586, 0.017241379310344834, 0.05172413793103448, 0.8793103448275861]
[40, 40, 68, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.755, 'time@10': 29.5664}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.755, 'time@10': 29.5664}:  10%|█         | 1/10 [00:14<02:13, 14.82s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.6189, 'time@10': 27.3208}:  10%|█         | 1/10 [00:39<02:13, 14.82s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.6189, 'time@10': 27.3208}:  20%|██        | 2/10 [00:39<02:47, 20.88s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9241, 'compress@10': 0.4651, 'time@10': 22.9021}:  20%|██        | 2/10 [00:47<02:47, 20.88s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9241, 'compress@10': 0.4651, 'time@10': 22.9021}:  30%|███       | 3/10 [00:47<01:41, 14.57s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.9341, 'compress@10': 0.4201, 'time@10': 22.6779}:  30%|███       | 3/10 [01:09<01:41, 14.57s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.9341, 'compress@10': 0.4201, 'time@10': 22.6779}:  40%|████      | 4/10 [01:09<01:45, 17.52s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0013, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9426, 'compress@10': 0.5327, 'time@10': 28.8993}:  40%|████      | 4/10 [01:35<01:45, 17.52s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0013, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9426, 'compress@10': 0.5327, 'time@10': 28.8993}:  50%|█████     | 5/10 [01:35<01:44, 20.91s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0037, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9507, 'compress@10': 0.6022, 'time@10': 29.5886}:  50%|█████     | 5/10 [02:09<01:44, 20.91s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0037, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9507, 'compress@10': 0.6022, 'time@10': 29.5886}:  60%|██████    | 6/10 [02:09<01:40, 25.05s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0032, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.952, 'compress@10': 0.6093, 'time@10': 31.0167}:  60%|██████    | 6/10 [02:28<01:40, 25.05s/it] {'epoch': 28, 'num_users': 6.2857, 'loss': 0.0032, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.952, 'compress@10': 0.6093, 'time@10': 31.0167}:  70%|███████   | 7/10 [02:28<01:10, 23.34s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0028, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9545, 'compress@10': 0.5388, 'time@10': 30.1455}:  70%|███████   | 7/10 [02:52<01:10, 23.34s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0028, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9545, 'compress@10': 0.5388, 'time@10': 30.1455}:  80%|████████  | 8/10 [02:52<00:47, 23.58s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0025, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9563, 'compress@10': 0.4877, 'time@10': 32.126}:  80%|████████  | 8/10 [03:16<00:47, 23.58s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0025, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9563, 'compress@10': 0.4877, 'time@10': 32.126}:  90%|█████████ | 9/10 [03:16<00:23, 23.72s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0024, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9584, 'compress@10': 0.5272, 'time@10': 32.2656}:  90%|█████████ | 9/10 [03:50<00:23, 23.72s/it]  {'epoch': 28, 'num_users': 6.3, 'loss': 0.0024, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9584, 'compress@10': 0.5272, 'time@10': 32.2656}: 100%|██████████| 10/10 [03:50<00:00, 26.76s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0024, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9584, 'compress@10': 0.5272, 'time@10': 32.2656}: 100%|██████████| 10/10 [03:50<00:00, 23.05s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.002427148150626891
Avg hit ratio: 0.8859131945210045
Avg ndcg: 0.9584324525981026
Avg compression ratio: 0.5271590797312486
Avg train time: 32.26558406352997
Std train time: 11.526297375833325
[0.7499999999999998, 0.45, 0.016666666666666673, 0.2833333333333333, 0.9833333333333332, 0.95, 0.6166666666666666, 0.016666666666666673, 0.05, 0.8833333333333332]
[40, 40, 69, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7632, 'time@10': 28.8728}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7632, 'time@10': 28.8728}:  10%|█         | 1/10 [00:14<02:10, 14.47s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.6154, 'time@10': 27.2593}:  10%|█         | 1/10 [00:40<02:10, 14.47s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.6154, 'time@10': 27.2593}:  20%|██        | 2/10 [00:40<02:48, 21.07s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9241, 'compress@10': 0.4627, 'time@10': 23.278}:  20%|██        | 2/10 [00:47<02:48, 21.07s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9241, 'compress@10': 0.4627, 'time@10': 23.278}:  30%|███       | 3/10 [00:47<01:44, 14.96s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9341, 'compress@10': 0.4242, 'time@10': 22.9686}:  30%|███       | 3/10 [01:09<01:44, 14.96s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9341, 'compress@10': 0.4242, 'time@10': 22.9686}:  40%|████      | 4/10 [01:09<01:46, 17.77s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0015, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9415, 'compress@10': 0.5361, 'time@10': 29.3204}:  40%|████      | 4/10 [01:37<01:46, 17.77s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0015, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9415, 'compress@10': 0.5361, 'time@10': 29.3204}:  50%|█████     | 5/10 [01:37<01:46, 21.24s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0016, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9476, 'compress@10': 0.6053, 'time@10': 29.8902}:  50%|█████     | 5/10 [02:10<01:46, 21.24s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0016, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9476, 'compress@10': 0.6053, 'time@10': 29.8902}:  60%|██████    | 6/10 [02:10<01:40, 25.16s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0014, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9493, 'compress@10': 0.6091, 'time@10': 31.2547}:  60%|██████    | 6/10 [02:29<01:40, 25.16s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0014, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9493, 'compress@10': 0.6091, 'time@10': 31.2547}:  70%|███████   | 7/10 [02:29<01:10, 23.40s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0012, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9521, 'compress@10': 0.5386, 'time@10': 30.3472}:  70%|███████   | 7/10 [02:53<01:10, 23.40s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0012, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9521, 'compress@10': 0.5386, 'time@10': 30.3472}:  80%|████████  | 8/10 [02:53<00:47, 23.60s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0011, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9542, 'compress@10': 0.4873, 'time@10': 32.3296}:  80%|████████  | 8/10 [03:18<00:47, 23.60s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0011, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9542, 'compress@10': 0.4873, 'time@10': 32.3296}:  90%|█████████ | 9/10 [03:18<00:23, 23.77s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0011, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9565, 'compress@10': 0.5272, 'time@10': 32.44}:  90%|█████████ | 9/10 [03:51<00:23, 23.77s/it]      {'epoch': 29, 'num_users': 6.3, 'loss': 0.0011, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9565, 'compress@10': 0.5272, 'time@10': 32.44}: 100%|██████████| 10/10 [03:51<00:00, 26.76s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0011, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9565, 'compress@10': 0.5272, 'time@10': 32.44}: 100%|██████████| 10/10 [03:51<00:00, 23.15s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.0011370460342345439
Avg hit ratio: 0.8839925596003695
Avg ndcg: 0.956547582684052
Avg compression ratio: 0.5271619519463696
Avg train time: 32.43995153903961
Std train time: 11.517179543751103
[0.758064516129032, 0.43548387096774194, 0.016129032258064523, 0.3064516129032258, 0.9838709677419353, 0.9516129032258064, 0.596774193548387, 0.016129032258064523, 0.048387096774193554, 0.8870967741935483]
[40, 40, 70, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7708, 'time@10': 29.1293}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7708, 'time@10': 29.1293}:  10%|█         | 1/10 [00:14<02:11, 14.63s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.6122, 'time@10': 27.0459}:  10%|█         | 1/10 [00:39<02:11, 14.63s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.6122, 'time@10': 27.0459}:  20%|██        | 2/10 [00:39<02:45, 20.73s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.4604, 'time@10': 22.9893}:  20%|██        | 2/10 [00:47<02:45, 20.73s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.4604, 'time@10': 22.9893}:  30%|███       | 3/10 [00:47<01:42, 14.68s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.9341, 'compress@10': 0.4281, 'time@10': 22.7215}:  30%|███       | 3/10 [01:09<01:42, 14.68s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.9341, 'compress@10': 0.4281, 'time@10': 22.7215}:  40%|████      | 4/10 [01:09<01:45, 17.55s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0007, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9433, 'compress@10': 0.5393, 'time@10': 28.9217}:  40%|████      | 4/10 [01:35<01:45, 17.55s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0007, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9433, 'compress@10': 0.5393, 'time@10': 28.9217}:  50%|█████     | 5/10 [01:35<01:44, 20.92s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0017, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9492, 'compress@10': 0.6082, 'time@10': 29.5469}:  50%|█████     | 5/10 [02:08<01:44, 20.92s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0017, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9492, 'compress@10': 0.6082, 'time@10': 29.5469}:  60%|██████    | 6/10 [02:08<01:39, 24.93s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0014, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9508, 'compress@10': 0.6089, 'time@10': 31.0386}:  60%|██████    | 6/10 [02:28<01:39, 24.93s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0014, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9508, 'compress@10': 0.6089, 'time@10': 31.0386}:  70%|███████   | 7/10 [02:28<01:09, 23.33s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0013, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9533, 'compress@10': 0.5383, 'time@10': 30.2047}:  70%|███████   | 7/10 [02:53<01:09, 23.33s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0013, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9533, 'compress@10': 0.5383, 'time@10': 30.2047}:  80%|████████  | 8/10 [02:53<00:47, 23.67s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0011, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9554, 'compress@10': 0.4869, 'time@10': 32.2548}:  80%|████████  | 8/10 [03:17<00:47, 23.67s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0011, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9554, 'compress@10': 0.4869, 'time@10': 32.2548}:  90%|█████████ | 9/10 [03:17<00:23, 23.89s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0014, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9575, 'compress@10': 0.5272, 'time@10': 32.4016}:  90%|█████████ | 9/10 [03:51<00:23, 23.89s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0014, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9575, 'compress@10': 0.5272, 'time@10': 32.4016}: 100%|██████████| 10/10 [03:51<00:00, 26.94s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0014, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9575, 'compress@10': 0.5272, 'time@10': 32.4016}: 100%|██████████| 10/10 [03:51<00:00, 23.12s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.0013648624276471077
Avg hit ratio: 0.8787933788528017
Avg ndcg: 0.957544485343439
Avg compression ratio: 0.5271626515903398
Avg train time: 32.401634430885316
Std train time: 11.514478311668299
[0.7343749999999998, 0.453125, 0.015625000000000007, 0.328125, 0.9843749999999998, 0.9531249999999999, 0.5781249999999999, 0.015625000000000007, 0.04687500000000001, 0.8906249999999999]
[40, 40, 71, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7484, 'time@10': 29.8821}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7484, 'time@10': 29.8821}:  10%|█         | 1/10 [00:14<02:14, 14.98s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.6096, 'time@10': 27.5196}:  10%|█         | 1/10 [00:40<02:14, 14.98s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.6096, 'time@10': 27.5196}:  20%|██        | 2/10 [00:40<02:47, 20.99s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9241, 'compress@10': 0.4585, 'time@10': 23.4134}:  20%|██        | 2/10 [00:47<02:47, 20.99s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9241, 'compress@10': 0.4585, 'time@10': 23.4134}:  30%|███       | 3/10 [00:47<01:44, 14.89s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9341, 'compress@10': 0.4319, 'time@10': 23.1513}:  30%|███       | 3/10 [01:10<01:44, 14.89s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9341, 'compress@10': 0.4319, 'time@10': 23.1513}:  40%|████      | 4/10 [01:10<01:47, 17.86s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0011, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9433, 'compress@10': 0.5424, 'time@10': 29.2713}:  40%|████      | 4/10 [01:37<01:47, 17.86s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0011, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9433, 'compress@10': 0.5424, 'time@10': 29.2713}:  50%|█████     | 5/10 [01:37<01:45, 21.12s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0009, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9491, 'compress@10': 0.6111, 'time@10': 29.8727}:  50%|█████     | 5/10 [02:10<01:45, 21.12s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0009, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9491, 'compress@10': 0.6111, 'time@10': 29.8727}:  60%|██████    | 6/10 [02:10<01:40, 25.13s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0008, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9506, 'compress@10': 0.6088, 'time@10': 31.3421}:  60%|██████    | 6/10 [02:30<01:40, 25.13s/it] {'epoch': 31, 'num_users': 6.2857, 'loss': 0.0008, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9506, 'compress@10': 0.6088, 'time@10': 31.3421}:  70%|███████   | 7/10 [02:30<01:10, 23.49s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0007, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.9532, 'compress@10': 0.5381, 'time@10': 30.5006}:  70%|███████   | 7/10 [02:54<01:10, 23.49s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0007, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.9532, 'compress@10': 0.5381, 'time@10': 30.5006}:  80%|████████  | 8/10 [02:54<00:47, 23.86s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0006, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9552, 'compress@10': 0.4866, 'time@10': 32.6276}:  80%|████████  | 8/10 [03:19<00:47, 23.86s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0006, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9552, 'compress@10': 0.4866, 'time@10': 32.6276}:  90%|█████████ | 9/10 [03:19<00:24, 24.17s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0012, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 32.6747}:  90%|█████████ | 9/10 [03:52<00:24, 24.17s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0012, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 32.6747}: 100%|██████████| 10/10 [03:52<00:00, 26.94s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0012, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 32.6747}: 100%|██████████| 10/10 [03:52<00:00, 23.28s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.0011799491100220947
Avg hit ratio: 0.8892183660519825
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5272284987327149
Avg train time: 32.67465999126434
Std train time: 11.52982671195064
[0.7121212121212119, 0.4696969696969697, 0.015151515151515159, 0.3484848484848485, 0.9848484848484846, 0.9242424242424241, 0.5606060606060606, 0.015151515151515159, 0.07575757575757576, 0.8939393939393938]
[40, 40, 72, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7273, 'time@10': 29.8579}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7273, 'time@10': 29.8579}:  10%|█         | 1/10 [00:14<02:14, 14.97s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.607, 'time@10': 27.349}:  10%|█         | 1/10 [00:39<02:14, 14.97s/it]  {'epoch': 32, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.607, 'time@10': 27.349}:  20%|██        | 2/10 [00:39<02:46, 20.80s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9241, 'compress@10': 0.4566, 'time@10': 23.4446}:  20%|██        | 2/10 [00:47<02:46, 20.80s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9241, 'compress@10': 0.4566, 'time@10': 23.4446}:  30%|███       | 3/10 [00:47<01:44, 14.89s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9341, 'compress@10': 0.4354, 'time@10': 23.0889}:  30%|███       | 3/10 [01:09<01:44, 14.89s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9341, 'compress@10': 0.4354, 'time@10': 23.0889}:  40%|████      | 4/10 [01:09<01:46, 17.72s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9433, 'compress@10': 0.5454, 'time@10': 29.0618}:  40%|████      | 4/10 [01:36<01:46, 17.72s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9433, 'compress@10': 0.5454, 'time@10': 29.0618}:  50%|█████     | 5/10 [01:36<01:44, 20.89s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0026, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9491, 'compress@10': 0.6088, 'time@10': 29.6651}:  50%|█████     | 5/10 [02:08<01:44, 20.89s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0026, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9491, 'compress@10': 0.6088, 'time@10': 29.6651}:  60%|██████    | 6/10 [02:08<01:39, 24.91s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0023, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9506, 'compress@10': 0.6044, 'time@10': 31.1117}:  60%|██████    | 6/10 [02:28<01:39, 24.91s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0023, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9506, 'compress@10': 0.6044, 'time@10': 31.1117}:  70%|███████   | 7/10 [02:28<01:09, 23.28s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.002, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9532, 'compress@10': 0.5343, 'time@10': 30.2265}:  70%|███████   | 7/10 [02:52<01:09, 23.28s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.002, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9532, 'compress@10': 0.5343, 'time@10': 30.2265}:  80%|████████  | 8/10 [02:52<00:47, 23.53s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0018, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9553, 'compress@10': 0.4863, 'time@10': 32.1595}:  80%|████████  | 8/10 [03:16<00:47, 23.53s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0018, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9553, 'compress@10': 0.4863, 'time@10': 32.1595}:  90%|█████████ | 9/10 [03:16<00:23, 23.63s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.003, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9557, 'compress@10': 0.5273, 'time@10': 32.2065}:  90%|█████████ | 9/10 [03:49<00:23, 23.63s/it]    {'epoch': 32, 'num_users': 6.3, 'loss': 0.003, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9557, 'compress@10': 0.5273, 'time@10': 32.2065}: 100%|██████████| 10/10 [03:49<00:00, 26.42s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.003, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9557, 'compress@10': 0.5273, 'time@10': 32.2065}: 100%|██████████| 10/10 [03:49<00:00, 22.95s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.00298371548101551
Avg hit ratio: 0.8812818581154744
Avg ndcg: 0.9557488443215384
Avg compression ratio: 0.5272711509766121
Avg train time: 32.20645337104797
Std train time: 11.095182024861069
[0.6911764705882351, 0.4852941176470589, 0.014705882352941183, 0.36764705882352944, 0.9852941176470587, 0.9264705882352939, 0.5441176470588235, 0.014705882352941183, 0.07352941176470588, 0.8970588235294117]
[40, 40, 73, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7074, 'time@10': 30.2335}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7074, 'time@10': 30.2335}:  10%|█         | 1/10 [00:15<02:16, 15.17s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.6047, 'time@10': 28.1385}:  10%|█         | 1/10 [00:41<02:16, 15.17s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.6047, 'time@10': 28.1385}:  20%|██        | 2/10 [00:41<02:52, 21.59s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7314, 'ndcg@10': 0.9241, 'compress@10': 0.4549, 'time@10': 23.8164}:  20%|██        | 2/10 [00:48<02:52, 21.59s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7314, 'ndcg@10': 0.9241, 'compress@10': 0.4549, 'time@10': 23.8164}:  30%|███       | 3/10 [00:48<01:46, 15.21s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7807, 'ndcg@10': 0.9341, 'compress@10': 0.4388, 'time@10': 23.4565}:  30%|███       | 3/10 [01:11<01:46, 15.21s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7807, 'ndcg@10': 0.9341, 'compress@10': 0.4388, 'time@10': 23.4565}:  40%|████      | 4/10 [01:11<01:48, 18.05s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0007, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.9433, 'compress@10': 0.5481, 'time@10': 29.5199}:  40%|████      | 4/10 [01:38<01:48, 18.05s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0007, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.9433, 'compress@10': 0.5481, 'time@10': 29.5199}:  50%|█████     | 5/10 [01:38<01:46, 21.25s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0011, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9491, 'compress@10': 0.6114, 'time@10': 30.0531}:  50%|█████     | 5/10 [02:10<01:46, 21.25s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0011, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9491, 'compress@10': 0.6114, 'time@10': 30.0531}:  60%|██████    | 6/10 [02:10<01:40, 25.16s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.001, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.9506, 'compress@10': 0.6044, 'time@10': 31.4746}:  60%|██████    | 6/10 [02:31<01:40, 25.16s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.001, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.9506, 'compress@10': 0.6044, 'time@10': 31.4746}:  70%|███████   | 7/10 [02:31<01:10, 23.49s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0009, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9532, 'compress@10': 0.5342, 'time@10': 30.4944}:  70%|███████   | 7/10 [02:54<01:10, 23.49s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.0009, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9532, 'compress@10': 0.5342, 'time@10': 30.4944}:  80%|████████  | 8/10 [02:54<00:47, 23.55s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0008, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.9552, 'compress@10': 0.486, 'time@10': 32.4299}:  80%|████████  | 8/10 [03:18<00:47, 23.55s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0008, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.9552, 'compress@10': 0.486, 'time@10': 32.4299}:  90%|█████████ | 9/10 [03:18<00:23, 23.69s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0014, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9575, 'compress@10': 0.5273, 'time@10': 32.5081}:  90%|█████████ | 9/10 [03:51<00:23, 23.69s/it]  {'epoch': 33, 'num_users': 6.3, 'loss': 0.0014, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9575, 'compress@10': 0.5273, 'time@10': 32.5081}: 100%|██████████| 10/10 [03:51<00:00, 26.64s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0014, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9575, 'compress@10': 0.5273, 'time@10': 32.5081}: 100%|██████████| 10/10 [03:51<00:00, 23.19s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.001400451082856718
Avg hit ratio: 0.864773921607538
Avg ndcg: 0.957535440464719
Avg compression ratio: 0.5273292514743873
Avg train time: 32.508145451545715
Std train time: 11.292499304418888
[0.6999999999999997, 0.4714285714285715, 0.014285714285714292, 0.38571428571428573, 0.9857142857142855, 0.9285714285714284, 0.5285714285714286, 0.014285714285714292, 0.07142857142857142, 0.8999999999999999]
[40, 40, 74, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7158, 'time@10': 29.939}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7158, 'time@10': 29.939}:  10%|█         | 1/10 [00:15<02:15, 15.01s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.6021, 'time@10': 27.6131}:  10%|█         | 1/10 [00:40<02:15, 15.01s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.6021, 'time@10': 27.6131}:  20%|██        | 2/10 [00:40<02:48, 21.08s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9241, 'compress@10': 0.4531, 'time@10': 23.676}:  20%|██        | 2/10 [00:48<02:48, 21.08s/it]  {'epoch': 34, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9241, 'compress@10': 0.4531, 'time@10': 23.676}:  30%|███       | 3/10 [00:48<01:45, 15.08s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9341, 'compress@10': 0.4418, 'time@10': 23.1954}:  30%|███       | 3/10 [01:10<01:45, 15.08s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9341, 'compress@10': 0.4418, 'time@10': 23.1954}:  40%|████      | 4/10 [01:10<01:46, 17.73s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.9433, 'compress@10': 0.5506, 'time@10': 29.3525}:  40%|████      | 4/10 [01:37<01:46, 17.73s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.9433, 'compress@10': 0.5506, 'time@10': 29.3525}:  50%|█████     | 5/10 [01:37<01:45, 21.09s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0012, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9491, 'compress@10': 0.6139, 'time@10': 29.9269}:  50%|█████     | 5/10 [02:09<01:45, 21.09s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0012, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9491, 'compress@10': 0.6139, 'time@10': 29.9269}:  60%|██████    | 6/10 [02:09<01:40, 25.08s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.001, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9506, 'compress@10': 0.6044, 'time@10': 31.3559}:  60%|██████    | 6/10 [02:29<01:40, 25.08s/it] {'epoch': 34, 'num_users': 6.2857, 'loss': 0.001, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9506, 'compress@10': 0.6044, 'time@10': 31.3559}:  70%|███████   | 7/10 [02:29<01:10, 23.42s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0009, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9532, 'compress@10': 0.5341, 'time@10': 30.425}:  70%|███████   | 7/10 [02:53<01:10, 23.42s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0009, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9532, 'compress@10': 0.5341, 'time@10': 30.425}:  80%|████████  | 8/10 [02:53<00:47, 23.59s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0008, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.9552, 'compress@10': 0.4857, 'time@10': 32.3963}:  80%|████████  | 8/10 [03:18<00:47, 23.59s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0008, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.9552, 'compress@10': 0.4857, 'time@10': 32.3963}:  90%|█████████ | 9/10 [03:18<00:23, 23.75s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.001, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9574, 'compress@10': 0.5273, 'time@10': 32.4703}:  90%|█████████ | 9/10 [03:51<00:23, 23.75s/it]    {'epoch': 34, 'num_users': 6.3, 'loss': 0.001, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9574, 'compress@10': 0.5273, 'time@10': 32.4703}: 100%|██████████| 10/10 [03:51<00:00, 26.66s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.001, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9574, 'compress@10': 0.5273, 'time@10': 32.4703}: 100%|██████████| 10/10 [03:51<00:00, 23.12s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.0010037368720886564
Avg hit ratio: 0.8762818581154745
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5273257402020367
Avg train time: 32.47030899524689
Std train time: 11.354699157450083
[0.708333333333333, 0.45833333333333337, 0.013888888888888895, 0.4027777777777778, 0.9861111111111109, 0.9305555555555554, 0.513888888888889, 0.013888888888888895, 0.06944444444444445, 0.9027777777777777]
[40, 40, 75, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7237, 'time@10': 29.3085}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7237, 'time@10': 29.3085}:  10%|█         | 1/10 [00:14<02:12, 14.69s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.5997, 'time@10': 27.1352}:  10%|█         | 1/10 [00:39<02:12, 14.69s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.5997, 'time@10': 27.1352}:  20%|██        | 2/10 [00:39<02:46, 20.76s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9241, 'compress@10': 0.4514, 'time@10': 23.0038}:  20%|██        | 2/10 [00:47<02:46, 20.76s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9241, 'compress@10': 0.4514, 'time@10': 23.0038}:  30%|███       | 3/10 [00:47<01:42, 14.66s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9341, 'compress@10': 0.4446, 'time@10': 22.8022}:  30%|███       | 3/10 [01:09<01:42, 14.66s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9341, 'compress@10': 0.4446, 'time@10': 22.8022}:  40%|████      | 4/10 [01:09<01:45, 17.65s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9433, 'compress@10': 0.5529, 'time@10': 28.9591}:  40%|████      | 4/10 [01:36<01:45, 17.65s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9433, 'compress@10': 0.5529, 'time@10': 28.9591}:  50%|█████     | 5/10 [01:36<01:44, 20.96s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0007, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9491, 'compress@10': 0.6161, 'time@10': 29.5452}:  50%|█████     | 5/10 [02:08<01:44, 20.96s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0007, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9491, 'compress@10': 0.6161, 'time@10': 29.5452}:  60%|██████    | 6/10 [02:08<01:39, 24.89s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0006, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9506, 'compress@10': 0.6043, 'time@10': 31.1992}:  60%|██████    | 6/10 [02:29<01:39, 24.89s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0006, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9506, 'compress@10': 0.6043, 'time@10': 31.1992}:  70%|███████   | 7/10 [02:29<01:10, 23.49s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0006, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9532, 'compress@10': 0.534, 'time@10': 30.3165}:  70%|███████   | 7/10 [02:53<01:10, 23.49s/it]  {'epoch': 35, 'num_users': 6.125, 'loss': 0.0006, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9532, 'compress@10': 0.534, 'time@10': 30.3165}:  80%|████████  | 8/10 [02:53<00:47, 23.71s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0005, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9552, 'compress@10': 0.4854, 'time@10': 32.485}:  80%|████████  | 8/10 [03:18<00:47, 23.71s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0005, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9552, 'compress@10': 0.4854, 'time@10': 32.485}:  90%|█████████ | 9/10 [03:18<00:24, 24.10s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0014, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9574, 'compress@10': 0.5273, 'time@10': 32.5473}:  90%|█████████ | 9/10 [03:51<00:24, 24.10s/it]  {'epoch': 35, 'num_users': 6.3, 'loss': 0.0014, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9574, 'compress@10': 0.5273, 'time@10': 32.5473}: 100%|██████████| 10/10 [03:51<00:00, 26.89s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0014, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9574, 'compress@10': 0.5273, 'time@10': 32.5473}: 100%|██████████| 10/10 [03:51<00:00, 23.16s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.0014026720105246493
Avg hit ratio: 0.8755675724011887
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5273219935731783
Avg train time: 32.5472868680954
Std train time: 11.739865291438917
[0.7162162162162159, 0.445945945945946, 0.01351351351351352, 0.4189189189189189, 0.9864864864864863, 0.9054054054054053, 0.5000000000000001, 0.01351351351351352, 0.0945945945945946, 0.9054054054054053]
[40, 40, 76, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7311, 'time@10': 29.3688}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7311, 'time@10': 29.3688}:  10%|█         | 1/10 [00:14<02:12, 14.72s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.5975, 'time@10': 27.0344}:  10%|█         | 1/10 [00:39<02:12, 14.72s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.5975, 'time@10': 27.0344}:  20%|██        | 2/10 [00:39<02:44, 20.61s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9241, 'compress@10': 0.4498, 'time@10': 23.1656}:  20%|██        | 2/10 [00:47<02:44, 20.61s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9241, 'compress@10': 0.4498, 'time@10': 23.1656}:  30%|███       | 3/10 [00:47<01:43, 14.74s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9341, 'compress@10': 0.4473, 'time@10': 22.8591}:  30%|███       | 3/10 [01:09<01:43, 14.74s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9341, 'compress@10': 0.4473, 'time@10': 22.8591}:  40%|████      | 4/10 [01:09<01:45, 17.60s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9433, 'compress@10': 0.5552, 'time@10': 29.04}:  40%|████      | 4/10 [01:36<01:45, 17.60s/it]  {'epoch': 36, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9433, 'compress@10': 0.5552, 'time@10': 29.04}:  50%|█████     | 5/10 [01:36<01:44, 20.96s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0027, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9509, 'compress@10': 0.6139, 'time@10': 29.6123}:  50%|█████     | 5/10 [02:08<01:44, 20.96s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0027, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9509, 'compress@10': 0.6139, 'time@10': 29.6123}:  60%|██████    | 6/10 [02:08<01:39, 24.89s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0023, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9522, 'compress@10': 0.6005, 'time@10': 30.9761}:  60%|██████    | 6/10 [02:28<01:39, 24.89s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0023, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9522, 'compress@10': 0.6005, 'time@10': 30.9761}:  70%|███████   | 7/10 [02:28<01:09, 23.16s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.002, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9546, 'compress@10': 0.5306, 'time@10': 30.0912}:  70%|███████   | 7/10 [02:52<01:09, 23.16s/it]  {'epoch': 36, 'num_users': 6.125, 'loss': 0.002, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9546, 'compress@10': 0.5306, 'time@10': 30.0912}:  80%|████████  | 8/10 [02:52<00:46, 23.41s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0018, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9564, 'compress@10': 0.4851, 'time@10': 32.5615}:  80%|████████  | 8/10 [03:18<00:46, 23.41s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0018, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9564, 'compress@10': 0.4851, 'time@10': 32.5615}:  90%|█████████ | 9/10 [03:18<00:24, 24.28s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0034, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9561, 'compress@10': 0.5273, 'time@10': 32.4605}:  90%|█████████ | 9/10 [03:49<00:24, 24.28s/it]  {'epoch': 36, 'num_users': 6.3, 'loss': 0.0034, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9561, 'compress@10': 0.5273, 'time@10': 32.4605}: 100%|██████████| 10/10 [03:49<00:00, 26.54s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0034, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9561, 'compress@10': 0.5273, 'time@10': 32.4605}: 100%|██████████| 10/10 [03:49<00:00, 23.00s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.0033591402882170497
Avg hit ratio: 0.8708338294416393
Avg ndcg: 0.9560569442947411
Avg compression ratio: 0.5273036159775075
Avg train time: 32.46050500869751
Std train time: 11.991646041435613
[0.6973684210526313, 0.43421052631578955, 0.013157894736842111, 0.4342105263157895, 0.9868421052631577, 0.9078947368421051, 0.486842105263158, 0.013157894736842111, 0.11842105263157895, 0.9078947368421051]
[40, 40, 77, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7133, 'time@10': 29.24}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7133, 'time@10': 29.24}:  10%|█         | 1/10 [00:14<02:11, 14.66s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.5829, 'time@10': 27.1365}:  10%|█         | 1/10 [00:39<02:11, 14.66s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.5829, 'time@10': 27.1365}:  20%|██        | 2/10 [00:39<02:46, 20.78s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9241, 'compress@10': 0.44, 'time@10': 23.5146}:  20%|██        | 2/10 [00:47<02:46, 20.78s/it]  {'epoch': 37, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9241, 'compress@10': 0.44, 'time@10': 23.5146}:  30%|███       | 3/10 [00:47<01:45, 15.02s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9341, 'compress@10': 0.4436, 'time@10': 23.2051}:  30%|███       | 3/10 [01:10<01:45, 15.02s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9341, 'compress@10': 0.4436, 'time@10': 23.2051}:  40%|████      | 4/10 [01:10<01:47, 17.90s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9433, 'compress@10': 0.5523, 'time@10': 29.4011}:  40%|████      | 4/10 [01:37<01:47, 17.90s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9433, 'compress@10': 0.5523, 'time@10': 29.4011}:  50%|█████     | 5/10 [01:37<01:46, 21.23s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0031, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9505, 'compress@10': 0.6119, 'time@10': 29.9341}:  50%|█████     | 5/10 [02:09<01:46, 21.23s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0031, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9505, 'compress@10': 0.6119, 'time@10': 29.9341}:  60%|██████    | 6/10 [02:09<01:40, 25.11s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0027, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9518, 'compress@10': 0.597, 'time@10': 31.3067}:  60%|██████    | 6/10 [02:29<01:40, 25.11s/it] {'epoch': 37, 'num_users': 6.2857, 'loss': 0.0027, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9518, 'compress@10': 0.597, 'time@10': 31.3067}:  70%|███████   | 7/10 [02:29<01:10, 23.37s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0023, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9543, 'compress@10': 0.5275, 'time@10': 30.4356}:  70%|███████   | 7/10 [02:54<01:10, 23.37s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0023, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9543, 'compress@10': 0.5275, 'time@10': 30.4356}:  80%|████████  | 8/10 [02:54<00:47, 23.69s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0021, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9562, 'compress@10': 0.4849, 'time@10': 32.9024}:  80%|████████  | 8/10 [03:20<00:47, 23.69s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0021, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9562, 'compress@10': 0.4849, 'time@10': 32.9024}:  90%|█████████ | 9/10 [03:20<00:24, 24.52s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.002, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9583, 'compress@10': 0.5274, 'time@10': 32.7089}:  90%|█████████ | 9/10 [03:51<00:24, 24.52s/it]    {'epoch': 37, 'num_users': 6.3, 'loss': 0.002, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9583, 'compress@10': 0.5274, 'time@10': 32.7089}: 100%|██████████| 10/10 [03:51<00:00, 26.53s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.002, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9583, 'compress@10': 0.5274, 'time@10': 32.7089}: 100%|██████████| 10/10 [03:51<00:00, 23.15s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.0019723417247682405
Avg hit ratio: 0.8781354167432266
Avg ndcg: 0.9582956324076625
Avg compression ratio: 0.5273641385734419
Avg train time: 32.70891687870026
Std train time: 11.950629273625543
[0.6794871794871792, 0.4487179487179488, 0.012820512820512827, 0.44871794871794873, 0.987179487179487, 0.9102564102564101, 0.4743589743589745, 0.012820512820512827, 0.11538461538461539, 0.9102564102564101]
[40, 40, 78, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.6963, 'time@10': 30.2024}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.6963, 'time@10': 30.2024}:  10%|█         | 1/10 [00:15<02:16, 15.14s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.5814, 'time@10': 27.6277}:  10%|█         | 1/10 [00:40<02:16, 15.14s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.5814, 'time@10': 27.6277}:  20%|██        | 2/10 [00:40<02:47, 20.99s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9241, 'compress@10': 0.4389, 'time@10': 23.8518}:  20%|██        | 2/10 [00:48<02:47, 20.99s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9241, 'compress@10': 0.4389, 'time@10': 23.8518}:  30%|███       | 3/10 [00:48<01:46, 15.14s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9341, 'compress@10': 0.4463, 'time@10': 23.5378}:  30%|███       | 3/10 [01:11<01:46, 15.14s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9341, 'compress@10': 0.4463, 'time@10': 23.5378}:  40%|████      | 4/10 [01:11<01:48, 18.10s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9433, 'compress@10': 0.5545, 'time@10': 29.6304}:  40%|████      | 4/10 [01:38<01:48, 18.10s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9433, 'compress@10': 0.5545, 'time@10': 29.6304}:  50%|█████     | 5/10 [01:38<01:46, 21.32s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.001, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9491, 'compress@10': 0.6141, 'time@10': 30.1449}:  50%|█████     | 5/10 [02:10<01:46, 21.32s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.001, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9491, 'compress@10': 0.6141, 'time@10': 30.1449}:  60%|██████    | 6/10 [02:10<01:40, 25.22s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0009, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9506, 'compress@10': 0.5972, 'time@10': 31.5613}:  60%|██████    | 6/10 [02:30<01:40, 25.22s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0009, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9506, 'compress@10': 0.5972, 'time@10': 31.5613}:  70%|███████   | 7/10 [02:30<01:10, 23.53s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0008, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9532, 'compress@10': 0.5276, 'time@10': 30.6601}:  70%|███████   | 7/10 [02:55<01:10, 23.53s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.0008, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9532, 'compress@10': 0.5276, 'time@10': 30.6601}:  80%|████████  | 8/10 [02:55<00:47, 23.80s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0007, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9552, 'compress@10': 0.4847, 'time@10': 32.8824}:  80%|████████  | 8/10 [03:20<00:47, 23.80s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0007, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9552, 'compress@10': 0.4847, 'time@10': 32.8824}:  90%|█████████ | 9/10 [03:20<00:24, 24.29s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.6205}:  90%|█████████ | 9/10 [03:50<00:24, 24.29s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.6205}: 100%|██████████| 10/10 [03:50<00:00, 26.15s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.6205}: 100%|██████████| 10/10 [03:50<00:00, 23.10s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.0006620675480551052
Avg hit ratio: 0.8913417659495758
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5274133661657177
Avg train time: 32.62050385475159
Std train time: 11.583687637026685
[0.6874999999999997, 0.43750000000000006, 0.012500000000000006, 0.4625, 0.9874999999999998, 0.9124999999999999, 0.46250000000000013, 0.012500000000000006, 0.1125, 0.9124999999999999]
[40, 40, 79, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7039, 'time@10': 29.1372}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7039, 'time@10': 29.1372}:  10%|█         | 1/10 [00:14<02:11, 14.61s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.5798, 'time@10': 26.5704}:  10%|█         | 1/10 [00:38<02:11, 14.61s/it] {'epoch': 39, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.5798, 'time@10': 26.5704}:  20%|██        | 2/10 [00:38<02:41, 20.16s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.4377, 'time@10': 23.3627}:  20%|██        | 2/10 [00:47<02:41, 20.16s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.4377, 'time@10': 23.3627}:  30%|███       | 3/10 [00:47<01:43, 14.84s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8066, 'ndcg@10': 0.9341, 'compress@10': 0.4487, 'time@10': 22.9348}:  30%|███       | 3/10 [01:08<01:43, 14.84s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8066, 'ndcg@10': 0.9341, 'compress@10': 0.4487, 'time@10': 22.9348}:  40%|████      | 4/10 [01:08<01:45, 17.54s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.9433, 'compress@10': 0.5565, 'time@10': 28.8979}:  40%|████      | 4/10 [01:35<01:45, 17.54s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.9433, 'compress@10': 0.5565, 'time@10': 28.8979}:  50%|█████     | 5/10 [01:35<01:43, 20.74s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0015, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.9491, 'compress@10': 0.6162, 'time@10': 29.4136}:  50%|█████     | 5/10 [02:07<01:43, 20.74s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0015, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.9491, 'compress@10': 0.6162, 'time@10': 29.4136}:  60%|██████    | 6/10 [02:07<01:38, 24.58s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0013, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9506, 'compress@10': 0.5973, 'time@10': 30.7769}:  60%|██████    | 6/10 [02:26<01:38, 24.58s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0013, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9506, 'compress@10': 0.5973, 'time@10': 30.7769}:  70%|███████   | 7/10 [02:26<01:08, 22.92s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0011, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9532, 'compress@10': 0.5277, 'time@10': 29.9629}:  70%|███████   | 7/10 [02:51<01:08, 22.92s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0011, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9532, 'compress@10': 0.5277, 'time@10': 29.9629}:  80%|████████  | 8/10 [02:51<00:46, 23.36s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.001, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9552, 'compress@10': 0.4844, 'time@10': 32.0347}:  80%|████████  | 8/10 [03:15<00:46, 23.36s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.001, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9552, 'compress@10': 0.4844, 'time@10': 32.0347}:  90%|█████████ | 9/10 [03:15<00:23, 23.67s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.001, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 31.912}:  90%|█████████ | 9/10 [03:46<00:23, 23.67s/it]    {'epoch': 39, 'num_users': 6.3, 'loss': 0.001, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 31.912}: 100%|██████████| 10/10 [03:46<00:00, 25.88s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.001, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 31.912}: 100%|██████████| 10/10 [03:46<00:00, 22.63s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.0009569872811565754
Avg hit ratio: 0.872285442344865
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5274081764937735
Avg train time: 31.91202199459076
Std train time: 11.053598959483761
[0.6951219512195119, 0.426829268292683, 0.012195121951219518, 0.475609756097561, 0.9878048780487804, 0.9146341463414633, 0.4756097560975611, 0.012195121951219518, 0.10975609756097561, 0.8902439024390243]
[40, 40, 80, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7112, 'time@10': 28.5934}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7112, 'time@10': 28.5934}:  10%|█         | 1/10 [00:14<02:08, 14.33s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.5782, 'time@10': 26.3533}:  10%|█         | 1/10 [00:38<02:08, 14.33s/it] {'epoch': 40, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.5782, 'time@10': 26.3533}:  20%|██        | 2/10 [00:38<02:40, 20.11s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.4366, 'time@10': 23.2581}:  20%|██        | 2/10 [00:47<02:40, 20.11s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.4366, 'time@10': 23.2581}:  30%|███       | 3/10 [00:47<01:43, 14.84s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8066, 'ndcg@10': 0.9341, 'compress@10': 0.451, 'time@10': 22.8369}:  30%|███       | 3/10 [01:08<01:43, 14.84s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8066, 'ndcg@10': 0.9341, 'compress@10': 0.451, 'time@10': 22.8369}:  40%|████      | 4/10 [01:08<01:45, 17.51s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0007, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.9433, 'compress@10': 0.5584, 'time@10': 28.7255}:  40%|████      | 4/10 [01:34<01:45, 17.51s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0007, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.9433, 'compress@10': 0.5584, 'time@10': 28.7255}:  50%|█████     | 5/10 [01:34<01:43, 20.64s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0006, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.9491, 'compress@10': 0.6181, 'time@10': 29.35}:  50%|█████     | 5/10 [02:07<01:43, 20.64s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0006, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.9491, 'compress@10': 0.6181, 'time@10': 29.35}:  60%|██████    | 6/10 [02:07<01:38, 24.68s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0005, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9506, 'compress@10': 0.6008, 'time@10': 30.718}:  60%|██████    | 6/10 [02:26<01:38, 24.68s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0005, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9506, 'compress@10': 0.6008, 'time@10': 30.718}:  70%|███████   | 7/10 [02:26<01:08, 22.98s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0005, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9532, 'compress@10': 0.5307, 'time@10': 29.9377}:  70%|███████   | 7/10 [02:51<01:08, 22.98s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0005, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9532, 'compress@10': 0.5307, 'time@10': 29.9377}:  80%|████████  | 8/10 [02:51<00:46, 23.47s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0004, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9552, 'compress@10': 0.4868, 'time@10': 32.1197}:  80%|████████  | 8/10 [03:16<00:46, 23.47s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0004, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9552, 'compress@10': 0.4868, 'time@10': 32.1197}:  90%|█████████ | 9/10 [03:16<00:23, 23.89s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0004, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.1672}:  90%|█████████ | 9/10 [03:48<00:23, 23.89s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0004, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.1672}: 100%|██████████| 10/10 [03:48<00:00, 26.59s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0004, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.1672}: 100%|██████████| 10/10 [03:48<00:00, 22.88s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.00041437977137795715
Avg hit ratio: 0.8791425852020079
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.527360643466716
Avg train time: 32.167166686058046
Std train time: 11.09303845935645
[0.7023809523809521, 0.4166666666666667, 0.011904761904761911, 0.48809523809523814, 0.988095238095238, 0.9166666666666666, 0.4642857142857144, 0.011904761904761911, 0.10714285714285714, 0.8928571428571428]
[40, 40, 81, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.718, 'time@10': 29.2557}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.718, 'time@10': 29.2557}:  10%|█         | 1/10 [00:14<02:11, 14.66s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.5768, 'time@10': 26.6454}:  10%|█         | 1/10 [00:38<02:11, 14.66s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.5768, 'time@10': 26.6454}:  20%|██        | 2/10 [00:38<02:41, 20.20s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7529, 'ndcg@10': 0.9241, 'compress@10': 0.4355, 'time@10': 23.4981}:  20%|██        | 2/10 [00:47<02:41, 20.20s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7529, 'ndcg@10': 0.9241, 'compress@10': 0.4355, 'time@10': 23.4981}:  30%|███       | 3/10 [00:47<01:44, 14.92s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9341, 'compress@10': 0.4532, 'time@10': 23.0091}:  30%|███       | 3/10 [01:08<01:44, 14.92s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9341, 'compress@10': 0.4532, 'time@10': 23.0091}:  40%|████      | 4/10 [01:08<01:45, 17.55s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0007, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.9433, 'compress@10': 0.5603, 'time@10': 28.8035}:  40%|████      | 4/10 [01:34<01:45, 17.55s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0007, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.9433, 'compress@10': 0.5603, 'time@10': 28.8035}:  50%|█████     | 5/10 [01:34<01:43, 20.61s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0023, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.9486, 'compress@10': 0.62, 'time@10': 29.2739}:  50%|█████     | 5/10 [02:06<01:43, 20.61s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0023, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.9486, 'compress@10': 0.62, 'time@10': 29.2739}:  60%|██████    | 6/10 [02:06<01:37, 24.36s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.002, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9502, 'compress@10': 0.6008, 'time@10': 30.5932}:  60%|██████    | 6/10 [02:25<01:37, 24.36s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.002, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9502, 'compress@10': 0.6008, 'time@10': 30.5932}:  70%|███████   | 7/10 [02:25<01:08, 22.71s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0017, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9529, 'compress@10': 0.5307, 'time@10': 29.9253}:  70%|███████   | 7/10 [02:51<01:08, 22.71s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0017, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9529, 'compress@10': 0.5307, 'time@10': 29.9253}:  80%|████████  | 8/10 [02:51<00:47, 23.53s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0015, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9549, 'compress@10': 0.4865, 'time@10': 32.0326}:  80%|████████  | 8/10 [03:15<00:47, 23.53s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0015, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9549, 'compress@10': 0.4865, 'time@10': 32.0326}:  90%|█████████ | 9/10 [03:15<00:23, 23.83s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0014, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9572, 'compress@10': 0.5274, 'time@10': 32.0124}:  90%|█████████ | 9/10 [03:47<00:23, 23.83s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0014, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9572, 'compress@10': 0.5274, 'time@10': 32.0124}: 100%|██████████| 10/10 [03:47<00:00, 26.31s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0014, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9572, 'compress@10': 0.5274, 'time@10': 32.0124}: 100%|██████████| 10/10 [03:47<00:00, 22.76s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.0014145809056181444
Avg hit ratio: 0.8696699789552081
Avg ndcg: 0.9571546136821448
Avg compression ratio: 0.5273580316379597
Avg train time: 32.01241929531098
Std train time: 10.82560423185901
[0.709302325581395, 0.4069767441860465, 0.011627906976744193, 0.5, 0.9883720930232558, 0.9186046511627907, 0.4534883720930234, 0.011627906976744193, 0.10465116279069767, 0.8953488372093023]
[40, 40, 82, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7246, 'time@10': 28.8523}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7246, 'time@10': 28.8523}:  10%|█         | 1/10 [00:14<02:10, 14.46s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.5753, 'time@10': 26.6644}:  10%|█         | 1/10 [00:38<02:10, 14.46s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.5753, 'time@10': 26.6644}:  20%|██        | 2/10 [00:38<02:42, 20.37s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.4345, 'time@10': 23.6516}:  20%|██        | 2/10 [00:47<02:42, 20.37s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.4345, 'time@10': 23.6516}:  30%|███       | 3/10 [00:47<01:45, 15.12s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.9341, 'compress@10': 0.4553, 'time@10': 23.1273}:  30%|███       | 3/10 [01:09<01:45, 15.12s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.9341, 'compress@10': 0.4553, 'time@10': 23.1273}:  40%|████      | 4/10 [01:09<01:46, 17.67s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0007, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.9433, 'compress@10': 0.562, 'time@10': 28.8324}:  40%|████      | 4/10 [01:35<01:46, 17.67s/it] {'epoch': 42, 'num_users': 5.8, 'loss': 0.0007, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.9433, 'compress@10': 0.562, 'time@10': 28.8324}:  50%|█████     | 5/10 [01:35<01:43, 20.63s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0013, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9491, 'compress@10': 0.6217, 'time@10': 29.3415}:  50%|█████     | 5/10 [02:07<01:43, 20.63s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0013, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9491, 'compress@10': 0.6217, 'time@10': 29.3415}:  60%|██████    | 6/10 [02:07<01:37, 24.47s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0012, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9506, 'compress@10': 0.6008, 'time@10': 30.6522}:  60%|██████    | 6/10 [02:26<01:37, 24.47s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0012, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9506, 'compress@10': 0.6008, 'time@10': 30.6522}:  70%|███████   | 7/10 [02:26<01:08, 22.78s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.001, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9532, 'compress@10': 0.5307, 'time@10': 30.0067}:  70%|███████   | 7/10 [02:52<01:08, 22.78s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.001, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9532, 'compress@10': 0.5307, 'time@10': 30.0067}:  80%|████████  | 8/10 [02:52<00:47, 23.66s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0009, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.9552, 'compress@10': 0.4862, 'time@10': 32.0642}:  80%|████████  | 8/10 [03:16<00:47, 23.66s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0009, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.9552, 'compress@10': 0.4862, 'time@10': 32.0642}:  90%|█████████ | 9/10 [03:16<00:23, 23.86s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0008, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 31.9658}:  90%|█████████ | 9/10 [03:47<00:23, 23.86s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0008, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 31.9658}: 100%|██████████| 10/10 [03:47<00:00, 26.10s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0008, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 31.9658}: 100%|██████████| 10/10 [03:47<00:00, 22.75s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.0008466298780101621
Avg hit ratio: 0.8766541059393351
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5273543856524288
Avg train time: 31.965827846527098
Std train time: 10.617039995340415
[0.6931818181818179, 0.42045454545454547, 0.011363636363636371, 0.5113636363636364, 0.9886363636363636, 0.9204545454545454, 0.44318181818181834, 0.011363636363636371, 0.10227272727272727, 0.8977272727272727]
[40, 40, 83, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7093, 'time@10': 29.7152}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7093, 'time@10': 29.7152}:  10%|█         | 1/10 [00:14<02:14, 14.89s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.5742, 'time@10': 26.8836}:  10%|█         | 1/10 [00:38<02:14, 14.89s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.5742, 'time@10': 26.8836}:  20%|██        | 2/10 [00:38<02:42, 20.30s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7529, 'ndcg@10': 0.9241, 'compress@10': 0.4337, 'time@10': 23.5367}:  20%|██        | 2/10 [00:47<02:42, 20.30s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7529, 'ndcg@10': 0.9241, 'compress@10': 0.4337, 'time@10': 23.5367}:  30%|███       | 3/10 [00:47<01:44, 14.89s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.9341, 'compress@10': 0.4575, 'time@10': 23.0347}:  30%|███       | 3/10 [01:09<01:44, 14.89s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.9341, 'compress@10': 0.4575, 'time@10': 23.0347}:  40%|████      | 4/10 [01:09<01:45, 17.53s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0006, 'hit_ratio@10': 0.812, 'ndcg@10': 0.9433, 'compress@10': 0.5637, 'time@10': 28.9684}:  40%|████      | 4/10 [01:35<01:45, 17.53s/it] {'epoch': 43, 'num_users': 5.8, 'loss': 0.0006, 'hit_ratio@10': 0.812, 'ndcg@10': 0.9433, 'compress@10': 0.5637, 'time@10': 28.9684}:  50%|█████     | 5/10 [01:35<01:43, 20.72s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.001, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9491, 'compress@10': 0.6235, 'time@10': 29.5531}:  50%|█████     | 5/10 [02:07<01:43, 20.72s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.001, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9491, 'compress@10': 0.6235, 'time@10': 29.5531}:  60%|██████    | 6/10 [02:07<01:38, 24.74s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0009, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9506, 'compress@10': 0.6009, 'time@10': 30.9202}:  60%|██████    | 6/10 [02:27<01:38, 24.74s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0009, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9506, 'compress@10': 0.6009, 'time@10': 30.9202}:  70%|███████   | 7/10 [02:27<01:09, 23.06s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0008, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9532, 'compress@10': 0.5308, 'time@10': 30.3085}:  70%|███████   | 7/10 [02:53<01:09, 23.06s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0008, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9532, 'compress@10': 0.5308, 'time@10': 30.3085}:  80%|████████  | 8/10 [02:53<00:48, 24.02s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0007, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.9552, 'compress@10': 0.486, 'time@10': 32.3121}:  80%|████████  | 8/10 [03:17<00:48, 24.02s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0007, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.9552, 'compress@10': 0.486, 'time@10': 32.3121}:  90%|█████████ | 9/10 [03:17<00:24, 24.08s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.1453}:  90%|█████████ | 9/10 [03:48<00:24, 24.08s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.1453}: 100%|██████████| 10/10 [03:48<00:00, 26.11s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.1453}: 100%|██████████| 10/10 [03:48<00:00, 22.85s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.0006412246241390784
Avg hit ratio: 0.8695906138758431
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5273982155923421
Avg train time: 32.14525578022003
Std train time: 10.916337683872582
[0.6999999999999997, 0.41111111111111115, 0.011111111111111118, 0.5222222222222223, 0.9888888888888889, 0.9222222222222222, 0.4333333333333335, 0.011111111111111118, 0.09999999999999999, 0.9]
[40, 40, 84, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7158, 'time@10': 28.9974}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7158, 'time@10': 28.9974}:  10%|█         | 1/10 [00:14<02:10, 14.54s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.5729, 'time@10': 26.5143}:  10%|█         | 1/10 [00:38<02:10, 14.54s/it] {'epoch': 44, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.5729, 'time@10': 26.5143}:  20%|██        | 2/10 [00:38<02:41, 20.14s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.4328, 'time@10': 23.5672}:  20%|██        | 2/10 [00:47<02:41, 20.14s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.4328, 'time@10': 23.5672}:  30%|███       | 3/10 [00:47<01:44, 15.00s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8066, 'ndcg@10': 0.9341, 'compress@10': 0.4594, 'time@10': 23.1104}:  30%|███       | 3/10 [01:09<01:44, 15.00s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8066, 'ndcg@10': 0.9341, 'compress@10': 0.4594, 'time@10': 23.1104}:  40%|████      | 4/10 [01:09<01:46, 17.67s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0006, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.9433, 'compress@10': 0.5653, 'time@10': 28.893}:  40%|████      | 4/10 [01:35<01:46, 17.67s/it] {'epoch': 44, 'num_users': 5.8, 'loss': 0.0006, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.9433, 'compress@10': 0.5653, 'time@10': 28.893}:  50%|█████     | 5/10 [01:35<01:43, 20.69s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0005, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9491, 'compress@10': 0.6251, 'time@10': 29.3769}:  50%|█████     | 5/10 [02:07<01:43, 20.69s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0005, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9491, 'compress@10': 0.6251, 'time@10': 29.3769}:  60%|██████    | 6/10 [02:07<01:37, 24.48s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0005, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9506, 'compress@10': 0.6009, 'time@10': 30.7156}:  60%|██████    | 6/10 [02:26<01:37, 24.48s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0005, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9506, 'compress@10': 0.6009, 'time@10': 30.7156}:  70%|███████   | 7/10 [02:26<01:08, 22.82s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0004, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9532, 'compress@10': 0.5307, 'time@10': 30.0912}:  70%|███████   | 7/10 [02:52<01:08, 22.82s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0004, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9532, 'compress@10': 0.5307, 'time@10': 30.0912}:  80%|████████  | 8/10 [02:52<00:47, 23.76s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0004, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9552, 'compress@10': 0.4857, 'time@10': 32.3584}:  80%|████████  | 8/10 [03:17<00:47, 23.76s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0004, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9552, 'compress@10': 0.4857, 'time@10': 32.3584}:  90%|█████████ | 9/10 [03:17<00:24, 24.24s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0004, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.1916}:  90%|█████████ | 9/10 [03:48<00:24, 24.24s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0004, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.1916}: 100%|██████████| 10/10 [03:48<00:00, 26.24s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0004, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.1916}: 100%|██████████| 10/10 [03:48<00:00, 22.83s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.0003728331670538938
Avg hit ratio: 0.8756505217099445
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5273942935517962
Avg train time: 32.19156937599182
Std train time: 11.011105988183106
[0.7065217391304345, 0.40217391304347827, 0.010869565217391311, 0.532608695652174, 0.9891304347826088, 0.9021739130434782, 0.42391304347826103, 0.010869565217391311, 0.11956521739130434, 0.9021739130434783]
[40, 40, 85, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.722, 'time@10': 28.3227}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.722, 'time@10': 28.3227}:  10%|█         | 1/10 [00:14<02:07, 14.20s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.5717, 'time@10': 26.2327}:  10%|█         | 1/10 [00:38<02:07, 14.20s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.5717, 'time@10': 26.2327}:  20%|██        | 2/10 [00:38<02:40, 20.08s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.4319, 'time@10': 23.3631}:  20%|██        | 2/10 [00:47<02:40, 20.08s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.4319, 'time@10': 23.3631}:  30%|███       | 3/10 [00:47<01:44, 14.95s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.9341, 'compress@10': 0.4612, 'time@10': 22.9348}:  30%|███       | 3/10 [01:08<01:44, 14.95s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.9341, 'compress@10': 0.4612, 'time@10': 22.9348}:  40%|████      | 4/10 [01:08<01:45, 17.61s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0007, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9433, 'compress@10': 0.5668, 'time@10': 28.8404}:  40%|████      | 4/10 [01:35<01:45, 17.61s/it] {'epoch': 45, 'num_users': 5.8, 'loss': 0.0007, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9433, 'compress@10': 0.5668, 'time@10': 28.8404}:  50%|█████     | 5/10 [01:35<01:43, 20.73s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0024, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.95, 'compress@10': 0.6231, 'time@10': 29.3749}:  50%|█████     | 5/10 [02:07<01:43, 20.73s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0024, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.95, 'compress@10': 0.6231, 'time@10': 29.3749}:  60%|██████    | 6/10 [02:07<01:38, 24.59s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0021, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9515, 'compress@10': 0.5979, 'time@10': 30.7072}:  60%|██████    | 6/10 [02:26<01:38, 24.59s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0021, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9515, 'compress@10': 0.5979, 'time@10': 30.7072}:  70%|███████   | 7/10 [02:26<01:08, 22.89s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0018, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.954, 'compress@10': 0.5281, 'time@10': 30.0493}:  70%|███████   | 7/10 [02:52<01:08, 22.89s/it]  {'epoch': 45, 'num_users': 6.125, 'loss': 0.0018, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.954, 'compress@10': 0.5281, 'time@10': 30.0493}:  80%|████████  | 8/10 [02:52<00:47, 23.72s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0016, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9559, 'compress@10': 0.4855, 'time@10': 32.1823}:  80%|████████  | 8/10 [03:16<00:47, 23.72s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0016, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9559, 'compress@10': 0.4855, 'time@10': 32.1823}:  90%|█████████ | 9/10 [03:16<00:24, 24.01s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0015, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.958, 'compress@10': 0.5274, 'time@10': 32.0478}:  90%|█████████ | 9/10 [03:47<00:24, 24.01s/it]    {'epoch': 45, 'num_users': 6.3, 'loss': 0.0015, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.958, 'compress@10': 0.5274, 'time@10': 32.0478}: 100%|██████████| 10/10 [03:47<00:00, 26.13s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0015, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.958, 'compress@10': 0.5274, 'time@10': 32.0478}: 100%|██████████| 10/10 [03:47<00:00, 22.77s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.0014757459893636538
Avg hit ratio: 0.8846541059393351
Avg ndcg: 0.9580322165088846
Avg compression ratio: 0.5273777773582269
Avg train time: 32.04781558513641
Std train time: 10.928967755104617
[0.7127659574468083, 0.39361702127659576, 0.010638297872340432, 0.5425531914893618, 0.9893617021276596, 0.9042553191489361, 0.41489361702127675, 0.010638297872340432, 0.11702127659574467, 0.9042553191489362]
[40, 40, 86, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7279, 'time@10': 28.9439}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7279, 'time@10': 28.9439}:  10%|█         | 1/10 [00:14<02:10, 14.52s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.5705, 'time@10': 26.6559}:  10%|█         | 1/10 [00:38<02:10, 14.52s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.5705, 'time@10': 26.6559}:  20%|██        | 2/10 [00:38<02:42, 20.33s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.431, 'time@10': 23.5458}:  20%|██        | 2/10 [00:47<02:42, 20.33s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.431, 'time@10': 23.5458}:  30%|███       | 3/10 [00:47<01:45, 15.02s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.9341, 'compress@10': 0.463, 'time@10': 23.1065}:  30%|███       | 3/10 [01:09<01:45, 15.02s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.9341, 'compress@10': 0.463, 'time@10': 23.1065}:  40%|████      | 4/10 [01:09<01:46, 17.71s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0004, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9433, 'compress@10': 0.5683, 'time@10': 29.2018}:  40%|████      | 4/10 [01:36<01:46, 17.71s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0004, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9433, 'compress@10': 0.5683, 'time@10': 29.2018}:  50%|█████     | 5/10 [01:36<01:44, 21.00s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0007, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9491, 'compress@10': 0.6246, 'time@10': 29.6692}:  50%|█████     | 5/10 [02:08<01:44, 21.00s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0007, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9491, 'compress@10': 0.6246, 'time@10': 29.6692}:  60%|██████    | 6/10 [02:08<01:39, 24.75s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0006, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9506, 'compress@10': 0.598, 'time@10': 30.9383}:  60%|██████    | 6/10 [02:27<01:39, 24.75s/it] {'epoch': 46, 'num_users': 6.2857, 'loss': 0.0006, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9506, 'compress@10': 0.598, 'time@10': 30.9383}:  70%|███████   | 7/10 [02:27<01:08, 22.97s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0006, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9532, 'compress@10': 0.5281, 'time@10': 30.258}:  70%|███████   | 7/10 [02:53<01:08, 22.97s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0006, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9532, 'compress@10': 0.5281, 'time@10': 30.258}:  80%|████████  | 8/10 [02:53<00:47, 23.79s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0005, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9552, 'compress@10': 0.4853, 'time@10': 32.291}:  80%|████████  | 8/10 [03:17<00:47, 23.79s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0005, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9552, 'compress@10': 0.4853, 'time@10': 32.291}:  90%|█████████ | 9/10 [03:17<00:23, 23.95s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0005, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.1553}:  90%|█████████ | 9/10 [03:48<00:23, 23.95s/it]  {'epoch': 46, 'num_users': 6.3, 'loss': 0.0005, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.1553}: 100%|██████████| 10/10 [03:48<00:00, 26.12s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0005, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.1553}: 100%|██████████| 10/10 [03:48<00:00, 22.84s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.00047029063982161057
Avg hit ratio: 0.8960826773679065
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5273740679788916
Avg train time: 32.15527443885803
Std train time: 11.014648603605943
[0.7187499999999998, 0.3854166666666667, 0.010416666666666673, 0.5520833333333334, 0.9895833333333334, 0.9062499999999999, 0.40625000000000017, 0.010416666666666673, 0.13541666666666666, 0.8854166666666667]
[40, 40, 87, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7335, 'time@10': 28.8143}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7335, 'time@10': 28.8143}:  10%|█         | 1/10 [00:14<02:09, 14.44s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.5694, 'time@10': 26.4311}:  10%|█         | 1/10 [00:38<02:09, 14.44s/it] {'epoch': 47, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.5694, 'time@10': 26.4311}:  20%|██        | 2/10 [00:38<02:40, 20.12s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.4302, 'time@10': 23.9774}:  20%|██        | 2/10 [00:48<02:40, 20.12s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.4302, 'time@10': 23.9774}:  30%|███       | 3/10 [00:48<01:47, 15.31s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.9341, 'compress@10': 0.4647, 'time@10': 23.3781}:  30%|███       | 3/10 [01:09<01:47, 15.31s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.9341, 'compress@10': 0.4647, 'time@10': 23.3781}:  40%|████      | 4/10 [01:09<01:46, 17.81s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9433, 'compress@10': 0.5697, 'time@10': 29.45}:  40%|████      | 4/10 [01:36<01:46, 17.81s/it]  {'epoch': 47, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9433, 'compress@10': 0.5697, 'time@10': 29.45}:  50%|█████     | 5/10 [01:36<01:45, 21.09s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0022, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9482, 'compress@10': 0.6261, 'time@10': 29.8469}:  50%|█████     | 5/10 [02:08<01:45, 21.09s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0022, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9482, 'compress@10': 0.6261, 'time@10': 29.8469}:  60%|██████    | 6/10 [02:08<01:39, 24.75s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0019, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9499, 'compress@10': 0.5981, 'time@10': 31.1191}:  60%|██████    | 6/10 [02:27<01:39, 24.75s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0019, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9499, 'compress@10': 0.5981, 'time@10': 31.1191}:  70%|███████   | 7/10 [02:27<01:09, 23.01s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0016, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9526, 'compress@10': 0.5282, 'time@10': 30.4115}:  70%|███████   | 7/10 [02:53<01:09, 23.01s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0016, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9526, 'compress@10': 0.5282, 'time@10': 30.4115}:  80%|████████  | 8/10 [02:53<00:47, 23.80s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0015, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9547, 'compress@10': 0.4873, 'time@10': 32.4768}:  80%|████████  | 8/10 [03:17<00:47, 23.80s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0015, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9547, 'compress@10': 0.4873, 'time@10': 32.4768}:  90%|█████████ | 9/10 [03:17<00:24, 24.03s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0013, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.957, 'compress@10': 0.5274, 'time@10': 32.4492}:  90%|█████████ | 9/10 [03:50<00:24, 24.03s/it]    {'epoch': 47, 'num_users': 6.3, 'loss': 0.0013, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.957, 'compress@10': 0.5274, 'time@10': 32.4492}: 100%|██████████| 10/10 [03:50<00:00, 26.56s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0013, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.957, 'compress@10': 0.5274, 'time@10': 32.4492}: 100%|██████████| 10/10 [03:50<00:00, 23.02s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.001335526301322668
Avg hit ratio: 0.8957298867893095
Avg ndcg: 0.9569526722476052
Avg compression ratio: 0.5273604563520433
Avg train time: 32.44917159080505
Std train time: 10.941070813344815
[0.7244897959183672, 0.3775510204081633, 0.010204081632653067, 0.5612244897959184, 0.9897959183673469, 0.9081632653061223, 0.39795918367346955, 0.010204081632653067, 0.15306122448979592, 0.8673469387755103]
[40, 40, 88, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0006, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.739, 'time@10': 29.4397}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0006, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.739, 'time@10': 29.4397}:  10%|█         | 1/10 [00:14<02:12, 14.76s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.5683, 'time@10': 26.8367}:  10%|█         | 1/10 [00:39<02:12, 14.76s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.5683, 'time@10': 26.8367}:  20%|██        | 2/10 [00:39<02:42, 20.35s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.4294, 'time@10': 24.2852}:  20%|██        | 2/10 [00:48<02:42, 20.35s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.4294, 'time@10': 24.2852}:  30%|███       | 3/10 [00:48<01:48, 15.46s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9341, 'compress@10': 0.4663, 'time@10': 23.7341}:  30%|███       | 3/10 [01:10<01:48, 15.46s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9341, 'compress@10': 0.4663, 'time@10': 23.7341}:  40%|████      | 4/10 [01:10<01:48, 18.09s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0003, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9433, 'compress@10': 0.571, 'time@10': 29.5241}:  40%|████      | 4/10 [01:37<01:48, 18.09s/it] {'epoch': 48, 'num_users': 5.8, 'loss': 0.0003, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9433, 'compress@10': 0.571, 'time@10': 29.5241}:  50%|█████     | 5/10 [01:37<01:45, 21.08s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0003, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9491, 'compress@10': 0.6275, 'time@10': 29.9163}:  50%|█████     | 5/10 [02:09<01:45, 21.08s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0003, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9491, 'compress@10': 0.6275, 'time@10': 29.9163}:  60%|██████    | 6/10 [02:09<01:39, 24.76s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0003, 'hit_ratio@10': 0.9076, 'ndcg@10': 0.9506, 'compress@10': 0.5982, 'time@10': 31.1696}:  60%|██████    | 6/10 [02:28<01:39, 24.76s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0003, 'hit_ratio@10': 0.9076, 'ndcg@10': 0.9506, 'compress@10': 0.5982, 'time@10': 31.1696}:  70%|███████   | 7/10 [02:28<01:09, 23.00s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0002, 'hit_ratio@10': 0.9156, 'ndcg@10': 0.9532, 'compress@10': 0.5282, 'time@10': 30.4911}:  70%|███████   | 7/10 [02:54<01:09, 23.00s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0002, 'hit_ratio@10': 0.9156, 'ndcg@10': 0.9532, 'compress@10': 0.5282, 'time@10': 30.4911}:  80%|████████  | 8/10 [02:54<00:47, 23.89s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0002, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9552, 'compress@10': 0.4892, 'time@10': 32.5026}:  80%|████████  | 8/10 [03:18<00:47, 23.89s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0002, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9552, 'compress@10': 0.4892, 'time@10': 32.5026}:  90%|█████████ | 9/10 [03:18<00:24, 24.03s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0002, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9574, 'compress@10': 0.5273, 'time@10': 32.5701}:  90%|█████████ | 9/10 [03:51<00:24, 24.03s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0002, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9574, 'compress@10': 0.5273, 'time@10': 32.5701}: 100%|██████████| 10/10 [03:51<00:00, 26.86s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0002, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9574, 'compress@10': 0.5273, 'time@10': 32.5701}: 100%|██████████| 10/10 [03:51<00:00, 23.18s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.00020961840189370832
Avg hit ratio: 0.9130565367475384
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5273442368351835
Avg train time: 32.57014534473419
Std train time: 10.55864387842047
[0.7299999999999998, 0.37000000000000005, 0.010000000000000005, 0.55, 0.99, 0.9099999999999999, 0.3900000000000002, 0.010000000000000005, 0.17, 0.8700000000000001]
[40, 40, 89, 40, 30, 40, 40, 40, 39, 40]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7442, 'time@10': 28.5914}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7442, 'time@10': 28.5914}:  10%|█         | 1/10 [00:14<02:08, 14.33s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.5673, 'time@10': 26.3347}:  10%|█         | 1/10 [00:38<02:08, 14.33s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.5673, 'time@10': 26.3347}:  20%|██        | 2/10 [00:38<02:40, 20.09s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7597, 'ndcg@10': 0.9241, 'compress@10': 0.4287, 'time@10': 24.0351}:  20%|██        | 2/10 [00:48<02:40, 20.09s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7597, 'ndcg@10': 0.9241, 'compress@10': 0.4287, 'time@10': 24.0351}:  30%|███       | 3/10 [00:48<01:47, 15.37s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.793, 'ndcg@10': 0.9341, 'compress@10': 0.463, 'time@10': 23.4074}:  30%|███       | 3/10 [01:09<01:47, 15.37s/it]  {'epoch': 49, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.793, 'ndcg@10': 0.9341, 'compress@10': 0.463, 'time@10': 23.4074}:  40%|████      | 4/10 [01:09<01:46, 17.81s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.001, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9433, 'compress@10': 0.5684, 'time@10': 29.2764}:  40%|████      | 4/10 [01:36<01:46, 17.81s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.001, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9433, 'compress@10': 0.5684, 'time@10': 29.2764}:  50%|█████     | 5/10 [01:36<01:44, 20.91s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0009, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9491, 'compress@10': 0.6257, 'time@10': 29.7502}:  50%|█████     | 5/10 [02:08<01:44, 20.91s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0009, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9491, 'compress@10': 0.6257, 'time@10': 29.7502}:  60%|██████    | 6/10 [02:08<01:38, 24.74s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0008, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9506, 'compress@10': 0.5955, 'time@10': 30.8369}:  60%|██████    | 6/10 [02:27<01:38, 24.74s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0008, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9506, 'compress@10': 0.5955, 'time@10': 30.8369}:  70%|███████   | 7/10 [02:27<01:08, 22.77s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0007, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9532, 'compress@10': 0.5259, 'time@10': 30.1482}:  70%|███████   | 7/10 [02:52<01:08, 22.77s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0007, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9532, 'compress@10': 0.5259, 'time@10': 30.1482}:  80%|████████  | 8/10 [02:52<00:47, 23.60s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0006, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9552, 'compress@10': 0.489, 'time@10': 32.1171}:  80%|████████  | 8/10 [03:16<00:47, 23.60s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0006, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9552, 'compress@10': 0.489, 'time@10': 32.1171}:  90%|█████████ | 9/10 [03:16<00:23, 23.72s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.1144}:  90%|█████████ | 9/10 [03:48<00:23, 23.72s/it]  {'epoch': 49, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.1144}: 100%|██████████| 10/10 [03:48<00:00, 26.31s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 32.1144}: 100%|██████████| 10/10 [03:48<00:00, 22.85s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.0005521924715482635
Avg hit ratio: 0.882707330398332
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5273557461291529
Avg train time: 32.114396929740906
Std train time: 10.476363881347039
[0.7352941176470585, 0.36274509803921573, 0.009803921568627456, 0.5588235294117647, 0.9901960784313726, 0.9117647058823528, 0.3823529411764708, 0.009803921568627456, 0.18627450980392157, 0.8529411764705883]
[40, 40, 90, 40, 30, 40, 40, 40, 39, 40]
