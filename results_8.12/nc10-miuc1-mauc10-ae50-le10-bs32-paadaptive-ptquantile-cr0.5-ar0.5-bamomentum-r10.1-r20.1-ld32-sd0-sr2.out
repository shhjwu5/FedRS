  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0587, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0213, 'compress@10': 0.5069, 'time@10': 34.3541}:   0%|          | 0/10 [00:17<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0587, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0213, 'compress@10': 0.5069, 'time@10': 34.3541}:  10%|█         | 1/10 [00:17<02:34, 17.22s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0619, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0089, 'compress@10': 0.5056, 'time@10': 31.0669}:  10%|█         | 1/10 [00:45<02:34, 17.22s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0619, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0089, 'compress@10': 0.5056, 'time@10': 31.0669}:  20%|██        | 2/10 [00:45<03:07, 23.45s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.0757, 'hit_ratio@10': 0.9798, 'ndcg@10': 0.9437, 'compress@10': 0.5101, 'time@10': 24.6789}:  20%|██        | 2/10 [00:51<03:07, 23.45s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.0757, 'hit_ratio@10': 0.9798, 'ndcg@10': 0.9437, 'compress@10': 0.5101, 'time@10': 24.6789}:  30%|███       | 3/10 [00:51<01:48, 15.48s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.072, 'hit_ratio@10': 0.9824, 'ndcg@10': 0.9602, 'compress@10': 0.5088, 'time@10': 24.5962}:  30%|███       | 3/10 [01:15<01:48, 15.48s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.072, 'hit_ratio@10': 0.9824, 'ndcg@10': 0.9602, 'compress@10': 0.5088, 'time@10': 24.5962}:  40%|████      | 4/10 [01:15<01:53, 19.00s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.0753, 'hit_ratio@10': 0.9849, 'ndcg@10': 0.9614, 'compress@10': 0.5075, 'time@10': 37.8619}:  40%|████      | 4/10 [02:00<01:53, 19.00s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.0753, 'hit_ratio@10': 0.9849, 'ndcg@10': 0.9614, 'compress@10': 0.5075, 'time@10': 37.8619}:  50%|█████     | 5/10 [02:00<02:22, 28.56s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.0768, 'hit_ratio@10': 0.9865, 'ndcg@10': 0.9657, 'compress@10': 0.5068, 'time@10': 38.3249}:  50%|█████     | 5/10 [02:41<02:22, 28.56s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.0768, 'hit_ratio@10': 0.9865, 'ndcg@10': 0.9657, 'compress@10': 0.5068, 'time@10': 38.3249}:  60%|██████    | 6/10 [02:41<02:10, 32.68s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.0733, 'hit_ratio@10': 0.9869, 'ndcg@10': 0.9722, 'compress@10': 0.5066, 'time@10': 39.1206}:  60%|██████    | 6/10 [03:03<02:10, 32.68s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.0733, 'hit_ratio@10': 0.9869, 'ndcg@10': 0.9722, 'compress@10': 0.5066, 'time@10': 39.1206}:  70%|███████   | 7/10 [03:03<01:27, 29.18s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.0694, 'hit_ratio@10': 0.9876, 'ndcg@10': 0.9816, 'compress@10': 0.5062, 'time@10': 38.1773}:  70%|███████   | 7/10 [03:35<01:27, 29.18s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.0694, 'hit_ratio@10': 0.9876, 'ndcg@10': 0.9816, 'compress@10': 0.5062, 'time@10': 38.1773}:  80%|████████  | 8/10 [03:35<00:59, 29.96s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.0662, 'hit_ratio@10': 0.9882, 'ndcg@10': 0.9868, 'compress@10': 0.5059, 'time@10': 40.8609}:  80%|████████  | 8/10 [04:06<00:59, 29.96s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.0662, 'hit_ratio@10': 0.9882, 'ndcg@10': 0.9868, 'compress@10': 0.5059, 'time@10': 40.8609}:  90%|█████████ | 9/10 [04:06<00:30, 30.35s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.0648, 'hit_ratio@10': 0.9888, 'ndcg@10': 0.989, 'compress@10': 0.5056, 'time@10': 40.756}:  90%|█████████ | 9/10 [04:46<00:30, 30.35s/it]     {'epoch': 0, 'num_users': 6.3, 'loss': 0.0648, 'hit_ratio@10': 0.9888, 'ndcg@10': 0.989, 'compress@10': 0.5056, 'time@10': 40.756}: 100%|██████████| 10/10 [04:46<00:00, 33.28s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.0648, 'hit_ratio@10': 0.9888, 'ndcg@10': 0.989, 'compress@10': 0.5056, 'time@10': 40.756}: 100%|██████████| 10/10 [04:46<00:00, 28.63s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.06478250271546303
Avg hit ratio: 0.9887532674922724
Avg ndcg: 0.9890139801645124
Avg compression ratio: 0.5056205050258403
Avg train time: 40.75596811771393
Std train time: 20.948704352994636
[0.25, 0.75, 0.75, 0.75, 0.75, 0.75, 0.25, 0.25, 0.25, 0.25]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0553, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0132, 'compress@10': 0.2604, 'time@10': 32.6019}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0553, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0132, 'compress@10': 0.2604, 'time@10': 32.6019}:  10%|█         | 1/10 [00:16<02:27, 16.34s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0553, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.005, 'compress@10': 0.5062, 'time@10': 30.2744}:  10%|█         | 1/10 [00:44<02:27, 16.34s/it] {'epoch': 1, 'num_users': 7.0, 'loss': 0.0553, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.005, 'compress@10': 0.5062, 'time@10': 30.2744}:  20%|██        | 2/10 [00:44<03:05, 23.20s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0195, 'compress@10': 0.5907, 'time@10': 24.61}:  20%|██        | 2/10 [00:51<03:05, 23.20s/it]  {'epoch': 1, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0195, 'compress@10': 0.5907, 'time@10': 24.61}:  30%|███       | 3/10 [00:51<01:49, 15.65s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0406, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0185, 'compress@10': 0.6311, 'time@10': 24.4711}:  30%|███       | 3/10 [01:15<01:49, 15.65s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0406, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0185, 'compress@10': 0.6311, 'time@10': 24.4711}:  40%|████      | 4/10 [01:15<01:53, 18.99s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0099, 'compress@10': 0.6552, 'time@10': 35.8268}:  40%|████      | 4/10 [01:55<01:53, 18.99s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0099, 'compress@10': 0.6552, 'time@10': 35.8268}:  50%|█████     | 5/10 [01:55<02:14, 26.80s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0505, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.008, 'compress@10': 0.6712, 'time@10': 36.6859}:  50%|█████     | 5/10 [02:36<02:14, 26.80s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0505, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.008, 'compress@10': 0.6712, 'time@10': 36.6859}:  60%|██████    | 6/10 [02:36<02:06, 31.64s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.05, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0075, 'compress@10': 0.6122, 'time@10': 37.8891}:  60%|██████    | 6/10 [02:59<02:06, 31.64s/it] {'epoch': 1, 'num_users': 6.2857, 'loss': 0.05, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0075, 'compress@10': 0.6122, 'time@10': 37.8891}:  70%|███████   | 7/10 [02:59<01:26, 28.68s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0494, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0105, 'compress@10': 0.5676, 'time@10': 37.1246}:  70%|███████   | 7/10 [03:31<01:26, 28.68s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0494, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0105, 'compress@10': 0.5676, 'time@10': 37.1246}:  80%|████████  | 8/10 [03:31<00:59, 29.68s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0507, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0201, 'compress@10': 0.5329, 'time@10': 39.1778}:  80%|████████  | 8/10 [03:59<00:59, 29.68s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0507, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0201, 'compress@10': 0.5329, 'time@10': 39.1778}:  90%|█████████ | 9/10 [03:59<00:29, 29.10s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0185, 'compress@10': 0.5051, 'time@10': 39.2268}:  90%|█████████ | 9/10 [04:38<00:29, 29.10s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0185, 'compress@10': 0.5051, 'time@10': 39.2268}: 100%|██████████| 10/10 [04:38<00:00, 32.38s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0185, 'compress@10': 0.5051, 'time@10': 39.2268}: 100%|██████████| 10/10 [04:38<00:00, 27.87s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.04945276032259601
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0184807670526559
Avg compression ratio: 0.505071137153986
Avg train time: 39.22684407234192
Std train time: 17.89416240765805
[0.5, 0.8333333333333334, 0.5, 0.5, 0.8333333333333334, 0.8333333333333334, 0.16666666666666669, 0.16666666666666669, 0.5, 0.16666666666666669]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0547, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0181, 'compress@10': 0.5069, 'time@10': 33.4791}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0547, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0181, 'compress@10': 0.5069, 'time@10': 33.4791}:  10%|█         | 1/10 [00:16<02:30, 16.78s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0527, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0109, 'compress@10': 0.6708, 'time@10': 30.2376}:  10%|█         | 1/10 [00:43<02:30, 16.78s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0527, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0109, 'compress@10': 0.6708, 'time@10': 30.2376}:  20%|██        | 2/10 [00:43<03:02, 22.81s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0382, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.023, 'compress@10': 0.6203, 'time@10': 24.89}:  20%|██        | 2/10 [00:50<03:02, 22.81s/it]   {'epoch': 2, 'num_users': 5.0, 'loss': 0.0382, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.023, 'compress@10': 0.6203, 'time@10': 24.89}:  30%|███       | 3/10 [00:50<01:49, 15.65s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0398, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0224, 'compress@10': 0.5914, 'time@10': 24.8253}:  30%|███       | 3/10 [01:15<01:49, 15.65s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0398, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0224, 'compress@10': 0.5914, 'time@10': 24.8253}:  40%|████      | 4/10 [01:15<01:55, 19.21s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0128, 'compress@10': 0.64, 'time@10': 34.4332}:  40%|████      | 4/10 [01:52<01:55, 19.21s/it]  {'epoch': 2, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0128, 'compress@10': 0.64, 'time@10': 34.4332}:  50%|█████     | 5/10 [01:52<02:07, 25.44s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0473, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0116, 'compress@10': 0.6723, 'time@10': 35.4758}:  50%|█████     | 5/10 [02:32<02:07, 25.44s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0473, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0116, 'compress@10': 0.6723, 'time@10': 35.4758}:  60%|██████    | 6/10 [02:32<02:02, 30.63s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.047, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0126, 'compress@10': 0.6014, 'time@10': 36.7123}:  60%|██████    | 6/10 [02:54<02:02, 30.63s/it] {'epoch': 2, 'num_users': 6.2857, 'loss': 0.047, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0126, 'compress@10': 0.6014, 'time@10': 36.7123}:  70%|███████   | 7/10 [02:54<01:23, 27.85s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0469, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0168, 'compress@10': 0.5478, 'time@10': 35.9692}:  70%|███████   | 7/10 [03:25<01:23, 27.85s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0469, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0168, 'compress@10': 0.5478, 'time@10': 35.9692}:  80%|████████  | 8/10 [03:25<00:57, 28.79s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0483, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0246, 'compress@10': 0.5429, 'time@10': 38.2991}:  80%|████████  | 8/10 [03:54<00:57, 28.79s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0483, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0246, 'compress@10': 0.5429, 'time@10': 38.2991}:  90%|█████████ | 9/10 [03:54<00:28, 28.70s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0468, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0252, 'compress@10': 0.5058, 'time@10': 38.4963}:  90%|█████████ | 9/10 [04:34<00:28, 28.70s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0468, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0252, 'compress@10': 0.5058, 'time@10': 38.4963}: 100%|██████████| 10/10 [04:34<00:00, 32.28s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0468, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0252, 'compress@10': 0.5058, 'time@10': 38.4963}: 100%|██████████| 10/10 [04:34<00:00, 27.45s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.046754642178682665
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0252430445260385
Avg compression ratio: 0.5057739494191537
Avg train time: 38.49628937244415
Std train time: 16.003132714818005
[0.625, 0.875, 0.375, 0.375, 0.875, 0.875, 0.125, 0.125, 0.625, 0.125]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0529, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0179, 'compress@10': 0.6302, 'time@10': 33.3671}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0529, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0179, 'compress@10': 0.6302, 'time@10': 33.3671}:  10%|█         | 1/10 [00:16<02:30, 16.72s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0134, 'compress@10': 0.7531, 'time@10': 29.6891}:  10%|█         | 1/10 [00:42<02:30, 16.72s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0134, 'compress@10': 0.7531, 'time@10': 29.6891}:  20%|██        | 2/10 [00:42<02:57, 22.21s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0373, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.025, 'compress@10': 0.6351, 'time@10': 24.8148}:  20%|██        | 2/10 [00:50<02:57, 22.21s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0373, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.025, 'compress@10': 0.6351, 'time@10': 24.8148}:  30%|███       | 3/10 [00:50<01:48, 15.53s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0382, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0248, 'compress@10': 0.5716, 'time@10': 24.8595}:  30%|███       | 3/10 [01:15<01:48, 15.53s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0382, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0248, 'compress@10': 0.5716, 'time@10': 24.8595}:  40%|████      | 4/10 [01:15<01:55, 19.28s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0438, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0153, 'compress@10': 0.6324, 'time@10': 31.9029}:  40%|████      | 4/10 [01:45<01:55, 19.28s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0438, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0153, 'compress@10': 0.6324, 'time@10': 31.9029}:  50%|█████     | 5/10 [01:45<01:55, 23.17s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.044, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0138, 'compress@10': 0.6729, 'time@10': 33.4145}:  50%|█████     | 5/10 [02:26<01:55, 23.17s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.044, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0138, 'compress@10': 0.6729, 'time@10': 33.4145}:  60%|██████    | 6/10 [02:26<01:57, 29.32s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0437, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0149, 'compress@10': 0.596, 'time@10': 34.6664}:  60%|██████    | 6/10 [02:47<01:57, 29.32s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0437, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0149, 'compress@10': 0.596, 'time@10': 34.6664}:  70%|███████   | 7/10 [02:47<01:19, 26.64s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0436, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0203, 'compress@10': 0.5379, 'time@10': 34.0783}:  70%|███████   | 7/10 [03:17<01:19, 26.64s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0436, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0203, 'compress@10': 0.5379, 'time@10': 34.0783}:  80%|████████  | 8/10 [03:17<00:55, 27.71s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0438, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0212, 'compress@10': 0.5479, 'time@10': 36.3692}:  80%|████████  | 8/10 [03:45<00:55, 27.71s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0438, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0212, 'compress@10': 0.5479, 'time@10': 36.3692}:  90%|█████████ | 9/10 [03:45<00:27, 27.61s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0421, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0241, 'compress@10': 0.5061, 'time@10': 36.5796}:  90%|█████████ | 9/10 [04:23<00:27, 27.61s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0421, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0241, 'compress@10': 0.5061, 'time@10': 36.5796}: 100%|██████████| 10/10 [04:23<00:00, 30.98s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0421, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0241, 'compress@10': 0.5061, 'time@10': 36.5796}: 100%|██████████| 10/10 [04:23<00:00, 26.38s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.042099204844340904
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.02411995013931
Avg compression ratio: 0.5061253293308405
Avg train time: 36.579614472389224
Std train time: 13.02848806813282
[0.7, 0.9, 0.3, 0.3, 0.9, 0.9, 0.1, 0.1, 0.7, 0.1]
[10, 10, 14, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0518, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0092, 'compress@10': 0.7042, 'time@10': 32.0135}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0518, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0092, 'compress@10': 0.7042, 'time@10': 32.0135}:  10%|█         | 1/10 [00:16<02:24, 16.04s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.046, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0121, 'compress@10': 0.8025, 'time@10': 28.6446}:  10%|█         | 1/10 [00:41<02:24, 16.04s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.046, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0121, 'compress@10': 0.8025, 'time@10': 28.6446}:  20%|██        | 2/10 [00:41<02:52, 21.52s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0353, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0238, 'compress@10': 0.644, 'time@10': 24.276}:  20%|██        | 2/10 [00:49<02:52, 21.52s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0353, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0238, 'compress@10': 0.644, 'time@10': 24.276}:  30%|███       | 3/10 [00:49<01:46, 15.26s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.036, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0238, 'compress@10': 0.5596, 'time@10': 24.2768}:  30%|███       | 3/10 [01:13<01:46, 15.26s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.036, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0238, 'compress@10': 0.5596, 'time@10': 24.2768}:  40%|████      | 4/10 [01:13<01:52, 18.83s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0406, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0165, 'compress@10': 0.6278, 'time@10': 30.9454}:  40%|████      | 4/10 [01:42<01:52, 18.83s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0406, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0165, 'compress@10': 0.6278, 'time@10': 30.9454}:  50%|█████     | 5/10 [01:42<01:52, 22.44s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.04, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0154, 'compress@10': 0.6733, 'time@10': 32.3698}:  50%|█████     | 5/10 [02:21<01:52, 22.44s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.04, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0154, 'compress@10': 0.6733, 'time@10': 32.3698}:  60%|██████    | 6/10 [02:21<01:53, 28.25s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0394, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0161, 'compress@10': 0.5927, 'time@10': 33.6642}:  60%|██████    | 6/10 [02:42<01:53, 28.25s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0394, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0161, 'compress@10': 0.5927, 'time@10': 33.6642}:  70%|███████   | 7/10 [02:42<01:17, 25.80s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0389, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0208, 'compress@10': 0.532, 'time@10': 33.099}:  70%|███████   | 7/10 [03:11<01:17, 25.80s/it]   {'epoch': 4, 'num_users': 6.125, 'loss': 0.0389, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0208, 'compress@10': 0.532, 'time@10': 33.099}:  80%|████████  | 8/10 [03:11<00:53, 26.88s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0388, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0205, 'compress@10': 0.5509, 'time@10': 35.4708}:  80%|████████  | 8/10 [03:39<00:53, 26.88s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0388, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0205, 'compress@10': 0.5509, 'time@10': 35.4708}:  90%|█████████ | 9/10 [03:39<00:26, 27.00s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0372, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0237, 'compress@10': 0.5063, 'time@10': 35.7065}:  90%|█████████ | 9/10 [04:16<00:26, 27.00s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0372, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0237, 'compress@10': 0.5063, 'time@10': 35.7065}: 100%|██████████| 10/10 [04:16<00:00, 30.35s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0372, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0237, 'compress@10': 0.5063, 'time@10': 35.7065}: 100%|██████████| 10/10 [04:16<00:00, 25.70s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.03717995041118002
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0237086860454079
Avg compression ratio: 0.5063355055502969
Avg train time: 35.70654685497284
Std train time: 12.59278145791258
[0.75, 0.9166666666666667, 0.25, 0.41666666666666663, 0.9166666666666667, 0.75, 0.08333333333333334, 0.08333333333333334, 0.75, 0.08333333333333334]
[10, 10, 15, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0088, 'compress@10': 0.7535, 'time@10': 32.678}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0088, 'compress@10': 0.7535, 'time@10': 32.678}:  10%|█         | 1/10 [00:16<02:27, 16.38s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.013, 'compress@10': 0.8354, 'time@10': 29.0133}:  10%|█         | 1/10 [00:41<02:27, 16.38s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.013, 'compress@10': 0.8354, 'time@10': 29.0133}:  20%|██        | 2/10 [00:41<02:53, 21.68s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0254, 'compress@10': 0.6499, 'time@10': 24.8845}:  20%|██        | 2/10 [00:50<02:53, 21.68s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0254, 'compress@10': 0.6499, 'time@10': 24.8845}:  30%|███       | 3/10 [00:50<01:49, 15.59s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0239, 'compress@10': 0.593, 'time@10': 24.7195}:  30%|███       | 3/10 [01:14<01:49, 15.59s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0239, 'compress@10': 0.593, 'time@10': 24.7195}:  40%|████      | 4/10 [01:14<01:54, 19.01s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0361, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0183, 'compress@10': 0.6578, 'time@10': 31.2207}:  40%|████      | 4/10 [01:43<01:54, 19.01s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0361, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0183, 'compress@10': 0.6578, 'time@10': 31.2207}:  50%|█████     | 5/10 [01:43<01:52, 22.49s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0351, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0182, 'compress@10': 0.6734, 'time@10': 32.6823}:  50%|█████     | 5/10 [02:23<01:52, 22.49s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0351, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0182, 'compress@10': 0.6734, 'time@10': 32.6823}:  60%|██████    | 6/10 [02:23<01:53, 28.45s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0196, 'compress@10': 0.5905, 'time@10': 33.9104}:  60%|██████    | 6/10 [02:43<01:53, 28.45s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0196, 'compress@10': 0.5905, 'time@10': 33.9104}:  70%|███████   | 7/10 [02:43<01:17, 25.91s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0339, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.024, 'compress@10': 0.5279, 'time@10': 33.2478}:  70%|███████   | 7/10 [03:12<01:17, 25.91s/it]  {'epoch': 5, 'num_users': 6.125, 'loss': 0.0339, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.024, 'compress@10': 0.5279, 'time@10': 33.2478}:  80%|████████  | 8/10 [03:12<00:53, 26.78s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0344, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.028, 'compress@10': 0.5528, 'time@10': 35.5867}:  80%|████████  | 8/10 [03:39<00:53, 26.78s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0344, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.028, 'compress@10': 0.5528, 'time@10': 35.5867}:  90%|█████████ | 9/10 [03:39<00:26, 26.91s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0331, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0301, 'compress@10': 0.5064, 'time@10': 35.8007}:  90%|█████████ | 9/10 [04:17<00:26, 26.91s/it]  {'epoch': 5, 'num_users': 6.3, 'loss': 0.0331, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0301, 'compress@10': 0.5064, 'time@10': 35.8007}: 100%|██████████| 10/10 [04:17<00:00, 30.26s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0331, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0301, 'compress@10': 0.5064, 'time@10': 35.8007}: 100%|██████████| 10/10 [04:17<00:00, 25.73s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.033123197782240106
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0301387019095407
Avg compression ratio: 0.506414936961433
Avg train time: 35.80068573951721
Std train time: 12.348345057025034
[0.7857142857142857, 0.9285714285714286, 0.2142857142857143, 0.5, 0.9285714285714286, 0.6428571428571429, 0.07142857142857144, 0.07142857142857144, 0.7857142857142857, 0.07142857142857144]
[10, 10, 16, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0066, 'compress@10': 0.7887, 'time@10': 32.5199}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0066, 'compress@10': 0.7887, 'time@10': 32.5199}:  10%|█         | 1/10 [00:16<02:26, 16.30s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0373, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0137, 'compress@10': 0.8589, 'time@10': 28.6727}:  10%|█         | 1/10 [00:41<02:26, 16.30s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0373, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0137, 'compress@10': 0.8589, 'time@10': 28.6727}:  20%|██        | 2/10 [00:41<02:50, 21.34s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0219, 'compress@10': 0.6541, 'time@10': 25.2502}:  20%|██        | 2/10 [00:50<02:50, 21.34s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0219, 'compress@10': 0.6541, 'time@10': 25.2502}:  30%|███       | 3/10 [00:50<01:50, 15.81s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0253, 'compress@10': 0.6168, 'time@10': 24.9845}:  30%|███       | 3/10 [01:14<01:50, 15.81s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0253, 'compress@10': 0.6168, 'time@10': 24.9845}:  40%|████      | 4/10 [01:14<01:54, 19.14s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0342, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0212, 'compress@10': 0.6792, 'time@10': 31.3874}:  40%|████      | 4/10 [01:43<01:54, 19.14s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0342, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0212, 'compress@10': 0.6792, 'time@10': 31.3874}:  50%|█████     | 5/10 [01:43<01:52, 22.53s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0326, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0233, 'compress@10': 0.6735, 'time@10': 32.6995}:  50%|█████     | 5/10 [02:22<01:52, 22.53s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0326, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0233, 'compress@10': 0.6735, 'time@10': 32.6995}:  60%|██████    | 6/10 [02:22<01:52, 28.23s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0317, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0244, 'compress@10': 0.5889, 'time@10': 34.0643}:  60%|██████    | 6/10 [02:43<01:52, 28.23s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0317, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0244, 'compress@10': 0.5889, 'time@10': 34.0643}:  70%|███████   | 7/10 [02:43<01:17, 25.92s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0313, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0283, 'compress@10': 0.5251, 'time@10': 33.374}:  70%|███████   | 7/10 [03:12<01:17, 25.92s/it]  {'epoch': 6, 'num_users': 6.125, 'loss': 0.0313, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0283, 'compress@10': 0.5251, 'time@10': 33.374}:  80%|████████  | 8/10 [03:12<00:53, 26.77s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0313, 'compress@10': 0.5542, 'time@10': 35.5388}:  80%|████████  | 8/10 [03:38<00:53, 26.77s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0313, 'compress@10': 0.5542, 'time@10': 35.5388}:  90%|█████████ | 9/10 [03:38<00:26, 26.67s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0334, 'compress@10': 0.5065, 'time@10': 35.6788}:  90%|█████████ | 9/10 [04:15<00:26, 26.67s/it]  {'epoch': 6, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0334, 'compress@10': 0.5065, 'time@10': 35.6788}: 100%|██████████| 10/10 [04:15<00:00, 29.85s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0334, 'compress@10': 0.5065, 'time@10': 35.6788}: 100%|██████████| 10/10 [04:15<00:00, 25.57s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.030663024150726657
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0333935078961183
Avg compression ratio: 0.5064691223274373
Avg train time: 35.67884833812714
Std train time: 11.901447375095517
[0.8125, 0.9375, 0.1875, 0.4375, 0.9375, 0.5625, 0.06250000000000001, 0.1875, 0.8125, 0.06250000000000001]
[10, 10, 17, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0406, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0097, 'compress@10': 0.8151, 'time@10': 32.3661}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0406, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0097, 'compress@10': 0.8151, 'time@10': 32.3661}:  10%|█         | 1/10 [00:16<02:25, 16.22s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0324, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0157, 'compress@10': 0.8766, 'time@10': 28.6343}:  10%|█         | 1/10 [00:41<02:25, 16.22s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0324, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0157, 'compress@10': 0.8766, 'time@10': 28.6343}:  20%|██        | 2/10 [00:41<02:50, 21.35s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0222, 'compress@10': 0.6573, 'time@10': 25.2669}:  20%|██        | 2/10 [00:50<02:50, 21.35s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0222, 'compress@10': 0.6573, 'time@10': 25.2669}:  30%|███       | 3/10 [00:50<01:50, 15.85s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0281, 'compress@10': 0.6037, 'time@10': 24.874}:  30%|███       | 3/10 [01:14<01:50, 15.85s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0281, 'compress@10': 0.6037, 'time@10': 24.874}:  40%|████      | 4/10 [01:14<01:53, 18.96s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0284, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0237, 'compress@10': 0.6705, 'time@10': 31.1614}:  40%|████      | 4/10 [01:42<01:53, 18.96s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0284, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0237, 'compress@10': 0.6705, 'time@10': 31.1614}:  50%|█████     | 5/10 [01:42<01:51, 22.29s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0272, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.027, 'compress@10': 0.6529, 'time@10': 32.5049}:  50%|█████     | 5/10 [02:21<01:51, 22.29s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0272, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.027, 'compress@10': 0.6529, 'time@10': 32.5049}:  60%|██████    | 6/10 [02:21<01:52, 28.06s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0269, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0279, 'compress@10': 0.57, 'time@10': 33.7169}:  60%|██████    | 6/10 [02:42<01:52, 28.06s/it] {'epoch': 7, 'num_users': 6.2857, 'loss': 0.0269, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0279, 'compress@10': 0.57, 'time@10': 33.7169}:  70%|███████   | 7/10 [02:42<01:16, 25.60s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0261, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0328, 'compress@10': 0.5229, 'time@10': 33.2262}:  70%|███████   | 7/10 [03:12<01:16, 25.60s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0261, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0328, 'compress@10': 0.5229, 'time@10': 33.2262}:  80%|████████  | 8/10 [03:12<00:53, 26.95s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.027, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0369, 'compress@10': 0.5553, 'time@10': 35.1871}:  80%|████████  | 8/10 [03:37<00:53, 26.95s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.027, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0369, 'compress@10': 0.5553, 'time@10': 35.1871}:  90%|█████████ | 9/10 [03:37<00:26, 26.49s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0261, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0388, 'compress@10': 0.5065, 'time@10': 35.3957}:  90%|█████████ | 9/10 [04:14<00:26, 26.49s/it]  {'epoch': 7, 'num_users': 6.3, 'loss': 0.0261, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0388, 'compress@10': 0.5065, 'time@10': 35.3957}: 100%|██████████| 10/10 [04:14<00:00, 29.83s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0261, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0388, 'compress@10': 0.5065, 'time@10': 35.3957}: 100%|██████████| 10/10 [04:14<00:00, 25.48s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.02609656359859197
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0388097214416885
Avg compression ratio: 0.5065379726057753
Avg train time: 35.39573626518249
Std train time: 11.395122797958113
[0.8333333333333334, 0.9444444444444444, 0.16666666666666666, 0.3888888888888889, 0.9444444444444444, 0.5, 0.16666666666666669, 0.16666666666666666, 0.8333333333333334, 0.055555555555555566]
[10, 10, 18, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0066, 'compress@10': 0.8356, 'time@10': 31.2491}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0066, 'compress@10': 0.8356, 'time@10': 31.2491}:  10%|█         | 1/10 [00:15<02:20, 15.66s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0305, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0205, 'compress@10': 0.8903, 'time@10': 27.8477}:  10%|█         | 1/10 [00:40<02:20, 15.66s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0305, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0205, 'compress@10': 0.8903, 'time@10': 27.8477}:  20%|██        | 2/10 [00:40<02:46, 20.86s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0248, 'compress@10': 0.6598, 'time@10': 25.0588}:  20%|██        | 2/10 [00:49<02:46, 20.86s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0248, 'compress@10': 0.6598, 'time@10': 25.0588}:  30%|███       | 3/10 [00:49<01:50, 15.80s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0312, 'compress@10': 0.5935, 'time@10': 24.7257}:  30%|███       | 3/10 [01:13<01:50, 15.80s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0312, 'compress@10': 0.5935, 'time@10': 24.7257}:  40%|████      | 4/10 [01:13<01:53, 18.94s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0267, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0287, 'compress@10': 0.6637, 'time@10': 31.1149}:  40%|████      | 4/10 [01:42<01:53, 18.94s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0267, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0287, 'compress@10': 0.6637, 'time@10': 31.1149}:  50%|█████     | 5/10 [01:42<01:51, 22.34s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0259, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0323, 'compress@10': 0.6369, 'time@10': 32.5639}:  50%|█████     | 5/10 [02:21<01:51, 22.34s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0259, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0323, 'compress@10': 0.6369, 'time@10': 32.5639}:  60%|██████    | 6/10 [02:21<01:53, 28.30s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0255, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0324, 'compress@10': 0.571, 'time@10': 33.8782}:  60%|██████    | 6/10 [02:42<01:53, 28.30s/it] {'epoch': 8, 'num_users': 6.2857, 'loss': 0.0255, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0324, 'compress@10': 0.571, 'time@10': 33.8782}:  70%|███████   | 7/10 [02:42<01:17, 25.88s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0258, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0374, 'compress@10': 0.5212, 'time@10': 33.3087}:  70%|███████   | 7/10 [03:12<01:17, 25.88s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0258, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0374, 'compress@10': 0.5212, 'time@10': 33.3087}:  80%|████████  | 8/10 [03:12<00:53, 26.99s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0425, 'compress@10': 0.5561, 'time@10': 35.2518}:  80%|████████  | 8/10 [03:37<00:53, 26.99s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0425, 'compress@10': 0.5561, 'time@10': 35.2518}:  90%|█████████ | 9/10 [03:37<00:26, 26.50s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0258, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0444, 'compress@10': 0.5066, 'time@10': 35.4417}:  90%|█████████ | 9/10 [04:14<00:26, 26.50s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0258, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0444, 'compress@10': 0.5066, 'time@10': 35.4417}: 100%|██████████| 10/10 [04:14<00:00, 29.80s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0258, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0444, 'compress@10': 0.5066, 'time@10': 35.4417}: 100%|██████████| 10/10 [04:14<00:00, 25.48s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.02582847238770105
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0444150106223082
Avg compression ratio: 0.5065558169968989
Avg train time: 35.44168176651001
Std train time: 11.473344705937969
[0.8500000000000001, 0.85, 0.15, 0.35, 0.95, 0.45, 0.25, 0.25, 0.8500000000000001, 0.05000000000000001]
[10, 10, 19, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0376, 'hit_ratio@10': 0.9861, 'ndcg@10': 0.9982, 'compress@10': 0.8521, 'time@10': 31.8959}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0376, 'hit_ratio@10': 0.9861, 'ndcg@10': 0.9982, 'compress@10': 0.8521, 'time@10': 31.8959}:  10%|█         | 1/10 [00:15<02:23, 15.99s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0199, 'compress@10': 0.8516, 'time@10': 28.9872}:  10%|█         | 1/10 [00:42<02:23, 15.99s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0199, 'compress@10': 0.8516, 'time@10': 28.9872}:  20%|██        | 2/10 [00:42<02:55, 21.94s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0267, 'compress@10': 0.6287, 'time@10': 26.1209}:  20%|██        | 2/10 [00:52<02:55, 21.94s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0267, 'compress@10': 0.6287, 'time@10': 26.1209}:  30%|███       | 3/10 [00:52<01:56, 16.60s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0361, 'compress@10': 0.5605, 'time@10': 25.4495}:  30%|███       | 3/10 [01:15<01:56, 16.60s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0361, 'compress@10': 0.5605, 'time@10': 25.4495}:  40%|████      | 4/10 [01:15<01:55, 19.31s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0339, 'compress@10': 0.6385, 'time@10': 31.9573}:  40%|████      | 4/10 [01:44<01:55, 19.31s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0339, 'compress@10': 0.6385, 'time@10': 31.9573}:  50%|█████     | 5/10 [01:44<01:54, 22.82s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0358, 'compress@10': 0.6076, 'time@10': 33.2106}:  50%|█████     | 5/10 [02:24<01:54, 22.82s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0358, 'compress@10': 0.6076, 'time@10': 33.2106}:  60%|██████    | 6/10 [02:24<01:53, 28.49s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0363, 'compress@10': 0.5577, 'time@10': 34.4333}:  60%|██████    | 6/10 [02:45<01:53, 28.49s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0363, 'compress@10': 0.5577, 'time@10': 34.4333}:  70%|███████   | 7/10 [02:45<01:18, 26.02s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0234, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0403, 'compress@10': 0.5199, 'time@10': 33.8658}:  70%|███████   | 7/10 [03:15<01:18, 26.02s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0234, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0403, 'compress@10': 0.5199, 'time@10': 33.8658}:  80%|████████  | 8/10 [03:15<00:54, 27.26s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0245, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0441, 'compress@10': 0.5567, 'time@10': 35.6189}:  80%|████████  | 8/10 [03:40<00:54, 27.26s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0245, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0441, 'compress@10': 0.5567, 'time@10': 35.6189}:  90%|█████████ | 9/10 [03:40<00:26, 26.51s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0462, 'compress@10': 0.5066, 'time@10': 35.7795}:  90%|█████████ | 9/10 [04:17<00:26, 26.51s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0462, 'compress@10': 0.5066, 'time@10': 35.7795}: 100%|██████████| 10/10 [04:17<00:00, 29.83s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0462, 'compress@10': 0.5066, 'time@10': 35.7795}: 100%|██████████| 10/10 [04:17<00:00, 25.73s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.023285383134075608
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.046173971102847
Avg compression ratio: 0.5065762624115274
Avg train time: 35.77952311038971
Std train time: 11.270232115815793
[0.8636363636363638, 0.7727272727272727, 0.13636363636363635, 0.3181818181818182, 0.9545454545454545, 0.5, 0.22727272727272727, 0.3181818181818182, 0.8636363636363638, 0.04545454545454546]
[10, 10, 19, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.032, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0084, 'compress@10': 0.8655, 'time@10': 32.2376}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.032, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0084, 'compress@10': 0.8655, 'time@10': 32.2376}:  10%|█         | 1/10 [00:16<02:25, 16.16s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0325, 'compress@10': 0.8201, 'time@10': 29.4296}:  10%|█         | 1/10 [00:42<02:25, 16.16s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0325, 'compress@10': 0.8201, 'time@10': 29.4296}:  20%|██        | 2/10 [00:42<02:58, 22.33s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0343, 'compress@10': 0.6032, 'time@10': 26.4933}:  20%|██        | 2/10 [00:53<02:58, 22.33s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0343, 'compress@10': 0.6032, 'time@10': 26.4933}:  30%|███       | 3/10 [00:53<01:58, 16.86s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0402, 'compress@10': 0.5336, 'time@10': 25.6318}:  30%|███       | 3/10 [01:16<01:58, 16.86s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0402, 'compress@10': 0.5336, 'time@10': 25.6318}:  40%|████      | 4/10 [01:16<01:55, 19.32s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0213, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0387, 'compress@10': 0.6178, 'time@10': 32.3415}:  40%|████      | 4/10 [01:45<01:55, 19.32s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0213, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0387, 'compress@10': 0.6178, 'time@10': 32.3415}:  50%|█████     | 5/10 [01:45<01:55, 23.04s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0218, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.042, 'compress@10': 0.5987, 'time@10': 33.5132}:  50%|█████     | 5/10 [02:25<01:55, 23.04s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0218, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.042, 'compress@10': 0.5987, 'time@10': 33.5132}:  60%|██████    | 6/10 [02:25<01:54, 28.60s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0218, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0413, 'compress@10': 0.5468, 'time@10': 34.6038}:  60%|██████    | 6/10 [02:45<01:54, 28.60s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0218, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0413, 'compress@10': 0.5468, 'time@10': 34.6038}:  70%|███████   | 7/10 [02:45<01:17, 25.99s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0218, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0462, 'compress@10': 0.5188, 'time@10': 34.0412}:  70%|███████   | 7/10 [03:16<01:17, 25.99s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0218, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0462, 'compress@10': 0.5188, 'time@10': 34.0412}:  80%|████████  | 8/10 [03:16<00:54, 27.31s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0502, 'compress@10': 0.5573, 'time@10': 35.8816}:  80%|████████  | 8/10 [03:41<00:54, 27.31s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0502, 'compress@10': 0.5573, 'time@10': 35.8816}:  90%|█████████ | 9/10 [03:41<00:26, 26.70s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0516, 'compress@10': 0.5066, 'time@10': 36.0025}:  90%|█████████ | 9/10 [04:18<00:26, 26.70s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0516, 'compress@10': 0.5066, 'time@10': 36.0025}: 100%|██████████| 10/10 [04:18<00:00, 29.92s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0516, 'compress@10': 0.5066, 'time@10': 36.0025}: 100%|██████████| 10/10 [04:18<00:00, 25.85s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.022064826512309642
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.05163955297789
Avg compression ratio: 0.5066417143463087
Avg train time: 36.00252892971039
Std train time: 11.536429446125338
[0.8750000000000001, 0.7083333333333333, 0.12499999999999999, 0.2916666666666667, 0.9583333333333333, 0.5416666666666666, 0.29166666666666663, 0.2916666666666667, 0.8750000000000001, 0.04166666666666667]
[10, 10, 19, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0082, 'compress@10': 0.8767, 'time@10': 30.9311}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0082, 'compress@10': 0.8767, 'time@10': 30.9311}:  10%|█         | 1/10 [00:15<02:19, 15.50s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0338, 'compress@10': 0.7937, 'time@10': 28.9874}:  10%|█         | 1/10 [00:42<02:19, 15.50s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0338, 'compress@10': 0.7937, 'time@10': 28.9874}:  20%|██        | 2/10 [00:42<02:58, 22.31s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0343, 'compress@10': 0.582, 'time@10': 26.1498}:  20%|██        | 2/10 [00:52<02:58, 22.31s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0343, 'compress@10': 0.582, 'time@10': 26.1498}:  30%|███       | 3/10 [00:52<01:57, 16.82s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0433, 'compress@10': 0.5111, 'time@10': 25.4248}:  30%|███       | 3/10 [01:16<01:57, 16.82s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0433, 'compress@10': 0.5111, 'time@10': 25.4248}:  40%|████      | 4/10 [01:16<01:56, 19.37s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0432, 'compress@10': 0.6006, 'time@10': 32.0991}:  40%|████      | 4/10 [01:45<01:56, 19.37s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0432, 'compress@10': 0.6006, 'time@10': 32.0991}:  50%|█████     | 5/10 [01:45<01:55, 23.00s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0214, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0482, 'compress@10': 0.5912, 'time@10': 33.31}:  50%|█████     | 5/10 [02:24<01:55, 23.00s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0214, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0482, 'compress@10': 0.5912, 'time@10': 33.31}:  60%|██████    | 6/10 [02:24<01:54, 28.58s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.049, 'compress@10': 0.5495, 'time@10': 34.4633}:  60%|██████    | 6/10 [02:45<01:54, 28.58s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.049, 'compress@10': 0.5495, 'time@10': 34.4633}:  70%|███████   | 7/10 [02:45<01:18, 26.01s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0213, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0539, 'compress@10': 0.5179, 'time@10': 33.8687}:  70%|███████   | 7/10 [03:15<01:18, 26.01s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0213, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0539, 'compress@10': 0.5179, 'time@10': 33.8687}:  80%|████████  | 8/10 [03:15<00:54, 27.20s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0564, 'compress@10': 0.5577, 'time@10': 35.661}:  80%|████████  | 8/10 [03:40<00:54, 27.20s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0564, 'compress@10': 0.5577, 'time@10': 35.661}:  90%|█████████ | 9/10 [03:40<00:26, 26.52s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0571, 'compress@10': 0.5067, 'time@10': 35.8181}:  90%|█████████ | 9/10 [04:17<00:26, 26.52s/it]  {'epoch': 11, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0571, 'compress@10': 0.5067, 'time@10': 35.8181}: 100%|██████████| 10/10 [04:17<00:00, 29.84s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0571, 'compress@10': 0.5067, 'time@10': 35.8181}: 100%|██████████| 10/10 [04:17<00:00, 25.78s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.02108218628458942
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0571158623743118
Avg compression ratio: 0.5066699416790772
Avg train time: 35.81814589500427
Std train time: 11.4292745832871
[0.8846153846153847, 0.6538461538461537, 0.11538461538461538, 0.34615384615384615, 0.8846153846153846, 0.5769230769230769, 0.2692307692307692, 0.34615384615384615, 0.8846153846153847, 0.038461538461538464]
[10, 10, 19, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0296, 'compress@10': 0.8862, 'time@10': 31.7643}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0296, 'compress@10': 0.8862, 'time@10': 31.7643}:  10%|█         | 1/10 [00:15<02:23, 15.94s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0454, 'compress@10': 0.7715, 'time@10': 29.2303}:  10%|█         | 1/10 [00:42<02:23, 15.94s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0454, 'compress@10': 0.7715, 'time@10': 29.2303}:  20%|██        | 2/10 [00:42<02:58, 22.29s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0403, 'compress@10': 0.5641, 'time@10': 26.5402}:  20%|██        | 2/10 [00:53<02:58, 22.29s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0403, 'compress@10': 0.5641, 'time@10': 26.5402}:  30%|███       | 3/10 [00:53<01:58, 16.96s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0459, 'compress@10': 0.5112, 'time@10': 25.6004}:  30%|███       | 3/10 [01:16<01:58, 16.96s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0459, 'compress@10': 0.5112, 'time@10': 25.6004}:  40%|████      | 4/10 [01:16<01:55, 19.27s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0466, 'compress@10': 0.586, 'time@10': 32.4453}:  40%|████      | 4/10 [01:46<01:55, 19.27s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0466, 'compress@10': 0.586, 'time@10': 32.4453}:  50%|█████     | 5/10 [01:46<01:55, 23.12s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0201, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0516, 'compress@10': 0.5849, 'time@10': 33.617}:  50%|█████     | 5/10 [02:25<01:55, 23.12s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0201, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0516, 'compress@10': 0.5849, 'time@10': 33.617}:  60%|██████    | 6/10 [02:25<01:54, 28.70s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0206, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0514, 'compress@10': 0.5409, 'time@10': 34.7574}:  60%|██████    | 6/10 [02:46<01:54, 28.70s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0206, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0514, 'compress@10': 0.5409, 'time@10': 34.7574}:  70%|███████   | 7/10 [02:46<01:18, 26.13s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0208, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0544, 'compress@10': 0.5172, 'time@10': 34.2076}:  70%|███████   | 7/10 [03:16<01:18, 26.13s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0208, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0544, 'compress@10': 0.5172, 'time@10': 34.2076}:  80%|████████  | 8/10 [03:16<00:54, 27.49s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0217, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0579, 'compress@10': 0.5581, 'time@10': 36.0811}:  80%|████████  | 8/10 [03:42<00:54, 27.49s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0217, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0579, 'compress@10': 0.5581, 'time@10': 36.0811}:  90%|█████████ | 9/10 [03:42<00:26, 26.89s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0591, 'compress@10': 0.5067, 'time@10': 36.1864}:  90%|█████████ | 9/10 [04:19<00:26, 26.89s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0591, 'compress@10': 0.5067, 'time@10': 36.1864}: 100%|██████████| 10/10 [04:19<00:00, 30.06s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0591, 'compress@10': 0.5067, 'time@10': 36.1864}: 100%|██████████| 10/10 [04:19<00:00, 25.95s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.020596044508673198
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0590781020510602
Avg compression ratio: 0.506680797542445
Avg train time: 36.186446404457094
Std train time: 11.70635733732048
[0.8928571428571429, 0.6071428571428571, 0.10714285714285714, 0.39285714285714285, 0.8214285714285714, 0.6071428571428571, 0.3214285714285714, 0.3214285714285714, 0.8928571428571429, 0.03571428571428572]
[10, 10, 19, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0309, 'compress@10': 0.8943, 'time@10': 31.1157}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0309, 'compress@10': 0.8943, 'time@10': 31.1157}:  10%|█         | 1/10 [00:15<02:20, 15.60s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0457, 'compress@10': 0.7524, 'time@10': 28.8184}:  10%|█         | 1/10 [00:42<02:20, 15.60s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0457, 'compress@10': 0.7524, 'time@10': 28.8184}:  20%|██        | 2/10 [00:42<02:56, 22.04s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0428, 'compress@10': 0.5487, 'time@10': 26.0156}:  20%|██        | 2/10 [00:52<02:56, 22.04s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0428, 'compress@10': 0.5487, 'time@10': 26.0156}:  30%|███       | 3/10 [00:52<01:56, 16.66s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0496, 'compress@10': 0.5112, 'time@10': 25.3481}:  30%|███       | 3/10 [01:15<01:56, 16.66s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0496, 'compress@10': 0.5112, 'time@10': 25.3481}:  40%|████      | 4/10 [01:15<01:55, 19.31s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0182, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0501, 'compress@10': 0.5734, 'time@10': 32.2496}:  40%|████      | 4/10 [01:45<01:55, 19.31s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0182, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0501, 'compress@10': 0.5734, 'time@10': 32.2496}:  50%|█████     | 5/10 [01:45<01:55, 23.15s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0192, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0535, 'compress@10': 0.5794, 'time@10': 33.3507}:  50%|█████     | 5/10 [02:24<01:55, 23.15s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0192, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0535, 'compress@10': 0.5794, 'time@10': 33.3507}:  60%|██████    | 6/10 [02:24<01:54, 28.51s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.019, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0525, 'compress@10': 0.5436, 'time@10': 34.6139}:  60%|██████    | 6/10 [02:45<01:54, 28.51s/it] {'epoch': 13, 'num_users': 6.2857, 'loss': 0.019, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0525, 'compress@10': 0.5436, 'time@10': 34.6139}:  70%|███████   | 7/10 [02:45<01:18, 26.10s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0196, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0568, 'compress@10': 0.5165, 'time@10': 34.0546}:  70%|███████   | 7/10 [03:15<01:18, 26.10s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0196, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0568, 'compress@10': 0.5165, 'time@10': 34.0546}:  80%|████████  | 8/10 [03:15<00:54, 27.40s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0575, 'compress@10': 0.5584, 'time@10': 35.6519}:  80%|████████  | 8/10 [03:40<00:54, 27.40s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0575, 'compress@10': 0.5584, 'time@10': 35.6519}:  90%|█████████ | 9/10 [03:40<00:26, 26.41s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0583, 'compress@10': 0.5067, 'time@10': 35.77}:  90%|█████████ | 9/10 [04:17<00:26, 26.41s/it]     {'epoch': 13, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0583, 'compress@10': 0.5067, 'time@10': 35.77}: 100%|██████████| 10/10 [04:17<00:00, 29.65s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0583, 'compress@10': 0.5067, 'time@10': 35.77}: 100%|██████████| 10/10 [04:17<00:00, 25.71s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.019232161610674085
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.058331089119541
Avg compression ratio: 0.5066686017963458
Avg train time: 35.769976592063905
Std train time: 11.495844576527327
[0.9, 0.5666666666666667, 0.09999999999999999, 0.43333333333333335, 0.7666666666666666, 0.6333333333333333, 0.3, 0.36666666666666664, 0.9, 0.03333333333333334]
[10, 10, 19, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0319, 'compress@10': 0.9014, 'time@10': 31.2756}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0319, 'compress@10': 0.9014, 'time@10': 31.2756}:  10%|█         | 1/10 [00:15<02:21, 15.68s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0472, 'compress@10': 0.7358, 'time@10': 28.9057}:  10%|█         | 1/10 [00:42<02:21, 15.68s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0472, 'compress@10': 0.7358, 'time@10': 28.9057}:  20%|██        | 2/10 [00:42<02:56, 22.09s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0434, 'compress@10': 0.5354, 'time@10': 26.061}:  20%|██        | 2/10 [00:52<02:56, 22.09s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0434, 'compress@10': 0.5354, 'time@10': 26.061}:  30%|███       | 3/10 [00:52<01:56, 16.67s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0511, 'compress@10': 0.5113, 'time@10': 25.2866}:  30%|███       | 3/10 [01:15<01:56, 16.67s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0511, 'compress@10': 0.5113, 'time@10': 25.2866}:  40%|████      | 4/10 [01:15<01:55, 19.17s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0206, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.052, 'compress@10': 0.5626, 'time@10': 32.1944}:  40%|████      | 4/10 [01:45<01:55, 19.17s/it] {'epoch': 14, 'num_users': 5.8, 'loss': 0.0206, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.052, 'compress@10': 0.5626, 'time@10': 32.1944}:  50%|█████     | 5/10 [01:45<01:55, 23.06s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.021, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0562, 'compress@10': 0.5747, 'time@10': 33.2554}:  50%|█████     | 5/10 [02:24<01:55, 23.06s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.021, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0562, 'compress@10': 0.5747, 'time@10': 33.2554}:  60%|██████    | 6/10 [02:24<01:53, 28.34s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.054, 'compress@10': 0.5365, 'time@10': 34.6108}:  60%|██████    | 6/10 [02:45<01:53, 28.34s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.054, 'compress@10': 0.5365, 'time@10': 34.6108}:  70%|███████   | 7/10 [02:45<01:18, 26.08s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0594, 'compress@10': 0.5159, 'time@10': 34.0762}:  70%|███████   | 7/10 [03:15<01:18, 26.08s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0594, 'compress@10': 0.5159, 'time@10': 34.0762}:  80%|████████  | 8/10 [03:15<00:54, 27.44s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0218, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0618, 'compress@10': 0.5586, 'time@10': 35.5712}:  80%|████████  | 8/10 [03:39<00:54, 27.44s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0218, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0618, 'compress@10': 0.5586, 'time@10': 35.5712}:  90%|█████████ | 9/10 [03:39<00:26, 26.31s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0208, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0622, 'compress@10': 0.5067, 'time@10': 35.7217}:  90%|█████████ | 9/10 [04:16<00:26, 26.31s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0208, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0622, 'compress@10': 0.5067, 'time@10': 35.7217}: 100%|██████████| 10/10 [04:16<00:00, 29.64s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0208, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0622, 'compress@10': 0.5067, 'time@10': 35.7217}: 100%|██████████| 10/10 [04:16<00:00, 25.67s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.020777372639054208
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0622232482311833
Avg compression ratio: 0.5066802355005234
Avg train time: 35.72167608737946
Std train time: 11.450925025287143
[0.90625, 0.53125, 0.09374999999999999, 0.46875, 0.71875, 0.65625, 0.28125, 0.40625, 0.90625, 0.03125000000000001]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0326, 'compress@10': 0.9075, 'time@10': 30.6789}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0326, 'compress@10': 0.9075, 'time@10': 30.6789}:  10%|█         | 1/10 [00:15<02:18, 15.38s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.044, 'compress@10': 0.7213, 'time@10': 28.1331}:  10%|█         | 1/10 [00:41<02:18, 15.38s/it]  {'epoch': 15, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.044, 'compress@10': 0.7213, 'time@10': 28.1331}:  20%|██        | 2/10 [00:41<02:51, 21.40s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0411, 'compress@10': 0.5238, 'time@10': 25.5883}:  20%|██        | 2/10 [00:51<02:51, 21.40s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0411, 'compress@10': 0.5238, 'time@10': 25.5883}:  30%|███       | 3/10 [00:51<01:54, 16.33s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0478, 'compress@10': 0.5113, 'time@10': 24.7268}:  30%|███       | 3/10 [01:13<01:54, 16.33s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0478, 'compress@10': 0.5113, 'time@10': 24.7268}:  40%|████      | 4/10 [01:13<01:51, 18.65s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0503, 'compress@10': 0.5531, 'time@10': 31.4115}:  40%|████      | 4/10 [01:42<01:51, 18.65s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0503, 'compress@10': 0.5531, 'time@10': 31.4115}:  50%|█████     | 5/10 [01:42<01:52, 22.42s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0164, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0541, 'compress@10': 0.5706, 'time@10': 32.3865}:  50%|█████     | 5/10 [02:19<01:52, 22.42s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0164, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0541, 'compress@10': 0.5706, 'time@10': 32.3865}:  60%|██████    | 6/10 [02:19<01:49, 27.48s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0537, 'compress@10': 0.5303, 'time@10': 33.4336}:  60%|██████    | 6/10 [02:39<01:49, 27.48s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0537, 'compress@10': 0.5303, 'time@10': 33.4336}:  70%|███████   | 7/10 [02:39<01:15, 25.00s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0166, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0545, 'compress@10': 0.5154, 'time@10': 32.9134}:  70%|███████   | 7/10 [03:09<01:15, 25.00s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0166, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0545, 'compress@10': 0.5154, 'time@10': 32.9134}:  80%|████████  | 8/10 [03:09<00:52, 26.37s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0556, 'compress@10': 0.5589, 'time@10': 34.4015}:  80%|████████  | 8/10 [03:32<00:52, 26.37s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0556, 'compress@10': 0.5589, 'time@10': 34.4015}:  90%|█████████ | 9/10 [03:32<00:25, 25.38s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0572, 'compress@10': 0.5067, 'time@10': 34.5027}:  90%|█████████ | 9/10 [04:07<00:25, 25.38s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0572, 'compress@10': 0.5067, 'time@10': 34.5027}: 100%|██████████| 10/10 [04:07<00:00, 28.49s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0572, 'compress@10': 0.5067, 'time@10': 34.5027}: 100%|██████████| 10/10 [04:07<00:00, 24.78s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.018065040678354898
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.057171465237048
Avg compression ratio: 0.5066902261634012
Avg train time: 34.502749824523924
Std train time: 10.9749274641958
[0.9117647058823529, 0.5, 0.08823529411764705, 0.5, 0.6764705882352942, 0.6764705882352942, 0.2647058823529412, 0.4411764705882353, 0.9117647058823529, 0.02941176470588236]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0435, 'compress@10': 0.913, 'time@10': 30.9477}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0435, 'compress@10': 0.913, 'time@10': 30.9477}:  10%|█         | 1/10 [00:15<02:19, 15.51s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0536, 'compress@10': 0.7086, 'time@10': 28.0336}:  10%|█         | 1/10 [00:40<02:19, 15.51s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0536, 'compress@10': 0.7086, 'time@10': 28.0336}:  20%|██        | 2/10 [00:40<02:49, 21.19s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0452, 'compress@10': 0.5135, 'time@10': 25.7461}:  20%|██        | 2/10 [00:51<02:49, 21.19s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0452, 'compress@10': 0.5135, 'time@10': 25.7461}:  30%|███       | 3/10 [00:51<01:54, 16.36s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0523, 'compress@10': 0.5113, 'time@10': 25.0161}:  30%|███       | 3/10 [01:14<01:54, 16.36s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0523, 'compress@10': 0.5113, 'time@10': 25.0161}:  40%|████      | 4/10 [01:14<01:53, 18.93s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0545, 'compress@10': 0.5447, 'time@10': 31.6317}:  40%|████      | 4/10 [01:43<01:53, 18.93s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0545, 'compress@10': 0.5447, 'time@10': 31.6317}:  50%|█████     | 5/10 [01:43<01:52, 22.59s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0577, 'compress@10': 0.5669, 'time@10': 32.4897}:  50%|█████     | 5/10 [02:20<01:52, 22.59s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0577, 'compress@10': 0.5669, 'time@10': 32.4897}:  60%|██████    | 6/10 [02:20<01:49, 27.44s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0562, 'compress@10': 0.5249, 'time@10': 33.594}:  60%|██████    | 6/10 [02:40<01:49, 27.44s/it] {'epoch': 16, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0562, 'compress@10': 0.5249, 'time@10': 33.594}:  70%|███████   | 7/10 [02:40<01:15, 25.06s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0181, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.06, 'compress@10': 0.5149, 'time@10': 33.0088}:  70%|███████   | 7/10 [03:09<01:15, 25.06s/it]  {'epoch': 16, 'num_users': 6.125, 'loss': 0.0181, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.06, 'compress@10': 0.5149, 'time@10': 33.0088}:  80%|████████  | 8/10 [03:09<00:52, 26.30s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0199, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0616, 'compress@10': 0.5591, 'time@10': 34.4709}:  80%|████████  | 8/10 [03:32<00:52, 26.30s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0199, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0616, 'compress@10': 0.5591, 'time@10': 34.4709}:  90%|█████████ | 9/10 [03:32<00:25, 25.31s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0637, 'compress@10': 0.5067, 'time@10': 34.5203}:  90%|█████████ | 9/10 [04:07<00:25, 25.31s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0637, 'compress@10': 0.5067, 'time@10': 34.5203}: 100%|██████████| 10/10 [04:07<00:00, 28.30s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0637, 'compress@10': 0.5067, 'time@10': 34.5203}: 100%|██████████| 10/10 [04:07<00:00, 24.73s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.01978086786193985
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0636784690381398
Avg compression ratio: 0.506697886898251
Avg train time: 34.52030565738678
Std train time: 10.847665151179912
[0.861111111111111, 0.4722222222222222, 0.08333333333333333, 0.5277777777777778, 0.638888888888889, 0.6944444444444445, 0.25, 0.4722222222222222, 0.9166666666666666, 0.08333333333333334]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0533, 'compress@10': 0.863, 'time@10': 30.4}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0533, 'compress@10': 0.863, 'time@10': 30.4}:  10%|█         | 1/10 [00:15<02:17, 15.24s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0626, 'compress@10': 0.6698, 'time@10': 27.6916}:  10%|█         | 1/10 [00:40<02:17, 15.24s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0626, 'compress@10': 0.6698, 'time@10': 27.6916}:  20%|██        | 2/10 [00:40<02:48, 21.01s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0543, 'compress@10': 0.4861, 'time@10': 25.383}:  20%|██        | 2/10 [00:50<02:48, 21.01s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0543, 'compress@10': 0.4861, 'time@10': 25.383}:  30%|███       | 3/10 [00:50<01:53, 16.17s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0586, 'compress@10': 0.4976, 'time@10': 24.5987}:  30%|███       | 3/10 [01:12<01:53, 16.17s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0586, 'compress@10': 0.4976, 'time@10': 24.5987}:  40%|████      | 4/10 [01:12<01:51, 18.59s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0599, 'compress@10': 0.5263, 'time@10': 31.3378}:  40%|████      | 4/10 [01:42<01:51, 18.59s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0599, 'compress@10': 0.5263, 'time@10': 31.3378}:  50%|█████     | 5/10 [01:42<01:52, 22.41s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0624, 'compress@10': 0.5546, 'time@10': 32.1981}:  50%|█████     | 5/10 [02:18<01:52, 22.41s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0624, 'compress@10': 0.5546, 'time@10': 32.1981}:  60%|██████    | 6/10 [02:18<01:48, 27.22s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0615, 'compress@10': 0.5122, 'time@10': 33.3637}:  60%|██████    | 6/10 [02:38<01:48, 27.22s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0615, 'compress@10': 0.5122, 'time@10': 33.3637}:  70%|███████   | 7/10 [02:38<01:14, 24.93s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0622, 'compress@10': 0.5077, 'time@10': 32.8151}:  70%|███████   | 7/10 [03:07<01:14, 24.93s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0622, 'compress@10': 0.5077, 'time@10': 32.8151}:  80%|████████  | 8/10 [03:07<00:52, 26.23s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0641, 'compress@10': 0.5532, 'time@10': 34.2544}:  80%|████████  | 8/10 [03:30<00:52, 26.23s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0641, 'compress@10': 0.5532, 'time@10': 34.2544}:  90%|█████████ | 9/10 [03:30<00:25, 25.20s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0671, 'compress@10': 0.5068, 'time@10': 34.3432}:  90%|█████████ | 9/10 [04:06<00:25, 25.20s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0671, 'compress@10': 0.5068, 'time@10': 34.3432}: 100%|██████████| 10/10 [04:06<00:00, 28.28s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0671, 'compress@10': 0.5068, 'time@10': 34.3432}: 100%|██████████| 10/10 [04:06<00:00, 24.61s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.018268552997308386
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0670538635961755
Avg compression ratio: 0.5067509966981013
Avg train time: 34.34316425323486
Std train time: 10.992396643581461
[0.8684210526315789, 0.4473684210526316, 0.07894736842105263, 0.5526315789473685, 0.605263157894737, 0.7105263157894738, 0.2368421052631579, 0.4473684210526316, 0.9210526315789473, 0.13157894736842107]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0422, 'compress@10': 0.8702, 'time@10': 29.8186}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0422, 'compress@10': 0.8702, 'time@10': 29.8186}:  10%|█         | 1/10 [00:14<02:14, 14.95s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0529, 'compress@10': 0.6611, 'time@10': 27.3081}:  10%|█         | 1/10 [00:39<02:14, 14.95s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0529, 'compress@10': 0.6611, 'time@10': 27.3081}:  20%|██        | 2/10 [00:39<02:46, 20.76s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0487, 'compress@10': 0.4789, 'time@10': 25.0308}:  20%|██        | 2/10 [00:50<02:46, 20.76s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0487, 'compress@10': 0.4789, 'time@10': 25.0308}:  30%|███       | 3/10 [00:50<01:51, 15.98s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0535, 'compress@10': 0.4984, 'time@10': 24.3169}:  30%|███       | 3/10 [01:12<01:51, 15.98s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0535, 'compress@10': 0.4984, 'time@10': 24.3169}:  40%|████      | 4/10 [01:12<01:50, 18.44s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0559, 'compress@10': 0.5202, 'time@10': 31.0666}:  40%|████      | 4/10 [01:41<01:50, 18.44s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0559, 'compress@10': 0.5202, 'time@10': 31.0666}:  50%|█████     | 5/10 [01:41<01:51, 22.27s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0175, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0587, 'compress@10': 0.5522, 'time@10': 31.8296}:  50%|█████     | 5/10 [02:17<01:51, 22.27s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0175, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0587, 'compress@10': 0.5522, 'time@10': 31.8296}:  60%|██████    | 6/10 [02:17<01:47, 26.83s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0168, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.058, 'compress@10': 0.5083, 'time@10': 33.0116}:  60%|██████    | 6/10 [02:37<01:47, 26.83s/it] {'epoch': 18, 'num_users': 6.2857, 'loss': 0.0168, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.058, 'compress@10': 0.5083, 'time@10': 33.0116}:  70%|███████   | 7/10 [02:37<01:13, 24.63s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0625, 'compress@10': 0.5012, 'time@10': 32.6001}:  70%|███████   | 7/10 [03:06<01:13, 24.63s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0625, 'compress@10': 0.5012, 'time@10': 32.6001}:  80%|████████  | 8/10 [03:06<00:52, 26.26s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0643, 'compress@10': 0.5479, 'time@10': 34.2247}:  80%|████████  | 8/10 [03:30<00:52, 26.26s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0643, 'compress@10': 0.5479, 'time@10': 34.2247}:  90%|█████████ | 9/10 [03:30<00:25, 25.45s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0676, 'compress@10': 0.5068, 'time@10': 34.4092}:  90%|█████████ | 9/10 [04:06<00:25, 25.45s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0676, 'compress@10': 0.5068, 'time@10': 34.4092}: 100%|██████████| 10/10 [04:06<00:00, 28.74s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0676, 'compress@10': 0.5068, 'time@10': 34.4092}: 100%|██████████| 10/10 [04:06<00:00, 24.67s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.01869510940686273
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.067635980061332
Avg compression ratio: 0.5067639699451393
Avg train time: 34.4092380285263
Std train time: 11.134335696149138
[0.8749999999999999, 0.425, 0.075, 0.5750000000000001, 0.5750000000000001, 0.7250000000000001, 0.225, 0.475, 0.9249999999999999, 0.12500000000000003]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0478, 'compress@10': 0.8767, 'time@10': 30.6285}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0478, 'compress@10': 0.8767, 'time@10': 30.6285}:  10%|█         | 1/10 [00:15<02:18, 15.35s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0553, 'compress@10': 0.6533, 'time@10': 28.0285}:  10%|█         | 1/10 [00:40<02:18, 15.35s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0553, 'compress@10': 0.6533, 'time@10': 28.0285}:  20%|██        | 2/10 [00:40<02:50, 21.31s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0504, 'compress@10': 0.4724, 'time@10': 25.6079}:  20%|██        | 2/10 [00:51<02:50, 21.31s/it]  {'epoch': 19, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0504, 'compress@10': 0.4724, 'time@10': 25.6079}:  30%|███       | 3/10 [00:51<01:54, 16.34s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0561, 'compress@10': 0.499, 'time@10': 24.7624}:  30%|███       | 3/10 [01:13<01:54, 16.34s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0561, 'compress@10': 0.499, 'time@10': 24.7624}:  40%|████      | 4/10 [01:13<01:52, 18.68s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0577, 'compress@10': 0.5147, 'time@10': 31.3597}:  40%|████      | 4/10 [01:42<01:52, 18.68s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0577, 'compress@10': 0.5147, 'time@10': 31.3597}:  50%|█████     | 5/10 [01:42<01:51, 22.37s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0604, 'compress@10': 0.55, 'time@10': 32.0745}:  50%|█████     | 5/10 [02:18<01:51, 22.37s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0604, 'compress@10': 0.55, 'time@10': 32.0745}:  60%|██████    | 6/10 [02:18<01:47, 26.90s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0589, 'compress@10': 0.5047, 'time@10': 33.3214}:  60%|██████    | 6/10 [02:38<01:47, 26.90s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0589, 'compress@10': 0.5047, 'time@10': 33.3214}:  70%|███████   | 7/10 [02:38<01:14, 24.78s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0679, 'compress@10': 0.5015, 'time@10': 32.7551}:  70%|███████   | 7/10 [03:07<01:14, 24.78s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0679, 'compress@10': 0.5015, 'time@10': 32.7551}:  80%|████████  | 8/10 [03:07<00:52, 26.07s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0686, 'compress@10': 0.5486, 'time@10': 34.343}:  80%|████████  | 8/10 [03:30<00:52, 26.07s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0686, 'compress@10': 0.5486, 'time@10': 34.343}:  90%|█████████ | 9/10 [03:30<00:25, 25.29s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0715, 'compress@10': 0.5068, 'time@10': 34.4825}:  90%|█████████ | 9/10 [04:06<00:25, 25.29s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0715, 'compress@10': 0.5068, 'time@10': 34.4825}: 100%|██████████| 10/10 [04:06<00:00, 28.53s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0715, 'compress@10': 0.5068, 'time@10': 34.4825}: 100%|██████████| 10/10 [04:06<00:00, 24.67s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.016436770562278935
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0714665783546888
Avg compression ratio: 0.5067676116627855
Avg train time: 34.48254022598267
Std train time: 10.998220585522864
[0.8333333333333333, 0.40476190476190477, 0.07142857142857142, 0.5952380952380953, 0.5476190476190477, 0.7380952380952381, 0.2619047619047619, 0.5, 0.9285714285714285, 0.11904761904761907]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0485, 'compress@10': 0.8356, 'time@10': 30.4939}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0485, 'compress@10': 0.8356, 'time@10': 30.4939}:  10%|█         | 1/10 [00:15<02:17, 15.28s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0527, 'compress@10': 0.6227, 'time@10': 28.0381}:  10%|█         | 1/10 [00:40<02:17, 15.28s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0527, 'compress@10': 0.6227, 'time@10': 28.0381}:  20%|██        | 2/10 [00:40<02:51, 21.38s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.051, 'compress@10': 0.4508, 'time@10': 25.6062}:  20%|██        | 2/10 [00:51<02:51, 21.38s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.051, 'compress@10': 0.4508, 'time@10': 25.6062}:  30%|███       | 3/10 [00:51<01:54, 16.37s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0546, 'compress@10': 0.4879, 'time@10': 24.7277}:  30%|███       | 3/10 [01:13<01:54, 16.37s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0546, 'compress@10': 0.4879, 'time@10': 24.7277}:  40%|████      | 4/10 [01:13<01:51, 18.65s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0567, 'compress@10': 0.5003, 'time@10': 31.3587}:  40%|████      | 4/10 [01:42<01:51, 18.65s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0567, 'compress@10': 0.5003, 'time@10': 31.3587}:  50%|█████     | 5/10 [01:42<01:51, 22.37s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0599, 'compress@10': 0.5402, 'time@10': 32.0821}:  50%|█████     | 5/10 [02:18<01:51, 22.37s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0599, 'compress@10': 0.5402, 'time@10': 32.0821}:  60%|██████    | 6/10 [02:18<01:47, 26.92s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0595, 'compress@10': 0.5016, 'time@10': 33.1799}:  60%|██████    | 6/10 [02:38<01:47, 26.92s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0595, 'compress@10': 0.5016, 'time@10': 33.1799}:  70%|███████   | 7/10 [02:38<01:13, 24.63s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0686, 'compress@10': 0.5018, 'time@10': 32.6688}:  70%|███████   | 7/10 [03:07<01:13, 24.63s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0686, 'compress@10': 0.5018, 'time@10': 32.6688}:  80%|████████  | 8/10 [03:07<00:52, 26.06s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0194, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0686, 'compress@10': 0.5493, 'time@10': 34.3329}:  80%|████████  | 8/10 [03:31<00:52, 26.06s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0194, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0686, 'compress@10': 0.5493, 'time@10': 34.3329}:  90%|█████████ | 9/10 [03:31<00:25, 25.37s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0697, 'compress@10': 0.5068, 'time@10': 34.4992}:  90%|█████████ | 9/10 [04:07<00:25, 25.37s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0697, 'compress@10': 0.5068, 'time@10': 34.4992}: 100%|██████████| 10/10 [04:07<00:00, 28.67s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0697, 'compress@10': 0.5068, 'time@10': 34.4992}: 100%|██████████| 10/10 [04:07<00:00, 24.71s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.018893332113827425
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0696664227098265
Avg compression ratio: 0.5067861789409946
Avg train time: 34.499158358573915
Std train time: 11.041027977646998
[0.8409090909090908, 0.38636363636363635, 0.06818181818181818, 0.6136363636363638, 0.5227272727272728, 0.75, 0.25, 0.5227272727272727, 0.9318181818181818, 0.11363636363636366]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0535, 'compress@10': 0.8431, 'time@10': 30.4534}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0535, 'compress@10': 0.8431, 'time@10': 30.4534}:  10%|█         | 1/10 [00:15<02:17, 15.33s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0529, 'compress@10': 0.6173, 'time@10': 27.9973}:  10%|█         | 1/10 [00:40<02:17, 15.33s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0529, 'compress@10': 0.6173, 'time@10': 27.9973}:  20%|██        | 2/10 [00:40<02:50, 21.36s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0501, 'compress@10': 0.4462, 'time@10': 25.5213}:  20%|██        | 2/10 [00:51<02:50, 21.36s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0501, 'compress@10': 0.4462, 'time@10': 25.5213}:  30%|███       | 3/10 [00:51<01:54, 16.32s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.05, 'compress@10': 0.489, 'time@10': 24.5918}:  30%|███       | 3/10 [01:13<01:54, 16.32s/it]   {'epoch': 21, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.05, 'compress@10': 0.489, 'time@10': 24.5918}:  40%|████      | 4/10 [01:13<01:51, 18.50s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.012, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0529, 'compress@10': 0.4962, 'time@10': 31.1705}:  40%|████      | 4/10 [01:41<01:51, 18.50s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.012, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0529, 'compress@10': 0.4962, 'time@10': 31.1705}:  50%|█████     | 5/10 [01:41<01:51, 22.21s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0134, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0555, 'compress@10': 0.5388, 'time@10': 31.9069}:  50%|█████     | 5/10 [02:17<01:51, 22.21s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0134, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0555, 'compress@10': 0.5388, 'time@10': 31.9069}:  60%|██████    | 6/10 [02:17<01:47, 26.77s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0556, 'compress@10': 0.4986, 'time@10': 33.1176}:  60%|██████    | 6/10 [02:37<01:47, 26.77s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0556, 'compress@10': 0.4986, 'time@10': 33.1176}:  70%|███████   | 7/10 [02:37<01:13, 24.63s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.063, 'compress@10': 0.5021, 'time@10': 32.6155}:  70%|███████   | 7/10 [03:06<01:13, 24.63s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.063, 'compress@10': 0.5021, 'time@10': 32.6155}:  80%|████████  | 8/10 [03:06<00:52, 26.07s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0654, 'compress@10': 0.5499, 'time@10': 34.3125}:  80%|████████  | 8/10 [03:30<00:52, 26.07s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0654, 'compress@10': 0.5499, 'time@10': 34.3125}:  90%|█████████ | 9/10 [03:30<00:25, 25.42s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0679, 'compress@10': 0.5068, 'time@10': 34.4437}:  90%|█████████ | 9/10 [04:06<00:25, 25.42s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0679, 'compress@10': 0.5068, 'time@10': 34.4437}: 100%|██████████| 10/10 [04:06<00:00, 28.58s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0679, 'compress@10': 0.5068, 'time@10': 34.4437}: 100%|██████████| 10/10 [04:06<00:00, 24.65s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.014960561031696077
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0678881475555249
Avg compression ratio: 0.5067883733364704
Avg train time: 34.44369103908539
Std train time: 11.070814392245902
[0.8043478260869564, 0.41304347826086957, 0.06521739130434782, 0.6304347826086958, 0.5000000000000001, 0.7608695652173914, 0.2391304347826087, 0.5434782608695652, 0.9347826086956521, 0.10869565217391307]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0256, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0557, 'compress@10': 0.8071, 'time@10': 29.6379}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0256, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0557, 'compress@10': 0.8071, 'time@10': 29.6379}:  10%|█         | 1/10 [00:14<02:13, 14.86s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0548, 'compress@10': 0.6125, 'time@10': 27.7739}:  10%|█         | 1/10 [00:40<02:13, 14.86s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0548, 'compress@10': 0.6125, 'time@10': 27.7739}:  20%|██        | 2/10 [00:40<02:51, 21.38s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0512, 'compress@10': 0.4421, 'time@10': 25.3446}:  20%|██        | 2/10 [00:51<02:51, 21.38s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0512, 'compress@10': 0.4421, 'time@10': 25.3446}:  30%|███       | 3/10 [00:51<01:54, 16.31s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.049, 'compress@10': 0.49, 'time@10': 24.4473}:  30%|███       | 3/10 [01:12<01:54, 16.31s/it]   {'epoch': 22, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.049, 'compress@10': 0.49, 'time@10': 24.4473}:  40%|████      | 4/10 [01:12<01:50, 18.48s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0515, 'compress@10': 0.4925, 'time@10': 31.1178}:  40%|████      | 4/10 [01:41<01:50, 18.48s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0515, 'compress@10': 0.4925, 'time@10': 31.1178}:  50%|█████     | 5/10 [01:41<01:51, 22.25s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0154, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0538, 'compress@10': 0.5375, 'time@10': 31.7571}:  50%|█████     | 5/10 [02:16<01:51, 22.25s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0154, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0538, 'compress@10': 0.5375, 'time@10': 31.7571}:  60%|██████    | 6/10 [02:16<01:46, 26.58s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0555, 'compress@10': 0.496, 'time@10': 32.944}:  60%|██████    | 6/10 [02:36<01:46, 26.58s/it]  {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0555, 'compress@10': 0.496, 'time@10': 32.944}:  70%|███████   | 7/10 [02:36<01:13, 24.45s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0623, 'compress@10': 0.5024, 'time@10': 32.4411}:  70%|███████   | 7/10 [03:05<01:13, 24.45s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0623, 'compress@10': 0.5024, 'time@10': 32.4411}:  80%|████████  | 8/10 [03:05<00:51, 25.89s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0165, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0645, 'compress@10': 0.5505, 'time@10': 34.1501}:  80%|████████  | 8/10 [03:29<00:51, 25.89s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0165, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0645, 'compress@10': 0.5505, 'time@10': 34.1501}:  90%|█████████ | 9/10 [03:29<00:25, 25.28s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0671, 'compress@10': 0.5068, 'time@10': 34.3832}:  90%|█████████ | 9/10 [04:06<00:25, 25.28s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0671, 'compress@10': 0.5068, 'time@10': 34.3832}: 100%|██████████| 10/10 [04:06<00:00, 28.75s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0671, 'compress@10': 0.5068, 'time@10': 34.3832}: 100%|██████████| 10/10 [04:06<00:00, 24.63s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.0165786682453734
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.067084880958459
Avg compression ratio: 0.5068158739137895
Avg train time: 34.3832471370697
Std train time: 11.147690644905213
[0.8124999999999999, 0.3958333333333333, 0.0625, 0.6458333333333335, 0.4791666666666668, 0.7708333333333334, 0.22916666666666669, 0.5208333333333333, 0.9374999999999999, 0.14583333333333337]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0607, 'compress@10': 0.8151, 'time@10': 30.2704}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0607, 'compress@10': 0.8151, 'time@10': 30.2704}:  10%|█         | 1/10 [00:15<02:16, 15.19s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0575, 'compress@10': 0.608, 'time@10': 28.236}:  10%|█         | 1/10 [00:41<02:16, 15.19s/it]   {'epoch': 23, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0575, 'compress@10': 0.608, 'time@10': 28.236}:  20%|██        | 2/10 [00:41<02:53, 21.69s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0526, 'compress@10': 0.4382, 'time@10': 25.5749}:  20%|██        | 2/10 [00:51<02:53, 21.69s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0526, 'compress@10': 0.4382, 'time@10': 25.5749}:  30%|███       | 3/10 [00:51<01:54, 16.43s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0537, 'compress@10': 0.4909, 'time@10': 24.6921}:  30%|███       | 3/10 [01:13<01:54, 16.43s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0537, 'compress@10': 0.4909, 'time@10': 24.6921}:  40%|████      | 4/10 [01:13<01:51, 18.66s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0555, 'compress@10': 0.4891, 'time@10': 31.3856}:  40%|████      | 4/10 [01:42<01:51, 18.66s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0555, 'compress@10': 0.4891, 'time@10': 31.3856}:  50%|█████     | 5/10 [01:42<01:52, 22.43s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0578, 'compress@10': 0.5363, 'time@10': 31.9076}:  50%|█████     | 5/10 [02:17<01:52, 22.43s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0578, 'compress@10': 0.5363, 'time@10': 31.9076}:  60%|██████    | 6/10 [02:17<01:46, 26.55s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0579, 'compress@10': 0.4936, 'time@10': 33.0497}:  60%|██████    | 6/10 [02:37<01:46, 26.55s/it] {'epoch': 23, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0579, 'compress@10': 0.4936, 'time@10': 33.0497}:  70%|███████   | 7/10 [02:37<01:13, 24.41s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0655, 'compress@10': 0.4974, 'time@10': 32.512}:  70%|███████   | 7/10 [03:06<01:13, 24.41s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0655, 'compress@10': 0.4974, 'time@10': 32.512}:  80%|████████  | 8/10 [03:06<00:51, 25.80s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0687, 'compress@10': 0.5464, 'time@10': 34.3416}:  80%|████████  | 8/10 [03:30<00:51, 25.80s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0687, 'compress@10': 0.5464, 'time@10': 34.3416}:  90%|█████████ | 9/10 [03:30<00:25, 25.40s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0705, 'compress@10': 0.5068, 'time@10': 34.5165}:  90%|█████████ | 9/10 [04:06<00:25, 25.40s/it]  {'epoch': 23, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0705, 'compress@10': 0.5068, 'time@10': 34.5165}: 100%|██████████| 10/10 [04:06<00:00, 28.71s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0705, 'compress@10': 0.5068, 'time@10': 34.5165}: 100%|██████████| 10/10 [04:06<00:00, 24.68s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.015290589477282937
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.070476891807818
Avg compression ratio: 0.5068240731162482
Avg train time: 34.516513752937314
Std train time: 11.309592021444189
[0.7799999999999999, 0.38, 0.06, 0.6600000000000001, 0.46000000000000013, 0.78, 0.22000000000000003, 0.5399999999999999, 0.94, 0.18000000000000005]
[10, 10, 21, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0557, 'compress@10': 0.783, 'time@10': 29.4902}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0557, 'compress@10': 0.783, 'time@10': 29.4902}:  10%|█         | 1/10 [00:14<02:13, 14.78s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0563, 'compress@10': 0.5841, 'time@10': 27.5294}:  10%|█         | 1/10 [00:40<02:13, 14.78s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0563, 'compress@10': 0.5841, 'time@10': 27.5294}:  20%|██        | 2/10 [00:40<02:49, 21.15s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0531, 'compress@10': 0.4215, 'time@10': 25.8343}:  20%|██        | 2/10 [00:51<02:49, 21.15s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0531, 'compress@10': 0.4215, 'time@10': 25.8343}:  30%|███       | 3/10 [00:51<01:56, 16.63s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0537, 'compress@10': 0.4819, 'time@10': 24.9146}:  30%|███       | 3/10 [01:13<01:56, 16.63s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0537, 'compress@10': 0.4819, 'time@10': 24.9146}:  40%|████      | 4/10 [01:13<01:52, 18.83s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0566, 'compress@10': 0.4781, 'time@10': 31.5616}:  40%|████      | 4/10 [01:42<01:52, 18.83s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0566, 'compress@10': 0.4781, 'time@10': 31.5616}:  50%|█████     | 5/10 [01:42<01:52, 22.54s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0583, 'compress@10': 0.5286, 'time@10': 32.1366}:  50%|█████     | 5/10 [02:18<01:52, 22.54s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0583, 'compress@10': 0.5286, 'time@10': 32.1366}:  60%|██████    | 6/10 [02:18<01:47, 26.79s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0592, 'compress@10': 0.4857, 'time@10': 33.2279}:  60%|██████    | 6/10 [02:37<01:47, 26.79s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0592, 'compress@10': 0.4857, 'time@10': 33.2279}:  70%|███████   | 7/10 [02:37<01:13, 24.55s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0145, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0665, 'compress@10': 0.4929, 'time@10': 32.7018}:  70%|███████   | 7/10 [03:06<01:13, 24.55s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0145, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0665, 'compress@10': 0.4929, 'time@10': 32.7018}:  80%|████████  | 8/10 [03:06<00:51, 25.98s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0674, 'compress@10': 0.5426, 'time@10': 34.3269}:  80%|████████  | 8/10 [03:30<00:51, 25.98s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0674, 'compress@10': 0.5426, 'time@10': 34.3269}:  90%|█████████ | 9/10 [03:30<00:25, 25.27s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.072, 'compress@10': 0.5069, 'time@10': 34.4778}:  90%|█████████ | 9/10 [04:06<00:25, 25.27s/it]    {'epoch': 24, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.072, 'compress@10': 0.5069, 'time@10': 34.4778}: 100%|██████████| 10/10 [04:06<00:00, 28.55s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.072, 'compress@10': 0.5069, 'time@10': 34.4778}: 100%|██████████| 10/10 [04:06<00:00, 24.66s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.01584914475743477
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0719847328565144
Avg compression ratio: 0.5068554512198719
Avg train time: 34.47782385349274
Std train time: 10.891951492110767
[0.7884615384615383, 0.40384615384615385, 0.05769230769230769, 0.6730769230769232, 0.44230769230769246, 0.7884615384615384, 0.21153846153846156, 0.5192307692307692, 0.9423076923076923, 0.17307692307692313]
[10, 10, 21, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0634, 'compress@10': 0.7914, 'time@10': 29.3083}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0634, 'compress@10': 0.7914, 'time@10': 29.3083}:  10%|█         | 1/10 [00:14<02:12, 14.69s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0584, 'compress@10': 0.6001, 'time@10': 27.2877}:  10%|█         | 1/10 [00:39<02:12, 14.69s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0584, 'compress@10': 0.6001, 'time@10': 27.2877}:  20%|██        | 2/10 [00:39<02:47, 20.93s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0545, 'compress@10': 0.4314, 'time@10': 25.4943}:  20%|██        | 2/10 [00:50<02:47, 20.93s/it]  {'epoch': 25, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0545, 'compress@10': 0.4314, 'time@10': 25.4943}:  30%|███       | 3/10 [00:50<01:54, 16.39s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0561, 'compress@10': 0.4926, 'time@10': 24.657}:  30%|███       | 3/10 [01:13<01:54, 16.39s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0561, 'compress@10': 0.4926, 'time@10': 24.657}:  40%|████      | 4/10 [01:13<01:52, 18.68s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0587, 'compress@10': 0.4831, 'time@10': 31.6802}:  40%|████      | 4/10 [01:43<01:52, 18.68s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0587, 'compress@10': 0.4831, 'time@10': 31.6802}:  50%|█████     | 5/10 [01:43<01:53, 22.73s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0616, 'compress@10': 0.5342, 'time@10': 32.4479}:  50%|█████     | 5/10 [02:19<01:53, 22.73s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0616, 'compress@10': 0.5342, 'time@10': 32.4479}:  60%|██████    | 6/10 [02:19<01:49, 27.36s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0627, 'compress@10': 0.4893, 'time@10': 33.7083}:  60%|██████    | 6/10 [02:40<01:49, 27.36s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0627, 'compress@10': 0.4893, 'time@10': 33.7083}:  70%|███████   | 7/10 [02:40<01:15, 25.17s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0693, 'compress@10': 0.4935, 'time@10': 33.2646}:  70%|███████   | 7/10 [03:10<01:15, 25.17s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0693, 'compress@10': 0.4935, 'time@10': 33.2646}:  80%|████████  | 8/10 [03:10<00:53, 26.78s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0695, 'compress@10': 0.5434, 'time@10': 34.8762}:  80%|████████  | 8/10 [03:34<00:53, 26.78s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0695, 'compress@10': 0.5434, 'time@10': 34.8762}:  90%|█████████ | 9/10 [03:34<00:25, 25.88s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0714, 'compress@10': 0.5069, 'time@10': 34.8622}:  90%|█████████ | 9/10 [04:09<00:25, 25.88s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0714, 'compress@10': 0.5069, 'time@10': 34.8622}: 100%|██████████| 10/10 [04:09<00:00, 28.63s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0714, 'compress@10': 0.5069, 'time@10': 34.8622}: 100%|██████████| 10/10 [04:09<00:00, 24.90s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.014643883567596442
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0713900350675818
Avg compression ratio: 0.5068508228312795
Avg train time: 34.86219968795776
Std train time: 11.422856026708574
[0.7592592592592591, 0.42592592592592593, 0.05555555555555555, 0.6851851851851853, 0.42592592592592604, 0.7962962962962963, 0.20370370370370372, 0.49999999999999994, 0.9444444444444444, 0.20370370370370375]
[10, 10, 21, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0586, 'compress@10': 0.7626, 'time@10': 27.2706}:   0%|          | 0/10 [00:13<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0586, 'compress@10': 0.7626, 'time@10': 27.2706}:  10%|█         | 1/10 [00:13<02:03, 13.67s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.065, 'compress@10': 0.5967, 'time@10': 25.4846}:  10%|█         | 1/10 [00:37<02:03, 13.67s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.065, 'compress@10': 0.5967, 'time@10': 25.4846}:  20%|██        | 2/10 [00:37<02:36, 19.59s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0591, 'compress@10': 0.4284, 'time@10': 23.9261}:  20%|██        | 2/10 [00:47<02:36, 19.59s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0591, 'compress@10': 0.4284, 'time@10': 23.9261}:  30%|███       | 3/10 [00:47<01:47, 15.41s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0591, 'compress@10': 0.4933, 'time@10': 22.9915}:  30%|███       | 3/10 [01:08<01:47, 15.41s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0591, 'compress@10': 0.4933, 'time@10': 22.9915}:  40%|████      | 4/10 [01:08<01:43, 17.31s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0614, 'compress@10': 0.4805, 'time@10': 29.2201}:  40%|████      | 4/10 [01:35<01:43, 17.31s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0614, 'compress@10': 0.4805, 'time@10': 29.2201}:  50%|█████     | 5/10 [01:35<01:44, 20.84s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.063, 'compress@10': 0.5333, 'time@10': 29.6715}:  50%|█████     | 5/10 [02:07<01:44, 20.84s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.063, 'compress@10': 0.5333, 'time@10': 29.6715}:  60%|██████    | 6/10 [02:07<01:38, 24.63s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.064, 'compress@10': 0.4874, 'time@10': 30.8083}:  60%|██████    | 6/10 [02:25<01:38, 24.63s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.064, 'compress@10': 0.4874, 'time@10': 30.8083}:  70%|███████   | 7/10 [02:25<01:08, 22.74s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0708, 'compress@10': 0.4894, 'time@10': 30.3515}:  70%|███████   | 7/10 [02:53<01:08, 22.74s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0708, 'compress@10': 0.4894, 'time@10': 30.3515}:  80%|████████  | 8/10 [02:53<00:48, 24.16s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0716, 'compress@10': 0.54, 'time@10': 31.9155}:  80%|████████  | 8/10 [03:15<00:48, 24.16s/it] {'epoch': 26, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0716, 'compress@10': 0.54, 'time@10': 31.9155}:  90%|█████████ | 9/10 [03:15<00:23, 23.56s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0738, 'compress@10': 0.5069, 'time@10': 32.1278}:  90%|█████████ | 9/10 [03:49<00:23, 23.56s/it] {'epoch': 26, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0738, 'compress@10': 0.5069, 'time@10': 32.1278}: 100%|██████████| 10/10 [03:49<00:00, 26.81s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0738, 'compress@10': 0.5069, 'time@10': 32.1278}: 100%|██████████| 10/10 [03:49<00:00, 22.95s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.014695419750283479
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0738286551995777
Avg compression ratio: 0.5068777926099037
Avg train time: 32.1278315782547
Std train time: 10.293664954675572
[0.7678571428571427, 0.4107142857142857, 0.05357142857142857, 0.6964285714285716, 0.4107142857142858, 0.8035714285714286, 0.19642857142857145, 0.4821428571428571, 0.9464285714285714, 0.23214285714285718]
[10, 10, 21, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0593, 'compress@10': 0.7711, 'time@10': 27.2261}:   0%|          | 0/10 [00:13<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0593, 'compress@10': 0.7711, 'time@10': 27.2261}:  10%|█         | 1/10 [00:13<02:02, 13.65s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0518, 'compress@10': 0.5933, 'time@10': 25.5311}:  10%|█         | 1/10 [00:37<02:02, 13.65s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0518, 'compress@10': 0.5933, 'time@10': 25.5311}:  20%|██        | 2/10 [00:37<02:37, 19.66s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0503, 'compress@10': 0.4256, 'time@10': 23.5374}:  20%|██        | 2/10 [00:47<02:37, 19.66s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0503, 'compress@10': 0.4256, 'time@10': 23.5374}:  30%|███       | 3/10 [00:47<01:46, 15.16s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0567, 'compress@10': 0.494, 'time@10': 23.2703}:  30%|███       | 3/10 [01:09<01:46, 15.16s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0567, 'compress@10': 0.494, 'time@10': 23.2703}:  40%|████      | 4/10 [01:09<01:48, 18.06s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0594, 'compress@10': 0.4779, 'time@10': 29.4517}:  40%|████      | 4/10 [01:36<01:48, 18.06s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0594, 'compress@10': 0.4779, 'time@10': 29.4517}:  50%|█████     | 5/10 [01:36<01:46, 21.33s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0616, 'compress@10': 0.5324, 'time@10': 29.889}:  50%|█████     | 5/10 [02:09<01:46, 21.33s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0616, 'compress@10': 0.5324, 'time@10': 29.889}:  60%|██████    | 6/10 [02:09<01:39, 25.00s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0634, 'compress@10': 0.4856, 'time@10': 30.9629}:  60%|██████    | 6/10 [02:27<01:39, 25.00s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0634, 'compress@10': 0.4856, 'time@10': 30.9629}:  70%|███████   | 7/10 [02:27<01:08, 22.95s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0707, 'compress@10': 0.4857, 'time@10': 30.4831}:  70%|███████   | 7/10 [02:54<01:08, 22.95s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0707, 'compress@10': 0.4857, 'time@10': 30.4831}:  80%|████████  | 8/10 [02:54<00:48, 24.29s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0716, 'compress@10': 0.5369, 'time@10': 31.949}:  80%|████████  | 8/10 [03:16<00:48, 24.29s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0716, 'compress@10': 0.5369, 'time@10': 31.949}:  90%|█████████ | 9/10 [03:16<00:23, 23.54s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0716, 'compress@10': 0.5069, 'time@10': 32.1249}:  90%|█████████ | 9/10 [03:50<00:23, 23.54s/it]  {'epoch': 27, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0716, 'compress@10': 0.5069, 'time@10': 32.1249}: 100%|██████████| 10/10 [03:50<00:00, 26.69s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0716, 'compress@10': 0.5069, 'time@10': 32.1249}: 100%|██████████| 10/10 [03:50<00:00, 23.06s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.011824699865781054
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0715974216693864
Avg compression ratio: 0.5068807310976973
Avg train time: 32.124894404411314
Std train time: 10.095690581679767
[0.7413793103448274, 0.43103448275862066, 0.05172413793103448, 0.7068965517241381, 0.3965517241379311, 0.810344827586207, 0.18965517241379312, 0.4655172413793103, 0.9482758620689655, 0.25862068965517243]
[10, 10, 22, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.065, 'compress@10': 0.745, 'time@10': 28.029}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.065, 'compress@10': 0.745, 'time@10': 28.029}:  10%|█         | 1/10 [00:14<02:06, 14.05s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0615, 'compress@10': 0.5904, 'time@10': 25.9716}:  10%|█         | 1/10 [00:37<02:06, 14.05s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0615, 'compress@10': 0.5904, 'time@10': 25.9716}:  20%|██        | 2/10 [00:37<02:38, 19.87s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.056, 'compress@10': 0.423, 'time@10': 24.4269}:  20%|██        | 2/10 [00:48<02:38, 19.87s/it]  {'epoch': 28, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.056, 'compress@10': 0.423, 'time@10': 24.4269}:  30%|███       | 3/10 [00:48<01:49, 15.69s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0671, 'compress@10': 0.4947, 'time@10': 23.9009}:  30%|███       | 3/10 [01:11<01:49, 15.69s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0671, 'compress@10': 0.4947, 'time@10': 23.9009}:  40%|████      | 4/10 [01:11<01:49, 18.32s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.068, 'compress@10': 0.4757, 'time@10': 30.0955}:  40%|████      | 4/10 [01:38<01:49, 18.32s/it] {'epoch': 28, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.068, 'compress@10': 0.4757, 'time@10': 30.0955}:  50%|█████     | 5/10 [01:38<01:48, 21.62s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0126, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0687, 'compress@10': 0.5316, 'time@10': 30.5231}:  50%|█████     | 5/10 [02:11<01:48, 21.62s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0126, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0687, 'compress@10': 0.5316, 'time@10': 30.5231}:  60%|██████    | 6/10 [02:11<01:41, 25.39s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0124, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0688, 'compress@10': 0.484, 'time@10': 31.5673}:  60%|██████    | 6/10 [02:30<01:41, 25.39s/it] {'epoch': 28, 'num_users': 6.2857, 'loss': 0.0124, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0688, 'compress@10': 0.484, 'time@10': 31.5673}:  70%|███████   | 7/10 [02:30<01:09, 23.28s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.075, 'compress@10': 0.4822, 'time@10': 30.9774}:  70%|███████   | 7/10 [02:57<01:09, 23.28s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.075, 'compress@10': 0.4822, 'time@10': 30.9774}:  80%|████████  | 8/10 [02:57<00:48, 24.43s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0733, 'compress@10': 0.534, 'time@10': 32.3695}:  80%|████████  | 8/10 [03:18<00:48, 24.43s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0733, 'compress@10': 0.534, 'time@10': 32.3695}:  90%|█████████ | 9/10 [03:18<00:23, 23.61s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.074, 'compress@10': 0.5069, 'time@10': 32.4977}:  90%|█████████ | 9/10 [03:52<00:23, 23.61s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.074, 'compress@10': 0.5069, 'time@10': 32.4977}: 100%|██████████| 10/10 [03:52<00:00, 26.72s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.074, 'compress@10': 0.5069, 'time@10': 32.4977}: 100%|██████████| 10/10 [03:52<00:00, 23.26s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.013720128059315315
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0739562539307625
Avg compression ratio: 0.5069045927690531
Avg train time: 32.49771919250488
Std train time: 10.026635339922876
[0.7499999999999998, 0.44999999999999996, 0.05, 0.6833333333333336, 0.3833333333333334, 0.8166666666666668, 0.18333333333333335, 0.44999999999999996, 0.95, 0.2833333333333333]
[10, 10, 22, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0061, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0616, 'compress@10': 0.7535, 'time@10': 28.701}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0061, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0616, 'compress@10': 0.7535, 'time@10': 28.701}:  10%|█         | 1/10 [00:14<02:09, 14.39s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0609, 'compress@10': 0.604, 'time@10': 26.399}:  10%|█         | 1/10 [00:38<02:09, 14.39s/it] {'epoch': 29, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0609, 'compress@10': 0.604, 'time@10': 26.399}:  20%|██        | 2/10 [00:38<02:40, 20.12s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0553, 'compress@10': 0.4315, 'time@10': 24.3001}:  20%|██        | 2/10 [00:48<02:40, 20.12s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0553, 'compress@10': 0.4315, 'time@10': 24.3001}:  30%|███       | 3/10 [00:48<01:48, 15.54s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0663, 'compress@10': 0.4952, 'time@10': 23.8586}:  30%|███       | 3/10 [01:11<01:48, 15.54s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0663, 'compress@10': 0.4952, 'time@10': 23.8586}:  40%|████      | 4/10 [01:11<01:49, 18.32s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0683, 'compress@10': 0.4735, 'time@10': 30.1667}:  40%|████      | 4/10 [01:38<01:49, 18.32s/it]  {'epoch': 29, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0683, 'compress@10': 0.4735, 'time@10': 30.1667}:  50%|█████     | 5/10 [01:38<01:48, 21.71s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0693, 'compress@10': 0.5309, 'time@10': 30.4337}:  50%|█████     | 5/10 [02:10<01:48, 21.71s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0693, 'compress@10': 0.5309, 'time@10': 30.4337}:  60%|██████    | 6/10 [02:10<01:40, 25.14s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.07, 'compress@10': 0.4825, 'time@10': 31.407}:  60%|██████    | 6/10 [02:29<01:40, 25.14s/it]   {'epoch': 29, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.07, 'compress@10': 0.4825, 'time@10': 31.407}:  70%|███████   | 7/10 [02:29<01:09, 23.02s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0769, 'compress@10': 0.4789, 'time@10': 30.9198}:  70%|███████   | 7/10 [02:56<01:09, 23.02s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0769, 'compress@10': 0.4789, 'time@10': 30.9198}:  80%|████████  | 8/10 [02:56<00:48, 24.46s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0746, 'compress@10': 0.5313, 'time@10': 32.1981}:  80%|████████  | 8/10 [03:18<00:48, 24.46s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0746, 'compress@10': 0.5313, 'time@10': 32.1981}:  90%|█████████ | 9/10 [03:18<00:23, 23.46s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0745, 'compress@10': 0.5069, 'time@10': 32.3555}:  90%|█████████ | 9/10 [03:52<00:23, 23.46s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0745, 'compress@10': 0.5069, 'time@10': 32.3555}: 100%|██████████| 10/10 [03:52<00:00, 26.66s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0745, 'compress@10': 0.5069, 'time@10': 32.3555}: 100%|██████████| 10/10 [03:52<00:00, 23.20s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.011774607059303561
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.074521181735923
Avg compression ratio: 0.5069114726201187
Avg train time: 32.35545172691345
Std train time: 10.051468269382104
[0.725806451612903, 0.46774193548387094, 0.048387096774193554, 0.6935483870967745, 0.37096774193548393, 0.8225806451612904, 0.20967741935483872, 0.4354838709677419, 0.9193548387096774, 0.3064516129032258]
[10, 10, 23, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0684, 'compress@10': 0.7296, 'time@10': 28.3975}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0684, 'compress@10': 0.7296, 'time@10': 28.3975}:  10%|█         | 1/10 [00:14<02:08, 14.24s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0628, 'compress@10': 0.6009, 'time@10': 26.2283}:  10%|█         | 1/10 [00:38<02:08, 14.24s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0628, 'compress@10': 0.6009, 'time@10': 26.2283}:  20%|██        | 2/10 [00:38<02:40, 20.04s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0562, 'compress@10': 0.4289, 'time@10': 24.6146}:  20%|██        | 2/10 [00:49<02:40, 20.04s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0562, 'compress@10': 0.4289, 'time@10': 24.6146}:  30%|███       | 3/10 [00:49<01:50, 15.79s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0719, 'compress@10': 0.4958, 'time@10': 24.0567}:  30%|███       | 3/10 [01:11<01:50, 15.79s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0719, 'compress@10': 0.4958, 'time@10': 24.0567}:  40%|████      | 4/10 [01:11<01:50, 18.41s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.072, 'compress@10': 0.4715, 'time@10': 30.3364}:  40%|████      | 4/10 [01:39<01:50, 18.41s/it] {'epoch': 30, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.072, 'compress@10': 0.4715, 'time@10': 30.3364}:  50%|█████     | 5/10 [01:39<01:48, 21.78s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0721, 'compress@10': 0.5302, 'time@10': 30.6267}:  50%|█████     | 5/10 [02:11<01:48, 21.78s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0721, 'compress@10': 0.5302, 'time@10': 30.6267}:  60%|██████    | 6/10 [02:11<01:41, 25.30s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0715, 'compress@10': 0.4856, 'time@10': 31.5774}:  60%|██████    | 6/10 [02:30<01:41, 25.30s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0715, 'compress@10': 0.4856, 'time@10': 31.5774}:  70%|███████   | 7/10 [02:30<01:09, 23.13s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0772, 'compress@10': 0.4798, 'time@10': 31.0493}:  70%|███████   | 7/10 [02:57<01:09, 23.13s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0772, 'compress@10': 0.4798, 'time@10': 31.0493}:  80%|████████  | 8/10 [02:57<00:48, 24.49s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0782, 'compress@10': 0.5287, 'time@10': 32.4409}:  80%|████████  | 8/10 [03:19<00:48, 24.49s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0782, 'compress@10': 0.5287, 'time@10': 32.4409}:  90%|█████████ | 9/10 [03:19<00:23, 23.65s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0757, 'compress@10': 0.5069, 'time@10': 32.6642}:  90%|█████████ | 9/10 [03:53<00:23, 23.65s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0757, 'compress@10': 0.5069, 'time@10': 32.6642}: 100%|██████████| 10/10 [03:53<00:00, 27.07s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0757, 'compress@10': 0.5069, 'time@10': 32.6642}: 100%|██████████| 10/10 [03:53<00:00, 23.40s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.013170019439138378
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0757300593333223
Avg compression ratio: 0.5069218978666131
Avg train time: 32.66424362659454
Std train time: 10.087150228733579
[0.7343749999999998, 0.453125, 0.04687500000000001, 0.7031250000000002, 0.35937500000000006, 0.828125, 0.203125, 0.42187499999999994, 0.921875, 0.328125]
[10, 10, 23, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0627, 'compress@10': 0.7381, 'time@10': 28.3665}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0627, 'compress@10': 0.7381, 'time@10': 28.3665}:  10%|█         | 1/10 [00:14<02:07, 14.22s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0736, 'compress@10': 0.5979, 'time@10': 26.4659}:  10%|█         | 1/10 [00:38<02:07, 14.22s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0736, 'compress@10': 0.5979, 'time@10': 26.4659}:  20%|██        | 2/10 [00:38<02:42, 20.33s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0644, 'compress@10': 0.4264, 'time@10': 24.7577}:  20%|██        | 2/10 [00:49<02:42, 20.33s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0644, 'compress@10': 0.4264, 'time@10': 24.7577}:  30%|███       | 3/10 [00:49<01:51, 15.93s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0704, 'compress@10': 0.4963, 'time@10': 24.2087}:  30%|███       | 3/10 [01:12<01:51, 15.93s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0704, 'compress@10': 0.4963, 'time@10': 24.2087}:  40%|████      | 4/10 [01:12<01:51, 18.58s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0713, 'compress@10': 0.4696, 'time@10': 30.4391}:  40%|████      | 4/10 [01:39<01:51, 18.58s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0713, 'compress@10': 0.4696, 'time@10': 30.4391}:  50%|█████     | 5/10 [01:39<01:49, 21.88s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0731, 'compress@10': 0.5295, 'time@10': 30.4763}:  50%|█████     | 5/10 [02:10<01:49, 21.88s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0731, 'compress@10': 0.5295, 'time@10': 30.4763}:  60%|██████    | 6/10 [02:10<01:39, 24.88s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0722, 'compress@10': 0.4841, 'time@10': 31.4155}:  60%|██████    | 6/10 [02:29<01:39, 24.88s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0722, 'compress@10': 0.4841, 'time@10': 31.4155}:  70%|███████   | 7/10 [02:29<01:08, 22.81s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0781, 'compress@10': 0.4768, 'time@10': 30.8567}:  70%|███████   | 7/10 [02:56<01:08, 22.81s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0781, 'compress@10': 0.4768, 'time@10': 30.8567}:  80%|████████  | 8/10 [02:56<00:48, 24.14s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0761, 'compress@10': 0.5264, 'time@10': 32.1834}:  80%|████████  | 8/10 [03:17<00:48, 24.14s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0761, 'compress@10': 0.5264, 'time@10': 32.1834}:  90%|█████████ | 9/10 [03:17<00:23, 23.29s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0748, 'compress@10': 0.5069, 'time@10': 32.3987}:  90%|█████████ | 9/10 [03:51<00:23, 23.29s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0748, 'compress@10': 0.5069, 'time@10': 32.3987}: 100%|██████████| 10/10 [03:51<00:00, 26.71s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0748, 'compress@10': 0.5069, 'time@10': 32.3987}: 100%|██████████| 10/10 [03:51<00:00, 23.19s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.011745792832078153
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0748137967002087
Avg compression ratio: 0.5069240334346683
Avg train time: 32.398726320266725
Std train time: 9.95078849520884
[0.7121212121212119, 0.4696969696969697, 0.04545454545454546, 0.7121212121212124, 0.34848484848484856, 0.8333333333333334, 0.19696969696969696, 0.40909090909090906, 0.9242424242424242, 0.3484848484848485]
[10, 10, 23, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0658, 'compress@10': 0.7161, 'time@10': 29.421}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0658, 'compress@10': 0.7161, 'time@10': 29.421}:  10%|█         | 1/10 [00:14<02:12, 14.75s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0665, 'compress@10': 0.5951, 'time@10': 26.8276}:  10%|█         | 1/10 [00:39<02:12, 14.75s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0665, 'compress@10': 0.5951, 'time@10': 26.8276}:  20%|██        | 2/10 [00:39<02:42, 20.35s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0586, 'compress@10': 0.4241, 'time@10': 25.179}:  20%|██        | 2/10 [00:49<02:42, 20.35s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0586, 'compress@10': 0.4241, 'time@10': 25.179}:  30%|███       | 3/10 [00:49<01:52, 16.07s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0795, 'compress@10': 0.4968, 'time@10': 24.4465}:  30%|███       | 3/10 [01:12<01:52, 16.07s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0795, 'compress@10': 0.4968, 'time@10': 24.4465}:  40%|████      | 4/10 [01:12<01:51, 18.53s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0785, 'compress@10': 0.4678, 'time@10': 30.513}:  40%|████      | 4/10 [01:39<01:51, 18.53s/it] {'epoch': 32, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0785, 'compress@10': 0.4678, 'time@10': 30.513}:  50%|█████     | 5/10 [01:39<01:48, 21.74s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0121, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0785, 'compress@10': 0.5289, 'time@10': 30.6365}:  50%|█████     | 5/10 [02:11<01:48, 21.74s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0121, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0785, 'compress@10': 0.5289, 'time@10': 30.6365}:  60%|██████    | 6/10 [02:11<01:39, 24.98s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0764, 'compress@10': 0.4827, 'time@10': 31.5469}:  60%|██████    | 6/10 [02:29<01:39, 24.98s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0764, 'compress@10': 0.4827, 'time@10': 31.5469}:  70%|███████   | 7/10 [02:29<01:08, 22.88s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0829, 'compress@10': 0.474, 'time@10': 30.9362}:  70%|███████   | 7/10 [02:56<01:08, 22.88s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0829, 'compress@10': 0.474, 'time@10': 30.9362}:  80%|████████  | 8/10 [02:56<00:48, 24.10s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0859, 'compress@10': 0.5241, 'time@10': 32.158}:  80%|████████  | 8/10 [03:17<00:48, 24.10s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0859, 'compress@10': 0.5241, 'time@10': 32.158}:  90%|█████████ | 9/10 [03:17<00:23, 23.14s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0838, 'compress@10': 0.5069, 'time@10': 32.355}:  90%|█████████ | 9/10 [03:51<00:23, 23.14s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0838, 'compress@10': 0.5069, 'time@10': 32.355}: 100%|██████████| 10/10 [03:51<00:00, 26.54s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0838, 'compress@10': 0.5069, 'time@10': 32.355}: 100%|██████████| 10/10 [03:51<00:00, 23.14s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.012886038753227348
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0838423137024575
Avg compression ratio: 0.5069422128838119
Avg train time: 32.35499219894409
Std train time: 9.692191871078155
[0.7205882352941174, 0.4558823529411765, 0.04411764705882354, 0.7205882352941179, 0.33823529411764713, 0.8382352941176471, 0.19117647058823528, 0.4264705882352941, 0.926470588235294, 0.3382352941176471]
[10, 10, 23, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0619, 'compress@10': 0.7245, 'time@10': 27.863}:   0%|          | 0/10 [00:13<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0619, 'compress@10': 0.7245, 'time@10': 27.863}:  10%|█         | 1/10 [00:13<02:05, 13.97s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0718, 'compress@10': 0.5924, 'time@10': 25.7617}:  10%|█         | 1/10 [00:37<02:05, 13.97s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0718, 'compress@10': 0.5924, 'time@10': 25.7617}:  20%|██        | 2/10 [00:37<02:37, 19.69s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0632, 'compress@10': 0.4219, 'time@10': 24.3547}:  20%|██        | 2/10 [00:48<02:37, 19.69s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0632, 'compress@10': 0.4219, 'time@10': 24.3547}:  30%|███       | 3/10 [00:48<01:49, 15.63s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.065, 'compress@10': 0.4973, 'time@10': 23.8066}:  30%|███       | 3/10 [01:10<01:49, 15.63s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.065, 'compress@10': 0.4973, 'time@10': 23.8066}:  40%|████      | 4/10 [01:10<01:49, 18.23s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.067, 'compress@10': 0.4661, 'time@10': 30.3434}:  40%|████      | 4/10 [01:38<01:49, 18.23s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.067, 'compress@10': 0.4661, 'time@10': 30.3434}:  50%|█████     | 5/10 [01:38<01:49, 21.85s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0691, 'compress@10': 0.5283, 'time@10': 30.4375}:  50%|█████     | 5/10 [02:09<01:49, 21.85s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0691, 'compress@10': 0.5283, 'time@10': 30.4375}:  60%|██████    | 6/10 [02:09<01:39, 24.94s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.069, 'compress@10': 0.4814, 'time@10': 31.4042}:  60%|██████    | 6/10 [02:28<01:39, 24.94s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.069, 'compress@10': 0.4814, 'time@10': 31.4042}:  70%|███████   | 7/10 [02:28<01:08, 22.88s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0737, 'compress@10': 0.475, 'time@10': 30.8531}:  70%|███████   | 7/10 [02:55<01:08, 22.88s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0737, 'compress@10': 0.475, 'time@10': 30.8531}:  80%|████████  | 8/10 [02:55<00:48, 24.20s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0729, 'compress@10': 0.5253, 'time@10': 32.137}:  80%|████████  | 8/10 [03:16<00:48, 24.20s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0729, 'compress@10': 0.5253, 'time@10': 32.137}:  90%|█████████ | 9/10 [03:16<00:23, 23.28s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0721, 'compress@10': 0.5069, 'time@10': 32.3536}:  90%|█████████ | 9/10 [03:51<00:23, 23.28s/it]  {'epoch': 33, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0721, 'compress@10': 0.5069, 'time@10': 32.3536}: 100%|██████████| 10/10 [03:51<00:00, 26.69s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0721, 'compress@10': 0.5069, 'time@10': 32.3536}: 100%|██████████| 10/10 [03:51<00:00, 23.12s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.0110152600837761
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0721057811801722
Avg compression ratio: 0.5069390027111931
Avg train time: 32.353575587272644
Std train time: 10.287525278812655
[0.6999999999999997, 0.4714285714285715, 0.042857142857142864, 0.7000000000000002, 0.3285714285714286, 0.8428571428571429, 0.21428571428571427, 0.41428571428571426, 0.9285714285714285, 0.35714285714285715]
[10, 10, 23, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0675, 'compress@10': 0.7042, 'time@10': 27.9703}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0675, 'compress@10': 0.7042, 'time@10': 27.9703}:  10%|█         | 1/10 [00:14<02:06, 14.02s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0631, 'compress@10': 0.59, 'time@10': 26.0404}:  10%|█         | 1/10 [00:38<02:06, 14.02s/it]  {'epoch': 34, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0631, 'compress@10': 0.59, 'time@10': 26.0404}:  20%|██        | 2/10 [00:38<02:39, 19.98s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0573, 'compress@10': 0.4199, 'time@10': 24.4451}:  20%|██        | 2/10 [00:48<02:39, 19.98s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0573, 'compress@10': 0.4199, 'time@10': 24.4451}:  30%|███       | 3/10 [00:48<01:50, 15.73s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0726, 'compress@10': 0.4906, 'time@10': 23.8883}:  30%|███       | 3/10 [01:11<01:50, 15.73s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0726, 'compress@10': 0.4906, 'time@10': 23.8883}:  40%|████      | 4/10 [01:11<01:49, 18.31s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.073, 'compress@10': 0.4589, 'time@10': 30.1115}:  40%|████      | 4/10 [01:38<01:49, 18.31s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.073, 'compress@10': 0.4589, 'time@10': 30.1115}:  50%|█████     | 5/10 [01:38<01:48, 21.64s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0734, 'compress@10': 0.523, 'time@10': 30.0923}:  50%|█████     | 5/10 [02:08<01:48, 21.64s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0734, 'compress@10': 0.523, 'time@10': 30.0923}:  60%|██████    | 6/10 [02:08<01:37, 24.49s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0725, 'compress@10': 0.4801, 'time@10': 31.1889}:  60%|██████    | 6/10 [02:27<01:37, 24.49s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0725, 'compress@10': 0.4801, 'time@10': 31.1889}:  70%|███████   | 7/10 [02:27<01:08, 22.67s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0767, 'compress@10': 0.4724, 'time@10': 30.6856}:  70%|███████   | 7/10 [02:54<01:08, 22.67s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0767, 'compress@10': 0.4724, 'time@10': 30.6856}:  80%|████████  | 8/10 [02:54<00:48, 24.11s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0772, 'compress@10': 0.5232, 'time@10': 31.9455}:  80%|████████  | 8/10 [03:15<00:48, 24.11s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0772, 'compress@10': 0.5232, 'time@10': 31.9455}:  90%|█████████ | 9/10 [03:15<00:23, 23.16s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0765, 'compress@10': 0.507, 'time@10': 32.1712}:  90%|█████████ | 9/10 [03:50<00:23, 23.16s/it]    {'epoch': 34, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0765, 'compress@10': 0.507, 'time@10': 32.1712}: 100%|██████████| 10/10 [03:50<00:00, 26.58s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0765, 'compress@10': 0.507, 'time@10': 32.1712}: 100%|██████████| 10/10 [03:50<00:00, 23.01s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.010701460085753792
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0764614025709967
Avg compression ratio: 0.5069532804269297
Avg train time: 32.17119607925415
Std train time: 9.922684431876627
[0.708333333333333, 0.45833333333333337, 0.04166666666666667, 0.7083333333333335, 0.3194444444444445, 0.8472222222222222, 0.20833333333333331, 0.4305555555555555, 0.9305555555555555, 0.3472222222222222]
[10, 10, 23, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.063, 'compress@10': 0.7124, 'time@10': 27.1481}:   0%|          | 0/10 [00:13<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.063, 'compress@10': 0.7124, 'time@10': 27.1481}:  10%|█         | 1/10 [00:13<02:02, 13.61s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0598, 'compress@10': 0.5876, 'time@10': 25.5847}:  10%|█         | 1/10 [00:37<02:02, 13.61s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0598, 'compress@10': 0.5876, 'time@10': 25.5847}:  20%|██        | 2/10 [00:37<02:38, 19.76s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0552, 'compress@10': 0.4179, 'time@10': 24.4307}:  20%|██        | 2/10 [00:48<02:38, 19.76s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0552, 'compress@10': 0.4179, 'time@10': 24.4307}:  30%|███       | 3/10 [00:48<01:50, 15.80s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0628, 'compress@10': 0.4912, 'time@10': 23.7551}:  30%|███       | 3/10 [01:10<01:50, 15.80s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0628, 'compress@10': 0.4912, 'time@10': 23.7551}:  40%|████      | 4/10 [01:10<01:48, 18.16s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0659, 'compress@10': 0.4576, 'time@10': 29.8478}:  40%|████      | 4/10 [01:37<01:48, 18.16s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0659, 'compress@10': 0.4576, 'time@10': 29.8478}:  50%|█████     | 5/10 [01:37<01:46, 21.40s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.067, 'compress@10': 0.5226, 'time@10': 29.8359}:  50%|█████     | 5/10 [02:07<01:46, 21.40s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.067, 'compress@10': 0.5226, 'time@10': 29.8359}:  60%|██████    | 6/10 [02:07<01:37, 24.27s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.067, 'compress@10': 0.4789, 'time@10': 30.8612}:  60%|██████    | 6/10 [02:26<01:37, 24.27s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.067, 'compress@10': 0.4789, 'time@10': 30.8612}:  70%|███████   | 7/10 [02:26<01:07, 22.39s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0724, 'compress@10': 0.4734, 'time@10': 30.3567}:  70%|███████   | 7/10 [02:52<01:07, 22.39s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0724, 'compress@10': 0.4734, 'time@10': 30.3567}:  80%|████████  | 8/10 [02:52<00:47, 23.82s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.071, 'compress@10': 0.5243, 'time@10': 31.631}:  80%|████████  | 8/10 [03:13<00:47, 23.82s/it] {'epoch': 35, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.071, 'compress@10': 0.5243, 'time@10': 31.631}:  90%|█████████ | 9/10 [03:13<00:22, 22.92s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0703, 'compress@10': 0.5069, 'time@10': 31.964}:  90%|█████████ | 9/10 [03:48<00:22, 22.92s/it]  {'epoch': 35, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0703, 'compress@10': 0.5069, 'time@10': 31.964}: 100%|██████████| 10/10 [03:48<00:00, 26.65s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0703, 'compress@10': 0.5069, 'time@10': 31.964}: 100%|██████████| 10/10 [03:48<00:00, 22.89s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.011219323042579572
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0702861071814258
Avg compression ratio: 0.5069492971871451
Avg train time: 31.964042210578917
Std train time: 9.726707809995665
[0.6891891891891889, 0.472972972972973, 0.04054054054054054, 0.7162162162162163, 0.31081081081081086, 0.8513513513513513, 0.2027027027027027, 0.4189189189189189, 0.9324324324324323, 0.36486486486486486]
[10, 10, 23, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0713, 'compress@10': 0.6935, 'time@10': 27.4077}:   0%|          | 0/10 [00:13<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0713, 'compress@10': 0.6935, 'time@10': 27.4077}:  10%|█         | 1/10 [00:13<02:03, 13.74s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0658, 'compress@10': 0.5854, 'time@10': 26.1958}:  10%|█         | 1/10 [00:38<02:03, 13.74s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0658, 'compress@10': 0.5854, 'time@10': 26.1958}:  20%|██        | 2/10 [00:38<02:43, 20.38s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0592, 'compress@10': 0.4161, 'time@10': 24.5684}:  20%|██        | 2/10 [00:49<02:43, 20.38s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0592, 'compress@10': 0.4161, 'time@10': 24.5684}:  30%|███       | 3/10 [00:49<01:51, 15.96s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0621, 'compress@10': 0.4918, 'time@10': 23.9071}:  30%|███       | 3/10 [01:11<01:51, 15.96s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0621, 'compress@10': 0.4918, 'time@10': 23.9071}:  40%|████      | 4/10 [01:11<01:49, 18.33s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0065, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0652, 'compress@10': 0.4563, 'time@10': 30.0579}:  40%|████      | 4/10 [01:38<01:49, 18.33s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0065, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0652, 'compress@10': 0.4563, 'time@10': 30.0579}:  50%|█████     | 5/10 [01:38<01:47, 21.59s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0686, 'compress@10': 0.5223, 'time@10': 30.1063}:  50%|█████     | 5/10 [02:09<01:47, 21.59s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0686, 'compress@10': 0.5223, 'time@10': 30.1063}:  60%|██████    | 6/10 [02:09<01:38, 24.58s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0684, 'compress@10': 0.4779, 'time@10': 31.1056}:  60%|██████    | 6/10 [02:27<01:38, 24.58s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0684, 'compress@10': 0.4779, 'time@10': 31.1056}:  70%|███████   | 7/10 [02:27<01:07, 22.62s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0086, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0727, 'compress@10': 0.471, 'time@10': 30.6107}:  70%|███████   | 7/10 [02:54<01:07, 22.62s/it]  {'epoch': 36, 'num_users': 6.125, 'loss': 0.0086, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0727, 'compress@10': 0.471, 'time@10': 30.6107}:  80%|████████  | 8/10 [02:54<00:48, 24.07s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0739, 'compress@10': 0.5223, 'time@10': 31.6689}:  80%|████████  | 8/10 [03:15<00:48, 24.07s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0739, 'compress@10': 0.5223, 'time@10': 31.6689}:  90%|█████████ | 9/10 [03:15<00:22, 22.83s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0743, 'compress@10': 0.507, 'time@10': 31.9237}:  90%|█████████ | 9/10 [03:49<00:22, 22.83s/it]  {'epoch': 36, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0743, 'compress@10': 0.507, 'time@10': 31.9237}: 100%|██████████| 10/10 [03:49<00:00, 26.37s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0743, 'compress@10': 0.507, 'time@10': 31.9237}: 100%|██████████| 10/10 [03:49<00:00, 22.93s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.010227704656145916
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0742900598514837
Avg compression ratio: 0.5069663481594258
Avg train time: 31.92370550632477
Std train time: 9.606788528575146
[0.6973684210526313, 0.46052631578947373, 0.03947368421052632, 0.6973684210526317, 0.3026315789473685, 0.8552631578947368, 0.19736842105263155, 0.4342105263157895, 0.9342105263157894, 0.381578947368421]
[10, 10, 23, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0629, 'compress@10': 0.7016, 'time@10': 26.9318}:   0%|          | 0/10 [00:13<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0629, 'compress@10': 0.7016, 'time@10': 26.9318}:  10%|█         | 1/10 [00:13<02:01, 13.50s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0748, 'compress@10': 0.5833, 'time@10': 25.4892}:  10%|█         | 1/10 [00:37<02:01, 13.50s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0748, 'compress@10': 0.5833, 'time@10': 25.4892}:  20%|██        | 2/10 [00:37<02:37, 19.74s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0655, 'compress@10': 0.4143, 'time@10': 24.1687}:  20%|██        | 2/10 [00:48<02:37, 19.74s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0655, 'compress@10': 0.4143, 'time@10': 24.1687}:  30%|███       | 3/10 [00:48<01:49, 15.66s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0724, 'compress@10': 0.4858, 'time@10': 23.6685}:  30%|███       | 3/10 [01:10<01:49, 15.66s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0724, 'compress@10': 0.4858, 'time@10': 23.6685}:  40%|████      | 4/10 [01:10<01:49, 18.25s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0736, 'compress@10': 0.4499, 'time@10': 30.1111}:  40%|████      | 4/10 [01:38<01:49, 18.25s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0736, 'compress@10': 0.4499, 'time@10': 30.1111}:  50%|█████     | 5/10 [01:38<01:48, 21.75s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0742, 'compress@10': 0.5176, 'time@10': 30.1257}:  50%|█████     | 5/10 [02:08<01:48, 21.75s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0742, 'compress@10': 0.5176, 'time@10': 30.1257}:  60%|██████    | 6/10 [02:08<01:38, 24.64s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0733, 'compress@10': 0.4731, 'time@10': 31.1702}:  60%|██████    | 6/10 [02:27<01:38, 24.64s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0733, 'compress@10': 0.4731, 'time@10': 31.1702}:  70%|███████   | 7/10 [02:27<01:08, 22.72s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0786, 'compress@10': 0.4687, 'time@10': 30.6736}:  70%|███████   | 7/10 [02:54<01:08, 22.72s/it]  {'epoch': 37, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0786, 'compress@10': 0.4687, 'time@10': 30.6736}:  80%|████████  | 8/10 [02:54<00:48, 24.16s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0769, 'compress@10': 0.5205, 'time@10': 31.7774}:  80%|████████  | 8/10 [03:15<00:48, 24.16s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0769, 'compress@10': 0.5205, 'time@10': 31.7774}:  90%|█████████ | 9/10 [03:15<00:22, 22.96s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0758, 'compress@10': 0.507, 'time@10': 32.03}:  90%|█████████ | 9/10 [03:49<00:22, 22.96s/it]      {'epoch': 37, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0758, 'compress@10': 0.507, 'time@10': 32.03}: 100%|██████████| 10/10 [03:49<00:00, 26.48s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0758, 'compress@10': 0.507, 'time@10': 32.03}: 100%|██████████| 10/10 [03:49<00:00, 22.95s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.011586521117387227
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0757588625770866
Avg compression ratio: 0.5069736109073272
Avg train time: 32.02999997138977
Std train time: 10.00437494211934
[0.6794871794871792, 0.4743589743589744, 0.038461538461538464, 0.7051282051282053, 0.29487179487179493, 0.8589743589743589, 0.1923076923076923, 0.44871794871794873, 0.9358974358974358, 0.37179487179487175]
[10, 10, 23, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0727, 'compress@10': 0.6839, 'time@10': 27.3965}:   0%|          | 0/10 [00:13<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0727, 'compress@10': 0.6839, 'time@10': 27.3965}:  10%|█         | 1/10 [00:13<02:03, 13.74s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0652, 'compress@10': 0.5813, 'time@10': 25.818}:  10%|█         | 1/10 [00:38<02:03, 13.74s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0652, 'compress@10': 0.5813, 'time@10': 25.818}:  20%|██        | 2/10 [00:38<02:39, 19.94s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0588, 'compress@10': 0.4127, 'time@10': 24.1552}:  20%|██        | 2/10 [00:48<02:39, 19.94s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0588, 'compress@10': 0.4127, 'time@10': 24.1552}:  30%|███       | 3/10 [00:48<01:49, 15.60s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.061, 'compress@10': 0.4865, 'time@10': 23.5594}:  30%|███       | 3/10 [01:10<01:49, 15.60s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.061, 'compress@10': 0.4865, 'time@10': 23.5594}:  40%|████      | 4/10 [01:10<01:48, 18.05s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0057, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0646, 'compress@10': 0.4489, 'time@10': 30.205}:  40%|████      | 4/10 [01:38<01:48, 18.05s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0057, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0646, 'compress@10': 0.4489, 'time@10': 30.205}:  50%|█████     | 5/10 [01:38<01:49, 21.80s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0651, 'compress@10': 0.5174, 'time@10': 30.3177}:  50%|█████     | 5/10 [02:09<01:49, 21.80s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0651, 'compress@10': 0.5174, 'time@10': 30.3177}:  60%|██████    | 6/10 [02:09<01:39, 24.90s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0078, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0655, 'compress@10': 0.4722, 'time@10': 31.3676}:  60%|██████    | 6/10 [02:28<01:39, 24.90s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0078, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0655, 'compress@10': 0.4722, 'time@10': 31.3676}:  70%|███████   | 7/10 [02:28<01:08, 22.93s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0082, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0691, 'compress@10': 0.4697, 'time@10': 30.8782}:  70%|███████   | 7/10 [02:56<01:08, 22.93s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0082, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0691, 'compress@10': 0.4697, 'time@10': 30.8782}:  80%|████████  | 8/10 [02:56<00:48, 24.38s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0091, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0687, 'compress@10': 0.5216, 'time@10': 31.9545}:  80%|████████  | 8/10 [03:16<00:48, 24.38s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0091, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0687, 'compress@10': 0.5216, 'time@10': 31.9545}:  90%|█████████ | 9/10 [03:16<00:23, 23.11s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0702, 'compress@10': 0.507, 'time@10': 32.1769}:  90%|█████████ | 9/10 [03:50<00:23, 23.11s/it]    {'epoch': 38, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0702, 'compress@10': 0.507, 'time@10': 32.1769}: 100%|██████████| 10/10 [03:50<00:00, 26.54s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0702, 'compress@10': 0.507, 'time@10': 32.1769}: 100%|██████████| 10/10 [03:50<00:00, 23.06s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.009392316529185886
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0701582786563075
Avg compression ratio: 0.5069831004754283
Avg train time: 32.17685272693634
Std train time: 10.281343131522483
[0.6874999999999997, 0.4625, 0.037500000000000006, 0.6875000000000001, 0.2875000000000001, 0.8624999999999999, 0.18749999999999997, 0.4625, 0.9374999999999999, 0.38749999999999996]
[10, 10, 23, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0661, 'compress@10': 0.6918, 'time@10': 27.9484}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0661, 'compress@10': 0.6918, 'time@10': 27.9484}:  10%|█         | 1/10 [00:14<02:06, 14.01s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0069, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.063, 'compress@10': 0.5794, 'time@10': 25.8457}:  10%|█         | 1/10 [00:37<02:06, 14.01s/it] {'epoch': 39, 'num_users': 7.0, 'loss': 0.0069, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.063, 'compress@10': 0.5794, 'time@10': 25.8457}:  20%|██        | 2/10 [00:37<02:38, 19.76s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0573, 'compress@10': 0.4111, 'time@10': 23.9776}:  20%|██        | 2/10 [00:47<02:38, 19.76s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0573, 'compress@10': 0.4111, 'time@10': 23.9776}:  30%|███       | 3/10 [00:47<01:47, 15.37s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0645, 'compress@10': 0.481, 'time@10': 23.4605}:  30%|███       | 3/10 [01:09<01:47, 15.37s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0645, 'compress@10': 0.481, 'time@10': 23.4605}:  40%|████      | 4/10 [01:09<01:47, 17.97s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0069, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.067, 'compress@10': 0.443, 'time@10': 29.4727}:  40%|████      | 4/10 [01:36<01:47, 17.97s/it] {'epoch': 39, 'num_users': 5.8, 'loss': 0.0069, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.067, 'compress@10': 0.443, 'time@10': 29.4727}:  50%|█████     | 5/10 [01:36<01:45, 21.15s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0079, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0668, 'compress@10': 0.513, 'time@10': 29.5873}:  50%|█████     | 5/10 [02:06<01:45, 21.15s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0079, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0668, 'compress@10': 0.513, 'time@10': 29.5873}:  60%|██████    | 6/10 [02:06<01:36, 24.23s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0081, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0671, 'compress@10': 0.4678, 'time@10': 30.4895}:  60%|██████    | 6/10 [02:24<01:36, 24.23s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0081, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0671, 'compress@10': 0.4678, 'time@10': 30.4895}:  70%|███████   | 7/10 [02:24<01:06, 22.19s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0724, 'compress@10': 0.4676, 'time@10': 29.9823}:  70%|███████   | 7/10 [02:51<01:06, 22.19s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0724, 'compress@10': 0.4676, 'time@10': 29.9823}:  80%|████████  | 8/10 [02:51<00:47, 23.55s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.009, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0724, 'compress@10': 0.5199, 'time@10': 31.0949}:  80%|████████  | 8/10 [03:11<00:47, 23.55s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.009, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0724, 'compress@10': 0.5199, 'time@10': 31.0949}:  90%|█████████ | 9/10 [03:11<00:22, 22.45s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0091, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0714, 'compress@10': 0.507, 'time@10': 31.3854}:  90%|█████████ | 9/10 [03:45<00:22, 22.45s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0091, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0714, 'compress@10': 0.507, 'time@10': 31.3854}: 100%|██████████| 10/10 [03:45<00:00, 26.03s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0091, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0714, 'compress@10': 0.507, 'time@10': 31.3854}: 100%|██████████| 10/10 [03:45<00:00, 22.54s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.00914229692780617
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0714236628377978
Avg compression ratio: 0.5069907180001142
Avg train time: 31.38542675971985
Std train time: 9.495391903977477
[0.6707317073170729, 0.45121951219512196, 0.03658536585365854, 0.6951219512195123, 0.28048780487804886, 0.8658536585365852, 0.18292682926829265, 0.475609756097561, 0.9390243902439024, 0.40243902439024387]
[10, 10, 24, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0735, 'compress@10': 0.6753, 'time@10': 28.8839}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0735, 'compress@10': 0.6753, 'time@10': 28.8839}:  10%|█         | 1/10 [00:14<02:10, 14.49s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0666, 'compress@10': 0.5655, 'time@10': 26.2031}:  10%|█         | 1/10 [00:38<02:10, 14.49s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0666, 'compress@10': 0.5655, 'time@10': 26.2031}:  20%|██        | 2/10 [00:38<02:38, 19.83s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0597, 'compress@10': 0.4016, 'time@10': 24.7241}:  20%|██        | 2/10 [00:48<02:38, 19.83s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0597, 'compress@10': 0.4016, 'time@10': 24.7241}:  30%|███       | 3/10 [00:48<01:50, 15.76s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0623, 'compress@10': 0.4757, 'time@10': 24.0186}:  30%|███       | 3/10 [01:10<01:50, 15.76s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0623, 'compress@10': 0.4757, 'time@10': 24.0186}:  40%|████      | 4/10 [01:10<01:49, 18.20s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0071, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0655, 'compress@10': 0.4374, 'time@10': 30.0478}:  40%|████      | 4/10 [01:38<01:49, 18.20s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0071, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0655, 'compress@10': 0.4374, 'time@10': 30.0478}:  50%|█████     | 5/10 [01:38<01:47, 21.42s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0081, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0665, 'compress@10': 0.5089, 'time@10': 30.0464}:  50%|█████     | 5/10 [02:08<01:47, 21.42s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0081, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0665, 'compress@10': 0.5089, 'time@10': 30.0464}:  60%|██████    | 6/10 [02:08<01:37, 24.36s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0079, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0671, 'compress@10': 0.4636, 'time@10': 30.9128}:  60%|██████    | 6/10 [02:26<01:37, 24.36s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0079, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0671, 'compress@10': 0.4636, 'time@10': 30.9128}:  70%|███████   | 7/10 [02:26<01:06, 22.31s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0699, 'compress@10': 0.4656, 'time@10': 30.3221}:  70%|███████   | 7/10 [02:52<01:06, 22.31s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0699, 'compress@10': 0.4656, 'time@10': 30.3221}:  80%|████████  | 8/10 [02:52<00:47, 23.56s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.069, 'compress@10': 0.5182, 'time@10': 31.3454}:  80%|████████  | 8/10 [03:12<00:47, 23.56s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.069, 'compress@10': 0.5182, 'time@10': 31.3454}:  90%|█████████ | 9/10 [03:12<00:22, 22.38s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.07, 'compress@10': 0.507, 'time@10': 31.621}:  90%|█████████ | 9/10 [03:46<00:22, 22.38s/it]      {'epoch': 40, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.07, 'compress@10': 0.507, 'time@10': 31.621}: 100%|██████████| 10/10 [03:46<00:00, 26.01s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.07, 'compress@10': 0.507, 'time@10': 31.621}: 100%|██████████| 10/10 [03:46<00:00, 22.64s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.009500817890178119
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0700193742381003
Avg compression ratio: 0.5070048999475966
Avg train time: 31.620955395698548
Std train time: 9.4540749262736
[0.6785714285714283, 0.4642857142857143, 0.03571428571428572, 0.6785714285714286, 0.2738095238095239, 0.869047619047619, 0.17857142857142855, 0.48809523809523814, 0.9166666666666666, 0.41666666666666663]
[10, 10, 24, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0052, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0674, 'compress@10': 0.683, 'time@10': 27.1915}:   0%|          | 0/10 [00:13<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0052, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0674, 'compress@10': 0.683, 'time@10': 27.1915}:  10%|█         | 1/10 [00:13<02:02, 13.63s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0629, 'compress@10': 0.5759, 'time@10': 25.2917}:  10%|█         | 1/10 [00:37<02:02, 13.63s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0629, 'compress@10': 0.5759, 'time@10': 25.2917}:  20%|██        | 2/10 [00:37<02:35, 19.40s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0573, 'compress@10': 0.4082, 'time@10': 24.4158}:  20%|██        | 2/10 [00:48<02:35, 19.40s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0573, 'compress@10': 0.4082, 'time@10': 24.4158}:  30%|███       | 3/10 [00:48<01:50, 15.73s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0655, 'compress@10': 0.4766, 'time@10': 23.9336}:  30%|███       | 3/10 [01:10<01:50, 15.73s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0655, 'compress@10': 0.4766, 'time@10': 23.9336}:  40%|████      | 4/10 [01:10<01:50, 18.41s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.068, 'compress@10': 0.4368, 'time@10': 29.9408}:  40%|████      | 4/10 [01:37<01:50, 18.41s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.068, 'compress@10': 0.4368, 'time@10': 29.9408}:  50%|█████     | 5/10 [01:37<01:47, 21.52s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0683, 'compress@10': 0.5089, 'time@10': 29.9155}:  50%|█████     | 5/10 [02:07<01:47, 21.52s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0683, 'compress@10': 0.5089, 'time@10': 29.9155}:  60%|██████    | 6/10 [02:07<01:37, 24.34s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0086, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0682, 'compress@10': 0.463, 'time@10': 30.7215}:  60%|██████    | 6/10 [02:25<01:37, 24.34s/it] {'epoch': 41, 'num_users': 6.2857, 'loss': 0.0086, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0682, 'compress@10': 0.463, 'time@10': 30.7215}:  70%|███████   | 7/10 [02:25<01:06, 22.21s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0717, 'compress@10': 0.4666, 'time@10': 30.1457}:  70%|███████   | 7/10 [02:51<01:06, 22.21s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0717, 'compress@10': 0.4666, 'time@10': 30.1457}:  80%|████████  | 8/10 [02:51<00:46, 23.47s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0102, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0733, 'compress@10': 0.5167, 'time@10': 31.0998}:  80%|████████  | 8/10 [03:11<00:46, 23.47s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0102, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0733, 'compress@10': 0.5167, 'time@10': 31.0998}:  90%|█████████ | 9/10 [03:11<00:22, 22.20s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0721, 'compress@10': 0.507, 'time@10': 31.3143}:  90%|█████████ | 9/10 [03:44<00:22, 22.20s/it]    {'epoch': 41, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0721, 'compress@10': 0.507, 'time@10': 31.3143}: 100%|██████████| 10/10 [03:44<00:00, 25.63s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0721, 'compress@10': 0.507, 'time@10': 31.3143}: 100%|██████████| 10/10 [03:44<00:00, 22.45s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.010184467413453786
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0720760386501467
Avg compression ratio: 0.5070093588057565
Avg train time: 31.314306688308715
Std train time: 9.22974224805438
[0.6627906976744183, 0.47674418604651164, 0.034883720930232565, 0.686046511627907, 0.26744186046511637, 0.8488372093023255, 0.17441860465116277, 0.5, 0.9186046511627907, 0.43023255813953487]
[10, 10, 24, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0743, 'compress@10': 0.6675, 'time@10': 27.2449}:   0%|          | 0/10 [00:13<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0743, 'compress@10': 0.6675, 'time@10': 27.2449}:  10%|█         | 1/10 [00:13<02:02, 13.66s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0645, 'compress@10': 0.5743, 'time@10': 25.2922}:  10%|█         | 1/10 [00:37<02:02, 13.66s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0645, 'compress@10': 0.5743, 'time@10': 25.2922}:  20%|██        | 2/10 [00:37<02:34, 19.37s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0583, 'compress@10': 0.4069, 'time@10': 24.341}:  20%|██        | 2/10 [00:48<02:34, 19.37s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0583, 'compress@10': 0.4069, 'time@10': 24.341}:  30%|███       | 3/10 [00:48<01:49, 15.67s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.061, 'compress@10': 0.4774, 'time@10': 23.7286}:  30%|███       | 3/10 [01:10<01:49, 15.67s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.061, 'compress@10': 0.4774, 'time@10': 23.7286}:  40%|████      | 4/10 [01:10<01:48, 18.14s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0645, 'compress@10': 0.4362, 'time@10': 29.5574}:  40%|████      | 4/10 [01:36<01:48, 18.14s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0645, 'compress@10': 0.4362, 'time@10': 29.5574}:  50%|█████     | 5/10 [01:36<01:45, 21.14s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0076, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0652, 'compress@10': 0.5051, 'time@10': 29.9863}:  50%|█████     | 5/10 [02:08<01:45, 21.14s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0076, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0652, 'compress@10': 0.5051, 'time@10': 29.9863}:  60%|██████    | 6/10 [02:08<01:39, 24.89s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0659, 'compress@10': 0.4591, 'time@10': 30.7871}:  60%|██████    | 6/10 [02:26<01:39, 24.89s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0659, 'compress@10': 0.4591, 'time@10': 30.7871}:  70%|███████   | 7/10 [02:26<01:07, 22.58s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0077, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0696, 'compress@10': 0.4647, 'time@10': 30.2488}:  70%|███████   | 7/10 [02:53<01:07, 22.58s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0077, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0696, 'compress@10': 0.4647, 'time@10': 30.2488}:  80%|████████  | 8/10 [02:53<00:47, 23.84s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0081, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0694, 'compress@10': 0.5152, 'time@10': 31.1385}:  80%|████████  | 8/10 [03:12<00:47, 23.84s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0081, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0694, 'compress@10': 0.5152, 'time@10': 31.1385}:  90%|█████████ | 9/10 [03:12<00:22, 22.38s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0702, 'compress@10': 0.507, 'time@10': 31.375}:  90%|█████████ | 9/10 [03:45<00:22, 22.38s/it]     {'epoch': 42, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0702, 'compress@10': 0.507, 'time@10': 31.375}: 100%|██████████| 10/10 [03:45<00:00, 25.83s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0702, 'compress@10': 0.507, 'time@10': 31.375}: 100%|██████████| 10/10 [03:45<00:00, 22.59s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.008285717598049126
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0701929620417179
Avg compression ratio: 0.5070169869584805
Avg train time: 31.375022864341737
Std train time: 8.987564750866156
[0.6704545454545452, 0.48863636363636365, 0.034090909090909095, 0.6704545454545454, 0.26136363636363646, 0.8295454545454545, 0.17045454545454544, 0.5113636363636364, 0.9204545454545454, 0.4431818181818182]
[10, 10, 24, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0039, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0677, 'compress@10': 0.675, 'time@10': 27.7543}:   0%|          | 0/10 [00:13<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0039, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0677, 'compress@10': 0.675, 'time@10': 27.7543}:  10%|█         | 1/10 [00:13<02:05, 13.91s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.063, 'compress@10': 0.584, 'time@10': 25.6067}:  10%|█         | 1/10 [00:37<02:05, 13.91s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.063, 'compress@10': 0.584, 'time@10': 25.6067}:  20%|██        | 2/10 [00:37<02:36, 19.56s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0576, 'compress@10': 0.4131, 'time@10': 23.9622}:  20%|██        | 2/10 [00:47<02:36, 19.56s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0576, 'compress@10': 0.4131, 'time@10': 23.9622}:  30%|███       | 3/10 [00:47<01:47, 15.37s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0651, 'compress@10': 0.4782, 'time@10': 23.4938}:  30%|███       | 3/10 [01:09<01:47, 15.37s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0651, 'compress@10': 0.4782, 'time@10': 23.4938}:  40%|████      | 4/10 [01:09<01:48, 18.04s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0065, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0682, 'compress@10': 0.4356, 'time@10': 29.8395}:  40%|████      | 4/10 [01:37<01:48, 18.04s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0065, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0682, 'compress@10': 0.4356, 'time@10': 29.8395}:  50%|█████     | 5/10 [01:37<01:47, 21.50s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0072, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.069, 'compress@10': 0.5014, 'time@10': 30.2501}:  50%|█████     | 5/10 [02:09<01:47, 21.50s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0072, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.069, 'compress@10': 0.5014, 'time@10': 30.2501}:  60%|██████    | 6/10 [02:09<01:40, 25.19s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0073, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0691, 'compress@10': 0.4554, 'time@10': 31.0444}:  60%|██████    | 6/10 [02:27<01:40, 25.19s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0073, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0691, 'compress@10': 0.4554, 'time@10': 31.0444}:  70%|███████   | 7/10 [02:27<01:08, 22.82s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0078, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0744, 'compress@10': 0.4628, 'time@10': 30.4616}:  70%|███████   | 7/10 [02:54<01:08, 22.82s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0078, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0744, 'compress@10': 0.4628, 'time@10': 30.4616}:  80%|████████  | 8/10 [02:54<00:47, 23.97s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0093, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0751, 'compress@10': 0.5137, 'time@10': 31.423}:  80%|████████  | 8/10 [03:13<00:47, 23.97s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0093, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0751, 'compress@10': 0.5137, 'time@10': 31.423}:  90%|█████████ | 9/10 [03:13<00:22, 22.60s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0739, 'compress@10': 0.507, 'time@10': 31.6887}:  90%|█████████ | 9/10 [03:48<00:22, 22.60s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0739, 'compress@10': 0.507, 'time@10': 31.6887}: 100%|██████████| 10/10 [03:48<00:00, 26.15s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0739, 'compress@10': 0.507, 'time@10': 31.6887}: 100%|██████████| 10/10 [03:48<00:00, 22.80s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.009257247885132717
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0738787811683836
Avg compression ratio: 0.50701580980051
Avg train time: 31.68874020576477
Std train time: 9.78225381400321
[0.6555555555555553, 0.5, 0.03333333333333334, 0.6777777777777777, 0.25555555555555565, 0.8333333333333333, 0.16666666666666666, 0.5222222222222223, 0.9222222222222222, 0.43333333333333335]
[10, 10, 24, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0744, 'compress@10': 0.6603, 'time@10': 29.1134}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0744, 'compress@10': 0.6603, 'time@10': 29.1134}:  10%|█         | 1/10 [00:14<02:11, 14.59s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0697, 'compress@10': 0.5822, 'time@10': 26.3531}:  10%|█         | 1/10 [00:38<02:11, 14.59s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0697, 'compress@10': 0.5822, 'time@10': 26.3531}:  20%|██        | 2/10 [00:38<02:39, 19.91s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0621, 'compress@10': 0.4117, 'time@10': 24.3643}:  20%|██        | 2/10 [00:48<02:39, 19.91s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0621, 'compress@10': 0.4117, 'time@10': 24.3643}:  30%|███       | 3/10 [00:48<01:48, 15.49s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.065, 'compress@10': 0.479, 'time@10': 23.8034}:  30%|███       | 3/10 [01:10<01:48, 15.49s/it]  {'epoch': 44, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.065, 'compress@10': 0.479, 'time@10': 23.8034}:  40%|████      | 4/10 [01:10<01:48, 18.12s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0677, 'compress@10': 0.4351, 'time@10': 29.7556}:  40%|████      | 4/10 [01:37<01:48, 18.12s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0677, 'compress@10': 0.4351, 'time@10': 29.7556}:  50%|█████     | 5/10 [01:37<01:46, 21.26s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0683, 'compress@10': 0.5016, 'time@10': 30.1985}:  50%|█████     | 5/10 [02:09<01:46, 21.26s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0683, 'compress@10': 0.5016, 'time@10': 30.1985}:  60%|██████    | 6/10 [02:09<01:40, 25.06s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0685, 'compress@10': 0.455, 'time@10': 31.1282}:  60%|██████    | 6/10 [02:28<01:40, 25.06s/it] {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0685, 'compress@10': 0.455, 'time@10': 31.1282}:  70%|███████   | 7/10 [02:28<01:08, 22.88s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0725, 'compress@10': 0.4639, 'time@10': 30.5253}:  70%|███████   | 7/10 [02:54<01:08, 22.88s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0725, 'compress@10': 0.4639, 'time@10': 30.5253}:  80%|████████  | 8/10 [02:54<00:47, 23.99s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0097, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0726, 'compress@10': 0.5148, 'time@10': 31.4244}:  80%|████████  | 8/10 [03:14<00:47, 23.99s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0097, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0726, 'compress@10': 0.5148, 'time@10': 31.4244}:  90%|█████████ | 9/10 [03:14<00:22, 22.55s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0726, 'compress@10': 0.507, 'time@10': 31.6548}:  90%|█████████ | 9/10 [03:47<00:22, 22.55s/it]    {'epoch': 44, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0726, 'compress@10': 0.507, 'time@10': 31.6548}: 100%|██████████| 10/10 [03:47<00:00, 26.01s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0726, 'compress@10': 0.507, 'time@10': 31.6548}: 100%|██████████| 10/10 [03:47<00:00, 22.78s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.009595375876537596
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.072622384881116
Avg compression ratio: 0.5070240222413893
Avg train time: 31.654833173751832
Std train time: 9.363957568010619
[0.6630434782608694, 0.5108695652173914, 0.03260869565217392, 0.6630434782608695, 0.2500000000000001, 0.8369565217391304, 0.16304347826086957, 0.532608695652174, 0.9239130434782609, 0.42391304347826086]
[10, 10, 24, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0036, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0692, 'compress@10': 0.6677, 'time@10': 27.5836}:   0%|          | 0/10 [00:13<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0036, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0692, 'compress@10': 0.6677, 'time@10': 27.5836}:  10%|█         | 1/10 [00:13<02:04, 13.83s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.066, 'compress@10': 0.5913, 'time@10': 25.8955}:  10%|█         | 1/10 [00:38<02:04, 13.83s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.066, 'compress@10': 0.5913, 'time@10': 25.8955}:  20%|██        | 2/10 [00:38<02:39, 19.96s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0596, 'compress@10': 0.4175, 'time@10': 24.656}:  20%|██        | 2/10 [00:49<02:39, 19.96s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0596, 'compress@10': 0.4175, 'time@10': 24.656}:  30%|███       | 3/10 [00:49<01:51, 15.92s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0626, 'compress@10': 0.4797, 'time@10': 24.0551}:  30%|███       | 3/10 [01:11<01:51, 15.92s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0626, 'compress@10': 0.4797, 'time@10': 24.0551}:  40%|████      | 4/10 [01:11<01:50, 18.44s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0056, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0659, 'compress@10': 0.4345, 'time@10': 29.9527}:  40%|████      | 4/10 [01:38<01:50, 18.44s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0056, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0659, 'compress@10': 0.4345, 'time@10': 29.9527}:  50%|█████     | 5/10 [01:38<01:47, 21.46s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0051, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0666, 'compress@10': 0.5017, 'time@10': 30.3062}:  50%|█████     | 5/10 [02:10<01:47, 21.46s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0051, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0666, 'compress@10': 0.5017, 'time@10': 30.3062}:  60%|██████    | 6/10 [02:10<01:40, 25.08s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0052, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.067, 'compress@10': 0.4546, 'time@10': 31.1402}:  60%|██████    | 6/10 [02:28<01:40, 25.08s/it] {'epoch': 45, 'num_users': 6.2857, 'loss': 0.0052, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.067, 'compress@10': 0.4546, 'time@10': 31.1402}:  70%|███████   | 7/10 [02:28<01:08, 22.80s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0056, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.072, 'compress@10': 0.4648, 'time@10': 30.5185}:  70%|███████   | 7/10 [02:54<01:08, 22.80s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0056, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.072, 'compress@10': 0.4648, 'time@10': 30.5185}:  80%|████████  | 8/10 [02:54<00:47, 23.88s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.006, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.071, 'compress@10': 0.5159, 'time@10': 31.3214}:  80%|████████  | 8/10 [03:13<00:47, 23.88s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.006, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.071, 'compress@10': 0.5159, 'time@10': 31.3214}:  90%|█████████ | 9/10 [03:13<00:22, 22.33s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0063, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0709, 'compress@10': 0.507, 'time@10': 31.5626}:  90%|█████████ | 9/10 [03:47<00:22, 22.33s/it]  {'epoch': 45, 'num_users': 6.3, 'loss': 0.0063, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0709, 'compress@10': 0.507, 'time@10': 31.5626}: 100%|██████████| 10/10 [03:47<00:00, 25.86s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0063, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0709, 'compress@10': 0.507, 'time@10': 31.5626}: 100%|██████████| 10/10 [03:47<00:00, 22.74s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.006259716002027125
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0708910295963583
Avg compression ratio: 0.5070218230944222
Avg train time: 31.56255247592926
Std train time: 9.061590760955884
[0.6489361702127658, 0.5212765957446809, 0.03191489361702128, 0.6702127659574467, 0.2446808510638299, 0.8191489361702127, 0.1595744680851064, 0.5425531914893618, 0.925531914893617, 0.43617021276595747]
[10, 10, 24, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0752, 'compress@10': 0.6538, 'time@10': 27.3577}:   0%|          | 0/10 [00:13<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0752, 'compress@10': 0.6538, 'time@10': 27.3577}:  10%|█         | 1/10 [00:13<02:03, 13.73s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0688, 'compress@10': 0.5895, 'time@10': 25.5158}:  10%|█         | 1/10 [00:37<02:03, 13.73s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0688, 'compress@10': 0.5895, 'time@10': 25.5158}:  20%|██        | 2/10 [00:37<02:36, 19.60s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0615, 'compress@10': 0.4161, 'time@10': 24.542}:  20%|██        | 2/10 [00:48<02:36, 19.60s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0615, 'compress@10': 0.4161, 'time@10': 24.542}:  30%|███       | 3/10 [00:48<01:50, 15.82s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0652, 'compress@10': 0.4804, 'time@10': 23.9969}:  30%|███       | 3/10 [01:11<01:50, 15.82s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0652, 'compress@10': 0.4804, 'time@10': 23.9969}:  40%|████      | 4/10 [01:11<01:50, 18.42s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0678, 'compress@10': 0.434, 'time@10': 29.8716}:  40%|████      | 4/10 [01:37<01:50, 18.42s/it] {'epoch': 46, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0678, 'compress@10': 0.434, 'time@10': 29.8716}:  50%|█████     | 5/10 [01:37<01:47, 21.42s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0073, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0688, 'compress@10': 0.4984, 'time@10': 30.4186}:  50%|█████     | 5/10 [02:11<01:47, 21.42s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0073, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0688, 'compress@10': 0.4984, 'time@10': 30.4186}:  60%|██████    | 6/10 [02:11<01:41, 25.42s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0073, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0689, 'compress@10': 0.4513, 'time@10': 31.1245}:  60%|██████    | 6/10 [02:28<01:41, 25.42s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0073, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0689, 'compress@10': 0.4513, 'time@10': 31.1245}:  70%|███████   | 7/10 [02:28<01:08, 22.90s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0073, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0737, 'compress@10': 0.4631, 'time@10': 30.5782}:  70%|███████   | 7/10 [02:55<01:08, 22.90s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0073, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0737, 'compress@10': 0.4631, 'time@10': 30.5782}:  80%|████████  | 8/10 [02:55<00:48, 24.14s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0081, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0729, 'compress@10': 0.5145, 'time@10': 31.3691}:  80%|████████  | 8/10 [03:14<00:48, 24.14s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0081, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0729, 'compress@10': 0.5145, 'time@10': 31.3691}:  90%|█████████ | 9/10 [03:14<00:22, 22.50s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0081, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0726, 'compress@10': 0.507, 'time@10': 31.5849}:  90%|█████████ | 9/10 [03:48<00:22, 22.50s/it]    {'epoch': 46, 'num_users': 6.3, 'loss': 0.0081, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0726, 'compress@10': 0.507, 'time@10': 31.5849}: 100%|██████████| 10/10 [03:48<00:00, 25.91s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0081, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0726, 'compress@10': 0.507, 'time@10': 31.5849}: 100%|██████████| 10/10 [03:48<00:00, 22.80s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.008148925681243941
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0726465708414261
Avg compression ratio: 0.5070312246374648
Avg train time: 31.584874534606932
Std train time: 8.956125782785637
[0.6562499999999999, 0.53125, 0.03125000000000001, 0.6770833333333333, 0.23958333333333343, 0.8020833333333333, 0.15625, 0.5312500000000001, 0.9270833333333333, 0.4479166666666667]
[10, 10, 24, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0038, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0705, 'compress@10': 0.661, 'time@10': 28.1927}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0038, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0705, 'compress@10': 0.661, 'time@10': 28.1927}:  10%|█         | 1/10 [00:14<02:07, 14.13s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0666, 'compress@10': 0.5981, 'time@10': 25.9684}:  10%|█         | 1/10 [00:37<02:07, 14.13s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0666, 'compress@10': 0.5981, 'time@10': 25.9684}:  20%|██        | 2/10 [00:37<02:38, 19.81s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.06, 'compress@10': 0.4216, 'time@10': 24.3277}:  20%|██        | 2/10 [00:48<02:38, 19.81s/it]   {'epoch': 47, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.06, 'compress@10': 0.4216, 'time@10': 24.3277}:  30%|███       | 3/10 [00:48<01:49, 15.58s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.063, 'compress@10': 0.4862, 'time@10': 23.7714}:  30%|███       | 3/10 [01:10<01:49, 15.58s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.063, 'compress@10': 0.4862, 'time@10': 23.7714}:  40%|████      | 4/10 [01:10<01:49, 18.18s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0055, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.066, 'compress@10': 0.4377, 'time@10': 29.618}:  40%|████      | 4/10 [01:37<01:49, 18.18s/it] {'epoch': 47, 'num_users': 5.8, 'loss': 0.0055, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.066, 'compress@10': 0.4377, 'time@10': 29.618}:  50%|█████     | 5/10 [01:37<01:45, 21.19s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0061, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0669, 'compress@10': 0.4986, 'time@10': 30.0599}:  50%|█████     | 5/10 [02:09<01:45, 21.19s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0061, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0669, 'compress@10': 0.4986, 'time@10': 30.0599}:  60%|██████    | 6/10 [02:09<01:39, 24.97s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0061, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0673, 'compress@10': 0.451, 'time@10': 30.8806}:  60%|██████    | 6/10 [02:27<01:39, 24.97s/it] {'epoch': 47, 'num_users': 6.2857, 'loss': 0.0061, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0673, 'compress@10': 0.451, 'time@10': 30.8806}:  70%|███████   | 7/10 [02:27<01:08, 22.67s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0064, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0719, 'compress@10': 0.4614, 'time@10': 30.3012}:  70%|███████   | 7/10 [02:53<01:08, 22.67s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0064, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0719, 'compress@10': 0.4614, 'time@10': 30.3012}:  80%|████████  | 8/10 [02:53<00:47, 23.82s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0069, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0733, 'compress@10': 0.5132, 'time@10': 31.2483}:  80%|████████  | 8/10 [03:13<00:47, 23.82s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0069, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0733, 'compress@10': 0.5132, 'time@10': 31.2483}:  90%|█████████ | 9/10 [03:13<00:22, 22.45s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.007, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0725, 'compress@10': 0.507, 'time@10': 31.487}:  90%|█████████ | 9/10 [03:46<00:22, 22.45s/it]      {'epoch': 47, 'num_users': 6.3, 'loss': 0.007, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0725, 'compress@10': 0.507, 'time@10': 31.487}: 100%|██████████| 10/10 [03:46<00:00, 25.92s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.007, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0725, 'compress@10': 0.507, 'time@10': 31.487}: 100%|██████████| 10/10 [03:46<00:00, 22.68s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.0070084029584173615
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0724945165539301
Avg compression ratio: 0.5070214501403341
Avg train time: 31.486962175369264
Std train time: 9.143678759384748
[0.6428571428571428, 0.5408163265306123, 0.03061224489795919, 0.6836734693877551, 0.2346938775510205, 0.8061224489795917, 0.15306122448979592, 0.5408163265306124, 0.9285714285714285, 0.4387755102040817]
[10, 10, 24, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0749, 'compress@10': 0.6478, 'time@10': 28.0536}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0749, 'compress@10': 0.6478, 'time@10': 28.0536}:  10%|█         | 1/10 [00:14<02:06, 14.06s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0687, 'compress@10': 0.5962, 'time@10': 25.6259}:  10%|█         | 1/10 [00:37<02:06, 14.06s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0687, 'compress@10': 0.5962, 'time@10': 25.6259}:  20%|██        | 2/10 [00:37<02:35, 19.46s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0614, 'compress@10': 0.4201, 'time@10': 24.4046}:  20%|██        | 2/10 [00:48<02:35, 19.46s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0614, 'compress@10': 0.4201, 'time@10': 24.4046}:  30%|███       | 3/10 [00:48<01:49, 15.61s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0645, 'compress@10': 0.4868, 'time@10': 24.0358}:  30%|███       | 3/10 [01:11<01:49, 15.61s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0645, 'compress@10': 0.4868, 'time@10': 24.0358}:  40%|████      | 4/10 [01:11<01:51, 18.51s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0672, 'compress@10': 0.4371, 'time@10': 29.9889}:  40%|████      | 4/10 [01:38<01:51, 18.51s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0672, 'compress@10': 0.4371, 'time@10': 29.9889}:  50%|█████     | 5/10 [01:38<01:47, 21.56s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0679, 'compress@10': 0.4988, 'time@10': 30.4575}:  50%|█████     | 5/10 [02:11<01:47, 21.56s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0679, 'compress@10': 0.4988, 'time@10': 30.4575}:  60%|██████    | 6/10 [02:11<01:41, 25.39s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0081, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0682, 'compress@10': 0.4507, 'time@10': 31.2506}:  60%|██████    | 6/10 [02:29<01:41, 25.39s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0081, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0682, 'compress@10': 0.4507, 'time@10': 31.2506}:  70%|███████   | 7/10 [02:29<01:08, 22.99s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0086, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0733, 'compress@10': 0.4624, 'time@10': 30.6722}:  70%|███████   | 7/10 [02:55<01:08, 22.99s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0086, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0733, 'compress@10': 0.4624, 'time@10': 30.6722}:  80%|████████  | 8/10 [02:55<00:48, 24.16s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0086, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0724, 'compress@10': 0.5143, 'time@10': 31.5361}:  80%|████████  | 8/10 [03:15<00:48, 24.16s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0086, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0724, 'compress@10': 0.5143, 'time@10': 31.5361}:  90%|█████████ | 9/10 [03:15<00:22, 22.63s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0721, 'compress@10': 0.507, 'time@10': 31.6968}:  90%|█████████ | 9/10 [03:48<00:22, 22.63s/it]    {'epoch': 48, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0721, 'compress@10': 0.507, 'time@10': 31.6968}: 100%|██████████| 10/10 [03:48<00:00, 25.89s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0721, 'compress@10': 0.507, 'time@10': 31.6968}: 100%|██████████| 10/10 [03:48<00:00, 22.82s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.008562899904923139
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.0721303169919416
Avg compression ratio: 0.5070319309452798
Avg train time: 31.696849632263184
Std train time: 9.159500321365522
[0.6499999999999999, 0.55, 0.030000000000000006, 0.69, 0.2300000000000001, 0.8099999999999999, 0.15, 0.5500000000000002, 0.9099999999999999, 0.43000000000000005]
[10, 10, 24, 11, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0039, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0719, 'compress@10': 0.6549, 'time@10': 27.67}:   0%|          | 0/10 [00:13<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0039, 'hit_ratio@10': 0.9861, 'ndcg@10': 1.0719, 'compress@10': 0.6549, 'time@10': 27.67}:  10%|█         | 1/10 [00:13<02:04, 13.87s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0685, 'compress@10': 0.6043, 'time@10': 25.7301}:  10%|█         | 1/10 [00:37<02:04, 13.87s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.9889, 'ndcg@10': 1.0685, 'compress@10': 0.6043, 'time@10': 25.7301}:  20%|██        | 2/10 [00:37<02:37, 19.73s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0613, 'compress@10': 0.4253, 'time@10': 24.3029}:  20%|██        | 2/10 [00:48<02:37, 19.73s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.9798, 'ndcg@10': 1.0613, 'compress@10': 0.4253, 'time@10': 24.3029}:  30%|███       | 3/10 [00:48<01:49, 15.63s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0642, 'compress@10': 0.4922, 'time@10': 23.7968}:  30%|███       | 3/10 [01:10<01:49, 15.63s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.9824, 'ndcg@10': 1.0642, 'compress@10': 0.4922, 'time@10': 23.7968}:  40%|████      | 4/10 [01:10<01:49, 18.33s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0055, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0668, 'compress@10': 0.4406, 'time@10': 29.6437}:  40%|████      | 4/10 [01:37<01:49, 18.33s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0055, 'hit_ratio@10': 0.9849, 'ndcg@10': 1.0668, 'compress@10': 0.4406, 'time@10': 29.6437}:  50%|█████     | 5/10 [01:37<01:46, 21.29s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0059, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0675, 'compress@10': 0.5023, 'time@10': 30.1514}:  50%|█████     | 5/10 [02:10<01:46, 21.29s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0059, 'hit_ratio@10': 0.9865, 'ndcg@10': 1.0675, 'compress@10': 0.5023, 'time@10': 30.1514}:  60%|██████    | 6/10 [02:10<01:40, 25.18s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.006, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0678, 'compress@10': 0.4533, 'time@10': 30.9705}:  60%|██████    | 6/10 [02:28<01:40, 25.18s/it] {'epoch': 49, 'num_users': 6.2857, 'loss': 0.006, 'hit_ratio@10': 0.9869, 'ndcg@10': 1.0678, 'compress@10': 0.4533, 'time@10': 30.9705}:  70%|███████   | 7/10 [02:28<01:08, 22.83s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0063, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0729, 'compress@10': 0.4658, 'time@10': 30.3991}:  70%|███████   | 7/10 [02:54<01:08, 22.83s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0063, 'hit_ratio@10': 0.9876, 'ndcg@10': 1.0729, 'compress@10': 0.4658, 'time@10': 30.3991}:  80%|████████  | 8/10 [02:54<00:47, 23.98s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.007, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0719, 'compress@10': 0.5152, 'time@10': 31.5172}:  80%|████████  | 8/10 [03:14<00:47, 23.98s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.007, 'hit_ratio@10': 0.9882, 'ndcg@10': 1.0719, 'compress@10': 0.5152, 'time@10': 31.5172}:  90%|█████████ | 9/10 [03:14<00:22, 22.82s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0071, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0716, 'compress@10': 0.507, 'time@10': 31.725}:  90%|█████████ | 9/10 [03:48<00:22, 22.82s/it]    {'epoch': 49, 'num_users': 6.3, 'loss': 0.0071, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0716, 'compress@10': 0.507, 'time@10': 31.725}: 100%|██████████| 10/10 [03:48<00:00, 26.16s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0071, 'hit_ratio@10': 0.9888, 'ndcg@10': 1.0716, 'compress@10': 0.507, 'time@10': 31.725}: 100%|██████████| 10/10 [03:48<00:00, 22.85s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.007083648406746244
Avg hit ratio: 0.9887532674922724
Avg ndcg: 1.071590317539915
Avg compression ratio: 0.5070269171275015
Avg train time: 31.725022649765016
Std train time: 9.244612073122008
[0.6372549019607843, 0.5588235294117647, 0.02941176470588236, 0.696078431372549, 0.22549019607843146, 0.8137254901960784, 0.14705882352941177, 0.5588235294117648, 0.9117647058823528, 0.42156862745098045]
[10, 10, 24, 11, 7, 10, 10, 10, 9, 10]
