  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.866, 'compress@10': 0.5263, 'time@10': 44.8901}:   0%|          | 0/10 [00:22<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.866, 'compress@10': 0.5263, 'time@10': 44.8901}:  10%|█         | 1/10 [00:22<03:22, 22.49s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0339, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8796, 'compress@10': 0.5212, 'time@10': 40.4444}:  10%|█         | 1/10 [00:58<03:22, 22.49s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0339, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8796, 'compress@10': 0.5212, 'time@10': 40.4444}:  20%|██        | 2/10 [00:58<04:03, 30.46s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8721, 'compress@10': 0.538, 'time@10': 31.5941}:  20%|██        | 2/10 [01:05<04:03, 30.46s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8721, 'compress@10': 0.538, 'time@10': 31.5941}:  30%|███       | 3/10 [01:05<02:18, 19.74s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8795, 'compress@10': 0.5329, 'time@10': 31.6916}:  30%|███       | 3/10 [01:37<02:18, 19.74s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8795, 'compress@10': 0.5329, 'time@10': 31.6916}:  40%|████      | 4/10 [01:37<02:27, 24.59s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.0246, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8808, 'compress@10': 0.5283, 'time@10': 49.0439}:  40%|████      | 4/10 [02:36<02:27, 24.59s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.0246, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8808, 'compress@10': 0.5283, 'time@10': 49.0439}:  50%|█████     | 5/10 [02:36<03:05, 37.09s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.0256, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.881, 'compress@10': 0.5255, 'time@10': 49.7657}:  50%|█████     | 5/10 [03:30<03:05, 37.09s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.0256, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.881, 'compress@10': 0.5255, 'time@10': 49.7657}:  60%|██████    | 6/10 [03:30<02:50, 42.64s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.0262, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.8835, 'compress@10': 0.5247, 'time@10': 50.904}:  60%|██████    | 6/10 [03:59<02:50, 42.64s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.0262, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.8835, 'compress@10': 0.5247, 'time@10': 50.904}:  70%|███████   | 7/10 [03:59<01:54, 38.15s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.0262, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.8851, 'compress@10': 0.5234, 'time@10': 49.635}:  70%|███████   | 7/10 [04:39<01:54, 38.15s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.0262, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.8851, 'compress@10': 0.5234, 'time@10': 49.635}:  80%|████████  | 8/10 [04:39<01:17, 38.99s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.0257, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.8896, 'compress@10': 0.5224, 'time@10': 53.1975}:  80%|████████  | 8/10 [05:20<01:17, 38.99s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.0257, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.8896, 'compress@10': 0.5224, 'time@10': 53.1975}:  90%|█████████ | 9/10 [05:20<00:39, 39.59s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.0249, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.8933, 'compress@10': 0.5213, 'time@10': 53.1379}:  90%|█████████ | 9/10 [06:13<00:39, 39.59s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.0249, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.8933, 'compress@10': 0.5213, 'time@10': 53.1379}: 100%|██████████| 10/10 [06:13<00:00, 43.62s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.0249, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.8933, 'compress@10': 0.5213, 'time@10': 53.1379}: 100%|██████████| 10/10 [06:13<00:00, 37.35s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.024859644018591236
Avg hit ratio: 0.9014828150532737
Avg ndcg: 0.8933175016324114
Avg compression ratio: 0.5212749006657823
Avg train time: 53.13785817623138
Std train time: 27.578935451303643
[0.75, 0.75, 0.25, 0.25, 0.75, 0.75, 0.75, 0.25, 0.25, 0.25]
[50, 50, 51, 50, 49, 50, 50, 50, 49, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8834, 'compress@10': 0.7632, 'time@10': 43.7372}:   0%|          | 0/10 [00:21<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8834, 'compress@10': 0.7632, 'time@10': 43.7372}:  10%|█         | 1/10 [00:21<03:17, 21.91s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9066, 'compress@10': 0.7606, 'time@10': 40.1034}:  10%|█         | 1/10 [00:58<03:17, 21.91s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9066, 'compress@10': 0.7606, 'time@10': 40.1034}:  20%|██        | 2/10 [00:58<04:03, 30.50s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8901, 'compress@10': 0.6261, 'time@10': 31.3662}:  20%|██        | 2/10 [01:05<04:03, 30.50s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8901, 'compress@10': 0.6261, 'time@10': 31.3662}:  30%|███       | 3/10 [01:05<02:18, 19.76s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9034, 'compress@10': 0.5388, 'time@10': 31.4598}:  30%|███       | 3/10 [01:37<02:18, 19.76s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9034, 'compress@10': 0.5388, 'time@10': 31.4598}:  40%|████      | 4/10 [01:37<02:27, 24.50s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.9079, 'compress@10': 0.582, 'time@10': 48.2526}:  40%|████      | 4/10 [02:34<02:27, 24.50s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.9079, 'compress@10': 0.582, 'time@10': 48.2526}:  50%|█████     | 5/10 [02:34<03:02, 36.49s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0156, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9112, 'compress@10': 0.6109, 'time@10': 48.9504}:  50%|█████     | 5/10 [03:27<03:02, 36.49s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0156, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9112, 'compress@10': 0.6109, 'time@10': 48.9504}:  60%|██████    | 6/10 [03:27<02:47, 41.93s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0161, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9144, 'compress@10': 0.6322, 'time@10': 50.307}:  60%|██████    | 6/10 [03:56<02:47, 41.93s/it] {'epoch': 1, 'num_users': 6.2857, 'loss': 0.0161, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9144, 'compress@10': 0.6322, 'time@10': 50.307}:  70%|███████   | 7/10 [03:56<01:53, 37.79s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0169, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9113, 'compress@10': 0.5871, 'time@10': 49.0993}:  70%|███████   | 7/10 [04:37<01:53, 37.79s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0169, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9113, 'compress@10': 0.5871, 'time@10': 49.0993}:  80%|████████  | 8/10 [04:37<01:17, 38.71s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9164, 'compress@10': 0.5521, 'time@10': 52.7232}:  80%|████████  | 8/10 [05:18<01:17, 38.71s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9164, 'compress@10': 0.5521, 'time@10': 52.7232}:  90%|█████████ | 9/10 [05:18<00:39, 39.40s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9208, 'compress@10': 0.5236, 'time@10': 52.5407}:  90%|█████████ | 9/10 [06:09<00:39, 39.40s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9208, 'compress@10': 0.5236, 'time@10': 52.5407}: 100%|██████████| 10/10 [06:09<00:00, 42.96s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9208, 'compress@10': 0.5236, 'time@10': 52.5407}: 100%|██████████| 10/10 [06:09<00:00, 36.92s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.01729165999199789
Avg hit ratio: 0.8955071794834104
Avg ndcg: 0.92080755817243
Avg compression ratio: 0.5235581019838685
Avg train time: 52.54067256450653
Std train time: 26.91964129607204
[0.8333333333333334, 0.5, 0.16666666666666669, 0.5, 0.5, 0.5, 0.8333333333333334, 0.5, 0.5, 0.16666666666666669]
[50, 50, 52, 50, 48, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0256, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8876, 'compress@10': 0.8421, 'time@10': 42.3213}:   0%|          | 0/10 [00:21<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0256, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8876, 'compress@10': 0.8421, 'time@10': 42.3213}:  10%|█         | 1/10 [00:21<03:10, 21.20s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9226, 'compress@10': 0.6791, 'time@10': 39.1843}:  10%|█         | 1/10 [00:57<03:10, 21.20s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9226, 'compress@10': 0.6791, 'time@10': 39.1843}:  20%|██        | 2/10 [00:57<03:59, 29.95s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.9008, 'compress@10': 0.548, 'time@10': 31.1619}:  20%|██        | 2/10 [01:04<03:59, 29.95s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.9008, 'compress@10': 0.548, 'time@10': 31.1619}:  30%|███       | 3/10 [01:04<02:18, 19.76s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9137, 'compress@10': 0.5404, 'time@10': 31.3887}:  30%|███       | 3/10 [01:37<02:18, 19.76s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9137, 'compress@10': 0.5404, 'time@10': 31.3887}:  40%|████      | 4/10 [01:37<02:27, 24.63s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9227, 'compress@10': 0.5344, 'time@10': 47.9144}:  40%|████      | 4/10 [02:34<02:27, 24.63s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9227, 'compress@10': 0.5344, 'time@10': 47.9144}:  50%|█████     | 5/10 [02:34<03:01, 36.32s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9292, 'compress@10': 0.5305, 'time@10': 48.8487}:  50%|█████     | 5/10 [03:27<03:01, 36.32s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9292, 'compress@10': 0.5305, 'time@10': 48.8487}:  60%|██████    | 6/10 [03:27<02:48, 42.18s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0121, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9275, 'compress@10': 0.5747, 'time@10': 49.8829}:  60%|██████    | 6/10 [03:55<02:48, 42.18s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0121, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9275, 'compress@10': 0.5747, 'time@10': 49.8829}:  70%|███████   | 7/10 [03:55<01:52, 37.57s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9301, 'compress@10': 0.5671, 'time@10': 48.7101}:  70%|███████   | 7/10 [04:36<01:52, 37.57s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9301, 'compress@10': 0.5671, 'time@10': 48.7101}:  80%|████████  | 8/10 [04:36<01:17, 38.52s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9329, 'compress@10': 0.5613, 'time@10': 51.9486}:  80%|████████  | 8/10 [05:15<01:17, 38.52s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9329, 'compress@10': 0.5613, 'time@10': 51.9486}:  90%|█████████ | 9/10 [05:15<00:38, 38.66s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.937, 'compress@10': 0.5237, 'time@10': 51.8202}:  90%|█████████ | 9/10 [06:05<00:38, 38.66s/it]     {'epoch': 2, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.937, 'compress@10': 0.5237, 'time@10': 51.8202}: 100%|██████████| 10/10 [06:05<00:00, 42.38s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.937, 'compress@10': 0.5237, 'time@10': 51.8202}: 100%|██████████| 10/10 [06:05<00:00, 36.59s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.011957038048017283
Avg hit ratio: 0.9003643223405533
Avg ndcg: 0.9370435273926875
Avg compression ratio: 0.5237064420641027
Avg train time: 51.82017636299133
Std train time: 26.025335186709686
[0.875, 0.625, 0.125, 0.375, 0.375, 0.625, 0.875, 0.625, 0.375, 0.125]
[50, 50, 53, 50, 47, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9008, 'compress@10': 0.8816, 'time@10': 38.9411}:   0%|          | 0/10 [00:19<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9008, 'compress@10': 0.8816, 'time@10': 38.9411}:  10%|█         | 1/10 [00:19<02:55, 19.51s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9306, 'compress@10': 0.7593, 'time@10': 37.2513}:  10%|█         | 1/10 [00:55<02:55, 19.51s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9306, 'compress@10': 0.7593, 'time@10': 37.2513}:  20%|██        | 2/10 [00:55<03:51, 28.98s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9061, 'compress@10': 0.5896, 'time@10': 29.7449}:  20%|██        | 2/10 [01:02<03:51, 28.98s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9061, 'compress@10': 0.5896, 'time@10': 29.7449}:  30%|███       | 3/10 [01:02<02:13, 19.13s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9197, 'compress@10': 0.5415, 'time@10': 30.4096}:  30%|███       | 3/10 [01:34<02:13, 19.13s/it]  {'epoch': 3, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9197, 'compress@10': 0.5415, 'time@10': 30.4096}:  40%|████      | 4/10 [01:34<02:26, 24.38s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9301, 'compress@10': 0.5107, 'time@10': 46.4673}:  40%|████      | 4/10 [02:30<02:26, 24.38s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9301, 'compress@10': 0.5107, 'time@10': 46.4673}:  50%|█████     | 5/10 [02:30<02:57, 35.56s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9371, 'compress@10': 0.5311, 'time@10': 47.592}:  50%|█████     | 5/10 [03:23<02:57, 35.56s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9371, 'compress@10': 0.5311, 'time@10': 47.592}:  60%|██████    | 6/10 [03:23<02:46, 41.58s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9387, 'compress@10': 0.581, 'time@10': 48.1574}:  60%|██████    | 6/10 [03:49<02:46, 41.58s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9387, 'compress@10': 0.581, 'time@10': 48.1574}:  70%|███████   | 7/10 [03:49<01:49, 36.42s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.941, 'compress@10': 0.5878, 'time@10': 47.1589}:  70%|███████   | 7/10 [04:29<01:49, 36.42s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.941, 'compress@10': 0.5878, 'time@10': 47.1589}:  80%|████████  | 8/10 [04:29<01:15, 37.63s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0097, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9427, 'compress@10': 0.5662, 'time@10': 50.5808}:  80%|████████  | 8/10 [05:08<01:15, 37.63s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0097, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9427, 'compress@10': 0.5662, 'time@10': 50.5808}:  90%|█████████ | 9/10 [05:08<00:38, 38.06s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9475, 'compress@10': 0.524, 'time@10': 50.4787}:  90%|█████████ | 9/10 [05:58<00:38, 38.06s/it]    {'epoch': 3, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9475, 'compress@10': 0.524, 'time@10': 50.4787}: 100%|██████████| 10/10 [05:58<00:00, 41.62s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9475, 'compress@10': 0.524, 'time@10': 50.4787}: 100%|██████████| 10/10 [05:58<00:00, 35.82s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.009628656256056559
Avg hit ratio: 0.8871727681863506
Avg ndcg: 0.9474718589704894
Avg compression ratio: 0.5240260062914842
Avg train time: 50.478654098510745
Std train time: 25.411354130651386
[0.9, 0.7, 0.1, 0.5, 0.3, 0.7, 0.7, 0.7, 0.3, 0.1]
[50, 50, 54, 50, 46, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9206, 'compress@10': 0.9052, 'time@10': 37.9706}:   0%|          | 0/10 [00:19<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9206, 'compress@10': 0.9052, 'time@10': 37.9706}:  10%|█         | 1/10 [00:19<02:51, 19.02s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9423, 'compress@10': 0.8075, 'time@10': 36.6096}:  10%|█         | 1/10 [00:54<02:51, 19.02s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9423, 'compress@10': 0.8075, 'time@10': 36.6096}:  20%|██        | 2/10 [00:54<03:48, 28.59s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9139, 'compress@10': 0.6145, 'time@10': 29.138}:  20%|██        | 2/10 [01:01<03:48, 28.59s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9139, 'compress@10': 0.6145, 'time@10': 29.138}:  30%|███       | 3/10 [01:01<02:11, 18.80s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9244, 'compress@10': 0.5903, 'time@10': 29.9561}:  30%|███       | 3/10 [01:33<02:11, 18.80s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9244, 'compress@10': 0.5903, 'time@10': 29.9561}:  40%|████      | 4/10 [01:33<02:25, 24.19s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0058, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9353, 'compress@10': 0.5351, 'time@10': 44.9958}:  40%|████      | 4/10 [02:26<02:25, 24.19s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0058, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9353, 'compress@10': 0.5351, 'time@10': 44.9958}:  50%|█████     | 5/10 [02:26<02:52, 34.44s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0073, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9409, 'compress@10': 0.5637, 'time@10': 46.1233}:  50%|█████     | 5/10 [03:18<02:52, 34.44s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0073, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9409, 'compress@10': 0.5637, 'time@10': 46.1233}:  60%|██████    | 6/10 [03:18<02:41, 40.34s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9429, 'compress@10': 0.5849, 'time@10': 47.6734}:  60%|██████    | 6/10 [03:47<02:41, 40.34s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9429, 'compress@10': 0.5849, 'time@10': 47.6734}:  70%|███████   | 7/10 [03:47<01:49, 36.59s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0081, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9457, 'compress@10': 0.6003, 'time@10': 46.6821}:  70%|███████   | 7/10 [04:26<01:49, 36.59s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0081, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9457, 'compress@10': 0.6003, 'time@10': 46.6821}:  80%|████████  | 8/10 [04:26<01:15, 37.60s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0077, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9479, 'compress@10': 0.5692, 'time@10': 50.1204}:  80%|████████  | 8/10 [05:05<01:15, 37.60s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0077, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9479, 'compress@10': 0.5692, 'time@10': 50.1204}:  90%|█████████ | 9/10 [05:05<00:37, 37.99s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0078, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9509, 'compress@10': 0.5243, 'time@10': 49.9614}:  90%|█████████ | 9/10 [05:54<00:37, 37.99s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0078, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9509, 'compress@10': 0.5243, 'time@10': 49.9614}: 100%|██████████| 10/10 [05:54<00:00, 41.26s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0078, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9509, 'compress@10': 0.5243, 'time@10': 49.9614}: 100%|██████████| 10/10 [05:54<00:00, 35.44s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.007822940760490308
Avg hit ratio: 0.9051200288110305
Avg ndcg: 0.9508563696224968
Avg compression ratio: 0.5243031004452805
Avg train time: 49.961420559883116
Std train time: 24.327122436516948
[0.75, 0.5833333333333333, 0.08333333333333334, 0.5833333333333334, 0.25, 0.75, 0.75, 0.75, 0.25, 0.25]
[50, 50, 55, 50, 45, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9333, 'compress@10': 0.7632, 'time@10': 41.2891}:   0%|          | 0/10 [00:20<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9333, 'compress@10': 0.7632, 'time@10': 41.2891}:  10%|█         | 1/10 [00:20<03:06, 20.68s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9487, 'compress@10': 0.68, 'time@10': 38.1341}:  10%|█         | 1/10 [00:55<03:06, 20.68s/it]   {'epoch': 5, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9487, 'compress@10': 0.68, 'time@10': 38.1341}:  20%|██        | 2/10 [00:55<03:52, 29.11s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9182, 'compress@10': 0.5247, 'time@10': 30.2208}:  20%|██        | 2/10 [01:02<03:52, 29.11s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9182, 'compress@10': 0.5247, 'time@10': 30.2208}:  30%|███       | 3/10 [01:02<02:13, 19.13s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9288, 'compress@10': 0.5431, 'time@10': 30.6064}:  30%|███       | 3/10 [01:34<02:13, 19.13s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9288, 'compress@10': 0.5431, 'time@10': 30.6064}:  40%|████      | 4/10 [01:34<02:24, 24.13s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0063, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9385, 'compress@10': 0.4875, 'time@10': 44.6235}:  40%|████      | 4/10 [02:25<02:24, 24.13s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0063, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9385, 'compress@10': 0.4875, 'time@10': 44.6235}:  50%|█████     | 5/10 [02:25<02:48, 33.60s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0065, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9453, 'compress@10': 0.5322, 'time@10': 45.6735}:  50%|█████     | 5/10 [03:16<02:48, 33.60s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0065, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9453, 'compress@10': 0.5322, 'time@10': 45.6735}:  60%|██████    | 6/10 [03:16<02:38, 39.50s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.9076, 'ndcg@10': 0.9473, 'compress@10': 0.5647, 'time@10': 47.0123}:  60%|██████    | 6/10 [03:43<02:38, 39.50s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.9076, 'ndcg@10': 0.9473, 'compress@10': 0.5647, 'time@10': 47.0123}:  70%|███████   | 7/10 [03:43<01:46, 35.60s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0068, 'hit_ratio@10': 0.9156, 'ndcg@10': 0.9503, 'compress@10': 0.5888, 'time@10': 45.9886}:  70%|███████   | 7/10 [04:22<01:46, 35.60s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0068, 'hit_ratio@10': 0.9156, 'ndcg@10': 0.9503, 'compress@10': 0.5888, 'time@10': 45.9886}:  80%|████████  | 8/10 [04:22<01:13, 36.64s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0062, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9523, 'compress@10': 0.5535, 'time@10': 49.1389}:  80%|████████  | 8/10 [04:59<01:13, 36.64s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0062, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9523, 'compress@10': 0.5535, 'time@10': 49.1389}:  90%|█████████ | 9/10 [04:59<00:36, 36.82s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9625, 'compress@10': 0.5249, 'time@10': 49.1539}:  90%|█████████ | 9/10 [05:49<00:36, 36.82s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9625, 'compress@10': 0.5249, 'time@10': 49.1539}: 100%|██████████| 10/10 [05:49<00:00, 40.68s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9625, 'compress@10': 0.5249, 'time@10': 49.1539}: 100%|██████████| 10/10 [05:49<00:00, 34.91s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.00924799222520658
Avg hit ratio: 0.9073422510332527
Avg ndcg: 0.9624862985465192
Avg compression ratio: 0.5248586845930986
Avg train time: 49.153901314735414
Std train time: 22.822381794184793
[0.7857142857142857, 0.6428571428571428, 0.07142857142857144, 0.6428571428571429, 0.2142857142857143, 0.6428571428571429, 0.7857142857142857, 0.6428571428571429, 0.2142857142857143, 0.35714285714285715]
[50, 50, 56, 50, 44, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9328, 'compress@10': 0.797, 'time@10': 39.8534}:   0%|          | 0/10 [00:19<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9328, 'compress@10': 0.797, 'time@10': 39.8534}:  10%|█         | 1/10 [00:19<02:59, 19.96s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9497, 'compress@10': 0.7257, 'time@10': 37.3554}:  10%|█         | 1/10 [00:54<02:59, 19.96s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9497, 'compress@10': 0.7257, 'time@10': 37.3554}:  20%|██        | 2/10 [00:54<03:50, 28.76s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9188, 'compress@10': 0.5518, 'time@10': 29.601}:  20%|██        | 2/10 [01:01<03:50, 28.76s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9188, 'compress@10': 0.5518, 'time@10': 29.601}:  30%|███       | 3/10 [01:01<02:12, 18.86s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9297, 'compress@10': 0.5778, 'time@10': 29.9834}:  30%|███       | 3/10 [01:33<02:12, 18.86s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9297, 'compress@10': 0.5778, 'time@10': 29.9834}:  40%|████      | 4/10 [01:33<02:22, 23.72s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0068, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9398, 'compress@10': 0.5082, 'time@10': 43.5055}:  40%|████      | 4/10 [02:21<02:22, 23.72s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0068, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9398, 'compress@10': 0.5082, 'time@10': 43.5055}:  50%|█████     | 5/10 [02:21<02:43, 32.78s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.881, 'ndcg@10': 0.946, 'compress@10': 0.532, 'time@10': 44.8179}:  50%|█████     | 5/10 [03:13<02:43, 32.78s/it] {'epoch': 6, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.881, 'ndcg@10': 0.946, 'compress@10': 0.532, 'time@10': 44.8179}:  60%|██████    | 6/10 [03:13<02:36, 39.11s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0074, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9479, 'compress@10': 0.5694, 'time@10': 46.1392}:  60%|██████    | 6/10 [03:40<02:36, 39.11s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0074, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9479, 'compress@10': 0.5694, 'time@10': 46.1392}:  70%|███████   | 7/10 [03:40<01:45, 35.18s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.008, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9569, 'compress@10': 0.5799, 'time@10': 45.243}:  70%|███████   | 7/10 [04:19<01:45, 35.18s/it]   {'epoch': 6, 'num_users': 6.125, 'loss': 0.008, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9569, 'compress@10': 0.5799, 'time@10': 45.243}:  80%|████████  | 8/10 [04:19<01:12, 36.40s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0073, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9585, 'compress@10': 0.5418, 'time@10': 48.5086}:  80%|████████  | 8/10 [04:56<01:12, 36.40s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0073, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9585, 'compress@10': 0.5418, 'time@10': 48.5086}:  90%|█████████ | 9/10 [04:56<00:36, 36.70s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0067, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9603, 'compress@10': 0.5248, 'time@10': 48.6625}:  90%|█████████ | 9/10 [05:46<00:36, 36.70s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0067, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9603, 'compress@10': 0.5248, 'time@10': 48.6625}: 100%|██████████| 10/10 [05:46<00:00, 40.83s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0067, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9603, 'compress@10': 0.5248, 'time@10': 48.6625}: 100%|██████████| 10/10 [05:46<00:00, 34.69s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.0067310509696394865
Avg hit ratio: 0.8966279653189669
Avg ndcg: 0.9602815828114226
Avg compression ratio: 0.5247659921491485
Avg train time: 48.66253170967102
Std train time: 22.297635743303687
[0.8125, 0.6875, 0.06250000000000001, 0.6875, 0.1875, 0.5625, 0.8125, 0.6875, 0.1875, 0.3125]
[50, 50, 57, 50, 43, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9425, 'compress@10': 0.8224, 'time@10': 40.4899}:   0%|          | 0/10 [00:20<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9425, 'compress@10': 0.8224, 'time@10': 40.4899}:  10%|█         | 1/10 [00:20<03:02, 20.28s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9551, 'compress@10': 0.76, 'time@10': 37.7687}:  10%|█         | 1/10 [00:55<03:02, 20.28s/it]  {'epoch': 7, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9551, 'compress@10': 0.76, 'time@10': 37.7687}:  20%|██        | 2/10 [00:55<03:51, 28.99s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9225, 'compress@10': 0.5721, 'time@10': 30.1144}:  20%|██        | 2/10 [01:02<03:51, 28.99s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9225, 'compress@10': 0.5721, 'time@10': 30.1144}:  30%|███       | 3/10 [01:02<02:14, 19.15s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9322, 'compress@10': 0.6038, 'time@10': 30.3568}:  30%|███       | 3/10 [01:33<02:14, 19.15s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9322, 'compress@10': 0.6038, 'time@10': 30.3568}:  40%|████      | 4/10 [01:33<02:23, 23.88s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0069, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9417, 'compress@10': 0.5238, 'time@10': 43.6541}:  40%|████      | 4/10 [02:22<02:23, 23.88s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0069, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9417, 'compress@10': 0.5238, 'time@10': 43.6541}:  50%|█████     | 5/10 [02:22<02:43, 32.74s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0078, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9478, 'compress@10': 0.5318, 'time@10': 44.9251}:  50%|█████     | 5/10 [03:13<02:43, 32.74s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0078, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9478, 'compress@10': 0.5318, 'time@10': 44.9251}:  60%|██████    | 6/10 [03:13<02:36, 39.06s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0078, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9495, 'compress@10': 0.573, 'time@10': 46.3236}:  60%|██████    | 6/10 [03:41<02:36, 39.06s/it] {'epoch': 7, 'num_users': 6.2857, 'loss': 0.0078, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9495, 'compress@10': 0.573, 'time@10': 46.3236}:  70%|███████   | 7/10 [03:41<01:45, 35.24s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.9184, 'ndcg@10': 0.9637, 'compress@10': 0.5884, 'time@10': 45.4117}:  70%|███████   | 7/10 [04:20<01:45, 35.24s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.9184, 'ndcg@10': 0.9637, 'compress@10': 0.5884, 'time@10': 45.4117}:  80%|████████  | 8/10 [04:20<01:12, 36.47s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0081, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9645, 'compress@10': 0.5465, 'time@10': 48.6642}:  80%|████████  | 8/10 [04:57<01:12, 36.47s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0081, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9645, 'compress@10': 0.5465, 'time@10': 48.6642}:  90%|█████████ | 9/10 [04:57<00:36, 36.75s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0074, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9658, 'compress@10': 0.5246, 'time@10': 48.8274}:  90%|█████████ | 9/10 [05:47<00:36, 36.75s/it]  {'epoch': 7, 'num_users': 6.3, 'loss': 0.0074, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9658, 'compress@10': 0.5246, 'time@10': 48.8274}: 100%|██████████| 10/10 [05:47<00:00, 40.94s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0074, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9658, 'compress@10': 0.5246, 'time@10': 48.8274}: 100%|██████████| 10/10 [05:47<00:00, 34.79s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.007448750603163956
Avg hit ratio: 0.909564473255475
Avg ndcg: 0.965790369153346
Avg compression ratio: 0.524625040550929
Avg train time: 48.827403616905215
Std train time: 22.010509766234833
[0.8333333333333334, 0.6111111111111112, 0.055555555555555566, 0.7222222222222222, 0.16666666666666666, 0.6111111111111112, 0.8333333333333334, 0.7222222222222222, 0.16666666666666666, 0.2777777777777778]
[50, 50, 58, 50, 42, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0044, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9447, 'compress@10': 0.8421, 'time@10': 38.6498}:   0%|          | 0/10 [00:19<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0044, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9447, 'compress@10': 0.8421, 'time@10': 38.6498}:  10%|█         | 1/10 [00:19<02:54, 19.36s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0046, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9562, 'compress@10': 0.7329, 'time@10': 36.8339}:  10%|█         | 1/10 [00:54<02:54, 19.36s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0046, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9562, 'compress@10': 0.7329, 'time@10': 36.8339}:  20%|██        | 2/10 [00:54<03:48, 28.59s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.003, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9232, 'compress@10': 0.5521, 'time@10': 29.3828}:  20%|██        | 2/10 [01:01<03:48, 28.59s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.003, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9232, 'compress@10': 0.5521, 'time@10': 29.3828}:  30%|███       | 3/10 [01:01<02:12, 18.86s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9335, 'compress@10': 0.5971, 'time@10': 29.7151}:  30%|███       | 3/10 [01:32<02:12, 18.86s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9335, 'compress@10': 0.5971, 'time@10': 29.7151}:  40%|████      | 4/10 [01:32<02:21, 23.55s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0051, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9426, 'compress@10': 0.5143, 'time@10': 42.2642}:  40%|████      | 4/10 [02:18<02:21, 23.55s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0051, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9426, 'compress@10': 0.5143, 'time@10': 42.2642}:  50%|█████     | 5/10 [02:18<02:38, 31.75s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.005, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9484, 'compress@10': 0.5319, 'time@10': 43.7988}:  50%|█████     | 5/10 [03:10<02:38, 31.75s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.005, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9484, 'compress@10': 0.5319, 'time@10': 43.7988}:  60%|██████    | 6/10 [03:10<02:33, 38.47s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0056, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.95, 'compress@10': 0.5759, 'time@10': 44.8345}:  60%|██████    | 6/10 [03:35<02:33, 38.47s/it] {'epoch': 8, 'num_users': 6.2857, 'loss': 0.0056, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.95, 'compress@10': 0.5759, 'time@10': 44.8345}:  70%|███████   | 7/10 [03:35<01:42, 34.25s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0064, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9518, 'compress@10': 0.5952, 'time@10': 44.1299}:  70%|███████   | 7/10 [04:15<01:42, 34.25s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0064, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9518, 'compress@10': 0.5952, 'time@10': 44.1299}:  80%|████████  | 8/10 [04:15<01:11, 35.84s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0057, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.954, 'compress@10': 0.5502, 'time@10': 47.5029}:  80%|████████  | 8/10 [04:52<01:11, 35.84s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0057, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.954, 'compress@10': 0.5502, 'time@10': 47.5029}:  90%|█████████ | 9/10 [04:52<00:36, 36.29s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0053, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9563, 'compress@10': 0.5246, 'time@10': 47.7237}:  90%|█████████ | 9/10 [05:42<00:36, 36.29s/it]  {'epoch': 8, 'num_users': 6.3, 'loss': 0.0053, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9563, 'compress@10': 0.5246, 'time@10': 47.7237}: 100%|██████████| 10/10 [05:42<00:00, 40.44s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0053, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9563, 'compress@10': 0.5246, 'time@10': 47.7237}: 100%|██████████| 10/10 [05:42<00:00, 34.21s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.005254752468943013
Avg hit ratio: 0.8917708224618242
Avg ndcg: 0.9563229740886442
Avg compression ratio: 0.524626832271003
Avg train time: 47.72365393638611
Std train time: 21.113152057734606
[0.75, 0.55, 0.05000000000000001, 0.75, 0.25, 0.65, 0.8500000000000001, 0.75, 0.15, 0.25]
[50, 50, 59, 50, 41, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0047, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7632, 'time@10': 41.5209}:   0%|          | 0/10 [00:20<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0047, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7632, 'time@10': 41.5209}:  10%|█         | 1/10 [00:20<03:07, 20.80s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0047, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6638, 'time@10': 38.2436}:  10%|█         | 1/10 [00:55<03:07, 20.80s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0047, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6638, 'time@10': 38.2436}:  20%|██        | 2/10 [00:55<03:53, 29.15s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0031, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5045, 'time@10': 30.4451}:  20%|██        | 2/10 [01:03<03:53, 29.15s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0031, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5045, 'time@10': 30.4451}:  30%|███       | 3/10 [01:03<02:14, 19.25s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9341, 'compress@10': 0.5681, 'time@10': 30.5628}:  30%|███       | 3/10 [01:34<02:14, 19.25s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9341, 'compress@10': 0.5681, 'time@10': 30.5628}:  40%|████      | 4/10 [01:34<02:23, 23.87s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0058, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9408, 'compress@10': 0.5075, 'time@10': 43.0851}:  40%|████      | 4/10 [02:20<02:23, 23.87s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0058, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9408, 'compress@10': 0.5075, 'time@10': 43.0851}:  50%|█████     | 5/10 [02:20<02:40, 32.08s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9452, 'compress@10': 0.5325, 'time@10': 44.4023}:  50%|█████     | 5/10 [03:11<02:40, 32.08s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9452, 'compress@10': 0.5325, 'time@10': 44.4023}:  60%|██████    | 6/10 [03:11<02:34, 38.52s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9473, 'compress@10': 0.5787, 'time@10': 45.2858}:  60%|██████    | 6/10 [03:37<02:34, 38.52s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9473, 'compress@10': 0.5787, 'time@10': 45.2858}:  70%|███████   | 7/10 [03:37<01:42, 34.21s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0076, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9503, 'compress@10': 0.601, 'time@10': 44.3934}:  70%|███████   | 7/10 [04:15<01:42, 34.21s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0076, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9503, 'compress@10': 0.601, 'time@10': 44.3934}:  80%|████████  | 8/10 [04:15<01:10, 35.47s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0068, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9527, 'compress@10': 0.5536, 'time@10': 47.499}:  80%|████████  | 8/10 [04:51<01:10, 35.47s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0068, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9527, 'compress@10': 0.5536, 'time@10': 47.499}:  90%|█████████ | 9/10 [04:51<00:35, 35.71s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0062, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9551, 'compress@10': 0.525, 'time@10': 47.5051}:  90%|█████████ | 9/10 [05:39<00:35, 35.71s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0062, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9551, 'compress@10': 0.525, 'time@10': 47.5051}: 100%|██████████| 10/10 [05:39<00:00, 39.38s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0062, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9551, 'compress@10': 0.525, 'time@10': 47.5051}: 100%|██████████| 10/10 [05:39<00:00, 33.92s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.006169146264977498
Avg hit ratio: 0.8885450160102113
Avg ndcg: 0.9551179967061664
Avg compression ratio: 0.5249544647380633
Avg train time: 47.50509040355682
Std train time: 20.848446977970003
[0.7727272727272727, 0.5, 0.04545454545454546, 0.7727272727272727, 0.3181818181818182, 0.6818181818181819, 0.8636363636363638, 0.6818181818181819, 0.13636363636363635, 0.22727272727272727]
[50, 50, 60, 50, 40, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0028, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7847, 'time@10': 39.2077}:   0%|          | 0/10 [00:19<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0028, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7847, 'time@10': 39.2077}:  10%|█         | 1/10 [00:19<02:56, 19.64s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0022, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6504, 'time@10': 36.5705}:  10%|█         | 1/10 [00:53<02:56, 19.64s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0022, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6504, 'time@10': 36.5705}:  20%|██        | 2/10 [00:53<03:44, 28.07s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0015, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.4942, 'time@10': 29.2738}:  20%|██        | 2/10 [01:00<03:44, 28.07s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0015, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.4942, 'time@10': 29.2738}:  30%|███       | 3/10 [01:00<02:10, 18.62s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0036, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9341, 'compress@10': 0.5659, 'time@10': 29.283}:  30%|███       | 3/10 [01:30<02:10, 18.62s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0036, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9341, 'compress@10': 0.5659, 'time@10': 29.283}:  40%|████      | 4/10 [01:30<02:17, 22.86s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0049, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9444, 'compress@10': 0.5191, 'time@10': 41.0734}:  40%|████      | 4/10 [02:14<02:17, 22.86s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0049, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9444, 'compress@10': 0.5191, 'time@10': 41.0734}:  50%|█████     | 5/10 [02:14<02:32, 30.54s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0071, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9489, 'compress@10': 0.5474, 'time@10': 42.4633}:  50%|█████     | 5/10 [03:03<02:32, 30.54s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0071, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9489, 'compress@10': 0.5474, 'time@10': 42.4633}:  60%|██████    | 6/10 [03:03<02:27, 36.97s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0073, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9505, 'compress@10': 0.5933, 'time@10': 43.3979}:  60%|██████    | 6/10 [03:28<02:27, 36.97s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0073, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9505, 'compress@10': 0.5933, 'time@10': 43.3979}:  70%|███████   | 7/10 [03:28<01:38, 32.90s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0067, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9531, 'compress@10': 0.6055, 'time@10': 42.7183}:  70%|███████   | 7/10 [04:06<01:38, 32.90s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0067, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9531, 'compress@10': 0.6055, 'time@10': 42.7183}:  80%|████████  | 8/10 [04:06<01:09, 34.53s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.006, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9551, 'compress@10': 0.5561, 'time@10': 45.9418}:  80%|████████  | 8/10 [04:42<01:09, 34.53s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.006, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9551, 'compress@10': 0.5561, 'time@10': 45.9418}:  90%|█████████ | 9/10 [04:42<00:34, 34.96s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0055, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.9573, 'compress@10': 0.525, 'time@10': 46.0912}:  90%|█████████ | 9/10 [05:29<00:34, 34.96s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0055, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.9573, 'compress@10': 0.525, 'time@10': 46.0912}: 100%|██████████| 10/10 [05:29<00:00, 38.83s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0055, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.9573, 'compress@10': 0.525, 'time@10': 46.0912}: 100%|██████████| 10/10 [05:29<00:00, 32.99s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.00547330458685209
Avg hit ratio: 0.883243428708624
Avg ndcg: 0.9573466292713941
Avg compression ratio: 0.5250028790006451
Avg train time: 46.09122183322906
Std train time: 19.96067559176797
[0.7916666666666666, 0.4583333333333333, 0.04166666666666667, 0.7916666666666666, 0.375, 0.7083333333333334, 0.8750000000000001, 0.625, 0.12499999999999999, 0.20833333333333331]
[50, 50, 61, 50, 39, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0011, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8026, 'time@10': 39.1804}:   0%|          | 0/10 [00:19<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0011, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8026, 'time@10': 39.1804}:  10%|█         | 1/10 [00:19<02:56, 19.63s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0009, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6392, 'time@10': 36.5218}:  10%|█         | 1/10 [00:53<02:56, 19.63s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0009, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6392, 'time@10': 36.5218}:  20%|██        | 2/10 [00:53<03:44, 28.02s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0006, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9241, 'compress@10': 0.4857, 'time@10': 29.3943}:  20%|██        | 2/10 [01:01<03:44, 28.02s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0006, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9241, 'compress@10': 0.4857, 'time@10': 29.3943}:  30%|███       | 3/10 [01:01<02:10, 18.70s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0025, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9341, 'compress@10': 0.564, 'time@10': 29.5241}:  30%|███       | 3/10 [01:31<02:10, 18.70s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0025, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9341, 'compress@10': 0.564, 'time@10': 29.5241}:  40%|████      | 4/10 [01:31<02:18, 23.14s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0041, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9514, 'compress@10': 0.5287, 'time@10': 41.5624}:  40%|████      | 4/10 [02:15<02:18, 23.14s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0041, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9514, 'compress@10': 0.5287, 'time@10': 41.5624}:  50%|█████     | 5/10 [02:15<02:34, 30.99s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0076, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9538, 'compress@10': 0.5597, 'time@10': 42.9606}:  50%|█████     | 5/10 [03:05<02:34, 30.99s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0076, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9538, 'compress@10': 0.5597, 'time@10': 42.9606}:  60%|██████    | 6/10 [03:05<02:29, 37.45s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0073, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9546, 'compress@10': 0.6055, 'time@10': 43.8254}:  60%|██████    | 6/10 [03:30<02:29, 37.45s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0073, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9546, 'compress@10': 0.6055, 'time@10': 43.8254}:  70%|███████   | 7/10 [03:30<01:39, 33.23s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0067, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9567, 'compress@10': 0.6093, 'time@10': 43.1893}:  70%|███████   | 7/10 [04:09<01:39, 33.23s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0067, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9567, 'compress@10': 0.6093, 'time@10': 43.1893}:  80%|████████  | 8/10 [04:09<01:09, 35.00s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0059, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.9584, 'compress@10': 0.5582, 'time@10': 46.6311}:  80%|████████  | 8/10 [04:46<01:09, 35.00s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0059, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.9584, 'compress@10': 0.5582, 'time@10': 46.6311}:  90%|█████████ | 9/10 [04:46<00:35, 35.66s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0054, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9603, 'compress@10': 0.525, 'time@10': 46.8778}:  90%|█████████ | 9/10 [05:35<00:35, 35.66s/it]    {'epoch': 11, 'num_users': 6.3, 'loss': 0.0054, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9603, 'compress@10': 0.525, 'time@10': 46.8778}: 100%|██████████| 10/10 [05:35<00:00, 39.82s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0054, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9603, 'compress@10': 0.525, 'time@10': 46.8778}: 100%|██████████| 10/10 [05:35<00:00, 33.56s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.005374990741621968
Avg hit ratio: 0.9007513652165604
Avg ndcg: 0.9602658369785892
Avg compression ratio: 0.5250425040248757
Avg train time: 46.87784097194672
Std train time: 20.46627587035842
[0.7307692307692307, 0.4230769230769231, 0.038461538461538464, 0.8076923076923077, 0.4230769230769231, 0.7307692307692308, 0.8846153846153847, 0.6538461538461539, 0.11538461538461538, 0.1923076923076923]
[50, 50, 62, 50, 38, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7449, 'time@10': 41.9499}:   0%|          | 0/10 [00:21<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7449, 'time@10': 41.9499}:  10%|█         | 1/10 [00:21<03:09, 21.02s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0014, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.5933, 'time@10': 38.5215}:  10%|█         | 1/10 [00:56<03:09, 21.02s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0014, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.5933, 'time@10': 38.5215}:  20%|██        | 2/10 [00:56<03:54, 29.32s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0009, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9241, 'compress@10': 0.4542, 'time@10': 31.1004}:  20%|██        | 2/10 [01:04<03:54, 29.32s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0009, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9241, 'compress@10': 0.4542, 'time@10': 31.1004}:  30%|███       | 3/10 [01:04<02:17, 19.66s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0025, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9341, 'compress@10': 0.5443, 'time@10': 30.8792}:  30%|███       | 3/10 [01:34<02:17, 19.66s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0025, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9341, 'compress@10': 0.5443, 'time@10': 30.8792}:  40%|████      | 4/10 [01:34<02:23, 23.84s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0038, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9473, 'compress@10': 0.5223, 'time@10': 42.2611}:  40%|████      | 4/10 [02:18<02:23, 23.84s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0038, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9473, 'compress@10': 0.5223, 'time@10': 42.2611}:  50%|█████     | 5/10 [02:18<02:35, 31.09s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0041, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9524, 'compress@10': 0.5581, 'time@10': 43.4441}:  50%|█████     | 5/10 [03:07<02:35, 31.09s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0041, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9524, 'compress@10': 0.5581, 'time@10': 43.4441}:  60%|██████    | 6/10 [03:07<02:29, 37.31s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0044, 'hit_ratio@10': 0.9285, 'ndcg@10': 0.9535, 'compress@10': 0.6054, 'time@10': 44.3481}:  60%|██████    | 6/10 [03:32<02:29, 37.31s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0044, 'hit_ratio@10': 0.9285, 'ndcg@10': 0.9535, 'compress@10': 0.6054, 'time@10': 44.3481}:  70%|███████   | 7/10 [03:32<01:39, 33.26s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0039, 'hit_ratio@10': 0.9339, 'ndcg@10': 0.9557, 'compress@10': 0.6127, 'time@10': 43.5275}:  70%|███████   | 7/10 [04:10<01:39, 33.26s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0039, 'hit_ratio@10': 0.9339, 'ndcg@10': 0.9557, 'compress@10': 0.6127, 'time@10': 43.5275}:  80%|████████  | 8/10 [04:10<01:09, 34.71s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0035, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9575, 'compress@10': 0.5602, 'time@10': 46.5596}:  80%|████████  | 8/10 [04:46<01:09, 34.71s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0035, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9575, 'compress@10': 0.5602, 'time@10': 46.5596}:  90%|█████████ | 9/10 [04:46<00:34, 34.94s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0031, 'hit_ratio@10': 0.9105, 'ndcg@10': 0.9594, 'compress@10': 0.5253, 'time@10': 46.5267}:  90%|█████████ | 9/10 [05:32<00:34, 34.94s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0031, 'hit_ratio@10': 0.9105, 'ndcg@10': 0.9594, 'compress@10': 0.5253, 'time@10': 46.5267}: 100%|██████████| 10/10 [05:32<00:00, 38.45s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0031, 'hit_ratio@10': 0.9105, 'ndcg@10': 0.9594, 'compress@10': 0.5253, 'time@10': 46.5267}: 100%|██████████| 10/10 [05:32<00:00, 33.24s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.0031329517662428558
Avg hit ratio: 0.9105450160102112
Avg ndcg: 0.9594348610298222
Avg compression ratio: 0.525264353869433
Avg train time: 46.52674651145935
Std train time: 19.2912777432134
[0.75, 0.39285714285714285, 0.03571428571428572, 0.8214285714285714, 0.4642857142857143, 0.7500000000000001, 0.8928571428571429, 0.6071428571428572, 0.10714285714285714, 0.17857142857142855]
[50, 50, 63, 50, 37, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0022, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7632, 'time@10': 39.4672}:   0%|          | 0/10 [00:19<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0022, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7632, 'time@10': 39.4672}:  10%|█         | 1/10 [00:19<02:58, 19.79s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0013, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9576, 'compress@10': 0.5878, 'time@10': 36.5664}:  10%|█         | 1/10 [00:53<02:58, 19.79s/it] {'epoch': 13, 'num_users': 7.0, 'loss': 0.0013, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9576, 'compress@10': 0.5878, 'time@10': 36.5664}:  20%|██        | 2/10 [00:53<03:43, 27.98s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0008, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9241, 'compress@10': 0.4497, 'time@10': 29.2945}:  20%|██        | 2/10 [01:00<03:43, 27.98s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0008, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9241, 'compress@10': 0.4497, 'time@10': 29.2945}:  30%|███       | 3/10 [01:00<02:10, 18.59s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0019, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9341, 'compress@10': 0.5442, 'time@10': 28.8183}:  30%|███       | 3/10 [01:28<02:10, 18.59s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0019, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9341, 'compress@10': 0.5442, 'time@10': 28.8183}:  40%|████      | 4/10 [01:28<02:12, 22.08s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0035, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9438, 'compress@10': 0.5304, 'time@10': 39.683}:  40%|████      | 4/10 [02:09<02:12, 22.08s/it] {'epoch': 13, 'num_users': 5.8, 'loss': 0.0035, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9438, 'compress@10': 0.5304, 'time@10': 39.683}:  50%|█████     | 5/10 [02:09<02:25, 29.12s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0033, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9495, 'compress@10': 0.5679, 'time@10': 41.0996}:  50%|█████     | 5/10 [02:58<02:25, 29.12s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0033, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9495, 'compress@10': 0.5679, 'time@10': 41.0996}:  60%|██████    | 6/10 [02:58<02:22, 35.61s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.004, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.951, 'compress@10': 0.6149, 'time@10': 41.6779}:  60%|██████    | 6/10 [03:20<02:22, 35.61s/it]  {'epoch': 13, 'num_users': 6.2857, 'loss': 0.004, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.951, 'compress@10': 0.6149, 'time@10': 41.6779}:  70%|███████   | 7/10 [03:20<01:34, 31.36s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0035, 'hit_ratio@10': 0.9103, 'ndcg@10': 0.9535, 'compress@10': 0.6154, 'time@10': 41.1878}:  70%|███████   | 7/10 [03:58<01:34, 31.36s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0035, 'hit_ratio@10': 0.9103, 'ndcg@10': 0.9535, 'compress@10': 0.6154, 'time@10': 41.1878}:  80%|████████  | 8/10 [03:58<01:06, 33.41s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0032, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9555, 'compress@10': 0.5617, 'time@10': 44.3952}:  80%|████████  | 8/10 [04:33<01:06, 33.41s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0032, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9555, 'compress@10': 0.5617, 'time@10': 44.3952}:  90%|█████████ | 9/10 [04:33<00:33, 33.93s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0029, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9577, 'compress@10': 0.5253, 'time@10': 44.5713}:  90%|█████████ | 9/10 [05:19<00:33, 33.93s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0029, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9577, 'compress@10': 0.5253, 'time@10': 44.5713}: 100%|██████████| 10/10 [05:19<00:00, 37.71s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0029, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9577, 'compress@10': 0.5253, 'time@10': 44.5713}: 100%|██████████| 10/10 [05:19<00:00, 31.98s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.0028736887337746033
Avg hit ratio: 0.9031128603522491
Avg ndcg: 0.9577095672130012
Avg compression ratio: 0.5252820724461869
Avg train time: 44.57134644985199
Std train time: 18.78523345516892
[0.7666666666666667, 0.36666666666666664, 0.03333333333333334, 0.8333333333333333, 0.5, 0.7666666666666667, 0.9, 0.5666666666666668, 0.09999999999999999, 0.16666666666666666]
[50, 50, 64, 50, 36, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7789, 'time@10': 39.5936}:   0%|          | 0/10 [00:19<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7789, 'time@10': 39.5936}:  10%|█         | 1/10 [00:19<02:58, 19.83s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0011, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.583, 'time@10': 36.5283}:  10%|█         | 1/10 [00:53<02:58, 19.83s/it] {'epoch': 14, 'num_users': 7.0, 'loss': 0.0011, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.583, 'time@10': 36.5283}:  20%|██        | 2/10 [00:53<03:42, 27.87s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0007, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.4458, 'time@10': 29.6304}:  20%|██        | 2/10 [01:01<03:42, 27.87s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0007, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.4458, 'time@10': 29.6304}:  30%|███       | 3/10 [01:01<02:11, 18.78s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0019, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9341, 'compress@10': 0.5442, 'time@10': 28.9973}:  30%|███       | 3/10 [01:28<02:11, 18.78s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0019, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9341, 'compress@10': 0.5442, 'time@10': 28.9973}:  40%|████      | 4/10 [01:28<02:12, 22.08s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0026, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.942, 'compress@10': 0.5373, 'time@10': 39.0635}:  40%|████      | 4/10 [02:08<02:12, 22.08s/it] {'epoch': 14, 'num_users': 5.8, 'loss': 0.0026, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.942, 'compress@10': 0.5373, 'time@10': 39.0635}:  50%|█████     | 5/10 [02:08<02:22, 28.43s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0024, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9479, 'compress@10': 0.5764, 'time@10': 40.5413}:  50%|█████     | 5/10 [02:56<02:22, 28.43s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0024, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9479, 'compress@10': 0.5764, 'time@10': 40.5413}:  60%|██████    | 6/10 [02:56<02:20, 35.08s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0028, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9497, 'compress@10': 0.6232, 'time@10': 41.1906}:  60%|██████    | 6/10 [03:18<02:20, 35.08s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0028, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9497, 'compress@10': 0.6232, 'time@10': 41.1906}:  70%|███████   | 7/10 [03:18<01:32, 31.00s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0025, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.9524, 'compress@10': 0.6177, 'time@10': 40.7205}:  70%|███████   | 7/10 [03:56<01:32, 31.00s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0025, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.9524, 'compress@10': 0.6177, 'time@10': 40.7205}:  80%|████████  | 8/10 [03:56<01:06, 33.06s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0022, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9545, 'compress@10': 0.563, 'time@10': 43.8939}:  80%|████████  | 8/10 [04:30<01:06, 33.06s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0022, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9545, 'compress@10': 0.563, 'time@10': 43.8939}:  90%|█████████ | 9/10 [04:30<00:33, 33.56s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.002, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9568, 'compress@10': 0.5253, 'time@10': 44.0882}:  90%|█████████ | 9/10 [05:16<00:33, 33.56s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.002, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9568, 'compress@10': 0.5253, 'time@10': 44.0882}: 100%|██████████| 10/10 [05:16<00:00, 37.36s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.002, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9568, 'compress@10': 0.5253, 'time@10': 44.0882}: 100%|██████████| 10/10 [05:16<00:00, 31.67s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.002015236782520296
Avg hit ratio: 0.897421616112618
Avg ndcg: 0.9567703209173463
Avg compression ratio: 0.525294388693555
Avg train time: 44.08818752765656
Std train time: 17.775543562503902
[0.78125, 0.34375, 0.03125000000000001, 0.8437499999999999, 0.53125, 0.78125, 0.90625, 0.5312500000000001, 0.09374999999999999, 0.15625]
[50, 50, 65, 50, 36, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7928, 'time@10': 38.8439}:   0%|          | 0/10 [00:19<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7928, 'time@10': 38.8439}:  10%|█         | 1/10 [00:19<02:55, 19.46s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.5788, 'time@10': 35.9501}:  10%|█         | 1/10 [00:52<02:55, 19.46s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.5788, 'time@10': 35.9501}:  20%|██        | 2/10 [00:52<03:39, 27.49s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0005, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9241, 'compress@10': 0.4424, 'time@10': 29.0794}:  20%|██        | 2/10 [01:00<03:39, 27.49s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0005, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9241, 'compress@10': 0.4424, 'time@10': 29.0794}:  30%|███       | 3/10 [01:00<02:09, 18.45s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0018, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9341, 'compress@10': 0.5442, 'time@10': 28.5944}:  30%|███       | 3/10 [01:27<02:09, 18.45s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0018, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9341, 'compress@10': 0.5442, 'time@10': 28.5944}:  40%|████      | 4/10 [01:27<02:11, 21.90s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0033, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9423, 'compress@10': 0.5435, 'time@10': 38.6816}:  40%|████      | 4/10 [02:06<02:11, 21.90s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0033, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9423, 'compress@10': 0.5435, 'time@10': 38.6816}:  50%|█████     | 5/10 [02:06<02:21, 28.26s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0029, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9482, 'compress@10': 0.5839, 'time@10': 40.1375}:  50%|█████     | 5/10 [02:54<02:21, 28.26s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0029, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9482, 'compress@10': 0.5839, 'time@10': 40.1375}:  60%|██████    | 6/10 [02:54<02:19, 34.79s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0032, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9499, 'compress@10': 0.6305, 'time@10': 40.8121}:  60%|██████    | 6/10 [03:16<02:19, 34.79s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0032, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9499, 'compress@10': 0.6305, 'time@10': 40.8121}:  70%|███████   | 7/10 [03:16<01:32, 30.76s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0029, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9526, 'compress@10': 0.6197, 'time@10': 40.4}:  70%|███████   | 7/10 [03:54<01:32, 30.76s/it]    {'epoch': 15, 'num_users': 6.125, 'loss': 0.0029, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9526, 'compress@10': 0.6197, 'time@10': 40.4}:  80%|████████  | 8/10 [03:54<01:05, 32.92s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0026, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9547, 'compress@10': 0.5642, 'time@10': 43.5694}:  80%|████████  | 8/10 [04:28<01:05, 32.92s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0026, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9547, 'compress@10': 0.5642, 'time@10': 43.5694}:  90%|█████████ | 9/10 [04:28<00:33, 33.42s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0023, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.957, 'compress@10': 0.5253, 'time@10': 43.7798}:  90%|█████████ | 9/10 [05:14<00:33, 33.42s/it]    {'epoch': 15, 'num_users': 6.3, 'loss': 0.0023, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.957, 'compress@10': 0.5253, 'time@10': 43.7798}: 100%|██████████| 10/10 [05:14<00:00, 37.21s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0023, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.957, 'compress@10': 0.5253, 'time@10': 43.7798}: 100%|██████████| 10/10 [05:14<00:00, 31.47s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.002323728296516651
Avg hit ratio: 0.9047513652165604
Avg ndcg: 0.9569548913047171
Avg compression ratio: 0.5253069582078392
Avg train time: 43.77977390289307
Std train time: 17.76863455741289
[0.7941176470588235, 0.3235294117647059, 0.02941176470588236, 0.8529411764705881, 0.5588235294117647, 0.7941176470588235, 0.9117647058823529, 0.5000000000000001, 0.08823529411764705, 0.14705882352941177]
[50, 50, 66, 50, 36, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0022, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8049, 'time@10': 39.5829}:   0%|          | 0/10 [00:19<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0022, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8049, 'time@10': 39.5829}:  10%|█         | 1/10 [00:19<02:58, 19.83s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0015, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.5751, 'time@10': 36.2156}:  10%|█         | 1/10 [00:52<02:58, 19.83s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0015, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.5751, 'time@10': 36.2156}:  20%|██        | 2/10 [00:52<03:40, 27.51s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.001, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9241, 'compress@10': 0.4395, 'time@10': 29.3551}:  20%|██        | 2/10 [01:00<03:40, 27.51s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.001, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9241, 'compress@10': 0.4395, 'time@10': 29.3551}:  30%|███       | 3/10 [01:00<02:09, 18.53s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0025, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9341, 'compress@10': 0.5441, 'time@10': 28.8093}:  30%|███       | 3/10 [01:27<02:09, 18.53s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0025, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9341, 'compress@10': 0.5441, 'time@10': 28.8093}:  40%|████      | 4/10 [01:27<02:11, 21.96s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0026, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9432, 'compress@10': 0.5488, 'time@10': 39.0921}:  40%|████      | 4/10 [02:07<02:11, 21.96s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0026, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9432, 'compress@10': 0.5488, 'time@10': 39.0921}:  50%|█████     | 5/10 [02:07<02:22, 28.52s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0023, 'hit_ratio@10': 0.9286, 'ndcg@10': 0.949, 'compress@10': 0.5905, 'time@10': 40.3907}:  50%|█████     | 5/10 [02:54<02:22, 28.52s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0023, 'hit_ratio@10': 0.9286, 'ndcg@10': 0.949, 'compress@10': 0.5905, 'time@10': 40.3907}:  60%|██████    | 6/10 [02:54<02:19, 34.77s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0023, 'hit_ratio@10': 0.9274, 'ndcg@10': 0.9505, 'compress@10': 0.6369, 'time@10': 41.0992}:  60%|██████    | 6/10 [03:17<02:19, 34.77s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0023, 'hit_ratio@10': 0.9274, 'ndcg@10': 0.9505, 'compress@10': 0.6369, 'time@10': 41.0992}:  70%|███████   | 7/10 [03:17<01:32, 30.83s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.002, 'hit_ratio@10': 0.9329, 'ndcg@10': 0.9531, 'compress@10': 0.6216, 'time@10': 40.5904}:  70%|███████   | 7/10 [03:54<01:32, 30.83s/it]  {'epoch': 16, 'num_users': 6.125, 'loss': 0.002, 'hit_ratio@10': 0.9329, 'ndcg@10': 0.9531, 'compress@10': 0.6216, 'time@10': 40.5904}:  80%|████████  | 8/10 [03:54<01:05, 32.82s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0018, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9552, 'compress@10': 0.5652, 'time@10': 43.7898}:  80%|████████  | 8/10 [04:29<01:05, 32.82s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0018, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9552, 'compress@10': 0.5652, 'time@10': 43.7898}:  90%|█████████ | 9/10 [04:29<00:33, 33.41s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0017, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 43.9571}:  90%|█████████ | 9/10 [05:14<00:33, 33.41s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0017, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 43.9571}: 100%|██████████| 10/10 [05:14<00:00, 37.15s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0017, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 43.9571}: 100%|██████████| 10/10 [05:14<00:00, 31.49s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.0016635268647826249
Avg hit ratio: 0.9183422510332526
Avg ndcg: 0.957387423054872
Avg compression ratio: 0.5253184426967475
Avg train time: 43.95708885192871
Std train time: 18.02505699213797
[0.8055555555555555, 0.36111111111111116, 0.027777777777777783, 0.8611111111111109, 0.5833333333333334, 0.75, 0.9166666666666666, 0.4722222222222223, 0.08333333333333333, 0.1388888888888889]
[50, 50, 67, 50, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0041, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8158, 'time@10': 39.2767}:   0%|          | 0/10 [00:19<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0041, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8158, 'time@10': 39.2767}:  10%|█         | 1/10 [00:19<02:57, 19.68s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0027, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9576, 'compress@10': 0.5987, 'time@10': 36.3771}:  10%|█         | 1/10 [00:53<02:57, 19.68s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0027, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9576, 'compress@10': 0.5987, 'time@10': 36.3771}:  20%|██        | 2/10 [00:53<03:42, 27.82s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0018, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.9241, 'compress@10': 0.4547, 'time@10': 29.7129}:  20%|██        | 2/10 [01:01<03:42, 27.82s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0018, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.9241, 'compress@10': 0.4547, 'time@10': 29.7129}:  30%|███       | 3/10 [01:01<02:12, 18.87s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0031, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9341, 'compress@10': 0.5576, 'time@10': 29.1412}:  30%|███       | 3/10 [01:28<02:12, 18.87s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0031, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9341, 'compress@10': 0.5576, 'time@10': 29.1412}:  40%|████      | 4/10 [01:28<02:13, 22.26s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0041, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9466, 'compress@10': 0.5644, 'time@10': 38.871}:  40%|████      | 4/10 [02:07<02:13, 22.26s/it] {'epoch': 17, 'num_users': 5.8, 'loss': 0.0041, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9466, 'compress@10': 0.5644, 'time@10': 38.871}:  50%|█████     | 5/10 [02:07<02:21, 28.27s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0035, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9518, 'compress@10': 0.5962, 'time@10': 40.3054}:  50%|█████     | 5/10 [02:55<02:21, 28.27s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0035, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9518, 'compress@10': 0.5962, 'time@10': 40.3054}:  60%|██████    | 6/10 [02:55<02:19, 34.82s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0032, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.953, 'compress@10': 0.6425, 'time@10': 40.912}:  60%|██████    | 6/10 [03:17<02:19, 34.82s/it]  {'epoch': 17, 'num_users': 6.2857, 'loss': 0.0032, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.953, 'compress@10': 0.6425, 'time@10': 40.912}:  70%|███████   | 7/10 [03:17<01:32, 30.73s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0028, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9553, 'compress@10': 0.6231, 'time@10': 40.4416}:  70%|███████   | 7/10 [03:54<01:32, 30.73s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0028, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9553, 'compress@10': 0.6231, 'time@10': 40.4416}:  80%|████████  | 8/10 [03:54<01:05, 32.79s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0025, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9571, 'compress@10': 0.566, 'time@10': 43.6852}:  80%|████████  | 8/10 [04:29<01:05, 32.79s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0025, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9571, 'compress@10': 0.566, 'time@10': 43.6852}:  90%|█████████ | 9/10 [04:29<00:33, 33.43s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0023, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9591, 'compress@10': 0.5253, 'time@10': 43.8519}:  90%|█████████ | 9/10 [05:15<00:33, 33.43s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0023, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9591, 'compress@10': 0.5253, 'time@10': 43.8519}: 100%|██████████| 10/10 [05:15<00:00, 37.12s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0023, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9591, 'compress@10': 0.5253, 'time@10': 43.8519}: 100%|██████████| 10/10 [05:15<00:00, 31.51s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.002255333479540612
Avg hit ratio: 0.8824446575872722
Avg ndcg: 0.9591149062196116
Avg compression ratio: 0.5252726970664778
Avg train time: 43.85186409950256
Std train time: 17.407380294550215
[0.8157894736842104, 0.3947368421052632, 0.026315789473684216, 0.8684210526315788, 0.6052631578947368, 0.7105263157894737, 0.9210526315789473, 0.4473684210526317, 0.07894736842105263, 0.13157894736842105]
[50, 50, 68, 50, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8255, 'time@10': 36.8888}:   0%|          | 0/10 [00:18<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8255, 'time@10': 36.8888}:  10%|█         | 1/10 [00:18<02:46, 18.50s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0014, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9576, 'compress@10': 0.6199, 'time@10': 35.3982}:  10%|█         | 1/10 [00:52<02:46, 18.50s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0014, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9576, 'compress@10': 0.6199, 'time@10': 35.3982}:  20%|██        | 2/10 [00:52<03:40, 27.59s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0009, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9241, 'compress@10': 0.4684, 'time@10': 29.1537}:  20%|██        | 2/10 [01:00<03:40, 27.59s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0009, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9241, 'compress@10': 0.4684, 'time@10': 29.1537}:  30%|███       | 3/10 [01:00<02:11, 18.81s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0015, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.9341, 'compress@10': 0.5696, 'time@10': 28.6381}:  30%|███       | 3/10 [01:27<02:11, 18.81s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0015, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.9341, 'compress@10': 0.5696, 'time@10': 28.6381}:  40%|████      | 4/10 [01:27<02:12, 22.10s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0015, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9433, 'compress@10': 0.5783, 'time@10': 38.3163}:  40%|████      | 4/10 [02:06<02:12, 22.10s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0015, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9433, 'compress@10': 0.5783, 'time@10': 38.3163}:  50%|█████     | 5/10 [02:06<02:20, 28.03s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0013, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9491, 'compress@10': 0.6014, 'time@10': 39.9503}:  50%|█████     | 5/10 [02:54<02:20, 28.03s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0013, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9491, 'compress@10': 0.6014, 'time@10': 39.9503}:  60%|██████    | 6/10 [02:54<02:19, 34.87s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0012, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9506, 'compress@10': 0.6475, 'time@10': 40.7545}:  60%|██████    | 6/10 [03:17<02:19, 34.87s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0012, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9506, 'compress@10': 0.6475, 'time@10': 40.7545}:  70%|███████   | 7/10 [03:17<01:32, 30.94s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0011, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9532, 'compress@10': 0.6245, 'time@10': 40.2589}:  70%|███████   | 7/10 [03:54<01:32, 30.94s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0011, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9532, 'compress@10': 0.6245, 'time@10': 40.2589}:  80%|████████  | 8/10 [03:54<01:05, 32.81s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.001, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9552, 'compress@10': 0.5668, 'time@10': 43.4548}:  80%|████████  | 8/10 [04:28<01:05, 32.81s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.001, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9552, 'compress@10': 0.5668, 'time@10': 43.4548}:  90%|█████████ | 9/10 [04:28<00:33, 33.35s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0009, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 43.6181}:  90%|█████████ | 9/10 [05:13<00:33, 33.35s/it]  {'epoch': 18, 'num_users': 6.3, 'loss': 0.0009, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 43.6181}: 100%|██████████| 10/10 [05:13<00:00, 36.99s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0009, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 43.6181}: 100%|██████████| 10/10 [05:13<00:00, 31.40s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.0008880659968651542
Avg hit ratio: 0.8920601209769291
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.525231896667318
Avg train time: 43.61813569068909
Std train time: 17.244504484320974
[0.8249999999999998, 0.42500000000000004, 0.025000000000000005, 0.8749999999999998, 0.625, 0.675, 0.9249999999999999, 0.4250000000000001, 0.075, 0.125]
[50, 50, 69, 50, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8342, 'time@10': 36.2423}:   0%|          | 0/10 [00:18<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8342, 'time@10': 36.2423}:  10%|█         | 1/10 [00:18<02:43, 18.16s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6389, 'time@10': 34.6582}:  10%|█         | 1/10 [00:51<02:43, 18.16s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6389, 'time@10': 34.6582}:  20%|██        | 2/10 [00:51<03:35, 26.95s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0005, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.4807, 'time@10': 28.643}:  20%|██        | 2/10 [00:59<03:35, 26.95s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0005, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.4807, 'time@10': 28.643}:  30%|███       | 3/10 [00:59<02:09, 18.46s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0013, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.5804, 'time@10': 28.1123}:  30%|███       | 3/10 [01:26<02:09, 18.46s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0013, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.5804, 'time@10': 28.1123}:  40%|████      | 4/10 [01:26<02:09, 21.66s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0024, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9437, 'compress@10': 0.5908, 'time@10': 37.9149}:  40%|████      | 4/10 [02:04<02:09, 21.66s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0024, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9437, 'compress@10': 0.5908, 'time@10': 37.9149}:  50%|█████     | 5/10 [02:04<02:18, 27.77s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0021, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9494, 'compress@10': 0.606, 'time@10': 39.5167}:  50%|█████     | 5/10 [02:52<02:18, 27.77s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0021, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9494, 'compress@10': 0.606, 'time@10': 39.5167}:  60%|██████    | 6/10 [02:52<02:17, 34.50s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0018, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9509, 'compress@10': 0.652, 'time@10': 40.1571}:  60%|██████    | 6/10 [03:14<02:17, 34.50s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0018, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9509, 'compress@10': 0.652, 'time@10': 40.1571}:  70%|███████   | 7/10 [03:14<01:31, 30.42s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0016, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9535, 'compress@10': 0.6257, 'time@10': 39.6034}:  70%|███████   | 7/10 [03:50<01:31, 30.42s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0016, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9535, 'compress@10': 0.6257, 'time@10': 39.6034}:  80%|████████  | 8/10 [03:50<01:04, 32.12s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0014, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9555, 'compress@10': 0.5675, 'time@10': 42.3941}:  80%|████████  | 8/10 [04:22<01:04, 32.12s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0014, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9555, 'compress@10': 0.5675, 'time@10': 42.3941}:  90%|█████████ | 9/10 [04:22<00:32, 32.21s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0013, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9576, 'compress@10': 0.5252, 'time@10': 42.5963}:  90%|█████████ | 9/10 [05:07<00:32, 32.21s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0013, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9576, 'compress@10': 0.5252, 'time@10': 42.5963}: 100%|██████████| 10/10 [05:07<00:00, 35.99s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0013, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9576, 'compress@10': 0.5252, 'time@10': 42.5963}: 100%|██████████| 10/10 [05:07<00:00, 30.70s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.0012800663255069114
Avg hit ratio: 0.8818942223594176
Avg ndcg: 0.9576338786123018
Avg compression ratio: 0.5251936232082979
Avg train time: 42.596259689331056
Std train time: 16.802055824813642
[0.7857142857142856, 0.45238095238095244, 0.023809523809523815, 0.8809523809523807, 0.6428571428571429, 0.6904761904761905, 0.8809523809523809, 0.4047619047619049, 0.11904761904761904, 0.11904761904761904]
[50, 50, 70, 51, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.797, 'time@10': 37.7268}:   0%|          | 0/10 [00:18<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.797, 'time@10': 37.7268}:  10%|█         | 1/10 [00:18<02:50, 18.90s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.6335, 'time@10': 34.5393}:  10%|█         | 1/10 [00:50<02:50, 18.90s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.6335, 'time@10': 34.5393}:  20%|██        | 2/10 [00:50<03:29, 26.25s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9241, 'compress@10': 0.4768, 'time@10': 28.2713}:  20%|██        | 2/10 [00:58<03:29, 26.25s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9241, 'compress@10': 0.4768, 'time@10': 28.2713}:  30%|███       | 3/10 [00:58<02:05, 17.88s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0015, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.9341, 'compress@10': 0.5789, 'time@10': 27.3757}:  30%|███       | 3/10 [01:22<02:05, 17.88s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0015, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.9341, 'compress@10': 0.5789, 'time@10': 27.3757}:  40%|████      | 4/10 [01:22<02:03, 20.58s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0014, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.9433, 'compress@10': 0.5931, 'time@10': 36.6342}:  40%|████      | 4/10 [01:59<02:03, 20.58s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0014, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.9433, 'compress@10': 0.5931, 'time@10': 36.6342}:  50%|█████     | 5/10 [01:59<02:12, 26.46s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0012, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9491, 'compress@10': 0.6105, 'time@10': 38.2957}:  50%|█████     | 5/10 [02:46<02:12, 26.46s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0012, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9491, 'compress@10': 0.6105, 'time@10': 38.2957}:  60%|██████    | 6/10 [02:46<02:13, 33.32s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0011, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9506, 'compress@10': 0.6498, 'time@10': 38.9685}:  60%|██████    | 6/10 [03:07<02:13, 33.32s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0011, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9506, 'compress@10': 0.6498, 'time@10': 38.9685}:  70%|███████   | 7/10 [03:07<01:28, 29.47s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.001, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9532, 'compress@10': 0.6213, 'time@10': 38.4939}:  70%|███████   | 7/10 [03:43<01:28, 29.47s/it]  {'epoch': 20, 'num_users': 6.125, 'loss': 0.001, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9532, 'compress@10': 0.6213, 'time@10': 38.4939}:  80%|████████  | 8/10 [03:43<01:02, 31.30s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0009, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.9552, 'compress@10': 0.5683, 'time@10': 41.6531}:  80%|████████  | 8/10 [04:16<01:02, 31.30s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0009, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.9552, 'compress@10': 0.5683, 'time@10': 41.6531}:  90%|█████████ | 9/10 [04:16<00:31, 31.99s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0008, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9574, 'compress@10': 0.5254, 'time@10': 41.8178}:  90%|█████████ | 9/10 [05:00<00:31, 31.99s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0008, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9574, 'compress@10': 0.5254, 'time@10': 41.8178}: 100%|██████████| 10/10 [05:00<00:00, 35.49s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0008, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9574, 'compress@10': 0.5254, 'time@10': 41.8178}: 100%|██████████| 10/10 [05:00<00:00, 30.00s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.0007957927655334815
Avg hit ratio: 0.8734052580130678
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5253605563555436
Avg train time: 41.81778507232666
Std train time: 16.779759125051097
[0.7499999999999999, 0.47727272727272735, 0.02272727272727273, 0.8863636363636361, 0.6590909090909092, 0.7045454545454546, 0.8863636363636364, 0.38636363636363646, 0.11363636363636363, 0.11363636363636363]
[50, 50, 71, 52, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7632, 'time@10': 37.8436}:   0%|          | 0/10 [00:18<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.7632, 'time@10': 37.8436}:  10%|█         | 1/10 [00:18<02:50, 18.96s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.6286, 'time@10': 34.6422}:  10%|█         | 1/10 [00:50<02:50, 18.96s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.6286, 'time@10': 34.6422}:  20%|██        | 2/10 [00:50<03:30, 26.32s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9241, 'compress@10': 0.4732, 'time@10': 28.782}:  20%|██        | 2/10 [00:59<03:30, 26.32s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9241, 'compress@10': 0.4732, 'time@10': 28.782}:  30%|███       | 3/10 [00:59<02:07, 18.22s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0013, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9341, 'compress@10': 0.5775, 'time@10': 27.8045}:  30%|███       | 3/10 [01:23<02:07, 18.22s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0013, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9341, 'compress@10': 0.5775, 'time@10': 27.8045}:  40%|████      | 4/10 [01:23<02:05, 20.86s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0021, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.9433, 'compress@10': 0.5952, 'time@10': 37.0728}:  40%|████      | 4/10 [02:01<02:05, 20.86s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0021, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.9433, 'compress@10': 0.5952, 'time@10': 37.0728}:  50%|█████     | 5/10 [02:01<02:13, 26.72s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0018, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.9491, 'compress@10': 0.6145, 'time@10': 38.6244}:  50%|█████     | 5/10 [02:47<02:13, 26.72s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0018, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.9491, 'compress@10': 0.6145, 'time@10': 38.6244}:  60%|██████    | 6/10 [02:47<02:13, 33.42s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0018, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9506, 'compress@10': 0.654, 'time@10': 39.3264}:  60%|██████    | 6/10 [03:09<02:13, 33.42s/it] {'epoch': 21, 'num_users': 6.2857, 'loss': 0.0018, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9506, 'compress@10': 0.654, 'time@10': 39.3264}:  70%|███████   | 7/10 [03:09<01:28, 29.62s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0016, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9532, 'compress@10': 0.6227, 'time@10': 38.8877}:  70%|███████   | 7/10 [03:45<01:28, 29.62s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0016, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9532, 'compress@10': 0.6227, 'time@10': 38.8877}:  80%|████████  | 8/10 [03:45<01:03, 31.61s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0015, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.9552, 'compress@10': 0.569, 'time@10': 42.0379}:  80%|████████  | 8/10 [04:18<01:03, 31.61s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0015, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.9552, 'compress@10': 0.569, 'time@10': 42.0379}:  90%|█████████ | 9/10 [04:18<00:32, 32.25s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0013, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.9574, 'compress@10': 0.5255, 'time@10': 42.143}:  90%|█████████ | 9/10 [05:01<00:32, 32.25s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0013, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.9574, 'compress@10': 0.5255, 'time@10': 42.143}: 100%|██████████| 10/10 [05:01<00:00, 35.61s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0013, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.9574, 'compress@10': 0.5255, 'time@10': 42.143}: 100%|██████████| 10/10 [05:01<00:00, 30.19s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.0013331537329284487
Avg hit ratio: 0.8692624008702108
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.525459692963038
Avg train time: 42.14296438694
Std train time: 16.658965455105378
[0.7608695652173912, 0.45652173913043487, 0.02173913043478261, 0.8913043478260867, 0.673913043478261, 0.7173913043478262, 0.8913043478260869, 0.36956521739130443, 0.10869565217391304, 0.10869565217391304]
[50, 50, 72, 53, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7734, 'time@10': 37.4049}:   0%|          | 0/10 [00:18<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7734, 'time@10': 37.4049}:  10%|█         | 1/10 [00:18<02:48, 18.74s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6237, 'time@10': 35.0216}:  10%|█         | 1/10 [00:51<02:48, 18.74s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6237, 'time@10': 35.0216}:  20%|██        | 2/10 [00:51<03:35, 26.95s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.4697, 'time@10': 28.9252}:  20%|██        | 2/10 [00:59<03:35, 26.95s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.4697, 'time@10': 28.9252}:  30%|███       | 3/10 [00:59<02:09, 18.49s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0009, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.576, 'time@10': 28.0551}:  30%|███       | 3/10 [01:25<02:09, 18.49s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0009, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.576, 'time@10': 28.0551}:  40%|████      | 4/10 [01:25<02:07, 21.25s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9433, 'compress@10': 0.5969, 'time@10': 37.158}:  40%|████      | 4/10 [02:02<02:07, 21.25s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9433, 'compress@10': 0.5969, 'time@10': 37.158}:  50%|█████     | 5/10 [02:02<02:14, 26.86s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0008, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9491, 'compress@10': 0.618, 'time@10': 38.8789}:  50%|█████     | 5/10 [02:49<02:14, 26.86s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0008, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9491, 'compress@10': 0.618, 'time@10': 38.8789}:  60%|██████    | 6/10 [02:49<02:15, 33.89s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0016, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9506, 'compress@10': 0.6577, 'time@10': 39.3764}:  60%|██████    | 6/10 [03:10<02:15, 33.89s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0016, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9506, 'compress@10': 0.6577, 'time@10': 39.3764}:  70%|███████   | 7/10 [03:10<01:29, 29.75s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0014, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9532, 'compress@10': 0.6239, 'time@10': 38.9057}:  70%|███████   | 7/10 [03:46<01:29, 29.75s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0014, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9532, 'compress@10': 0.6239, 'time@10': 38.9057}:  80%|████████  | 8/10 [03:46<01:03, 31.63s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0012, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.9552, 'compress@10': 0.5695, 'time@10': 42.2037}:  80%|████████  | 8/10 [04:20<01:03, 31.63s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0012, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.9552, 'compress@10': 0.5695, 'time@10': 42.2037}:  90%|█████████ | 9/10 [04:20<00:32, 32.47s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0011, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9574, 'compress@10': 0.5255, 'time@10': 42.2483}:  90%|█████████ | 9/10 [05:03<00:32, 32.47s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0011, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9574, 'compress@10': 0.5255, 'time@10': 42.2483}: 100%|██████████| 10/10 [05:03<00:00, 35.63s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0011, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9574, 'compress@10': 0.5255, 'time@10': 42.2483}: 100%|██████████| 10/10 [05:03<00:00, 30.36s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.0011229406213789526
Avg hit ratio: 0.8761799366451319
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5254613398478487
Avg train time: 42.248259329795836
Std train time: 16.720151905649942
[0.7708333333333333, 0.47916666666666674, 0.020833333333333336, 0.895833333333333, 0.6875000000000001, 0.6875000000000001, 0.8958333333333333, 0.35416666666666674, 0.10416666666666666, 0.10416666666666666]
[50, 50, 73, 54, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7829, 'time@10': 37.26}:   0%|          | 0/10 [00:18<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7829, 'time@10': 37.26}:  10%|█         | 1/10 [00:18<02:48, 18.67s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0006, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9576, 'compress@10': 0.6394, 'time@10': 34.9859}:  10%|█         | 1/10 [00:51<02:48, 18.67s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0006, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9576, 'compress@10': 0.6394, 'time@10': 34.9859}:  20%|██        | 2/10 [00:51<03:35, 26.95s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9241, 'compress@10': 0.4799, 'time@10': 28.8172}:  20%|██        | 2/10 [00:59<03:35, 26.95s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9241, 'compress@10': 0.4799, 'time@10': 28.8172}:  30%|███       | 3/10 [00:59<02:09, 18.43s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0012, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.9341, 'compress@10': 0.5848, 'time@10': 28.0497}:  30%|███       | 3/10 [01:25<02:09, 18.43s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0012, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.9341, 'compress@10': 0.5848, 'time@10': 28.0497}:  40%|████      | 4/10 [01:25<02:07, 21.33s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0022, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9459, 'compress@10': 0.6066, 'time@10': 37.0801}:  40%|████      | 4/10 [02:02<02:07, 21.33s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0022, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9459, 'compress@10': 0.6066, 'time@10': 37.0801}:  50%|█████     | 5/10 [02:02<02:14, 26.86s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0019, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9512, 'compress@10': 0.6212, 'time@10': 38.7514}:  50%|█████     | 5/10 [02:49<02:14, 26.86s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0019, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9512, 'compress@10': 0.6212, 'time@10': 38.7514}:  60%|██████    | 6/10 [02:49<02:15, 33.76s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0018, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9525, 'compress@10': 0.661, 'time@10': 39.4017}:  60%|██████    | 6/10 [03:11<02:15, 33.76s/it] {'epoch': 23, 'num_users': 6.2857, 'loss': 0.0018, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9525, 'compress@10': 0.661, 'time@10': 39.4017}:  70%|███████   | 7/10 [03:11<01:29, 29.82s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0016, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9549, 'compress@10': 0.625, 'time@10': 39.0861}:  70%|███████   | 7/10 [03:47<01:29, 29.82s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0016, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9549, 'compress@10': 0.625, 'time@10': 39.0861}:  80%|████████  | 8/10 [03:47<01:04, 32.08s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0015, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9567, 'compress@10': 0.57, 'time@10': 42.2102}:  80%|████████  | 8/10 [04:21<01:04, 32.08s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0015, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9567, 'compress@10': 0.57, 'time@10': 42.2102}:  90%|█████████ | 9/10 [04:21<00:32, 32.56s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0013, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9588, 'compress@10': 0.5254, 'time@10': 42.2758}:  90%|█████████ | 9/10 [05:04<00:32, 32.56s/it] {'epoch': 23, 'num_users': 6.3, 'loss': 0.0013, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9588, 'compress@10': 0.5254, 'time@10': 42.2758}: 100%|██████████| 10/10 [05:04<00:00, 35.76s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0013, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9588, 'compress@10': 0.5254, 'time@10': 42.2758}: 100%|██████████| 10/10 [05:04<00:00, 30.45s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.001309404058805815
Avg hit ratio: 0.8823192095585984
Avg ndcg: 0.9587518875315173
Avg compression ratio: 0.5254205018137672
Avg train time: 42.27578675746918
Std train time: 16.39187782660372
[0.7799999999999999, 0.5000000000000001, 0.020000000000000004, 0.8999999999999997, 0.7000000000000001, 0.6600000000000001, 0.8999999999999999, 0.3400000000000001, 0.09999999999999999, 0.09999999999999999]
[50, 50, 74, 55, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0012, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7916, 'time@10': 38.9189}:   0%|          | 0/10 [00:19<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0012, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7916, 'time@10': 38.9189}:  10%|█         | 1/10 [00:19<02:55, 19.50s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0008, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6538, 'time@10': 35.8009}:  10%|█         | 1/10 [00:52<02:55, 19.50s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0008, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6538, 'time@10': 35.8009}:  20%|██        | 2/10 [00:52<03:38, 27.28s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0005, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.4892, 'time@10': 29.6155}:  20%|██        | 2/10 [01:00<03:38, 27.28s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0005, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.4892, 'time@10': 29.6155}:  30%|███       | 3/10 [01:00<02:11, 18.77s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0012, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9341, 'compress@10': 0.5928, 'time@10': 28.8729}:  30%|███       | 3/10 [01:27<02:11, 18.77s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0012, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9341, 'compress@10': 0.5928, 'time@10': 28.8729}:  40%|████      | 4/10 [01:27<02:11, 21.90s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0017, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9433, 'compress@10': 0.6155, 'time@10': 38.0187}:  40%|████      | 4/10 [02:04<02:11, 21.90s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0017, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9433, 'compress@10': 0.6155, 'time@10': 38.0187}:  50%|█████     | 5/10 [02:04<02:17, 27.46s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0014, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9491, 'compress@10': 0.6241, 'time@10': 39.4211}:  50%|█████     | 5/10 [02:51<02:17, 27.46s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0014, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9491, 'compress@10': 0.6241, 'time@10': 39.4211}:  60%|██████    | 6/10 [02:51<02:15, 33.93s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0016, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9506, 'compress@10': 0.6641, 'time@10': 39.8176}:  60%|██████    | 6/10 [03:12<02:15, 33.93s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0016, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9506, 'compress@10': 0.6641, 'time@10': 39.8176}:  70%|███████   | 7/10 [03:12<01:29, 29.74s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0014, 'hit_ratio@10': 0.9201, 'ndcg@10': 0.9532, 'compress@10': 0.626, 'time@10': 39.6673}:  70%|███████   | 7/10 [03:51<01:29, 29.74s/it]  {'epoch': 24, 'num_users': 6.125, 'loss': 0.0014, 'hit_ratio@10': 0.9201, 'ndcg@10': 0.9532, 'compress@10': 0.626, 'time@10': 39.6673}:  80%|████████  | 8/10 [03:51<01:05, 32.59s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0013, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9552, 'compress@10': 0.5704, 'time@10': 43.529}:  80%|████████  | 8/10 [04:28<01:05, 32.59s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0013, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9552, 'compress@10': 0.5704, 'time@10': 43.529}:  90%|█████████ | 9/10 [04:28<00:34, 34.05s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0012, 'hit_ratio@10': 0.9195, 'ndcg@10': 0.9574, 'compress@10': 0.5254, 'time@10': 43.8649}:  90%|█████████ | 9/10 [05:15<00:34, 34.05s/it]  {'epoch': 24, 'num_users': 6.3, 'loss': 0.0012, 'hit_ratio@10': 0.9195, 'ndcg@10': 0.9574, 'compress@10': 0.5254, 'time@10': 43.8649}: 100%|██████████| 10/10 [05:15<00:00, 38.03s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0012, 'hit_ratio@10': 0.9195, 'ndcg@10': 0.9574, 'compress@10': 0.5254, 'time@10': 43.8649}: 100%|██████████| 10/10 [05:15<00:00, 31.54s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.001161894979761669
Avg hit ratio: 0.91948510817611
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5253837383705872
Avg train time: 43.864886140823366
Std train time: 17.547887894077817
[0.7884615384615383, 0.5192307692307694, 0.019230769230769235, 0.9038461538461535, 0.7115384615384616, 0.6346153846153848, 0.9038461538461537, 0.326923076923077, 0.09615384615384615, 0.09615384615384615]
[50, 50, 75, 55, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7996, 'time@10': 40.0069}:   0%|          | 0/10 [00:20<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7996, 'time@10': 40.0069}:  10%|█         | 1/10 [00:20<03:00, 20.04s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6672, 'time@10': 37.4926}:  10%|█         | 1/10 [00:55<03:00, 20.04s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6672, 'time@10': 37.4926}:  20%|██        | 2/10 [00:55<03:50, 28.85s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.4979, 'time@10': 31.2435}:  20%|██        | 2/10 [01:04<03:50, 28.85s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.4979, 'time@10': 31.2435}:  30%|███       | 3/10 [01:04<02:19, 19.98s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0009, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.6002, 'time@10': 30.3568}:  30%|███       | 3/10 [01:32<02:19, 19.98s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0009, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.6002, 'time@10': 30.3568}:  40%|████      | 4/10 [01:32<02:18, 23.04s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0019, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9434, 'compress@10': 0.6236, 'time@10': 39.7638}:  40%|████      | 4/10 [02:10<02:18, 23.04s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0019, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9434, 'compress@10': 0.6236, 'time@10': 39.7638}:  50%|█████     | 5/10 [02:10<02:23, 28.70s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0016, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9491, 'compress@10': 0.6268, 'time@10': 41.5457}:  50%|█████     | 5/10 [03:01<02:23, 28.70s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0016, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9491, 'compress@10': 0.6268, 'time@10': 41.5457}:  60%|██████    | 6/10 [03:01<02:24, 36.11s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0016, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9507, 'compress@10': 0.6669, 'time@10': 42.056}:  60%|██████    | 6/10 [03:24<02:24, 36.11s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.0016, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9507, 'compress@10': 0.6669, 'time@10': 42.056}:  70%|███████   | 7/10 [03:24<01:35, 31.70s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0014, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9533, 'compress@10': 0.6269, 'time@10': 41.6696}:  70%|███████   | 7/10 [04:03<01:35, 31.70s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0014, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9533, 'compress@10': 0.6269, 'time@10': 41.6696}:  80%|████████  | 8/10 [04:03<01:08, 34.03s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0013, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9553, 'compress@10': 0.5708, 'time@10': 44.9123}:  80%|████████  | 8/10 [04:38<01:08, 34.03s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0013, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9553, 'compress@10': 0.5708, 'time@10': 44.9123}:  90%|█████████ | 9/10 [04:38<00:34, 34.48s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0012, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9575, 'compress@10': 0.5253, 'time@10': 45.1025}:  90%|█████████ | 9/10 [05:25<00:34, 34.48s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0012, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9575, 'compress@10': 0.5253, 'time@10': 45.1025}: 100%|██████████| 10/10 [05:25<00:00, 38.30s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0012, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9575, 'compress@10': 0.5253, 'time@10': 45.1025}: 100%|██████████| 10/10 [05:25<00:00, 32.54s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.0011599897623308377
Avg hit ratio: 0.8984021588673541
Avg ndcg: 0.9574832483940577
Avg compression ratio: 0.5253495383150384
Avg train time: 45.10249984264374
Std train time: 17.032577715361832
[0.7962962962962962, 0.5000000000000001, 0.018518518518518524, 0.9074074074074071, 0.7222222222222222, 0.6111111111111113, 0.9074074074074073, 0.3148148148148149, 0.12962962962962962, 0.09259259259259259]
[50, 50, 76, 55, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.001, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.807, 'time@10': 40.9039}:   0%|          | 0/10 [00:20<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.001, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.807, 'time@10': 40.9039}:  10%|█         | 1/10 [00:20<03:04, 20.50s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0006, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6616, 'time@10': 38.0876}:  10%|█         | 1/10 [00:55<03:04, 20.50s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0006, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6616, 'time@10': 38.0876}:  20%|██        | 2/10 [00:55<03:53, 29.23s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.494, 'time@10': 31.8228}:  20%|██        | 2/10 [01:05<03:53, 29.23s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.494, 'time@10': 31.8228}:  30%|███       | 3/10 [01:05<02:22, 20.31s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0012, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9341, 'compress@10': 0.5981, 'time@10': 30.9801}:  30%|███       | 3/10 [01:34<02:22, 20.31s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0012, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9341, 'compress@10': 0.5981, 'time@10': 30.9801}:  40%|████      | 4/10 [01:34<02:21, 23.54s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0015, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9433, 'compress@10': 0.6241, 'time@10': 40.2868}:  40%|████      | 4/10 [02:12<02:21, 23.54s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0015, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9433, 'compress@10': 0.6241, 'time@10': 40.2868}:  50%|█████     | 5/10 [02:12<02:25, 29.05s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0012, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9491, 'compress@10': 0.6233, 'time@10': 42.1182}:  50%|█████     | 5/10 [03:04<02:25, 29.05s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0012, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9491, 'compress@10': 0.6233, 'time@10': 42.1182}:  60%|██████    | 6/10 [03:04<02:26, 36.62s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0012, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9506, 'compress@10': 0.6645, 'time@10': 42.6919}:  60%|██████    | 6/10 [03:27<02:26, 36.62s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0012, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9506, 'compress@10': 0.6645, 'time@10': 42.6919}:  70%|███████   | 7/10 [03:27<01:36, 32.20s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0011, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9532, 'compress@10': 0.6232, 'time@10': 42.0868}:  70%|███████   | 7/10 [04:05<01:36, 32.20s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0011, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9532, 'compress@10': 0.6232, 'time@10': 42.0868}:  80%|████████  | 8/10 [04:05<01:08, 34.01s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.001, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9552, 'compress@10': 0.5711, 'time@10': 45.5685}:  80%|████████  | 8/10 [04:41<01:08, 34.01s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.001, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9552, 'compress@10': 0.5711, 'time@10': 45.5685}:  90%|█████████ | 9/10 [04:41<00:34, 34.87s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0009, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 45.6451}:  90%|█████████ | 9/10 [05:28<00:34, 34.87s/it]  {'epoch': 26, 'num_users': 6.3, 'loss': 0.0009, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 45.6451}: 100%|██████████| 10/10 [05:28<00:00, 38.42s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0009, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 45.6451}: 100%|██████████| 10/10 [05:28<00:00, 32.83s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.000905780101517463
Avg hit ratio: 0.8916243810895763
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5253305114550941
Avg train time: 45.645085501670835
Std train time: 17.321739517507282
[0.8035714285714285, 0.48214285714285726, 0.017857142857142863, 0.9107142857142855, 0.7321428571428571, 0.5892857142857144, 0.9107142857142856, 0.33928571428571436, 0.125, 0.08928571428571427]
[50, 50, 77, 55, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8139, 'time@10': 40.1166}:   0%|          | 0/10 [00:20<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8139, 'time@10': 40.1166}:  10%|█         | 1/10 [00:20<03:00, 20.10s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6564, 'time@10': 37.1178}:  10%|█         | 1/10 [00:54<03:00, 20.10s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6564, 'time@10': 37.1178}:  20%|██        | 2/10 [00:54<03:46, 28.37s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.4903, 'time@10': 31.0866}:  20%|██        | 2/10 [01:03<03:46, 28.37s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.4903, 'time@10': 31.0866}:  30%|███       | 3/10 [01:03<02:18, 19.79s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.001, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9341, 'compress@10': 0.5962, 'time@10': 30.4114}:  30%|███       | 3/10 [01:32<02:18, 19.79s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.001, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9341, 'compress@10': 0.5962, 'time@10': 30.4114}:  40%|████      | 4/10 [01:32<02:19, 23.20s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0019, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9435, 'compress@10': 0.6245, 'time@10': 39.6588}:  40%|████      | 4/10 [02:10<02:19, 23.20s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0019, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9435, 'compress@10': 0.6245, 'time@10': 39.6588}:  50%|█████     | 5/10 [02:10<02:23, 28.67s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0016, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9492, 'compress@10': 0.6201, 'time@10': 41.583}:  50%|█████     | 5/10 [03:01<02:23, 28.67s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0016, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9492, 'compress@10': 0.6201, 'time@10': 41.583}:  60%|██████    | 6/10 [03:01<02:25, 36.35s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0017, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9508, 'compress@10': 0.6621, 'time@10': 42.4434}:  60%|██████    | 6/10 [03:25<02:25, 36.35s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0017, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9508, 'compress@10': 0.6621, 'time@10': 42.4434}:  70%|███████   | 7/10 [03:25<01:36, 32.26s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0015, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9533, 'compress@10': 0.6241, 'time@10': 42.0325}:  70%|███████   | 7/10 [04:04<01:36, 32.26s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0015, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9533, 'compress@10': 0.6241, 'time@10': 42.0325}:  80%|████████  | 8/10 [04:04<01:08, 34.48s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0013, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9554, 'compress@10': 0.5715, 'time@10': 45.4651}:  80%|████████  | 8/10 [04:41<01:08, 34.48s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0013, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9554, 'compress@10': 0.5715, 'time@10': 45.4651}:  90%|█████████ | 9/10 [04:41<00:35, 35.11s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0012, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9575, 'compress@10': 0.5253, 'time@10': 45.5825}:  90%|█████████ | 9/10 [05:28<00:35, 35.11s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0012, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9575, 'compress@10': 0.5253, 'time@10': 45.5825}: 100%|██████████| 10/10 [05:28<00:00, 38.68s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0012, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9575, 'compress@10': 0.5253, 'time@10': 45.5825}: 100%|██████████| 10/10 [05:28<00:00, 32.81s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.0012104076303501615
Avg hit ratio: 0.897338666803862
Avg ndcg: 0.9575423921987968
Avg compression ratio: 0.5253140353673886
Avg train time: 45.582545971870424
Std train time: 17.18503660183557
[0.8103448275862069, 0.46551724137931044, 0.017241379310344834, 0.9137931034482756, 0.7413793103448275, 0.5689655172413794, 0.9137931034482757, 0.36206896551724144, 0.1206896551724138, 0.08620689655172413]
[50, 50, 78, 55, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0012, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8203, 'time@10': 39.8787}:   0%|          | 0/10 [00:19<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0012, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8203, 'time@10': 39.8787}:  10%|█         | 1/10 [00:19<02:59, 19.98s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0008, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.6515, 'time@10': 37.1674}:  10%|█         | 1/10 [00:54<02:59, 19.98s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0008, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.6515, 'time@10': 37.1674}:  20%|██        | 2/10 [00:54<03:48, 28.52s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0006, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.9241, 'compress@10': 0.4869, 'time@10': 31.5484}:  20%|██        | 2/10 [01:04<03:48, 28.52s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0006, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.9241, 'compress@10': 0.4869, 'time@10': 31.5484}:  30%|███       | 3/10 [01:04<02:21, 20.15s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0011, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9341, 'compress@10': 0.5944, 'time@10': 30.906}:  30%|███       | 3/10 [01:33<02:21, 20.15s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0011, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9341, 'compress@10': 0.5944, 'time@10': 30.906}:  40%|████      | 4/10 [01:33<02:21, 23.65s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0015, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9433, 'compress@10': 0.6248, 'time@10': 40.3685}:  40%|████      | 4/10 [02:12<02:21, 23.65s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0015, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9433, 'compress@10': 0.6248, 'time@10': 40.3685}:  50%|█████     | 5/10 [02:12<02:26, 29.24s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0013, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9491, 'compress@10': 0.6171, 'time@10': 42.1021}:  50%|█████     | 5/10 [03:03<02:26, 29.24s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0013, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9491, 'compress@10': 0.6171, 'time@10': 42.1021}:  60%|██████    | 6/10 [03:03<02:26, 36.57s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0015, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9506, 'compress@10': 0.66, 'time@10': 42.1663}:  60%|██████    | 6/10 [03:24<02:26, 36.57s/it]   {'epoch': 28, 'num_users': 6.2857, 'loss': 0.0015, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9506, 'compress@10': 0.66, 'time@10': 42.1663}:  70%|███████   | 7/10 [03:24<01:34, 31.58s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0013, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9532, 'compress@10': 0.625, 'time@10': 41.3135}:  70%|███████   | 7/10 [04:00<01:34, 31.58s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0013, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9532, 'compress@10': 0.625, 'time@10': 41.3135}:  80%|████████  | 8/10 [04:00<01:05, 32.79s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0012, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9552, 'compress@10': 0.5718, 'time@10': 44.2543}:  80%|████████  | 8/10 [04:34<01:05, 32.79s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0012, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9552, 'compress@10': 0.5718, 'time@10': 44.2543}:  90%|█████████ | 9/10 [04:34<00:33, 33.15s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0011, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 44.1275}:  90%|█████████ | 9/10 [05:17<00:33, 33.15s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0011, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 44.1275}: 100%|██████████| 10/10 [05:17<00:00, 36.20s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0011, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 44.1275}: 100%|██████████| 10/10 [05:17<00:00, 31.73s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.0010992888914859269
Avg hit ratio: 0.9053842646694937
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5252982971291063
Avg train time: 44.127470421791074
Std train time: 16.598519342719666
[0.8166666666666667, 0.48333333333333345, 0.016666666666666673, 0.9166666666666664, 0.7499999999999999, 0.5500000000000002, 0.9166666666666665, 0.35000000000000003, 0.11666666666666667, 0.08333333333333333]
[50, 50, 79, 55, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0008, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8263, 'time@10': 34.075}:   0%|          | 0/10 [00:17<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0008, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8263, 'time@10': 34.075}:  10%|█         | 1/10 [00:17<02:33, 17.07s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0006, 'hit_ratio@10': 0.9312, 'ndcg@10': 0.9576, 'compress@10': 0.6632, 'time@10': 33.2459}:  10%|█         | 1/10 [00:49<02:33, 17.07s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0006, 'hit_ratio@10': 0.9312, 'ndcg@10': 0.9576, 'compress@10': 0.6632, 'time@10': 33.2459}:  20%|██        | 2/10 [00:49<03:28, 26.12s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.9241, 'compress@10': 0.4945, 'time@10': 28.0341}:  20%|██        | 2/10 [00:58<03:28, 26.12s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.9241, 'compress@10': 0.4945, 'time@10': 28.0341}:  30%|███       | 3/10 [00:58<02:07, 18.23s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0009, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9341, 'compress@10': 0.6008, 'time@10': 27.8128}:  30%|███       | 3/10 [01:25<02:07, 18.23s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0009, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9341, 'compress@10': 0.6008, 'time@10': 27.8128}:  40%|████      | 4/10 [01:25<02:10, 21.77s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0015, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9433, 'compress@10': 0.6316, 'time@10': 36.1978}:  40%|████      | 4/10 [02:00<02:10, 21.77s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0015, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9433, 'compress@10': 0.6316, 'time@10': 36.1978}:  50%|█████     | 5/10 [02:00<02:12, 26.50s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0013, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9491, 'compress@10': 0.6197, 'time@10': 38.0543}:  50%|█████     | 5/10 [02:47<02:12, 26.50s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0013, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9491, 'compress@10': 0.6197, 'time@10': 38.0543}:  60%|██████    | 6/10 [02:47<02:14, 33.60s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0016, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9506, 'compress@10': 0.6626, 'time@10': 38.7609}:  60%|██████    | 6/10 [03:09<02:14, 33.60s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0016, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9506, 'compress@10': 0.6626, 'time@10': 38.7609}:  70%|███████   | 7/10 [03:09<01:28, 29.66s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0014, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9532, 'compress@10': 0.6258, 'time@10': 38.4765}:  70%|███████   | 7/10 [03:45<01:28, 29.66s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0014, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9532, 'compress@10': 0.6258, 'time@10': 38.4765}:  80%|████████  | 8/10 [03:45<01:03, 31.84s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0013, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9552, 'compress@10': 0.5721, 'time@10': 41.5074}:  80%|████████  | 8/10 [04:18<01:03, 31.84s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0013, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9552, 'compress@10': 0.5721, 'time@10': 41.5074}:  90%|█████████ | 9/10 [04:18<00:32, 32.18s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0011, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 41.5915}:  90%|█████████ | 9/10 [05:01<00:32, 32.18s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0011, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 41.5915}: 100%|██████████| 10/10 [05:01<00:00, 35.33s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0011, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 41.5915}: 100%|██████████| 10/10 [05:01<00:00, 30.12s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.0011429936749171713
Avg hit ratio: 0.9036100711211068
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.525273215912242
Avg train time: 41.59145839214325
Std train time: 15.369049049042333
[0.8225806451612903, 0.5000000000000001, 0.016129032258064523, 0.9193548387096772, 0.7580645161290321, 0.5322580645161292, 0.9193548387096773, 0.33870967741935487, 0.11290322580645161, 0.08064516129032258]
[50, 50, 80, 55, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0008, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8319, 'time@10': 33.8073}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0008, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8319, 'time@10': 33.8073}:  10%|█         | 1/10 [00:16<02:32, 16.94s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.9312, 'ndcg@10': 0.9576, 'compress@10': 0.674, 'time@10': 32.5705}:  10%|█         | 1/10 [00:48<02:32, 16.94s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.9312, 'ndcg@10': 0.9576, 'compress@10': 0.674, 'time@10': 32.5705}:  20%|██        | 2/10 [00:48<03:23, 25.43s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.9241, 'compress@10': 0.5016, 'time@10': 27.4588}:  20%|██        | 2/10 [00:56<03:23, 25.43s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.9241, 'compress@10': 0.5016, 'time@10': 27.4588}:  30%|███       | 3/10 [00:56<02:04, 17.77s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0009, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9341, 'compress@10': 0.6067, 'time@10': 27.5148}:  30%|███       | 3/10 [01:24<02:04, 17.77s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0009, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9341, 'compress@10': 0.6067, 'time@10': 27.5148}:  40%|████      | 4/10 [01:24<02:10, 21.70s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0014, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9433, 'compress@10': 0.638, 'time@10': 35.4111}:  40%|████      | 4/10 [01:58<02:10, 21.70s/it] {'epoch': 30, 'num_users': 5.8, 'loss': 0.0014, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9433, 'compress@10': 0.638, 'time@10': 35.4111}:  50%|█████     | 5/10 [01:58<02:09, 25.98s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0012, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9491, 'compress@10': 0.6221, 'time@10': 37.08}:  50%|█████     | 5/10 [02:43<02:09, 25.98s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0012, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9491, 'compress@10': 0.6221, 'time@10': 37.08}:  60%|██████    | 6/10 [02:43<02:10, 32.60s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0012, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9506, 'compress@10': 0.665, 'time@10': 38.306}:  60%|██████    | 6/10 [03:06<02:10, 32.60s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0012, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9506, 'compress@10': 0.665, 'time@10': 38.306}:  70%|███████   | 7/10 [03:06<01:28, 29.42s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0011, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9532, 'compress@10': 0.6266, 'time@10': 38.024}:  70%|███████   | 7/10 [03:42<01:28, 29.42s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0011, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9532, 'compress@10': 0.6266, 'time@10': 38.024}:  80%|████████  | 8/10 [03:42<01:03, 31.55s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.001, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9552, 'compress@10': 0.5723, 'time@10': 40.9915}:  80%|████████  | 8/10 [04:15<01:03, 31.55s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.001, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9552, 'compress@10': 0.5723, 'time@10': 40.9915}:  90%|█████████ | 9/10 [04:15<00:31, 31.82s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0009, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 41.2749}:  90%|█████████ | 9/10 [04:58<00:31, 31.82s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0009, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 41.2749}: 100%|██████████| 10/10 [04:58<00:00, 35.54s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0009, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 41.2749}: 100%|██████████| 10/10 [04:58<00:00, 29.90s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.0009135194993691824
Avg hit ratio: 0.8910386425496781
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5252454158873292
Avg train time: 41.27488696575165
Std train time: 14.830093952888035
[0.8281249999999999, 0.5156250000000001, 0.015625000000000007, 0.9218749999999998, 0.7656249999999999, 0.5156250000000002, 0.9218749999999999, 0.32812500000000006, 0.109375, 0.078125]
[50, 50, 81, 55, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8372, 'time@10': 33.6744}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8372, 'time@10': 33.6744}:  10%|█         | 1/10 [00:16<02:31, 16.87s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.6842, 'time@10': 32.461}:  10%|█         | 1/10 [00:48<02:31, 16.87s/it] {'epoch': 31, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.6842, 'time@10': 32.461}:  20%|██        | 2/10 [00:48<03:22, 25.35s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9241, 'compress@10': 0.5082, 'time@10': 27.9114}:  20%|██        | 2/10 [00:57<03:22, 25.35s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9241, 'compress@10': 0.5082, 'time@10': 27.9114}:  30%|███       | 3/10 [00:57<02:06, 18.09s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0008, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9341, 'compress@10': 0.6123, 'time@10': 27.665}:  30%|███       | 3/10 [01:24<02:06, 18.09s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0008, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9341, 'compress@10': 0.6123, 'time@10': 27.665}:  40%|████      | 4/10 [01:24<02:09, 21.59s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0016, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.9444, 'compress@10': 0.6439, 'time@10': 35.4652}:  40%|████      | 4/10 [01:57<02:09, 21.59s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0016, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.9444, 'compress@10': 0.6439, 'time@10': 35.4652}:  50%|█████     | 5/10 [01:57<02:09, 25.84s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0014, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.95, 'compress@10': 0.6243, 'time@10': 37.2218}:  50%|█████     | 5/10 [02:43<02:09, 25.84s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0014, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.95, 'compress@10': 0.6243, 'time@10': 37.2218}:  60%|██████    | 6/10 [02:43<02:10, 32.71s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0014, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9514, 'compress@10': 0.6673, 'time@10': 38.3558}:  60%|██████    | 6/10 [03:06<02:10, 32.71s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0014, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9514, 'compress@10': 0.6673, 'time@10': 38.3558}:  70%|███████   | 7/10 [03:06<01:28, 29.41s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0012, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9539, 'compress@10': 0.6273, 'time@10': 38.0139}:  70%|███████   | 7/10 [03:42<01:28, 29.41s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0012, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9539, 'compress@10': 0.6273, 'time@10': 38.0139}:  80%|████████  | 8/10 [03:42<01:02, 31.40s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0011, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9559, 'compress@10': 0.5726, 'time@10': 40.9802}:  80%|████████  | 8/10 [04:14<01:02, 31.40s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0011, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9559, 'compress@10': 0.5726, 'time@10': 40.9802}:  90%|█████████ | 9/10 [04:14<00:31, 31.71s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.001, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.958, 'compress@10': 0.5252, 'time@10': 41.1641}:  90%|█████████ | 9/10 [04:57<00:31, 31.71s/it]     {'epoch': 31, 'num_users': 6.3, 'loss': 0.001, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.958, 'compress@10': 0.5252, 'time@10': 41.1641}: 100%|██████████| 10/10 [04:57<00:00, 35.15s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.001, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.958, 'compress@10': 0.5252, 'time@10': 41.1641}: 100%|██████████| 10/10 [04:57<00:00, 29.75s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.001002940818639209
Avg hit ratio: 0.884853286686903
Avg ndcg: 0.957999593002629
Avg compression ratio: 0.5252220668746529
Avg train time: 41.16409006118774
Std train time: 14.609776879968589
[0.8333333333333333, 0.5303030303030304, 0.015151515151515159, 0.924242424242424, 0.7727272727272726, 0.5000000000000002, 0.9242424242424241, 0.31818181818181823, 0.10606060606060606, 0.07575757575757576]
[50, 50, 82, 55, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8421, 'time@10': 32.9977}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8421, 'time@10': 32.9977}:  10%|█         | 1/10 [00:16<02:28, 16.55s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0006, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.6938, 'time@10': 32.6319}:  10%|█         | 1/10 [00:48<02:28, 16.55s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0006, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.6938, 'time@10': 32.6319}:  20%|██        | 2/10 [00:48<03:26, 25.82s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.5145, 'time@10': 27.7865}:  20%|██        | 2/10 [00:57<03:26, 25.82s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.5145, 'time@10': 27.7865}:  30%|███       | 3/10 [00:57<02:07, 18.18s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0006, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.9341, 'compress@10': 0.6176, 'time@10': 27.5648}:  30%|███       | 3/10 [01:24<02:07, 18.18s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0006, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.9341, 'compress@10': 0.6176, 'time@10': 27.5648}:  40%|████      | 4/10 [01:24<02:09, 21.63s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0013, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9433, 'compress@10': 0.6495, 'time@10': 35.5676}:  40%|████      | 4/10 [01:58<02:09, 21.63s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0013, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9433, 'compress@10': 0.6495, 'time@10': 35.5676}:  50%|█████     | 5/10 [01:58<02:10, 26.03s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0011, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.9491, 'compress@10': 0.6264, 'time@10': 37.4647}:  50%|█████     | 5/10 [02:45<02:10, 26.03s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0011, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.9491, 'compress@10': 0.6264, 'time@10': 37.4647}:  60%|██████    | 6/10 [02:45<02:12, 33.16s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0013, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9506, 'compress@10': 0.6694, 'time@10': 38.4533}:  60%|██████    | 6/10 [03:07<02:12, 33.16s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0013, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9506, 'compress@10': 0.6694, 'time@10': 38.4533}:  70%|███████   | 7/10 [03:07<01:28, 29.58s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0012, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9532, 'compress@10': 0.628, 'time@10': 38.0204}:  70%|███████   | 7/10 [03:42<01:28, 29.58s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.0012, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9532, 'compress@10': 0.628, 'time@10': 38.0204}:  80%|████████  | 8/10 [03:42<01:02, 31.32s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0011, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9552, 'compress@10': 0.5728, 'time@10': 41.0014}:  80%|████████  | 8/10 [04:15<01:02, 31.32s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0011, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9552, 'compress@10': 0.5728, 'time@10': 41.0014}:  90%|█████████ | 9/10 [04:15<00:31, 31.68s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.001, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 41.1156}:  90%|█████████ | 9/10 [04:57<00:31, 31.68s/it]    {'epoch': 32, 'num_users': 6.3, 'loss': 0.001, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 41.1156}: 100%|██████████| 10/10 [04:57<00:00, 34.93s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.001, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 41.1156}: 100%|██████████| 10/10 [04:57<00:00, 29.76s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.0009513771534114541
Avg hit ratio: 0.8827140137734364
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5252001270988778
Avg train time: 41.11559987068176
Std train time: 14.91022848037836
[0.838235294117647, 0.5441176470588236, 0.014705882352941183, 0.9264705882352938, 0.7794117647058822, 0.48529411764705904, 0.9264705882352939, 0.3088235294117648, 0.10294117647058824, 0.07352941176470588]
[50, 50, 83, 55, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8467, 'time@10': 35.1623}:   0%|          | 0/10 [00:17<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8467, 'time@10': 35.1623}:  10%|█         | 1/10 [00:17<02:38, 17.62s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.7028, 'time@10': 33.3293}:  10%|█         | 1/10 [00:49<02:38, 17.62s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.7028, 'time@10': 33.3293}:  20%|██        | 2/10 [00:49<03:26, 25.80s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9241, 'compress@10': 0.5203, 'time@10': 28.7073}:  20%|██        | 2/10 [00:58<03:26, 25.80s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9241, 'compress@10': 0.5203, 'time@10': 28.7073}:  30%|███       | 3/10 [00:58<02:09, 18.48s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0007, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9341, 'compress@10': 0.6225, 'time@10': 28.1658}:  30%|███       | 3/10 [01:25<02:09, 18.48s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0007, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9341, 'compress@10': 0.6225, 'time@10': 28.1658}:  40%|████      | 4/10 [01:25<02:10, 21.68s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0013, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9433, 'compress@10': 0.6548, 'time@10': 36.1199}:  40%|████      | 4/10 [01:59<02:10, 21.68s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0013, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9433, 'compress@10': 0.6548, 'time@10': 36.1199}:  50%|█████     | 5/10 [01:59<02:10, 26.12s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0011, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.9491, 'compress@10': 0.6284, 'time@10': 37.8124}:  50%|█████     | 5/10 [02:45<02:10, 26.12s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0011, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.9491, 'compress@10': 0.6284, 'time@10': 37.8124}:  60%|██████    | 6/10 [02:45<02:11, 32.99s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0011, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9506, 'compress@10': 0.6714, 'time@10': 38.7715}:  60%|██████    | 6/10 [03:08<02:11, 32.99s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0011, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9506, 'compress@10': 0.6714, 'time@10': 38.7715}:  70%|███████   | 7/10 [03:08<01:28, 29.50s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0009, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9532, 'compress@10': 0.6286, 'time@10': 38.3087}:  70%|███████   | 7/10 [03:43<01:28, 29.50s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.0009, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9532, 'compress@10': 0.6286, 'time@10': 38.3087}:  80%|████████  | 8/10 [03:43<01:02, 31.28s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0008, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.9552, 'compress@10': 0.573, 'time@10': 41.4421}:  80%|████████  | 8/10 [04:16<01:02, 31.28s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0008, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.9552, 'compress@10': 0.573, 'time@10': 41.4421}:  90%|█████████ | 9/10 [04:16<00:31, 31.91s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0008, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 41.5317}:  90%|█████████ | 9/10 [04:58<00:31, 31.91s/it]  {'epoch': 33, 'num_users': 6.3, 'loss': 0.0008, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 41.5317}: 100%|██████████| 10/10 [04:58<00:00, 35.14s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0008, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 41.5317}: 100%|██████████| 10/10 [04:58<00:00, 29.89s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.0007661827080414595
Avg hit ratio: 0.86662748023529
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5251800707781134
Avg train time: 41.53169777393341
Std train time: 14.99330557219035
[0.8428571428571427, 0.5571428571428572, 0.014285714285714292, 0.9285714285714283, 0.7857142857142856, 0.47142857142857164, 0.9285714285714284, 0.30000000000000004, 0.1, 0.07142857142857142]
[50, 50, 84, 56, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8511, 'time@10': 32.4396}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8511, 'time@10': 32.4396}:  10%|█         | 1/10 [00:16<02:26, 16.26s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.7113, 'time@10': 31.8977}:  10%|█         | 1/10 [00:47<02:26, 16.26s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.7113, 'time@10': 31.8977}:  20%|██        | 2/10 [00:47<03:21, 25.16s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5259, 'time@10': 27.2259}:  20%|██        | 2/10 [00:56<03:21, 25.16s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5259, 'time@10': 27.2259}:  30%|███       | 3/10 [00:56<02:04, 17.77s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0006, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9341, 'compress@10': 0.6272, 'time@10': 27.3869}:  30%|███       | 3/10 [01:24<02:04, 17.77s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0006, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9341, 'compress@10': 0.6272, 'time@10': 27.3869}:  40%|████      | 4/10 [01:24<02:10, 21.77s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9433, 'compress@10': 0.6597, 'time@10': 35.5135}:  40%|████      | 4/10 [01:58<02:10, 21.77s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9433, 'compress@10': 0.6597, 'time@10': 35.5135}:  50%|█████     | 5/10 [01:58<02:11, 26.20s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0007, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9491, 'compress@10': 0.6303, 'time@10': 37.3961}:  50%|█████     | 5/10 [02:45<02:11, 26.20s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0007, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9491, 'compress@10': 0.6303, 'time@10': 37.3961}:  60%|██████    | 6/10 [02:45<02:12, 33.22s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0009, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9506, 'compress@10': 0.6733, 'time@10': 38.3526}:  60%|██████    | 6/10 [03:07<02:12, 33.22s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0009, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9506, 'compress@10': 0.6733, 'time@10': 38.3526}:  70%|███████   | 7/10 [03:07<01:28, 29.58s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0008, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9532, 'compress@10': 0.6292, 'time@10': 37.8087}:  70%|███████   | 7/10 [03:41<01:28, 29.58s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0008, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9532, 'compress@10': 0.6292, 'time@10': 37.8087}:  80%|████████  | 8/10 [03:41<01:02, 31.01s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0007, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9552, 'compress@10': 0.5732, 'time@10': 40.855}:  80%|████████  | 8/10 [04:14<01:02, 31.01s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0007, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9552, 'compress@10': 0.5732, 'time@10': 40.855}:  90%|█████████ | 9/10 [04:14<00:31, 31.52s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 40.9494}:  90%|█████████ | 9/10 [04:56<00:31, 31.52s/it]  {'epoch': 34, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 40.9494}: 100%|██████████| 10/10 [04:56<00:00, 34.71s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 40.9494}: 100%|██████████| 10/10 [04:56<00:00, 29.61s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.0006453901796413399
Avg hit ratio: 0.8876878731530684
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5251611633413994
Avg train time: 40.94942684173584
Std train time: 15.109322603887012
[0.8472222222222221, 0.5416666666666667, 0.013888888888888895, 0.9305555555555552, 0.7916666666666665, 0.45833333333333354, 0.9305555555555554, 0.2916666666666667, 0.125, 0.06944444444444445]
[50, 50, 85, 56, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8552, 'time@10': 32.8245}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8552, 'time@10': 32.8245}:  10%|█         | 1/10 [00:16<02:28, 16.48s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.7058, 'time@10': 32.0849}:  10%|█         | 1/10 [00:47<02:28, 16.48s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.7058, 'time@10': 32.0849}:  20%|██        | 2/10 [00:47<03:21, 25.24s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5222, 'time@10': 28.0729}:  20%|██        | 2/10 [00:57<03:21, 25.24s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5222, 'time@10': 28.0729}:  30%|███       | 3/10 [00:57<02:08, 18.31s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0007, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.9341, 'compress@10': 0.6249, 'time@10': 28.0498}:  30%|███       | 3/10 [01:25<02:08, 18.31s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0007, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.9341, 'compress@10': 0.6249, 'time@10': 28.0498}:  40%|████      | 4/10 [01:25<02:12, 22.16s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0013, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.9433, 'compress@10': 0.6591, 'time@10': 36.1797}:  40%|████      | 4/10 [02:00<02:12, 22.16s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0013, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.9433, 'compress@10': 0.6591, 'time@10': 36.1797}:  50%|█████     | 5/10 [02:00<02:12, 26.57s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0011, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9491, 'compress@10': 0.6276, 'time@10': 38.0923}:  50%|█████     | 5/10 [02:48<02:12, 26.57s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0011, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9491, 'compress@10': 0.6276, 'time@10': 38.0923}:  60%|██████    | 6/10 [02:48<02:15, 33.75s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.001, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9506, 'compress@10': 0.6713, 'time@10': 38.8838}:  60%|██████    | 6/10 [03:09<02:15, 33.75s/it] {'epoch': 35, 'num_users': 6.2857, 'loss': 0.001, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9506, 'compress@10': 0.6713, 'time@10': 38.8838}:  70%|███████   | 7/10 [03:09<01:29, 29.86s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0009, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9532, 'compress@10': 0.6264, 'time@10': 38.189}:  70%|███████   | 7/10 [03:43<01:29, 29.86s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0009, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9532, 'compress@10': 0.6264, 'time@10': 38.189}:  80%|████████  | 8/10 [03:43<01:01, 30.98s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0008, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9552, 'compress@10': 0.5734, 'time@10': 41.3586}:  80%|████████  | 8/10 [04:16<01:01, 30.98s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0008, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9552, 'compress@10': 0.5734, 'time@10': 41.3586}:  90%|█████████ | 9/10 [04:16<00:31, 31.73s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 41.4696}:  90%|█████████ | 9/10 [04:59<00:31, 31.73s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 41.4696}: 100%|██████████| 10/10 [04:59<00:00, 35.06s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 41.4696}: 100%|██████████| 10/10 [04:59<00:00, 29.92s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.0007468391289358719
Avg hit ratio: 0.8794021588673541
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5251506122357943
Avg train time: 41.469646143913266
Std train time: 15.18911196388625
[0.8513513513513512, 0.5270270270270271, 0.01351351351351352, 0.9324324324324321, 0.7972972972972971, 0.44594594594594616, 0.9324324324324322, 0.2837837837837838, 0.14864864864864866, 0.06756756756756757]
[50, 50, 86, 56, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0006, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8592, 'time@10': 32.506}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0006, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8592, 'time@10': 32.506}:  10%|█         | 1/10 [00:16<02:26, 16.29s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.7007, 'time@10': 32.0356}:  10%|█         | 1/10 [00:47<02:26, 16.29s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.7007, 'time@10': 32.0356}:  20%|██        | 2/10 [00:47<03:22, 25.30s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9241, 'compress@10': 0.5186, 'time@10': 27.3568}:  20%|██        | 2/10 [00:56<03:22, 25.30s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9241, 'compress@10': 0.5186, 'time@10': 27.3568}:  30%|███       | 3/10 [00:56<02:05, 17.87s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0005, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.9341, 'compress@10': 0.6227, 'time@10': 27.2648}:  30%|███       | 3/10 [01:23<02:05, 17.87s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0005, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.9341, 'compress@10': 0.6227, 'time@10': 27.2648}:  40%|████      | 4/10 [01:23<02:08, 21.49s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.001, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9433, 'compress@10': 0.6584, 'time@10': 35.3649}:  40%|████      | 4/10 [01:57<02:08, 21.49s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 0.001, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9433, 'compress@10': 0.6584, 'time@10': 35.3649}:  50%|█████     | 5/10 [01:57<02:09, 25.97s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0009, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.9491, 'compress@10': 0.6251, 'time@10': 37.3264}:  50%|█████     | 5/10 [02:45<02:09, 25.97s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0009, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.9491, 'compress@10': 0.6251, 'time@10': 37.3264}:  60%|██████    | 6/10 [02:45<02:12, 33.18s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.001, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9506, 'compress@10': 0.6693, 'time@10': 38.3101}:  60%|██████    | 6/10 [03:07<02:12, 33.18s/it] {'epoch': 36, 'num_users': 6.2857, 'loss': 0.001, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9506, 'compress@10': 0.6693, 'time@10': 38.3101}:  70%|███████   | 7/10 [03:07<01:28, 29.57s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0008, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9532, 'compress@10': 0.6237, 'time@10': 37.7245}:  70%|███████   | 7/10 [03:40<01:28, 29.57s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0008, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9532, 'compress@10': 0.6237, 'time@10': 37.7245}:  80%|████████  | 8/10 [03:40<01:01, 30.87s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0008, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9552, 'compress@10': 0.5736, 'time@10': 40.6496}:  80%|████████  | 8/10 [04:12<01:01, 30.87s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0008, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9552, 'compress@10': 0.5736, 'time@10': 40.6496}:  90%|█████████ | 9/10 [04:12<00:31, 31.24s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9574, 'compress@10': 0.5251, 'time@10': 40.7789}:  90%|█████████ | 9/10 [04:54<00:31, 31.24s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9574, 'compress@10': 0.5251, 'time@10': 40.7789}: 100%|██████████| 10/10 [04:54<00:00, 34.56s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9574, 'compress@10': 0.5251, 'time@10': 40.7789}: 100%|██████████| 10/10 [04:54<00:00, 29.49s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.00072039913530498
Avg hit ratio: 0.8775486002396018
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5251423636513363
Avg train time: 40.778935480117795
Std train time: 14.956381671221214
[0.8552631578947367, 0.5131578947368421, 0.013157894736842111, 0.9342105263157892, 0.8026315789473683, 0.4342105263157897, 0.9342105263157893, 0.27631578947368424, 0.17105263157894737, 0.06578947368421054]
[50, 50, 87, 56, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0006, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8629, 'time@10': 32.6814}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0006, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8629, 'time@10': 32.6814}:  10%|█         | 1/10 [00:16<02:27, 16.41s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9576, 'compress@10': 0.6959, 'time@10': 31.9521}:  10%|█         | 1/10 [00:47<02:27, 16.41s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9576, 'compress@10': 0.6959, 'time@10': 31.9521}:  20%|██        | 2/10 [00:47<03:21, 25.14s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9241, 'compress@10': 0.5153, 'time@10': 27.764}:  20%|██        | 2/10 [00:57<03:21, 25.14s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9241, 'compress@10': 0.5153, 'time@10': 27.764}:  30%|███       | 3/10 [00:57<02:06, 18.11s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0007, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9341, 'compress@10': 0.6206, 'time@10': 27.9123}:  30%|███       | 3/10 [01:25<02:06, 18.11s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0007, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9341, 'compress@10': 0.6206, 'time@10': 27.9123}:  40%|████      | 4/10 [01:25<02:13, 22.17s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9433, 'compress@10': 0.6578, 'time@10': 35.7907}:  40%|████      | 4/10 [01:59<02:13, 22.17s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9433, 'compress@10': 0.6578, 'time@10': 35.7907}:  50%|█████     | 5/10 [01:59<02:11, 26.32s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0008, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9491, 'compress@10': 0.6226, 'time@10': 37.6125}:  50%|█████     | 5/10 [02:46<02:11, 26.32s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0008, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9491, 'compress@10': 0.6226, 'time@10': 37.6125}:  60%|██████    | 6/10 [02:46<02:13, 33.27s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0008, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9506, 'compress@10': 0.6675, 'time@10': 38.4696}:  60%|██████    | 6/10 [03:08<02:13, 33.27s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0008, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9506, 'compress@10': 0.6675, 'time@10': 38.4696}:  70%|███████   | 7/10 [03:08<01:28, 29.53s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0007, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9532, 'compress@10': 0.6212, 'time@10': 37.8623}:  70%|███████   | 7/10 [03:41<01:28, 29.53s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0007, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9532, 'compress@10': 0.6212, 'time@10': 37.8623}:  80%|████████  | 8/10 [03:41<01:01, 30.84s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0007, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9552, 'compress@10': 0.5738, 'time@10': 41.6713}:  80%|████████  | 8/10 [04:17<01:01, 30.84s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0007, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9552, 'compress@10': 0.5738, 'time@10': 41.6713}:  90%|█████████ | 9/10 [04:17<00:32, 32.49s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9574, 'compress@10': 0.5251, 'time@10': 42.0629}:  90%|█████████ | 9/10 [05:03<00:32, 32.49s/it]  {'epoch': 37, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9574, 'compress@10': 0.5251, 'time@10': 42.0629}: 100%|██████████| 10/10 [05:03<00:00, 36.55s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9574, 'compress@10': 0.5251, 'time@10': 42.0629}: 100%|██████████| 10/10 [05:03<00:00, 30.35s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.0006140475187206572
Avg hit ratio: 0.896890638130027
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.525136834824231
Avg train time: 42.0629016160965
Std train time: 15.992093471731193
[0.8589743589743588, 0.5, 0.012820512820512827, 0.9358974358974356, 0.8076923076923075, 0.4230769230769233, 0.9358974358974357, 0.2692307692307693, 0.19230769230769232, 0.06410256410256411]
[50, 50, 88, 56, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0006, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8664, 'time@10': 31.8966}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0006, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8664, 'time@10': 31.8966}:  10%|█         | 1/10 [00:15<02:23, 15.99s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6913, 'time@10': 32.1683}:  10%|█         | 1/10 [00:48<02:23, 15.99s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6913, 'time@10': 32.1683}:  20%|██        | 2/10 [00:48<03:25, 25.69s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.5121, 'time@10': 28.4899}:  20%|██        | 2/10 [00:59<03:25, 25.69s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.5121, 'time@10': 28.4899}:  30%|███       | 3/10 [00:59<02:11, 18.80s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9341, 'compress@10': 0.6186, 'time@10': 28.2252}:  30%|███       | 3/10 [01:26<02:11, 18.80s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9341, 'compress@10': 0.6186, 'time@10': 28.2252}:  40%|████      | 4/10 [01:26<02:13, 22.23s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9433, 'compress@10': 0.6572, 'time@10': 34.6256}:  40%|████      | 4/10 [01:56<02:13, 22.23s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9433, 'compress@10': 0.6572, 'time@10': 34.6256}:  50%|█████     | 5/10 [01:56<02:05, 25.09s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0007, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9491, 'compress@10': 0.6203, 'time@10': 35.8704}:  50%|█████     | 5/10 [02:38<02:05, 25.09s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0007, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9491, 'compress@10': 0.6203, 'time@10': 35.8704}:  60%|██████    | 6/10 [02:38<02:03, 30.88s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0009, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9506, 'compress@10': 0.6658, 'time@10': 36.4999}:  60%|██████    | 6/10 [02:59<02:03, 30.88s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0009, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9506, 'compress@10': 0.6658, 'time@10': 36.4999}:  70%|███████   | 7/10 [02:59<01:22, 27.38s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0008, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9532, 'compress@10': 0.6188, 'time@10': 35.8088}:  70%|███████   | 7/10 [03:30<01:22, 27.38s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0008, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9532, 'compress@10': 0.6188, 'time@10': 35.8088}:  80%|████████  | 8/10 [03:30<00:57, 28.54s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0007, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9552, 'compress@10': 0.574, 'time@10': 38.7305}:  80%|████████  | 8/10 [04:01<00:57, 28.54s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0007, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9552, 'compress@10': 0.574, 'time@10': 38.7305}:  90%|█████████ | 9/10 [04:01<00:29, 29.33s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9574, 'compress@10': 0.5251, 'time@10': 38.7018}:  90%|█████████ | 9/10 [04:39<00:29, 29.33s/it]  {'epoch': 38, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9574, 'compress@10': 0.5251, 'time@10': 38.7018}: 100%|██████████| 10/10 [04:39<00:00, 32.16s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9574, 'compress@10': 0.5251, 'time@10': 38.7018}: 100%|██████████| 10/10 [04:39<00:00, 27.96s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.0006617976734222661
Avg hit ratio: 0.8961993938903955
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5251292948713221
Avg train time: 38.70184998512268
Std train time: 12.672885679035305
[0.8624999999999998, 0.4875, 0.012500000000000006, 0.9374999999999997, 0.8124999999999998, 0.4125000000000002, 0.9374999999999998, 0.28750000000000003, 0.1875, 0.06250000000000001]
[50, 50, 89, 56, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8697, 'time@10': 30.3727}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8697, 'time@10': 30.3727}:  10%|█         | 1/10 [00:15<02:17, 15.22s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6869, 'time@10': 29.8856}:  10%|█         | 1/10 [00:44<02:17, 15.22s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6869, 'time@10': 29.8856}:  20%|██        | 2/10 [00:44<03:08, 23.58s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5091, 'time@10': 25.9734}:  20%|██        | 2/10 [00:53<03:08, 23.58s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5091, 'time@10': 25.9734}:  30%|███       | 3/10 [00:53<01:58, 16.97s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0006, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.6168, 'time@10': 25.7266}:  30%|███       | 3/10 [01:18<01:58, 16.97s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0006, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.6168, 'time@10': 25.7266}:  40%|████      | 4/10 [01:18<02:00, 20.15s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0012, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9433, 'compress@10': 0.6567, 'time@10': 31.7416}:  40%|████      | 4/10 [01:46<02:00, 20.15s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0012, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9433, 'compress@10': 0.6567, 'time@10': 31.7416}:  50%|█████     | 5/10 [01:46<01:54, 22.97s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.001, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9491, 'compress@10': 0.6181, 'time@10': 33.5267}:  50%|█████     | 5/10 [02:29<01:54, 22.97s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.001, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9491, 'compress@10': 0.6181, 'time@10': 33.5267}:  60%|██████    | 6/10 [02:29<01:58, 29.60s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.001, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9506, 'compress@10': 0.6641, 'time@10': 34.2731}:  60%|██████    | 6/10 [02:48<01:58, 29.60s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.001, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9506, 'compress@10': 0.6641, 'time@10': 34.2731}:  70%|███████   | 7/10 [02:48<01:18, 26.27s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0009, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9532, 'compress@10': 0.6196, 'time@10': 33.8713}:  70%|███████   | 7/10 [03:19<01:18, 26.27s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0009, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9532, 'compress@10': 0.6196, 'time@10': 33.8713}:  80%|████████  | 8/10 [03:19<00:55, 27.81s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0008, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9552, 'compress@10': 0.5742, 'time@10': 36.77}:  80%|████████  | 8/10 [03:49<00:55, 27.81s/it] {'epoch': 39, 'num_users': 6.3333, 'loss': 0.0008, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9552, 'compress@10': 0.5742, 'time@10': 36.77}:  90%|█████████ | 9/10 [03:49<00:28, 28.50s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9574, 'compress@10': 0.5251, 'time@10': 36.9474}:  90%|█████████ | 9/10 [04:28<00:28, 28.50s/it] {'epoch': 39, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9574, 'compress@10': 0.5251, 'time@10': 36.9474}: 100%|██████████| 10/10 [04:28<00:00, 31.61s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9574, 'compress@10': 0.5251, 'time@10': 36.9474}: 100%|██████████| 10/10 [04:28<00:00, 26.84s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.0007070964967980594
Avg hit ratio: 0.886338666803862
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5251228195807518
Avg train time: 36.94744529724121
Std train time: 12.459854598631232
[0.8658536585365852, 0.47560975609756095, 0.012195121951219518, 0.9390243902439022, 0.8170731707317072, 0.4024390243902441, 0.9390243902439023, 0.2804878048780488, 0.2073170731707317, 0.060975609756097573]
[50, 50, 90, 57, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8729, 'time@10': 29.3794}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8729, 'time@10': 29.3794}:  10%|█         | 1/10 [00:14<02:12, 14.72s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6827, 'time@10': 29.1299}:  10%|█         | 1/10 [00:43<02:12, 14.72s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6827, 'time@10': 29.1299}:  20%|██        | 2/10 [00:43<03:04, 23.07s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7597, 'ndcg@10': 0.9241, 'compress@10': 0.5062, 'time@10': 25.893}:  20%|██        | 2/10 [00:53<03:04, 23.07s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.7597, 'ndcg@10': 0.9241, 'compress@10': 0.5062, 'time@10': 25.893}:  30%|███       | 3/10 [00:53<01:58, 16.99s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.793, 'ndcg@10': 0.9341, 'compress@10': 0.615, 'time@10': 25.5444}:  30%|███       | 3/10 [01:17<01:58, 16.99s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0004, 'hit_ratio@10': 0.793, 'ndcg@10': 0.9341, 'compress@10': 0.615, 'time@10': 25.5444}:  40%|████      | 4/10 [01:17<01:59, 19.97s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0005, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9433, 'compress@10': 0.6561, 'time@10': 31.8551}:  40%|████      | 4/10 [01:46<01:59, 19.97s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0005, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9433, 'compress@10': 0.6561, 'time@10': 31.8551}:  50%|█████     | 5/10 [01:46<01:55, 23.07s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0004, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.9491, 'compress@10': 0.6161, 'time@10': 33.7194}:  50%|█████     | 5/10 [02:29<01:55, 23.07s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0004, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.9491, 'compress@10': 0.6161, 'time@10': 33.7194}:  60%|██████    | 6/10 [02:29<01:59, 29.88s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0004, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9506, 'compress@10': 0.6625, 'time@10': 34.501}:  60%|██████    | 6/10 [02:49<01:59, 29.88s/it] {'epoch': 40, 'num_users': 6.2857, 'loss': 0.0004, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9506, 'compress@10': 0.6625, 'time@10': 34.501}:  70%|███████   | 7/10 [02:49<01:19, 26.53s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0004, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9532, 'compress@10': 0.6174, 'time@10': 34.1656}:  70%|███████   | 7/10 [03:21<01:19, 26.53s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0004, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9532, 'compress@10': 0.6174, 'time@10': 34.1656}:  80%|████████  | 8/10 [03:21<00:56, 28.23s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0005, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9552, 'compress@10': 0.5743, 'time@10': 37.2175}:  80%|████████  | 8/10 [03:51<00:56, 28.23s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0005, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9552, 'compress@10': 0.5743, 'time@10': 37.2175}:  90%|█████████ | 9/10 [03:51<00:29, 29.05s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0004, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9574, 'compress@10': 0.5251, 'time@10': 37.369}:  90%|█████████ | 9/10 [04:30<00:29, 29.05s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0004, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9574, 'compress@10': 0.5251, 'time@10': 37.369}: 100%|██████████| 10/10 [04:30<00:00, 32.05s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0004, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9574, 'compress@10': 0.5251, 'time@10': 37.369}: 100%|██████████| 10/10 [04:30<00:00, 27.07s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.00041690223759548504
Avg hit ratio: 0.8816279653189671
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5251164129705177
Avg train time: 37.368967819213864
Std train time: 12.922182159017536
[0.8452380952380951, 0.46428571428571425, 0.011904761904761911, 0.9404761904761902, 0.8214285714285713, 0.392857142857143, 0.9404761904761904, 0.29761904761904767, 0.2261904761904762, 0.059523809523809534]
[50, 50, 91, 58, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8534, 'time@10': 29.2759}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8534, 'time@10': 29.2759}:  10%|█         | 1/10 [00:14<02:12, 14.67s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.6675, 'time@10': 28.879}:  10%|█         | 1/10 [00:43<02:12, 14.67s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.6675, 'time@10': 28.879}:  20%|██        | 2/10 [00:43<03:02, 22.82s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.496, 'time@10': 25.9977}:  20%|██        | 2/10 [00:53<03:02, 22.82s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.496, 'time@10': 25.9977}:  30%|███       | 3/10 [00:53<01:59, 17.04s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.9341, 'compress@10': 0.6076, 'time@10': 25.9045}:  30%|███       | 3/10 [01:19<01:59, 17.04s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.9341, 'compress@10': 0.6076, 'time@10': 25.9045}:  40%|████      | 4/10 [01:19<02:02, 20.44s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0002, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9433, 'compress@10': 0.6511, 'time@10': 31.8066}:  40%|████      | 4/10 [01:46<02:02, 20.44s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0002, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9433, 'compress@10': 0.6511, 'time@10': 31.8066}:  50%|█████     | 5/10 [01:46<01:55, 23.08s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0002, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9491, 'compress@10': 0.6103, 'time@10': 33.6833}:  50%|█████     | 5/10 [02:29<01:55, 23.08s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0002, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9491, 'compress@10': 0.6103, 'time@10': 33.6833}:  60%|██████    | 6/10 [02:29<01:59, 29.88s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0005, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9506, 'compress@10': 0.6578, 'time@10': 34.3633}:  60%|██████    | 6/10 [02:49<01:59, 29.88s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0005, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9506, 'compress@10': 0.6578, 'time@10': 34.3633}:  70%|███████   | 7/10 [02:49<01:19, 26.41s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0004, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9532, 'compress@10': 0.6153, 'time@10': 33.9943}:  70%|███████   | 7/10 [03:20<01:19, 26.41s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0004, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9532, 'compress@10': 0.6153, 'time@10': 33.9943}:  80%|████████  | 8/10 [03:20<00:56, 28.01s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0004, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9552, 'compress@10': 0.5745, 'time@10': 37.0352}:  80%|████████  | 8/10 [03:51<00:56, 28.01s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0004, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9552, 'compress@10': 0.5745, 'time@10': 37.0352}:  90%|█████████ | 9/10 [03:51<00:28, 28.86s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0004, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 37.1606}:  90%|█████████ | 9/10 [04:29<00:28, 28.86s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0004, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 37.1606}: 100%|██████████| 10/10 [04:29<00:00, 31.78s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0004, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 37.1606}: 100%|██████████| 10/10 [04:29<00:00, 26.96s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.00038673859829793195
Avg hit ratio: 0.8967334710187002
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5251675619605709
Avg train time: 37.16055800914764
Std train time: 12.437126101768788
[0.8488372093023254, 0.45348837209302323, 0.011627906976744193, 0.9418604651162789, 0.8255813953488371, 0.38372093023255827, 0.941860465116279, 0.2906976744186047, 0.2441860465116279, 0.05813953488372094]
[50, 50, 92, 59, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8568, 'time@10': 28.5673}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8568, 'time@10': 28.5673}:  10%|█         | 1/10 [00:14<02:08, 14.32s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.6639, 'time@10': 28.436}:  10%|█         | 1/10 [00:42<02:08, 14.32s/it] {'epoch': 42, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.6639, 'time@10': 28.436}:  20%|██        | 2/10 [00:42<03:00, 22.57s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.9241, 'compress@10': 0.4936, 'time@10': 25.5367}:  20%|██        | 2/10 [00:52<03:00, 22.57s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.9241, 'compress@10': 0.4936, 'time@10': 25.5367}:  30%|███       | 3/10 [00:52<01:57, 16.78s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.9341, 'compress@10': 0.6062, 'time@10': 25.4942}:  30%|███       | 3/10 [01:17<01:57, 16.78s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.9341, 'compress@10': 0.6062, 'time@10': 25.4942}:  40%|████      | 4/10 [01:17<02:01, 20.19s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9433, 'compress@10': 0.6507, 'time@10': 31.6514}:  40%|████      | 4/10 [01:46<02:01, 20.19s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0009, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9433, 'compress@10': 0.6507, 'time@10': 31.6514}:  50%|█████     | 5/10 [01:46<01:55, 23.07s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0007, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9491, 'compress@10': 0.6085, 'time@10': 33.4489}:  50%|█████     | 5/10 [02:28<01:55, 23.07s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0007, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9491, 'compress@10': 0.6085, 'time@10': 33.4489}:  60%|██████    | 6/10 [02:28<01:58, 29.67s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0007, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9506, 'compress@10': 0.6565, 'time@10': 34.4935}:  60%|██████    | 6/10 [02:49<01:58, 29.67s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0007, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9506, 'compress@10': 0.6565, 'time@10': 34.4935}:  70%|███████   | 7/10 [02:49<01:19, 26.64s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0007, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.9532, 'compress@10': 0.6133, 'time@10': 34.1712}:  70%|███████   | 7/10 [03:20<01:19, 26.64s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0007, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.9532, 'compress@10': 0.6133, 'time@10': 34.1712}:  80%|████████  | 8/10 [03:20<00:56, 28.33s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0007, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9552, 'compress@10': 0.5747, 'time@10': 37.3311}:  80%|████████  | 8/10 [03:52<00:56, 28.33s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0007, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9552, 'compress@10': 0.5747, 'time@10': 37.3311}:  90%|█████████ | 9/10 [03:52<00:29, 29.27s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 37.5568}:  90%|█████████ | 9/10 [04:31<00:29, 29.27s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 37.5568}: 100%|██████████| 10/10 [04:31<00:00, 32.47s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 37.5568}: 100%|██████████| 10/10 [04:31<00:00, 27.20s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.0006276103100636816
Avg hit ratio: 0.9153842646694939
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5251608080901087
Avg train time: 37.556804060935974
Std train time: 12.964596527376973
[0.8295454545454544, 0.4431818181818182, 0.011363636363636371, 0.943181818181818, 0.8295454545454545, 0.3750000000000001, 0.9431818181818181, 0.3068181818181819, 0.26136363636363635, 0.05681818181818183]
[50, 50, 93, 60, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8385, 'time@10': 28.905}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8385, 'time@10': 28.905}:  10%|█         | 1/10 [00:14<02:10, 14.49s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.6498, 'time@10': 28.764}:  10%|█         | 1/10 [00:43<02:10, 14.49s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.6498, 'time@10': 28.764}:  20%|██        | 2/10 [00:43<03:02, 22.82s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.4841, 'time@10': 26.0137}:  20%|██        | 2/10 [00:53<03:02, 22.82s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.4841, 'time@10': 26.0137}:  30%|███       | 3/10 [00:53<01:59, 17.11s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.9341, 'compress@10': 0.5994, 'time@10': 25.9596}:  30%|███       | 3/10 [01:19<01:59, 17.11s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.9341, 'compress@10': 0.5994, 'time@10': 25.9596}:  40%|████      | 4/10 [01:19<02:03, 20.55s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9433, 'compress@10': 0.6461, 'time@10': 31.7753}:  40%|████      | 4/10 [01:46<02:03, 20.55s/it] {'epoch': 43, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9433, 'compress@10': 0.6461, 'time@10': 31.7753}:  50%|█████     | 5/10 [01:46<01:55, 23.08s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0006, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9491, 'compress@10': 0.6032, 'time@10': 33.6078}:  50%|█████     | 5/10 [02:29<01:55, 23.08s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0006, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9491, 'compress@10': 0.6032, 'time@10': 33.6078}:  60%|██████    | 6/10 [02:29<01:59, 29.79s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0007, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9506, 'compress@10': 0.6521, 'time@10': 34.3256}:  60%|██████    | 6/10 [02:49<01:59, 29.79s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0007, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9506, 'compress@10': 0.6521, 'time@10': 34.3256}:  70%|███████   | 7/10 [02:49<01:19, 26.38s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0006, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9532, 'compress@10': 0.6114, 'time@10': 34.0938}:  70%|███████   | 7/10 [03:21<01:19, 26.38s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0006, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9532, 'compress@10': 0.6114, 'time@10': 34.0938}:  80%|████████  | 8/10 [03:21<00:56, 28.33s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0005, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9552, 'compress@10': 0.5749, 'time@10': 37.0779}:  80%|████████  | 8/10 [03:52<00:56, 28.33s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0005, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9552, 'compress@10': 0.5749, 'time@10': 37.0779}:  90%|█████████ | 9/10 [03:52<00:29, 29.01s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0005, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 37.1941}:  90%|█████████ | 9/10 [04:30<00:29, 29.01s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0005, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 37.1941}: 100%|██████████| 10/10 [04:30<00:00, 31.87s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0005, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 37.1941}: 100%|██████████| 10/10 [04:30<00:00, 27.03s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.0004958826706712037
Avg hit ratio: 0.8968128360980654
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5252075457170323
Avg train time: 37.19414846897125
Std train time: 12.205085970116631
[0.8333333333333331, 0.43333333333333335, 0.011111111111111118, 0.9444444444444443, 0.8333333333333333, 0.36666666666666675, 0.9444444444444444, 0.30000000000000004, 0.25555555555555554, 0.07777777777777779]
[50, 50, 94, 61, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8421, 'time@10': 28.1282}:   0%|          | 0/10 [00:14<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8421, 'time@10': 28.1282}:  10%|█         | 1/10 [00:14<02:06, 14.10s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.6469, 'time@10': 28.3948}:  10%|█         | 1/10 [00:42<02:06, 14.10s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.6469, 'time@10': 28.3948}:  20%|██        | 2/10 [00:42<03:01, 22.69s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.482, 'time@10': 25.399}:  20%|██        | 2/10 [00:52<03:01, 22.69s/it]  {'epoch': 44, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.482, 'time@10': 25.399}:  30%|███       | 3/10 [00:52<01:57, 16.77s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.9341, 'compress@10': 0.5981, 'time@10': 25.5401}:  30%|███       | 3/10 [01:18<01:57, 16.77s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.9341, 'compress@10': 0.5981, 'time@10': 25.5401}:  40%|████      | 4/10 [01:18<02:02, 20.42s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0006, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9433, 'compress@10': 0.6458, 'time@10': 31.3089}:  40%|████      | 4/10 [01:45<02:02, 20.42s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0006, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9433, 'compress@10': 0.6458, 'time@10': 31.3089}:  50%|█████     | 5/10 [01:45<01:54, 22.87s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0005, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9491, 'compress@10': 0.6017, 'time@10': 33.25}:  50%|█████     | 5/10 [02:28<01:54, 22.87s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0005, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9491, 'compress@10': 0.6017, 'time@10': 33.25}:  60%|██████    | 6/10 [02:28<01:58, 29.71s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0007, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9506, 'compress@10': 0.6509, 'time@10': 34.208}:  60%|██████    | 6/10 [02:48<01:58, 29.71s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0007, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9506, 'compress@10': 0.6509, 'time@10': 34.208}:  70%|███████   | 7/10 [02:48<01:19, 26.54s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0007, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9532, 'compress@10': 0.6096, 'time@10': 33.9792}:  70%|███████   | 7/10 [03:21<01:19, 26.54s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0007, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9532, 'compress@10': 0.6096, 'time@10': 33.9792}:  80%|████████  | 8/10 [03:21<00:56, 28.41s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0008, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9552, 'compress@10': 0.5726, 'time@10': 37.3279}:  80%|████████  | 8/10 [03:53<00:56, 28.41s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0008, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9552, 'compress@10': 0.5726, 'time@10': 37.3279}:  90%|█████████ | 9/10 [03:53<00:29, 29.56s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 37.4714}:  90%|█████████ | 9/10 [04:32<00:29, 29.56s/it]  {'epoch': 44, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 37.4714}: 100%|██████████| 10/10 [04:32<00:00, 32.42s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0007, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 37.4714}: 100%|██████████| 10/10 [04:32<00:00, 27.21s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.0007002745375896105
Avg hit ratio: 0.8978128360980653
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5252137550890738
Avg train time: 37.471388816833496
Std train time: 12.975231802953173
[0.8152173913043477, 0.42391304347826086, 0.010869565217391311, 0.9456521739130433, 0.8369565217391304, 0.35869565217391314, 0.9456521739130435, 0.3152173913043479, 0.2717391304347826, 0.07608695652173915]
[50, 50, 95, 62, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8249, 'time@10': 30.7491}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8249, 'time@10': 30.7491}:  10%|█         | 1/10 [00:15<02:18, 15.41s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.6337, 'time@10': 29.7606}:  10%|█         | 1/10 [00:44<02:18, 15.41s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.6337, 'time@10': 29.7606}:  20%|██        | 2/10 [00:44<03:06, 23.29s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.4732, 'time@10': 26.4194}:  20%|██        | 2/10 [00:54<03:06, 23.29s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.4732, 'time@10': 26.4194}:  30%|███       | 3/10 [00:54<02:00, 17.18s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.9341, 'compress@10': 0.5918, 'time@10': 26.4201}:  30%|███       | 3/10 [01:20<02:00, 17.18s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.9341, 'compress@10': 0.5918, 'time@10': 26.4201}:  40%|████      | 4/10 [01:20<02:05, 20.84s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9433, 'compress@10': 0.6415, 'time@10': 32.1615}:  40%|████      | 4/10 [01:48<02:05, 20.84s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0008, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9433, 'compress@10': 0.6415, 'time@10': 32.1615}:  50%|█████     | 5/10 [01:48<01:56, 23.28s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0007, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9491, 'compress@10': 0.5967, 'time@10': 33.7268}:  50%|█████     | 5/10 [02:29<01:56, 23.28s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0007, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9491, 'compress@10': 0.5967, 'time@10': 33.7268}:  60%|██████    | 6/10 [02:29<01:58, 29.50s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0007, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9506, 'compress@10': 0.6469, 'time@10': 34.3585}:  60%|██████    | 6/10 [02:48<01:58, 29.50s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0007, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9506, 'compress@10': 0.6469, 'time@10': 34.3585}:  70%|███████   | 7/10 [02:48<01:18, 26.11s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0006, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9532, 'compress@10': 0.6079, 'time@10': 34.1516}:  70%|███████   | 7/10 [03:21<01:18, 26.11s/it]  {'epoch': 45, 'num_users': 6.125, 'loss': 0.0006, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9532, 'compress@10': 0.6079, 'time@10': 34.1516}:  80%|████████  | 8/10 [03:21<00:56, 28.22s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0005, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9552, 'compress@10': 0.5728, 'time@10': 37.158}:  80%|████████  | 8/10 [03:52<00:56, 28.22s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0005, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9552, 'compress@10': 0.5728, 'time@10': 37.158}:  90%|█████████ | 9/10 [03:52<00:28, 28.97s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0005, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 37.3074}:  90%|█████████ | 9/10 [04:30<00:28, 28.97s/it]  {'epoch': 45, 'num_users': 6.3, 'loss': 0.0005, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 37.3074}: 100%|██████████| 10/10 [04:30<00:00, 31.98s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0005, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 37.3074}: 100%|██████████| 10/10 [04:30<00:00, 27.10s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.0005031756740753396
Avg hit ratio: 0.8846699789552082
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5252583272575311
Avg train time: 37.30744142532349
Std train time: 12.1394626355028
[0.8191489361702126, 0.4148936170212766, 0.010638297872340432, 0.9468085106382977, 0.8404255319148936, 0.35106382978723416, 0.9468085106382979, 0.3085106382978724, 0.28723404255319146, 0.074468085106383]
[50, 50, 96, 63, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8287, 'time@10': 31.2702}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8287, 'time@10': 31.2702}:  10%|█         | 1/10 [00:15<02:21, 15.68s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9312, 'ndcg@10': 0.9576, 'compress@10': 0.6312, 'time@10': 30.1287}:  10%|█         | 1/10 [00:44<02:21, 15.68s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9312, 'ndcg@10': 0.9576, 'compress@10': 0.6312, 'time@10': 30.1287}:  20%|██        | 2/10 [00:44<03:08, 23.53s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.9241, 'compress@10': 0.4715, 'time@10': 26.3906}:  20%|██        | 2/10 [00:54<03:08, 23.53s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.9241, 'compress@10': 0.4715, 'time@10': 26.3906}:  30%|███       | 3/10 [00:54<01:59, 17.12s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.9341, 'compress@10': 0.5908, 'time@10': 26.4424}:  30%|███       | 3/10 [01:20<01:59, 17.12s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.9341, 'compress@10': 0.5908, 'time@10': 26.4424}:  40%|████      | 4/10 [01:20<02:05, 20.88s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0003, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.9433, 'compress@10': 0.6413, 'time@10': 32.8646}:  40%|████      | 4/10 [01:50<02:05, 20.88s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0003, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.9433, 'compress@10': 0.6413, 'time@10': 32.8646}:  50%|█████     | 5/10 [01:50<01:59, 23.92s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0003, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9491, 'compress@10': 0.5954, 'time@10': 34.3864}:  50%|█████     | 5/10 [02:32<01:59, 23.92s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0003, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9491, 'compress@10': 0.5954, 'time@10': 34.3864}:  60%|██████    | 6/10 [02:32<02:00, 30.08s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0004, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9506, 'compress@10': 0.6459, 'time@10': 34.8622}:  60%|██████    | 6/10 [02:51<02:00, 30.08s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0004, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9506, 'compress@10': 0.6459, 'time@10': 34.8622}:  70%|███████   | 7/10 [02:51<01:19, 26.44s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0003, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9532, 'compress@10': 0.6062, 'time@10': 34.5739}:  70%|███████   | 7/10 [03:23<01:19, 26.44s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0003, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9532, 'compress@10': 0.6062, 'time@10': 34.5739}:  80%|████████  | 8/10 [03:23<00:56, 28.40s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0004, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9552, 'compress@10': 0.573, 'time@10': 37.672}:  80%|████████  | 8/10 [03:54<00:56, 28.40s/it] {'epoch': 46, 'num_users': 6.3333, 'loss': 0.0004, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9552, 'compress@10': 0.573, 'time@10': 37.672}:  90%|█████████ | 9/10 [03:54<00:29, 29.29s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0003, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 37.7151}:  90%|█████████ | 9/10 [04:33<00:29, 29.29s/it] {'epoch': 46, 'num_users': 6.3, 'loss': 0.0003, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 37.7151}: 100%|██████████| 10/10 [04:33<00:00, 32.02s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0003, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 37.7151}: 100%|██████████| 10/10 [04:33<00:00, 27.31s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.00034852009648575065
Avg hit ratio: 0.8836100711211069
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5252501567689256
Avg train time: 37.71506397724151
Std train time: 12.985592140971216
[0.8229166666666665, 0.40625, 0.010416666666666673, 0.9479166666666665, 0.8437499999999999, 0.3437500000000001, 0.9479166666666666, 0.30208333333333337, 0.3020833333333333, 0.07291666666666669]
[50, 50, 97, 63, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8322, 'time@10': 32.635}:   0%|          | 0/10 [00:16<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8322, 'time@10': 32.635}:  10%|█         | 1/10 [00:16<02:27, 16.35s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.6288, 'time@10': 30.7955}:  10%|█         | 1/10 [00:45<02:27, 16.35s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.6288, 'time@10': 30.7955}:  20%|██        | 2/10 [00:45<03:10, 23.79s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.9241, 'compress@10': 0.4698, 'time@10': 27.2642}:  20%|██        | 2/10 [00:55<03:10, 23.79s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.9241, 'compress@10': 0.4698, 'time@10': 27.2642}:  30%|███       | 3/10 [00:55<02:02, 17.55s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9341, 'compress@10': 0.5898, 'time@10': 27.1919}:  30%|███       | 3/10 [01:22<02:02, 17.55s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9341, 'compress@10': 0.5898, 'time@10': 27.1919}:  40%|████      | 4/10 [01:22<02:07, 21.29s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0006, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9433, 'compress@10': 0.6412, 'time@10': 33.4428}:  40%|████      | 4/10 [01:51<02:07, 21.29s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0006, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9433, 'compress@10': 0.6412, 'time@10': 33.4428}:  50%|█████     | 5/10 [01:51<02:00, 24.16s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0005, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9491, 'compress@10': 0.5941, 'time@10': 34.8938}:  50%|█████     | 5/10 [02:33<02:00, 24.16s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0005, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9491, 'compress@10': 0.5941, 'time@10': 34.8938}:  60%|██████    | 6/10 [02:33<02:01, 30.29s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0004, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9506, 'compress@10': 0.6449, 'time@10': 35.3315}:  60%|██████    | 6/10 [02:52<02:01, 30.29s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0004, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9506, 'compress@10': 0.6449, 'time@10': 35.3315}:  70%|███████   | 7/10 [02:52<01:19, 26.60s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0004, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9532, 'compress@10': 0.6045, 'time@10': 34.9127}:  70%|███████   | 7/10 [03:24<01:19, 26.60s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0004, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9532, 'compress@10': 0.6045, 'time@10': 34.9127}:  80%|████████  | 8/10 [03:24<00:56, 28.33s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0004, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9552, 'compress@10': 0.5732, 'time@10': 37.8965}:  80%|████████  | 8/10 [03:55<00:56, 28.33s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0004, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9552, 'compress@10': 0.5732, 'time@10': 37.8965}:  90%|█████████ | 9/10 [03:55<00:29, 29.14s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0003, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 37.9572}:  90%|█████████ | 9/10 [04:34<00:29, 29.14s/it]  {'epoch': 47, 'num_users': 6.3, 'loss': 0.0003, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 37.9572}: 100%|██████████| 10/10 [04:34<00:00, 32.04s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0003, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 37.9572}: 100%|██████████| 10/10 [04:34<00:00, 27.44s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.00032617366952984
Avg hit ratio: 0.8978128360980652
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5252426288933456
Avg train time: 37.95715754032135
Std train time: 12.591718842922678
[0.8265306122448978, 0.41836734693877553, 0.010204081632653067, 0.9489795918367345, 0.846938775510204, 0.3367346938775511, 0.9285714285714285, 0.3163265306122449, 0.29591836734693877, 0.07142857142857145]
[50, 50, 98, 63, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8356, 'time@10': 30.7535}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0003, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8356, 'time@10': 30.7535}:  10%|█         | 1/10 [00:15<02:18, 15.41s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.6364, 'time@10': 29.9251}:  10%|█         | 1/10 [00:44<02:18, 15.41s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.6364, 'time@10': 29.9251}:  20%|██        | 2/10 [00:44<03:07, 23.48s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.4748, 'time@10': 26.9493}:  20%|██        | 2/10 [00:55<03:07, 23.48s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.4748, 'time@10': 26.9493}:  30%|███       | 3/10 [00:55<02:02, 17.57s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.9341, 'compress@10': 0.5938, 'time@10': 26.9404}:  30%|███       | 3/10 [01:22<02:02, 17.57s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0002, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.9341, 'compress@10': 0.5938, 'time@10': 26.9404}:  40%|████      | 4/10 [01:22<02:07, 21.27s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0004, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.9433, 'compress@10': 0.645, 'time@10': 33.4054}:  40%|████      | 4/10 [01:51<02:07, 21.27s/it] {'epoch': 48, 'num_users': 5.8, 'loss': 0.0004, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.9433, 'compress@10': 0.645, 'time@10': 33.4054}:  50%|█████     | 5/10 [01:51<02:01, 24.30s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0004, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9491, 'compress@10': 0.5961, 'time@10': 34.7497}:  50%|█████     | 5/10 [02:33<02:01, 24.30s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0004, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9491, 'compress@10': 0.5961, 'time@10': 34.7497}:  60%|██████    | 6/10 [02:33<02:00, 30.15s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0004, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9506, 'compress@10': 0.644, 'time@10': 35.4543}:  60%|██████    | 6/10 [02:53<02:00, 30.15s/it] {'epoch': 48, 'num_users': 6.2857, 'loss': 0.0004, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9506, 'compress@10': 0.644, 'time@10': 35.4543}:  70%|███████   | 7/10 [02:53<01:20, 26.80s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0005, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9532, 'compress@10': 0.6055, 'time@10': 35.0882}:  70%|███████   | 7/10 [03:25<01:20, 26.80s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0005, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9532, 'compress@10': 0.6055, 'time@10': 35.0882}:  80%|████████  | 8/10 [03:25<00:57, 28.63s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0005, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9552, 'compress@10': 0.5733, 'time@10': 38.0734}:  80%|████████  | 8/10 [03:56<00:57, 28.63s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0005, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9552, 'compress@10': 0.5733, 'time@10': 38.0734}:  90%|█████████ | 9/10 [03:56<00:29, 29.38s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0005, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 38.1661}:  90%|█████████ | 9/10 [04:35<00:29, 29.38s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 0.0005, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 38.1661}: 100%|██████████| 10/10 [04:35<00:00, 32.36s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0005, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9574, 'compress@10': 0.5252, 'time@10': 38.1661}: 100%|██████████| 10/10 [04:35<00:00, 27.57s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.0005027673540558661
Avg hit ratio: 0.8942414075266367
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5252497041020763
Avg train time: 38.16606843471527
Std train time: 12.709701224975202
[0.8299999999999998, 0.41000000000000003, 0.010000000000000005, 0.9299999999999998, 0.85, 0.33000000000000007, 0.9299999999999999, 0.33, 0.31, 0.07000000000000002]
[50, 50, 99, 63, 35, 50, 50, 50, 48, 50]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8389, 'time@10': 30.766}:   0%|          | 0/10 [00:15<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0002, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.8389, 'time@10': 30.766}:  10%|█         | 1/10 [00:15<02:18, 15.42s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.634, 'time@10': 29.5717}:  10%|█         | 1/10 [00:43<02:18, 15.42s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0001, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.634, 'time@10': 29.5717}:  20%|██        | 2/10 [00:43<03:04, 23.06s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.4731, 'time@10': 26.4467}:  20%|██        | 2/10 [00:53<03:04, 23.06s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.4731, 'time@10': 26.4467}:  30%|███       | 3/10 [00:53<02:00, 17.16s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8058, 'ndcg@10': 0.9341, 'compress@10': 0.588, 'time@10': 26.9913}:  30%|███       | 3/10 [01:22<02:00, 17.16s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.0001, 'hit_ratio@10': 0.8058, 'ndcg@10': 0.9341, 'compress@10': 0.588, 'time@10': 26.9913}:  40%|████      | 4/10 [01:22<02:10, 21.70s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0006, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.9433, 'compress@10': 0.641, 'time@10': 33.3721}:  40%|████      | 4/10 [01:52<02:10, 21.70s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0006, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.9433, 'compress@10': 0.641, 'time@10': 33.3721}:  50%|█████     | 5/10 [01:52<02:02, 24.51s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0005, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9491, 'compress@10': 0.5916, 'time@10': 34.7747}:  50%|█████     | 5/10 [02:33<02:02, 24.51s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0005, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9491, 'compress@10': 0.5916, 'time@10': 34.7747}:  60%|██████    | 6/10 [02:33<02:01, 30.39s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0007, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9506, 'compress@10': 0.6404, 'time@10': 35.2178}:  60%|██████    | 6/10 [02:52<02:01, 30.39s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0007, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9506, 'compress@10': 0.6404, 'time@10': 35.2178}:  70%|███████   | 7/10 [02:52<01:19, 26.66s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0007, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9532, 'compress@10': 0.604, 'time@10': 34.8712}:  70%|███████   | 7/10 [03:25<01:19, 26.66s/it]   {'epoch': 49, 'num_users': 6.125, 'loss': 0.0007, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9532, 'compress@10': 0.604, 'time@10': 34.8712}:  80%|████████  | 8/10 [03:25<00:57, 28.51s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0006, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.9552, 'compress@10': 0.5735, 'time@10': 37.8633}:  80%|████████  | 8/10 [03:56<00:57, 28.51s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0006, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.9552, 'compress@10': 0.5735, 'time@10': 37.8633}:  90%|█████████ | 9/10 [03:56<00:29, 29.27s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 38.0348}:  90%|█████████ | 9/10 [04:35<00:29, 29.27s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 38.0348}: 100%|██████████| 10/10 [04:35<00:00, 32.46s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0006, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9574, 'compress@10': 0.5253, 'time@10': 38.0348}: 100%|██████████| 10/10 [04:35<00:00, 27.59s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.000569881388504814
Avg hit ratio: 0.8718128360980651
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5252558861188833
Avg train time: 38.03475019931793
Std train time: 12.651186807547766
[0.8333333333333331, 0.4019607843137255, 0.009803921568627456, 0.9313725490196076, 0.8529411764705882, 0.32352941176470595, 0.9313725490196078, 0.3235294117647059, 0.3235294117647059, 0.06862745098039218]
[50, 50, 100, 63, 35, 50, 50, 50, 48, 50]
