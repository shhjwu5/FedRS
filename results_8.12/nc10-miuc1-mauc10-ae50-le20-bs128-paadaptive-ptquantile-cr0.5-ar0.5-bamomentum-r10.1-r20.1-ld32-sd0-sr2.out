  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0512, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8629, 'compress@10': 0.5263, 'time@10': 18.415}:   0%|          | 0/10 [00:09<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0512, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8629, 'compress@10': 0.5263, 'time@10': 18.415}:  10%|█         | 1/10 [00:09<01:23,  9.25s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8603, 'compress@10': 0.5212, 'time@10': 16.2233}:  10%|█         | 1/10 [00:23<01:23,  9.25s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8603, 'compress@10': 0.5212, 'time@10': 16.2233}:  20%|██        | 2/10 [00:23<01:36, 12.08s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.1676, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.6252, 'compress@10': 0.538, 'time@10': 12.7315}:  20%|██        | 2/10 [00:26<01:36, 12.08s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.1676, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.6252, 'compress@10': 0.538, 'time@10': 12.7315}:  30%|███       | 3/10 [00:26<00:55,  7.90s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.1377, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.6807, 'compress@10': 0.5329, 'time@10': 12.7036}:  30%|███       | 3/10 [00:38<00:55,  7.90s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.1377, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.6807, 'compress@10': 0.5329, 'time@10': 12.7036}:  40%|████      | 4/10 [00:38<00:58,  9.78s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.1258, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.7034, 'compress@10': 0.5283, 'time@10': 19.5794}:  40%|████      | 4/10 [01:02<00:58,  9.78s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.1258, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.7034, 'compress@10': 0.5283, 'time@10': 19.5794}:  50%|█████     | 5/10 [01:02<01:13, 14.76s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.1167, 'hit_ratio@10': 0.8051, 'ndcg@10': 0.7224, 'compress@10': 0.5255, 'time@10': 19.8315}:  50%|█████     | 5/10 [01:23<01:13, 14.76s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.1167, 'hit_ratio@10': 0.8051, 'ndcg@10': 0.7224, 'compress@10': 0.5255, 'time@10': 19.8315}:  60%|██████    | 6/10 [01:23<01:07, 16.92s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.1059, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.7441, 'compress@10': 0.5247, 'time@10': 20.2458}:  60%|██████    | 6/10 [01:35<01:07, 16.92s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.1059, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.7441, 'compress@10': 0.5247, 'time@10': 20.2458}:  70%|███████   | 7/10 [01:35<00:45, 15.12s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.097, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.7603, 'compress@10': 0.5234, 'time@10': 19.7261}:  70%|███████   | 7/10 [01:51<00:45, 15.12s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 0.097, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.7603, 'compress@10': 0.5234, 'time@10': 19.7261}:  80%|████████  | 8/10 [01:51<00:30, 15.44s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.0898, 'hit_ratio@10': 0.8244, 'ndcg@10': 0.7772, 'compress@10': 0.5224, 'time@10': 21.1286}:  80%|████████  | 8/10 [02:07<00:30, 15.44s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.0898, 'hit_ratio@10': 0.8244, 'ndcg@10': 0.7772, 'compress@10': 0.5224, 'time@10': 21.1286}:  90%|█████████ | 9/10 [02:07<00:15, 15.68s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.085, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.7841, 'compress@10': 0.5213, 'time@10': 21.0499}:  90%|█████████ | 9/10 [02:27<00:15, 15.68s/it]    {'epoch': 0, 'num_users': 6.3, 'loss': 0.085, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.7841, 'compress@10': 0.5213, 'time@10': 21.0499}: 100%|██████████| 10/10 [02:27<00:00, 17.13s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.085, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.7841, 'compress@10': 0.5213, 'time@10': 21.0499}: 100%|██████████| 10/10 [02:27<00:00, 14.77s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.08503476147786712
Avg hit ratio: 0.8351271384717904
Avg ndcg: 0.7840764628276459
Avg compression ratio: 0.5212715761653699
Avg train time: 21.049905824661256
Std train time: 10.930322371740017
[0.75, 0.75, 0.75, 0.25, 0.75, 0.75, 0.25, 0.25, 0.25, 0.25]
[20, 20, 21, 20, 19, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.853, 'compress@10': 0.7632, 'time@10': 16.7609}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.853, 'compress@10': 0.7632, 'time@10': 16.7609}:  10%|█         | 1/10 [00:08<01:15,  8.42s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8503, 'compress@10': 0.7606, 'time@10': 15.5527}:  10%|█         | 1/10 [00:22<01:15,  8.42s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8503, 'compress@10': 0.7606, 'time@10': 15.5527}:  20%|██        | 2/10 [00:22<01:35, 11.93s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8526, 'compress@10': 0.769, 'time@10': 12.2797}:  20%|██        | 2/10 [00:25<01:35, 11.93s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8526, 'compress@10': 0.769, 'time@10': 12.2797}:  30%|███       | 3/10 [00:25<00:54,  7.81s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.852, 'compress@10': 0.6459, 'time@10': 12.2425}:  30%|███       | 3/10 [00:37<00:54,  7.81s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.852, 'compress@10': 0.6459, 'time@10': 12.2425}:  40%|████      | 4/10 [00:37<00:57,  9.53s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0394, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8437, 'compress@10': 0.6677, 'time@10': 18.6248}:  40%|████      | 4/10 [01:00<00:57,  9.53s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0394, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8437, 'compress@10': 0.6677, 'time@10': 18.6248}:  50%|█████     | 5/10 [01:00<01:10, 14.07s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0421, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8423, 'compress@10': 0.6824, 'time@10': 19.0311}:  50%|█████     | 5/10 [01:21<01:10, 14.07s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0421, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8423, 'compress@10': 0.6824, 'time@10': 19.0311}:  60%|██████    | 6/10 [01:21<01:05, 16.46s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0414, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8476, 'compress@10': 0.6249, 'time@10': 19.4954}:  60%|██████    | 6/10 [01:32<01:05, 16.46s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0414, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8476, 'compress@10': 0.6249, 'time@10': 19.4954}:  70%|███████   | 7/10 [01:32<00:44, 14.73s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0429, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8444, 'compress@10': 0.5807, 'time@10': 19.0698}:  70%|███████   | 7/10 [01:48<00:44, 14.73s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0429, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8444, 'compress@10': 0.5807, 'time@10': 19.0698}:  80%|████████  | 8/10 [01:48<00:30, 15.18s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0414, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8526, 'compress@10': 0.5463, 'time@10': 20.3434}:  80%|████████  | 8/10 [02:03<00:30, 15.18s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0414, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8526, 'compress@10': 0.5463, 'time@10': 20.3434}:  90%|█████████ | 9/10 [02:03<00:15, 15.22s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0405, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8544, 'compress@10': 0.5184, 'time@10': 20.2779}:  90%|█████████ | 9/10 [02:23<00:15, 15.22s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0405, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8544, 'compress@10': 0.5184, 'time@10': 20.2779}: 100%|██████████| 10/10 [02:23<00:00, 16.61s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0405, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8544, 'compress@10': 0.5184, 'time@10': 20.2779}: 100%|██████████| 10/10 [02:23<00:00, 14.35s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.04048837867576745
Avg hit ratio: 0.8425080908527429
Avg ndcg: 0.8543554842787925
Avg compression ratio: 0.5184134637429769
Avg train time: 20.277856612205504
Std train time: 10.115451254860334
[0.8333333333333334, 0.8333333333333334, 0.5, 0.16666666666666669, 0.8333333333333334, 0.8333333333333334, 0.16666666666666669, 0.5, 0.16666666666666669, 0.16666666666666669]
[20, 20, 22, 20, 18, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0433, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8549, 'compress@10': 0.8421, 'time@10': 16.5983}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0433, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8549, 'compress@10': 0.8421, 'time@10': 16.5983}:  10%|█         | 1/10 [00:08<01:15,  8.33s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8644, 'compress@10': 0.8404, 'time@10': 15.3524}:  10%|█         | 1/10 [00:22<01:15,  8.33s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8644, 'compress@10': 0.8404, 'time@10': 15.3524}:  20%|██        | 2/10 [00:22<01:34, 11.75s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.744, 'ndcg@10': 0.862, 'compress@10': 0.7507, 'time@10': 12.3243}:  20%|██        | 2/10 [00:25<01:34, 11.75s/it]  {'epoch': 2, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.744, 'ndcg@10': 0.862, 'compress@10': 0.7507, 'time@10': 12.3243}:  30%|███       | 3/10 [00:25<00:54,  7.83s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.799, 'ndcg@10': 0.8655, 'compress@10': 0.6122, 'time@10': 12.2844}:  30%|███       | 3/10 [00:37<00:54,  7.83s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.799, 'ndcg@10': 0.8655, 'compress@10': 0.6122, 'time@10': 12.2844}:  40%|████      | 4/10 [00:37<00:57,  9.56s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0401, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8561, 'compress@10': 0.6571, 'time@10': 18.1619}:  40%|████      | 4/10 [00:58<00:57,  9.56s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0401, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8561, 'compress@10': 0.6571, 'time@10': 18.1619}:  50%|█████     | 5/10 [00:58<01:08, 13.64s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0413, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.8552, 'compress@10': 0.6871, 'time@10': 18.5409}:  50%|█████     | 5/10 [01:19<01:08, 13.64s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0413, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.8552, 'compress@10': 0.6871, 'time@10': 18.5409}:  60%|██████    | 6/10 [01:19<01:03, 15.96s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0404, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.86, 'compress@10': 0.6175, 'time@10': 18.961}:  60%|██████    | 6/10 [01:29<01:03, 15.96s/it]   {'epoch': 2, 'num_users': 6.2857, 'loss': 0.0404, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.86, 'compress@10': 0.6175, 'time@10': 18.961}:  70%|███████   | 7/10 [01:29<00:42, 14.27s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0393, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8634, 'compress@10': 0.6046, 'time@10': 18.6151}:  70%|███████   | 7/10 [01:46<00:42, 14.27s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0393, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8634, 'compress@10': 0.6046, 'time@10': 18.6151}:  80%|████████  | 8/10 [01:46<00:29, 14.90s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0384, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8693, 'compress@10': 0.5586, 'time@10': 19.894}:  80%|████████  | 8/10 [02:01<00:29, 14.90s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0384, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8693, 'compress@10': 0.5586, 'time@10': 19.894}:  90%|█████████ | 9/10 [02:01<00:14, 14.96s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8723, 'compress@10': 0.5213, 'time@10': 19.8431}:  90%|█████████ | 9/10 [02:20<00:14, 14.96s/it]  {'epoch': 2, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8723, 'compress@10': 0.5213, 'time@10': 19.8431}: 100%|██████████| 10/10 [02:20<00:00, 16.34s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8723, 'compress@10': 0.5213, 'time@10': 19.8431}: 100%|██████████| 10/10 [02:20<00:00, 14.07s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.03685987329905479
Avg hit ratio: 0.8503082118786702
Avg ndcg: 0.8722563996019812
Avg compression ratio: 0.5212695160149767
Avg train time: 19.843068766593934
Std train time: 9.409861964986858
[0.875, 0.875, 0.375, 0.375, 0.875, 0.875, 0.125, 0.375, 0.125, 0.125]
[20, 20, 23, 20, 17, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0429, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8654, 'compress@10': 0.8816, 'time@10': 16.5059}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0429, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8654, 'compress@10': 0.8816, 'time@10': 16.5059}:  10%|█         | 1/10 [00:08<01:14,  8.29s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8793, 'compress@10': 0.8803, 'time@10': 15.1104}:  10%|█         | 1/10 [00:22<01:14,  8.29s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8793, 'compress@10': 0.8803, 'time@10': 15.1104}:  20%|██        | 2/10 [00:22<01:32, 11.52s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8719, 'compress@10': 0.7416, 'time@10': 12.2263}:  20%|██        | 2/10 [00:25<01:32, 11.52s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8719, 'compress@10': 0.7416, 'time@10': 12.2263}:  30%|███       | 3/10 [00:25<00:54,  7.75s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8689, 'compress@10': 0.6555, 'time@10': 12.4083}:  30%|███       | 3/10 [00:38<00:54,  7.75s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8689, 'compress@10': 0.6555, 'time@10': 12.4083}:  40%|████      | 4/10 [00:38<00:58,  9.82s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0372, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8608, 'compress@10': 0.6999, 'time@10': 17.6102}:  40%|████      | 4/10 [00:57<00:58,  9.82s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0372, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8608, 'compress@10': 0.6999, 'time@10': 17.6102}:  50%|█████     | 5/10 [00:57<01:06, 13.22s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.038, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8609, 'compress@10': 0.7296, 'time@10': 18.0819}:  50%|█████     | 5/10 [01:18<01:06, 13.22s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.038, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8609, 'compress@10': 0.7296, 'time@10': 18.0819}:  60%|██████    | 6/10 [01:18<01:02, 15.69s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0376, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8612, 'compress@10': 0.6482, 'time@10': 18.5483}:  60%|██████    | 6/10 [01:28<01:02, 15.69s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0376, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8612, 'compress@10': 0.6482, 'time@10': 18.5483}:  70%|███████   | 7/10 [01:28<00:42, 14.06s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0367, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.866, 'compress@10': 0.6163, 'time@10': 18.2614}:  70%|███████   | 7/10 [01:45<00:42, 14.06s/it]  {'epoch': 3, 'num_users': 6.125, 'loss': 0.0367, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.866, 'compress@10': 0.6163, 'time@10': 18.2614}:  80%|████████  | 8/10 [01:45<00:29, 14.77s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0367, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8729, 'compress@10': 0.5645, 'time@10': 19.5714}:  80%|████████  | 8/10 [02:00<00:29, 14.77s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0367, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8729, 'compress@10': 0.5645, 'time@10': 19.5714}:  90%|█████████ | 9/10 [02:00<00:14, 14.86s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0348, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8772, 'compress@10': 0.5225, 'time@10': 19.5248}:  90%|█████████ | 9/10 [02:19<00:14, 14.86s/it]    {'epoch': 3, 'num_users': 6.3, 'loss': 0.0348, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8772, 'compress@10': 0.5225, 'time@10': 19.5248}: 100%|██████████| 10/10 [02:19<00:00, 16.19s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0348, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8772, 'compress@10': 0.5225, 'time@10': 19.5248}: 100%|██████████| 10/10 [02:19<00:00, 13.93s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.03481899867282011
Avg hit ratio: 0.8620189133635654
Avg ndcg: 0.8772390127511764
Avg compression ratio: 0.5225196571397547
Avg train time: 19.524806928634643
Std train time: 8.599721871273522
[0.9, 0.9, 0.3, 0.5, 0.9, 0.9, 0.1, 0.3, 0.1, 0.1]
[20, 20, 24, 20, 16, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0391, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8647, 'compress@10': 0.9052, 'time@10': 16.718}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0391, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8647, 'compress@10': 0.9052, 'time@10': 16.718}:  10%|█         | 1/10 [00:08<01:15,  8.40s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.041, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8667, 'compress@10': 0.9042, 'time@10': 15.2149}:  10%|█         | 1/10 [00:22<01:15,  8.40s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.041, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8667, 'compress@10': 0.9042, 'time@10': 15.2149}:  20%|██        | 2/10 [00:22<01:32, 11.55s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8635, 'compress@10': 0.7362, 'time@10': 12.3103}:  20%|██        | 2/10 [00:25<01:32, 11.55s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8635, 'compress@10': 0.7362, 'time@10': 12.3103}:  30%|███       | 3/10 [00:25<00:54,  7.78s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8755, 'compress@10': 0.6816, 'time@10': 12.5082}:  30%|███       | 3/10 [00:38<00:54,  7.78s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8755, 'compress@10': 0.6816, 'time@10': 12.5082}:  40%|████      | 4/10 [00:38<00:59,  9.89s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0312, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8701, 'compress@10': 0.7257, 'time@10': 17.2637}:  40%|████      | 4/10 [00:56<00:59,  9.89s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0312, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8701, 'compress@10': 0.7257, 'time@10': 17.2637}:  50%|█████     | 5/10 [00:56<01:04, 12.88s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0316, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8704, 'compress@10': 0.7551, 'time@10': 17.7198}:  50%|█████     | 5/10 [01:16<01:04, 12.88s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0316, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8704, 'compress@10': 0.7551, 'time@10': 17.7198}:  60%|██████    | 6/10 [01:16<01:01, 15.32s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.031, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.873, 'compress@10': 0.6666, 'time@10': 18.2557}:  60%|██████    | 6/10 [01:27<01:01, 15.32s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.031, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.873, 'compress@10': 0.6666, 'time@10': 18.2557}:  70%|███████   | 7/10 [01:27<00:41, 13.83s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0312, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8756, 'compress@10': 0.6233, 'time@10': 17.976}:  70%|███████   | 7/10 [01:43<00:41, 13.83s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0312, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8756, 'compress@10': 0.6233, 'time@10': 17.976}:  80%|████████  | 8/10 [01:43<00:29, 14.54s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0323, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8846, 'compress@10': 0.568, 'time@10': 19.3092}:  80%|████████  | 8/10 [01:58<00:29, 14.54s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0323, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8846, 'compress@10': 0.568, 'time@10': 19.3092}:  90%|█████████ | 9/10 [01:58<00:14, 14.69s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.884, 'ndcg@10': 0.8888, 'compress@10': 0.5233, 'time@10': 19.2883}:  90%|█████████ | 9/10 [02:17<00:14, 14.69s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.884, 'ndcg@10': 0.8888, 'compress@10': 0.5233, 'time@10': 19.2883}: 100%|██████████| 10/10 [02:17<00:00, 16.06s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.884, 'ndcg@10': 0.8888, 'compress@10': 0.5233, 'time@10': 19.2883}: 100%|██████████| 10/10 [02:17<00:00, 13.78s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.030428515274102542
Avg hit ratio: 0.8840217993664513
Avg ndcg: 0.8887558076012164
Avg compression ratio: 0.523269466749116
Avg train time: 19.288307976722717
Std train time: 8.115431119833573
[0.9166666666666667, 0.9166666666666667, 0.25, 0.4166666666666667, 0.9166666666666667, 0.9166666666666667, 0.08333333333333334, 0.25, 0.25, 0.08333333333333334]
[20, 20, 25, 20, 15, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8583, 'compress@10': 0.921, 'time@10': 15.4882}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8583, 'compress@10': 0.921, 'time@10': 15.4882}:  10%|█         | 1/10 [00:07<01:10,  7.78s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8818, 'compress@10': 0.9202, 'time@10': 14.2346}:  10%|█         | 1/10 [00:20<01:10,  7.78s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8818, 'compress@10': 0.9202, 'time@10': 14.2346}:  20%|██        | 2/10 [00:20<01:26, 10.86s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8736, 'compress@10': 0.7325, 'time@10': 11.8078}:  20%|██        | 2/10 [00:24<01:26, 10.86s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8736, 'compress@10': 0.7325, 'time@10': 11.8078}:  30%|███       | 3/10 [00:24<00:52,  7.51s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8851, 'compress@10': 0.6588, 'time@10': 12.116}:  30%|███       | 3/10 [00:37<00:52,  7.51s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8851, 'compress@10': 0.6588, 'time@10': 12.116}:  40%|████      | 4/10 [00:37<00:58,  9.71s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0293, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8785, 'compress@10': 0.7107, 'time@10': 16.1075}:  40%|████      | 4/10 [00:53<00:58,  9.71s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0293, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8785, 'compress@10': 0.7107, 'time@10': 16.1075}:  50%|█████     | 5/10 [00:53<01:00, 12.00s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.029, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8809, 'compress@10': 0.7453, 'time@10': 16.7586}:  50%|█████     | 5/10 [01:13<01:00, 12.00s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.029, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8809, 'compress@10': 0.7453, 'time@10': 16.7586}:  60%|██████    | 6/10 [01:13<00:58, 14.74s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0285, 'hit_ratio@10': 0.879, 'ndcg@10': 0.883, 'compress@10': 0.656, 'time@10': 17.3693}:  60%|██████    | 6/10 [01:24<00:58, 14.74s/it]  {'epoch': 5, 'num_users': 6.2857, 'loss': 0.0285, 'hit_ratio@10': 0.879, 'ndcg@10': 0.883, 'compress@10': 0.656, 'time@10': 17.3693}:  70%|███████   | 7/10 [01:24<00:40, 13.37s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8836, 'compress@10': 0.6079, 'time@10': 17.1825}:  70%|███████   | 7/10 [01:39<00:40, 13.37s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8836, 'compress@10': 0.6079, 'time@10': 17.1825}:  80%|████████  | 8/10 [01:39<00:28, 14.18s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0313, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8978, 'compress@10': 0.5705, 'time@10': 18.6631}:  80%|████████  | 8/10 [01:55<00:28, 14.18s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0313, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8978, 'compress@10': 0.5705, 'time@10': 18.6631}:  90%|█████████ | 9/10 [01:55<00:14, 14.53s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.902, 'compress@10': 0.5239, 'time@10': 18.7143}:  90%|█████████ | 9/10 [02:14<00:14, 14.53s/it]    {'epoch': 5, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.902, 'compress@10': 0.5239, 'time@10': 18.7143}: 100%|██████████| 10/10 [02:14<00:00, 15.98s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.902, 'compress@10': 0.5239, 'time@10': 18.7143}: 100%|██████████| 10/10 [02:14<00:00, 13.45s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.029252922381570623
Avg hit ratio: 0.8872849572611882
Avg ndcg: 0.9020087253871589
Avg compression ratio: 0.5238857724003935
Avg train time: 18.7142694234848
Std train time: 7.393667412501102
[0.9285714285714286, 0.9285714285714286, 0.2142857142857143, 0.35714285714285715, 0.9285714285714286, 0.7857142857142858, 0.07142857142857144, 0.35714285714285715, 0.35714285714285715, 0.07142857142857144]
[20, 20, 26, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0335, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.863, 'compress@10': 0.9323, 'time@10': 15.8878}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0335, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.863, 'compress@10': 0.9323, 'time@10': 15.8878}:  10%|█         | 1/10 [00:07<01:11,  7.98s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0344, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.91, 'compress@10': 0.9316, 'time@10': 14.4112}:  10%|█         | 1/10 [00:20<01:11,  7.98s/it] {'epoch': 6, 'num_users': 7.0, 'loss': 0.0344, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.91, 'compress@10': 0.9316, 'time@10': 14.4112}:  20%|██        | 2/10 [00:20<01:27, 10.92s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8924, 'compress@10': 0.7299, 'time@10': 12.0477}:  20%|██        | 2/10 [00:24<01:27, 10.92s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8924, 'compress@10': 0.7299, 'time@10': 12.0477}:  30%|███       | 3/10 [00:24<00:53,  7.63s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9023, 'compress@10': 0.6425, 'time@10': 12.2567}:  30%|███       | 3/10 [00:37<00:53,  7.63s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9023, 'compress@10': 0.6425, 'time@10': 12.2567}:  40%|████      | 4/10 [00:37<00:58,  9.72s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.025, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8963, 'compress@10': 0.7, 'time@10': 15.7274}:  40%|████      | 4/10 [00:52<00:58,  9.72s/it]    {'epoch': 6, 'num_users': 5.8, 'loss': 0.025, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8963, 'compress@10': 0.7, 'time@10': 15.7274}:  50%|█████     | 5/10 [00:52<00:57, 11.57s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0246, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8984, 'compress@10': 0.715, 'time@10': 16.5666}:  50%|█████     | 5/10 [01:13<00:57, 11.57s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0246, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8984, 'compress@10': 0.715, 'time@10': 16.5666}:  60%|██████    | 6/10 [01:13<00:58, 14.71s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0243, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8988, 'compress@10': 0.6284, 'time@10': 17.1758}:  60%|██████    | 6/10 [01:23<00:58, 14.71s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0243, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8988, 'compress@10': 0.6284, 'time@10': 17.1758}:  70%|███████   | 7/10 [01:23<00:39, 13.32s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0247, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.8906, 'compress@10': 0.5968, 'time@10': 17.0616}:  70%|███████   | 7/10 [01:40<00:39, 13.32s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0247, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.8906, 'compress@10': 0.5968, 'time@10': 17.0616}:  80%|████████  | 8/10 [01:40<00:28, 14.27s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0269, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8936, 'compress@10': 0.5722, 'time@10': 18.6316}:  80%|████████  | 8/10 [01:55<00:28, 14.27s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0269, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8936, 'compress@10': 0.5722, 'time@10': 18.6316}:  90%|█████████ | 9/10 [01:55<00:14, 14.69s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.8987, 'compress@10': 0.5242, 'time@10': 18.6512}:  90%|█████████ | 9/10 [02:14<00:14, 14.69s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.8987, 'compress@10': 0.5242, 'time@10': 18.6512}: 100%|██████████| 10/10 [02:14<00:00, 15.98s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.8987, 'compress@10': 0.5242, 'time@10': 18.6512}: 100%|██████████| 10/10 [02:14<00:00, 13.45s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.025305473632836462
Avg hit ratio: 0.8891385158889402
Avg ndcg: 0.8986858726267404
Avg compression ratio: 0.5242402608115906
Avg train time: 18.651153254508973
Std train time: 7.030471142884556
[0.9375, 0.9375, 0.1875, 0.3125, 0.9375, 0.6875000000000001, 0.06250000000000001, 0.4375, 0.4375, 0.06250000000000001]
[20, 20, 27, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8849, 'compress@10': 0.9408, 'time@10': 15.4155}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8849, 'compress@10': 0.9408, 'time@10': 15.4155}:  10%|█         | 1/10 [00:07<01:09,  7.75s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9098, 'compress@10': 0.9401, 'time@10': 14.2403}:  10%|█         | 1/10 [00:20<01:09,  7.75s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9098, 'compress@10': 0.9401, 'time@10': 14.2403}:  20%|██        | 2/10 [00:20<01:27, 10.90s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8923, 'compress@10': 0.728, 'time@10': 12.0041}:  20%|██        | 2/10 [00:24<01:27, 10.90s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8923, 'compress@10': 0.728, 'time@10': 12.0041}:  30%|███       | 3/10 [00:24<00:53,  7.66s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9032, 'compress@10': 0.6302, 'time@10': 12.1445}:  30%|███       | 3/10 [00:37<00:53,  7.66s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9032, 'compress@10': 0.6302, 'time@10': 12.1445}:  40%|████      | 4/10 [00:37<00:57,  9.61s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0221, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9022, 'compress@10': 0.6919, 'time@10': 15.724}:  40%|████      | 4/10 [00:52<00:57,  9.61s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.0221, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9022, 'compress@10': 0.6919, 'time@10': 15.724}:  50%|█████     | 5/10 [00:52<00:57, 11.58s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0212, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9072, 'compress@10': 0.6923, 'time@10': 16.5602}:  50%|█████     | 5/10 [01:13<00:57, 11.58s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0212, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9072, 'compress@10': 0.6923, 'time@10': 16.5602}:  60%|██████    | 6/10 [01:13<00:59, 14.80s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0212, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9076, 'compress@10': 0.6077, 'time@10': 17.1812}:  60%|██████    | 6/10 [01:23<00:59, 14.80s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0212, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9076, 'compress@10': 0.6077, 'time@10': 17.1812}:  70%|███████   | 7/10 [01:23<00:40, 13.40s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0224, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9066, 'compress@10': 0.5885, 'time@10': 17.0109}:  70%|███████   | 7/10 [01:39<00:40, 13.40s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0224, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9066, 'compress@10': 0.5885, 'time@10': 17.0109}:  80%|████████  | 8/10 [01:39<00:28, 14.18s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9042, 'compress@10': 0.5735, 'time@10': 18.5519}:  80%|████████  | 8/10 [01:55<00:28, 14.18s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9042, 'compress@10': 0.5735, 'time@10': 18.5519}:  90%|█████████ | 9/10 [01:55<00:14, 14.59s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9096, 'compress@10': 0.5245, 'time@10': 18.5676}:  90%|█████████ | 9/10 [02:13<00:14, 14.59s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9096, 'compress@10': 0.5245, 'time@10': 18.5676}: 100%|██████████| 10/10 [02:13<00:00, 15.87s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9096, 'compress@10': 0.5245, 'time@10': 18.5676}: 100%|██████████| 10/10 [02:13<00:00, 13.40s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.022478615369426413
Avg hit ratio: 0.8935071794834105
Avg ndcg: 0.9096306179869835
Avg compression ratio: 0.5245031769478146
Avg train time: 18.567596673965454
Std train time: 7.064333437183231
[0.9444444444444444, 0.9444444444444444, 0.16666666666666666, 0.2777777777777778, 0.9444444444444444, 0.6111111111111112, 0.055555555555555566, 0.5, 0.5, 0.055555555555555566]
[20, 20, 28, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8863, 'compress@10': 0.9474, 'time@10': 15.6785}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8863, 'compress@10': 0.9474, 'time@10': 15.6785}:  10%|█         | 1/10 [00:08<01:13,  8.21s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9136, 'compress@10': 0.9468, 'time@10': 14.2415}:  10%|█         | 1/10 [00:21<01:13,  8.21s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9136, 'compress@10': 0.9468, 'time@10': 14.2415}:  20%|██        | 2/10 [00:21<01:27, 10.94s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8948, 'compress@10': 0.7264, 'time@10': 11.9455}:  20%|██        | 2/10 [00:24<01:27, 10.94s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8948, 'compress@10': 0.7264, 'time@10': 11.9455}:  30%|███       | 3/10 [00:24<00:53,  7.64s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.853, 'ndcg@10': 0.909, 'compress@10': 0.6207, 'time@10': 12.06}:  30%|███       | 3/10 [00:37<00:53,  7.64s/it]    {'epoch': 8, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.853, 'ndcg@10': 0.909, 'compress@10': 0.6207, 'time@10': 12.06}:  40%|████      | 4/10 [00:37<00:57,  9.53s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9108, 'compress@10': 0.6857, 'time@10': 15.5859}:  40%|████      | 4/10 [00:52<00:57,  9.53s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9108, 'compress@10': 0.6857, 'time@10': 15.5859}:  50%|█████     | 5/10 [00:52<00:57, 11.46s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0187, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9172, 'compress@10': 0.6747, 'time@10': 16.4427}:  50%|█████     | 5/10 [01:12<00:57, 11.46s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0187, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9172, 'compress@10': 0.6747, 'time@10': 16.4427}:  60%|██████    | 6/10 [01:12<00:58, 14.63s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9187, 'compress@10': 0.5916, 'time@10': 17.0101}:  60%|██████    | 6/10 [01:23<00:58, 14.63s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9187, 'compress@10': 0.5916, 'time@10': 17.0101}:  70%|███████   | 7/10 [01:23<00:39, 13.19s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9201, 'compress@10': 0.582, 'time@10': 16.8934}:  70%|███████   | 7/10 [01:39<00:39, 13.19s/it]  {'epoch': 8, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9201, 'compress@10': 0.582, 'time@10': 16.8934}:  80%|████████  | 8/10 [01:39<00:28, 14.12s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9141, 'compress@10': 0.5744, 'time@10': 18.4084}:  80%|████████  | 8/10 [01:54<00:28, 14.12s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9141, 'compress@10': 0.5744, 'time@10': 18.4084}:  90%|█████████ | 9/10 [01:54<00:14, 14.49s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.919, 'compress@10': 0.5247, 'time@10': 18.4358}:  90%|█████████ | 9/10 [02:13<00:14, 14.49s/it]    {'epoch': 8, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.919, 'compress@10': 0.5247, 'time@10': 18.4358}: 100%|██████████| 10/10 [02:13<00:00, 15.80s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.919, 'compress@10': 0.5247, 'time@10': 18.4358}: 100%|██████████| 10/10 [02:13<00:00, 13.32s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.020403529079728665
Avg hit ratio: 0.8956909722987823
Avg ndcg: 0.9190441273023312
Avg compression ratio: 0.5247080475859085
Avg train time: 18.435776281356812
Std train time: 6.972689156501287
[0.95, 0.95, 0.15, 0.25, 0.95, 0.55, 0.05000000000000001, 0.55, 0.55, 0.05000000000000001]
[20, 20, 29, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8978, 'compress@10': 0.9526, 'time@10': 15.0508}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8978, 'compress@10': 0.9526, 'time@10': 15.0508}:  10%|█         | 1/10 [00:07<01:08,  7.56s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9206, 'compress@10': 0.9521, 'time@10': 13.9053}:  10%|█         | 1/10 [00:20<01:08,  7.56s/it] {'epoch': 9, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9206, 'compress@10': 0.9521, 'time@10': 13.9053}:  20%|██        | 2/10 [00:20<01:25, 10.64s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8994, 'compress@10': 0.7252, 'time@10': 11.8772}:  20%|██        | 2/10 [00:24<01:25, 10.64s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8994, 'compress@10': 0.7252, 'time@10': 11.8772}:  30%|███       | 3/10 [00:24<00:53,  7.58s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9133, 'compress@10': 0.6131, 'time@10': 11.9814}:  30%|███       | 3/10 [00:36<00:53,  7.58s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9133, 'compress@10': 0.6131, 'time@10': 11.9814}:  40%|████      | 4/10 [00:36<00:56,  9.46s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9149, 'compress@10': 0.6807, 'time@10': 15.3964}:  40%|████      | 4/10 [00:51<00:56,  9.46s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9149, 'compress@10': 0.6807, 'time@10': 15.3964}:  50%|█████     | 5/10 [00:51<00:56, 11.30s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.9221, 'compress@10': 0.6606, 'time@10': 16.2971}:  50%|█████     | 5/10 [01:12<00:56, 11.30s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.9221, 'compress@10': 0.6606, 'time@10': 16.2971}:  60%|██████    | 6/10 [01:12<00:58, 14.54s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0175, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9222, 'compress@10': 0.5788, 'time@10': 16.907}:  60%|██████    | 6/10 [01:22<00:58, 14.54s/it] {'epoch': 9, 'num_users': 6.2857, 'loss': 0.0175, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9222, 'compress@10': 0.5788, 'time@10': 16.907}:  70%|███████   | 7/10 [01:22<00:39, 13.16s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9262, 'compress@10': 0.5768, 'time@10': 16.7929}:  70%|███████   | 7/10 [01:38<00:39, 13.16s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9262, 'compress@10': 0.5768, 'time@10': 16.7929}:  80%|████████  | 8/10 [01:38<00:28, 14.07s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0217, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9227, 'compress@10': 0.5752, 'time@10': 18.3817}:  80%|████████  | 8/10 [01:53<00:28, 14.07s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0217, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9227, 'compress@10': 0.5752, 'time@10': 18.3817}:  90%|█████████ | 9/10 [01:53<00:14, 14.55s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9266, 'compress@10': 0.5249, 'time@10': 18.3738}:  90%|█████████ | 9/10 [02:12<00:14, 14.55s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9266, 'compress@10': 0.5249, 'time@10': 18.3738}: 100%|██████████| 10/10 [02:12<00:00, 15.72s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9266, 'compress@10': 0.5249, 'time@10': 18.3738}: 100%|██████████| 10/10 [02:12<00:00, 13.23s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.021277992705862617
Avg hit ratio: 0.8797739216075378
Avg ndcg: 0.9266362351091081
Avg compression ratio: 0.524871704255372
Avg train time: 18.373815846443176
Std train time: 6.950771573757702
[0.9545454545454545, 0.9545454545454545, 0.13636363636363635, 0.22727272727272727, 0.9545454545454545, 0.5, 0.04545454545454546, 0.5909090909090909, 0.5909090909090909, 0.04545454545454546]
[20, 20, 30, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8978, 'compress@10': 0.9569, 'time@10': 15.5414}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8978, 'compress@10': 0.9569, 'time@10': 15.5414}:  10%|█         | 1/10 [00:07<01:10,  7.81s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9476, 'compress@10': 0.9565, 'time@10': 14.1162}:  10%|█         | 1/10 [00:20<01:10,  7.81s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9476, 'compress@10': 0.9565, 'time@10': 14.1162}:  20%|██        | 2/10 [00:20<01:25, 10.70s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9174, 'compress@10': 0.7242, 'time@10': 12.1484}:  20%|██        | 2/10 [00:24<01:25, 10.70s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9174, 'compress@10': 0.7242, 'time@10': 12.1484}:  30%|███       | 3/10 [00:24<00:53,  7.71s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9283, 'compress@10': 0.6069, 'time@10': 12.2612}:  30%|███       | 3/10 [00:37<00:53,  7.71s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9283, 'compress@10': 0.6069, 'time@10': 12.2612}:  40%|████      | 4/10 [00:37<00:57,  9.65s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.927, 'compress@10': 0.6766, 'time@10': 15.7246}:  40%|████      | 4/10 [00:52<00:57,  9.65s/it] {'epoch': 10, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.927, 'compress@10': 0.6766, 'time@10': 15.7246}:  50%|█████     | 5/10 [00:52<00:57, 11.52s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9332, 'compress@10': 0.649, 'time@10': 16.5935}:  50%|█████     | 5/10 [01:13<00:57, 11.52s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9332, 'compress@10': 0.649, 'time@10': 16.5935}:  60%|██████    | 6/10 [01:13<00:58, 14.73s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0155, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.934, 'compress@10': 0.5682, 'time@10': 17.1544}:  60%|██████    | 6/10 [01:23<00:58, 14.73s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0155, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.934, 'compress@10': 0.5682, 'time@10': 17.1544}:  70%|███████   | 7/10 [01:23<00:39, 13.28s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9333, 'compress@10': 0.5725, 'time@10': 17.0247}:  70%|███████   | 7/10 [01:39<00:39, 13.28s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9333, 'compress@10': 0.5725, 'time@10': 17.0247}:  80%|████████  | 8/10 [01:39<00:28, 14.20s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.94, 'compress@10': 0.5759, 'time@10': 18.5139}:  80%|████████  | 8/10 [01:54<00:28, 14.20s/it] {'epoch': 10, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.94, 'compress@10': 0.5759, 'time@10': 18.5139}:  90%|█████████ | 9/10 [01:54<00:14, 14.53s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9425, 'compress@10': 0.525, 'time@10': 18.5041}:  90%|█████████ | 9/10 [02:13<00:14, 14.53s/it]  {'epoch': 10, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9425, 'compress@10': 0.525, 'time@10': 18.5041}: 100%|██████████| 10/10 [02:13<00:00, 15.74s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9425, 'compress@10': 0.525, 'time@10': 18.5041}: 100%|██████████| 10/10 [02:13<00:00, 13.33s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.01860286913760851
Avg hit ratio: 0.8877104295440459
Avg ndcg: 0.9424948426606923
Avg compression ratio: 0.5250052011869382
Avg train time: 18.504078602790834
Std train time: 6.810437026337537
[0.8749999999999999, 0.9583333333333333, 0.12499999999999999, 0.20833333333333331, 0.9583333333333333, 0.4583333333333333, 0.04166666666666667, 0.625, 0.625, 0.125]
[20, 20, 31, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8964, 'compress@10': 0.8816, 'time@10': 16.0453}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8964, 'compress@10': 0.8816, 'time@10': 16.0453}:  10%|█         | 1/10 [00:08<01:12,  8.06s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9277, 'compress@10': 0.9206, 'time@10': 14.47}:  10%|█         | 1/10 [00:20<01:12,  8.06s/it] {'epoch': 11, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9277, 'compress@10': 0.9206, 'time@10': 14.47}:  20%|██        | 2/10 [00:20<01:27, 10.93s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9042, 'compress@10': 0.6971, 'time@10': 12.3989}:  20%|██        | 2/10 [00:25<01:27, 10.93s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9042, 'compress@10': 0.6971, 'time@10': 12.3989}:  30%|███       | 3/10 [00:25<00:54,  7.84s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9183, 'compress@10': 0.582, 'time@10': 12.4025}:  30%|███       | 3/10 [00:37<00:54,  7.84s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9183, 'compress@10': 0.582, 'time@10': 12.4025}:  40%|████      | 4/10 [00:37<00:57,  9.66s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.918, 'compress@10': 0.6574, 'time@10': 15.7917}:  40%|████      | 4/10 [00:52<00:57,  9.66s/it] {'epoch': 11, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.918, 'compress@10': 0.6574, 'time@10': 15.7917}:  50%|█████     | 5/10 [00:52<00:57, 11.48s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9264, 'compress@10': 0.6262, 'time@10': 16.602}:  50%|█████     | 5/10 [01:13<00:57, 11.48s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9264, 'compress@10': 0.6262, 'time@10': 16.602}:  60%|██████    | 6/10 [01:13<00:58, 14.61s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0159, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9264, 'compress@10': 0.5482, 'time@10': 17.1392}:  60%|██████    | 6/10 [01:23<00:58, 14.61s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0159, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9264, 'compress@10': 0.5482, 'time@10': 17.1392}:  70%|███████   | 7/10 [01:23<00:39, 13.18s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0169, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9311, 'compress@10': 0.5591, 'time@10': 16.9799}:  70%|███████   | 7/10 [01:39<00:39, 13.18s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0169, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9311, 'compress@10': 0.5591, 'time@10': 16.9799}:  80%|████████  | 8/10 [01:39<00:28, 14.04s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9301, 'compress@10': 0.5676, 'time@10': 18.5148}:  80%|████████  | 8/10 [01:54<00:28, 14.04s/it] {'epoch': 11, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9301, 'compress@10': 0.5676, 'time@10': 18.5148}:  90%|█████████ | 9/10 [01:54<00:14, 14.48s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9369, 'compress@10': 0.5254, 'time@10': 18.6168}:  90%|█████████ | 9/10 [02:14<00:14, 14.48s/it] {'epoch': 11, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9369, 'compress@10': 0.5254, 'time@10': 18.6168}: 100%|██████████| 10/10 [02:14<00:00, 16.05s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9369, 'compress@10': 0.5254, 'time@10': 18.6168}: 100%|██████████| 10/10 [02:14<00:00, 13.41s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.017416613899790184
Avg hit ratio: 0.8807703373781471
Avg ndcg: 0.9368678726061941
Avg compression ratio: 0.525367086440759
Avg train time: 18.616779708862303
Std train time: 6.813527988673948
[0.8076923076923076, 0.9615384615384615, 0.11538461538461538, 0.1923076923076923, 0.9615384615384615, 0.4230769230769231, 0.11538461538461539, 0.6538461538461539, 0.6538461538461539, 0.11538461538461539]
[20, 20, 32, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8986, 'compress@10': 0.8178, 'time@10': 16.452}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8986, 'compress@10': 0.8178, 'time@10': 16.452}:  10%|█         | 1/10 [00:08<01:14,  8.26s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9331, 'compress@10': 0.8903, 'time@10': 14.5901}:  10%|█         | 1/10 [00:21<01:14,  8.26s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9331, 'compress@10': 0.8903, 'time@10': 14.5901}:  20%|██        | 2/10 [00:21<01:27, 10.91s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9078, 'compress@10': 0.6741, 'time@10': 12.3548}:  20%|██        | 2/10 [00:25<01:27, 10.91s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9078, 'compress@10': 0.6741, 'time@10': 12.3548}:  30%|███       | 3/10 [00:25<00:54,  7.76s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.921, 'compress@10': 0.5609, 'time@10': 12.3693}:  30%|███       | 3/10 [00:37<00:54,  7.76s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.921, 'compress@10': 0.5609, 'time@10': 12.3693}:  40%|████      | 4/10 [00:37<00:57,  9.61s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9223, 'compress@10': 0.6412, 'time@10': 15.811}:  40%|████      | 4/10 [00:52<00:57,  9.61s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9223, 'compress@10': 0.6412, 'time@10': 15.811}:  50%|█████     | 5/10 [00:52<00:57, 11.49s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9303, 'compress@10': 0.6069, 'time@10': 16.6799}:  50%|█████     | 5/10 [01:13<00:57, 11.49s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9303, 'compress@10': 0.6069, 'time@10': 16.6799}:  60%|██████    | 6/10 [01:13<00:58, 14.75s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9323, 'compress@10': 0.5418, 'time@10': 17.2619}:  60%|██████    | 6/10 [01:23<00:58, 14.75s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9323, 'compress@10': 0.5418, 'time@10': 17.2619}:  70%|███████   | 7/10 [01:23<00:39, 13.33s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9359, 'compress@10': 0.557, 'time@10': 17.0902}:  70%|███████   | 7/10 [01:39<00:39, 13.33s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9359, 'compress@10': 0.557, 'time@10': 17.0902}:  80%|████████  | 8/10 [01:39<00:28, 14.16s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9427, 'compress@10': 0.5689, 'time@10': 18.5621}:  80%|████████  | 8/10 [01:54<00:28, 14.16s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9427, 'compress@10': 0.5689, 'time@10': 18.5621}:  90%|█████████ | 9/10 [01:54<00:14, 14.48s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9472, 'compress@10': 0.5255, 'time@10': 18.5472}:  90%|█████████ | 9/10 [02:13<00:14, 14.48s/it]  {'epoch': 12, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9472, 'compress@10': 0.5255, 'time@10': 18.5472}: 100%|██████████| 10/10 [02:13<00:00, 15.71s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9472, 'compress@10': 0.5255, 'time@10': 18.5472}: 100%|██████████| 10/10 [02:13<00:00, 13.34s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.01669909000948968
Avg hit ratio: 0.8907672382324335
Avg ndcg: 0.9472358788416241
Avg compression ratio: 0.5255400934503169
Avg train time: 18.547247529029846
Std train time: 6.84364121728443
[0.8214285714285714, 0.9642857142857142, 0.10714285714285714, 0.17857142857142855, 0.9642857142857142, 0.39285714285714285, 0.10714285714285715, 0.6785714285714286, 0.6785714285714286, 0.10714285714285715]
[20, 20, 33, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8938, 'compress@10': 0.8308, 'time@10': 16.2861}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8938, 'compress@10': 0.8308, 'time@10': 16.2861}:  10%|█         | 1/10 [00:08<01:13,  8.18s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9444, 'compress@10': 0.8981, 'time@10': 14.551}:  10%|█         | 1/10 [00:21<01:13,  8.18s/it]  {'epoch': 13, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9444, 'compress@10': 0.8981, 'time@10': 14.551}:  20%|██        | 2/10 [00:21<01:27, 10.93s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9153, 'compress@10': 0.677, 'time@10': 12.5114}:  20%|██        | 2/10 [00:25<01:27, 10.93s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9153, 'compress@10': 0.677, 'time@10': 12.5114}:  30%|███       | 3/10 [00:25<00:55,  7.88s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.927, 'compress@10': 0.5597, 'time@10': 12.404}:  30%|███       | 3/10 [00:37<00:55,  7.88s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.927, 'compress@10': 0.5597, 'time@10': 12.404}:  40%|████      | 4/10 [00:37<00:57,  9.55s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0157, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.93, 'compress@10': 0.6408, 'time@10': 15.7897}:  40%|████      | 4/10 [00:52<00:57,  9.55s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0157, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.93, 'compress@10': 0.6408, 'time@10': 15.7897}:  50%|█████     | 5/10 [00:52<00:57, 11.41s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9368, 'compress@10': 0.6017, 'time@10': 16.5531}:  50%|█████     | 5/10 [01:12<00:57, 11.41s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9368, 'compress@10': 0.6017, 'time@10': 16.5531}:  60%|██████    | 6/10 [01:12<00:57, 14.47s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0145, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9374, 'compress@10': 0.5361, 'time@10': 17.0825}:  60%|██████    | 6/10 [01:22<00:57, 14.47s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0145, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9374, 'compress@10': 0.5361, 'time@10': 17.0825}:  70%|███████   | 7/10 [01:22<00:39, 13.06s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9402, 'compress@10': 0.5551, 'time@10': 16.8575}:  70%|███████   | 7/10 [01:38<00:39, 13.06s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9402, 'compress@10': 0.5551, 'time@10': 16.8575}:  80%|████████  | 8/10 [01:38<00:27, 13.79s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9423, 'compress@10': 0.5698, 'time@10': 18.2917}:  80%|████████  | 8/10 [01:52<00:27, 13.79s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9423, 'compress@10': 0.5698, 'time@10': 18.2917}:  90%|█████████ | 9/10 [01:52<00:14, 14.14s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9444, 'compress@10': 0.5256, 'time@10': 18.2647}:  90%|█████████ | 9/10 [02:10<00:14, 14.14s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9444, 'compress@10': 0.5256, 'time@10': 18.2647}: 100%|██████████| 10/10 [02:10<00:00, 15.35s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9444, 'compress@10': 0.5256, 'time@10': 18.2647}: 100%|██████████| 10/10 [02:10<00:00, 13.10s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.015024997162973055
Avg hit ratio: 0.8961128603522491
Avg ndcg: 0.9443733697363627
Avg compression ratio: 0.5255967459804312
Avg train time: 18.264657378196716
Std train time: 6.638065789904307
[0.8333333333333333, 0.9666666666666666, 0.09999999999999999, 0.16666666666666666, 0.9666666666666666, 0.36666666666666664, 0.16666666666666669, 0.6333333333333334, 0.7000000000000001, 0.1]
[20, 20, 34, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8965, 'compress@10': 0.8421, 'time@10': 16.5316}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8965, 'compress@10': 0.8421, 'time@10': 16.5316}:  10%|█         | 1/10 [00:08<01:14,  8.30s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0237, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9511, 'compress@10': 0.9049, 'time@10': 14.4751}:  10%|█         | 1/10 [00:20<01:14,  8.30s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0237, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9511, 'compress@10': 0.9049, 'time@10': 14.4751}:  20%|██        | 2/10 [00:20<01:25, 10.75s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9198, 'compress@10': 0.6795, 'time@10': 12.369}:  20%|██        | 2/10 [00:24<01:25, 10.75s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9198, 'compress@10': 0.6795, 'time@10': 12.369}:  30%|███       | 3/10 [00:24<00:54,  7.72s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.931, 'compress@10': 0.5587, 'time@10': 12.3381}:  30%|███       | 3/10 [00:37<00:54,  7.72s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.931, 'compress@10': 0.5587, 'time@10': 12.3381}:  40%|████      | 4/10 [00:37<00:57,  9.52s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9346, 'compress@10': 0.6404, 'time@10': 15.453}:  40%|████      | 4/10 [00:51<00:57,  9.52s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9346, 'compress@10': 0.6404, 'time@10': 15.453}:  50%|█████     | 5/10 [00:51<00:55, 11.14s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9407, 'compress@10': 0.5971, 'time@10': 16.2534}:  50%|█████     | 5/10 [01:11<00:55, 11.14s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9407, 'compress@10': 0.5971, 'time@10': 16.2534}:  60%|██████    | 6/10 [01:11<00:57, 14.25s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9415, 'compress@10': 0.5404, 'time@10': 16.9941}:  60%|██████    | 6/10 [01:22<00:57, 14.25s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9415, 'compress@10': 0.5404, 'time@10': 16.9941}:  70%|███████   | 7/10 [01:22<00:39, 13.11s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.929, 'compress@10': 0.5533, 'time@10': 16.8226}:  70%|███████   | 7/10 [01:37<00:39, 13.11s/it]  {'epoch': 14, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.929, 'compress@10': 0.5533, 'time@10': 16.8226}:  80%|████████  | 8/10 [01:37<00:27, 13.92s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9325, 'compress@10': 0.5706, 'time@10': 18.2348}:  80%|████████  | 8/10 [01:52<00:27, 13.92s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9325, 'compress@10': 0.5706, 'time@10': 18.2348}:  90%|█████████ | 9/10 [01:52<00:14, 14.20s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9367, 'compress@10': 0.5256, 'time@10': 18.2363}:  90%|█████████ | 9/10 [02:10<00:14, 14.20s/it]  {'epoch': 14, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9367, 'compress@10': 0.5256, 'time@10': 18.2363}: 100%|██████████| 10/10 [02:10<00:00, 15.46s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9367, 'compress@10': 0.5256, 'time@10': 18.2363}: 100%|██████████| 10/10 [02:10<00:00, 13.10s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.01651827225390042
Avg hit ratio: 0.9050529525181478
Avg ndcg: 0.9366528672652951
Avg compression ratio: 0.5255711467339245
Avg train time: 18.2362580537796
Std train time: 6.454721959670426
[0.8437499999999999, 0.9687499999999999, 0.09374999999999999, 0.15625, 0.9687499999999999, 0.34375, 0.15625000000000003, 0.6562500000000001, 0.7187500000000001, 0.09375]
[20, 20, 35, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.852, 'time@10': 15.6804}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.852, 'time@10': 15.6804}:  10%|█         | 1/10 [00:07<01:10,  7.88s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9324, 'compress@10': 0.9109, 'time@10': 13.9331}:  10%|█         | 1/10 [00:20<01:10,  7.88s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9324, 'compress@10': 0.9109, 'time@10': 13.9331}:  20%|██        | 2/10 [00:20<01:23, 10.43s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9073, 'compress@10': 0.6816, 'time@10': 12.251}:  20%|██        | 2/10 [00:24<01:23, 10.43s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9073, 'compress@10': 0.6816, 'time@10': 12.251}:  30%|███       | 3/10 [00:24<00:54,  7.72s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9216, 'compress@10': 0.5578, 'time@10': 12.2202}:  30%|███       | 3/10 [00:36<00:54,  7.72s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9216, 'compress@10': 0.5578, 'time@10': 12.2202}:  40%|████      | 4/10 [00:36<00:56,  9.48s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9268, 'compress@10': 0.6401, 'time@10': 15.5925}:  40%|████      | 4/10 [00:51<00:56,  9.48s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9268, 'compress@10': 0.6401, 'time@10': 15.5925}:  50%|█████     | 5/10 [00:51<00:56, 11.32s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0101, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9342, 'compress@10': 0.5932, 'time@10': 16.382}:  50%|█████     | 5/10 [01:11<00:56, 11.32s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0101, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9342, 'compress@10': 0.5932, 'time@10': 16.382}:  60%|██████    | 6/10 [01:11<00:57, 14.39s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9359, 'compress@10': 0.5356, 'time@10': 17.1112}:  60%|██████    | 6/10 [01:22<00:57, 14.39s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9359, 'compress@10': 0.5356, 'time@10': 17.1112}:  70%|███████   | 7/10 [01:22<00:39, 13.21s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9414, 'compress@10': 0.5519, 'time@10': 16.9167}:  70%|███████   | 7/10 [01:38<00:39, 13.21s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9414, 'compress@10': 0.5519, 'time@10': 16.9167}:  80%|████████  | 8/10 [01:38<00:27, 13.97s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0142, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9413, 'compress@10': 0.5713, 'time@10': 18.3163}:  80%|████████  | 8/10 [01:52<00:27, 13.97s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0142, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9413, 'compress@10': 0.5713, 'time@10': 18.3163}:  90%|█████████ | 9/10 [01:52<00:14, 14.23s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9452, 'compress@10': 0.5256, 'time@10': 18.2694}:  90%|█████████ | 9/10 [02:10<00:14, 14.23s/it]    {'epoch': 15, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9452, 'compress@10': 0.5256, 'time@10': 18.2694}: 100%|██████████| 10/10 [02:10<00:00, 15.36s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9452, 'compress@10': 0.5256, 'time@10': 18.2694}: 100%|██████████| 10/10 [02:10<00:00, 13.08s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.013747011314358274
Avg hit ratio: 0.8989700032093919
Avg ndcg: 0.9451711165390007
Avg compression ratio: 0.5256194393313095
Avg train time: 18.269424629211425
Std train time: 6.595013542262233
[0.7941176470588234, 0.9705882352941175, 0.08823529411764705, 0.14705882352941177, 0.9705882352941175, 0.3235294117647059, 0.2058823529411765, 0.6764705882352943, 0.7352941176470589, 0.08823529411764706]
[20, 20, 36, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9191, 'compress@10': 0.8049, 'time@10': 16.3526}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9191, 'compress@10': 0.8049, 'time@10': 16.3526}:  10%|█         | 1/10 [00:08<01:13,  8.21s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9422, 'compress@10': 0.8882, 'time@10': 14.33}:  10%|█         | 1/10 [00:20<01:13,  8.21s/it]   {'epoch': 16, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9422, 'compress@10': 0.8882, 'time@10': 14.33}:  20%|██        | 2/10 [00:20<01:25, 10.64s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9138, 'compress@10': 0.665, 'time@10': 12.4491}:  20%|██        | 2/10 [00:24<01:25, 10.64s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9138, 'compress@10': 0.665, 'time@10': 12.4491}:  30%|███       | 3/10 [00:24<00:54,  7.78s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9266, 'compress@10': 0.5431, 'time@10': 12.3177}:  30%|███       | 3/10 [00:36<00:54,  7.78s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9266, 'compress@10': 0.5431, 'time@10': 12.3177}:  40%|████      | 4/10 [00:36<00:56,  9.43s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9315, 'compress@10': 0.6287, 'time@10': 15.6484}:  40%|████      | 4/10 [00:51<00:56,  9.43s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9315, 'compress@10': 0.6287, 'time@10': 15.6484}:  50%|█████     | 5/10 [00:51<00:56, 11.27s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.9236, 'ndcg@10': 0.9383, 'compress@10': 0.5804, 'time@10': 16.3992}:  50%|█████     | 5/10 [01:11<00:56, 11.27s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.9236, 'ndcg@10': 0.9383, 'compress@10': 0.5804, 'time@10': 16.3992}:  60%|██████    | 6/10 [01:11<00:57, 14.31s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.9288, 'ndcg@10': 0.9401, 'compress@10': 0.5314, 'time@10': 17.1813}:  60%|██████    | 6/10 [01:22<00:57, 14.31s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.9288, 'ndcg@10': 0.9401, 'compress@10': 0.5314, 'time@10': 17.1813}:  70%|███████   | 7/10 [01:22<00:39, 13.22s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.9342, 'ndcg@10': 0.9352, 'compress@10': 0.5507, 'time@10': 16.9559}:  70%|███████   | 7/10 [01:38<00:39, 13.22s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.9342, 'ndcg@10': 0.9352, 'compress@10': 0.5507, 'time@10': 16.9559}:  80%|████████  | 8/10 [01:38<00:27, 13.92s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9356, 'compress@10': 0.572, 'time@10': 18.338}:  80%|████████  | 8/10 [01:52<00:27, 13.92s/it] {'epoch': 16, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9356, 'compress@10': 0.572, 'time@10': 18.338}:  90%|█████████ | 9/10 [01:52<00:14, 14.17s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.9136, 'ndcg@10': 0.941, 'compress@10': 0.5257, 'time@10': 18.2435}:  90%|█████████ | 9/10 [02:10<00:14, 14.17s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.9136, 'ndcg@10': 0.941, 'compress@10': 0.5257, 'time@10': 18.2435}: 100%|██████████| 10/10 [02:10<00:00, 15.18s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.9136, 'ndcg@10': 0.941, 'compress@10': 0.5257, 'time@10': 18.2435}: 100%|██████████| 10/10 [02:10<00:00, 13.02s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.013013900451451014
Avg hit ratio: 0.9136243810895761
Avg ndcg: 0.9410202343246852
Avg compression ratio: 0.5257366929165462
Avg train time: 18.243516826629637
Std train time: 6.5974089282262405
[0.7499999999999999, 0.9722222222222221, 0.08333333333333333, 0.1388888888888889, 0.9722222222222221, 0.3055555555555556, 0.19444444444444448, 0.6944444444444446, 0.75, 0.1388888888888889]
[20, 20, 37, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9143, 'compress@10': 0.7632, 'time@10': 16.4697}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9143, 'compress@10': 0.7632, 'time@10': 16.4697}:  10%|█         | 1/10 [00:08<01:14,  8.27s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9449, 'compress@10': 0.8681, 'time@10': 14.4035}:  10%|█         | 1/10 [00:20<01:14,  8.27s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9449, 'compress@10': 0.8681, 'time@10': 14.4035}:  20%|██        | 2/10 [00:20<01:25, 10.69s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9156, 'compress@10': 0.6502, 'time@10': 12.6226}:  20%|██        | 2/10 [00:25<01:25, 10.69s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9156, 'compress@10': 0.6502, 'time@10': 12.6226}:  30%|███       | 3/10 [00:25<00:55,  7.90s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9284, 'compress@10': 0.53, 'time@10': 12.4081}:  30%|███       | 3/10 [00:37<00:55,  7.90s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9284, 'compress@10': 0.53, 'time@10': 12.4081}:  40%|████      | 4/10 [00:37<00:56,  9.44s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9333, 'compress@10': 0.6186, 'time@10': 15.6927}:  40%|████      | 4/10 [00:51<00:56,  9.44s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9333, 'compress@10': 0.6186, 'time@10': 15.6927}:  50%|█████     | 5/10 [00:51<00:56, 11.25s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9398, 'compress@10': 0.569, 'time@10': 16.4522}:  50%|█████     | 5/10 [01:11<00:56, 11.25s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9398, 'compress@10': 0.569, 'time@10': 16.4522}:  60%|██████    | 6/10 [01:11<00:57, 14.33s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9398, 'compress@10': 0.5201, 'time@10': 17.124}:  60%|██████    | 6/10 [01:22<00:57, 14.33s/it] {'epoch': 17, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9398, 'compress@10': 0.5201, 'time@10': 17.124}:  70%|███████   | 7/10 [01:22<00:39, 13.11s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9506, 'compress@10': 0.543, 'time@10': 16.9321}:  70%|███████   | 7/10 [01:38<00:39, 13.11s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9506, 'compress@10': 0.543, 'time@10': 16.9321}:  80%|████████  | 8/10 [01:38<00:27, 13.91s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9499, 'compress@10': 0.5668, 'time@10': 18.3299}:  80%|████████  | 8/10 [01:52<00:27, 13.91s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9499, 'compress@10': 0.5668, 'time@10': 18.3299}:  90%|█████████ | 9/10 [01:52<00:14, 14.19s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9532, 'compress@10': 0.5259, 'time@10': 18.4251}:  90%|█████████ | 9/10 [02:12<00:14, 14.19s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9532, 'compress@10': 0.5259, 'time@10': 18.4251}: 100%|██████████| 10/10 [02:12<00:00, 15.78s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9532, 'compress@10': 0.5259, 'time@10': 18.4251}: 100%|██████████| 10/10 [02:12<00:00, 13.22s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.015796098092256322
Avg hit ratio: 0.902564473255475
Avg ndcg: 0.9532424589443472
Avg compression ratio: 0.5259386464006848
Avg train time: 18.425093150138856
Std train time: 6.5093977089933865
[0.763157894736842, 0.9736842105263157, 0.07894736842105263, 0.13157894736842105, 0.9210526315789472, 0.2894736842105263, 0.23684210526315794, 0.7105263157894739, 0.7631578947368421, 0.13157894736842105]
[20, 20, 38, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9209, 'compress@10': 0.7756, 'time@10': 16.2152}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9209, 'compress@10': 0.7756, 'time@10': 16.2152}:  10%|█         | 1/10 [00:08<01:13,  8.15s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9586, 'compress@10': 0.8751, 'time@10': 14.3664}:  10%|█         | 1/10 [00:20<01:13,  8.15s/it] {'epoch': 18, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9586, 'compress@10': 0.8751, 'time@10': 14.3664}:  20%|██        | 2/10 [00:20<01:25, 10.74s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9248, 'compress@10': 0.6536, 'time@10': 12.6969}:  20%|██        | 2/10 [00:25<01:25, 10.74s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9248, 'compress@10': 0.6536, 'time@10': 12.6969}:  30%|███       | 3/10 [00:25<00:55,  7.99s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9353, 'compress@10': 0.5308, 'time@10': 12.5387}:  30%|███       | 3/10 [00:37<00:55,  7.99s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9353, 'compress@10': 0.5308, 'time@10': 12.5387}:  40%|████      | 4/10 [00:37<00:57,  9.62s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.941, 'compress@10': 0.6092, 'time@10': 15.7805}:  40%|████      | 4/10 [00:51<00:57,  9.62s/it] {'epoch': 18, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.941, 'compress@10': 0.6092, 'time@10': 15.7805}:  50%|█████     | 5/10 [00:51<00:56, 11.35s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9462, 'compress@10': 0.5585, 'time@10': 16.4576}:  50%|█████     | 5/10 [01:11<00:56, 11.35s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9462, 'compress@10': 0.5585, 'time@10': 16.4576}:  60%|██████    | 6/10 [01:11<00:56, 14.25s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9473, 'compress@10': 0.5169, 'time@10': 17.2017}:  60%|██████    | 6/10 [01:22<00:56, 14.25s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9473, 'compress@10': 0.5169, 'time@10': 17.2017}:  70%|███████   | 7/10 [01:22<00:39, 13.14s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9498, 'compress@10': 0.5422, 'time@10': 16.9704}:  70%|███████   | 7/10 [01:38<00:39, 13.14s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9498, 'compress@10': 0.5422, 'time@10': 16.9704}:  80%|████████  | 8/10 [01:38<00:27, 13.86s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9523, 'compress@10': 0.5675, 'time@10': 18.3319}:  80%|████████  | 8/10 [01:52<00:27, 13.86s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9523, 'compress@10': 0.5675, 'time@10': 18.3319}:  90%|█████████ | 9/10 [01:52<00:14, 14.11s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9548, 'compress@10': 0.5259, 'time@10': 18.4051}:  90%|█████████ | 9/10 [02:11<00:14, 14.11s/it]  {'epoch': 18, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9548, 'compress@10': 0.5259, 'time@10': 18.4051}: 100%|██████████| 10/10 [02:11<00:00, 15.65s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9548, 'compress@10': 0.5259, 'time@10': 18.4051}: 100%|██████████| 10/10 [02:11<00:00, 13.18s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.01264193099925722
Avg hit ratio: 0.9050529525181478
Avg ndcg: 0.9548204063694467
Avg compression ratio: 0.5258527097010063
Avg train time: 18.405112433433533
Std train time: 6.387404118958046
[0.7749999999999999, 0.9749999999999999, 0.075, 0.125, 0.9249999999999998, 0.275, 0.22500000000000003, 0.7250000000000002, 0.775, 0.125]
[20, 20, 39, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9282, 'compress@10': 0.7868, 'time@10': 16.0215}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9282, 'compress@10': 0.7868, 'time@10': 16.0215}:  10%|█         | 1/10 [00:08<01:12,  8.05s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9824, 'compress@10': 0.8813, 'time@10': 14.3205}:  10%|█         | 1/10 [00:20<01:12,  8.05s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9824, 'compress@10': 0.8813, 'time@10': 14.3205}:  20%|██        | 2/10 [00:20<01:26, 10.76s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9407, 'compress@10': 0.6566, 'time@10': 12.762}:  20%|██        | 2/10 [00:25<01:26, 10.76s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9407, 'compress@10': 0.6566, 'time@10': 12.762}:  30%|███       | 3/10 [00:25<00:56,  8.07s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9466, 'compress@10': 0.5315, 'time@10': 12.5839}:  30%|███       | 3/10 [00:37<00:56,  8.07s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9466, 'compress@10': 0.5315, 'time@10': 12.5839}:  40%|████      | 4/10 [00:37<00:57,  9.66s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.014, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9496, 'compress@10': 0.6105, 'time@10': 15.7414}:  40%|████      | 4/10 [00:51<00:57,  9.66s/it] {'epoch': 19, 'num_users': 5.8, 'loss': 0.014, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9496, 'compress@10': 0.6105, 'time@10': 15.7414}:  50%|█████     | 5/10 [00:51<00:56, 11.30s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9534, 'compress@10': 0.5573, 'time@10': 16.4795}:  50%|█████     | 5/10 [01:12<00:56, 11.30s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9534, 'compress@10': 0.5573, 'time@10': 16.4795}:  60%|██████    | 6/10 [01:12<00:57, 14.33s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9222, 'ndcg@10': 0.9518, 'compress@10': 0.5142, 'time@10': 17.3231}:  60%|██████    | 6/10 [01:23<00:57, 14.33s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9222, 'ndcg@10': 0.9518, 'compress@10': 0.5142, 'time@10': 17.3231}:  70%|███████   | 7/10 [01:23<00:39, 13.32s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.9284, 'ndcg@10': 0.9645, 'compress@10': 0.5416, 'time@10': 17.1083}:  70%|███████   | 7/10 [01:38<00:39, 13.32s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.9284, 'ndcg@10': 0.9645, 'compress@10': 0.5416, 'time@10': 17.1083}:  80%|████████  | 8/10 [01:38<00:28, 14.06s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9616, 'compress@10': 0.5682, 'time@10': 18.4351}:  80%|████████  | 8/10 [01:53<00:28, 14.06s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9616, 'compress@10': 0.5682, 'time@10': 18.4351}:  90%|█████████ | 9/10 [01:53<00:14, 14.21s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.9119, 'ndcg@10': 0.9723, 'compress@10': 0.5259, 'time@10': 18.4935}:  90%|█████████ | 9/10 [02:12<00:14, 14.21s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.9119, 'ndcg@10': 0.9723, 'compress@10': 0.5259, 'time@10': 18.4935}: 100%|██████████| 10/10 [02:12<00:00, 15.71s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.9119, 'ndcg@10': 0.9723, 'compress@10': 0.5259, 'time@10': 18.4935}: 100%|██████████| 10/10 [02:12<00:00, 13.26s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.016622905196443338
Avg hit ratio: 0.9118732290158436
Avg ndcg: 0.9722735455126182
Avg compression ratio: 0.5258759575588897
Avg train time: 18.493483686447142
Std train time: 6.2929841124402595
[0.738095238095238, 0.976190476190476, 0.07142857142857142, 0.11904761904761904, 0.8809523809523808, 0.2619047619047619, 0.2619047619047619, 0.7380952380952382, 0.7857142857142857, 0.16666666666666666]
[20, 20, 40, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9315, 'compress@10': 0.7519, 'time@10': 16.7115}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9315, 'compress@10': 0.7519, 'time@10': 16.7115}:  10%|█         | 1/10 [00:08<01:15,  8.41s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9502, 'compress@10': 0.8644, 'time@10': 14.5772}:  10%|█         | 1/10 [00:20<01:15,  8.41s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9502, 'compress@10': 0.8644, 'time@10': 14.5772}:  20%|██        | 2/10 [00:20<01:26, 10.80s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9192, 'compress@10': 0.6443, 'time@10': 13.0204}:  20%|██        | 2/10 [00:25<01:26, 10.80s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9192, 'compress@10': 0.6443, 'time@10': 13.0204}:  30%|███       | 3/10 [00:25<00:57,  8.16s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9311, 'compress@10': 0.5209, 'time@10': 12.7267}:  30%|███       | 3/10 [00:37<00:57,  8.16s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9311, 'compress@10': 0.5209, 'time@10': 12.7267}:  40%|████      | 4/10 [00:37<00:57,  9.63s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9385, 'compress@10': 0.5933, 'time@10': 16.0624}:  40%|████      | 4/10 [00:52<00:57,  9.63s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9385, 'compress@10': 0.5933, 'time@10': 16.0624}:  50%|█████     | 5/10 [00:52<00:57, 11.47s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9445, 'compress@10': 0.5408, 'time@10': 16.6816}:  50%|█████     | 5/10 [01:12<00:57, 11.47s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9445, 'compress@10': 0.5408, 'time@10': 16.6816}:  60%|██████    | 6/10 [01:12<00:57, 14.31s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0084, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.946, 'compress@10': 0.5052, 'time@10': 17.3647}:  60%|██████    | 6/10 [01:23<00:57, 14.31s/it] {'epoch': 20, 'num_users': 6.2857, 'loss': 0.0084, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.946, 'compress@10': 0.5052, 'time@10': 17.3647}:  70%|███████   | 7/10 [01:23<00:39, 13.16s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.01, 'hit_ratio@10': 0.905, 'ndcg@10': 0.948, 'compress@10': 0.5353, 'time@10': 17.0927}:  70%|███████   | 7/10 [01:38<00:39, 13.16s/it]    {'epoch': 20, 'num_users': 6.125, 'loss': 0.01, 'hit_ratio@10': 0.905, 'ndcg@10': 0.948, 'compress@10': 0.5353, 'time@10': 17.0927}:  80%|████████  | 8/10 [01:38<00:27, 13.82s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9549, 'compress@10': 0.5638, 'time@10': 18.3832}:  80%|████████  | 8/10 [01:52<00:27, 13.82s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9549, 'compress@10': 0.5638, 'time@10': 18.3832}:  90%|█████████ | 9/10 [01:52<00:13, 14.00s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9593, 'compress@10': 0.5259, 'time@10': 18.4434}:  90%|█████████ | 9/10 [02:11<00:13, 14.00s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9593, 'compress@10': 0.5259, 'time@10': 18.4434}: 100%|██████████| 10/10 [02:11<00:00, 15.55s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9593, 'compress@10': 0.5259, 'time@10': 18.4434}: 100%|██████████| 10/10 [02:11<00:00, 13.18s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.012624501729100221
Avg hit ratio: 0.9017073303983321
Avg ndcg: 0.9593479989509026
Avg compression ratio: 0.5259473198574718
Avg train time: 18.443418765068053
Std train time: 6.345941082029683
[0.7045454545454545, 0.9318181818181817, 0.06818181818181818, 0.1590909090909091, 0.8863636363636362, 0.25, 0.25, 0.7500000000000001, 0.7954545454545454, 0.20454545454545453]
[20, 20, 41, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9304, 'compress@10': 0.7201, 'time@10': 16.8352}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9304, 'compress@10': 0.7201, 'time@10': 16.8352}:  10%|█         | 1/10 [00:08<01:16,  8.46s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9477, 'compress@10': 0.827, 'time@10': 14.5882}:  10%|█         | 1/10 [00:20<01:16,  8.46s/it] {'epoch': 21, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9477, 'compress@10': 0.827, 'time@10': 14.5882}:  20%|██        | 2/10 [00:20<01:26, 10.76s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9175, 'compress@10': 0.6185, 'time@10': 13.147}:  20%|██        | 2/10 [00:26<01:26, 10.76s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9175, 'compress@10': 0.6185, 'time@10': 13.147}:  30%|███       | 3/10 [00:26<00:57,  8.21s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9292, 'compress@10': 0.5111, 'time@10': 12.8789}:  30%|███       | 3/10 [00:38<00:57,  8.21s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9292, 'compress@10': 0.5111, 'time@10': 12.8789}:  40%|████      | 4/10 [00:38<00:58,  9.75s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9366, 'compress@10': 0.5866, 'time@10': 16.2423}:  40%|████      | 4/10 [00:52<00:58,  9.75s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9366, 'compress@10': 0.5866, 'time@10': 16.2423}:  50%|█████     | 5/10 [00:53<00:58, 11.60s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9429, 'compress@10': 0.5333, 'time@10': 16.8614}:  50%|█████     | 5/10 [01:13<00:58, 11.60s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9429, 'compress@10': 0.5333, 'time@10': 16.8614}:  60%|██████    | 6/10 [01:13<00:57, 14.46s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9438, 'compress@10': 0.4971, 'time@10': 17.5476}:  60%|██████    | 6/10 [01:23<00:57, 14.46s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9438, 'compress@10': 0.4971, 'time@10': 17.5476}:  70%|███████   | 7/10 [01:23<00:39, 13.29s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9477, 'compress@10': 0.5296, 'time@10': 17.261}:  70%|███████   | 7/10 [01:39<00:39, 13.29s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9477, 'compress@10': 0.5296, 'time@10': 17.261}:  80%|████████  | 8/10 [01:39<00:27, 13.94s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9491, 'compress@10': 0.5598, 'time@10': 18.6358}:  80%|████████  | 8/10 [01:54<00:27, 13.94s/it] {'epoch': 21, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9491, 'compress@10': 0.5598, 'time@10': 18.6358}:  90%|█████████ | 9/10 [01:54<00:14, 14.22s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9596, 'compress@10': 0.5261, 'time@10': 18.7081}:  90%|█████████ | 9/10 [02:13<00:14, 14.22s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9596, 'compress@10': 0.5261, 'time@10': 18.7081}: 100%|██████████| 10/10 [02:13<00:00, 15.82s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9596, 'compress@10': 0.5261, 'time@10': 18.7081}: 100%|██████████| 10/10 [02:13<00:00, 13.35s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.0184067540949944
Avg hit ratio: 0.9077672382324333
Avg ndcg: 0.9596116605230293
Avg compression ratio: 0.5260850842915004
Avg train time: 18.708122301101685
Std train time: 6.497048733858601
[0.6739130434782608, 0.934782608695652, 0.06521739130434782, 0.15217391304347827, 0.8478260869565216, 0.2391304347826087, 0.2826086956521739, 0.7608695652173915, 0.8043478260869564, 0.23913043478260868]
[20, 20, 42, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.6911, 'time@10': 16.5979}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.6911, 'time@10': 16.5979}:  10%|█         | 1/10 [00:08<01:15,  8.34s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9497, 'compress@10': 0.814, 'time@10': 14.4387}:  10%|█         | 1/10 [00:20<01:15,  8.34s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9497, 'compress@10': 0.814, 'time@10': 14.4387}:  20%|██        | 2/10 [00:20<01:25, 10.68s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9188, 'compress@10': 0.6089, 'time@10': 13.1061}:  20%|██        | 2/10 [00:25<01:25, 10.68s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9188, 'compress@10': 0.6089, 'time@10': 13.1061}:  30%|███       | 3/10 [00:25<00:57,  8.20s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9308, 'compress@10': 0.5023, 'time@10': 12.8161}:  30%|███       | 3/10 [00:37<00:57,  8.20s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9308, 'compress@10': 0.5023, 'time@10': 12.8161}:  40%|████      | 4/10 [00:37<00:58,  9.70s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9388, 'compress@10': 0.572, 'time@10': 16.2835}:  40%|████      | 4/10 [00:53<00:58,  9.70s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9388, 'compress@10': 0.572, 'time@10': 16.2835}:  50%|█████     | 5/10 [00:53<00:58, 11.65s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9453, 'compress@10': 0.5193, 'time@10': 16.9188}:  50%|█████     | 5/10 [01:13<00:58, 11.65s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9453, 'compress@10': 0.5193, 'time@10': 16.9188}:  60%|██████    | 6/10 [01:13<00:58, 14.53s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.947, 'compress@10': 0.4896, 'time@10': 17.6758}:  60%|██████    | 6/10 [01:24<00:58, 14.53s/it] {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.947, 'compress@10': 0.4896, 'time@10': 17.6758}:  70%|███████   | 7/10 [01:24<00:40, 13.43s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0084, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9501, 'compress@10': 0.5244, 'time@10': 17.3745}:  70%|███████   | 7/10 [01:39<00:40, 13.43s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0084, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9501, 'compress@10': 0.5244, 'time@10': 17.3745}:  80%|████████  | 8/10 [01:39<00:28, 14.02s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9621, 'compress@10': 0.5561, 'time@10': 18.7056}:  80%|████████  | 8/10 [01:54<00:28, 14.02s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9621, 'compress@10': 0.5561, 'time@10': 18.7056}:  90%|█████████ | 9/10 [01:54<00:14, 14.24s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9635, 'compress@10': 0.5261, 'time@10': 18.771}:  90%|█████████ | 9/10 [02:13<00:14, 14.24s/it]    {'epoch': 22, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9635, 'compress@10': 0.5261, 'time@10': 18.771}: 100%|██████████| 10/10 [02:13<00:00, 15.83s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9635, 'compress@10': 0.5261, 'time@10': 18.771}: 100%|██████████| 10/10 [02:13<00:00, 13.37s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.010754708129289012
Avg hit ratio: 0.8997073303983321
Avg ndcg: 0.9634561712239706
Avg compression ratio: 0.5261406991055019
Avg train time: 18.770987582206725
Std train time: 6.5624289838211345
[0.6874999999999999, 0.9374999999999998, 0.0625, 0.1875, 0.8541666666666665, 0.22916666666666669, 0.2708333333333333, 0.7291666666666669, 0.8124999999999999, 0.22916666666666666]
[20, 20, 43, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9304, 'compress@10': 0.7039, 'time@10': 16.4489}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9304, 'compress@10': 0.7039, 'time@10': 16.4489}:  10%|█         | 1/10 [00:08<01:14,  8.26s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.946, 'compress@10': 0.8217, 'time@10': 14.4447}:  10%|█         | 1/10 [00:20<01:14,  8.26s/it] {'epoch': 23, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.946, 'compress@10': 0.8217, 'time@10': 14.4447}:  20%|██        | 2/10 [00:20<01:25, 10.74s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9164, 'compress@10': 0.6133, 'time@10': 13.1136}:  20%|██        | 2/10 [00:26<01:25, 10.74s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9164, 'compress@10': 0.6133, 'time@10': 13.1136}:  30%|███       | 3/10 [00:26<00:57,  8.24s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9283, 'compress@10': 0.5141, 'time@10': 12.9091}:  30%|███       | 3/10 [00:38<00:57,  8.24s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9283, 'compress@10': 0.5141, 'time@10': 12.9091}:  40%|████      | 4/10 [00:38<00:59,  9.86s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9364, 'compress@10': 0.5827, 'time@10': 16.4029}:  40%|████      | 4/10 [00:53<00:59,  9.86s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9364, 'compress@10': 0.5827, 'time@10': 16.4029}:  50%|█████     | 5/10 [00:53<00:58, 11.79s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9433, 'compress@10': 0.5266, 'time@10': 16.9989}:  50%|█████     | 5/10 [01:13<00:58, 11.79s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9433, 'compress@10': 0.5266, 'time@10': 16.9989}:  60%|██████    | 6/10 [01:13<00:58, 14.59s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9227, 'ndcg@10': 0.9446, 'compress@10': 0.4943, 'time@10': 17.6894}:  60%|██████    | 6/10 [01:24<00:58, 14.59s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9227, 'ndcg@10': 0.9446, 'compress@10': 0.4943, 'time@10': 17.6894}:  70%|███████   | 7/10 [01:24<00:40, 13.40s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.9288, 'ndcg@10': 0.9459, 'compress@10': 0.5246, 'time@10': 17.3827}:  70%|███████   | 7/10 [01:39<00:40, 13.40s/it]  {'epoch': 23, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.9288, 'ndcg@10': 0.9459, 'compress@10': 0.5246, 'time@10': 17.3827}:  80%|████████  | 8/10 [01:39<00:27, 14.00s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.9145, 'ndcg@10': 0.9484, 'compress@10': 0.5572, 'time@10': 18.7239}:  80%|████████  | 8/10 [01:54<00:27, 14.00s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.9145, 'ndcg@10': 0.9484, 'compress@10': 0.5572, 'time@10': 18.7239}:  90%|█████████ | 9/10 [01:54<00:14, 14.24s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9511, 'compress@10': 0.5261, 'time@10': 18.7885}:  90%|█████████ | 9/10 [02:13<00:14, 14.24s/it]    {'epoch': 23, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9511, 'compress@10': 0.5261, 'time@10': 18.7885}: 100%|██████████| 10/10 [02:13<00:00, 15.83s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9511, 'compress@10': 0.5261, 'time@10': 18.7885}: 100%|██████████| 10/10 [02:13<00:00, 13.40s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.012957768065820325
Avg hit ratio: 0.9207902797070877
Avg ndcg: 0.9511297266720427
Avg compression ratio: 0.5261203141014827
Avg train time: 18.788483357429506
Std train time: 6.550899177610659
[0.6999999999999998, 0.9399999999999998, 0.06, 0.18, 0.8199999999999998, 0.22000000000000003, 0.3, 0.7400000000000002, 0.8199999999999998, 0.22]
[20, 20, 44, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.941, 'compress@10': 0.7158, 'time@10': 16.1371}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.941, 'compress@10': 0.7158, 'time@10': 16.1371}:  10%|█         | 1/10 [00:08<01:12,  8.11s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9544, 'compress@10': 0.8288, 'time@10': 14.3529}:  10%|█         | 1/10 [00:20<01:12,  8.11s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9544, 'compress@10': 0.8288, 'time@10': 14.3529}:  20%|██        | 2/10 [00:20<01:26, 10.75s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.855, 'ndcg@10': 0.922, 'compress@10': 0.6173, 'time@10': 13.1828}:  20%|██        | 2/10 [00:26<01:26, 10.75s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.855, 'ndcg@10': 0.922, 'compress@10': 0.6173, 'time@10': 13.1828}:  30%|███       | 3/10 [00:26<00:58,  8.34s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9326, 'compress@10': 0.5153, 'time@10': 12.8757}:  30%|███       | 3/10 [00:38<00:58,  8.34s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9326, 'compress@10': 0.5153, 'time@10': 12.8757}:  40%|████      | 4/10 [00:38<00:58,  9.78s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9416, 'compress@10': 0.577, 'time@10': 16.3514}:  40%|████      | 4/10 [00:53<00:58,  9.78s/it]  {'epoch': 24, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9416, 'compress@10': 0.577, 'time@10': 16.3514}:  50%|█████     | 5/10 [00:53<00:58, 11.72s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0078, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9476, 'compress@10': 0.5204, 'time@10': 16.9842}:  50%|█████     | 5/10 [01:13<00:58, 11.72s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0078, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9476, 'compress@10': 0.5204, 'time@10': 16.9842}:  60%|██████    | 6/10 [01:13<00:58, 14.60s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0073, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.949, 'compress@10': 0.4929, 'time@10': 17.6476}:  60%|██████    | 6/10 [01:24<00:58, 14.60s/it] {'epoch': 24, 'num_users': 6.2857, 'loss': 0.0073, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.949, 'compress@10': 0.4929, 'time@10': 17.6476}:  70%|███████   | 7/10 [01:24<00:40, 13.38s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.9522, 'compress@10': 0.5247, 'time@10': 17.3677}:  70%|███████   | 7/10 [01:39<00:40, 13.38s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.9522, 'compress@10': 0.5247, 'time@10': 17.3677}:  80%|████████  | 8/10 [01:39<00:28, 14.04s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9558, 'compress@10': 0.5581, 'time@10': 18.6394}:  80%|████████  | 8/10 [01:54<00:28, 14.04s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9558, 'compress@10': 0.5581, 'time@10': 18.6394}:  90%|█████████ | 9/10 [01:54<00:14, 14.17s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.958, 'compress@10': 0.526, 'time@10': 18.7117}:  90%|█████████ | 9/10 [02:13<00:14, 14.17s/it]     {'epoch': 24, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.958, 'compress@10': 0.526, 'time@10': 18.7117}: 100%|██████████| 10/10 [02:13<00:00, 15.78s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.958, 'compress@10': 0.526, 'time@10': 18.7117}: 100%|██████████| 10/10 [02:13<00:00, 13.37s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.009859050163970725
Avg hit ratio: 0.9074216161126177
Avg ndcg: 0.9579716448267851
Avg compression ratio: 0.5260484162229473
Avg train time: 18.711691212654113
Std train time: 6.396289529797896
[0.7115384615384613, 0.9038461538461537, 0.05769230769230769, 0.21153846153846154, 0.8269230769230768, 0.21153846153846156, 0.28846153846153844, 0.7500000000000002, 0.8269230769230768, 0.21153846153846154]
[20, 20, 44, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.7267, 'time@10': 16.5569}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.7267, 'time@10': 16.5569}:  10%|█         | 1/10 [00:08<01:14,  8.32s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9552, 'compress@10': 0.8168, 'time@10': 14.5883}:  10%|█         | 1/10 [00:20<01:14,  8.32s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9552, 'compress@10': 0.8168, 'time@10': 14.5883}:  20%|██        | 2/10 [00:20<01:26, 10.87s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9225, 'compress@10': 0.6087, 'time@10': 13.3042}:  20%|██        | 2/10 [00:26<01:26, 10.87s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9225, 'compress@10': 0.6087, 'time@10': 13.3042}:  30%|███       | 3/10 [00:26<00:58,  8.37s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.933, 'compress@10': 0.5164, 'time@10': 13.0917}:  30%|███       | 3/10 [00:38<00:58,  8.37s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.933, 'compress@10': 0.5164, 'time@10': 13.0917}:  40%|████      | 4/10 [00:38<01:00, 10.00s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9421, 'compress@10': 0.5792, 'time@10': 16.4477}:  40%|████      | 4/10 [00:53<01:00, 10.00s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9421, 'compress@10': 0.5792, 'time@10': 16.4477}:  50%|█████     | 5/10 [00:53<00:59, 11.80s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.948, 'compress@10': 0.5209, 'time@10': 16.9417}:  50%|█████     | 5/10 [01:13<00:59, 11.80s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.948, 'compress@10': 0.5209, 'time@10': 16.9417}:  60%|██████    | 6/10 [01:13<00:57, 14.40s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.913, 'ndcg@10': 0.948, 'compress@10': 0.4917, 'time@10': 17.4878}:  60%|██████    | 6/10 [01:23<00:57, 14.40s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.913, 'ndcg@10': 0.948, 'compress@10': 0.4917, 'time@10': 17.4878}:  70%|███████   | 7/10 [01:23<00:39, 13.10s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9509, 'compress@10': 0.5249, 'time@10': 17.1071}:  70%|███████   | 7/10 [01:38<00:39, 13.10s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9509, 'compress@10': 0.5249, 'time@10': 17.1071}:  80%|████████  | 8/10 [01:38<00:27, 13.54s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9554, 'compress@10': 0.559, 'time@10': 18.2183}:  80%|████████  | 8/10 [01:51<00:27, 13.54s/it] {'epoch': 25, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9554, 'compress@10': 0.559, 'time@10': 18.2183}:  90%|█████████ | 9/10 [01:51<00:13, 13.56s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.914, 'ndcg@10': 0.959, 'compress@10': 0.526, 'time@10': 18.224}:  90%|█████████ | 9/10 [02:10<00:13, 13.56s/it]     {'epoch': 25, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.914, 'ndcg@10': 0.959, 'compress@10': 0.526, 'time@10': 18.224}: 100%|██████████| 10/10 [02:10<00:00, 15.02s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.914, 'ndcg@10': 0.959, 'compress@10': 0.526, 'time@10': 18.224}: 100%|██████████| 10/10 [02:10<00:00, 13.01s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.012064987550878072
Avg hit ratio: 0.9139930446840463
Avg ndcg: 0.9590390761507288
Avg compression ratio: 0.5260481336919796
Avg train time: 18.223996305465697
Std train time: 6.002512038315032
[0.722222222222222, 0.8703703703703702, 0.05555555555555555, 0.2037037037037037, 0.7962962962962962, 0.20370370370370372, 0.31481481481481477, 0.7592592592592595, 0.8333333333333331, 0.24074074074074073]
[20, 20, 44, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0058, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.7368, 'time@10': 15.3455}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0058, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.7368, 'time@10': 15.3455}:  10%|█         | 1/10 [00:07<01:09,  7.73s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.98, 'compress@10': 0.8057, 'time@10': 13.9894}:  10%|█         | 1/10 [00:20<01:09,  7.73s/it] {'epoch': 26, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.98, 'compress@10': 0.8057, 'time@10': 13.9894}:  20%|██        | 2/10 [00:20<01:25, 10.64s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.939, 'compress@10': 0.6006, 'time@10': 12.7885}:  20%|██        | 2/10 [00:25<01:25, 10.64s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.939, 'compress@10': 0.6006, 'time@10': 12.7885}:  30%|███       | 3/10 [00:25<00:57,  8.17s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9453, 'compress@10': 0.5085, 'time@10': 12.456}:  30%|███       | 3/10 [00:37<00:57,  8.17s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9453, 'compress@10': 0.5085, 'time@10': 12.456}:  40%|████      | 4/10 [00:37<00:56,  9.48s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9517, 'compress@10': 0.5669, 'time@10': 15.7056}:  40%|████      | 4/10 [00:51<00:56,  9.48s/it] {'epoch': 26, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9517, 'compress@10': 0.5669, 'time@10': 15.7056}:  50%|█████     | 5/10 [00:51<00:56, 11.25s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0104, 'hit_ratio@10': 0.9106, 'ndcg@10': 0.9555, 'compress@10': 0.5093, 'time@10': 16.2128}:  50%|█████     | 5/10 [01:10<00:56, 11.25s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0104, 'hit_ratio@10': 0.9106, 'ndcg@10': 0.9555, 'compress@10': 0.5093, 'time@10': 16.2128}:  60%|██████    | 6/10 [01:10<00:55, 13.81s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9561, 'compress@10': 0.4854, 'time@10': 16.8182}:  60%|██████    | 6/10 [01:20<00:55, 13.81s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9561, 'compress@10': 0.4854, 'time@10': 16.8182}:  70%|███████   | 7/10 [01:20<00:37, 12.65s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.9244, 'ndcg@10': 0.9572, 'compress@10': 0.5205, 'time@10': 16.4889}:  70%|███████   | 7/10 [01:34<00:37, 12.65s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.9244, 'ndcg@10': 0.9572, 'compress@10': 0.5205, 'time@10': 16.4889}:  80%|████████  | 8/10 [01:34<00:26, 13.15s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9588, 'compress@10': 0.5558, 'time@10': 17.6552}:  80%|████████  | 8/10 [01:48<00:26, 13.15s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9588, 'compress@10': 0.5558, 'time@10': 17.6552}:  90%|█████████ | 9/10 [01:48<00:13, 13.27s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9144, 'ndcg@10': 0.9616, 'compress@10': 0.526, 'time@10': 17.7301}:  90%|█████████ | 9/10 [02:06<00:13, 13.27s/it]    {'epoch': 26, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9144, 'ndcg@10': 0.9616, 'compress@10': 0.526, 'time@10': 17.7301}: 100%|██████████| 10/10 [02:06<00:00, 14.87s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9144, 'ndcg@10': 0.9616, 'compress@10': 0.526, 'time@10': 17.7301}: 100%|██████████| 10/10 [02:06<00:00, 12.68s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.012380071910590455
Avg hit ratio: 0.9143617082785165
Avg ndcg: 0.9615854971413034
Avg compression ratio: 0.5260181470563573
Avg train time: 17.730147743225096
Std train time: 5.93708675737941
[0.6964285714285712, 0.8749999999999999, 0.05357142857142857, 0.23214285714285712, 0.7678571428571427, 0.19642857142857145, 0.30357142857142855, 0.7678571428571431, 0.8392857142857141, 0.26785714285714285]
[20, 20, 45, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.7124, 'time@10': 15.4712}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.7124, 'time@10': 15.4712}:  10%|█         | 1/10 [00:07<01:09,  7.77s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9559, 'compress@10': 0.7957, 'time@10': 13.8532}:  10%|█         | 1/10 [00:20<01:09,  7.77s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9559, 'compress@10': 0.7957, 'time@10': 13.8532}:  20%|██        | 2/10 [00:20<01:23, 10.42s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.855, 'ndcg@10': 0.923, 'compress@10': 0.5934, 'time@10': 12.4716}:  20%|██        | 2/10 [00:24<01:23, 10.42s/it]  {'epoch': 27, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.855, 'ndcg@10': 0.923, 'compress@10': 0.5934, 'time@10': 12.4716}:  30%|███       | 3/10 [00:24<00:55,  7.89s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9333, 'compress@10': 0.5099, 'time@10': 12.192}:  30%|███       | 3/10 [00:36<00:55,  7.89s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9333, 'compress@10': 0.5099, 'time@10': 12.192}:  40%|████      | 4/10 [00:36<00:55,  9.27s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9426, 'compress@10': 0.5625, 'time@10': 15.6384}:  40%|████      | 4/10 [00:51<00:55,  9.27s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9426, 'compress@10': 0.5625, 'time@10': 15.6384}:  50%|█████     | 5/10 [00:51<00:56, 11.26s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.948, 'compress@10': 0.5044, 'time@10': 16.1921}:  50%|█████     | 5/10 [01:10<00:56, 11.26s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.948, 'compress@10': 0.5044, 'time@10': 16.1921}:  60%|██████    | 6/10 [01:10<00:55, 13.89s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9496, 'compress@10': 0.4797, 'time@10': 16.8589}:  60%|██████    | 6/10 [01:20<00:55, 13.89s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9496, 'compress@10': 0.4797, 'time@10': 16.8589}:  70%|███████   | 7/10 [01:20<00:38, 12.77s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.01, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9502, 'compress@10': 0.5166, 'time@10': 16.5683}:  70%|███████   | 7/10 [01:35<00:38, 12.77s/it]   {'epoch': 27, 'num_users': 6.125, 'loss': 0.01, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9502, 'compress@10': 0.5166, 'time@10': 16.5683}:  80%|████████  | 8/10 [01:35<00:26, 13.34s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9526, 'compress@10': 0.5529, 'time@10': 17.7339}:  80%|████████  | 8/10 [01:48<00:26, 13.34s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9526, 'compress@10': 0.5529, 'time@10': 17.7339}:  90%|█████████ | 9/10 [01:48<00:13, 13.41s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9602, 'compress@10': 0.5261, 'time@10': 17.7832}:  90%|█████████ | 9/10 [02:06<00:13, 13.41s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9602, 'compress@10': 0.5261, 'time@10': 17.7832}: 100%|██████████| 10/10 [02:06<00:00, 14.92s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9602, 'compress@10': 0.5261, 'time@10': 17.7832}: 100%|██████████| 10/10 [02:06<00:00, 12.70s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.011720992526165921
Avg hit ratio: 0.9117708224618241
Avg ndcg: 0.960194272632604
Avg compression ratio: 0.5260819969417673
Avg train time: 17.783233451843262
Std train time: 6.21157310894859
[0.6724137931034481, 0.8448275862068965, 0.05172413793103448, 0.22413793103448273, 0.7413793103448274, 0.2241379310344828, 0.3275862068965517, 0.7758620689655175, 0.8448275862068964, 0.29310344827586204]
[20, 20, 46, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6896, 'time@10': 15.944}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6896, 'time@10': 15.944}:  10%|█         | 1/10 [00:08<01:12,  8.01s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9591, 'compress@10': 0.7697, 'time@10': 14.2173}:  10%|█         | 1/10 [00:20<01:12,  8.01s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9591, 'compress@10': 0.7697, 'time@10': 14.2173}:  20%|██        | 2/10 [00:20<01:25, 10.67s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9251, 'compress@10': 0.5756, 'time@10': 12.9207}:  20%|██        | 2/10 [00:25<01:25, 10.67s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9251, 'compress@10': 0.5756, 'time@10': 12.9207}:  30%|███       | 3/10 [00:25<00:57,  8.17s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9349, 'compress@10': 0.4946, 'time@10': 12.6854}:  30%|███       | 3/10 [00:37<00:57,  8.17s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9349, 'compress@10': 0.4946, 'time@10': 12.6854}:  40%|████      | 4/10 [00:37<00:58,  9.70s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9436, 'compress@10': 0.545, 'time@10': 16.0756}:  40%|████      | 4/10 [00:52<00:58,  9.70s/it] {'epoch': 28, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9436, 'compress@10': 0.545, 'time@10': 16.0756}:  50%|█████     | 5/10 [00:52<00:57, 11.56s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9515, 'compress@10': 0.4944, 'time@10': 16.5254}:  50%|█████     | 5/10 [01:11<00:57, 11.56s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9515, 'compress@10': 0.4944, 'time@10': 16.5254}:  60%|██████    | 6/10 [01:11<00:56, 14.02s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.9303, 'ndcg@10': 0.9527, 'compress@10': 0.4744, 'time@10': 17.1219}:  60%|██████    | 6/10 [01:21<00:56, 14.02s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.9303, 'ndcg@10': 0.9527, 'compress@10': 0.4744, 'time@10': 17.1219}:  70%|███████   | 7/10 [01:21<00:38, 12.83s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.9354, 'ndcg@10': 0.9631, 'compress@10': 0.5129, 'time@10': 16.7531}:  70%|███████   | 7/10 [01:36<00:38, 12.83s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.9354, 'ndcg@10': 0.9631, 'compress@10': 0.5129, 'time@10': 16.7531}:  80%|████████  | 8/10 [01:36<00:26, 13.27s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9645, 'compress@10': 0.5503, 'time@10': 17.8396}:  80%|████████  | 8/10 [01:49<00:26, 13.27s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9645, 'compress@10': 0.5503, 'time@10': 17.8396}:  90%|█████████ | 9/10 [01:49<00:13, 13.29s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9662, 'compress@10': 0.5262, 'time@10': 17.9105}:  90%|█████████ | 9/10 [02:07<00:13, 13.29s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9662, 'compress@10': 0.5262, 'time@10': 17.9105}: 100%|██████████| 10/10 [02:07<00:00, 14.92s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9662, 'compress@10': 0.5262, 'time@10': 17.9105}: 100%|██████████| 10/10 [02:07<00:00, 12.79s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.01503989677891801
Avg hit ratio: 0.9203422510332526
Avg ndcg: 0.9662445584733973
Avg compression ratio: 0.5261583453642759
Avg train time: 17.910466694831847
Std train time: 6.00546275985676
[0.6499999999999998, 0.8499999999999999, 0.05, 0.21666666666666665, 0.7166666666666665, 0.25000000000000006, 0.31666666666666665, 0.7833333333333335, 0.8499999999999998, 0.31666666666666665]
[20, 20, 47, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.6684, 'time@10': 15.743}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.6684, 'time@10': 15.743}:  10%|█         | 1/10 [00:07<01:11,  7.91s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9559, 'compress@10': 0.7616, 'time@10': 13.9782}:  10%|█         | 1/10 [00:20<01:11,  7.91s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9559, 'compress@10': 0.7616, 'time@10': 13.9782}:  20%|██        | 2/10 [00:20<01:23, 10.46s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.855, 'ndcg@10': 0.923, 'compress@10': 0.5697, 'time@10': 12.9551}:  20%|██        | 2/10 [00:25<01:23, 10.46s/it]  {'epoch': 29, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.855, 'ndcg@10': 0.923, 'compress@10': 0.5697, 'time@10': 12.9551}:  30%|███       | 3/10 [00:25<00:57,  8.19s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9333, 'compress@10': 0.4884, 'time@10': 12.6051}:  30%|███       | 3/10 [00:37<00:57,  8.19s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9333, 'compress@10': 0.4884, 'time@10': 12.6051}:  40%|████      | 4/10 [00:37<00:57,  9.53s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9426, 'compress@10': 0.5352, 'time@10': 16.0162}:  40%|████      | 4/10 [00:52<00:57,  9.53s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9426, 'compress@10': 0.5352, 'time@10': 16.0162}:  50%|█████     | 5/10 [00:52<00:57, 11.46s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9543, 'compress@10': 0.4904, 'time@10': 16.4927}:  50%|█████     | 5/10 [01:11<00:57, 11.46s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9543, 'compress@10': 0.4904, 'time@10': 16.4927}:  60%|██████    | 6/10 [01:11<00:55, 13.99s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9551, 'compress@10': 0.4695, 'time@10': 17.1366}:  60%|██████    | 6/10 [01:21<00:55, 13.99s/it] {'epoch': 29, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9551, 'compress@10': 0.4695, 'time@10': 17.1366}:  70%|███████   | 7/10 [01:21<00:38, 12.86s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9535, 'compress@10': 0.5095, 'time@10': 16.8026}:  70%|███████   | 7/10 [01:36<00:38, 12.86s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9535, 'compress@10': 0.5095, 'time@10': 16.8026}:  80%|████████  | 8/10 [01:36<00:26, 13.38s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9607, 'compress@10': 0.5478, 'time@10': 17.8823}:  80%|████████  | 8/10 [01:49<00:26, 13.38s/it] {'epoch': 29, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9607, 'compress@10': 0.5478, 'time@10': 17.8823}:  90%|█████████ | 9/10 [01:49<00:13, 13.36s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9649, 'compress@10': 0.5263, 'time@10': 17.9616}:  90%|█████████ | 9/10 [02:08<00:13, 13.36s/it]  {'epoch': 29, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9649, 'compress@10': 0.5263, 'time@10': 17.9616}: 100%|██████████| 10/10 [02:08<00:00, 15.01s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9649, 'compress@10': 0.5263, 'time@10': 17.9616}: 100%|██████████| 10/10 [02:08<00:00, 12.81s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.012623968822524029
Avg hit ratio: 0.9139930446840463
Avg ndcg: 0.9649286165958045
Avg compression ratio: 0.5262563389625963
Avg train time: 17.9616308927536
Std train time: 6.0137975297621304
[0.6290322580645159, 0.8225806451612901, 0.048387096774193554, 0.2096774193548387, 0.725806451612903, 0.2741935483870968, 0.3064516129032258, 0.7903225806451615, 0.8548387096774192, 0.3387096774193548]
[20, 20, 47, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0044, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6485, 'time@10': 15.425}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0044, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6485, 'time@10': 15.425}:  10%|█         | 1/10 [00:07<01:09,  7.75s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.0277, 'compress@10': 0.7384, 'time@10': 14.0443}:  10%|█         | 1/10 [00:20<01:09,  7.75s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.0277, 'compress@10': 0.7384, 'time@10': 14.0443}:  20%|██        | 2/10 [00:20<01:25, 10.66s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9709, 'compress@10': 0.5537, 'time@10': 12.8794}:  20%|██        | 2/10 [00:25<01:25, 10.66s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9709, 'compress@10': 0.5537, 'time@10': 12.8794}:  30%|███       | 3/10 [00:25<00:57,  8.22s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9692, 'compress@10': 0.4748, 'time@10': 12.568}:  30%|███       | 3/10 [00:37<00:57,  8.22s/it]  {'epoch': 30, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9692, 'compress@10': 0.4748, 'time@10': 12.568}:  40%|████      | 4/10 [00:37<00:57,  9.66s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.971, 'compress@10': 0.5261, 'time@10': 15.9565}:  40%|████      | 4/10 [00:52<00:57,  9.66s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.971, 'compress@10': 0.5261, 'time@10': 15.9565}:  50%|█████     | 5/10 [00:52<00:57, 11.51s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.9236, 'ndcg@10': 0.9737, 'compress@10': 0.4868, 'time@10': 16.4839}:  50%|█████     | 5/10 [01:11<00:57, 11.51s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.9236, 'ndcg@10': 0.9737, 'compress@10': 0.4868, 'time@10': 16.4839}:  60%|██████    | 6/10 [01:11<00:56, 14.11s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0098, 'hit_ratio@10': 0.9288, 'ndcg@10': 0.9717, 'compress@10': 0.465, 'time@10': 17.1431}:  60%|██████    | 6/10 [01:22<00:56, 14.11s/it] {'epoch': 30, 'num_users': 6.2857, 'loss': 0.0098, 'hit_ratio@10': 0.9288, 'ndcg@10': 0.9717, 'compress@10': 0.465, 'time@10': 17.1431}:  70%|███████   | 7/10 [01:22<00:38, 12.96s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9342, 'ndcg@10': 0.978, 'compress@10': 0.5064, 'time@10': 16.7915}:  70%|███████   | 7/10 [01:36<00:38, 12.96s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9342, 'ndcg@10': 0.978, 'compress@10': 0.5064, 'time@10': 16.7915}:  80%|████████  | 8/10 [01:36<00:26, 13.41s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9776, 'compress@10': 0.5456, 'time@10': 17.8796}:  80%|████████  | 8/10 [01:49<00:26, 13.41s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9776, 'compress@10': 0.5456, 'time@10': 17.8796}:  90%|█████████ | 9/10 [01:49<00:13, 13.38s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.9279, 'ndcg@10': 0.9775, 'compress@10': 0.5264, 'time@10': 17.9667}:  90%|█████████ | 9/10 [02:08<00:13, 13.38s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.9279, 'ndcg@10': 0.9775, 'compress@10': 0.5264, 'time@10': 17.9667}: 100%|██████████| 10/10 [02:08<00:00, 15.05s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.9279, 'ndcg@10': 0.9775, 'compress@10': 0.5264, 'time@10': 17.9667}: 100%|██████████| 10/10 [02:08<00:00, 12.87s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.011541785534767837
Avg hit ratio: 0.9279100953752906
Avg ndcg: 0.97753385239743
Avg compression ratio: 0.5263887118629598
Avg train time: 17.96674327850342
Std train time: 6.018283658844807
[0.6093749999999998, 0.8281249999999998, 0.04687500000000001, 0.23437499999999997, 0.7343749999999998, 0.26562500000000006, 0.296875, 0.7968750000000002, 0.8593749999999998, 0.328125]
[20, 20, 47, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6299, 'time@10': 16.1862}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6299, 'time@10': 16.1862}:  10%|█         | 1/10 [00:08<01:13,  8.13s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0051, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9576, 'compress@10': 0.7318, 'time@10': 14.3006}:  10%|█         | 1/10 [00:20<01:13,  8.13s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0051, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9576, 'compress@10': 0.7318, 'time@10': 14.3006}:  20%|██        | 2/10 [00:20<01:25, 10.67s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9241, 'compress@10': 0.5489, 'time@10': 13.0737}:  20%|██        | 2/10 [00:25<01:25, 10.67s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9241, 'compress@10': 0.5489, 'time@10': 13.0737}:  30%|███       | 3/10 [00:25<00:57,  8.24s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9341, 'compress@10': 0.4771, 'time@10': 12.6841}:  30%|███       | 3/10 [00:37<00:57,  8.24s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9341, 'compress@10': 0.4771, 'time@10': 12.6841}:  40%|████      | 4/10 [00:37<00:57,  9.55s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0059, 'hit_ratio@10': 0.89, 'ndcg@10': 0.943, 'compress@10': 0.5296, 'time@10': 16.0312}:  40%|████      | 4/10 [00:52<00:57,  9.55s/it]   {'epoch': 31, 'num_users': 5.8, 'loss': 0.0059, 'hit_ratio@10': 0.89, 'ndcg@10': 0.943, 'compress@10': 0.5296, 'time@10': 16.0312}:  50%|█████     | 5/10 [00:52<00:57, 11.42s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0075, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9527, 'compress@10': 0.4883, 'time@10': 16.5139}:  50%|█████     | 5/10 [01:11<00:57, 11.42s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0075, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9527, 'compress@10': 0.4883, 'time@10': 16.5139}:  60%|██████    | 6/10 [01:11<00:55, 13.99s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0072, 'hit_ratio@10': 0.9094, 'ndcg@10': 0.9537, 'compress@10': 0.465, 'time@10': 17.1277}:  60%|██████    | 6/10 [01:21<00:55, 13.99s/it] {'epoch': 31, 'num_users': 6.2857, 'loss': 0.0072, 'hit_ratio@10': 0.9094, 'ndcg@10': 0.9537, 'compress@10': 0.465, 'time@10': 17.1277}:  70%|███████   | 7/10 [01:21<00:38, 12.83s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0075, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9559, 'compress@10': 0.5072, 'time@10': 16.7765}:  70%|███████   | 7/10 [01:36<00:38, 12.83s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0075, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9559, 'compress@10': 0.5072, 'time@10': 16.7765}:  80%|████████  | 8/10 [01:36<00:26, 13.32s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.9585, 'compress@10': 0.5468, 'time@10': 17.8813}:  80%|████████  | 8/10 [01:49<00:26, 13.32s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.9585, 'compress@10': 0.5468, 'time@10': 17.8813}:  90%|█████████ | 9/10 [01:49<00:13, 13.35s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.9618, 'compress@10': 0.5264, 'time@10': 17.9794}:  90%|█████████ | 9/10 [02:08<00:13, 13.35s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.9618, 'compress@10': 0.5264, 'time@10': 17.9794}: 100%|██████████| 10/10 [02:08<00:00, 15.06s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.9618, 'compress@10': 0.5264, 'time@10': 17.9794}: 100%|██████████| 10/10 [02:08<00:00, 12.83s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.009348044660878869
Avg hit ratio: 0.9114252003420085
Avg ndcg: 0.9618345549225893
Avg compression ratio: 0.5264403519715849
Avg train time: 17.979360508918763
Std train time: 6.004165165180903
[0.5909090909090907, 0.8030303030303028, 0.04545454545454546, 0.22727272727272724, 0.7424242424242422, 0.28787878787878796, 0.2878787878787879, 0.8030303030303032, 0.8636363636363634, 0.3484848484848485]
[20, 20, 47, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0037, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6124, 'time@10': 15.9551}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0037, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6124, 'time@10': 15.9551}:  10%|█         | 1/10 [00:08<01:12,  8.01s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0032, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.7109, 'time@10': 14.2468}:  10%|█         | 1/10 [00:20<01:12,  8.01s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0032, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.7109, 'time@10': 14.2468}:  20%|██        | 2/10 [00:20<01:25, 10.70s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0021, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.5345, 'time@10': 13.0323}:  20%|██        | 2/10 [00:25<01:25, 10.70s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0021, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.5345, 'time@10': 13.0323}:  30%|███       | 3/10 [00:25<00:57,  8.25s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9341, 'compress@10': 0.4646, 'time@10': 12.6465}:  30%|███       | 3/10 [00:37<00:57,  8.25s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9341, 'compress@10': 0.4646, 'time@10': 12.6465}:  40%|████      | 4/10 [00:37<00:57,  9.54s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.006, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.943, 'compress@10': 0.5212, 'time@10': 15.9858}:  40%|████      | 4/10 [00:52<00:57,  9.54s/it]  {'epoch': 32, 'num_users': 5.8, 'loss': 0.006, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.943, 'compress@10': 0.5212, 'time@10': 15.9858}:  50%|█████     | 5/10 [00:52<00:57, 11.41s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0066, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9489, 'compress@10': 0.485, 'time@10': 16.4883}:  50%|█████     | 5/10 [01:11<00:57, 11.41s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0066, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9489, 'compress@10': 0.485, 'time@10': 16.4883}:  60%|██████    | 6/10 [01:11<00:56, 14.00s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0059, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9505, 'compress@10': 0.4609, 'time@10': 17.1409}:  60%|██████    | 6/10 [01:21<00:56, 14.00s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0059, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9505, 'compress@10': 0.4609, 'time@10': 17.1409}:  70%|███████   | 7/10 [01:21<00:38, 12.88s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0079, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9527, 'compress@10': 0.5043, 'time@10': 16.8392}:  70%|███████   | 7/10 [01:36<00:38, 12.88s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0079, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9527, 'compress@10': 0.5043, 'time@10': 16.8392}:  80%|████████  | 8/10 [01:36<00:26, 13.48s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0087, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9553, 'compress@10': 0.5447, 'time@10': 17.9727}:  80%|████████  | 8/10 [01:50<00:26, 13.48s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0087, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9553, 'compress@10': 0.5447, 'time@10': 17.9727}:  90%|█████████ | 9/10 [01:50<00:13, 13.50s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9593, 'compress@10': 0.5266, 'time@10': 18.0268}:  90%|█████████ | 9/10 [02:08<00:13, 13.50s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9593, 'compress@10': 0.5266, 'time@10': 18.0268}: 100%|██████████| 10/10 [02:08<00:00, 15.06s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9593, 'compress@10': 0.5266, 'time@10': 18.0268}: 100%|██████████| 10/10 [02:08<00:00, 12.86s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.009627742190953758
Avg hit ratio: 0.9139930446840463
Avg ndcg: 0.9593337569901221
Avg compression ratio: 0.5265601003121356
Avg train time: 18.02676191329956
Std train time: 6.023541013139318
[0.5735294117647057, 0.7794117647058821, 0.04411764705882354, 0.24999999999999997, 0.7499999999999998, 0.2794117647058824, 0.27941176470588236, 0.8088235294117648, 0.8676470588235292, 0.36764705882352944]
[20, 20, 47, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.596, 'time@10': 15.8071}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.596, 'time@10': 15.8071}:  10%|█         | 1/10 [00:07<01:11,  7.94s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0044, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6912, 'time@10': 14.302}:  10%|█         | 1/10 [00:20<01:11,  7.94s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0044, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6912, 'time@10': 14.302}:  20%|██        | 2/10 [00:20<01:26, 10.82s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0029, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.5211, 'time@10': 13.1764}:  20%|██        | 2/10 [00:26<01:26, 10.82s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0029, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.5211, 'time@10': 13.1764}:  30%|███       | 3/10 [00:26<00:58,  8.39s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0039, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9341, 'compress@10': 0.46, 'time@10': 12.733}:  30%|███       | 3/10 [00:37<00:58,  8.39s/it]  {'epoch': 33, 'num_users': 5.0, 'loss': 0.0039, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9341, 'compress@10': 0.46, 'time@10': 12.733}:  40%|████      | 4/10 [00:37<00:57,  9.59s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.005, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9433, 'compress@10': 0.519, 'time@10': 16.1413}:  40%|████      | 4/10 [00:52<00:57,  9.59s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.005, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9433, 'compress@10': 0.519, 'time@10': 16.1413}:  50%|█████     | 5/10 [00:52<00:57, 11.52s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0053, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9491, 'compress@10': 0.4817, 'time@10': 16.6134}:  50%|█████     | 5/10 [01:11<00:57, 11.52s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0053, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9491, 'compress@10': 0.4817, 'time@10': 16.6134}:  60%|██████    | 6/10 [01:11<00:56, 14.06s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0046, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.9506, 'compress@10': 0.4569, 'time@10': 17.2066}:  60%|██████    | 6/10 [01:22<00:56, 14.06s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0046, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.9506, 'compress@10': 0.4569, 'time@10': 17.2066}:  70%|███████   | 7/10 [01:22<00:38, 12.88s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0055, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9561, 'compress@10': 0.5016, 'time@10': 16.8486}:  70%|███████   | 7/10 [01:36<00:38, 12.88s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.0055, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9561, 'compress@10': 0.5016, 'time@10': 16.8486}:  80%|████████  | 8/10 [01:36<00:26, 13.36s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0069, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9585, 'compress@10': 0.5427, 'time@10': 17.9157}:  80%|████████  | 8/10 [01:49<00:26, 13.36s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0069, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9585, 'compress@10': 0.5427, 'time@10': 17.9157}:  90%|█████████ | 9/10 [01:49<00:13, 13.33s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0084, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.963, 'compress@10': 0.5266, 'time@10': 17.9516}:  90%|█████████ | 9/10 [02:08<00:13, 13.33s/it]    {'epoch': 33, 'num_users': 6.3, 'loss': 0.0084, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.963, 'compress@10': 0.5266, 'time@10': 17.9516}: 100%|██████████| 10/10 [02:08<00:00, 14.87s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0084, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.963, 'compress@10': 0.5266, 'time@10': 17.9516}: 100%|██████████| 10/10 [02:08<00:00, 12.80s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.008404110477931919
Avg hit ratio: 0.9132787589697606
Avg ndcg: 0.9629626188916909
Avg compression ratio: 0.5266309943850509
Avg train time: 17.951557517051697
Std train time: 5.979690544239893
[0.5571428571428569, 0.7571428571428569, 0.042857142857142864, 0.2714285714285714, 0.7571428571428569, 0.27142857142857146, 0.27142857142857146, 0.8142857142857144, 0.8714285714285712, 0.38571428571428573]
[20, 20, 47, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0044, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.5804, 'time@10': 15.634}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0044, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.5804, 'time@10': 15.634}:  10%|█         | 1/10 [00:07<01:10,  7.85s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6727, 'time@10': 14.2432}:  10%|█         | 1/10 [00:20<01:10,  7.85s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6727, 'time@10': 14.2432}:  20%|██        | 2/10 [00:20<01:26, 10.82s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9241, 'compress@10': 0.5083, 'time@10': 12.9916}:  20%|██        | 2/10 [00:26<01:26, 10.82s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9241, 'compress@10': 0.5083, 'time@10': 12.9916}:  30%|███       | 3/10 [00:26<00:58,  8.29s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9341, 'compress@10': 0.4556, 'time@10': 12.5752}:  30%|███       | 3/10 [00:37<00:58,  8.29s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9341, 'compress@10': 0.4556, 'time@10': 12.5752}:  40%|████      | 4/10 [00:37<00:57,  9.50s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0075, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.943, 'compress@10': 0.5169, 'time@10': 15.8341}:  40%|████      | 4/10 [00:51<00:57,  9.50s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 0.0075, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.943, 'compress@10': 0.5169, 'time@10': 15.8341}:  50%|█████     | 5/10 [00:51<00:56, 11.29s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0068, 'hit_ratio@10': 0.929, 'ndcg@10': 0.9488, 'compress@10': 0.4787, 'time@10': 16.3355}:  50%|█████     | 5/10 [01:10<00:56, 11.29s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0068, 'hit_ratio@10': 0.929, 'ndcg@10': 0.9488, 'compress@10': 0.4787, 'time@10': 16.3355}:  60%|██████    | 6/10 [01:10<00:55, 13.87s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.9334, 'ndcg@10': 0.9504, 'compress@10': 0.4532, 'time@10': 16.9986}:  60%|██████    | 6/10 [01:21<00:55, 13.87s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.9334, 'ndcg@10': 0.9504, 'compress@10': 0.4532, 'time@10': 16.9986}:  70%|███████   | 7/10 [01:21<00:38, 12.78s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.007, 'hit_ratio@10': 0.9382, 'ndcg@10': 0.953, 'compress@10': 0.499, 'time@10': 16.6443}:  70%|███████   | 7/10 [01:35<00:38, 12.78s/it]    {'epoch': 34, 'num_users': 6.125, 'loss': 0.007, 'hit_ratio@10': 0.9382, 'ndcg@10': 0.953, 'compress@10': 0.499, 'time@10': 16.6443}:  80%|████████  | 8/10 [01:35<00:26, 13.23s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.008, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.9554, 'compress@10': 0.5408, 'time@10': 17.7179}:  80%|████████  | 8/10 [01:48<00:26, 13.23s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.008, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.9554, 'compress@10': 0.5408, 'time@10': 17.7179}:  90%|█████████ | 9/10 [01:48<00:13, 13.22s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9283, 'ndcg@10': 0.9491, 'compress@10': 0.5267, 'time@10': 17.846}:  90%|█████████ | 9/10 [02:07<00:13, 13.22s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9283, 'ndcg@10': 0.9491, 'compress@10': 0.5267, 'time@10': 17.846}: 100%|██████████| 10/10 [02:07<00:00, 15.01s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9283, 'ndcg@10': 0.9491, 'compress@10': 0.5267, 'time@10': 17.846}: 100%|██████████| 10/10 [02:07<00:00, 12.77s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.011908103187490955
Avg hit ratio: 0.9282787589697608
Avg ndcg: 0.9491278329694819
Avg compression ratio: 0.5266980768682962
Avg train time: 17.846013641357423
Std train time: 5.8759163057457116
[0.5416666666666665, 0.7638888888888886, 0.04166666666666667, 0.29166666666666663, 0.7638888888888886, 0.26388888888888895, 0.26388888888888895, 0.7916666666666667, 0.8749999999999998, 0.4027777777777778]
[20, 20, 48, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0039, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.5658, 'time@10': 15.5133}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0039, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.5658, 'time@10': 15.5133}:  10%|█         | 1/10 [00:07<01:10,  7.79s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0025, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.6686, 'time@10': 14.247}:  10%|█         | 1/10 [00:20<01:10,  7.79s/it] {'epoch': 35, 'num_users': 7.0, 'loss': 0.0025, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.6686, 'time@10': 14.247}:  20%|██        | 2/10 [00:20<01:26, 10.87s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0016, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9241, 'compress@10': 0.5053, 'time@10': 13.2588}:  20%|██        | 2/10 [00:26<01:26, 10.87s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0016, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9241, 'compress@10': 0.5053, 'time@10': 13.2588}:  30%|███       | 3/10 [00:26<00:59,  8.50s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0024, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9341, 'compress@10': 0.4582, 'time@10': 12.8383}:  30%|███       | 3/10 [00:38<00:59,  8.50s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0024, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9341, 'compress@10': 0.4582, 'time@10': 12.8383}:  40%|████      | 4/10 [00:38<00:58,  9.73s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0035, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9433, 'compress@10': 0.5203, 'time@10': 16.0992}:  40%|████      | 4/10 [00:52<00:58,  9.73s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0035, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9433, 'compress@10': 0.5203, 'time@10': 16.0992}:  50%|█████     | 5/10 [00:52<00:57, 11.49s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0071, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.946, 'compress@10': 0.4803, 'time@10': 16.6016}:  50%|█████     | 5/10 [01:11<00:57, 11.49s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0071, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.946, 'compress@10': 0.4803, 'time@10': 16.6016}:  60%|██████    | 6/10 [01:11<00:56, 14.09s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0062, 'hit_ratio@10': 0.913, 'ndcg@10': 0.948, 'compress@10': 0.4536, 'time@10': 17.1616}:  60%|██████    | 6/10 [01:22<00:56, 14.09s/it] {'epoch': 35, 'num_users': 6.2857, 'loss': 0.0062, 'hit_ratio@10': 0.913, 'ndcg@10': 0.948, 'compress@10': 0.4536, 'time@10': 17.1616}:  70%|███████   | 7/10 [01:22<00:38, 12.85s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.006, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.951, 'compress@10': 0.4966, 'time@10': 16.8026}:  70%|███████   | 7/10 [01:36<00:38, 12.85s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.006, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.951, 'compress@10': 0.4966, 'time@10': 16.8026}:  80%|████████  | 8/10 [01:36<00:26, 13.32s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0069, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.9537, 'compress@10': 0.539, 'time@10': 17.8767}:  80%|████████  | 8/10 [01:49<00:26, 13.32s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0069, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.9537, 'compress@10': 0.539, 'time@10': 17.8767}:  90%|█████████ | 9/10 [01:49<00:13, 13.31s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0067, 'hit_ratio@10': 0.9169, 'ndcg@10': 0.956, 'compress@10': 0.5268, 'time@10': 17.954}:  90%|█████████ | 9/10 [02:08<00:13, 13.31s/it]    {'epoch': 35, 'num_users': 6.3, 'loss': 0.0067, 'hit_ratio@10': 0.9169, 'ndcg@10': 0.956, 'compress@10': 0.5268, 'time@10': 17.954}: 100%|██████████| 10/10 [02:08<00:00, 14.97s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0067, 'hit_ratio@10': 0.9169, 'ndcg@10': 0.956, 'compress@10': 0.5268, 'time@10': 17.954}: 100%|██████████| 10/10 [02:08<00:00, 12.85s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.006669464569343954
Avg hit ratio: 0.9168532866869029
Avg ndcg: 0.9560496211463325
Avg compression ratio: 0.5267532998794521
Avg train time: 17.954024696350096
Std train time: 5.791476773984273
[0.5270270270270269, 0.743243243243243, 0.04054054054054054, 0.3108108108108108, 0.77027027027027, 0.2837837837837838, 0.2567567567567568, 0.7972972972972974, 0.8783783783783782, 0.3918918918918919]
[20, 20, 48, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0017, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.5519, 'time@10': 15.6315}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0017, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.5519, 'time@10': 15.6315}:  10%|█         | 1/10 [00:07<01:10,  7.85s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0069, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6517, 'time@10': 14.3499}:  10%|█         | 1/10 [00:20<01:10,  7.85s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0069, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6517, 'time@10': 14.3499}:  20%|██        | 2/10 [00:20<01:27, 10.94s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0046, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9241, 'compress@10': 0.4937, 'time@10': 13.0883}:  20%|██        | 2/10 [00:26<01:27, 10.94s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0046, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9241, 'compress@10': 0.4937, 'time@10': 13.0883}:  30%|███       | 3/10 [00:26<00:58,  8.38s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9341, 'compress@10': 0.4541, 'time@10': 12.7458}:  30%|███       | 3/10 [00:38<00:58,  8.38s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9341, 'compress@10': 0.4541, 'time@10': 12.7458}:  40%|████      | 4/10 [00:38<00:58,  9.71s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0065, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9432, 'compress@10': 0.5183, 'time@10': 16.0028}:  40%|████      | 4/10 [00:52<00:58,  9.71s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0065, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9432, 'compress@10': 0.5183, 'time@10': 16.0028}:  50%|█████     | 5/10 [00:52<00:57, 11.46s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0059, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.949, 'compress@10': 0.4818, 'time@10': 16.5072}:  50%|█████     | 5/10 [01:11<00:57, 11.46s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0059, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.949, 'compress@10': 0.4818, 'time@10': 16.5072}:  60%|██████    | 6/10 [01:11<00:56, 14.05s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0057, 'hit_ratio@10': 0.9303, 'ndcg@10': 0.9506, 'compress@10': 0.4539, 'time@10': 17.0845}:  60%|██████    | 6/10 [01:21<00:56, 14.05s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0057, 'hit_ratio@10': 0.9303, 'ndcg@10': 0.9506, 'compress@10': 0.4539, 'time@10': 17.0845}:  70%|███████   | 7/10 [01:21<00:38, 12.82s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0086, 'hit_ratio@10': 0.9354, 'ndcg@10': 0.9606, 'compress@10': 0.4976, 'time@10': 16.7745}:  70%|███████   | 7/10 [01:36<00:38, 12.82s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0086, 'hit_ratio@10': 0.9354, 'ndcg@10': 0.9606, 'compress@10': 0.4976, 'time@10': 16.7745}:  80%|████████  | 8/10 [01:36<00:26, 13.41s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.009, 'hit_ratio@10': 0.9204, 'ndcg@10': 0.9618, 'compress@10': 0.5403, 'time@10': 17.834}:  80%|████████  | 8/10 [01:49<00:26, 13.41s/it] {'epoch': 36, 'num_users': 6.3333, 'loss': 0.009, 'hit_ratio@10': 0.9204, 'ndcg@10': 0.9618, 'compress@10': 0.5403, 'time@10': 17.834}:  90%|█████████ | 9/10 [01:49<00:13, 13.34s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9261, 'ndcg@10': 0.9634, 'compress@10': 0.5268, 'time@10': 17.8849}:  90%|█████████ | 9/10 [02:08<00:13, 13.34s/it] {'epoch': 36, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9261, 'ndcg@10': 0.9634, 'compress@10': 0.5268, 'time@10': 17.8849}: 100%|██████████| 10/10 [02:08<00:00, 14.90s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9261, 'ndcg@10': 0.9634, 'compress@10': 0.5268, 'time@10': 17.8849}: 100%|██████████| 10/10 [02:08<00:00, 12.82s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.009185388337869702
Avg hit ratio: 0.9260565367475385
Avg ndcg: 0.9633727839857545
Avg compression ratio: 0.5268132040355177
Avg train time: 17.884944081306458
Std train time: 5.783415927889136
[0.5131578947368419, 0.7499999999999998, 0.03947368421052632, 0.3289473684210526, 0.7499999999999997, 0.27631578947368424, 0.25000000000000006, 0.8026315789473685, 0.8815789473684209, 0.40789473684210525]
[20, 20, 48, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0033, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.5388, 'time@10': 15.6269}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0033, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.5388, 'time@10': 15.6269}:  10%|█         | 1/10 [00:07<01:10,  7.85s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0019, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.6484, 'time@10': 14.2095}:  10%|█         | 1/10 [00:20<01:10,  7.85s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0019, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.6484, 'time@10': 14.2095}:  20%|██        | 2/10 [00:20<01:26, 10.78s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0013, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9241, 'compress@10': 0.4912, 'time@10': 13.1538}:  20%|██        | 2/10 [00:26<01:26, 10.78s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0013, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9241, 'compress@10': 0.4912, 'time@10': 13.1538}:  30%|███       | 3/10 [00:26<00:58,  8.39s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0019, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9341, 'compress@10': 0.4566, 'time@10': 12.7877}:  30%|███       | 3/10 [00:37<00:58,  8.39s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0019, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9341, 'compress@10': 0.4566, 'time@10': 12.7877}:  40%|████      | 4/10 [00:37<00:58,  9.71s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0029, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9433, 'compress@10': 0.5163, 'time@10': 16.0361}:  40%|████      | 4/10 [00:52<00:58,  9.71s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0029, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9433, 'compress@10': 0.5163, 'time@10': 16.0361}:  50%|█████     | 5/10 [00:52<00:57, 11.46s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0043, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9478, 'compress@10': 0.479, 'time@10': 16.563}:  50%|█████     | 5/10 [01:11<00:57, 11.46s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0043, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9478, 'compress@10': 0.479, 'time@10': 16.563}:  60%|██████    | 6/10 [01:11<00:56, 14.10s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0039, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9495, 'compress@10': 0.4505, 'time@10': 17.1255}:  60%|██████    | 6/10 [01:22<00:56, 14.10s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0039, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9495, 'compress@10': 0.4505, 'time@10': 17.1255}:  70%|███████   | 7/10 [01:22<00:38, 12.85s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0041, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9522, 'compress@10': 0.4953, 'time@10': 16.7502}:  70%|███████   | 7/10 [01:36<00:38, 12.85s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0041, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9522, 'compress@10': 0.4953, 'time@10': 16.7502}:  80%|████████  | 8/10 [01:36<00:26, 13.27s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.005, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9544, 'compress@10': 0.5386, 'time@10': 17.8511}:  80%|████████  | 8/10 [01:49<00:26, 13.27s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.005, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9544, 'compress@10': 0.5386, 'time@10': 17.8511}:  90%|█████████ | 9/10 [01:49<00:13, 13.30s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0075, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9689, 'compress@10': 0.5268, 'time@10': 17.9265}:  90%|█████████ | 9/10 [02:08<00:13, 13.30s/it]  {'epoch': 37, 'num_users': 6.3, 'loss': 0.0075, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9689, 'compress@10': 0.5268, 'time@10': 17.9265}: 100%|██████████| 10/10 [02:08<00:00, 14.95s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0075, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9689, 'compress@10': 0.5268, 'time@10': 17.9265}: 100%|██████████| 10/10 [02:08<00:00, 12.82s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.007481691565884785
Avg hit ratio: 0.9163417659495758
Avg ndcg: 0.9688614407349065
Avg compression ratio: 0.5268398362783877
Avg train time: 17.926540398597716
Std train time: 5.836234429431859
[0.49999999999999983, 0.7307692307692305, 0.038461538461538464, 0.3205128205128205, 0.756410256410256, 0.2948717948717949, 0.24358974358974364, 0.8076923076923077, 0.8846153846153845, 0.4230769230769231]
[20, 20, 48, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0022, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.5263, 'time@10': 15.6219}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0022, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.5263, 'time@10': 15.6219}:  10%|█         | 1/10 [00:07<01:10,  7.85s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9986, 'compress@10': 0.6329, 'time@10': 14.2141}:  10%|█         | 1/10 [00:20<01:10,  7.85s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9986, 'compress@10': 0.6329, 'time@10': 14.2141}:  20%|██        | 2/10 [00:20<01:26, 10.79s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9514, 'compress@10': 0.4805, 'time@10': 13.168}:  20%|██        | 2/10 [00:26<01:26, 10.79s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9514, 'compress@10': 0.4805, 'time@10': 13.168}:  30%|███       | 3/10 [00:26<00:58,  8.41s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9546, 'compress@10': 0.4466, 'time@10': 12.7765}:  30%|███       | 3/10 [00:37<00:58,  8.41s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9546, 'compress@10': 0.4466, 'time@10': 12.7765}:  40%|████      | 4/10 [00:37<00:58,  9.69s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0078, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.9597, 'compress@10': 0.5095, 'time@10': 16.1409}:  40%|████      | 4/10 [00:52<00:58,  9.69s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0078, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.9597, 'compress@10': 0.5095, 'time@10': 16.1409}:  50%|█████     | 5/10 [00:52<00:57, 11.55s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9625, 'compress@10': 0.4764, 'time@10': 16.6297}:  50%|█████     | 5/10 [01:11<00:57, 11.55s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9625, 'compress@10': 0.4764, 'time@10': 16.6297}:  60%|██████    | 6/10 [01:11<00:56, 14.12s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0066, 'hit_ratio@10': 0.9196, 'ndcg@10': 0.9622, 'compress@10': 0.4474, 'time@10': 17.1687}:  60%|██████    | 6/10 [01:22<00:56, 14.12s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0066, 'hit_ratio@10': 0.9196, 'ndcg@10': 0.9622, 'compress@10': 0.4474, 'time@10': 17.1687}:  70%|███████   | 7/10 [01:22<00:38, 12.85s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0072, 'hit_ratio@10': 0.9261, 'ndcg@10': 0.9626, 'compress@10': 0.4931, 'time@10': 16.8221}:  70%|███████   | 7/10 [01:36<00:38, 12.85s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0072, 'hit_ratio@10': 0.9261, 'ndcg@10': 0.9626, 'compress@10': 0.4931, 'time@10': 16.8221}:  80%|████████  | 8/10 [01:36<00:26, 13.35s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0077, 'hit_ratio@10': 0.9184, 'ndcg@10': 0.9636, 'compress@10': 0.537, 'time@10': 17.9019}:  80%|████████  | 8/10 [01:49<00:26, 13.35s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0077, 'hit_ratio@10': 0.9184, 'ndcg@10': 0.9636, 'compress@10': 0.537, 'time@10': 17.9019}:  90%|█████████ | 9/10 [01:49<00:13, 13.35s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9243, 'ndcg@10': 0.9687, 'compress@10': 0.5269, 'time@10': 18.0059}:  90%|█████████ | 9/10 [02:08<00:13, 13.35s/it]  {'epoch': 38, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9243, 'ndcg@10': 0.9687, 'compress@10': 0.5269, 'time@10': 18.0059}: 100%|██████████| 10/10 [02:08<00:00, 15.08s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9243, 'ndcg@10': 0.9687, 'compress@10': 0.5269, 'time@10': 18.0059}: 100%|██████████| 10/10 [02:08<00:00, 12.89s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.008617625459916465
Avg hit ratio: 0.924285442344865
Avg ndcg: 0.9687006435109321
Avg compression ratio: 0.5269288059430054
Avg train time: 18.00586817264557
Std train time: 5.914136009978703
[0.4874999999999998, 0.7374999999999997, 0.037500000000000006, 0.33749999999999997, 0.7374999999999996, 0.28750000000000003, 0.23750000000000004, 0.8125, 0.8874999999999998, 0.4375]
[20, 20, 48, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0029, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.5145, 'time@10': 15.7344}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0029, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.5145, 'time@10': 15.7344}:  10%|█         | 1/10 [00:07<01:11,  7.90s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0019, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9576, 'compress@10': 0.6302, 'time@10': 14.2879}:  10%|█         | 1/10 [00:20<01:11,  7.90s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0019, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9576, 'compress@10': 0.6302, 'time@10': 14.2879}:  20%|██        | 2/10 [00:20<01:26, 10.83s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0013, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9241, 'compress@10': 0.4785, 'time@10': 13.0125}:  20%|██        | 2/10 [00:26<01:26, 10.83s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0013, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9241, 'compress@10': 0.4785, 'time@10': 13.0125}:  30%|███       | 3/10 [00:26<00:58,  8.29s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0017, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9341, 'compress@10': 0.4491, 'time@10': 12.6193}:  30%|███       | 3/10 [00:37<00:58,  8.29s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.0017, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9341, 'compress@10': 0.4491, 'time@10': 12.6193}:  40%|████      | 4/10 [00:37<00:57,  9.55s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0024, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9433, 'compress@10': 0.5079, 'time@10': 15.9989}:  40%|████      | 4/10 [00:52<00:57,  9.55s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0024, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9433, 'compress@10': 0.5079, 'time@10': 15.9989}:  50%|█████     | 5/10 [00:52<00:57, 11.44s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.004, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9503, 'compress@10': 0.4738, 'time@10': 16.5534}:  50%|█████     | 5/10 [01:11<00:57, 11.44s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.004, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9503, 'compress@10': 0.4738, 'time@10': 16.5534}:  60%|██████    | 6/10 [01:11<00:56, 14.13s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.004, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9517, 'compress@10': 0.4444, 'time@10': 17.0726}:  60%|██████    | 6/10 [01:21<00:56, 14.13s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.004, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9517, 'compress@10': 0.4444, 'time@10': 17.0726}:  70%|███████   | 7/10 [01:21<00:38, 12.83s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0035, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9541, 'compress@10': 0.4911, 'time@10': 16.6978}:  70%|███████   | 7/10 [01:35<00:38, 12.83s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0035, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9541, 'compress@10': 0.4911, 'time@10': 16.6978}:  80%|████████  | 8/10 [01:35<00:26, 13.24s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0043, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.956, 'compress@10': 0.5355, 'time@10': 17.772}:  80%|████████  | 8/10 [01:49<00:26, 13.24s/it] {'epoch': 39, 'num_users': 6.3333, 'loss': 0.0043, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.956, 'compress@10': 0.5355, 'time@10': 17.772}:  90%|█████████ | 9/10 [01:49<00:13, 13.23s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0052, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9617, 'compress@10': 0.5269, 'time@10': 17.8633}:  90%|█████████ | 9/10 [02:07<00:13, 13.23s/it] {'epoch': 39, 'num_users': 6.3, 'loss': 0.0052, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9617, 'compress@10': 0.5269, 'time@10': 17.8633}: 100%|██████████| 10/10 [02:07<00:00, 14.93s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0052, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9617, 'compress@10': 0.5269, 'time@10': 17.8633}: 100%|██████████| 10/10 [02:07<00:00, 12.79s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.005187193484456957
Avg hit ratio: 0.8988302452122486
Avg ndcg: 0.9617338188892599
Avg compression ratio: 0.5269498136397506
Avg train time: 17.863320803642274
Std train time: 5.970531488685137
[0.4756097560975608, 0.719512195121951, 0.03658536585365854, 0.3292682926829268, 0.7439024390243899, 0.30487804878048785, 0.2560975609756098, 0.7926829268292683, 0.8902439024390243, 0.45121951219512196]
[20, 20, 49, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0042, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.5032, 'time@10': 15.5948}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0042, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.5032, 'time@10': 15.5948}:  10%|█         | 1/10 [00:07<01:10,  7.83s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.6159, 'time@10': 14.1457}:  10%|█         | 1/10 [00:20<01:10,  7.83s/it]  {'epoch': 40, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.6159, 'time@10': 14.1457}:  20%|██        | 2/10 [00:20<01:25, 10.72s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.9241, 'compress@10': 0.4687, 'time@10': 13.0176}:  20%|██        | 2/10 [00:25<01:25, 10.72s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.9241, 'compress@10': 0.4687, 'time@10': 13.0176}:  30%|███       | 3/10 [00:25<00:58,  8.30s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9341, 'compress@10': 0.4398, 'time@10': 12.6519}:  30%|███       | 3/10 [00:37<00:58,  8.30s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9341, 'compress@10': 0.4398, 'time@10': 12.6519}:  40%|████      | 4/10 [00:37<00:57,  9.60s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0067, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9433, 'compress@10': 0.5016, 'time@10': 15.9344}:  40%|████      | 4/10 [00:52<00:57,  9.60s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0067, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9433, 'compress@10': 0.5016, 'time@10': 15.9344}:  50%|█████     | 5/10 [00:52<00:56, 11.39s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0061, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9491, 'compress@10': 0.4714, 'time@10': 16.4721}:  50%|█████     | 5/10 [01:11<00:56, 11.39s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0061, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9491, 'compress@10': 0.4714, 'time@10': 16.4721}:  60%|██████    | 6/10 [01:11<00:56, 14.05s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0055, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9506, 'compress@10': 0.4449, 'time@10': 17.0027}:  60%|██████    | 6/10 [01:21<00:56, 14.05s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0055, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9506, 'compress@10': 0.4449, 'time@10': 17.0027}:  70%|███████   | 7/10 [01:21<00:38, 12.76s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0068, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9658, 'compress@10': 0.4891, 'time@10': 16.6531}:  70%|███████   | 7/10 [01:35<00:38, 12.76s/it]  {'epoch': 40, 'num_users': 6.125, 'loss': 0.0068, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9658, 'compress@10': 0.4891, 'time@10': 16.6531}:  80%|████████  | 8/10 [01:35<00:26, 13.24s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.007, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9664, 'compress@10': 0.534, 'time@10': 17.678}:  80%|████████  | 8/10 [01:48<00:26, 13.24s/it] {'epoch': 40, 'num_users': 6.3333, 'loss': 0.007, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9664, 'compress@10': 0.534, 'time@10': 17.678}:  90%|█████████ | 9/10 [01:48<00:13, 13.15s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9821, 'compress@10': 0.527, 'time@10': 17.7898}:  90%|█████████ | 9/10 [02:07<00:13, 13.15s/it] {'epoch': 40, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9821, 'compress@10': 0.527, 'time@10': 17.7898}: 100%|██████████| 10/10 [02:07<00:00, 14.91s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9821, 'compress@10': 0.527, 'time@10': 17.7898}: 100%|██████████| 10/10 [02:07<00:00, 12.75s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.009175707043546009
Avg hit ratio: 0.9065076645670873
Avg ndcg: 0.9820956582951588
Avg compression ratio: 0.5270030528679264
Avg train time: 17.789805221557618
Std train time: 5.770861712809942
[0.4642857142857141, 0.7261904761904759, 0.03571428571428572, 0.3452380952380952, 0.7261904761904758, 0.29761904761904767, 0.25000000000000006, 0.7976190476190477, 0.8928571428571428, 0.4642857142857143]
[20, 20, 49, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0017, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4925, 'time@10': 16.058}:   0%|          | 0/10 [00:08<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0017, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4925, 'time@10': 16.058}:  10%|█         | 1/10 [00:08<01:12,  8.06s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0011, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9576, 'compress@10': 0.6137, 'time@10': 14.3857}:  10%|█         | 1/10 [00:20<01:12,  8.06s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0011, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9576, 'compress@10': 0.6137, 'time@10': 14.3857}:  20%|██        | 2/10 [00:20<01:26, 10.82s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0008, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9241, 'compress@10': 0.467, 'time@10': 13.3348}:  20%|██        | 2/10 [00:26<01:26, 10.82s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0008, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9241, 'compress@10': 0.467, 'time@10': 13.3348}:  30%|███       | 3/10 [00:26<00:59,  8.46s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0012, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9341, 'compress@10': 0.4424, 'time@10': 12.9572}:  30%|███       | 3/10 [00:38<00:59,  8.46s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0012, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9341, 'compress@10': 0.4424, 'time@10': 12.9572}:  40%|████      | 4/10 [00:38<00:58,  9.80s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0017, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9433, 'compress@10': 0.5003, 'time@10': 16.3047}:  40%|████      | 4/10 [00:53<00:58,  9.80s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 0.0017, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9433, 'compress@10': 0.5003, 'time@10': 16.3047}:  50%|█████     | 5/10 [00:53<00:58, 11.64s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0042, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9522, 'compress@10': 0.4691, 'time@10': 16.71}:  50%|█████     | 5/10 [01:11<00:58, 11.64s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0042, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9522, 'compress@10': 0.4691, 'time@10': 16.71}:  60%|██████    | 6/10 [01:11<00:56, 14.06s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0042, 'hit_ratio@10': 0.9122, 'ndcg@10': 0.9533, 'compress@10': 0.4421, 'time@10': 17.2252}:  60%|██████    | 6/10 [01:22<00:56, 14.06s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0042, 'hit_ratio@10': 0.9122, 'ndcg@10': 0.9533, 'compress@10': 0.4421, 'time@10': 17.2252}:  70%|███████   | 7/10 [01:22<00:38, 12.80s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0039, 'hit_ratio@10': 0.9196, 'ndcg@10': 0.9556, 'compress@10': 0.4872, 'time@10': 16.846}:  70%|███████   | 7/10 [01:36<00:38, 12.80s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.0039, 'hit_ratio@10': 0.9196, 'ndcg@10': 0.9556, 'compress@10': 0.4872, 'time@10': 16.846}:  80%|████████  | 8/10 [01:36<00:26, 13.25s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0046, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9573, 'compress@10': 0.5326, 'time@10': 17.9133}:  80%|████████  | 8/10 [01:49<00:26, 13.25s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0046, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9573, 'compress@10': 0.5326, 'time@10': 17.9133}:  90%|█████████ | 9/10 [01:49<00:13, 13.26s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0058, 'hit_ratio@10': 0.9134, 'ndcg@10': 0.9611, 'compress@10': 0.527, 'time@10': 18.0123}:  90%|█████████ | 9/10 [02:08<00:13, 13.26s/it]    {'epoch': 41, 'num_users': 6.3, 'loss': 0.0058, 'hit_ratio@10': 0.9134, 'ndcg@10': 0.9611, 'compress@10': 0.527, 'time@10': 18.0123}: 100%|██████████| 10/10 [02:08<00:00, 15.01s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0058, 'hit_ratio@10': 0.9134, 'ndcg@10': 0.9611, 'compress@10': 0.527, 'time@10': 18.0123}: 100%|██████████| 10/10 [02:08<00:00, 12.86s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.005798695472571688
Avg hit ratio: 0.9134252003420086
Avg ndcg: 0.9610803503158103
Avg compression ratio: 0.5270225726488273
Avg train time: 18.01232466697693
Std train time: 5.874238732177772
[0.45348837209302306, 0.709302325581395, 0.034883720930232565, 0.33720930232558133, 0.7325581395348834, 0.3139534883720931, 0.2674418604651163, 0.7790697674418605, 0.8953488372093023, 0.47674418604651164]
[20, 20, 49, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0034, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4822, 'time@10': 15.7473}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0034, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4822, 'time@10': 15.7473}:  10%|█         | 1/10 [00:07<01:11,  7.91s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9253, 'ndcg@10': 1.0268, 'compress@10': 0.6005, 'time@10': 14.1691}:  10%|█         | 1/10 [00:20<01:11,  7.91s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9253, 'ndcg@10': 1.0268, 'compress@10': 0.6005, 'time@10': 14.1691}:  20%|██        | 2/10 [00:20<01:25, 10.69s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9702, 'compress@10': 0.4579, 'time@10': 13.1907}:  20%|██        | 2/10 [00:26<01:25, 10.69s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9702, 'compress@10': 0.4579, 'time@10': 13.1907}:  30%|███       | 3/10 [00:26<00:58,  8.39s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9687, 'compress@10': 0.4336, 'time@10': 12.8403}:  30%|███       | 3/10 [00:38<00:58,  8.39s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9687, 'compress@10': 0.4336, 'time@10': 12.8403}:  40%|████      | 4/10 [00:38<00:58,  9.75s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.971, 'compress@10': 0.4945, 'time@10': 16.1649}:  40%|████      | 4/10 [00:52<00:58,  9.75s/it] {'epoch': 42, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.971, 'compress@10': 0.4945, 'time@10': 16.1649}:  50%|█████     | 5/10 [00:52<00:57, 11.56s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9721, 'compress@10': 0.4669, 'time@10': 16.6764}:  50%|█████     | 5/10 [01:12<00:57, 11.56s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9721, 'compress@10': 0.4669, 'time@10': 16.6764}:  60%|██████    | 6/10 [01:12<00:56, 14.18s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9704, 'compress@10': 0.4426, 'time@10': 17.2104}:  60%|██████    | 6/10 [01:22<00:56, 14.18s/it] {'epoch': 42, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9704, 'compress@10': 0.4426, 'time@10': 17.2104}:  70%|███████   | 7/10 [01:22<00:38, 12.89s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0063, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9705, 'compress@10': 0.4855, 'time@10': 16.8397}:  70%|███████   | 7/10 [01:36<00:38, 12.89s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0063, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9705, 'compress@10': 0.4855, 'time@10': 16.8397}:  80%|████████  | 8/10 [01:36<00:26, 13.34s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0071, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9706, 'compress@10': 0.5313, 'time@10': 17.9194}:  80%|████████  | 8/10 [01:49<00:26, 13.34s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0071, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9706, 'compress@10': 0.5313, 'time@10': 17.9194}:  90%|█████████ | 9/10 [01:49<00:13, 13.33s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0073, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9707, 'compress@10': 0.5271, 'time@10': 17.9955}:  90%|█████████ | 9/10 [02:08<00:13, 13.33s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0073, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9707, 'compress@10': 0.5271, 'time@10': 17.9955}: 100%|██████████| 10/10 [02:08<00:00, 14.99s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0073, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9707, 'compress@10': 0.5271, 'time@10': 17.9955}: 100%|██████████| 10/10 [02:08<00:00, 12.86s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.0073112317908981235
Avg hit ratio: 0.9111359018269034
Avg ndcg: 0.970705914979221
Avg compression ratio: 0.5270734317913671
Avg train time: 17.99550266265869
Std train time: 5.875627435707662
[0.443181818181818, 0.7159090909090906, 0.034090909090909095, 0.3522727272727272, 0.7386363636363633, 0.3068181818181819, 0.2613636363636364, 0.7613636363636365, 0.8977272727272727, 0.48863636363636365]
[20, 20, 49, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0034, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4725, 'time@10': 15.7647}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0034, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4725, 'time@10': 15.7647}:  10%|█         | 1/10 [00:07<01:11,  7.92s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0052, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.5988, 'time@10': 14.2966}:  10%|█         | 1/10 [00:20<01:11,  7.92s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0052, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.5988, 'time@10': 14.2966}:  20%|██        | 2/10 [00:20<01:26, 10.83s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9241, 'compress@10': 0.4565, 'time@10': 13.2522}:  20%|██        | 2/10 [00:26<01:26, 10.83s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9241, 'compress@10': 0.4565, 'time@10': 13.2522}:  30%|███       | 3/10 [00:26<00:59,  8.45s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9341, 'compress@10': 0.4363, 'time@10': 12.8069}:  30%|███       | 3/10 [00:37<00:59,  8.45s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9341, 'compress@10': 0.4363, 'time@10': 12.8069}:  40%|████      | 4/10 [00:37<00:57,  9.66s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0034, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9433, 'compress@10': 0.4978, 'time@10': 16.1021}:  40%|████      | 4/10 [00:52<00:57,  9.66s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0034, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9433, 'compress@10': 0.4978, 'time@10': 16.1021}:  50%|█████     | 5/10 [00:52<00:57, 11.47s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.003, 'hit_ratio@10': 0.9145, 'ndcg@10': 0.9491, 'compress@10': 0.4685, 'time@10': 16.5515}:  50%|█████     | 5/10 [01:11<00:57, 11.47s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.003, 'hit_ratio@10': 0.9145, 'ndcg@10': 0.9491, 'compress@10': 0.4685, 'time@10': 16.5515}:  60%|██████    | 6/10 [01:11<00:55, 13.97s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0031, 'hit_ratio@10': 0.921, 'ndcg@10': 0.9506, 'compress@10': 0.4431, 'time@10': 17.1606}:  60%|██████    | 6/10 [01:21<00:55, 13.97s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0031, 'hit_ratio@10': 0.921, 'ndcg@10': 0.9506, 'compress@10': 0.4431, 'time@10': 17.1606}:  70%|███████   | 7/10 [01:21<00:38, 12.82s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0043, 'hit_ratio@10': 0.9273, 'ndcg@10': 0.9532, 'compress@10': 0.4838, 'time@10': 16.7887}:  70%|███████   | 7/10 [01:36<00:38, 12.82s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0043, 'hit_ratio@10': 0.9273, 'ndcg@10': 0.9532, 'compress@10': 0.4838, 'time@10': 16.7887}:  80%|████████  | 8/10 [01:36<00:26, 13.27s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0049, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9552, 'compress@10': 0.5301, 'time@10': 17.8291}:  80%|████████  | 8/10 [01:49<00:26, 13.27s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0049, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9552, 'compress@10': 0.5301, 'time@10': 17.8291}:  90%|█████████ | 9/10 [01:49<00:13, 13.22s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.005, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9574, 'compress@10': 0.5271, 'time@10': 17.8836}:  90%|█████████ | 9/10 [02:07<00:13, 13.22s/it]    {'epoch': 43, 'num_users': 6.3, 'loss': 0.005, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9574, 'compress@10': 0.5271, 'time@10': 17.8836}: 100%|██████████| 10/10 [02:07<00:00, 14.82s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.005, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9574, 'compress@10': 0.5271, 'time@10': 17.8836}: 100%|██████████| 10/10 [02:07<00:00, 12.76s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.005024603709462743
Avg hit ratio: 0.9224247152583315
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5271091003878972
Avg train time: 17.88359866142273
Std train time: 5.813731832939349
[0.4333333333333332, 0.7222222222222219, 0.03333333333333334, 0.34444444444444433, 0.7444444444444441, 0.30000000000000004, 0.2555555555555556, 0.7666666666666667, 0.9, 0.5]
[20, 20, 49, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.003, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4632, 'time@10': 15.7117}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.003, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4632, 'time@10': 15.7117}:  10%|█         | 1/10 [00:07<01:11,  7.89s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.5972, 'time@10': 14.2816}:  10%|█         | 1/10 [00:20<01:11,  7.89s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.5972, 'time@10': 14.2816}:  20%|██        | 2/10 [00:20<01:26, 10.83s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9241, 'compress@10': 0.4553, 'time@10': 13.1043}:  20%|██        | 2/10 [00:26<01:26, 10.83s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9241, 'compress@10': 0.4553, 'time@10': 13.1043}:  30%|███       | 3/10 [00:26<00:58,  8.36s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9341, 'compress@10': 0.4334, 'time@10': 12.7104}:  30%|███       | 3/10 [00:37<00:58,  8.36s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9341, 'compress@10': 0.4334, 'time@10': 12.7104}:  40%|████      | 4/10 [00:37<00:57,  9.62s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0066, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9433, 'compress@10': 0.4966, 'time@10': 15.95}:  40%|████      | 4/10 [00:52<00:57,  9.62s/it]  {'epoch': 44, 'num_users': 5.8, 'loss': 0.0066, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9433, 'compress@10': 0.4966, 'time@10': 15.95}:  50%|█████     | 5/10 [00:52<00:56, 11.38s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0062, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9491, 'compress@10': 0.4665, 'time@10': 16.4886}:  50%|█████     | 5/10 [01:11<00:56, 11.38s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0062, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9491, 'compress@10': 0.4665, 'time@10': 16.4886}:  60%|██████    | 6/10 [01:11<00:56, 14.04s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0055, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9506, 'compress@10': 0.4406, 'time@10': 17.1302}:  60%|██████    | 6/10 [01:21<00:56, 14.04s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0055, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9506, 'compress@10': 0.4406, 'time@10': 17.1302}:  70%|███████   | 7/10 [01:21<00:38, 12.89s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0053, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9532, 'compress@10': 0.4822, 'time@10': 16.8027}:  70%|███████   | 7/10 [01:36<00:38, 12.89s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0053, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9532, 'compress@10': 0.4822, 'time@10': 16.8027}:  80%|████████  | 8/10 [01:36<00:26, 13.42s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0062, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9552, 'compress@10': 0.5289, 'time@10': 17.8121}:  80%|████████  | 8/10 [01:49<00:26, 13.42s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0062, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9552, 'compress@10': 0.5289, 'time@10': 17.8121}:  90%|█████████ | 9/10 [01:49<00:13, 13.29s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9136, 'ndcg@10': 0.9598, 'compress@10': 0.5272, 'time@10': 17.8816}:  90%|█████████ | 9/10 [02:08<00:13, 13.29s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9136, 'ndcg@10': 0.9598, 'compress@10': 0.5272, 'time@10': 17.8816}: 100%|██████████| 10/10 [02:08<00:00, 14.93s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9136, 'ndcg@10': 0.9598, 'compress@10': 0.5272, 'time@10': 17.8816}: 100%|██████████| 10/10 [02:08<00:00, 12.81s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.008638577924767351
Avg hit ratio: 0.9136243810895763
Avg ndcg: 0.9598478782006362
Avg compression ratio: 0.5271583279581099
Avg train time: 17.881560850143433
Std train time: 5.74415324844963
[0.4239130434782607, 0.7282608695652171, 0.03260869565217392, 0.3586956521739129, 0.7499999999999997, 0.29347826086956524, 0.25000000000000006, 0.75, 0.9021739130434783, 0.5108695652173914]
[20, 20, 49, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0023, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4542, 'time@10': 15.4538}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0023, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4542, 'time@10': 15.4538}:  10%|█         | 1/10 [00:07<01:09,  7.76s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0021, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.5956, 'time@10': 14.0777}:  10%|█         | 1/10 [00:20<01:09,  7.76s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.0021, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.5956, 'time@10': 14.0777}:  20%|██        | 2/10 [00:20<01:25, 10.69s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0014, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9241, 'compress@10': 0.454, 'time@10': 13.0527}:  20%|██        | 2/10 [00:26<01:25, 10.69s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.0014, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9241, 'compress@10': 0.454, 'time@10': 13.0527}:  30%|███       | 3/10 [00:26<00:58,  8.34s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0017, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9341, 'compress@10': 0.4359, 'time@10': 12.6756}:  30%|███       | 3/10 [00:37<00:58,  8.34s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0017, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9341, 'compress@10': 0.4359, 'time@10': 12.6756}:  40%|████      | 4/10 [00:37<00:57,  9.62s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0019, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9433, 'compress@10': 0.4997, 'time@10': 16.0392}:  40%|████      | 4/10 [00:52<00:57,  9.62s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0019, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9433, 'compress@10': 0.4997, 'time@10': 16.0392}:  50%|█████     | 5/10 [00:52<00:57, 11.49s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0034, 'hit_ratio@10': 0.9162, 'ndcg@10': 0.9484, 'compress@10': 0.468, 'time@10': 16.5756}:  50%|█████     | 5/10 [01:11<00:57, 11.49s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0034, 'hit_ratio@10': 0.9162, 'ndcg@10': 0.9484, 'compress@10': 0.468, 'time@10': 16.5756}:  60%|██████    | 6/10 [01:11<00:56, 14.14s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0033, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.95, 'compress@10': 0.4411, 'time@10': 17.1261}:  60%|██████    | 6/10 [01:21<00:56, 14.14s/it] {'epoch': 45, 'num_users': 6.2857, 'loss': 0.0033, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.95, 'compress@10': 0.4411, 'time@10': 17.1261}:  70%|███████   | 7/10 [01:21<00:38, 12.87s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0041, 'hit_ratio@10': 0.9286, 'ndcg@10': 0.9527, 'compress@10': 0.4806, 'time@10': 16.8052}:  70%|███████   | 7/10 [01:36<00:38, 12.87s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0041, 'hit_ratio@10': 0.9286, 'ndcg@10': 0.9527, 'compress@10': 0.4806, 'time@10': 16.8052}:  80%|████████  | 8/10 [01:36<00:26, 13.42s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0044, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9548, 'compress@10': 0.5278, 'time@10': 17.8315}:  80%|████████  | 8/10 [01:49<00:26, 13.42s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0044, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9548, 'compress@10': 0.5278, 'time@10': 17.8315}:  90%|█████████ | 9/10 [01:49<00:13, 13.31s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.9177, 'ndcg@10': 0.9565, 'compress@10': 0.5272, 'time@10': 17.9192}:  90%|█████████ | 9/10 [02:08<00:13, 13.31s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.9177, 'ndcg@10': 0.9565, 'compress@10': 0.5272, 'time@10': 17.9192}: 100%|██████████| 10/10 [02:08<00:00, 14.99s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.9177, 'ndcg@10': 0.9565, 'compress@10': 0.5272, 'time@10': 17.9192}: 100%|██████████| 10/10 [02:08<00:00, 12.84s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.0058589120883880495
Avg hit ratio: 0.9177140137734364
Avg ndcg: 0.9564826008210663
Avg compression ratio: 0.5271902762435776
Avg train time: 17.91918339729309
Std train time: 5.845760926053439
[0.4148936170212764, 0.7127659574468082, 0.03191489361702128, 0.35106382978723394, 0.7553191489361699, 0.30851063829787234, 0.24468085106382984, 0.7553191489361702, 0.9042553191489362, 0.5212765957446809]
[20, 20, 49, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0021, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4457, 'time@10': 15.5361}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0021, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4457, 'time@10': 15.5361}:  10%|█         | 1/10 [00:07<01:10,  7.82s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9644, 'compress@10': 0.5839, 'time@10': 14.2186}:  10%|█         | 1/10 [00:20<01:10,  7.82s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9644, 'compress@10': 0.5839, 'time@10': 14.2186}:  20%|██        | 2/10 [00:20<01:26, 10.83s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9286, 'compress@10': 0.446, 'time@10': 13.1543}:  20%|██        | 2/10 [00:26<01:26, 10.83s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9286, 'compress@10': 0.446, 'time@10': 13.1543}:  30%|███       | 3/10 [00:26<00:58,  8.42s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9376, 'compress@10': 0.428, 'time@10': 12.7562}:  30%|███       | 3/10 [00:37<00:58,  8.42s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9376, 'compress@10': 0.428, 'time@10': 12.7562}:  40%|████      | 4/10 [00:37<00:58,  9.67s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0062, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.946, 'compress@10': 0.4945, 'time@10': 16.02}:  40%|████      | 4/10 [00:52<00:58,  9.67s/it]  {'epoch': 46, 'num_users': 5.8, 'loss': 0.0062, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.946, 'compress@10': 0.4945, 'time@10': 16.02}:  50%|█████     | 5/10 [00:52<00:57, 11.44s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0073, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.957, 'compress@10': 0.466, 'time@10': 16.5232}:  50%|█████     | 5/10 [01:11<00:57, 11.44s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0073, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.957, 'compress@10': 0.466, 'time@10': 16.5232}:  60%|██████    | 6/10 [01:11<00:56, 14.04s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0065, 'hit_ratio@10': 0.9303, 'ndcg@10': 0.9575, 'compress@10': 0.4387, 'time@10': 17.1141}:  60%|██████    | 6/10 [01:21<00:56, 14.04s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0065, 'hit_ratio@10': 0.9303, 'ndcg@10': 0.9575, 'compress@10': 0.4387, 'time@10': 17.1141}:  70%|███████   | 7/10 [01:21<00:38, 12.84s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0064, 'hit_ratio@10': 0.9354, 'ndcg@10': 0.9592, 'compress@10': 0.4792, 'time@10': 16.7469}:  70%|███████   | 7/10 [01:36<00:38, 12.84s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0064, 'hit_ratio@10': 0.9354, 'ndcg@10': 0.9592, 'compress@10': 0.4792, 'time@10': 16.7469}:  80%|████████  | 8/10 [01:36<00:26, 13.27s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0071, 'hit_ratio@10': 0.9267, 'ndcg@10': 0.9606, 'compress@10': 0.5267, 'time@10': 17.7607}:  80%|████████  | 8/10 [01:49<00:26, 13.27s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0071, 'hit_ratio@10': 0.9267, 'ndcg@10': 0.9606, 'compress@10': 0.5267, 'time@10': 17.7607}:  90%|█████████ | 9/10 [01:49<00:13, 13.18s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0066, 'hit_ratio@10': 0.9318, 'ndcg@10': 0.9622, 'compress@10': 0.5273, 'time@10': 17.871}:  90%|█████████ | 9/10 [02:08<00:13, 13.18s/it]    {'epoch': 46, 'num_users': 6.3, 'loss': 0.0066, 'hit_ratio@10': 0.9318, 'ndcg@10': 0.9622, 'compress@10': 0.5273, 'time@10': 17.871}: 100%|██████████| 10/10 [02:08<00:00, 14.95s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0066, 'hit_ratio@10': 0.9318, 'ndcg@10': 0.9622, 'compress@10': 0.5273, 'time@10': 17.871}: 100%|██████████| 10/10 [02:08<00:00, 12.80s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.006609993961259231
Avg hit ratio: 0.9317708224618242
Avg ndcg: 0.9622366564930861
Avg compression ratio: 0.5272566558727931
Avg train time: 17.87096929550171
Std train time: 5.745586709514304
[0.40624999999999983, 0.7187499999999997, 0.03125000000000001, 0.36458333333333326, 0.739583333333333, 0.3229166666666667, 0.23958333333333337, 0.7604166666666667, 0.90625, 0.5104166666666667]
[20, 20, 49, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0025, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4375, 'time@10': 15.8728}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0025, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4375, 'time@10': 15.8728}:  10%|█         | 1/10 [00:07<01:11,  7.99s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0026, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9576, 'compress@10': 0.5827, 'time@10': 14.5099}:  10%|█         | 1/10 [00:21<01:11,  7.99s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0026, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9576, 'compress@10': 0.5827, 'time@10': 14.5099}:  20%|██        | 2/10 [00:21<01:28, 11.04s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0018, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9241, 'compress@10': 0.445, 'time@10': 13.3924}:  20%|██        | 2/10 [00:26<01:28, 11.04s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0018, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9241, 'compress@10': 0.445, 'time@10': 13.3924}:  30%|███       | 3/10 [00:26<00:59,  8.57s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0019, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9341, 'compress@10': 0.4306, 'time@10': 12.93}:  30%|███       | 3/10 [00:38<00:59,  8.57s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0019, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9341, 'compress@10': 0.4306, 'time@10': 12.93}:  40%|████      | 4/10 [00:38<00:58,  9.76s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0021, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.9433, 'compress@10': 0.4934, 'time@10': 16.1799}:  40%|████      | 4/10 [00:53<00:58,  9.76s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0021, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.9433, 'compress@10': 0.4934, 'time@10': 16.1799}:  50%|█████     | 5/10 [00:53<00:57, 11.51s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0025, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9491, 'compress@10': 0.4675, 'time@10': 16.6407}:  50%|█████     | 5/10 [01:11<00:57, 11.51s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0025, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9491, 'compress@10': 0.4675, 'time@10': 16.6407}:  60%|██████    | 6/10 [01:11<00:56, 14.06s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0024, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9506, 'compress@10': 0.4393, 'time@10': 17.1969}:  60%|██████    | 6/10 [01:22<00:56, 14.06s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0024, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9506, 'compress@10': 0.4393, 'time@10': 17.1969}:  70%|███████   | 7/10 [01:22<00:38, 12.83s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.003, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9532, 'compress@10': 0.4803, 'time@10': 16.8449}:  70%|███████   | 7/10 [01:36<00:38, 12.83s/it]  {'epoch': 47, 'num_users': 6.125, 'loss': 0.003, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9532, 'compress@10': 0.4803, 'time@10': 16.8449}:  80%|████████  | 8/10 [01:36<00:26, 13.33s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0033, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9552, 'compress@10': 0.5279, 'time@10': 17.7815}:  80%|████████  | 8/10 [01:49<00:26, 13.33s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0033, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9552, 'compress@10': 0.5279, 'time@10': 17.7815}:  90%|█████████ | 9/10 [01:49<00:13, 13.13s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0047, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9611, 'compress@10': 0.5273, 'time@10': 17.8409}:  90%|█████████ | 9/10 [02:07<00:13, 13.13s/it]  {'epoch': 47, 'num_users': 6.3, 'loss': 0.0047, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9611, 'compress@10': 0.5273, 'time@10': 17.8409}: 100%|██████████| 10/10 [02:07<00:00, 14.76s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0047, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9611, 'compress@10': 0.5273, 'time@10': 17.8409}: 100%|██████████| 10/10 [02:07<00:00, 12.78s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.004651086767835612
Avg hit ratio: 0.8726648316784141
Avg ndcg: 0.9611184916123985
Avg compression ratio: 0.527268794182308
Avg train time: 17.840949153900148
Std train time: 5.6107776559822495
[0.3979591836734692, 0.7040816326530609, 0.03061224489795919, 0.3571428571428571, 0.7448979591836732, 0.33673469387755106, 0.23469387755102045, 0.7653061224489797, 0.9081632653061225, 0.5204081632653061]
[20, 20, 49, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0023, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4296, 'time@10': 15.799}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0023, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4296, 'time@10': 15.799}:  10%|█         | 1/10 [00:07<01:11,  7.94s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0029, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.5716, 'time@10': 14.2816}:  10%|█         | 1/10 [00:20<01:11,  7.94s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0029, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.5716, 'time@10': 14.2816}:  20%|██        | 2/10 [00:20<01:26, 10.80s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.002, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9241, 'compress@10': 0.4375, 'time@10': 13.2973}:  20%|██        | 2/10 [00:26<01:26, 10.80s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.002, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9241, 'compress@10': 0.4375, 'time@10': 13.2973}:  30%|███       | 3/10 [00:26<00:59,  8.48s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.003, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9341, 'compress@10': 0.4231, 'time@10': 12.882}:  30%|███       | 3/10 [00:38<00:59,  8.48s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.003, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9341, 'compress@10': 0.4231, 'time@10': 12.882}:  40%|████      | 4/10 [00:38<00:58,  9.74s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0035, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.9433, 'compress@10': 0.4885, 'time@10': 16.1344}:  40%|████      | 4/10 [00:52<00:58,  9.74s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0035, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.9433, 'compress@10': 0.4885, 'time@10': 16.1344}:  50%|█████     | 5/10 [00:52<00:57, 11.50s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0034, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9491, 'compress@10': 0.4657, 'time@10': 16.6512}:  50%|█████     | 5/10 [01:12<00:57, 11.50s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0034, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9491, 'compress@10': 0.4657, 'time@10': 16.6512}:  60%|██████    | 6/10 [01:12<00:56, 14.14s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0031, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9506, 'compress@10': 0.437, 'time@10': 17.2069}:  60%|██████    | 6/10 [01:22<00:56, 14.14s/it] {'epoch': 48, 'num_users': 6.2857, 'loss': 0.0031, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9506, 'compress@10': 0.437, 'time@10': 17.2069}:  70%|███████   | 7/10 [01:22<00:38, 12.89s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0033, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9532, 'compress@10': 0.4789, 'time@10': 16.806}:  70%|███████   | 7/10 [01:36<00:38, 12.89s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0033, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9532, 'compress@10': 0.4789, 'time@10': 16.806}:  80%|████████  | 8/10 [01:36<00:26, 13.25s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0043, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9552, 'compress@10': 0.5269, 'time@10': 17.7988}:  80%|████████  | 8/10 [01:49<00:26, 13.25s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0043, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9552, 'compress@10': 0.5269, 'time@10': 17.7988}:  90%|█████████ | 9/10 [01:49<00:13, 13.15s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0065, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.96, 'compress@10': 0.5273, 'time@10': 17.8816}:  90%|█████████ | 9/10 [02:07<00:13, 13.15s/it]    {'epoch': 48, 'num_users': 6.3, 'loss': 0.0065, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.96, 'compress@10': 0.5273, 'time@10': 17.8816}: 100%|██████████| 10/10 [02:07<00:00, 14.85s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0065, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.96, 'compress@10': 0.5273, 'time@10': 17.8816}: 100%|██████████| 10/10 [02:07<00:00, 12.80s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.006486840160946463
Avg hit ratio: 0.8914846230924329
Avg ndcg: 0.9599641733876026
Avg compression ratio: 0.5273316296402164
Avg train time: 17.881599068641663
Std train time: 5.706152391562902
[0.38999999999999985, 0.6899999999999997, 0.030000000000000006, 0.36999999999999994, 0.7499999999999998, 0.33, 0.23000000000000004, 0.77, 0.91, 0.53]
[20, 20, 49, 20, 14, 20, 20, 20, 19, 20]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0027, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4221, 'time@10': 15.1653}:   0%|          | 0/10 [00:07<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0027, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4221, 'time@10': 15.1653}:  10%|█         | 1/10 [00:07<01:08,  7.62s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.9312, 'ndcg@10': 0.9576, 'compress@10': 0.561, 'time@10': 13.853}:  10%|█         | 1/10 [00:20<01:08,  7.62s/it]  {'epoch': 49, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.9312, 'ndcg@10': 0.9576, 'compress@10': 0.561, 'time@10': 13.853}:  20%|██        | 2/10 [00:20<01:24, 10.54s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9241, 'compress@10': 0.4302, 'time@10': 12.7849}:  20%|██        | 2/10 [00:25<01:24, 10.54s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9241, 'compress@10': 0.4302, 'time@10': 12.7849}:  30%|███       | 3/10 [00:25<00:57,  8.17s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9341, 'compress@10': 0.4208, 'time@10': 12.4332}:  30%|███       | 3/10 [00:36<00:57,  8.17s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9341, 'compress@10': 0.4208, 'time@10': 12.4332}:  40%|████      | 4/10 [00:36<00:56,  9.45s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0041, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9433, 'compress@10': 0.4876, 'time@10': 15.8341}:  40%|████      | 4/10 [00:51<00:56,  9.45s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0041, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9433, 'compress@10': 0.4876, 'time@10': 15.8341}:  50%|█████     | 5/10 [00:51<00:56, 11.37s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0052, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9521, 'compress@10': 0.4638, 'time@10': 16.31}:  50%|█████     | 5/10 [01:10<00:56, 11.37s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0052, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9521, 'compress@10': 0.4638, 'time@10': 16.31}:  60%|██████    | 6/10 [01:10<00:55, 13.87s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0045, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9533, 'compress@10': 0.4348, 'time@10': 16.9099}:  60%|██████    | 6/10 [01:20<00:55, 13.87s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0045, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9533, 'compress@10': 0.4348, 'time@10': 16.9099}:  70%|███████   | 7/10 [01:20<00:38, 12.70s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0049, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9555, 'compress@10': 0.4776, 'time@10': 16.5309}:  70%|███████   | 7/10 [01:34<00:38, 12.70s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0049, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9555, 'compress@10': 0.4776, 'time@10': 16.5309}:  80%|████████  | 8/10 [01:34<00:26, 13.09s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0048, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9573, 'compress@10': 0.5259, 'time@10': 17.4332}:  80%|████████  | 8/10 [01:47<00:26, 13.09s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0048, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9573, 'compress@10': 0.5259, 'time@10': 17.4332}:  90%|█████████ | 9/10 [01:47<00:12, 12.86s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0057, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.96, 'compress@10': 0.5274, 'time@10': 17.545}:  90%|█████████ | 9/10 [02:05<00:12, 12.86s/it]      {'epoch': 49, 'num_users': 6.3, 'loss': 0.0057, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.96, 'compress@10': 0.5274, 'time@10': 17.545}: 100%|██████████| 10/10 [02:05<00:00, 14.63s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0057, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.96, 'compress@10': 0.5274, 'time@10': 17.545}: 100%|██████████| 10/10 [02:05<00:00, 12.56s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.0056663898848104315
Avg hit ratio: 0.909879912390948
Avg ndcg: 0.9600153618664823
Avg compression ratio: 0.5273638700967732
Avg train time: 17.54502592086792
Std train time: 5.768771362739047
[0.38235294117647045, 0.6960784313725488, 0.02941176470588236, 0.3627450980392156, 0.7352941176470587, 0.3431372549019608, 0.2254901960784314, 0.7745098039215687, 0.9117647058823529, 0.5392156862745098]
[20, 20, 49, 20, 14, 20, 20, 20, 19, 20]
