  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 1.252, 'hit_ratio@10': 0.3, 'ndcg@10': 0.065, 'compress@10': 0.55, 'time@10': 5.6057}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 1.252, 'hit_ratio@10': 0.3, 'ndcg@10': 0.065, 'compress@10': 0.55, 'time@10': 5.6057}:  10%|█         | 1/10 [00:02<00:25,  2.84s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.7026, 'hit_ratio@10': 0.3688, 'ndcg@10': 0.2856, 'compress@10': 0.5406, 'time@10': 4.6579}:  10%|█         | 1/10 [00:06<00:25,  2.84s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.7026, 'hit_ratio@10': 0.3688, 'ndcg@10': 0.2856, 'compress@10': 0.5406, 'time@10': 4.6579}:  20%|██        | 2/10 [00:06<00:27,  3.38s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 1.0748, 'hit_ratio@10': 0.2458, 'ndcg@10': 0.1904, 'compress@10': 0.5687, 'time@10': 3.5856}:  20%|██        | 2/10 [00:07<00:27,  3.38s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 1.0748, 'hit_ratio@10': 0.2458, 'ndcg@10': 0.1904, 'compress@10': 0.5687, 'time@10': 3.5856}:  30%|███       | 3/10 [00:07<00:15,  2.18s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8583, 'hit_ratio@10': 0.3177, 'ndcg@10': 0.2608, 'compress@10': 0.5599, 'time@10': 3.5632}:  30%|███       | 3/10 [00:10<00:15,  2.18s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8583, 'hit_ratio@10': 0.3177, 'ndcg@10': 0.2608, 'compress@10': 0.5599, 'time@10': 3.5632}:  40%|████      | 4/10 [00:10<00:16,  2.72s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.708, 'hit_ratio@10': 0.3849, 'ndcg@10': 0.3232, 'compress@10': 0.5518, 'time@10': 5.3095}:  40%|████      | 4/10 [00:17<00:16,  2.72s/it] {'epoch': 0, 'num_users': 5.8, 'loss': 0.708, 'hit_ratio@10': 0.3849, 'ndcg@10': 0.3232, 'compress@10': 0.5518, 'time@10': 5.3095}:  50%|█████     | 5/10 [00:17<00:19,  3.97s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.609, 'hit_ratio@10': 0.386, 'ndcg@10': 0.3729, 'compress@10': 0.5468, 'time@10': 5.3091}:  50%|█████     | 5/10 [00:22<00:19,  3.97s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.609, 'hit_ratio@10': 0.386, 'ndcg@10': 0.3729, 'compress@10': 0.5468, 'time@10': 5.3091}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.5564, 'hit_ratio@10': 0.3528, 'ndcg@10': 0.3639, 'compress@10': 0.5456, 'time@10': 5.4196}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.5564, 'hit_ratio@10': 0.3528, 'ndcg@10': 0.3639, 'compress@10': 0.5456, 'time@10': 5.4196}:  70%|███████   | 7/10 [00:25<00:11,  3.99s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.5014, 'hit_ratio@10': 0.3811, 'ndcg@10': 0.3723, 'compress@10': 0.5432, 'time@10': 5.2926}:  70%|███████   | 7/10 [00:29<00:11,  3.99s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.5014, 'hit_ratio@10': 0.3811, 'ndcg@10': 0.3723, 'compress@10': 0.5432, 'time@10': 5.2926}:  80%|████████  | 8/10 [00:29<00:08,  4.13s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.4611, 'hit_ratio@10': 0.3696, 'ndcg@10': 0.3865, 'compress@10': 0.5415, 'time@10': 5.656}:  80%|████████  | 8/10 [00:34<00:08,  4.13s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.4611, 'hit_ratio@10': 0.3696, 'ndcg@10': 0.3865, 'compress@10': 0.5415, 'time@10': 5.656}:  90%|█████████ | 9/10 [00:34<00:04,  4.19s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.4241, 'hit_ratio@10': 0.3935, 'ndcg@10': 0.4026, 'compress@10': 0.5395, 'time@10': 5.6419}:  90%|█████████ | 9/10 [00:39<00:04,  4.19s/it]  {'epoch': 0, 'num_users': 6.3, 'loss': 0.4241, 'hit_ratio@10': 0.3935, 'ndcg@10': 0.4026, 'compress@10': 0.5395, 'time@10': 5.6419}: 100%|██████████| 10/10 [00:39<00:00,  4.61s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.4241, 'hit_ratio@10': 0.3935, 'ndcg@10': 0.4026, 'compress@10': 0.5395, 'time@10': 5.6419}: 100%|██████████| 10/10 [00:39<00:00,  3.98s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.42406917447084186
Avg hit ratio: 0.3935250787224472
Avg ndcg: 0.4026003624883895
Avg compression ratio: 0.5394820818655083
Avg train time: 5.641877222061157
Std train time: 2.8396908972738806
[0.75, 0.75, 0.75, 0.75, 0.25, 0.25, 0.75, 0.25, 0.25, 0.25]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0762, 'hit_ratio@10': 0.3, 'ndcg@10': 0.6603, 'compress@10': 0.775, 'time@10': 4.0888}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0762, 'hit_ratio@10': 0.3, 'ndcg@10': 0.6603, 'compress@10': 0.775, 'time@10': 4.0888}:  10%|█         | 1/10 [00:02<00:18,  2.08s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0676, 'hit_ratio@10': 0.3063, 'ndcg@10': 0.737, 'compress@10': 0.7703, 'time@10': 3.8534}:  10%|█         | 1/10 [00:05<00:18,  2.08s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0676, 'hit_ratio@10': 0.3063, 'ndcg@10': 0.737, 'compress@10': 0.7703, 'time@10': 3.8534}:  20%|██        | 2/10 [00:05<00:24,  3.01s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0792, 'hit_ratio@10': 0.3708, 'ndcg@10': 0.6082, 'compress@10': 0.7844, 'time@10': 3.0767}:  20%|██        | 2/10 [00:06<00:24,  3.01s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0792, 'hit_ratio@10': 0.3708, 'ndcg@10': 0.6082, 'compress@10': 0.7844, 'time@10': 3.0767}:  30%|███       | 3/10 [00:06<00:14,  2.00s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0744, 'hit_ratio@10': 0.3948, 'ndcg@10': 0.6474, 'compress@10': 0.7799, 'time@10': 3.1169}:  30%|███       | 3/10 [00:09<00:14,  2.00s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0744, 'hit_ratio@10': 0.3948, 'ndcg@10': 0.6474, 'compress@10': 0.7799, 'time@10': 3.1169}:  40%|████      | 4/10 [00:09<00:15,  2.50s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0764, 'hit_ratio@10': 0.4312, 'ndcg@10': 0.6575, 'compress@10': 0.6797, 'time@10': 4.6785}:  40%|████      | 4/10 [00:15<00:15,  2.50s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0764, 'hit_ratio@10': 0.4312, 'ndcg@10': 0.6575, 'compress@10': 0.6797, 'time@10': 4.6785}:  50%|█████     | 5/10 [00:15<00:17,  3.58s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.076, 'hit_ratio@10': 0.4463, 'ndcg@10': 0.6825, 'compress@10': 0.6135, 'time@10': 4.7724}:  50%|█████     | 5/10 [00:20<00:17,  3.58s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.076, 'hit_ratio@10': 0.4463, 'ndcg@10': 0.6825, 'compress@10': 0.6135, 'time@10': 4.7724}:  60%|██████    | 6/10 [00:20<00:16,  4.16s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0735, 'hit_ratio@10': 0.4595, 'ndcg@10': 0.6774, 'compress@10': 0.6358, 'time@10': 4.8865}:  60%|██████    | 6/10 [00:23<00:16,  4.16s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0735, 'hit_ratio@10': 0.4595, 'ndcg@10': 0.6774, 'compress@10': 0.6358, 'time@10': 4.8865}:  70%|███████   | 7/10 [00:23<00:11,  3.72s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0694, 'hit_ratio@10': 0.4941, 'ndcg@10': 0.6895, 'compress@10': 0.5925, 'time@10': 4.8268}:  70%|███████   | 7/10 [00:27<00:11,  3.72s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0694, 'hit_ratio@10': 0.4941, 'ndcg@10': 0.6895, 'compress@10': 0.5925, 'time@10': 4.8268}:  80%|████████  | 8/10 [00:27<00:07,  3.95s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0663, 'hit_ratio@10': 0.4763, 'ndcg@10': 0.7114, 'compress@10': 0.5591, 'time@10': 5.1168}:  80%|████████  | 8/10 [00:31<00:07,  3.95s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0663, 'hit_ratio@10': 0.4763, 'ndcg@10': 0.7114, 'compress@10': 0.5591, 'time@10': 5.1168}:  90%|█████████ | 9/10 [00:31<00:03,  3.89s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0644, 'hit_ratio@10': 0.4982, 'ndcg@10': 0.721, 'compress@10': 0.5314, 'time@10': 5.1263}:  90%|█████████ | 9/10 [00:36<00:03,  3.89s/it]    {'epoch': 1, 'num_users': 6.3, 'loss': 0.0644, 'hit_ratio@10': 0.4982, 'ndcg@10': 0.721, 'compress@10': 0.5314, 'time@10': 5.1263}: 100%|██████████| 10/10 [00:36<00:00,  4.31s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0644, 'hit_ratio@10': 0.4982, 'ndcg@10': 0.721, 'compress@10': 0.5314, 'time@10': 5.1263}: 100%|██████████| 10/10 [00:36<00:00,  3.69s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.0644132283567176
Avg hit ratio: 0.4982118024995598
Avg ndcg: 0.7209999286744047
Avg compression ratio: 0.5314199803890726
Avg train time: 5.126289439201355
Std train time: 2.4413255812058536
[0.8333333333333334, 0.5, 0.8333333333333334, 0.8333333333333334, 0.5, 0.5, 0.5, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.4, 'ndcg@10': 0.805, 'compress@10': 0.85, 'time@10': 4.4952}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.4, 'ndcg@10': 0.805, 'compress@10': 0.85, 'time@10': 4.4952}:  10%|█         | 1/10 [00:02<00:20,  2.28s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.3875, 'ndcg@10': 0.816, 'compress@10': 0.6906, 'time@10': 4.0344}:  10%|█         | 1/10 [00:05<00:20,  2.28s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.3875, 'ndcg@10': 0.816, 'compress@10': 0.6906, 'time@10': 4.0344}:  20%|██        | 2/10 [00:05<00:24,  3.06s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0416, 'hit_ratio@10': 0.5083, 'ndcg@10': 0.7788, 'compress@10': 0.7521, 'time@10': 3.2439}:  20%|██        | 2/10 [00:06<00:24,  3.06s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0416, 'hit_ratio@10': 0.5083, 'ndcg@10': 0.7788, 'compress@10': 0.7521, 'time@10': 3.2439}:  30%|███       | 3/10 [00:06<00:14,  2.06s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.043, 'hit_ratio@10': 0.4646, 'ndcg@10': 0.7895, 'compress@10': 0.7752, 'time@10': 3.2415}:  30%|███       | 3/10 [00:10<00:14,  2.06s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.043, 'hit_ratio@10': 0.4646, 'ndcg@10': 0.7895, 'compress@10': 0.7752, 'time@10': 3.2415}:  40%|████      | 4/10 [00:10<00:15,  2.54s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0505, 'hit_ratio@10': 0.5024, 'ndcg@10': 0.7744, 'compress@10': 0.724, 'time@10': 4.614}:  40%|████      | 4/10 [00:15<00:15,  2.54s/it] {'epoch': 2, 'num_users': 5.8, 'loss': 0.0505, 'hit_ratio@10': 0.5024, 'ndcg@10': 0.7744, 'compress@10': 0.724, 'time@10': 4.614}:  50%|█████     | 5/10 [00:15<00:17,  3.46s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0536, 'hit_ratio@10': 0.4912, 'ndcg@10': 0.7828, 'compress@10': 0.6903, 'time@10': 4.7548}:  50%|█████     | 5/10 [00:20<00:17,  3.46s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0536, 'hit_ratio@10': 0.4912, 'ndcg@10': 0.7828, 'compress@10': 0.6903, 'time@10': 4.7548}:  60%|██████    | 6/10 [00:20<00:16,  4.15s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.052, 'hit_ratio@10': 0.5199, 'ndcg@10': 0.7874, 'compress@10': 0.6686, 'time@10': 4.8854}:  60%|██████    | 6/10 [00:23<00:16,  4.15s/it] {'epoch': 2, 'num_users': 6.2857, 'loss': 0.052, 'hit_ratio@10': 0.5199, 'ndcg@10': 0.7874, 'compress@10': 0.6686, 'time@10': 4.8854}:  70%|███████   | 7/10 [00:23<00:11,  3.73s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0499, 'hit_ratio@10': 0.547, 'ndcg@10': 0.7934, 'compress@10': 0.6113, 'time@10': 4.8249}:  70%|███████   | 7/10 [00:27<00:11,  3.73s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0499, 'hit_ratio@10': 0.547, 'ndcg@10': 0.7934, 'compress@10': 0.6113, 'time@10': 4.8249}:  80%|████████  | 8/10 [00:27<00:07,  3.96s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0479, 'hit_ratio@10': 0.5356, 'ndcg@10': 0.8055, 'compress@10': 0.5671, 'time@10': 5.0972}:  80%|████████  | 8/10 [00:31<00:07,  3.96s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0479, 'hit_ratio@10': 0.5356, 'ndcg@10': 0.8055, 'compress@10': 0.5671, 'time@10': 5.0972}:  90%|█████████ | 9/10 [00:31<00:03,  3.87s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0474, 'hit_ratio@10': 0.556, 'ndcg@10': 0.8056, 'compress@10': 0.5306, 'time@10': 5.1186}:  90%|█████████ | 9/10 [00:36<00:03,  3.87s/it]    {'epoch': 2, 'num_users': 6.3, 'loss': 0.0474, 'hit_ratio@10': 0.556, 'ndcg@10': 0.8056, 'compress@10': 0.5306, 'time@10': 5.1186}: 100%|██████████| 10/10 [00:36<00:00,  4.32s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0474, 'hit_ratio@10': 0.556, 'ndcg@10': 0.8056, 'compress@10': 0.5306, 'time@10': 5.1186}: 100%|██████████| 10/10 [00:36<00:00,  3.69s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04739190833506192
Avg hit ratio: 0.5559686772673043
Avg ndcg: 0.8055858855795053
Avg compression ratio: 0.530649061746801
Avg train time: 5.1185788869857785
Std train time: 2.2077304096846126
[0.875, 0.625, 0.625, 0.875, 0.625, 0.625, 0.375, 0.125, 0.125, 0.125]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8054, 'compress@10': 0.8875, 'time@10': 4.0613}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8054, 'compress@10': 0.8875, 'time@10': 4.0613}:  10%|█         | 1/10 [00:02<00:18,  2.07s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8115, 'compress@10': 0.768, 'time@10': 3.8791}:  10%|█         | 1/10 [00:05<00:18,  2.07s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8115, 'compress@10': 0.768, 'time@10': 3.8791}:  20%|██        | 2/10 [00:05<00:24,  3.05s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0346, 'hit_ratio@10': 0.55, 'ndcg@10': 0.791, 'compress@10': 0.7516, 'time@10': 3.2289}:  20%|██        | 2/10 [00:06<00:24,  3.05s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0346, 'hit_ratio@10': 0.55, 'ndcg@10': 0.791, 'compress@10': 0.7516, 'time@10': 3.2289}:  30%|███       | 3/10 [00:06<00:14,  2.11s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0371, 'hit_ratio@10': 0.5125, 'ndcg@10': 0.7973, 'compress@10': 0.7845, 'time@10': 3.2128}:  30%|███       | 3/10 [00:10<00:14,  2.11s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0371, 'hit_ratio@10': 0.5125, 'ndcg@10': 0.7973, 'compress@10': 0.7845, 'time@10': 3.2128}:  40%|████      | 4/10 [00:10<00:15,  2.54s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.5331, 'ndcg@10': 0.7833, 'compress@10': 0.7555, 'time@10': 4.3246}:  40%|████      | 4/10 [00:14<00:15,  2.54s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.5331, 'ndcg@10': 0.7833, 'compress@10': 0.7555, 'time@10': 4.3246}:  50%|█████     | 5/10 [00:14<00:16,  3.23s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0494, 'hit_ratio@10': 0.5094, 'ndcg@10': 0.7907, 'compress@10': 0.7365, 'time@10': 4.5395}:  50%|█████     | 5/10 [00:20<00:16,  3.23s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0494, 'hit_ratio@10': 0.5094, 'ndcg@10': 0.7907, 'compress@10': 0.7365, 'time@10': 4.5395}:  60%|██████    | 6/10 [00:20<00:16,  4.05s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.048, 'hit_ratio@10': 0.5466, 'ndcg@10': 0.7936, 'compress@10': 0.6917, 'time@10': 4.7087}:  60%|██████    | 6/10 [00:23<00:16,  4.05s/it] {'epoch': 3, 'num_users': 6.2857, 'loss': 0.048, 'hit_ratio@10': 0.5466, 'ndcg@10': 0.7936, 'compress@10': 0.6917, 'time@10': 4.7087}:  70%|███████   | 7/10 [00:23<00:11,  3.68s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0466, 'hit_ratio@10': 0.5703, 'ndcg@10': 0.8011, 'compress@10': 0.6266, 'time@10': 4.6255}:  70%|███████   | 7/10 [00:27<00:11,  3.68s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0466, 'hit_ratio@10': 0.5703, 'ndcg@10': 0.8011, 'compress@10': 0.6266, 'time@10': 4.6255}:  80%|████████  | 8/10 [00:27<00:07,  3.80s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0447, 'hit_ratio@10': 0.5564, 'ndcg@10': 0.8119, 'compress@10': 0.5763, 'time@10': 4.8997}:  80%|████████  | 8/10 [00:30<00:07,  3.80s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0447, 'hit_ratio@10': 0.5564, 'ndcg@10': 0.8119, 'compress@10': 0.5763, 'time@10': 4.8997}:  90%|█████████ | 9/10 [00:30<00:03,  3.73s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0446, 'hit_ratio@10': 0.5833, 'ndcg@10': 0.8133, 'compress@10': 0.535, 'time@10': 4.9378}:  90%|█████████ | 9/10 [00:35<00:03,  3.73s/it]    {'epoch': 3, 'num_users': 6.3, 'loss': 0.0446, 'hit_ratio@10': 0.5833, 'ndcg@10': 0.8133, 'compress@10': 0.535, 'time@10': 4.9378}: 100%|██████████| 10/10 [00:35<00:00,  4.22s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0446, 'hit_ratio@10': 0.5833, 'ndcg@10': 0.8133, 'compress@10': 0.535, 'time@10': 4.9378}: 100%|██████████| 10/10 [00:35<00:00,  3.60s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.04459458340477709
Avg hit ratio: 0.5833293238670814
Avg ndcg: 0.8133231079348677
Avg compression ratio: 0.5349505729687616
Avg train time: 4.937778425216675
Std train time: 1.8934283161307055
[0.9, 0.7, 0.5, 0.9, 0.7, 0.7, 0.3, 0.1, 0.1, 0.1]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8223, 'compress@10': 0.91, 'time@10': 4.1597}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8223, 'compress@10': 0.91, 'time@10': 4.1597}:  10%|█         | 1/10 [00:02<00:19,  2.12s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.4188, 'ndcg@10': 0.8188, 'compress@10': 0.8144, 'time@10': 3.8494}:  10%|█         | 1/10 [00:05<00:19,  2.12s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.4188, 'ndcg@10': 0.8188, 'compress@10': 0.8144, 'time@10': 3.8494}:  20%|██        | 2/10 [00:05<00:23,  2.97s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.4458, 'ndcg@10': 0.7958, 'compress@10': 0.7512, 'time@10': 3.2043}:  20%|██        | 2/10 [00:06<00:23,  2.97s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.4458, 'ndcg@10': 0.7958, 'compress@10': 0.7512, 'time@10': 3.2043}:  30%|███       | 3/10 [00:06<00:14,  2.07s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.4344, 'ndcg@10': 0.8003, 'compress@10': 0.7901, 'time@10': 3.2014}:  30%|███       | 3/10 [00:09<00:14,  2.07s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.4344, 'ndcg@10': 0.8003, 'compress@10': 0.7901, 'time@10': 3.2014}:  40%|████      | 4/10 [00:09<00:15,  2.53s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0441, 'hit_ratio@10': 0.4706, 'ndcg@10': 0.7855, 'compress@10': 0.7744, 'time@10': 4.0569}:  40%|████      | 4/10 [00:13<00:15,  2.53s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0441, 'hit_ratio@10': 0.4706, 'ndcg@10': 0.7855, 'compress@10': 0.7744, 'time@10': 4.0569}:  50%|█████     | 5/10 [00:13<00:14,  2.98s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0477, 'hit_ratio@10': 0.4646, 'ndcg@10': 0.7913, 'compress@10': 0.7642, 'time@10': 4.2767}:  50%|█████     | 5/10 [00:19<00:14,  2.98s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0477, 'hit_ratio@10': 0.4646, 'ndcg@10': 0.7913, 'compress@10': 0.7642, 'time@10': 4.2767}:  60%|██████    | 6/10 [00:19<00:15,  3.80s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0464, 'hit_ratio@10': 0.4971, 'ndcg@10': 0.7946, 'compress@10': 0.7055, 'time@10': 4.4903}:  60%|██████    | 6/10 [00:22<00:15,  3.80s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0464, 'hit_ratio@10': 0.4971, 'ndcg@10': 0.7946, 'compress@10': 0.7055, 'time@10': 4.4903}:  70%|███████   | 7/10 [00:22<00:10,  3.52s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0467, 'hit_ratio@10': 0.5271, 'ndcg@10': 0.7964, 'compress@10': 0.6358, 'time@10': 4.4453}:  70%|███████   | 7/10 [00:26<00:10,  3.52s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0467, 'hit_ratio@10': 0.5271, 'ndcg@10': 0.7964, 'compress@10': 0.6358, 'time@10': 4.4453}:  80%|████████  | 8/10 [00:26<00:07,  3.72s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0448, 'hit_ratio@10': 0.5303, 'ndcg@10': 0.8087, 'compress@10': 0.5818, 'time@10': 4.8005}:  80%|████████  | 8/10 [00:30<00:07,  3.72s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0448, 'hit_ratio@10': 0.5303, 'ndcg@10': 0.8087, 'compress@10': 0.5818, 'time@10': 4.8005}:  90%|█████████ | 9/10 [00:30<00:03,  3.77s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0448, 'hit_ratio@10': 0.5642, 'ndcg@10': 0.8093, 'compress@10': 0.5375, 'time@10': 4.8617}:  90%|█████████ | 9/10 [00:35<00:03,  3.77s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0448, 'hit_ratio@10': 0.5642, 'ndcg@10': 0.8093, 'compress@10': 0.5375, 'time@10': 4.8617}: 100%|██████████| 10/10 [00:35<00:00,  4.29s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0448, 'hit_ratio@10': 0.5642, 'ndcg@10': 0.8093, 'compress@10': 0.5375, 'time@10': 4.8617}: 100%|██████████| 10/10 [00:35<00:00,  3.55s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.044821791933932674
Avg hit ratio: 0.5641937794597978
Avg ndcg: 0.8092523598158559
Avg compression ratio: 0.5375317580096206
Avg train time: 4.8616914510726925
Std train time: 1.738591466993316
[0.75, 0.75, 0.4166666666666667, 0.75, 0.75, 0.75, 0.25, 0.25, 0.08333333333333334, 0.25]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8223, 'compress@10': 0.775, 'time@10': 4.4965}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8223, 'compress@10': 0.775, 'time@10': 4.4965}:  10%|█         | 1/10 [00:02<00:20,  2.28s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.4188, 'ndcg@10': 0.8188, 'compress@10': 0.7703, 'time@10': 4.1265}:  10%|█         | 1/10 [00:06<00:20,  2.28s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.4188, 'ndcg@10': 0.8188, 'compress@10': 0.7703, 'time@10': 4.1265}:  20%|██        | 2/10 [00:06<00:25,  3.17s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.4458, 'ndcg@10': 0.7958, 'compress@10': 0.701, 'time@10': 3.4596}:  20%|██        | 2/10 [00:07<00:25,  3.17s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.4458, 'ndcg@10': 0.7958, 'compress@10': 0.701, 'time@10': 3.4596}:  30%|███       | 3/10 [00:07<00:15,  2.23s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.4344, 'ndcg@10': 0.8021, 'compress@10': 0.7174, 'time@10': 3.429}:  30%|███       | 3/10 [00:10<00:15,  2.23s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.4344, 'ndcg@10': 0.8021, 'compress@10': 0.7174, 'time@10': 3.429}:  40%|████      | 4/10 [00:10<00:16,  2.68s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0431, 'hit_ratio@10': 0.4706, 'ndcg@10': 0.789, 'compress@10': 0.7259, 'time@10': 4.2028}:  40%|████      | 4/10 [00:14<00:16,  2.68s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0431, 'hit_ratio@10': 0.4706, 'ndcg@10': 0.789, 'compress@10': 0.7259, 'time@10': 4.2028}:  50%|█████     | 5/10 [00:14<00:15,  3.04s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0466, 'hit_ratio@10': 0.4719, 'ndcg@10': 0.7953, 'compress@10': 0.7317, 'time@10': 4.3776}:  50%|█████     | 5/10 [00:19<00:15,  3.04s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0466, 'hit_ratio@10': 0.4719, 'ndcg@10': 0.7953, 'compress@10': 0.7317, 'time@10': 4.3776}:  60%|██████    | 6/10 [00:19<00:15,  3.81s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0454, 'hit_ratio@10': 0.5034, 'ndcg@10': 0.7989, 'compress@10': 0.6711, 'time@10': 4.5982}:  60%|██████    | 6/10 [00:22<00:15,  3.81s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0454, 'hit_ratio@10': 0.5034, 'ndcg@10': 0.7989, 'compress@10': 0.6711, 'time@10': 4.5982}:  70%|███████   | 7/10 [00:22<00:10,  3.54s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0442, 'hit_ratio@10': 0.5325, 'ndcg@10': 0.8041, 'compress@10': 0.6234, 'time@10': 4.5391}:  70%|███████   | 7/10 [00:26<00:10,  3.54s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0442, 'hit_ratio@10': 0.5325, 'ndcg@10': 0.8041, 'compress@10': 0.6234, 'time@10': 4.5391}:  80%|████████  | 8/10 [00:26<00:07,  3.74s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0429, 'hit_ratio@10': 0.5289, 'ndcg@10': 0.8152, 'compress@10': 0.5691, 'time@10': 4.8249}:  80%|████████  | 8/10 [00:30<00:07,  3.74s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0429, 'hit_ratio@10': 0.5289, 'ndcg@10': 0.8152, 'compress@10': 0.5691, 'time@10': 4.8249}:  90%|█████████ | 9/10 [00:30<00:03,  3.70s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0438, 'hit_ratio@10': 0.5586, 'ndcg@10': 0.818, 'compress@10': 0.5404, 'time@10': 4.8863}:  90%|█████████ | 9/10 [00:35<00:03,  3.70s/it]    {'epoch': 5, 'num_users': 6.3, 'loss': 0.0438, 'hit_ratio@10': 0.5586, 'ndcg@10': 0.818, 'compress@10': 0.5404, 'time@10': 4.8863}: 100%|██████████| 10/10 [00:35<00:00,  4.25s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0438, 'hit_ratio@10': 0.5586, 'ndcg@10': 0.818, 'compress@10': 0.5404, 'time@10': 4.8863}: 100%|██████████| 10/10 [00:35<00:00,  3.58s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.043821341908111475
Avg hit ratio: 0.5586382239042422
Avg ndcg: 0.8179532380213242
Avg compression ratio: 0.5404296376605281
Avg train time: 4.886279296875
Std train time: 1.5590546720141258
[0.6428571428571429, 0.7857142857142857, 0.35714285714285715, 0.7857142857142857, 0.7857142857142857, 0.7857142857142857, 0.2142857142857143, 0.2142857142857143, 0.07142857142857144, 0.35714285714285715]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0413, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.6786, 'time@10': 4.2597}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0413, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.6786, 'time@10': 4.2597}:  10%|█         | 1/10 [00:02<00:19,  2.17s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8216, 'compress@10': 0.7388, 'time@10': 3.9168}:  10%|█         | 1/10 [00:05<00:19,  2.17s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8216, 'compress@10': 0.7388, 'time@10': 3.9168}:  20%|██        | 2/10 [00:05<00:24,  3.02s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.7977, 'compress@10': 0.6652, 'time@10': 3.4133}:  20%|██        | 2/10 [00:07<00:24,  3.02s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.7977, 'compress@10': 0.6652, 'time@10': 3.4133}:  30%|███       | 3/10 [00:07<00:15,  2.20s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.805, 'compress@10': 0.6989, 'time@10': 3.3403}:  30%|███       | 3/10 [00:10<00:15,  2.20s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.805, 'compress@10': 0.6989, 'time@10': 3.3403}:  40%|████      | 4/10 [00:10<00:15,  2.58s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0428, 'hit_ratio@10': 0.4964, 'ndcg@10': 0.7923, 'compress@10': 0.7179, 'time@10': 4.0726}:  40%|████      | 4/10 [00:13<00:15,  2.58s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0428, 'hit_ratio@10': 0.4964, 'ndcg@10': 0.7923, 'compress@10': 0.7179, 'time@10': 4.0726}:  50%|█████     | 5/10 [00:13<00:14,  2.92s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0458, 'hit_ratio@10': 0.4934, 'ndcg@10': 0.7991, 'compress@10': 0.7307, 'time@10': 4.2606}:  50%|█████     | 5/10 [00:18<00:14,  2.92s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0458, 'hit_ratio@10': 0.4934, 'ndcg@10': 0.7991, 'compress@10': 0.7307, 'time@10': 4.2606}:  60%|██████    | 6/10 [00:18<00:14,  3.71s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0447, 'hit_ratio@10': 0.5218, 'ndcg@10': 0.8021, 'compress@10': 0.6656, 'time@10': 4.5288}:  60%|██████    | 6/10 [00:22<00:14,  3.71s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0447, 'hit_ratio@10': 0.5218, 'ndcg@10': 0.8021, 'compress@10': 0.6656, 'time@10': 4.5288}:  70%|███████   | 7/10 [00:22<00:10,  3.51s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0442, 'hit_ratio@10': 0.5553, 'ndcg@10': 0.8037, 'compress@10': 0.6144, 'time@10': 4.5008}:  70%|███████   | 7/10 [00:26<00:10,  3.51s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0442, 'hit_ratio@10': 0.5553, 'ndcg@10': 0.8037, 'compress@10': 0.6144, 'time@10': 4.5008}:  80%|████████  | 8/10 [00:26<00:07,  3.78s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0428, 'hit_ratio@10': 0.5615, 'ndcg@10': 0.8157, 'compress@10': 0.5598, 'time@10': 4.8135}:  80%|████████  | 8/10 [00:30<00:07,  3.78s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0428, 'hit_ratio@10': 0.5615, 'ndcg@10': 0.8157, 'compress@10': 0.5598, 'time@10': 4.8135}:  90%|█████████ | 9/10 [00:30<00:03,  3.75s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0459, 'hit_ratio@10': 0.5879, 'ndcg@10': 0.8185, 'compress@10': 0.5423, 'time@10': 4.8645}:  90%|█████████ | 9/10 [00:35<00:03,  3.75s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0459, 'hit_ratio@10': 0.5879, 'ndcg@10': 0.8185, 'compress@10': 0.5423, 'time@10': 4.8645}: 100%|██████████| 10/10 [00:35<00:00,  4.25s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0459, 'hit_ratio@10': 0.5879, 'ndcg@10': 0.8185, 'compress@10': 0.5423, 'time@10': 4.8645}: 100%|██████████| 10/10 [00:35<00:00,  3.54s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.045928813392228436
Avg hit ratio: 0.5879291595767568
Avg ndcg: 0.818490203590002
Avg compression ratio: 0.5422974883256779
Avg train time: 4.864541006088257
Std train time: 1.5473925379270899
[0.5625, 0.8125, 0.3125, 0.8125, 0.8125, 0.8125, 0.1875, 0.1875, 0.06250000000000001, 0.4375]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0409, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.6062, 'time@10': 4.3668}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0409, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.6062, 'time@10': 4.3668}:  10%|█         | 1/10 [00:02<00:19,  2.22s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.4813, 'ndcg@10': 0.8192, 'compress@10': 0.7152, 'time@10': 3.9449}:  10%|█         | 1/10 [00:05<00:19,  2.22s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.4813, 'ndcg@10': 0.8192, 'compress@10': 0.7152, 'time@10': 3.9449}:  20%|██        | 2/10 [00:05<00:24,  3.01s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.4875, 'ndcg@10': 0.7961, 'compress@10': 0.6383, 'time@10': 3.4259}:  20%|██        | 2/10 [00:07<00:24,  3.01s/it]  {'epoch': 7, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.4875, 'ndcg@10': 0.7961, 'compress@10': 0.6383, 'time@10': 3.4259}:  30%|███       | 3/10 [00:07<00:15,  2.19s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.4823, 'ndcg@10': 0.8029, 'compress@10': 0.685, 'time@10': 3.3806}:  30%|███       | 3/10 [00:10<00:15,  2.19s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.4823, 'ndcg@10': 0.8029, 'compress@10': 0.685, 'time@10': 3.3806}:  40%|████      | 4/10 [00:10<00:15,  2.62s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0417, 'hit_ratio@10': 0.5089, 'ndcg@10': 0.7894, 'compress@10': 0.7119, 'time@10': 4.1106}:  40%|████      | 4/10 [00:13<00:15,  2.62s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0417, 'hit_ratio@10': 0.5089, 'ndcg@10': 0.7894, 'compress@10': 0.7119, 'time@10': 4.1106}:  50%|█████     | 5/10 [00:13<00:14,  2.96s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0446, 'hit_ratio@10': 0.4893, 'ndcg@10': 0.7946, 'compress@10': 0.73, 'time@10': 4.2819}:  50%|█████     | 5/10 [00:19<00:14,  2.96s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0446, 'hit_ratio@10': 0.4893, 'ndcg@10': 0.7946, 'compress@10': 0.73, 'time@10': 4.2819}:  60%|██████    | 6/10 [00:19<00:14,  3.71s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0436, 'hit_ratio@10': 0.5183, 'ndcg@10': 0.7983, 'compress@10': 0.6615, 'time@10': 4.4939}:  60%|██████    | 6/10 [00:21<00:14,  3.71s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0436, 'hit_ratio@10': 0.5183, 'ndcg@10': 0.7983, 'compress@10': 0.6615, 'time@10': 4.4939}:  70%|███████   | 7/10 [00:21<00:10,  3.45s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0433, 'hit_ratio@10': 0.5522, 'ndcg@10': 0.8029, 'compress@10': 0.6076, 'time@10': 4.4439}:  70%|███████   | 7/10 [00:26<00:10,  3.45s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0433, 'hit_ratio@10': 0.5522, 'ndcg@10': 0.8029, 'compress@10': 0.6076, 'time@10': 4.4439}:  80%|████████  | 8/10 [00:26<00:07,  3.67s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0423, 'hit_ratio@10': 0.5464, 'ndcg@10': 0.8149, 'compress@10': 0.5528, 'time@10': 4.759}:  80%|████████  | 8/10 [00:29<00:07,  3.67s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0423, 'hit_ratio@10': 0.5464, 'ndcg@10': 0.8149, 'compress@10': 0.5528, 'time@10': 4.759}:  90%|█████████ | 9/10 [00:29<00:03,  3.67s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0431, 'hit_ratio@10': 0.5744, 'ndcg@10': 0.8174, 'compress@10': 0.5437, 'time@10': 4.8265}:  90%|█████████ | 9/10 [00:35<00:03,  3.67s/it]  {'epoch': 7, 'num_users': 6.3, 'loss': 0.0431, 'hit_ratio@10': 0.5744, 'ndcg@10': 0.8174, 'compress@10': 0.5437, 'time@10': 4.8265}: 100%|██████████| 10/10 [00:35<00:00,  4.23s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0431, 'hit_ratio@10': 0.5744, 'ndcg@10': 0.8174, 'compress@10': 0.5437, 'time@10': 4.8265}: 100%|██████████| 10/10 [00:35<00:00,  3.52s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.043129144547914215
Avg hit ratio: 0.5743723962917326
Avg ndcg: 0.8173721992787334
Avg compression ratio: 0.5436983531627372
Avg train time: 4.826488733291626
Std train time: 1.5205751525547926
[0.5, 0.8333333333333334, 0.2777777777777778, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.16666666666666666, 0.16666666666666666, 0.055555555555555566, 0.5]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0405, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.55, 'time@10': 4.2827}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0405, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.55, 'time@10': 4.2827}:  10%|█         | 1/10 [00:02<00:19,  2.18s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.045, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8181, 'compress@10': 0.6969, 'time@10': 3.9114}:  10%|█         | 1/10 [00:05<00:19,  2.18s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.045, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8181, 'compress@10': 0.6969, 'time@10': 3.9114}:  20%|██        | 2/10 [00:05<00:24,  3.00s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.7954, 'compress@10': 0.6174, 'time@10': 3.5203}:  20%|██        | 2/10 [00:07<00:24,  3.00s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.7954, 'compress@10': 0.6174, 'time@10': 3.5203}:  30%|███       | 3/10 [00:07<00:15,  2.27s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8031, 'compress@10': 0.6741, 'time@10': 3.4762}:  30%|███       | 3/10 [00:10<00:15,  2.27s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8031, 'compress@10': 0.6741, 'time@10': 3.4762}:  40%|████      | 4/10 [00:10<00:16,  2.71s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0414, 'hit_ratio@10': 0.4964, 'ndcg@10': 0.79, 'compress@10': 0.7072, 'time@10': 4.1997}:  40%|████      | 4/10 [00:14<00:16,  2.71s/it]  {'epoch': 8, 'num_users': 5.8, 'loss': 0.0414, 'hit_ratio@10': 0.4964, 'ndcg@10': 0.79, 'compress@10': 0.7072, 'time@10': 4.1997}:  50%|█████     | 5/10 [00:14<00:15,  3.02s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0441, 'hit_ratio@10': 0.4861, 'ndcg@10': 0.7955, 'compress@10': 0.7295, 'time@10': 4.3221}:  50%|█████     | 5/10 [00:19<00:15,  3.02s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0441, 'hit_ratio@10': 0.4861, 'ndcg@10': 0.7955, 'compress@10': 0.7295, 'time@10': 4.3221}:  60%|██████    | 6/10 [00:19<00:14,  3.69s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.043, 'hit_ratio@10': 0.5156, 'ndcg@10': 0.7993, 'compress@10': 0.6582, 'time@10': 4.5495}:  60%|██████    | 6/10 [00:22<00:14,  3.69s/it] {'epoch': 8, 'num_users': 6.2857, 'loss': 0.043, 'hit_ratio@10': 0.5156, 'ndcg@10': 0.7993, 'compress@10': 0.6582, 'time@10': 4.5495}:  70%|███████   | 7/10 [00:22<00:10,  3.47s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.042, 'hit_ratio@10': 0.5498, 'ndcg@10': 0.8036, 'compress@10': 0.6023, 'time@10': 4.5095}:  70%|███████   | 7/10 [00:26<00:10,  3.47s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.042, 'hit_ratio@10': 0.5498, 'ndcg@10': 0.8036, 'compress@10': 0.6023, 'time@10': 4.5095}:  80%|████████  | 8/10 [00:26<00:07,  3.72s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0408, 'hit_ratio@10': 0.5381, 'ndcg@10': 0.8148, 'compress@10': 0.5473, 'time@10': 4.8287}:  80%|████████  | 8/10 [00:30<00:07,  3.72s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0408, 'hit_ratio@10': 0.5381, 'ndcg@10': 0.8148, 'compress@10': 0.5473, 'time@10': 4.8287}:  90%|█████████ | 9/10 [00:30<00:03,  3.72s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0416, 'hit_ratio@10': 0.5713, 'ndcg@10': 0.8182, 'compress@10': 0.5448, 'time@10': 4.8778}:  90%|█████████ | 9/10 [00:35<00:03,  3.72s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0416, 'hit_ratio@10': 0.5713, 'ndcg@10': 0.8182, 'compress@10': 0.5448, 'time@10': 4.8778}: 100%|██████████| 10/10 [00:35<00:00,  4.23s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0416, 'hit_ratio@10': 0.5713, 'ndcg@10': 0.8182, 'compress@10': 0.5448, 'time@10': 4.8778}: 100%|██████████| 10/10 [00:35<00:00,  3.55s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.041555191628612716
Avg hit ratio: 0.5712624929100902
Avg ndcg: 0.8182021755639226
Avg compression ratio: 0.5447875099434218
Avg train time: 4.877815055847168
Std train time: 1.481523892609363
[0.45, 0.8500000000000001, 0.25, 0.8500000000000001, 0.8500000000000001, 0.8500000000000001, 0.15, 0.15, 0.05000000000000001, 0.55]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.04, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.505, 'time@10': 4.4262}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.04, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.505, 'time@10': 4.4262}:  10%|█         | 1/10 [00:02<00:20,  2.25s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0432, 'hit_ratio@10': 0.45, 'ndcg@10': 0.825, 'compress@10': 0.6822, 'time@10': 4.1905}:  10%|█         | 1/10 [00:06<00:20,  2.25s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0432, 'hit_ratio@10': 0.45, 'ndcg@10': 0.825, 'compress@10': 0.6822, 'time@10': 4.1905}:  20%|██        | 2/10 [00:06<00:26,  3.27s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8, 'compress@10': 0.6006, 'time@10': 3.6972}:  20%|██        | 2/10 [00:07<00:26,  3.27s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8, 'compress@10': 0.6006, 'time@10': 3.6972}:  30%|███       | 3/10 [00:07<00:16,  2.41s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8075, 'compress@10': 0.6655, 'time@10': 3.5856}:  30%|███       | 3/10 [00:10<00:16,  2.41s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8075, 'compress@10': 0.6655, 'time@10': 3.5856}:  40%|████      | 4/10 [00:10<00:16,  2.76s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0401, 'hit_ratio@10': 0.4964, 'ndcg@10': 0.7937, 'compress@10': 0.7035, 'time@10': 4.3801}:  40%|████      | 4/10 [00:14<00:16,  2.76s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0401, 'hit_ratio@10': 0.4964, 'ndcg@10': 0.7937, 'compress@10': 0.7035, 'time@10': 4.3801}:  50%|█████     | 5/10 [00:14<00:15,  3.14s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0435, 'hit_ratio@10': 0.4934, 'ndcg@10': 0.7998, 'compress@10': 0.729, 'time@10': 4.4623}:  50%|█████     | 5/10 [00:19<00:15,  3.14s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0435, 'hit_ratio@10': 0.4934, 'ndcg@10': 0.7998, 'compress@10': 0.729, 'time@10': 4.4623}:  60%|██████    | 6/10 [00:19<00:14,  3.74s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0425, 'hit_ratio@10': 0.5218, 'ndcg@10': 0.8023, 'compress@10': 0.6556, 'time@10': 4.6555}:  60%|██████    | 6/10 [00:22<00:14,  3.74s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0425, 'hit_ratio@10': 0.5218, 'ndcg@10': 0.8023, 'compress@10': 0.6556, 'time@10': 4.6555}:  70%|███████   | 7/10 [00:22<00:10,  3.48s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0417, 'hit_ratio@10': 0.5553, 'ndcg@10': 0.8062, 'compress@10': 0.598, 'time@10': 4.5946}:  70%|███████   | 7/10 [00:26<00:10,  3.48s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0417, 'hit_ratio@10': 0.5553, 'ndcg@10': 0.8062, 'compress@10': 0.598, 'time@10': 4.5946}:  80%|████████  | 8/10 [00:26<00:07,  3.71s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0406, 'hit_ratio@10': 0.5491, 'ndcg@10': 0.8156, 'compress@10': 0.543, 'time@10': 4.9306}:  80%|████████  | 8/10 [00:30<00:07,  3.71s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0406, 'hit_ratio@10': 0.5491, 'ndcg@10': 0.8156, 'compress@10': 0.543, 'time@10': 4.9306}:  90%|█████████ | 9/10 [00:30<00:03,  3.76s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0406, 'hit_ratio@10': 0.5768, 'ndcg@10': 0.8186, 'compress@10': 0.5457, 'time@10': 4.9754}:  90%|█████████ | 9/10 [00:36<00:03,  3.76s/it]  {'epoch': 9, 'num_users': 6.3, 'loss': 0.0406, 'hit_ratio@10': 0.5768, 'ndcg@10': 0.8186, 'compress@10': 0.5457, 'time@10': 4.9754}: 100%|██████████| 10/10 [00:36<00:00,  4.27s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0406, 'hit_ratio@10': 0.5768, 'ndcg@10': 0.8186, 'compress@10': 0.5457, 'time@10': 4.9754}: 100%|██████████| 10/10 [00:36<00:00,  3.61s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.04056259217722276
Avg hit ratio: 0.5768180484656458
Avg ndcg: 0.8185669205508915
Avg compression ratio: 0.5456593035996632
Avg train time: 4.975433325767517
Std train time: 1.569578448544744
[0.5, 0.8636363636363638, 0.22727272727272727, 0.7727272727272728, 0.8636363636363638, 0.8636363636363638, 0.13636363636363635, 0.13636363636363635, 0.04545454545454546, 0.5909090909090909]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0395, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.55, 'time@10': 4.3758}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0395, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.55, 'time@10': 4.3758}:  10%|█         | 1/10 [00:02<00:20,  2.23s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.4188, 'ndcg@10': 0.8181, 'compress@10': 0.7111, 'time@10': 3.9657}:  10%|█         | 1/10 [00:05<00:20,  2.23s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.4188, 'ndcg@10': 0.8181, 'compress@10': 0.7111, 'time@10': 3.9657}:  20%|██        | 2/10 [00:05<00:24,  3.03s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0288, 'hit_ratio@10': 0.4458, 'ndcg@10': 0.7954, 'compress@10': 0.6142, 'time@10': 3.5847}:  20%|██        | 2/10 [00:07<00:24,  3.03s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0288, 'hit_ratio@10': 0.4458, 'ndcg@10': 0.7954, 'compress@10': 0.6142, 'time@10': 3.5847}:  30%|███       | 3/10 [00:07<00:16,  2.31s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.451, 'ndcg@10': 0.8031, 'compress@10': 0.6576, 'time@10': 3.5135}:  30%|███       | 3/10 [00:10<00:16,  2.31s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.451, 'ndcg@10': 0.8031, 'compress@10': 0.6576, 'time@10': 3.5135}:  40%|████      | 4/10 [00:10<00:16,  2.71s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0394, 'hit_ratio@10': 0.4839, 'ndcg@10': 0.7902, 'compress@10': 0.6999, 'time@10': 4.2319}:  40%|████      | 4/10 [00:14<00:16,  2.71s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0394, 'hit_ratio@10': 0.4839, 'ndcg@10': 0.7902, 'compress@10': 0.6999, 'time@10': 4.2319}:  50%|█████     | 5/10 [00:14<00:15,  3.03s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0447, 'hit_ratio@10': 0.483, 'ndcg@10': 0.8005, 'compress@10': 0.7281, 'time@10': 4.3369}:  50%|█████     | 5/10 [00:19<00:15,  3.03s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0447, 'hit_ratio@10': 0.483, 'ndcg@10': 0.8005, 'compress@10': 0.7281, 'time@10': 4.3369}:  60%|██████    | 6/10 [00:19<00:14,  3.67s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0434, 'hit_ratio@10': 0.5129, 'ndcg@10': 0.8032, 'compress@10': 0.6531, 'time@10': 4.517}:  60%|██████    | 6/10 [00:21<00:14,  3.67s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0434, 'hit_ratio@10': 0.5129, 'ndcg@10': 0.8032, 'compress@10': 0.6531, 'time@10': 4.517}:  70%|███████   | 7/10 [00:21<00:10,  3.40s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0422, 'hit_ratio@10': 0.554, 'ndcg@10': 0.807, 'compress@10': 0.5942, 'time@10': 4.4839}:  70%|███████   | 7/10 [00:26<00:10,  3.40s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.0422, 'hit_ratio@10': 0.554, 'ndcg@10': 0.807, 'compress@10': 0.5942, 'time@10': 4.4839}:  80%|████████  | 8/10 [00:26<00:07,  3.68s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0412, 'hit_ratio@10': 0.5419, 'ndcg@10': 0.8157, 'compress@10': 0.5391, 'time@10': 4.8188}:  80%|████████  | 8/10 [00:30<00:07,  3.68s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0412, 'hit_ratio@10': 0.5419, 'ndcg@10': 0.8157, 'compress@10': 0.5391, 'time@10': 4.8188}:  90%|█████████ | 9/10 [00:30<00:03,  3.71s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0422, 'hit_ratio@10': 0.5746, 'ndcg@10': 0.8192, 'compress@10': 0.5461, 'time@10': 4.8705}:  90%|█████████ | 9/10 [00:35<00:03,  3.71s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0422, 'hit_ratio@10': 0.5746, 'ndcg@10': 0.8192, 'compress@10': 0.5461, 'time@10': 4.8705}: 100%|██████████| 10/10 [00:35<00:00,  4.22s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0422, 'hit_ratio@10': 0.5746, 'ndcg@10': 0.8192, 'compress@10': 0.5461, 'time@10': 4.8705}: 100%|██████████| 10/10 [00:35<00:00,  3.54s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.04216818527790778
Avg hit ratio: 0.5746234768917835
Avg ndcg: 0.8192108278284325
Avg compression ratio: 0.5460701411604865
Avg train time: 4.870528697967529
Std train time: 1.4717427500488576
[0.5416666666666666, 0.8750000000000001, 0.20833333333333331, 0.7083333333333334, 0.8750000000000001, 0.8750000000000001, 0.12499999999999999, 0.12499999999999999, 0.04166666666666667, 0.625]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.5875, 'time@10': 4.4361}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.5875, 'time@10': 4.4361}:  10%|█         | 1/10 [00:02<00:20,  2.25s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.4188, 'ndcg@10': 0.8204, 'compress@10': 0.7352, 'time@10': 4.0421}:  10%|█         | 1/10 [00:05<00:20,  2.25s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.4188, 'ndcg@10': 0.8204, 'compress@10': 0.7352, 'time@10': 4.0421}:  20%|██        | 2/10 [00:05<00:24,  3.10s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.4458, 'ndcg@10': 0.7969, 'compress@10': 0.6255, 'time@10': 3.6358}:  20%|██        | 2/10 [00:07<00:24,  3.10s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.4458, 'ndcg@10': 0.7969, 'compress@10': 0.6255, 'time@10': 3.6358}:  30%|███       | 3/10 [00:07<00:16,  2.35s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0307, 'hit_ratio@10': 0.451, 'ndcg@10': 0.8029, 'compress@10': 0.6511, 'time@10': 3.5764}:  30%|███       | 3/10 [00:10<00:16,  2.35s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0307, 'hit_ratio@10': 0.451, 'ndcg@10': 0.8029, 'compress@10': 0.6511, 'time@10': 3.5764}:  40%|████      | 4/10 [00:10<00:16,  2.78s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0386, 'hit_ratio@10': 0.4839, 'ndcg@10': 0.7903, 'compress@10': 0.6968, 'time@10': 4.3177}:  40%|████      | 4/10 [00:14<00:16,  2.78s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0386, 'hit_ratio@10': 0.4839, 'ndcg@10': 0.7903, 'compress@10': 0.6968, 'time@10': 4.3177}:  50%|█████     | 5/10 [00:14<00:15,  3.10s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0428, 'hit_ratio@10': 0.4612, 'ndcg@10': 0.788, 'compress@10': 0.7274, 'time@10': 4.3953}:  50%|█████     | 5/10 [00:19<00:15,  3.10s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0428, 'hit_ratio@10': 0.4612, 'ndcg@10': 0.788, 'compress@10': 0.7274, 'time@10': 4.3953}:  60%|██████    | 6/10 [00:19<00:14,  3.68s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0416, 'hit_ratio@10': 0.4942, 'ndcg@10': 0.7925, 'compress@10': 0.651, 'time@10': 4.5787}:  60%|██████    | 6/10 [00:22<00:14,  3.68s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0416, 'hit_ratio@10': 0.4942, 'ndcg@10': 0.7925, 'compress@10': 0.651, 'time@10': 4.5787}:  70%|███████   | 7/10 [00:22<00:10,  3.42s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0408, 'hit_ratio@10': 0.5377, 'ndcg@10': 0.7976, 'compress@10': 0.591, 'time@10': 4.5027}:  70%|███████   | 7/10 [00:26<00:10,  3.42s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0408, 'hit_ratio@10': 0.5377, 'ndcg@10': 0.7976, 'compress@10': 0.591, 'time@10': 4.5027}:  80%|████████  | 8/10 [00:26<00:07,  3.61s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0398, 'hit_ratio@10': 0.5212, 'ndcg@10': 0.8068, 'compress@10': 0.5359, 'time@10': 4.8136}:  80%|████████  | 8/10 [00:29<00:07,  3.61s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0398, 'hit_ratio@10': 0.5212, 'ndcg@10': 0.8068, 'compress@10': 0.5359, 'time@10': 4.8136}:  90%|█████████ | 9/10 [00:29<00:03,  3.63s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.04, 'hit_ratio@10': 0.556, 'ndcg@10': 0.8115, 'compress@10': 0.5464, 'time@10': 4.8657}:  90%|█████████ | 9/10 [00:35<00:03,  3.63s/it]      {'epoch': 11, 'num_users': 6.3, 'loss': 0.04, 'hit_ratio@10': 0.556, 'ndcg@10': 0.8115, 'compress@10': 0.5464, 'time@10': 4.8657}: 100%|██████████| 10/10 [00:35<00:00,  4.17s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.04, 'hit_ratio@10': 0.556, 'ndcg@10': 0.8115, 'compress@10': 0.5464, 'time@10': 4.8657}: 100%|██████████| 10/10 [00:35<00:00,  3.53s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03999617644156106
Avg hit ratio: 0.5560244430753585
Avg ndcg: 0.8114878745447565
Avg compression ratio: 0.5464139060201709
Avg train time: 4.865712690353393
Std train time: 1.4647960850669626
[0.5769230769230769, 0.8846153846153847, 0.1923076923076923, 0.6538461538461539, 0.8846153846153847, 0.8846153846153847, 0.11538461538461538, 0.11538461538461538, 0.038461538461538464, 0.6538461538461539]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0382, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.6192, 'time@10': 4.3964}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0382, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.6192, 'time@10': 4.3964}:  10%|█         | 1/10 [00:02<00:20,  2.25s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0406, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8278, 'compress@10': 0.7555, 'time@10': 4.1129}:  10%|█         | 1/10 [00:06<00:20,  2.25s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0406, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8278, 'compress@10': 0.7555, 'time@10': 4.1129}:  20%|██        | 2/10 [00:06<00:25,  3.20s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8019, 'compress@10': 0.6351, 'time@10': 3.7058}:  20%|██        | 2/10 [00:07<00:25,  3.20s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8019, 'compress@10': 0.6351, 'time@10': 3.7058}:  30%|███       | 3/10 [00:07<00:16,  2.43s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8086, 'compress@10': 0.6455, 'time@10': 3.6181}:  30%|███       | 3/10 [00:11<00:16,  2.43s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8086, 'compress@10': 0.6455, 'time@10': 3.6181}:  40%|████      | 4/10 [00:11<00:16,  2.81s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0372, 'hit_ratio@10': 0.4964, 'ndcg@10': 0.7957, 'compress@10': 0.6942, 'time@10': 4.3486}:  40%|████      | 4/10 [00:14<00:16,  2.81s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0372, 'hit_ratio@10': 0.4964, 'ndcg@10': 0.7957, 'compress@10': 0.6942, 'time@10': 4.3486}:  50%|█████     | 5/10 [00:14<00:15,  3.12s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0391, 'hit_ratio@10': 0.5079, 'ndcg@10': 0.8046, 'compress@10': 0.7268, 'time@10': 4.4453}:  50%|█████     | 5/10 [00:19<00:15,  3.12s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0391, 'hit_ratio@10': 0.5079, 'ndcg@10': 0.8046, 'compress@10': 0.7268, 'time@10': 4.4453}:  60%|██████    | 6/10 [00:19<00:14,  3.75s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0383, 'hit_ratio@10': 0.5342, 'ndcg@10': 0.8083, 'compress@10': 0.6492, 'time@10': 4.6451}:  60%|██████    | 6/10 [00:22<00:14,  3.75s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0383, 'hit_ratio@10': 0.5342, 'ndcg@10': 0.8083, 'compress@10': 0.6492, 'time@10': 4.6451}:  70%|███████   | 7/10 [00:22<00:10,  3.49s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0376, 'hit_ratio@10': 0.5727, 'ndcg@10': 0.8114, 'compress@10': 0.5883, 'time@10': 4.583}:  70%|███████   | 7/10 [00:26<00:10,  3.49s/it]  {'epoch': 12, 'num_users': 6.125, 'loss': 0.0376, 'hit_ratio@10': 0.5727, 'ndcg@10': 0.8114, 'compress@10': 0.5883, 'time@10': 4.583}:  80%|████████  | 8/10 [00:26<00:07,  3.71s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0379, 'hit_ratio@10': 0.5585, 'ndcg@10': 0.8206, 'compress@10': 0.5331, 'time@10': 4.8731}:  80%|████████  | 8/10 [00:30<00:07,  3.71s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0379, 'hit_ratio@10': 0.5585, 'ndcg@10': 0.8206, 'compress@10': 0.5331, 'time@10': 4.8731}:  90%|█████████ | 9/10 [00:30<00:03,  3.69s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0381, 'hit_ratio@10': 0.5896, 'ndcg@10': 0.8252, 'compress@10': 0.5467, 'time@10': 4.9217}:  90%|█████████ | 9/10 [00:35<00:03,  3.69s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0381, 'hit_ratio@10': 0.5896, 'ndcg@10': 0.8252, 'compress@10': 0.5467, 'time@10': 4.9217}: 100%|██████████| 10/10 [00:35<00:00,  4.21s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0381, 'hit_ratio@10': 0.5896, 'ndcg@10': 0.8252, 'compress@10': 0.5467, 'time@10': 4.9217}: 100%|██████████| 10/10 [00:35<00:00,  3.58s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.038131946305646064
Avg hit ratio: 0.5895691290656966
Avg ndcg: 0.8251801546816502
Avg compression ratio: 0.5467019444510982
Avg train time: 4.921714401245117
Std train time: 1.4271181887754072
[0.5357142857142857, 0.8928571428571429, 0.17857142857142855, 0.6071428571428572, 0.8928571428571429, 0.8928571428571429, 0.10714285714285714, 0.10714285714285714, 0.10714285714285715, 0.6785714285714286]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0373, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.5821, 'time@10': 4.7274}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0373, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.5821, 'time@10': 4.7274}:  10%|█         | 1/10 [00:02<00:21,  2.40s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0381, 'hit_ratio@10': 0.45, 'ndcg@10': 0.824, 'compress@10': 0.7408, 'time@10': 4.2413}:  10%|█         | 1/10 [00:06<00:21,  2.40s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0381, 'hit_ratio@10': 0.45, 'ndcg@10': 0.824, 'compress@10': 0.7408, 'time@10': 4.2413}:  20%|██        | 2/10 [00:06<00:25,  3.22s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.7993, 'compress@10': 0.6219, 'time@10': 3.7744}:  20%|██        | 2/10 [00:07<00:25,  3.22s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.7993, 'compress@10': 0.6219, 'time@10': 3.7744}:  30%|███       | 3/10 [00:07<00:16,  2.42s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8099, 'compress@10': 0.6247, 'time@10': 3.6516}:  30%|███       | 3/10 [00:10<00:16,  2.42s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8099, 'compress@10': 0.6247, 'time@10': 3.6516}:  40%|████      | 4/10 [00:10<00:16,  2.77s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0356, 'hit_ratio@10': 0.4964, 'ndcg@10': 0.7974, 'compress@10': 0.6792, 'time@10': 4.3078}:  40%|████      | 4/10 [00:14<00:16,  2.77s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0356, 'hit_ratio@10': 0.4964, 'ndcg@10': 0.7974, 'compress@10': 0.6792, 'time@10': 4.3078}:  50%|█████     | 5/10 [00:14<00:15,  3.04s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0369, 'hit_ratio@10': 0.5006, 'ndcg@10': 0.8032, 'compress@10': 0.7156, 'time@10': 4.4554}:  50%|█████     | 5/10 [00:19<00:15,  3.04s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0369, 'hit_ratio@10': 0.5006, 'ndcg@10': 0.8032, 'compress@10': 0.7156, 'time@10': 4.4554}:  60%|██████    | 6/10 [00:19<00:15,  3.79s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0362, 'hit_ratio@10': 0.528, 'ndcg@10': 0.8076, 'compress@10': 0.6385, 'time@10': 4.6488}:  60%|██████    | 6/10 [00:22<00:15,  3.79s/it] {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0362, 'hit_ratio@10': 0.528, 'ndcg@10': 0.8076, 'compress@10': 0.6385, 'time@10': 4.6488}:  70%|███████   | 7/10 [00:22<00:10,  3.51s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0354, 'hit_ratio@10': 0.5673, 'ndcg@10': 0.8109, 'compress@10': 0.5779, 'time@10': 4.5715}:  70%|███████   | 7/10 [00:26<00:10,  3.51s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0354, 'hit_ratio@10': 0.5673, 'ndcg@10': 0.8109, 'compress@10': 0.5779, 'time@10': 4.5715}:  80%|████████  | 8/10 [00:26<00:07,  3.69s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0356, 'hit_ratio@10': 0.5475, 'ndcg@10': 0.8181, 'compress@10': 0.5311, 'time@10': 4.8831}:  80%|████████  | 8/10 [00:30<00:07,  3.69s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0356, 'hit_ratio@10': 0.5475, 'ndcg@10': 0.8181, 'compress@10': 0.5311, 'time@10': 4.8831}:  90%|█████████ | 9/10 [00:30<00:03,  3.70s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0356, 'hit_ratio@10': 0.5797, 'ndcg@10': 0.8216, 'compress@10': 0.5473, 'time@10': 4.9386}:  90%|█████████ | 9/10 [00:35<00:03,  3.70s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0356, 'hit_ratio@10': 0.5797, 'ndcg@10': 0.8216, 'compress@10': 0.5473, 'time@10': 4.9386}: 100%|██████████| 10/10 [00:35<00:00,  4.25s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0356, 'hit_ratio@10': 0.5797, 'ndcg@10': 0.8216, 'compress@10': 0.5473, 'time@10': 4.9386}: 100%|██████████| 10/10 [00:35<00:00,  3.59s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03559590240886183
Avg hit ratio: 0.5796657474231847
Avg ndcg: 0.8215741715954001
Avg compression ratio: 0.5472680168651467
Avg train time: 4.938649106025696
Std train time: 1.4283154259608049
[0.5666666666666667, 0.9, 0.16666666666666666, 0.5666666666666668, 0.9, 0.9, 0.09999999999999999, 0.09999999999999999, 0.16666666666666669, 0.6333333333333334]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0363, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.61, 'time@10': 4.4426}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0363, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8259, 'compress@10': 0.61, 'time@10': 4.4426}:  10%|█         | 1/10 [00:02<00:20,  2.26s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8193, 'compress@10': 0.7581, 'time@10': 4.0527}:  10%|█         | 1/10 [00:05<00:20,  2.26s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8193, 'compress@10': 0.7581, 'time@10': 4.0527}:  20%|██        | 2/10 [00:05<00:24,  3.11s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.7962, 'compress@10': 0.6304, 'time@10': 3.6678}:  20%|██        | 2/10 [00:07<00:24,  3.11s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.7962, 'compress@10': 0.6304, 'time@10': 3.6678}:  30%|███       | 3/10 [00:07<00:16,  2.37s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8082, 'compress@10': 0.6217, 'time@10': 3.6048}:  30%|███       | 3/10 [00:10<00:16,  2.37s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8082, 'compress@10': 0.6217, 'time@10': 3.6048}:  40%|████      | 4/10 [00:10<00:16,  2.80s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.035, 'hit_ratio@10': 0.4964, 'ndcg@10': 0.7964, 'compress@10': 0.6781, 'time@10': 4.319}:  40%|████      | 4/10 [00:14<00:16,  2.80s/it]  {'epoch': 14, 'num_users': 5.8, 'loss': 0.035, 'hit_ratio@10': 0.4964, 'ndcg@10': 0.7964, 'compress@10': 0.6781, 'time@10': 4.319}:  50%|█████     | 5/10 [00:14<00:15,  3.10s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0364, 'hit_ratio@10': 0.5006, 'ndcg@10': 0.8026, 'compress@10': 0.7158, 'time@10': 4.4587}:  50%|█████     | 5/10 [00:19<00:15,  3.10s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0364, 'hit_ratio@10': 0.5006, 'ndcg@10': 0.8026, 'compress@10': 0.7158, 'time@10': 4.4587}:  60%|██████    | 6/10 [00:19<00:15,  3.81s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0356, 'hit_ratio@10': 0.528, 'ndcg@10': 0.807, 'compress@10': 0.6377, 'time@10': 4.6461}:  60%|██████    | 6/10 [00:22<00:15,  3.81s/it]  {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0356, 'hit_ratio@10': 0.528, 'ndcg@10': 0.807, 'compress@10': 0.6377, 'time@10': 4.6461}:  70%|███████   | 7/10 [00:22<00:10,  3.52s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0353, 'hit_ratio@10': 0.5673, 'ndcg@10': 0.8103, 'compress@10': 0.5764, 'time@10': 4.5752}:  70%|███████   | 7/10 [00:26<00:10,  3.52s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0353, 'hit_ratio@10': 0.5673, 'ndcg@10': 0.8103, 'compress@10': 0.5764, 'time@10': 4.5752}:  80%|████████  | 8/10 [00:26<00:07,  3.71s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0353, 'hit_ratio@10': 0.5536, 'ndcg@10': 0.8221, 'compress@10': 0.5361, 'time@10': 4.8985}:  80%|████████  | 8/10 [00:30<00:07,  3.71s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0353, 'hit_ratio@10': 0.5536, 'ndcg@10': 0.8221, 'compress@10': 0.5361, 'time@10': 4.8985}:  90%|█████████ | 9/10 [00:30<00:03,  3.73s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.5852, 'ndcg@10': 0.8266, 'compress@10': 0.5474, 'time@10': 4.9435}:  90%|█████████ | 9/10 [00:35<00:03,  3.73s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.5852, 'ndcg@10': 0.8266, 'compress@10': 0.5474, 'time@10': 4.9435}: 100%|██████████| 10/10 [00:35<00:00,  4.25s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.5852, 'ndcg@10': 0.8266, 'compress@10': 0.5474, 'time@10': 4.9435}: 100%|██████████| 10/10 [00:35<00:00,  3.59s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.035797470776473564
Avg hit ratio: 0.5852213029787402
Avg ndcg: 0.8265914290213889
Avg compression ratio: 0.5473806729758848
Avg train time: 4.9435302972793576
Std train time: 1.4659966376555378
[0.59375, 0.90625, 0.15625, 0.5312500000000001, 0.90625, 0.90625, 0.09374999999999999, 0.09374999999999999, 0.15625000000000003, 0.6562500000000001]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0353, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8295, 'compress@10': 0.6344, 'time@10': 4.1918}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0353, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8295, 'compress@10': 0.6344, 'time@10': 4.1918}:  10%|█         | 1/10 [00:02<00:19,  2.13s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0357, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8248, 'compress@10': 0.7732, 'time@10': 3.9571}:  10%|█         | 1/10 [00:05<00:19,  2.13s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0357, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8248, 'compress@10': 0.7732, 'time@10': 3.9571}:  20%|██        | 2/10 [00:05<00:24,  3.09s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.7999, 'compress@10': 0.6379, 'time@10': 3.5987}:  20%|██        | 2/10 [00:07<00:24,  3.09s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.7999, 'compress@10': 0.6379, 'time@10': 3.5987}:  30%|███       | 3/10 [00:07<00:16,  2.35s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8122, 'compress@10': 0.619, 'time@10': 3.5514}:  30%|███       | 3/10 [00:10<00:16,  2.35s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8122, 'compress@10': 0.619, 'time@10': 3.5514}:  40%|████      | 4/10 [00:10<00:16,  2.79s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0332, 'hit_ratio@10': 0.5041, 'ndcg@10': 0.7995, 'compress@10': 0.6772, 'time@10': 4.2463}:  40%|████      | 4/10 [00:14<00:16,  2.79s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0332, 'hit_ratio@10': 0.5041, 'ndcg@10': 0.7995, 'compress@10': 0.6772, 'time@10': 4.2463}:  50%|█████     | 5/10 [00:14<00:15,  3.06s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.035, 'hit_ratio@10': 0.5215, 'ndcg@10': 0.8052, 'compress@10': 0.7161, 'time@10': 4.4032}:  50%|█████     | 5/10 [00:19<00:15,  3.06s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.035, 'hit_ratio@10': 0.5215, 'ndcg@10': 0.8052, 'compress@10': 0.7161, 'time@10': 4.4032}:  60%|██████    | 6/10 [00:19<00:15,  3.80s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0342, 'hit_ratio@10': 0.5459, 'ndcg@10': 0.8093, 'compress@10': 0.6371, 'time@10': 4.5721}:  60%|██████    | 6/10 [00:22<00:15,  3.80s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0342, 'hit_ratio@10': 0.5459, 'ndcg@10': 0.8093, 'compress@10': 0.6371, 'time@10': 4.5721}:  70%|███████   | 7/10 [00:22<00:10,  3.48s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0335, 'hit_ratio@10': 0.583, 'ndcg@10': 0.8132, 'compress@10': 0.5752, 'time@10': 4.5119}:  70%|███████   | 7/10 [00:26<00:10,  3.48s/it]  {'epoch': 15, 'num_users': 6.125, 'loss': 0.0335, 'hit_ratio@10': 0.583, 'ndcg@10': 0.8132, 'compress@10': 0.5752, 'time@10': 4.5119}:  80%|████████  | 8/10 [00:26<00:07,  3.69s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0322, 'hit_ratio@10': 0.5614, 'ndcg@10': 0.8235, 'compress@10': 0.5338, 'time@10': 4.8277}:  80%|████████  | 8/10 [00:30<00:07,  3.69s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0322, 'hit_ratio@10': 0.5614, 'ndcg@10': 0.8235, 'compress@10': 0.5338, 'time@10': 4.8277}:  90%|█████████ | 9/10 [00:30<00:03,  3.69s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0322, 'hit_ratio@10': 0.5922, 'ndcg@10': 0.828, 'compress@10': 0.5476, 'time@10': 4.8836}:  90%|█████████ | 9/10 [00:35<00:03,  3.69s/it]    {'epoch': 15, 'num_users': 6.3, 'loss': 0.0322, 'hit_ratio@10': 0.5922, 'ndcg@10': 0.828, 'compress@10': 0.5476, 'time@10': 4.8836}: 100%|██████████| 10/10 [00:35<00:00,  4.23s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0322, 'hit_ratio@10': 0.5922, 'ndcg@10': 0.828, 'compress@10': 0.5476, 'time@10': 4.8836}: 100%|██████████| 10/10 [00:35<00:00,  3.57s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.03224137663227565
Avg hit ratio: 0.5922075534432514
Avg ndcg: 0.8279715686980547
Avg compression ratio: 0.5475549992030695
Avg train time: 4.883608961105347
Std train time: 1.4201106381351958
[0.6176470588235294, 0.9117647058823529, 0.14705882352941177, 0.5000000000000001, 0.9117647058823529, 0.9117647058823529, 0.08823529411764705, 0.08823529411764705, 0.1470588235294118, 0.6764705882352943]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0341, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8316, 'compress@10': 0.6559, 'time@10': 4.6698}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0341, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8316, 'compress@10': 0.6559, 'time@10': 4.6698}:  10%|█         | 1/10 [00:02<00:21,  2.37s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.035, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8269, 'compress@10': 0.7866, 'time@10': 4.1248}:  10%|█         | 1/10 [00:05<00:21,  2.37s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.035, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8269, 'compress@10': 0.7866, 'time@10': 4.1248}:  20%|██        | 2/10 [00:05<00:24,  3.10s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8013, 'compress@10': 0.6445, 'time@10': 3.6763}:  20%|██        | 2/10 [00:07<00:24,  3.10s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8013, 'compress@10': 0.6445, 'time@10': 3.6763}:  30%|███       | 3/10 [00:07<00:16,  2.34s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8151, 'compress@10': 0.6167, 'time@10': 3.6146}:  30%|███       | 3/10 [00:10<00:16,  2.34s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8151, 'compress@10': 0.6167, 'time@10': 3.6146}:  40%|████      | 4/10 [00:10<00:16,  2.79s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0323, 'hit_ratio@10': 0.5118, 'ndcg@10': 0.8024, 'compress@10': 0.6764, 'time@10': 4.3377}:  40%|████      | 4/10 [00:14<00:16,  2.79s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0323, 'hit_ratio@10': 0.5118, 'ndcg@10': 0.8024, 'compress@10': 0.6764, 'time@10': 4.3377}:  50%|█████     | 5/10 [00:14<00:15,  3.10s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0351, 'hit_ratio@10': 0.5279, 'ndcg@10': 0.8106, 'compress@10': 0.7163, 'time@10': 4.4731}:  50%|█████     | 5/10 [00:19<00:15,  3.10s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0351, 'hit_ratio@10': 0.5279, 'ndcg@10': 0.8106, 'compress@10': 0.7163, 'time@10': 4.4731}:  60%|██████    | 6/10 [00:19<00:15,  3.81s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0341, 'hit_ratio@10': 0.5514, 'ndcg@10': 0.8144, 'compress@10': 0.6366, 'time@10': 4.6743}:  60%|██████    | 6/10 [00:22<00:15,  3.81s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0341, 'hit_ratio@10': 0.5514, 'ndcg@10': 0.8144, 'compress@10': 0.6366, 'time@10': 4.6743}:  70%|███████   | 7/10 [00:22<00:10,  3.54s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0332, 'hit_ratio@10': 0.5878, 'ndcg@10': 0.8177, 'compress@10': 0.574, 'time@10': 4.6147}:  70%|███████   | 7/10 [00:26<00:10,  3.54s/it]  {'epoch': 16, 'num_users': 6.125, 'loss': 0.0332, 'hit_ratio@10': 0.5878, 'ndcg@10': 0.8177, 'compress@10': 0.574, 'time@10': 4.6147}:  80%|████████  | 8/10 [00:26<00:07,  3.76s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0334, 'hit_ratio@10': 0.5904, 'ndcg@10': 0.8273, 'compress@10': 0.5318, 'time@10': 4.9654}:  80%|████████  | 8/10 [00:30<00:07,  3.76s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0334, 'hit_ratio@10': 0.5904, 'ndcg@10': 0.8273, 'compress@10': 0.5318, 'time@10': 4.9654}:  90%|█████████ | 9/10 [00:30<00:03,  3.81s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0334, 'hit_ratio@10': 0.6183, 'ndcg@10': 0.833, 'compress@10': 0.5477, 'time@10': 5.0321}:  90%|█████████ | 9/10 [00:36<00:03,  3.81s/it]    {'epoch': 16, 'num_users': 6.3, 'loss': 0.0334, 'hit_ratio@10': 0.6183, 'ndcg@10': 0.833, 'compress@10': 0.5477, 'time@10': 5.0321}: 100%|██████████| 10/10 [00:36<00:00,  4.39s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0334, 'hit_ratio@10': 0.6183, 'ndcg@10': 0.833, 'compress@10': 0.5477, 'time@10': 5.0321}: 100%|██████████| 10/10 [00:36<00:00,  3.65s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.03340932595748835
Avg hit ratio: 0.6182759295116276
Avg ndcg: 0.8330393066167657
Avg compression ratio: 0.5477104674974868
Avg train time: 5.032071948051453
Std train time: 1.5493994525806842
[0.638888888888889, 0.9166666666666666, 0.1388888888888889, 0.4722222222222223, 0.9166666666666666, 0.9166666666666666, 0.08333333333333333, 0.08333333333333333, 0.19444444444444448, 0.6388888888888891]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0332, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8278, 'compress@10': 0.675, 'time@10': 4.6479}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0332, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8278, 'compress@10': 0.675, 'time@10': 4.6479}:  10%|█         | 1/10 [00:02<00:21,  2.36s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0336, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8272, 'compress@10': 0.7984, 'time@10': 4.1233}:  10%|█         | 1/10 [00:05<00:21,  2.36s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0336, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8272, 'compress@10': 0.7984, 'time@10': 4.1233}:  20%|██        | 2/10 [00:05<00:24,  3.11s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8015, 'compress@10': 0.6503, 'time@10': 3.7605}:  20%|██        | 2/10 [00:07<00:24,  3.11s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8015, 'compress@10': 0.6503, 'time@10': 3.7605}:  30%|███       | 3/10 [00:07<00:16,  2.40s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8169, 'compress@10': 0.6146, 'time@10': 3.6608}:  30%|███       | 3/10 [00:10<00:16,  2.40s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8169, 'compress@10': 0.6146, 'time@10': 3.6608}:  40%|████      | 4/10 [00:10<00:16,  2.79s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.031, 'hit_ratio@10': 0.5195, 'ndcg@10': 0.8051, 'compress@10': 0.6757, 'time@10': 4.3774}:  40%|████      | 4/10 [00:14<00:16,  2.79s/it] {'epoch': 17, 'num_users': 5.8, 'loss': 0.031, 'hit_ratio@10': 0.5195, 'ndcg@10': 0.8051, 'compress@10': 0.6757, 'time@10': 4.3774}:  50%|█████     | 5/10 [00:14<00:15,  3.11s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0338, 'hit_ratio@10': 0.5271, 'ndcg@10': 0.8045, 'compress@10': 0.7164, 'time@10': 4.5033}:  50%|█████     | 5/10 [00:19<00:15,  3.11s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0338, 'hit_ratio@10': 0.5271, 'ndcg@10': 0.8045, 'compress@10': 0.7164, 'time@10': 4.5033}:  60%|██████    | 6/10 [00:19<00:15,  3.81s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0328, 'hit_ratio@10': 0.5507, 'ndcg@10': 0.8092, 'compress@10': 0.6361, 'time@10': 4.6962}:  60%|██████    | 6/10 [00:22<00:15,  3.81s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0328, 'hit_ratio@10': 0.5507, 'ndcg@10': 0.8092, 'compress@10': 0.6361, 'time@10': 4.6962}:  70%|███████   | 7/10 [00:22<00:10,  3.53s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.032, 'hit_ratio@10': 0.5871, 'ndcg@10': 0.8137, 'compress@10': 0.573, 'time@10': 4.6367}:  70%|███████   | 7/10 [00:26<00:10,  3.53s/it]   {'epoch': 17, 'num_users': 6.125, 'loss': 0.032, 'hit_ratio@10': 0.5871, 'ndcg@10': 0.8137, 'compress@10': 0.573, 'time@10': 4.6367}:  80%|████████  | 8/10 [00:26<00:07,  3.76s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0316, 'hit_ratio@10': 0.5651, 'ndcg@10': 0.8227, 'compress@10': 0.5359, 'time@10': 4.9487}:  80%|████████  | 8/10 [00:30<00:07,  3.76s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0316, 'hit_ratio@10': 0.5651, 'ndcg@10': 0.8227, 'compress@10': 0.5359, 'time@10': 4.9487}:  90%|█████████ | 9/10 [00:30<00:03,  3.76s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.5999, 'ndcg@10': 0.8277, 'compress@10': 0.5478, 'time@10': 5.0121}:  90%|█████████ | 9/10 [00:36<00:03,  3.76s/it]    {'epoch': 17, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.5999, 'ndcg@10': 0.8277, 'compress@10': 0.5478, 'time@10': 5.0121}: 100%|██████████| 10/10 [00:36<00:00,  4.34s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.5999, 'ndcg@10': 0.8277, 'compress@10': 0.5478, 'time@10': 5.0121}: 100%|██████████| 10/10 [00:36<00:00,  3.64s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.03099678089321929
Avg hit ratio: 0.599899861135559
Avg ndcg: 0.8276983496841206
Avg compression ratio: 0.5477793317800677
Avg train time: 5.01213755607605
Std train time: 1.460782634853035
[0.6578947368421053, 0.9210526315789473, 0.13157894736842105, 0.5000000000000001, 0.9210526315789473, 0.9210526315789473, 0.07894736842105263, 0.07894736842105263, 0.1842105263157895, 0.605263157894737]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0323, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8278, 'compress@10': 0.6921, 'time@10': 4.4487}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0323, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8278, 'compress@10': 0.6921, 'time@10': 4.4487}:  10%|█         | 1/10 [00:02<00:20,  2.26s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0323, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8316, 'compress@10': 0.809, 'time@10': 4.0323}:  10%|█         | 1/10 [00:05<00:20,  2.26s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0323, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8316, 'compress@10': 0.809, 'time@10': 4.0323}:  20%|██        | 2/10 [00:05<00:24,  3.08s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8044, 'compress@10': 0.6556, 'time@10': 3.6681}:  20%|██        | 2/10 [00:07<00:24,  3.08s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8044, 'compress@10': 0.6556, 'time@10': 3.6681}:  30%|███       | 3/10 [00:07<00:16,  2.36s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8196, 'compress@10': 0.625, 'time@10': 3.6011}:  30%|███       | 3/10 [00:10<00:16,  2.36s/it]   {'epoch': 18, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8196, 'compress@10': 0.625, 'time@10': 3.6011}:  40%|████      | 4/10 [00:10<00:16,  2.79s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.5062, 'ndcg@10': 0.8065, 'compress@10': 0.6848, 'time@10': 4.3827}:  40%|████      | 4/10 [00:14<00:16,  2.79s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.5062, 'ndcg@10': 0.8065, 'compress@10': 0.6848, 'time@10': 4.3827}:  50%|█████     | 5/10 [00:14<00:15,  3.15s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0302, 'hit_ratio@10': 0.5232, 'ndcg@10': 0.8155, 'compress@10': 0.7248, 'time@10': 4.5148}:  50%|█████     | 5/10 [00:19<00:15,  3.15s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0302, 'hit_ratio@10': 0.5232, 'ndcg@10': 0.8155, 'compress@10': 0.7248, 'time@10': 4.5148}:  60%|██████    | 6/10 [00:19<00:15,  3.85s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0296, 'hit_ratio@10': 0.5474, 'ndcg@10': 0.819, 'compress@10': 0.6426, 'time@10': 4.7076}:  60%|██████    | 6/10 [00:22<00:15,  3.85s/it] {'epoch': 18, 'num_users': 6.2857, 'loss': 0.0296, 'hit_ratio@10': 0.5474, 'ndcg@10': 0.819, 'compress@10': 0.6426, 'time@10': 4.7076}:  70%|███████   | 7/10 [00:22<00:10,  3.56s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0291, 'hit_ratio@10': 0.5842, 'ndcg@10': 0.8233, 'compress@10': 0.5782, 'time@10': 4.6223}:  70%|███████   | 7/10 [00:26<00:10,  3.56s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0291, 'hit_ratio@10': 0.5842, 'ndcg@10': 0.8233, 'compress@10': 0.5782, 'time@10': 4.6223}:  80%|████████  | 8/10 [00:26<00:07,  3.72s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0295, 'hit_ratio@10': 0.5872, 'ndcg@10': 0.8332, 'compress@10': 0.5395, 'time@10': 4.9217}:  80%|████████  | 8/10 [00:30<00:07,  3.72s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0295, 'hit_ratio@10': 0.5872, 'ndcg@10': 0.8332, 'compress@10': 0.5395, 'time@10': 4.9217}:  90%|█████████ | 9/10 [00:30<00:03,  3.71s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0299, 'hit_ratio@10': 0.6155, 'ndcg@10': 0.8389, 'compress@10': 0.5478, 'time@10': 4.9753}:  90%|█████████ | 9/10 [00:36<00:03,  3.71s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0299, 'hit_ratio@10': 0.6155, 'ndcg@10': 0.8389, 'compress@10': 0.5478, 'time@10': 4.9753}: 100%|██████████| 10/10 [00:36<00:00,  4.26s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0299, 'hit_ratio@10': 0.6155, 'ndcg@10': 0.8389, 'compress@10': 0.5478, 'time@10': 4.9753}: 100%|██████████| 10/10 [00:36<00:00,  3.61s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.029878427945106062
Avg hit ratio: 0.6154554166911147
Avg ndcg: 0.8389332890563781
Avg compression ratio: 0.5477834672545667
Avg train time: 4.975306534767151
Std train time: 1.5040422628544043
[0.675, 0.9249999999999999, 0.125, 0.4750000000000001, 0.9249999999999999, 0.875, 0.075, 0.075, 0.22500000000000003, 0.6250000000000001]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0314, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8278, 'compress@10': 0.7075, 'time@10': 4.4317}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0314, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8278, 'compress@10': 0.7075, 'time@10': 4.4317}:  10%|█         | 1/10 [00:02<00:20,  2.25s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.5312, 'ndcg@10': 0.8334, 'compress@10': 0.8186, 'time@10': 3.9735}:  10%|█         | 1/10 [00:05<00:20,  2.25s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.5312, 'ndcg@10': 0.8334, 'compress@10': 0.8186, 'time@10': 3.9735}:  20%|██        | 2/10 [00:05<00:24,  3.02s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.5208, 'ndcg@10': 0.8056, 'compress@10': 0.6603, 'time@10': 3.6807}:  20%|██        | 2/10 [00:07<00:24,  3.02s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.5208, 'ndcg@10': 0.8056, 'compress@10': 0.6603, 'time@10': 3.6807}:  30%|███       | 3/10 [00:07<00:16,  2.36s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.4906, 'ndcg@10': 0.8213, 'compress@10': 0.6227, 'time@10': 3.6266}:  30%|███       | 3/10 [00:10<00:16,  2.36s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.4906, 'ndcg@10': 0.8213, 'compress@10': 0.6227, 'time@10': 3.6266}:  40%|████      | 4/10 [00:10<00:16,  2.82s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.029, 'hit_ratio@10': 0.5463, 'ndcg@10': 0.8094, 'compress@10': 0.6838, 'time@10': 4.346}:  40%|████      | 4/10 [00:14<00:16,  2.82s/it]  {'epoch': 19, 'num_users': 5.8, 'loss': 0.029, 'hit_ratio@10': 0.5463, 'ndcg@10': 0.8094, 'compress@10': 0.6838, 'time@10': 4.346}:  50%|█████     | 5/10 [00:14<00:15,  3.12s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0295, 'hit_ratio@10': 0.5567, 'ndcg@10': 0.822, 'compress@10': 0.7165, 'time@10': 4.5069}:  50%|█████     | 5/10 [00:19<00:15,  3.12s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0295, 'hit_ratio@10': 0.5567, 'ndcg@10': 0.822, 'compress@10': 0.7165, 'time@10': 4.5069}:  60%|██████    | 6/10 [00:19<00:15,  3.88s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0288, 'hit_ratio@10': 0.5871, 'ndcg@10': 0.8267, 'compress@10': 0.6351, 'time@10': 4.6877}:  60%|██████    | 6/10 [00:22<00:15,  3.88s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0288, 'hit_ratio@10': 0.5871, 'ndcg@10': 0.8267, 'compress@10': 0.6351, 'time@10': 4.6877}:  70%|███████   | 7/10 [00:22<00:10,  3.57s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0281, 'hit_ratio@10': 0.619, 'ndcg@10': 0.8321, 'compress@10': 0.5711, 'time@10': 4.6173}:  70%|███████   | 7/10 [00:27<00:10,  3.57s/it]  {'epoch': 19, 'num_users': 6.125, 'loss': 0.0281, 'hit_ratio@10': 0.619, 'ndcg@10': 0.8321, 'compress@10': 0.5711, 'time@10': 4.6173}:  80%|████████  | 8/10 [00:27<00:07,  3.76s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0272, 'hit_ratio@10': 0.5934, 'ndcg@10': 0.8408, 'compress@10': 0.5375, 'time@10': 4.916}:  80%|████████  | 8/10 [00:30<00:07,  3.76s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0272, 'hit_ratio@10': 0.5934, 'ndcg@10': 0.8408, 'compress@10': 0.5375, 'time@10': 4.916}:  90%|█████████ | 9/10 [00:30<00:03,  3.74s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.6254, 'ndcg@10': 0.8438, 'compress@10': 0.5478, 'time@10': 4.9814}:  90%|█████████ | 9/10 [00:36<00:03,  3.74s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.6254, 'ndcg@10': 0.8438, 'compress@10': 0.5478, 'time@10': 4.9814}: 100%|██████████| 10/10 [00:36<00:00,  4.31s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.6254, 'ndcg@10': 0.8438, 'compress@10': 0.5478, 'time@10': 4.9814}: 100%|██████████| 10/10 [00:36<00:00,  3.63s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.027267777053439846
Avg hit ratio: 0.6253694820943105
Avg ndcg: 0.8438050524961691
Avg compression ratio: 0.5478420844129835
Avg train time: 4.981407046318054
Std train time: 1.4338104246208419
[0.6904761904761905, 0.9285714285714285, 0.11904761904761904, 0.45238095238095244, 0.9285714285714285, 0.8809523809523809, 0.07142857142857142, 0.07142857142857142, 0.21428571428571433, 0.642857142857143]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0305, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8278, 'compress@10': 0.7214, 'time@10': 4.4579}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0305, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8278, 'compress@10': 0.7214, 'time@10': 4.4579}:  10%|█         | 1/10 [00:02<00:20,  2.27s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.5312, 'ndcg@10': 0.8346, 'compress@10': 0.8272, 'time@10': 4.0522}:  10%|█         | 1/10 [00:05<00:20,  2.27s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.5312, 'ndcg@10': 0.8346, 'compress@10': 0.8272, 'time@10': 4.0522}:  20%|██        | 2/10 [00:05<00:24,  3.10s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.5208, 'ndcg@10': 0.8064, 'compress@10': 0.6646, 'time@10': 3.6869}:  20%|██        | 2/10 [00:07<00:24,  3.10s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.5208, 'ndcg@10': 0.8064, 'compress@10': 0.6646, 'time@10': 3.6869}:  30%|███       | 3/10 [00:07<00:16,  2.38s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.4906, 'ndcg@10': 0.8218, 'compress@10': 0.6207, 'time@10': 3.645}:  30%|███       | 3/10 [00:11<00:16,  2.38s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.4906, 'ndcg@10': 0.8218, 'compress@10': 0.6207, 'time@10': 3.645}:  40%|████      | 4/10 [00:11<00:17,  2.85s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0277, 'hit_ratio@10': 0.5463, 'ndcg@10': 0.8112, 'compress@10': 0.6828, 'time@10': 4.3995}:  40%|████      | 4/10 [00:14<00:17,  2.85s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0277, 'hit_ratio@10': 0.5463, 'ndcg@10': 0.8112, 'compress@10': 0.6828, 'time@10': 4.3995}:  50%|█████     | 5/10 [00:14<00:15,  3.17s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0284, 'hit_ratio@10': 0.5495, 'ndcg@10': 0.8251, 'compress@10': 0.7167, 'time@10': 4.5433}:  50%|█████     | 5/10 [00:20<00:15,  3.17s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0284, 'hit_ratio@10': 0.5495, 'ndcg@10': 0.8251, 'compress@10': 0.7167, 'time@10': 4.5433}:  60%|██████    | 6/10 [00:20<00:15,  3.89s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0278, 'hit_ratio@10': 0.5809, 'ndcg@10': 0.8294, 'compress@10': 0.6347, 'time@10': 4.7034}:  60%|██████    | 6/10 [00:22<00:15,  3.89s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0278, 'hit_ratio@10': 0.5809, 'ndcg@10': 0.8294, 'compress@10': 0.6347, 'time@10': 4.7034}:  70%|███████   | 7/10 [00:22<00:10,  3.56s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0272, 'hit_ratio@10': 0.6135, 'ndcg@10': 0.8344, 'compress@10': 0.5704, 'time@10': 4.6247}:  70%|███████   | 7/10 [00:27<00:10,  3.56s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0272, 'hit_ratio@10': 0.6135, 'ndcg@10': 0.8344, 'compress@10': 0.5704, 'time@10': 4.6247}:  80%|████████  | 8/10 [00:27<00:07,  3.74s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0279, 'hit_ratio@10': 0.6071, 'ndcg@10': 0.8429, 'compress@10': 0.5357, 'time@10': 4.9538}:  80%|████████  | 8/10 [00:30<00:07,  3.74s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0279, 'hit_ratio@10': 0.6071, 'ndcg@10': 0.8429, 'compress@10': 0.5357, 'time@10': 4.9538}:  90%|█████████ | 9/10 [00:30<00:03,  3.77s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0279, 'hit_ratio@10': 0.6333, 'ndcg@10': 0.8481, 'compress@10': 0.548, 'time@10': 4.9996}:  90%|█████████ | 9/10 [00:36<00:03,  3.77s/it]    {'epoch': 20, 'num_users': 6.3, 'loss': 0.0279, 'hit_ratio@10': 0.6333, 'ndcg@10': 0.8481, 'compress@10': 0.548, 'time@10': 4.9996}: 100%|██████████| 10/10 [00:36<00:00,  4.28s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0279, 'hit_ratio@10': 0.6333, 'ndcg@10': 0.8481, 'compress@10': 0.548, 'time@10': 4.9996}: 100%|██████████| 10/10 [00:36<00:00,  3.63s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.027931205946574694
Avg hit ratio: 0.633340496587064
Avg ndcg: 0.848058832159636
Avg compression ratio: 0.5479533907887819
Avg train time: 4.999614810943603
Std train time: 1.5022293723865157
[0.7045454545454546, 0.9318181818181818, 0.11363636363636363, 0.4318181818181819, 0.9318181818181818, 0.8863636363636364, 0.06818181818181818, 0.06818181818181818, 0.25000000000000006, 0.6136363636363638]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8312, 'compress@10': 0.7341, 'time@10': 4.3223}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8312, 'compress@10': 0.7341, 'time@10': 4.3223}:  10%|█         | 1/10 [00:02<00:19,  2.20s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.5312, 'ndcg@10': 0.8425, 'compress@10': 0.8351, 'time@10': 3.952}:  10%|█         | 1/10 [00:05<00:19,  2.20s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.5312, 'ndcg@10': 0.8425, 'compress@10': 0.8351, 'time@10': 3.952}:  20%|██        | 2/10 [00:05<00:24,  3.03s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.5208, 'ndcg@10': 0.8117, 'compress@10': 0.6685, 'time@10': 3.6039}:  20%|██        | 2/10 [00:07<00:24,  3.03s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.5208, 'ndcg@10': 0.8117, 'compress@10': 0.6685, 'time@10': 3.6039}:  30%|███       | 3/10 [00:07<00:16,  2.33s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.5073, 'ndcg@10': 0.8284, 'compress@10': 0.6188, 'time@10': 3.542}:  30%|███       | 3/10 [00:10<00:16,  2.33s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.5073, 'ndcg@10': 0.8284, 'compress@10': 0.6188, 'time@10': 3.542}:  40%|████      | 4/10 [00:10<00:16,  2.75s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0264, 'hit_ratio@10': 0.5597, 'ndcg@10': 0.8167, 'compress@10': 0.6819, 'time@10': 4.2821}:  40%|████      | 4/10 [00:14<00:16,  2.75s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0264, 'hit_ratio@10': 0.5597, 'ndcg@10': 0.8167, 'compress@10': 0.6819, 'time@10': 4.2821}:  50%|█████     | 5/10 [00:14<00:15,  3.08s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0301, 'hit_ratio@10': 0.5678, 'ndcg@10': 0.8329, 'compress@10': 0.7168, 'time@10': 4.4569}:  50%|█████     | 5/10 [00:19<00:15,  3.08s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0301, 'hit_ratio@10': 0.5678, 'ndcg@10': 0.8329, 'compress@10': 0.7168, 'time@10': 4.4569}:  60%|██████    | 6/10 [00:19<00:15,  3.86s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.029, 'hit_ratio@10': 0.5966, 'ndcg@10': 0.8369, 'compress@10': 0.6344, 'time@10': 4.6476}:  60%|██████    | 6/10 [00:22<00:15,  3.86s/it] {'epoch': 21, 'num_users': 6.2857, 'loss': 0.029, 'hit_ratio@10': 0.5966, 'ndcg@10': 0.8369, 'compress@10': 0.6344, 'time@10': 4.6476}:  70%|███████   | 7/10 [00:22<00:10,  3.56s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0283, 'hit_ratio@10': 0.6273, 'ndcg@10': 0.8417, 'compress@10': 0.5697, 'time@10': 4.5777}:  70%|███████   | 7/10 [00:26<00:10,  3.56s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0283, 'hit_ratio@10': 0.6273, 'ndcg@10': 0.8417, 'compress@10': 0.5697, 'time@10': 4.5777}:  80%|████████  | 8/10 [00:26<00:07,  3.74s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.6008, 'ndcg@10': 0.8489, 'compress@10': 0.5388, 'time@10': 4.8775}:  80%|████████  | 8/10 [00:30<00:07,  3.74s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.6008, 'ndcg@10': 0.8489, 'compress@10': 0.5388, 'time@10': 4.8775}:  90%|█████████ | 9/10 [00:30<00:03,  3.72s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0267, 'hit_ratio@10': 0.632, 'ndcg@10': 0.8536, 'compress@10': 0.548, 'time@10': 4.9288}:  90%|█████████ | 9/10 [00:35<00:03,  3.72s/it]     {'epoch': 21, 'num_users': 6.3, 'loss': 0.0267, 'hit_ratio@10': 0.632, 'ndcg@10': 0.8536, 'compress@10': 0.548, 'time@10': 4.9288}: 100%|██████████| 10/10 [00:35<00:00,  4.25s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0267, 'hit_ratio@10': 0.632, 'ndcg@10': 0.8536, 'compress@10': 0.548, 'time@10': 4.9288}: 100%|██████████| 10/10 [00:35<00:00,  3.59s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.026734982857685174
Avg hit ratio: 0.6320361487609771
Avg ndcg: 0.8536401484949712
Avg compression ratio: 0.5479992200607704
Avg train time: 4.928768634796143
Std train time: 1.4638365920508252
[0.7173913043478262, 0.9347826086956521, 0.10869565217391304, 0.4130434782608696, 0.9347826086956521, 0.8913043478260869, 0.06521739130434782, 0.10869565217391304, 0.23913043478260876, 0.5869565217391306]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0286, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8348, 'compress@10': 0.7456, 'time@10': 4.3834}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0286, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8348, 'compress@10': 0.7456, 'time@10': 4.3834}:  10%|█         | 1/10 [00:02<00:20,  2.23s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8453, 'compress@10': 0.8422, 'time@10': 3.9342}:  10%|█         | 1/10 [00:05<00:20,  2.23s/it] {'epoch': 22, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8453, 'compress@10': 0.8422, 'time@10': 3.9342}:  20%|██        | 2/10 [00:05<00:23,  2.99s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8136, 'compress@10': 0.672, 'time@10': 3.5633}:  20%|██        | 2/10 [00:07<00:23,  2.99s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8136, 'compress@10': 0.672, 'time@10': 3.5633}:  30%|███       | 3/10 [00:07<00:16,  2.29s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.4917, 'ndcg@10': 0.828, 'compress@10': 0.617, 'time@10': 3.5346}:  30%|███       | 3/10 [00:10<00:16,  2.29s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.4917, 'ndcg@10': 0.828, 'compress@10': 0.617, 'time@10': 3.5346}:  40%|████      | 4/10 [00:10<00:16,  2.76s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0252, 'hit_ratio@10': 0.5472, 'ndcg@10': 0.8166, 'compress@10': 0.6811, 'time@10': 4.2786}:  40%|████      | 4/10 [00:14<00:16,  2.76s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0252, 'hit_ratio@10': 0.5472, 'ndcg@10': 0.8166, 'compress@10': 0.6811, 'time@10': 4.2786}:  50%|█████     | 5/10 [00:14<00:15,  3.09s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0282, 'hit_ratio@10': 0.5429, 'ndcg@10': 0.8135, 'compress@10': 0.7169, 'time@10': 4.4448}:  50%|█████     | 5/10 [00:19<00:15,  3.09s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0282, 'hit_ratio@10': 0.5429, 'ndcg@10': 0.8135, 'compress@10': 0.7169, 'time@10': 4.4448}:  60%|██████    | 6/10 [00:19<00:15,  3.84s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0272, 'hit_ratio@10': 0.5753, 'ndcg@10': 0.8206, 'compress@10': 0.6341, 'time@10': 4.6018}:  60%|██████    | 6/10 [00:22<00:15,  3.84s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0272, 'hit_ratio@10': 0.5753, 'ndcg@10': 0.8206, 'compress@10': 0.6341, 'time@10': 4.6018}:  70%|███████   | 7/10 [00:22<00:10,  3.51s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0265, 'hit_ratio@10': 0.6086, 'ndcg@10': 0.8281, 'compress@10': 0.5743, 'time@10': 4.5014}:  70%|███████   | 7/10 [00:26<00:10,  3.51s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0265, 'hit_ratio@10': 0.6086, 'ndcg@10': 0.8281, 'compress@10': 0.5743, 'time@10': 4.5014}:  80%|████████  | 8/10 [00:26<00:07,  3.61s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.5966, 'ndcg@10': 0.8377, 'compress@10': 0.5417, 'time@10': 4.8018}:  80%|████████  | 8/10 [00:29<00:07,  3.61s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.5966, 'ndcg@10': 0.8377, 'compress@10': 0.5417, 'time@10': 4.8018}:  90%|█████████ | 9/10 [00:29<00:03,  3.62s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.6239, 'ndcg@10': 0.845, 'compress@10': 0.5481, 'time@10': 4.8686}:  90%|█████████ | 9/10 [00:35<00:03,  3.62s/it]     {'epoch': 22, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.6239, 'ndcg@10': 0.845, 'compress@10': 0.5481, 'time@10': 4.8686}: 100%|██████████| 10/10 [00:35<00:00,  4.20s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.6239, 'ndcg@10': 0.845, 'compress@10': 0.5481, 'time@10': 4.8686}: 100%|██████████| 10/10 [00:35<00:00,  3.55s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.027045618256490656
Avg hit ratio: 0.6238537816112186
Avg ndcg: 0.8450311111826053
Avg compression ratio: 0.5480538993043589
Avg train time: 4.868642282485962
Std train time: 1.4708924981662896
[0.7291666666666667, 0.8958333333333333, 0.10416666666666666, 0.39583333333333337, 0.9374999999999999, 0.8958333333333333, 0.0625, 0.10416666666666666, 0.27083333333333337, 0.6041666666666669]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8348, 'compress@10': 0.7562, 'time@10': 4.4864}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8348, 'compress@10': 0.7562, 'time@10': 4.4864}:  10%|█         | 1/10 [00:02<00:20,  2.28s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8486, 'compress@10': 0.8293, 'time@10': 4.0605}:  10%|█         | 1/10 [00:05<00:20,  2.28s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8486, 'compress@10': 0.8293, 'time@10': 4.0605}:  20%|██        | 2/10 [00:05<00:24,  3.10s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8158, 'compress@10': 0.6622, 'time@10': 3.6219}:  20%|██        | 2/10 [00:07<00:24,  3.10s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8158, 'compress@10': 0.6622, 'time@10': 3.6219}:  30%|███       | 3/10 [00:07<00:16,  2.33s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.4917, 'ndcg@10': 0.8308, 'compress@10': 0.6057, 'time@10': 3.5716}:  30%|███       | 3/10 [00:10<00:16,  2.33s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.4917, 'ndcg@10': 0.8308, 'compress@10': 0.6057, 'time@10': 3.5716}:  40%|████      | 4/10 [00:10<00:16,  2.77s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.5472, 'ndcg@10': 0.8215, 'compress@10': 0.6725, 'time@10': 4.2812}:  40%|████      | 4/10 [00:14<00:16,  2.77s/it] {'epoch': 23, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.5472, 'ndcg@10': 0.8215, 'compress@10': 0.6725, 'time@10': 4.2812}:  50%|█████     | 5/10 [00:14<00:15,  3.07s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0249, 'hit_ratio@10': 0.5429, 'ndcg@10': 0.8342, 'compress@10': 0.7105, 'time@10': 4.4584}:  50%|█████     | 5/10 [00:19<00:15,  3.07s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0249, 'hit_ratio@10': 0.5429, 'ndcg@10': 0.8342, 'compress@10': 0.7105, 'time@10': 4.4584}:  60%|██████    | 6/10 [00:19<00:15,  3.86s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0243, 'hit_ratio@10': 0.5643, 'ndcg@10': 0.8392, 'compress@10': 0.6282, 'time@10': 4.6124}:  60%|██████    | 6/10 [00:22<00:15,  3.86s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0243, 'hit_ratio@10': 0.5643, 'ndcg@10': 0.8392, 'compress@10': 0.6282, 'time@10': 4.6124}:  70%|███████   | 7/10 [00:22<00:10,  3.51s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0237, 'hit_ratio@10': 0.599, 'ndcg@10': 0.8455, 'compress@10': 0.5686, 'time@10': 4.5351}:  70%|███████   | 7/10 [00:26<00:10,  3.51s/it]  {'epoch': 23, 'num_users': 6.125, 'loss': 0.0237, 'hit_ratio@10': 0.599, 'ndcg@10': 0.8455, 'compress@10': 0.5686, 'time@10': 4.5351}:  80%|████████  | 8/10 [00:26<00:07,  3.68s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0233, 'hit_ratio@10': 0.5633, 'ndcg@10': 0.8526, 'compress@10': 0.54, 'time@10': 4.8587}:  80%|████████  | 8/10 [00:30<00:07,  3.68s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0233, 'hit_ratio@10': 0.5633, 'ndcg@10': 0.8526, 'compress@10': 0.54, 'time@10': 4.8587}:  90%|█████████ | 9/10 [00:30<00:03,  3.70s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.5939, 'ndcg@10': 0.8569, 'compress@10': 0.5482, 'time@10': 4.9223}:  90%|█████████ | 9/10 [00:35<00:03,  3.70s/it] {'epoch': 23, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.5939, 'ndcg@10': 0.8569, 'compress@10': 0.5482, 'time@10': 4.9223}: 100%|██████████| 10/10 [00:35<00:00,  4.27s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.5939, 'ndcg@10': 0.8569, 'compress@10': 0.5482, 'time@10': 4.9223}: 100%|██████████| 10/10 [00:35<00:00,  3.59s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.023165117705058823
Avg hit ratio: 0.5939392516966888
Avg ndcg: 0.8569148990634312
Avg compression ratio: 0.5481717442984024
Avg train time: 4.922261571884155
Std train time: 1.4761557354705543
[0.7400000000000001, 0.8999999999999999, 0.09999999999999999, 0.38000000000000006, 0.94, 0.8999999999999999, 0.06, 0.09999999999999999, 0.26, 0.6200000000000002]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8348, 'compress@10': 0.766, 'time@10': 4.5926}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8348, 'compress@10': 0.766, 'time@10': 4.5926}:  10%|█         | 1/10 [00:02<00:21,  2.33s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.4813, 'ndcg@10': 0.8497, 'compress@10': 0.8361, 'time@10': 4.1115}:  10%|█         | 1/10 [00:06<00:21,  2.33s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.4813, 'ndcg@10': 0.8497, 'compress@10': 0.8361, 'time@10': 4.1115}:  20%|██        | 2/10 [00:06<00:24,  3.12s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.4875, 'ndcg@10': 0.8164, 'compress@10': 0.6657, 'time@10': 3.7282}:  20%|██        | 2/10 [00:07<00:24,  3.12s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.4875, 'ndcg@10': 0.8164, 'compress@10': 0.6657, 'time@10': 3.7282}:  30%|███       | 3/10 [00:07<00:16,  2.39s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.4823, 'ndcg@10': 0.8324, 'compress@10': 0.6046, 'time@10': 3.6326}:  30%|███       | 3/10 [00:10<00:16,  2.39s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.4823, 'ndcg@10': 0.8324, 'compress@10': 0.6046, 'time@10': 3.6326}:  40%|████      | 4/10 [00:10<00:16,  2.78s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0234, 'hit_ratio@10': 0.5397, 'ndcg@10': 0.8227, 'compress@10': 0.6722, 'time@10': 4.3711}:  40%|████      | 4/10 [00:14<00:16,  2.78s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0234, 'hit_ratio@10': 0.5397, 'ndcg@10': 0.8227, 'compress@10': 0.6722, 'time@10': 4.3711}:  50%|█████     | 5/10 [00:14<00:15,  3.11s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0242, 'hit_ratio@10': 0.5512, 'ndcg@10': 0.8307, 'compress@10': 0.7109, 'time@10': 4.5378}:  50%|█████     | 5/10 [00:20<00:15,  3.11s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0242, 'hit_ratio@10': 0.5512, 'ndcg@10': 0.8307, 'compress@10': 0.7109, 'time@10': 4.5378}:  60%|██████    | 6/10 [00:20<00:15,  3.91s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.5713, 'ndcg@10': 0.8372, 'compress@10': 0.6282, 'time@10': 4.6862}:  60%|██████    | 6/10 [00:22<00:15,  3.91s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.5713, 'ndcg@10': 0.8372, 'compress@10': 0.6282, 'time@10': 4.6862}:  70%|███████   | 7/10 [00:22<00:10,  3.56s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.023, 'hit_ratio@10': 0.6052, 'ndcg@10': 0.844, 'compress@10': 0.5681, 'time@10': 4.61}:  70%|███████   | 7/10 [00:27<00:10,  3.56s/it]     {'epoch': 24, 'num_users': 6.125, 'loss': 0.023, 'hit_ratio@10': 0.6052, 'ndcg@10': 0.844, 'compress@10': 0.5681, 'time@10': 4.61}:  80%|████████  | 8/10 [00:27<00:07,  3.73s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0235, 'hit_ratio@10': 0.5997, 'ndcg@10': 0.8523, 'compress@10': 0.5384, 'time@10': 4.905}:  80%|████████  | 8/10 [00:30<00:07,  3.73s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0235, 'hit_ratio@10': 0.5997, 'ndcg@10': 0.8523, 'compress@10': 0.5384, 'time@10': 4.905}:  90%|█████████ | 9/10 [00:30<00:03,  3.71s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.6354, 'ndcg@10': 0.8595, 'compress@10': 0.5483, 'time@10': 4.9589}:  90%|█████████ | 9/10 [00:36<00:03,  3.71s/it]  {'epoch': 24, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.6354, 'ndcg@10': 0.8595, 'compress@10': 0.5483, 'time@10': 4.9589}: 100%|██████████| 10/10 [00:36<00:00,  4.26s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.6354, 'ndcg@10': 0.8595, 'compress@10': 0.5483, 'time@10': 4.9589}: 100%|██████████| 10/10 [00:36<00:00,  3.62s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.02349024775767341
Avg hit ratio: 0.6353583338222927
Avg ndcg: 0.8595046515325147
Avg compression ratio: 0.5482513935323136
Avg train time: 4.95894455909729
Std train time: 1.4482270137523288
[0.7500000000000001, 0.9038461538461537, 0.09615384615384615, 0.3653846153846154, 0.9423076923076923, 0.9038461538461537, 0.05769230769230769, 0.09615384615384615, 0.2884615384615385, 0.5961538461538464]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8386, 'compress@10': 0.775, 'time@10': 4.0698}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8386, 'compress@10': 0.775, 'time@10': 4.0698}:  10%|█         | 1/10 [00:02<00:18,  2.07s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.5625, 'ndcg@10': 0.8516, 'compress@10': 0.8424, 'time@10': 3.857}:  10%|█         | 1/10 [00:05<00:18,  2.07s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.5625, 'ndcg@10': 0.8516, 'compress@10': 0.8424, 'time@10': 3.857}:  20%|██        | 2/10 [00:05<00:24,  3.02s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.5417, 'ndcg@10': 0.8177, 'compress@10': 0.669, 'time@10': 3.5987}:  20%|██        | 2/10 [00:07<00:24,  3.02s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.5417, 'ndcg@10': 0.8177, 'compress@10': 0.669, 'time@10': 3.5987}:  30%|███       | 3/10 [00:07<00:16,  2.36s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.5229, 'ndcg@10': 0.8333, 'compress@10': 0.6037, 'time@10': 3.5728}:  30%|███       | 3/10 [00:10<00:16,  2.36s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.5229, 'ndcg@10': 0.8333, 'compress@10': 0.6037, 'time@10': 3.5728}:  40%|████      | 4/10 [00:10<00:16,  2.82s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0222, 'hit_ratio@10': 0.5722, 'ndcg@10': 0.8248, 'compress@10': 0.6718, 'time@10': 4.2836}:  40%|████      | 4/10 [00:14<00:16,  2.82s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0222, 'hit_ratio@10': 0.5722, 'ndcg@10': 0.8248, 'compress@10': 0.6718, 'time@10': 4.2836}:  50%|█████     | 5/10 [00:14<00:15,  3.10s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0234, 'hit_ratio@10': 0.571, 'ndcg@10': 0.8391, 'compress@10': 0.7112, 'time@10': 4.4573}:  50%|█████     | 5/10 [00:19<00:15,  3.10s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0234, 'hit_ratio@10': 0.571, 'ndcg@10': 0.8391, 'compress@10': 0.7112, 'time@10': 4.4573}:  60%|██████    | 6/10 [00:19<00:15,  3.87s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0227, 'hit_ratio@10': 0.5883, 'ndcg@10': 0.8444, 'compress@10': 0.6282, 'time@10': 4.5914}:  60%|██████    | 6/10 [00:22<00:15,  3.87s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0227, 'hit_ratio@10': 0.5883, 'ndcg@10': 0.8444, 'compress@10': 0.6282, 'time@10': 4.5914}:  70%|███████   | 7/10 [00:22<00:10,  3.50s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0222, 'hit_ratio@10': 0.6201, 'ndcg@10': 0.8505, 'compress@10': 0.5676, 'time@10': 4.5243}:  70%|███████   | 7/10 [00:26<00:10,  3.50s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0222, 'hit_ratio@10': 0.6201, 'ndcg@10': 0.8505, 'compress@10': 0.5676, 'time@10': 4.5243}:  80%|████████  | 8/10 [00:26<00:07,  3.69s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0217, 'hit_ratio@10': 0.5882, 'ndcg@10': 0.8575, 'compress@10': 0.541, 'time@10': 4.8391}:  80%|████████  | 8/10 [00:30<00:07,  3.69s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0217, 'hit_ratio@10': 0.5882, 'ndcg@10': 0.8575, 'compress@10': 0.541, 'time@10': 4.8391}:  90%|█████████ | 9/10 [00:30<00:03,  3.70s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.6163, 'ndcg@10': 0.8638, 'compress@10': 0.5483, 'time@10': 4.9191}:  90%|█████████ | 9/10 [00:36<00:03,  3.70s/it]  {'epoch': 25, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.6163, 'ndcg@10': 0.8638, 'compress@10': 0.5483, 'time@10': 4.9191}: 100%|██████████| 10/10 [00:36<00:00,  4.31s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.6163, 'ndcg@10': 0.8638, 'compress@10': 0.5483, 'time@10': 4.9191}: 100%|██████████| 10/10 [00:36<00:00,  3.60s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.02135337535782158
Avg hit ratio: 0.6163426333392008
Avg ndcg: 0.8637503319465161
Avg compression ratio: 0.548279668815881
Avg train time: 4.919078278541565
Std train time: 1.422185862937441
[0.7592592592592594, 0.9074074074074073, 0.09259259259259259, 0.35185185185185186, 0.9444444444444444, 0.9074074074074073, 0.09259259259259259, 0.09259259259259259, 0.2777777777777778, 0.5740740740740743]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8386, 'compress@10': 0.7833, 'time@10': 4.2822}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8386, 'compress@10': 0.7833, 'time@10': 4.2822}:  10%|█         | 1/10 [00:02<00:19,  2.18s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.5125, 'ndcg@10': 0.8516, 'compress@10': 0.8483, 'time@10': 3.9128}:  10%|█         | 1/10 [00:05<00:19,  2.18s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.5125, 'ndcg@10': 0.8516, 'compress@10': 0.8483, 'time@10': 3.9128}:  20%|██        | 2/10 [00:05<00:24,  3.00s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.5083, 'ndcg@10': 0.8177, 'compress@10': 0.672, 'time@10': 3.5897}:  20%|██        | 2/10 [00:07<00:24,  3.00s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.5083, 'ndcg@10': 0.8177, 'compress@10': 0.672, 'time@10': 3.5897}:  30%|███       | 3/10 [00:07<00:16,  2.32s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.4979, 'ndcg@10': 0.8352, 'compress@10': 0.6028, 'time@10': 3.532}:  30%|███       | 3/10 [00:10<00:16,  2.32s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.4979, 'ndcg@10': 0.8352, 'compress@10': 0.6028, 'time@10': 3.532}:  40%|████      | 4/10 [00:10<00:16,  2.75s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0213, 'hit_ratio@10': 0.5522, 'ndcg@10': 0.8267, 'compress@10': 0.6715, 'time@10': 4.2207}:  40%|████      | 4/10 [00:14<00:16,  2.75s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0213, 'hit_ratio@10': 0.5522, 'ndcg@10': 0.8267, 'compress@10': 0.6715, 'time@10': 4.2207}:  50%|█████     | 5/10 [00:14<00:15,  3.03s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0223, 'hit_ratio@10': 0.5544, 'ndcg@10': 0.8344, 'compress@10': 0.7115, 'time@10': 4.352}:  50%|█████     | 5/10 [00:19<00:15,  3.03s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0223, 'hit_ratio@10': 0.5544, 'ndcg@10': 0.8344, 'compress@10': 0.7115, 'time@10': 4.352}:  60%|██████    | 6/10 [00:19<00:14,  3.71s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0217, 'hit_ratio@10': 0.5741, 'ndcg@10': 0.8404, 'compress@10': 0.6331, 'time@10': 4.4722}:  60%|██████    | 6/10 [00:21<00:14,  3.71s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0217, 'hit_ratio@10': 0.5741, 'ndcg@10': 0.8404, 'compress@10': 0.6331, 'time@10': 4.4722}:  70%|███████   | 7/10 [00:21<00:10,  3.36s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0211, 'hit_ratio@10': 0.6141, 'ndcg@10': 0.8476, 'compress@10': 0.5715, 'time@10': 4.3909}:  70%|███████   | 7/10 [00:25<00:10,  3.36s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0211, 'hit_ratio@10': 0.6141, 'ndcg@10': 0.8476, 'compress@10': 0.5715, 'time@10': 4.3909}:  80%|████████  | 8/10 [00:25<00:07,  3.52s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.6076, 'ndcg@10': 0.8558, 'compress@10': 0.5433, 'time@10': 4.6918}:  80%|████████  | 8/10 [00:29<00:07,  3.52s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.6076, 'ndcg@10': 0.8558, 'compress@10': 0.5433, 'time@10': 4.6918}:  90%|█████████ | 9/10 [00:29<00:03,  3.54s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.6382, 'ndcg@10': 0.8642, 'compress@10': 0.5482, 'time@10': 4.7374}:  90%|█████████ | 9/10 [00:34<00:03,  3.54s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.6382, 'ndcg@10': 0.8642, 'compress@10': 0.5482, 'time@10': 4.7374}: 100%|██████████| 10/10 [00:34<00:00,  4.05s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.6382, 'ndcg@10': 0.8642, 'compress@10': 0.5482, 'time@10': 4.7374}: 100%|██████████| 10/10 [00:34<00:00,  3.45s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.021915045802159302
Avg hit ratio: 0.6381758395431163
Avg ndcg: 0.864228212581998
Avg compression ratio: 0.5482256326145548
Avg train time: 4.737446284294128
Std train time: 1.364815359909584
[0.767857142857143, 0.8749999999999999, 0.08928571428571427, 0.3392857142857143, 0.9464285714285714, 0.9107142857142856, 0.08928571428571427, 0.08928571428571427, 0.3035714285714286, 0.5892857142857145]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8461, 'compress@10': 0.7911, 'time@10': 4.2284}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8461, 'compress@10': 0.7911, 'time@10': 4.2284}:  10%|█         | 1/10 [00:02<00:19,  2.15s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.5625, 'ndcg@10': 0.8575, 'compress@10': 0.8369, 'time@10': 3.9393}:  10%|█         | 1/10 [00:05<00:19,  2.15s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.5625, 'ndcg@10': 0.8575, 'compress@10': 0.8369, 'time@10': 3.9393}:  20%|██        | 2/10 [00:05<00:24,  3.05s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.5417, 'ndcg@10': 0.8217, 'compress@10': 0.6636, 'time@10': 3.5684}:  20%|██        | 2/10 [00:07<00:24,  3.05s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.5417, 'ndcg@10': 0.8217, 'compress@10': 0.6636, 'time@10': 3.5684}:  30%|███       | 3/10 [00:07<00:16,  2.32s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.5229, 'ndcg@10': 0.8388, 'compress@10': 0.5935, 'time@10': 3.531}:  30%|███       | 3/10 [00:10<00:16,  2.32s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.5229, 'ndcg@10': 0.8388, 'compress@10': 0.5935, 'time@10': 3.531}:  40%|████      | 4/10 [00:10<00:16,  2.77s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.5722, 'ndcg@10': 0.8319, 'compress@10': 0.6645, 'time@10': 4.2126}:  40%|████      | 4/10 [00:14<00:16,  2.77s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.5722, 'ndcg@10': 0.8319, 'compress@10': 0.6645, 'time@10': 4.2126}:  50%|█████     | 5/10 [00:14<00:15,  3.03s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0214, 'hit_ratio@10': 0.571, 'ndcg@10': 0.8454, 'compress@10': 0.7062, 'time@10': 4.3597}:  50%|█████     | 5/10 [00:19<00:15,  3.03s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0214, 'hit_ratio@10': 0.571, 'ndcg@10': 0.8454, 'compress@10': 0.7062, 'time@10': 4.3597}:  60%|██████    | 6/10 [00:19<00:14,  3.75s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0207, 'hit_ratio@10': 0.5883, 'ndcg@10': 0.8502, 'compress@10': 0.6281, 'time@10': 4.5243}:  60%|██████    | 6/10 [00:22<00:14,  3.75s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0207, 'hit_ratio@10': 0.5883, 'ndcg@10': 0.8502, 'compress@10': 0.6281, 'time@10': 4.5243}:  70%|███████   | 7/10 [00:22<00:10,  3.44s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0201, 'hit_ratio@10': 0.6266, 'ndcg@10': 0.8562, 'compress@10': 0.5667, 'time@10': 4.4438}:  70%|███████   | 7/10 [00:26<00:10,  3.44s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0201, 'hit_ratio@10': 0.6266, 'ndcg@10': 0.8562, 'compress@10': 0.5667, 'time@10': 4.4438}:  80%|████████  | 8/10 [00:26<00:07,  3.59s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0197, 'hit_ratio@10': 0.5879, 'ndcg@10': 0.8628, 'compress@10': 0.5418, 'time@10': 4.751}:  80%|████████  | 8/10 [00:29<00:07,  3.59s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0197, 'hit_ratio@10': 0.5879, 'ndcg@10': 0.8628, 'compress@10': 0.5418, 'time@10': 4.751}:  90%|█████████ | 9/10 [00:29<00:03,  3.60s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.6161, 'ndcg@10': 0.8685, 'compress@10': 0.5483, 'time@10': 4.8046}:  90%|█████████ | 9/10 [00:35<00:03,  3.60s/it]  {'epoch': 27, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.6161, 'ndcg@10': 0.8685, 'compress@10': 0.5483, 'time@10': 4.8046}: 100%|██████████| 10/10 [00:35<00:00,  4.14s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.6161, 'ndcg@10': 0.8685, 'compress@10': 0.5483, 'time@10': 4.8046}: 100%|██████████| 10/10 [00:35<00:00,  3.51s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.01968964715724145
Avg hit ratio: 0.6160502356783821
Avg ndcg: 0.8685061421154534
Avg compression ratio: 0.5483215543777883
Avg train time: 4.804592442512512
Std train time: 1.3964862104726519
[0.7758620689655173, 0.8793103448275861, 0.08620689655172413, 0.3275862068965517, 0.9482758620689655, 0.9137931034482757, 0.08620689655172413, 0.08620689655172413, 0.2931034482758621, 0.6034482758620692]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0236, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8499, 'compress@10': 0.7983, 'time@10': 4.2012}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0236, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8499, 'compress@10': 0.7983, 'time@10': 4.2012}:  10%|█         | 1/10 [00:02<00:19,  2.14s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.5125, 'ndcg@10': 0.8614, 'compress@10': 0.8426, 'time@10': 3.8943}:  10%|█         | 1/10 [00:05<00:19,  2.14s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.5125, 'ndcg@10': 0.8614, 'compress@10': 0.8426, 'time@10': 3.8943}:  20%|██        | 2/10 [00:05<00:24,  3.01s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.5083, 'ndcg@10': 0.8242, 'compress@10': 0.6666, 'time@10': 3.5476}:  20%|██        | 2/10 [00:07<00:24,  3.01s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.5083, 'ndcg@10': 0.8242, 'compress@10': 0.6666, 'time@10': 3.5476}:  30%|███       | 3/10 [00:07<00:16,  2.31s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.4979, 'ndcg@10': 0.8407, 'compress@10': 0.593, 'time@10': 3.4913}:  30%|███       | 3/10 [00:10<00:16,  2.31s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.4979, 'ndcg@10': 0.8407, 'compress@10': 0.593, 'time@10': 3.4913}:  40%|████      | 4/10 [00:10<00:16,  2.72s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0193, 'hit_ratio@10': 0.5522, 'ndcg@10': 0.8355, 'compress@10': 0.6645, 'time@10': 4.1989}:  40%|████      | 4/10 [00:14<00:16,  2.72s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0193, 'hit_ratio@10': 0.5522, 'ndcg@10': 0.8355, 'compress@10': 0.6645, 'time@10': 4.1989}:  50%|█████     | 5/10 [00:14<00:15,  3.03s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0201, 'hit_ratio@10': 0.5688, 'ndcg@10': 0.8433, 'compress@10': 0.7067, 'time@10': 4.3582}:  50%|█████     | 5/10 [00:19<00:15,  3.03s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0201, 'hit_ratio@10': 0.5688, 'ndcg@10': 0.8433, 'compress@10': 0.7067, 'time@10': 4.3582}:  60%|██████    | 6/10 [00:19<00:15,  3.76s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.5865, 'ndcg@10': 0.8485, 'compress@10': 0.6281, 'time@10': 4.5351}:  60%|██████    | 6/10 [00:22<00:15,  3.76s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.5865, 'ndcg@10': 0.8485, 'compress@10': 0.6281, 'time@10': 4.5351}:  70%|███████   | 7/10 [00:22<00:10,  3.46s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.625, 'ndcg@10': 0.8547, 'compress@10': 0.5663, 'time@10': 4.4616}:  70%|███████   | 7/10 [00:26<00:10,  3.46s/it]  {'epoch': 28, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.625, 'ndcg@10': 0.8547, 'compress@10': 0.5663, 'time@10': 4.4616}:  80%|████████  | 8/10 [00:26<00:07,  3.63s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.6173, 'ndcg@10': 0.8628, 'compress@10': 0.5404, 'time@10': 4.7622}:  80%|████████  | 8/10 [00:29<00:07,  3.63s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.6173, 'ndcg@10': 0.8628, 'compress@10': 0.5404, 'time@10': 4.7622}:  90%|█████████ | 9/10 [00:29<00:03,  3.63s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.6469, 'ndcg@10': 0.8701, 'compress@10': 0.5484, 'time@10': 4.8184}:  90%|█████████ | 9/10 [00:35<00:03,  3.63s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.6469, 'ndcg@10': 0.8701, 'compress@10': 0.5484, 'time@10': 4.8184}: 100%|██████████| 10/10 [00:35<00:00,  4.17s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.6469, 'ndcg@10': 0.8701, 'compress@10': 0.5484, 'time@10': 4.8184}: 100%|██████████| 10/10 [00:35<00:00,  3.52s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.019253255676790253
Avg hit ratio: 0.6468714917170294
Avg ndcg: 0.8700957174418582
Avg compression ratio: 0.5483849997061243
Avg train time: 4.818362069129944
Std train time: 1.4186731183157166
[0.7833333333333334, 0.8499999999999999, 0.08333333333333333, 0.31666666666666665, 0.95, 0.9166666666666665, 0.08333333333333333, 0.08333333333333333, 0.3166666666666667, 0.6166666666666669]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8499, 'compress@10': 0.805, 'time@10': 4.1766}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8499, 'compress@10': 0.805, 'time@10': 4.1766}:  10%|█         | 1/10 [00:02<00:19,  2.13s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.5312, 'ndcg@10': 0.8614, 'compress@10': 0.8322, 'time@10': 3.8911}:  10%|█         | 1/10 [00:05<00:19,  2.13s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.5312, 'ndcg@10': 0.8614, 'compress@10': 0.8322, 'time@10': 3.8911}:  20%|██        | 2/10 [00:05<00:24,  3.02s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.5208, 'ndcg@10': 0.8242, 'compress@10': 0.659, 'time@10': 3.505}:  20%|██        | 2/10 [00:07<00:24,  3.02s/it]  {'epoch': 29, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.5208, 'ndcg@10': 0.8242, 'compress@10': 0.659, 'time@10': 3.505}:  30%|███       | 3/10 [00:07<00:15,  2.28s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.5073, 'ndcg@10': 0.8415, 'compress@10': 0.5848, 'time@10': 3.4653}:  30%|███       | 3/10 [00:10<00:15,  2.28s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.5073, 'ndcg@10': 0.8415, 'compress@10': 0.5848, 'time@10': 3.4653}:  40%|████      | 4/10 [00:10<00:16,  2.72s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0183, 'hit_ratio@10': 0.552, 'ndcg@10': 0.8361, 'compress@10': 0.6582, 'time@10': 4.153}:  40%|████      | 4/10 [00:14<00:16,  2.72s/it]  {'epoch': 29, 'num_users': 5.8, 'loss': 0.0183, 'hit_ratio@10': 0.552, 'ndcg@10': 0.8361, 'compress@10': 0.6582, 'time@10': 4.153}:  50%|█████     | 5/10 [00:14<00:14,  2.99s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0193, 'hit_ratio@10': 0.5542, 'ndcg@10': 0.8493, 'compress@10': 0.7019, 'time@10': 4.3416}:  50%|█████     | 5/10 [00:19<00:14,  2.99s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0193, 'hit_ratio@10': 0.5542, 'ndcg@10': 0.8493, 'compress@10': 0.7019, 'time@10': 4.3416}:  60%|██████    | 6/10 [00:19<00:15,  3.79s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0187, 'hit_ratio@10': 0.5739, 'ndcg@10': 0.8539, 'compress@10': 0.6236, 'time@10': 4.4862}:  60%|██████    | 6/10 [00:22<00:15,  3.79s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0187, 'hit_ratio@10': 0.5739, 'ndcg@10': 0.8539, 'compress@10': 0.6236, 'time@10': 4.4862}:  70%|███████   | 7/10 [00:22<00:10,  3.44s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.614, 'ndcg@10': 0.8595, 'compress@10': 0.5621, 'time@10': 4.4042}:  70%|███████   | 7/10 [00:25<00:10,  3.44s/it]  {'epoch': 29, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.614, 'ndcg@10': 0.8595, 'compress@10': 0.5621, 'time@10': 4.4042}:  80%|████████  | 8/10 [00:25<00:07,  3.57s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.5705, 'ndcg@10': 0.8661, 'compress@10': 0.539, 'time@10': 4.7115}:  80%|████████  | 8/10 [00:29<00:07,  3.57s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.5705, 'ndcg@10': 0.8661, 'compress@10': 0.539, 'time@10': 4.7115}:  90%|█████████ | 9/10 [00:29<00:03,  3.59s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.6004, 'ndcg@10': 0.872, 'compress@10': 0.5485, 'time@10': 4.7704}:  90%|█████████ | 9/10 [00:34<00:03,  3.59s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.6004, 'ndcg@10': 0.872, 'compress@10': 0.5485, 'time@10': 4.7704}: 100%|██████████| 10/10 [00:34<00:00,  4.13s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.6004, 'ndcg@10': 0.872, 'compress@10': 0.5485, 'time@10': 4.7704}: 100%|██████████| 10/10 [00:34<00:00,  3.49s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.01776602274833109
Avg hit ratio: 0.6003985262766728
Avg ndcg: 0.8720068247477399
Avg compression ratio: 0.548467041198692
Avg train time: 4.770440912246704
Std train time: 1.4132057879093554
[0.7903225806451614, 0.8548387096774193, 0.08064516129032258, 0.3064516129032258, 0.9516129032258064, 0.9193548387096773, 0.08064516129032258, 0.08064516129032258, 0.30645161290322587, 0.6290322580645163]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8499, 'compress@10': 0.8113, 'time@10': 4.2571}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8499, 'compress@10': 0.8113, 'time@10': 4.2571}:  10%|█         | 1/10 [00:02<00:19,  2.16s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.5312, 'ndcg@10': 0.8659, 'compress@10': 0.8376, 'time@10': 3.8397}:  10%|█         | 1/10 [00:05<00:19,  2.16s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.5312, 'ndcg@10': 0.8659, 'compress@10': 0.8376, 'time@10': 3.8397}:  20%|██        | 2/10 [00:05<00:23,  2.93s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.6042, 'ndcg@10': 0.8273, 'compress@10': 0.6619, 'time@10': 3.6145}:  20%|██        | 2/10 [00:07<00:23,  2.93s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.6042, 'ndcg@10': 0.8273, 'compress@10': 0.6619, 'time@10': 3.6145}:  30%|███       | 3/10 [00:07<00:16,  2.33s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.5698, 'ndcg@10': 0.8446, 'compress@10': 0.5846, 'time@10': 3.5296}:  30%|███       | 3/10 [00:10<00:16,  2.33s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.5698, 'ndcg@10': 0.8446, 'compress@10': 0.5846, 'time@10': 3.5296}:  40%|████      | 4/10 [00:10<00:16,  2.72s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.6097, 'ndcg@10': 0.8388, 'compress@10': 0.6584, 'time@10': 4.1545}:  40%|████      | 4/10 [00:13<00:16,  2.72s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.6097, 'ndcg@10': 0.8388, 'compress@10': 0.6584, 'time@10': 4.1545}:  50%|█████     | 5/10 [00:13<00:14,  2.95s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.6168, 'ndcg@10': 0.8472, 'compress@10': 0.7024, 'time@10': 4.3162}:  50%|█████     | 5/10 [00:19<00:14,  2.95s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.6168, 'ndcg@10': 0.8472, 'compress@10': 0.7024, 'time@10': 4.3162}:  60%|██████    | 6/10 [00:19<00:14,  3.70s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.6276, 'ndcg@10': 0.8521, 'compress@10': 0.6237, 'time@10': 4.4559}:  60%|██████    | 6/10 [00:21<00:14,  3.70s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.6276, 'ndcg@10': 0.8521, 'compress@10': 0.6237, 'time@10': 4.4559}:  70%|███████   | 7/10 [00:21<00:10,  3.37s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.661, 'ndcg@10': 0.8583, 'compress@10': 0.5619, 'time@10': 4.3917}:  70%|███████   | 7/10 [00:25<00:10,  3.37s/it]  {'epoch': 30, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.661, 'ndcg@10': 0.8583, 'compress@10': 0.5619, 'time@10': 4.3917}:  80%|████████  | 8/10 [00:25<00:07,  3.56s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.6492, 'ndcg@10': 0.8659, 'compress@10': 0.5378, 'time@10': 4.7335}:  80%|████████  | 8/10 [00:29<00:07,  3.56s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.6492, 'ndcg@10': 0.8659, 'compress@10': 0.5378, 'time@10': 4.7335}:  90%|█████████ | 9/10 [00:29<00:03,  3.63s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.6756, 'ndcg@10': 0.8745, 'compress@10': 0.5485, 'time@10': 4.7913}:  90%|█████████ | 9/10 [00:34<00:03,  3.63s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.6756, 'ndcg@10': 0.8745, 'compress@10': 0.5485, 'time@10': 4.7913}: 100%|██████████| 10/10 [00:34<00:00,  4.16s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.6756, 'ndcg@10': 0.8745, 'compress@10': 0.5485, 'time@10': 4.7913}: 100%|██████████| 10/10 [00:34<00:00,  3.49s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.01817436898529383
Avg hit ratio: 0.6756214917170295
Avg ndcg: 0.8745445835984402
Avg compression ratio: 0.5485218421304333
Avg train time: 4.791341066360474
Std train time: 1.3819804944404133
[0.7968750000000001, 0.8281249999999999, 0.078125, 0.296875, 0.9531249999999999, 0.9218749999999999, 0.078125, 0.078125, 0.32812500000000006, 0.6406250000000002]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8499, 'compress@10': 0.8172, 'time@10': 4.0879}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8499, 'compress@10': 0.8172, 'time@10': 4.0879}:  10%|█         | 1/10 [00:02<00:18,  2.08s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.4813, 'ndcg@10': 0.8659, 'compress@10': 0.828, 'time@10': 3.782}:  10%|█         | 1/10 [00:05<00:18,  2.08s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.4813, 'ndcg@10': 0.8659, 'compress@10': 0.828, 'time@10': 3.782}:  20%|██        | 2/10 [00:05<00:23,  2.92s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.5708, 'ndcg@10': 0.8273, 'compress@10': 0.6549, 'time@10': 3.5081}:  20%|██        | 2/10 [00:07<00:23,  2.92s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.5708, 'ndcg@10': 0.8273, 'compress@10': 0.6549, 'time@10': 3.5081}:  30%|███       | 3/10 [00:07<00:15,  2.28s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.5448, 'ndcg@10': 0.8446, 'compress@10': 0.5771, 'time@10': 3.4559}:  30%|███       | 3/10 [00:10<00:15,  2.28s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.5448, 'ndcg@10': 0.8446, 'compress@10': 0.5771, 'time@10': 3.4559}:  40%|████      | 4/10 [00:10<00:16,  2.71s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.5897, 'ndcg@10': 0.8402, 'compress@10': 0.6527, 'time@10': 4.126}:  40%|████      | 4/10 [00:13<00:16,  2.71s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.5897, 'ndcg@10': 0.8402, 'compress@10': 0.6527, 'time@10': 4.126}:  50%|█████     | 5/10 [00:13<00:14,  2.98s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.5928, 'ndcg@10': 0.8541, 'compress@10': 0.6981, 'time@10': 4.2866}:  50%|█████     | 5/10 [00:19<00:14,  2.98s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.5928, 'ndcg@10': 0.8541, 'compress@10': 0.6981, 'time@10': 4.2866}:  60%|██████    | 6/10 [00:19<00:14,  3.71s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0172, 'hit_ratio@10': 0.5961, 'ndcg@10': 0.8592, 'compress@10': 0.6197, 'time@10': 4.4189}:  60%|██████    | 6/10 [00:21<00:14,  3.71s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0172, 'hit_ratio@10': 0.5961, 'ndcg@10': 0.8592, 'compress@10': 0.6197, 'time@10': 4.4189}:  70%|███████   | 7/10 [00:21<00:10,  3.36s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.6334, 'ndcg@10': 0.8665, 'compress@10': 0.558, 'time@10': 4.3427}:  70%|███████   | 7/10 [00:25<00:10,  3.36s/it]  {'epoch': 31, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.6334, 'ndcg@10': 0.8665, 'compress@10': 0.558, 'time@10': 4.3427}:  80%|████████  | 8/10 [00:25<00:07,  3.51s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.6001, 'ndcg@10': 0.8721, 'compress@10': 0.5366, 'time@10': 4.6829}:  80%|████████  | 8/10 [00:29<00:07,  3.51s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.6001, 'ndcg@10': 0.8721, 'compress@10': 0.5366, 'time@10': 4.6829}:  90%|█████████ | 9/10 [00:29<00:03,  3.58s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.6183, 'ndcg@10': 0.8777, 'compress@10': 0.5486, 'time@10': 4.7358}:  90%|█████████ | 9/10 [00:34<00:03,  3.58s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.6183, 'ndcg@10': 0.8777, 'compress@10': 0.5486, 'time@10': 4.7358}: 100%|██████████| 10/10 [00:34<00:00,  4.10s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.6183, 'ndcg@10': 0.8777, 'compress@10': 0.5486, 'time@10': 4.7358}: 100%|██████████| 10/10 [00:34<00:00,  3.45s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.01666158927174587
Avg hit ratio: 0.6183156574546735
Avg ndcg: 0.8777027505678419
Avg compression ratio: 0.5485954067936184
Avg train time: 4.735779047012329
Std train time: 1.4167370639907841
[0.8030303030303031, 0.8030303030303029, 0.07575757575757576, 0.2878787878787879, 0.9545454545454545, 0.9242424242424241, 0.07575757575757576, 0.07575757575757576, 0.34848484848484856, 0.6515151515151517]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8499, 'compress@10': 0.8227, 'time@10': 4.1712}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8499, 'compress@10': 0.8227, 'time@10': 4.1712}:  10%|█         | 1/10 [00:02<00:19,  2.12s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.4813, 'ndcg@10': 0.8711, 'compress@10': 0.819, 'time@10': 3.8674}:  10%|█         | 1/10 [00:05<00:19,  2.12s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.4813, 'ndcg@10': 0.8711, 'compress@10': 0.819, 'time@10': 3.8674}:  20%|██        | 2/10 [00:05<00:23,  2.99s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.5708, 'ndcg@10': 0.8307, 'compress@10': 0.6483, 'time@10': 3.5867}:  20%|██        | 2/10 [00:07<00:23,  2.99s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.5708, 'ndcg@10': 0.8307, 'compress@10': 0.6483, 'time@10': 3.5867}:  30%|███       | 3/10 [00:07<00:16,  2.33s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.5448, 'ndcg@10': 0.8481, 'compress@10': 0.5701, 'time@10': 3.5062}:  30%|███       | 3/10 [00:10<00:16,  2.33s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.5448, 'ndcg@10': 0.8481, 'compress@10': 0.5701, 'time@10': 3.5062}:  40%|████      | 4/10 [00:10<00:16,  2.72s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.5974, 'ndcg@10': 0.8436, 'compress@10': 0.6473, 'time@10': 4.1457}:  40%|████      | 4/10 [00:13<00:16,  2.72s/it] {'epoch': 32, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.5974, 'ndcg@10': 0.8436, 'compress@10': 0.6473, 'time@10': 4.1457}:  50%|█████     | 5/10 [00:13<00:14,  2.96s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.6138, 'ndcg@10': 0.8552, 'compress@10': 0.694, 'time@10': 4.3}:  50%|█████     | 5/10 [00:19<00:14,  2.96s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.6138, 'ndcg@10': 0.8552, 'compress@10': 0.694, 'time@10': 4.3}:  60%|██████    | 6/10 [00:19<00:14,  3.69s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0161, 'hit_ratio@10': 0.614, 'ndcg@10': 0.8602, 'compress@10': 0.6158, 'time@10': 4.4117}:  60%|██████    | 6/10 [00:21<00:14,  3.69s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0161, 'hit_ratio@10': 0.614, 'ndcg@10': 0.8602, 'compress@10': 0.6158, 'time@10': 4.4117}:  70%|███████   | 7/10 [00:21<00:09,  3.33s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.6491, 'ndcg@10': 0.8676, 'compress@10': 0.5544, 'time@10': 4.3338}:  70%|███████   | 7/10 [00:25<00:09,  3.33s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.6491, 'ndcg@10': 0.8676, 'compress@10': 0.5544, 'time@10': 4.3338}:  80%|████████  | 8/10 [00:25<00:06,  3.49s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.6387, 'ndcg@10': 0.8742, 'compress@10': 0.5356, 'time@10': 4.6519}:  80%|████████  | 8/10 [00:29<00:06,  3.49s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.6387, 'ndcg@10': 0.8742, 'compress@10': 0.5356, 'time@10': 4.6519}:  90%|█████████ | 9/10 [00:29<00:03,  3.53s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.6618, 'ndcg@10': 0.8811, 'compress@10': 0.5487, 'time@10': 4.6969}:  90%|█████████ | 9/10 [00:34<00:03,  3.53s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.6618, 'ndcg@10': 0.8811, 'compress@10': 0.5487, 'time@10': 4.6969}: 100%|██████████| 10/10 [00:34<00:00,  4.03s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.6618, 'ndcg@10': 0.8811, 'compress@10': 0.5487, 'time@10': 4.6969}: 100%|██████████| 10/10 [00:34<00:00,  3.43s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.01641198852065446
Avg hit ratio: 0.6617753378708757
Avg ndcg: 0.8810682010091867
Avg compression ratio: 0.5486648008760673
Avg train time: 4.696853470802307
Std train time: 1.3400728332477556
[0.8088235294117647, 0.7794117647058822, 0.07352941176470588, 0.27941176470588236, 0.9558823529411764, 0.9264705882352939, 0.07352941176470588, 0.07352941176470588, 0.3676470588235295, 0.6617647058823531]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8499, 'compress@10': 0.8279, 'time@10': 4.2402}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8499, 'compress@10': 0.8279, 'time@10': 4.2402}:  10%|█         | 1/10 [00:02<00:19,  2.16s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.4813, 'ndcg@10': 0.8741, 'compress@10': 0.8106, 'time@10': 3.9459}:  10%|█         | 1/10 [00:05<00:19,  2.16s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.4813, 'ndcg@10': 0.8741, 'compress@10': 0.8106, 'time@10': 3.9459}:  20%|██        | 2/10 [00:05<00:24,  3.07s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.4875, 'ndcg@10': 0.8327, 'compress@10': 0.6421, 'time@10': 3.6679}:  20%|██        | 2/10 [00:07<00:24,  3.07s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.4875, 'ndcg@10': 0.8327, 'compress@10': 0.6421, 'time@10': 3.6679}:  30%|███       | 3/10 [00:07<00:16,  2.39s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.4823, 'ndcg@10': 0.8506, 'compress@10': 0.5634, 'time@10': 3.6003}:  30%|███       | 3/10 [00:10<00:16,  2.39s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.4823, 'ndcg@10': 0.8506, 'compress@10': 0.5634, 'time@10': 3.6003}:  40%|████      | 4/10 [00:10<00:16,  2.81s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.5551, 'ndcg@10': 0.8461, 'compress@10': 0.6423, 'time@10': 4.2513}:  40%|████      | 4/10 [00:14<00:16,  2.81s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.5551, 'ndcg@10': 0.8461, 'compress@10': 0.6423, 'time@10': 4.2513}:  50%|█████     | 5/10 [00:14<00:15,  3.05s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0161, 'hit_ratio@10': 0.564, 'ndcg@10': 0.8591, 'compress@10': 0.6902, 'time@10': 4.4274}:  50%|█████     | 5/10 [00:19<00:15,  3.05s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0161, 'hit_ratio@10': 0.564, 'ndcg@10': 0.8591, 'compress@10': 0.6902, 'time@10': 4.4274}:  60%|██████    | 6/10 [00:19<00:15,  3.83s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0156, 'hit_ratio@10': 0.5713, 'ndcg@10': 0.8635, 'compress@10': 0.6123, 'time@10': 4.5518}:  60%|██████    | 6/10 [00:22<00:15,  3.83s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0156, 'hit_ratio@10': 0.5713, 'ndcg@10': 0.8635, 'compress@10': 0.6123, 'time@10': 4.5518}:  70%|███████   | 7/10 [00:22<00:10,  3.45s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.6118, 'ndcg@10': 0.8705, 'compress@10': 0.551, 'time@10': 4.4802}:  70%|███████   | 7/10 [00:26<00:10,  3.45s/it]  {'epoch': 33, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.6118, 'ndcg@10': 0.8705, 'compress@10': 0.551, 'time@10': 4.4802}:  80%|████████  | 8/10 [00:26<00:07,  3.63s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0149, 'hit_ratio@10': 0.5808, 'ndcg@10': 0.876, 'compress@10': 0.5345, 'time@10': 4.784}:  80%|████████  | 8/10 [00:30<00:07,  3.63s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0149, 'hit_ratio@10': 0.5808, 'ndcg@10': 0.876, 'compress@10': 0.5345, 'time@10': 4.784}:  90%|█████████ | 9/10 [00:30<00:03,  3.64s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.6054, 'ndcg@10': 0.8817, 'compress@10': 0.5487, 'time@10': 4.8154}:  90%|█████████ | 9/10 [00:35<00:03,  3.64s/it]  {'epoch': 33, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.6054, 'ndcg@10': 0.8817, 'compress@10': 0.5487, 'time@10': 4.8154}: 100%|██████████| 10/10 [00:35<00:00,  4.10s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.6054, 'ndcg@10': 0.8817, 'compress@10': 0.5487, 'time@10': 4.8154}: 100%|██████████| 10/10 [00:35<00:00,  3.52s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.014983821127890758
Avg hit ratio: 0.6053557912339377
Avg ndcg: 0.8816936468716406
Avg compression ratio: 0.5487294404252472
Avg train time: 4.815381383895874
Std train time: 1.3329833437701668
[0.8142857142857143, 0.7857142857142856, 0.07142857142857142, 0.27142857142857146, 0.9571428571428571, 0.9285714285714284, 0.07142857142857142, 0.07142857142857142, 0.3571428571428572, 0.6714285714285716]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8535, 'compress@10': 0.8328, 'time@10': 4.386}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8535, 'compress@10': 0.8328, 'time@10': 4.386}:  10%|█         | 1/10 [00:02<00:20,  2.23s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.4813, 'ndcg@10': 0.8847, 'compress@10': 0.816, 'time@10': 3.9256}:  10%|█         | 1/10 [00:05<00:20,  2.23s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.4813, 'ndcg@10': 0.8847, 'compress@10': 0.816, 'time@10': 3.9256}:  20%|██        | 2/10 [00:05<00:23,  2.98s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.5708, 'ndcg@10': 0.8398, 'compress@10': 0.6452, 'time@10': 3.5743}:  20%|██        | 2/10 [00:07<00:23,  2.98s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.5708, 'ndcg@10': 0.8398, 'compress@10': 0.6452, 'time@10': 3.5743}:  30%|███       | 3/10 [00:07<00:16,  2.29s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.5615, 'ndcg@10': 0.8558, 'compress@10': 0.5639, 'time@10': 3.4969}:  30%|███       | 3/10 [00:10<00:16,  2.29s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.5615, 'ndcg@10': 0.8558, 'compress@10': 0.5639, 'time@10': 3.4969}:  40%|████      | 4/10 [00:10<00:16,  2.69s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.6184, 'ndcg@10': 0.8515, 'compress@10': 0.6429, 'time@10': 4.2252}:  40%|████      | 4/10 [00:14<00:16,  2.69s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.6184, 'ndcg@10': 0.8515, 'compress@10': 0.6429, 'time@10': 4.2252}:  50%|█████     | 5/10 [00:14<00:15,  3.02s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.6313, 'ndcg@10': 0.863, 'compress@10': 0.691, 'time@10': 4.399}:  50%|█████     | 5/10 [00:19<00:15,  3.02s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.6313, 'ndcg@10': 0.863, 'compress@10': 0.691, 'time@10': 4.399}:  60%|██████    | 6/10 [00:19<00:15,  3.80s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.629, 'ndcg@10': 0.8678, 'compress@10': 0.6127, 'time@10': 4.5517}:  60%|██████    | 6/10 [00:22<00:15,  3.80s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.629, 'ndcg@10': 0.8678, 'compress@10': 0.6127, 'time@10': 4.5517}:  70%|███████   | 7/10 [00:22<00:10,  3.46s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.6622, 'ndcg@10': 0.8742, 'compress@10': 0.5511, 'time@10': 4.4867}:  70%|███████   | 7/10 [00:26<00:10,  3.46s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.6622, 'ndcg@10': 0.8742, 'compress@10': 0.5511, 'time@10': 4.4867}:  80%|████████  | 8/10 [00:26<00:07,  3.66s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0149, 'hit_ratio@10': 0.6504, 'ndcg@10': 0.8801, 'compress@10': 0.5336, 'time@10': 4.7964}:  80%|████████  | 8/10 [00:29<00:07,  3.66s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0149, 'hit_ratio@10': 0.6504, 'ndcg@10': 0.8801, 'compress@10': 0.5336, 'time@10': 4.7964}:  90%|█████████ | 9/10 [00:29<00:03,  3.66s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.6723, 'ndcg@10': 0.8884, 'compress@10': 0.5488, 'time@10': 4.8369}:  90%|█████████ | 9/10 [00:35<00:03,  3.66s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.6723, 'ndcg@10': 0.8884, 'compress@10': 0.5488, 'time@10': 4.8369}: 100%|██████████| 10/10 [00:35<00:00,  4.15s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.6723, 'ndcg@10': 0.8884, 'compress@10': 0.5488, 'time@10': 4.8369}: 100%|██████████| 10/10 [00:35<00:00,  3.52s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.015495962704796255
Avg hit ratio: 0.6722881583836962
Avg ndcg: 0.8884130430379589
Avg compression ratio: 0.5487722978484644
Avg train time: 4.836875700950623
Std train time: 1.449715357879137
[0.8194444444444444, 0.7638888888888887, 0.06944444444444445, 0.26388888888888895, 0.9583333333333333, 0.9305555555555554, 0.06944444444444445, 0.06944444444444445, 0.37500000000000006, 0.6805555555555557]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8535, 'compress@10': 0.8375, 'time@10': 4.179}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8535, 'compress@10': 0.8375, 'time@10': 4.179}:  10%|█         | 1/10 [00:02<00:19,  2.12s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8847, 'compress@10': 0.8081, 'time@10': 3.8991}:  10%|█         | 1/10 [00:05<00:19,  2.12s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8847, 'compress@10': 0.8081, 'time@10': 3.8991}:  20%|██        | 2/10 [00:05<00:24,  3.03s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8398, 'compress@10': 0.6394, 'time@10': 3.5757}:  20%|██        | 2/10 [00:07<00:24,  3.03s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.8398, 'compress@10': 0.6394, 'time@10': 3.5757}:  30%|███       | 3/10 [00:07<00:16,  2.33s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.4833, 'ndcg@10': 0.8572, 'compress@10': 0.5578, 'time@10': 3.497}:  30%|███       | 3/10 [00:10<00:16,  2.33s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.4833, 'ndcg@10': 0.8572, 'compress@10': 0.5578, 'time@10': 3.497}:  40%|████      | 4/10 [00:10<00:16,  2.71s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.5559, 'ndcg@10': 0.8531, 'compress@10': 0.6382, 'time@10': 4.1795}:  40%|████      | 4/10 [00:14<00:16,  2.71s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.5559, 'ndcg@10': 0.8531, 'compress@10': 0.6382, 'time@10': 4.1795}:  50%|█████     | 5/10 [00:14<00:14,  2.99s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.5647, 'ndcg@10': 0.8663, 'compress@10': 0.6874, 'time@10': 4.3608}:  50%|█████     | 5/10 [00:19<00:14,  2.99s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.5647, 'ndcg@10': 0.8663, 'compress@10': 0.6874, 'time@10': 4.3608}:  60%|██████    | 6/10 [00:19<00:15,  3.78s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.5719, 'ndcg@10': 0.8706, 'compress@10': 0.6094, 'time@10': 4.5215}:  60%|██████    | 6/10 [00:22<00:15,  3.78s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.5719, 'ndcg@10': 0.8706, 'compress@10': 0.6094, 'time@10': 4.5215}:  70%|███████   | 7/10 [00:22<00:10,  3.46s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.6123, 'ndcg@10': 0.877, 'compress@10': 0.548, 'time@10': 4.4314}:  70%|███████   | 7/10 [00:26<00:10,  3.46s/it]   {'epoch': 35, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.6123, 'ndcg@10': 0.877, 'compress@10': 0.548, 'time@10': 4.4314}:  80%|████████  | 8/10 [00:26<00:07,  3.58s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.5813, 'ndcg@10': 0.8824, 'compress@10': 0.5327, 'time@10': 4.7323}:  80%|████████  | 8/10 [00:29<00:07,  3.58s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.5813, 'ndcg@10': 0.8824, 'compress@10': 0.5327, 'time@10': 4.7323}:  90%|█████████ | 9/10 [00:29<00:03,  3.59s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.6014, 'ndcg@10': 0.8875, 'compress@10': 0.5488, 'time@10': 4.7846}:  90%|█████████ | 9/10 [00:34<00:03,  3.59s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.6014, 'ndcg@10': 0.8875, 'compress@10': 0.5488, 'time@10': 4.7846}: 100%|██████████| 10/10 [00:34<00:00,  4.11s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.6014, 'ndcg@10': 0.8875, 'compress@10': 0.5488, 'time@10': 4.7846}: 100%|██████████| 10/10 [00:34<00:00,  3.49s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.013921097118019718
Avg hit ratio: 0.6014246318136478
Avg ndcg: 0.8874588302975891
Avg compression ratio: 0.5488295561971789
Avg train time: 4.784643983840942
Std train time: 1.3953370931712936
[0.8243243243243243, 0.7432432432432431, 0.06756756756756757, 0.2567567567567568, 0.9594594594594594, 0.9324324324324322, 0.06756756756756757, 0.06756756756756757, 0.39189189189189194, 0.6891891891891894]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8571, 'compress@10': 0.8419, 'time@10': 4.3658}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8571, 'compress@10': 0.8419, 'time@10': 4.3658}:  10%|█         | 1/10 [00:02<00:19,  2.22s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8865, 'compress@10': 0.8006, 'time@10': 3.9055}:  10%|█         | 1/10 [00:05<00:19,  2.22s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8865, 'compress@10': 0.8006, 'time@10': 3.9055}:  20%|██        | 2/10 [00:05<00:23,  2.96s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.55, 'ndcg@10': 0.841, 'compress@10': 0.6339, 'time@10': 3.5914}:  20%|██        | 2/10 [00:07<00:23,  2.96s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.55, 'ndcg@10': 0.841, 'compress@10': 0.6339, 'time@10': 3.5914}:  30%|███       | 3/10 [00:07<00:16,  2.30s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.5292, 'ndcg@10': 0.8594, 'compress@10': 0.552, 'time@10': 3.5457}:  30%|███       | 3/10 [00:10<00:16,  2.30s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.5292, 'ndcg@10': 0.8594, 'compress@10': 0.552, 'time@10': 3.5457}:  40%|████      | 4/10 [00:10<00:16,  2.75s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0131, 'hit_ratio@10': 0.5926, 'ndcg@10': 0.8548, 'compress@10': 0.6338, 'time@10': 4.1957}:  40%|████      | 4/10 [00:14<00:16,  2.75s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0131, 'hit_ratio@10': 0.5926, 'ndcg@10': 0.8548, 'compress@10': 0.6338, 'time@10': 4.1957}:  50%|█████     | 5/10 [00:14<00:15,  3.00s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.6025, 'ndcg@10': 0.8668, 'compress@10': 0.6841, 'time@10': 4.3532}:  50%|█████     | 5/10 [00:19<00:15,  3.00s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.6025, 'ndcg@10': 0.8668, 'compress@10': 0.6841, 'time@10': 4.3532}:  60%|██████    | 6/10 [00:19<00:14,  3.74s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.6153, 'ndcg@10': 0.871, 'compress@10': 0.6063, 'time@10': 4.4839}:  60%|██████    | 6/10 [00:21<00:14,  3.74s/it] {'epoch': 36, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.6153, 'ndcg@10': 0.871, 'compress@10': 0.6063, 'time@10': 4.4839}:  70%|███████   | 7/10 [00:21<00:10,  3.39s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.6503, 'ndcg@10': 0.8782, 'compress@10': 0.5451, 'time@10': 4.4083}:  70%|███████   | 7/10 [00:25<00:10,  3.39s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.6503, 'ndcg@10': 0.8782, 'compress@10': 0.5451, 'time@10': 4.4083}:  80%|████████  | 8/10 [00:25<00:07,  3.56s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.6397, 'ndcg@10': 0.8843, 'compress@10': 0.5318, 'time@10': 4.7163}:  80%|████████  | 8/10 [00:29<00:07,  3.56s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.6397, 'ndcg@10': 0.8843, 'compress@10': 0.5318, 'time@10': 4.7163}:  90%|█████████ | 9/10 [00:29<00:03,  3.58s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.6627, 'ndcg@10': 0.8907, 'compress@10': 0.5489, 'time@10': 4.7537}:  90%|█████████ | 9/10 [00:34<00:03,  3.58s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.6627, 'ndcg@10': 0.8907, 'compress@10': 0.5489, 'time@10': 4.7537}: 100%|██████████| 10/10 [00:34<00:00,  4.06s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.6627, 'ndcg@10': 0.8907, 'compress@10': 0.5489, 'time@10': 4.7537}: 100%|██████████| 10/10 [00:34<00:00,  3.46s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.013873607894090863
Avg hit ratio: 0.6627159733223806
Avg ndcg: 0.8906692374982204
Avg compression ratio: 0.5488846026507489
Avg train time: 4.753740668296814
Std train time: 1.35003023053356
[0.8289473684210527, 0.7236842105263156, 0.06578947368421054, 0.25000000000000006, 0.9605263157894737, 0.9342105263157893, 0.06578947368421054, 0.06578947368421054, 0.4078947368421053, 0.6973684210526317]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8571, 'compress@10': 0.846, 'time@10': 4.215}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.4, 'ndcg@10': 0.8571, 'compress@10': 0.846, 'time@10': 4.215}:  10%|█         | 1/10 [00:02<00:19,  2.14s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8865, 'compress@10': 0.7935, 'time@10': 3.8534}:  10%|█         | 1/10 [00:05<00:19,  2.14s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.45, 'ndcg@10': 0.8865, 'compress@10': 0.7935, 'time@10': 3.8534}:  20%|██        | 2/10 [00:05<00:23,  2.96s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.841, 'compress@10': 0.6288, 'time@10': 3.5592}:  20%|██        | 2/10 [00:07<00:23,  2.96s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.841, 'compress@10': 0.6288, 'time@10': 3.5592}:  30%|███       | 3/10 [00:07<00:16,  2.30s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.4833, 'ndcg@10': 0.8609, 'compress@10': 0.5466, 'time@10': 3.4994}:  30%|███       | 3/10 [00:10<00:16,  2.30s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.4833, 'ndcg@10': 0.8609, 'compress@10': 0.5466, 'time@10': 3.4994}:  40%|████      | 4/10 [00:10<00:16,  2.72s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.5559, 'ndcg@10': 0.8579, 'compress@10': 0.6297, 'time@10': 4.2333}:  40%|████      | 4/10 [00:14<00:16,  2.72s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.5559, 'ndcg@10': 0.8579, 'compress@10': 0.6297, 'time@10': 4.2333}:  50%|█████     | 5/10 [00:14<00:15,  3.04s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.5575, 'ndcg@10': 0.8706, 'compress@10': 0.6809, 'time@10': 4.406}:  50%|█████     | 5/10 [00:19<00:15,  3.04s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.5575, 'ndcg@10': 0.8706, 'compress@10': 0.6809, 'time@10': 4.406}:  60%|██████    | 6/10 [00:19<00:15,  3.82s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.5767, 'ndcg@10': 0.8743, 'compress@10': 0.6033, 'time@10': 4.4961}:  60%|██████    | 6/10 [00:22<00:15,  3.82s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.5767, 'ndcg@10': 0.8743, 'compress@10': 0.6033, 'time@10': 4.4961}:  70%|███████   | 7/10 [00:22<00:10,  3.41s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.6165, 'ndcg@10': 0.8811, 'compress@10': 0.5423, 'time@10': 4.4173}:  70%|███████   | 7/10 [00:25<00:10,  3.41s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.6165, 'ndcg@10': 0.8811, 'compress@10': 0.5423, 'time@10': 4.4173}:  80%|████████  | 8/10 [00:25<00:07,  3.56s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.5788, 'ndcg@10': 0.8865, 'compress@10': 0.531, 'time@10': 4.7612}:  80%|████████  | 8/10 [00:29<00:07,  3.56s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.5788, 'ndcg@10': 0.8865, 'compress@10': 0.531, 'time@10': 4.7612}:  90%|█████████ | 9/10 [00:29<00:03,  3.64s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.6036, 'ndcg@10': 0.8923, 'compress@10': 0.5489, 'time@10': 4.8073}:  90%|█████████ | 9/10 [00:35<00:03,  3.64s/it]  {'epoch': 37, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.6036, 'ndcg@10': 0.8923, 'compress@10': 0.5489, 'time@10': 4.8073}: 100%|██████████| 10/10 [00:35<00:00,  4.14s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.6036, 'ndcg@10': 0.8923, 'compress@10': 0.5489, 'time@10': 4.8073}: 100%|██████████| 10/10 [00:35<00:00,  3.50s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.012638970309164
Avg hit ratio: 0.6035613839503999
Avg ndcg: 0.8923400584814243
Avg compression ratio: 0.5489355162442561
Avg train time: 4.807313227653504
Std train time: 1.479457678354536
[0.8333333333333334, 0.705128205128205, 0.06410256410256411, 0.24358974358974364, 0.9615384615384616, 0.9358974358974357, 0.06410256410256411, 0.06410256410256411, 0.42307692307692313, 0.7051282051282053]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8653, 'compress@10': 0.85, 'time@10': 4.1926}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8653, 'compress@10': 0.85, 'time@10': 4.1926}:  10%|█         | 1/10 [00:02<00:19,  2.13s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8906, 'compress@10': 0.7868, 'time@10': 3.8669}:  10%|█         | 1/10 [00:05<00:19,  2.13s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8906, 'compress@10': 0.7868, 'time@10': 3.8669}:  20%|██        | 2/10 [00:05<00:23,  2.98s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.5833, 'ndcg@10': 0.8437, 'compress@10': 0.6239, 'time@10': 3.6189}:  20%|██        | 2/10 [00:07<00:23,  2.98s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.5833, 'ndcg@10': 0.8437, 'compress@10': 0.6239, 'time@10': 3.6189}:  30%|███       | 3/10 [00:07<00:16,  2.35s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.5542, 'ndcg@10': 0.863, 'compress@10': 0.5414, 'time@10': 3.549}:  30%|███       | 3/10 [00:10<00:16,  2.35s/it]  {'epoch': 38, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.5542, 'ndcg@10': 0.863, 'compress@10': 0.5414, 'time@10': 3.549}:  40%|████      | 4/10 [00:10<00:16,  2.76s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.6126, 'ndcg@10': 0.8599, 'compress@10': 0.6257, 'time@10': 4.2128}:  40%|████      | 4/10 [00:14<00:16,  2.76s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.6126, 'ndcg@10': 0.8599, 'compress@10': 0.6257, 'time@10': 4.2128}:  50%|█████     | 5/10 [00:14<00:15,  3.01s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0126, 'hit_ratio@10': 0.6119, 'ndcg@10': 0.8713, 'compress@10': 0.6779, 'time@10': 4.3607}:  50%|█████     | 5/10 [00:19<00:15,  3.01s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0126, 'hit_ratio@10': 0.6119, 'ndcg@10': 0.8713, 'compress@10': 0.6779, 'time@10': 4.3607}:  60%|██████    | 6/10 [00:19<00:14,  3.74s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0123, 'hit_ratio@10': 0.6234, 'ndcg@10': 0.8749, 'compress@10': 0.6005, 'time@10': 4.5158}:  60%|██████    | 6/10 [00:22<00:14,  3.74s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0123, 'hit_ratio@10': 0.6234, 'ndcg@10': 0.8749, 'compress@10': 0.6005, 'time@10': 4.5158}:  70%|███████   | 7/10 [00:22<00:10,  3.42s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.6573, 'ndcg@10': 0.8816, 'compress@10': 0.5396, 'time@10': 4.4422}:  70%|███████   | 7/10 [00:26<00:10,  3.42s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.6573, 'ndcg@10': 0.8816, 'compress@10': 0.5396, 'time@10': 4.4422}:  80%|████████  | 8/10 [00:26<00:07,  3.59s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.646, 'ndcg@10': 0.8874, 'compress@10': 0.5302, 'time@10': 4.7452}:  80%|████████  | 8/10 [00:29<00:07,  3.59s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.646, 'ndcg@10': 0.8874, 'compress@10': 0.5302, 'time@10': 4.7452}:  90%|█████████ | 9/10 [00:29<00:03,  3.60s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.664, 'ndcg@10': 0.8959, 'compress@10': 0.549, 'time@10': 4.7794}:  90%|█████████ | 9/10 [00:34<00:03,  3.60s/it]    {'epoch': 38, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.664, 'ndcg@10': 0.8959, 'compress@10': 0.549, 'time@10': 4.7794}: 100%|██████████| 10/10 [00:34<00:00,  4.07s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.664, 'ndcg@10': 0.8959, 'compress@10': 0.549, 'time@10': 4.7794}: 100%|██████████| 10/10 [00:34<00:00,  3.48s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.013644513132089031
Avg hit ratio: 0.6640203211484675
Avg ndcg: 0.8959225005557387
Avg compression ratio: 0.5489856664668754
Avg train time: 4.779447627067566
Std train time: 1.346728524944514
[0.8375, 0.6874999999999998, 0.06250000000000001, 0.23750000000000004, 0.9625, 0.9374999999999998, 0.06250000000000001, 0.06250000000000001, 0.43750000000000006, 0.7125000000000001]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8653, 'compress@10': 0.8537, 'time@10': 4.4052}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8653, 'compress@10': 0.8537, 'time@10': 4.4052}:  10%|█         | 1/10 [00:02<00:20,  2.24s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.5312, 'ndcg@10': 0.8924, 'compress@10': 0.7804, 'time@10': 4.0987}:  10%|█         | 1/10 [00:06<00:20,  2.24s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.5312, 'ndcg@10': 0.8924, 'compress@10': 0.7804, 'time@10': 4.0987}:  20%|██        | 2/10 [00:06<00:25,  3.17s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.5208, 'ndcg@10': 0.8449, 'compress@10': 0.6192, 'time@10': 3.7451}:  20%|██        | 2/10 [00:07<00:25,  3.17s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.5208, 'ndcg@10': 0.8449, 'compress@10': 0.6192, 'time@10': 3.7451}:  30%|███       | 3/10 [00:07<00:17,  2.43s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.524, 'ndcg@10': 0.8638, 'compress@10': 0.5365, 'time@10': 3.6479}:  30%|███       | 3/10 [00:11<00:17,  2.43s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.524, 'ndcg@10': 0.8638, 'compress@10': 0.5365, 'time@10': 3.6479}:  40%|████      | 4/10 [00:11<00:16,  2.81s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.5884, 'ndcg@10': 0.8616, 'compress@10': 0.622, 'time@10': 4.3201}:  40%|████      | 4/10 [00:14<00:16,  2.81s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.5884, 'ndcg@10': 0.8616, 'compress@10': 0.622, 'time@10': 4.3201}:  50%|█████     | 5/10 [00:14<00:15,  3.08s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0121, 'hit_ratio@10': 0.5845, 'ndcg@10': 0.8754, 'compress@10': 0.675, 'time@10': 4.474}:  50%|█████     | 5/10 [00:19<00:15,  3.08s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0121, 'hit_ratio@10': 0.5845, 'ndcg@10': 0.8754, 'compress@10': 0.675, 'time@10': 4.474}:  60%|██████    | 6/10 [00:19<00:15,  3.83s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.5999, 'ndcg@10': 0.8784, 'compress@10': 0.5978, 'time@10': 4.5863}:  60%|██████    | 6/10 [00:22<00:15,  3.83s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.5999, 'ndcg@10': 0.8784, 'compress@10': 0.5978, 'time@10': 4.5863}:  70%|███████   | 7/10 [00:22<00:10,  3.45s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.6368, 'ndcg@10': 0.8846, 'compress@10': 0.5371, 'time@10': 4.5007}:  70%|███████   | 7/10 [00:26<00:10,  3.45s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.6368, 'ndcg@10': 0.8846, 'compress@10': 0.5371, 'time@10': 4.5007}:  80%|████████  | 8/10 [00:26<00:07,  3.60s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.5969, 'ndcg@10': 0.8896, 'compress@10': 0.5295, 'time@10': 4.8217}:  80%|████████  | 8/10 [00:30<00:07,  3.60s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.5969, 'ndcg@10': 0.8896, 'compress@10': 0.5295, 'time@10': 4.8217}:  90%|█████████ | 9/10 [00:30<00:03,  3.64s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.6155, 'ndcg@10': 0.8947, 'compress@10': 0.549, 'time@10': 4.8497}:  90%|█████████ | 9/10 [00:35<00:03,  3.64s/it]    {'epoch': 39, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.6155, 'ndcg@10': 0.8947, 'compress@10': 0.549, 'time@10': 4.8497}: 100%|██████████| 10/10 [00:35<00:00,  4.11s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.6155, 'ndcg@10': 0.8947, 'compress@10': 0.549, 'time@10': 4.8497}: 100%|██████████| 10/10 [00:35<00:00,  3.53s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.01162277180408922
Avg hit ratio: 0.6154635578634434
Avg ndcg: 0.8946552989472952
Avg compression ratio: 0.5490307979446203
Avg train time: 4.8497111082077025
Std train time: 1.386644242341082
[0.8414634146341463, 0.670731707317073, 0.060975609756097573, 0.23170731707317077, 0.9634146341463414, 0.9390243902439023, 0.060975609756097573, 0.060975609756097573, 0.451219512195122, 0.7195121951219513]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8685, 'compress@10': 0.8573, 'time@10': 4.3262}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8685, 'compress@10': 0.8573, 'time@10': 4.3262}:  10%|█         | 1/10 [00:02<00:19,  2.20s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.5312, 'ndcg@10': 0.8976, 'compress@10': 0.7743, 'time@10': 3.933}:  10%|█         | 1/10 [00:05<00:19,  2.20s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.5312, 'ndcg@10': 0.8976, 'compress@10': 0.7743, 'time@10': 3.933}:  20%|██        | 2/10 [00:05<00:24,  3.01s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.6042, 'ndcg@10': 0.8484, 'compress@10': 0.6148, 'time@10': 3.6142}:  20%|██        | 2/10 [00:07<00:24,  3.01s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.6042, 'ndcg@10': 0.8484, 'compress@10': 0.6148, 'time@10': 3.6142}:  30%|███       | 3/10 [00:07<00:16,  2.33s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.6031, 'ndcg@10': 0.8664, 'compress@10': 0.5318, 'time@10': 3.527}:  30%|███       | 3/10 [00:10<00:16,  2.33s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.6031, 'ndcg@10': 0.8664, 'compress@10': 0.5318, 'time@10': 3.527}:  40%|████      | 4/10 [00:10<00:16,  2.72s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.6517, 'ndcg@10': 0.8644, 'compress@10': 0.6184, 'time@10': 4.2022}:  40%|████      | 4/10 [00:14<00:16,  2.72s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.6517, 'ndcg@10': 0.8644, 'compress@10': 0.6184, 'time@10': 4.2022}:  50%|█████     | 5/10 [00:14<00:14,  2.99s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.6373, 'ndcg@10': 0.8759, 'compress@10': 0.6723, 'time@10': 4.3651}:  50%|█████     | 5/10 [00:19<00:14,  2.99s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.6373, 'ndcg@10': 0.8759, 'compress@10': 0.6723, 'time@10': 4.3651}:  60%|██████    | 6/10 [00:19<00:14,  3.75s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.6342, 'ndcg@10': 0.8789, 'compress@10': 0.5953, 'time@10': 4.5019}:  60%|██████    | 6/10 [00:22<00:14,  3.75s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.6342, 'ndcg@10': 0.8789, 'compress@10': 0.5953, 'time@10': 4.5019}:  70%|███████   | 7/10 [00:22<00:10,  3.41s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.6667, 'ndcg@10': 0.8851, 'compress@10': 0.5347, 'time@10': 4.4397}:  70%|███████   | 7/10 [00:26<00:10,  3.41s/it]  {'epoch': 40, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.6667, 'ndcg@10': 0.8851, 'compress@10': 0.5347, 'time@10': 4.4397}:  80%|████████  | 8/10 [00:26<00:07,  3.61s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.6482, 'ndcg@10': 0.8904, 'compress@10': 0.5288, 'time@10': 4.7415}:  80%|████████  | 8/10 [00:29<00:07,  3.61s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.6482, 'ndcg@10': 0.8904, 'compress@10': 0.5288, 'time@10': 4.7415}:  90%|█████████ | 9/10 [00:29<00:03,  3.61s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.666, 'ndcg@10': 0.8963, 'compress@10': 0.5491, 'time@10': 4.7945}:  90%|█████████ | 9/10 [00:34<00:03,  3.61s/it]    {'epoch': 40, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.666, 'ndcg@10': 0.8963, 'compress@10': 0.5491, 'time@10': 4.7945}: 100%|██████████| 10/10 [00:34<00:00,  4.13s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.666, 'ndcg@10': 0.8963, 'compress@10': 0.5491, 'time@10': 4.7945}: 100%|██████████| 10/10 [00:34<00:00,  3.50s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.01184843276238657
Avg hit ratio: 0.6660079651469812
Avg ndcg: 0.8963335165251513
Avg compression ratio: 0.5490763765000664
Avg train time: 4.7944557666778564
Std train time: 1.3687854017746797
[0.8452380952380952, 0.6547619047619045, 0.059523809523809534, 0.22619047619047622, 0.9642857142857143, 0.9404761904761904, 0.059523809523809534, 0.059523809523809534, 0.46428571428571436, 0.7261904761904763]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8685, 'compress@10': 0.8607, 'time@10': 4.3119}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8685, 'compress@10': 0.8607, 'time@10': 4.3119}:  10%|█         | 1/10 [00:02<00:19,  2.19s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.5312, 'ndcg@10': 0.8976, 'compress@10': 0.7685, 'time@10': 3.9591}:  10%|█         | 1/10 [00:05<00:19,  2.19s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.5312, 'ndcg@10': 0.8976, 'compress@10': 0.7685, 'time@10': 3.9591}:  20%|██        | 2/10 [00:05<00:24,  3.05s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.5208, 'ndcg@10': 0.8484, 'compress@10': 0.6106, 'time@10': 3.6482}:  20%|██        | 2/10 [00:07<00:24,  3.05s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.5208, 'ndcg@10': 0.8484, 'compress@10': 0.6106, 'time@10': 3.6482}:  30%|███       | 3/10 [00:07<00:16,  2.36s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.5573, 'ndcg@10': 0.8676, 'compress@10': 0.5274, 'time@10': 3.5593}:  30%|███       | 3/10 [00:10<00:16,  2.36s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.5573, 'ndcg@10': 0.8676, 'compress@10': 0.5274, 'time@10': 3.5593}:  40%|████      | 4/10 [00:10<00:16,  2.75s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.6151, 'ndcg@10': 0.8681, 'compress@10': 0.615, 'time@10': 4.214}:  40%|████      | 4/10 [00:14<00:16,  2.75s/it]  {'epoch': 41, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.6151, 'ndcg@10': 0.8681, 'compress@10': 0.615, 'time@10': 4.214}:  50%|█████     | 5/10 [00:14<00:15,  3.00s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.614, 'ndcg@10': 0.8813, 'compress@10': 0.6697, 'time@10': 4.3803}:  50%|█████     | 5/10 [00:19<00:15,  3.00s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.614, 'ndcg@10': 0.8813, 'compress@10': 0.6697, 'time@10': 4.3803}:  60%|██████    | 6/10 [00:19<00:15,  3.76s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.6142, 'ndcg@10': 0.8847, 'compress@10': 0.5929, 'time@10': 4.5075}:  60%|██████    | 6/10 [00:22<00:15,  3.76s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.6142, 'ndcg@10': 0.8847, 'compress@10': 0.5929, 'time@10': 4.5075}:  70%|███████   | 7/10 [00:22<00:10,  3.42s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.6493, 'ndcg@10': 0.8902, 'compress@10': 0.5324, 'time@10': 4.4398}:  70%|███████   | 7/10 [00:26<00:10,  3.42s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.6493, 'ndcg@10': 0.8902, 'compress@10': 0.5324, 'time@10': 4.4398}:  80%|████████  | 8/10 [00:26<00:07,  3.60s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.608, 'ndcg@10': 0.8946, 'compress@10': 0.5281, 'time@10': 4.7482}:  80%|████████  | 8/10 [00:29<00:07,  3.60s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.608, 'ndcg@10': 0.8946, 'compress@10': 0.5281, 'time@10': 4.7482}:  90%|█████████ | 9/10 [00:29<00:03,  3.62s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.6211, 'ndcg@10': 0.8999, 'compress@10': 0.5491, 'time@10': 4.7875}:  90%|█████████ | 9/10 [00:34<00:03,  3.62s/it]  {'epoch': 41, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.6211, 'ndcg@10': 0.8999, 'compress@10': 0.5491, 'time@10': 4.7875}: 100%|██████████| 10/10 [00:34<00:00,  4.10s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.6211, 'ndcg@10': 0.8999, 'compress@10': 0.5491, 'time@10': 4.7875}: 100%|██████████| 10/10 [00:34<00:00,  3.49s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.010766898806470802
Avg hit ratio: 0.6211045835044691
Avg ndcg: 0.899927000866273
Avg compression ratio: 0.5491191773715106
Avg train time: 4.7874915599823
Std train time: 1.3508196641887276
[0.8488372093023255, 0.63953488372093, 0.05813953488372094, 0.22093023255813957, 0.9651162790697675, 0.941860465116279, 0.05813953488372094, 0.05813953488372094, 0.4767441860465117, 0.7325581395348838]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8685, 'compress@10': 0.8639, 'time@10': 4.2806}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8685, 'compress@10': 0.8639, 'time@10': 4.2806}:  10%|█         | 1/10 [00:02<00:19,  2.17s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8976, 'compress@10': 0.763, 'time@10': 3.9658}:  10%|█         | 1/10 [00:05<00:19,  2.17s/it] {'epoch': 42, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8976, 'compress@10': 0.763, 'time@10': 3.9658}:  20%|██        | 2/10 [00:05<00:24,  3.07s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8484, 'compress@10': 0.6065, 'time@10': 3.6277}:  20%|██        | 2/10 [00:07<00:24,  3.07s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8484, 'compress@10': 0.6065, 'time@10': 3.6277}:  30%|███       | 3/10 [00:07<00:16,  2.36s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.5583, 'ndcg@10': 0.8684, 'compress@10': 0.5231, 'time@10': 3.5222}:  30%|███       | 3/10 [00:10<00:16,  2.36s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.5583, 'ndcg@10': 0.8684, 'compress@10': 0.5231, 'time@10': 3.5222}:  40%|████      | 4/10 [00:10<00:16,  2.71s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.6082, 'ndcg@10': 0.8684, 'compress@10': 0.6118, 'time@10': 4.2157}:  40%|████      | 4/10 [00:14<00:16,  2.71s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.6082, 'ndcg@10': 0.8684, 'compress@10': 0.6118, 'time@10': 4.2157}:  50%|█████     | 5/10 [00:14<00:15,  3.00s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.601, 'ndcg@10': 0.8798, 'compress@10': 0.6672, 'time@10': 4.3853}:  50%|█████     | 5/10 [00:19<00:15,  3.00s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.601, 'ndcg@10': 0.8798, 'compress@10': 0.6672, 'time@10': 4.3853}:  60%|██████    | 6/10 [00:19<00:15,  3.77s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.6031, 'ndcg@10': 0.8835, 'compress@10': 0.5906, 'time@10': 4.5295}:  60%|██████    | 6/10 [00:22<00:15,  3.77s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.6031, 'ndcg@10': 0.8835, 'compress@10': 0.5906, 'time@10': 4.5295}:  70%|███████   | 7/10 [00:22<00:10,  3.44s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0101, 'hit_ratio@10': 0.6395, 'ndcg@10': 0.8894, 'compress@10': 0.5302, 'time@10': 4.4454}:  70%|███████   | 7/10 [00:26<00:10,  3.44s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0101, 'hit_ratio@10': 0.6395, 'ndcg@10': 0.8894, 'compress@10': 0.5302, 'time@10': 4.4454}:  80%|████████  | 8/10 [00:26<00:07,  3.58s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.624, 'ndcg@10': 0.8945, 'compress@10': 0.5275, 'time@10': 4.798}:  80%|████████  | 8/10 [00:29<00:07,  3.58s/it] {'epoch': 42, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.624, 'ndcg@10': 0.8945, 'compress@10': 0.5275, 'time@10': 4.798}:  90%|█████████ | 9/10 [00:29<00:03,  3.66s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.6442, 'ndcg@10': 0.9014, 'compress@10': 0.5492, 'time@10': 4.8497}:  90%|█████████ | 9/10 [00:35<00:03,  3.66s/it] {'epoch': 42, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.6442, 'ndcg@10': 0.9014, 'compress@10': 0.5492, 'time@10': 4.8497}: 100%|██████████| 10/10 [00:35<00:00,  4.19s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.6442, 'ndcg@10': 0.9014, 'compress@10': 0.5492, 'time@10': 4.8497}: 100%|██████████| 10/10 [00:35<00:00,  3.53s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.011900411814782014
Avg hit ratio: 0.6442451446341606
Avg ndcg: 0.9014095703350774
Avg compression ratio: 0.54915980355201
Avg train time: 4.849748253822327
Std train time: 1.482006088536056
[0.8522727272727272, 0.6249999999999998, 0.05681818181818183, 0.21590909090909094, 0.9659090909090909, 0.9431818181818181, 0.05681818181818183, 0.05681818181818183, 0.4886363636363637, 0.7386363636363638]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8685, 'compress@10': 0.867, 'time@10': 4.4642}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8685, 'compress@10': 0.867, 'time@10': 4.4642}:  10%|█         | 1/10 [00:02<00:20,  2.28s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8986, 'compress@10': 0.7577, 'time@10': 4.0561}:  10%|█         | 1/10 [00:05<00:20,  2.28s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8986, 'compress@10': 0.7577, 'time@10': 4.0561}:  20%|██        | 2/10 [00:05<00:24,  3.11s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8491, 'compress@10': 0.6027, 'time@10': 3.6514}:  20%|██        | 2/10 [00:07<00:24,  3.11s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8491, 'compress@10': 0.6027, 'time@10': 3.6514}:  30%|███       | 3/10 [00:07<00:16,  2.36s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.5583, 'ndcg@10': 0.8689, 'compress@10': 0.5191, 'time@10': 3.556}:  30%|███       | 3/10 [00:10<00:16,  2.36s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.5583, 'ndcg@10': 0.8689, 'compress@10': 0.5191, 'time@10': 3.556}:  40%|████      | 4/10 [00:10<00:16,  2.74s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.6082, 'ndcg@10': 0.8712, 'compress@10': 0.6087, 'time@10': 4.2401}:  40%|████      | 4/10 [00:14<00:16,  2.74s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.6082, 'ndcg@10': 0.8712, 'compress@10': 0.6087, 'time@10': 4.2401}:  50%|█████     | 5/10 [00:14<00:15,  3.02s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0101, 'hit_ratio@10': 0.601, 'ndcg@10': 0.8839, 'compress@10': 0.6649, 'time@10': 4.3933}:  50%|█████     | 5/10 [00:19<00:15,  3.02s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0101, 'hit_ratio@10': 0.601, 'ndcg@10': 0.8839, 'compress@10': 0.6649, 'time@10': 4.3933}:  60%|██████    | 6/10 [00:19<00:15,  3.76s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.6141, 'ndcg@10': 0.887, 'compress@10': 0.5884, 'time@10': 4.5108}:  60%|██████    | 6/10 [00:22<00:15,  3.76s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.6141, 'ndcg@10': 0.887, 'compress@10': 0.5884, 'time@10': 4.5108}:  70%|███████   | 7/10 [00:22<00:10,  3.39s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.6492, 'ndcg@10': 0.8924, 'compress@10': 0.5281, 'time@10': 4.4472}:  70%|███████   | 7/10 [00:26<00:10,  3.39s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.6492, 'ndcg@10': 0.8924, 'compress@10': 0.5281, 'time@10': 4.4472}:  80%|████████  | 8/10 [00:26<00:07,  3.60s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.6264, 'ndcg@10': 0.8966, 'compress@10': 0.5269, 'time@10': 4.7748}:  80%|████████  | 8/10 [00:29<00:07,  3.60s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.6264, 'ndcg@10': 0.8966, 'compress@10': 0.5269, 'time@10': 4.7748}:  90%|█████████ | 9/10 [00:29<00:03,  3.64s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0098, 'hit_ratio@10': 0.6377, 'ndcg@10': 0.9017, 'compress@10': 0.5492, 'time@10': 4.8213}:  90%|█████████ | 9/10 [00:35<00:03,  3.64s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0098, 'hit_ratio@10': 0.6377, 'ndcg@10': 0.9017, 'compress@10': 0.5492, 'time@10': 4.8213}: 100%|██████████| 10/10 [00:35<00:00,  4.15s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0098, 'hit_ratio@10': 0.6377, 'ndcg@10': 0.9017, 'compress@10': 0.5492, 'time@10': 4.8213}: 100%|██████████| 10/10 [00:35<00:00,  3.52s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.009824326995532656
Avg hit ratio: 0.6376862445969997
Avg ndcg: 0.9017043156498321
Avg compression ratio: 0.5491990525445327
Avg train time: 4.821286535263061
Std train time: 1.4218734451178456
[0.8555555555555555, 0.6111111111111109, 0.055555555555555566, 0.21111111111111114, 0.9666666666666667, 0.9444444444444444, 0.055555555555555566, 0.07777777777777779, 0.47777777777777786, 0.7444444444444446]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8685, 'compress@10': 0.87, 'time@10': 4.3273}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8685, 'compress@10': 0.87, 'time@10': 4.3273}:  10%|█         | 1/10 [00:02<00:19,  2.20s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8997, 'compress@10': 0.7527, 'time@10': 4.0263}:  10%|█         | 1/10 [00:05<00:19,  2.20s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8997, 'compress@10': 0.7527, 'time@10': 4.0263}:  20%|██        | 2/10 [00:05<00:24,  3.12s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8498, 'compress@10': 0.599, 'time@10': 3.6919}:  20%|██        | 2/10 [00:07<00:24,  3.12s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8498, 'compress@10': 0.599, 'time@10': 3.6919}:  30%|███       | 3/10 [00:07<00:16,  2.40s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.525, 'ndcg@10': 0.8694, 'compress@10': 0.5152, 'time@10': 3.5919}:  30%|███       | 3/10 [00:10<00:16,  2.40s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.525, 'ndcg@10': 0.8694, 'compress@10': 0.5152, 'time@10': 3.5919}:  40%|████      | 4/10 [00:10<00:16,  2.77s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.5815, 'ndcg@10': 0.8705, 'compress@10': 0.6057, 'time@10': 4.2464}:  40%|████      | 4/10 [00:14<00:16,  2.77s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.5815, 'ndcg@10': 0.8705, 'compress@10': 0.6057, 'time@10': 4.2464}:  50%|█████     | 5/10 [00:14<00:15,  3.02s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.5861, 'ndcg@10': 0.8815, 'compress@10': 0.6626, 'time@10': 4.359}:  50%|█████     | 5/10 [00:19<00:15,  3.02s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.5861, 'ndcg@10': 0.8815, 'compress@10': 0.6626, 'time@10': 4.359}:  60%|██████    | 6/10 [00:19<00:14,  3.68s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.5903, 'ndcg@10': 0.885, 'compress@10': 0.5863, 'time@10': 4.4998}:  60%|██████    | 6/10 [00:21<00:14,  3.68s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.5903, 'ndcg@10': 0.885, 'compress@10': 0.5863, 'time@10': 4.4998}:  70%|███████   | 7/10 [00:21<00:10,  3.36s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.6283, 'ndcg@10': 0.8911, 'compress@10': 0.5288, 'time@10': 4.4187}:  70%|███████   | 7/10 [00:25<00:10,  3.36s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.6283, 'ndcg@10': 0.8911, 'compress@10': 0.5288, 'time@10': 4.4187}:  80%|████████  | 8/10 [00:25<00:07,  3.53s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.6141, 'ndcg@10': 0.8964, 'compress@10': 0.5263, 'time@10': 4.7733}:  80%|████████  | 8/10 [00:29<00:07,  3.53s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.6141, 'ndcg@10': 0.8964, 'compress@10': 0.5263, 'time@10': 4.7733}:  90%|█████████ | 9/10 [00:29<00:03,  3.63s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.6353, 'ndcg@10': 0.9019, 'compress@10': 0.5492, 'time@10': 4.8059}:  90%|█████████ | 9/10 [00:34<00:03,  3.63s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.6353, 'ndcg@10': 0.9019, 'compress@10': 0.5492, 'time@10': 4.8059}: 100%|██████████| 10/10 [00:34<00:00,  4.09s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.6353, 'ndcg@10': 0.9019, 'compress@10': 0.5492, 'time@10': 4.8059}: 100%|██████████| 10/10 [00:34<00:00,  3.49s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.010255032890242089
Avg hit ratio: 0.6352596373877838
Avg ndcg: 0.9018539670128737
Avg compression ratio: 0.5492435451616647
Avg train time: 4.8058559656143185
Std train time: 1.423734569991611
[0.858695652173913, 0.5978260869565216, 0.054347826086956534, 0.2065217391304348, 0.967391304347826, 0.9456521739130435, 0.054347826086956534, 0.07608695652173915, 0.48913043478260876, 0.7500000000000001]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8685, 'compress@10': 0.8728, 'time@10': 4.2681}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8685, 'compress@10': 0.8728, 'time@10': 4.2681}:  10%|█         | 1/10 [00:02<00:19,  2.17s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.4688, 'ndcg@10': 0.8997, 'compress@10': 0.7479, 'time@10': 3.9961}:  10%|█         | 1/10 [00:05<00:19,  2.17s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.4688, 'ndcg@10': 0.8997, 'compress@10': 0.7479, 'time@10': 3.9961}:  20%|██        | 2/10 [00:05<00:24,  3.11s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.4792, 'ndcg@10': 0.8498, 'compress@10': 0.5955, 'time@10': 3.6206}:  20%|██        | 2/10 [00:07<00:24,  3.11s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.4792, 'ndcg@10': 0.8498, 'compress@10': 0.5955, 'time@10': 3.6206}:  30%|███       | 3/10 [00:07<00:16,  2.36s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.5094, 'ndcg@10': 0.8694, 'compress@10': 0.5115, 'time@10': 3.5147}:  30%|███       | 3/10 [00:10<00:16,  2.36s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.5094, 'ndcg@10': 0.8694, 'compress@10': 0.5115, 'time@10': 3.5147}:  40%|████      | 4/10 [00:10<00:16,  2.70s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0084, 'hit_ratio@10': 0.569, 'ndcg@10': 0.8711, 'compress@10': 0.6029, 'time@10': 4.2339}:  40%|████      | 4/10 [00:14<00:16,  2.70s/it] {'epoch': 45, 'num_users': 5.8, 'loss': 0.0084, 'hit_ratio@10': 0.569, 'ndcg@10': 0.8711, 'compress@10': 0.6029, 'time@10': 4.2339}:  50%|█████     | 5/10 [00:14<00:15,  3.02s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.5756, 'ndcg@10': 0.8842, 'compress@10': 0.6604, 'time@10': 4.3942}:  50%|█████     | 5/10 [00:19<00:15,  3.02s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.5756, 'ndcg@10': 0.8842, 'compress@10': 0.6604, 'time@10': 4.3942}:  60%|██████    | 6/10 [00:19<00:15,  3.77s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.5923, 'ndcg@10': 0.8872, 'compress@10': 0.5842, 'time@10': 4.5179}:  60%|██████    | 6/10 [00:22<00:15,  3.77s/it] {'epoch': 45, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.5923, 'ndcg@10': 0.8872, 'compress@10': 0.5842, 'time@10': 4.5179}:  70%|███████   | 7/10 [00:22<00:10,  3.41s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.6301, 'ndcg@10': 0.8931, 'compress@10': 0.5268, 'time@10': 4.4458}:  70%|███████   | 7/10 [00:26<00:10,  3.41s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.6301, 'ndcg@10': 0.8931, 'compress@10': 0.5268, 'time@10': 4.4458}:  80%|████████  | 8/10 [00:26<00:07,  3.59s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.5971, 'ndcg@10': 0.8972, 'compress@10': 0.5258, 'time@10': 4.7587}:  80%|████████  | 8/10 [00:29<00:07,  3.59s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.5971, 'ndcg@10': 0.8972, 'compress@10': 0.5258, 'time@10': 4.7587}:  90%|█████████ | 9/10 [00:29<00:03,  3.62s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0091, 'hit_ratio@10': 0.6113, 'ndcg@10': 0.9023, 'compress@10': 0.5493, 'time@10': 4.8011}:  90%|█████████ | 9/10 [00:34<00:03,  3.62s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0091, 'hit_ratio@10': 0.6113, 'ndcg@10': 0.9023, 'compress@10': 0.5493, 'time@10': 4.8011}: 100%|██████████| 10/10 [00:34<00:00,  4.11s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0091, 'hit_ratio@10': 0.6113, 'ndcg@10': 0.9023, 'compress@10': 0.5493, 'time@10': 4.8011}: 100%|██████████| 10/10 [00:34<00:00,  3.50s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.009091511585758326
Avg hit ratio: 0.6113396262395117
Avg ndcg: 0.902250727033616
Avg compression ratio: 0.5492790345399438
Avg train time: 4.801141357421875
Std train time: 1.4278901400522166
[0.8617021276595744, 0.5851063829787233, 0.05319148936170214, 0.2021276595744681, 0.9680851063829787, 0.9468085106382979, 0.05319148936170214, 0.09574468085106386, 0.47872340425531923, 0.7553191489361704]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8757, 'compress@10': 0.8755, 'time@10': 4.096}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8757, 'compress@10': 0.8755, 'time@10': 4.096}:  10%|█         | 1/10 [00:02<00:18,  2.09s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.4688, 'ndcg@10': 0.9032, 'compress@10': 0.7433, 'time@10': 3.8874}:  10%|█         | 1/10 [00:05<00:18,  2.09s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.4688, 'ndcg@10': 0.9032, 'compress@10': 0.7433, 'time@10': 3.8874}:  20%|██        | 2/10 [00:05<00:24,  3.05s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.4792, 'ndcg@10': 0.8522, 'compress@10': 0.5922, 'time@10': 3.5668}:  20%|██        | 2/10 [00:07<00:24,  3.05s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.4792, 'ndcg@10': 0.8522, 'compress@10': 0.5922, 'time@10': 3.5668}:  30%|███       | 3/10 [00:07<00:16,  2.34s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.5094, 'ndcg@10': 0.8712, 'compress@10': 0.5079, 'time@10': 3.4715}:  30%|███       | 3/10 [00:10<00:16,  2.34s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.5094, 'ndcg@10': 0.8712, 'compress@10': 0.5079, 'time@10': 3.4715}:  40%|████      | 4/10 [00:10<00:16,  2.69s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.569, 'ndcg@10': 0.8734, 'compress@10': 0.6002, 'time@10': 4.1721}:  40%|████      | 4/10 [00:14<00:16,  2.69s/it] {'epoch': 46, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.569, 'ndcg@10': 0.8734, 'compress@10': 0.6002, 'time@10': 4.1721}:  50%|█████     | 5/10 [00:14<00:14,  2.99s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0091, 'hit_ratio@10': 0.5756, 'ndcg@10': 0.8848, 'compress@10': 0.6584, 'time@10': 4.3231}:  50%|█████     | 5/10 [00:19<00:14,  2.99s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0091, 'hit_ratio@10': 0.5756, 'ndcg@10': 0.8848, 'compress@10': 0.6584, 'time@10': 4.3231}:  60%|██████    | 6/10 [00:19<00:14,  3.71s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.5813, 'ndcg@10': 0.8883, 'compress@10': 0.5823, 'time@10': 4.4415}:  60%|██████    | 6/10 [00:21<00:14,  3.71s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.5813, 'ndcg@10': 0.8883, 'compress@10': 0.5823, 'time@10': 4.4415}:  70%|███████   | 7/10 [00:21<00:10,  3.36s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0088, 'hit_ratio@10': 0.6205, 'ndcg@10': 0.8943, 'compress@10': 0.5274, 'time@10': 4.3715}:  70%|███████   | 7/10 [00:25<00:10,  3.36s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0088, 'hit_ratio@10': 0.6205, 'ndcg@10': 0.8943, 'compress@10': 0.5274, 'time@10': 4.3715}:  80%|████████  | 8/10 [00:25<00:07,  3.54s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.6071, 'ndcg@10': 0.8996, 'compress@10': 0.5252, 'time@10': 4.6934}:  80%|████████  | 8/10 [00:29<00:07,  3.54s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.6071, 'ndcg@10': 0.8996, 'compress@10': 0.5252, 'time@10': 4.6934}:  90%|█████████ | 9/10 [00:29<00:03,  3.58s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.629, 'ndcg@10': 0.9077, 'compress@10': 0.5493, 'time@10': 4.7497}:  90%|█████████ | 9/10 [00:34<00:03,  3.58s/it]    {'epoch': 46, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.629, 'ndcg@10': 0.9077, 'compress@10': 0.5493, 'time@10': 4.7497}: 100%|██████████| 10/10 [00:34<00:00,  4.11s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.629, 'ndcg@10': 0.9077, 'compress@10': 0.5493, 'time@10': 4.7497}: 100%|██████████| 10/10 [00:34<00:00,  3.47s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.010669189757734019
Avg hit ratio: 0.6290096373877838
Avg ndcg: 0.9077133558346929
Avg compression ratio: 0.5493180190634968
Avg train time: 4.749749565124512
Std train time: 1.4114544502355568
[0.8645833333333333, 0.5729166666666665, 0.05208333333333335, 0.19791666666666669, 0.96875, 0.9479166666666666, 0.05208333333333335, 0.09375000000000003, 0.4895833333333334, 0.7604166666666669]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8757, 'compress@10': 0.8781, 'time@10': 4.2867}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8757, 'compress@10': 0.8781, 'time@10': 4.2867}:  10%|█         | 1/10 [00:02<00:19,  2.18s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.4688, 'ndcg@10': 0.9032, 'compress@10': 0.7389, 'time@10': 3.9216}:  10%|█         | 1/10 [00:05<00:19,  2.18s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.4688, 'ndcg@10': 0.9032, 'compress@10': 0.7389, 'time@10': 3.9216}:  20%|██        | 2/10 [00:05<00:24,  3.01s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.4792, 'ndcg@10': 0.8522, 'compress@10': 0.5889, 'time@10': 3.586}:  20%|██        | 2/10 [00:07<00:24,  3.01s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.4792, 'ndcg@10': 0.8522, 'compress@10': 0.5889, 'time@10': 3.586}:  30%|███       | 3/10 [00:07<00:16,  2.32s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.5094, 'ndcg@10': 0.8712, 'compress@10': 0.5045, 'time@10': 3.4676}:  30%|███       | 3/10 [00:10<00:16,  2.32s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.5094, 'ndcg@10': 0.8712, 'compress@10': 0.5045, 'time@10': 3.4676}:  40%|████      | 4/10 [00:10<00:15,  2.65s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.569, 'ndcg@10': 0.8743, 'compress@10': 0.5976, 'time@10': 4.1365}:  40%|████      | 4/10 [00:13<00:15,  2.65s/it] {'epoch': 47, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.569, 'ndcg@10': 0.8743, 'compress@10': 0.5976, 'time@10': 4.1365}:  50%|█████     | 5/10 [00:13<00:14,  2.93s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.5684, 'ndcg@10': 0.8868, 'compress@10': 0.6564, 'time@10': 4.319}:  50%|█████     | 5/10 [00:19<00:14,  2.93s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.5684, 'ndcg@10': 0.8868, 'compress@10': 0.6564, 'time@10': 4.319}:  60%|██████    | 6/10 [00:19<00:14,  3.73s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0084, 'hit_ratio@10': 0.5861, 'ndcg@10': 0.8905, 'compress@10': 0.5805, 'time@10': 4.4298}:  60%|██████    | 6/10 [00:21<00:14,  3.73s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0084, 'hit_ratio@10': 0.5861, 'ndcg@10': 0.8905, 'compress@10': 0.5805, 'time@10': 4.4298}:  70%|███████   | 7/10 [00:21<00:10,  3.35s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.6247, 'ndcg@10': 0.8962, 'compress@10': 0.5256, 'time@10': 4.3388}:  70%|███████   | 7/10 [00:25<00:10,  3.35s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.6247, 'ndcg@10': 0.8962, 'compress@10': 0.5256, 'time@10': 4.3388}:  80%|████████  | 8/10 [00:25<00:06,  3.48s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.6047, 'ndcg@10': 0.9008, 'compress@10': 0.5247, 'time@10': 4.6714}:  80%|████████  | 8/10 [00:29<00:06,  3.48s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.6047, 'ndcg@10': 0.9008, 'compress@10': 0.5247, 'time@10': 4.6714}:  90%|█████████ | 9/10 [00:29<00:03,  3.55s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.6181, 'ndcg@10': 0.9055, 'compress@10': 0.5494, 'time@10': 4.7399}:  90%|█████████ | 9/10 [00:34<00:03,  3.55s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.6181, 'ndcg@10': 0.9055, 'compress@10': 0.5494, 'time@10': 4.7399}: 100%|██████████| 10/10 [00:34<00:00,  4.12s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.6181, 'ndcg@10': 0.9055, 'compress@10': 0.5494, 'time@10': 4.7399}: 100%|██████████| 10/10 [00:34<00:00,  3.45s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.008573082642350802
Avg hit ratio: 0.6181029112636665
Avg ndcg: 0.9055485880760095
Avg compression ratio: 0.5493514429882029
Avg train time: 4.739932560920716
Std train time: 1.4292311408854312
[0.8673469387755102, 0.5612244897959182, 0.05102040816326532, 0.19387755102040818, 0.9693877551020408, 0.9489795918367346, 0.05102040816326532, 0.1122448979591837, 0.47959183673469397, 0.7653061224489798]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8757, 'compress@10': 0.8806, 'time@10': 4.1627}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8757, 'compress@10': 0.8806, 'time@10': 4.1627}:  10%|█         | 1/10 [00:02<00:19,  2.12s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.5, 'ndcg@10': 0.9032, 'compress@10': 0.7346, 'time@10': 3.8792}:  10%|█         | 1/10 [00:05<00:19,  2.12s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.5, 'ndcg@10': 0.9032, 'compress@10': 0.7346, 'time@10': 3.8792}:  20%|██        | 2/10 [00:05<00:24,  3.01s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8522, 'compress@10': 0.5858, 'time@10': 3.5483}:  20%|██        | 2/10 [00:07<00:24,  3.01s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8522, 'compress@10': 0.5858, 'time@10': 3.5483}:  30%|███       | 3/10 [00:07<00:16,  2.31s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.525, 'ndcg@10': 0.8712, 'compress@10': 0.5013, 'time@10': 3.3862}:  30%|███       | 3/10 [00:10<00:16,  2.31s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.525, 'ndcg@10': 0.8712, 'compress@10': 0.5013, 'time@10': 3.3862}:  40%|████      | 4/10 [00:10<00:15,  2.56s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.5815, 'ndcg@10': 0.8741, 'compress@10': 0.5951, 'time@10': 4.0896}:  40%|████      | 4/10 [00:13<00:15,  2.56s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.5815, 'ndcg@10': 0.8741, 'compress@10': 0.5951, 'time@10': 4.0896}:  50%|█████     | 5/10 [00:13<00:14,  2.89s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.5933, 'ndcg@10': 0.8856, 'compress@10': 0.6545, 'time@10': 4.2835}:  50%|█████     | 5/10 [00:18<00:14,  2.89s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.5933, 'ndcg@10': 0.8856, 'compress@10': 0.6545, 'time@10': 4.2835}:  60%|██████    | 6/10 [00:18<00:14,  3.71s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.6075, 'ndcg@10': 0.8894, 'compress@10': 0.5787, 'time@10': 4.4216}:  60%|██████    | 6/10 [00:21<00:14,  3.71s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.6075, 'ndcg@10': 0.8894, 'compress@10': 0.5787, 'time@10': 4.4216}:  70%|███████   | 7/10 [00:21<00:10,  3.37s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0081, 'hit_ratio@10': 0.6499, 'ndcg@10': 0.8952, 'compress@10': 0.5262, 'time@10': 4.3402}:  70%|███████   | 7/10 [00:25<00:10,  3.37s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0081, 'hit_ratio@10': 0.6499, 'ndcg@10': 0.8952, 'compress@10': 0.5262, 'time@10': 4.3402}:  80%|████████  | 8/10 [00:25<00:07,  3.51s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0086, 'hit_ratio@10': 0.6395, 'ndcg@10': 0.9005, 'compress@10': 0.5243, 'time@10': 4.6622}:  80%|████████  | 8/10 [00:29<00:07,  3.51s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0086, 'hit_ratio@10': 0.6395, 'ndcg@10': 0.9005, 'compress@10': 0.5243, 'time@10': 4.6622}:  90%|█████████ | 9/10 [00:29<00:03,  3.56s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.6581, 'ndcg@10': 0.9058, 'compress@10': 0.5494, 'time@10': 4.7146}:  90%|█████████ | 9/10 [00:34<00:03,  3.56s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.6581, 'ndcg@10': 0.9058, 'compress@10': 0.5494, 'time@10': 4.7146}: 100%|██████████| 10/10 [00:34<00:00,  4.07s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.6581, 'ndcg@10': 0.9058, 'compress@10': 0.5494, 'time@10': 4.7146}: 100%|██████████| 10/10 [00:34<00:00,  3.43s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.00877902159961363
Avg hit ratio: 0.6581184846173405
Avg ndcg: 0.9057858946567604
Avg compression ratio: 0.5493881496113611
Avg train time: 4.714561104774475
Std train time: 1.4504252891472116
[0.87, 0.5499999999999998, 0.05000000000000002, 0.19000000000000003, 0.97, 0.95, 0.05000000000000002, 0.11000000000000003, 0.4900000000000001, 0.7700000000000001]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8757, 'compress@10': 0.883, 'time@10': 4.2205}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8757, 'compress@10': 0.883, 'time@10': 4.2205}:  10%|█         | 1/10 [00:02<00:19,  2.15s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.5, 'ndcg@10': 0.9044, 'compress@10': 0.7306, 'time@10': 3.9107}:  10%|█         | 1/10 [00:05<00:19,  2.15s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.5, 'ndcg@10': 0.9044, 'compress@10': 0.7306, 'time@10': 3.9107}:  20%|██        | 2/10 [00:05<00:24,  3.02s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8529, 'compress@10': 0.5829, 'time@10': 3.6236}:  20%|██        | 2/10 [00:07<00:24,  3.02s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.5, 'ndcg@10': 0.8529, 'compress@10': 0.5829, 'time@10': 3.6236}:  30%|███       | 3/10 [00:07<00:16,  2.36s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.525, 'ndcg@10': 0.8718, 'compress@10': 0.4982, 'time@10': 3.5019}:  30%|███       | 3/10 [00:10<00:16,  2.36s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.525, 'ndcg@10': 0.8718, 'compress@10': 0.4982, 'time@10': 3.5019}:  40%|████      | 4/10 [00:10<00:16,  2.68s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.007, 'hit_ratio@10': 0.5815, 'ndcg@10': 0.8765, 'compress@10': 0.5928, 'time@10': 4.1829}:  40%|████      | 4/10 [00:14<00:16,  2.68s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.007, 'hit_ratio@10': 0.5815, 'ndcg@10': 0.8765, 'compress@10': 0.5928, 'time@10': 4.1829}:  50%|█████     | 5/10 [00:14<00:14,  2.98s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0081, 'hit_ratio@10': 0.5716, 'ndcg@10': 0.8887, 'compress@10': 0.6527, 'time@10': 4.3417}:  50%|█████     | 5/10 [00:19<00:14,  2.98s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0081, 'hit_ratio@10': 0.5716, 'ndcg@10': 0.8887, 'compress@10': 0.6527, 'time@10': 4.3417}:  60%|██████    | 6/10 [00:19<00:14,  3.73s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0079, 'hit_ratio@10': 0.5888, 'ndcg@10': 0.8921, 'compress@10': 0.577, 'time@10': 4.4342}:  60%|██████    | 6/10 [00:21<00:14,  3.73s/it] {'epoch': 49, 'num_users': 6.2857, 'loss': 0.0079, 'hit_ratio@10': 0.5888, 'ndcg@10': 0.8921, 'compress@10': 0.577, 'time@10': 4.4342}:  70%|███████   | 7/10 [00:21<00:10,  3.34s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0079, 'hit_ratio@10': 0.6336, 'ndcg@10': 0.8985, 'compress@10': 0.5245, 'time@10': 4.356}:  70%|███████   | 7/10 [00:25<00:10,  3.34s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0079, 'hit_ratio@10': 0.6336, 'ndcg@10': 0.8985, 'compress@10': 0.5245, 'time@10': 4.356}:  80%|████████  | 8/10 [00:25<00:07,  3.50s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0078, 'hit_ratio@10': 0.6126, 'ndcg@10': 0.9029, 'compress@10': 0.5238, 'time@10': 4.7118}:  80%|████████  | 8/10 [00:29<00:07,  3.50s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0078, 'hit_ratio@10': 0.6126, 'ndcg@10': 0.9029, 'compress@10': 0.5238, 'time@10': 4.7118}:  90%|█████████ | 9/10 [00:29<00:03,  3.61s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0081, 'hit_ratio@10': 0.6253, 'ndcg@10': 0.9079, 'compress@10': 0.5494, 'time@10': 4.7712}:  90%|█████████ | 9/10 [00:34<00:03,  3.61s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0081, 'hit_ratio@10': 0.6253, 'ndcg@10': 0.9079, 'compress@10': 0.5494, 'time@10': 4.7712}: 100%|██████████| 10/10 [00:34<00:00,  4.14s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0081, 'hit_ratio@10': 0.6253, 'ndcg@10': 0.9079, 'compress@10': 0.5494, 'time@10': 4.7712}: 100%|██████████| 10/10 [00:34<00:00,  3.48s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.008083474173966822
Avg hit ratio: 0.6252682430714468
Avg ndcg: 0.9079011079131771
Avg compression ratio: 0.5494173100963613
Avg train time: 4.7711588621139525
Std train time: 1.4500923421944203
[0.8725490196078431, 0.5392156862745097, 0.04901960784313727, 0.1862745098039216, 0.9705882352941176, 0.9509803921568627, 0.04901960784313727, 0.12745098039215688, 0.4803921568627452, 0.7745098039215688]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
