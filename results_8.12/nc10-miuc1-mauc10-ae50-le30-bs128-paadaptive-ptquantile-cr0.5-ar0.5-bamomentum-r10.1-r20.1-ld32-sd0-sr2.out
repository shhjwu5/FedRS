  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8531, 'compress@10': 0.5263, 'time@10': 26.5721}:   0%|          | 0/10 [00:13<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8531, 'compress@10': 0.5263, 'time@10': 26.5721}:  10%|█         | 1/10 [00:13<01:59, 13.33s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8499, 'compress@10': 0.5212, 'time@10': 23.9124}:  10%|█         | 1/10 [00:34<01:59, 13.33s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8499, 'compress@10': 0.5212, 'time@10': 23.9124}:  20%|██        | 2/10 [00:34<02:24, 18.01s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.0603, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8251, 'compress@10': 0.538, 'time@10': 18.6927}:  20%|██        | 2/10 [00:38<02:24, 18.01s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.0603, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8251, 'compress@10': 0.538, 'time@10': 18.6927}:  30%|███       | 3/10 [00:38<01:21, 11.69s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.0561, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8324, 'compress@10': 0.5329, 'time@10': 18.8305}:  30%|███       | 3/10 [00:58<01:21, 11.69s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.0561, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8324, 'compress@10': 0.5329, 'time@10': 18.8305}:  40%|████      | 4/10 [00:58<01:28, 14.69s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.0571, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8279, 'compress@10': 0.5283, 'time@10': 29.0626}:  40%|████      | 4/10 [01:33<01:28, 14.69s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.0571, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8279, 'compress@10': 0.5283, 'time@10': 29.0626}:  50%|█████     | 5/10 [01:33<01:50, 22.03s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.0573, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8281, 'compress@10': 0.5255, 'time@10': 29.5541}:  50%|█████     | 5/10 [02:05<01:50, 22.03s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.0573, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8281, 'compress@10': 0.5255, 'time@10': 29.5541}:  60%|██████    | 6/10 [02:05<01:41, 25.43s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.0546, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.8344, 'compress@10': 0.5247, 'time@10': 30.2795}:  60%|██████    | 6/10 [02:22<01:41, 25.43s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.0546, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.8344, 'compress@10': 0.5247, 'time@10': 30.2795}:  70%|███████   | 7/10 [02:22<01:08, 22.80s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.052, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8407, 'compress@10': 0.5234, 'time@10': 29.5395}:  70%|███████   | 7/10 [02:46<01:08, 22.80s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 0.052, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8407, 'compress@10': 0.5234, 'time@10': 29.5395}:  80%|████████  | 8/10 [02:46<00:46, 23.31s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8496, 'compress@10': 0.5224, 'time@10': 31.7539}:  80%|████████  | 8/10 [03:11<00:46, 23.31s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8496, 'compress@10': 0.5224, 'time@10': 31.7539}:  90%|█████████ | 9/10 [03:11<00:23, 23.77s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8508, 'compress@10': 0.5213, 'time@10': 31.6279}:  90%|█████████ | 9/10 [03:42<00:23, 23.77s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8508, 'compress@10': 0.5213, 'time@10': 31.6279}: 100%|██████████| 10/10 [03:42<00:00, 25.86s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8508, 'compress@10': 0.5213, 'time@10': 31.6279}: 100%|██████████| 10/10 [03:42<00:00, 22.22s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.0480710192892705
Avg hit ratio: 0.8389366622813142
Avg ndcg: 0.8508029666235251
Avg compression ratio: 0.5212749006657823
Avg train time: 31.627874112129213
Std train time: 16.389922022913453
[0.75, 0.75, 0.75, 0.25, 0.75, 0.75, 0.25, 0.25, 0.25, 0.25]
[30, 30, 31, 30, 29, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.857, 'compress@10': 0.7632, 'time@10': 24.6583}:   0%|          | 0/10 [00:12<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.857, 'compress@10': 0.7632, 'time@10': 24.6583}:  10%|█         | 1/10 [00:12<01:51, 12.37s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0371, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8726, 'compress@10': 0.7606, 'time@10': 22.6456}:  10%|█         | 1/10 [00:33<01:51, 12.37s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0371, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8726, 'compress@10': 0.7606, 'time@10': 22.6456}:  20%|██        | 2/10 [00:33<02:18, 17.25s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8674, 'compress@10': 0.769, 'time@10': 17.857}:  20%|██        | 2/10 [00:37<02:18, 17.25s/it]   {'epoch': 1, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8674, 'compress@10': 0.769, 'time@10': 17.857}:  30%|███       | 3/10 [00:37<01:18, 11.28s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.799, 'ndcg@10': 0.8695, 'compress@10': 0.6459, 'time@10': 18.2109}:  30%|███       | 3/10 [00:56<01:18, 11.28s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.799, 'ndcg@10': 0.8695, 'compress@10': 0.6459, 'time@10': 18.2109}:  40%|████      | 4/10 [00:56<01:26, 14.45s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.866, 'compress@10': 0.6677, 'time@10': 28.1397}:  40%|████      | 4/10 [01:30<01:26, 14.45s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.866, 'compress@10': 0.6677, 'time@10': 28.1397}:  50%|█████     | 5/10 [01:30<01:47, 21.49s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0306, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8659, 'compress@10': 0.6824, 'time@10': 28.8006}:  50%|█████     | 5/10 [02:02<01:47, 21.49s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0306, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8659, 'compress@10': 0.6824, 'time@10': 28.8006}:  60%|██████    | 6/10 [02:02<01:40, 25.11s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0307, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8706, 'compress@10': 0.6249, 'time@10': 29.6279}:  60%|██████    | 6/10 [02:19<01:40, 25.11s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0307, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8706, 'compress@10': 0.6249, 'time@10': 29.6279}:  70%|███████   | 7/10 [02:19<01:07, 22.57s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0298, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8727, 'compress@10': 0.5807, 'time@10': 28.8883}:  70%|███████   | 7/10 [02:43<01:07, 22.57s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0298, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8727, 'compress@10': 0.5807, 'time@10': 28.8883}:  80%|████████  | 8/10 [02:43<00:45, 22.95s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0294, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8779, 'compress@10': 0.5463, 'time@10': 30.8592}:  80%|████████  | 8/10 [03:07<00:45, 22.95s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0294, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8779, 'compress@10': 0.5463, 'time@10': 30.8592}:  90%|█████████ | 9/10 [03:07<00:23, 23.07s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8823, 'compress@10': 0.5184, 'time@10': 30.8053}:  90%|█████████ | 9/10 [03:37<00:23, 23.07s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8823, 'compress@10': 0.5184, 'time@10': 30.8053}: 100%|██████████| 10/10 [03:37<00:00, 25.32s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8823, 'compress@10': 0.5184, 'time@10': 30.8053}: 100%|██████████| 10/10 [03:37<00:00, 21.74s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.02829361809398618
Avg hit ratio: 0.858168240738699
Avg ndcg: 0.8822912819748131
Avg compression ratio: 0.5184152995265663
Avg train time: 30.805282306671142
Std train time: 15.720177479045066
[0.8333333333333334, 0.8333333333333334, 0.5, 0.5, 0.8333333333333334, 0.8333333333333334, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[30, 30, 32, 30, 28, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0376, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.866, 'compress@10': 0.8421, 'time@10': 25.7225}:   0%|          | 0/10 [00:12<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0376, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.866, 'compress@10': 0.8421, 'time@10': 25.7225}:  10%|█         | 1/10 [00:12<01:56, 12.90s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0393, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8703, 'compress@10': 0.8404, 'time@10': 23.5862}:  10%|█         | 1/10 [00:34<01:56, 12.90s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0393, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8703, 'compress@10': 0.8404, 'time@10': 23.5862}:  20%|██        | 2/10 [00:34<02:23, 17.95s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8659, 'compress@10': 0.7507, 'time@10': 18.8212}:  20%|██        | 2/10 [00:39<02:23, 17.95s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8659, 'compress@10': 0.7507, 'time@10': 18.8212}:  30%|███       | 3/10 [00:39<01:23, 11.89s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8772, 'compress@10': 0.6925, 'time@10': 18.9885}:  30%|███       | 3/10 [00:58<01:23, 11.89s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8772, 'compress@10': 0.6925, 'time@10': 18.9885}:  40%|████      | 4/10 [00:58<01:29, 14.91s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0263, 'hit_ratio@10': 0.8128, 'ndcg@10': 0.877, 'compress@10': 0.7213, 'time@10': 28.23}:  40%|████      | 4/10 [01:31<01:29, 14.91s/it]  {'epoch': 2, 'num_users': 5.8, 'loss': 0.0263, 'hit_ratio@10': 0.8128, 'ndcg@10': 0.877, 'compress@10': 0.7213, 'time@10': 28.23}:  50%|█████     | 5/10 [01:31<01:46, 21.30s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0262, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8819, 'compress@10': 0.7406, 'time@10': 28.6461}:  50%|█████     | 5/10 [02:01<01:46, 21.30s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0262, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8819, 'compress@10': 0.7406, 'time@10': 28.6461}:  60%|██████    | 6/10 [02:01<01:38, 24.52s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0261, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8841, 'compress@10': 0.6634, 'time@10': 29.3075}:  60%|██████    | 6/10 [02:18<01:38, 24.52s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0261, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8841, 'compress@10': 0.6634, 'time@10': 29.3075}:  70%|███████   | 7/10 [02:18<01:05, 21.95s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0247, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.8882, 'compress@10': 0.6043, 'time@10': 28.6209}:  70%|███████   | 7/10 [02:42<01:05, 21.95s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0247, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.8882, 'compress@10': 0.6043, 'time@10': 28.6209}:  80%|████████  | 8/10 [02:42<00:45, 22.56s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0243, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8925, 'compress@10': 0.5583, 'time@10': 30.4794}:  80%|████████  | 8/10 [03:05<00:45, 22.56s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0243, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8925, 'compress@10': 0.5583, 'time@10': 30.4794}:  90%|█████████ | 9/10 [03:05<00:22, 22.61s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8967, 'compress@10': 0.521, 'time@10': 30.4432}:  90%|█████████ | 9/10 [03:35<00:22, 22.61s/it]    {'epoch': 2, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8967, 'compress@10': 0.521, 'time@10': 30.4432}: 100%|██████████| 10/10 [03:35<00:00, 24.94s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8967, 'compress@10': 0.521, 'time@10': 30.4432}: 100%|██████████| 10/10 [03:35<00:00, 21.54s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.02337307294776123
Avg hit ratio: 0.8648284371730892
Avg ndcg: 0.8967235914776556
Avg compression ratio: 0.5210336350715938
Avg train time: 30.443169379234313
Std train time: 14.671541834007755
[0.875, 0.875, 0.375, 0.375, 0.875, 0.875, 0.375, 0.125, 0.125, 0.125]
[30, 30, 33, 30, 27, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8674, 'compress@10': 0.8816, 'time@10': 26.1196}:   0%|          | 0/10 [00:13<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8674, 'compress@10': 0.8816, 'time@10': 26.1196}:  10%|█         | 1/10 [00:13<01:57, 13.10s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0281, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8879, 'compress@10': 0.8803, 'time@10': 23.7927}:  10%|█         | 1/10 [00:34<01:57, 13.10s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0281, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8879, 'compress@10': 0.8803, 'time@10': 23.7927}:  20%|██        | 2/10 [00:34<02:24, 18.04s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8776, 'compress@10': 0.7416, 'time@10': 18.9419}:  20%|██        | 2/10 [00:39<02:24, 18.04s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8776, 'compress@10': 0.7416, 'time@10': 18.9419}:  30%|███       | 3/10 [00:39<01:23, 11.93s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8919, 'compress@10': 0.6556, 'time@10': 19.0603}:  30%|███       | 3/10 [00:58<01:23, 11.93s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8919, 'compress@10': 0.6556, 'time@10': 19.0603}:  40%|████      | 4/10 [00:58<01:29, 14.90s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0198, 'hit_ratio@10': 0.8128, 'ndcg@10': 0.8975, 'compress@10': 0.6999, 'time@10': 27.7656}:  40%|████      | 4/10 [01:30<01:29, 14.90s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0198, 'hit_ratio@10': 0.8128, 'ndcg@10': 0.8975, 'compress@10': 0.6999, 'time@10': 27.7656}:  50%|█████     | 5/10 [01:30<01:44, 20.83s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0194, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.9016, 'compress@10': 0.7296, 'time@10': 28.1695}:  50%|█████     | 5/10 [02:00<01:44, 20.83s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0194, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.9016, 'compress@10': 0.7296, 'time@10': 28.1695}:  60%|██████    | 6/10 [02:00<01:36, 24.03s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0193, 'hit_ratio@10': 0.851, 'ndcg@10': 0.904, 'compress@10': 0.6825, 'time@10': 29.0231}:  60%|██████    | 6/10 [02:17<01:36, 24.03s/it]  {'epoch': 3, 'num_users': 6.2857, 'loss': 0.0193, 'hit_ratio@10': 0.851, 'ndcg@10': 0.904, 'compress@10': 0.6825, 'time@10': 29.0231}:  70%|███████   | 7/10 [02:17<01:05, 21.77s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9073, 'compress@10': 0.6159, 'time@10': 28.3597}:  70%|███████   | 7/10 [02:41<01:05, 21.77s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9073, 'compress@10': 0.6159, 'time@10': 28.3597}:  80%|████████  | 8/10 [02:41<00:44, 22.40s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.9115, 'compress@10': 0.5642, 'time@10': 30.2447}:  80%|████████  | 8/10 [03:03<00:44, 22.40s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.9115, 'compress@10': 0.5642, 'time@10': 30.2447}:  90%|█████████ | 9/10 [03:03<00:22, 22.50s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9158, 'compress@10': 0.5222, 'time@10': 30.2074}:  90%|█████████ | 9/10 [03:33<00:22, 22.50s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9158, 'compress@10': 0.5222, 'time@10': 30.2074}: 100%|██████████| 10/10 [03:33<00:00, 24.78s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9158, 'compress@10': 0.5222, 'time@10': 30.2074}: 100%|██████████| 10/10 [03:33<00:00, 21.38s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.017121662832342517
Avg hit ratio: 0.8705932279378799
Avg ndcg: 0.9157984498290513
Avg compression ratio: 0.5222353761551799
Avg train time: 30.207447743415834
Std train time: 14.08525124819276
[0.9, 0.9, 0.3, 0.5, 0.9, 0.7, 0.5, 0.1, 0.1, 0.1]
[30, 30, 34, 30, 26, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8813, 'compress@10': 0.9052, 'time@10': 25.5097}:   0%|          | 0/10 [00:12<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8813, 'compress@10': 0.9052, 'time@10': 25.5097}:  10%|█         | 1/10 [00:12<01:55, 12.82s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.911, 'compress@10': 0.9042, 'time@10': 23.3653}:  10%|█         | 1/10 [00:34<01:55, 12.82s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.911, 'compress@10': 0.9042, 'time@10': 23.3653}:  20%|██        | 2/10 [00:34<02:22, 17.79s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8931, 'compress@10': 0.7362, 'time@10': 18.626}:  20%|██        | 2/10 [00:38<02:22, 17.79s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8931, 'compress@10': 0.7362, 'time@10': 18.626}:  30%|███       | 3/10 [00:38<01:22, 11.77s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9082, 'compress@10': 0.6816, 'time@10': 18.9623}:  30%|███       | 3/10 [00:58<01:22, 11.77s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9082, 'compress@10': 0.6816, 'time@10': 18.9623}:  40%|████      | 4/10 [00:58<01:30, 15.02s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9114, 'compress@10': 0.7257, 'time@10': 27.1865}:  40%|████      | 4/10 [01:28<01:30, 15.02s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9114, 'compress@10': 0.7257, 'time@10': 27.1865}:  50%|█████     | 5/10 [01:28<01:42, 20.45s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9175, 'compress@10': 0.7225, 'time@10': 27.8446}:  50%|█████     | 5/10 [01:59<01:42, 20.45s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9175, 'compress@10': 0.7225, 'time@10': 27.8446}:  60%|██████    | 6/10 [01:59<01:36, 24.10s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.919, 'compress@10': 0.6936, 'time@10': 28.7245}:  60%|██████    | 6/10 [02:16<01:36, 24.10s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.919, 'compress@10': 0.6936, 'time@10': 28.7245}:  70%|███████   | 7/10 [02:16<01:05, 21.79s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0135, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9226, 'compress@10': 0.6226, 'time@10': 27.9962}:  70%|███████   | 7/10 [02:39<01:05, 21.79s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0135, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9226, 'compress@10': 0.6226, 'time@10': 27.9962}:  80%|████████  | 8/10 [02:39<00:44, 22.15s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9261, 'compress@10': 0.5674, 'time@10': 29.6851}:  80%|████████  | 8/10 [03:01<00:44, 22.15s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9261, 'compress@10': 0.5674, 'time@10': 29.6851}:  90%|█████████ | 9/10 [03:01<00:21, 22.00s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9301, 'compress@10': 0.5227, 'time@10': 29.6268}:  90%|█████████ | 9/10 [03:30<00:21, 22.00s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9301, 'compress@10': 0.5227, 'time@10': 29.6268}: 100%|██████████| 10/10 [03:30<00:00, 24.20s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9301, 'compress@10': 0.5227, 'time@10': 29.6268}: 100%|██████████| 10/10 [03:30<00:00, 21.07s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.012895868245088957
Avg hit ratio: 0.894142100118331
Avg ndcg: 0.9301365839976405
Avg compression ratio: 0.5226867781742697
Avg train time: 29.626802682876587
Std train time: 13.337908706084107
[0.9166666666666667, 0.9166666666666667, 0.25, 0.5833333333333334, 0.9166666666666667, 0.5833333333333333, 0.5833333333333334, 0.08333333333333334, 0.08333333333333334, 0.08333333333333334]
[30, 30, 35, 30, 25, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8886, 'compress@10': 0.921, 'time@10': 23.618}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8886, 'compress@10': 0.921, 'time@10': 23.618}:  10%|█         | 1/10 [00:11<01:46, 11.86s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.9211, 'compress@10': 0.9202, 'time@10': 21.4465}:  10%|█         | 1/10 [00:31<01:46, 11.86s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.9211, 'compress@10': 0.9202, 'time@10': 21.4465}:  20%|██        | 2/10 [00:31<02:09, 16.25s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.7769, 'ndcg@10': 0.8998, 'compress@10': 0.7325, 'time@10': 17.5248}:  20%|██        | 2/10 [00:36<02:09, 16.25s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.7769, 'ndcg@10': 0.8998, 'compress@10': 0.7325, 'time@10': 17.5248}:  30%|███       | 3/10 [00:36<01:17, 11.05s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.9123, 'compress@10': 0.6989, 'time@10': 17.9848}:  30%|███       | 3/10 [00:55<01:17, 11.05s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.9123, 'compress@10': 0.6989, 'time@10': 17.9848}:  40%|████      | 4/10 [00:55<01:26, 14.35s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.847, 'ndcg@10': 0.9207, 'compress@10': 0.7428, 'time@10': 25.6296}:  40%|████      | 4/10 [01:23<01:26, 14.35s/it]  {'epoch': 5, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.847, 'ndcg@10': 0.9207, 'compress@10': 0.7428, 'time@10': 25.6296}:  50%|█████     | 5/10 [01:23<01:36, 19.32s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0121, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.9275, 'compress@10': 0.7178, 'time@10': 26.5647}:  50%|█████     | 5/10 [01:54<01:36, 19.32s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0121, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.9275, 'compress@10': 0.7178, 'time@10': 26.5647}:  60%|██████    | 6/10 [01:54<01:33, 23.39s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.012, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9288, 'compress@10': 0.7009, 'time@10': 27.7879}:  60%|██████    | 6/10 [02:12<01:33, 23.39s/it] {'epoch': 5, 'num_users': 6.2857, 'loss': 0.012, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9288, 'compress@10': 0.7009, 'time@10': 27.7879}:  70%|███████   | 7/10 [02:12<01:04, 21.50s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9322, 'compress@10': 0.627, 'time@10': 27.1486}:  70%|███████   | 7/10 [02:35<01:04, 21.50s/it]  {'epoch': 5, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9322, 'compress@10': 0.627, 'time@10': 27.1486}:  80%|████████  | 8/10 [02:35<00:43, 21.89s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9345, 'compress@10': 0.5695, 'time@10': 28.827}:  80%|████████  | 8/10 [02:56<00:43, 21.89s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9345, 'compress@10': 0.5695, 'time@10': 28.827}:  90%|█████████ | 9/10 [02:56<00:21, 21.66s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9381, 'compress@10': 0.523, 'time@10': 28.7874}:  90%|█████████ | 9/10 [03:24<00:21, 21.66s/it]    {'epoch': 5, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9381, 'compress@10': 0.523, 'time@10': 28.7874}: 100%|██████████| 10/10 [03:24<00:00, 23.77s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9381, 'compress@10': 0.523, 'time@10': 28.7874}: 100%|██████████| 10/10 [03:24<00:00, 20.49s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.01092401706225034
Avg hit ratio: 0.8949920745166924
Avg ndcg: 0.9380998576702384
Avg compression ratio: 0.5229874096585918
Avg train time: 28.78735570907593
Std train time: 12.601716780716943
[0.9285714285714286, 0.9285714285714286, 0.2142857142857143, 0.6428571428571429, 0.9285714285714286, 0.49999999999999994, 0.6428571428571429, 0.07142857142857144, 0.07142857142857144, 0.07142857142857144]
[30, 30, 36, 30, 24, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8912, 'compress@10': 0.9323, 'time@10': 22.7195}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8912, 'compress@10': 0.9323, 'time@10': 22.7195}:  10%|█         | 1/10 [00:11<01:42, 11.40s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9218, 'compress@10': 0.9316, 'time@10': 20.903}:  10%|█         | 1/10 [00:30<01:42, 11.40s/it]  {'epoch': 6, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9218, 'compress@10': 0.9316, 'time@10': 20.903}:  20%|██        | 2/10 [00:30<02:07, 15.94s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9003, 'compress@10': 0.7299, 'time@10': 17.3627}:  20%|██        | 2/10 [00:35<02:07, 15.94s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9003, 'compress@10': 0.7299, 'time@10': 17.3627}:  30%|███       | 3/10 [00:35<01:17, 11.03s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9149, 'compress@10': 0.7113, 'time@10': 17.7725}:  30%|███       | 3/10 [00:54<01:17, 11.03s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9149, 'compress@10': 0.7113, 'time@10': 17.7725}:  40%|████      | 4/10 [00:54<01:25, 14.19s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9244, 'compress@10': 0.7551, 'time@10': 24.8038}:  40%|████      | 4/10 [01:21<01:25, 14.19s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9244, 'compress@10': 0.7551, 'time@10': 24.8038}:  50%|█████     | 5/10 [01:21<01:33, 18.63s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9316, 'compress@10': 0.7144, 'time@10': 25.9916}:  50%|█████     | 5/10 [01:53<01:33, 18.63s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9316, 'compress@10': 0.7144, 'time@10': 25.9916}:  60%|██████    | 6/10 [01:53<01:32, 23.16s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9337, 'compress@10': 0.7062, 'time@10': 27.1463}:  60%|██████    | 6/10 [02:10<01:32, 23.16s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9337, 'compress@10': 0.7062, 'time@10': 27.1463}:  70%|███████   | 7/10 [02:10<01:03, 21.17s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.9142, 'ndcg@10': 0.937, 'compress@10': 0.6302, 'time@10': 26.6139}:  70%|███████   | 7/10 [02:33<01:03, 21.17s/it]  {'epoch': 6, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.9142, 'ndcg@10': 0.937, 'compress@10': 0.6302, 'time@10': 26.6139}:  80%|████████  | 8/10 [02:33<00:43, 21.73s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0086, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9392, 'compress@10': 0.5711, 'time@10': 28.2928}:  80%|████████  | 8/10 [02:54<00:43, 21.73s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0086, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9392, 'compress@10': 0.5711, 'time@10': 28.2928}:  90%|█████████ | 9/10 [02:54<00:21, 21.47s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.95, 'compress@10': 0.5232, 'time@10': 28.227}:  90%|█████████ | 9/10 [03:21<00:21, 21.47s/it]      {'epoch': 6, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.95, 'compress@10': 0.5232, 'time@10': 28.227}: 100%|██████████| 10/10 [03:21<00:00, 23.39s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.95, 'compress@10': 0.5232, 'time@10': 28.227}: 100%|██████████| 10/10 [03:21<00:00, 20.18s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.011260565183224647
Avg hit ratio: 0.9091128603522491
Avg ndcg: 0.9500220088405058
Avg compression ratio: 0.5232019799888432
Avg train time: 28.22703456878662
Std train time: 11.790427961128293
[0.9375, 0.9375, 0.1875, 0.5625, 0.8125, 0.43749999999999994, 0.6875, 0.06250000000000001, 0.1875, 0.1875]
[30, 30, 37, 30, 23, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8976, 'compress@10': 0.9408, 'time@10': 23.1397}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8976, 'compress@10': 0.9408, 'time@10': 23.1397}:  10%|█         | 1/10 [00:11<01:44, 11.61s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9811, 'compress@10': 0.9401, 'time@10': 21.0953}:  10%|█         | 1/10 [00:30<01:44, 11.61s/it] {'epoch': 7, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9811, 'compress@10': 0.9401, 'time@10': 21.0953}:  20%|██        | 2/10 [00:30<02:08, 16.01s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9398, 'compress@10': 0.728, 'time@10': 17.3349}:  20%|██        | 2/10 [00:35<02:08, 16.01s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9398, 'compress@10': 0.728, 'time@10': 17.3349}:  30%|███       | 3/10 [00:35<01:16, 10.96s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9441, 'compress@10': 0.6905, 'time@10': 17.8609}:  30%|███       | 3/10 [00:55<01:16, 10.96s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9441, 'compress@10': 0.6905, 'time@10': 17.8609}:  40%|████      | 4/10 [00:55<01:25, 14.32s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9494, 'compress@10': 0.7156, 'time@10': 24.563}:  40%|████      | 4/10 [01:20<01:25, 14.32s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9494, 'compress@10': 0.7156, 'time@10': 24.563}:  50%|█████     | 5/10 [01:20<01:32, 18.43s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9528, 'compress@10': 0.6714, 'time@10': 25.7309}:  50%|█████     | 5/10 [01:52<01:32, 18.43s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9528, 'compress@10': 0.6714, 'time@10': 25.7309}:  60%|██████    | 6/10 [01:52<01:31, 22.91s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9526, 'compress@10': 0.6755, 'time@10': 26.8505}:  60%|██████    | 6/10 [02:09<01:31, 22.91s/it] {'epoch': 7, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9526, 'compress@10': 0.6755, 'time@10': 26.8505}:  70%|███████   | 7/10 [02:09<01:02, 20.92s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9546, 'compress@10': 0.6022, 'time@10': 26.3684}:  70%|███████   | 7/10 [02:32<01:02, 20.92s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9546, 'compress@10': 0.6022, 'time@10': 26.3684}:  80%|████████  | 8/10 [02:32<00:43, 21.59s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9553, 'compress@10': 0.5587, 'time@10': 28.4963}:  80%|████████  | 8/10 [02:55<00:43, 21.59s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9553, 'compress@10': 0.5587, 'time@10': 28.4963}:  90%|█████████ | 9/10 [02:55<00:21, 21.97s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.96, 'compress@10': 0.5234, 'time@10': 28.601}:  90%|█████████ | 9/10 [03:24<00:21, 21.97s/it]      {'epoch': 7, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.96, 'compress@10': 0.5234, 'time@10': 28.601}: 100%|██████████| 10/10 [03:24<00:00, 24.32s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.96, 'compress@10': 0.5234, 'time@10': 28.601}: 100%|██████████| 10/10 [03:24<00:00, 20.47s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.009348210793331263
Avg hit ratio: 0.9111128603522491
Avg ndcg: 0.9600477611671764
Avg compression ratio: 0.5234189734794322
Avg train time: 28.601028537750246
Std train time: 11.951956765707141
[0.9444444444444444, 0.9444444444444444, 0.16666666666666666, 0.5, 0.7222222222222222, 0.38888888888888884, 0.7222222222222222, 0.055555555555555566, 0.2777777777777778, 0.2777777777777778]
[30, 30, 38, 30, 22, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9034, 'compress@10': 0.9474, 'time@10': 23.1594}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9034, 'compress@10': 0.9474, 'time@10': 23.1594}:  10%|█         | 1/10 [00:11<01:44, 11.62s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9803, 'compress@10': 0.9468, 'time@10': 21.1876}:  10%|█         | 1/10 [00:30<01:44, 11.62s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9803, 'compress@10': 0.9468, 'time@10': 21.1876}:  20%|██        | 2/10 [00:30<02:08, 16.11s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9392, 'compress@10': 0.7264, 'time@10': 17.4962}:  20%|██        | 2/10 [00:35<02:08, 16.11s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9392, 'compress@10': 0.7264, 'time@10': 17.4962}:  30%|███       | 3/10 [00:35<01:17, 11.08s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9445, 'compress@10': 0.6743, 'time@10': 17.8403}:  30%|███       | 3/10 [00:54<01:17, 11.08s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9445, 'compress@10': 0.6743, 'time@10': 17.8403}:  40%|████      | 4/10 [00:54<01:25, 14.17s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9497, 'compress@10': 0.685, 'time@10': 24.1877}:  40%|████      | 4/10 [01:19<01:25, 14.17s/it] {'epoch': 8, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9497, 'compress@10': 0.685, 'time@10': 24.1877}:  50%|█████     | 5/10 [01:19<01:30, 18.01s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9531, 'compress@10': 0.6379, 'time@10': 25.4016}:  50%|█████     | 5/10 [01:51<01:30, 18.01s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9531, 'compress@10': 0.6379, 'time@10': 25.4016}:  60%|██████    | 6/10 [01:51<01:30, 22.60s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9531, 'compress@10': 0.6515, 'time@10': 26.7119}:  60%|██████    | 6/10 [02:08<01:30, 22.60s/it] {'epoch': 8, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9531, 'compress@10': 0.6515, 'time@10': 26.7119}:  70%|███████   | 7/10 [02:08<01:02, 20.88s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0075, 'hit_ratio@10': 0.9205, 'ndcg@10': 0.9552, 'compress@10': 0.5804, 'time@10': 26.2005}:  70%|███████   | 7/10 [02:31<01:02, 20.88s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0075, 'hit_ratio@10': 0.9205, 'ndcg@10': 0.9552, 'compress@10': 0.5804, 'time@10': 26.2005}:  80%|████████  | 8/10 [02:31<00:42, 21.45s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0074, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9559, 'compress@10': 0.5491, 'time@10': 28.2935}:  80%|████████  | 8/10 [02:53<00:42, 21.45s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0074, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9559, 'compress@10': 0.5491, 'time@10': 28.2935}:  90%|█████████ | 9/10 [02:53<00:21, 21.79s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9671, 'compress@10': 0.5236, 'time@10': 28.3298}:  90%|█████████ | 9/10 [03:22<00:21, 21.79s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9671, 'compress@10': 0.5236, 'time@10': 28.3298}: 100%|██████████| 10/10 [03:22<00:00, 23.93s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9671, 'compress@10': 0.5236, 'time@10': 28.3298}: 100%|██████████| 10/10 [03:22<00:00, 20.25s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.010212797242051604
Avg hit ratio: 0.908402158867354
Avg ndcg: 0.9671125260303242
Avg compression ratio: 0.5235874944485134
Avg train time: 28.329837059974672
Std train time: 11.589733929474926
[0.95, 0.95, 0.15, 0.45, 0.65, 0.44999999999999996, 0.65, 0.05000000000000001, 0.35, 0.35]
[30, 30, 39, 30, 21, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.9526, 'time@10': 22.2619}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.9526, 'time@10': 22.2619}:  10%|█         | 1/10 [00:11<01:40, 11.17s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9437, 'compress@10': 0.9521, 'time@10': 20.5115}:  10%|█         | 1/10 [00:29<01:40, 11.17s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9437, 'compress@10': 0.9521, 'time@10': 20.5115}:  20%|██        | 2/10 [00:29<02:05, 15.66s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9149, 'compress@10': 0.7252, 'time@10': 17.0204}:  20%|██        | 2/10 [00:35<02:05, 15.66s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9149, 'compress@10': 0.7252, 'time@10': 17.0204}:  30%|███       | 3/10 [00:35<01:15, 10.82s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9267, 'compress@10': 0.6613, 'time@10': 17.4315}:  30%|███       | 3/10 [00:53<01:15, 10.82s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9267, 'compress@10': 0.6613, 'time@10': 17.4315}:  40%|████      | 4/10 [00:53<01:23, 13.94s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0072, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9358, 'compress@10': 0.6605, 'time@10': 23.4767}:  40%|████      | 4/10 [01:17<01:23, 13.94s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0072, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9358, 'compress@10': 0.6605, 'time@10': 23.4767}:  50%|█████     | 5/10 [01:17<01:27, 17.52s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0072, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9417, 'compress@10': 0.6274, 'time@10': 24.7119}:  50%|█████     | 5/10 [01:48<01:27, 17.52s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0072, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9417, 'compress@10': 0.6274, 'time@10': 24.7119}:  60%|██████    | 6/10 [01:48<01:28, 22.08s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9433, 'compress@10': 0.6326, 'time@10': 25.9745}:  60%|██████    | 6/10 [02:05<01:28, 22.08s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9433, 'compress@10': 0.6326, 'time@10': 25.9745}:  70%|███████   | 7/10 [02:05<01:01, 20.35s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0067, 'hit_ratio@10': 0.9192, 'ndcg@10': 0.9467, 'compress@10': 0.5632, 'time@10': 25.4516}:  70%|███████   | 7/10 [02:27<01:01, 20.35s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0067, 'hit_ratio@10': 0.9192, 'ndcg@10': 0.9467, 'compress@10': 0.5632, 'time@10': 25.4516}:  80%|████████  | 8/10 [02:27<00:41, 20.83s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0065, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9488, 'compress@10': 0.5416, 'time@10': 27.7202}:  80%|████████  | 8/10 [02:50<00:41, 20.83s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0065, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9488, 'compress@10': 0.5416, 'time@10': 27.7202}:  90%|█████████ | 9/10 [02:50<00:21, 21.50s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9436, 'compress@10': 0.5239, 'time@10': 27.9035}:  90%|█████████ | 9/10 [03:19<00:21, 21.50s/it]    {'epoch': 9, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9436, 'compress@10': 0.5239, 'time@10': 27.9035}: 100%|██████████| 10/10 [03:19<00:00, 24.00s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9436, 'compress@10': 0.5239, 'time@10': 27.9035}: 100%|██████████| 10/10 [03:19<00:00, 19.98s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.008260510606803686
Avg hit ratio: 0.9159700032093919
Avg ndcg: 0.943589566739654
Avg compression ratio: 0.5238990996726627
Avg train time: 27.903538632392884
Std train time: 11.46205169919982
[0.9545454545454545, 0.9545454545454545, 0.13636363636363635, 0.4090909090909091, 0.5909090909090909, 0.49999999999999994, 0.6818181818181819, 0.04545454545454546, 0.3181818181818182, 0.40909090909090906]
[30, 30, 40, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0061, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9189, 'compress@10': 0.9569, 'time@10': 22.4734}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0061, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9189, 'compress@10': 0.9569, 'time@10': 22.4734}:  10%|█         | 1/10 [00:11<01:41, 11.33s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9421, 'compress@10': 0.9565, 'time@10': 20.5634}:  10%|█         | 1/10 [00:30<01:41, 11.33s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9421, 'compress@10': 0.9565, 'time@10': 20.5634}:  20%|██        | 2/10 [00:30<02:05, 15.66s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9138, 'compress@10': 0.7242, 'time@10': 17.2161}:  20%|██        | 2/10 [00:35<02:05, 15.66s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9138, 'compress@10': 0.7242, 'time@10': 17.2161}:  30%|███       | 3/10 [00:35<01:16, 10.93s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9259, 'compress@10': 0.6507, 'time@10': 17.5675}:  30%|███       | 3/10 [00:53<01:16, 10.93s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9259, 'compress@10': 0.6507, 'time@10': 17.5675}:  40%|████      | 4/10 [00:53<01:23, 13.98s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0072, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.936, 'compress@10': 0.6404, 'time@10': 23.2588}:  40%|████      | 4/10 [01:17<01:23, 13.98s/it] {'epoch': 10, 'num_users': 5.8, 'loss': 0.0072, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.936, 'compress@10': 0.6404, 'time@10': 23.2588}:  50%|█████     | 5/10 [01:17<01:26, 17.25s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9423, 'compress@10': 0.6188, 'time@10': 24.4972}:  50%|█████     | 5/10 [01:47<01:26, 17.25s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9423, 'compress@10': 0.6188, 'time@10': 24.4972}:  60%|██████    | 6/10 [01:47<01:27, 21.83s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0071, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9439, 'compress@10': 0.6297, 'time@10': 25.7989}:  60%|██████    | 6/10 [02:04<01:27, 21.83s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0071, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9439, 'compress@10': 0.6297, 'time@10': 25.7989}:  70%|███████   | 7/10 [02:04<01:00, 20.20s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0072, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9471, 'compress@10': 0.56, 'time@10': 25.1812}:  70%|███████   | 7/10 [02:25<01:00, 20.20s/it]   {'epoch': 10, 'num_users': 6.125, 'loss': 0.0072, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9471, 'compress@10': 0.56, 'time@10': 25.1812}:  80%|████████  | 8/10 [02:25<00:40, 20.42s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0069, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9495, 'compress@10': 0.5353, 'time@10': 27.3627}:  80%|████████  | 8/10 [02:47<00:40, 20.42s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0069, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9495, 'compress@10': 0.5353, 'time@10': 27.3627}:  90%|█████████ | 9/10 [02:47<00:21, 21.05s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0075, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9534, 'compress@10': 0.5241, 'time@10': 27.5854}:  90%|█████████ | 9/10 [03:17<00:21, 21.05s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0075, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9534, 'compress@10': 0.5241, 'time@10': 27.5854}: 100%|██████████| 10/10 [03:17<00:00, 23.70s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0075, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9534, 'compress@10': 0.5241, 'time@10': 27.5854}: 100%|██████████| 10/10 [03:17<00:00, 19.76s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.007454934983694978
Avg hit ratio: 0.8974620667014556
Avg ndcg: 0.9534263290177692
Avg compression ratio: 0.524051417291398
Avg train time: 27.58535873889923
Std train time: 10.997787532460421
[0.8749999999999999, 0.9583333333333333, 0.12499999999999999, 0.375, 0.625, 0.5416666666666666, 0.625, 0.125, 0.2916666666666667, 0.4583333333333333]
[30, 30, 41, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0059, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9263, 'compress@10': 0.8816, 'time@10': 24.803}:   0%|          | 0/10 [00:12<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0059, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9263, 'compress@10': 0.8816, 'time@10': 24.803}:  10%|█         | 1/10 [00:12<01:51, 12.44s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.947, 'compress@10': 0.9206, 'time@10': 21.7053}:  10%|█         | 1/10 [00:31<01:51, 12.44s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.947, 'compress@10': 0.9206, 'time@10': 21.7053}:  20%|██        | 2/10 [00:31<02:08, 16.09s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0045, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.917, 'compress@10': 0.6971, 'time@10': 18.1742}:  20%|██        | 2/10 [00:36<02:08, 16.09s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0045, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.917, 'compress@10': 0.6971, 'time@10': 18.1742}:  30%|███       | 3/10 [00:36<01:19, 11.30s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9289, 'compress@10': 0.6221, 'time@10': 18.2448}:  30%|███       | 3/10 [00:55<01:19, 11.30s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9289, 'compress@10': 0.6221, 'time@10': 18.2448}:  40%|████      | 4/10 [00:55<01:24, 14.14s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.005, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9386, 'compress@10': 0.6242, 'time@10': 23.7019}:  40%|████      | 4/10 [01:17<01:24, 14.14s/it] {'epoch': 11, 'num_users': 5.8, 'loss': 0.005, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9386, 'compress@10': 0.6242, 'time@10': 23.7019}:  50%|█████     | 5/10 [01:17<01:26, 17.27s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9433, 'compress@10': 0.6121, 'time@10': 24.891}:  50%|█████     | 5/10 [01:48<01:26, 17.27s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9433, 'compress@10': 0.6121, 'time@10': 24.891}:  60%|██████    | 6/10 [01:48<01:27, 21.90s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0067, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9451, 'compress@10': 0.6161, 'time@10': 26.1503}:  60%|██████    | 6/10 [02:05<01:27, 21.90s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0067, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9451, 'compress@10': 0.6161, 'time@10': 26.1503}:  70%|███████   | 7/10 [02:05<01:00, 20.26s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0071, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9484, 'compress@10': 0.5579, 'time@10': 25.7482}:  70%|███████   | 7/10 [02:28<01:00, 20.26s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0071, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9484, 'compress@10': 0.5579, 'time@10': 25.7482}:  80%|████████  | 8/10 [02:28<00:42, 21.12s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0067, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9506, 'compress@10': 0.5305, 'time@10': 27.9327}:  80%|████████  | 8/10 [02:51<00:42, 21.12s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0067, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9506, 'compress@10': 0.5305, 'time@10': 27.9327}:  90%|█████████ | 9/10 [02:51<00:21, 21.63s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9583, 'compress@10': 0.5245, 'time@10': 28.1281}:  90%|█████████ | 9/10 [03:21<00:21, 21.63s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9583, 'compress@10': 0.5245, 'time@10': 28.1281}: 100%|██████████| 10/10 [03:21<00:00, 24.19s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9583, 'compress@10': 0.5245, 'time@10': 28.1281}: 100%|██████████| 10/10 [03:21<00:00, 20.14s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.008839810555274144
Avg hit ratio: 0.9030565367475385
Avg ndcg: 0.9583313269911399
Avg compression ratio: 0.5245450236476039
Avg train time: 28.128091073036195
Std train time: 10.74601541676159
[0.8076923076923076, 0.9615384615384615, 0.11538461538461538, 0.34615384615384615, 0.6538461538461539, 0.5769230769230769, 0.5769230769230769, 0.1923076923076923, 0.2692307692307693, 0.5]
[30, 30, 42, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.8178, 'time@10': 24.4999}:   0%|          | 0/10 [00:12<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.8178, 'time@10': 24.4999}:  10%|█         | 1/10 [00:12<01:50, 12.29s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9404, 'compress@10': 0.8903, 'time@10': 21.4471}:  10%|█         | 1/10 [00:30<01:50, 12.29s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9404, 'compress@10': 0.8903, 'time@10': 21.4471}:  20%|██        | 2/10 [00:30<02:07, 15.91s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9126, 'compress@10': 0.6741, 'time@10': 18.0464}:  20%|██        | 2/10 [00:36<02:07, 15.91s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9126, 'compress@10': 0.6741, 'time@10': 18.0464}:  30%|███       | 3/10 [00:36<01:18, 11.23s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9255, 'compress@10': 0.598, 'time@10': 18.1309}:  30%|███       | 3/10 [00:54<01:18, 11.23s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9255, 'compress@10': 0.598, 'time@10': 18.1309}:  40%|████      | 4/10 [00:54<01:24, 14.07s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9346, 'compress@10': 0.6105, 'time@10': 23.6649}:  40%|████      | 4/10 [01:17<01:24, 14.07s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9346, 'compress@10': 0.6105, 'time@10': 23.6649}:  50%|█████     | 5/10 [01:17<01:26, 17.27s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9417, 'compress@10': 0.6065, 'time@10': 24.9037}:  50%|█████     | 5/10 [01:48<01:26, 17.27s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9417, 'compress@10': 0.6065, 'time@10': 24.9037}:  60%|██████    | 6/10 [01:48<01:27, 21.98s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9438, 'compress@10': 0.6047, 'time@10': 26.1191}:  60%|██████    | 6/10 [02:05<01:27, 21.98s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9438, 'compress@10': 0.6047, 'time@10': 26.1191}:  70%|███████   | 7/10 [02:05<01:00, 20.28s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.947, 'compress@10': 0.556, 'time@10': 25.739}:  70%|███████   | 7/10 [02:28<01:00, 20.28s/it]    {'epoch': 12, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.947, 'compress@10': 0.556, 'time@10': 25.739}:  80%|████████  | 8/10 [02:28<00:42, 21.18s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9494, 'compress@10': 0.5265, 'time@10': 27.8753}:  80%|████████  | 8/10 [02:51<00:42, 21.18s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9494, 'compress@10': 0.5265, 'time@10': 27.8753}:  90%|█████████ | 9/10 [02:51<00:21, 21.60s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9522, 'compress@10': 0.525, 'time@10': 28.0441}:  90%|█████████ | 9/10 [03:20<00:21, 21.60s/it]    {'epoch': 12, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9522, 'compress@10': 0.525, 'time@10': 28.0441}: 100%|██████████| 10/10 [03:20<00:00, 24.07s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9522, 'compress@10': 0.525, 'time@10': 28.0441}: 100%|██████████| 10/10 [03:20<00:00, 20.09s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.010060473839325266
Avg hit ratio: 0.9163386668038621
Avg ndcg: 0.9521632483583577
Avg compression ratio: 0.5249619755981518
Avg train time: 28.04412739276886
Std train time: 10.714344674843412
[0.8214285714285714, 0.9642857142857142, 0.10714285714285714, 0.3214285714285714, 0.6785714285714286, 0.6071428571428571, 0.5357142857142857, 0.25, 0.25000000000000006, 0.4642857142857143]
[30, 30, 43, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9354, 'compress@10': 0.8308, 'time@10': 24.8371}:   0%|          | 0/10 [00:12<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9354, 'compress@10': 0.8308, 'time@10': 24.8371}:  10%|█         | 1/10 [00:12<01:52, 12.47s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.951, 'compress@10': 0.8981, 'time@10': 21.7756}:  10%|█         | 1/10 [00:31<01:52, 12.47s/it] {'epoch': 13, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.951, 'compress@10': 0.8981, 'time@10': 21.7756}:  20%|██        | 2/10 [00:31<02:09, 16.17s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9197, 'compress@10': 0.677, 'time@10': 18.3712}:  20%|██        | 2/10 [00:37<02:09, 16.17s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9197, 'compress@10': 0.677, 'time@10': 18.3712}:  30%|███       | 3/10 [00:37<01:20, 11.44s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9308, 'compress@10': 0.5941, 'time@10': 18.3507}:  30%|███       | 3/10 [00:55<01:20, 11.44s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9308, 'compress@10': 0.5941, 'time@10': 18.3507}:  40%|████      | 4/10 [00:55<01:24, 14.16s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.007, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9404, 'compress@10': 0.6123, 'time@10': 23.8044}:  40%|████      | 4/10 [01:18<01:24, 14.16s/it] {'epoch': 13, 'num_users': 5.8, 'loss': 0.007, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9404, 'compress@10': 0.6123, 'time@10': 23.8044}:  50%|█████     | 5/10 [01:18<01:26, 17.29s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0061, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9466, 'compress@10': 0.6129, 'time@10': 24.9976}:  50%|█████     | 5/10 [01:49<01:26, 17.29s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0061, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9466, 'compress@10': 0.6129, 'time@10': 24.9976}:  60%|██████    | 6/10 [01:49<01:27, 21.96s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.006, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9482, 'compress@10': 0.6045, 'time@10': 26.1375}:  60%|██████    | 6/10 [02:05<01:27, 21.96s/it] {'epoch': 13, 'num_users': 6.2857, 'loss': 0.006, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9482, 'compress@10': 0.6045, 'time@10': 26.1375}:  70%|███████   | 7/10 [02:05<01:00, 20.19s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0062, 'hit_ratio@10': 0.9094, 'ndcg@10': 0.9511, 'compress@10': 0.5629, 'time@10': 25.8142}:  70%|███████   | 7/10 [02:29<01:00, 20.19s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0062, 'hit_ratio@10': 0.9094, 'ndcg@10': 0.9511, 'compress@10': 0.5629, 'time@10': 25.8142}:  80%|████████  | 8/10 [02:29<00:42, 21.27s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0061, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.953, 'compress@10': 0.5305, 'time@10': 27.9785}:  80%|████████  | 8/10 [02:52<00:42, 21.27s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0061, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.953, 'compress@10': 0.5305, 'time@10': 27.9785}:  90%|█████████ | 9/10 [02:52<00:21, 21.71s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9554, 'compress@10': 0.5251, 'time@10': 28.1354}:  90%|█████████ | 9/10 [03:21<00:21, 21.71s/it]  {'epoch': 13, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9554, 'compress@10': 0.5251, 'time@10': 28.1354}: 100%|██████████| 10/10 [03:21<00:00, 24.14s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9554, 'compress@10': 0.5251, 'time@10': 28.1354}: 100%|██████████| 10/10 [03:21<00:00, 20.16s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.005921518978351539
Avg hit ratio: 0.9081359018269035
Avg ndcg: 0.9554135673987106
Avg compression ratio: 0.5251055816168819
Avg train time: 28.135407972335816
Std train time: 10.61026835738502
[0.8333333333333333, 0.9666666666666666, 0.09999999999999999, 0.3, 0.7000000000000001, 0.5666666666666667, 0.5666666666666667, 0.3, 0.2333333333333334, 0.43333333333333335]
[30, 30, 44, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9417, 'compress@10': 0.8421, 'time@10': 25.253}:   0%|          | 0/10 [00:12<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9417, 'compress@10': 0.8421, 'time@10': 25.253}:  10%|█         | 1/10 [00:12<01:55, 12.83s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9547, 'compress@10': 0.9049, 'time@10': 21.9873}:  10%|█         | 1/10 [00:31<01:55, 12.83s/it] {'epoch': 14, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9547, 'compress@10': 0.9049, 'time@10': 21.9873}:  20%|██        | 2/10 [00:31<02:10, 16.32s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9222, 'compress@10': 0.6795, 'time@10': 18.5108}:  20%|██        | 2/10 [00:37<02:10, 16.32s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9222, 'compress@10': 0.6795, 'time@10': 18.5108}:  30%|███       | 3/10 [00:37<01:20, 11.52s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9327, 'compress@10': 0.5908, 'time@10': 18.4107}:  30%|███       | 3/10 [00:55<01:20, 11.52s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9327, 'compress@10': 0.5908, 'time@10': 18.4107}:  40%|████      | 4/10 [00:55<01:24, 14.14s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0065, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9422, 'compress@10': 0.6139, 'time@10': 23.7409}:  40%|████      | 4/10 [01:18<01:24, 14.14s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0065, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9422, 'compress@10': 0.6139, 'time@10': 23.7409}:  50%|█████     | 5/10 [01:18<01:25, 17.18s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.9145, 'ndcg@10': 0.9493, 'compress@10': 0.6076, 'time@10': 24.9085}:  50%|█████     | 5/10 [01:48<01:25, 17.18s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.9145, 'ndcg@10': 0.9493, 'compress@10': 0.6076, 'time@10': 24.9085}:  60%|██████    | 6/10 [01:48<01:27, 21.80s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.921, 'ndcg@10': 0.9504, 'compress@10': 0.6042, 'time@10': 26.1347}:  60%|██████    | 6/10 [02:05<01:27, 21.80s/it] {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.921, 'ndcg@10': 0.9504, 'compress@10': 0.6042, 'time@10': 26.1347}:  70%|███████   | 7/10 [02:05<01:00, 20.16s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.9273, 'ndcg@10': 0.9531, 'compress@10': 0.5687, 'time@10': 25.8213}:  70%|███████   | 7/10 [02:29<01:00, 20.16s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.9273, 'ndcg@10': 0.9531, 'compress@10': 0.5687, 'time@10': 25.8213}:  80%|████████  | 8/10 [02:29<00:42, 21.28s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9551, 'compress@10': 0.5339, 'time@10': 27.8942}:  80%|████████  | 8/10 [02:51<00:42, 21.28s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9551, 'compress@10': 0.5339, 'time@10': 27.8942}:  90%|█████████ | 9/10 [02:51<00:21, 21.59s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9196, 'ndcg@10': 0.9547, 'compress@10': 0.5251, 'time@10': 28.0542}:  90%|█████████ | 9/10 [03:21<00:21, 21.59s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9196, 'ndcg@10': 0.9547, 'compress@10': 0.5251, 'time@10': 28.0542}: 100%|██████████| 10/10 [03:21<00:00, 24.04s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9196, 'ndcg@10': 0.9547, 'compress@10': 0.5251, 'time@10': 28.0542}: 100%|██████████| 10/10 [03:21<00:00, 20.12s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.009168707742174811
Avg hit ratio: 0.9195644732554749
Avg ndcg: 0.9547093740676843
Avg compression ratio: 0.525113266007478
Avg train time: 28.05415313243866
Std train time: 10.408682780878873
[0.8437499999999999, 0.9687499999999999, 0.09374999999999999, 0.28125, 0.7187500000000001, 0.59375, 0.53125, 0.28125, 0.21875000000000006, 0.46875]
[30, 30, 45, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9408, 'compress@10': 0.852, 'time@10': 24.9139}:   0%|          | 0/10 [00:12<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9408, 'compress@10': 0.852, 'time@10': 24.9139}:  10%|█         | 1/10 [00:12<01:52, 12.49s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9525, 'compress@10': 0.9109, 'time@10': 21.7704}:  10%|█         | 1/10 [00:31<01:52, 12.49s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9525, 'compress@10': 0.9109, 'time@10': 21.7704}:  20%|██        | 2/10 [00:31<02:08, 16.12s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9207, 'compress@10': 0.6816, 'time@10': 18.559}:  20%|██        | 2/10 [00:37<02:08, 16.12s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9207, 'compress@10': 0.6816, 'time@10': 18.559}:  30%|███       | 3/10 [00:37<01:20, 11.55s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9316, 'compress@10': 0.588, 'time@10': 18.4691}:  30%|███       | 3/10 [00:55<01:20, 11.55s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9316, 'compress@10': 0.588, 'time@10': 18.4691}:  40%|████      | 4/10 [00:55<01:25, 14.19s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9408, 'compress@10': 0.6152, 'time@10': 23.8389}:  40%|████      | 4/10 [01:18<01:25, 14.19s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9408, 'compress@10': 0.6152, 'time@10': 23.8389}:  50%|█████     | 5/10 [01:18<01:26, 17.26s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.947, 'compress@10': 0.6132, 'time@10': 24.9635}:  50%|█████     | 5/10 [01:48<01:26, 17.26s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.947, 'compress@10': 0.6132, 'time@10': 24.9635}:  60%|██████    | 6/10 [01:48<01:27, 21.80s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9484, 'compress@10': 0.6041, 'time@10': 26.1878}:  60%|██████    | 6/10 [02:05<01:27, 21.80s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9484, 'compress@10': 0.6041, 'time@10': 26.1878}:  70%|███████   | 7/10 [02:05<01:00, 20.17s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9513, 'compress@10': 0.5663, 'time@10': 25.8271}:  70%|███████   | 7/10 [02:28<01:00, 20.17s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9513, 'compress@10': 0.5663, 'time@10': 25.8271}:  80%|████████  | 8/10 [02:28<00:42, 21.18s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9536, 'compress@10': 0.5302, 'time@10': 27.8958}:  80%|████████  | 8/10 [02:51<00:42, 21.18s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9536, 'compress@10': 0.5302, 'time@10': 27.8958}:  90%|█████████ | 9/10 [02:51<00:21, 21.52s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9614, 'compress@10': 0.5253, 'time@10': 28.0619}:  90%|█████████ | 9/10 [03:20<00:21, 21.52s/it]  {'epoch': 15, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9614, 'compress@10': 0.5253, 'time@10': 28.0619}: 100%|██████████| 10/10 [03:20<00:00, 24.01s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9614, 'compress@10': 0.5253, 'time@10': 28.0619}: 100%|██████████| 10/10 [03:20<00:00, 20.08s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.010694529649268314
Avg hit ratio: 0.9094882073218236
Avg ndcg: 0.9613504953864457
Avg compression ratio: 0.5252671046664229
Avg train time: 28.06192305088043
Std train time: 10.378888608222045
[0.8529411764705881, 0.9705882352941175, 0.08823529411764705, 0.2647058823529412, 0.7352941176470589, 0.5588235294117647, 0.5, 0.3235294117647059, 0.20588235294117652, 0.5]
[30, 30, 46, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0017, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8607, 'time@10': 24.5578}:   0%|          | 0/10 [00:12<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0017, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.8607, 'time@10': 24.5578}:  10%|█         | 1/10 [00:12<01:50, 12.32s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.9161, 'time@10': 21.5079}:  10%|█         | 1/10 [00:30<01:50, 12.32s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.9161, 'time@10': 21.5079}:  20%|██        | 2/10 [00:30<02:07, 15.95s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.6836, 'time@10': 18.2793}:  20%|██        | 2/10 [00:36<02:07, 15.95s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.6836, 'time@10': 18.2793}:  30%|███       | 3/10 [00:36<01:19, 11.38s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9341, 'compress@10': 0.5854, 'time@10': 18.2575}:  30%|███       | 3/10 [00:54<01:19, 11.38s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9341, 'compress@10': 0.5854, 'time@10': 18.2575}:  40%|████      | 4/10 [00:54<01:24, 14.09s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0058, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9433, 'compress@10': 0.6164, 'time@10': 23.706}:  40%|████      | 4/10 [01:17<01:24, 14.09s/it] {'epoch': 16, 'num_users': 5.8, 'loss': 0.0058, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9433, 'compress@10': 0.6164, 'time@10': 23.706}:  50%|█████     | 5/10 [01:17<01:26, 17.23s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.008, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9538, 'compress@10': 0.6085, 'time@10': 24.9316}:  50%|█████     | 5/10 [01:48<01:26, 17.23s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.008, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9538, 'compress@10': 0.6085, 'time@10': 24.9316}:  60%|██████    | 6/10 [01:48<01:27, 21.94s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9547, 'compress@10': 0.5958, 'time@10': 26.1167}:  60%|██████    | 6/10 [02:05<01:27, 21.94s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9547, 'compress@10': 0.5958, 'time@10': 26.1167}:  70%|███████   | 7/10 [02:05<01:00, 20.21s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0075, 'hit_ratio@10': 0.9245, 'ndcg@10': 0.9568, 'compress@10': 0.5642, 'time@10': 25.7261}:  70%|███████   | 7/10 [02:28<01:00, 20.21s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0075, 'hit_ratio@10': 0.9245, 'ndcg@10': 0.9568, 'compress@10': 0.5642, 'time@10': 25.7261}:  80%|████████  | 8/10 [02:28<00:42, 21.11s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0073, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9584, 'compress@10': 0.5269, 'time@10': 27.5697}:  80%|████████  | 8/10 [02:49<00:42, 21.11s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0073, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9584, 'compress@10': 0.5269, 'time@10': 27.5697}:  90%|█████████ | 9/10 [02:49<00:21, 21.14s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0074, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.9603, 'compress@10': 0.5254, 'time@10': 27.6624}:  90%|█████████ | 9/10 [03:18<00:21, 21.14s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0074, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.9603, 'compress@10': 0.5254, 'time@10': 27.6624}: 100%|██████████| 10/10 [03:18<00:00, 23.42s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0074, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.9603, 'compress@10': 0.5254, 'time@10': 27.6624}: 100%|██████████| 10/10 [03:18<00:00, 19.83s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.007417425892027781
Avg hit ratio: 0.9173422510332527
Avg ndcg: 0.9602797608380491
Avg compression ratio: 0.5253653176708303
Avg train time: 27.662355828285218
Std train time: 10.163393022183113
[0.8055555555555555, 0.9722222222222221, 0.08333333333333333, 0.25, 0.75, 0.5833333333333334, 0.4722222222222222, 0.36111111111111116, 0.19444444444444448, 0.5277777777777778]
[30, 30, 47, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.8158, 'time@10': 23.4722}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.8158, 'time@10': 23.4722}:  10%|█         | 1/10 [00:11<01:45, 11.77s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9553, 'compress@10': 0.8944, 'time@10': 20.3543}:  10%|█         | 1/10 [00:29<01:45, 11.77s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9553, 'compress@10': 0.8944, 'time@10': 20.3543}:  20%|██        | 2/10 [00:29<02:00, 15.01s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9226, 'compress@10': 0.6677, 'time@10': 17.2833}:  20%|██        | 2/10 [00:34<02:00, 15.01s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9226, 'compress@10': 0.6677, 'time@10': 17.2833}:  30%|███       | 3/10 [00:34<01:15, 10.72s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.933, 'compress@10': 0.57, 'time@10': 17.2181}:  30%|███       | 3/10 [00:51<01:15, 10.72s/it]   {'epoch': 17, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.933, 'compress@10': 0.57, 'time@10': 17.2181}:  40%|████      | 4/10 [00:51<01:19, 13.22s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0067, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9424, 'compress@10': 0.607, 'time@10': 22.4191}:  40%|████      | 4/10 [01:13<01:19, 13.22s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0067, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9424, 'compress@10': 0.607, 'time@10': 22.4191}:  50%|█████     | 5/10 [01:13<01:21, 16.26s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0057, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9483, 'compress@10': 0.6046, 'time@10': 23.5433}:  50%|█████     | 5/10 [01:42<01:21, 16.26s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0057, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9483, 'compress@10': 0.6046, 'time@10': 23.5433}:  60%|██████    | 6/10 [01:42<01:22, 20.66s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0055, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.95, 'compress@10': 0.5887, 'time@10': 24.7249}:  60%|██████    | 6/10 [01:58<01:22, 20.66s/it] {'epoch': 17, 'num_users': 6.2857, 'loss': 0.0055, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.95, 'compress@10': 0.5887, 'time@10': 24.7249}:  70%|███████   | 7/10 [01:58<00:57, 19.12s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0057, 'hit_ratio@10': 0.9149, 'ndcg@10': 0.9527, 'compress@10': 0.5625, 'time@10': 24.4206}:  70%|███████   | 7/10 [02:20<00:57, 19.12s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0057, 'hit_ratio@10': 0.9149, 'ndcg@10': 0.9527, 'compress@10': 0.5625, 'time@10': 24.4206}:  80%|████████  | 8/10 [02:20<00:40, 20.14s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0061, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9547, 'compress@10': 0.5242, 'time@10': 26.2705}:  80%|████████  | 8/10 [02:41<00:40, 20.14s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0061, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9547, 'compress@10': 0.5242, 'time@10': 26.2705}:  90%|█████████ | 9/10 [02:41<00:20, 20.27s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0068, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9585, 'compress@10': 0.5256, 'time@10': 26.4873}:  90%|█████████ | 9/10 [03:09<00:20, 20.27s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0068, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9585, 'compress@10': 0.5256, 'time@10': 26.4873}: 100%|██████████| 10/10 [03:09<00:00, 22.81s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0068, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9585, 'compress@10': 0.5256, 'time@10': 26.4873}: 100%|██████████| 10/10 [03:09<00:00, 18.99s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.0067881739247851345
Avg hit ratio: 0.9011005715657667
Avg ndcg: 0.9584984276870452
Avg compression ratio: 0.5256223417537185
Avg train time: 26.487330412864686
Std train time: 9.846081647409655
[0.763157894736842, 0.9736842105263157, 0.07894736842105263, 0.2368421052631579, 0.7631578947368421, 0.5526315789473685, 0.4473684210526316, 0.3947368421052632, 0.23684210526315794, 0.5526315789473685]
[30, 30, 48, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0054, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.7756, 'time@10': 23.2746}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0054, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.7756, 'time@10': 23.2746}:  10%|█         | 1/10 [00:11<01:45, 11.70s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9567, 'compress@10': 0.8751, 'time@10': 20.3149}:  10%|█         | 1/10 [00:29<01:45, 11.70s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9567, 'compress@10': 0.8751, 'time@10': 20.3149}:  20%|██        | 2/10 [00:29<02:00, 15.05s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9235, 'compress@10': 0.6536, 'time@10': 17.4827}:  20%|██        | 2/10 [00:35<02:00, 15.05s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9235, 'compress@10': 0.6536, 'time@10': 17.4827}:  30%|███       | 3/10 [00:35<01:16, 10.89s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9337, 'compress@10': 0.5562, 'time@10': 17.401}:  30%|███       | 3/10 [00:52<01:16, 10.89s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9337, 'compress@10': 0.5562, 'time@10': 17.401}:  40%|████      | 4/10 [00:52<01:20, 13.38s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9429, 'compress@10': 0.5985, 'time@10': 22.3931}:  40%|████      | 4/10 [01:13<01:20, 13.38s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9429, 'compress@10': 0.5985, 'time@10': 22.3931}:  50%|█████     | 5/10 [01:13<01:21, 16.21s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0081, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9484, 'compress@10': 0.5925, 'time@10': 23.5164}:  50%|█████     | 5/10 [01:42<01:21, 16.21s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0081, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9484, 'compress@10': 0.5925, 'time@10': 23.5164}:  60%|██████    | 6/10 [01:42<01:22, 20.61s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.95, 'compress@10': 0.575, 'time@10': 24.7259}:  60%|██████    | 6/10 [01:58<01:22, 20.61s/it]   {'epoch': 18, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.95, 'compress@10': 0.575, 'time@10': 24.7259}:  70%|███████   | 7/10 [01:58<00:57, 19.11s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0082, 'hit_ratio@10': 0.9205, 'ndcg@10': 0.9521, 'compress@10': 0.5546, 'time@10': 24.3933}:  70%|███████   | 7/10 [02:20<00:57, 19.11s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0082, 'hit_ratio@10': 0.9205, 'ndcg@10': 0.9521, 'compress@10': 0.5546, 'time@10': 24.3933}:  80%|████████  | 8/10 [02:20<00:40, 20.07s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9539, 'compress@10': 0.5217, 'time@10': 26.3254}:  80%|████████  | 8/10 [02:41<00:40, 20.07s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9539, 'compress@10': 0.5217, 'time@10': 26.3254}:  90%|█████████ | 9/10 [02:41<00:20, 20.33s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9563, 'compress@10': 0.5258, 'time@10': 26.4874}:  90%|█████████ | 9/10 [03:09<00:20, 20.33s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9563, 'compress@10': 0.5258, 'time@10': 26.4874}: 100%|██████████| 10/10 [03:09<00:00, 22.70s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9563, 'compress@10': 0.5258, 'time@10': 26.4874}: 100%|██████████| 10/10 [03:09<00:00, 18.97s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.009344695847387067
Avg hit ratio: 0.908402158867354
Avg ndcg: 0.9562545067589161
Avg compression ratio: 0.5258166273188609
Avg train time: 26.48741681575775
Std train time: 9.69937841079581
[0.725, 0.9749999999999999, 0.075, 0.225, 0.7250000000000001, 0.5750000000000001, 0.425, 0.42500000000000004, 0.275, 0.5750000000000001]
[30, 30, 49, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0036, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7395, 'time@10': 23.6812}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0036, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7395, 'time@10': 23.6812}:  10%|█         | 1/10 [00:11<01:46, 11.88s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9558, 'compress@10': 0.8576, 'time@10': 20.5021}:  10%|█         | 1/10 [00:29<01:46, 11.88s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9558, 'compress@10': 0.8576, 'time@10': 20.5021}:  20%|██        | 2/10 [00:29<02:00, 15.10s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9229, 'compress@10': 0.6408, 'time@10': 17.6664}:  20%|██        | 2/10 [00:35<02:00, 15.10s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9229, 'compress@10': 0.6408, 'time@10': 17.6664}:  30%|███       | 3/10 [00:35<01:16, 10.96s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9333, 'compress@10': 0.5438, 'time@10': 17.5412}:  30%|███       | 3/10 [00:52<01:16, 10.96s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9333, 'compress@10': 0.5438, 'time@10': 17.5412}:  40%|████      | 4/10 [00:52<01:20, 13.43s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.007, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9426, 'compress@10': 0.5811, 'time@10': 22.7504}:  40%|████      | 4/10 [01:14<01:20, 13.43s/it] {'epoch': 19, 'num_users': 5.8, 'loss': 0.007, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9426, 'compress@10': 0.5811, 'time@10': 22.7504}:  50%|█████     | 5/10 [01:14<01:22, 16.46s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0069, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9485, 'compress@10': 0.5817, 'time@10': 23.7987}:  50%|█████     | 5/10 [01:43<01:22, 16.46s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0069, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9485, 'compress@10': 0.5817, 'time@10': 23.7987}:  60%|██████    | 6/10 [01:43<01:22, 20.75s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0066, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9501, 'compress@10': 0.5626, 'time@10': 24.8891}:  60%|██████    | 6/10 [01:59<01:22, 20.75s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0066, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9501, 'compress@10': 0.5626, 'time@10': 24.8891}:  70%|███████   | 7/10 [01:59<00:57, 19.11s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9471, 'compress@10': 0.5474, 'time@10': 24.5378}:  70%|███████   | 7/10 [02:21<00:57, 19.11s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9471, 'compress@10': 0.5474, 'time@10': 24.5378}:  80%|████████  | 8/10 [02:21<00:40, 20.07s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0098, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9573, 'compress@10': 0.5195, 'time@10': 26.5362}:  80%|████████  | 8/10 [02:42<00:40, 20.07s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0098, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9573, 'compress@10': 0.5195, 'time@10': 26.5362}:  90%|█████████ | 9/10 [02:42<00:20, 20.45s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9593, 'compress@10': 0.526, 'time@10': 26.7628}:  90%|█████████ | 9/10 [03:11<00:20, 20.45s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9593, 'compress@10': 0.526, 'time@10': 26.7628}: 100%|██████████| 10/10 [03:11<00:00, 23.05s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9593, 'compress@10': 0.526, 'time@10': 26.7628}: 100%|██████████| 10/10 [03:11<00:00, 19.14s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.009190668514948097
Avg hit ratio: 0.9059136796046813
Avg ndcg: 0.9592575123334888
Avg compression ratio: 0.5259813082421573
Avg train time: 26.762804913520814
Std train time: 9.966570458929782
[0.6904761904761905, 0.976190476190476, 0.07142857142857142, 0.2142857142857143, 0.7380952380952381, 0.5952380952380953, 0.40476190476190477, 0.45238095238095244, 0.30952380952380953, 0.5476190476190477]
[30, 30, 50, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7068, 'time@10': 23.9175}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.7068, 'time@10': 23.9175}:  10%|█         | 1/10 [00:11<01:47, 12.00s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.8418, 'time@10': 20.5392}:  10%|█         | 1/10 [00:29<01:47, 12.00s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.8418, 'time@10': 20.5392}:  20%|██        | 2/10 [00:29<02:00, 15.06s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.6293, 'time@10': 17.6991}:  20%|██        | 2/10 [00:35<02:00, 15.06s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.6293, 'time@10': 17.6991}:  30%|███       | 3/10 [00:35<01:16, 10.95s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9341, 'compress@10': 0.5325, 'time@10': 17.4753}:  30%|███       | 3/10 [00:52<01:16, 10.95s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9341, 'compress@10': 0.5325, 'time@10': 17.4753}:  40%|████      | 4/10 [00:52<01:19, 13.28s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0046, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9433, 'compress@10': 0.5747, 'time@10': 22.4784}:  40%|████      | 4/10 [01:13<01:19, 13.28s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0046, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9433, 'compress@10': 0.5747, 'time@10': 22.4784}:  50%|█████     | 5/10 [01:13<01:20, 16.16s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0067, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9524, 'compress@10': 0.5796, 'time@10': 23.5917}:  50%|█████     | 5/10 [01:42<01:20, 16.16s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0067, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9524, 'compress@10': 0.5796, 'time@10': 23.5917}:  60%|██████    | 6/10 [01:42<01:22, 20.59s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0062, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9535, 'compress@10': 0.558, 'time@10': 24.6581}:  60%|██████    | 6/10 [01:58<01:22, 20.59s/it] {'epoch': 20, 'num_users': 6.2857, 'loss': 0.0062, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9535, 'compress@10': 0.558, 'time@10': 24.6581}:  70%|███████   | 7/10 [01:58<00:56, 18.95s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.006, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9557, 'compress@10': 0.5468, 'time@10': 24.3713}:  70%|███████   | 7/10 [02:20<00:56, 18.95s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.006, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9557, 'compress@10': 0.5468, 'time@10': 24.3713}:  80%|████████  | 8/10 [02:20<00:40, 20.05s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0061, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9575, 'compress@10': 0.5226, 'time@10': 26.418}:  80%|████████  | 8/10 [02:42<00:40, 20.05s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0061, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9575, 'compress@10': 0.5226, 'time@10': 26.418}:  90%|█████████ | 9/10 [02:42<00:20, 20.49s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0072, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9578, 'compress@10': 0.5261, 'time@10': 26.6154}:  90%|█████████ | 9/10 [03:10<00:20, 20.49s/it]  {'epoch': 20, 'num_users': 6.3, 'loss': 0.0072, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9578, 'compress@10': 0.5261, 'time@10': 26.6154}: 100%|██████████| 10/10 [03:10<00:00, 22.94s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0072, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9578, 'compress@10': 0.5261, 'time@10': 26.6154}: 100%|██████████| 10/10 [03:10<00:00, 19.04s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.0071563139192743624
Avg hit ratio: 0.8964656509308462
Avg ndcg: 0.9578009837175696
Avg compression ratio: 0.5261446542113662
Avg train time: 26.615413999557497
Std train time: 9.834179527366326
[0.6590909090909091, 0.9772727272727272, 0.06818181818181818, 0.20454545454545456, 0.75, 0.6136363636363638, 0.38636363636363635, 0.4318181818181819, 0.34090909090909094, 0.5681818181818182]
[30, 30, 51, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0061, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.677, 'time@10': 23.652}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0061, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.677, 'time@10': 23.652}:  10%|█         | 1/10 [00:11<01:46, 11.86s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.8275, 'time@10': 20.5181}:  10%|█         | 1/10 [00:29<01:46, 11.86s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.8275, 'time@10': 20.5181}:  20%|██        | 2/10 [00:29<02:01, 15.13s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9241, 'compress@10': 0.6188, 'time@10': 17.6451}:  20%|██        | 2/10 [00:35<02:01, 15.13s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9241, 'compress@10': 0.6188, 'time@10': 17.6451}:  30%|███       | 3/10 [00:35<01:16, 10.96s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9341, 'compress@10': 0.5223, 'time@10': 17.5447}:  30%|███       | 3/10 [00:52<01:16, 10.96s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9341, 'compress@10': 0.5223, 'time@10': 17.5447}:  40%|████      | 4/10 [00:52<01:20, 13.45s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9433, 'compress@10': 0.5689, 'time@10': 22.587}:  40%|████      | 4/10 [01:13<01:20, 13.45s/it] {'epoch': 21, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9433, 'compress@10': 0.5689, 'time@10': 22.587}:  50%|█████     | 5/10 [01:13<01:21, 16.32s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0064, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9491, 'compress@10': 0.5778, 'time@10': 23.7238}:  50%|█████     | 5/10 [01:43<01:21, 16.32s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0064, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9491, 'compress@10': 0.5778, 'time@10': 23.7238}:  60%|██████    | 6/10 [01:43<01:23, 20.79s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9494, 'compress@10': 0.5539, 'time@10': 24.9019}:  60%|██████    | 6/10 [01:59<01:23, 20.79s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9494, 'compress@10': 0.5539, 'time@10': 24.9019}:  70%|███████   | 7/10 [01:59<00:57, 19.23s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9534, 'compress@10': 0.5407, 'time@10': 24.592}:  70%|███████   | 7/10 [02:21<00:57, 19.23s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9534, 'compress@10': 0.5407, 'time@10': 24.592}:  80%|████████  | 8/10 [02:21<00:40, 20.26s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9593, 'compress@10': 0.5206, 'time@10': 26.6636}:  80%|████████  | 8/10 [02:43<00:40, 20.26s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9593, 'compress@10': 0.5206, 'time@10': 26.6636}:  90%|█████████ | 9/10 [02:43<00:20, 20.69s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9619, 'compress@10': 0.5263, 'time@10': 26.857}:  90%|█████████ | 9/10 [03:12<00:20, 20.69s/it]     {'epoch': 21, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9619, 'compress@10': 0.5263, 'time@10': 26.857}: 100%|██████████| 10/10 [03:12<00:00, 23.15s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9619, 'compress@10': 0.5263, 'time@10': 26.857}: 100%|██████████| 10/10 [03:12<00:00, 19.22s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.011025920018512799
Avg hit ratio: 0.8973422510332527
Avg ndcg: 0.9619375520561029
Avg compression ratio: 0.526319313030104
Avg train time: 26.856986951828002
Std train time: 9.96286055109367
[0.6304347826086957, 0.9782608695652173, 0.06521739130434782, 0.1956521739130435, 0.717391304347826, 0.5869565217391306, 0.41304347826086957, 0.4565217391304348, 0.3695652173913044, 0.5869565217391305]
[30, 30, 52, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0026, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6499, 'time@10': 24.2874}:   0%|          | 0/10 [00:12<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0026, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6499, 'time@10': 24.2874}:  10%|█         | 1/10 [00:12<01:49, 12.20s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0051, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.8144, 'time@10': 20.7701}:  10%|█         | 1/10 [00:29<01:49, 12.20s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0051, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.8144, 'time@10': 20.7701}:  20%|██        | 2/10 [00:29<02:01, 15.19s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9241, 'compress@10': 0.6092, 'time@10': 17.9787}:  20%|██        | 2/10 [00:35<02:01, 15.19s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9241, 'compress@10': 0.6092, 'time@10': 17.9787}:  30%|███       | 3/10 [00:35<01:17, 11.10s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0037, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9341, 'compress@10': 0.513, 'time@10': 17.7057}:  30%|███       | 3/10 [00:52<01:17, 11.10s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0037, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9341, 'compress@10': 0.513, 'time@10': 17.7057}:  40%|████      | 4/10 [00:52<01:20, 13.40s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0041, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9433, 'compress@10': 0.555, 'time@10': 22.7738}:  40%|████      | 4/10 [01:14<01:20, 13.40s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0041, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9433, 'compress@10': 0.555, 'time@10': 22.7738}:  50%|█████     | 5/10 [01:14<01:21, 16.34s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0065, 'hit_ratio@10': 0.887, 'ndcg@10': 0.951, 'compress@10': 0.5619, 'time@10': 23.8679}:  50%|█████     | 5/10 [01:43<01:21, 16.34s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0065, 'hit_ratio@10': 0.887, 'ndcg@10': 0.951, 'compress@10': 0.5619, 'time@10': 23.8679}:  60%|██████    | 6/10 [01:43<01:23, 20.77s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0057, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9522, 'compress@10': 0.544, 'time@10': 24.9002}:  60%|██████    | 6/10 [01:59<01:23, 20.77s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0057, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9522, 'compress@10': 0.544, 'time@10': 24.9002}:  70%|███████   | 7/10 [01:59<00:57, 19.08s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0058, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9546, 'compress@10': 0.535, 'time@10': 24.5468}:  70%|███████   | 7/10 [02:21<00:57, 19.08s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0058, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9546, 'compress@10': 0.535, 'time@10': 24.5468}:  80%|████████  | 8/10 [02:21<00:40, 20.04s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9625, 'compress@10': 0.5186, 'time@10': 26.6582}:  80%|████████  | 8/10 [02:43<00:40, 20.04s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9625, 'compress@10': 0.5186, 'time@10': 26.6582}:  90%|█████████ | 9/10 [02:43<00:20, 20.60s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.964, 'compress@10': 0.5264, 'time@10': 26.8235}:  90%|█████████ | 9/10 [03:11<00:20, 20.60s/it]    {'epoch': 22, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.964, 'compress@10': 0.5264, 'time@10': 26.8235}: 100%|██████████| 10/10 [03:11<00:00, 22.99s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.964, 'compress@10': 0.5264, 'time@10': 26.8235}: 100%|██████████| 10/10 [03:11<00:00, 19.15s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.00827050985382769
Avg hit ratio: 0.9030565367475385
Avg ndcg: 0.9639601160107821
Avg compression ratio: 0.5263618908399389
Avg train time: 26.82347927093506
Std train time: 9.985993709698125
[0.6041666666666667, 0.9791666666666665, 0.0625, 0.1875, 0.7291666666666666, 0.6041666666666669, 0.3958333333333333, 0.4791666666666667, 0.39583333333333337, 0.5625]
[30, 30, 53, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0038, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.625, 'time@10': 23.713}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0038, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.625, 'time@10': 23.713}:  10%|█         | 1/10 [00:11<01:47, 11.89s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.957, 'compress@10': 0.8024, 'time@10': 20.4783}:  10%|█         | 1/10 [00:29<01:47, 11.89s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.957, 'compress@10': 0.8024, 'time@10': 20.4783}:  20%|██        | 2/10 [00:29<02:00, 15.06s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9237, 'compress@10': 0.6004, 'time@10': 17.7285}:  20%|██        | 2/10 [00:35<02:00, 15.06s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9237, 'compress@10': 0.6004, 'time@10': 17.7285}:  30%|███       | 3/10 [00:35<01:16, 10.99s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9338, 'compress@10': 0.5044, 'time@10': 17.5368}:  30%|███       | 3/10 [00:52<01:16, 10.99s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9338, 'compress@10': 0.5044, 'time@10': 17.5368}:  40%|████      | 4/10 [00:52<01:20, 13.36s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0065, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9431, 'compress@10': 0.5505, 'time@10': 22.6275}:  40%|████      | 4/10 [01:13<01:20, 13.36s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0065, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9431, 'compress@10': 0.5505, 'time@10': 22.6275}:  50%|█████     | 5/10 [01:13<01:21, 16.31s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0065, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9489, 'compress@10': 0.5609, 'time@10': 23.6746}:  50%|█████     | 5/10 [01:42<01:21, 16.31s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0065, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9489, 'compress@10': 0.5609, 'time@10': 23.6746}:  60%|██████    | 6/10 [01:42<01:22, 20.61s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0057, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9505, 'compress@10': 0.5408, 'time@10': 24.81}:  60%|██████    | 6/10 [01:58<01:22, 20.61s/it]   {'epoch': 23, 'num_users': 6.2857, 'loss': 0.0057, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9505, 'compress@10': 0.5408, 'time@10': 24.81}:  70%|███████   | 7/10 [01:58<00:57, 19.05s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0056, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9531, 'compress@10': 0.5349, 'time@10': 24.4595}:  70%|███████   | 7/10 [02:20<00:57, 19.05s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0056, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9531, 'compress@10': 0.5349, 'time@10': 24.4595}:  80%|████████  | 8/10 [02:20<00:40, 20.00s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0062, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9551, 'compress@10': 0.5214, 'time@10': 26.538}:  80%|████████  | 8/10 [02:42<00:40, 20.00s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0062, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9551, 'compress@10': 0.5214, 'time@10': 26.538}:  90%|█████████ | 9/10 [02:42<00:20, 20.51s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.006, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9573, 'compress@10': 0.5265, 'time@10': 26.7125}:  90%|█████████ | 9/10 [03:10<00:20, 20.51s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.006, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9573, 'compress@10': 0.5265, 'time@10': 26.7125}: 100%|██████████| 10/10 [03:10<00:00, 22.92s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.006, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9573, 'compress@10': 0.5265, 'time@10': 26.7125}: 100%|██████████| 10/10 [03:10<00:00, 19.06s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.0060487472689814215
Avg hit ratio: 0.896338666803862
Avg ndcg: 0.9573290592989279
Avg compression ratio: 0.5264864845830597
Avg train time: 26.712464880943298
Std train time: 9.96363680449609
[0.5800000000000001, 0.9799999999999999, 0.06, 0.22, 0.74, 0.6200000000000002, 0.38, 0.46, 0.42000000000000004, 0.54]
[30, 30, 54, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0013, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.6021, 'time@10': 24.0105}:   0%|          | 0/10 [00:12<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0013, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.6021, 'time@10': 24.0105}:  10%|█         | 1/10 [00:12<01:48, 12.04s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.7914, 'time@10': 20.6271}:  10%|█         | 1/10 [00:29<01:48, 12.04s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.7914, 'time@10': 20.6271}:  20%|██        | 2/10 [00:29<02:00, 15.12s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.5923, 'time@10': 17.7808}:  20%|██        | 2/10 [00:35<02:00, 15.12s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9241, 'compress@10': 0.5923, 'time@10': 17.7808}:  30%|███       | 3/10 [00:35<01:16, 10.99s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0046, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.9341, 'compress@10': 0.5062, 'time@10': 17.6621}:  30%|███       | 3/10 [00:52<01:16, 10.99s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0046, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.9341, 'compress@10': 0.5062, 'time@10': 17.6621}:  40%|████      | 4/10 [00:52<01:21, 13.50s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0048, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9433, 'compress@10': 0.554, 'time@10': 22.706}:  40%|████      | 4/10 [01:14<01:21, 13.50s/it]   {'epoch': 24, 'num_users': 5.8, 'loss': 0.0048, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9433, 'compress@10': 0.554, 'time@10': 22.706}:  50%|█████     | 5/10 [01:14<01:21, 16.38s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0055, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9498, 'compress@10': 0.5664, 'time@10': 23.7779}:  50%|█████     | 5/10 [01:43<01:21, 16.38s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0055, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9498, 'compress@10': 0.5664, 'time@10': 23.7779}:  60%|██████    | 6/10 [01:43<01:22, 20.73s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.005, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9513, 'compress@10': 0.5433, 'time@10': 24.9379}:  60%|██████    | 6/10 [01:59<01:22, 20.73s/it] {'epoch': 24, 'num_users': 6.2857, 'loss': 0.005, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9513, 'compress@10': 0.5433, 'time@10': 24.9379}:  70%|███████   | 7/10 [01:59<00:57, 19.18s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.005, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9538, 'compress@10': 0.5348, 'time@10': 24.6353}:  70%|███████   | 7/10 [02:21<00:57, 19.18s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.005, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9538, 'compress@10': 0.5348, 'time@10': 24.6353}:  80%|████████  | 8/10 [02:21<00:40, 20.25s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0049, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9558, 'compress@10': 0.5239, 'time@10': 26.712}:  80%|████████  | 8/10 [02:43<00:40, 20.25s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0049, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9558, 'compress@10': 0.5239, 'time@10': 26.712}:  90%|█████████ | 9/10 [02:43<00:20, 20.70s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0047, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9579, 'compress@10': 0.5266, 'time@10': 26.8396}:  90%|█████████ | 9/10 [03:11<00:20, 20.70s/it] {'epoch': 24, 'num_users': 6.3, 'loss': 0.0047, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9579, 'compress@10': 0.5266, 'time@10': 26.8396}: 100%|██████████| 10/10 [03:11<00:00, 22.96s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0047, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9579, 'compress@10': 0.5266, 'time@10': 26.8396}: 100%|██████████| 10/10 [03:11<00:00, 19.17s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.0046871644993348414
Avg hit ratio: 0.8996699789552082
Avg ndcg: 0.9579100619241799
Avg compression ratio: 0.5265753566059407
Avg train time: 26.839565110206603
Std train time: 9.942680731769116
[0.5576923076923077, 0.9807692307692306, 0.05769230769230769, 0.25, 0.75, 0.6346153846153848, 0.36538461538461536, 0.4807692307692308, 0.4038461538461539, 0.5192307692307693]
[30, 30, 55, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0026, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.581, 'time@10': 23.7449}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0026, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.581, 'time@10': 23.7449}:  10%|█         | 1/10 [00:11<01:47, 11.91s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9576, 'compress@10': 0.7812, 'time@10': 20.5101}:  10%|█         | 1/10 [00:29<01:47, 11.91s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9576, 'compress@10': 0.7812, 'time@10': 20.5101}:  20%|██        | 2/10 [00:29<02:00, 15.09s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9241, 'compress@10': 0.5849, 'time@10': 17.7544}:  20%|██        | 2/10 [00:35<02:00, 15.09s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9241, 'compress@10': 0.5849, 'time@10': 17.7544}:  30%|███       | 3/10 [00:35<01:17, 11.01s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9341, 'compress@10': 0.5079, 'time@10': 17.5734}:  30%|███       | 3/10 [00:52<01:17, 11.01s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9341, 'compress@10': 0.5079, 'time@10': 17.5734}:  40%|████      | 4/10 [00:52<01:20, 13.40s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0058, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9433, 'compress@10': 0.5573, 'time@10': 22.519}:  40%|████      | 4/10 [01:13<01:20, 13.40s/it] {'epoch': 25, 'num_users': 5.8, 'loss': 0.0058, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9433, 'compress@10': 0.5573, 'time@10': 22.519}:  50%|█████     | 5/10 [01:13<01:21, 16.21s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0075, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9541, 'compress@10': 0.5715, 'time@10': 23.615}:  50%|█████     | 5/10 [01:42<01:21, 16.21s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0075, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9541, 'compress@10': 0.5715, 'time@10': 23.615}:  60%|██████    | 6/10 [01:42<01:22, 20.60s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0071, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9549, 'compress@10': 0.5457, 'time@10': 24.6419}:  60%|██████    | 6/10 [01:58<01:22, 20.60s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0071, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9549, 'compress@10': 0.5457, 'time@10': 24.6419}:  70%|███████   | 7/10 [01:58<00:56, 18.92s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0069, 'hit_ratio@10': 0.9258, 'ndcg@10': 0.957, 'compress@10': 0.5394, 'time@10': 24.3657}:  70%|███████   | 7/10 [02:20<00:56, 18.92s/it]  {'epoch': 25, 'num_users': 6.125, 'loss': 0.0069, 'hit_ratio@10': 0.9258, 'ndcg@10': 0.957, 'compress@10': 0.5394, 'time@10': 24.3657}:  80%|████████  | 8/10 [02:20<00:40, 20.05s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0068, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9586, 'compress@10': 0.5263, 'time@10': 26.4447}:  80%|████████  | 8/10 [02:42<00:40, 20.05s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0068, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9586, 'compress@10': 0.5263, 'time@10': 26.4447}:  90%|█████████ | 9/10 [02:42<00:20, 20.52s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0063, 'hit_ratio@10': 0.9155, 'ndcg@10': 0.9605, 'compress@10': 0.5267, 'time@10': 26.5878}:  90%|█████████ | 9/10 [03:10<00:20, 20.52s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0063, 'hit_ratio@10': 0.9155, 'ndcg@10': 0.9605, 'compress@10': 0.5267, 'time@10': 26.5878}: 100%|██████████| 10/10 [03:10<00:00, 22.81s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0063, 'hit_ratio@10': 0.9155, 'ndcg@10': 0.9605, 'compress@10': 0.5267, 'time@10': 26.5878}: 100%|██████████| 10/10 [03:10<00:00, 19.02s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.006331633786362869
Avg hit ratio: 0.9154886924055005
Avg ndcg: 0.9604747177428182
Avg compression ratio: 0.5266572670727518
Avg train time: 26.587811017036437
Std train time: 9.765823054845804
[0.5370370370370371, 0.9814814814814813, 0.05555555555555555, 0.2777777777777778, 0.7592592592592593, 0.6481481481481484, 0.3518518518518518, 0.46296296296296297, 0.425925925925926, 0.5]
[30, 30, 56, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.002, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.5614, 'time@10': 24.0759}:   0%|          | 0/10 [00:12<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.002, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.5614, 'time@10': 24.0759}:  10%|█         | 1/10 [00:12<01:48, 12.08s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0054, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.7717, 'time@10': 20.6254}:  10%|█         | 1/10 [00:29<01:48, 12.08s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0054, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9576, 'compress@10': 0.7717, 'time@10': 20.6254}:  20%|██        | 2/10 [00:29<02:00, 15.10s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0036, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.9241, 'compress@10': 0.578, 'time@10': 17.8129}:  20%|██        | 2/10 [00:35<02:00, 15.10s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0036, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.9241, 'compress@10': 0.578, 'time@10': 17.8129}:  30%|███       | 3/10 [00:35<01:17, 11.00s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9341, 'compress@10': 0.5094, 'time@10': 17.6154}:  30%|███       | 3/10 [00:52<01:17, 11.00s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9341, 'compress@10': 0.5094, 'time@10': 17.6154}:  40%|████      | 4/10 [00:52<01:20, 13.40s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0045, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9433, 'compress@10': 0.5603, 'time@10': 22.6317}:  40%|████      | 4/10 [01:13<01:20, 13.40s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0045, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9433, 'compress@10': 0.5603, 'time@10': 22.6317}:  50%|█████     | 5/10 [01:13<01:21, 16.28s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9494, 'compress@10': 0.5763, 'time@10': 23.6754}:  50%|█████     | 5/10 [01:42<01:21, 16.28s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9494, 'compress@10': 0.5763, 'time@10': 23.6754}:  60%|██████    | 6/10 [01:42<01:22, 20.58s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0064, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9509, 'compress@10': 0.5479, 'time@10': 24.687}:  60%|██████    | 6/10 [01:58<01:22, 20.58s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0064, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9509, 'compress@10': 0.5479, 'time@10': 24.687}:  70%|███████   | 7/10 [01:58<00:56, 18.89s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0079, 'hit_ratio@10': 0.9147, 'ndcg@10': 0.9535, 'compress@10': 0.5392, 'time@10': 24.3492}:  70%|███████   | 7/10 [02:20<00:56, 18.89s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0079, 'hit_ratio@10': 0.9147, 'ndcg@10': 0.9535, 'compress@10': 0.5392, 'time@10': 24.3492}:  80%|████████  | 8/10 [02:20<00:39, 19.89s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0079, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9555, 'compress@10': 0.5284, 'time@10': 26.45}:  80%|████████  | 8/10 [02:41<00:39, 19.89s/it]  {'epoch': 26, 'num_users': 6.3333, 'loss': 0.0079, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9555, 'compress@10': 0.5284, 'time@10': 26.45}:  90%|█████████ | 9/10 [02:41<00:20, 20.44s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0075, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9577, 'compress@10': 0.5267, 'time@10': 26.6367}:  90%|█████████ | 9/10 [03:10<00:20, 20.44s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0075, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9577, 'compress@10': 0.5267, 'time@10': 26.6367}: 100%|██████████| 10/10 [03:10<00:00, 22.89s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0075, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9577, 'compress@10': 0.5267, 'time@10': 26.6367}: 100%|██████████| 10/10 [03:10<00:00, 19.03s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.007497789011781368
Avg hit ratio: 0.909511248796478
Avg ndcg: 0.9576582241022459
Avg compression ratio: 0.5267317018934113
Avg train time: 26.63670301437378
Std train time: 9.88931149846589
[0.5178571428571429, 0.982142857142857, 0.05357142857142857, 0.3035714285714286, 0.7321428571428572, 0.6607142857142859, 0.33928571428571425, 0.48214285714285715, 0.4464285714285715, 0.48214285714285715]
[30, 30, 57, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0035, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.5432, 'time@10': 24.185}:   0%|          | 0/10 [00:12<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0035, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.5432, 'time@10': 24.185}:  10%|█         | 1/10 [00:12<01:49, 12.13s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.763, 'time@10': 20.7379}:  10%|█         | 1/10 [00:29<01:49, 12.13s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.763, 'time@10': 20.7379}:  20%|██        | 2/10 [00:29<02:01, 15.19s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9241, 'compress@10': 0.5716, 'time@10': 18.0349}:  20%|██        | 2/10 [00:35<02:01, 15.19s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9241, 'compress@10': 0.5716, 'time@10': 18.0349}:  30%|███       | 3/10 [00:35<01:18, 11.15s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9341, 'compress@10': 0.5108, 'time@10': 17.84}:  30%|███       | 3/10 [00:53<01:18, 11.15s/it]  {'epoch': 27, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9341, 'compress@10': 0.5108, 'time@10': 17.84}:  40%|████      | 4/10 [00:53<01:21, 13.58s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0056, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9433, 'compress@10': 0.5561, 'time@10': 22.7965}:  40%|████      | 4/10 [01:14<01:21, 13.58s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0056, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9433, 'compress@10': 0.5561, 'time@10': 22.7965}:  50%|█████     | 5/10 [01:14<01:21, 16.38s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0064, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9499, 'compress@10': 0.5748, 'time@10': 23.7666}:  50%|█████     | 5/10 [01:43<01:21, 16.38s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0064, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9499, 'compress@10': 0.5748, 'time@10': 23.7666}:  60%|██████    | 6/10 [01:43<01:22, 20.55s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0064, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9514, 'compress@10': 0.5449, 'time@10': 24.7742}:  60%|██████    | 6/10 [01:58<01:22, 20.55s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0064, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9514, 'compress@10': 0.5449, 'time@10': 24.7742}:  70%|███████   | 7/10 [01:58<00:56, 18.89s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0069, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9539, 'compress@10': 0.5389, 'time@10': 24.4574}:  70%|███████   | 7/10 [02:20<00:56, 18.89s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0069, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9539, 'compress@10': 0.5389, 'time@10': 24.4574}:  80%|████████  | 8/10 [02:20<00:39, 19.97s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0066, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9558, 'compress@10': 0.5304, 'time@10': 26.6199}:  80%|████████  | 8/10 [02:42<00:39, 19.97s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0066, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9558, 'compress@10': 0.5304, 'time@10': 26.6199}:  90%|█████████ | 9/10 [02:42<00:20, 20.60s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0068, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.958, 'compress@10': 0.5268, 'time@10': 26.8046}:  90%|█████████ | 9/10 [03:11<00:20, 20.60s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0068, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.958, 'compress@10': 0.5268, 'time@10': 26.8046}: 100%|██████████| 10/10 [03:11<00:00, 23.04s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0068, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.958, 'compress@10': 0.5268, 'time@10': 26.8046}: 100%|██████████| 10/10 [03:11<00:00, 19.14s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.006786818900398758
Avg hit ratio: 0.8915486002396019
Avg ndcg: 0.9579666686228988
Avg compression ratio: 0.5267696595626723
Avg train time: 26.804635977745058
Std train time: 9.87744947451389
[0.5, 0.982758620689655, 0.05172413793103448, 0.32758620689655177, 0.706896551724138, 0.6724137931034485, 0.3275862068965517, 0.5, 0.4310344827586208, 0.5]
[30, 30, 58, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0018, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.5263, 'time@10': 24.2171}:   0%|          | 0/10 [00:12<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0018, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.5263, 'time@10': 24.2171}:  10%|█         | 1/10 [00:12<01:49, 12.15s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0057, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.7548, 'time@10': 20.6651}:  10%|█         | 1/10 [00:29<01:49, 12.15s/it] {'epoch': 28, 'num_users': 7.0, 'loss': 0.0057, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.7548, 'time@10': 20.6651}:  20%|██        | 2/10 [00:29<02:00, 15.09s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0038, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.9241, 'compress@10': 0.5656, 'time@10': 17.9894}:  20%|██        | 2/10 [00:35<02:00, 15.09s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0038, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.9241, 'compress@10': 0.5656, 'time@10': 17.9894}:  30%|███       | 3/10 [00:35<01:17, 11.10s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.9341, 'compress@10': 0.5121, 'time@10': 17.8064}:  30%|███       | 3/10 [00:52<01:17, 11.10s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.9341, 'compress@10': 0.5121, 'time@10': 17.8064}:  40%|████      | 4/10 [00:52<01:21, 13.55s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0043, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9433, 'compress@10': 0.5522, 'time@10': 22.7188}:  40%|████      | 4/10 [01:14<01:21, 13.55s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0043, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9433, 'compress@10': 0.5522, 'time@10': 22.7188}:  50%|█████     | 5/10 [01:14<01:21, 16.36s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0061, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9487, 'compress@10': 0.5735, 'time@10': 23.7716}:  50%|█████     | 5/10 [01:43<01:21, 16.36s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0061, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9487, 'compress@10': 0.5735, 'time@10': 23.7716}:  60%|██████    | 6/10 [01:43<01:22, 20.69s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0057, 'hit_ratio@10': 0.9103, 'ndcg@10': 0.9503, 'compress@10': 0.5422, 'time@10': 24.7455}:  60%|██████    | 6/10 [01:58<01:22, 20.69s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0057, 'hit_ratio@10': 0.9103, 'ndcg@10': 0.9503, 'compress@10': 0.5422, 'time@10': 24.7455}:  70%|███████   | 7/10 [01:58<00:56, 18.94s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0057, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.953, 'compress@10': 0.5387, 'time@10': 24.4032}:  70%|███████   | 7/10 [02:20<00:56, 18.94s/it]  {'epoch': 28, 'num_users': 6.125, 'loss': 0.0057, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.953, 'compress@10': 0.5387, 'time@10': 24.4032}:  80%|████████  | 8/10 [02:20<00:39, 19.93s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0053, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.955, 'compress@10': 0.5285, 'time@10': 26.4396}:  80%|████████  | 8/10 [02:42<00:39, 19.93s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0053, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.955, 'compress@10': 0.5285, 'time@10': 26.4396}:  90%|█████████ | 9/10 [02:42<00:20, 20.39s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0048, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9572, 'compress@10': 0.5268, 'time@10': 26.6062}:  90%|█████████ | 9/10 [03:10<00:20, 20.39s/it]  {'epoch': 28, 'num_users': 6.3, 'loss': 0.0048, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9572, 'compress@10': 0.5268, 'time@10': 26.6062}: 100%|██████████| 10/10 [03:10<00:00, 22.78s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0048, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9572, 'compress@10': 0.5268, 'time@10': 26.6062}: 100%|██████████| 10/10 [03:10<00:00, 19.03s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.004823514222528071
Avg hit ratio: 0.9063648074242302
Avg ndcg: 0.9572313325349618
Avg compression ratio: 0.5268273319625474
Avg train time: 26.60621862411499
Std train time: 9.653728627271418
[0.48333333333333334, 0.9833333333333332, 0.05, 0.35000000000000003, 0.7166666666666668, 0.6833333333333336, 0.31666666666666665, 0.5166666666666667, 0.41666666666666674, 0.48333333333333334]
[30, 30, 59, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0027, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.5105, 'time@10': 23.5497}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0027, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.5105, 'time@10': 23.5497}:  10%|█         | 1/10 [00:11<01:46, 11.81s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.7472, 'time@10': 20.3893}:  10%|█         | 1/10 [00:29<01:46, 11.81s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.7472, 'time@10': 20.3893}:  20%|██        | 2/10 [00:29<02:00, 15.02s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.56, 'time@10': 17.9888}:  20%|██        | 2/10 [00:35<02:00, 15.02s/it]  {'epoch': 29, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.56, 'time@10': 17.9888}:  30%|███       | 3/10 [00:35<01:18, 11.19s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.5133, 'time@10': 17.7791}:  30%|███       | 3/10 [00:52<01:18, 11.19s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.5133, 'time@10': 17.7791}:  40%|████      | 4/10 [00:52<01:21, 13.56s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0057, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9433, 'compress@10': 0.5551, 'time@10': 22.824}:  40%|████      | 4/10 [01:14<01:21, 13.56s/it] {'epoch': 29, 'num_users': 5.8, 'loss': 0.0057, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9433, 'compress@10': 0.5551, 'time@10': 22.824}:  50%|█████     | 5/10 [01:14<01:22, 16.44s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0056, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9491, 'compress@10': 0.5777, 'time@10': 23.7779}:  50%|█████     | 5/10 [01:43<01:22, 16.44s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0056, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9491, 'compress@10': 0.5777, 'time@10': 23.7779}:  60%|██████    | 6/10 [01:43<01:22, 20.57s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0062, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9506, 'compress@10': 0.5443, 'time@10': 24.7903}:  60%|██████    | 6/10 [01:58<01:22, 20.57s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0062, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9506, 'compress@10': 0.5443, 'time@10': 24.7903}:  70%|███████   | 7/10 [01:58<00:56, 18.90s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0063, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9532, 'compress@10': 0.5426, 'time@10': 24.508}:  70%|███████   | 7/10 [02:21<00:56, 18.90s/it]   {'epoch': 29, 'num_users': 6.125, 'loss': 0.0063, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9532, 'compress@10': 0.5426, 'time@10': 24.508}:  80%|████████  | 8/10 [02:21<00:40, 20.07s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.006, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9552, 'compress@10': 0.5304, 'time@10': 26.6143}:  80%|████████  | 8/10 [02:42<00:40, 20.07s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.006, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9552, 'compress@10': 0.5304, 'time@10': 26.6143}:  90%|█████████ | 9/10 [02:42<00:20, 20.61s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0061, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9574, 'compress@10': 0.5269, 'time@10': 26.7559}:  90%|█████████ | 9/10 [03:10<00:20, 20.61s/it]  {'epoch': 29, 'num_users': 6.3, 'loss': 0.0061, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9574, 'compress@10': 0.5269, 'time@10': 26.7559}: 100%|██████████| 10/10 [03:10<00:00, 22.91s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0061, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9574, 'compress@10': 0.5269, 'time@10': 26.7559}: 100%|██████████| 10/10 [03:10<00:00, 19.09s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.006073072829681244
Avg hit ratio: 0.8929100953752906
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5268888816637902
Avg train time: 26.75590479373932
Std train time: 9.798578098618695
[0.467741935483871, 0.9838709677419353, 0.048387096774193554, 0.3709677419354839, 0.6935483870967744, 0.6612903225806454, 0.3387096774193548, 0.5322580645161291, 0.403225806451613, 0.5]
[30, 30, 60, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4958, 'time@10': 23.7832}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4958, 'time@10': 23.7832}:  10%|█         | 1/10 [00:11<01:47, 11.93s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0046, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.7401, 'time@10': 20.5183}:  10%|█         | 1/10 [00:29<01:47, 11.93s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0046, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.7401, 'time@10': 20.5183}:  20%|██        | 2/10 [00:29<02:00, 15.08s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0031, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9241, 'compress@10': 0.5548, 'time@10': 18.1856}:  20%|██        | 2/10 [00:36<02:00, 15.08s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0031, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9241, 'compress@10': 0.5548, 'time@10': 18.1856}:  30%|███       | 3/10 [00:36<01:19, 11.30s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0035, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9341, 'compress@10': 0.5145, 'time@10': 17.9184}:  30%|███       | 3/10 [00:53<01:19, 11.30s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0035, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9341, 'compress@10': 0.5145, 'time@10': 17.9184}:  40%|████      | 4/10 [00:53<01:21, 13.61s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0038, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9433, 'compress@10': 0.5515, 'time@10': 23.0017}:  40%|████      | 4/10 [01:14<01:21, 13.61s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0038, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9433, 'compress@10': 0.5515, 'time@10': 23.0017}:  50%|█████     | 5/10 [01:14<01:22, 16.53s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0057, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9531, 'compress@10': 0.5711, 'time@10': 23.9334}:  50%|█████     | 5/10 [01:43<01:22, 16.53s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0057, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9531, 'compress@10': 0.5711, 'time@10': 23.9334}:  60%|██████    | 6/10 [01:43<01:22, 20.64s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.005, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9541, 'compress@10': 0.5416, 'time@10': 24.9204}:  60%|██████    | 6/10 [01:58<01:22, 20.64s/it] {'epoch': 30, 'num_users': 6.2857, 'loss': 0.005, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9541, 'compress@10': 0.5416, 'time@10': 24.9204}:  70%|███████   | 7/10 [01:58<00:56, 18.95s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0049, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9563, 'compress@10': 0.5421, 'time@10': 24.5578}:  70%|███████   | 7/10 [02:21<00:56, 18.95s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0049, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9563, 'compress@10': 0.5421, 'time@10': 24.5578}:  80%|████████  | 8/10 [02:21<00:39, 19.94s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0047, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9579, 'compress@10': 0.5286, 'time@10': 26.6094}:  80%|████████  | 8/10 [02:42<00:39, 19.94s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0047, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9579, 'compress@10': 0.5286, 'time@10': 26.6094}:  90%|█████████ | 9/10 [02:42<00:20, 20.44s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0044, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9599, 'compress@10': 0.5269, 'time@10': 26.7816}:  90%|█████████ | 9/10 [03:10<00:20, 20.44s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0044, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9599, 'compress@10': 0.5269, 'time@10': 26.7816}: 100%|██████████| 10/10 [03:10<00:00, 22.89s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0044, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9599, 'compress@10': 0.5269, 'time@10': 26.7816}: 100%|██████████| 10/10 [03:10<00:00, 19.09s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.004405073769713426
Avg hit ratio: 0.9032818581154745
Avg ndcg: 0.959877023637355
Avg compression ratio: 0.5268797178378305
Avg train time: 26.78156383037567
Std train time: 9.755306971637166
[0.453125, 0.9843749999999998, 0.04687500000000001, 0.390625, 0.7031250000000001, 0.6718750000000002, 0.328125, 0.5468750000000001, 0.3906250000000001, 0.484375]
[30, 30, 61, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4819, 'time@10': 23.9495}:   0%|          | 0/10 [00:12<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4819, 'time@10': 23.9495}:  10%|█         | 1/10 [00:12<01:48, 12.01s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.7334, 'time@10': 20.6487}:  10%|█         | 1/10 [00:29<01:48, 12.01s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.7334, 'time@10': 20.6487}:  20%|██        | 2/10 [00:29<02:01, 15.17s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.5499, 'time@10': 18.2573}:  20%|██        | 2/10 [00:36<02:01, 15.17s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.5499, 'time@10': 18.2573}:  30%|███       | 3/10 [00:36<01:19, 11.34s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9341, 'compress@10': 0.5155, 'time@10': 18.1987}:  30%|███       | 3/10 [00:54<01:19, 11.34s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9341, 'compress@10': 0.5155, 'time@10': 18.1987}:  40%|████      | 4/10 [00:54<01:23, 13.99s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0061, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9433, 'compress@10': 0.5543, 'time@10': 23.0562}:  40%|████      | 4/10 [01:15<01:23, 13.99s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0061, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9433, 'compress@10': 0.5543, 'time@10': 23.0562}:  50%|█████     | 5/10 [01:15<01:23, 16.62s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0064, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9491, 'compress@10': 0.5751, 'time@10': 24.0046}:  50%|█████     | 5/10 [01:44<01:23, 16.62s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0064, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9491, 'compress@10': 0.5751, 'time@10': 24.0046}:  60%|██████    | 6/10 [01:44<01:23, 20.76s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0058, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9506, 'compress@10': 0.5436, 'time@10': 25.0056}:  60%|██████    | 6/10 [01:59<01:23, 20.76s/it] {'epoch': 31, 'num_users': 6.2857, 'loss': 0.0058, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9506, 'compress@10': 0.5436, 'time@10': 25.0056}:  70%|███████   | 7/10 [01:59<00:57, 19.05s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0057, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9532, 'compress@10': 0.5457, 'time@10': 24.6465}:  70%|███████   | 7/10 [02:22<00:57, 19.05s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0057, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9532, 'compress@10': 0.5457, 'time@10': 24.6465}:  80%|████████  | 8/10 [02:22<00:40, 20.04s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0059, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9552, 'compress@10': 0.5304, 'time@10': 26.7013}:  80%|████████  | 8/10 [02:43<00:40, 20.04s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0059, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9552, 'compress@10': 0.5304, 'time@10': 26.7013}:  90%|█████████ | 9/10 [02:43<00:20, 20.53s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0061, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9574, 'compress@10': 0.5269, 'time@10': 26.886}:  90%|█████████ | 9/10 [03:12<00:20, 20.53s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 0.0061, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9574, 'compress@10': 0.5269, 'time@10': 26.886}: 100%|██████████| 10/10 [03:12<00:00, 23.02s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0061, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9574, 'compress@10': 0.5269, 'time@10': 26.886}: 100%|██████████| 10/10 [03:12<00:00, 19.22s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.0060967845351955555
Avg hit ratio: 0.9013422510332527
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5269358982773791
Avg train time: 26.88597881793976
Std train time: 9.546715868016731
[0.4393939393939394, 0.9848484848484846, 0.04545454545454546, 0.4090909090909091, 0.6818181818181819, 0.681818181818182, 0.3181818181818182, 0.5303030303030304, 0.40909090909090917, 0.5]
[30, 30, 62, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4689, 'time@10': 23.5823}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4689, 'time@10': 23.5823}:  10%|█         | 1/10 [00:11<01:46, 11.83s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0034, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.7271, 'time@10': 20.435}:  10%|█         | 1/10 [00:29<01:46, 11.83s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0034, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.7271, 'time@10': 20.435}:  20%|██        | 2/10 [00:29<02:00, 15.06s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0023, 'hit_ratio@10': 0.7207, 'ndcg@10': 0.9241, 'compress@10': 0.5453, 'time@10': 18.2692}:  20%|██        | 2/10 [00:36<02:00, 15.06s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0023, 'hit_ratio@10': 0.7207, 'ndcg@10': 0.9241, 'compress@10': 0.5453, 'time@10': 18.2692}:  30%|███       | 3/10 [00:36<01:19, 11.38s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0031, 'hit_ratio@10': 0.7637, 'ndcg@10': 0.9341, 'compress@10': 0.5166, 'time@10': 18.0172}:  30%|███       | 3/10 [00:53<01:19, 11.38s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0031, 'hit_ratio@10': 0.7637, 'ndcg@10': 0.9341, 'compress@10': 0.5166, 'time@10': 18.0172}:  40%|████      | 4/10 [00:53<01:22, 13.72s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0035, 'hit_ratio@10': 0.803, 'ndcg@10': 0.9433, 'compress@10': 0.5509, 'time@10': 22.9938}:  40%|████      | 4/10 [01:14<01:22, 13.72s/it] {'epoch': 32, 'num_users': 5.8, 'loss': 0.0035, 'hit_ratio@10': 0.803, 'ndcg@10': 0.9433, 'compress@10': 0.5509, 'time@10': 22.9938}:  50%|█████     | 5/10 [01:14<01:22, 16.52s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0047, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.9489, 'compress@10': 0.5739, 'time@10': 23.9233}:  50%|█████     | 5/10 [01:43<01:22, 16.52s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0047, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.9489, 'compress@10': 0.5739, 'time@10': 23.9233}:  60%|██████    | 6/10 [01:43<01:22, 20.63s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0047, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.9505, 'compress@10': 0.5413, 'time@10': 24.7889}:  60%|██████    | 6/10 [01:58<01:22, 20.63s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0047, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.9505, 'compress@10': 0.5413, 'time@10': 24.7889}:  70%|███████   | 7/10 [01:58<00:56, 18.80s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0046, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9531, 'compress@10': 0.5416, 'time@10': 24.3194}:  70%|███████   | 7/10 [02:19<00:56, 18.80s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0046, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9531, 'compress@10': 0.5416, 'time@10': 24.3194}:  80%|████████  | 8/10 [02:19<00:39, 19.52s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0055, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9551, 'compress@10': 0.5287, 'time@10': 26.2821}:  80%|████████  | 8/10 [02:40<00:39, 19.52s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0055, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9551, 'compress@10': 0.5287, 'time@10': 26.2821}:  90%|█████████ | 9/10 [02:40<00:19, 19.99s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.005, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9574, 'compress@10': 0.527, 'time@10': 26.4243}:  90%|█████████ | 9/10 [03:08<00:19, 19.99s/it]     {'epoch': 32, 'num_users': 6.3, 'loss': 0.005, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9574, 'compress@10': 0.527, 'time@10': 26.4243}: 100%|██████████| 10/10 [03:08<00:00, 22.38s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.005, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9574, 'compress@10': 0.527, 'time@10': 26.4243}: 100%|██████████| 10/10 [03:08<00:00, 18.84s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.005023264046845974
Avg hit ratio: 0.8696274802352901
Avg ndcg: 0.9573501142766551
Avg compression ratio: 0.5269806681347997
Avg train time: 26.424271368980406
Std train time: 9.449590273349296
[0.4264705882352941, 0.9852941176470587, 0.04411764705882354, 0.42647058823529416, 0.6911764705882354, 0.6911764705882355, 0.3088235294117647, 0.5147058823529412, 0.4264705882352942, 0.4852941176470588]
[30, 30, 63, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0017, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4567, 'time@10': 23.3176}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0017, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4567, 'time@10': 23.3176}:  10%|█         | 1/10 [00:11<01:45, 11.69s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9592, 'compress@10': 0.7212, 'time@10': 20.0024}:  10%|█         | 1/10 [00:28<01:45, 11.69s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9592, 'compress@10': 0.7212, 'time@10': 20.0024}:  20%|██        | 2/10 [00:28<01:57, 14.65s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9252, 'compress@10': 0.541, 'time@10': 17.789}:  20%|██        | 2/10 [00:35<01:57, 14.65s/it]  {'epoch': 33, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9252, 'compress@10': 0.541, 'time@10': 17.789}:  30%|███       | 3/10 [00:35<01:17, 11.03s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.935, 'compress@10': 0.5175, 'time@10': 17.6129}:  30%|███       | 3/10 [00:52<01:17, 11.03s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.935, 'compress@10': 0.5175, 'time@10': 17.6129}:  40%|████      | 4/10 [00:52<01:20, 13.43s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0066, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.944, 'compress@10': 0.5535, 'time@10': 22.1268}:  40%|████      | 4/10 [01:12<01:20, 13.43s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0066, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.944, 'compress@10': 0.5535, 'time@10': 22.1268}:  50%|█████     | 5/10 [01:12<01:19, 15.85s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0061, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9496, 'compress@10': 0.5776, 'time@10': 23.0038}:  50%|█████     | 5/10 [01:39<01:19, 15.85s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0061, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9496, 'compress@10': 0.5776, 'time@10': 23.0038}:  60%|██████    | 6/10 [01:39<01:19, 19.78s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0061, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9511, 'compress@10': 0.5431, 'time@10': 23.928}:  60%|██████    | 6/10 [01:54<01:19, 19.78s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.0061, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9511, 'compress@10': 0.5431, 'time@10': 23.928}:  70%|███████   | 7/10 [01:54<00:54, 18.15s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.006, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9536, 'compress@10': 0.5413, 'time@10': 23.5945}:  70%|███████   | 7/10 [02:15<00:54, 18.15s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.006, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9536, 'compress@10': 0.5413, 'time@10': 23.5945}:  80%|████████  | 8/10 [02:15<00:38, 19.15s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0074, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9546, 'compress@10': 0.5304, 'time@10': 25.5447}:  80%|████████  | 8/10 [02:36<00:38, 19.15s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0074, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9546, 'compress@10': 0.5304, 'time@10': 25.5447}:  90%|█████████ | 9/10 [02:36<00:19, 19.60s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0073, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9569, 'compress@10': 0.527, 'time@10': 25.7287}:  90%|█████████ | 9/10 [03:03<00:19, 19.60s/it]    {'epoch': 33, 'num_users': 6.3, 'loss': 0.0073, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9569, 'compress@10': 0.527, 'time@10': 25.7287}: 100%|██████████| 10/10 [03:03<00:00, 22.02s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0073, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9569, 'compress@10': 0.527, 'time@10': 25.7287}: 100%|██████████| 10/10 [03:03<00:00, 18.39s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.007287288282312454
Avg hit ratio: 0.8917708224618242
Avg ndcg: 0.9568917429558568
Avg compression ratio: 0.5270295104343645
Avg train time: 25.72872657775879
Std train time: 8.951458156174041
[0.41428571428571426, 0.9857142857142855, 0.042857142857142864, 0.4428571428571429, 0.7000000000000001, 0.6714285714285716, 0.3, 0.5000000000000001, 0.44285714285714295, 0.5]
[30, 30, 64, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0015, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4451, 'time@10': 22.6959}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0015, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4451, 'time@10': 22.6959}:  10%|█         | 1/10 [00:11<01:42, 11.39s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0038, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.7156, 'time@10': 19.533}:  10%|█         | 1/10 [00:27<01:42, 11.39s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.0038, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.7156, 'time@10': 19.533}:  20%|██        | 2/10 [00:27<01:54, 14.34s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0025, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9241, 'compress@10': 0.537, 'time@10': 17.4266}:  20%|██        | 2/10 [00:34<01:54, 14.34s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.0025, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9241, 'compress@10': 0.537, 'time@10': 17.4266}:  30%|███       | 3/10 [00:34<01:15, 10.83s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0032, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.9341, 'compress@10': 0.5184, 'time@10': 17.2548}:  30%|███       | 3/10 [00:51<01:15, 10.83s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0032, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.9341, 'compress@10': 0.5184, 'time@10': 17.2548}:  40%|████      | 4/10 [00:51<01:19, 13.17s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0038, 'hit_ratio@10': 0.838, 'ndcg@10': 0.9433, 'compress@10': 0.5559, 'time@10': 22.0096}:  40%|████      | 4/10 [01:11<01:19, 13.17s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 0.0038, 'hit_ratio@10': 0.838, 'ndcg@10': 0.9433, 'compress@10': 0.5559, 'time@10': 22.0096}:  50%|█████     | 5/10 [01:11<01:19, 15.83s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.005, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.9483, 'compress@10': 0.5764, 'time@10': 22.9682}:  50%|█████     | 5/10 [01:39<01:19, 15.83s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.005, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.9483, 'compress@10': 0.5764, 'time@10': 22.9682}:  60%|██████    | 6/10 [01:39<01:19, 19.91s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0046, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.95, 'compress@10': 0.5409, 'time@10': 23.992}:  60%|██████    | 6/10 [01:54<01:19, 19.91s/it]  {'epoch': 34, 'num_users': 6.2857, 'loss': 0.0046, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.95, 'compress@10': 0.5409, 'time@10': 23.992}:  70%|███████   | 7/10 [01:54<00:55, 18.34s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0045, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9526, 'compress@10': 0.5376, 'time@10': 23.6251}:  70%|███████   | 7/10 [02:15<00:55, 18.34s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0045, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9526, 'compress@10': 0.5376, 'time@10': 23.6251}:  80%|████████  | 8/10 [02:15<00:38, 19.22s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0045, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9547, 'compress@10': 0.5288, 'time@10': 25.6096}:  80%|████████  | 8/10 [02:36<00:38, 19.22s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0045, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9547, 'compress@10': 0.5288, 'time@10': 25.6096}:  90%|█████████ | 9/10 [02:36<00:19, 19.71s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0041, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.957, 'compress@10': 0.5271, 'time@10': 25.7252}:  90%|█████████ | 9/10 [03:03<00:19, 19.71s/it]    {'epoch': 34, 'num_users': 6.3, 'loss': 0.0041, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.957, 'compress@10': 0.5271, 'time@10': 25.7252}: 100%|██████████| 10/10 [03:03<00:00, 21.90s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0041, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.957, 'compress@10': 0.5271, 'time@10': 25.7252}: 100%|██████████| 10/10 [03:03<00:00, 18.34s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.004107141990387987
Avg hit ratio: 0.876853286686903
Avg ndcg: 0.9569847229454421
Avg compression ratio: 0.5270761309291151
Avg train time: 25.725195479393005
Std train time: 9.289867400273362
[0.40277777777777773, 0.9861111111111109, 0.04166666666666667, 0.45833333333333337, 0.7083333333333334, 0.6805555555555557, 0.29166666666666663, 0.4861111111111112, 0.4583333333333334, 0.4861111111111111]
[30, 30, 65, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0023, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4342, 'time@10': 22.2412}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0023, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4342, 'time@10': 22.2412}:  10%|█         | 1/10 [00:11<01:40, 11.16s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.7104, 'time@10': 19.3362}:  10%|█         | 1/10 [00:27<01:40, 11.16s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.7104, 'time@10': 19.3362}:  20%|██        | 2/10 [00:27<01:54, 14.28s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.5331, 'time@10': 17.301}:  20%|██        | 2/10 [00:34<01:54, 14.28s/it]  {'epoch': 35, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.5331, 'time@10': 17.301}:  30%|███       | 3/10 [00:34<01:15, 10.80s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9341, 'compress@10': 0.5193, 'time@10': 17.1366}:  30%|███       | 3/10 [00:50<01:15, 10.80s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9341, 'compress@10': 0.5193, 'time@10': 17.1366}:  40%|████      | 4/10 [00:50<01:18, 13.12s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0062, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9444, 'compress@10': 0.5582, 'time@10': 21.8404}:  40%|████      | 4/10 [01:11<01:18, 13.12s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0062, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9444, 'compress@10': 0.5582, 'time@10': 21.8404}:  50%|█████     | 5/10 [01:11<01:18, 15.73s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0065, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9503, 'compress@10': 0.5798, 'time@10': 22.7902}:  50%|█████     | 5/10 [01:38<01:18, 15.73s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0065, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9503, 'compress@10': 0.5798, 'time@10': 22.7902}:  60%|██████    | 6/10 [01:38<01:19, 19.76s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0059, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9516, 'compress@10': 0.5427, 'time@10': 23.7218}:  60%|██████    | 6/10 [01:53<01:19, 19.76s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0059, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9516, 'compress@10': 0.5427, 'time@10': 23.7218}:  70%|███████   | 7/10 [01:53<00:54, 18.10s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0058, 'hit_ratio@10': 0.9184, 'ndcg@10': 0.9541, 'compress@10': 0.5375, 'time@10': 23.3345}:  70%|███████   | 7/10 [02:14<00:54, 18.10s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0058, 'hit_ratio@10': 0.9184, 'ndcg@10': 0.9541, 'compress@10': 0.5375, 'time@10': 23.3345}:  80%|████████  | 8/10 [02:14<00:37, 18.92s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0065, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.956, 'compress@10': 0.5304, 'time@10': 25.3293}:  80%|████████  | 8/10 [02:34<00:37, 18.92s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0065, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.956, 'compress@10': 0.5304, 'time@10': 25.3293}:  90%|█████████ | 9/10 [02:34<00:19, 19.47s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.006, 'hit_ratio@10': 0.9124, 'ndcg@10': 0.9582, 'compress@10': 0.5271, 'time@10': 25.4831}:  90%|█████████ | 9/10 [03:01<00:19, 19.47s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.006, 'hit_ratio@10': 0.9124, 'ndcg@10': 0.9582, 'compress@10': 0.5271, 'time@10': 25.4831}: 100%|██████████| 10/10 [03:01<00:00, 21.76s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.006, 'hit_ratio@10': 0.9124, 'ndcg@10': 0.9582, 'compress@10': 0.5271, 'time@10': 25.4831}: 100%|██████████| 10/10 [03:01<00:00, 18.18s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.0059889833474606495
Avg hit ratio: 0.9124216161126177
Avg ndcg: 0.9581634844902334
Avg compression ratio: 0.5271211623978176
Avg train time: 25.483136940002442
Std train time: 9.193082525844014
[0.39189189189189183, 0.9864864864864863, 0.04054054054054054, 0.472972972972973, 0.7162162162162162, 0.6891891891891894, 0.28378378378378377, 0.4729729729729731, 0.4729729729729731, 0.47297297297297297]
[30, 30, 66, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0027, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4239, 'time@10': 22.4961}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0027, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4239, 'time@10': 22.4961}:  10%|█         | 1/10 [00:11<01:41, 11.30s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0059, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.7054, 'time@10': 19.6785}:  10%|█         | 1/10 [00:28<01:41, 11.30s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 0.0059, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.7054, 'time@10': 19.6785}:  20%|██        | 2/10 [00:28<01:56, 14.59s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.004, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.5295, 'time@10': 17.612}:  20%|██        | 2/10 [00:34<01:56, 14.59s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.004, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.5295, 'time@10': 17.612}:  30%|███       | 3/10 [00:34<01:17, 11.02s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0046, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.9341, 'compress@10': 0.5201, 'time@10': 17.4832}:  30%|███       | 3/10 [00:52<01:17, 11.02s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0046, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.9341, 'compress@10': 0.5201, 'time@10': 17.4832}:  40%|████      | 4/10 [00:52<01:20, 13.44s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0046, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9433, 'compress@10': 0.5604, 'time@10': 22.1822}:  40%|████      | 4/10 [01:12<01:20, 13.44s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0046, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9433, 'compress@10': 0.5604, 'time@10': 22.1822}:  50%|█████     | 5/10 [01:12<01:19, 15.99s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0059, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.95, 'compress@10': 0.583, 'time@10': 22.9754}:  50%|█████     | 5/10 [01:39<01:19, 15.99s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0059, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.95, 'compress@10': 0.583, 'time@10': 22.9754}:  60%|██████    | 6/10 [01:39<01:18, 19.73s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0054, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9514, 'compress@10': 0.5444, 'time@10': 24.0114}:  60%|██████    | 6/10 [01:54<01:18, 19.73s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0054, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9514, 'compress@10': 0.5444, 'time@10': 24.0114}:  70%|███████   | 7/10 [01:54<00:54, 18.23s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0054, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9539, 'compress@10': 0.5373, 'time@10': 23.6299}:  70%|███████   | 7/10 [02:15<00:54, 18.23s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0054, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9539, 'compress@10': 0.5373, 'time@10': 23.6299}:  80%|████████  | 8/10 [02:15<00:38, 19.11s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0055, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9559, 'compress@10': 0.5319, 'time@10': 25.6173}:  80%|████████  | 8/10 [02:36<00:38, 19.11s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0055, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9559, 'compress@10': 0.5319, 'time@10': 25.6173}:  90%|█████████ | 9/10 [02:36<00:19, 19.64s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.958, 'compress@10': 0.5272, 'time@10': 25.7157}:  90%|█████████ | 9/10 [03:03<00:19, 19.64s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.958, 'compress@10': 0.5272, 'time@10': 25.7157}: 100%|██████████| 10/10 [03:03<00:00, 21.80s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.958, 'compress@10': 0.5272, 'time@10': 25.7157}: 100%|██████████| 10/10 [03:03<00:00, 18.32s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.00593965666238583
Avg hit ratio: 0.8849362359956588
Avg ndcg: 0.9580103877987437
Avg compression ratio: 0.5271626637711262
Avg train time: 25.71566822528839
Std train time: 9.16881746635288
[0.381578947368421, 0.9868421052631577, 0.03947368421052632, 0.48684210526315796, 0.6973684210526316, 0.6973684210526317, 0.2763157894736842, 0.4605263157894738, 0.486842105263158, 0.4868421052631579]
[30, 30, 67, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4141, 'time@10': 22.7413}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0005, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.4141, 'time@10': 22.7413}:  10%|█         | 1/10 [00:11<01:42, 11.41s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.004, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.7007, 'time@10': 19.6195}:  10%|█         | 1/10 [00:27<01:42, 11.41s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.004, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9576, 'compress@10': 0.7007, 'time@10': 19.6195}:  20%|██        | 2/10 [00:27<01:55, 14.42s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0027, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9241, 'compress@10': 0.526, 'time@10': 17.7971}:  20%|██        | 2/10 [00:35<01:55, 14.42s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0027, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9241, 'compress@10': 0.526, 'time@10': 17.7971}:  30%|███       | 3/10 [00:35<01:17, 11.08s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.9341, 'compress@10': 0.5208, 'time@10': 17.5497}:  30%|███       | 3/10 [00:51<01:17, 11.08s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.9341, 'compress@10': 0.5208, 'time@10': 17.5497}:  40%|████      | 4/10 [00:51<01:20, 13.36s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0035, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.9433, 'compress@10': 0.5573, 'time@10': 22.2268}:  40%|████      | 4/10 [01:12<01:20, 13.36s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0035, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.9433, 'compress@10': 0.5573, 'time@10': 22.2268}:  50%|█████     | 5/10 [01:12<01:19, 15.94s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0065, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9526, 'compress@10': 0.5818, 'time@10': 23.05}:  50%|█████     | 5/10 [01:39<01:19, 15.94s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0065, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9526, 'compress@10': 0.5818, 'time@10': 23.05}:  60%|██████    | 6/10 [01:39<01:19, 19.77s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0061, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9537, 'compress@10': 0.5423, 'time@10': 23.9884}:  60%|██████    | 6/10 [01:54<01:19, 19.77s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0061, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9537, 'compress@10': 0.5423, 'time@10': 23.9884}:  70%|███████   | 7/10 [01:54<00:54, 18.16s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0061, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9559, 'compress@10': 0.534, 'time@10': 23.6439}:  70%|███████   | 7/10 [02:15<00:54, 18.16s/it]  {'epoch': 37, 'num_users': 6.125, 'loss': 0.0061, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9559, 'compress@10': 0.534, 'time@10': 23.6439}:  80%|████████  | 8/10 [02:15<00:38, 19.15s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.007, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9576, 'compress@10': 0.5304, 'time@10': 25.6113}:  80%|████████  | 8/10 [02:36<00:38, 19.15s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.007, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9576, 'compress@10': 0.5304, 'time@10': 25.6113}:  90%|█████████ | 9/10 [02:36<00:19, 19.64s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0065, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9596, 'compress@10': 0.5272, 'time@10': 25.7488}:  90%|█████████ | 9/10 [03:03<00:19, 19.64s/it]  {'epoch': 37, 'num_users': 6.3, 'loss': 0.0065, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9596, 'compress@10': 0.5272, 'time@10': 25.7488}: 100%|██████████| 10/10 [03:03<00:00, 21.92s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0065, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9596, 'compress@10': 0.5272, 'time@10': 25.7488}: 100%|██████████| 10/10 [03:03<00:00, 18.35s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.0065181199865808935
Avg hit ratio: 0.8813417659495759
Avg ndcg: 0.9595868237169229
Avg compression ratio: 0.5271955376117614
Avg train time: 25.7488263130188
Std train time: 9.066370535402568
[0.37179487179487175, 0.987179487179487, 0.038461538461538464, 0.5000000000000001, 0.6794871794871795, 0.7051282051282053, 0.2692307692307692, 0.47435897435897445, 0.5000000000000001, 0.4743589743589744]
[30, 30, 68, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4049, 'time@10': 22.7243}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.4049, 'time@10': 22.7243}:  10%|█         | 1/10 [00:11<01:42, 11.40s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0063, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6962, 'time@10': 19.6146}:  10%|█         | 1/10 [00:27<01:42, 11.40s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0063, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6962, 'time@10': 19.6146}:  20%|██        | 2/10 [00:27<01:55, 14.43s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5228, 'time@10': 17.8743}:  20%|██        | 2/10 [00:35<01:55, 14.43s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5228, 'time@10': 17.8743}:  30%|███       | 3/10 [00:35<01:18, 11.15s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0046, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.5215, 'time@10': 17.617}:  30%|███       | 3/10 [00:52<01:18, 11.15s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0046, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.5215, 'time@10': 17.617}:  40%|████      | 4/10 [00:52<01:20, 13.41s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0046, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9433, 'compress@10': 0.5544, 'time@10': 22.2309}:  40%|████      | 4/10 [01:12<01:20, 13.41s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0046, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9433, 'compress@10': 0.5544, 'time@10': 22.2309}:  50%|█████     | 5/10 [01:12<01:19, 15.93s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0057, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9495, 'compress@10': 0.5806, 'time@10': 23.0987}:  50%|█████     | 5/10 [01:39<01:19, 15.93s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0057, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9495, 'compress@10': 0.5806, 'time@10': 23.0987}:  60%|██████    | 6/10 [01:39<01:19, 19.85s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0052, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.951, 'compress@10': 0.5403, 'time@10': 24.0319}:  60%|██████    | 6/10 [01:54<01:19, 19.85s/it] {'epoch': 38, 'num_users': 6.2857, 'loss': 0.0052, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.951, 'compress@10': 0.5403, 'time@10': 24.0319}:  70%|███████   | 7/10 [01:54<00:54, 18.22s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0048, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9535, 'compress@10': 0.5339, 'time@10': 23.6204}:  70%|███████   | 7/10 [02:15<00:54, 18.22s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0048, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9535, 'compress@10': 0.5339, 'time@10': 23.6204}:  80%|████████  | 8/10 [02:15<00:38, 19.03s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0062, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9555, 'compress@10': 0.5318, 'time@10': 25.5733}:  80%|████████  | 8/10 [02:36<00:38, 19.03s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0062, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9555, 'compress@10': 0.5318, 'time@10': 25.5733}:  90%|█████████ | 9/10 [02:36<00:19, 19.53s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0057, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9577, 'compress@10': 0.5272, 'time@10': 25.6884}:  90%|█████████ | 9/10 [03:02<00:19, 19.53s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0057, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9577, 'compress@10': 0.5272, 'time@10': 25.6884}: 100%|██████████| 10/10 [03:02<00:00, 21.76s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0057, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9577, 'compress@10': 0.5272, 'time@10': 25.6884}: 100%|██████████| 10/10 [03:02<00:00, 18.30s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.005657009828601356
Avg hit ratio: 0.8949100953752905
Avg ndcg: 0.9576951960488895
Avg compression ratio: 0.527211223479258
Avg train time: 25.688418579101562
Std train time: 8.99183587291309
[0.36249999999999993, 0.9874999999999998, 0.037500000000000006, 0.5125000000000001, 0.6875, 0.7125000000000001, 0.2625, 0.4625000000000001, 0.5125000000000001, 0.4625]
[30, 30, 69, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0016, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.3961, 'time@10': 22.8279}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0016, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.3961, 'time@10': 22.8279}:  10%|█         | 1/10 [00:11<01:43, 11.45s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.692, 'time@10': 19.6531}:  10%|█         | 1/10 [00:27<01:43, 11.45s/it]  {'epoch': 39, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.692, 'time@10': 19.6531}:  20%|██        | 2/10 [00:27<01:55, 14.43s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.5197, 'time@10': 17.8408}:  20%|██        | 2/10 [00:35<01:55, 14.43s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.5197, 'time@10': 17.8408}:  30%|███       | 3/10 [00:35<01:17, 11.10s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.9341, 'compress@10': 0.5222, 'time@10': 17.6034}:  30%|███       | 3/10 [00:52<01:17, 11.10s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.9341, 'compress@10': 0.5222, 'time@10': 17.6034}:  40%|████      | 4/10 [00:52<01:20, 13.40s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0042, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9433, 'compress@10': 0.5565, 'time@10': 22.3066}:  40%|████      | 4/10 [01:12<01:20, 13.40s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0042, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9433, 'compress@10': 0.5565, 'time@10': 22.3066}:  50%|█████     | 5/10 [01:12<01:19, 16.00s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0047, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.9491, 'compress@10': 0.5836, 'time@10': 23.1955}:  50%|█████     | 5/10 [01:40<01:19, 16.00s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0047, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.9491, 'compress@10': 0.5836, 'time@10': 23.1955}:  60%|██████    | 6/10 [01:40<01:19, 19.97s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0045, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9506, 'compress@10': 0.5419, 'time@10': 24.1352}:  60%|██████    | 6/10 [01:55<01:19, 19.97s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0045, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9506, 'compress@10': 0.5419, 'time@10': 24.1352}:  70%|███████   | 7/10 [01:55<00:54, 18.32s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0042, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9532, 'compress@10': 0.5339, 'time@10': 23.8333}:  70%|███████   | 7/10 [02:16<00:54, 18.32s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0042, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9532, 'compress@10': 0.5339, 'time@10': 23.8333}:  80%|████████  | 8/10 [02:16<00:38, 19.41s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0046, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9552, 'compress@10': 0.5331, 'time@10': 25.7615}:  80%|████████  | 8/10 [02:37<00:38, 19.41s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0046, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9552, 'compress@10': 0.5331, 'time@10': 25.7615}:  90%|█████████ | 9/10 [02:37<00:19, 19.79s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0042, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 25.8832}:  90%|█████████ | 9/10 [03:04<00:19, 19.79s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0042, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 25.8832}: 100%|██████████| 10/10 [03:04<00:00, 22.02s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0042, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 25.8832}: 100%|██████████| 10/10 [03:04<00:00, 18.46s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.004168417538677355
Avg hit ratio: 0.8855711566305793
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5272489631203638
Avg train time: 25.883249831199645
Std train time: 9.043529368096317
[0.3536585365853658, 0.9878048780487804, 0.03658536585365854, 0.524390243902439, 0.6707317073170732, 0.7195121951219513, 0.2804878048780488, 0.451219512195122, 0.524390243902439, 0.45121951219512196]
[30, 30, 70, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.002, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.3877, 'time@10': 22.2397}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.002, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.3877, 'time@10': 22.2397}:  10%|█         | 1/10 [00:11<01:40, 11.16s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0041, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6879, 'time@10': 19.181}:  10%|█         | 1/10 [00:27<01:40, 11.16s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0041, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6879, 'time@10': 19.181}:  20%|██        | 2/10 [00:27<01:52, 14.11s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0027, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9241, 'compress@10': 0.5167, 'time@10': 17.7114}:  20%|██        | 2/10 [00:34<01:52, 14.11s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0027, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9241, 'compress@10': 0.5167, 'time@10': 17.7114}:  30%|███       | 3/10 [00:34<01:17, 11.06s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0032, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9341, 'compress@10': 0.5229, 'time@10': 17.5554}:  30%|███       | 3/10 [00:51<01:17, 11.06s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0032, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9341, 'compress@10': 0.5229, 'time@10': 17.5554}:  40%|████      | 4/10 [00:51<01:20, 13.45s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0032, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9433, 'compress@10': 0.5538, 'time@10': 22.1504}:  40%|████      | 4/10 [01:12<01:20, 13.45s/it] {'epoch': 40, 'num_users': 5.8, 'loss': 0.0032, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9433, 'compress@10': 0.5538, 'time@10': 22.1504}:  50%|█████     | 5/10 [01:12<01:19, 15.93s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0032, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9491, 'compress@10': 0.5824, 'time@10': 23.0555}:  50%|█████     | 5/10 [01:39<01:19, 15.93s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0032, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9491, 'compress@10': 0.5824, 'time@10': 23.0555}:  60%|██████    | 6/10 [01:39<01:19, 19.90s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0031, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9506, 'compress@10': 0.5434, 'time@10': 23.9795}:  60%|██████    | 6/10 [01:54<01:19, 19.90s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0031, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9506, 'compress@10': 0.5434, 'time@10': 23.9795}:  70%|███████   | 7/10 [01:54<00:54, 18.23s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0034, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9532, 'compress@10': 0.5338, 'time@10': 23.6111}:  70%|███████   | 7/10 [02:15<00:54, 18.23s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0034, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9532, 'compress@10': 0.5338, 'time@10': 23.6111}:  80%|████████  | 8/10 [02:15<00:38, 19.14s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0044, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9552, 'compress@10': 0.5343, 'time@10': 25.6956}:  80%|████████  | 8/10 [02:36<00:38, 19.14s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0044, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9552, 'compress@10': 0.5343, 'time@10': 25.6956}:  90%|█████████ | 9/10 [02:36<00:19, 19.79s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0041, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 25.8122}:  90%|█████████ | 9/10 [03:03<00:19, 19.79s/it]    {'epoch': 40, 'num_users': 6.3, 'loss': 0.0041, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 25.8122}: 100%|██████████| 10/10 [03:03<00:00, 21.98s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0041, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9574, 'compress@10': 0.5272, 'time@10': 25.8122}: 100%|██████████| 10/10 [03:03<00:00, 18.38s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.004087573245843904
Avg hit ratio: 0.9009930446840464
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5272327928668401
Avg train time: 25.81222336292267
Std train time: 9.145284399648164
[0.3452380952380952, 0.988095238095238, 0.03571428571428572, 0.5357142857142857, 0.6785714285714286, 0.7023809523809524, 0.27380952380952384, 0.46428571428571436, 0.5357142857142857, 0.44047619047619047]
[30, 30, 71, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0024, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.3797, 'time@10': 22.5015}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0024, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.3797, 'time@10': 22.5015}:  10%|█         | 1/10 [00:11<01:41, 11.29s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0051, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6841, 'time@10': 19.5639}:  10%|█         | 1/10 [00:27<01:41, 11.29s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0051, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 0.6841, 'time@10': 19.5639}:  20%|██        | 2/10 [00:27<01:55, 14.45s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5139, 'time@10': 18.1025}:  20%|██        | 2/10 [00:35<01:55, 14.45s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9241, 'compress@10': 0.5139, 'time@10': 18.1025}:  30%|███       | 3/10 [00:35<01:19, 11.33s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0039, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.5235, 'time@10': 17.8215}:  30%|███       | 3/10 [00:52<01:19, 11.33s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0039, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9341, 'compress@10': 0.5235, 'time@10': 17.8215}:  40%|████      | 4/10 [00:52<01:21, 13.58s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0042, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9433, 'compress@10': 0.5558, 'time@10': 22.3628}:  40%|████      | 4/10 [01:12<01:21, 13.58s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0042, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9433, 'compress@10': 0.5558, 'time@10': 22.3628}:  50%|█████     | 5/10 [01:12<01:20, 16.01s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0052, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9486, 'compress@10': 0.5813, 'time@10': 23.1729}:  50%|█████     | 5/10 [01:40<01:20, 16.01s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0052, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9486, 'compress@10': 0.5813, 'time@10': 23.1729}:  60%|██████    | 6/10 [01:40<01:19, 19.83s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0048, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9502, 'compress@10': 0.5415, 'time@10': 24.0289}:  60%|██████    | 6/10 [01:54<01:19, 19.83s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0048, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9502, 'compress@10': 0.5415, 'time@10': 24.0289}:  70%|███████   | 7/10 [01:54<00:54, 18.13s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.005, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9529, 'compress@10': 0.5338, 'time@10': 23.6505}:  70%|███████   | 7/10 [02:15<00:54, 18.13s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.005, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9529, 'compress@10': 0.5338, 'time@10': 23.6505}:  80%|████████  | 8/10 [02:15<00:38, 19.06s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0056, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9549, 'compress@10': 0.5355, 'time@10': 25.6034}:  80%|████████  | 8/10 [02:36<00:38, 19.06s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0056, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9549, 'compress@10': 0.5355, 'time@10': 25.6034}:  90%|█████████ | 9/10 [02:36<00:19, 19.56s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0052, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9572, 'compress@10': 0.5273, 'time@10': 25.6734}:  90%|█████████ | 9/10 [03:02<00:19, 19.56s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0052, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9572, 'compress@10': 0.5273, 'time@10': 25.6734}: 100%|██████████| 10/10 [03:02<00:00, 21.65s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0052, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9572, 'compress@10': 0.5273, 'time@10': 25.6734}: 100%|██████████| 10/10 [03:02<00:00, 18.28s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.005161564360465968
Avg hit ratio: 0.8847513652165604
Avg ndcg: 0.9571508781264658
Avg compression ratio: 0.5272534385819753
Avg train time: 25.673402261734008
Std train time: 8.814789452998168
[0.33720930232558133, 0.9883720930232558, 0.034883720930232565, 0.5232558139534883, 0.686046511627907, 0.7093023255813954, 0.2674418604651163, 0.4767441860465117, 0.5465116279069767, 0.43023255813953487]
[30, 30, 72, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0012, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.3721, 'time@10': 22.2117}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0012, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.3721, 'time@10': 22.2117}:  10%|█         | 1/10 [00:11<01:40, 11.14s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0025, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9576, 'compress@10': 0.6804, 'time@10': 19.2252}:  10%|█         | 1/10 [00:27<01:40, 11.14s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0025, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9576, 'compress@10': 0.6804, 'time@10': 19.2252}:  20%|██        | 2/10 [00:27<01:53, 14.16s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0016, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9241, 'compress@10': 0.5112, 'time@10': 17.6641}:  20%|██        | 2/10 [00:34<01:53, 14.16s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0016, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9241, 'compress@10': 0.5112, 'time@10': 17.6641}:  30%|███       | 3/10 [00:34<01:17, 11.03s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0023, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9341, 'compress@10': 0.5185, 'time@10': 17.3933}:  30%|███       | 3/10 [00:51<01:17, 11.03s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0023, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9341, 'compress@10': 0.5185, 'time@10': 17.3933}:  40%|████      | 4/10 [00:51<01:19, 13.24s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0023, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.9433, 'compress@10': 0.5532, 'time@10': 22.0357}:  40%|████      | 4/10 [01:11<01:19, 13.24s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0023, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.9433, 'compress@10': 0.5532, 'time@10': 22.0357}:  50%|█████     | 5/10 [01:11<01:19, 15.80s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0022, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.9491, 'compress@10': 0.5803, 'time@10': 22.8871}:  50%|█████     | 5/10 [01:38<01:19, 15.80s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0022, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.9491, 'compress@10': 0.5803, 'time@10': 22.8871}:  60%|██████    | 6/10 [01:38<01:18, 19.67s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0023, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9506, 'compress@10': 0.5398, 'time@10': 23.7608}:  60%|██████    | 6/10 [01:53<01:18, 19.67s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0023, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9506, 'compress@10': 0.5398, 'time@10': 23.7608}:  70%|███████   | 7/10 [01:53<00:53, 17.99s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0025, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9532, 'compress@10': 0.5338, 'time@10': 23.369}:  70%|███████   | 7/10 [02:14<00:53, 17.99s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.0025, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9532, 'compress@10': 0.5338, 'time@10': 23.369}:  80%|████████  | 8/10 [02:14<00:37, 18.84s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0032, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9552, 'compress@10': 0.5367, 'time@10': 25.4243}:  80%|████████  | 8/10 [02:35<00:37, 18.84s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0032, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9552, 'compress@10': 0.5367, 'time@10': 25.4243}:  90%|█████████ | 9/10 [02:35<00:19, 19.51s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0029, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9574, 'compress@10': 0.5273, 'time@10': 25.6373}:  90%|█████████ | 9/10 [03:02<00:19, 19.51s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.0029, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9574, 'compress@10': 0.5273, 'time@10': 25.6373}: 100%|██████████| 10/10 [03:02<00:00, 22.00s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0029, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9574, 'compress@10': 0.5273, 'time@10': 25.6373}: 100%|██████████| 10/10 [03:02<00:00, 18.26s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.0029088509975438628
Avg hit ratio: 0.8970299110434933
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5273035146941994
Avg train time: 25.637349319458007
Std train time: 9.137986827082194
[0.3295454545454545, 0.9886363636363636, 0.034090909090909095, 0.5340909090909091, 0.6704545454545454, 0.6931818181818182, 0.2840909090909091, 0.4886363636363637, 0.5568181818181818, 0.4204545454545454]
[30, 30, 73, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0011, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.3648, 'time@10': 21.7138}:   0%|          | 0/10 [00:10<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0011, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.3648, 'time@10': 21.7138}:  10%|█         | 1/10 [00:10<01:38, 10.89s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.003, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.9576, 'compress@10': 0.6769, 'time@10': 19.0075}:  10%|█         | 1/10 [00:27<01:38, 10.89s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.003, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.9576, 'compress@10': 0.6769, 'time@10': 19.0075}:  20%|██        | 2/10 [00:27<01:52, 14.10s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.002, 'hit_ratio@10': 0.736, 'ndcg@10': 0.9241, 'compress@10': 0.5086, 'time@10': 17.8663}:  20%|██        | 2/10 [00:35<01:52, 14.10s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.002, 'hit_ratio@10': 0.736, 'ndcg@10': 0.9241, 'compress@10': 0.5086, 'time@10': 17.8663}:  30%|███       | 3/10 [00:35<01:18, 11.23s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.003, 'hit_ratio@10': 0.7842, 'ndcg@10': 0.9341, 'compress@10': 0.5192, 'time@10': 17.499}:  30%|███       | 3/10 [00:51<01:18, 11.23s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.003, 'hit_ratio@10': 0.7842, 'ndcg@10': 0.9341, 'compress@10': 0.5192, 'time@10': 17.499}:  40%|████      | 4/10 [00:51<01:19, 13.29s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0033, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.9433, 'compress@10': 0.5507, 'time@10': 22.2291}:  40%|████      | 4/10 [01:12<01:19, 13.29s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0033, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.9433, 'compress@10': 0.5507, 'time@10': 22.2291}:  50%|█████     | 5/10 [01:12<01:19, 15.93s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0044, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.9491, 'compress@10': 0.5756, 'time@10': 23.0315}:  50%|█████     | 5/10 [01:39<01:19, 15.93s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0044, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.9491, 'compress@10': 0.5756, 'time@10': 23.0315}:  60%|██████    | 6/10 [01:39<01:18, 19.72s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0042, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.9506, 'compress@10': 0.5381, 'time@10': 23.9275}:  60%|██████    | 6/10 [01:53<01:18, 19.72s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0042, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.9506, 'compress@10': 0.5381, 'time@10': 23.9275}:  70%|███████   | 7/10 [01:53<00:54, 18.07s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.004, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9532, 'compress@10': 0.5337, 'time@10': 23.5176}:  70%|███████   | 7/10 [02:14<00:54, 18.07s/it]  {'epoch': 43, 'num_users': 6.125, 'loss': 0.004, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9532, 'compress@10': 0.5337, 'time@10': 23.5176}:  80%|████████  | 8/10 [02:14<00:37, 18.91s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0056, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9556, 'compress@10': 0.5377, 'time@10': 25.3995}:  80%|████████  | 8/10 [02:34<00:37, 18.91s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0056, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9556, 'compress@10': 0.5377, 'time@10': 25.3995}:  90%|█████████ | 9/10 [02:34<00:19, 19.33s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0052, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9577, 'compress@10': 0.5273, 'time@10': 25.5228}:  90%|█████████ | 9/10 [03:01<00:19, 19.33s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0052, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9577, 'compress@10': 0.5273, 'time@10': 25.5228}: 100%|██████████| 10/10 [03:01<00:00, 21.60s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0052, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9577, 'compress@10': 0.5273, 'time@10': 25.5228}: 100%|██████████| 10/10 [03:01<00:00, 18.15s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.005240623386032669
Avg hit ratio: 0.8780929180233086
Avg ndcg: 0.9577242177402516
Avg compression ratio: 0.527274381726306
Avg train time: 25.5228054523468
Std train time: 8.89015774394588
[0.32222222222222213, 0.9888888888888889, 0.03333333333333334, 0.5444444444444444, 0.6777777777777777, 0.7000000000000001, 0.2777777777777778, 0.47777777777777786, 0.5666666666666667, 0.4111111111111111]
[30, 30, 74, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0008, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.3579, 'time@10': 21.9614}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0008, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.3579, 'time@10': 21.9614}:  10%|█         | 1/10 [00:11<01:39, 11.02s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0067, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9576, 'compress@10': 0.6736, 'time@10': 19.1208}:  10%|█         | 1/10 [00:27<01:39, 11.02s/it] {'epoch': 44, 'num_users': 7.0, 'loss': 0.0067, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9576, 'compress@10': 0.6736, 'time@10': 19.1208}:  20%|██        | 2/10 [00:27<01:53, 14.14s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0045, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9241, 'compress@10': 0.5062, 'time@10': 17.701}:  20%|██        | 2/10 [00:34<01:53, 14.14s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0045, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9241, 'compress@10': 0.5062, 'time@10': 17.701}:  30%|███       | 3/10 [00:34<01:17, 11.09s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0044, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9341, 'compress@10': 0.5198, 'time@10': 17.4976}:  30%|███       | 3/10 [00:51<01:17, 11.09s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0044, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9341, 'compress@10': 0.5198, 'time@10': 17.4976}:  40%|████      | 4/10 [00:51<01:20, 13.39s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0046, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9433, 'compress@10': 0.5527, 'time@10': 22.1902}:  40%|████      | 4/10 [01:12<01:20, 13.39s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0046, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9433, 'compress@10': 0.5527, 'time@10': 22.1902}:  50%|█████     | 5/10 [01:12<01:19, 15.96s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0044, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9491, 'compress@10': 0.5784, 'time@10': 23.0589}:  50%|█████     | 5/10 [01:39<01:19, 15.96s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0044, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9491, 'compress@10': 0.5784, 'time@10': 23.0589}:  60%|██████    | 6/10 [01:39<01:19, 19.86s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0041, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9506, 'compress@10': 0.5395, 'time@10': 24.0379}:  60%|██████    | 6/10 [01:54<01:19, 19.86s/it] {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0041, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9506, 'compress@10': 0.5395, 'time@10': 24.0379}:  70%|███████   | 7/10 [01:54<00:54, 18.27s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0041, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9532, 'compress@10': 0.5337, 'time@10': 23.6106}:  70%|███████   | 7/10 [02:15<00:54, 18.27s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0041, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9532, 'compress@10': 0.5337, 'time@10': 23.6106}:  80%|████████  | 8/10 [02:15<00:38, 19.03s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0044, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9552, 'compress@10': 0.5387, 'time@10': 25.5025}:  80%|████████  | 8/10 [02:35<00:38, 19.03s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0044, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9552, 'compress@10': 0.5387, 'time@10': 25.5025}:  90%|█████████ | 9/10 [02:35<00:19, 19.44s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.004, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9574, 'compress@10': 0.5273, 'time@10': 25.5878}:  90%|█████████ | 9/10 [03:02<00:19, 19.44s/it]    {'epoch': 44, 'num_users': 6.3, 'loss': 0.004, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9574, 'compress@10': 0.5273, 'time@10': 25.5878}: 100%|██████████| 10/10 [03:02<00:00, 21.59s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.004, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9574, 'compress@10': 0.5273, 'time@10': 25.5878}: 100%|██████████| 10/10 [03:02<00:00, 18.21s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.003955644764708699
Avg hit ratio: 0.8837477809871699
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5273059134499175
Avg train time: 25.587773323059082
Std train time: 8.947638364570068
[0.3152173913043477, 0.9891304347826088, 0.03260869565217392, 0.5543478260869564, 0.6847826086956521, 0.6847826086956522, 0.2717391304347826, 0.48913043478260876, 0.5760869565217391, 0.40217391304347827]
[30, 30, 75, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0011, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.3513, 'time@10': 21.9636}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0011, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.3513, 'time@10': 21.9636}:  10%|█         | 1/10 [00:11<01:39, 11.02s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0038, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.6704, 'time@10': 19.096}:  10%|█         | 1/10 [00:27<01:39, 11.02s/it]  {'epoch': 45, 'num_users': 7.0, 'loss': 0.0038, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.6704, 'time@10': 19.096}:  20%|██        | 2/10 [00:27<01:52, 14.10s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0026, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.5038, 'time@10': 17.9972}:  20%|██        | 2/10 [00:35<01:52, 14.10s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0026, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.5038, 'time@10': 17.9972}:  30%|███       | 3/10 [00:35<01:19, 11.29s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.003, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.9341, 'compress@10': 0.5204, 'time@10': 17.678}:  30%|███       | 3/10 [00:51<01:19, 11.29s/it]  {'epoch': 45, 'num_users': 5.0, 'loss': 0.003, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.9341, 'compress@10': 0.5204, 'time@10': 17.678}:  40%|████      | 4/10 [00:51<01:20, 13.45s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0031, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9433, 'compress@10': 0.5546, 'time@10': 22.2456}:  40%|████      | 4/10 [01:12<01:20, 13.45s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0031, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9433, 'compress@10': 0.5546, 'time@10': 22.2456}:  50%|█████     | 5/10 [01:12<01:19, 15.92s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0053, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9513, 'compress@10': 0.5774, 'time@10': 23.0865}:  50%|█████     | 5/10 [01:39<01:19, 15.92s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0053, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9513, 'compress@10': 0.5774, 'time@10': 23.0865}:  60%|██████    | 6/10 [01:39<01:19, 19.80s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.005, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9526, 'compress@10': 0.5379, 'time@10': 23.9539}:  60%|██████    | 6/10 [01:54<01:19, 19.80s/it] {'epoch': 45, 'num_users': 6.2857, 'loss': 0.005, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9526, 'compress@10': 0.5379, 'time@10': 23.9539}:  70%|███████   | 7/10 [01:54<00:54, 18.10s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.005, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9549, 'compress@10': 0.5337, 'time@10': 23.5528}:  70%|███████   | 7/10 [02:14<00:54, 18.10s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.005, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9549, 'compress@10': 0.5337, 'time@10': 23.5528}:  80%|████████  | 8/10 [02:14<00:37, 18.96s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0055, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9568, 'compress@10': 0.5397, 'time@10': 25.5211}:  80%|████████  | 8/10 [02:35<00:37, 18.96s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0055, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9568, 'compress@10': 0.5397, 'time@10': 25.5211}:  90%|█████████ | 9/10 [02:35<00:19, 19.49s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9604, 'compress@10': 0.5273, 'time@10': 25.6174}:  90%|█████████ | 9/10 [03:02<00:19, 19.49s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9604, 'compress@10': 0.5273, 'time@10': 25.6174}: 100%|██████████| 10/10 [03:02<00:00, 21.66s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9604, 'compress@10': 0.5273, 'time@10': 25.6174}: 100%|██████████| 10/10 [03:02<00:00, 18.22s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.0059193379364840875
Avg hit ratio: 0.8999362359956586
Avg ndcg: 0.9604437971449086
Avg compression ratio: 0.5273218933652738
Avg train time: 25.617399406433105
Std train time: 8.853018050152267
[0.30851063829787223, 0.9893617021276596, 0.03191489361702128, 0.5425531914893617, 0.6702127659574467, 0.6914893617021277, 0.26595744680851063, 0.5000000000000001, 0.5851063829787234, 0.4148936170212766]
[30, 30, 76, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.3449, 'time@10': 22.2563}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.3449, 'time@10': 22.2563}:  10%|█         | 1/10 [00:11<01:40, 11.16s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0026, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.6673, 'time@10': 19.2627}:  10%|█         | 1/10 [00:27<01:40, 11.16s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0026, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9576, 'compress@10': 0.6673, 'time@10': 19.2627}:  20%|██        | 2/10 [00:27<01:53, 14.19s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0018, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9241, 'compress@10': 0.5016, 'time@10': 17.768}:  20%|██        | 2/10 [00:34<01:53, 14.19s/it]  {'epoch': 46, 'num_users': 5.0, 'loss': 0.0018, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9241, 'compress@10': 0.5016, 'time@10': 17.768}:  30%|███       | 3/10 [00:34<01:17, 11.10s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0027, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.9341, 'compress@10': 0.5159, 'time@10': 17.6343}:  30%|███       | 3/10 [00:52<01:17, 11.10s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0027, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.9341, 'compress@10': 0.5159, 'time@10': 17.6343}:  40%|████      | 4/10 [00:52<01:21, 13.54s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0032, 'hit_ratio@10': 0.842, 'ndcg@10': 0.9433, 'compress@10': 0.5481, 'time@10': 22.2974}:  40%|████      | 4/10 [01:12<01:21, 13.54s/it] {'epoch': 46, 'num_users': 5.8, 'loss': 0.0032, 'hit_ratio@10': 0.842, 'ndcg@10': 0.9433, 'compress@10': 0.5481, 'time@10': 22.2974}:  50%|█████     | 5/10 [01:12<01:20, 16.05s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.004, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9496, 'compress@10': 0.5731, 'time@10': 23.1683}:  50%|█████     | 5/10 [01:40<01:20, 16.05s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.004, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9496, 'compress@10': 0.5731, 'time@10': 23.1683}:  60%|██████    | 6/10 [01:40<01:19, 19.97s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0039, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9511, 'compress@10': 0.5335, 'time@10': 24.0161}:  60%|██████    | 6/10 [01:54<01:19, 19.97s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0039, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9511, 'compress@10': 0.5335, 'time@10': 24.0161}:  70%|███████   | 7/10 [01:54<00:54, 18.21s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.004, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9536, 'compress@10': 0.5311, 'time@10': 23.6005}:  70%|███████   | 7/10 [02:15<00:54, 18.21s/it]  {'epoch': 46, 'num_users': 6.125, 'loss': 0.004, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9536, 'compress@10': 0.5311, 'time@10': 23.6005}:  80%|████████  | 8/10 [02:15<00:38, 19.01s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0052, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9556, 'compress@10': 0.5384, 'time@10': 25.4503}:  80%|████████  | 8/10 [02:35<00:38, 19.01s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0052, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9556, 'compress@10': 0.5384, 'time@10': 25.4503}:  90%|█████████ | 9/10 [02:35<00:19, 19.37s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0047, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9578, 'compress@10': 0.5274, 'time@10': 25.5594}:  90%|█████████ | 9/10 [03:02<00:19, 19.37s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0047, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9578, 'compress@10': 0.5274, 'time@10': 25.5594}: 100%|██████████| 10/10 [03:02<00:00, 21.60s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0047, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9578, 'compress@10': 0.5274, 'time@10': 25.5594}: 100%|██████████| 10/10 [03:02<00:00, 18.23s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.004668605582542169
Avg hit ratio: 0.8845675724011887
Avg ndcg: 0.9577774484975297
Avg compression ratio: 0.5273594335005918
Avg train time: 25.559400939941405
Std train time: 8.81169747761041
[0.3020833333333332, 0.96875, 0.03125000000000001, 0.5520833333333333, 0.6770833333333333, 0.6979166666666667, 0.2604166666666667, 0.5104166666666667, 0.59375, 0.40625]
[30, 30, 77, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.3388, 'time@10': 22.427}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.3388, 'time@10': 22.427}:  10%|█         | 1/10 [00:11<01:41, 11.25s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0044, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.6543, 'time@10': 19.4594}:  10%|█         | 1/10 [00:27<01:41, 11.25s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0044, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.6543, 'time@10': 19.4594}:  20%|██        | 2/10 [00:27<01:54, 14.36s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0029, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.4927, 'time@10': 18.1629}:  20%|██        | 2/10 [00:35<01:54, 14.36s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0029, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.4927, 'time@10': 18.1629}:  30%|███       | 3/10 [00:35<01:19, 11.37s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0028, 'hit_ratio@10': 0.8066, 'ndcg@10': 0.9341, 'compress@10': 0.5116, 'time@10': 17.7849}:  30%|███       | 3/10 [00:52<01:19, 11.37s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0028, 'hit_ratio@10': 0.8066, 'ndcg@10': 0.9341, 'compress@10': 0.5116, 'time@10': 17.7849}:  40%|████      | 4/10 [00:52<01:20, 13.47s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0029, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.9433, 'compress@10': 0.546, 'time@10': 22.2795}:  40%|████      | 4/10 [01:12<01:20, 13.47s/it] {'epoch': 47, 'num_users': 5.8, 'loss': 0.0029, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.9433, 'compress@10': 0.546, 'time@10': 22.2795}:  50%|█████     | 5/10 [01:12<01:19, 15.88s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0029, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9491, 'compress@10': 0.5724, 'time@10': 23.104}:  50%|█████     | 5/10 [01:39<01:19, 15.88s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0029, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9491, 'compress@10': 0.5724, 'time@10': 23.104}:  60%|██████    | 6/10 [01:39<01:19, 19.75s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0029, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9506, 'compress@10': 0.5321, 'time@10': 23.9613}:  60%|██████    | 6/10 [01:54<01:19, 19.75s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0029, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9506, 'compress@10': 0.5321, 'time@10': 23.9613}:  70%|███████   | 7/10 [01:54<00:54, 18.06s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.003, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9532, 'compress@10': 0.5311, 'time@10': 23.5838}:  70%|███████   | 7/10 [02:15<00:54, 18.06s/it]  {'epoch': 47, 'num_users': 6.125, 'loss': 0.003, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9532, 'compress@10': 0.5311, 'time@10': 23.5838}:  80%|████████  | 8/10 [02:15<00:37, 18.99s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.003, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9552, 'compress@10': 0.5394, 'time@10': 25.5036}:  80%|████████  | 8/10 [02:35<00:37, 18.99s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.003, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9552, 'compress@10': 0.5394, 'time@10': 25.5036}:  90%|█████████ | 9/10 [02:35<00:19, 19.45s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0039, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9601, 'compress@10': 0.5274, 'time@10': 25.6151}:  90%|█████████ | 9/10 [03:02<00:19, 19.45s/it]  {'epoch': 47, 'num_users': 6.3, 'loss': 0.0039, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9601, 'compress@10': 0.5274, 'time@10': 25.6151}: 100%|██████████| 10/10 [03:02<00:00, 21.68s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0039, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9601, 'compress@10': 0.5274, 'time@10': 25.6151}: 100%|██████████| 10/10 [03:02<00:00, 18.24s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.0039038101789791134
Avg hit ratio: 0.883079093138516
Avg ndcg: 0.9601254672617549
Avg compression ratio: 0.5273948119149103
Avg train time: 25.615080428123473
Std train time: 8.713113947305219
[0.29591836734693866, 0.9693877551020408, 0.03061224489795919, 0.5408163265306122, 0.6836734693877551, 0.6836734693877552, 0.25510204081632654, 0.5204081632653061, 0.6020408163265306, 0.41836734693877553]
[30, 30, 78, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.333, 'time@10': 22.3334}:   0%|          | 0/10 [00:11<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0007, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.333, 'time@10': 22.3334}:  10%|█         | 1/10 [00:11<01:40, 11.20s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.6517, 'time@10': 19.3583}:  10%|█         | 1/10 [00:27<01:40, 11.20s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0004, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9576, 'compress@10': 0.6517, 'time@10': 19.3583}:  20%|██        | 2/10 [00:27<01:54, 14.27s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.4908, 'time@10': 18.0072}:  20%|██        | 2/10 [00:35<01:54, 14.27s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0003, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.9241, 'compress@10': 0.4908, 'time@10': 18.0072}:  30%|███       | 3/10 [00:35<01:18, 11.26s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0018, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.9341, 'compress@10': 0.5074, 'time@10': 17.619}:  30%|███       | 3/10 [00:51<01:18, 11.26s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.0018, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.9341, 'compress@10': 0.5074, 'time@10': 17.619}:  40%|████      | 4/10 [00:51<01:19, 13.33s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0024, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9433, 'compress@10': 0.5439, 'time@10': 22.1822}:  40%|████      | 4/10 [01:12<01:19, 13.33s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0024, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9433, 'compress@10': 0.5439, 'time@10': 22.1822}:  50%|█████     | 5/10 [01:12<01:19, 15.83s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0022, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9491, 'compress@10': 0.5684, 'time@10': 22.9867}:  50%|█████     | 5/10 [01:39<01:19, 15.83s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0022, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9491, 'compress@10': 0.5684, 'time@10': 22.9867}:  60%|██████    | 6/10 [01:39<01:18, 19.64s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.002, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9506, 'compress@10': 0.5279, 'time@10': 23.8704}:  60%|██████    | 6/10 [01:53<01:18, 19.64s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.002, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9506, 'compress@10': 0.5279, 'time@10': 23.8704}:  70%|███████   | 7/10 [01:53<00:53, 18.00s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0023, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9532, 'compress@10': 0.5287, 'time@10': 23.496}:  70%|███████   | 7/10 [02:14<00:53, 18.00s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0023, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9532, 'compress@10': 0.5287, 'time@10': 23.496}:  80%|████████  | 8/10 [02:14<00:37, 18.93s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0026, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9552, 'compress@10': 0.5381, 'time@10': 25.4328}:  80%|████████  | 8/10 [02:35<00:37, 18.93s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0026, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9552, 'compress@10': 0.5381, 'time@10': 25.4328}:  90%|█████████ | 9/10 [02:35<00:19, 19.42s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0024, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 25.5326}:  90%|█████████ | 9/10 [03:01<00:19, 19.42s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0024, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 25.5326}: 100%|██████████| 10/10 [03:01<00:00, 21.60s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0024, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9574, 'compress@10': 0.5274, 'time@10': 25.5326}: 100%|██████████| 10/10 [03:01<00:00, 18.16s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.002417239529717579
Avg hit ratio: 0.8945870296464523
Avg ndcg: 0.9574446575872722
Avg compression ratio: 0.5274361460036081
Avg train time: 25.53261272907257
Std train time: 8.820159937405423
[0.28999999999999987, 0.95, 0.030000000000000006, 0.5499999999999999, 0.69, 0.67, 0.27, 0.53, 0.61, 0.41000000000000003]
[30, 30, 79, 30, 20, 30, 30, 30, 29, 30]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.3274, 'time@10': 21.8961}:   0%|          | 0/10 [00:10<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.001, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 0.3274, 'time@10': 21.8961}:  10%|█         | 1/10 [00:10<01:38, 10.98s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0014, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9576, 'compress@10': 0.6395, 'time@10': 19.6574}:  10%|█         | 1/10 [00:28<01:38, 10.98s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0014, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9576, 'compress@10': 0.6395, 'time@10': 19.6574}:  20%|██        | 2/10 [00:28<01:58, 14.79s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0009, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9241, 'compress@10': 0.4825, 'time@10': 18.34}:  20%|██        | 2/10 [00:36<01:58, 14.79s/it]  {'epoch': 49, 'num_users': 5.0, 'loss': 0.0009, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9241, 'compress@10': 0.4825, 'time@10': 18.34}:  30%|███       | 3/10 [00:36<01:21, 11.64s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0015, 'hit_ratio@10': 0.7744, 'ndcg@10': 0.9341, 'compress@10': 0.5034, 'time@10': 17.8745}:  30%|███       | 3/10 [00:52<01:21, 11.64s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0015, 'hit_ratio@10': 0.7744, 'ndcg@10': 0.9341, 'compress@10': 0.5034, 'time@10': 17.8745}:  40%|████      | 4/10 [00:52<01:21, 13.56s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0022, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.9433, 'compress@10': 0.542, 'time@10': 22.5977}:  40%|████      | 4/10 [01:13<01:21, 13.56s/it] {'epoch': 49, 'num_users': 5.8, 'loss': 0.0022, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.9433, 'compress@10': 0.542, 'time@10': 22.5977}:  50%|█████     | 5/10 [01:13<01:20, 16.17s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0032, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.9491, 'compress@10': 0.5645, 'time@10': 23.4872}:  50%|█████     | 5/10 [01:41<01:20, 16.17s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0032, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.9491, 'compress@10': 0.5645, 'time@10': 23.4872}:  60%|██████    | 6/10 [01:41<01:20, 20.18s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0031, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9506, 'compress@10': 0.5266, 'time@10': 24.3282}:  60%|██████    | 6/10 [01:56<01:20, 20.18s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0031, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9506, 'compress@10': 0.5266, 'time@10': 24.3282}:  70%|███████   | 7/10 [01:56<00:55, 18.40s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0034, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9532, 'compress@10': 0.5287, 'time@10': 23.9196}:  70%|███████   | 7/10 [02:17<00:55, 18.40s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0034, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9532, 'compress@10': 0.5287, 'time@10': 23.9196}:  80%|████████  | 8/10 [02:17<00:38, 19.26s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0041, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9552, 'compress@10': 0.539, 'time@10': 25.7893}:  80%|████████  | 8/10 [02:37<00:38, 19.26s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0041, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9552, 'compress@10': 0.539, 'time@10': 25.7893}:  90%|█████████ | 9/10 [02:37<00:19, 19.62s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0047, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9595, 'compress@10': 0.5274, 'time@10': 25.8605}:  90%|█████████ | 9/10 [03:04<00:19, 19.62s/it]  {'epoch': 49, 'num_users': 6.3, 'loss': 0.0047, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9595, 'compress@10': 0.5274, 'time@10': 25.8605}: 100%|██████████| 10/10 [03:04<00:00, 21.75s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0047, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9595, 'compress@10': 0.5274, 'time@10': 25.8605}: 100%|██████████| 10/10 [03:04<00:00, 18.44s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.004717314401960741
Avg hit ratio: 0.8792552324114293
Avg ndcg: 0.9594812415374865
Avg compression ratio: 0.5274311627131097
Avg train time: 25.860510635375977
Std train time: 8.855361161203222
[0.28431372549019596, 0.9313725490196078, 0.02941176470588236, 0.5392156862745098, 0.696078431372549, 0.6764705882352942, 0.2647058823529412, 0.5392156862745098, 0.6176470588235294, 0.42156862745098045]
[30, 30, 80, 30, 20, 30, 30, 30, 29, 30]
