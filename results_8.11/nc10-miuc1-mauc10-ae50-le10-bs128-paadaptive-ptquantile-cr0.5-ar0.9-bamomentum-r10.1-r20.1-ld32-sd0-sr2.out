  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1847, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5094, 'compress@10': 0.5263, 'time@10': 9.4255}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1847, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5094, 'compress@10': 0.5263, 'time@10': 9.4255}:  10%|█         | 1/10 [00:04<00:42,  4.75s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1336, 'hit_ratio@10': 0.618, 'ndcg@10': 0.6179, 'compress@10': 0.5212, 'time@10': 8.1426}:  10%|█         | 1/10 [00:11<00:42,  4.75s/it] {'epoch': 0, 'num_users': 7.0, 'loss': 0.1336, 'hit_ratio@10': 0.618, 'ndcg@10': 0.6179, 'compress@10': 0.5212, 'time@10': 8.1426}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9196, 'hit_ratio@10': 0.5072, 'ndcg@10': 0.4119, 'compress@10': 0.538, 'time@10': 6.3389}:  20%|██        | 2/10 [00:13<00:48,  6.02s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9196, 'hit_ratio@10': 0.5072, 'ndcg@10': 0.4119, 'compress@10': 0.538, 'time@10': 6.3389}:  30%|███       | 3/10 [00:13<00:27,  3.92s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7183, 'hit_ratio@10': 0.5769, 'ndcg@10': 0.46, 'compress@10': 0.5329, 'time@10': 6.3074}:  30%|███       | 3/10 [00:19<00:27,  3.92s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.7183, 'hit_ratio@10': 0.5769, 'ndcg@10': 0.46, 'compress@10': 0.5329, 'time@10': 6.3074}:  40%|████      | 4/10 [00:19<00:29,  4.84s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5935, 'hit_ratio@10': 0.6255, 'ndcg@10': 0.5187, 'compress@10': 0.5283, 'time@10': 9.5645}:  40%|████      | 4/10 [00:30<00:29,  4.84s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5935, 'hit_ratio@10': 0.6255, 'ndcg@10': 0.5187, 'compress@10': 0.5283, 'time@10': 9.5645}:  50%|█████     | 5/10 [00:30<00:35,  7.18s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5092, 'hit_ratio@10': 0.6472, 'ndcg@10': 0.5625, 'compress@10': 0.5255, 'time@10': 9.6716}:  50%|█████     | 5/10 [00:40<00:35,  7.18s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5092, 'hit_ratio@10': 0.6472, 'ndcg@10': 0.5625, 'compress@10': 0.5255, 'time@10': 9.6716}:  60%|██████    | 6/10 [00:40<00:32,  8.22s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4541, 'hit_ratio@10': 0.6519, 'ndcg@10': 0.5641, 'compress@10': 0.5247, 'time@10': 9.9342}:  60%|██████    | 6/10 [00:46<00:32,  8.22s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4541, 'hit_ratio@10': 0.6519, 'ndcg@10': 0.5641, 'compress@10': 0.5247, 'time@10': 9.9342}:  70%|███████   | 7/10 [00:46<00:22,  7.43s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.404, 'hit_ratio@10': 0.6847, 'ndcg@10': 0.5908, 'compress@10': 0.5234, 'time@10': 9.6668}:  70%|███████   | 7/10 [00:54<00:22,  7.43s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 0.404, 'hit_ratio@10': 0.6847, 'ndcg@10': 0.5908, 'compress@10': 0.5234, 'time@10': 9.6668}:  80%|████████  | 8/10 [00:54<00:15,  7.56s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.365, 'hit_ratio@10': 0.6975, 'ndcg@10': 0.6256, 'compress@10': 0.5224, 'time@10': 10.325}:  80%|████████  | 8/10 [01:02<00:15,  7.56s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.365, 'hit_ratio@10': 0.6975, 'ndcg@10': 0.6256, 'compress@10': 0.5224, 'time@10': 10.325}:  90%|█████████ | 9/10 [01:02<00:07,  7.64s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3339, 'hit_ratio@10': 0.7209, 'ndcg@10': 0.6467, 'compress@10': 0.5213, 'time@10': 10.2811}:  90%|█████████ | 9/10 [01:12<00:07,  7.64s/it] {'epoch': 0, 'num_users': 6.3, 'loss': 0.3339, 'hit_ratio@10': 0.7209, 'ndcg@10': 0.6467, 'compress@10': 0.5213, 'time@10': 10.2811}: 100%|██████████| 10/10 [01:12<00:00,  8.35s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3339, 'hit_ratio@10': 0.7209, 'ndcg@10': 0.6467, 'compress@10': 0.5213, 'time@10': 10.2811}: 100%|██████████| 10/10 [01:12<00:00,  7.23s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.3339235459753624
Avg hit ratio: 0.7209081231916545
Avg ndcg: 0.6467492427794204
Avg compression ratio: 0.5212749006657823
Avg train time: 10.281067633628846
Std train time: 5.230754421175714
[0.25, 0.25, 0.75, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.054, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8402, 'compress@10': 0.2895, 'time@10': 7.9928}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.054, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8402, 'compress@10': 0.2895, 'time@10': 7.9928}:  10%|█         | 1/10 [00:04<00:36,  4.03s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0537, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8473, 'compress@10': 0.2818, 'time@10': 7.3912}:  10%|█         | 1/10 [00:10<00:36,  4.03s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0537, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8473, 'compress@10': 0.2818, 'time@10': 7.3912}:  20%|██        | 2/10 [00:10<00:45,  5.68s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0452, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.7905, 'compress@10': 0.4498, 'time@10': 5.9468}:  20%|██        | 2/10 [00:12<00:45,  5.68s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0452, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.7905, 'compress@10': 0.4498, 'time@10': 5.9468}:  30%|███       | 3/10 [00:12<00:26,  3.80s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0464, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8036, 'compress@10': 0.4065, 'time@10': 6.0126}:  30%|███       | 3/10 [00:18<00:26,  3.80s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0464, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8036, 'compress@10': 0.4065, 'time@10': 6.0126}:  40%|████      | 4/10 [00:18<00:28,  4.77s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0546, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8002, 'compress@10': 0.3782, 'time@10': 8.7768}:  40%|████      | 4/10 [00:28<00:28,  4.77s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0546, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8002, 'compress@10': 0.3782, 'time@10': 8.7768}:  50%|█████     | 5/10 [00:28<00:33,  6.64s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0584, 'hit_ratio@10': 0.7823, 'ndcg@10': 0.8028, 'compress@10': 0.3596, 'time@10': 8.9879}:  50%|█████     | 5/10 [00:38<00:33,  6.64s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0584, 'hit_ratio@10': 0.7823, 'ndcg@10': 0.8028, 'compress@10': 0.3596, 'time@10': 8.9879}:  60%|██████    | 6/10 [00:38<00:31,  7.81s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0562, 'hit_ratio@10': 0.8077, 'ndcg@10': 0.8128, 'compress@10': 0.3483, 'time@10': 9.2396}:  60%|██████    | 6/10 [00:44<00:31,  7.81s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0562, 'hit_ratio@10': 0.8077, 'ndcg@10': 0.8128, 'compress@10': 0.3483, 'time@10': 9.2396}:  70%|███████   | 7/10 [00:44<00:21,  7.02s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0539, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8206, 'compress@10': 0.3387, 'time@10': 9.0315}:  70%|███████   | 7/10 [00:51<00:21,  7.02s/it]  {'epoch': 1, 'num_users': 6.125, 'loss': 0.0539, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8206, 'compress@10': 0.3387, 'time@10': 9.0315}:  80%|████████  | 8/10 [00:51<00:14,  7.21s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0518, 'hit_ratio@10': 0.806, 'ndcg@10': 0.8308, 'compress@10': 0.3312, 'time@10': 9.5382}:  80%|████████  | 8/10 [00:58<00:14,  7.21s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0518, 'hit_ratio@10': 0.806, 'ndcg@10': 0.8308, 'compress@10': 0.3312, 'time@10': 9.5382}:  90%|█████████ | 9/10 [00:58<00:07,  7.09s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0513, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8322, 'compress@10': 0.3248, 'time@10': 9.5453}:  90%|█████████ | 9/10 [01:08<00:07,  7.09s/it]  {'epoch': 1, 'num_users': 6.3, 'loss': 0.0513, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8322, 'compress@10': 0.3248, 'time@10': 9.5453}: 100%|██████████| 10/10 [01:08<00:00,  7.88s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0513, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8322, 'compress@10': 0.3248, 'time@10': 9.5453}: 100%|██████████| 10/10 [01:08<00:00,  6.82s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.051283015403625454
Avg hit ratio: 0.818555224816685
Avg ndcg: 0.8321604338146452
Avg compression ratio: 0.3247719935235018
Avg train time: 9.54527506828308
Std train time: 4.370610785926137
[0.16666666666666669, 0.16666666666666669, 0.5, 0.16666666666666669, 0.5, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8463, 'compress@10': 0.2105, 'time@10': 7.767}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8463, 'compress@10': 0.2105, 'time@10': 7.767}:  10%|█         | 1/10 [00:03<00:35,  3.92s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.7657, 'ndcg@10': 0.8483, 'compress@10': 0.202, 'time@10': 7.1079}:  10%|█         | 1/10 [00:10<00:35,  3.92s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.7657, 'ndcg@10': 0.8483, 'compress@10': 0.202, 'time@10': 7.1079}:  20%|██        | 2/10 [00:10<00:43,  5.43s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0347, 'hit_ratio@10': 0.7486, 'ndcg@10': 0.8512, 'compress@10': 0.3252, 'time@10': 5.8242}:  20%|██        | 2/10 [00:12<00:43,  5.43s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0347, 'hit_ratio@10': 0.7486, 'ndcg@10': 0.8512, 'compress@10': 0.3252, 'time@10': 5.8242}:  30%|███       | 3/10 [00:12<00:25,  3.71s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0385, 'hit_ratio@10': 0.7846, 'ndcg@10': 0.8494, 'compress@10': 0.293, 'time@10': 5.8284}:  30%|███       | 3/10 [00:17<00:25,  3.71s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.0385, 'hit_ratio@10': 0.7846, 'ndcg@10': 0.8494, 'compress@10': 0.293, 'time@10': 5.8284}:  40%|████      | 4/10 [00:17<00:27,  4.57s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0481, 'hit_ratio@10': 0.7917, 'ndcg@10': 0.8367, 'compress@10': 0.3364, 'time@10': 8.2917}:  40%|████      | 4/10 [00:27<00:27,  4.57s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0481, 'hit_ratio@10': 0.7917, 'ndcg@10': 0.8367, 'compress@10': 0.3364, 'time@10': 8.2917}:  50%|█████     | 5/10 [00:27<00:31,  6.20s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0527, 'hit_ratio@10': 0.7857, 'ndcg@10': 0.8348, 'compress@10': 0.3112, 'time@10': 8.6199}:  50%|█████     | 5/10 [00:37<00:31,  6.20s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0527, 'hit_ratio@10': 0.7857, 'ndcg@10': 0.8348, 'compress@10': 0.3112, 'time@10': 8.6199}:  60%|██████    | 6/10 [00:37<00:30,  7.60s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0511, 'hit_ratio@10': 0.8106, 'ndcg@10': 0.8386, 'compress@10': 0.2953, 'time@10': 8.8962}:  60%|██████    | 6/10 [00:42<00:30,  7.60s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0511, 'hit_ratio@10': 0.8106, 'ndcg@10': 0.8386, 'compress@10': 0.2953, 'time@10': 8.8962}:  70%|███████   | 7/10 [00:42<00:20,  6.85s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0508, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8443, 'compress@10': 0.2822, 'time@10': 8.7043}:  70%|███████   | 7/10 [00:50<00:20,  6.85s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0508, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8443, 'compress@10': 0.2822, 'time@10': 8.7043}:  80%|████████  | 8/10 [00:50<00:14,  7.03s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.8146, 'ndcg@10': 0.8517, 'compress@10': 0.272, 'time@10': 9.2595}:  80%|████████  | 8/10 [00:56<00:14,  7.03s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.8146, 'ndcg@10': 0.8517, 'compress@10': 0.272, 'time@10': 9.2595}:  90%|█████████ | 9/10 [00:56<00:06,  6.99s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8517, 'compress@10': 0.2634, 'time@10': 9.2675}:  90%|█████████ | 9/10 [01:06<00:06,  6.99s/it]  {'epoch': 2, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8517, 'compress@10': 0.2634, 'time@10': 9.2675}: 100%|██████████| 10/10 [01:06<00:00,  7.73s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8517, 'compress@10': 0.2634, 'time@10': 9.2675}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04886109387011027
Avg hit ratio: 0.8263068619740945
Avg ndcg: 0.851651171838817
Avg compression ratio: 0.2633756031677683
Avg train time: 9.267516207695007
Std train time: 4.034948646812955
[0.125, 0.125, 0.375, 0.125, 0.625, 0.125, 0.125, 0.125, 0.125, 0.125]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8544, 'compress@10': 0.1711, 'time@10': 7.5217}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8544, 'compress@10': 0.1711, 'time@10': 7.5217}:  10%|█         | 1/10 [00:03<00:34,  3.80s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8503, 'compress@10': 0.1621, 'time@10': 6.8427}:  10%|█         | 1/10 [00:10<00:34,  3.80s/it] {'epoch': 3, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8503, 'compress@10': 0.1621, 'time@10': 6.8427}:  20%|██        | 2/10 [00:10<00:41,  5.21s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8526, 'compress@10': 0.2629, 'time@10': 5.7145}:  20%|██        | 2/10 [00:11<00:41,  5.21s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8526, 'compress@10': 0.2629, 'time@10': 5.7145}:  30%|███       | 3/10 [00:11<00:25,  3.64s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8466, 'compress@10': 0.2362, 'time@10': 5.6989}:  30%|███       | 3/10 [00:17<00:25,  3.64s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8466, 'compress@10': 0.2362, 'time@10': 5.6989}:  40%|████      | 4/10 [00:17<00:26,  4.45s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8361, 'compress@10': 0.3155, 'time@10': 7.7635}:  40%|████      | 4/10 [00:25<00:26,  4.45s/it]  {'epoch': 3, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8361, 'compress@10': 0.3155, 'time@10': 7.7635}:  50%|█████     | 5/10 [00:25<00:28,  5.75s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.051, 'hit_ratio@10': 0.7763, 'ndcg@10': 0.8343, 'compress@10': 0.287, 'time@10': 8.0905}:  50%|█████     | 5/10 [00:35<00:28,  5.75s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.051, 'hit_ratio@10': 0.7763, 'ndcg@10': 0.8343, 'compress@10': 0.287, 'time@10': 8.0905}:  60%|██████    | 6/10 [00:35<00:28,  7.11s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.8026, 'ndcg@10': 0.8344, 'compress@10': 0.2688, 'time@10': 8.3409}:  60%|██████    | 6/10 [00:40<00:28,  7.11s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.8026, 'ndcg@10': 0.8344, 'compress@10': 0.2688, 'time@10': 8.3409}:  70%|███████   | 7/10 [00:40<00:19,  6.41s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0519, 'hit_ratio@10': 0.8201, 'ndcg@10': 0.8367, 'compress@10': 0.254, 'time@10': 8.2002}:  70%|███████   | 7/10 [00:47<00:19,  6.41s/it]  {'epoch': 3, 'num_users': 6.125, 'loss': 0.0519, 'hit_ratio@10': 0.8201, 'ndcg@10': 0.8367, 'compress@10': 0.254, 'time@10': 8.2002}:  80%|████████  | 8/10 [00:47<00:13,  6.68s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0508, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8478, 'compress@10': 0.2424, 'time@10': 8.6702}:  80%|████████  | 8/10 [00:53<00:13,  6.68s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0508, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8478, 'compress@10': 0.2424, 'time@10': 8.6702}:  90%|█████████ | 9/10 [00:53<00:06,  6.54s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8476, 'compress@10': 0.2327, 'time@10': 8.672}:  90%|█████████ | 9/10 [01:02<00:06,  6.54s/it]    {'epoch': 3, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8476, 'compress@10': 0.2327, 'time@10': 8.672}: 100%|██████████| 10/10 [01:02<00:00,  7.22s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8476, 'compress@10': 0.2327, 'time@10': 8.672}: 100%|██████████| 10/10 [01:02<00:00,  6.25s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.05036866473483388
Avg hit ratio: 0.826409268528114
Avg ndcg: 0.8475638858957881
Avg compression ratio: 0.232663376838866
Avg train time: 8.671989250183106
Std train time: 3.4156954280995224
[0.1, 0.1, 0.3, 0.1, 0.7, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8597, 'compress@10': 0.1474, 'time@10': 7.4172}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8597, 'compress@10': 0.1474, 'time@10': 7.4172}:  10%|█         | 1/10 [00:03<00:33,  3.75s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8563, 'compress@10': 0.1382, 'time@10': 6.9058}:  10%|█         | 1/10 [00:10<00:33,  3.75s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8563, 'compress@10': 0.1382, 'time@10': 6.9058}:  20%|██        | 2/10 [00:10<00:42,  5.33s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8566, 'compress@10': 0.2255, 'time@10': 5.8267}:  20%|██        | 2/10 [00:12<00:42,  5.33s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8566, 'compress@10': 0.2255, 'time@10': 5.8267}:  30%|███       | 3/10 [00:12<00:26,  3.75s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8475, 'compress@10': 0.2021, 'time@10': 5.7666}:  30%|███       | 3/10 [00:17<00:26,  3.75s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8475, 'compress@10': 0.2021, 'time@10': 5.7666}:  40%|████      | 4/10 [00:17<00:26,  4.49s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0478, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8354, 'compress@10': 0.3029, 'time@10': 7.3866}:  40%|████      | 4/10 [00:24<00:26,  4.49s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0478, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8354, 'compress@10': 0.3029, 'time@10': 7.3866}:  50%|█████     | 5/10 [00:24<00:26,  5.38s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0509, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.8339, 'compress@10': 0.2724, 'time@10': 7.7682}:  50%|█████     | 5/10 [00:34<00:26,  5.38s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0509, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.8339, 'compress@10': 0.2724, 'time@10': 7.7682}:  60%|██████    | 6/10 [00:34<00:27,  6.86s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8394, 'compress@10': 0.2529, 'time@10': 8.0608}:  60%|██████    | 6/10 [00:39<00:27,  6.86s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8394, 'compress@10': 0.2529, 'time@10': 8.0608}:  70%|███████   | 7/10 [00:39<00:18,  6.24s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0515, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8423, 'compress@10': 0.237, 'time@10': 7.9407}:  70%|███████   | 7/10 [00:46<00:18,  6.24s/it]  {'epoch': 4, 'num_users': 6.125, 'loss': 0.0515, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8423, 'compress@10': 0.237, 'time@10': 7.9407}:  80%|████████  | 8/10 [00:46<00:13,  6.52s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0539, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8568, 'compress@10': 0.2247, 'time@10': 8.4627}:  80%|████████  | 8/10 [00:52<00:13,  6.52s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0539, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8568, 'compress@10': 0.2247, 'time@10': 8.4627}:  90%|█████████ | 9/10 [00:52<00:06,  6.47s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0529, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8558, 'compress@10': 0.2142, 'time@10': 8.4998}:  90%|█████████ | 9/10 [01:01<00:06,  6.47s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0529, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8558, 'compress@10': 0.2142, 'time@10': 8.4998}: 100%|██████████| 10/10 [01:01<00:00,  7.21s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0529, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8558, 'compress@10': 0.2142, 'time@10': 8.4998}: 100%|██████████| 10/10 [01:01<00:00,  6.17s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.05288144303466106
Avg hit ratio: 0.8402858686305207
Avg ndcg: 0.855844866806596
Avg compression ratio: 0.21424996128324397
Avg train time: 8.499840879440308
Std train time: 2.9757148675535534
[0.08333333333333334, 0.08333333333333334, 0.25, 0.08333333333333334, 0.75, 0.08333333333333334, 0.08333333333333334, 0.08333333333333334, 0.08333333333333334, 0.08333333333333334]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8627, 'compress@10': 0.1316, 'time@10': 7.8161}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8627, 'compress@10': 0.1316, 'time@10': 7.8161}:  10%|█         | 1/10 [00:03<00:35,  3.95s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8545, 'compress@10': 0.1223, 'time@10': 7.0063}:  10%|█         | 1/10 [00:10<00:35,  3.95s/it]  {'epoch': 5, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8545, 'compress@10': 0.1223, 'time@10': 7.0063}:  20%|██        | 2/10 [00:10<00:42,  5.29s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8554, 'compress@10': 0.2005, 'time@10': 5.9351}:  20%|██        | 2/10 [00:12<00:42,  5.29s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8554, 'compress@10': 0.2005, 'time@10': 5.9351}:  30%|███       | 3/10 [00:12<00:26,  3.76s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0391, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8365, 'compress@10': 0.1794, 'time@10': 5.8612}:  30%|███       | 3/10 [00:17<00:26,  3.76s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0391, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8365, 'compress@10': 0.1794, 'time@10': 5.8612}:  40%|████      | 4/10 [00:17<00:27,  4.52s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0478, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8264, 'compress@10': 0.2945, 'time@10': 7.4026}:  40%|████      | 4/10 [00:24<00:27,  4.52s/it] {'epoch': 5, 'num_users': 5.8, 'loss': 0.0478, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8264, 'compress@10': 0.2945, 'time@10': 7.4026}:  50%|█████     | 5/10 [00:24<00:26,  5.35s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0501, 'hit_ratio@10': 0.7874, 'ndcg@10': 0.8271, 'compress@10': 0.2627, 'time@10': 7.739}:  50%|█████     | 5/10 [00:34<00:26,  5.35s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0501, 'hit_ratio@10': 0.7874, 'ndcg@10': 0.8271, 'compress@10': 0.2627, 'time@10': 7.739}:  60%|██████    | 6/10 [00:34<00:26,  6.74s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.049, 'hit_ratio@10': 0.8121, 'ndcg@10': 0.8291, 'compress@10': 0.2424, 'time@10': 8.0576}:  60%|██████    | 6/10 [00:39<00:26,  6.74s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.049, 'hit_ratio@10': 0.8121, 'ndcg@10': 0.8291, 'compress@10': 0.2424, 'time@10': 8.0576}:  70%|███████   | 7/10 [00:39<00:18,  6.18s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0499, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.834, 'compress@10': 0.2257, 'time@10': 7.98}:  70%|███████   | 7/10 [00:46<00:18,  6.18s/it]   {'epoch': 5, 'num_users': 6.125, 'loss': 0.0499, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.834, 'compress@10': 0.2257, 'time@10': 7.98}:  80%|████████  | 8/10 [00:46<00:13,  6.59s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0509, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8417, 'compress@10': 0.2128, 'time@10': 8.5499}:  80%|████████  | 8/10 [00:53<00:13,  6.59s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0509, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8417, 'compress@10': 0.2128, 'time@10': 8.5499}:  90%|█████████ | 9/10 [00:53<00:06,  6.59s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0496, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8432, 'compress@10': 0.202, 'time@10': 8.6424}:  90%|█████████ | 9/10 [01:02<00:06,  6.59s/it]    {'epoch': 5, 'num_users': 6.3, 'loss': 0.0496, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8432, 'compress@10': 0.202, 'time@10': 8.6424}: 100%|██████████| 10/10 [01:02<00:00,  7.49s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0496, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8432, 'compress@10': 0.202, 'time@10': 8.6424}: 100%|██████████| 10/10 [01:02<00:00,  6.27s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.049592047837416324
Avg hit ratio: 0.8330759351947808
Avg ndcg: 0.8432128279137308
Avg compression ratio: 0.2019702098964112
Avg train time: 8.642409610748292
Std train time: 2.9652514638021157
[0.07142857142857144, 0.07142857142857144, 0.2142857142857143, 0.07142857142857144, 0.7857142857142857, 0.07142857142857144, 0.07142857142857144, 0.07142857142857144, 0.07142857142857144, 0.07142857142857144]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.1203, 'time@10': 7.3963}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.1203, 'time@10': 7.3963}:  10%|█         | 1/10 [00:03<00:33,  3.74s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.854, 'compress@10': 0.1109, 'time@10': 6.9138}:  10%|█         | 1/10 [00:10<00:33,  3.74s/it] {'epoch': 6, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.854, 'compress@10': 0.1109, 'time@10': 6.9138}:  20%|██        | 2/10 [00:10<00:42,  5.34s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8551, 'compress@10': 0.1827, 'time@10': 5.9934}:  20%|██        | 2/10 [00:12<00:42,  5.34s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8551, 'compress@10': 0.1827, 'time@10': 5.9934}:  30%|███       | 3/10 [00:12<00:27,  3.87s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8503, 'compress@10': 0.1632, 'time@10': 5.9485}:  30%|███       | 3/10 [00:18<00:27,  3.87s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8503, 'compress@10': 0.1632, 'time@10': 5.9485}:  40%|████      | 4/10 [00:18<00:27,  4.65s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0469, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8374, 'compress@10': 0.2886, 'time@10': 7.4936}:  40%|████      | 4/10 [00:25<00:27,  4.65s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0469, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8374, 'compress@10': 0.2886, 'time@10': 7.4936}:  50%|█████     | 5/10 [00:25<00:27,  5.45s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0484, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8365, 'compress@10': 0.2558, 'time@10': 7.731}:  50%|█████     | 5/10 [00:34<00:27,  5.45s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0484, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8365, 'compress@10': 0.2558, 'time@10': 7.731}:  60%|██████    | 6/10 [00:34<00:26,  6.64s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0485, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8426, 'compress@10': 0.2348, 'time@10': 8.024}:  60%|██████    | 6/10 [00:38<00:26,  6.64s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0485, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8426, 'compress@10': 0.2348, 'time@10': 8.024}:  70%|███████   | 7/10 [00:38<00:18,  6.08s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0486, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.8423, 'compress@10': 0.2177, 'time@10': 7.9118}:  70%|███████   | 7/10 [00:46<00:18,  6.08s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0486, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.8423, 'compress@10': 0.2177, 'time@10': 7.9118}:  80%|████████  | 8/10 [00:46<00:12,  6.43s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.049, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8634, 'compress@10': 0.2044, 'time@10': 8.4045}:  80%|████████  | 8/10 [00:52<00:12,  6.43s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.049, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8634, 'compress@10': 0.2044, 'time@10': 8.4045}:  90%|█████████ | 9/10 [00:52<00:06,  6.36s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8644, 'compress@10': 0.1932, 'time@10': 8.4582}:  90%|█████████ | 9/10 [01:01<00:06,  6.36s/it]  {'epoch': 6, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8644, 'compress@10': 0.1932, 'time@10': 8.4582}: 100%|██████████| 10/10 [01:01<00:00,  7.17s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8644, 'compress@10': 0.1932, 'time@10': 8.4582}: 100%|██████████| 10/10 [01:01<00:00,  6.13s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04753635462642207
Avg hit ratio: 0.8707173260619779
Avg ndcg: 0.8643647994960612
Avg compression ratio: 0.19319918375130976
Avg train time: 8.45824329853058
Std train time: 2.776117408943481
[0.06250000000000001, 0.06250000000000001, 0.1875, 0.06250000000000001, 0.8125, 0.06250000000000001, 0.06250000000000001, 0.06250000000000001, 0.06250000000000001, 0.06250000000000001]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8373, 'compress@10': 0.1118, 'time@10': 7.3751}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8373, 'compress@10': 0.1118, 'time@10': 7.3751}:  10%|█         | 1/10 [00:03<00:33,  3.72s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0448, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8496, 'compress@10': 0.1023, 'time@10': 6.8613}:  10%|█         | 1/10 [00:10<00:33,  3.72s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0448, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8496, 'compress@10': 0.1023, 'time@10': 6.8613}:  20%|██        | 2/10 [00:10<00:42,  5.29s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8521, 'compress@10': 0.1694, 'time@10': 6.0568}:  20%|██        | 2/10 [00:12<00:42,  5.29s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8521, 'compress@10': 0.1694, 'time@10': 6.0568}:  30%|███       | 3/10 [00:12<00:27,  3.91s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0357, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8406, 'compress@10': 0.151, 'time@10': 5.9573}:  30%|███       | 3/10 [00:18<00:27,  3.91s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0357, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8406, 'compress@10': 0.151, 'time@10': 5.9573}:  40%|████      | 4/10 [00:18<00:27,  4.61s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.044, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8299, 'compress@10': 0.2841, 'time@10': 7.5259}:  40%|████      | 4/10 [00:25<00:27,  4.61s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.044, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8299, 'compress@10': 0.2841, 'time@10': 7.5259}:  50%|█████     | 5/10 [00:25<00:27,  5.45s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0451, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.831, 'compress@10': 0.2506, 'time@10': 7.8302}:  50%|█████     | 5/10 [00:34<00:27,  5.45s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0451, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.831, 'compress@10': 0.2506, 'time@10': 7.8302}:  60%|██████    | 6/10 [00:34<00:27,  6.79s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0448, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8319, 'compress@10': 0.2291, 'time@10': 8.1199}:  60%|██████    | 6/10 [00:39<00:27,  6.79s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0448, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8319, 'compress@10': 0.2291, 'time@10': 8.1199}:  70%|███████   | 7/10 [00:39<00:18,  6.19s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0445, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8331, 'compress@10': 0.2116, 'time@10': 8.0119}:  70%|███████   | 7/10 [00:46<00:18,  6.19s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0445, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8331, 'compress@10': 0.2116, 'time@10': 8.0119}:  80%|████████  | 8/10 [00:46<00:13,  6.54s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0471, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8492, 'compress@10': 0.198, 'time@10': 8.4652}:  80%|████████  | 8/10 [00:52<00:13,  6.54s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0471, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8492, 'compress@10': 0.198, 'time@10': 8.4652}:  90%|█████████ | 9/10 [00:52<00:06,  6.40s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0469, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.848, 'compress@10': 0.1866, 'time@10': 8.5062}:  90%|█████████ | 9/10 [01:01<00:06,  6.40s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0469, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.848, 'compress@10': 0.1866, 'time@10': 8.5062}: 100%|██████████| 10/10 [01:01<00:00,  7.18s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0469, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.848, 'compress@10': 0.1866, 'time@10': 8.5062}: 100%|██████████| 10/10 [01:01<00:00,  6.16s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04688372097122147
Avg hit ratio: 0.8713176146622666
Avg ndcg: 0.8480429387209535
Avg compression ratio: 0.18660909007270537
Avg train time: 8.5062486410141
Std train time: 2.7502886891623
[0.055555555555555566, 0.055555555555555566, 0.16666666666666666, 0.055555555555555566, 0.8333333333333334, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8696, 'compress@10': 0.1053, 'time@10': 7.4417}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8696, 'compress@10': 0.1053, 'time@10': 7.4417}:  10%|█         | 1/10 [00:03<00:33,  3.78s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.867, 'compress@10': 0.0957, 'time@10': 6.9644}:  10%|█         | 1/10 [00:10<00:33,  3.78s/it] {'epoch': 8, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.867, 'compress@10': 0.0957, 'time@10': 6.9644}:  20%|██        | 2/10 [00:10<00:43,  5.39s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8637, 'compress@10': 0.159, 'time@10': 6.2223}:  20%|██        | 2/10 [00:12<00:43,  5.39s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8637, 'compress@10': 0.159, 'time@10': 6.2223}:  30%|███       | 3/10 [00:12<00:28,  4.03s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8582, 'compress@10': 0.1416, 'time@10': 6.1278}:  30%|███       | 3/10 [00:18<00:28,  4.03s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8582, 'compress@10': 0.1416, 'time@10': 6.1278}:  40%|████      | 4/10 [00:18<00:28,  4.76s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0402, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8451, 'compress@10': 0.2806, 'time@10': 7.6349}:  40%|████      | 4/10 [00:25<00:28,  4.76s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0402, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8451, 'compress@10': 0.2806, 'time@10': 7.6349}:  50%|█████     | 5/10 [00:25<00:27,  5.52s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0411, 'hit_ratio@10': 0.83, 'ndcg@10': 0.8445, 'compress@10': 0.2466, 'time@10': 7.9126}:  50%|█████     | 5/10 [00:34<00:27,  5.52s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0411, 'hit_ratio@10': 0.83, 'ndcg@10': 0.8445, 'compress@10': 0.2466, 'time@10': 7.9126}:  60%|██████    | 6/10 [00:34<00:27,  6.82s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0413, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8519, 'compress@10': 0.2247, 'time@10': 8.1383}:  60%|██████    | 6/10 [00:39<00:27,  6.82s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0413, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8519, 'compress@10': 0.2247, 'time@10': 8.1383}:  70%|███████   | 7/10 [00:39<00:18,  6.15s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0402, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8548, 'compress@10': 0.2069, 'time@10': 8.03}:  70%|███████   | 7/10 [00:46<00:18,  6.15s/it]   {'epoch': 8, 'num_users': 6.125, 'loss': 0.0402, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8548, 'compress@10': 0.2069, 'time@10': 8.03}:  80%|████████  | 8/10 [00:46<00:13,  6.53s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0415, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8605, 'compress@10': 0.1931, 'time@10': 8.5962}:  80%|████████  | 8/10 [00:53<00:13,  6.53s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0415, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8605, 'compress@10': 0.1931, 'time@10': 8.5962}:  90%|█████████ | 9/10 [00:53<00:06,  6.55s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0397, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8639, 'compress@10': 0.1815, 'time@10': 8.6457}:  90%|█████████ | 9/10 [01:02<00:06,  6.55s/it]    {'epoch': 8, 'num_users': 6.3, 'loss': 0.0397, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8639, 'compress@10': 0.1815, 'time@10': 8.6457}: 100%|██████████| 10/10 [01:02<00:00,  7.35s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0397, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8639, 'compress@10': 0.1815, 'time@10': 8.6457}: 100%|██████████| 10/10 [01:02<00:00,  6.26s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.03973872027689991
Avg hit ratio: 0.8540189133635654
Avg ndcg: 0.8638948181176449
Avg compression ratio: 0.18149952924224572
Avg train time: 8.645681023597717
Std train time: 2.7876152627095196
[0.05000000000000001, 0.05000000000000001, 0.15, 0.05000000000000001, 0.8500000000000001, 0.05000000000000001, 0.05000000000000001, 0.05000000000000001, 0.05000000000000001, 0.05000000000000001]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8404, 'compress@10': 0.1, 'time@10': 7.5826}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8404, 'compress@10': 0.1, 'time@10': 7.5826}:  10%|█         | 1/10 [00:03<00:34,  3.83s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0415, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8541, 'compress@10': 0.0903, 'time@10': 7.0554}:  10%|█         | 1/10 [00:10<00:34,  3.83s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0415, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8541, 'compress@10': 0.0903, 'time@10': 7.0554}:  20%|██        | 2/10 [00:10<00:43,  5.44s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8551, 'compress@10': 0.1507, 'time@10': 6.3788}:  20%|██        | 2/10 [00:12<00:43,  5.44s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8551, 'compress@10': 0.1507, 'time@10': 6.3788}:  30%|███       | 3/10 [00:12<00:28,  4.12s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8532, 'compress@10': 0.134, 'time@10': 6.2154}:  30%|███       | 3/10 [00:18<00:28,  4.12s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8532, 'compress@10': 0.134, 'time@10': 6.2154}:  40%|████      | 4/10 [00:18<00:28,  4.77s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0392, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8413, 'compress@10': 0.2778, 'time@10': 7.6806}:  40%|████      | 4/10 [00:25<00:28,  4.77s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0392, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8413, 'compress@10': 0.2778, 'time@10': 7.6806}:  50%|█████     | 5/10 [00:25<00:27,  5.50s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.04, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8433, 'compress@10': 0.2434, 'time@10': 7.9695}:  50%|█████     | 5/10 [00:34<00:27,  5.50s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.04, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8433, 'compress@10': 0.2434, 'time@10': 7.9695}:  60%|██████    | 6/10 [00:34<00:27,  6.85s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0394, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8456, 'compress@10': 0.2212, 'time@10': 8.3208}:  60%|██████    | 6/10 [00:40<00:27,  6.85s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0394, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8456, 'compress@10': 0.2212, 'time@10': 8.3208}:  70%|███████   | 7/10 [00:40<00:18,  6.33s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0386, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.8511, 'compress@10': 0.2032, 'time@10': 8.191}:  70%|███████   | 7/10 [00:47<00:18,  6.33s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0386, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.8511, 'compress@10': 0.2032, 'time@10': 8.191}:  80%|████████  | 8/10 [00:47<00:13,  6.64s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8754, 'compress@10': 0.1892, 'time@10': 8.7065}:  80%|████████  | 8/10 [00:53<00:13,  6.64s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8754, 'compress@10': 0.1892, 'time@10': 8.7065}:  90%|█████████ | 9/10 [00:53<00:06,  6.58s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0404, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8774, 'compress@10': 0.1774, 'time@10': 8.6943}:  90%|█████████ | 9/10 [01:02<00:06,  6.58s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0404, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8774, 'compress@10': 0.1774, 'time@10': 8.6943}: 100%|██████████| 10/10 [01:02<00:00,  7.21s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0404, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8774, 'compress@10': 0.1774, 'time@10': 8.6943}: 100%|██████████| 10/10 [01:02<00:00,  6.26s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.04042896353079763
Avg hit ratio: 0.8766341636103945
Avg ndcg: 0.8774428016479984
Avg compression ratio: 0.17740672106845418
Avg train time: 8.694339156150818
Std train time: 2.7265363210329605
[0.04545454545454546, 0.04545454545454546, 0.13636363636363635, 0.04545454545454546, 0.8636363636363638, 0.04545454545454546, 0.04545454545454546, 0.04545454545454546, 0.04545454545454546, 0.04545454545454546]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0397, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8688, 'compress@10': 0.0957, 'time@10': 7.0789}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0397, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8688, 'compress@10': 0.0957, 'time@10': 7.0789}:  10%|█         | 1/10 [00:03<00:32,  3.58s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0367, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8772, 'compress@10': 0.086, 'time@10': 6.7203}:  10%|█         | 1/10 [00:09<00:32,  3.58s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.0367, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8772, 'compress@10': 0.086, 'time@10': 6.7203}:  20%|██        | 2/10 [00:09<00:41,  5.24s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0245, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8705, 'compress@10': 0.1439, 'time@10': 6.1387}:  20%|██        | 2/10 [00:12<00:41,  5.24s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0245, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8705, 'compress@10': 0.1439, 'time@10': 6.1387}:  30%|███       | 3/10 [00:12<00:28,  4.00s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8554, 'compress@10': 0.1278, 'time@10': 6.0792}:  30%|███       | 3/10 [00:18<00:28,  4.00s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8554, 'compress@10': 0.1278, 'time@10': 6.0792}:  40%|████      | 4/10 [00:18<00:28,  4.77s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0371, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.844, 'compress@10': 0.2755, 'time@10': 7.5917}:  40%|████      | 4/10 [00:25<00:28,  4.77s/it] {'epoch': 10, 'num_users': 5.8, 'loss': 0.0371, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.844, 'compress@10': 0.2755, 'time@10': 7.5917}:  50%|█████     | 5/10 [00:25<00:27,  5.52s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0383, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8462, 'compress@10': 0.2407, 'time@10': 7.8834}:  50%|█████     | 5/10 [00:34<00:27,  5.52s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0383, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8462, 'compress@10': 0.2407, 'time@10': 7.8834}:  60%|██████    | 6/10 [00:34<00:27,  6.83s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0377, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8543, 'compress@10': 0.2183, 'time@10': 8.2146}:  60%|██████    | 6/10 [00:39<00:27,  6.83s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0377, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8543, 'compress@10': 0.2183, 'time@10': 8.2146}:  70%|███████   | 7/10 [00:39<00:18,  6.28s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0372, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8578, 'compress@10': 0.2001, 'time@10': 8.0975}:  70%|███████   | 7/10 [00:47<00:18,  6.28s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0372, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8578, 'compress@10': 0.2001, 'time@10': 8.0975}:  80%|████████  | 8/10 [00:47<00:13,  6.61s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0369, 'hit_ratio@10': 0.851, 'ndcg@10': 0.8635, 'compress@10': 0.1859, 'time@10': 8.6599}:  80%|████████  | 8/10 [00:53<00:13,  6.61s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0369, 'hit_ratio@10': 0.851, 'ndcg@10': 0.8635, 'compress@10': 0.1859, 'time@10': 8.6599}:  90%|█████████ | 9/10 [00:53<00:06,  6.61s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.036, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8664, 'compress@10': 0.1741, 'time@10': 8.6807}:  90%|█████████ | 9/10 [01:02<00:06,  6.61s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.036, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8664, 'compress@10': 0.1741, 'time@10': 8.6807}: 100%|██████████| 10/10 [01:02<00:00,  7.32s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.036, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8664, 'compress@10': 0.1741, 'time@10': 8.6807}: 100%|██████████| 10/10 [01:02<00:00,  6.27s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03599769515198126
Avg hit ratio: 0.8636567200013718
Avg ndcg: 0.866424159568812
Avg compression ratio: 0.17405707072503512
Avg train time: 8.680745816230774
Std train time: 2.807699756271412
[0.04166666666666667, 0.04166666666666667, 0.12499999999999999, 0.04166666666666667, 0.8750000000000001, 0.04166666666666667, 0.04166666666666667, 0.04166666666666667, 0.04166666666666667, 0.04166666666666667]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0511, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8306, 'compress@10': 0.0921, 'time@10': 7.5471}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0511, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8306, 'compress@10': 0.0921, 'time@10': 7.5471}:  10%|█         | 1/10 [00:03<00:34,  3.81s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8556, 'compress@10': 0.0824, 'time@10': 6.9913}:  10%|█         | 1/10 [00:10<00:34,  3.81s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8556, 'compress@10': 0.0824, 'time@10': 6.9913}:  20%|██        | 2/10 [00:10<00:43,  5.38s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8561, 'compress@10': 0.1382, 'time@10': 6.4813}:  20%|██        | 2/10 [00:13<00:43,  5.38s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8561, 'compress@10': 0.1382, 'time@10': 6.4813}:  30%|███       | 3/10 [00:13<00:29,  4.19s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8368, 'compress@10': 0.1227, 'time@10': 6.3281}:  30%|███       | 3/10 [00:18<00:29,  4.19s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8368, 'compress@10': 0.1227, 'time@10': 6.3281}:  40%|████      | 4/10 [00:18<00:29,  4.87s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0411, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8296, 'compress@10': 0.2736, 'time@10': 7.7681}:  40%|████      | 4/10 [00:25<00:29,  4.87s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0411, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8296, 'compress@10': 0.2736, 'time@10': 7.7681}:  50%|█████     | 5/10 [00:25<00:27,  5.57s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0429, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8398, 'compress@10': 0.2385, 'time@10': 8.0138}:  50%|█████     | 5/10 [00:35<00:27,  5.57s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0429, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8398, 'compress@10': 0.2385, 'time@10': 8.0138}:  60%|██████    | 6/10 [00:35<00:27,  6.83s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.043, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8492, 'compress@10': 0.2159, 'time@10': 8.5049}:  60%|██████    | 6/10 [00:40<00:27,  6.83s/it] {'epoch': 11, 'num_users': 6.2857, 'loss': 0.043, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8492, 'compress@10': 0.2159, 'time@10': 8.5049}:  70%|███████   | 7/10 [00:40<00:19,  6.48s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0424, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.8475, 'compress@10': 0.1975, 'time@10': 8.3679}:  70%|███████   | 7/10 [00:48<00:19,  6.48s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0424, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.8475, 'compress@10': 0.1975, 'time@10': 8.3679}:  80%|████████  | 8/10 [00:48<00:13,  6.79s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8562, 'compress@10': 0.1832, 'time@10': 8.8712}:  80%|████████  | 8/10 [00:54<00:13,  6.79s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8562, 'compress@10': 0.1832, 'time@10': 8.8712}:  90%|█████████ | 9/10 [00:54<00:06,  6.69s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0386, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.8647, 'compress@10': 0.1713, 'time@10': 8.8641}:  90%|█████████ | 9/10 [01:03<00:06,  6.69s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0386, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.8647, 'compress@10': 0.1713, 'time@10': 8.8641}: 100%|██████████| 10/10 [01:03<00:00,  7.36s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0386, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.8647, 'compress@10': 0.1713, 'time@10': 8.8641}: 100%|██████████| 10/10 [01:03<00:00,  6.36s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03863409538275787
Avg hit ratio: 0.8898789422235941
Avg ndcg: 0.8647020017985587
Avg compression ratio: 0.17126699501383927
Avg train time: 8.86408314704895
Std train time: 2.7417609961563407
[0.038461538461538464, 0.038461538461538464, 0.11538461538461538, 0.038461538461538464, 0.8846153846153847, 0.038461538461538464, 0.038461538461538464, 0.038461538461538464, 0.038461538461538464, 0.038461538461538464]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8675, 'compress@10': 0.0891, 'time@10': 7.4473}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8675, 'compress@10': 0.0891, 'time@10': 7.4473}:  10%|█         | 1/10 [00:03<00:34,  3.79s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8778, 'compress@10': 0.0793, 'time@10': 6.9783}:  10%|█         | 1/10 [00:10<00:34,  3.79s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8778, 'compress@10': 0.0793, 'time@10': 6.9783}:  20%|██        | 2/10 [00:10<00:43,  5.41s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8709, 'compress@10': 0.1334, 'time@10': 6.503}:  20%|██        | 2/10 [00:13<00:43,  5.41s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8709, 'compress@10': 0.1334, 'time@10': 6.503}:  30%|███       | 3/10 [00:13<00:29,  4.22s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0288, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8498, 'compress@10': 0.1183, 'time@10': 6.3257}:  30%|███       | 3/10 [00:18<00:29,  4.22s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0288, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8498, 'compress@10': 0.1183, 'time@10': 6.3257}:  40%|████      | 4/10 [00:18<00:29,  4.86s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0348, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8417, 'compress@10': 0.272, 'time@10': 7.7477}:  40%|████      | 4/10 [00:25<00:29,  4.86s/it] {'epoch': 12, 'num_users': 5.8, 'loss': 0.0348, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8417, 'compress@10': 0.272, 'time@10': 7.7477}:  50%|█████     | 5/10 [00:25<00:27,  5.55s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0361, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8498, 'compress@10': 0.2366, 'time@10': 7.9576}:  50%|█████     | 5/10 [00:34<00:27,  5.55s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0361, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8498, 'compress@10': 0.2366, 'time@10': 7.9576}:  60%|██████    | 6/10 [00:34<00:26,  6.73s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0362, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8505, 'compress@10': 0.2138, 'time@10': 8.3088}:  60%|██████    | 6/10 [00:40<00:26,  6.73s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0362, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8505, 'compress@10': 0.2138, 'time@10': 8.3088}:  70%|███████   | 7/10 [00:40<00:18,  6.25s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0342, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.858, 'compress@10': 0.1953, 'time@10': 8.1803}:  70%|███████   | 7/10 [00:47<00:18,  6.25s/it]  {'epoch': 12, 'num_users': 6.125, 'loss': 0.0342, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.858, 'compress@10': 0.1953, 'time@10': 8.1803}:  80%|████████  | 8/10 [00:47<00:13,  6.59s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0333, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8679, 'compress@10': 0.181, 'time@10': 8.7093}:  80%|████████  | 8/10 [00:53<00:13,  6.59s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0333, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8679, 'compress@10': 0.181, 'time@10': 8.7093}:  90%|█████████ | 9/10 [00:53<00:06,  6.56s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0335, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.8681, 'compress@10': 0.1689, 'time@10': 8.7637}:  90%|█████████ | 9/10 [01:03<00:06,  6.56s/it]  {'epoch': 12, 'num_users': 6.3, 'loss': 0.0335, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.8681, 'compress@10': 0.1689, 'time@10': 8.7637}: 100%|██████████| 10/10 [01:03<00:00,  7.41s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0335, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.8681, 'compress@10': 0.1689, 'time@10': 8.7637}: 100%|██████████| 10/10 [01:03<00:00,  6.31s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.033467372104026054
Avg hit ratio: 0.8872344522106831
Avg ndcg: 0.8680616314269525
Avg compression ratio: 0.16890495415053158
Avg train time: 8.763662505149842
Std train time: 2.6543430870653353
[0.03571428571428572, 0.03571428571428572, 0.10714285714285714, 0.03571428571428572, 0.8928571428571429, 0.03571428571428572, 0.03571428571428572, 0.03571428571428572, 0.03571428571428572, 0.03571428571428572]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.051, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8365, 'compress@10': 0.0865, 'time@10': 7.3379}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.051, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8365, 'compress@10': 0.0865, 'time@10': 7.3379}:  10%|█         | 1/10 [00:03<00:33,  3.71s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8684, 'compress@10': 0.0767, 'time@10': 6.8785}:  10%|█         | 1/10 [00:10<00:33,  3.71s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8684, 'compress@10': 0.0767, 'time@10': 6.8785}:  20%|██        | 2/10 [00:10<00:42,  5.32s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8646, 'compress@10': 0.1293, 'time@10': 6.4092}:  20%|██        | 2/10 [00:12<00:42,  5.32s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8646, 'compress@10': 0.1293, 'time@10': 6.4092}:  30%|███       | 3/10 [00:12<00:29,  4.16s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8506, 'compress@10': 0.1145, 'time@10': 6.255}:  30%|███       | 3/10 [00:18<00:29,  4.16s/it]  {'epoch': 13, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8506, 'compress@10': 0.1145, 'time@10': 6.255}:  40%|████      | 4/10 [00:18<00:28,  4.82s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0355, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.843, 'compress@10': 0.2706, 'time@10': 7.7168}:  40%|████      | 4/10 [00:25<00:28,  4.82s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0355, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.843, 'compress@10': 0.2706, 'time@10': 7.7168}:  50%|█████     | 5/10 [00:25<00:27,  5.54s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0342, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8525, 'compress@10': 0.2351, 'time@10': 7.9642}:  50%|█████     | 5/10 [00:34<00:27,  5.54s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0342, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8525, 'compress@10': 0.2351, 'time@10': 7.9642}:  60%|██████    | 6/10 [00:34<00:27,  6.80s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8604, 'compress@10': 0.2121, 'time@10': 8.3257}:  60%|██████    | 6/10 [00:40<00:27,  6.80s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8604, 'compress@10': 0.2121, 'time@10': 8.3257}:  70%|███████   | 7/10 [00:40<00:18,  6.30s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0338, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8631, 'compress@10': 0.1935, 'time@10': 8.1935}:  70%|███████   | 7/10 [00:47<00:18,  6.30s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0338, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8631, 'compress@10': 0.1935, 'time@10': 8.1935}:  80%|████████  | 8/10 [00:47<00:13,  6.62s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0333, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8732, 'compress@10': 0.179, 'time@10': 8.7136}:  80%|████████  | 8/10 [00:53<00:13,  6.62s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0333, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8732, 'compress@10': 0.179, 'time@10': 8.7136}:  90%|█████████ | 9/10 [00:53<00:06,  6.58s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0314, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8798, 'compress@10': 0.1669, 'time@10': 8.7493}:  90%|█████████ | 9/10 [01:02<00:06,  6.58s/it]  {'epoch': 13, 'num_users': 6.3, 'loss': 0.0314, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8798, 'compress@10': 0.1669, 'time@10': 8.7493}: 100%|██████████| 10/10 [01:02<00:00,  7.36s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0314, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8798, 'compress@10': 0.1669, 'time@10': 8.7493}: 100%|██████████| 10/10 [01:02<00:00,  6.30s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.031402766519895715
Avg hit ratio: 0.8813868787315305
Avg ndcg: 0.8797550645019889
Avg compression ratio: 0.16688289539982837
Avg train time: 8.749268889427185
Std train time: 2.6954805338964904
[0.03333333333333334, 0.03333333333333334, 0.09999999999999999, 0.03333333333333334, 0.9, 0.03333333333333334, 0.03333333333333334, 0.03333333333333334, 0.03333333333333334, 0.03333333333333334]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0393, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8568, 'compress@10': 0.0842, 'time@10': 7.3851}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0393, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8568, 'compress@10': 0.0842, 'time@10': 7.3851}:  10%|█         | 1/10 [00:03<00:33,  3.73s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0342, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8827, 'compress@10': 0.0744, 'time@10': 6.7697}:  10%|█         | 1/10 [00:09<00:33,  3.73s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0342, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8827, 'compress@10': 0.0744, 'time@10': 6.7697}:  20%|██        | 2/10 [00:09<00:41,  5.18s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8742, 'compress@10': 0.1258, 'time@10': 6.3563}:  20%|██        | 2/10 [00:12<00:41,  5.18s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8742, 'compress@10': 0.1258, 'time@10': 6.3563}:  30%|███       | 3/10 [00:12<00:28,  4.09s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8625, 'compress@10': 0.1113, 'time@10': 6.1512}:  30%|███       | 3/10 [00:18<00:28,  4.09s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8625, 'compress@10': 0.1113, 'time@10': 6.1512}:  40%|████      | 4/10 [00:18<00:28,  4.68s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0316, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8539, 'compress@10': 0.2694, 'time@10': 7.7232}:  40%|████      | 4/10 [00:25<00:28,  4.68s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0316, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8539, 'compress@10': 0.2694, 'time@10': 7.7232}:  50%|█████     | 5/10 [00:25<00:27,  5.53s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.034, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8633, 'compress@10': 0.2337, 'time@10': 7.9842}:  50%|█████     | 5/10 [00:34<00:27,  5.53s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.034, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8633, 'compress@10': 0.2337, 'time@10': 7.9842}:  60%|██████    | 6/10 [00:34<00:27,  6.82s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0365, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8687, 'compress@10': 0.2106, 'time@10': 8.3117}:  60%|██████    | 6/10 [00:39<00:27,  6.82s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0365, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8687, 'compress@10': 0.2106, 'time@10': 8.3117}:  70%|███████   | 7/10 [00:39<00:18,  6.29s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0345, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8756, 'compress@10': 0.1919, 'time@10': 8.197}:  70%|███████   | 7/10 [00:47<00:18,  6.29s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0345, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8756, 'compress@10': 0.1919, 'time@10': 8.197}:  80%|████████  | 8/10 [00:47<00:13,  6.65s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0346, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8914, 'compress@10': 0.1773, 'time@10': 8.7641}:  80%|████████  | 8/10 [00:53<00:13,  6.65s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0346, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8914, 'compress@10': 0.1773, 'time@10': 8.7641}:  90%|█████████ | 9/10 [00:53<00:06,  6.66s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0322, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8966, 'compress@10': 0.1651, 'time@10': 8.7254}:  90%|█████████ | 9/10 [01:02<00:06,  6.66s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0322, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8966, 'compress@10': 0.1651, 'time@10': 8.7254}: 100%|██████████| 10/10 [01:02<00:00,  7.20s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0322, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8966, 'compress@10': 0.1651, 'time@10': 8.7254}: 100%|██████████| 10/10 [01:02<00:00,  6.24s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.032226718239360186
Avg hit ratio: 0.8815706715469025
Avg ndcg: 0.8966450358864391
Avg compression ratio: 0.1651280706861728
Avg train time: 8.725443601608276
Std train time: 2.868735437780774
[0.03125000000000001, 0.03125000000000001, 0.09374999999999999, 0.03125000000000001, 0.84375, 0.03125000000000001, 0.09375, 0.03125000000000001, 0.03125000000000001, 0.03125000000000001]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0428, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8463, 'compress@10': 0.0822, 'time@10': 7.1194}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0428, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8463, 'compress@10': 0.0822, 'time@10': 7.1194}:  10%|█         | 1/10 [00:03<00:32,  3.60s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8762, 'compress@10': 0.0724, 'time@10': 6.4344}:  10%|█         | 1/10 [00:09<00:32,  3.60s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8762, 'compress@10': 0.0724, 'time@10': 6.4344}:  20%|██        | 2/10 [00:09<00:39,  4.88s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8699, 'compress@10': 0.1227, 'time@10': 6.0691}:  20%|██        | 2/10 [00:12<00:39,  4.88s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8699, 'compress@10': 0.1227, 'time@10': 6.0691}:  30%|███       | 3/10 [00:12<00:27,  3.89s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8635, 'compress@10': 0.1085, 'time@10': 5.9058}:  30%|███       | 3/10 [00:17<00:27,  3.89s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8635, 'compress@10': 0.1085, 'time@10': 5.9058}:  40%|████      | 4/10 [00:17<00:27,  4.51s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0307, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8563, 'compress@10': 0.2561, 'time@10': 7.4415}:  40%|████      | 4/10 [00:24<00:27,  4.51s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0307, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8563, 'compress@10': 0.2561, 'time@10': 7.4415}:  50%|█████     | 5/10 [00:24<00:26,  5.34s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0313, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8664, 'compress@10': 0.2222, 'time@10': 7.74}:  50%|█████     | 5/10 [00:33<00:26,  5.34s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0313, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8664, 'compress@10': 0.2222, 'time@10': 7.74}:  60%|██████    | 6/10 [00:33<00:26,  6.68s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0314, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8669, 'compress@10': 0.2091, 'time@10': 8.1227}:  60%|██████    | 6/10 [00:38<00:26,  6.68s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0314, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8669, 'compress@10': 0.2091, 'time@10': 8.1227}:  70%|███████   | 7/10 [00:38<00:18,  6.21s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0308, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.8711, 'compress@10': 0.1903, 'time@10': 7.9988}:  70%|███████   | 7/10 [00:46<00:18,  6.21s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0308, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.8711, 'compress@10': 0.1903, 'time@10': 7.9988}:  80%|████████  | 8/10 [00:46<00:13,  6.52s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0327, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.894, 'compress@10': 0.1757, 'time@10': 8.5079}:  80%|████████  | 8/10 [00:52<00:13,  6.52s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0327, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.894, 'compress@10': 0.1757, 'time@10': 8.5079}:  90%|█████████ | 9/10 [00:52<00:06,  6.46s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.8965, 'compress@10': 0.1635, 'time@10': 8.498}:  90%|█████████ | 9/10 [01:00<00:06,  6.46s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.8965, 'compress@10': 0.1635, 'time@10': 8.498}: 100%|██████████| 10/10 [01:00<00:00,  7.08s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.8965, 'compress@10': 0.1635, 'time@10': 8.498}: 100%|██████████| 10/10 [01:00<00:00,  6.08s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.0316262728275439
Avg hit ratio: 0.8837928937691247
Avg ndcg: 0.8965482705530194
Avg compression ratio: 0.16345913772769946
Avg train time: 8.498018860816956
Std train time: 2.785170642491908
[0.02941176470588236, 0.02941176470588236, 0.08823529411764705, 0.02941176470588236, 0.7941176470588235, 0.02941176470588236, 0.08823529411764706, 0.02941176470588236, 0.08823529411764706, 0.02941176470588236]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8581, 'compress@10': 0.0805, 'time@10': 7.0074}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8581, 'compress@10': 0.0805, 'time@10': 7.0074}:  10%|█         | 1/10 [00:03<00:31,  3.54s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8911, 'compress@10': 0.0706, 'time@10': 6.4984}:  10%|█         | 1/10 [00:09<00:31,  3.54s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8911, 'compress@10': 0.0706, 'time@10': 6.4984}:  20%|██        | 2/10 [00:09<00:40,  5.00s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8798, 'compress@10': 0.1199, 'time@10': 6.138}:  20%|██        | 2/10 [00:12<00:40,  5.00s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8798, 'compress@10': 0.1199, 'time@10': 6.138}:  30%|███       | 3/10 [00:12<00:27,  3.97s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0256, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8653, 'compress@10': 0.106, 'time@10': 5.921}:  30%|███       | 3/10 [00:17<00:27,  3.97s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0256, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8653, 'compress@10': 0.106, 'time@10': 5.921}:  40%|████      | 4/10 [00:17<00:26,  4.50s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0293, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8589, 'compress@10': 0.2444, 'time@10': 7.4381}:  40%|████      | 4/10 [00:24<00:26,  4.50s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0293, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8589, 'compress@10': 0.2444, 'time@10': 7.4381}:  50%|█████     | 5/10 [00:24<00:26,  5.32s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0284, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8698, 'compress@10': 0.2122, 'time@10': 7.7146}:  50%|█████     | 5/10 [00:33<00:26,  5.32s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0284, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8698, 'compress@10': 0.2122, 'time@10': 7.7146}:  60%|██████    | 6/10 [00:33<00:26,  6.62s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0281, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8792, 'compress@10': 0.1997, 'time@10': 8.1529}:  60%|██████    | 6/10 [00:38<00:26,  6.62s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0281, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8792, 'compress@10': 0.1997, 'time@10': 8.1529}:  70%|███████   | 7/10 [00:38<00:18,  6.23s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0274, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.8833, 'compress@10': 0.1819, 'time@10': 8.0277}:  70%|███████   | 7/10 [00:46<00:18,  6.23s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0274, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.8833, 'compress@10': 0.1819, 'time@10': 8.0277}:  80%|████████  | 8/10 [00:46<00:13,  6.54s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0295, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8969, 'compress@10': 0.1744, 'time@10': 8.6487}:  80%|████████  | 8/10 [00:53<00:13,  6.54s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0295, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8969, 'compress@10': 0.1744, 'time@10': 8.6487}:  90%|█████████ | 9/10 [00:53<00:06,  6.63s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0279, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9021, 'compress@10': 0.1621, 'time@10': 8.6254}:  90%|█████████ | 9/10 [01:01<00:06,  6.63s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0279, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9021, 'compress@10': 0.1621, 'time@10': 8.6254}: 100%|██████████| 10/10 [01:01<00:00,  7.19s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0279, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9021, 'compress@10': 0.1621, 'time@10': 8.6254}: 100%|██████████| 10/10 [01:01<00:00,  6.15s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.0278942582892902
Avg hit ratio: 0.8866500366262675
Avg ndcg: 0.9021493066274999
Avg compression ratio: 0.16206946290874097
Avg train time: 8.62540876865387
Std train time: 2.9486431033658325
[0.027777777777777783, 0.027777777777777783, 0.08333333333333333, 0.027777777777777783, 0.75, 0.027777777777777783, 0.08333333333333334, 0.027777777777777783, 0.1388888888888889, 0.027777777777777783]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0354, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8594, 'compress@10': 0.079, 'time@10': 7.043}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0354, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8594, 'compress@10': 0.079, 'time@10': 7.043}:  10%|█         | 1/10 [00:03<00:32,  3.56s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8933, 'compress@10': 0.0691, 'time@10': 6.494}:  10%|█         | 1/10 [00:09<00:32,  3.56s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8933, 'compress@10': 0.0691, 'time@10': 6.494}:  20%|██        | 2/10 [00:09<00:39,  4.98s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8813, 'compress@10': 0.1175, 'time@10': 6.1377}:  20%|██        | 2/10 [00:12<00:39,  4.98s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8813, 'compress@10': 0.1175, 'time@10': 6.1377}:  30%|███       | 3/10 [00:12<00:27,  3.96s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8694, 'compress@10': 0.1037, 'time@10': 5.9802}:  30%|███       | 3/10 [00:17<00:27,  3.96s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8694, 'compress@10': 0.1037, 'time@10': 5.9802}:  40%|████      | 4/10 [00:17<00:27,  4.59s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0274, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8627, 'compress@10': 0.234, 'time@10': 7.6365}:  40%|████      | 4/10 [00:25<00:27,  4.59s/it] {'epoch': 17, 'num_users': 5.8, 'loss': 0.0274, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8627, 'compress@10': 0.234, 'time@10': 7.6365}:  50%|█████     | 5/10 [00:25<00:27,  5.52s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0295, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8765, 'compress@10': 0.2032, 'time@10': 7.8617}:  50%|█████     | 5/10 [00:34<00:27,  5.52s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0295, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8765, 'compress@10': 0.2032, 'time@10': 7.8617}:  60%|██████    | 6/10 [00:34<00:26,  6.71s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0301, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8783, 'compress@10': 0.1913, 'time@10': 8.2531}:  60%|██████    | 6/10 [00:39<00:26,  6.71s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0301, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8783, 'compress@10': 0.1913, 'time@10': 8.2531}:  70%|███████   | 7/10 [00:39<00:18,  6.26s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0288, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.8855, 'compress@10': 0.1744, 'time@10': 8.1247}:  70%|███████   | 7/10 [00:46<00:18,  6.26s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0288, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.8855, 'compress@10': 0.1744, 'time@10': 8.1247}:  80%|████████  | 8/10 [00:46<00:13,  6.58s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8911, 'compress@10': 0.1732, 'time@10': 8.7133}:  80%|████████  | 8/10 [00:53<00:13,  6.58s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8911, 'compress@10': 0.1732, 'time@10': 8.7133}:  90%|█████████ | 9/10 [00:53<00:06,  6.63s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0265, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8988, 'compress@10': 0.1608, 'time@10': 8.6936}:  90%|█████████ | 9/10 [01:01<00:06,  6.63s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0265, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8988, 'compress@10': 0.1608, 'time@10': 8.6936}: 100%|██████████| 10/10 [01:01<00:00,  7.23s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0265, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8988, 'compress@10': 0.1608, 'time@10': 8.6936}: 100%|██████████| 10/10 [01:01<00:00,  6.19s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02645089819785403
Avg hit ratio: 0.8719131945210042
Avg ndcg: 0.8987983094779409
Avg compression ratio: 0.16082548098244165
Avg train time: 8.69362108707428
Std train time: 3.006396580431757
[0.026315789473684216, 0.026315789473684216, 0.07894736842105263, 0.026315789473684216, 0.7631578947368421, 0.026315789473684216, 0.07894736842105264, 0.026315789473684216, 0.13157894736842105, 0.026315789473684216]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0319, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8624, 'compress@10': 0.0776, 'time@10': 7.164}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0319, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8624, 'compress@10': 0.0776, 'time@10': 7.164}:  10%|█         | 1/10 [00:03<00:32,  3.62s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8977, 'compress@10': 0.0677, 'time@10': 6.6066}:  10%|█         | 1/10 [00:09<00:32,  3.62s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8977, 'compress@10': 0.0677, 'time@10': 6.6066}:  20%|██        | 2/10 [00:09<00:40,  5.07s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8842, 'compress@10': 0.1153, 'time@10': 6.2287}:  20%|██        | 2/10 [00:12<00:40,  5.07s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8842, 'compress@10': 0.1153, 'time@10': 6.2287}:  30%|███       | 3/10 [00:12<00:28,  4.02s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8835, 'compress@10': 0.1017, 'time@10': 5.976}:  30%|███       | 3/10 [00:17<00:28,  4.02s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8835, 'compress@10': 0.1017, 'time@10': 5.976}:  40%|████      | 4/10 [00:17<00:27,  4.51s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0252, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8758, 'compress@10': 0.235, 'time@10': 7.4812}:  40%|████      | 4/10 [00:24<00:27,  4.51s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0252, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8758, 'compress@10': 0.235, 'time@10': 7.4812}:  50%|█████     | 5/10 [00:24<00:26,  5.34s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0255, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8851, 'compress@10': 0.2038, 'time@10': 7.6945}:  50%|█████     | 5/10 [00:33<00:26,  5.34s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0255, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8851, 'compress@10': 0.2038, 'time@10': 7.6945}:  60%|██████    | 6/10 [00:33<00:26,  6.51s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0254, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8872, 'compress@10': 0.1912, 'time@10': 8.1181}:  60%|██████    | 6/10 [00:38<00:26,  6.51s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0254, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8872, 'compress@10': 0.1912, 'time@10': 8.1181}:  70%|███████   | 7/10 [00:38<00:18,  6.14s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0246, 'hit_ratio@10': 0.882, 'ndcg@10': 0.8924, 'compress@10': 0.1741, 'time@10': 8.0028}:  70%|███████   | 7/10 [00:45<00:18,  6.14s/it]  {'epoch': 18, 'num_users': 6.125, 'loss': 0.0246, 'hit_ratio@10': 0.882, 'ndcg@10': 0.8924, 'compress@10': 0.1741, 'time@10': 8.0028}:  80%|████████  | 8/10 [00:45<00:12,  6.49s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0235, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.898, 'compress@10': 0.1721, 'time@10': 8.6191}:  80%|████████  | 8/10 [00:52<00:12,  6.49s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0235, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.898, 'compress@10': 0.1721, 'time@10': 8.6191}:  90%|█████████ | 9/10 [00:52<00:06,  6.59s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9012, 'compress@10': 0.1598, 'time@10': 8.6031}:  90%|█████████ | 9/10 [01:01<00:06,  6.59s/it]  {'epoch': 18, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9012, 'compress@10': 0.1598, 'time@10': 8.6031}: 100%|██████████| 10/10 [01:01<00:00,  7.18s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9012, 'compress@10': 0.1598, 'time@10': 8.6031}: 100%|██████████| 10/10 [01:01<00:00,  6.13s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.023558944503503168
Avg hit ratio: 0.8747703373781472
Avg ndcg: 0.9012305228994835
Avg compression ratio: 0.15975804280008396
Avg train time: 8.603073048591614
Std train time: 2.90815097366865
[0.025000000000000005, 0.025000000000000005, 0.075, 0.025000000000000005, 0.775, 0.025000000000000005, 0.07500000000000001, 0.025000000000000005, 0.125, 0.025000000000000005]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0256, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8838, 'compress@10': 0.0763, 'time@10': 7.2615}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0256, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8838, 'compress@10': 0.0763, 'time@10': 7.2615}:  10%|█         | 1/10 [00:03<00:33,  3.67s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9102, 'compress@10': 0.0664, 'time@10': 6.6043}:  10%|█         | 1/10 [00:09<00:33,  3.67s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9102, 'compress@10': 0.0664, 'time@10': 6.6043}:  20%|██        | 2/10 [00:09<00:40,  5.03s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.8925, 'compress@10': 0.1133, 'time@10': 6.203}:  20%|██        | 2/10 [00:12<00:40,  5.03s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.8925, 'compress@10': 0.1133, 'time@10': 6.203}:  30%|███       | 3/10 [00:12<00:27,  3.98s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8996, 'compress@10': 0.0999, 'time@10': 5.9482}:  30%|███       | 3/10 [00:17<00:27,  3.98s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8996, 'compress@10': 0.0999, 'time@10': 5.9482}:  40%|████      | 4/10 [00:17<00:26,  4.47s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8912, 'compress@10': 0.2359, 'time@10': 7.4435}:  40%|████      | 4/10 [00:24<00:26,  4.47s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8912, 'compress@10': 0.2359, 'time@10': 7.4435}:  50%|█████     | 5/10 [00:24<00:26,  5.29s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0223, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8993, 'compress@10': 0.2043, 'time@10': 7.7116}:  50%|█████     | 5/10 [00:33<00:26,  5.29s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0223, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8993, 'compress@10': 0.2043, 'time@10': 7.7116}:  60%|██████    | 6/10 [00:33<00:26,  6.59s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.021, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9053, 'compress@10': 0.1911, 'time@10': 8.1029}:  60%|██████    | 6/10 [00:38<00:26,  6.59s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.021, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9053, 'compress@10': 0.1911, 'time@10': 8.1029}:  70%|███████   | 7/10 [00:38<00:18,  6.16s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0209, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9078, 'compress@10': 0.1739, 'time@10': 7.9403}:  70%|███████   | 7/10 [00:45<00:18,  6.16s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0209, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9078, 'compress@10': 0.1739, 'time@10': 7.9403}:  80%|████████  | 8/10 [00:45<00:12,  6.38s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.9145, 'compress@10': 0.1712, 'time@10': 8.5065}:  80%|████████  | 8/10 [00:52<00:12,  6.38s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.9145, 'compress@10': 0.1712, 'time@10': 8.5065}:  90%|█████████ | 9/10 [00:52<00:06,  6.43s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.02, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9194, 'compress@10': 0.1588, 'time@10': 8.4909}:  90%|█████████ | 9/10 [01:00<00:06,  6.43s/it]     {'epoch': 19, 'num_users': 6.3, 'loss': 0.02, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9194, 'compress@10': 0.1588, 'time@10': 8.4909}: 100%|██████████| 10/10 [01:00<00:00,  7.04s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.02, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9194, 'compress@10': 0.1588, 'time@10': 8.4909}: 100%|██████████| 10/10 [01:00<00:00,  6.05s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.019953232057867965
Avg hit ratio: 0.8675219745355569
Avg ndcg: 0.9194207350181784
Avg compression ratio: 0.15879863530658384
Avg train time: 8.490888810157776
Std train time: 2.8371916951628995
[0.023809523809523815, 0.023809523809523815, 0.07142857142857142, 0.023809523809523815, 0.7857142857142857, 0.023809523809523815, 0.07142857142857144, 0.023809523809523815, 0.11904761904761904, 0.023809523809523815]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0405, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.896, 'compress@10': 0.0752, 'time@10': 7.1411}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0405, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.896, 'compress@10': 0.0752, 'time@10': 7.1411}:  10%|█         | 1/10 [00:03<00:32,  3.61s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.926, 'compress@10': 0.0653, 'time@10': 6.6615}:  10%|█         | 1/10 [00:09<00:32,  3.61s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.926, 'compress@10': 0.0653, 'time@10': 6.6615}:  20%|██        | 2/10 [00:09<00:41,  5.14s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.74, 'ndcg@10': 0.903, 'compress@10': 0.1115, 'time@10': 6.4516}:  20%|██        | 2/10 [00:12<00:41,  5.14s/it]  {'epoch': 20, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.74, 'ndcg@10': 0.903, 'compress@10': 0.1115, 'time@10': 6.4516}:  30%|███       | 3/10 [00:12<00:29,  4.19s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.9018, 'compress@10': 0.0983, 'time@10': 6.1824}:  30%|███       | 3/10 [00:18<00:29,  4.19s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.9018, 'compress@10': 0.0983, 'time@10': 6.1824}:  40%|████      | 4/10 [00:18<00:28,  4.67s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0232, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8933, 'compress@10': 0.2367, 'time@10': 7.7258}:  40%|████      | 4/10 [00:25<00:28,  4.67s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0232, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8933, 'compress@10': 0.2367, 'time@10': 7.7258}:  50%|█████     | 5/10 [00:25<00:27,  5.51s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0249, 'hit_ratio@10': 0.84, 'ndcg@10': 0.9011, 'compress@10': 0.2048, 'time@10': 7.8968}:  50%|█████     | 5/10 [00:34<00:27,  5.51s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0249, 'hit_ratio@10': 0.84, 'ndcg@10': 0.9011, 'compress@10': 0.2048, 'time@10': 7.8968}:  60%|██████    | 6/10 [00:34<00:26,  6.62s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0283, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.9073, 'compress@10': 0.1911, 'time@10': 8.3016}:  60%|██████    | 6/10 [00:39<00:26,  6.62s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0283, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.9073, 'compress@10': 0.1911, 'time@10': 8.3016}:  70%|███████   | 7/10 [00:39<00:18,  6.22s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0269, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9107, 'compress@10': 0.1736, 'time@10': 8.1108}:  70%|███████   | 7/10 [00:46<00:18,  6.22s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0269, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9107, 'compress@10': 0.1736, 'time@10': 8.1108}:  80%|████████  | 8/10 [00:46<00:12,  6.41s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0289, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9288, 'compress@10': 0.1704, 'time@10': 8.7003}:  80%|████████  | 8/10 [00:53<00:12,  6.41s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0289, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9288, 'compress@10': 0.1704, 'time@10': 8.7003}:  90%|█████████ | 9/10 [00:53<00:06,  6.52s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9347, 'compress@10': 0.1579, 'time@10': 8.6899}:  90%|█████████ | 9/10 [01:01<00:06,  6.52s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9347, 'compress@10': 0.1579, 'time@10': 8.6899}: 100%|██████████| 10/10 [01:01<00:00,  7.17s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9347, 'compress@10': 0.1579, 'time@10': 8.6899}: 100%|██████████| 10/10 [01:01<00:00,  6.17s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.029137083431711168
Avg hit ratio: 0.8662813730317975
Avg ndcg: 0.9347142034011515
Avg compression ratio: 0.15793315442242287
Avg train time: 8.689887976646423
Std train time: 2.899393386682001
[0.02272727272727273, 0.02272727272727273, 0.06818181818181818, 0.02272727272727273, 0.75, 0.02272727272727273, 0.11363636363636365, 0.02272727272727273, 0.11363636363636363, 0.02272727272727273]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8898, 'compress@10': 0.0742, 'time@10': 7.3911}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8898, 'compress@10': 0.0742, 'time@10': 7.3911}:  10%|█         | 1/10 [00:03<00:33,  3.73s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9113, 'compress@10': 0.0642, 'time@10': 6.6878}:  10%|█         | 1/10 [00:09<00:33,  3.73s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9113, 'compress@10': 0.0642, 'time@10': 6.6878}:  20%|██        | 2/10 [00:09<00:40,  5.08s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8933, 'compress@10': 0.1099, 'time@10': 6.272}:  20%|██        | 2/10 [00:12<00:40,  5.08s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8933, 'compress@10': 0.1099, 'time@10': 6.272}:  30%|███       | 3/10 [00:12<00:28,  4.02s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8881, 'compress@10': 0.0968, 'time@10': 6.0324}:  30%|███       | 3/10 [00:17<00:28,  4.02s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8881, 'compress@10': 0.0968, 'time@10': 6.0324}:  40%|████      | 4/10 [00:17<00:27,  4.54s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0211, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8836, 'compress@10': 0.2285, 'time@10': 7.5604}:  40%|████      | 4/10 [00:24<00:27,  4.54s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0211, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8836, 'compress@10': 0.2285, 'time@10': 7.5604}:  50%|█████     | 5/10 [00:24<00:26,  5.39s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.894, 'compress@10': 0.1978, 'time@10': 7.7671}:  50%|█████     | 5/10 [00:33<00:26,  5.39s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.894, 'compress@10': 0.1978, 'time@10': 7.7671}:  60%|██████    | 6/10 [00:33<00:26,  6.56s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8959, 'compress@10': 0.1908, 'time@10': 8.1754}:  60%|██████    | 6/10 [00:38<00:26,  6.56s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8959, 'compress@10': 0.1908, 'time@10': 8.1754}:  70%|███████   | 7/10 [00:38<00:18,  6.16s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9006, 'compress@10': 0.1733, 'time@10': 7.9836}:  70%|███████   | 7/10 [00:45<00:18,  6.16s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9006, 'compress@10': 0.1733, 'time@10': 7.9836}:  80%|████████  | 8/10 [00:45<00:12,  6.33s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0259, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9145, 'compress@10': 0.1695, 'time@10': 8.5986}:  80%|████████  | 8/10 [00:52<00:12,  6.33s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0259, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9145, 'compress@10': 0.1695, 'time@10': 8.5986}:  90%|█████████ | 9/10 [00:52<00:06,  6.47s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.026, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9171, 'compress@10': 0.1571, 'time@10': 8.5972}:  90%|█████████ | 9/10 [01:01<00:06,  6.47s/it]     {'epoch': 21, 'num_users': 6.3, 'loss': 0.026, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9171, 'compress@10': 0.1571, 'time@10': 8.5972}: 100%|██████████| 10/10 [01:01<00:00,  7.14s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.026, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9171, 'compress@10': 0.1571, 'time@10': 8.5972}: 100%|██████████| 10/10 [01:01<00:00,  6.10s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.02598137652988754
Avg hit ratio: 0.8769925596003695
Avg ndcg: 0.9171396652516444
Avg compression ratio: 0.15705291110847525
Avg train time: 8.597175860404969
Std train time: 2.9494488633904257
[0.02173913043478261, 0.02173913043478261, 0.06521739130434782, 0.02173913043478261, 0.717391304347826, 0.02173913043478261, 0.10869565217391305, 0.02173913043478261, 0.15217391304347827, 0.02173913043478261]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.894, 'compress@10': 0.0732, 'time@10': 7.1873}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.894, 'compress@10': 0.0732, 'time@10': 7.1873}:  10%|█         | 1/10 [00:03<00:32,  3.63s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9202, 'compress@10': 0.0633, 'time@10': 6.6284}:  10%|█         | 1/10 [00:09<00:32,  3.63s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9202, 'compress@10': 0.0633, 'time@10': 6.6284}:  20%|██        | 2/10 [00:09<00:40,  5.09s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8992, 'compress@10': 0.1084, 'time@10': 6.2286}:  20%|██        | 2/10 [00:12<00:40,  5.09s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8992, 'compress@10': 0.1084, 'time@10': 6.2286}:  30%|███       | 3/10 [00:12<00:28,  4.02s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8875, 'compress@10': 0.0955, 'time@10': 6.002}:  30%|███       | 3/10 [00:17<00:28,  4.02s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8875, 'compress@10': 0.0955, 'time@10': 6.002}:  40%|████      | 4/10 [00:17<00:27,  4.55s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8854, 'compress@10': 0.221, 'time@10': 7.5265}:  40%|████      | 4/10 [00:24<00:27,  4.55s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8854, 'compress@10': 0.221, 'time@10': 7.5265}:  50%|█████     | 5/10 [00:24<00:26,  5.38s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0249, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9018, 'compress@10': 0.1914, 'time@10': 7.759}:  50%|█████     | 5/10 [00:33<00:26,  5.38s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0249, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9018, 'compress@10': 0.1914, 'time@10': 7.759}:  60%|██████    | 6/10 [00:33<00:26,  6.62s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9079, 'compress@10': 0.1847, 'time@10': 8.1522}:  60%|██████    | 6/10 [00:39<00:26,  6.62s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9079, 'compress@10': 0.1847, 'time@10': 8.1522}:  70%|███████   | 7/10 [00:39<00:18,  6.19s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0237, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9082, 'compress@10': 0.1678, 'time@10': 7.9494}:  70%|███████   | 7/10 [00:45<00:18,  6.19s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0237, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9082, 'compress@10': 0.1678, 'time@10': 7.9494}:  80%|████████  | 8/10 [00:45<00:12,  6.31s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.914, 'compress@10': 0.1688, 'time@10': 8.5976}:  80%|████████  | 8/10 [00:52<00:12,  6.31s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.914, 'compress@10': 0.1688, 'time@10': 8.5976}:  90%|█████████ | 9/10 [00:52<00:06,  6.51s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0252, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9196, 'compress@10': 0.1563, 'time@10': 8.5981}:  90%|█████████ | 9/10 [01:01<00:06,  6.51s/it]  {'epoch': 22, 'num_users': 6.3, 'loss': 0.0252, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9196, 'compress@10': 0.1563, 'time@10': 8.5981}: 100%|██████████| 10/10 [01:01<00:00,  7.17s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0252, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9196, 'compress@10': 0.1563, 'time@10': 8.5981}: 100%|██████████| 10/10 [01:01<00:00,  6.12s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.02522054177780871
Avg hit ratio: 0.8818497024575123
Avg ndcg: 0.9196406906957266
Avg compression ratio: 0.15629844272620202
Avg train time: 8.59813826084137
Std train time: 2.9891127273530818
[0.020833333333333336, 0.020833333333333336, 0.0625, 0.020833333333333336, 0.6875, 0.020833333333333336, 0.10416666666666667, 0.020833333333333336, 0.1875, 0.020833333333333336]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0249, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9, 'compress@10': 0.0724, 'time@10': 7.4212}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0249, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9, 'compress@10': 0.0724, 'time@10': 7.4212}:  10%|█         | 1/10 [00:03<00:33,  3.75s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9402, 'compress@10': 0.0624, 'time@10': 6.8155}:  10%|█         | 1/10 [00:09<00:33,  3.75s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9402, 'compress@10': 0.0624, 'time@10': 6.8155}:  20%|██        | 2/10 [00:09<00:41,  5.22s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9125, 'compress@10': 0.1071, 'time@10': 6.3877}:  20%|██        | 2/10 [00:12<00:41,  5.22s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9125, 'compress@10': 0.1071, 'time@10': 6.3877}:  30%|███       | 3/10 [00:12<00:28,  4.12s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9143, 'compress@10': 0.0943, 'time@10': 6.1898}:  30%|███       | 3/10 [00:18<00:28,  4.12s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9143, 'compress@10': 0.0943, 'time@10': 6.1898}:  40%|████      | 4/10 [00:18<00:28,  4.72s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0193, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.9079, 'compress@10': 0.2142, 'time@10': 7.698}:  40%|████      | 4/10 [00:25<00:28,  4.72s/it] {'epoch': 23, 'num_users': 5.8, 'loss': 0.0193, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.9079, 'compress@10': 0.2142, 'time@10': 7.698}:  50%|█████     | 5/10 [00:25<00:27,  5.51s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9138, 'compress@10': 0.1856, 'time@10': 7.9338}:  50%|█████     | 5/10 [00:34<00:27,  5.51s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9138, 'compress@10': 0.1856, 'time@10': 7.9338}:  60%|██████    | 6/10 [00:34<00:26,  6.74s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.021, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9147, 'compress@10': 0.1791, 'time@10': 8.353}:  60%|██████    | 6/10 [00:39<00:26,  6.74s/it]  {'epoch': 23, 'num_users': 6.2857, 'loss': 0.021, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9147, 'compress@10': 0.1791, 'time@10': 8.353}:  70%|███████   | 7/10 [00:39<00:18,  6.33s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9196, 'compress@10': 0.1628, 'time@10': 8.1234}:  70%|███████   | 7/10 [00:46<00:18,  6.33s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9196, 'compress@10': 0.1628, 'time@10': 8.1234}:  80%|████████  | 8/10 [00:46<00:12,  6.40s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9348, 'compress@10': 0.1681, 'time@10': 8.7196}:  80%|████████  | 8/10 [00:53<00:12,  6.40s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9348, 'compress@10': 0.1681, 'time@10': 8.7196}:  90%|█████████ | 9/10 [00:53<00:06,  6.52s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0252, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9332, 'compress@10': 0.1556, 'time@10': 8.7112}:  90%|█████████ | 9/10 [01:01<00:06,  6.52s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0252, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9332, 'compress@10': 0.1556, 'time@10': 8.7112}: 100%|██████████| 10/10 [01:01<00:00,  7.18s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0252, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9332, 'compress@10': 0.1556, 'time@10': 8.7112}: 100%|██████████| 10/10 [01:01<00:00,  6.20s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.025243930785051955
Avg hit ratio: 0.8728302452122486
Avg ndcg: 0.9331929298672748
Avg compression ratio: 0.1556050199074968
Avg train time: 8.711193442344666
Std train time: 2.9222274946424585
[0.020000000000000004, 0.020000000000000004, 0.06, 0.020000000000000004, 0.66, 0.020000000000000004, 0.1, 0.020000000000000004, 0.22, 0.020000000000000004]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9, 'compress@10': 0.0716, 'time@10': 7.5494}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9, 'compress@10': 0.0716, 'time@10': 7.5494}:  10%|█         | 1/10 [00:03<00:34,  3.81s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9315, 'compress@10': 0.0616, 'time@10': 6.7722}:  10%|█         | 1/10 [00:09<00:34,  3.81s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9315, 'compress@10': 0.0616, 'time@10': 6.7722}:  20%|██        | 2/10 [00:09<00:40,  5.12s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9067, 'compress@10': 0.1058, 'time@10': 6.4136}:  20%|██        | 2/10 [00:12<00:40,  5.12s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9067, 'compress@10': 0.1058, 'time@10': 6.4136}:  30%|███       | 3/10 [00:12<00:28,  4.10s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9133, 'compress@10': 0.0931, 'time@10': 6.1422}:  30%|███       | 3/10 [00:18<00:28,  4.10s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9133, 'compress@10': 0.0931, 'time@10': 6.1422}:  40%|████      | 4/10 [00:18<00:27,  4.60s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.9087, 'compress@10': 0.2079, 'time@10': 7.5875}:  40%|████      | 4/10 [00:24<00:27,  4.60s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.9087, 'compress@10': 0.2079, 'time@10': 7.5875}:  50%|█████     | 5/10 [00:24<00:26,  5.37s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.9167, 'compress@10': 0.1802, 'time@10': 7.7923}:  50%|█████     | 5/10 [00:33<00:26,  5.37s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.9167, 'compress@10': 0.1802, 'time@10': 7.7923}:  60%|██████    | 6/10 [00:33<00:26,  6.56s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9174, 'compress@10': 0.1739, 'time@10': 8.2718}:  60%|██████    | 6/10 [00:39<00:26,  6.56s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9174, 'compress@10': 0.1739, 'time@10': 8.2718}:  70%|███████   | 7/10 [00:39<00:18,  6.25s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9194, 'compress@10': 0.1581, 'time@10': 8.0899}:  70%|███████   | 7/10 [00:46<00:18,  6.25s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9194, 'compress@10': 0.1581, 'time@10': 8.0899}:  80%|████████  | 8/10 [00:46<00:12,  6.44s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9212, 'compress@10': 0.1675, 'time@10': 8.6896}:  80%|████████  | 8/10 [00:52<00:12,  6.44s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9212, 'compress@10': 0.1675, 'time@10': 8.6896}:  90%|█████████ | 9/10 [00:52<00:06,  6.55s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9258, 'compress@10': 0.155, 'time@10': 8.6598}:  90%|█████████ | 9/10 [01:01<00:06,  6.55s/it]    {'epoch': 24, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9258, 'compress@10': 0.155, 'time@10': 8.6598}: 100%|██████████| 10/10 [01:01<00:00,  7.13s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9258, 'compress@10': 0.155, 'time@10': 8.6598}: 100%|██████████| 10/10 [01:01<00:00,  6.14s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.01646615220298184
Avg hit ratio: 0.8749096102916137
Avg ndcg: 0.9257749198111023
Avg compression ratio: 0.15496927061055749
Avg train time: 8.65980634689331
Std train time: 2.8874883729694423
[0.019230769230769235, 0.019230769230769235, 0.05769230769230769, 0.019230769230769235, 0.6346153846153847, 0.019230769230769235, 0.09615384615384616, 0.019230769230769235, 0.25, 0.019230769230769235]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9022, 'compress@10': 0.0709, 'time@10': 7.0724}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9022, 'compress@10': 0.0709, 'time@10': 7.0724}:  10%|█         | 1/10 [00:03<00:32,  3.57s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9334, 'compress@10': 0.0609, 'time@10': 6.4456}:  10%|█         | 1/10 [00:09<00:32,  3.57s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9334, 'compress@10': 0.0609, 'time@10': 6.4456}:  20%|██        | 2/10 [00:09<00:39,  4.92s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.908, 'compress@10': 0.1047, 'time@10': 6.1201}:  20%|██        | 2/10 [00:12<00:39,  4.92s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.908, 'compress@10': 0.1047, 'time@10': 6.1201}:  30%|███       | 3/10 [00:12<00:27,  3.94s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9093, 'compress@10': 0.0921, 'time@10': 5.8931}:  30%|███       | 3/10 [00:17<00:27,  3.94s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9093, 'compress@10': 0.0921, 'time@10': 5.8931}:  40%|████      | 4/10 [00:17<00:26,  4.46s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9066, 'compress@10': 0.202, 'time@10': 7.4519}:  40%|████      | 4/10 [00:24<00:26,  4.46s/it] {'epoch': 25, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9066, 'compress@10': 0.202, 'time@10': 7.4519}:  50%|█████     | 5/10 [00:24<00:26,  5.33s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9225, 'compress@10': 0.1752, 'time@10': 7.7012}:  50%|█████     | 5/10 [00:33<00:26,  5.33s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9225, 'compress@10': 0.1752, 'time@10': 7.7012}:  60%|██████    | 6/10 [00:33<00:26,  6.57s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9264, 'compress@10': 0.1691, 'time@10': 8.1352}:  60%|██████    | 6/10 [00:38<00:26,  6.57s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9264, 'compress@10': 0.1691, 'time@10': 8.1352}:  70%|███████   | 7/10 [00:38<00:18,  6.19s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0181, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.9276, 'compress@10': 0.1539, 'time@10': 7.95}:  70%|███████   | 7/10 [00:45<00:18,  6.19s/it]   {'epoch': 25, 'num_users': 6.125, 'loss': 0.0181, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.9276, 'compress@10': 0.1539, 'time@10': 7.95}:  80%|████████  | 8/10 [00:45<00:12,  6.35s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.946, 'compress@10': 0.1669, 'time@10': 8.5962}:  80%|████████  | 8/10 [00:52<00:12,  6.35s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.946, 'compress@10': 0.1669, 'time@10': 8.5962}:  90%|█████████ | 9/10 [00:52<00:06,  6.53s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9488, 'compress@10': 0.1544, 'time@10': 8.6267}:  90%|█████████ | 9/10 [01:01<00:06,  6.53s/it]  {'epoch': 25, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9488, 'compress@10': 0.1544, 'time@10': 8.6267}: 100%|██████████| 10/10 [01:01<00:00,  7.27s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9488, 'compress@10': 0.1544, 'time@10': 8.6267}: 100%|██████████| 10/10 [01:01<00:00,  6.13s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.019186305189315706
Avg hit ratio: 0.8886238960058994
Avg ndcg: 0.9487920430153525
Avg compression ratio: 0.1543814197553473
Avg train time: 8.62674059867859
Std train time: 3.041084620863367
[0.018518518518518524, 0.018518518518518524, 0.05555555555555555, 0.018518518518518524, 0.6111111111111112, 0.018518518518518524, 0.0925925925925926, 0.018518518518518524, 0.2777777777777778, 0.018518518518518524]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9008, 'compress@10': 0.0702, 'time@10': 7.4454}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9008, 'compress@10': 0.0702, 'time@10': 7.4454}:  10%|█         | 1/10 [00:03<00:33,  3.76s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9322, 'compress@10': 0.0602, 'time@10': 6.8423}:  10%|█         | 1/10 [00:10<00:33,  3.76s/it] {'epoch': 26, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9322, 'compress@10': 0.0602, 'time@10': 6.8423}:  20%|██        | 2/10 [00:10<00:41,  5.24s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9072, 'compress@10': 0.1036, 'time@10': 6.366}:  20%|██        | 2/10 [00:12<00:41,  5.24s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9072, 'compress@10': 0.1036, 'time@10': 6.366}:  30%|███       | 3/10 [00:12<00:28,  4.10s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.903, 'compress@10': 0.0911, 'time@10': 6.1101}:  30%|███       | 3/10 [00:18<00:28,  4.10s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.903, 'compress@10': 0.0911, 'time@10': 6.1101}:  40%|████      | 4/10 [00:18<00:27,  4.61s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0195, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9016, 'compress@10': 0.1967, 'time@10': 7.5918}:  40%|████      | 4/10 [00:24<00:27,  4.61s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0195, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9016, 'compress@10': 0.1967, 'time@10': 7.5918}:  50%|█████     | 5/10 [00:24<00:26,  5.40s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.9119, 'compress@10': 0.1706, 'time@10': 7.8156}:  50%|█████     | 5/10 [00:33<00:26,  5.40s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.9119, 'compress@10': 0.1706, 'time@10': 7.8156}:  60%|██████    | 6/10 [00:33<00:26,  6.61s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.019, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9182, 'compress@10': 0.1647, 'time@10': 8.2557}:  60%|██████    | 6/10 [00:39<00:26,  6.61s/it] {'epoch': 26, 'num_users': 6.2857, 'loss': 0.019, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9182, 'compress@10': 0.1647, 'time@10': 8.2557}:  70%|███████   | 7/10 [00:39<00:18,  6.24s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0186, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9223, 'compress@10': 0.1499, 'time@10': 8.0587}:  70%|███████   | 7/10 [00:46<00:18,  6.24s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0186, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9223, 'compress@10': 0.1499, 'time@10': 8.0587}:  80%|████████  | 8/10 [00:46<00:12,  6.39s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9248, 'compress@10': 0.1664, 'time@10': 8.6848}:  80%|████████  | 8/10 [00:53<00:12,  6.39s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9248, 'compress@10': 0.1664, 'time@10': 8.6848}:  90%|█████████ | 9/10 [00:53<00:06,  6.55s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9245, 'compress@10': 0.1538, 'time@10': 8.6795}:  90%|█████████ | 9/10 [01:01<00:06,  6.55s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9245, 'compress@10': 0.1538, 'time@10': 8.6795}: 100%|██████████| 10/10 [01:01<00:00,  7.20s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9245, 'compress@10': 0.1538, 'time@10': 8.6795}: 100%|██████████| 10/10 [01:01<00:00,  6.17s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.021736558076680117
Avg hit ratio: 0.8776049238443127
Avg ndcg: 0.9244541405224199
Avg compression ratio: 0.15383909001953538
Avg train time: 8.679497909545898
Std train time: 2.9467224791422866
[0.017857142857142863, 0.017857142857142863, 0.05357142857142857, 0.017857142857142863, 0.5892857142857143, 0.017857142857142863, 0.08928571428571429, 0.017857142857142863, 0.26785714285714285, 0.053571428571428575]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9008, 'compress@10': 0.0696, 'time@10': 7.2584}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9008, 'compress@10': 0.0696, 'time@10': 7.2584}:  10%|█         | 1/10 [00:03<00:33,  3.67s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9416, 'compress@10': 0.0596, 'time@10': 6.6059}:  10%|█         | 1/10 [00:09<00:33,  3.67s/it]  {'epoch': 27, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9416, 'compress@10': 0.0596, 'time@10': 6.6059}:  20%|██        | 2/10 [00:09<00:40,  5.03s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9135, 'compress@10': 0.1026, 'time@10': 6.0834}:  20%|██        | 2/10 [00:12<00:40,  5.03s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9135, 'compress@10': 0.1026, 'time@10': 6.0834}:  30%|███       | 3/10 [00:12<00:27,  3.90s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9162, 'compress@10': 0.0902, 'time@10': 5.9028}:  30%|███       | 3/10 [00:17<00:27,  3.90s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9162, 'compress@10': 0.0902, 'time@10': 5.9028}:  40%|████      | 4/10 [00:17<00:26,  4.49s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9122, 'compress@10': 0.1917, 'time@10': 7.4608}:  40%|████      | 4/10 [00:24<00:26,  4.49s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9122, 'compress@10': 0.1917, 'time@10': 7.4608}:  50%|█████     | 5/10 [00:24<00:26,  5.35s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0159, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9203, 'compress@10': 0.1663, 'time@10': 7.6788}:  50%|█████     | 5/10 [00:33<00:26,  5.35s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0159, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9203, 'compress@10': 0.1663, 'time@10': 7.6788}:  60%|██████    | 6/10 [00:33<00:26,  6.53s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9137, 'compress@10': 0.1605, 'time@10': 8.1264}:  60%|██████    | 6/10 [00:38<00:26,  6.53s/it] {'epoch': 27, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9137, 'compress@10': 0.1605, 'time@10': 8.1264}:  70%|███████   | 7/10 [00:38<00:18,  6.17s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0176, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9197, 'compress@10': 0.1462, 'time@10': 7.9337}:  70%|███████   | 7/10 [00:45<00:18,  6.17s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0176, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9197, 'compress@10': 0.1462, 'time@10': 7.9337}:  80%|████████  | 8/10 [00:45<00:12,  6.32s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9418, 'compress@10': 0.1621, 'time@10': 8.6158}:  80%|████████  | 8/10 [00:52<00:12,  6.32s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9418, 'compress@10': 0.1621, 'time@10': 8.6158}:  90%|█████████ | 9/10 [00:52<00:06,  6.56s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.945, 'compress@10': 0.1534, 'time@10': 8.6194}:  90%|█████████ | 9/10 [01:01<00:06,  6.56s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.945, 'compress@10': 0.1534, 'time@10': 8.6194}: 100%|██████████| 10/10 [01:01<00:00,  7.22s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.945, 'compress@10': 0.1534, 'time@10': 8.6194}: 100%|██████████| 10/10 [01:01<00:00,  6.12s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.018736604341675126
Avg hit ratio: 0.8903985746379635
Avg ndcg: 0.9450241357003437
Avg compression ratio: 0.1533563827371718
Avg train time: 8.619404578208924
Std train time: 3.112188582537829
[0.017241379310344834, 0.017241379310344834, 0.05172413793103448, 0.017241379310344834, 0.5689655172413793, 0.017241379310344834, 0.08620689655172414, 0.017241379310344834, 0.29310344827586204, 0.05172413793103449]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8982, 'compress@10': 0.069, 'time@10': 7.4542}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8982, 'compress@10': 0.069, 'time@10': 7.4542}:  10%|█         | 1/10 [00:03<00:33,  3.77s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.93, 'compress@10': 0.059, 'time@10': 6.8273}:  10%|█         | 1/10 [00:10<00:33,  3.77s/it]  {'epoch': 28, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.93, 'compress@10': 0.059, 'time@10': 6.8273}:  20%|██        | 2/10 [00:10<00:41,  5.22s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9057, 'compress@10': 0.1017, 'time@10': 6.2893}:  20%|██        | 2/10 [00:12<00:41,  5.22s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9057, 'compress@10': 0.1017, 'time@10': 6.2893}:  30%|███       | 3/10 [00:12<00:28,  4.04s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9114, 'compress@10': 0.0894, 'time@10': 6.0597}:  30%|███       | 3/10 [00:18<00:28,  4.04s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9114, 'compress@10': 0.0894, 'time@10': 6.0597}:  40%|████      | 4/10 [00:18<00:27,  4.58s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9103, 'compress@10': 0.187, 'time@10': 7.5663}:  40%|████      | 4/10 [00:24<00:27,  4.58s/it] {'epoch': 28, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9103, 'compress@10': 0.187, 'time@10': 7.5663}:  50%|█████     | 5/10 [00:24<00:26,  5.39s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.921, 'compress@10': 0.1624, 'time@10': 7.7785}:  50%|█████     | 5/10 [00:33<00:26,  5.39s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.921, 'compress@10': 0.1624, 'time@10': 7.7785}:  60%|██████    | 6/10 [00:33<00:26,  6.58s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9236, 'compress@10': 0.1567, 'time@10': 8.1989}:  60%|██████    | 6/10 [00:39<00:26,  6.58s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9236, 'compress@10': 0.1567, 'time@10': 8.1989}:  70%|███████   | 7/10 [00:39<00:18,  6.19s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9284, 'compress@10': 0.1428, 'time@10': 8.008}:  70%|███████   | 7/10 [00:45<00:18,  6.19s/it]  {'epoch': 28, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9284, 'compress@10': 0.1428, 'time@10': 8.008}:  80%|████████  | 8/10 [00:45<00:12,  6.36s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9268, 'compress@10': 0.1617, 'time@10': 8.6874}:  80%|████████  | 8/10 [00:52<00:12,  6.36s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9268, 'compress@10': 0.1617, 'time@10': 8.6874}:  90%|█████████ | 9/10 [00:52<00:06,  6.59s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9295, 'compress@10': 0.1529, 'time@10': 8.7081}:  90%|█████████ | 9/10 [01:01<00:06,  6.59s/it]  {'epoch': 28, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9295, 'compress@10': 0.1529, 'time@10': 8.7081}: 100%|██████████| 10/10 [01:01<00:00,  7.31s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9295, 'compress@10': 0.1529, 'time@10': 8.7081}: 100%|██████████| 10/10 [01:01<00:00,  6.19s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.01752720730635015
Avg hit ratio: 0.8843156253292077
Avg ndcg: 0.9295436634620824
Avg compression ratio: 0.15288527747004016
Avg train time: 8.708135318756103
Std train time: 3.0435742881043826
[0.016666666666666673, 0.016666666666666673, 0.05, 0.016666666666666673, 0.55, 0.016666666666666673, 0.08333333333333334, 0.016666666666666673, 0.31666666666666665, 0.05]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8804, 'compress@10': 0.0684, 'time@10': 7.3064}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8804, 'compress@10': 0.0684, 'time@10': 7.3064}:  10%|█         | 1/10 [00:03<00:33,  3.69s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9214, 'compress@10': 0.0584, 'time@10': 6.7115}:  10%|█         | 1/10 [00:09<00:33,  3.69s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9214, 'compress@10': 0.0584, 'time@10': 6.7115}:  20%|██        | 2/10 [00:09<00:41,  5.14s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9, 'compress@10': 0.1009, 'time@10': 6.1907}:  20%|██        | 2/10 [00:12<00:41,  5.14s/it]  {'epoch': 29, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9, 'compress@10': 0.1009, 'time@10': 6.1907}:  30%|███       | 3/10 [00:12<00:28,  4.05s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9064, 'compress@10': 0.0886, 'time@10': 5.977}:  30%|███       | 3/10 [00:17<00:28,  4.05s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9064, 'compress@10': 0.0886, 'time@10': 5.977}:  40%|████      | 4/10 [00:17<00:27,  4.57s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0161, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.908, 'compress@10': 0.1827, 'time@10': 7.5808}:  40%|████      | 4/10 [00:25<00:27,  4.57s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0161, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.908, 'compress@10': 0.1827, 'time@10': 7.5808}:  50%|█████     | 5/10 [00:25<00:27,  5.46s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9176, 'compress@10': 0.1586, 'time@10': 7.8001}:  50%|█████     | 5/10 [00:33<00:27,  5.46s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9176, 'compress@10': 0.1586, 'time@10': 7.8001}:  60%|██████    | 6/10 [00:33<00:26,  6.64s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9226, 'compress@10': 0.1531, 'time@10': 8.2355}:  60%|██████    | 6/10 [00:39<00:26,  6.64s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9226, 'compress@10': 0.1531, 'time@10': 8.2355}:  70%|███████   | 7/10 [00:39<00:18,  6.26s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.927, 'compress@10': 0.1396, 'time@10': 8.0214}:  70%|███████   | 7/10 [00:45<00:18,  6.26s/it]  {'epoch': 29, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.927, 'compress@10': 0.1396, 'time@10': 8.0214}:  80%|████████  | 8/10 [00:45<00:12,  6.36s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9467, 'compress@10': 0.1614, 'time@10': 8.6542}:  80%|████████  | 8/10 [00:52<00:12,  6.36s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9467, 'compress@10': 0.1614, 'time@10': 8.6542}:  90%|█████████ | 9/10 [00:52<00:06,  6.53s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.95, 'compress@10': 0.1524, 'time@10': 8.6529}:  90%|█████████ | 9/10 [01:01<00:06,  6.53s/it]     {'epoch': 29, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.95, 'compress@10': 0.1524, 'time@10': 8.6529}: 100%|██████████| 10/10 [01:01<00:00,  7.19s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.95, 'compress@10': 0.1524, 'time@10': 8.6529}: 100%|██████████| 10/10 [01:01<00:00,  6.16s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.016241709257399838
Avg hit ratio: 0.8846049238443128
Avg ndcg: 0.9499783900791323
Avg compression ratio: 0.1524479987469895
Avg train time: 8.652871417999268
Std train time: 3.0843686995311534
[0.016129032258064523, 0.016129032258064523, 0.048387096774193554, 0.016129032258064523, 0.5322580645161291, 0.016129032258064523, 0.08064516129032259, 0.016129032258064523, 0.3387096774193548, 0.048387096774193554]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8858, 'compress@10': 0.0679, 'time@10': 7.8969}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8858, 'compress@10': 0.0679, 'time@10': 7.8969}:  10%|█         | 1/10 [00:03<00:35,  3.99s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9364, 'compress@10': 0.0579, 'time@10': 6.9768}:  10%|█         | 1/10 [00:10<00:35,  3.99s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9364, 'compress@10': 0.0579, 'time@10': 6.9768}:  20%|██        | 2/10 [00:10<00:41,  5.23s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.91, 'compress@10': 0.1001, 'time@10': 6.3906}:  20%|██        | 2/10 [00:12<00:41,  5.23s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.91, 'compress@10': 0.1001, 'time@10': 6.3906}:  30%|███       | 3/10 [00:12<00:28,  4.05s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9144, 'compress@10': 0.0879, 'time@10': 6.1435}:  30%|███       | 3/10 [00:18<00:28,  4.05s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9144, 'compress@10': 0.0879, 'time@10': 6.1435}:  40%|████      | 4/10 [00:18<00:27,  4.60s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9159, 'compress@10': 0.1786, 'time@10': 7.6355}:  40%|████      | 4/10 [00:25<00:27,  4.60s/it] {'epoch': 30, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9159, 'compress@10': 0.1786, 'time@10': 7.6355}:  50%|█████     | 5/10 [00:25<00:27,  5.41s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9242, 'compress@10': 0.1552, 'time@10': 7.8264}:  50%|█████     | 5/10 [00:33<00:27,  5.41s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9242, 'compress@10': 0.1552, 'time@10': 7.8264}:  60%|██████    | 6/10 [00:33<00:26,  6.57s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0184, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9294, 'compress@10': 0.1498, 'time@10': 8.2507}:  60%|██████    | 6/10 [00:39<00:26,  6.57s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0184, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9294, 'compress@10': 0.1498, 'time@10': 8.2507}:  70%|███████   | 7/10 [00:39<00:18,  6.20s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0178, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9322, 'compress@10': 0.1366, 'time@10': 8.0698}:  70%|███████   | 7/10 [00:46<00:18,  6.20s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0178, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9322, 'compress@10': 0.1366, 'time@10': 8.0698}:  80%|████████  | 8/10 [00:46<00:12,  6.40s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9316, 'compress@10': 0.1612, 'time@10': 8.7093}:  80%|████████  | 8/10 [00:53<00:12,  6.40s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9316, 'compress@10': 0.1612, 'time@10': 8.7093}:  90%|█████████ | 9/10 [00:53<00:06,  6.57s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9332, 'compress@10': 0.152, 'time@10': 8.7094}:  90%|█████████ | 9/10 [01:01<00:06,  6.57s/it]    {'epoch': 30, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9332, 'compress@10': 0.152, 'time@10': 8.7094}: 100%|██████████| 10/10 [01:01<00:00,  7.25s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9332, 'compress@10': 0.152, 'time@10': 8.7094}: 100%|██████████| 10/10 [01:01<00:00,  6.18s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.019672013250028462
Avg hit ratio: 0.8875414317808206
Avg ndcg: 0.933150650226942
Avg compression ratio: 0.15203929602935295
Avg train time: 8.709444212913514
Std train time: 2.9825460979422886
[0.015625000000000007, 0.015625000000000007, 0.04687500000000001, 0.015625000000000007, 0.5156250000000001, 0.015625000000000007, 0.07812500000000001, 0.015625000000000007, 0.359375, 0.04687500000000001]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8961, 'compress@10': 0.0674, 'time@10': 7.3512}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8961, 'compress@10': 0.0674, 'time@10': 7.3512}:  10%|█         | 1/10 [00:03<00:33,  3.71s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9375, 'compress@10': 0.0574, 'time@10': 6.6669}:  10%|█         | 1/10 [00:09<00:33,  3.71s/it] {'epoch': 31, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9375, 'compress@10': 0.0574, 'time@10': 6.6669}:  20%|██        | 2/10 [00:09<00:40,  5.07s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9107, 'compress@10': 0.0993, 'time@10': 6.1923}:  20%|██        | 2/10 [00:12<00:40,  5.07s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9107, 'compress@10': 0.0993, 'time@10': 6.1923}:  30%|███       | 3/10 [00:12<00:27,  3.97s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9153, 'compress@10': 0.0872, 'time@10': 5.9901}:  30%|███       | 3/10 [00:17<00:27,  3.97s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9153, 'compress@10': 0.0872, 'time@10': 5.9901}:  40%|████      | 4/10 [00:17<00:27,  4.54s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0133, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9162, 'compress@10': 0.1748, 'time@10': 7.5462}:  40%|████      | 4/10 [00:24<00:27,  4.54s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0133, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9162, 'compress@10': 0.1748, 'time@10': 7.5462}:  50%|█████     | 5/10 [00:24<00:27,  5.40s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9276, 'compress@10': 0.1519, 'time@10': 7.7732}:  50%|█████     | 5/10 [00:33<00:27,  5.40s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9276, 'compress@10': 0.1519, 'time@10': 7.7732}:  60%|██████    | 6/10 [00:33<00:26,  6.61s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9275, 'compress@10': 0.1466, 'time@10': 8.1839}:  60%|██████    | 6/10 [00:39<00:26,  6.61s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9275, 'compress@10': 0.1466, 'time@10': 8.1839}:  70%|███████   | 7/10 [00:39<00:18,  6.20s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9323, 'compress@10': 0.1338, 'time@10': 8.007}:  70%|███████   | 7/10 [00:45<00:18,  6.20s/it]  {'epoch': 31, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9323, 'compress@10': 0.1338, 'time@10': 8.007}:  80%|████████  | 8/10 [00:45<00:12,  6.39s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.953, 'compress@10': 0.1609, 'time@10': 8.7307}:  80%|████████  | 8/10 [00:53<00:12,  6.39s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.953, 'compress@10': 0.1609, 'time@10': 8.7307}:  90%|█████████ | 9/10 [00:53<00:06,  6.67s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9553, 'compress@10': 0.1516, 'time@10': 8.7547}:  90%|█████████ | 9/10 [01:02<00:06,  6.67s/it]  {'epoch': 31, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9553, 'compress@10': 0.1516, 'time@10': 8.7547}: 100%|██████████| 10/10 [01:02<00:00,  7.40s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9553, 'compress@10': 0.1516, 'time@10': 8.7547}: 100%|██████████| 10/10 [01:02<00:00,  6.22s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.016808084156210646
Avg hit ratio: 0.8903985746379635
Avg ndcg: 0.9553217566208938
Avg compression ratio: 0.1516437006044752
Avg train time: 8.754706716537475
Std train time: 3.152105322087992
[0.015151515151515159, 0.015151515151515159, 0.04545454545454546, 0.015151515151515159, 0.5000000000000001, 0.015151515151515159, 0.07575757575757577, 0.015151515151515159, 0.3787878787878788, 0.04545454545454546]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8929, 'compress@10': 0.067, 'time@10': 7.2326}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8929, 'compress@10': 0.067, 'time@10': 7.2326}:  10%|█         | 1/10 [00:03<00:32,  3.65s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9274, 'compress@10': 0.057, 'time@10': 6.5846}:  10%|█         | 1/10 [00:09<00:32,  3.65s/it] {'epoch': 32, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9274, 'compress@10': 0.057, 'time@10': 6.5846}:  20%|██        | 2/10 [00:09<00:40,  5.02s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.904, 'compress@10': 0.0986, 'time@10': 6.1282}:  20%|██        | 2/10 [00:12<00:40,  5.02s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.904, 'compress@10': 0.0986, 'time@10': 6.1282}:  30%|███       | 3/10 [00:12<00:27,  3.94s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9105, 'compress@10': 0.0865, 'time@10': 5.9417}:  30%|███       | 3/10 [00:17<00:27,  3.94s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9105, 'compress@10': 0.0865, 'time@10': 5.9417}:  40%|████      | 4/10 [00:17<00:27,  4.52s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.913, 'compress@10': 0.1712, 'time@10': 7.5152}:  40%|████      | 4/10 [00:24<00:27,  4.52s/it] {'epoch': 32, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.913, 'compress@10': 0.1712, 'time@10': 7.5152}:  50%|█████     | 5/10 [00:24<00:26,  5.40s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9227, 'compress@10': 0.1489, 'time@10': 7.7416}:  50%|█████     | 5/10 [00:33<00:26,  5.40s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9227, 'compress@10': 0.1489, 'time@10': 7.7416}:  60%|██████    | 6/10 [00:33<00:26,  6.59s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9248, 'compress@10': 0.1437, 'time@10': 8.1317}:  60%|██████    | 6/10 [00:38<00:26,  6.59s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9248, 'compress@10': 0.1437, 'time@10': 8.1317}:  70%|███████   | 7/10 [00:38<00:18,  6.16s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9299, 'compress@10': 0.1311, 'time@10': 7.9713}:  70%|███████   | 7/10 [00:45<00:18,  6.16s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9299, 'compress@10': 0.1311, 'time@10': 7.9713}:  80%|████████  | 8/10 [00:45<00:12,  6.39s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9275, 'compress@10': 0.1606, 'time@10': 8.664}:  80%|████████  | 8/10 [00:52<00:12,  6.39s/it] {'epoch': 32, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9275, 'compress@10': 0.1606, 'time@10': 8.664}:  90%|█████████ | 9/10 [00:52<00:06,  6.63s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9307, 'compress@10': 0.1513, 'time@10': 8.699}:  90%|█████████ | 9/10 [01:01<00:06,  6.63s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9307, 'compress@10': 0.1513, 'time@10': 8.699}: 100%|██████████| 10/10 [01:01<00:00,  7.37s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9307, 'compress@10': 0.1513, 'time@10': 8.699}: 100%|██████████| 10/10 [01:01<00:00,  6.19s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.01467523888605537
Avg hit ratio: 0.8914021588673542
Avg ndcg: 0.9307159192430243
Avg compression ratio: 0.15128740503840404
Avg train time: 8.699031615257264
Std train time: 3.099340822104741
[0.014705882352941183, 0.014705882352941183, 0.04411764705882354, 0.014705882352941183, 0.48529411764705893, 0.014705882352941183, 0.0735294117647059, 0.014705882352941183, 0.3676470588235294, 0.0735294117647059]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9046, 'compress@10': 0.0666, 'time@10': 7.6776}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9046, 'compress@10': 0.0666, 'time@10': 7.6776}:  10%|█         | 1/10 [00:03<00:34,  3.88s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.938, 'compress@10': 0.0565, 'time@10': 6.9778}:  10%|█         | 1/10 [00:10<00:34,  3.88s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.938, 'compress@10': 0.0565, 'time@10': 6.9778}:  20%|██        | 2/10 [00:10<00:42,  5.32s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.911, 'compress@10': 0.0979, 'time@10': 6.4765}:  20%|██        | 2/10 [00:12<00:42,  5.32s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.911, 'compress@10': 0.0979, 'time@10': 6.4765}:  30%|███       | 3/10 [00:12<00:29,  4.16s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.918, 'compress@10': 0.0859, 'time@10': 6.2424}:  30%|███       | 3/10 [00:18<00:29,  4.16s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.918, 'compress@10': 0.0859, 'time@10': 6.2424}:  40%|████      | 4/10 [00:18<00:28,  4.72s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.014, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9191, 'compress@10': 0.1679, 'time@10': 7.8071}:  40%|████      | 4/10 [00:25<00:28,  4.72s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.014, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9191, 'compress@10': 0.1679, 'time@10': 7.8071}:  50%|█████     | 5/10 [00:25<00:27,  5.57s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9283, 'compress@10': 0.146, 'time@10': 8.033}:  50%|█████     | 5/10 [00:34<00:27,  5.57s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9283, 'compress@10': 0.146, 'time@10': 8.033}:  60%|██████    | 6/10 [00:34<00:27,  6.80s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.888, 'ndcg@10': 0.932, 'compress@10': 0.1409, 'time@10': 8.2938}:  60%|██████    | 6/10 [00:39<00:27,  6.80s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.888, 'ndcg@10': 0.932, 'compress@10': 0.1409, 'time@10': 8.2938}:  70%|███████   | 7/10 [00:39<00:18,  6.20s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9365, 'compress@10': 0.1287, 'time@10': 8.0726}:  70%|███████   | 7/10 [00:46<00:18,  6.20s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9365, 'compress@10': 0.1287, 'time@10': 8.0726}:  80%|████████  | 8/10 [00:46<00:12,  6.32s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9538, 'compress@10': 0.1572, 'time@10': 8.7606}:  80%|████████  | 8/10 [00:53<00:12,  6.32s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9538, 'compress@10': 0.1572, 'time@10': 8.7606}:  90%|█████████ | 9/10 [00:53<00:06,  6.58s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9564, 'compress@10': 0.151, 'time@10': 8.7941}:  90%|█████████ | 9/10 [01:02<00:06,  6.58s/it]    {'epoch': 33, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9564, 'compress@10': 0.151, 'time@10': 8.7941}: 100%|██████████| 10/10 [01:02<00:00,  7.37s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9564, 'compress@10': 0.151, 'time@10': 8.7941}: 100%|██████████| 10/10 [01:02<00:00,  6.27s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.01485871854438004
Avg hit ratio: 0.8964815239467192
Avg ndcg: 0.9564254849105984
Avg compression ratio: 0.15096445550138118
Avg train time: 8.794050765037536
Std train time: 3.0564374016449154
[0.014285714285714292, 0.014285714285714292, 0.042857142857142864, 0.014285714285714292, 0.47142857142857153, 0.014285714285714292, 0.07142857142857144, 0.014285714285714292, 0.3857142857142857, 0.07142857142857144]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9046, 'compress@10': 0.0662, 'time@10': 7.6979}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9046, 'compress@10': 0.0662, 'time@10': 7.6979}:  10%|█         | 1/10 [00:03<00:35,  3.89s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.893, 'ndcg@10': 0.953, 'compress@10': 0.0561, 'time@10': 7.0071}:  10%|█         | 1/10 [00:10<00:35,  3.89s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.893, 'ndcg@10': 0.953, 'compress@10': 0.0561, 'time@10': 7.0071}:  20%|██        | 2/10 [00:10<00:42,  5.37s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.921, 'compress@10': 0.0973, 'time@10': 6.4887}:  20%|██        | 2/10 [00:13<00:42,  5.37s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.921, 'compress@10': 0.0973, 'time@10': 6.4887}:  30%|███       | 3/10 [00:13<00:29,  4.18s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9264, 'compress@10': 0.0853, 'time@10': 6.2782}:  30%|███       | 3/10 [00:18<00:29,  4.18s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9264, 'compress@10': 0.0853, 'time@10': 6.2782}:  40%|████      | 4/10 [00:18<00:28,  4.77s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.014, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.9269, 'compress@10': 0.1647, 'time@10': 7.7781}:  40%|████      | 4/10 [00:25<00:28,  4.77s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 0.014, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.9269, 'compress@10': 0.1647, 'time@10': 7.7781}:  50%|█████     | 5/10 [00:25<00:27,  5.55s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.9323, 'compress@10': 0.1433, 'time@10': 8.0072}:  50%|█████     | 5/10 [00:34<00:27,  5.55s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.9323, 'compress@10': 0.1433, 'time@10': 8.0072}:  60%|██████    | 6/10 [00:34<00:27,  6.79s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.9373, 'compress@10': 0.1383, 'time@10': 8.3299}:  60%|██████    | 6/10 [00:40<00:27,  6.79s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.9373, 'compress@10': 0.1383, 'time@10': 8.3299}:  70%|███████   | 7/10 [00:40<00:18,  6.26s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9385, 'compress@10': 0.1263, 'time@10': 8.1347}:  70%|███████   | 7/10 [00:46<00:18,  6.26s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9385, 'compress@10': 0.1263, 'time@10': 8.1347}:  80%|████████  | 8/10 [00:46<00:12,  6.43s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9371, 'compress@10': 0.1571, 'time@10': 8.8361}:  80%|████████  | 8/10 [00:54<00:12,  6.43s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9371, 'compress@10': 0.1571, 'time@10': 8.8361}:  90%|█████████ | 9/10 [00:54<00:06,  6.69s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9388, 'compress@10': 0.1506, 'time@10': 8.8412}:  90%|█████████ | 9/10 [01:03<00:06,  6.69s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9388, 'compress@10': 0.1506, 'time@10': 8.8412}: 100%|██████████| 10/10 [01:03<00:00,  7.38s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9388, 'compress@10': 0.1506, 'time@10': 8.8412}: 100%|██████████| 10/10 [01:03<00:00,  6.30s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.018413339410693407
Avg hit ratio: 0.873890638130027
Avg ndcg: 0.9387888326431397
Avg compression ratio: 0.15064528087814855
Avg train time: 8.841211748123168
Std train time: 3.02639479025469
[0.013888888888888895, 0.013888888888888895, 0.04166666666666667, 0.013888888888888895, 0.4583333333333334, 0.013888888888888895, 0.06944444444444445, 0.013888888888888895, 0.40277777777777773, 0.06944444444444445]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8934, 'compress@10': 0.0658, 'time@10': 7.4439}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8934, 'compress@10': 0.0658, 'time@10': 7.4439}:  10%|█         | 1/10 [00:03<00:33,  3.76s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9305, 'compress@10': 0.0558, 'time@10': 6.7569}:  10%|█         | 1/10 [00:09<00:33,  3.76s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9305, 'compress@10': 0.0558, 'time@10': 6.7569}:  20%|██        | 2/10 [00:09<00:41,  5.14s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.7597, 'ndcg@10': 0.9061, 'compress@10': 0.0967, 'time@10': 6.2325}:  20%|██        | 2/10 [00:12<00:41,  5.14s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.7597, 'ndcg@10': 0.9061, 'compress@10': 0.0967, 'time@10': 6.2325}:  30%|███       | 3/10 [00:12<00:27,  3.99s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8019, 'ndcg@10': 0.9158, 'compress@10': 0.0848, 'time@10': 6.0561}:  30%|███       | 3/10 [00:18<00:27,  3.99s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8019, 'ndcg@10': 0.9158, 'compress@10': 0.0848, 'time@10': 6.0561}:  40%|████      | 4/10 [00:18<00:27,  4.61s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.012, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9194, 'compress@10': 0.1617, 'time@10': 7.6367}:  40%|████      | 4/10 [00:25<00:27,  4.61s/it] {'epoch': 35, 'num_users': 5.8, 'loss': 0.012, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9194, 'compress@10': 0.1617, 'time@10': 7.6367}:  50%|█████     | 5/10 [00:25<00:27,  5.48s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.9278, 'compress@10': 0.1407, 'time@10': 7.9072}:  50%|█████     | 5/10 [00:34<00:27,  5.48s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.9278, 'compress@10': 0.1407, 'time@10': 7.9072}:  60%|██████    | 6/10 [00:34<00:27,  6.78s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9312, 'compress@10': 0.1358, 'time@10': 8.2219}:  60%|██████    | 6/10 [00:39<00:27,  6.78s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9312, 'compress@10': 0.1358, 'time@10': 8.2219}:  70%|███████   | 7/10 [00:39<00:18,  6.23s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9328, 'compress@10': 0.1241, 'time@10': 8.0361}:  70%|███████   | 7/10 [00:46<00:18,  6.23s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9328, 'compress@10': 0.1241, 'time@10': 8.0361}:  80%|████████  | 8/10 [00:46<00:12,  6.40s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.949, 'compress@10': 0.157, 'time@10': 8.7082}:  80%|████████  | 8/10 [00:53<00:12,  6.40s/it] {'epoch': 35, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.949, 'compress@10': 0.157, 'time@10': 8.7082}:  90%|█████████ | 9/10 [00:53<00:06,  6.61s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9517, 'compress@10': 0.1503, 'time@10': 8.7216}:  90%|█████████ | 9/10 [01:02<00:06,  6.61s/it] {'epoch': 35, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9517, 'compress@10': 0.1503, 'time@10': 8.7216}: 100%|██████████| 10/10 [01:02<00:00,  7.31s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9517, 'compress@10': 0.1503, 'time@10': 8.7216}: 100%|██████████| 10/10 [01:02<00:00,  6.22s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.014699368660435207
Avg hit ratio: 0.8854216161126178
Avg ndcg: 0.95172894858334
Avg compression ratio: 0.15033972784184152
Avg train time: 8.721596288681031
Std train time: 3.062119770751766
[0.01351351351351352, 0.01351351351351352, 0.04054054054054054, 0.01351351351351352, 0.44594594594594605, 0.01351351351351352, 0.06756756756756757, 0.01351351351351352, 0.41891891891891886, 0.06756756756756757]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9117, 'compress@10': 0.0654, 'time@10': 7.4737}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9117, 'compress@10': 0.0654, 'time@10': 7.4737}:  10%|█         | 1/10 [00:03<00:33,  3.77s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9379, 'compress@10': 0.0554, 'time@10': 6.7899}:  10%|█         | 1/10 [00:09<00:33,  3.77s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9379, 'compress@10': 0.0554, 'time@10': 6.7899}:  20%|██        | 2/10 [00:09<00:41,  5.17s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.911, 'compress@10': 0.0961, 'time@10': 6.3022}:  20%|██        | 2/10 [00:12<00:41,  5.17s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.911, 'compress@10': 0.0961, 'time@10': 6.3022}:  30%|███       | 3/10 [00:12<00:28,  4.04s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.9154, 'compress@10': 0.0843, 'time@10': 6.0993}:  30%|███       | 3/10 [00:18<00:28,  4.04s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.9154, 'compress@10': 0.0843, 'time@10': 6.0993}:  40%|████      | 4/10 [00:18<00:27,  4.63s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.9198, 'compress@10': 0.1588, 'time@10': 7.7174}:  40%|████      | 4/10 [00:25<00:27,  4.63s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.9198, 'compress@10': 0.1588, 'time@10': 7.7174}:  50%|█████     | 5/10 [00:25<00:27,  5.53s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9373, 'compress@10': 0.1383, 'time@10': 7.9488}:  50%|█████     | 5/10 [00:34<00:27,  5.53s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9373, 'compress@10': 0.1383, 'time@10': 7.9488}:  60%|██████    | 6/10 [00:34<00:27,  6.76s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9366, 'compress@10': 0.1335, 'time@10': 8.29}:  60%|██████    | 6/10 [00:39<00:27,  6.76s/it]  {'epoch': 36, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9366, 'compress@10': 0.1335, 'time@10': 8.29}:  70%|███████   | 7/10 [00:39<00:18,  6.25s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9527, 'compress@10': 0.122, 'time@10': 8.1181}:  70%|███████   | 7/10 [00:46<00:18,  6.25s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9527, 'compress@10': 0.122, 'time@10': 8.1181}:  80%|████████  | 8/10 [00:46<00:12,  6.48s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.9518, 'compress@10': 0.1569, 'time@10': 8.8164}:  80%|████████  | 8/10 [00:53<00:12,  6.48s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.9518, 'compress@10': 0.1569, 'time@10': 8.8164}:  90%|█████████ | 9/10 [00:53<00:06,  6.72s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.874, 'ndcg@10': 0.953, 'compress@10': 0.1501, 'time@10': 8.8334}:  90%|█████████ | 9/10 [01:02<00:06,  6.72s/it]     {'epoch': 36, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.874, 'ndcg@10': 0.953, 'compress@10': 0.1501, 'time@10': 8.8334}: 100%|██████████| 10/10 [01:02<00:00,  7.43s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.874, 'ndcg@10': 0.953, 'compress@10': 0.1501, 'time@10': 8.8334}: 100%|██████████| 10/10 [01:02<00:00,  6.29s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.017729382183419694
Avg hit ratio: 0.873970003209392
Avg ndcg: 0.9530197093115398
Avg compression ratio: 0.15005123858089803
Avg train time: 8.83337390422821
Std train time: 3.138586099497611
[0.013157894736842111, 0.013157894736842111, 0.03947368421052632, 0.013157894736842111, 0.4342105263157896, 0.013157894736842111, 0.06578947368421054, 0.013157894736842111, 0.4078947368421052, 0.09210526315789475]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8987, 'compress@10': 0.0651, 'time@10': 7.5595}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8987, 'compress@10': 0.0651, 'time@10': 7.5595}:  10%|█         | 1/10 [00:03<00:34,  3.82s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9345, 'compress@10': 0.0551, 'time@10': 6.9595}:  10%|█         | 1/10 [00:10<00:34,  3.82s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9345, 'compress@10': 0.0551, 'time@10': 6.9595}:  20%|██        | 2/10 [00:10<00:42,  5.34s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9087, 'compress@10': 0.0956, 'time@10': 6.4374}:  20%|██        | 2/10 [00:12<00:42,  5.34s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9087, 'compress@10': 0.0956, 'time@10': 6.4374}:  30%|███       | 3/10 [00:12<00:29,  4.15s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9189, 'compress@10': 0.0838, 'time@10': 6.2287}:  30%|███       | 3/10 [00:18<00:29,  4.15s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9189, 'compress@10': 0.0838, 'time@10': 6.2287}:  40%|████      | 4/10 [00:18<00:28,  4.74s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9228, 'compress@10': 0.1561, 'time@10': 7.848}:  40%|████      | 4/10 [00:25<00:28,  4.74s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9228, 'compress@10': 0.1561, 'time@10': 7.848}:  50%|█████     | 5/10 [00:25<00:28,  5.68s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9313, 'compress@10': 0.136, 'time@10': 8.0391}:  50%|█████     | 5/10 [00:34<00:28,  5.68s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9313, 'compress@10': 0.136, 'time@10': 8.0391}:  60%|██████    | 6/10 [00:34<00:27,  6.82s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9348, 'compress@10': 0.1313, 'time@10': 8.3129}:  60%|██████    | 6/10 [00:39<00:27,  6.82s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9348, 'compress@10': 0.1313, 'time@10': 8.3129}:  70%|███████   | 7/10 [00:39<00:18,  6.23s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9348, 'compress@10': 0.12, 'time@10': 8.1498}:  70%|███████   | 7/10 [00:47<00:18,  6.23s/it]   {'epoch': 37, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9348, 'compress@10': 0.12, 'time@10': 8.1498}:  80%|████████  | 8/10 [00:47<00:12,  6.50s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9509, 'compress@10': 0.1539, 'time@10': 8.8304}:  80%|████████  | 8/10 [00:54<00:12,  6.50s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9509, 'compress@10': 0.1539, 'time@10': 8.8304}:  90%|█████████ | 9/10 [00:54<00:06,  6.71s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9536, 'compress@10': 0.1498, 'time@10': 8.8751}:  90%|█████████ | 9/10 [01:03<00:06,  6.71s/it]  {'epoch': 37, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9536, 'compress@10': 0.1498, 'time@10': 8.8751}: 100%|██████████| 10/10 [01:03<00:00,  7.51s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9536, 'compress@10': 0.1498, 'time@10': 8.8751}: 100%|██████████| 10/10 [01:03<00:00,  6.35s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.012054231067843599
Avg hit ratio: 0.8771164445816397
Avg ndcg: 0.9535506433242082
Avg compression ratio: 0.14979283001423205
Avg train time: 8.875107097625733
Std train time: 3.0755250384013464
[0.012820512820512827, 0.012820512820512827, 0.038461538461538464, 0.012820512820512827, 0.4230769230769232, 0.012820512820512827, 0.06410256410256411, 0.012820512820512827, 0.423076923076923, 0.08974358974358976]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9183, 'compress@10': 0.0648, 'time@10': 7.605}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9183, 'compress@10': 0.0648, 'time@10': 7.605}:  10%|█         | 1/10 [00:03<00:34,  3.85s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9465, 'compress@10': 0.0547, 'time@10': 6.8836}:  10%|█         | 1/10 [00:10<00:34,  3.85s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9465, 'compress@10': 0.0547, 'time@10': 6.8836}:  20%|██        | 2/10 [00:10<00:41,  5.23s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9167, 'compress@10': 0.0951, 'time@10': 6.3479}:  20%|██        | 2/10 [00:12<00:41,  5.23s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9167, 'compress@10': 0.0951, 'time@10': 6.3479}:  30%|███       | 3/10 [00:12<00:28,  4.06s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.924, 'compress@10': 0.0833, 'time@10': 6.123}:  30%|███       | 3/10 [00:18<00:28,  4.06s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.924, 'compress@10': 0.0833, 'time@10': 6.123}:  40%|████      | 4/10 [00:18<00:27,  4.62s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9275, 'compress@10': 0.1536, 'time@10': 7.5755}:  40%|████      | 4/10 [00:24<00:27,  4.62s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9275, 'compress@10': 0.1536, 'time@10': 7.5755}:  50%|█████     | 5/10 [00:24<00:26,  5.38s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.9351, 'compress@10': 0.1338, 'time@10': 7.8528}:  50%|█████     | 5/10 [00:34<00:26,  5.38s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.9351, 'compress@10': 0.1338, 'time@10': 7.8528}:  60%|██████    | 6/10 [00:34<00:26,  6.71s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9377, 'compress@10': 0.1292, 'time@10': 8.2123}:  60%|██████    | 6/10 [00:39<00:26,  6.71s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9377, 'compress@10': 0.1292, 'time@10': 8.2123}:  70%|███████   | 7/10 [00:39<00:18,  6.22s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0179, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9637, 'compress@10': 0.1182, 'time@10': 8.0417}:  70%|███████   | 7/10 [00:46<00:18,  6.22s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0179, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9637, 'compress@10': 0.1182, 'time@10': 8.0417}:  80%|████████  | 8/10 [00:46<00:12,  6.43s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9602, 'compress@10': 0.1539, 'time@10': 8.7353}:  80%|████████  | 8/10 [00:53<00:12,  6.43s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9602, 'compress@10': 0.1539, 'time@10': 8.7353}:  90%|█████████ | 9/10 [00:53<00:06,  6.67s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9611, 'compress@10': 0.1495, 'time@10': 8.7428}:  90%|█████████ | 9/10 [01:02<00:06,  6.67s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9611, 'compress@10': 0.1495, 'time@10': 8.7428}: 100%|██████████| 10/10 [01:02<00:00,  7.34s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9611, 'compress@10': 0.1495, 'time@10': 8.7428}: 100%|██████████| 10/10 [01:02<00:00,  6.24s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.020221340690134405
Avg hit ratio: 0.8707672382324334
Avg ndcg: 0.9611185135809613
Avg compression ratio: 0.14953775801272165
Avg train time: 8.7428484916687
Std train time: 2.992784690363999
[0.012500000000000006, 0.012500000000000006, 0.037500000000000006, 0.012500000000000006, 0.4125000000000001, 0.012500000000000006, 0.06250000000000001, 0.037500000000000006, 0.4124999999999999, 0.08750000000000001]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.916, 'compress@10': 0.0645, 'time@10': 7.5355}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.916, 'compress@10': 0.0645, 'time@10': 7.5355}:  10%|█         | 1/10 [00:03<00:34,  3.80s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9578, 'compress@10': 0.0544, 'time@10': 6.8631}:  10%|█         | 1/10 [00:10<00:34,  3.80s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9578, 'compress@10': 0.0544, 'time@10': 6.8631}:  20%|██        | 2/10 [00:10<00:41,  5.23s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9242, 'compress@10': 0.0946, 'time@10': 6.3156}:  20%|██        | 2/10 [00:12<00:41,  5.23s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9242, 'compress@10': 0.0946, 'time@10': 6.3156}:  30%|███       | 3/10 [00:12<00:28,  4.05s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9309, 'compress@10': 0.0829, 'time@10': 6.126}:  30%|███       | 3/10 [00:18<00:28,  4.05s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9309, 'compress@10': 0.0829, 'time@10': 6.126}:  40%|████      | 4/10 [00:18<00:27,  4.66s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9339, 'compress@10': 0.1512, 'time@10': 7.6702}:  40%|████      | 4/10 [00:25<00:27,  4.66s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9339, 'compress@10': 0.1512, 'time@10': 7.6702}:  50%|█████     | 5/10 [00:25<00:27,  5.49s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9403, 'compress@10': 0.1317, 'time@10': 7.9155}:  50%|█████     | 5/10 [00:34<00:27,  5.49s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9403, 'compress@10': 0.1317, 'time@10': 7.9155}:  60%|██████    | 6/10 [00:34<00:26,  6.74s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0169, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9423, 'compress@10': 0.1272, 'time@10': 8.2134}:  60%|██████    | 6/10 [00:39<00:26,  6.74s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0169, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9423, 'compress@10': 0.1272, 'time@10': 8.2134}:  70%|███████   | 7/10 [00:39<00:18,  6.18s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0179, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9556, 'compress@10': 0.1194, 'time@10': 8.0538}:  70%|███████   | 7/10 [00:46<00:18,  6.18s/it]  {'epoch': 39, 'num_users': 6.125, 'loss': 0.0179, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9556, 'compress@10': 0.1194, 'time@10': 8.0538}:  80%|████████  | 8/10 [00:46<00:12,  6.44s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9717, 'compress@10': 0.1538, 'time@10': 8.7468}:  80%|████████  | 8/10 [00:53<00:12,  6.44s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9717, 'compress@10': 0.1538, 'time@10': 8.7468}:  90%|█████████ | 9/10 [00:53<00:06,  6.67s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9723, 'compress@10': 0.1493, 'time@10': 8.7745}:  90%|█████████ | 9/10 [01:02<00:06,  6.67s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9723, 'compress@10': 0.1493, 'time@10': 8.7745}: 100%|██████████| 10/10 [01:02<00:00,  7.41s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9723, 'compress@10': 0.1493, 'time@10': 8.7745}: 100%|██████████| 10/10 [01:02<00:00,  6.27s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.017836595241656917
Avg hit ratio: 0.8806085080737033
Avg ndcg: 0.9722744245521687
Avg compression ratio: 0.14928827080949747
Avg train time: 8.774482536315919
Std train time: 3.040290558475719
[0.012195121951219518, 0.012195121951219518, 0.03658536585365854, 0.012195121951219518, 0.402439024390244, 0.012195121951219518, 0.060975609756097573, 0.03658536585365854, 0.42682926829268286, 0.08536585365853659]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9162, 'compress@10': 0.0642, 'time@10': 7.6721}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9162, 'compress@10': 0.0642, 'time@10': 7.6721}:  10%|█         | 1/10 [00:03<00:34,  3.87s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9401, 'compress@10': 0.0541, 'time@10': 7.0391}:  10%|█         | 1/10 [00:10<00:34,  3.87s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9401, 'compress@10': 0.0541, 'time@10': 7.0391}:  20%|██        | 2/10 [00:10<00:43,  5.38s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.9125, 'compress@10': 0.0942, 'time@10': 6.5134}:  20%|██        | 2/10 [00:13<00:43,  5.38s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.9125, 'compress@10': 0.0942, 'time@10': 6.5134}:  30%|███       | 3/10 [00:13<00:29,  4.19s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.827, 'ndcg@10': 0.9215, 'compress@10': 0.0825, 'time@10': 6.2951}:  30%|███       | 3/10 [00:18<00:29,  4.19s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.827, 'ndcg@10': 0.9215, 'compress@10': 0.0825, 'time@10': 6.2951}:  40%|████      | 4/10 [00:18<00:28,  4.78s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.9262, 'compress@10': 0.1489, 'time@10': 7.8099}:  40%|████      | 4/10 [00:25<00:28,  4.78s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.9262, 'compress@10': 0.1489, 'time@10': 7.8099}:  50%|█████     | 5/10 [00:25<00:27,  5.57s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9344, 'compress@10': 0.1298, 'time@10': 8.0447}:  50%|█████     | 5/10 [00:34<00:27,  5.57s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9344, 'compress@10': 0.1298, 'time@10': 8.0447}:  60%|██████    | 6/10 [00:34<00:27,  6.82s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9355, 'compress@10': 0.1253, 'time@10': 8.3459}:  60%|██████    | 6/10 [00:40<00:27,  6.82s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9355, 'compress@10': 0.1253, 'time@10': 8.3459}:  70%|███████   | 7/10 [00:40<00:18,  6.26s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9361, 'compress@10': 0.1176, 'time@10': 8.1697}:  70%|███████   | 7/10 [00:47<00:18,  6.26s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9361, 'compress@10': 0.1176, 'time@10': 8.1697}:  80%|████████  | 8/10 [00:47<00:12,  6.49s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9338, 'compress@10': 0.1538, 'time@10': 8.8802}:  80%|████████  | 8/10 [00:54<00:12,  6.49s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9338, 'compress@10': 0.1538, 'time@10': 8.8802}:  90%|█████████ | 9/10 [00:54<00:06,  6.75s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9339, 'compress@10': 0.1491, 'time@10': 8.92}:  90%|█████████ | 9/10 [01:03<00:06,  6.75s/it]      {'epoch': 40, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9339, 'compress@10': 0.1491, 'time@10': 8.92}: 100%|██████████| 10/10 [01:03<00:00,  7.54s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9339, 'compress@10': 0.1491, 'time@10': 8.92}: 100%|██████████| 10/10 [01:03<00:00,  6.37s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.01418508769816774
Avg hit ratio: 0.8840160861587008
Avg ndcg: 0.93387530490574
Avg compression ratio: 0.14905573527757615
Avg train time: 8.920019817352294
Std train time: 3.043219649636599
[0.011904761904761911, 0.011904761904761911, 0.03571428571428572, 0.011904761904761911, 0.39285714285714296, 0.011904761904761911, 0.059523809523809534, 0.03571428571428572, 0.41666666666666663, 0.10714285714285715]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9242, 'compress@10': 0.0639, 'time@10': 7.6651}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9242, 'compress@10': 0.0639, 'time@10': 7.6651}:  10%|█         | 1/10 [00:03<00:34,  3.87s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9599, 'compress@10': 0.0539, 'time@10': 7.0327}:  10%|█         | 1/10 [00:10<00:34,  3.87s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9599, 'compress@10': 0.0539, 'time@10': 7.0327}:  20%|██        | 2/10 [00:10<00:43,  5.38s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9257, 'compress@10': 0.0937, 'time@10': 6.4849}:  20%|██        | 2/10 [00:13<00:43,  5.38s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9257, 'compress@10': 0.0937, 'time@10': 6.4849}:  30%|███       | 3/10 [00:13<00:29,  4.17s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9329, 'compress@10': 0.0821, 'time@10': 6.2815}:  30%|███       | 3/10 [00:18<00:29,  4.17s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9329, 'compress@10': 0.0821, 'time@10': 6.2815}:  40%|████      | 4/10 [00:18<00:28,  4.78s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.9379, 'compress@10': 0.1467, 'time@10': 7.8665}:  40%|████      | 4/10 [00:25<00:28,  4.78s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.9379, 'compress@10': 0.1467, 'time@10': 7.8665}:  50%|█████     | 5/10 [00:25<00:28,  5.63s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9484, 'compress@10': 0.1279, 'time@10': 8.0839}:  50%|█████     | 5/10 [00:35<00:28,  5.63s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9484, 'compress@10': 0.1279, 'time@10': 8.0839}:  60%|██████    | 6/10 [00:35<00:27,  6.85s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9495, 'compress@10': 0.1235, 'time@10': 8.3831}:  60%|██████    | 6/10 [00:40<00:27,  6.85s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9495, 'compress@10': 0.1235, 'time@10': 8.3831}:  70%|███████   | 7/10 [00:40<00:18,  6.28s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9661, 'compress@10': 0.116, 'time@10': 8.2232}:  70%|███████   | 7/10 [00:47<00:18,  6.28s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9661, 'compress@10': 0.116, 'time@10': 8.2232}:  80%|████████  | 8/10 [00:47<00:13,  6.56s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9671, 'compress@10': 0.1512, 'time@10': 8.907}:  80%|████████  | 8/10 [00:54<00:13,  6.56s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9671, 'compress@10': 0.1512, 'time@10': 8.907}:  90%|█████████ | 9/10 [00:54<00:06,  6.77s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9681, 'compress@10': 0.1488, 'time@10': 8.9306}:  90%|█████████ | 9/10 [01:03<00:06,  6.77s/it]  {'epoch': 41, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9681, 'compress@10': 0.1488, 'time@10': 8.9306}: 100%|██████████| 10/10 [01:03<00:00,  7.51s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9681, 'compress@10': 0.1488, 'time@10': 8.9306}: 100%|██████████| 10/10 [01:03<00:00,  6.38s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.01415894741695001
Avg hit ratio: 0.890744196757779
Avg ndcg: 0.9681059825012657
Avg compression ratio: 0.14884905603811388
Avg train time: 8.930605101585389
Std train time: 3.060606209838907
[0.011627906976744193, 0.011627906976744193, 0.034883720930232565, 0.011627906976744193, 0.38372093023255827, 0.011627906976744193, 0.05813953488372094, 0.058139534883720936, 0.40697674418604646, 0.10465116279069768]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.0637, 'time@10': 7.4935}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.0637, 'time@10': 7.4935}:  10%|█         | 1/10 [00:03<00:34,  3.78s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9633, 'compress@10': 0.0536, 'time@10': 6.8543}:  10%|█         | 1/10 [00:10<00:34,  3.78s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9633, 'compress@10': 0.0536, 'time@10': 6.8543}:  20%|██        | 2/10 [00:10<00:41,  5.24s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9279, 'compress@10': 0.0933, 'time@10': 6.4261}:  20%|██        | 2/10 [00:12<00:41,  5.24s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9279, 'compress@10': 0.0933, 'time@10': 6.4261}:  30%|███       | 3/10 [00:12<00:28,  4.13s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9345, 'compress@10': 0.0817, 'time@10': 6.2078}:  30%|███       | 3/10 [00:18<00:28,  4.13s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9345, 'compress@10': 0.0817, 'time@10': 6.2078}:  40%|████      | 4/10 [00:18<00:28,  4.71s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9371, 'compress@10': 0.1446, 'time@10': 7.7487}:  40%|████      | 4/10 [00:25<00:28,  4.71s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9371, 'compress@10': 0.1446, 'time@10': 7.7487}:  50%|█████     | 5/10 [00:25<00:27,  5.53s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9433, 'compress@10': 0.1261, 'time@10': 7.9874}:  50%|█████     | 5/10 [00:34<00:27,  5.53s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9433, 'compress@10': 0.1261, 'time@10': 7.9874}:  60%|██████    | 6/10 [00:34<00:27,  6.78s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9448, 'compress@10': 0.1218, 'time@10': 8.3388}:  60%|██████    | 6/10 [00:39<00:27,  6.78s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9448, 'compress@10': 0.1218, 'time@10': 8.3388}:  70%|███████   | 7/10 [00:39<00:18,  6.29s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9643, 'compress@10': 0.1172, 'time@10': 8.194}:  70%|███████   | 7/10 [00:47<00:18,  6.29s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9643, 'compress@10': 0.1172, 'time@10': 8.194}:  80%|████████  | 8/10 [00:47<00:13,  6.58s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.986, 'compress@10': 0.1513, 'time@10': 8.8659}:  80%|████████  | 8/10 [00:54<00:13,  6.58s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.986, 'compress@10': 0.1513, 'time@10': 8.8659}:  90%|█████████ | 9/10 [00:54<00:06,  6.76s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0169, 'hit_ratio@10': 0.88, 'ndcg@10': 0.9824, 'compress@10': 0.1486, 'time@10': 8.8841}:  90%|█████████ | 9/10 [01:03<00:06,  6.76s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.0169, 'hit_ratio@10': 0.88, 'ndcg@10': 0.9824, 'compress@10': 0.1486, 'time@10': 8.8841}: 100%|██████████| 10/10 [01:03<00:00,  7.48s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0169, 'hit_ratio@10': 0.88, 'ndcg@10': 0.9824, 'compress@10': 0.1486, 'time@10': 8.8841}: 100%|██████████| 10/10 [01:03<00:00,  6.34s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.01689450767540223
Avg hit ratio: 0.8799735874387826
Avg ndcg: 0.9823719327897946
Avg compression ratio: 0.14863604466441876
Avg train time: 8.88410563468933
Std train time: 3.009555105135518
[0.011363636363636371, 0.011363636363636371, 0.034090909090909095, 0.011363636363636371, 0.3750000000000001, 0.011363636363636371, 0.05681818181818183, 0.05681818181818182, 0.4204545454545454, 0.10227272727272728]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9224, 'compress@10': 0.0634, 'time@10': 7.9116}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9224, 'compress@10': 0.0634, 'time@10': 7.9116}:  10%|█         | 1/10 [00:03<00:35,  3.99s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9418, 'compress@10': 0.0533, 'time@10': 7.0545}:  10%|█         | 1/10 [00:10<00:35,  3.99s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9418, 'compress@10': 0.0533, 'time@10': 7.0545}:  20%|██        | 2/10 [00:10<00:42,  5.31s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9136, 'compress@10': 0.0929, 'time@10': 6.5117}:  20%|██        | 2/10 [00:12<00:42,  5.31s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9136, 'compress@10': 0.0929, 'time@10': 6.5117}:  30%|███       | 3/10 [00:12<00:29,  4.15s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.924, 'compress@10': 0.0814, 'time@10': 6.2882}:  30%|███       | 3/10 [00:18<00:29,  4.15s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.924, 'compress@10': 0.0814, 'time@10': 6.2882}:  40%|████      | 4/10 [00:18<00:28,  4.74s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.931, 'compress@10': 0.1426, 'time@10': 7.9522}:  40%|████      | 4/10 [00:25<00:28,  4.74s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.931, 'compress@10': 0.1426, 'time@10': 7.9522}:  50%|█████     | 5/10 [00:25<00:28,  5.68s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9367, 'compress@10': 0.1244, 'time@10': 8.1677}:  50%|█████     | 5/10 [00:35<00:28,  5.68s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9367, 'compress@10': 0.1244, 'time@10': 8.1677}:  60%|██████    | 6/10 [00:35<00:27,  6.91s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9384, 'compress@10': 0.1201, 'time@10': 8.4072}:  60%|██████    | 6/10 [00:40<00:27,  6.91s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9384, 'compress@10': 0.1201, 'time@10': 8.4072}:  70%|███████   | 7/10 [00:40<00:18,  6.27s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9425, 'compress@10': 0.1156, 'time@10': 8.2356}:  70%|███████   | 7/10 [00:47<00:18,  6.27s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9425, 'compress@10': 0.1156, 'time@10': 8.2356}:  80%|████████  | 8/10 [00:47<00:13,  6.53s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0142, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9435, 'compress@10': 0.1513, 'time@10': 8.9385}:  80%|████████  | 8/10 [00:54<00:13,  6.53s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0142, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9435, 'compress@10': 0.1513, 'time@10': 8.9385}:  90%|█████████ | 9/10 [00:54<00:06,  6.78s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9469, 'compress@10': 0.1484, 'time@10': 8.9531}:  90%|█████████ | 9/10 [01:03<00:06,  6.78s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9469, 'compress@10': 0.1484, 'time@10': 8.9531}: 100%|██████████| 10/10 [01:03<00:00,  7.50s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9469, 'compress@10': 0.1484, 'time@10': 8.9531}: 100%|██████████| 10/10 [01:03<00:00,  6.38s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.012881669908758447
Avg hit ratio: 0.8943617082785165
Avg ndcg: 0.9469183187371906
Avg compression ratio: 0.14843324972689242
Avg train time: 8.95311644077301
Std train time: 3.1662772369215273
[0.011111111111111118, 0.011111111111111118, 0.03333333333333334, 0.011111111111111118, 0.36666666666666675, 0.011111111111111118, 0.055555555555555566, 0.05555555555555556, 0.4333333333333333, 0.1]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9363, 'compress@10': 0.0632, 'time@10': 7.5635}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9363, 'compress@10': 0.0632, 'time@10': 7.5635}:  10%|█         | 1/10 [00:03<00:34,  3.82s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9942, 'compress@10': 0.0531, 'time@10': 6.9129}:  10%|█         | 1/10 [00:10<00:34,  3.82s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9942, 'compress@10': 0.0531, 'time@10': 6.9129}:  20%|██        | 2/10 [00:10<00:42,  5.28s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9485, 'compress@10': 0.0925, 'time@10': 6.514}:  20%|██        | 2/10 [00:13<00:42,  5.28s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9485, 'compress@10': 0.0925, 'time@10': 6.514}:  30%|███       | 3/10 [00:13<00:29,  4.19s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9491, 'compress@10': 0.081, 'time@10': 6.301}:  30%|███       | 3/10 [00:18<00:29,  4.19s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9491, 'compress@10': 0.081, 'time@10': 6.301}:  40%|████      | 4/10 [00:18<00:28,  4.79s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0142, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9514, 'compress@10': 0.1407, 'time@10': 7.8244}:  40%|████      | 4/10 [00:25<00:28,  4.79s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0142, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9514, 'compress@10': 0.1407, 'time@10': 7.8244}:  50%|█████     | 5/10 [00:25<00:27,  5.58s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9599, 'compress@10': 0.1228, 'time@10': 8.0413}:  50%|█████     | 5/10 [00:34<00:27,  5.58s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9599, 'compress@10': 0.1228, 'time@10': 8.0413}:  60%|██████    | 6/10 [00:34<00:27,  6.80s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0148, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9589, 'compress@10': 0.1185, 'time@10': 8.3663}:  60%|██████    | 6/10 [00:40<00:27,  6.80s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0148, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9589, 'compress@10': 0.1185, 'time@10': 8.3663}:  70%|███████   | 7/10 [00:40<00:18,  6.28s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9598, 'compress@10': 0.114, 'time@10': 8.1968}:  70%|███████   | 7/10 [00:47<00:18,  6.28s/it]  {'epoch': 44, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9598, 'compress@10': 0.114, 'time@10': 8.1968}:  80%|████████  | 8/10 [00:47<00:13,  6.52s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9775, 'compress@10': 0.1513, 'time@10': 8.8869}:  80%|████████  | 8/10 [00:54<00:13,  6.52s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9775, 'compress@10': 0.1513, 'time@10': 8.8869}:  90%|█████████ | 9/10 [00:54<00:06,  6.75s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9751, 'compress@10': 0.1482, 'time@10': 8.9154}:  90%|█████████ | 9/10 [01:03<00:06,  6.75s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9751, 'compress@10': 0.1482, 'time@10': 8.9154}: 100%|██████████| 10/10 [01:03<00:00,  7.51s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9751, 'compress@10': 0.1482, 'time@10': 8.9154}: 100%|██████████| 10/10 [01:03<00:00,  6.36s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.01779686986809366
Avg hit ratio: 0.894338666803862
Avg ndcg: 0.9750995185520649
Avg compression ratio: 0.14823861834102275
Avg train time: 8.915353751182556
Std train time: 3.0095866347354536
[0.010869565217391311, 0.03260869565217392, 0.03260869565217392, 0.010869565217391311, 0.35869565217391314, 0.010869565217391311, 0.054347826086956534, 0.05434782608695653, 0.4239130434782608, 0.09782608695652174]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.935, 'compress@10': 0.0629, 'time@10': 7.6717}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.935, 'compress@10': 0.0629, 'time@10': 7.6717}:  10%|█         | 1/10 [00:03<00:34,  3.87s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9538, 'compress@10': 0.0634, 'time@10': 7.087}:  10%|█         | 1/10 [00:10<00:34,  3.87s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9538, 'compress@10': 0.0634, 'time@10': 7.087}:  20%|██        | 2/10 [00:10<00:43,  5.44s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9216, 'compress@10': 0.0992, 'time@10': 6.6874}:  20%|██        | 2/10 [00:13<00:43,  5.44s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9216, 'compress@10': 0.0992, 'time@10': 6.6874}:  30%|███       | 3/10 [00:13<00:30,  4.32s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9298, 'compress@10': 0.086, 'time@10': 6.4692}:  30%|███       | 3/10 [00:19<00:30,  4.32s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9298, 'compress@10': 0.086, 'time@10': 6.4692}:  40%|████      | 4/10 [00:19<00:29,  4.92s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9362, 'compress@10': 0.1431, 'time@10': 7.9862}:  40%|████      | 4/10 [00:26<00:29,  4.92s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9362, 'compress@10': 0.1431, 'time@10': 7.9862}:  50%|█████     | 5/10 [00:26<00:28,  5.70s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9429, 'compress@10': 0.1247, 'time@10': 8.1896}:  50%|█████     | 5/10 [00:35<00:28,  5.70s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9429, 'compress@10': 0.1247, 'time@10': 8.1896}:  60%|██████    | 6/10 [00:35<00:27,  6.90s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9452, 'compress@10': 0.1201, 'time@10': 8.4581}:  60%|██████    | 6/10 [00:40<00:27,  6.90s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9452, 'compress@10': 0.1201, 'time@10': 8.4581}:  70%|███████   | 7/10 [00:40<00:18,  6.30s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0074, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9476, 'compress@10': 0.1152, 'time@10': 8.2704}:  70%|███████   | 7/10 [00:47<00:18,  6.30s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0074, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9476, 'compress@10': 0.1152, 'time@10': 8.2704}:  80%|████████  | 8/10 [00:47<00:13,  6.52s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.009, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9474, 'compress@10': 0.1513, 'time@10': 8.9501}:  80%|████████  | 8/10 [00:54<00:13,  6.52s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.009, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9474, 'compress@10': 0.1513, 'time@10': 8.9501}:  90%|█████████ | 9/10 [00:54<00:06,  6.74s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0084, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9503, 'compress@10': 0.148, 'time@10': 8.9798}:  90%|█████████ | 9/10 [01:04<00:06,  6.74s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0084, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9503, 'compress@10': 0.148, 'time@10': 8.9798}: 100%|██████████| 10/10 [01:04<00:00,  7.53s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0084, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9503, 'compress@10': 0.148, 'time@10': 8.9798}: 100%|██████████| 10/10 [01:04<00:00,  6.41s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.008392917963760144
Avg hit ratio: 0.8881763524157412
Avg ndcg: 0.9503489192188199
Avg compression ratio: 0.14804693581447023
Avg train time: 8.979840564727784
Std train time: 2.963459800201908
[0.010638297872340432, 0.03191489361702128, 0.03191489361702128, 0.010638297872340432, 0.35106382978723416, 0.010638297872340432, 0.05319148936170214, 0.053191489361702135, 0.4361702127659574, 0.09574468085106383]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9183, 'compress@10': 0.0627, 'time@10': 7.8599}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9183, 'compress@10': 0.0627, 'time@10': 7.8599}:  10%|█         | 1/10 [00:04<00:36,  4.01s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.943, 'compress@10': 0.0629, 'time@10': 7.2001}:  10%|█         | 1/10 [00:10<00:36,  4.01s/it] {'epoch': 46, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.943, 'compress@10': 0.0629, 'time@10': 7.2001}:  20%|██        | 2/10 [00:10<00:44,  5.52s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9144, 'compress@10': 0.0987, 'time@10': 6.6828}:  20%|██        | 2/10 [00:13<00:44,  5.52s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9144, 'compress@10': 0.0987, 'time@10': 6.6828}:  30%|███       | 3/10 [00:13<00:30,  4.31s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.924, 'compress@10': 0.0855, 'time@10': 6.4178}:  30%|███       | 3/10 [00:19<00:30,  4.31s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.924, 'compress@10': 0.0855, 'time@10': 6.4178}:  40%|████      | 4/10 [00:19<00:29,  4.85s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9316, 'compress@10': 0.1412, 'time@10': 7.9574}:  40%|████      | 4/10 [00:26<00:29,  4.85s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9316, 'compress@10': 0.1412, 'time@10': 7.9574}:  50%|█████     | 5/10 [00:26<00:28,  5.66s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.938, 'compress@10': 0.1231, 'time@10': 8.182}:  50%|█████     | 5/10 [00:35<00:28,  5.66s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.938, 'compress@10': 0.1231, 'time@10': 8.182}:  60%|██████    | 6/10 [00:35<00:27,  6.91s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0123, 'hit_ratio@10': 0.9227, 'ndcg@10': 0.9407, 'compress@10': 0.1185, 'time@10': 8.4778}:  60%|██████    | 6/10 [00:40<00:27,  6.91s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0123, 'hit_ratio@10': 0.9227, 'ndcg@10': 0.9407, 'compress@10': 0.1185, 'time@10': 8.4778}:  70%|███████   | 7/10 [00:40<00:19,  6.34s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.9288, 'ndcg@10': 0.9463, 'compress@10': 0.1138, 'time@10': 8.3016}:  70%|███████   | 7/10 [00:47<00:19,  6.34s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.9288, 'ndcg@10': 0.9463, 'compress@10': 0.1138, 'time@10': 8.3016}:  80%|████████  | 8/10 [00:47<00:13,  6.58s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9642, 'compress@10': 0.1514, 'time@10': 8.9563}:  80%|████████  | 8/10 [00:54<00:13,  6.58s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9642, 'compress@10': 0.1514, 'time@10': 8.9563}:  90%|█████████ | 9/10 [00:54<00:06,  6.76s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9629, 'compress@10': 0.1479, 'time@10': 8.9934}:  90%|█████████ | 9/10 [01:04<00:06,  6.76s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9629, 'compress@10': 0.1479, 'time@10': 8.9934}: 100%|██████████| 10/10 [01:04<00:00,  7.57s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9629, 'compress@10': 0.1479, 'time@10': 8.9934}: 100%|██████████| 10/10 [01:04<00:00,  6.44s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.016349708673652735
Avg hit ratio: 0.9179331368499449
Avg ndcg: 0.9629485154208067
Avg compression ratio: 0.1478675362148401
Avg train time: 8.99341003894806
Std train time: 2.9771793016848807
[0.010416666666666673, 0.03125000000000001, 0.03125000000000001, 0.010416666666666673, 0.3437500000000001, 0.010416666666666673, 0.05208333333333335, 0.05208333333333334, 0.4270833333333333, 0.11458333333333333]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9363, 'compress@10': 0.0625, 'time@10': 7.6487}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9363, 'compress@10': 0.0625, 'time@10': 7.6487}:  10%|█         | 1/10 [00:03<00:34,  3.86s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9582, 'compress@10': 0.0625, 'time@10': 7.0128}:  10%|█         | 1/10 [00:10<00:34,  3.86s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9582, 'compress@10': 0.0625, 'time@10': 7.0128}:  20%|██        | 2/10 [00:10<00:42,  5.36s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9245, 'compress@10': 0.0982, 'time@10': 6.4943}:  20%|██        | 2/10 [00:13<00:42,  5.36s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9245, 'compress@10': 0.0982, 'time@10': 6.4943}:  30%|███       | 3/10 [00:13<00:29,  4.18s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.933, 'compress@10': 0.0851, 'time@10': 6.2428}:  30%|███       | 3/10 [00:18<00:29,  4.18s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.933, 'compress@10': 0.0851, 'time@10': 6.2428}:  40%|████      | 4/10 [00:18<00:28,  4.71s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9386, 'compress@10': 0.1395, 'time@10': 7.7931}:  40%|████      | 4/10 [00:25<00:28,  4.71s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9386, 'compress@10': 0.1395, 'time@10': 7.7931}:  50%|█████     | 5/10 [00:25<00:27,  5.55s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9484, 'compress@10': 0.1216, 'time@10': 8.0751}:  50%|█████     | 5/10 [00:35<00:27,  5.55s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9484, 'compress@10': 0.1216, 'time@10': 8.0751}:  60%|██████    | 6/10 [00:35<00:27,  6.90s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9539, 'compress@10': 0.1171, 'time@10': 8.3472}:  60%|██████    | 6/10 [00:40<00:27,  6.90s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9539, 'compress@10': 0.1171, 'time@10': 8.3472}:  70%|███████   | 7/10 [00:40<00:18,  6.29s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.017, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9769, 'compress@10': 0.1124, 'time@10': 8.1661}:  70%|███████   | 7/10 [00:47<00:18,  6.29s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.017, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9769, 'compress@10': 0.1124, 'time@10': 8.1661}:  80%|████████  | 8/10 [00:47<00:13,  6.53s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9732, 'compress@10': 0.1492, 'time@10': 8.8411}:  80%|████████  | 8/10 [00:54<00:13,  6.53s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9732, 'compress@10': 0.1492, 'time@10': 8.8411}:  90%|█████████ | 9/10 [00:54<00:06,  6.73s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9736, 'compress@10': 0.1477, 'time@10': 8.8946}:  90%|█████████ | 9/10 [01:03<00:06,  6.73s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9736, 'compress@10': 0.1477, 'time@10': 8.8946}: 100%|██████████| 10/10 [01:03<00:00,  7.56s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9736, 'compress@10': 0.1477, 'time@10': 8.8946}: 100%|██████████| 10/10 [01:03<00:00,  6.38s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.016059444364437032
Avg hit ratio: 0.8936243810895764
Avg ndcg: 0.9735899534442061
Avg compression ratio: 0.14770848454187238
Avg train time: 8.894568634033202
Std train time: 3.027422110670614
[0.010204081632653067, 0.03061224489795919, 0.03061224489795919, 0.010204081632653067, 0.3367346938775511, 0.010204081632653067, 0.05102040816326532, 0.07142857142857144, 0.4183673469387755, 0.11224489795918367]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.935, 'compress@10': 0.0623, 'time@10': 7.6759}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.935, 'compress@10': 0.0623, 'time@10': 7.6759}:  10%|█         | 1/10 [00:03<00:34,  3.88s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9489, 'compress@10': 0.0621, 'time@10': 7.0911}:  10%|█         | 1/10 [00:10<00:34,  3.88s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9489, 'compress@10': 0.0621, 'time@10': 7.0911}:  20%|██        | 2/10 [00:10<00:43,  5.45s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9183, 'compress@10': 0.0978, 'time@10': 6.5737}:  20%|██        | 2/10 [00:13<00:43,  5.45s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9183, 'compress@10': 0.0978, 'time@10': 6.5737}:  30%|███       | 3/10 [00:13<00:29,  4.24s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.9285, 'compress@10': 0.0847, 'time@10': 6.3303}:  30%|███       | 3/10 [00:18<00:29,  4.24s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.9285, 'compress@10': 0.0847, 'time@10': 6.3303}:  40%|████      | 4/10 [00:18<00:28,  4.79s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9351, 'compress@10': 0.1378, 'time@10': 7.8519}:  40%|████      | 4/10 [00:25<00:28,  4.79s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9351, 'compress@10': 0.1378, 'time@10': 7.8519}:  50%|█████     | 5/10 [00:25<00:27,  5.59s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9421, 'compress@10': 0.1202, 'time@10': 8.0336}:  50%|█████     | 5/10 [00:34<00:27,  5.59s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9421, 'compress@10': 0.1202, 'time@10': 8.0336}:  60%|██████    | 6/10 [00:34<00:26,  6.74s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9441, 'compress@10': 0.1157, 'time@10': 8.3389}:  60%|██████    | 6/10 [00:39<00:26,  6.74s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9441, 'compress@10': 0.1157, 'time@10': 8.3389}:  70%|███████   | 7/10 [00:39<00:18,  6.21s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9421, 'compress@10': 0.1135, 'time@10': 8.1911}:  70%|███████   | 7/10 [00:47<00:18,  6.21s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9421, 'compress@10': 0.1135, 'time@10': 8.1911}:  80%|████████  | 8/10 [00:47<00:13,  6.52s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9607, 'compress@10': 0.1492, 'time@10': 8.862}:  80%|████████  | 8/10 [00:54<00:13,  6.52s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9607, 'compress@10': 0.1492, 'time@10': 8.862}:  90%|█████████ | 9/10 [00:54<00:06,  6.72s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9577, 'compress@10': 0.1475, 'time@10': 8.9134}:  90%|█████████ | 9/10 [01:03<00:06,  6.72s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9577, 'compress@10': 0.1475, 'time@10': 8.9134}: 100%|██████████| 10/10 [01:03<00:00,  7.55s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9577, 'compress@10': 0.1475, 'time@10': 8.9134}: 100%|██████████| 10/10 [01:03<00:00,  6.37s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.013371419736980897
Avg hit ratio: 0.9042823431991514
Avg ndcg: 0.9577291780066439
Avg compression ratio: 0.14754577479969877
Avg train time: 8.91336419582367
Std train time: 2.967805890207874
[0.010000000000000005, 0.030000000000000006, 0.030000000000000006, 0.010000000000000005, 0.33000000000000007, 0.010000000000000005, 0.05000000000000002, 0.07, 0.43, 0.11]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9313, 'compress@10': 0.0621, 'time@10': 7.729}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9313, 'compress@10': 0.0621, 'time@10': 7.729}:  10%|█         | 1/10 [00:03<00:35,  3.90s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.893, 'ndcg@10': 1.0013, 'compress@10': 0.0617, 'time@10': 7.0266}:  10%|█         | 1/10 [00:10<00:35,  3.90s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.893, 'ndcg@10': 1.0013, 'compress@10': 0.0617, 'time@10': 7.0266}:  20%|██        | 2/10 [00:10<00:42,  5.35s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9533, 'compress@10': 0.0973, 'time@10': 6.536}:  20%|██        | 2/10 [00:13<00:42,  5.35s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9533, 'compress@10': 0.0973, 'time@10': 6.536}:  30%|███       | 3/10 [00:13<00:29,  4.19s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9552, 'compress@10': 0.0843, 'time@10': 6.3156}:  30%|███       | 3/10 [00:18<00:29,  4.19s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9552, 'compress@10': 0.0843, 'time@10': 6.3156}:  40%|████      | 4/10 [00:18<00:28,  4.78s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.957, 'compress@10': 0.1362, 'time@10': 7.893}:  40%|████      | 4/10 [00:25<00:28,  4.78s/it]  {'epoch': 49, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.957, 'compress@10': 0.1362, 'time@10': 7.893}:  50%|█████     | 5/10 [00:25<00:28,  5.63s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9607, 'compress@10': 0.1188, 'time@10': 8.0744}:  50%|█████     | 5/10 [00:34<00:28,  5.63s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9607, 'compress@10': 0.1188, 'time@10': 8.0744}:  60%|██████    | 6/10 [00:34<00:27,  6.79s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9603, 'compress@10': 0.1144, 'time@10': 8.3659}:  60%|██████    | 6/10 [00:40<00:27,  6.79s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9603, 'compress@10': 0.1144, 'time@10': 8.3659}:  70%|███████   | 7/10 [00:40<00:18,  6.23s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0135, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9511, 'compress@10': 0.1122, 'time@10': 8.2299}:  70%|███████   | 7/10 [00:47<00:18,  6.23s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0135, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9511, 'compress@10': 0.1122, 'time@10': 8.2299}:  80%|████████  | 8/10 [00:47<00:13,  6.58s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9504, 'compress@10': 0.1493, 'time@10': 8.9367}:  80%|████████  | 8/10 [00:54<00:13,  6.58s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9504, 'compress@10': 0.1493, 'time@10': 8.9367}:  90%|█████████ | 9/10 [00:54<00:06,  6.81s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9531, 'compress@10': 0.1474, 'time@10': 8.9772}:  90%|█████████ | 9/10 [01:04<00:06,  6.81s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9531, 'compress@10': 0.1474, 'time@10': 8.9772}: 100%|██████████| 10/10 [01:04<00:00,  7.61s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9531, 'compress@10': 0.1474, 'time@10': 8.9772}: 100%|██████████| 10/10 [01:04<00:00,  6.41s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.013156097796775217
Avg hit ratio: 0.8903985746379635
Avg ndcg: 0.953113503953673
Avg compression ratio: 0.1473896350892438
Avg train time: 8.97721586227417
Std train time: 3.073930623125379
[0.009803921568627456, 0.04901960784313726, 0.02941176470588236, 0.009803921568627456, 0.32352941176470595, 0.009803921568627456, 0.04901960784313727, 0.06862745098039216, 0.4215686274509804, 0.10784313725490197]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
