  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1289, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.5608, 'compress@10': 0.4735, 'time@10': 5.97}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1289, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.5608, 'compress@10': 0.4735, 'time@10': 5.97}:  10%|█         | 1/10 [00:03<00:27,  3.03s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0943, 'hit_ratio@10': 0.7292, 'ndcg@10': 0.7003, 'compress@10': 0.4954, 'time@10': 5.1101}:  10%|█         | 1/10 [00:07<00:27,  3.03s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0943, 'hit_ratio@10': 0.7292, 'ndcg@10': 0.7003, 'compress@10': 0.4954, 'time@10': 5.1101}:  20%|██        | 2/10 [00:07<00:30,  3.77s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6878, 'hit_ratio@10': 0.5814, 'ndcg@10': 0.4774, 'compress@10': 0.5176, 'time@10': 3.9577}:  20%|██        | 2/10 [00:08<00:30,  3.77s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6878, 'hit_ratio@10': 0.5814, 'ndcg@10': 0.4774, 'compress@10': 0.5176, 'time@10': 3.9577}:  30%|███       | 3/10 [00:08<00:17,  2.45s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5338, 'hit_ratio@10': 0.6503, 'ndcg@10': 0.5522, 'compress@10': 0.5044, 'time@10': 3.9059}:  30%|███       | 3/10 [00:11<00:17,  2.45s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5338, 'hit_ratio@10': 0.6503, 'ndcg@10': 0.5522, 'compress@10': 0.5044, 'time@10': 3.9059}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4454, 'hit_ratio@10': 0.6843, 'ndcg@10': 0.598, 'compress@10': 0.5041, 'time@10': 5.9026}:  40%|████      | 4/10 [00:18<00:17,  2.98s/it] {'epoch': 0, 'num_users': 5.8, 'loss': 0.4454, 'hit_ratio@10': 0.6843, 'ndcg@10': 0.598, 'compress@10': 0.5041, 'time@10': 5.9026}:  50%|█████     | 5/10 [00:18<00:22,  4.42s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.3851, 'hit_ratio@10': 0.6813, 'ndcg@10': 0.634, 'compress@10': 0.4955, 'time@10': 5.969}:  50%|█████     | 5/10 [00:25<00:22,  4.42s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.3851, 'hit_ratio@10': 0.6813, 'ndcg@10': 0.634, 'compress@10': 0.4955, 'time@10': 5.969}:  60%|██████    | 6/10 [00:25<00:20,  5.08s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3411, 'hit_ratio@10': 0.704, 'ndcg@10': 0.6348, 'compress@10': 0.4718, 'time@10': 6.0853}:  60%|██████    | 6/10 [00:28<00:20,  5.08s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3411, 'hit_ratio@10': 0.704, 'ndcg@10': 0.6348, 'compress@10': 0.4718, 'time@10': 6.0853}:  70%|███████   | 7/10 [00:28<00:13,  4.54s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3037, 'hit_ratio@10': 0.7303, 'ndcg@10': 0.6628, 'compress@10': 0.4855, 'time@10': 5.9209}:  70%|███████   | 7/10 [00:33<00:13,  4.54s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3037, 'hit_ratio@10': 0.7303, 'ndcg@10': 0.6628, 'compress@10': 0.4855, 'time@10': 5.9209}:  80%|████████  | 8/10 [00:33<00:09,  4.62s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2748, 'hit_ratio@10': 0.7285, 'ndcg@10': 0.6906, 'compress@10': 0.4881, 'time@10': 6.3281}:  80%|████████  | 8/10 [00:38<00:09,  4.62s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2748, 'hit_ratio@10': 0.7285, 'ndcg@10': 0.6906, 'compress@10': 0.4881, 'time@10': 6.3281}:  90%|█████████ | 9/10 [00:38<00:04,  4.69s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2523, 'hit_ratio@10': 0.7488, 'ndcg@10': 0.7062, 'compress@10': 0.4888, 'time@10': 6.2624}:  90%|█████████ | 9/10 [00:44<00:04,  4.69s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2523, 'hit_ratio@10': 0.7488, 'ndcg@10': 0.7062, 'compress@10': 0.4888, 'time@10': 6.2624}: 100%|██████████| 10/10 [00:44<00:00,  5.01s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2523, 'hit_ratio@10': 0.7488, 'ndcg@10': 0.7062, 'compress@10': 0.4888, 'time@10': 6.2624}: 100%|██████████| 10/10 [00:44<00:00,  4.41s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.2523457881811685
Avg hit ratio: 0.7488317494616307
Avg ndcg: 0.706165597566643
Avg compression ratio: 0.4887645664173224
Avg train time: 6.262423491477966
Std train time: 3.2210886311309874
[0.75, 0.75, 0.75, 0.75, 0.75, 0.75, 0.75, 0.25, 0.25, 0.25]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.846, 'compress@10': 0.9938, 'time@10': 5.0083}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.846, 'compress@10': 0.9938, 'time@10': 5.0083}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8488, 'compress@10': 0.9934, 'time@10': 4.5875}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8488, 'compress@10': 0.9934, 'time@10': 4.5875}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8404, 'compress@10': 0.9906, 'time@10': 3.6576}:  20%|██        | 2/10 [00:07<00:28,  3.52s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8404, 'compress@10': 0.9906, 'time@10': 3.6576}:  30%|███       | 3/10 [00:07<00:16,  2.34s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0403, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8417, 'compress@10': 0.9911, 'time@10': 3.6763}:  30%|███       | 3/10 [00:11<00:16,  2.34s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0403, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8417, 'compress@10': 0.9911, 'time@10': 3.6763}:  40%|████      | 4/10 [00:11<00:17,  2.91s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0495, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8302, 'compress@10': 0.9901, 'time@10': 5.4294}:  40%|████      | 4/10 [00:17<00:17,  2.91s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0495, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8302, 'compress@10': 0.9901, 'time@10': 5.4294}:  50%|█████     | 5/10 [00:17<00:20,  4.12s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0541, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8273, 'compress@10': 0.9901, 'time@10': 5.5651}:  50%|█████     | 5/10 [00:23<00:20,  4.12s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0541, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8273, 'compress@10': 0.9901, 'time@10': 5.5651}:  60%|██████    | 6/10 [00:23<00:19,  4.85s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0524, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8317, 'compress@10': 0.9906, 'time@10': 5.7172}:  60%|██████    | 6/10 [00:27<00:19,  4.85s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0524, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8317, 'compress@10': 0.9906, 'time@10': 5.7172}:  70%|███████   | 7/10 [00:27<00:13,  4.36s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8369, 'compress@10': 0.8715, 'time@10': 5.5929}:  70%|███████   | 7/10 [00:32<00:13,  4.36s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8369, 'compress@10': 0.8715, 'time@10': 5.5929}:  80%|████████  | 8/10 [00:32<00:08,  4.49s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0488, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8447, 'compress@10': 0.779, 'time@10': 5.9307}:  80%|████████  | 8/10 [00:36<00:08,  4.49s/it] {'epoch': 1, 'num_users': 6.3333, 'loss': 0.0488, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8447, 'compress@10': 0.779, 'time@10': 5.9307}:  90%|█████████ | 9/10 [00:36<00:04,  4.45s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0485, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8453, 'compress@10': 0.7044, 'time@10': 5.9027}:  90%|█████████ | 9/10 [00:42<00:04,  4.45s/it] {'epoch': 1, 'num_users': 6.3, 'loss': 0.0485, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8453, 'compress@10': 0.7044, 'time@10': 5.9027}: 100%|██████████| 10/10 [00:42<00:00,  4.83s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0485, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8453, 'compress@10': 0.7044, 'time@10': 5.9027}: 100%|██████████| 10/10 [00:42<00:00,  4.22s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.0485330472451108
Avg hit ratio: 0.8258183827114218
Avg ndcg: 0.8452827087019432
Avg compression ratio: 0.7043672010769824
Avg train time: 5.90266695022583
Std train time: 2.7872954932062814
[0.8333333333333334, 0.8333333333333334, 0.5, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.16666666666666669, 0.16666666666666669, 0.5]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.9985, 'time@10': 5.1385}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.9985, 'time@10': 5.1385}:  10%|█         | 1/10 [00:02<00:23,  2.61s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.849, 'compress@10': 0.9984, 'time@10': 4.7222}:  10%|█         | 1/10 [00:06<00:23,  2.61s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.849, 'compress@10': 0.9984, 'time@10': 4.7222}:  20%|██        | 2/10 [00:06<00:29,  3.63s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8517, 'compress@10': 0.8641, 'time@10': 3.834}:  20%|██        | 2/10 [00:08<00:29,  3.63s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8517, 'compress@10': 0.8641, 'time@10': 3.834}:  30%|███       | 3/10 [00:08<00:17,  2.46s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8506, 'compress@10': 0.8974, 'time@10': 3.8186}:  30%|███       | 3/10 [00:11<00:17,  2.46s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8506, 'compress@10': 0.8974, 'time@10': 3.8186}:  40%|████      | 4/10 [00:11<00:17,  2.99s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.7696, 'ndcg@10': 0.8372, 'compress@10': 0.9173, 'time@10': 5.2898}:  40%|████      | 4/10 [00:17<00:17,  2.99s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.7696, 'ndcg@10': 0.8372, 'compress@10': 0.9173, 'time@10': 5.2898}:  50%|█████     | 5/10 [00:17<00:19,  3.94s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0517, 'hit_ratio@10': 0.7673, 'ndcg@10': 0.8343, 'compress@10': 0.9307, 'time@10': 5.4589}:  50%|█████     | 5/10 [00:23<00:19,  3.94s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0517, 'hit_ratio@10': 0.7673, 'ndcg@10': 0.8343, 'compress@10': 0.9307, 'time@10': 5.4589}:  60%|██████    | 6/10 [00:23<00:19,  4.77s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0511, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.8336, 'compress@10': 0.9404, 'time@10': 5.6665}:  60%|██████    | 6/10 [00:27<00:19,  4.77s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0511, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.8336, 'compress@10': 0.9404, 'time@10': 5.6665}:  70%|███████   | 7/10 [00:27<00:13,  4.35s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0526, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8436, 'compress@10': 0.8268, 'time@10': 5.5539}:  70%|███████   | 7/10 [00:32<00:13,  4.35s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0526, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8436, 'compress@10': 0.8268, 'time@10': 5.5539}:  80%|████████  | 8/10 [00:32<00:08,  4.50s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0531, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8567, 'compress@10': 0.7383, 'time@10': 5.9088}:  80%|████████  | 8/10 [00:36<00:08,  4.50s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0531, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8567, 'compress@10': 0.7383, 'time@10': 5.9088}:  90%|█████████ | 9/10 [00:36<00:04,  4.47s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0527, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8549, 'compress@10': 0.7083, 'time@10': 5.8842}:  90%|█████████ | 9/10 [00:42<00:04,  4.47s/it]    {'epoch': 2, 'num_users': 6.3, 'loss': 0.0527, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8549, 'compress@10': 0.7083, 'time@10': 5.8842}: 100%|██████████| 10/10 [00:42<00:00,  4.85s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0527, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8549, 'compress@10': 0.7083, 'time@10': 5.8842}: 100%|██████████| 10/10 [00:42<00:00,  4.23s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.052694822791507966
Avg hit ratio: 0.8209612398542789
Avg ndcg: 0.8548743757401516
Avg compression ratio: 0.7083493036412414
Avg train time: 5.884208917617798
Std train time: 2.467208310725188
[0.625, 0.875, 0.375, 0.875, 0.875, 0.875, 0.625, 0.375, 0.375, 0.625]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8537, 'compress@10': 0.9229, 'time@10': 5.1208}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8537, 'compress@10': 0.9229, 'time@10': 5.1208}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8513, 'compress@10': 0.9611, 'time@10': 4.6797}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it] {'epoch': 3, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8513, 'compress@10': 0.9611, 'time@10': 4.6797}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8533, 'compress@10': 0.7079, 'time@10': 3.859}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8533, 'compress@10': 0.7079, 'time@10': 3.859}:  30%|███       | 3/10 [00:08<00:17,  2.48s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.7561, 'ndcg@10': 0.8466, 'compress@10': 0.7807, 'time@10': 3.8106}:  30%|███       | 3/10 [00:11<00:17,  2.48s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.7561, 'ndcg@10': 0.8466, 'compress@10': 0.7807, 'time@10': 3.8106}:  40%|████      | 4/10 [00:11<00:17,  2.96s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0465, 'hit_ratio@10': 0.7689, 'ndcg@10': 0.8364, 'compress@10': 0.8243, 'time@10': 5.0082}:  40%|████      | 4/10 [00:16<00:17,  2.96s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0465, 'hit_ratio@10': 0.7689, 'ndcg@10': 0.8364, 'compress@10': 0.8243, 'time@10': 5.0082}:  50%|█████     | 5/10 [00:16<00:18,  3.67s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0503, 'hit_ratio@10': 0.7704, 'ndcg@10': 0.8342, 'compress@10': 0.8534, 'time@10': 5.2176}:  50%|█████     | 5/10 [00:22<00:18,  3.67s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0503, 'hit_ratio@10': 0.7704, 'ndcg@10': 0.8342, 'compress@10': 0.8534, 'time@10': 5.2176}:  60%|██████    | 6/10 [00:22<00:18,  4.57s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.7975, 'ndcg@10': 0.8372, 'compress@10': 0.8637, 'time@10': 5.4489}:  60%|██████    | 6/10 [00:26<00:18,  4.57s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.7975, 'ndcg@10': 0.8372, 'compress@10': 0.8637, 'time@10': 5.4489}:  70%|███████   | 7/10 [00:26<00:12,  4.21s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0524, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.8433, 'compress@10': 0.7682, 'time@10': 5.3628}:  70%|███████   | 7/10 [00:31<00:12,  4.21s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0524, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.8433, 'compress@10': 0.7682, 'time@10': 5.3628}:  80%|████████  | 8/10 [00:31<00:08,  4.39s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0512, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.8505, 'compress@10': 0.695, 'time@10': 5.7335}:  80%|████████  | 8/10 [00:35<00:08,  4.39s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0512, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.8505, 'compress@10': 0.695, 'time@10': 5.7335}:  90%|█████████ | 9/10 [00:35<00:04,  4.39s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0512, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.8498, 'compress@10': 0.7168, 'time@10': 5.7114}:  90%|█████████ | 9/10 [00:41<00:04,  4.39s/it]  {'epoch': 3, 'num_users': 6.3, 'loss': 0.0512, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.8498, 'compress@10': 0.7168, 'time@10': 5.7114}: 100%|██████████| 10/10 [00:41<00:00,  4.75s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0512, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.8498, 'compress@10': 0.7168, 'time@10': 5.7114}: 100%|██████████| 10/10 [00:41<00:00,  4.12s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.0511512962816172
Avg hit ratio: 0.8171235542423998
Avg ndcg: 0.8498209577404943
Avg compression ratio: 0.716849331573341
Avg train time: 5.711398792266846
Std train time: 2.1692938522979954
[0.5, 0.9, 0.3, 0.9, 0.9, 0.9, 0.7, 0.5, 0.3, 0.7]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8627, 'compress@10': 0.3866, 'time@10': 5.0758}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8627, 'compress@10': 0.3866, 'time@10': 5.0758}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8585, 'compress@10': 0.693, 'time@10': 4.6807}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8585, 'compress@10': 0.693, 'time@10': 4.6807}:  20%|██        | 2/10 [00:06<00:28,  3.61s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.858, 'compress@10': 0.5146, 'time@10': 3.8993}:  20%|██        | 2/10 [00:08<00:28,  3.61s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.858, 'compress@10': 0.5146, 'time@10': 3.8993}:  30%|███       | 3/10 [00:08<00:17,  2.51s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0389, 'hit_ratio@10': 0.7642, 'ndcg@10': 0.8451, 'compress@10': 0.6358, 'time@10': 3.8599}:  30%|███       | 3/10 [00:11<00:17,  2.51s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0389, 'hit_ratio@10': 0.7642, 'ndcg@10': 0.8451, 'compress@10': 0.6358, 'time@10': 3.8599}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.048, 'hit_ratio@10': 0.7794, 'ndcg@10': 0.8324, 'compress@10': 0.7085, 'time@10': 4.7875}:  40%|████      | 4/10 [00:16<00:18,  3.01s/it] {'epoch': 4, 'num_users': 5.8, 'loss': 0.048, 'hit_ratio@10': 0.7794, 'ndcg@10': 0.8324, 'compress@10': 0.7085, 'time@10': 4.7875}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0509, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8311, 'compress@10': 0.757, 'time@10': 4.9057}:  50%|█████     | 5/10 [00:21<00:17,  3.47s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0509, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8311, 'compress@10': 0.757, 'time@10': 4.9057}:  60%|██████    | 6/10 [00:21<00:16,  4.17s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0495, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8392, 'compress@10': 0.7888, 'time@10': 4.9632}:  60%|██████    | 6/10 [00:24<00:16,  4.17s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0495, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8392, 'compress@10': 0.7888, 'time@10': 4.9632}:  70%|███████   | 7/10 [00:24<00:11,  3.69s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0509, 'hit_ratio@10': 0.8277, 'ndcg@10': 0.8446, 'compress@10': 0.7553, 'time@10': 4.8615}:  70%|███████   | 7/10 [00:28<00:11,  3.69s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0509, 'hit_ratio@10': 0.8277, 'ndcg@10': 0.8446, 'compress@10': 0.7553, 'time@10': 4.8615}:  80%|████████  | 8/10 [00:28<00:07,  3.85s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8536, 'compress@10': 0.677, 'time@10': 5.2394}:  80%|████████  | 8/10 [00:32<00:07,  3.85s/it]  {'epoch': 4, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8536, 'compress@10': 0.677, 'time@10': 5.2394}:  90%|█████████ | 9/10 [00:32<00:03,  3.95s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8536, 'compress@10': 0.7065, 'time@10': 5.2694}:  90%|█████████ | 9/10 [00:38<00:03,  3.95s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8536, 'compress@10': 0.7065, 'time@10': 5.2694}: 100%|██████████| 10/10 [00:38<00:00,  4.46s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8536, 'compress@10': 0.7065, 'time@10': 5.2694}: 100%|██████████| 10/10 [00:38<00:00,  3.84s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.048920360525170604
Avg hit ratio: 0.8325080908527427
Avg ndcg: 0.8535997433902566
Avg compression ratio: 0.7064531508598206
Avg train time: 5.269398164749146
Std train time: 1.808409531543691
[0.5833333333333334, 0.9166666666666667, 0.25, 0.9166666666666667, 0.9166666666666667, 0.9166666666666667, 0.5833333333333333, 0.5833333333333334, 0.41666666666666663, 0.5833333333333333]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8451, 'compress@10': 0.8201, 'time@10': 5.2964}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8451, 'compress@10': 0.8201, 'time@10': 5.2964}:  10%|█         | 1/10 [00:02<00:24,  2.69s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8471, 'compress@10': 0.9099, 'time@10': 4.8334}:  10%|█         | 1/10 [00:07<00:24,  2.69s/it]  {'epoch': 5, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8471, 'compress@10': 0.9099, 'time@10': 4.8334}:  20%|██        | 2/10 [00:07<00:29,  3.71s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8505, 'compress@10': 0.6562, 'time@10': 4.0736}:  20%|██        | 2/10 [00:08<00:29,  3.71s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8505, 'compress@10': 0.6562, 'time@10': 4.0736}:  30%|███       | 3/10 [00:08<00:18,  2.62s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0415, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8621, 'compress@10': 0.7421, 'time@10': 4.004}:  30%|███       | 3/10 [00:12<00:18,  2.62s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0415, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8621, 'compress@10': 0.7421, 'time@10': 4.004}:  40%|████      | 4/10 [00:12<00:18,  3.10s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0497, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.847, 'compress@10': 0.7936, 'time@10': 4.9047}:  40%|████      | 4/10 [00:16<00:18,  3.10s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0497, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.847, 'compress@10': 0.7936, 'time@10': 4.9047}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0513, 'hit_ratio@10': 0.8035, 'ndcg@10': 0.8443, 'compress@10': 0.8279, 'time@10': 5.1422}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0513, 'hit_ratio@10': 0.8035, 'ndcg@10': 0.8443, 'compress@10': 0.8279, 'time@10': 5.1422}:  60%|██████    | 6/10 [00:22<00:17,  4.50s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0502, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8481, 'compress@10': 0.8221, 'time@10': 5.4048}:  60%|██████    | 6/10 [00:26<00:17,  4.50s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0502, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8481, 'compress@10': 0.8221, 'time@10': 5.4048}:  70%|███████   | 7/10 [00:26<00:12,  4.19s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0501, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8451, 'compress@10': 0.8304, 'time@10': 5.3274}:  70%|███████   | 7/10 [00:31<00:12,  4.19s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0501, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8451, 'compress@10': 0.8304, 'time@10': 5.3274}:  80%|████████  | 8/10 [00:31<00:08,  4.39s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0513, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8656, 'compress@10': 0.7549, 'time@10': 5.6921}:  80%|████████  | 8/10 [00:35<00:08,  4.39s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0513, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8656, 'compress@10': 0.7549, 'time@10': 5.6921}:  90%|█████████ | 9/10 [00:35<00:04,  4.38s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0513, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8678, 'compress@10': 0.7636, 'time@10': 5.6611}:  90%|█████████ | 9/10 [00:41<00:04,  4.38s/it]  {'epoch': 5, 'num_users': 6.3, 'loss': 0.0513, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8678, 'compress@10': 0.7636, 'time@10': 5.6611}: 100%|██████████| 10/10 [00:41<00:00,  4.70s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0513, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8678, 'compress@10': 0.7636, 'time@10': 5.6611}: 100%|██████████| 10/10 [00:41<00:00,  4.11s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.05125320050477933
Avg hit ratio: 0.8455521256709713
Avg ndcg: 0.8678161130522299
Avg compression ratio: 0.7636409464230345
Avg train time: 5.661136555671692
Std train time: 1.864518382038201
[0.6428571428571429, 0.7857142857142858, 0.2142857142857143, 0.9285714285714286, 0.9285714285714286, 0.9285714285714286, 0.49999999999999994, 0.6428571428571429, 0.5, 0.6428571428571428]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8591, 'compress@10': 0.9315, 'time@10': 5.1291}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8591, 'compress@10': 0.9315, 'time@10': 5.1291}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0432, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8567, 'compress@10': 0.9641, 'time@10': 4.6829}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0432, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8567, 'compress@10': 0.9641, 'time@10': 4.6829}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0288, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8568, 'compress@10': 0.6914, 'time@10': 4.0145}:  20%|██        | 2/10 [00:08<00:28,  3.59s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0288, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8568, 'compress@10': 0.6914, 'time@10': 4.0145}:  30%|███       | 3/10 [00:08<00:18,  2.58s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0389, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8522, 'compress@10': 0.7685, 'time@10': 3.9603}:  30%|███       | 3/10 [00:12<00:18,  2.58s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0389, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8522, 'compress@10': 0.7685, 'time@10': 3.9603}:  40%|████      | 4/10 [00:12<00:18,  3.08s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8393, 'compress@10': 0.8147, 'time@10': 4.8469}:  40%|████      | 4/10 [00:16<00:18,  3.08s/it] {'epoch': 6, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8393, 'compress@10': 0.8147, 'time@10': 4.8469}:  50%|█████     | 5/10 [00:16<00:17,  3.50s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0482, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8386, 'compress@10': 0.8456, 'time@10': 5.0822}:  50%|█████     | 5/10 [00:22<00:17,  3.50s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0482, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8386, 'compress@10': 0.8456, 'time@10': 5.0822}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0472, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8434, 'compress@10': 0.7627, 'time@10': 5.3423}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0472, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8434, 'compress@10': 0.7627, 'time@10': 5.3423}:  70%|███████   | 7/10 [00:26<00:12,  4.14s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.046, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8428, 'compress@10': 0.7869, 'time@10': 5.2836}:  70%|███████   | 7/10 [00:31<00:12,  4.14s/it]  {'epoch': 6, 'num_users': 6.125, 'loss': 0.046, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8428, 'compress@10': 0.7869, 'time@10': 5.2836}:  80%|████████  | 8/10 [00:31<00:08,  4.38s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0511, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8688, 'compress@10': 0.7344, 'time@10': 5.6229}:  80%|████████  | 8/10 [00:35<00:08,  4.38s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0511, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8688, 'compress@10': 0.7344, 'time@10': 5.6229}:  90%|█████████ | 9/10 [00:35<00:04,  4.33s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0507, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8687, 'compress@10': 0.7569, 'time@10': 5.6175}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0507, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8687, 'compress@10': 0.7569, 'time@10': 5.6175}: 100%|██████████| 10/10 [00:40<00:00,  4.72s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0507, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8687, 'compress@10': 0.7569, 'time@10': 5.6175}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.050709417882656115
Avg hit ratio: 0.8570824054270574
Avg ndcg: 0.8686983260728953
Avg compression ratio: 0.7568809612297243
Avg train time: 5.617469358444214
Std train time: 1.784037426359912
[0.6875, 0.6875000000000001, 0.1875, 0.9375, 0.9375, 0.9375, 0.5625, 0.5625, 0.5625, 0.6875]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.052, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8288, 'compress@10': 0.9661, 'time@10': 5.1205}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.052, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8288, 'compress@10': 0.9661, 'time@10': 5.1205}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0494, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8332, 'compress@10': 0.9714, 'time@10': 4.7157}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0494, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8332, 'compress@10': 0.9714, 'time@10': 4.7157}:  20%|██        | 2/10 [00:06<00:29,  3.63s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8412, 'compress@10': 0.6959, 'time@10': 4.0972}:  20%|██        | 2/10 [00:08<00:29,  3.63s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8412, 'compress@10': 0.6959, 'time@10': 4.0972}:  30%|███       | 3/10 [00:08<00:18,  2.64s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0391, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.838, 'compress@10': 0.7718, 'time@10': 4.0301}:  30%|███       | 3/10 [00:12<00:18,  2.64s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0391, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.838, 'compress@10': 0.7718, 'time@10': 4.0301}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0465, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8283, 'compress@10': 0.8174, 'time@10': 4.9352}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0465, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8283, 'compress@10': 0.8174, 'time@10': 4.9352}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0468, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8302, 'compress@10': 0.8478, 'time@10': 5.1656}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0468, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8302, 'compress@10': 0.8478, 'time@10': 5.1656}:  60%|██████    | 6/10 [00:22<00:18,  4.51s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0462, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8384, 'compress@10': 0.8352, 'time@10': 5.3935}:  60%|██████    | 6/10 [00:26<00:18,  4.51s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0462, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8384, 'compress@10': 0.8352, 'time@10': 5.3935}:  70%|███████   | 7/10 [00:26<00:12,  4.15s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0446, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8442, 'compress@10': 0.835, 'time@10': 5.3184}:  70%|███████   | 7/10 [00:31<00:12,  4.15s/it]  {'epoch': 7, 'num_users': 6.125, 'loss': 0.0446, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8442, 'compress@10': 0.835, 'time@10': 5.3184}:  80%|████████  | 8/10 [00:31<00:08,  4.37s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0466, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8447, 'compress@10': 0.8353, 'time@10': 5.6907}:  80%|████████  | 8/10 [00:35<00:08,  4.37s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0466, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8447, 'compress@10': 0.8353, 'time@10': 5.6907}:  90%|█████████ | 9/10 [00:35<00:04,  4.37s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0445, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8488, 'compress@10': 0.8508, 'time@10': 5.7342}:  90%|█████████ | 9/10 [00:41<00:04,  4.37s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0445, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8488, 'compress@10': 0.8508, 'time@10': 5.7342}: 100%|██████████| 10/10 [00:41<00:00,  4.93s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0445, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8488, 'compress@10': 0.8508, 'time@10': 5.7342}: 100%|██████████| 10/10 [00:41<00:00,  4.18s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.044523510869055205
Avg hit ratio: 0.8584848362352606
Avg ndcg: 0.8487937172486705
Avg compression ratio: 0.8508449310295145
Avg train time: 5.734157872200012
Std train time: 1.8247309735929205
[0.7222222222222222, 0.7222222222222223, 0.16666666666666666, 0.9444444444444444, 0.9444444444444444, 0.9444444444444444, 0.6111111111111112, 0.5, 0.6111111111111112, 0.6111111111111112]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8454, 'compress@10': 0.982, 'time@10': 5.1496}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8454, 'compress@10': 0.982, 'time@10': 5.1496}:  10%|█         | 1/10 [00:02<00:23,  2.61s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8581, 'compress@10': 0.9862, 'time@10': 4.7194}:  10%|█         | 1/10 [00:06<00:23,  2.61s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8581, 'compress@10': 0.9862, 'time@10': 4.7194}:  20%|██        | 2/10 [00:06<00:28,  3.62s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.028, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8578, 'compress@10': 0.7054, 'time@10': 4.1378}:  20%|██        | 2/10 [00:08<00:28,  3.62s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.028, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8578, 'compress@10': 0.7054, 'time@10': 4.1378}:  30%|███       | 3/10 [00:08<00:18,  2.66s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0342, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8469, 'compress@10': 0.779, 'time@10': 4.0571}:  30%|███       | 3/10 [00:12<00:18,  2.66s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0342, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8469, 'compress@10': 0.779, 'time@10': 4.0571}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.042, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8375, 'compress@10': 0.8231, 'time@10': 4.93}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it]  {'epoch': 8, 'num_users': 5.8, 'loss': 0.042, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8375, 'compress@10': 0.8231, 'time@10': 4.93}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0426, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8405, 'compress@10': 0.8526, 'time@10': 5.1598}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0426, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8405, 'compress@10': 0.8526, 'time@10': 5.1598}:  60%|██████    | 6/10 [00:22<00:17,  4.49s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0426, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8456, 'compress@10': 0.8573, 'time@10': 5.3916}:  60%|██████    | 6/10 [00:26<00:17,  4.49s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0426, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8456, 'compress@10': 0.8573, 'time@10': 5.3916}:  70%|███████   | 7/10 [00:26<00:12,  4.15s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.042, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8497, 'compress@10': 0.7942, 'time@10': 5.3203}:  70%|███████   | 7/10 [00:31<00:12,  4.15s/it]  {'epoch': 8, 'num_users': 6.125, 'loss': 0.042, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8497, 'compress@10': 0.7942, 'time@10': 5.3203}:  80%|████████  | 8/10 [00:31<00:08,  4.37s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0405, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.858, 'compress@10': 0.8041, 'time@10': 5.6209}:  80%|████████  | 8/10 [00:35<00:08,  4.37s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0405, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.858, 'compress@10': 0.8041, 'time@10': 5.6209}:  90%|█████████ | 9/10 [00:35<00:04,  4.27s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0403, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.862, 'compress@10': 0.8204, 'time@10': 5.6371}:  90%|█████████ | 9/10 [00:41<00:04,  4.27s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0403, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.862, 'compress@10': 0.8204, 'time@10': 5.6371}: 100%|██████████| 10/10 [00:41<00:00,  4.75s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0403, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.862, 'compress@10': 0.8204, 'time@10': 5.6371}: 100%|██████████| 10/10 [00:41<00:00,  4.11s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04026399441313113
Avg hit ratio: 0.8677995771442291
Avg ndcg: 0.8620393423515056
Avg compression ratio: 0.8203970515779245
Avg train time: 5.637144684791565
Std train time: 1.6844731693138946
[0.75, 0.6500000000000001, 0.15, 0.95, 0.95, 0.95, 0.65, 0.55, 0.55, 0.65]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8371, 'compress@10': 0.9882, 'time@10': 4.5702}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8371, 'compress@10': 0.9882, 'time@10': 4.5702}:  10%|█         | 1/10 [00:02<00:20,  2.32s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0423, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8636, 'compress@10': 0.9708, 'time@10': 4.0207}:  10%|█         | 1/10 [00:05<00:20,  2.32s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0423, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8636, 'compress@10': 0.9708, 'time@10': 4.0207}:  20%|██        | 2/10 [00:05<00:24,  3.02s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0282, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8615, 'compress@10': 0.695, 'time@10': 3.5167}:  20%|██        | 2/10 [00:07<00:24,  3.02s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0282, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8615, 'compress@10': 0.695, 'time@10': 3.5167}:  30%|███       | 3/10 [00:07<00:15,  2.23s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8536, 'compress@10': 0.7712, 'time@10': 3.4935}:  30%|███       | 3/10 [00:10<00:15,  2.23s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8536, 'compress@10': 0.7712, 'time@10': 3.4935}:  40%|████      | 4/10 [00:10<00:16,  2.72s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0413, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.844, 'compress@10': 0.8169, 'time@10': 4.316}:  40%|████      | 4/10 [00:14<00:16,  2.72s/it]  {'epoch': 9, 'num_users': 5.8, 'loss': 0.0413, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.844, 'compress@10': 0.8169, 'time@10': 4.316}:  50%|█████     | 5/10 [00:14<00:15,  3.12s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0413, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8463, 'compress@10': 0.8474, 'time@10': 4.5851}:  50%|█████     | 5/10 [00:20<00:15,  3.12s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0413, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8463, 'compress@10': 0.8474, 'time@10': 4.5851}:  60%|██████    | 6/10 [00:20<00:16,  4.09s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0414, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8527, 'compress@10': 0.8588, 'time@10': 4.9033}:  60%|██████    | 6/10 [00:23<00:16,  4.09s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0414, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8527, 'compress@10': 0.8588, 'time@10': 4.9033}:  70%|███████   | 7/10 [00:23<00:11,  3.88s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0402, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8587, 'compress@10': 0.8525, 'time@10': 4.8678}:  70%|███████   | 7/10 [00:28<00:11,  3.88s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0402, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8587, 'compress@10': 0.8525, 'time@10': 4.8678}:  80%|████████  | 8/10 [00:28<00:08,  4.13s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0394, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8674, 'compress@10': 0.8182, 'time@10': 5.249}:  80%|████████  | 8/10 [00:32<00:08,  4.13s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0394, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8674, 'compress@10': 0.8182, 'time@10': 5.249}:  90%|█████████ | 9/10 [00:32<00:04,  4.15s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0388, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.8695, 'compress@10': 0.8323, 'time@10': 5.3101}:  90%|█████████ | 9/10 [00:38<00:04,  4.15s/it]  {'epoch': 9, 'num_users': 6.3, 'loss': 0.0388, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.8695, 'compress@10': 0.8323, 'time@10': 5.3101}: 100%|██████████| 10/10 [00:38<00:00,  4.69s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0388, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.8695, 'compress@10': 0.8323, 'time@10': 5.3101}: 100%|██████████| 10/10 [00:38<00:00,  3.86s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03878874752026648
Avg hit ratio: 0.8740591508095752
Avg ndcg: 0.8694680285595272
Avg compression ratio: 0.8322726863732637
Avg train time: 5.310149621963501
Std train time: 1.8153154645599432
[0.7727272727272727, 0.681818181818182, 0.13636363636363635, 0.9545454545454545, 0.9545454545454545, 0.9545454545454545, 0.6818181818181819, 0.5, 0.5, 0.6818181818181819]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8409, 'compress@10': 0.9892, 'time@10': 5.2385}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8409, 'compress@10': 0.9892, 'time@10': 5.2385}:  10%|█         | 1/10 [00:02<00:23,  2.66s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8672, 'compress@10': 0.9834, 'time@10': 4.7804}:  10%|█         | 1/10 [00:07<00:23,  2.66s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8672, 'compress@10': 0.9834, 'time@10': 4.7804}:  20%|██        | 2/10 [00:07<00:29,  3.66s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8638, 'compress@10': 0.7033, 'time@10': 4.3119}:  20%|██        | 2/10 [00:08<00:29,  3.66s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8638, 'compress@10': 0.7033, 'time@10': 4.3119}:  30%|███       | 3/10 [00:08<00:19,  2.78s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8622, 'compress@10': 0.7775, 'time@10': 4.1707}:  30%|███       | 3/10 [00:12<00:19,  2.78s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8622, 'compress@10': 0.7775, 'time@10': 4.1707}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0405, 'hit_ratio@10': 0.7816, 'ndcg@10': 0.8516, 'compress@10': 0.8219, 'time@10': 5.0054}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0405, 'hit_ratio@10': 0.7816, 'ndcg@10': 0.8516, 'compress@10': 0.8219, 'time@10': 5.0054}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0434, 'hit_ratio@10': 0.7995, 'ndcg@10': 0.8484, 'compress@10': 0.8516, 'time@10': 5.2141}:  50%|█████     | 5/10 [00:23<00:17,  3.55s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0434, 'hit_ratio@10': 0.7995, 'ndcg@10': 0.8484, 'compress@10': 0.8516, 'time@10': 5.2141}:  60%|██████    | 6/10 [00:23<00:17,  4.48s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0441, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8537, 'compress@10': 0.8658, 'time@10': 5.4341}:  60%|██████    | 6/10 [00:26<00:17,  4.48s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0441, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8537, 'compress@10': 0.8658, 'time@10': 5.4341}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.042, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8589, 'compress@10': 0.8065, 'time@10': 5.3275}:  70%|███████   | 7/10 [00:31<00:12,  4.13s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.042, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8589, 'compress@10': 0.8065, 'time@10': 5.3275}:  80%|████████  | 8/10 [00:31<00:08,  4.29s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0412, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8713, 'compress@10': 0.7333, 'time@10': 5.6554}:  80%|████████  | 8/10 [00:35<00:08,  4.29s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0412, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8713, 'compress@10': 0.7333, 'time@10': 5.6554}:  90%|█████████ | 9/10 [00:35<00:04,  4.26s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.04, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8762, 'compress@10': 0.7556, 'time@10': 5.6855}:  90%|█████████ | 9/10 [00:41<00:04,  4.26s/it]     {'epoch': 10, 'num_users': 6.3, 'loss': 0.04, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8762, 'compress@10': 0.7556, 'time@10': 5.6855}: 100%|██████████| 10/10 [00:41<00:00,  4.79s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.04, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8762, 'compress@10': 0.7556, 'time@10': 5.6855}: 100%|██████████| 10/10 [00:41<00:00,  4.13s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.04003948686666692
Avg hit ratio: 0.8448400277330668
Avg ndcg: 0.8762209271751835
Avg compression ratio: 0.7556396247558436
Avg train time: 5.685512590408325
Std train time: 1.6646352130885258
[0.7916666666666666, 0.7083333333333335, 0.12499999999999999, 0.9583333333333333, 0.9583333333333333, 0.9583333333333333, 0.7083333333333334, 0.4583333333333333, 0.5416666666666666, 0.625]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8436, 'compress@10': 0.9961, 'time@10': 5.055}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8436, 'compress@10': 0.9961, 'time@10': 5.055}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8706, 'compress@10': 0.9913, 'time@10': 4.6719}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it] {'epoch': 11, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8706, 'compress@10': 0.9913, 'time@10': 4.6719}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8661, 'compress@10': 0.7086, 'time@10': 4.2301}:  20%|██        | 2/10 [00:08<00:28,  3.60s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8661, 'compress@10': 0.7086, 'time@10': 4.2301}:  30%|███       | 3/10 [00:08<00:19,  2.74s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0307, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8563, 'compress@10': 0.7814, 'time@10': 4.1096}:  30%|███       | 3/10 [00:12<00:19,  2.74s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0307, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8563, 'compress@10': 0.7814, 'time@10': 4.1096}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0365, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8485, 'compress@10': 0.8251, 'time@10': 4.9553}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0365, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8485, 'compress@10': 0.8251, 'time@10': 4.9553}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0386, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8529, 'compress@10': 0.8542, 'time@10': 5.1829}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0386, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8529, 'compress@10': 0.8542, 'time@10': 5.1829}:  60%|██████    | 6/10 [00:22<00:17,  4.50s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0387, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8556, 'compress@10': 0.8723, 'time@10': 5.4201}:  60%|██████    | 6/10 [00:26<00:17,  4.50s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0387, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8556, 'compress@10': 0.8723, 'time@10': 5.4201}:  70%|███████   | 7/10 [00:26<00:12,  4.16s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0369, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8608, 'compress@10': 0.7872, 'time@10': 5.3197}:  70%|███████   | 7/10 [00:31<00:12,  4.16s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0369, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8608, 'compress@10': 0.7872, 'time@10': 5.3197}:  80%|████████  | 8/10 [00:31<00:08,  4.32s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0364, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8712, 'compress@10': 0.7629, 'time@10': 5.6124}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0364, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8712, 'compress@10': 0.7629, 'time@10': 5.6124}:  90%|█████████ | 9/10 [00:35<00:04,  4.22s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0366, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8718, 'compress@10': 0.7779, 'time@10': 5.6454}:  90%|█████████ | 9/10 [00:41<00:04,  4.22s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0366, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8718, 'compress@10': 0.7779, 'time@10': 5.6454}: 100%|██████████| 10/10 [00:41<00:00,  4.77s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0366, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8718, 'compress@10': 0.7779, 'time@10': 5.6454}: 100%|██████████| 10/10 [00:41<00:00,  4.11s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03658647961830018
Avg hit ratio: 0.864380408499254
Avg ndcg: 0.8717798916417813
Avg compression ratio: 0.777913027152844
Avg train time: 5.6453965425491335
Std train time: 1.6337430290731765
[0.8076923076923077, 0.653846153846154, 0.11538461538461538, 0.9615384615384615, 0.9615384615384615, 0.9615384615384615, 0.7307692307692308, 0.4230769230769231, 0.5769230769230769, 0.6538461538461539]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8433, 'compress@10': 0.9982, 'time@10': 5.1005}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8433, 'compress@10': 0.9982, 'time@10': 5.1005}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8753, 'compress@10': 0.9668, 'time@10': 4.6985}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8753, 'compress@10': 0.9668, 'time@10': 4.6985}:  20%|██        | 2/10 [00:06<00:28,  3.62s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8693, 'compress@10': 0.6922, 'time@10': 4.2435}:  20%|██        | 2/10 [00:08<00:28,  3.62s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8693, 'compress@10': 0.6922, 'time@10': 4.2435}:  30%|███       | 3/10 [00:08<00:19,  2.75s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.86, 'compress@10': 0.7691, 'time@10': 4.1282}:  30%|███       | 3/10 [00:12<00:19,  2.75s/it]  {'epoch': 12, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.86, 'compress@10': 0.7691, 'time@10': 4.1282}:  40%|████      | 4/10 [00:12<00:19,  3.17s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0346, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8521, 'compress@10': 0.8153, 'time@10': 4.9826}:  40%|████      | 4/10 [00:16<00:19,  3.17s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0346, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8521, 'compress@10': 0.8153, 'time@10': 4.9826}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0361, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8624, 'compress@10': 0.8461, 'time@10': 5.1878}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0361, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8624, 'compress@10': 0.8461, 'time@10': 5.1878}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.036, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.8686, 'compress@10': 0.867, 'time@10': 5.4125}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it]  {'epoch': 12, 'num_users': 6.2857, 'loss': 0.036, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.8686, 'compress@10': 0.867, 'time@10': 5.4125}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0346, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.872, 'compress@10': 0.7728, 'time@10': 5.3075}:  70%|███████   | 7/10 [00:30<00:12,  4.13s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0346, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.872, 'compress@10': 0.7728, 'time@10': 5.3075}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0345, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.8887, 'compress@10': 0.7811, 'time@10': 5.5933}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0345, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.8887, 'compress@10': 0.7811, 'time@10': 5.5933}:  90%|█████████ | 9/10 [00:34<00:04,  4.19s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0341, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.8898, 'compress@10': 0.8008, 'time@10': 5.6225}:  90%|█████████ | 9/10 [00:40<00:04,  4.19s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0341, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.8898, 'compress@10': 0.8008, 'time@10': 5.6225}: 100%|██████████| 10/10 [00:40<00:00,  4.72s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0341, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.8898, 'compress@10': 0.8008, 'time@10': 5.6225}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03406628004472221
Avg hit ratio: 0.8867964779985155
Avg ndcg: 0.8897952773633063
Avg compression ratio: 0.8008131929411808
Avg train time: 5.622462058067322
Std train time: 1.621296399597396
[0.8214285714285714, 0.6071428571428572, 0.10714285714285714, 0.9642857142857142, 0.9642857142857142, 0.9642857142857142, 0.7500000000000001, 0.39285714285714285, 0.6071428571428571, 0.6785714285714286]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8557, 'compress@10': 0.9992, 'time@10': 5.0972}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8557, 'compress@10': 0.9992, 'time@10': 5.0972}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.888, 'compress@10': 0.9238, 'time@10': 4.6657}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it] {'epoch': 13, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.888, 'compress@10': 0.9238, 'time@10': 4.6657}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8777, 'compress@10': 0.6635, 'time@10': 4.2305}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8777, 'compress@10': 0.6635, 'time@10': 4.2305}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8683, 'compress@10': 0.7476, 'time@10': 4.121}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8683, 'compress@10': 0.7476, 'time@10': 4.121}:  40%|████      | 4/10 [00:12<00:18,  3.17s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0317, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.8594, 'compress@10': 0.7981, 'time@10': 4.9661}:  40%|████      | 4/10 [00:16<00:18,  3.17s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0317, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.8594, 'compress@10': 0.7981, 'time@10': 4.9661}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0338, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.8679, 'compress@10': 0.8317, 'time@10': 5.0385}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0338, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.8679, 'compress@10': 0.8317, 'time@10': 5.0385}:  60%|██████    | 6/10 [00:22<00:16,  4.19s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0349, 'hit_ratio@10': 0.9144, 'ndcg@10': 0.8713, 'compress@10': 0.8549, 'time@10': 5.1021}:  60%|██████    | 6/10 [00:24<00:16,  4.19s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0349, 'hit_ratio@10': 0.9144, 'ndcg@10': 0.8713, 'compress@10': 0.8549, 'time@10': 5.1021}:  70%|███████   | 7/10 [00:24<00:11,  3.73s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0339, 'hit_ratio@10': 0.9215, 'ndcg@10': 0.8721, 'compress@10': 0.7562, 'time@10': 4.989}:  70%|███████   | 7/10 [00:29<00:11,  3.73s/it]  {'epoch': 13, 'num_users': 6.125, 'loss': 0.0339, 'hit_ratio@10': 0.9215, 'ndcg@10': 0.8721, 'compress@10': 0.7562, 'time@10': 4.989}:  80%|████████  | 8/10 [00:29<00:07,  3.89s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.035, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.897, 'compress@10': 0.7761, 'time@10': 5.2838}:  80%|████████  | 8/10 [00:32<00:07,  3.89s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.035, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.897, 'compress@10': 0.7761, 'time@10': 5.2838}:  90%|█████████ | 9/10 [00:32<00:03,  3.88s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.898, 'compress@10': 0.7977, 'time@10': 5.3086}:  90%|█████████ | 9/10 [00:38<00:03,  3.88s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.898, 'compress@10': 0.7977, 'time@10': 5.3086}: 100%|██████████| 10/10 [00:38<00:00,  4.41s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.898, 'compress@10': 0.7977, 'time@10': 5.3086}: 100%|██████████| 10/10 [00:38<00:00,  3.85s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03498216254689766
Avg hit ratio: 0.9034882073218234
Avg ndcg: 0.8979596039161419
Avg compression ratio: 0.7977036402037507
Avg train time: 5.3086034774780275
Std train time: 1.526340503945304
[0.8333333333333333, 0.5666666666666668, 0.09999999999999999, 0.9666666666666666, 0.9666666666666666, 0.9666666666666666, 0.7666666666666667, 0.36666666666666664, 0.6333333333333333, 0.7000000000000001]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0359, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8856, 'compress@10': 0.9994, 'time@10': 5.0715}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0359, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8856, 'compress@10': 0.9994, 'time@10': 5.0715}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.907, 'compress@10': 0.8887, 'time@10': 4.6967}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it] {'epoch': 14, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.907, 'compress@10': 0.8887, 'time@10': 4.6967}:  20%|██        | 2/10 [00:06<00:29,  3.63s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8904, 'compress@10': 0.6401, 'time@10': 4.2459}:  20%|██        | 2/10 [00:08<00:29,  3.63s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8904, 'compress@10': 0.6401, 'time@10': 4.2459}:  30%|███       | 3/10 [00:08<00:19,  2.75s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8764, 'compress@10': 0.7301, 'time@10': 4.1388}:  30%|███       | 3/10 [00:12<00:19,  2.75s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8764, 'compress@10': 0.7301, 'time@10': 4.1388}:  40%|████      | 4/10 [00:12<00:19,  3.19s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0296, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.8679, 'compress@10': 0.784, 'time@10': 4.9906}:  40%|████      | 4/10 [00:16<00:19,  3.19s/it] {'epoch': 14, 'num_users': 5.8, 'loss': 0.0296, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.8679, 'compress@10': 0.784, 'time@10': 4.9906}:  50%|█████     | 5/10 [00:16<00:17,  3.57s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0316, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.8779, 'compress@10': 0.82, 'time@10': 5.2121}:  50%|█████     | 5/10 [00:23<00:17,  3.57s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0316, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.8779, 'compress@10': 0.82, 'time@10': 5.2121}:  60%|██████    | 6/10 [00:23<00:18,  4.52s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0315, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.8802, 'compress@10': 0.8452, 'time@10': 5.4088}:  60%|██████    | 6/10 [00:26<00:18,  4.52s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0315, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.8802, 'compress@10': 0.8452, 'time@10': 5.4088}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.031, 'hit_ratio@10': 0.9243, 'ndcg@10': 0.8778, 'compress@10': 0.7454, 'time@10': 5.3301}:  70%|███████   | 7/10 [00:31<00:12,  4.13s/it]  {'epoch': 14, 'num_users': 6.125, 'loss': 0.031, 'hit_ratio@10': 0.9243, 'ndcg@10': 0.8778, 'compress@10': 0.7454, 'time@10': 5.3301}:  80%|████████  | 8/10 [00:31<00:08,  4.35s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0346, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9055, 'compress@10': 0.7682, 'time@10': 5.6306}:  80%|████████  | 8/10 [00:35<00:08,  4.35s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0346, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9055, 'compress@10': 0.7682, 'time@10': 5.6306}:  90%|█████████ | 9/10 [00:35<00:04,  4.26s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0347, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9054, 'compress@10': 0.791, 'time@10': 5.672}:  90%|█████████ | 9/10 [00:41<00:04,  4.26s/it]      {'epoch': 14, 'num_users': 6.3, 'loss': 0.0347, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9054, 'compress@10': 0.791, 'time@10': 5.672}: 100%|██████████| 10/10 [00:41<00:00,  4.82s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0347, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9054, 'compress@10': 0.791, 'time@10': 5.672}: 100%|██████████| 10/10 [00:41<00:00,  4.14s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.03466614310119721
Avg hit ratio: 0.9120091308427473
Avg ndcg: 0.9054485356649519
Avg compression ratio: 0.7910344460878488
Avg train time: 5.671957564353943
Std train time: 1.6202637315606998
[0.8437499999999999, 0.5312500000000001, 0.09374999999999999, 0.9687499999999999, 0.9687499999999999, 0.9687499999999999, 0.78125, 0.34375, 0.65625, 0.7187500000000001]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8925, 'compress@10': 0.9994, 'time@10': 5.2136}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8925, 'compress@10': 0.9994, 'time@10': 5.2136}:  10%|█         | 1/10 [00:02<00:23,  2.65s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9172, 'compress@10': 0.8489, 'time@10': 4.7358}:  10%|█         | 1/10 [00:06<00:23,  2.65s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9172, 'compress@10': 0.8489, 'time@10': 4.7358}:  20%|██        | 2/10 [00:06<00:28,  3.62s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8972, 'compress@10': 0.6136, 'time@10': 4.2513}:  20%|██        | 2/10 [00:08<00:28,  3.62s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8972, 'compress@10': 0.6136, 'time@10': 4.2513}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8837, 'compress@10': 0.7102, 'time@10': 4.1055}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8837, 'compress@10': 0.7102, 'time@10': 4.1055}:  40%|████      | 4/10 [00:12<00:18,  3.12s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0283, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8751, 'compress@10': 0.7681, 'time@10': 4.9513}:  40%|████      | 4/10 [00:16<00:18,  3.12s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0283, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8751, 'compress@10': 0.7681, 'time@10': 4.9513}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0297, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8837, 'compress@10': 0.8068, 'time@10': 5.1941}:  50%|█████     | 5/10 [00:23<00:17,  3.52s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0297, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8837, 'compress@10': 0.8068, 'time@10': 5.1941}:  60%|██████    | 6/10 [00:23<00:18,  4.52s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.888, 'compress@10': 0.8339, 'time@10': 5.4501}:  60%|██████    | 6/10 [00:26<00:18,  4.52s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.888, 'compress@10': 0.8339, 'time@10': 5.4501}:  70%|███████   | 7/10 [00:26<00:12,  4.19s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0286, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.8893, 'compress@10': 0.7346, 'time@10': 5.3703}:  70%|███████   | 7/10 [00:31<00:12,  4.19s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0286, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.8893, 'compress@10': 0.7346, 'time@10': 5.3703}:  80%|████████  | 8/10 [00:31<00:08,  4.41s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0306, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.899, 'compress@10': 0.7545, 'time@10': 5.6901}:  80%|████████  | 8/10 [00:35<00:08,  4.41s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0306, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.899, 'compress@10': 0.7545, 'time@10': 5.6901}:  90%|█████████ | 9/10 [00:35<00:04,  4.33s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9032, 'compress@10': 0.7788, 'time@10': 5.7215}:  90%|█████████ | 9/10 [00:41<00:04,  4.33s/it]  {'epoch': 15, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9032, 'compress@10': 0.7788, 'time@10': 5.7215}: 100%|██████████| 10/10 [00:41<00:00,  4.86s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9032, 'compress@10': 0.7788, 'time@10': 5.7215}: 100%|██████████| 10/10 [00:41<00:00,  4.16s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.029726536183799158
Avg hit ratio: 0.8947329859350234
Avg ndcg: 0.9031616792687533
Avg compression ratio: 0.7787934245472343
Avg train time: 5.721518778800965
Std train time: 1.6957426476469637
[0.8529411764705881, 0.5000000000000001, 0.08823529411764705, 0.9705882352941175, 0.9705882352941175, 0.9705882352941175, 0.7941176470588235, 0.38235294117647056, 0.6764705882352942, 0.6764705882352943]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9005, 'compress@10': 0.9995, 'time@10': 5.0965}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9005, 'compress@10': 0.9995, 'time@10': 5.0965}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9223, 'compress@10': 0.7386, 'time@10': 4.6789}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9223, 'compress@10': 0.7386, 'time@10': 4.6789}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9006, 'compress@10': 0.5401, 'time@10': 4.2223}:  20%|██        | 2/10 [00:08<00:28,  3.60s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9006, 'compress@10': 0.5401, 'time@10': 4.2223}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0224, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8849, 'compress@10': 0.655, 'time@10': 4.1157}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0224, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8849, 'compress@10': 0.655, 'time@10': 4.1157}:  40%|████      | 4/10 [00:12<00:18,  3.16s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0262, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.8768, 'compress@10': 0.724, 'time@10': 4.9892}:  40%|████      | 4/10 [00:16<00:18,  3.16s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0262, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.8768, 'compress@10': 0.724, 'time@10': 4.9892}:  50%|█████     | 5/10 [00:16<00:17,  3.57s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0282, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.8847, 'compress@10': 0.77, 'time@10': 5.2168}:  50%|█████     | 5/10 [00:23<00:17,  3.57s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0282, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.8847, 'compress@10': 0.77, 'time@10': 5.2168}:  60%|██████    | 6/10 [00:23<00:18,  4.53s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0294, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.8901, 'compress@10': 0.8025, 'time@10': 5.3797}:  60%|██████    | 6/10 [00:26<00:18,  4.53s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0294, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.8901, 'compress@10': 0.8025, 'time@10': 5.3797}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0284, 'hit_ratio@10': 0.9243, 'ndcg@10': 0.8929, 'compress@10': 0.7091, 'time@10': 5.295}:  70%|███████   | 7/10 [00:31<00:12,  4.10s/it]  {'epoch': 16, 'num_users': 6.125, 'loss': 0.0284, 'hit_ratio@10': 0.9243, 'ndcg@10': 0.8929, 'compress@10': 0.7091, 'time@10': 5.295}:  80%|████████  | 8/10 [00:31<00:08,  4.31s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.8984, 'compress@10': 0.7369, 'time@10': 5.5997}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.8984, 'compress@10': 0.7369, 'time@10': 5.5997}:  90%|█████████ | 9/10 [00:35<00:04,  4.23s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.912, 'ndcg@10': 0.8977, 'compress@10': 0.7625, 'time@10': 5.6421}:  90%|█████████ | 9/10 [00:41<00:04,  4.23s/it]    {'epoch': 16, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.912, 'ndcg@10': 0.8977, 'compress@10': 0.7625, 'time@10': 5.6421}: 100%|██████████| 10/10 [00:41<00:00,  4.80s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.912, 'ndcg@10': 0.8977, 'compress@10': 0.7625, 'time@10': 5.6421}: 100%|██████████| 10/10 [00:41<00:00,  4.12s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.028616204513318887
Avg hit ratio: 0.9120091308427473
Avg ndcg: 0.8976933644268419
Avg compression ratio: 0.7625391007761307
Avg train time: 5.642137336730957
Std train time: 1.640527637072417
[0.8611111111111109, 0.5277777777777779, 0.08333333333333333, 0.9722222222222221, 0.9722222222222221, 0.9722222222222221, 0.8055555555555555, 0.3611111111111111, 0.638888888888889, 0.6944444444444446]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9026, 'compress@10': 0.9996, 'time@10': 5.1543}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9026, 'compress@10': 0.9996, 'time@10': 5.1543}:  10%|█         | 1/10 [00:02<00:23,  2.62s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9255, 'compress@10': 0.8668, 'time@10': 4.7246}:  10%|█         | 1/10 [00:06<00:23,  2.62s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9255, 'compress@10': 0.8668, 'time@10': 4.7246}:  20%|██        | 2/10 [00:06<00:29,  3.63s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9027, 'compress@10': 0.6255, 'time@10': 4.2881}:  20%|██        | 2/10 [00:08<00:29,  3.63s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9027, 'compress@10': 0.6255, 'time@10': 4.2881}:  30%|███       | 3/10 [00:08<00:19,  2.78s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8891, 'compress@10': 0.7191, 'time@10': 4.1617}:  30%|███       | 3/10 [00:12<00:19,  2.78s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8891, 'compress@10': 0.7191, 'time@10': 4.1617}:  40%|████      | 4/10 [00:12<00:19,  3.19s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0232, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.8823, 'compress@10': 0.7753, 'time@10': 5.0328}:  40%|████      | 4/10 [00:16<00:19,  3.19s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0232, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.8823, 'compress@10': 0.7753, 'time@10': 5.0328}:  50%|█████     | 5/10 [00:16<00:17,  3.59s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.025, 'hit_ratio@10': 0.896, 'ndcg@10': 0.8901, 'compress@10': 0.8127, 'time@10': 5.2321}:  50%|█████     | 5/10 [00:23<00:17,  3.59s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.025, 'hit_ratio@10': 0.896, 'ndcg@10': 0.8901, 'compress@10': 0.8127, 'time@10': 5.2321}:  60%|██████    | 6/10 [00:23<00:18,  4.50s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0256, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.8908, 'compress@10': 0.8392, 'time@10': 5.4384}:  60%|██████    | 6/10 [00:26<00:18,  4.50s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0256, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.8908, 'compress@10': 0.8392, 'time@10': 5.4384}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0258, 'hit_ratio@10': 0.9134, 'ndcg@10': 0.8896, 'compress@10': 0.7401, 'time@10': 5.329}:  70%|███████   | 7/10 [00:31<00:12,  4.13s/it]  {'epoch': 17, 'num_users': 6.125, 'loss': 0.0258, 'hit_ratio@10': 0.9134, 'ndcg@10': 0.8896, 'compress@10': 0.7401, 'time@10': 5.329}:  80%|████████  | 8/10 [00:31<00:08,  4.28s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8955, 'compress@10': 0.7599, 'time@10': 5.5264}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8955, 'compress@10': 0.7599, 'time@10': 5.5264}:  90%|█████████ | 9/10 [00:34<00:04,  4.07s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9013, 'compress@10': 0.7834, 'time@10': 5.4852}:  90%|█████████ | 9/10 [00:39<00:04,  4.07s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9013, 'compress@10': 0.7834, 'time@10': 5.4852}: 100%|██████████| 10/10 [00:39<00:00,  4.40s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9013, 'compress@10': 0.7834, 'time@10': 5.4852}: 100%|██████████| 10/10 [00:39<00:00,  3.98s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02440068940692239
Avg hit ratio: 0.894179451561455
Avg ndcg: 0.9013468716755109
Avg compression ratio: 0.7834253060151001
Avg train time: 5.485182547569275
Std train time: 1.5325761079449849
[0.8684210526315788, 0.5000000000000001, 0.07894736842105263, 0.9736842105263157, 0.9736842105263157, 0.9736842105263157, 0.8157894736842104, 0.39473684210526316, 0.605263157894737, 0.7105263157894739]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0278, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9008, 'compress@10': 0.9996, 'time@10': 4.8662}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0278, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9008, 'compress@10': 0.9996, 'time@10': 4.8662}:  10%|█         | 1/10 [00:02<00:22,  2.47s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9263, 'compress@10': 0.7481, 'time@10': 4.5582}:  10%|█         | 1/10 [00:06<00:22,  2.47s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9263, 'compress@10': 0.7481, 'time@10': 4.5582}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9033, 'compress@10': 0.5464, 'time@10': 4.0943}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9033, 'compress@10': 0.5464, 'time@10': 4.0943}:  30%|███       | 3/10 [00:08<00:18,  2.67s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8914, 'compress@10': 0.6598, 'time@10': 3.892}:  30%|███       | 3/10 [00:11<00:18,  2.67s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8914, 'compress@10': 0.6598, 'time@10': 3.892}:  40%|████      | 4/10 [00:11<00:17,  2.93s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.86, 'ndcg@10': 0.886, 'compress@10': 0.7278, 'time@10': 4.649}:  40%|████      | 4/10 [00:15<00:17,  2.93s/it]    {'epoch': 18, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.86, 'ndcg@10': 0.886, 'compress@10': 0.7278, 'time@10': 4.649}:  50%|█████     | 5/10 [00:15<00:16,  3.27s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0248, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.8923, 'compress@10': 0.7732, 'time@10': 4.8929}:  50%|█████     | 5/10 [00:21<00:16,  3.27s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0248, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.8923, 'compress@10': 0.7732, 'time@10': 4.8929}:  60%|██████    | 6/10 [00:21<00:16,  4.25s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0247, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.8958, 'compress@10': 0.8054, 'time@10': 5.1779}:  60%|██████    | 6/10 [00:25<00:16,  4.25s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0247, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.8958, 'compress@10': 0.8054, 'time@10': 5.1779}:  70%|███████   | 7/10 [00:25<00:11,  4.00s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.8945, 'compress@10': 0.7132, 'time@10': 5.0934}:  70%|███████   | 7/10 [00:29<00:11,  4.00s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.8945, 'compress@10': 0.7132, 'time@10': 5.0934}:  80%|████████  | 8/10 [00:29<00:08,  4.17s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0263, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9156, 'compress@10': 0.7318, 'time@10': 5.4286}:  80%|████████  | 8/10 [00:33<00:08,  4.17s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0263, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9156, 'compress@10': 0.7318, 'time@10': 5.4286}:  90%|█████████ | 9/10 [00:33<00:04,  4.15s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.915, 'compress@10': 0.7582, 'time@10': 5.4921}:  90%|█████████ | 9/10 [00:39<00:04,  4.15s/it]    {'epoch': 18, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.915, 'compress@10': 0.7582, 'time@10': 5.4921}: 100%|██████████| 10/10 [00:39<00:00,  4.75s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.915, 'compress@10': 0.7582, 'time@10': 5.4921}: 100%|██████████| 10/10 [00:39<00:00,  4.00s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.02752696667666791
Avg hit ratio: 0.8871953245773281
Avg ndcg: 0.9149861381128058
Avg compression ratio: 0.7582129084311063
Avg train time: 5.492128038406372
Std train time: 1.6578364543185795
[0.8749999999999998, 0.4750000000000001, 0.075, 0.9749999999999999, 0.9749999999999999, 0.9749999999999999, 0.7749999999999999, 0.425, 0.6250000000000001, 0.7250000000000002]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0253, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9027, 'compress@10': 0.9996, 'time@10': 5.0521}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0253, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9027, 'compress@10': 0.9996, 'time@10': 5.0521}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9286, 'compress@10': 0.6259, 'time@10': 4.665}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it] {'epoch': 19, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9286, 'compress@10': 0.6259, 'time@10': 4.665}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9048, 'compress@10': 0.4649, 'time@10': 4.2493}:  20%|██        | 2/10 [00:08<00:28,  3.60s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9048, 'compress@10': 0.4649, 'time@10': 4.2493}:  30%|███       | 3/10 [00:08<00:19,  2.75s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8997, 'compress@10': 0.5987, 'time@10': 4.129}:  30%|███       | 3/10 [00:12<00:19,  2.75s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8997, 'compress@10': 0.5987, 'time@10': 4.129}:  40%|████      | 4/10 [00:12<00:19,  3.17s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8931, 'compress@10': 0.6789, 'time@10': 4.9738}:  40%|████      | 4/10 [00:16<00:19,  3.17s/it] {'epoch': 19, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8931, 'compress@10': 0.6789, 'time@10': 4.9738}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0237, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9043, 'compress@10': 0.7324, 'time@10': 5.158}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0237, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9043, 'compress@10': 0.7324, 'time@10': 5.158}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0252, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9062, 'compress@10': 0.7701, 'time@10': 5.3908}:  60%|██████    | 6/10 [00:26<00:17,  4.43s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0252, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9062, 'compress@10': 0.7701, 'time@10': 5.3908}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9081, 'compress@10': 0.6871, 'time@10': 5.2852}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9081, 'compress@10': 0.6871, 'time@10': 5.2852}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9318, 'compress@10': 0.7124, 'time@10': 5.6004}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9318, 'compress@10': 0.7124, 'time@10': 5.6004}:  90%|█████████ | 9/10 [00:34<00:04,  4.21s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0305, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9298, 'compress@10': 0.7408, 'time@10': 5.646}:  90%|█████████ | 9/10 [00:41<00:04,  4.21s/it]    {'epoch': 19, 'num_users': 6.3, 'loss': 0.0305, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9298, 'compress@10': 0.7408, 'time@10': 5.646}: 100%|██████████| 10/10 [00:41<00:00,  4.79s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0305, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9298, 'compress@10': 0.7408, 'time@10': 5.646}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.03051383181136704
Avg hit ratio: 0.8957667531487565
Avg ndcg: 0.9298282729951977
Avg compression ratio: 0.7408096578754961
Avg train time: 5.645968961715698
Std train time: 1.6443495336983043
[0.8809523809523807, 0.45238095238095244, 0.07142857142857142, 0.976190476190476, 0.976190476190476, 0.976190476190476, 0.7857142857142856, 0.40476190476190477, 0.642857142857143, 0.7380952380952382]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9005, 'compress@10': 0.9997, 'time@10': 5.1205}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9005, 'compress@10': 0.9997, 'time@10': 5.1205}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9287, 'compress@10': 0.59, 'time@10': 4.7174}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it]  {'epoch': 20, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9287, 'compress@10': 0.59, 'time@10': 4.7174}:  20%|██        | 2/10 [00:06<00:29,  3.63s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9049, 'compress@10': 0.441, 'time@10': 4.2821}:  20%|██        | 2/10 [00:08<00:29,  3.63s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9049, 'compress@10': 0.441, 'time@10': 4.2821}:  30%|███       | 3/10 [00:08<00:19,  2.77s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9023, 'compress@10': 0.5807, 'time@10': 4.1711}:  30%|███       | 3/10 [00:12<00:19,  2.77s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9023, 'compress@10': 0.5807, 'time@10': 4.1711}:  40%|████      | 4/10 [00:12<00:19,  3.21s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8982, 'compress@10': 0.6646, 'time@10': 5.0115}:  40%|████      | 4/10 [00:16<00:19,  3.21s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8982, 'compress@10': 0.6646, 'time@10': 5.0115}:  50%|█████     | 5/10 [00:16<00:17,  3.57s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0215, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9058, 'compress@10': 0.7205, 'time@10': 5.193}:  50%|█████     | 5/10 [00:22<00:17,  3.57s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0215, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9058, 'compress@10': 0.7205, 'time@10': 5.193}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0221, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9064, 'compress@10': 0.76, 'time@10': 5.4216}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]  {'epoch': 20, 'num_users': 6.2857, 'loss': 0.0221, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9064, 'compress@10': 0.76, 'time@10': 5.4216}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.022, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9102, 'compress@10': 0.6751, 'time@10': 5.303}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.022, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9102, 'compress@10': 0.6751, 'time@10': 5.303}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0239, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9069, 'compress@10': 0.6983, 'time@10': 5.6479}:  80%|████████  | 8/10 [00:35<00:08,  4.24s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0239, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9069, 'compress@10': 0.6983, 'time@10': 5.6479}:  90%|█████████ | 9/10 [00:35<00:04,  4.24s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9116, 'compress@10': 0.7281, 'time@10': 5.688}:  90%|█████████ | 9/10 [00:41<00:04,  4.24s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9116, 'compress@10': 0.7281, 'time@10': 5.688}: 100%|██████████| 10/10 [00:41<00:00,  4.81s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9116, 'compress@10': 0.7281, 'time@10': 5.688}: 100%|██████████| 10/10 [00:41<00:00,  4.12s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.023746805417478374
Avg hit ratio: 0.8915445309265344
Avg ndcg: 0.9115595472693787
Avg compression ratio: 0.7281433478952044
Avg train time: 5.687952375411987
Std train time: 1.6856587821737492
[0.8863636363636361, 0.4318181818181819, 0.06818181818181818, 0.9772727272727272, 0.9772727272727272, 0.9772727272727272, 0.7954545454545453, 0.38636363636363635, 0.6590909090909093, 0.7500000000000001]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9006, 'compress@10': 0.9997, 'time@10': 5.1113}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9006, 'compress@10': 0.9997, 'time@10': 5.1113}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9291, 'compress@10': 0.5665, 'time@10': 4.714}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it]  {'epoch': 21, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9291, 'compress@10': 0.5665, 'time@10': 4.714}:  20%|██        | 2/10 [00:06<00:29,  3.64s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9051, 'compress@10': 0.4253, 'time@10': 4.3086}:  20%|██        | 2/10 [00:08<00:29,  3.64s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9051, 'compress@10': 0.4253, 'time@10': 4.3086}:  30%|███       | 3/10 [00:08<00:19,  2.79s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.907, 'compress@10': 0.569, 'time@10': 4.1767}:  30%|███       | 3/10 [00:12<00:19,  2.79s/it]   {'epoch': 21, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.907, 'compress@10': 0.569, 'time@10': 4.1767}:  40%|████      | 4/10 [00:12<00:19,  3.20s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0179, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9039, 'compress@10': 0.6552, 'time@10': 5.0292}:  40%|████      | 4/10 [00:16<00:19,  3.20s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0179, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9039, 'compress@10': 0.6552, 'time@10': 5.0292}:  50%|█████     | 5/10 [00:16<00:17,  3.58s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0205, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.909, 'compress@10': 0.7126, 'time@10': 5.2157}:  50%|█████     | 5/10 [00:23<00:17,  3.58s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0205, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.909, 'compress@10': 0.7126, 'time@10': 5.2157}:  60%|██████    | 6/10 [00:23<00:17,  4.47s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0199, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9122, 'compress@10': 0.7533, 'time@10': 5.4415}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0199, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9122, 'compress@10': 0.7533, 'time@10': 5.4415}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9142, 'compress@10': 0.6669, 'time@10': 5.3174}:  70%|███████   | 7/10 [00:30<00:12,  4.13s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9142, 'compress@10': 0.6669, 'time@10': 5.3174}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9186, 'compress@10': 0.6963, 'time@10': 5.641}:  80%|████████  | 8/10 [00:35<00:08,  4.24s/it] {'epoch': 21, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9186, 'compress@10': 0.6963, 'time@10': 5.641}:  90%|█████████ | 9/10 [00:35<00:04,  4.22s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9197, 'compress@10': 0.7264, 'time@10': 5.6832}:  90%|█████████ | 9/10 [00:41<00:04,  4.22s/it] {'epoch': 21, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9197, 'compress@10': 0.7264, 'time@10': 5.6832}: 100%|██████████| 10/10 [00:41<00:00,  4.80s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9197, 'compress@10': 0.7264, 'time@10': 5.6832}: 100%|██████████| 10/10 [00:41<00:00,  4.12s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.020230385804308918
Avg hit ratio: 0.9013985746379634
Avg ndcg: 0.9196678504593816
Avg compression ratio: 0.7263992493334311
Avg train time: 5.683150792121888
Std train time: 1.667167961930131
[0.8913043478260867, 0.4130434782608696, 0.06521739130434782, 0.9782608695652173, 0.9782608695652173, 0.9782608695652173, 0.8043478260869564, 0.41304347826086957, 0.6304347826086958, 0.7608695652173915]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0434, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8421, 'compress@10': 0.9997, 'time@10': 4.4481}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0434, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8421, 'compress@10': 0.9997, 'time@10': 4.4481}:  10%|█         | 1/10 [00:02<00:20,  2.26s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0305, 'hit_ratio@10': 0.893, 'ndcg@10': 0.8998, 'compress@10': 0.5493, 'time@10': 4.0451}:  10%|█         | 1/10 [00:05<00:20,  2.26s/it] {'epoch': 22, 'num_users': 7.0, 'loss': 0.0305, 'hit_ratio@10': 0.893, 'ndcg@10': 0.8998, 'compress@10': 0.5493, 'time@10': 4.0451}:  20%|██        | 2/10 [00:05<00:24,  3.10s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.8856, 'compress@10': 0.4138, 'time@10': 3.6945}:  20%|██        | 2/10 [00:07<00:24,  3.10s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.8856, 'compress@10': 0.4138, 'time@10': 3.6945}:  30%|███       | 3/10 [00:07<00:16,  2.39s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8869, 'compress@10': 0.5604, 'time@10': 3.6035}:  30%|███       | 3/10 [00:10<00:16,  2.39s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8869, 'compress@10': 0.5604, 'time@10': 3.6035}:  40%|████      | 4/10 [00:10<00:16,  2.77s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8889, 'compress@10': 0.6483, 'time@10': 4.4434}:  40%|████      | 4/10 [00:14<00:16,  2.77s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8889, 'compress@10': 0.6483, 'time@10': 4.4434}:  50%|█████     | 5/10 [00:14<00:15,  3.19s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0253, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9054, 'compress@10': 0.7069, 'time@10': 4.6955}:  50%|█████     | 5/10 [00:20<00:15,  3.19s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0253, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9054, 'compress@10': 0.7069, 'time@10': 4.6955}:  60%|██████    | 6/10 [00:20<00:16,  4.15s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0262, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9086, 'compress@10': 0.7485, 'time@10': 4.9166}:  60%|██████    | 6/10 [00:24<00:16,  4.15s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0262, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9086, 'compress@10': 0.7485, 'time@10': 4.9166}:  70%|███████   | 7/10 [00:24<00:11,  3.89s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0256, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.91, 'compress@10': 0.6654, 'time@10': 4.8208}:  70%|███████   | 7/10 [00:28<00:11,  3.89s/it]   {'epoch': 22, 'num_users': 6.125, 'loss': 0.0256, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.91, 'compress@10': 0.6654, 'time@10': 4.8208}:  80%|████████  | 8/10 [00:28<00:07,  3.99s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0264, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9292, 'compress@10': 0.6923, 'time@10': 5.2144}:  80%|████████  | 8/10 [00:32<00:07,  3.99s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0264, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9292, 'compress@10': 0.6923, 'time@10': 5.2144}:  90%|█████████ | 9/10 [00:32<00:04,  4.06s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9337, 'compress@10': 0.7228, 'time@10': 5.3055}:  90%|█████████ | 9/10 [00:38<00:04,  4.06s/it] {'epoch': 22, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9337, 'compress@10': 0.7228, 'time@10': 5.3055}: 100%|██████████| 10/10 [00:38<00:00,  4.71s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9337, 'compress@10': 0.7228, 'time@10': 5.3055}: 100%|██████████| 10/10 [00:38<00:00,  3.87s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.024350631230228688
Avg hit ratio: 0.8806842889236778
Avg ndcg: 0.9337489274061829
Avg compression ratio: 0.7228026268484586
Avg train time: 5.3054851770401
Std train time: 1.7789473950433956
[0.895833333333333, 0.39583333333333337, 0.0625, 0.9791666666666665, 0.9791666666666665, 0.9791666666666665, 0.8124999999999999, 0.4375, 0.6458333333333335, 0.7291666666666669]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8901, 'compress@10': 0.9997, 'time@10': 5.3894}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8901, 'compress@10': 0.9997, 'time@10': 5.3894}:  10%|█         | 1/10 [00:02<00:24,  2.74s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9241, 'compress@10': 0.5416, 'time@10': 4.8889}:  10%|█         | 1/10 [00:07<00:24,  2.74s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9241, 'compress@10': 0.5416, 'time@10': 4.8889}:  20%|██        | 2/10 [00:07<00:29,  3.74s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9018, 'compress@10': 0.4087, 'time@10': 4.4752}:  20%|██        | 2/10 [00:09<00:29,  3.74s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9018, 'compress@10': 0.4087, 'time@10': 4.4752}:  30%|███       | 3/10 [00:09<00:20,  2.88s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9062, 'compress@10': 0.5565, 'time@10': 4.3069}:  30%|███       | 3/10 [00:12<00:20,  2.88s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9062, 'compress@10': 0.5565, 'time@10': 4.3069}:  40%|████      | 4/10 [00:12<00:19,  3.26s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9037, 'compress@10': 0.6452, 'time@10': 5.1467}:  40%|████      | 4/10 [00:17<00:19,  3.26s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9037, 'compress@10': 0.6452, 'time@10': 5.1467}:  50%|█████     | 5/10 [00:17<00:18,  3.63s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9133, 'compress@10': 0.7043, 'time@10': 5.3117}:  50%|█████     | 5/10 [00:23<00:18,  3.63s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9133, 'compress@10': 0.7043, 'time@10': 5.3117}:  60%|██████    | 6/10 [00:23<00:17,  4.50s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9112, 'compress@10': 0.7463, 'time@10': 5.5337}:  60%|██████    | 6/10 [00:26<00:17,  4.50s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9112, 'compress@10': 0.7463, 'time@10': 5.5337}:  70%|███████   | 7/10 [00:26<00:12,  4.16s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9144, 'compress@10': 0.6673, 'time@10': 5.3952}:  70%|███████   | 7/10 [00:31<00:12,  4.16s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9144, 'compress@10': 0.6673, 'time@10': 5.3952}:  80%|████████  | 8/10 [00:31<00:08,  4.26s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0239, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9352, 'compress@10': 0.6953, 'time@10': 5.7202}:  80%|████████  | 8/10 [00:35<00:08,  4.26s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0239, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9352, 'compress@10': 0.6953, 'time@10': 5.7202}:  90%|█████████ | 9/10 [00:35<00:04,  4.24s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.024, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9344, 'compress@10': 0.7251, 'time@10': 5.7606}:  90%|█████████ | 9/10 [00:41<00:04,  4.24s/it]    {'epoch': 23, 'num_users': 6.3, 'loss': 0.024, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9344, 'compress@10': 0.7251, 'time@10': 5.7606}: 100%|██████████| 10/10 [00:41<00:00,  4.83s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.024, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9344, 'compress@10': 0.7251, 'time@10': 5.7606}: 100%|██████████| 10/10 [00:41<00:00,  4.17s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.024027454678759934
Avg hit ratio: 0.9010529525181477
Avg ndcg: 0.934423430844207
Avg compression ratio: 0.7251498551675029
Avg train time: 5.760572743415833
Std train time: 1.6638103078821838
[0.8999999999999997, 0.38000000000000006, 0.06, 0.9799999999999999, 0.9799999999999999, 0.9399999999999998, 0.8199999999999998, 0.46, 0.6600000000000001, 0.7400000000000002]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9091, 'compress@10': 0.9997, 'time@10': 5.0916}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9091, 'compress@10': 0.9997, 'time@10': 5.0916}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9352, 'compress@10': 0.5351, 'time@10': 4.6766}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it] {'epoch': 24, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9352, 'compress@10': 0.5351, 'time@10': 4.6766}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9092, 'compress@10': 0.4044, 'time@10': 4.2996}:  20%|██        | 2/10 [00:08<00:28,  3.59s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9092, 'compress@10': 0.4044, 'time@10': 4.2996}:  30%|███       | 3/10 [00:08<00:19,  2.78s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.912, 'compress@10': 0.5533, 'time@10': 4.1812}:  30%|███       | 3/10 [00:12<00:19,  2.78s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.912, 'compress@10': 0.5533, 'time@10': 4.1812}:  40%|████      | 4/10 [00:12<00:19,  3.21s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9085, 'compress@10': 0.6426, 'time@10': 5.0374}:  40%|████      | 4/10 [00:16<00:19,  3.21s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9085, 'compress@10': 0.6426, 'time@10': 5.0374}:  50%|█████     | 5/10 [00:16<00:17,  3.59s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0189, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9167, 'compress@10': 0.7021, 'time@10': 5.2137}:  50%|█████     | 5/10 [00:22<00:17,  3.59s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0189, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9167, 'compress@10': 0.7021, 'time@10': 5.2137}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0176, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.921, 'compress@10': 0.7445, 'time@10': 5.457}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]  {'epoch': 24, 'num_users': 6.2857, 'loss': 0.0176, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.921, 'compress@10': 0.7445, 'time@10': 5.457}:  70%|███████   | 7/10 [00:26<00:12,  4.14s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0176, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9231, 'compress@10': 0.6702, 'time@10': 5.3283}:  70%|███████   | 7/10 [00:30<00:12,  4.14s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0176, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9231, 'compress@10': 0.6702, 'time@10': 5.3283}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0204, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9184, 'compress@10': 0.6989, 'time@10': 5.6707}:  80%|████████  | 8/10 [00:35<00:08,  4.25s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0204, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9184, 'compress@10': 0.6989, 'time@10': 5.6707}:  90%|█████████ | 9/10 [00:35<00:04,  4.25s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9235, 'compress@10': 0.7284, 'time@10': 5.7056}:  90%|█████████ | 9/10 [00:41<00:04,  4.25s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9235, 'compress@10': 0.7284, 'time@10': 5.7056}: 100%|██████████| 10/10 [00:41<00:00,  4.81s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9235, 'compress@10': 0.7284, 'time@10': 5.7056}: 100%|██████████| 10/10 [00:41<00:00,  4.12s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.019668771412257674
Avg hit ratio: 0.8993985746379632
Avg ndcg: 0.9235491628935086
Avg compression ratio: 0.728420496139356
Avg train time: 5.705623912811279
Std train time: 1.7006833518258344
[0.9038461538461535, 0.3653846153846154, 0.05769230769230769, 0.9807692307692306, 0.9807692307692306, 0.9423076923076922, 0.7884615384615383, 0.4807692307692308, 0.6730769230769232, 0.7500000000000002]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9141, 'compress@10': 0.9997, 'time@10': 5.2139}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9141, 'compress@10': 0.9997, 'time@10': 5.2139}:  10%|█         | 1/10 [00:02<00:23,  2.64s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9371, 'compress@10': 0.5294, 'time@10': 4.7532}:  10%|█         | 1/10 [00:06<00:23,  2.64s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9371, 'compress@10': 0.5294, 'time@10': 4.7532}:  20%|██        | 2/10 [00:06<00:29,  3.64s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9105, 'compress@10': 0.4006, 'time@10': 4.3491}:  20%|██        | 2/10 [00:08<00:29,  3.64s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9105, 'compress@10': 0.4006, 'time@10': 4.3491}:  30%|███       | 3/10 [00:08<00:19,  2.80s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.908, 'compress@10': 0.5504, 'time@10': 4.2191}:  30%|███       | 3/10 [00:12<00:19,  2.80s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.908, 'compress@10': 0.5504, 'time@10': 4.2191}:  40%|████      | 4/10 [00:12<00:19,  3.22s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0164, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9066, 'compress@10': 0.6403, 'time@10': 5.0754}:  40%|████      | 4/10 [00:16<00:19,  3.22s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0164, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9066, 'compress@10': 0.6403, 'time@10': 5.0754}:  50%|█████     | 5/10 [00:16<00:18,  3.61s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0185, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9199, 'compress@10': 0.7002, 'time@10': 5.2437}:  50%|█████     | 5/10 [00:23<00:18,  3.61s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0185, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9199, 'compress@10': 0.7002, 'time@10': 5.2437}:  60%|██████    | 6/10 [00:23<00:17,  4.46s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0187, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9239, 'compress@10': 0.7426, 'time@10': 5.4509}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0187, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9239, 'compress@10': 0.7426, 'time@10': 5.4509}:  70%|███████   | 7/10 [00:26<00:12,  4.11s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9263, 'compress@10': 0.6732, 'time@10': 5.3273}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9263, 'compress@10': 0.6732, 'time@10': 5.3273}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9473, 'compress@10': 0.7044, 'time@10': 5.6731}:  80%|████████  | 8/10 [00:35<00:08,  4.24s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9473, 'compress@10': 0.7044, 'time@10': 5.6731}:  90%|█████████ | 9/10 [00:35<00:04,  4.24s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9501, 'compress@10': 0.7335, 'time@10': 5.7135}:  90%|█████████ | 9/10 [00:41<00:04,  4.24s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9501, 'compress@10': 0.7335, 'time@10': 5.7135}: 100%|██████████| 10/10 [00:41<00:00,  4.82s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9501, 'compress@10': 0.7335, 'time@10': 5.7135}: 100%|██████████| 10/10 [00:41<00:00,  4.13s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.01948309641993987
Avg hit ratio: 0.9096243810895762
Avg ndcg: 0.9500589817080065
Avg compression ratio: 0.733484532562777
Avg train time: 5.713515138626098
Std train time: 1.689283003621244
[0.87037037037037, 0.38888888888888895, 0.05555555555555555, 0.9814814814814813, 0.9814814814814813, 0.9444444444444443, 0.7962962962962962, 0.5, 0.6851851851851853, 0.7222222222222224]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8239, 'compress@10': 0.9996, 'time@10': 5.074}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8239, 'compress@10': 0.9996, 'time@10': 5.074}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.893, 'ndcg@10': 0.8918, 'compress@10': 0.5378, 'time@10': 4.7243}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.893, 'ndcg@10': 0.8918, 'compress@10': 0.5378, 'time@10': 4.7243}:  20%|██        | 2/10 [00:06<00:29,  3.66s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.8803, 'compress@10': 0.4062, 'time@10': 4.316}:  20%|██        | 2/10 [00:08<00:29,  3.66s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.8803, 'compress@10': 0.4062, 'time@10': 4.316}:  30%|███       | 3/10 [00:08<00:19,  2.80s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8882, 'compress@10': 0.5546, 'time@10': 4.1536}:  30%|███       | 3/10 [00:12<00:19,  2.80s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8882, 'compress@10': 0.5546, 'time@10': 4.1536}:  40%|████      | 4/10 [00:12<00:18,  3.16s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8894, 'compress@10': 0.6437, 'time@10': 4.7944}:  40%|████      | 4/10 [00:16<00:18,  3.16s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8894, 'compress@10': 0.6437, 'time@10': 4.7944}:  50%|█████     | 5/10 [00:16<00:16,  3.36s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.019, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9028, 'compress@10': 0.7031, 'time@10': 4.8655}:  50%|█████     | 5/10 [00:21<00:16,  3.36s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.019, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9028, 'compress@10': 0.7031, 'time@10': 4.8655}:  60%|██████    | 6/10 [00:21<00:16,  4.01s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9002, 'compress@10': 0.7451, 'time@10': 5.0258}:  60%|██████    | 6/10 [00:24<00:16,  4.01s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9002, 'compress@10': 0.7451, 'time@10': 5.0258}:  70%|███████   | 7/10 [00:24<00:11,  3.69s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0204, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9062, 'compress@10': 0.6859, 'time@10': 4.9288}:  70%|███████   | 7/10 [00:28<00:11,  3.69s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0204, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9062, 'compress@10': 0.6859, 'time@10': 4.9288}:  80%|████████  | 8/10 [00:28<00:07,  3.88s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0208, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9083, 'compress@10': 0.716, 'time@10': 5.3007}:  80%|████████  | 8/10 [00:32<00:07,  3.88s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0208, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9083, 'compress@10': 0.716, 'time@10': 5.3007}:  90%|█████████ | 9/10 [00:32<00:03,  3.97s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9081, 'compress@10': 0.7434, 'time@10': 5.3473}:  90%|█████████ | 9/10 [00:38<00:03,  3.97s/it]  {'epoch': 26, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9081, 'compress@10': 0.7434, 'time@10': 5.3473}: 100%|██████████| 10/10 [00:38<00:00,  4.54s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9081, 'compress@10': 0.7434, 'time@10': 5.3473}: 100%|██████████| 10/10 [00:38<00:00,  3.88s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.022289059559272954
Avg hit ratio: 0.8863985746379635
Avg ndcg: 0.9081369914133788
Avg compression ratio: 0.7434484492380732
Avg train time: 5.347254133224487
Std train time: 1.472523897135003
[0.8749999999999997, 0.37500000000000006, 0.05357142857142857, 0.982142857142857, 0.982142857142857, 0.9107142857142856, 0.8035714285714285, 0.5178571428571429, 0.6964285714285716, 0.7321428571428573]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9205, 'compress@10': 0.9996, 'time@10': 4.8892}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9205, 'compress@10': 0.9996, 'time@10': 4.8892}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9412, 'compress@10': 0.5332, 'time@10': 4.4307}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it]  {'epoch': 27, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9412, 'compress@10': 0.5332, 'time@10': 4.4307}:  20%|██        | 2/10 [00:06<00:27,  3.38s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9132, 'compress@10': 0.4031, 'time@10': 4.0951}:  20%|██        | 2/10 [00:08<00:27,  3.38s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9132, 'compress@10': 0.4031, 'time@10': 4.0951}:  30%|███       | 3/10 [00:08<00:18,  2.64s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9178, 'compress@10': 0.5523, 'time@10': 4.0184}:  30%|███       | 3/10 [00:12<00:18,  2.64s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9178, 'compress@10': 0.5523, 'time@10': 4.0184}:  40%|████      | 4/10 [00:12<00:18,  3.11s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.014, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.9147, 'compress@10': 0.6419, 'time@10': 4.9263}:  40%|████      | 4/10 [00:16<00:18,  3.11s/it] {'epoch': 27, 'num_users': 5.8, 'loss': 0.014, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.9147, 'compress@10': 0.6419, 'time@10': 4.9263}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0185, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9267, 'compress@10': 0.7015, 'time@10': 5.1305}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0185, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9267, 'compress@10': 0.7015, 'time@10': 5.1305}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0176, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9287, 'compress@10': 0.7439, 'time@10': 5.3536}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0176, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9287, 'compress@10': 0.7439, 'time@10': 5.3536}:  70%|███████   | 7/10 [00:26<00:12,  4.11s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9291, 'compress@10': 0.7059, 'time@10': 5.2391}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9291, 'compress@10': 0.7059, 'time@10': 5.2391}:  80%|████████  | 8/10 [00:30<00:08,  4.23s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9326, 'compress@10': 0.7351, 'time@10': 5.6013}:  80%|████████  | 8/10 [00:34<00:08,  4.23s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9326, 'compress@10': 0.7351, 'time@10': 5.6013}:  90%|█████████ | 9/10 [00:34<00:04,  4.24s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.882, 'ndcg@10': 0.937, 'compress@10': 0.7605, 'time@10': 5.6541}:  90%|█████████ | 9/10 [00:40<00:04,  4.24s/it]     {'epoch': 27, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.882, 'ndcg@10': 0.937, 'compress@10': 0.7605, 'time@10': 5.6541}: 100%|██████████| 10/10 [00:40<00:00,  4.84s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.882, 'ndcg@10': 0.937, 'compress@10': 0.7605, 'time@10': 5.6541}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.015203227346407448
Avg hit ratio: 0.881970003209392
Avg ndcg: 0.9369746368929015
Avg compression ratio: 0.7605303384836629
Avg train time: 5.65411102771759
Std train time: 1.7726749566800908
[0.8793103448275859, 0.3965517241379311, 0.05172413793103448, 0.982758620689655, 0.982758620689655, 0.9137931034482757, 0.8103448275862069, 0.5344827586206897, 0.6724137931034485, 0.7068965517241381]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8628, 'compress@10': 0.9996, 'time@10': 5.0864}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8628, 'compress@10': 0.9996, 'time@10': 5.0864}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9121, 'compress@10': 0.5414, 'time@10': 4.6895}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9121, 'compress@10': 0.5414, 'time@10': 4.6895}:  20%|██        | 2/10 [00:06<00:28,  3.62s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.8938, 'compress@10': 0.4085, 'time@10': 4.2974}:  20%|██        | 2/10 [00:08<00:28,  3.62s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.8938, 'compress@10': 0.4085, 'time@10': 4.2974}:  30%|███       | 3/10 [00:08<00:19,  2.79s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9024, 'compress@10': 0.5564, 'time@10': 4.1803}:  30%|███       | 3/10 [00:12<00:19,  2.79s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9024, 'compress@10': 0.5564, 'time@10': 4.1803}:  40%|████      | 4/10 [00:12<00:19,  3.21s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9008, 'compress@10': 0.6451, 'time@10': 5.0156}:  40%|████      | 4/10 [00:16<00:19,  3.21s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9008, 'compress@10': 0.6451, 'time@10': 5.0156}:  50%|█████     | 5/10 [00:16<00:17,  3.58s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9119, 'compress@10': 0.7042, 'time@10': 5.2109}:  50%|█████     | 5/10 [00:23<00:17,  3.58s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9119, 'compress@10': 0.7042, 'time@10': 5.2109}:  60%|██████    | 6/10 [00:23<00:17,  4.48s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9178, 'compress@10': 0.7462, 'time@10': 5.3976}:  60%|██████    | 6/10 [00:26<00:17,  4.48s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9178, 'compress@10': 0.7462, 'time@10': 5.3976}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.921, 'compress@10': 0.729, 'time@10': 5.3052}:  70%|███████   | 7/10 [00:31<00:12,  4.09s/it]  {'epoch': 28, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.921, 'compress@10': 0.729, 'time@10': 5.3052}:  80%|████████  | 8/10 [00:31<00:08,  4.29s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9359, 'compress@10': 0.7534, 'time@10': 5.6437}:  80%|████████  | 8/10 [00:35<00:08,  4.29s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9359, 'compress@10': 0.7534, 'time@10': 5.6437}:  90%|█████████ | 9/10 [00:35<00:04,  4.26s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0205, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.939, 'compress@10': 0.776, 'time@10': 5.6844}:  90%|█████████ | 9/10 [00:41<00:04,  4.26s/it]    {'epoch': 28, 'num_users': 6.3, 'loss': 0.0205, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.939, 'compress@10': 0.776, 'time@10': 5.6844}: 100%|██████████| 10/10 [00:41<00:00,  4.83s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0205, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.939, 'compress@10': 0.776, 'time@10': 5.6844}: 100%|██████████| 10/10 [00:41<00:00,  4.13s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.02051621283932996
Avg hit ratio: 0.8951164445816397
Avg ndcg: 0.9389957061849625
Avg compression ratio: 0.7760180444401967
Avg train time: 5.684424257278442
Std train time: 1.6382849758403546
[0.883333333333333, 0.3833333333333334, 0.05, 0.9833333333333332, 0.9833333333333332, 0.9166666666666665, 0.7833333333333333, 0.55, 0.6833333333333336, 0.7166666666666669]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9117, 'compress@10': 0.9996, 'time@10': 5.1365}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9117, 'compress@10': 0.9996, 'time@10': 5.1365}:  10%|█         | 1/10 [00:02<00:23,  2.61s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9313, 'compress@10': 0.5366, 'time@10': 4.7435}:  10%|█         | 1/10 [00:06<00:23,  2.61s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9313, 'compress@10': 0.5366, 'time@10': 4.7435}:  20%|██        | 2/10 [00:06<00:29,  3.66s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9066, 'compress@10': 0.4053, 'time@10': 4.3554}:  20%|██        | 2/10 [00:08<00:29,  3.66s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9066, 'compress@10': 0.4053, 'time@10': 4.3554}:  30%|███       | 3/10 [00:08<00:19,  2.82s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.909, 'compress@10': 0.554, 'time@10': 4.2227}:  30%|███       | 3/10 [00:12<00:19,  2.82s/it]  {'epoch': 29, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.909, 'compress@10': 0.554, 'time@10': 4.2227}:  40%|████      | 4/10 [00:12<00:19,  3.31s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9094, 'compress@10': 0.6432, 'time@10': 5.0625}:  40%|████      | 4/10 [00:17<00:19,  3.31s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9094, 'compress@10': 0.6432, 'time@10': 5.0625}:  50%|█████     | 5/10 [00:17<00:18,  3.65s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9202, 'compress@10': 0.7026, 'time@10': 5.283}:  50%|█████     | 5/10 [00:23<00:18,  3.65s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9202, 'compress@10': 0.7026, 'time@10': 5.283}:  60%|██████    | 6/10 [00:23<00:18,  4.59s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9274, 'compress@10': 0.7445, 'time@10': 5.4439}:  60%|██████    | 6/10 [00:26<00:18,  4.59s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9274, 'compress@10': 0.7445, 'time@10': 5.4439}:  70%|███████   | 7/10 [00:26<00:12,  4.15s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.017, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9307, 'compress@10': 0.7366, 'time@10': 5.341}:  70%|███████   | 7/10 [00:31<00:12,  4.15s/it]  {'epoch': 29, 'num_users': 6.125, 'loss': 0.017, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9307, 'compress@10': 0.7366, 'time@10': 5.341}:  80%|████████  | 8/10 [00:31<00:08,  4.32s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9379, 'compress@10': 0.7614, 'time@10': 5.6938}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9379, 'compress@10': 0.7614, 'time@10': 5.6938}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9393, 'compress@10': 0.7836, 'time@10': 5.7448}:  90%|█████████ | 9/10 [00:42<00:04,  4.31s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9393, 'compress@10': 0.7836, 'time@10': 5.7448}: 100%|██████████| 10/10 [00:42<00:00,  4.91s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9393, 'compress@10': 0.7836, 'time@10': 5.7448}: 100%|██████████| 10/10 [00:42<00:00,  4.20s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.020553158343811974
Avg hit ratio: 0.8968501875411892
Avg ndcg: 0.9393368260344956
Avg compression ratio: 0.7836028118083433
Avg train time: 5.74480721950531
Std train time: 1.6692281192603529
[0.854838709677419, 0.403225806451613, 0.048387096774193554, 0.9838709677419353, 0.9838709677419353, 0.9193548387096773, 0.7903225806451613, 0.5322580645161291, 0.6935483870967745, 0.7258064516129035]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9161, 'compress@10': 0.9993, 'time@10': 5.3982}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9161, 'compress@10': 0.9993, 'time@10': 5.3982}:  10%|█         | 1/10 [00:02<00:24,  2.74s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9383, 'compress@10': 0.5471, 'time@10': 4.9445}:  10%|█         | 1/10 [00:07<00:24,  2.74s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9383, 'compress@10': 0.5471, 'time@10': 4.9445}:  20%|██        | 2/10 [00:07<00:30,  3.79s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9112, 'compress@10': 0.4123, 'time@10': 4.492}:  20%|██        | 2/10 [00:09<00:30,  3.79s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9112, 'compress@10': 0.4123, 'time@10': 4.492}:  30%|███       | 3/10 [00:09<00:20,  2.90s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9163, 'compress@10': 0.5592, 'time@10': 4.3567}:  30%|███       | 3/10 [00:13<00:20,  2.90s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9163, 'compress@10': 0.5592, 'time@10': 4.3567}:  40%|████      | 4/10 [00:13<00:19,  3.33s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9146, 'compress@10': 0.6474, 'time@10': 5.0833}:  40%|████      | 4/10 [00:17<00:19,  3.33s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9146, 'compress@10': 0.6474, 'time@10': 5.0833}:  50%|█████     | 5/10 [00:17<00:17,  3.58s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0149, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9225, 'compress@10': 0.7061, 'time@10': 5.2745}:  50%|█████     | 5/10 [00:23<00:17,  3.58s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0149, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9225, 'compress@10': 0.7061, 'time@10': 5.2745}:  60%|██████    | 6/10 [00:23<00:17,  4.50s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0174, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9227, 'compress@10': 0.7477, 'time@10': 5.3884}:  60%|██████    | 6/10 [00:26<00:17,  4.50s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0174, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9227, 'compress@10': 0.7477, 'time@10': 5.3884}:  70%|███████   | 7/10 [00:26<00:12,  4.03s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9283, 'compress@10': 0.7286, 'time@10': 5.2841}:  70%|███████   | 7/10 [00:31<00:12,  4.03s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9283, 'compress@10': 0.7286, 'time@10': 5.2841}:  80%|████████  | 8/10 [00:31<00:08,  4.21s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0179, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9234, 'compress@10': 0.755, 'time@10': 5.5526}:  80%|████████  | 8/10 [00:34<00:08,  4.21s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0179, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9234, 'compress@10': 0.755, 'time@10': 5.5526}:  90%|█████████ | 9/10 [00:34<00:04,  4.12s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9287, 'compress@10': 0.7777, 'time@10': 5.5434}:  90%|█████████ | 9/10 [00:40<00:04,  4.12s/it]  {'epoch': 30, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9287, 'compress@10': 0.7777, 'time@10': 5.5434}: 100%|██████████| 10/10 [00:40<00:00,  4.54s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9287, 'compress@10': 0.7777, 'time@10': 5.5434}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.016527962574419422
Avg hit ratio: 0.8903985746379635
Avg ndcg: 0.9287037155788083
Avg compression ratio: 0.7777454203831906
Avg train time: 5.543424415588379
Std train time: 1.4095374798070486
[0.8593749999999997, 0.3906250000000001, 0.04687500000000001, 0.9843749999999998, 0.9843749999999998, 0.9218749999999999, 0.796875, 0.5468750000000001, 0.7031250000000002, 0.7031250000000002]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9231, 'compress@10': 0.9994, 'time@10': 5.2009}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9231, 'compress@10': 0.9994, 'time@10': 5.2009}:  10%|█         | 1/10 [00:02<00:23,  2.64s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9425, 'compress@10': 0.5395, 'time@10': 4.7477}:  10%|█         | 1/10 [00:06<00:23,  2.64s/it] {'epoch': 31, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9425, 'compress@10': 0.5395, 'time@10': 4.7477}:  20%|██        | 2/10 [00:06<00:29,  3.64s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.914, 'compress@10': 0.4073, 'time@10': 4.2658}:  20%|██        | 2/10 [00:08<00:29,  3.64s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.914, 'compress@10': 0.4073, 'time@10': 4.2658}:  30%|███       | 3/10 [00:08<00:19,  2.75s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.9173, 'compress@10': 0.5555, 'time@10': 4.09}:  30%|███       | 3/10 [00:12<00:19,  2.75s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.9173, 'compress@10': 0.5555, 'time@10': 4.09}:  40%|████      | 4/10 [00:12<00:18,  3.09s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.9162, 'compress@10': 0.6444, 'time@10': 4.8282}:  40%|████      | 4/10 [00:16<00:18,  3.09s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.9162, 'compress@10': 0.6444, 'time@10': 4.8282}:  50%|█████     | 5/10 [00:16<00:16,  3.39s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.93, 'compress@10': 0.7036, 'time@10': 5.0083}:  50%|█████     | 5/10 [00:22<00:16,  3.39s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.93, 'compress@10': 0.7036, 'time@10': 5.0083}:  60%|██████    | 6/10 [00:22<00:17,  4.26s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9315, 'compress@10': 0.7457, 'time@10': 5.2419}:  60%|██████    | 6/10 [00:25<00:17,  4.26s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9315, 'compress@10': 0.7457, 'time@10': 5.2419}:  70%|███████   | 7/10 [00:25<00:11,  3.97s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.888, 'ndcg@10': 0.934, 'compress@10': 0.7386, 'time@10': 5.1708}:  70%|███████   | 7/10 [00:30<00:11,  3.97s/it]   {'epoch': 31, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.888, 'ndcg@10': 0.934, 'compress@10': 0.7386, 'time@10': 5.1708}:  80%|████████  | 8/10 [00:30<00:08,  4.20s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9381, 'compress@10': 0.7656, 'time@10': 5.563}:  80%|████████  | 8/10 [00:34<00:08,  4.20s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9381, 'compress@10': 0.7656, 'time@10': 5.563}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.936, 'compress@10': 0.7867, 'time@10': 5.6118}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]  {'epoch': 31, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.936, 'compress@10': 0.7867, 'time@10': 5.6118}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.936, 'compress@10': 0.7867, 'time@10': 5.6118}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.017665699280515347
Avg hit ratio: 0.8852557174951062
Avg ndcg: 0.9360480645828215
Avg compression ratio: 0.7866915139269731
Avg train time: 5.61176290512085
Std train time: 1.6707266848700728
[0.8636363636363633, 0.3787878787878789, 0.04545454545454546, 0.9848484848484846, 0.9848484848484846, 0.9242424242424241, 0.803030303030303, 0.5303030303030304, 0.7121212121212124, 0.7121212121212124]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9201, 'compress@10': 0.9994, 'time@10': 5.1108}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9201, 'compress@10': 0.9994, 'time@10': 5.1108}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.893, 'ndcg@10': 0.941, 'compress@10': 0.5353, 'time@10': 4.6803}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it]  {'epoch': 32, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.893, 'ndcg@10': 0.941, 'compress@10': 0.5353, 'time@10': 4.6803}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.913, 'compress@10': 0.4045, 'time@10': 4.3131}:  20%|██        | 2/10 [00:08<00:28,  3.59s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.913, 'compress@10': 0.4045, 'time@10': 4.3131}:  30%|███       | 3/10 [00:08<00:19,  2.79s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9176, 'compress@10': 0.5533, 'time@10': 4.1813}:  30%|███       | 3/10 [00:12<00:19,  2.79s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9176, 'compress@10': 0.5533, 'time@10': 4.1813}:  40%|████      | 4/10 [00:12<00:19,  3.20s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9183, 'compress@10': 0.6427, 'time@10': 4.9632}:  40%|████      | 4/10 [00:16<00:19,  3.20s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9183, 'compress@10': 0.6427, 'time@10': 4.9632}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9273, 'compress@10': 0.7022, 'time@10': 5.135}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9273, 'compress@10': 0.7022, 'time@10': 5.135}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.931, 'compress@10': 0.7445, 'time@10': 5.3693}:  60%|██████    | 6/10 [00:26<00:17,  4.37s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.931, 'compress@10': 0.7445, 'time@10': 5.3693}:  70%|███████   | 7/10 [00:26<00:12,  4.06s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9383, 'compress@10': 0.7228, 'time@10': 5.2781}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9383, 'compress@10': 0.7228, 'time@10': 5.2781}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9606, 'compress@10': 0.7515, 'time@10': 5.7147}:  80%|████████  | 8/10 [00:35<00:08,  4.26s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9606, 'compress@10': 0.7515, 'time@10': 5.7147}:  90%|█████████ | 9/10 [00:35<00:04,  4.38s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.9623, 'compress@10': 0.7743, 'time@10': 5.7561}:  90%|█████████ | 9/10 [00:41<00:04,  4.38s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.9623, 'compress@10': 0.7743, 'time@10': 5.7561}: 100%|██████████| 10/10 [00:41<00:00,  4.93s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.9623, 'compress@10': 0.7743, 'time@10': 5.7561}: 100%|██████████| 10/10 [00:41<00:00,  4.16s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.015679946586885058
Avg hit ratio: 0.9001763524157413
Avg ndcg: 0.9622533854771724
Avg compression ratio: 0.7742682863908656
Avg train time: 5.756088590621948
Std train time: 1.765144667833149
[0.8676470588235291, 0.39705882352941185, 0.04411764705882354, 0.9852941176470587, 0.9852941176470587, 0.8970588235294116, 0.8088235294117646, 0.5441176470588236, 0.7205882352941179, 0.6911764705882355]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.894, 'compress@10': 0.9995, 'time@10': 5.0901}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.894, 'compress@10': 0.9995, 'time@10': 5.0901}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9251, 'compress@10': 0.5418, 'time@10': 4.6762}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9251, 'compress@10': 0.5418, 'time@10': 4.6762}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9025, 'compress@10': 0.4089, 'time@10': 4.3046}:  20%|██        | 2/10 [00:08<00:28,  3.59s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9025, 'compress@10': 0.4089, 'time@10': 4.3046}:  30%|███       | 3/10 [00:08<00:19,  2.78s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.776, 'ndcg@10': 0.9097, 'compress@10': 0.5566, 'time@10': 4.1639}:  30%|███       | 3/10 [00:12<00:19,  2.78s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.776, 'ndcg@10': 0.9097, 'compress@10': 0.5566, 'time@10': 4.1639}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.8168, 'ndcg@10': 0.9124, 'compress@10': 0.6453, 'time@10': 4.9588}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.8168, 'ndcg@10': 0.9124, 'compress@10': 0.6453, 'time@10': 4.9588}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.9225, 'compress@10': 0.7044, 'time@10': 5.1178}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.9225, 'compress@10': 0.7044, 'time@10': 5.1178}:  60%|██████    | 6/10 [00:22<00:17,  4.34s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0175, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.9284, 'compress@10': 0.7463, 'time@10': 5.3743}:  60%|██████    | 6/10 [00:26<00:17,  4.34s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0175, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.9284, 'compress@10': 0.7463, 'time@10': 5.3743}:  70%|███████   | 7/10 [00:26<00:12,  4.07s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9325, 'compress@10': 0.733, 'time@10': 5.2777}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]  {'epoch': 33, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9325, 'compress@10': 0.733, 'time@10': 5.2777}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0199, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9274, 'compress@10': 0.7608, 'time@10': 5.6777}:  80%|████████  | 8/10 [00:35<00:08,  4.25s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0199, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9274, 'compress@10': 0.7608, 'time@10': 5.6777}:  90%|█████████ | 9/10 [00:35<00:04,  4.32s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0215, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9352, 'compress@10': 0.7821, 'time@10': 5.7161}:  90%|█████████ | 9/10 [00:41<00:04,  4.32s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0215, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9352, 'compress@10': 0.7821, 'time@10': 5.7161}: 100%|██████████| 10/10 [00:41<00:00,  4.87s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0215, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9352, 'compress@10': 0.7821, 'time@10': 5.7161}: 100%|██████████| 10/10 [00:41<00:00,  4.13s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.02154566882069818
Avg hit ratio: 0.8748307302959255
Avg ndcg: 0.9351691393407269
Avg compression ratio: 0.7820873759952114
Avg train time: 5.716062307357788
Std train time: 1.7245038537825554
[0.8714285714285711, 0.41428571428571437, 0.042857142857142864, 0.9857142857142855, 0.9857142857142855, 0.8714285714285712, 0.8142857142857142, 0.5285714285714286, 0.7285714285714288, 0.7000000000000002]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9152, 'compress@10': 0.9996, 'time@10': 5.1497}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9152, 'compress@10': 0.9996, 'time@10': 5.1497}:  10%|█         | 1/10 [00:02<00:23,  2.62s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.931, 'compress@10': 0.5527, 'time@10': 4.7017}:  10%|█         | 1/10 [00:06<00:23,  2.62s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.931, 'compress@10': 0.5527, 'time@10': 4.7017}:  20%|██        | 2/10 [00:06<00:29,  3.63s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9064, 'compress@10': 0.4161, 'time@10': 4.3505}:  20%|██        | 2/10 [00:08<00:29,  3.63s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9064, 'compress@10': 0.4161, 'time@10': 4.3505}:  30%|███       | 3/10 [00:08<00:19,  2.82s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.7849, 'ndcg@10': 0.9139, 'compress@10': 0.5621, 'time@10': 4.189}:  30%|███       | 3/10 [00:12<00:19,  2.82s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.7849, 'ndcg@10': 0.9139, 'compress@10': 0.5621, 'time@10': 4.189}:  40%|████      | 4/10 [00:12<00:19,  3.19s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.824, 'ndcg@10': 0.9164, 'compress@10': 0.6496, 'time@10': 4.9958}:  40%|████      | 4/10 [00:16<00:19,  3.19s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.824, 'ndcg@10': 0.9164, 'compress@10': 0.6496, 'time@10': 4.9958}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.017, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.9217, 'compress@10': 0.708, 'time@10': 5.1537}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.017, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.9217, 'compress@10': 0.708, 'time@10': 5.1537}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.9271, 'compress@10': 0.7495, 'time@10': 5.3905}:  60%|██████    | 6/10 [00:26<00:17,  4.37s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.9271, 'compress@10': 0.7495, 'time@10': 5.3905}:  70%|███████   | 7/10 [00:26<00:12,  4.07s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9322, 'compress@10': 0.7278, 'time@10': 5.3022}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9322, 'compress@10': 0.7278, 'time@10': 5.3022}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.9356, 'compress@10': 0.7561, 'time@10': 5.689}:  80%|████████  | 8/10 [00:35<00:08,  4.29s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.9356, 'compress@10': 0.7561, 'time@10': 5.689}:  90%|█████████ | 9/10 [00:35<00:04,  4.33s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9377, 'compress@10': 0.7782, 'time@10': 5.6417}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]  {'epoch': 34, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9377, 'compress@10': 0.7782, 'time@10': 5.6417}: 100%|██████████| 10/10 [00:40<00:00,  4.63s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9377, 'compress@10': 0.7782, 'time@10': 5.6417}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.015663871071484054
Avg hit ratio: 0.8784021588673541
Avg ndcg: 0.9377162272259751
Avg compression ratio: 0.778211540460328
Avg train time: 5.641747903823853
Std train time: 1.7025634251228612
[0.8749999999999997, 0.43055555555555564, 0.04166666666666667, 0.9861111111111109, 0.9861111111111109, 0.8749999999999998, 0.8194444444444443, 0.513888888888889, 0.7083333333333335, 0.7083333333333335]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.9996, 'time@10': 4.6605}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.9996, 'time@10': 4.6605}:  10%|█         | 1/10 [00:02<00:21,  2.37s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9384, 'compress@10': 0.5644, 'time@10': 4.2878}:  10%|█         | 1/10 [00:06<00:21,  2.37s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9384, 'compress@10': 0.5644, 'time@10': 4.2878}:  20%|██        | 2/10 [00:06<00:26,  3.31s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9113, 'compress@10': 0.4239, 'time@10': 3.9111}:  20%|██        | 2/10 [00:07<00:26,  3.31s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9113, 'compress@10': 0.4239, 'time@10': 3.9111}:  30%|███       | 3/10 [00:07<00:17,  2.54s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.919, 'compress@10': 0.5679, 'time@10': 3.783}:  30%|███       | 3/10 [00:11<00:17,  2.54s/it]  {'epoch': 35, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.919, 'compress@10': 0.5679, 'time@10': 3.783}:  40%|████      | 4/10 [00:11<00:17,  2.89s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9207, 'compress@10': 0.6543, 'time@10': 4.6665}:  40%|████      | 4/10 [00:15<00:17,  2.89s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9207, 'compress@10': 0.6543, 'time@10': 4.6665}:  50%|█████     | 5/10 [00:15<00:16,  3.34s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9297, 'compress@10': 0.7119, 'time@10': 4.8989}:  50%|█████     | 5/10 [00:21<00:16,  3.34s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9297, 'compress@10': 0.7119, 'time@10': 4.8989}:  60%|██████    | 6/10 [00:21<00:17,  4.28s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9325, 'compress@10': 0.7529, 'time@10': 5.1181}:  60%|██████    | 6/10 [00:24<00:17,  4.28s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9325, 'compress@10': 0.7529, 'time@10': 5.1181}:  70%|███████   | 7/10 [00:24<00:11,  3.95s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9364, 'compress@10': 0.7167, 'time@10': 5.0538}:  70%|███████   | 7/10 [00:29<00:11,  3.95s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9364, 'compress@10': 0.7167, 'time@10': 5.0538}:  80%|████████  | 8/10 [00:29<00:08,  4.17s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0143, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.957, 'compress@10': 0.7463, 'time@10': 5.4333}:  80%|████████  | 8/10 [00:33<00:08,  4.17s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0143, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.957, 'compress@10': 0.7463, 'time@10': 5.4333}:  90%|█████████ | 9/10 [00:33<00:04,  4.20s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9586, 'compress@10': 0.7694, 'time@10': 5.4687}:  90%|█████████ | 9/10 [00:39<00:04,  4.20s/it]  {'epoch': 35, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9586, 'compress@10': 0.7694, 'time@10': 5.4687}: 100%|██████████| 10/10 [00:39<00:00,  4.70s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9586, 'compress@10': 0.7694, 'time@10': 5.4687}: 100%|██████████| 10/10 [00:39<00:00,  3.96s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.014094019813130368
Avg hit ratio: 0.9099331368499449
Avg ndcg: 0.9585728616305305
Avg compression ratio: 0.7694447668272762
Avg train time: 5.468667149543762
Std train time: 1.7688827193065355
[0.851351351351351, 0.44594594594594605, 0.04054054054054054, 0.9864864864864863, 0.9864864864864863, 0.8513513513513511, 0.8243243243243242, 0.5270270270270271, 0.7162162162162163, 0.7162162162162163]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9271, 'compress@10': 0.9993, 'time@10': 5.1413}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9271, 'compress@10': 0.9993, 'time@10': 5.1413}:  10%|█         | 1/10 [00:02<00:23,  2.61s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9358, 'compress@10': 0.5776, 'time@10': 4.7162}:  10%|█         | 1/10 [00:06<00:23,  2.61s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9358, 'compress@10': 0.5776, 'time@10': 4.7162}:  20%|██        | 2/10 [00:06<00:28,  3.62s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9096, 'compress@10': 0.4327, 'time@10': 4.3252}:  20%|██        | 2/10 [00:08<00:28,  3.62s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9096, 'compress@10': 0.4327, 'time@10': 4.3252}:  30%|███       | 3/10 [00:08<00:19,  2.80s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9165, 'compress@10': 0.5745, 'time@10': 4.1407}:  30%|███       | 3/10 [00:12<00:19,  2.80s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9165, 'compress@10': 0.5745, 'time@10': 4.1407}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9205, 'compress@10': 0.6596, 'time@10': 4.9924}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9205, 'compress@10': 0.6596, 'time@10': 4.9924}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9297, 'compress@10': 0.7162, 'time@10': 5.1452}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9297, 'compress@10': 0.7162, 'time@10': 5.1452}:  60%|██████    | 6/10 [00:22<00:17,  4.35s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9333, 'compress@10': 0.7566, 'time@10': 5.3738}:  60%|██████    | 6/10 [00:25<00:17,  4.35s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9333, 'compress@10': 0.7566, 'time@10': 5.3738}:  70%|███████   | 7/10 [00:25<00:12,  4.04s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9386, 'compress@10': 0.7315, 'time@10': 5.2451}:  70%|███████   | 7/10 [00:30<00:12,  4.04s/it]  {'epoch': 36, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9386, 'compress@10': 0.7315, 'time@10': 5.2451}:  80%|████████  | 8/10 [00:30<00:08,  4.15s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9341, 'compress@10': 0.7594, 'time@10': 5.6518}:  80%|████████  | 8/10 [00:34<00:08,  4.15s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9341, 'compress@10': 0.7594, 'time@10': 5.6518}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9342, 'compress@10': 0.7816, 'time@10': 5.6967}:  90%|█████████ | 9/10 [00:41<00:04,  4.26s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9342, 'compress@10': 0.7816, 'time@10': 5.6967}: 100%|██████████| 10/10 [00:41<00:00,  4.84s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9342, 'compress@10': 0.7816, 'time@10': 5.6967}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.018569204933154615
Avg hit ratio: 0.8981359018269035
Avg ndcg: 0.9341757142731548
Avg compression ratio: 0.7816110181511643
Avg train time: 5.696739935874939
Std train time: 1.7919452020445932
[0.8552631578947365, 0.4342105263157896, 0.03947368421052632, 0.9868421052631577, 0.9868421052631577, 0.8552631578947366, 0.8026315789473684, 0.5394736842105263, 0.7236842105263159, 0.7236842105263159]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9305, 'compress@10': 0.9994, 'time@10': 5.1569}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9305, 'compress@10': 0.9994, 'time@10': 5.1569}:  10%|█         | 1/10 [00:02<00:23,  2.62s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9284, 'compress@10': 0.567, 'time@10': 4.7773}:  10%|█         | 1/10 [00:07<00:23,  2.62s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9284, 'compress@10': 0.567, 'time@10': 4.7773}:  20%|██        | 2/10 [00:07<00:29,  3.69s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.7705, 'ndcg@10': 0.9046, 'compress@10': 0.4256, 'time@10': 4.377}:  20%|██        | 2/10 [00:08<00:29,  3.69s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.7705, 'ndcg@10': 0.9046, 'compress@10': 0.4256, 'time@10': 4.377}:  30%|███       | 3/10 [00:08<00:19,  2.84s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8011, 'ndcg@10': 0.9136, 'compress@10': 0.5692, 'time@10': 4.1757}:  30%|███       | 3/10 [00:12<00:19,  2.84s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8011, 'ndcg@10': 0.9136, 'compress@10': 0.5692, 'time@10': 4.1757}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9185, 'compress@10': 0.6554, 'time@10': 5.0345}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9185, 'compress@10': 0.6554, 'time@10': 5.0345}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9349, 'compress@10': 0.7127, 'time@10': 5.2225}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9349, 'compress@10': 0.7127, 'time@10': 5.2225}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9381, 'compress@10': 0.7535, 'time@10': 5.4618}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9381, 'compress@10': 0.7535, 'time@10': 5.4618}:  70%|███████   | 7/10 [00:26<00:12,  4.14s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9616, 'compress@10': 0.7355, 'time@10': 5.355}:  70%|███████   | 7/10 [00:31<00:12,  4.14s/it]  {'epoch': 37, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9616, 'compress@10': 0.7355, 'time@10': 5.355}:  80%|████████  | 8/10 [00:31<00:08,  4.31s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9617, 'compress@10': 0.7635, 'time@10': 5.7321}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9617, 'compress@10': 0.7635, 'time@10': 5.7321}:  90%|█████████ | 9/10 [00:35<00:04,  4.34s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9665, 'compress@10': 0.7854, 'time@10': 5.7707}:  90%|█████████ | 9/10 [00:41<00:04,  4.34s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9665, 'compress@10': 0.7854, 'time@10': 5.7707}: 100%|██████████| 10/10 [00:41<00:00,  4.90s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9665, 'compress@10': 0.7854, 'time@10': 5.7707}: 100%|██████████| 10/10 [00:41<00:00,  4.17s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.016449448564337728
Avg hit ratio: 0.8813617082785165
Avg ndcg: 0.966472869749077
Avg compression ratio: 0.7853829787405547
Avg train time: 5.770655584335327
Std train time: 1.7595714054290623
[0.8589743589743587, 0.44871794871794884, 0.038461538461538464, 0.987179487179487, 0.987179487179487, 0.8589743589743587, 0.7820512820512819, 0.5512820512820513, 0.7051282051282053, 0.730769230769231]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9252, 'compress@10': 0.9993, 'time@10': 5.0594}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9252, 'compress@10': 0.9993, 'time@10': 5.0594}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.0084, 'compress@10': 0.5875, 'time@10': 4.665}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.0084, 'compress@10': 0.5875, 'time@10': 4.665}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.958, 'compress@10': 0.4393, 'time@10': 4.2838}:  20%|██        | 2/10 [00:08<00:28,  3.59s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.958, 'compress@10': 0.4393, 'time@10': 4.2838}:  30%|███       | 3/10 [00:08<00:19,  2.78s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9562, 'compress@10': 0.5794, 'time@10': 4.117}:  30%|███       | 3/10 [00:12<00:19,  2.78s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9562, 'compress@10': 0.5794, 'time@10': 4.117}:  40%|████      | 4/10 [00:12<00:18,  3.12s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0189, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9507, 'compress@10': 0.6635, 'time@10': 4.9964}:  40%|████      | 4/10 [00:16<00:18,  3.12s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0189, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9507, 'compress@10': 0.6635, 'time@10': 4.9964}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0161, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9551, 'compress@10': 0.7196, 'time@10': 5.1533}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0161, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9551, 'compress@10': 0.7196, 'time@10': 5.1533}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9584, 'compress@10': 0.7593, 'time@10': 5.389}:  60%|██████    | 6/10 [00:26<00:17,  4.38s/it]  {'epoch': 38, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9584, 'compress@10': 0.7593, 'time@10': 5.389}:  70%|███████   | 7/10 [00:26<00:12,  4.07s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0176, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9555, 'compress@10': 0.7524, 'time@10': 5.288}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0176, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9555, 'compress@10': 0.7524, 'time@10': 5.288}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9756, 'compress@10': 0.7787, 'time@10': 5.6641}:  80%|████████  | 8/10 [00:35<00:08,  4.24s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9756, 'compress@10': 0.7787, 'time@10': 5.6641}:  90%|█████████ | 9/10 [00:35<00:04,  4.29s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9713, 'compress@10': 0.7994, 'time@10': 5.706}:  90%|█████████ | 9/10 [00:41<00:04,  4.29s/it]     {'epoch': 38, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9713, 'compress@10': 0.7994, 'time@10': 5.706}: 100%|██████████| 10/10 [00:41<00:00,  4.85s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9713, 'compress@10': 0.7994, 'time@10': 5.706}: 100%|██████████| 10/10 [00:41<00:00,  4.12s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.019660798342440017
Avg hit ratio: 0.9069735874387828
Avg ndcg: 0.9713441479321092
Avg compression ratio: 0.7994035472754473
Avg train time: 5.705968356132507
Std train time: 1.7596366878307668
[0.8374999999999997, 0.46250000000000013, 0.037500000000000006, 0.9874999999999998, 0.9874999999999998, 0.8374999999999997, 0.7874999999999999, 0.5625, 0.7125000000000001, 0.7375000000000002]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9211, 'compress@10': 0.9989, 'time@10': 5.1889}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9211, 'compress@10': 0.9989, 'time@10': 5.1889}:  10%|█         | 1/10 [00:02<00:23,  2.63s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9772, 'compress@10': 0.5808, 'time@10': 4.6462}:  10%|█         | 1/10 [00:06<00:23,  2.63s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9772, 'compress@10': 0.5808, 'time@10': 4.6462}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9372, 'compress@10': 0.4348, 'time@10': 4.1444}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9372, 'compress@10': 0.4348, 'time@10': 4.1444}:  30%|███       | 3/10 [00:08<00:18,  2.68s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9422, 'compress@10': 0.5761, 'time@10': 3.8937}:  30%|███       | 3/10 [00:11<00:18,  2.68s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9422, 'compress@10': 0.5761, 'time@10': 3.8937}:  40%|████      | 4/10 [00:11<00:17,  2.88s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9422, 'compress@10': 0.6609, 'time@10': 4.566}:  40%|████      | 4/10 [00:15<00:17,  2.88s/it] {'epoch': 39, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9422, 'compress@10': 0.6609, 'time@10': 4.566}:  50%|█████     | 5/10 [00:15<00:15,  3.16s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0181, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9522, 'compress@10': 0.7173, 'time@10': 4.6997}:  50%|█████     | 5/10 [00:20<00:15,  3.16s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0181, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9522, 'compress@10': 0.7173, 'time@10': 4.6997}:  60%|██████    | 6/10 [00:20<00:15,  3.93s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0173, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9521, 'compress@10': 0.7574, 'time@10': 4.9091}:  60%|██████    | 6/10 [00:23<00:15,  3.93s/it] {'epoch': 39, 'num_users': 6.2857, 'loss': 0.0173, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9521, 'compress@10': 0.7574, 'time@10': 4.9091}:  70%|███████   | 7/10 [00:23<00:10,  3.66s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9683, 'compress@10': 0.7499, 'time@10': 4.8577}:  70%|███████   | 7/10 [00:28<00:10,  3.66s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9683, 'compress@10': 0.7499, 'time@10': 4.8577}:  80%|████████  | 8/10 [00:28<00:07,  3.94s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9578, 'compress@10': 0.7765, 'time@10': 5.2974}:  80%|████████  | 8/10 [00:32<00:07,  3.94s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9578, 'compress@10': 0.7765, 'time@10': 5.2974}:  90%|█████████ | 9/10 [00:32<00:04,  4.10s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9593, 'compress@10': 0.7977, 'time@10': 5.3639}:  90%|█████████ | 9/10 [00:38<00:04,  4.10s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9593, 'compress@10': 0.7977, 'time@10': 5.3639}: 100%|██████████| 10/10 [00:38<00:00,  4.69s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9593, 'compress@10': 0.7977, 'time@10': 5.3639}: 100%|██████████| 10/10 [00:38<00:00,  3.89s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.020582214163017476
Avg hit ratio: 0.8998870539006363
Avg ndcg: 0.9593269389377699
Avg compression ratio: 0.7977356429795194
Avg train time: 5.36393895149231
Std train time: 1.6952563120514426
[0.817073170731707, 0.4756097560975611, 0.03658536585365854, 0.9878048780487804, 0.9878048780487804, 0.8414634146341461, 0.7682926829268292, 0.573170731707317, 0.7195121951219513, 0.7439024390243903]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.9984, 'time@10': 4.896}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.9984, 'time@10': 4.896}:  10%|█         | 1/10 [00:02<00:22,  2.49s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9781, 'compress@10': 0.6067, 'time@10': 4.5821}:  10%|█         | 1/10 [00:06<00:22,  2.49s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9781, 'compress@10': 0.6067, 'time@10': 4.5821}:  20%|██        | 2/10 [00:06<00:28,  3.57s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9378, 'compress@10': 0.4521, 'time@10': 4.1827}:  20%|██        | 2/10 [00:08<00:28,  3.57s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9378, 'compress@10': 0.4521, 'time@10': 4.1827}:  30%|███       | 3/10 [00:08<00:19,  2.74s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9411, 'compress@10': 0.5891, 'time@10': 3.9917}:  30%|███       | 3/10 [00:12<00:19,  2.74s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9411, 'compress@10': 0.5891, 'time@10': 3.9917}:  40%|████      | 4/10 [00:12<00:18,  3.02s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0129, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9415, 'compress@10': 0.6712, 'time@10': 4.83}:  40%|████      | 4/10 [00:16<00:18,  3.02s/it]  {'epoch': 40, 'num_users': 5.8, 'loss': 0.0129, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9415, 'compress@10': 0.6712, 'time@10': 4.83}:  50%|█████     | 5/10 [00:16<00:17,  3.42s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9504, 'compress@10': 0.7259, 'time@10': 5.0286}:  50%|█████     | 5/10 [00:22<00:17,  3.42s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9504, 'compress@10': 0.7259, 'time@10': 5.0286}:  60%|██████    | 6/10 [00:22<00:17,  4.32s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9512, 'compress@10': 0.7646, 'time@10': 5.2953}:  60%|██████    | 6/10 [00:25<00:17,  4.32s/it] {'epoch': 40, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9512, 'compress@10': 0.7646, 'time@10': 5.2953}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9543, 'compress@10': 0.7668, 'time@10': 5.2069}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9543, 'compress@10': 0.7668, 'time@10': 5.2069}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9556, 'compress@10': 0.7917, 'time@10': 5.5884}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9556, 'compress@10': 0.7917, 'time@10': 5.5884}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9578, 'compress@10': 0.8115, 'time@10': 5.638}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]    {'epoch': 40, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9578, 'compress@10': 0.8115, 'time@10': 5.638}: 100%|██████████| 10/10 [00:40<00:00,  4.85s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9578, 'compress@10': 0.8115, 'time@10': 5.638}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.010603440136830148
Avg hit ratio: 0.909195809661005
Avg ndcg: 0.9578075528396914
Avg compression ratio: 0.811459394757482
Avg train time: 5.637965202331543
Std train time: 1.7593377790536036
[0.8214285714285712, 0.48809523809523825, 0.03571428571428572, 0.988095238095238, 0.988095238095238, 0.845238095238095, 0.7738095238095237, 0.5833333333333333, 0.7023809523809524, 0.7261904761904763]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.9989, 'time@10': 5.264}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.9989, 'time@10': 5.264}:  10%|█         | 1/10 [00:02<00:24,  2.67s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9459, 'compress@10': 0.6262, 'time@10': 4.7911}:  10%|█         | 1/10 [00:07<00:24,  2.67s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9459, 'compress@10': 0.6262, 'time@10': 4.7911}:  20%|██        | 2/10 [00:07<00:29,  3.66s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0041, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9163, 'compress@10': 0.4651, 'time@10': 4.3934}:  20%|██        | 2/10 [00:08<00:29,  3.66s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0041, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9163, 'compress@10': 0.4651, 'time@10': 4.3934}:  30%|███       | 3/10 [00:08<00:19,  2.83s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9254, 'compress@10': 0.5988, 'time@10': 4.2164}:  30%|███       | 3/10 [00:12<00:19,  2.83s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9254, 'compress@10': 0.5988, 'time@10': 4.2164}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9292, 'compress@10': 0.679, 'time@10': 4.9686}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9292, 'compress@10': 0.679, 'time@10': 4.9686}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9376, 'compress@10': 0.7324, 'time@10': 5.1808}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9376, 'compress@10': 0.7324, 'time@10': 5.1808}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0095, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9406, 'compress@10': 0.7702, 'time@10': 5.4219}:  60%|██████    | 6/10 [00:26<00:17,  4.44s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0095, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9406, 'compress@10': 0.7702, 'time@10': 5.4219}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9103, 'ndcg@10': 0.957, 'compress@10': 0.7739, 'time@10': 5.3151}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9103, 'ndcg@10': 0.957, 'compress@10': 0.7739, 'time@10': 5.3151}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.96, 'compress@10': 0.7978, 'time@10': 5.6971}:  80%|████████  | 8/10 [00:35<00:08,  4.28s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.96, 'compress@10': 0.7978, 'time@10': 5.6971}:  90%|█████████ | 9/10 [00:35<00:04,  4.32s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9566, 'compress@10': 0.8169, 'time@10': 5.7434}:  90%|█████████ | 9/10 [00:41<00:04,  4.32s/it] {'epoch': 41, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9566, 'compress@10': 0.8169, 'time@10': 5.7434}: 100%|██████████| 10/10 [00:41<00:00,  4.90s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9566, 'compress@10': 0.8169, 'time@10': 5.7434}: 100%|██████████| 10/10 [00:41<00:00,  4.16s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.015391983934515885
Avg hit ratio: 0.9002557174951061
Avg ndcg: 0.9566019470443232
Avg compression ratio: 0.8169237565876741
Avg train time: 5.743369007110596
Std train time: 1.6798839002252903
[0.825581395348837, 0.47674418604651175, 0.034883720930232565, 0.9883720930232558, 0.9883720930232558, 0.8488372093023253, 0.755813953488372, 0.5930232558139534, 0.7093023255813954, 0.7325581395348838]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9252, 'compress@10': 0.9989, 'time@10': 5.1541}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9252, 'compress@10': 0.9989, 'time@10': 5.1541}:  10%|█         | 1/10 [00:02<00:23,  2.62s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0069, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9465, 'compress@10': 0.6118, 'time@10': 4.7346}:  10%|█         | 1/10 [00:06<00:23,  2.62s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0069, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9465, 'compress@10': 0.6118, 'time@10': 4.7346}:  20%|██        | 2/10 [00:06<00:29,  3.64s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0046, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9167, 'compress@10': 0.4555, 'time@10': 4.2592}:  20%|██        | 2/10 [00:08<00:29,  3.64s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0046, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9167, 'compress@10': 0.4555, 'time@10': 4.2592}:  30%|███       | 3/10 [00:08<00:19,  2.75s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9277, 'compress@10': 0.5916, 'time@10': 4.1176}:  30%|███       | 3/10 [00:12<00:19,  2.75s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9277, 'compress@10': 0.5916, 'time@10': 4.1176}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9323, 'compress@10': 0.6733, 'time@10': 4.8649}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9323, 'compress@10': 0.6733, 'time@10': 4.8649}:  50%|█████     | 5/10 [00:16<00:17,  3.44s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0091, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9397, 'compress@10': 0.7276, 'time@10': 5.1109}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0091, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9397, 'compress@10': 0.7276, 'time@10': 5.1109}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9424, 'compress@10': 0.7658, 'time@10': 5.3692}:  60%|██████    | 6/10 [00:26<00:17,  4.44s/it] {'epoch': 42, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9424, 'compress@10': 0.7658, 'time@10': 5.3692}:  70%|███████   | 7/10 [00:26<00:12,  4.14s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9435, 'compress@10': 0.777, 'time@10': 5.291}:  70%|███████   | 7/10 [00:31<00:12,  4.14s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9435, 'compress@10': 0.777, 'time@10': 5.291}:  80%|████████  | 8/10 [00:31<00:08,  4.34s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9533, 'compress@10': 0.8007, 'time@10': 5.6722}:  80%|████████  | 8/10 [00:35<00:08,  4.34s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9533, 'compress@10': 0.8007, 'time@10': 5.6722}:  90%|█████████ | 9/10 [00:35<00:04,  4.36s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9557, 'compress@10': 0.8194, 'time@10': 5.7136}:  90%|█████████ | 9/10 [00:41<00:04,  4.36s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9557, 'compress@10': 0.8194, 'time@10': 5.7136}: 100%|██████████| 10/10 [00:41<00:00,  4.91s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9557, 'compress@10': 0.8194, 'time@10': 5.7136}: 100%|██████████| 10/10 [00:41<00:00,  4.16s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.01231210219793951
Avg hit ratio: 0.9012593017244971
Avg ndcg: 0.9556770459770283
Avg compression ratio: 0.8194071963616281
Avg train time: 5.7136483669281
Std train time: 1.6939758374096079
[0.8295454545454544, 0.46590909090909105, 0.034090909090909095, 0.9886363636363636, 0.9886363636363636, 0.852272727272727, 0.7613636363636362, 0.6022727272727272, 0.7159090909090909, 0.7159090909090909]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9271, 'compress@10': 0.9991, 'time@10': 5.1286}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9271, 'compress@10': 0.9991, 'time@10': 5.1286}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9434, 'compress@10': 0.6005, 'time@10': 4.7287}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9434, 'compress@10': 0.6005, 'time@10': 4.7287}:  20%|██        | 2/10 [00:06<00:29,  3.64s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9147, 'compress@10': 0.448, 'time@10': 4.1772}:  20%|██        | 2/10 [00:08<00:29,  3.64s/it]   {'epoch': 43, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9147, 'compress@10': 0.448, 'time@10': 4.1772}:  30%|███       | 3/10 [00:08<00:18,  2.70s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9232, 'compress@10': 0.586, 'time@10': 4.0897}:  30%|███       | 3/10 [00:12<00:18,  2.70s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9232, 'compress@10': 0.586, 'time@10': 4.0897}:  40%|████      | 4/10 [00:12<00:18,  3.16s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9285, 'compress@10': 0.6688, 'time@10': 4.8309}:  40%|████      | 4/10 [00:16<00:18,  3.16s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9285, 'compress@10': 0.6688, 'time@10': 4.8309}:  50%|█████     | 5/10 [00:16<00:17,  3.45s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9437, 'compress@10': 0.7239, 'time@10': 5.0059}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9437, 'compress@10': 0.7239, 'time@10': 5.0059}:  60%|██████    | 6/10 [00:22<00:17,  4.29s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0219, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9568, 'compress@10': 0.7627, 'time@10': 5.1058}:  60%|██████    | 6/10 [00:25<00:17,  4.29s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0219, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9568, 'compress@10': 0.7627, 'time@10': 5.1058}:  70%|███████   | 7/10 [00:25<00:11,  3.83s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.9184, 'ndcg@10': 0.982, 'compress@10': 0.77, 'time@10': 4.983}:  70%|███████   | 7/10 [00:29<00:11,  3.83s/it]     {'epoch': 43, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.9184, 'ndcg@10': 0.982, 'compress@10': 0.77, 'time@10': 4.983}:  80%|████████  | 8/10 [00:29<00:07,  3.94s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0245, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9738, 'compress@10': 0.7946, 'time@10': 5.3676}:  80%|████████  | 8/10 [00:33<00:07,  3.94s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0245, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9738, 'compress@10': 0.7946, 'time@10': 5.3676}:  90%|█████████ | 9/10 [00:33<00:04,  4.04s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9742, 'compress@10': 0.8134, 'time@10': 5.378}:  90%|█████████ | 9/10 [00:39<00:04,  4.04s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9742, 'compress@10': 0.8134, 'time@10': 5.378}: 100%|██████████| 10/10 [00:39<00:00,  4.50s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9742, 'compress@10': 0.8134, 'time@10': 5.378}: 100%|██████████| 10/10 [00:39<00:00,  3.91s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.02246832683569301
Avg hit ratio: 0.909564473255475
Avg ndcg: 0.9741741151974553
Avg compression ratio: 0.8134329272461522
Avg train time: 5.378032374382019
Std train time: 1.6147330275662501
[0.8333333333333331, 0.4555555555555557, 0.03333333333333334, 0.9888888888888889, 0.9888888888888889, 0.8555555555555553, 0.7666666666666665, 0.611111111111111, 0.7222222222222222, 0.7000000000000001]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0071, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9326, 'compress@10': 0.9992, 'time@10': 5.2288}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0071, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9326, 'compress@10': 0.9992, 'time@10': 5.2288}:  10%|█         | 1/10 [00:02<00:23,  2.65s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9507, 'compress@10': 0.5885, 'time@10': 4.8006}:  10%|█         | 1/10 [00:07<00:23,  2.65s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9507, 'compress@10': 0.5885, 'time@10': 4.8006}:  20%|██        | 2/10 [00:07<00:29,  3.70s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9195, 'compress@10': 0.44, 'time@10': 4.3386}:  20%|██        | 2/10 [00:08<00:29,  3.70s/it]  {'epoch': 44, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9195, 'compress@10': 0.44, 'time@10': 4.3386}:  30%|███       | 3/10 [00:08<00:19,  2.81s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9299, 'compress@10': 0.58, 'time@10': 4.2112}:  30%|███       | 3/10 [00:12<00:19,  2.81s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9299, 'compress@10': 0.58, 'time@10': 4.2112}:  40%|████      | 4/10 [00:12<00:19,  3.23s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9342, 'compress@10': 0.664, 'time@10': 4.8738}:  40%|████      | 4/10 [00:16<00:19,  3.23s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9342, 'compress@10': 0.664, 'time@10': 4.8738}:  50%|█████     | 5/10 [00:16<00:17,  3.43s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9413, 'compress@10': 0.7199, 'time@10': 5.1131}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9413, 'compress@10': 0.7199, 'time@10': 5.1131}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0084, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.944, 'compress@10': 0.7594, 'time@10': 5.303}:  60%|██████    | 6/10 [00:26<00:17,  4.43s/it]  {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0084, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.944, 'compress@10': 0.7594, 'time@10': 5.303}:  70%|███████   | 7/10 [00:26<00:12,  4.04s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9466, 'compress@10': 0.7757, 'time@10': 5.2251}:  70%|███████   | 7/10 [00:30<00:12,  4.04s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9466, 'compress@10': 0.7757, 'time@10': 5.2251}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0098, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9498, 'compress@10': 0.7999, 'time@10': 5.6069}:  80%|████████  | 8/10 [00:35<00:08,  4.26s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0098, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9498, 'compress@10': 0.7999, 'time@10': 5.6069}:  90%|█████████ | 9/10 [00:35<00:04,  4.29s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9541, 'compress@10': 0.8182, 'time@10': 5.6548}:  90%|█████████ | 9/10 [00:41<00:04,  4.29s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9541, 'compress@10': 0.8182, 'time@10': 5.6548}: 100%|██████████| 10/10 [00:41<00:00,  4.86s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9541, 'compress@10': 0.8182, 'time@10': 5.6548}: 100%|██████████| 10/10 [00:41<00:00,  4.13s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.011864470642326146
Avg hit ratio: 0.8898307302959255
Avg ndcg: 0.9540856020536179
Avg compression ratio: 0.8181688733594307
Avg train time: 5.654756236076355
Std train time: 1.5778686252880176
[0.8369565217391303, 0.4673913043478262, 0.03260869565217392, 0.9891304347826088, 0.9891304347826088, 0.8369565217391302, 0.7499999999999998, 0.6195652173913043, 0.7282608695652174, 0.7065217391304348]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9265, 'compress@10': 0.9993, 'time@10': 5.1369}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9265, 'compress@10': 0.9993, 'time@10': 5.1369}:  10%|█         | 1/10 [00:02<00:23,  2.62s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9358, 'compress@10': 0.6084, 'time@10': 4.6645}:  10%|█         | 1/10 [00:06<00:23,  2.62s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9358, 'compress@10': 0.6084, 'time@10': 4.6645}:  20%|██        | 2/10 [00:06<00:28,  3.57s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9096, 'compress@10': 0.4532, 'time@10': 4.2787}:  20%|██        | 2/10 [00:08<00:28,  3.57s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9096, 'compress@10': 0.4532, 'time@10': 4.2787}:  30%|███       | 3/10 [00:08<00:19,  2.76s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.9225, 'compress@10': 0.5899, 'time@10': 4.1591}:  30%|███       | 3/10 [00:12<00:19,  2.76s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.9225, 'compress@10': 0.5899, 'time@10': 4.1591}:  40%|████      | 4/10 [00:12<00:19,  3.19s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.9285, 'compress@10': 0.6719, 'time@10': 4.9359}:  40%|████      | 4/10 [00:16<00:19,  3.19s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.9285, 'compress@10': 0.6719, 'time@10': 4.9359}:  50%|█████     | 5/10 [00:16<00:17,  3.50s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9364, 'compress@10': 0.7265, 'time@10': 5.1646}:  50%|█████     | 5/10 [00:22<00:17,  3.50s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9364, 'compress@10': 0.7265, 'time@10': 5.1646}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9396, 'compress@10': 0.7647, 'time@10': 5.4102}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9396, 'compress@10': 0.7647, 'time@10': 5.4102}:  70%|███████   | 7/10 [00:26<00:12,  4.15s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9459, 'compress@10': 0.7832, 'time@10': 5.3384}:  70%|███████   | 7/10 [00:31<00:12,  4.15s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9459, 'compress@10': 0.7832, 'time@10': 5.3384}:  80%|████████  | 8/10 [00:31<00:08,  4.38s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9409, 'compress@10': 0.8066, 'time@10': 5.7123}:  80%|████████  | 8/10 [00:35<00:08,  4.38s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9409, 'compress@10': 0.8066, 'time@10': 5.7123}:  90%|█████████ | 9/10 [00:35<00:04,  4.38s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9445, 'compress@10': 0.8242, 'time@10': 5.7507}:  90%|█████████ | 9/10 [00:41<00:04,  4.38s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9445, 'compress@10': 0.8242, 'time@10': 5.7507}: 100%|██████████| 10/10 [00:41<00:00,  4.93s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9445, 'compress@10': 0.8242, 'time@10': 5.7507}: 100%|██████████| 10/10 [00:41<00:00,  4.18s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.010811092930831595
Avg hit ratio: 0.8934252003420085
Avg ndcg: 0.9445360283544237
Avg compression ratio: 0.8242026590671292
Avg train time: 5.7506958723068236
Std train time: 1.6785800689492945
[0.8404255319148934, 0.4787234042553193, 0.03191489361702128, 0.9893617021276596, 0.9893617021276596, 0.8404255319148933, 0.7340425531914891, 0.6276595744680851, 0.7340425531914894, 0.6914893617021277]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.9993, 'time@10': 5.3167}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.9993, 'time@10': 5.3167}:  10%|█         | 1/10 [00:02<00:24,  2.70s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8769, 'ndcg@10': 1.0292, 'compress@10': 0.6229, 'time@10': 4.7674}:  10%|█         | 1/10 [00:06<00:24,  2.70s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8769, 'ndcg@10': 1.0292, 'compress@10': 0.6229, 'time@10': 4.7674}:  20%|██        | 2/10 [00:06<00:28,  3.62s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9719, 'compress@10': 0.4629, 'time@10': 4.4062}:  20%|██        | 2/10 [00:08<00:28,  3.62s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9719, 'compress@10': 0.4629, 'time@10': 4.4062}:  30%|███       | 3/10 [00:08<00:19,  2.82s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9688, 'compress@10': 0.5972, 'time@10': 4.2173}:  30%|███       | 3/10 [00:12<00:19,  2.82s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9688, 'compress@10': 0.5972, 'time@10': 4.2173}:  40%|████      | 4/10 [00:12<00:18,  3.17s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9666, 'compress@10': 0.6777, 'time@10': 5.0258}:  40%|████      | 4/10 [00:16<00:18,  3.17s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9666, 'compress@10': 0.6777, 'time@10': 5.0258}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0187, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9699, 'compress@10': 0.7313, 'time@10': 5.2412}:  50%|█████     | 5/10 [00:23<00:17,  3.53s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0187, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9699, 'compress@10': 0.7313, 'time@10': 5.2412}:  60%|██████    | 6/10 [00:23<00:17,  4.49s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0174, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9676, 'compress@10': 0.7686, 'time@10': 5.4152}:  60%|██████    | 6/10 [00:26<00:17,  4.49s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0174, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9676, 'compress@10': 0.7686, 'time@10': 5.4152}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9857, 'compress@10': 0.7848, 'time@10': 5.3356}:  70%|███████   | 7/10 [00:31<00:12,  4.09s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9857, 'compress@10': 0.7848, 'time@10': 5.3356}:  80%|████████  | 8/10 [00:31<00:08,  4.32s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9841, 'compress@10': 0.8082, 'time@10': 5.7111}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9841, 'compress@10': 0.8082, 'time@10': 5.7111}:  90%|█████████ | 9/10 [00:35<00:04,  4.34s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9826, 'compress@10': 0.8255, 'time@10': 5.7471}:  90%|█████████ | 9/10 [00:41<00:04,  4.34s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9826, 'compress@10': 0.8255, 'time@10': 5.7471}: 100%|██████████| 10/10 [00:41<00:00,  4.89s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9826, 'compress@10': 0.8255, 'time@10': 5.7471}: 100%|██████████| 10/10 [00:41<00:00,  4.16s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.017859796462979423
Avg hit ratio: 0.9091727681863505
Avg ndcg: 0.9826418317476419
Avg compression ratio: 0.8255178823281657
Avg train time: 5.74709529876709
Std train time: 1.6785833956827194
[0.8437499999999998, 0.4895833333333335, 0.03125000000000001, 0.9895833333333334, 0.9895833333333334, 0.8437499999999997, 0.7187499999999998, 0.6354166666666666, 0.71875, 0.6979166666666667]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9386, 'compress@10': 0.9994, 'time@10': 5.1505}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9386, 'compress@10': 0.9994, 'time@10': 5.1505}:  10%|█         | 1/10 [00:02<00:23,  2.61s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9475, 'compress@10': 0.6401, 'time@10': 4.619}:  10%|█         | 1/10 [00:06<00:23,  2.61s/it] {'epoch': 47, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9475, 'compress@10': 0.6401, 'time@10': 4.619}:  20%|██        | 2/10 [00:06<00:28,  3.50s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.7705, 'ndcg@10': 0.9174, 'compress@10': 0.4744, 'time@10': 4.2991}:  20%|██        | 2/10 [00:08<00:28,  3.50s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.7705, 'ndcg@10': 0.9174, 'compress@10': 0.4744, 'time@10': 4.2991}:  30%|███       | 3/10 [00:08<00:19,  2.76s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.8011, 'ndcg@10': 0.9283, 'compress@10': 0.6058, 'time@10': 4.1188}:  30%|███       | 3/10 [00:12<00:19,  2.76s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.8011, 'ndcg@10': 0.9283, 'compress@10': 0.6058, 'time@10': 4.1188}:  40%|████      | 4/10 [00:12<00:18,  3.11s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9337, 'compress@10': 0.6846, 'time@10': 4.9647}:  40%|████      | 4/10 [00:16<00:18,  3.11s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9337, 'compress@10': 0.6846, 'time@10': 4.9647}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.9408, 'compress@10': 0.7371, 'time@10': 5.1766}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.9408, 'compress@10': 0.7371, 'time@10': 5.1766}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9412, 'compress@10': 0.7732, 'time@10': 5.3561}:  60%|██████    | 6/10 [00:25<00:17,  4.45s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9412, 'compress@10': 0.7732, 'time@10': 5.3561}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0101, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9445, 'compress@10': 0.795, 'time@10': 5.2887}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]  {'epoch': 47, 'num_users': 6.125, 'loss': 0.0101, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9445, 'compress@10': 0.795, 'time@10': 5.2887}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0099, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9466, 'compress@10': 0.8171, 'time@10': 5.5916}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0099, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9466, 'compress@10': 0.8171, 'time@10': 5.5916}:  90%|█████████ | 9/10 [00:34<00:04,  4.23s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9503, 'compress@10': 0.8338, 'time@10': 5.565}:  90%|█████████ | 9/10 [00:40<00:04,  4.23s/it]    {'epoch': 47, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9503, 'compress@10': 0.8338, 'time@10': 5.565}: 100%|██████████| 10/10 [00:40<00:00,  4.58s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9503, 'compress@10': 0.8338, 'time@10': 5.565}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.011193620101598193
Avg hit ratio: 0.8848537717705799
Avg ndcg: 0.9502905190643427
Avg compression ratio: 0.8337942121983696
Avg train time: 5.5649841785430905
Std train time: 1.5970426384054155
[0.8265306122448978, 0.5000000000000001, 0.03061224489795919, 0.9897959183673469, 0.9897959183673469, 0.8265306122448977, 0.7244897959183672, 0.6428571428571428, 0.7244897959183674, 0.7040816326530613]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9265, 'compress@10': 0.9992, 'time@10': 4.5373}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9265, 'compress@10': 0.9992, 'time@10': 4.5373}:  10%|█         | 1/10 [00:02<00:20,  2.31s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9935, 'compress@10': 0.6811, 'time@10': 4.3015}:  10%|█         | 1/10 [00:06<00:20,  2.31s/it] {'epoch': 48, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9935, 'compress@10': 0.6811, 'time@10': 4.3015}:  20%|██        | 2/10 [00:06<00:26,  3.37s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.948, 'compress@10': 0.5017, 'time@10': 3.9744}:  20%|██        | 2/10 [00:08<00:26,  3.37s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.948, 'compress@10': 0.5017, 'time@10': 3.9744}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9513, 'compress@10': 0.6263, 'time@10': 3.7623}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9513, 'compress@10': 0.6263, 'time@10': 3.7623}:  40%|████      | 4/10 [00:11<00:16,  2.83s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0153, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.952, 'compress@10': 0.701, 'time@10': 4.5552}:  40%|████      | 4/10 [00:15<00:16,  2.83s/it]  {'epoch': 48, 'num_users': 5.8, 'loss': 0.0153, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.952, 'compress@10': 0.701, 'time@10': 4.5552}:  50%|█████     | 5/10 [00:15<00:16,  3.21s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9561, 'compress@10': 0.7507, 'time@10': 4.8429}:  50%|█████     | 5/10 [00:21<00:16,  3.21s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9561, 'compress@10': 0.7507, 'time@10': 4.8429}:  60%|██████    | 6/10 [00:21<00:17,  4.27s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9567, 'compress@10': 0.7852, 'time@10': 5.1171}:  60%|██████    | 6/10 [00:24<00:17,  4.27s/it] {'epoch': 48, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9567, 'compress@10': 0.7852, 'time@10': 5.1171}:  70%|███████   | 7/10 [00:24<00:11,  3.99s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9601, 'compress@10': 0.8052, 'time@10': 5.0422}:  70%|███████   | 7/10 [00:29<00:11,  3.99s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9601, 'compress@10': 0.8052, 'time@10': 5.0422}:  80%|████████  | 8/10 [00:29<00:08,  4.17s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9769, 'compress@10': 0.8261, 'time@10': 5.3877}:  80%|████████  | 8/10 [00:33<00:08,  4.17s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9769, 'compress@10': 0.8261, 'time@10': 5.3877}:  90%|█████████ | 9/10 [00:33<00:04,  4.16s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9769, 'compress@10': 0.8422, 'time@10': 5.4385}:  90%|█████████ | 9/10 [00:39<00:04,  4.16s/it]    {'epoch': 48, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9769, 'compress@10': 0.8422, 'time@10': 5.4385}: 100%|██████████| 10/10 [00:39<00:00,  4.71s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9769, 'compress@10': 0.8422, 'time@10': 5.4385}: 100%|██████████| 10/10 [00:39<00:00,  3.96s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.014007173749609428
Avg hit ratio: 0.880890638130027
Avg ndcg: 0.9769331318755929
Avg compression ratio: 0.8421596981840439
Avg train time: 5.438492679595948
Std train time: 1.6925023730018063
[0.8299999999999998, 0.5100000000000001, 0.030000000000000006, 0.99, 0.99, 0.8099999999999997, 0.7299999999999998, 0.6499999999999999, 0.73, 0.6900000000000002]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0048, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.9993, 'time@10': 4.9365}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0048, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.9993, 'time@10': 4.9365}:  10%|█         | 1/10 [00:02<00:22,  2.51s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9797, 'compress@10': 0.7552, 'time@10': 4.3221}:  10%|█         | 1/10 [00:06<00:22,  2.51s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9797, 'compress@10': 0.7552, 'time@10': 4.3221}:  20%|██        | 2/10 [00:06<00:25,  3.25s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9388, 'compress@10': 0.5511, 'time@10': 3.9943}:  20%|██        | 2/10 [00:07<00:25,  3.25s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9388, 'compress@10': 0.5511, 'time@10': 3.9943}:  30%|███       | 3/10 [00:07<00:17,  2.54s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.9421, 'compress@10': 0.6633, 'time@10': 3.8395}:  30%|███       | 3/10 [00:11<00:17,  2.54s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.9421, 'compress@10': 0.6633, 'time@10': 3.8395}:  40%|████      | 4/10 [00:11<00:17,  2.89s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.9455, 'compress@10': 0.7306, 'time@10': 4.4091}:  40%|████      | 4/10 [00:14<00:17,  2.89s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.9455, 'compress@10': 0.7306, 'time@10': 4.4091}:  50%|█████     | 5/10 [00:14<00:15,  3.07s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9539, 'compress@10': 0.7753, 'time@10': 4.5308}:  50%|█████     | 5/10 [00:19<00:15,  3.07s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9539, 'compress@10': 0.7753, 'time@10': 4.5308}:  60%|██████    | 6/10 [00:19<00:15,  3.78s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9544, 'compress@10': 0.8066, 'time@10': 4.6508}:  60%|██████    | 6/10 [00:22<00:15,  3.78s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9544, 'compress@10': 0.8066, 'time@10': 4.6508}:  70%|███████   | 7/10 [00:22<00:10,  3.44s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9608, 'compress@10': 0.8243, 'time@10': 4.5198}:  70%|███████   | 7/10 [00:26<00:10,  3.44s/it]  {'epoch': 49, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9608, 'compress@10': 0.8243, 'time@10': 4.5198}:  80%|████████  | 8/10 [00:26<00:07,  3.51s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9561, 'compress@10': 0.8432, 'time@10': 4.7477}:  80%|████████  | 8/10 [00:29<00:07,  3.51s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9561, 'compress@10': 0.8432, 'time@10': 4.7477}:  90%|█████████ | 9/10 [00:29<00:03,  3.45s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9578, 'compress@10': 0.8572, 'time@10': 4.7031}:  90%|█████████ | 9/10 [00:34<00:03,  3.45s/it]  {'epoch': 49, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9578, 'compress@10': 0.8572, 'time@10': 4.7031}: 100%|██████████| 10/10 [00:34<00:00,  3.72s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9578, 'compress@10': 0.8572, 'time@10': 4.7031}: 100%|██████████| 10/10 [00:34<00:00,  3.40s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.018634379607915547
Avg hit ratio: 0.8852557174951062
Avg ndcg: 0.9578430737546016
Avg compression ratio: 0.8572422170635164
Avg train time: 4.703072476387024
Std train time: 1.1875293226044812
[0.8137254901960783, 0.519607843137255, 0.02941176470588236, 0.9901960784313726, 0.9901960784313726, 0.8137254901960782, 0.7156862745098037, 0.6568627450980391, 0.7352941176470588, 0.6960784313725492]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
