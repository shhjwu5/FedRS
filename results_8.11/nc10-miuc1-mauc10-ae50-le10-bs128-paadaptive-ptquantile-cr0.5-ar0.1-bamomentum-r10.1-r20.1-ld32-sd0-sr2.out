  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1996, 'hit_ratio@10': 0.4211, 'ndcg@10': 0.523, 'compress@10': 0.5263, 'time@10': 9.2619}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1996, 'hit_ratio@10': 0.4211, 'ndcg@10': 0.523, 'compress@10': 0.5263, 'time@10': 9.2619}:  10%|█         | 1/10 [00:04<00:42,  4.67s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1418, 'hit_ratio@10': 0.5654, 'ndcg@10': 0.6242, 'compress@10': 0.5212, 'time@10': 8.0846}:  10%|█         | 1/10 [00:11<00:42,  4.67s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1418, 'hit_ratio@10': 0.5654, 'ndcg@10': 0.6242, 'compress@10': 0.5212, 'time@10': 8.0846}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.868, 'hit_ratio@10': 0.4245, 'ndcg@10': 0.4162, 'compress@10': 0.538, 'time@10': 6.304}:  20%|██        | 2/10 [00:13<00:48,  6.01s/it]   {'epoch': 0, 'num_users': 5.0, 'loss': 0.868, 'hit_ratio@10': 0.4245, 'ndcg@10': 0.4162, 'compress@10': 0.538, 'time@10': 6.304}:  30%|███       | 3/10 [00:13<00:27,  3.91s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6846, 'hit_ratio@10': 0.4791, 'ndcg@10': 0.4519, 'compress@10': 0.5329, 'time@10': 6.2841}:  30%|███       | 3/10 [00:19<00:27,  3.91s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6846, 'hit_ratio@10': 0.4791, 'ndcg@10': 0.4519, 'compress@10': 0.5329, 'time@10': 6.2841}:  40%|████      | 4/10 [00:19<00:29,  4.84s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5665, 'hit_ratio@10': 0.5473, 'ndcg@10': 0.5113, 'compress@10': 0.5283, 'time@10': 9.6067}:  40%|████      | 4/10 [00:30<00:29,  4.84s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5665, 'hit_ratio@10': 0.5473, 'ndcg@10': 0.5113, 'compress@10': 0.5283, 'time@10': 9.6067}:  50%|█████     | 5/10 [00:30<00:36,  7.24s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4869, 'hit_ratio@10': 0.5709, 'ndcg@10': 0.554, 'compress@10': 0.5255, 'time@10': 9.7087}:  50%|█████     | 5/10 [00:41<00:36,  7.24s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4869, 'hit_ratio@10': 0.5709, 'ndcg@10': 0.554, 'compress@10': 0.5255, 'time@10': 9.7087}:  60%|██████    | 6/10 [00:41<00:33,  8.26s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4362, 'hit_ratio@10': 0.5865, 'ndcg@10': 0.5539, 'compress@10': 0.5247, 'time@10': 9.9752}:  60%|██████    | 6/10 [00:46<00:33,  8.26s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4362, 'hit_ratio@10': 0.5865, 'ndcg@10': 0.5539, 'compress@10': 0.5247, 'time@10': 9.9752}:  70%|███████   | 7/10 [00:46<00:22,  7.47s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.389, 'hit_ratio@10': 0.6275, 'ndcg@10': 0.5802, 'compress@10': 0.5234, 'time@10': 9.6928}:  70%|███████   | 7/10 [00:54<00:22,  7.47s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 0.389, 'hit_ratio@10': 0.6275, 'ndcg@10': 0.5802, 'compress@10': 0.5234, 'time@10': 9.6928}:  80%|████████  | 8/10 [00:54<00:15,  7.56s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3529, 'hit_ratio@10': 0.6498, 'ndcg@10': 0.6158, 'compress@10': 0.5224, 'time@10': 10.3667}:  80%|████████  | 8/10 [01:02<00:15,  7.56s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3529, 'hit_ratio@10': 0.6498, 'ndcg@10': 0.6158, 'compress@10': 0.5224, 'time@10': 10.3667}:  90%|█████████ | 9/10 [01:02<00:07,  7.67s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3231, 'hit_ratio@10': 0.678, 'ndcg@10': 0.6377, 'compress@10': 0.5213, 'time@10': 10.3185}:  90%|█████████ | 9/10 [01:12<00:07,  7.67s/it]    {'epoch': 0, 'num_users': 6.3, 'loss': 0.3231, 'hit_ratio@10': 0.678, 'ndcg@10': 0.6377, 'compress@10': 0.5213, 'time@10': 10.3185}: 100%|██████████| 10/10 [01:12<00:00,  8.37s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3231, 'hit_ratio@10': 0.678, 'ndcg@10': 0.6377, 'compress@10': 0.5213, 'time@10': 10.3185}: 100%|██████████| 10/10 [01:12<00:00,  7.25s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.32312520173504056
Avg hit ratio: 0.6780008550212285
Avg ndcg: 0.6377277797124931
Avg compression ratio: 0.5212749006657823
Avg train time: 10.318538117408753
Std train time: 5.32220330766019
[0.75, 0.75, 0.75, 0.75, 0.75, 0.75, 0.75, 0.75, 0.75, 0.25]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0577, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8301, 'compress@10': 0.7632, 'time@10': 8.1467}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0577, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8301, 'compress@10': 0.7632, 'time@10': 8.1467}:  10%|█         | 1/10 [00:04<00:36,  4.11s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0555, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8393, 'compress@10': 0.7606, 'time@10': 7.5163}:  10%|█         | 1/10 [00:11<00:36,  4.11s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0555, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8393, 'compress@10': 0.7606, 'time@10': 7.5163}:  20%|██        | 2/10 [00:11<00:46,  5.76s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0478, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.8074, 'compress@10': 0.769, 'time@10': 6.0431}:  20%|██        | 2/10 [00:12<00:46,  5.76s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.0478, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.8074, 'compress@10': 0.769, 'time@10': 6.0431}:  30%|███       | 3/10 [00:12<00:27,  3.86s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0484, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8163, 'compress@10': 0.7665, 'time@10': 6.1265}:  30%|███       | 3/10 [00:19<00:27,  3.86s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0484, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8163, 'compress@10': 0.7665, 'time@10': 6.1265}:  40%|████      | 4/10 [00:19<00:29,  4.87s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.056, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8102, 'compress@10': 0.7642, 'time@10': 8.9745}:  40%|████      | 4/10 [00:29<00:29,  4.87s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 0.056, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8102, 'compress@10': 0.7642, 'time@10': 8.9745}:  50%|█████     | 5/10 [00:29<00:33,  6.80s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0599, 'hit_ratio@10': 0.7877, 'ndcg@10': 0.8126, 'compress@10': 0.7627, 'time@10': 9.1705}:  50%|█████     | 5/10 [00:39<00:33,  6.80s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0599, 'hit_ratio@10': 0.7877, 'ndcg@10': 0.8126, 'compress@10': 0.7627, 'time@10': 9.1705}:  60%|██████    | 6/10 [00:39<00:31,  7.95s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0577, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.8199, 'compress@10': 0.7623, 'time@10': 9.4162}:  60%|██████    | 6/10 [00:44<00:31,  7.95s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0577, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.8199, 'compress@10': 0.7623, 'time@10': 9.4162}:  70%|███████   | 7/10 [00:44<00:21,  7.14s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0552, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8269, 'compress@10': 0.7617, 'time@10': 9.1768}:  70%|███████   | 7/10 [00:52<00:21,  7.14s/it]  {'epoch': 1, 'num_users': 6.125, 'loss': 0.0552, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8269, 'compress@10': 0.7617, 'time@10': 9.1768}:  80%|████████  | 8/10 [00:52<00:14,  7.27s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0531, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.8373, 'compress@10': 0.7612, 'time@10': 9.7448}:  80%|████████  | 8/10 [00:59<00:14,  7.27s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0531, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.8373, 'compress@10': 0.7612, 'time@10': 9.7448}:  90%|█████████ | 9/10 [00:59<00:07,  7.25s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0524, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8382, 'compress@10': 0.7118, 'time@10': 9.7239}:  90%|█████████ | 9/10 [01:09<00:07,  7.25s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0524, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8382, 'compress@10': 0.7118, 'time@10': 9.7239}: 100%|██████████| 10/10 [01:09<00:00,  7.96s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0524, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8382, 'compress@10': 0.7118, 'time@10': 9.7239}: 100%|██████████| 10/10 [01:09<00:00,  6.92s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05244848991582672
Avg hit ratio: 0.8246381741254407
Avg ndcg: 0.8382402325461598
Avg compression ratio: 0.7117713019833288
Avg train time: 9.72393581867218
Std train time: 4.541908954431876
[0.8333333333333334, 0.8333333333333334, 0.5, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.5]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.8421, 'time@10': 7.9182}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.8421, 'time@10': 7.9182}:  10%|█         | 1/10 [00:03<00:35,  3.99s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.05, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8438, 'compress@10': 0.8404, 'time@10': 7.3507}:  10%|█         | 1/10 [00:10<00:35,  3.99s/it]  {'epoch': 2, 'num_users': 7.0, 'loss': 0.05, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8438, 'compress@10': 0.8404, 'time@10': 7.3507}:  20%|██        | 2/10 [00:10<00:45,  5.66s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0349, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8461, 'compress@10': 0.7507, 'time@10': 5.9924}:  20%|██        | 2/10 [00:12<00:45,  5.66s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0349, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8461, 'compress@10': 0.7507, 'time@10': 5.9924}:  30%|███       | 3/10 [00:12<00:26,  3.84s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0384, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8463, 'compress@10': 0.7729, 'time@10': 6.001}:  30%|███       | 3/10 [00:18<00:26,  3.84s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.0384, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8463, 'compress@10': 0.7729, 'time@10': 6.001}:  40%|████      | 4/10 [00:18<00:28,  4.72s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0478, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8341, 'compress@10': 0.7856, 'time@10': 8.3815}:  40%|████      | 4/10 [00:27<00:28,  4.72s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0478, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8341, 'compress@10': 0.7856, 'time@10': 8.3815}:  50%|█████     | 5/10 [00:27<00:31,  6.26s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0521, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8314, 'compress@10': 0.7942, 'time@10': 8.6817}:  50%|█████     | 5/10 [00:37<00:31,  6.26s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0521, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8314, 'compress@10': 0.7942, 'time@10': 8.6817}:  60%|██████    | 6/10 [00:37<00:30,  7.61s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0506, 'hit_ratio@10': 0.8244, 'ndcg@10': 0.8352, 'compress@10': 0.8007, 'time@10': 8.9872}:  60%|██████    | 6/10 [00:43<00:30,  7.61s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0506, 'hit_ratio@10': 0.8244, 'ndcg@10': 0.8352, 'compress@10': 0.8007, 'time@10': 8.9872}:  70%|███████   | 7/10 [00:43<00:20,  6.90s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.05, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8412, 'compress@10': 0.8054, 'time@10': 8.7842}:  70%|███████   | 7/10 [00:50<00:20,  6.90s/it]   {'epoch': 2, 'num_users': 6.125, 'loss': 0.05, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8412, 'compress@10': 0.8054, 'time@10': 8.7842}:  80%|████████  | 8/10 [00:50<00:14,  7.06s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0491, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8492, 'compress@10': 0.809, 'time@10': 9.461}:  80%|████████  | 8/10 [00:58<00:14,  7.06s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0491, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8492, 'compress@10': 0.809, 'time@10': 9.461}:  90%|█████████ | 9/10 [00:58<00:07,  7.19s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8493, 'compress@10': 0.7793, 'time@10': 9.5464}:  90%|█████████ | 9/10 [01:08<00:07,  7.19s/it]  {'epoch': 2, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8493, 'compress@10': 0.7793, 'time@10': 9.5464}: 100%|██████████| 10/10 [01:08<00:00,  8.17s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8493, 'compress@10': 0.7793, 'time@10': 9.5464}: 100%|██████████| 10/10 [01:08<00:00,  6.85s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.048970051860160624
Avg hit ratio: 0.8445557099003619
Avg ndcg: 0.8492752987431693
Avg compression ratio: 0.779265091096158
Avg train time: 9.546427822113037
Std train time: 4.094148618899849
[0.875, 0.875, 0.375, 0.875, 0.875, 0.875, 0.875, 0.875, 0.875, 0.625]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.8816, 'time@10': 7.7979}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.8816, 'time@10': 7.7979}:  10%|█         | 1/10 [00:03<00:35,  3.94s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8579, 'compress@10': 0.8803, 'time@10': 7.1834}:  10%|█         | 1/10 [00:10<00:35,  3.94s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8579, 'compress@10': 0.8803, 'time@10': 7.1834}:  20%|██        | 2/10 [00:10<00:44,  5.51s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8576, 'compress@10': 0.7416, 'time@10': 5.9893}:  20%|██        | 2/10 [00:12<00:44,  5.51s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8576, 'compress@10': 0.7416, 'time@10': 5.9893}:  30%|███       | 3/10 [00:12<00:26,  3.83s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.7642, 'ndcg@10': 0.8531, 'compress@10': 0.7761, 'time@10': 5.9436}:  30%|███       | 3/10 [00:18<00:26,  3.83s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.7642, 'ndcg@10': 0.8531, 'compress@10': 0.7761, 'time@10': 5.9436}:  40%|████      | 4/10 [00:18<00:27,  4.63s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0463, 'hit_ratio@10': 0.7794, 'ndcg@10': 0.8411, 'compress@10': 0.7964, 'time@10': 7.7039}:  40%|████      | 4/10 [00:25<00:27,  4.63s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0463, 'hit_ratio@10': 0.7794, 'ndcg@10': 0.8411, 'compress@10': 0.7964, 'time@10': 7.7039}:  50%|█████     | 5/10 [00:25<00:28,  5.63s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0503, 'hit_ratio@10': 0.7791, 'ndcg@10': 0.8386, 'compress@10': 0.8099, 'time@10': 8.0573}:  50%|█████     | 5/10 [00:35<00:28,  5.63s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0503, 'hit_ratio@10': 0.7791, 'ndcg@10': 0.8386, 'compress@10': 0.8099, 'time@10': 8.0573}:  60%|██████    | 6/10 [00:35<00:28,  7.07s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0498, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8381, 'compress@10': 0.8199, 'time@10': 8.4438}:  60%|██████    | 6/10 [00:40<00:28,  7.07s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0498, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8381, 'compress@10': 0.8199, 'time@10': 8.4438}:  70%|███████   | 7/10 [00:40<00:19,  6.53s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0508, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8404, 'compress@10': 0.8273, 'time@10': 8.2931}:  70%|███████   | 7/10 [00:48<00:19,  6.53s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0508, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8404, 'compress@10': 0.8273, 'time@10': 8.2931}:  80%|████████  | 8/10 [00:48<00:13,  6.77s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0496, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.8488, 'compress@10': 0.833, 'time@10': 8.8476}:  80%|████████  | 8/10 [00:54<00:13,  6.77s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0496, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.8488, 'compress@10': 0.833, 'time@10': 8.8476}:  90%|█████████ | 9/10 [00:54<00:06,  6.74s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8496, 'compress@10': 0.813, 'time@10': 8.9505}:  90%|█████████ | 9/10 [01:04<00:06,  6.74s/it]    {'epoch': 3, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8496, 'compress@10': 0.813, 'time@10': 8.9505}: 100%|██████████| 10/10 [01:04<00:00,  7.72s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8496, 'compress@10': 0.813, 'time@10': 8.9505}: 100%|██████████| 10/10 [01:04<00:00,  6.48s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.04898311565109146
Avg hit ratio: 0.8223493606940127
Avg ndcg: 0.8495880094432376
Avg compression ratio: 0.8130259666948916
Avg train time: 8.950524473190308
Std train time: 3.2510988039500752
[0.9, 0.9, 0.3, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.7]
[10, 10, 14, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.9052, 'time@10': 7.9531}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.9052, 'time@10': 7.9531}:  10%|█         | 1/10 [00:04<00:36,  4.01s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8608, 'compress@10': 0.9042, 'time@10': 7.2071}:  10%|█         | 1/10 [00:10<00:36,  4.01s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8608, 'compress@10': 0.9042, 'time@10': 7.2071}:  20%|██        | 2/10 [00:10<00:43,  5.48s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8596, 'compress@10': 0.7362, 'time@10': 6.0659}:  20%|██        | 2/10 [00:12<00:43,  5.48s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8596, 'compress@10': 0.7362, 'time@10': 6.0659}:  30%|███       | 3/10 [00:12<00:26,  3.86s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0368, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8528, 'compress@10': 0.778, 'time@10': 6.0824}:  30%|███       | 3/10 [00:18<00:26,  3.86s/it]  {'epoch': 4, 'num_users': 5.0, 'loss': 0.0368, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8528, 'compress@10': 0.778, 'time@10': 6.0824}:  40%|████      | 4/10 [00:18<00:28,  4.77s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0456, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8411, 'compress@10': 0.8028, 'time@10': 7.8038}:  40%|████      | 4/10 [00:25<00:28,  4.77s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0456, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8411, 'compress@10': 0.8028, 'time@10': 7.8038}:  50%|█████     | 5/10 [00:25<00:28,  5.71s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.049, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8392, 'compress@10': 0.8194, 'time@10': 8.1427}:  50%|█████     | 5/10 [00:35<00:28,  5.71s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.049, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8392, 'compress@10': 0.8194, 'time@10': 8.1427}:  60%|██████    | 6/10 [00:35<00:28,  7.13s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0488, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8386, 'compress@10': 0.8315, 'time@10': 8.4714}:  60%|██████    | 6/10 [00:41<00:28,  7.13s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0488, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8386, 'compress@10': 0.8315, 'time@10': 8.4714}:  70%|███████   | 7/10 [00:41<00:19,  6.52s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0504, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8484, 'compress@10': 0.8404, 'time@10': 8.3237}:  70%|███████   | 7/10 [00:48<00:19,  6.52s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0504, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8484, 'compress@10': 0.8404, 'time@10': 8.3237}:  80%|████████  | 8/10 [00:48<00:13,  6.78s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8557, 'compress@10': 0.8473, 'time@10': 8.91}:  80%|████████  | 8/10 [00:55<00:13,  6.78s/it] {'epoch': 4, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8557, 'compress@10': 0.8473, 'time@10': 8.91}:  90%|█████████ | 9/10 [00:55<00:06,  6.80s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8557, 'compress@10': 0.8333, 'time@10': 9.0199}:  90%|█████████ | 9/10 [01:05<00:06,  6.80s/it] {'epoch': 4, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8557, 'compress@10': 0.8333, 'time@10': 9.0199}: 100%|██████████| 10/10 [01:05<00:00,  7.80s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8557, 'compress@10': 0.8333, 'time@10': 9.0199}: 100%|██████████| 10/10 [01:05<00:00,  6.53s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04890524322041653
Avg hit ratio: 0.8396509479956
Avg ndcg: 0.8556638917146199
Avg compression ratio: 0.8332684111125861
Avg train time: 9.01986927986145
Std train time: 3.212985502766372
[0.9166666666666667, 0.9166666666666667, 0.25, 0.9166666666666667, 0.9166666666666667, 0.9166666666666667, 0.9166666666666667, 0.9166666666666667, 0.9166666666666667, 0.75]
[10, 10, 15, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.921, 'time@10': 7.7852}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.921, 'time@10': 7.7852}:  10%|█         | 1/10 [00:03<00:35,  3.93s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8703, 'compress@10': 0.9202, 'time@10': 7.1721}:  10%|█         | 1/10 [00:10<00:35,  3.93s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8703, 'compress@10': 0.9202, 'time@10': 7.1721}:  20%|██        | 2/10 [00:10<00:43,  5.50s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8659, 'compress@10': 0.7325, 'time@10': 6.1393}:  20%|██        | 2/10 [00:12<00:43,  5.50s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8659, 'compress@10': 0.7325, 'time@10': 6.1393}:  30%|███       | 3/10 [00:12<00:27,  3.94s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8551, 'compress@10': 0.7793, 'time@10': 6.0341}:  30%|███       | 3/10 [00:18<00:27,  3.94s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8551, 'compress@10': 0.7793, 'time@10': 6.0341}:  40%|████      | 4/10 [00:18<00:27,  4.65s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.045, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8433, 'compress@10': 0.8071, 'time@10': 7.8183}:  40%|████      | 4/10 [00:25<00:27,  4.65s/it] {'epoch': 5, 'num_users': 5.8, 'loss': 0.045, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8433, 'compress@10': 0.8071, 'time@10': 7.8183}:  50%|█████     | 5/10 [00:25<00:28,  5.69s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0477, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8406, 'compress@10': 0.8257, 'time@10': 8.1904}:  50%|█████     | 5/10 [00:35<00:28,  5.69s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0477, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8406, 'compress@10': 0.8257, 'time@10': 8.1904}:  60%|██████    | 6/10 [00:35<00:28,  7.18s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.047, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8425, 'compress@10': 0.8391, 'time@10': 8.5416}:  60%|██████    | 6/10 [00:41<00:28,  7.18s/it] {'epoch': 5, 'num_users': 6.2857, 'loss': 0.047, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8425, 'compress@10': 0.8391, 'time@10': 8.5416}:  70%|███████   | 7/10 [00:41<00:19,  6.59s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0479, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8523, 'compress@10': 0.8491, 'time@10': 8.4638}:  70%|███████   | 7/10 [00:49<00:19,  6.59s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0479, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8523, 'compress@10': 0.8491, 'time@10': 8.4638}:  80%|████████  | 8/10 [00:49<00:14,  7.02s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0465, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8615, 'compress@10': 0.8569, 'time@10': 9.0232}:  80%|████████  | 8/10 [00:56<00:14,  7.02s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0465, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8615, 'compress@10': 0.8569, 'time@10': 9.0232}:  90%|█████████ | 9/10 [00:56<00:06,  6.95s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.046, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8611, 'compress@10': 0.8468, 'time@10': 9.0699}:  90%|█████████ | 9/10 [01:05<00:06,  6.95s/it]    {'epoch': 5, 'num_users': 6.3, 'loss': 0.046, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8611, 'compress@10': 0.8468, 'time@10': 9.0699}: 100%|██████████| 10/10 [01:05<00:00,  7.75s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.046, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8611, 'compress@10': 0.8468, 'time@10': 9.0699}: 100%|██████████| 10/10 [01:05<00:00,  6.56s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04599262836725759
Avg hit ratio: 0.8475874559321079
Avg ndcg: 0.8610929562482339
Avg compression ratio: 0.8467678271021594
Avg train time: 9.069911646842957
Std train time: 3.2148409592877836
[0.9285714285714286, 0.9285714285714286, 0.2142857142857143, 0.9285714285714286, 0.9285714285714286, 0.9285714285714286, 0.9285714285714286, 0.9285714285714286, 0.9285714285714286, 0.7857142857142857]
[10, 10, 16, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.9323, 'time@10': 8.2376}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.9323, 'time@10': 8.2376}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8574, 'compress@10': 0.9316, 'time@10': 7.4189}:  10%|█         | 1/10 [00:10<00:37,  4.17s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8574, 'compress@10': 0.9316, 'time@10': 7.4189}:  20%|██        | 2/10 [00:10<00:44,  5.62s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8573, 'compress@10': 0.7299, 'time@10': 6.3914}:  20%|██        | 2/10 [00:13<00:44,  5.62s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8573, 'compress@10': 0.7299, 'time@10': 6.3914}:  30%|███       | 3/10 [00:13<00:28,  4.06s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8515, 'compress@10': 0.7802, 'time@10': 6.2389}:  30%|███       | 3/10 [00:18<00:28,  4.06s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8515, 'compress@10': 0.7802, 'time@10': 6.2389}:  40%|████      | 4/10 [00:18<00:28,  4.76s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0424, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8409, 'compress@10': 0.8102, 'time@10': 8.0035}:  40%|████      | 4/10 [00:26<00:28,  4.76s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0424, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8409, 'compress@10': 0.8102, 'time@10': 8.0035}:  50%|█████     | 5/10 [00:26<00:28,  5.77s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0447, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8403, 'compress@10': 0.8302, 'time@10': 8.3109}:  50%|█████     | 5/10 [00:36<00:28,  5.77s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0447, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8403, 'compress@10': 0.8302, 'time@10': 8.3109}:  60%|██████    | 6/10 [00:36<00:28,  7.17s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0442, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8449, 'compress@10': 0.8446, 'time@10': 8.6098}:  60%|██████    | 6/10 [00:41<00:28,  7.17s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0442, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8449, 'compress@10': 0.8446, 'time@10': 8.6098}:  70%|███████   | 7/10 [00:41<00:19,  6.54s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0442, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8523, 'compress@10': 0.8554, 'time@10': 8.5005}:  70%|███████   | 7/10 [00:49<00:19,  6.54s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0442, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8523, 'compress@10': 0.8554, 'time@10': 8.5005}:  80%|████████  | 8/10 [00:49<00:13,  6.93s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0457, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8589, 'compress@10': 0.8637, 'time@10': 9.0259}:  80%|████████  | 8/10 [00:55<00:13,  6.93s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0457, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8589, 'compress@10': 0.8637, 'time@10': 9.0259}:  90%|█████████ | 9/10 [00:55<00:06,  6.84s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.045, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8591, 'compress@10': 0.8564, 'time@10': 9.0697}:  90%|█████████ | 9/10 [01:05<00:06,  6.84s/it]     {'epoch': 6, 'num_users': 6.3, 'loss': 0.045, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8591, 'compress@10': 0.8564, 'time@10': 9.0697}: 100%|██████████| 10/10 [01:05<00:00,  7.66s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.045, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8591, 'compress@10': 0.8564, 'time@10': 9.0697}: 100%|██████████| 10/10 [01:05<00:00,  6.54s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.044981511198623945
Avg hit ratio: 0.8590160273606793
Avg ndcg: 0.8590987466290043
Avg compression ratio: 0.8564093608148274
Avg train time: 9.069676184654236
Std train time: 3.12297783191695
[0.9375, 0.9375, 0.1875, 0.9375, 0.9375, 0.9375, 0.9375, 0.9375, 0.9375, 0.8125]
[10, 10, 17, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8639, 'compress@10': 0.9408, 'time@10': 7.9566}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8639, 'compress@10': 0.9408, 'time@10': 7.9566}:  10%|█         | 1/10 [00:04<00:36,  4.02s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0429, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8667, 'compress@10': 0.9401, 'time@10': 7.2827}:  10%|█         | 1/10 [00:10<00:36,  4.02s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0429, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8667, 'compress@10': 0.9401, 'time@10': 7.2827}:  20%|██        | 2/10 [00:10<00:44,  5.56s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8635, 'compress@10': 0.728, 'time@10': 6.3635}:  20%|██        | 2/10 [00:12<00:44,  5.56s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8635, 'compress@10': 0.728, 'time@10': 6.3635}:  30%|███       | 3/10 [00:12<00:28,  4.07s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8608, 'compress@10': 0.7809, 'time@10': 6.2396}:  30%|███       | 3/10 [00:18<00:28,  4.07s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8608, 'compress@10': 0.7809, 'time@10': 6.2396}:  40%|████      | 4/10 [00:18<00:28,  4.80s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0409, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.85, 'compress@10': 0.8125, 'time@10': 8.0218}:  40%|████      | 4/10 [00:26<00:28,  4.80s/it]  {'epoch': 7, 'num_users': 5.8, 'loss': 0.0409, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.85, 'compress@10': 0.8125, 'time@10': 8.0218}:  50%|█████     | 5/10 [00:26<00:29,  5.81s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0429, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8491, 'compress@10': 0.8335, 'time@10': 8.3346}:  50%|█████     | 5/10 [00:36<00:29,  5.81s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0429, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8491, 'compress@10': 0.8335, 'time@10': 8.3346}:  60%|██████    | 6/10 [00:36<00:28,  7.21s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0422, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8503, 'compress@10': 0.8487, 'time@10': 8.6587}:  60%|██████    | 6/10 [00:41<00:28,  7.21s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0422, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8503, 'compress@10': 0.8487, 'time@10': 8.6587}:  70%|███████   | 7/10 [00:41<00:19,  6.60s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0422, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.8573, 'compress@10': 0.8601, 'time@10': 8.5111}:  70%|███████   | 7/10 [00:49<00:19,  6.60s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0422, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.8573, 'compress@10': 0.8601, 'time@10': 8.5111}:  80%|████████  | 8/10 [00:49<00:13,  6.89s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0432, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.862, 'compress@10': 0.8689, 'time@10': 9.0307}:  80%|████████  | 8/10 [00:55<00:13,  6.89s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0432, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.862, 'compress@10': 0.8689, 'time@10': 9.0307}:  90%|█████████ | 9/10 [00:55<00:06,  6.81s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0424, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8641, 'compress@10': 0.8637, 'time@10': 9.1103}:  90%|█████████ | 9/10 [01:05<00:06,  6.81s/it]  {'epoch': 7, 'num_users': 6.3, 'loss': 0.0424, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8641, 'compress@10': 0.8637, 'time@10': 9.1103}: 100%|██████████| 10/10 [01:05<00:00,  7.75s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0424, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8641, 'compress@10': 0.8637, 'time@10': 9.1103}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.0424202301136082
Avg hit ratio: 0.8670824054270574
Avg ndcg: 0.8640527904912332
Avg compression ratio: 0.8636532534913375
Avg train time: 9.110286521911622
Std train time: 3.1345987651272624
[0.9444444444444444, 0.9444444444444444, 0.16666666666666666, 0.9444444444444444, 0.9444444444444444, 0.9444444444444444, 0.9444444444444444, 0.9444444444444444, 0.9444444444444444, 0.8333333333333334]
[10, 10, 18, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8471, 'compress@10': 0.9474, 'time@10': 7.9224}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8471, 'compress@10': 0.9474, 'time@10': 7.9224}:  10%|█         | 1/10 [00:03<00:35,  4.00s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0412, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8626, 'compress@10': 0.9468, 'time@10': 7.2492}:  10%|█         | 1/10 [00:10<00:35,  4.00s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0412, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8626, 'compress@10': 0.9468, 'time@10': 7.2492}:  20%|██        | 2/10 [00:10<00:44,  5.54s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8608, 'compress@10': 0.7264, 'time@10': 6.4628}:  20%|██        | 2/10 [00:13<00:44,  5.54s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8608, 'compress@10': 0.7264, 'time@10': 6.4628}:  30%|███       | 3/10 [00:13<00:28,  4.14s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.861, 'compress@10': 0.7814, 'time@10': 6.316}:  30%|███       | 3/10 [00:19<00:28,  4.14s/it]  {'epoch': 8, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.861, 'compress@10': 0.7814, 'time@10': 6.316}:  40%|████      | 4/10 [00:19<00:29,  4.84s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0396, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8511, 'compress@10': 0.8143, 'time@10': 8.1281}:  40%|████      | 4/10 [00:26<00:29,  4.84s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0396, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8511, 'compress@10': 0.8143, 'time@10': 8.1281}:  50%|█████     | 5/10 [00:26<00:29,  5.88s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0409, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.8506, 'compress@10': 0.8362, 'time@10': 8.5062}:  50%|█████     | 5/10 [00:37<00:29,  5.88s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0409, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.8506, 'compress@10': 0.8362, 'time@10': 8.5062}:  60%|██████    | 6/10 [00:37<00:29,  7.43s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0414, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8554, 'compress@10': 0.8519, 'time@10': 8.8991}:  60%|██████    | 6/10 [00:42<00:29,  7.43s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0414, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8554, 'compress@10': 0.8519, 'time@10': 8.8991}:  70%|███████   | 7/10 [00:42<00:20,  6.85s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0412, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8605, 'compress@10': 0.8637, 'time@10': 8.7114}:  70%|███████   | 7/10 [00:50<00:20,  6.85s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0412, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8605, 'compress@10': 0.8637, 'time@10': 8.7114}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.04, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8674, 'compress@10': 0.8728, 'time@10': 9.2046}:  80%|████████  | 8/10 [00:56<00:14,  7.04s/it] {'epoch': 8, 'num_users': 6.3333, 'loss': 0.04, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8674, 'compress@10': 0.8728, 'time@10': 9.2046}:  90%|█████████ | 9/10 [00:56<00:06,  6.91s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0392, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8685, 'compress@10': 0.8693, 'time@10': 9.2428}:  90%|█████████ | 9/10 [01:06<00:06,  6.91s/it] {'epoch': 8, 'num_users': 6.3, 'loss': 0.0392, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8685, 'compress@10': 0.8693, 'time@10': 9.2428}: 100%|██████████| 10/10 [01:06<00:00,  7.74s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0392, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8685, 'compress@10': 0.8693, 'time@10': 9.2428}: 100%|██████████| 10/10 [01:06<00:00,  6.65s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.039217634800757704
Avg hit ratio: 0.8648161483866067
Avg ndcg: 0.8685385451384023
Avg compression ratio: 0.8692712094248136
Avg train time: 9.242795276641846
Std train time: 3.1771219284057604
[0.95, 0.95, 0.15, 0.95, 0.95, 0.95, 0.95, 0.95, 0.95, 0.8500000000000001]
[10, 10, 19, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.862, 'compress@10': 0.9526, 'time@10': 8.1511}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.862, 'compress@10': 0.9526, 'time@10': 8.1511}:  10%|█         | 1/10 [00:04<00:37,  4.11s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8749, 'compress@10': 0.9521, 'time@10': 7.3943}:  10%|█         | 1/10 [00:10<00:37,  4.11s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8749, 'compress@10': 0.9521, 'time@10': 7.3943}:  20%|██        | 2/10 [00:10<00:44,  5.62s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.869, 'compress@10': 0.7252, 'time@10': 6.7099}:  20%|██        | 2/10 [00:13<00:44,  5.62s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.869, 'compress@10': 0.7252, 'time@10': 6.7099}:  30%|███       | 3/10 [00:13<00:30,  4.29s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8679, 'compress@10': 0.7819, 'time@10': 6.5049}:  30%|███       | 3/10 [00:19<00:30,  4.29s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8679, 'compress@10': 0.7819, 'time@10': 6.5049}:  40%|████      | 4/10 [00:19<00:29,  4.94s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0375, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8574, 'compress@10': 0.8157, 'time@10': 8.2262}:  40%|████      | 4/10 [00:27<00:29,  4.94s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0375, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8574, 'compress@10': 0.8157, 'time@10': 8.2262}:  50%|█████     | 5/10 [00:27<00:29,  5.90s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0383, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8572, 'compress@10': 0.8382, 'time@10': 8.4868}:  50%|█████     | 5/10 [00:36<00:29,  5.90s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0383, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8572, 'compress@10': 0.8382, 'time@10': 8.4868}:  60%|██████    | 6/10 [00:36<00:28,  7.23s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0389, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8528, 'compress@10': 0.8545, 'time@10': 8.8052}:  60%|██████    | 6/10 [00:42<00:28,  7.23s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0389, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8528, 'compress@10': 0.8545, 'time@10': 8.8052}:  70%|███████   | 7/10 [00:42<00:19,  6.63s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0394, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8554, 'compress@10': 0.8666, 'time@10': 8.6132}:  70%|███████   | 7/10 [00:49<00:19,  6.63s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0394, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8554, 'compress@10': 0.8666, 'time@10': 8.6132}:  80%|████████  | 8/10 [00:49<00:13,  6.85s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0385, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.863, 'compress@10': 0.876, 'time@10': 9.095}:  80%|████████  | 8/10 [00:56<00:13,  6.85s/it]  {'epoch': 9, 'num_users': 6.3333, 'loss': 0.0385, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.863, 'compress@10': 0.876, 'time@10': 9.095}:  90%|█████████ | 9/10 [00:56<00:06,  6.74s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0383, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8647, 'compress@10': 0.8738, 'time@10': 9.1543}:  90%|█████████ | 9/10 [01:05<00:06,  6.74s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0383, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8647, 'compress@10': 0.8738, 'time@10': 9.1543}: 100%|██████████| 10/10 [01:05<00:00,  7.66s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0383, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8647, 'compress@10': 0.8738, 'time@10': 9.1543}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03825547441931584
Avg hit ratio: 0.8745304341008925
Avg ndcg: 0.8646738502095364
Avg compression ratio: 0.8737701599549128
Avg train time: 9.154321312904358
Std train time: 2.985118263865154
[0.9545454545454545, 0.9545454545454545, 0.13636363636363635, 0.9545454545454545, 0.9545454545454545, 0.9545454545454545, 0.9545454545454545, 0.9545454545454545, 0.9545454545454545, 0.8636363636363638]
[10, 10, 19, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8346, 'compress@10': 0.9569, 'time@10': 8.0024}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8346, 'compress@10': 0.9569, 'time@10': 8.0024}:  10%|█         | 1/10 [00:04<00:36,  4.04s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0413, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8603, 'compress@10': 0.9565, 'time@10': 7.3333}:  10%|█         | 1/10 [00:10<00:36,  4.04s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0413, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8603, 'compress@10': 0.9565, 'time@10': 7.3333}:  20%|██        | 2/10 [00:10<00:44,  5.60s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8592, 'compress@10': 0.7242, 'time@10': 6.5553}:  20%|██        | 2/10 [00:13<00:44,  5.60s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8592, 'compress@10': 0.7242, 'time@10': 6.5553}:  30%|███       | 3/10 [00:13<00:29,  4.20s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.862, 'compress@10': 0.7822, 'time@10': 6.3824}:  30%|███       | 3/10 [00:19<00:29,  4.20s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.862, 'compress@10': 0.7822, 'time@10': 6.3824}:  40%|████      | 4/10 [00:19<00:29,  4.87s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0371, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8526, 'compress@10': 0.8169, 'time@10': 8.1807}:  40%|████      | 4/10 [00:26<00:29,  4.87s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0371, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8526, 'compress@10': 0.8169, 'time@10': 8.1807}:  50%|█████     | 5/10 [00:26<00:29,  5.90s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0374, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8541, 'compress@10': 0.84, 'time@10': 8.4858}:  50%|█████     | 5/10 [00:36<00:29,  5.90s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0374, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8541, 'compress@10': 0.84, 'time@10': 8.4858}:  60%|██████    | 6/10 [00:36<00:29,  7.31s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0377, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8593, 'compress@10': 0.8566, 'time@10': 8.7675}:  60%|██████    | 6/10 [00:42<00:29,  7.31s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0377, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8593, 'compress@10': 0.8566, 'time@10': 8.7675}:  70%|███████   | 7/10 [00:42<00:19,  6.64s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0382, 'hit_ratio@10': 0.869, 'ndcg@10': 0.8596, 'compress@10': 0.869, 'time@10': 8.6037}:  70%|███████   | 7/10 [00:49<00:19,  6.64s/it]   {'epoch': 10, 'num_users': 6.125, 'loss': 0.0382, 'hit_ratio@10': 0.869, 'ndcg@10': 0.8596, 'compress@10': 0.869, 'time@10': 8.6037}:  80%|████████  | 8/10 [00:49<00:13,  6.91s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0379, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8691, 'compress@10': 0.8786, 'time@10': 9.0963}:  80%|████████  | 8/10 [00:56<00:13,  6.91s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0379, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8691, 'compress@10': 0.8786, 'time@10': 9.0963}:  90%|█████████ | 9/10 [00:56<00:06,  6.80s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.8721, 'compress@10': 0.8775, 'time@10': 9.1477}:  90%|█████████ | 9/10 [01:05<00:06,  6.80s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.8721, 'compress@10': 0.8775, 'time@10': 9.1477}: 100%|██████████| 10/10 [01:05<00:00,  7.68s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.8721, 'compress@10': 0.8775, 'time@10': 9.1477}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03674198558852256
Avg hit ratio: 0.8700852914299434
Avg ndcg: 0.8721411497407796
Avg compression ratio: 0.8774518715753628
Avg train time: 9.147701716423034
Std train time: 3.0804797847009358
[0.9583333333333333, 0.9583333333333333, 0.12499999999999999, 0.9583333333333333, 0.9583333333333333, 0.9583333333333333, 0.9583333333333333, 0.9583333333333333, 0.9583333333333333, 0.8750000000000001]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0398, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8696, 'compress@10': 0.9605, 'time@10': 7.9042}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0398, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8696, 'compress@10': 0.9605, 'time@10': 7.9042}:  10%|█         | 1/10 [00:03<00:35,  3.99s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.035, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8807, 'compress@10': 0.9601, 'time@10': 7.4399}:  10%|█         | 1/10 [00:11<00:35,  3.99s/it] {'epoch': 11, 'num_users': 7.0, 'loss': 0.035, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8807, 'compress@10': 0.9601, 'time@10': 7.4399}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8728, 'compress@10': 0.7234, 'time@10': 6.8368}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8728, 'compress@10': 0.7234, 'time@10': 6.8368}:  30%|███       | 3/10 [00:13<00:31,  4.45s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8729, 'compress@10': 0.7825, 'time@10': 6.6263}:  30%|███       | 3/10 [00:19<00:31,  4.45s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8729, 'compress@10': 0.7825, 'time@10': 6.6263}:  40%|████      | 4/10 [00:19<00:30,  5.08s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0333, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8617, 'compress@10': 0.8178, 'time@10': 8.395}:  40%|████      | 4/10 [00:27<00:30,  5.08s/it] {'epoch': 11, 'num_users': 5.8, 'loss': 0.0333, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8617, 'compress@10': 0.8178, 'time@10': 8.395}:  50%|█████     | 5/10 [00:27<00:30,  6.05s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0336, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8629, 'compress@10': 0.8414, 'time@10': 8.6536}:  50%|█████     | 5/10 [00:37<00:30,  6.05s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0336, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8629, 'compress@10': 0.8414, 'time@10': 8.6536}:  60%|██████    | 6/10 [00:37<00:29,  7.39s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0334, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8617, 'compress@10': 0.8583, 'time@10': 8.917}:  60%|██████    | 6/10 [00:42<00:29,  7.39s/it] {'epoch': 11, 'num_users': 6.2857, 'loss': 0.0334, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8617, 'compress@10': 0.8583, 'time@10': 8.917}:  70%|███████   | 7/10 [00:42<00:20,  6.70s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0339, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.862, 'compress@10': 0.871, 'time@10': 8.7643}:  70%|███████   | 7/10 [00:50<00:20,  6.70s/it]  {'epoch': 11, 'num_users': 6.125, 'loss': 0.0339, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.862, 'compress@10': 0.871, 'time@10': 8.7643}:  80%|████████  | 8/10 [00:50<00:14,  7.03s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0354, 'hit_ratio@10': 0.866, 'ndcg@10': 0.8835, 'compress@10': 0.8808, 'time@10': 9.2634}:  80%|████████  | 8/10 [00:57<00:14,  7.03s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0354, 'hit_ratio@10': 0.866, 'ndcg@10': 0.8835, 'compress@10': 0.8808, 'time@10': 9.2634}:  90%|█████████ | 9/10 [00:57<00:06,  6.92s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0347, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8858, 'compress@10': 0.8805, 'time@10': 9.2935}:  90%|█████████ | 9/10 [01:06<00:06,  6.92s/it]  {'epoch': 11, 'num_users': 6.3, 'loss': 0.0347, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8858, 'compress@10': 0.8805, 'time@10': 9.2935}: 100%|██████████| 10/10 [01:06<00:00,  7.75s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0347, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8858, 'compress@10': 0.8805, 'time@10': 9.2935}: 100%|██████████| 10/10 [01:06<00:00,  6.70s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03473211151552309
Avg hit ratio: 0.8771646565093084
Avg ndcg: 0.885767458926507
Avg compression ratio: 0.8805197481071836
Avg train time: 9.293467903137207
Std train time: 2.9992405131711037
[0.9615384615384615, 0.9615384615384615, 0.11538461538461538, 0.9615384615384615, 0.9615384615384615, 0.9615384615384615, 0.9615384615384615, 0.9615384615384615, 0.9615384615384615, 0.8846153846153847]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8503, 'compress@10': 0.9635, 'time@10': 7.8888}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8503, 'compress@10': 0.9635, 'time@10': 7.8888}:  10%|█         | 1/10 [00:03<00:35,  3.98s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8725, 'compress@10': 0.9632, 'time@10': 7.3157}:  10%|█         | 1/10 [00:10<00:35,  3.98s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8725, 'compress@10': 0.9632, 'time@10': 7.3157}:  20%|██        | 2/10 [00:10<00:45,  5.63s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8674, 'compress@10': 0.7227, 'time@10': 6.6461}:  20%|██        | 2/10 [00:13<00:45,  5.63s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8674, 'compress@10': 0.7227, 'time@10': 6.6461}:  30%|███       | 3/10 [00:13<00:29,  4.29s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.028, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.868, 'compress@10': 0.7827, 'time@10': 6.4647}:  30%|███       | 3/10 [00:19<00:29,  4.29s/it]  {'epoch': 12, 'num_users': 5.0, 'loss': 0.028, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.868, 'compress@10': 0.7827, 'time@10': 6.4647}:  40%|████      | 4/10 [00:19<00:29,  4.95s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0325, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8593, 'compress@10': 0.8187, 'time@10': 8.1864}:  40%|████      | 4/10 [00:26<00:29,  4.95s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0325, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8593, 'compress@10': 0.8187, 'time@10': 8.1864}:  50%|█████     | 5/10 [00:26<00:29,  5.89s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0334, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8614, 'compress@10': 0.8426, 'time@10': 8.4391}:  50%|█████     | 5/10 [00:36<00:29,  5.89s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0334, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8614, 'compress@10': 0.8426, 'time@10': 8.4391}:  60%|██████    | 6/10 [00:36<00:28,  7.20s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8674, 'compress@10': 0.8598, 'time@10': 8.7445}:  60%|██████    | 6/10 [00:42<00:28,  7.20s/it] {'epoch': 12, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8674, 'compress@10': 0.8598, 'time@10': 8.7445}:  70%|███████   | 7/10 [00:42<00:19,  6.59s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0331, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8692, 'compress@10': 0.8727, 'time@10': 8.5733}:  70%|███████   | 7/10 [00:49<00:19,  6.59s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0331, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8692, 'compress@10': 0.8727, 'time@10': 8.5733}:  80%|████████  | 8/10 [00:49<00:13,  6.85s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0357, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8935, 'compress@10': 0.8827, 'time@10': 9.1023}:  80%|████████  | 8/10 [00:56<00:13,  6.85s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0357, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8935, 'compress@10': 0.8827, 'time@10': 9.1023}:  90%|█████████ | 9/10 [00:56<00:06,  6.80s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0346, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.896, 'compress@10': 0.8831, 'time@10': 9.1611}:  90%|█████████ | 9/10 [01:05<00:06,  6.80s/it]    {'epoch': 12, 'num_users': 6.3, 'loss': 0.0346, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.896, 'compress@10': 0.8831, 'time@10': 9.1611}: 100%|██████████| 10/10 [01:05<00:00,  7.71s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0346, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.896, 'compress@10': 0.8831, 'time@10': 9.1611}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03458994472249337
Avg hit ratio: 0.8872849572611882
Avg ndcg: 0.8959702106201842
Avg compression ratio: 0.8831158177778008
Avg train time: 9.16105396747589
Std train time: 3.0160108816900393
[0.9642857142857142, 0.9642857142857142, 0.10714285714285714, 0.9642857142857142, 0.9642857142857142, 0.9642857142857142, 0.9642857142857142, 0.9642857142857142, 0.9642857142857142, 0.8928571428571429]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.852, 'compress@10': 0.9661, 'time@10': 8.0078}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.852, 'compress@10': 0.9661, 'time@10': 8.0078}:  10%|█         | 1/10 [00:04<00:36,  4.04s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8799, 'compress@10': 0.9658, 'time@10': 7.3588}:  10%|█         | 1/10 [00:10<00:36,  4.04s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8799, 'compress@10': 0.9658, 'time@10': 7.3588}:  20%|██        | 2/10 [00:10<00:45,  5.64s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8723, 'compress@10': 0.7221, 'time@10': 6.6619}:  20%|██        | 2/10 [00:13<00:45,  5.64s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8723, 'compress@10': 0.7221, 'time@10': 6.6619}:  30%|███       | 3/10 [00:13<00:29,  4.28s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.027, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8741, 'compress@10': 0.783, 'time@10': 6.431}:  30%|███       | 3/10 [00:19<00:29,  4.28s/it]   {'epoch': 13, 'num_users': 5.0, 'loss': 0.027, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8741, 'compress@10': 0.783, 'time@10': 6.431}:  40%|████      | 4/10 [00:19<00:29,  4.87s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.031, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.868, 'compress@10': 0.8194, 'time@10': 8.2463}:  40%|████      | 4/10 [00:27<00:29,  4.87s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.031, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.868, 'compress@10': 0.8194, 'time@10': 8.2463}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8691, 'compress@10': 0.8436, 'time@10': 8.5008}:  50%|█████     | 5/10 [00:36<00:29,  5.92s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8691, 'compress@10': 0.8436, 'time@10': 8.5008}:  60%|██████    | 6/10 [00:36<00:29,  7.30s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0317, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8701, 'compress@10': 0.8611, 'time@10': 8.8559}:  60%|██████    | 6/10 [00:42<00:29,  7.30s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0317, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8701, 'compress@10': 0.8611, 'time@10': 8.8559}:  70%|███████   | 7/10 [00:42<00:20,  6.72s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0307, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.8746, 'compress@10': 0.8741, 'time@10': 8.7008}:  70%|███████   | 7/10 [00:50<00:20,  6.72s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0307, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.8746, 'compress@10': 0.8741, 'time@10': 8.7008}:  80%|████████  | 8/10 [00:50<00:14,  7.02s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0318, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.875, 'compress@10': 0.8842, 'time@10': 9.2901}:  80%|████████  | 8/10 [00:57<00:14,  7.02s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0318, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.875, 'compress@10': 0.8842, 'time@10': 9.2901}:  90%|█████████ | 9/10 [00:57<00:07,  7.02s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.8803, 'compress@10': 0.8853, 'time@10': 9.3473}:  90%|█████████ | 9/10 [01:07<00:07,  7.02s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.8803, 'compress@10': 0.8853, 'time@10': 9.3473}: 100%|██████████| 10/10 [01:07<00:00,  7.91s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.8803, 'compress@10': 0.8853, 'time@10': 9.3473}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.0309799642549849
Avg hit ratio: 0.8927329859350233
Avg ndcg: 0.8802558613463131
Avg compression ratio: 0.8853387949259449
Avg train time: 9.347250747680665
Std train time: 3.2279494942194407
[0.9666666666666666, 0.9666666666666666, 0.09999999999999999, 0.9666666666666666, 0.9666666666666666, 0.9666666666666666, 0.9666666666666666, 0.9666666666666666, 0.9666666666666666, 0.9]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.848, 'compress@10': 0.9684, 'time@10': 8.2566}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.848, 'compress@10': 0.9684, 'time@10': 8.2566}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0365, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8815, 'compress@10': 0.9681, 'time@10': 7.6784}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0365, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8815, 'compress@10': 0.9681, 'time@10': 7.6784}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8734, 'compress@10': 0.7216, 'time@10': 6.8859}:  20%|██        | 2/10 [00:13<00:47,  5.91s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8734, 'compress@10': 0.7216, 'time@10': 6.8859}:  30%|███       | 3/10 [00:13<00:31,  4.44s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8748, 'compress@10': 0.7831, 'time@10': 6.6035}:  30%|███       | 3/10 [00:19<00:31,  4.44s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8748, 'compress@10': 0.7831, 'time@10': 6.6035}:  40%|████      | 4/10 [00:19<00:29,  4.98s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0312, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8665, 'compress@10': 0.82, 'time@10': 7.9111}:  40%|████      | 4/10 [00:26<00:29,  4.98s/it]  {'epoch': 14, 'num_users': 5.8, 'loss': 0.0312, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8665, 'compress@10': 0.82, 'time@10': 7.9111}:  50%|█████     | 5/10 [00:26<00:27,  5.56s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0308, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8729, 'compress@10': 0.8445, 'time@10': 8.216}:  50%|█████     | 5/10 [00:36<00:27,  5.56s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0308, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8729, 'compress@10': 0.8445, 'time@10': 8.216}:  60%|██████    | 6/10 [00:36<00:27,  7.00s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0304, 'hit_ratio@10': 0.876, 'ndcg@10': 0.8788, 'compress@10': 0.8622, 'time@10': 8.54}:  60%|██████    | 6/10 [00:41<00:27,  7.00s/it]  {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0304, 'hit_ratio@10': 0.876, 'ndcg@10': 0.8788, 'compress@10': 0.8622, 'time@10': 8.54}:  70%|███████   | 7/10 [00:41<00:19,  6.44s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0285, 'hit_ratio@10': 0.888, 'ndcg@10': 0.885, 'compress@10': 0.8754, 'time@10': 8.4149}:  70%|███████   | 7/10 [00:49<00:19,  6.44s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0285, 'hit_ratio@10': 0.888, 'ndcg@10': 0.885, 'compress@10': 0.8754, 'time@10': 8.4149}:  80%|████████  | 8/10 [00:49<00:13,  6.80s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0278, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8902, 'compress@10': 0.8856, 'time@10': 8.9395}:  80%|████████  | 8/10 [00:55<00:13,  6.80s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0278, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8902, 'compress@10': 0.8856, 'time@10': 8.9395}:  90%|█████████ | 9/10 [00:55<00:06,  6.74s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.8941, 'compress@10': 0.8873, 'time@10': 8.9997}:  90%|█████████ | 9/10 [01:05<00:06,  6.74s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.8941, 'compress@10': 0.8873, 'time@10': 8.9997}: 100%|██████████| 10/10 [01:05<00:00,  7.61s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.8941, 'compress@10': 0.8873, 'time@10': 8.9997}: 100%|██████████| 10/10 [01:05<00:00,  6.52s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.027501349194575697
Avg hit ratio: 0.8795333201037785
Avg ndcg: 0.8941074049861981
Avg compression ratio: 0.8872679849414308
Avg train time: 8.999698138237
Std train time: 2.6039741009131423
[0.9687499999999999, 0.9687499999999999, 0.09374999999999999, 0.9687499999999999, 0.9687499999999999, 0.9687499999999999, 0.9687499999999999, 0.9687499999999999, 0.9687499999999999, 0.90625]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0367, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8716, 'compress@10': 0.9704, 'time@10': 8.0363}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0367, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8716, 'compress@10': 0.9704, 'time@10': 8.0363}:  10%|█         | 1/10 [00:04<00:36,  4.05s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0308, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8973, 'compress@10': 0.9701, 'time@10': 7.3845}:  10%|█         | 1/10 [00:10<00:36,  4.05s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0308, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8973, 'compress@10': 0.9701, 'time@10': 7.3845}:  20%|██        | 2/10 [00:10<00:45,  5.65s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8839, 'compress@10': 0.7211, 'time@10': 6.6801}:  20%|██        | 2/10 [00:13<00:45,  5.65s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8839, 'compress@10': 0.7211, 'time@10': 6.6801}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.885, 'compress@10': 0.7833, 'time@10': 6.5354}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.885, 'compress@10': 0.7833, 'time@10': 6.5354}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0277, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8749, 'compress@10': 0.8205, 'time@10': 7.8631}:  40%|████      | 4/10 [00:26<00:30,  5.03s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0277, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8749, 'compress@10': 0.8205, 'time@10': 7.8631}:  50%|█████     | 5/10 [00:26<00:28,  5.60s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0269, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8812, 'compress@10': 0.8453, 'time@10': 8.1913}:  50%|█████     | 5/10 [00:36<00:28,  5.60s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0269, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8812, 'compress@10': 0.8453, 'time@10': 8.1913}:  60%|██████    | 6/10 [00:36<00:28,  7.05s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0273, 'hit_ratio@10': 0.876, 'ndcg@10': 0.8811, 'compress@10': 0.8631, 'time@10': 8.5284}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0273, 'hit_ratio@10': 0.876, 'ndcg@10': 0.8811, 'compress@10': 0.8631, 'time@10': 8.5284}:  70%|███████   | 7/10 [00:41<00:19,  6.48s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0261, 'hit_ratio@10': 0.888, 'ndcg@10': 0.8874, 'compress@10': 0.8765, 'time@10': 8.3976}:  70%|███████   | 7/10 [00:48<00:19,  6.48s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0261, 'hit_ratio@10': 0.888, 'ndcg@10': 0.8874, 'compress@10': 0.8765, 'time@10': 8.3976}:  80%|████████  | 8/10 [00:48<00:13,  6.81s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0264, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.8955, 'compress@10': 0.8868, 'time@10': 8.9321}:  80%|████████  | 8/10 [00:55<00:13,  6.81s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0264, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.8955, 'compress@10': 0.8868, 'time@10': 8.9321}:  90%|█████████ | 9/10 [00:55<00:06,  6.76s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8999, 'compress@10': 0.889, 'time@10': 8.9938}:  90%|█████████ | 9/10 [01:05<00:06,  6.76s/it]    {'epoch': 15, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8999, 'compress@10': 0.889, 'time@10': 8.9938}: 100%|██████████| 10/10 [01:05<00:00,  7.63s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8999, 'compress@10': 0.889, 'time@10': 8.9938}: 100%|██████████| 10/10 [01:05<00:00,  6.52s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.02571705250491694
Avg hit ratio: 0.8823904629609214
Avg ndcg: 0.8998535822235046
Avg compression ratio: 0.8889646354002207
Avg train time: 8.993840289115905
Std train time: 2.630660378317971
[0.9705882352941175, 0.9705882352941175, 0.08823529411764705, 0.9705882352941175, 0.9705882352941175, 0.9705882352941175, 0.9705882352941175, 0.9705882352941175, 0.9705882352941175, 0.9117647058823529]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8731, 'compress@10': 0.9721, 'time@10': 8.1541}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8731, 'compress@10': 0.9721, 'time@10': 8.1541}:  10%|█         | 1/10 [00:04<00:37,  4.11s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8986, 'compress@10': 0.9718, 'time@10': 7.4242}:  10%|█         | 1/10 [00:10<00:37,  4.11s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8986, 'compress@10': 0.9718, 'time@10': 7.4242}:  20%|██        | 2/10 [00:10<00:45,  5.65s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8848, 'compress@10': 0.7207, 'time@10': 6.7177}:  20%|██        | 2/10 [00:13<00:45,  5.65s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8848, 'compress@10': 0.7207, 'time@10': 6.7177}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8871, 'compress@10': 0.7834, 'time@10': 6.5244}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8871, 'compress@10': 0.7834, 'time@10': 6.5244}:  40%|████      | 4/10 [00:19<00:29,  4.96s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8776, 'compress@10': 0.821, 'time@10': 7.8581}:  40%|████      | 4/10 [00:26<00:29,  4.96s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8776, 'compress@10': 0.821, 'time@10': 7.8581}:  50%|█████     | 5/10 [00:26<00:27,  5.57s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0277, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8842, 'compress@10': 0.846, 'time@10': 8.2485}:  50%|█████     | 5/10 [00:36<00:27,  5.57s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0277, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8842, 'compress@10': 0.846, 'time@10': 8.2485}:  60%|██████    | 6/10 [00:36<00:28,  7.16s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.027, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8872, 'compress@10': 0.864, 'time@10': 8.7129}:  60%|██████    | 6/10 [00:42<00:28,  7.16s/it] {'epoch': 16, 'num_users': 6.2857, 'loss': 0.027, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8872, 'compress@10': 0.864, 'time@10': 8.7129}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.026, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.8923, 'compress@10': 0.8774, 'time@10': 8.5639}:  70%|███████   | 7/10 [00:49<00:20,  6.71s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.026, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.8923, 'compress@10': 0.8774, 'time@10': 8.5639}:  80%|████████  | 8/10 [00:49<00:13,  6.98s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9002, 'compress@10': 0.8879, 'time@10': 9.0793}:  80%|████████  | 8/10 [00:56<00:13,  6.98s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9002, 'compress@10': 0.8879, 'time@10': 9.0793}:  90%|█████████ | 9/10 [00:56<00:06,  6.87s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0263, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9032, 'compress@10': 0.8904, 'time@10': 9.1327}:  90%|█████████ | 9/10 [01:06<00:06,  6.87s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0263, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9032, 'compress@10': 0.8904, 'time@10': 9.1327}: 100%|██████████| 10/10 [01:06<00:00,  7.73s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0263, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9032, 'compress@10': 0.8904, 'time@10': 9.1327}: 100%|██████████| 10/10 [01:06<00:00,  6.60s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.026257642111669328
Avg hit ratio: 0.898447271649309
Avg ndcg: 0.9032431407565136
Avg compression ratio: 0.8904454533818912
Avg train time: 9.132651305198669
Std train time: 2.726494622210063
[0.9722222222222221, 0.9722222222222221, 0.08333333333333333, 0.9722222222222221, 0.9722222222222221, 0.9722222222222221, 0.9722222222222221, 0.9722222222222221, 0.9722222222222221, 0.9166666666666666]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8804, 'compress@10': 0.9737, 'time@10': 7.7676}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8804, 'compress@10': 0.9737, 'time@10': 7.7676}:  10%|█         | 1/10 [00:03<00:35,  3.92s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9002, 'compress@10': 0.9734, 'time@10': 7.296}:  10%|█         | 1/10 [00:10<00:35,  3.92s/it] {'epoch': 17, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9002, 'compress@10': 0.9734, 'time@10': 7.296}:  20%|██        | 2/10 [00:10<00:45,  5.65s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8858, 'compress@10': 0.7204, 'time@10': 6.6666}:  20%|██        | 2/10 [00:13<00:45,  5.65s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8858, 'compress@10': 0.7204, 'time@10': 6.6666}:  30%|███       | 3/10 [00:13<00:30,  4.32s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.889, 'compress@10': 0.7836, 'time@10': 6.5197}:  30%|███       | 3/10 [00:19<00:30,  4.32s/it]  {'epoch': 17, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.889, 'compress@10': 0.7836, 'time@10': 6.5197}:  40%|████      | 4/10 [00:19<00:30,  5.04s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.025, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8811, 'compress@10': 0.8214, 'time@10': 7.8452}:  40%|████      | 4/10 [00:26<00:30,  5.04s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.025, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8811, 'compress@10': 0.8214, 'time@10': 7.8452}:  50%|█████     | 5/10 [00:26<00:28,  5.61s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0254, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.8873, 'compress@10': 0.8466, 'time@10': 8.1575}:  50%|█████     | 5/10 [00:36<00:28,  5.61s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0254, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.8873, 'compress@10': 0.8466, 'time@10': 8.1575}:  60%|██████    | 6/10 [00:36<00:28,  7.02s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0258, 'hit_ratio@10': 0.904, 'ndcg@10': 0.89, 'compress@10': 0.8647, 'time@10': 8.5019}:  60%|██████    | 6/10 [00:41<00:28,  7.02s/it]   {'epoch': 17, 'num_users': 6.2857, 'loss': 0.0258, 'hit_ratio@10': 0.904, 'ndcg@10': 0.89, 'compress@10': 0.8647, 'time@10': 8.5019}:  70%|███████   | 7/10 [00:41<00:19,  6.46s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0249, 'hit_ratio@10': 0.9124, 'ndcg@10': 0.8946, 'compress@10': 0.8783, 'time@10': 8.3824}:  70%|███████   | 7/10 [00:48<00:19,  6.46s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0249, 'hit_ratio@10': 0.9124, 'ndcg@10': 0.8946, 'compress@10': 0.8783, 'time@10': 8.3824}:  80%|████████  | 8/10 [00:48<00:13,  6.82s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.025, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9008, 'compress@10': 0.8888, 'time@10': 8.9228}:  80%|████████  | 8/10 [00:55<00:13,  6.82s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.025, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9008, 'compress@10': 0.8888, 'time@10': 8.9228}:  90%|█████████ | 9/10 [00:55<00:06,  6.77s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9061, 'compress@10': 0.8918, 'time@10': 8.9957}:  90%|█████████ | 9/10 [01:05<00:06,  6.77s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9061, 'compress@10': 0.8918, 'time@10': 8.9957}: 100%|██████████| 10/10 [01:05<00:00,  7.67s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9061, 'compress@10': 0.8918, 'time@10': 8.9957}: 100%|██████████| 10/10 [01:05<00:00,  6.53s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02345394362933843
Avg hit ratio: 0.9076536208556583
Avg ndcg: 0.9060660195133373
Avg compression ratio: 0.8917721204010667
Avg train time: 8.995729207992554
Std train time: 2.6159588185058684
[0.9736842105263157, 0.9736842105263157, 0.07894736842105263, 0.9736842105263157, 0.9736842105263157, 0.9736842105263157, 0.9736842105263157, 0.9736842105263157, 0.9736842105263157, 0.9210526315789473]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8725, 'compress@10': 0.9751, 'time@10': 7.7284}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8725, 'compress@10': 0.9751, 'time@10': 7.7284}:  10%|█         | 1/10 [00:03<00:35,  3.90s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9011, 'compress@10': 0.9748, 'time@10': 7.1819}:  10%|█         | 1/10 [00:10<00:35,  3.90s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9011, 'compress@10': 0.9748, 'time@10': 7.1819}:  20%|██        | 2/10 [00:10<00:44,  5.53s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8864, 'compress@10': 0.72, 'time@10': 6.5754}:  20%|██        | 2/10 [00:13<00:44,  5.53s/it]  {'epoch': 18, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8864, 'compress@10': 0.72, 'time@10': 6.5754}:  30%|███       | 3/10 [00:13<00:29,  4.25s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8928, 'compress@10': 0.7837, 'time@10': 6.4152}:  30%|███       | 3/10 [00:19<00:29,  4.25s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8928, 'compress@10': 0.7837, 'time@10': 6.4152}:  40%|████      | 4/10 [00:19<00:30,  5.07s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8851, 'compress@10': 0.8218, 'time@10': 7.761}:  40%|████      | 4/10 [00:26<00:30,  5.07s/it] {'epoch': 18, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8851, 'compress@10': 0.8218, 'time@10': 7.761}:  50%|█████     | 5/10 [00:26<00:28,  5.62s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0233, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.8944, 'compress@10': 0.8472, 'time@10': 8.0932}:  50%|█████     | 5/10 [00:36<00:28,  5.62s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0233, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.8944, 'compress@10': 0.8472, 'time@10': 8.0932}:  60%|██████    | 6/10 [00:36<00:28,  7.04s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0241, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.8926, 'compress@10': 0.8654, 'time@10': 8.4618}:  60%|██████    | 6/10 [00:41<00:28,  7.04s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0241, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.8926, 'compress@10': 0.8654, 'time@10': 8.4618}:  70%|███████   | 7/10 [00:41<00:19,  6.50s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0236, 'hit_ratio@10': 0.9152, 'ndcg@10': 0.8961, 'compress@10': 0.879, 'time@10': 8.3331}:  70%|███████   | 7/10 [00:48<00:19,  6.50s/it]  {'epoch': 18, 'num_users': 6.125, 'loss': 0.0236, 'hit_ratio@10': 0.9152, 'ndcg@10': 0.8961, 'compress@10': 0.879, 'time@10': 8.3331}:  80%|████████  | 8/10 [00:48<00:13,  6.81s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0232, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9032, 'compress@10': 0.8896, 'time@10': 8.8617}:  80%|████████  | 8/10 [00:55<00:13,  6.81s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0232, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9032, 'compress@10': 0.8896, 'time@10': 8.8617}:  90%|█████████ | 9/10 [00:55<00:06,  6.74s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0243, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.902, 'compress@10': 0.893, 'time@10': 8.9239}:  90%|█████████ | 9/10 [01:04<00:06,  6.74s/it]     {'epoch': 18, 'num_users': 6.3, 'loss': 0.0243, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.902, 'compress@10': 0.893, 'time@10': 8.9239}: 100%|██████████| 10/10 [01:04<00:00,  7.60s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0243, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.902, 'compress@10': 0.893, 'time@10': 8.9239}: 100%|██████████| 10/10 [01:04<00:00,  6.50s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.024255745226744917
Avg hit ratio: 0.9047459729480105
Avg ndcg: 0.9020361363937643
Avg compression ratio: 0.8929562776748012
Avg train time: 8.923885774612426
Std train time: 2.641081758023095
[0.9749999999999999, 0.9749999999999999, 0.075, 0.9749999999999999, 0.9749999999999999, 0.9749999999999999, 0.9749999999999999, 0.9749999999999999, 0.9749999999999999, 0.9249999999999999]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8838, 'compress@10': 0.9763, 'time@10': 7.76}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8838, 'compress@10': 0.9763, 'time@10': 7.76}:  10%|█         | 1/10 [00:03<00:35,  3.93s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9123, 'compress@10': 0.976, 'time@10': 7.2549}:  10%|█         | 1/10 [00:10<00:35,  3.93s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9123, 'compress@10': 0.976, 'time@10': 7.2549}:  20%|██        | 2/10 [00:10<00:44,  5.61s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8939, 'compress@10': 0.7197, 'time@10': 6.918}:  20%|██        | 2/10 [00:13<00:44,  5.61s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8939, 'compress@10': 0.7197, 'time@10': 6.918}:  30%|███       | 3/10 [00:13<00:31,  4.49s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9001, 'compress@10': 0.7838, 'time@10': 6.725}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]  {'epoch': 19, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9001, 'compress@10': 0.7838, 'time@10': 6.725}:  40%|████      | 4/10 [00:20<00:30,  5.16s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0223, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.8947, 'compress@10': 0.8221, 'time@10': 7.9791}:  40%|████      | 4/10 [00:26<00:30,  5.16s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0223, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.8947, 'compress@10': 0.8221, 'time@10': 7.9791}:  50%|█████     | 5/10 [00:26<00:28,  5.66s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.9022, 'compress@10': 0.8477, 'time@10': 8.2492}:  50%|█████     | 5/10 [00:36<00:28,  5.66s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.9022, 'compress@10': 0.8477, 'time@10': 8.2492}:  60%|██████    | 6/10 [00:36<00:28,  7.01s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.023, 'hit_ratio@10': 0.9204, 'ndcg@10': 0.9052, 'compress@10': 0.866, 'time@10': 8.632}:  60%|██████    | 6/10 [00:41<00:28,  7.01s/it]   {'epoch': 19, 'num_users': 6.2857, 'loss': 0.023, 'hit_ratio@10': 0.9204, 'ndcg@10': 0.9052, 'compress@10': 0.866, 'time@10': 8.632}:  70%|███████   | 7/10 [00:41<00:19,  6.52s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.9268, 'ndcg@10': 0.9076, 'compress@10': 0.8797, 'time@10': 8.4801}:  70%|███████   | 7/10 [00:49<00:19,  6.52s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.9268, 'ndcg@10': 0.9076, 'compress@10': 0.8797, 'time@10': 8.4801}:  80%|████████  | 8/10 [00:49<00:13,  6.81s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9132, 'compress@10': 0.8904, 'time@10': 9.0286}:  80%|████████  | 8/10 [00:55<00:13,  6.81s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9132, 'compress@10': 0.8904, 'time@10': 9.0286}:  90%|█████████ | 9/10 [00:55<00:06,  6.79s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.021, 'hit_ratio@10': 0.9191, 'ndcg@10': 0.9185, 'compress@10': 0.894, 'time@10': 9.0663}:  90%|█████████ | 9/10 [01:05<00:06,  6.79s/it]     {'epoch': 19, 'num_users': 6.3, 'loss': 0.021, 'hit_ratio@10': 0.9191, 'ndcg@10': 0.9185, 'compress@10': 0.894, 'time@10': 9.0663}: 100%|██████████| 10/10 [01:05<00:00,  7.61s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.021, 'hit_ratio@10': 0.9191, 'ndcg@10': 0.9185, 'compress@10': 0.894, 'time@10': 9.0663}: 100%|██████████| 10/10 [01:05<00:00,  6.54s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.021038902455394384
Avg hit ratio: 0.9191390009726172
Avg ndcg: 0.9185014893165159
Avg compression ratio: 0.8940208774414758
Avg train time: 9.066339015960693
Std train time: 2.5400853899051974
[0.976190476190476, 0.976190476190476, 0.07142857142857142, 0.976190476190476, 0.976190476190476, 0.976190476190476, 0.976190476190476, 0.976190476190476, 0.976190476190476, 0.9285714285714285]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8884, 'compress@10': 0.9774, 'time@10': 7.4553}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8884, 'compress@10': 0.9774, 'time@10': 7.4553}:  10%|█         | 1/10 [00:03<00:34,  3.79s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9211, 'compress@10': 0.9772, 'time@10': 6.9938}:  10%|█         | 1/10 [00:10<00:34,  3.79s/it] {'epoch': 20, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9211, 'compress@10': 0.9772, 'time@10': 6.9938}:  20%|██        | 2/10 [00:10<00:43,  5.43s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8998, 'compress@10': 0.7195, 'time@10': 6.4385}:  20%|██        | 2/10 [00:13<00:43,  5.43s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8998, 'compress@10': 0.7195, 'time@10': 6.4385}:  30%|███       | 3/10 [00:13<00:29,  4.18s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.91, 'compress@10': 0.7839, 'time@10': 6.2735}:  30%|███       | 3/10 [00:18<00:29,  4.18s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.91, 'compress@10': 0.7839, 'time@10': 6.2735}:  40%|████      | 4/10 [00:18<00:28,  4.83s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.9119, 'ndcg@10': 0.9041, 'compress@10': 0.8224, 'time@10': 7.63}:  40%|████      | 4/10 [00:25<00:28,  4.83s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.9119, 'ndcg@10': 0.9041, 'compress@10': 0.8224, 'time@10': 7.63}:  50%|█████     | 5/10 [00:25<00:27,  5.46s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0208, 'hit_ratio@10': 0.9192, 'ndcg@10': 0.9113, 'compress@10': 0.8481, 'time@10': 7.927}:  50%|█████     | 5/10 [00:34<00:27,  5.46s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0208, 'hit_ratio@10': 0.9192, 'ndcg@10': 0.9113, 'compress@10': 0.8481, 'time@10': 7.927}:  60%|██████    | 6/10 [00:34<00:27,  6.81s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0225, 'hit_ratio@10': 0.925, 'ndcg@10': 0.9086, 'compress@10': 0.8666, 'time@10': 8.2525}:  60%|██████    | 6/10 [00:40<00:27,  6.81s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0225, 'hit_ratio@10': 0.925, 'ndcg@10': 0.9086, 'compress@10': 0.8666, 'time@10': 8.2525}:  70%|███████   | 7/10 [00:40<00:18,  6.27s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0217, 'hit_ratio@10': 0.9308, 'ndcg@10': 0.9127, 'compress@10': 0.8804, 'time@10': 8.1222}:  70%|███████   | 7/10 [00:47<00:18,  6.27s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0217, 'hit_ratio@10': 0.9308, 'ndcg@10': 0.9127, 'compress@10': 0.8804, 'time@10': 8.1222}:  80%|████████  | 8/10 [00:47<00:13,  6.58s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9204, 'compress@10': 0.8911, 'time@10': 8.6934}:  80%|████████  | 8/10 [00:53<00:13,  6.58s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9204, 'compress@10': 0.8911, 'time@10': 8.6934}:  90%|█████████ | 9/10 [00:53<00:06,  6.61s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0229, 'hit_ratio@10': 0.9195, 'ndcg@10': 0.9251, 'compress@10': 0.895, 'time@10': 8.74}:  90%|█████████ | 9/10 [01:03<00:06,  6.61s/it]      {'epoch': 20, 'num_users': 6.3, 'loss': 0.0229, 'hit_ratio@10': 0.9195, 'ndcg@10': 0.9251, 'compress@10': 0.895, 'time@10': 8.74}: 100%|██████████| 10/10 [01:03<00:00,  7.41s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0229, 'hit_ratio@10': 0.9195, 'ndcg@10': 0.9251, 'compress@10': 0.895, 'time@10': 8.74}: 100%|██████████| 10/10 [01:03<00:00,  6.32s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.022920392625960725
Avg hit ratio: 0.9195076645670873
Avg ndcg: 0.9250558443376617
Avg compression ratio: 0.8949829875549286
Avg train time: 8.739990496635437
Std train time: 2.6671004986081055
[0.9772727272727272, 0.9772727272727272, 0.06818181818181818, 0.9772727272727272, 0.9772727272727272, 0.9772727272727272, 0.9772727272727272, 0.9772727272727272, 0.9772727272727272, 0.9318181818181818]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0275, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.89, 'compress@10': 0.9785, 'time@10': 7.6696}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0275, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.89, 'compress@10': 0.9785, 'time@10': 7.6696}:  10%|█         | 1/10 [00:03<00:34,  3.87s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9233, 'compress@10': 0.9782, 'time@10': 7.0514}:  10%|█         | 1/10 [00:10<00:34,  3.87s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9233, 'compress@10': 0.9782, 'time@10': 7.0514}:  20%|██        | 2/10 [00:10<00:43,  5.40s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9012, 'compress@10': 0.7192, 'time@10': 6.4656}:  20%|██        | 2/10 [00:13<00:43,  5.40s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9012, 'compress@10': 0.7192, 'time@10': 6.4656}:  30%|███       | 3/10 [00:13<00:29,  4.16s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9109, 'compress@10': 0.784, 'time@10': 6.2452}:  30%|███       | 3/10 [00:18<00:29,  4.16s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9109, 'compress@10': 0.784, 'time@10': 6.2452}:  40%|████      | 4/10 [00:18<00:28,  4.74s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0189, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9067, 'compress@10': 0.8227, 'time@10': 7.5083}:  40%|████      | 4/10 [00:24<00:28,  4.74s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0189, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9067, 'compress@10': 0.8227, 'time@10': 7.5083}:  50%|█████     | 5/10 [00:24<00:26,  5.31s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0177, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9153, 'compress@10': 0.8485, 'time@10': 7.8007}:  50%|█████     | 5/10 [00:34<00:26,  5.31s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0177, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9153, 'compress@10': 0.8485, 'time@10': 7.8007}:  60%|██████    | 6/10 [00:34<00:26,  6.67s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9125, 'compress@10': 0.8671, 'time@10': 8.1267}:  60%|██████    | 6/10 [00:39<00:26,  6.67s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9125, 'compress@10': 0.8671, 'time@10': 8.1267}:  70%|███████   | 7/10 [00:39<00:18,  6.15s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9162, 'ndcg@10': 0.9144, 'compress@10': 0.8809, 'time@10': 8.0141}:  70%|███████   | 7/10 [00:46<00:18,  6.15s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9162, 'ndcg@10': 0.9144, 'compress@10': 0.8809, 'time@10': 8.0141}:  80%|████████  | 8/10 [00:46<00:13,  6.50s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0215, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9356, 'compress@10': 0.8917, 'time@10': 8.6117}:  80%|████████  | 8/10 [00:53<00:13,  6.50s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0215, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9356, 'compress@10': 0.8917, 'time@10': 8.6117}:  90%|█████████ | 9/10 [00:53<00:06,  6.57s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9373, 'compress@10': 0.8959, 'time@10': 8.6688}:  90%|█████████ | 9/10 [01:02<00:06,  6.57s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9373, 'compress@10': 0.8959, 'time@10': 8.6688}: 100%|██████████| 10/10 [01:02<00:00,  7.40s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9373, 'compress@10': 0.8959, 'time@10': 8.6688}: 100%|██████████| 10/10 [01:02<00:00,  6.26s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.021703619032841823
Avg hit ratio: 0.9078302452122486
Avg ndcg: 0.9372940032390886
Avg compression ratio: 0.895859842419419
Avg train time: 8.668826866149903
Std train time: 2.6279116749628293
[0.9782608695652173, 0.9782608695652173, 0.06521739130434782, 0.9782608695652173, 0.9782608695652173, 0.9782608695652173, 0.9782608695652173, 0.9782608695652173, 0.9782608695652173, 0.9347826086956521]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8922, 'compress@10': 0.9794, 'time@10': 7.6761}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8922, 'compress@10': 0.9794, 'time@10': 7.6761}:  10%|█         | 1/10 [00:03<00:34,  3.88s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9289, 'compress@10': 0.9792, 'time@10': 7.0572}:  10%|█         | 1/10 [00:10<00:34,  3.88s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9289, 'compress@10': 0.9792, 'time@10': 7.0572}:  20%|██        | 2/10 [00:10<00:43,  5.41s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.905, 'compress@10': 0.719, 'time@10': 6.545}:  20%|██        | 2/10 [00:13<00:43,  5.41s/it]   {'epoch': 22, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.905, 'compress@10': 0.719, 'time@10': 6.545}:  30%|███       | 3/10 [00:13<00:29,  4.22s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9171, 'compress@10': 0.784, 'time@10': 6.2995}:  30%|███       | 3/10 [00:18<00:29,  4.22s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9171, 'compress@10': 0.784, 'time@10': 6.2995}:  40%|████      | 4/10 [00:18<00:28,  4.76s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9132, 'compress@10': 0.823, 'time@10': 7.534}:  40%|████      | 4/10 [00:25<00:28,  4.76s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9132, 'compress@10': 0.823, 'time@10': 7.534}:  50%|█████     | 5/10 [00:25<00:26,  5.31s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0203, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9235, 'compress@10': 0.8489, 'time@10': 7.8361}:  50%|█████     | 5/10 [00:34<00:26,  5.31s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0203, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9235, 'compress@10': 0.8489, 'time@10': 7.8361}:  60%|██████    | 6/10 [00:34<00:26,  6.69s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0206, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.926, 'compress@10': 0.8675, 'time@10': 8.1392}:  60%|██████    | 6/10 [00:39<00:26,  6.69s/it] {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0206, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.926, 'compress@10': 0.8675, 'time@10': 8.1392}:  70%|███████   | 7/10 [00:39<00:18,  6.15s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0201, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.928, 'compress@10': 0.8814, 'time@10': 7.9919}:  70%|███████   | 7/10 [00:46<00:18,  6.15s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0201, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.928, 'compress@10': 0.8814, 'time@10': 7.9919}:  80%|████████  | 8/10 [00:46<00:12,  6.42s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0243, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.927, 'compress@10': 0.8923, 'time@10': 8.5541}:  80%|████████  | 8/10 [00:52<00:12,  6.42s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0243, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.927, 'compress@10': 0.8923, 'time@10': 8.5541}:  90%|█████████ | 9/10 [00:52<00:06,  6.46s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9318, 'compress@10': 0.8967, 'time@10': 8.6016}:  90%|█████████ | 9/10 [01:02<00:06,  6.46s/it]  {'epoch': 22, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9318, 'compress@10': 0.8967, 'time@10': 8.6016}: 100%|██████████| 10/10 [01:02<00:00,  7.27s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9318, 'compress@10': 0.8967, 'time@10': 8.6016}: 100%|██████████| 10/10 [01:02<00:00,  6.21s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.022409007779275483
Avg hit ratio: 0.8981354167432265
Avg ndcg: 0.9318435217568546
Avg compression ratio: 0.8966604713699594
Avg train time: 8.60158567428589
Std train time: 2.535931518405939
[0.9791666666666665, 0.9791666666666665, 0.0625, 0.9791666666666665, 0.9791666666666665, 0.9791666666666665, 0.9791666666666665, 0.9791666666666665, 0.9791666666666665, 0.9374999999999999]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8982, 'compress@10': 0.9802, 'time@10': 7.3754}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8982, 'compress@10': 0.9802, 'time@10': 7.3754}:  10%|█         | 1/10 [00:03<00:33,  3.72s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9307, 'compress@10': 0.98, 'time@10': 6.7628}:  10%|█         | 1/10 [00:09<00:33,  3.72s/it]  {'epoch': 23, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9307, 'compress@10': 0.98, 'time@10': 6.7628}:  20%|██        | 2/10 [00:09<00:41,  5.17s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9062, 'compress@10': 0.7188, 'time@10': 6.2588}:  20%|██        | 2/10 [00:12<00:41,  5.17s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9062, 'compress@10': 0.7188, 'time@10': 6.2588}:  30%|███       | 3/10 [00:12<00:28,  4.03s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9182, 'compress@10': 0.7841, 'time@10': 6.066}:  30%|███       | 3/10 [00:18<00:28,  4.03s/it]  {'epoch': 23, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9182, 'compress@10': 0.7841, 'time@10': 6.066}:  40%|████      | 4/10 [00:18<00:27,  4.62s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9148, 'compress@10': 0.8232, 'time@10': 7.3014}:  40%|████      | 4/10 [00:24<00:27,  4.62s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9148, 'compress@10': 0.8232, 'time@10': 7.3014}:  50%|█████     | 5/10 [00:24<00:25,  5.17s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0173, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9199, 'compress@10': 0.8493, 'time@10': 7.5798}:  50%|█████     | 5/10 [00:33<00:25,  5.17s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0173, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9199, 'compress@10': 0.8493, 'time@10': 7.5798}:  60%|██████    | 6/10 [00:33<00:25,  6.48s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.919, 'compress@10': 0.8679, 'time@10': 7.9096}:  60%|██████    | 6/10 [00:38<00:25,  6.48s/it] {'epoch': 23, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.919, 'compress@10': 0.8679, 'time@10': 7.9096}:  70%|███████   | 7/10 [00:38<00:17,  5.99s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0173, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9227, 'compress@10': 0.8819, 'time@10': 7.7782}:  70%|███████   | 7/10 [00:45<00:17,  5.99s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0173, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9227, 'compress@10': 0.8819, 'time@10': 7.7782}:  80%|████████  | 8/10 [00:45<00:12,  6.28s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9228, 'compress@10': 0.8928, 'time@10': 8.3348}:  80%|████████  | 8/10 [00:51<00:12,  6.28s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9228, 'compress@10': 0.8928, 'time@10': 8.3348}:  90%|█████████ | 9/10 [00:51<00:06,  6.32s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9239, 'compress@10': 0.8974, 'time@10': 8.3945}:  90%|█████████ | 9/10 [01:00<00:06,  6.32s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9239, 'compress@10': 0.8974, 'time@10': 8.3945}: 100%|██████████| 10/10 [01:00<00:00,  7.14s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9239, 'compress@10': 0.8974, 'time@10': 8.3945}: 100%|██████████| 10/10 [01:00<00:00,  6.05s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.020260426212275768
Avg hit ratio: 0.88625881664082
Avg ndcg: 0.9239287138640027
Avg compression ratio: 0.8973951673408915
Avg train time: 8.394486045837402
Std train time: 2.524527816311555
[0.9799999999999999, 0.9799999999999999, 0.06, 0.9799999999999999, 0.9799999999999999, 0.9799999999999999, 0.9799999999999999, 0.9799999999999999, 0.9799999999999999, 0.94]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9028, 'compress@10': 0.981, 'time@10': 7.7944}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9028, 'compress@10': 0.981, 'time@10': 7.7944}:  10%|█         | 1/10 [00:03<00:35,  3.93s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9327, 'compress@10': 0.9808, 'time@10': 6.9917}:  10%|█         | 1/10 [00:10<00:35,  3.93s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9327, 'compress@10': 0.9808, 'time@10': 6.9917}:  20%|██        | 2/10 [00:10<00:42,  5.28s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9075, 'compress@10': 0.7187, 'time@10': 6.3979}:  20%|██        | 2/10 [00:12<00:42,  5.28s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9075, 'compress@10': 0.7187, 'time@10': 6.3979}:  30%|███       | 3/10 [00:12<00:28,  4.08s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.92, 'compress@10': 0.7842, 'time@10': 6.1765}:  30%|███       | 3/10 [00:18<00:28,  4.08s/it]   {'epoch': 24, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.92, 'compress@10': 0.7842, 'time@10': 6.1765}:  40%|████      | 4/10 [00:18<00:28,  4.67s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0163, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9172, 'compress@10': 0.8234, 'time@10': 7.4138}:  40%|████      | 4/10 [00:24<00:28,  4.67s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0163, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9172, 'compress@10': 0.8234, 'time@10': 7.4138}:  50%|█████     | 5/10 [00:24<00:26,  5.23s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9251, 'compress@10': 0.8496, 'time@10': 7.7191}:  50%|█████     | 5/10 [00:33<00:26,  5.23s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9251, 'compress@10': 0.8496, 'time@10': 7.7191}:  60%|██████    | 6/10 [00:33<00:26,  6.61s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9281, 'compress@10': 0.8683, 'time@10': 8.0369}:  60%|██████    | 6/10 [00:38<00:26,  6.61s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9281, 'compress@10': 0.8683, 'time@10': 8.0369}:  70%|███████   | 7/10 [00:38<00:18,  6.09s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.9251, 'ndcg@10': 0.9281, 'compress@10': 0.8823, 'time@10': 7.8951}:  70%|███████   | 7/10 [00:45<00:18,  6.09s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.9251, 'ndcg@10': 0.9281, 'compress@10': 0.8823, 'time@10': 7.8951}:  80%|████████  | 8/10 [00:45<00:12,  6.36s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9462, 'compress@10': 0.8933, 'time@10': 8.4483}:  80%|████████  | 8/10 [00:52<00:12,  6.36s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9462, 'compress@10': 0.8933, 'time@10': 8.4483}:  90%|█████████ | 9/10 [00:52<00:06,  6.40s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9483, 'compress@10': 0.8981, 'time@10': 8.5691}:  90%|█████████ | 9/10 [01:02<00:06,  6.40s/it]  {'epoch': 24, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9483, 'compress@10': 0.8981, 'time@10': 8.5691}: 100%|██████████| 10/10 [01:02<00:00,  7.41s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9483, 'compress@10': 0.8981, 'time@10': 8.5691}: 100%|██████████| 10/10 [01:02<00:00,  6.20s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.01729445331512091
Avg hit ratio: 0.9177897946234109
Avg ndcg: 0.9482637984068256
Avg compression ratio: 0.8980706072472477
Avg train time: 8.569133639335632
Std train time: 2.5714203286762136
[0.9807692307692306, 0.9807692307692306, 0.05769230769230769, 0.9807692307692306, 0.9807692307692306, 0.9807692307692306, 0.9807692307692306, 0.9807692307692306, 0.9807692307692306, 0.9423076923076923]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9071, 'compress@10': 0.9818, 'time@10': 7.489}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9071, 'compress@10': 0.9818, 'time@10': 7.489}:  10%|█         | 1/10 [00:03<00:34,  3.78s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9419, 'compress@10': 0.9816, 'time@10': 6.8602}:  10%|█         | 1/10 [00:10<00:34,  3.78s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9419, 'compress@10': 0.9816, 'time@10': 6.8602}:  20%|██        | 2/10 [00:10<00:42,  5.25s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9136, 'compress@10': 0.7185, 'time@10': 6.3446}:  20%|██        | 2/10 [00:12<00:42,  5.25s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9136, 'compress@10': 0.7185, 'time@10': 6.3446}:  30%|███       | 3/10 [00:12<00:28,  4.08s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9259, 'compress@10': 0.7842, 'time@10': 6.1166}:  30%|███       | 3/10 [00:18<00:28,  4.08s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9259, 'compress@10': 0.7842, 'time@10': 6.1166}:  40%|████      | 4/10 [00:18<00:27,  4.63s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.923, 'compress@10': 0.8236, 'time@10': 7.371}:  40%|████      | 4/10 [00:24<00:27,  4.63s/it]  {'epoch': 25, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.923, 'compress@10': 0.8236, 'time@10': 7.371}:  50%|█████     | 5/10 [00:24<00:26,  5.21s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0181, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9332, 'compress@10': 0.8499, 'time@10': 7.6632}:  50%|█████     | 5/10 [00:33<00:26,  5.21s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0181, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9332, 'compress@10': 0.8499, 'time@10': 7.6632}:  60%|██████    | 6/10 [00:33<00:26,  6.55s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0193, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9303, 'compress@10': 0.8687, 'time@10': 7.9944}:  60%|██████    | 6/10 [00:38<00:26,  6.55s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0193, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9303, 'compress@10': 0.8687, 'time@10': 7.9944}:  70%|███████   | 7/10 [00:38<00:18,  6.05s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0181, 'hit_ratio@10': 0.9235, 'ndcg@10': 0.9341, 'compress@10': 0.8828, 'time@10': 7.8591}:  70%|███████   | 7/10 [00:45<00:18,  6.05s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0181, 'hit_ratio@10': 0.9235, 'ndcg@10': 0.9341, 'compress@10': 0.8828, 'time@10': 7.8591}:  80%|████████  | 8/10 [00:45<00:12,  6.34s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9329, 'compress@10': 0.8937, 'time@10': 8.4161}:  80%|████████  | 8/10 [00:52<00:12,  6.34s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9329, 'compress@10': 0.8937, 'time@10': 8.4161}:  90%|█████████ | 9/10 [00:52<00:06,  6.38s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.9194, 'ndcg@10': 0.9383, 'compress@10': 0.8987, 'time@10': 8.4576}:  90%|█████████ | 9/10 [01:00<00:06,  6.38s/it]  {'epoch': 25, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.9194, 'ndcg@10': 0.9383, 'compress@10': 0.8987, 'time@10': 8.4576}: 100%|██████████| 10/10 [01:00<00:00,  7.15s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.9194, 'ndcg@10': 0.9383, 'compress@10': 0.8987, 'time@10': 8.4576}: 100%|██████████| 10/10 [01:00<00:00,  6.09s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.01936425148177679
Avg hit ratio: 0.9194211310289407
Avg ndcg: 0.938296006874683
Avg compression ratio: 0.8986936584216835
Avg train time: 8.457642936706543
Std train time: 2.5527048445217067
[0.9814814814814813, 0.9814814814814813, 0.05555555555555555, 0.9814814814814813, 0.9814814814814813, 0.9814814814814813, 0.9814814814814813, 0.9814814814814813, 0.9814814814814813, 0.9444444444444444]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9089, 'compress@10': 0.9824, 'time@10': 7.2843}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9089, 'compress@10': 0.9824, 'time@10': 7.2843}:  10%|█         | 1/10 [00:03<00:33,  3.68s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9354, 'compress@10': 0.9822, 'time@10': 6.7294}:  10%|█         | 1/10 [00:09<00:33,  3.68s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9354, 'compress@10': 0.9822, 'time@10': 6.7294}:  20%|██        | 2/10 [00:09<00:41,  5.17s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9093, 'compress@10': 0.7183, 'time@10': 6.223}:  20%|██        | 2/10 [00:12<00:41,  5.17s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9093, 'compress@10': 0.7183, 'time@10': 6.223}:  30%|███       | 3/10 [00:12<00:28,  4.02s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9214, 'compress@10': 0.7843, 'time@10': 6.0424}:  30%|███       | 3/10 [00:18<00:28,  4.02s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9214, 'compress@10': 0.7843, 'time@10': 6.0424}:  40%|████      | 4/10 [00:18<00:27,  4.62s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9232, 'compress@10': 0.8238, 'time@10': 7.2677}:  40%|████      | 4/10 [00:24<00:27,  4.62s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9232, 'compress@10': 0.8238, 'time@10': 7.2677}:  50%|█████     | 5/10 [00:24<00:25,  5.16s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0126, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9298, 'compress@10': 0.8501, 'time@10': 7.5473}:  50%|█████     | 5/10 [00:33<00:25,  5.16s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0126, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9298, 'compress@10': 0.8501, 'time@10': 7.5473}:  60%|██████    | 6/10 [00:33<00:25,  6.46s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9304, 'compress@10': 0.869, 'time@10': 7.8662}:  60%|██████    | 6/10 [00:38<00:25,  6.46s/it] {'epoch': 26, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9304, 'compress@10': 0.869, 'time@10': 7.8662}:  70%|███████   | 7/10 [00:38<00:17,  5.96s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0135, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9316, 'compress@10': 0.8831, 'time@10': 7.7413}:  70%|███████   | 7/10 [00:45<00:17,  5.96s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0135, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9316, 'compress@10': 0.8831, 'time@10': 7.7413}:  80%|████████  | 8/10 [00:45<00:12,  6.26s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9486, 'compress@10': 0.8941, 'time@10': 8.2844}:  80%|████████  | 8/10 [00:51<00:12,  6.26s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9486, 'compress@10': 0.8941, 'time@10': 8.2844}:  90%|█████████ | 9/10 [00:51<00:06,  6.29s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9491, 'compress@10': 0.8993, 'time@10': 8.3394}:  90%|█████████ | 9/10 [01:00<00:06,  6.29s/it]  {'epoch': 26, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9491, 'compress@10': 0.8993, 'time@10': 8.3394}: 100%|██████████| 10/10 [01:00<00:00,  7.09s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9491, 'compress@10': 0.8993, 'time@10': 8.3394}: 100%|██████████| 10/10 [01:00<00:00,  6.02s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.017278307036793113
Avg hit ratio: 0.8951989088067187
Avg ndcg: 0.9491348670532765
Avg compression ratio: 0.8992706893348773
Avg train time: 8.339416456222533
Std train time: 2.4814730337349187
[0.982142857142857, 0.982142857142857, 0.05357142857142857, 0.982142857142857, 0.982142857142857, 0.982142857142857, 0.982142857142857, 0.982142857142857, 0.982142857142857, 0.9464285714285714]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9131, 'compress@10': 0.9831, 'time@10': 7.4641}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9131, 'compress@10': 0.9831, 'time@10': 7.4641}:  10%|█         | 1/10 [00:03<00:33,  3.77s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9369, 'compress@10': 0.9829, 'time@10': 6.834}:  10%|█         | 1/10 [00:10<00:33,  3.77s/it] {'epoch': 27, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9369, 'compress@10': 0.9829, 'time@10': 6.834}:  20%|██        | 2/10 [00:10<00:41,  5.22s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9103, 'compress@10': 0.7182, 'time@10': 6.2656}:  20%|██        | 2/10 [00:12<00:41,  5.22s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9103, 'compress@10': 0.7182, 'time@10': 6.2656}:  30%|███       | 3/10 [00:12<00:28,  4.03s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9222, 'compress@10': 0.7843, 'time@10': 6.0618}:  30%|███       | 3/10 [00:18<00:28,  4.03s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9222, 'compress@10': 0.7843, 'time@10': 6.0618}:  40%|████      | 4/10 [00:18<00:27,  4.60s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9219, 'compress@10': 0.824, 'time@10': 7.2488}:  40%|████      | 4/10 [00:24<00:27,  4.60s/it] {'epoch': 27, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9219, 'compress@10': 0.824, 'time@10': 7.2488}:  50%|█████     | 5/10 [00:24<00:25,  5.12s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9253, 'compress@10': 0.8504, 'time@10': 7.5354}:  50%|█████     | 5/10 [00:33<00:25,  5.12s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9253, 'compress@10': 0.8504, 'time@10': 7.5354}:  60%|██████    | 6/10 [00:33<00:25,  6.44s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.928, 'compress@10': 0.8693, 'time@10': 7.8504}:  60%|██████    | 6/10 [00:38<00:25,  6.44s/it] {'epoch': 27, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.928, 'compress@10': 0.8693, 'time@10': 7.8504}:  70%|███████   | 7/10 [00:38<00:17,  5.94s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.9235, 'ndcg@10': 0.929, 'compress@10': 0.8835, 'time@10': 7.7437}:  70%|███████   | 7/10 [00:45<00:17,  5.94s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.9235, 'ndcg@10': 0.929, 'compress@10': 0.8835, 'time@10': 7.7437}:  80%|████████  | 8/10 [00:45<00:12,  6.29s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.931, 'compress@10': 0.8945, 'time@10': 8.3595}:  80%|████████  | 8/10 [00:51<00:12,  6.29s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.931, 'compress@10': 0.8945, 'time@10': 8.3595}:  90%|█████████ | 9/10 [00:51<00:06,  6.41s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9356, 'compress@10': 0.8998, 'time@10': 8.4187}:  90%|█████████ | 9/10 [01:00<00:06,  6.41s/it]  {'epoch': 27, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9356, 'compress@10': 0.8998, 'time@10': 8.4187}: 100%|██████████| 10/10 [01:00<00:00,  7.21s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9356, 'compress@10': 0.8998, 'time@10': 8.4187}: 100%|██████████| 10/10 [01:00<00:00,  6.08s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.015313903404733722
Avg hit ratio: 0.916563988171798
Avg ndcg: 0.9355675106588185
Avg compression ratio: 0.8998040339713672
Avg train time: 8.418747472763062
Std train time: 2.5747954467167915
[0.982758620689655, 0.982758620689655, 0.05172413793103448, 0.982758620689655, 0.982758620689655, 0.982758620689655, 0.982758620689655, 0.982758620689655, 0.982758620689655, 0.9482758620689655]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9131, 'compress@10': 0.9836, 'time@10': 7.5237}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9131, 'compress@10': 0.9836, 'time@10': 7.5237}:  10%|█         | 1/10 [00:03<00:34,  3.80s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9457, 'compress@10': 0.9835, 'time@10': 6.8191}:  10%|█         | 1/10 [00:09<00:34,  3.80s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9457, 'compress@10': 0.9835, 'time@10': 6.8191}:  20%|██        | 2/10 [00:09<00:41,  5.18s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9162, 'compress@10': 0.718, 'time@10': 6.3786}:  20%|██        | 2/10 [00:12<00:41,  5.18s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9162, 'compress@10': 0.718, 'time@10': 6.3786}:  30%|███       | 3/10 [00:12<00:28,  4.09s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9282, 'compress@10': 0.7844, 'time@10': 6.1337}:  30%|███       | 3/10 [00:18<00:28,  4.09s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9282, 'compress@10': 0.7844, 'time@10': 6.1337}:  40%|████      | 4/10 [00:18<00:27,  4.62s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.9279, 'compress@10': 0.8241, 'time@10': 7.3303}:  40%|████      | 4/10 [00:24<00:27,  4.62s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.9279, 'compress@10': 0.8241, 'time@10': 7.3303}:  50%|█████     | 5/10 [00:24<00:25,  5.15s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9348, 'compress@10': 0.8506, 'time@10': 7.6102}:  50%|█████     | 5/10 [00:33<00:25,  5.15s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9348, 'compress@10': 0.8506, 'time@10': 7.6102}:  60%|██████    | 6/10 [00:33<00:25,  6.48s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9348, 'compress@10': 0.8696, 'time@10': 7.9087}:  60%|██████    | 6/10 [00:38<00:25,  6.48s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9348, 'compress@10': 0.8696, 'time@10': 7.9087}:  70%|███████   | 7/10 [00:38<00:17,  5.96s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9384, 'compress@10': 0.8838, 'time@10': 7.7687}:  70%|███████   | 7/10 [00:45<00:17,  5.96s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9384, 'compress@10': 0.8838, 'time@10': 7.7687}:  80%|████████  | 8/10 [00:45<00:12,  6.23s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.9515, 'compress@10': 0.8948, 'time@10': 8.2907}:  80%|████████  | 8/10 [00:51<00:12,  6.23s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.9515, 'compress@10': 0.8948, 'time@10': 8.2907}:  90%|█████████ | 9/10 [00:51<00:06,  6.24s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9521, 'compress@10': 0.9003, 'time@10': 8.3449}:  90%|█████████ | 9/10 [01:00<00:06,  6.24s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9521, 'compress@10': 0.9003, 'time@10': 8.3449}: 100%|██████████| 10/10 [01:00<00:00,  7.05s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9521, 'compress@10': 0.9003, 'time@10': 8.3449}: 100%|██████████| 10/10 [01:00<00:00,  6.02s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.01667995382938365
Avg hit ratio: 0.8800560516638616
Avg ndcg: 0.952088784482464
Avg compression ratio: 0.9003043674519027
Avg train time: 8.344910836219787
Std train time: 2.4204961564480234
[0.9833333333333332, 0.9833333333333332, 0.05, 0.9833333333333332, 0.9833333333333332, 0.9833333333333332, 0.9833333333333332, 0.9833333333333332, 0.9833333333333332, 0.95]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9191, 'compress@10': 0.9842, 'time@10': 7.2182}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9191, 'compress@10': 0.9842, 'time@10': 7.2182}:  10%|█         | 1/10 [00:03<00:32,  3.65s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9581, 'compress@10': 0.984, 'time@10': 6.6688}:  10%|█         | 1/10 [00:09<00:32,  3.65s/it] {'epoch': 29, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9581, 'compress@10': 0.984, 'time@10': 6.6688}:  20%|██        | 2/10 [00:09<00:41,  5.13s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9245, 'compress@10': 0.7179, 'time@10': 6.2604}:  20%|██        | 2/10 [00:12<00:41,  5.13s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9245, 'compress@10': 0.7179, 'time@10': 6.2604}:  30%|███       | 3/10 [00:12<00:28,  4.04s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9344, 'compress@10': 0.7844, 'time@10': 6.0656}:  30%|███       | 3/10 [00:18<00:28,  4.04s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9344, 'compress@10': 0.7844, 'time@10': 6.0656}:  40%|████      | 4/10 [00:18<00:27,  4.63s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0133, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.934, 'compress@10': 0.8243, 'time@10': 7.2791}:  40%|████      | 4/10 [00:24<00:27,  4.63s/it] {'epoch': 29, 'num_users': 5.8, 'loss': 0.0133, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.934, 'compress@10': 0.8243, 'time@10': 7.2791}:  50%|█████     | 5/10 [00:24<00:25,  5.16s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9394, 'compress@10': 0.8508, 'time@10': 7.5526}:  50%|█████     | 5/10 [00:33<00:25,  5.16s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9394, 'compress@10': 0.8508, 'time@10': 7.5526}:  60%|██████    | 6/10 [00:33<00:25,  6.45s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9387, 'compress@10': 0.8699, 'time@10': 7.8747}:  60%|██████    | 6/10 [00:38<00:25,  6.45s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9387, 'compress@10': 0.8699, 'time@10': 7.8747}:  70%|███████   | 7/10 [00:38<00:17,  5.96s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9396, 'compress@10': 0.8841, 'time@10': 7.7715}:  70%|███████   | 7/10 [00:45<00:17,  5.96s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9396, 'compress@10': 0.8841, 'time@10': 7.7715}:  80%|████████  | 8/10 [00:45<00:12,  6.32s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9388, 'compress@10': 0.8952, 'time@10': 8.2918}:  80%|████████  | 8/10 [00:51<00:12,  6.32s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9388, 'compress@10': 0.8952, 'time@10': 8.2918}:  90%|█████████ | 9/10 [00:51<00:06,  6.30s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9414, 'compress@10': 0.9008, 'time@10': 8.3499}:  90%|█████████ | 9/10 [01:00<00:06,  6.30s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9414, 'compress@10': 0.9008, 'time@10': 8.3499}: 100%|██████████| 10/10 [01:00<00:00,  7.11s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9414, 'compress@10': 0.9008, 'time@10': 8.3499}: 100%|██████████| 10/10 [01:00<00:00,  6.04s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.015875083383021762
Avg hit ratio: 0.8912183660519822
Avg ndcg: 0.9413645919371845
Avg compression ratio: 0.9007673410546676
Avg train time: 8.349910616874695
Std train time: 2.418843142061492
[0.9838709677419353, 0.9838709677419353, 0.048387096774193554, 0.9838709677419353, 0.9838709677419353, 0.9838709677419353, 0.9838709677419353, 0.9838709677419353, 0.9838709677419353, 0.9516129032258064]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9212, 'compress@10': 0.9847, 'time@10': 7.3596}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9212, 'compress@10': 0.9847, 'time@10': 7.3596}:  10%|█         | 1/10 [00:03<00:33,  3.72s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9416, 'compress@10': 0.9845, 'time@10': 6.7616}:  10%|█         | 1/10 [00:09<00:33,  3.72s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9416, 'compress@10': 0.9845, 'time@10': 6.7616}:  20%|██        | 2/10 [00:09<00:41,  5.18s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9134, 'compress@10': 0.7178, 'time@10': 6.3439}:  20%|██        | 2/10 [00:12<00:41,  5.18s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9134, 'compress@10': 0.7178, 'time@10': 6.3439}:  30%|███       | 3/10 [00:12<00:28,  4.09s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9261, 'compress@10': 0.7845, 'time@10': 6.1556}:  30%|███       | 3/10 [00:18<00:28,  4.09s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9261, 'compress@10': 0.7845, 'time@10': 6.1556}:  40%|████      | 4/10 [00:18<00:28,  4.70s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9276, 'compress@10': 0.8244, 'time@10': 7.3038}:  40%|████      | 4/10 [00:24<00:28,  4.70s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9276, 'compress@10': 0.8244, 'time@10': 7.3038}:  50%|█████     | 5/10 [00:24<00:25,  5.16s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9375, 'compress@10': 0.851, 'time@10': 7.5845}:  50%|█████     | 5/10 [00:33<00:25,  5.16s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9375, 'compress@10': 0.851, 'time@10': 7.5845}:  60%|██████    | 6/10 [00:33<00:25,  6.48s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9387, 'compress@10': 0.8701, 'time@10': 7.9308}:  60%|██████    | 6/10 [00:38<00:25,  6.48s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9387, 'compress@10': 0.8701, 'time@10': 7.9308}:  70%|███████   | 7/10 [00:38<00:18,  6.01s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9405, 'compress@10': 0.8844, 'time@10': 7.8069}:  70%|███████   | 7/10 [00:45<00:18,  6.01s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9405, 'compress@10': 0.8844, 'time@10': 7.8069}:  80%|████████  | 8/10 [00:45<00:12,  6.32s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9574, 'compress@10': 0.8955, 'time@10': 8.4467}:  80%|████████  | 8/10 [00:52<00:12,  6.32s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9574, 'compress@10': 0.8955, 'time@10': 8.4467}:  90%|█████████ | 9/10 [00:52<00:06,  6.48s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9593, 'compress@10': 0.9012, 'time@10': 8.4966}:  90%|█████████ | 9/10 [01:01<00:06,  6.48s/it]    {'epoch': 30, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9593, 'compress@10': 0.9012, 'time@10': 8.4966}: 100%|██████████| 10/10 [01:01<00:00,  7.25s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9593, 'compress@10': 0.9012, 'time@10': 8.4966}: 100%|██████████| 10/10 [01:01<00:00,  6.12s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.013992661358112172
Avg hit ratio: 0.9032818581154745
Avg ndcg: 0.9592548719120328
Avg compression ratio: 0.9012009466446769
Avg train time: 8.496563172340393
Std train time: 2.5788950807399633
[0.9843749999999998, 0.9843749999999998, 0.04687500000000001, 0.9843749999999998, 0.9843749999999998, 0.9843749999999998, 0.9843749999999998, 0.9843749999999998, 0.9843749999999998, 0.9531249999999999]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9212, 'compress@10': 0.9852, 'time@10': 7.9755}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9212, 'compress@10': 0.9852, 'time@10': 7.9755}:  10%|█         | 1/10 [00:04<00:36,  4.02s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9439, 'compress@10': 0.985, 'time@10': 7.0587}:  10%|█         | 1/10 [00:10<00:36,  4.02s/it]  {'epoch': 31, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9439, 'compress@10': 0.985, 'time@10': 7.0587}:  20%|██        | 2/10 [00:10<00:42,  5.29s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.915, 'compress@10': 0.7177, 'time@10': 6.5505}:  20%|██        | 2/10 [00:13<00:42,  5.29s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.915, 'compress@10': 0.7177, 'time@10': 6.5505}:  30%|███       | 3/10 [00:13<00:29,  4.16s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9273, 'compress@10': 0.7845, 'time@10': 6.3032}:  30%|███       | 3/10 [00:18<00:29,  4.16s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9273, 'compress@10': 0.7845, 'time@10': 6.3032}:  40%|████      | 4/10 [00:18<00:28,  4.73s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9292, 'compress@10': 0.8245, 'time@10': 7.4704}:  40%|████      | 4/10 [00:24<00:28,  4.73s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9292, 'compress@10': 0.8245, 'time@10': 7.4704}:  50%|█████     | 5/10 [00:24<00:26,  5.22s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9363, 'compress@10': 0.8512, 'time@10': 7.7238}:  50%|█████     | 5/10 [00:33<00:26,  5.22s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9363, 'compress@10': 0.8512, 'time@10': 7.7238}:  60%|██████    | 6/10 [00:33<00:26,  6.52s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9381, 'compress@10': 0.8703, 'time@10': 8.0409}:  60%|██████    | 6/10 [00:38<00:26,  6.52s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9381, 'compress@10': 0.8703, 'time@10': 8.0409}:  70%|███████   | 7/10 [00:38<00:18,  6.03s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.01, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9416, 'compress@10': 0.8847, 'time@10': 7.9274}:  70%|███████   | 7/10 [00:45<00:18,  6.03s/it]   {'epoch': 31, 'num_users': 6.125, 'loss': 0.01, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9416, 'compress@10': 0.8847, 'time@10': 7.9274}:  80%|████████  | 8/10 [00:45<00:12,  6.39s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9392, 'compress@10': 0.8958, 'time@10': 8.4675}:  80%|████████  | 8/10 [00:52<00:12,  6.39s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9392, 'compress@10': 0.8958, 'time@10': 8.4675}:  90%|█████████ | 9/10 [00:52<00:06,  6.40s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9406, 'compress@10': 0.9016, 'time@10': 8.5224}:  90%|█████████ | 9/10 [01:01<00:06,  6.40s/it]  {'epoch': 31, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9406, 'compress@10': 0.9016, 'time@10': 8.5224}: 100%|██████████| 10/10 [01:01<00:00,  7.22s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9406, 'compress@10': 0.9016, 'time@10': 8.5224}: 100%|██████████| 10/10 [01:01<00:00,  6.14s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.013732096506322043
Avg hit ratio: 0.8971989088067186
Avg ndcg: 0.9405812793324131
Avg compression ratio: 0.9016195352643346
Avg train time: 8.52235779762268
Std train time: 2.436182852439377
[0.9848484848484846, 0.9848484848484846, 0.04545454545454546, 0.9848484848484846, 0.9848484848484846, 0.9848484848484846, 0.9848484848484846, 0.9848484848484846, 0.9848484848484846, 0.9545454545454545]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 0.9856, 'time@10': 7.3508}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 0.9856, 'time@10': 7.3508}:  10%|█         | 1/10 [00:03<00:33,  3.71s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9449, 'compress@10': 0.9855, 'time@10': 6.8182}:  10%|█         | 1/10 [00:10<00:33,  3.71s/it] {'epoch': 32, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9449, 'compress@10': 0.9855, 'time@10': 6.8182}:  20%|██        | 2/10 [00:10<00:41,  5.25s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9156, 'compress@10': 0.7176, 'time@10': 6.3885}:  20%|██        | 2/10 [00:12<00:41,  5.25s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9156, 'compress@10': 0.7176, 'time@10': 6.3885}:  30%|███       | 3/10 [00:12<00:28,  4.13s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9272, 'compress@10': 0.7845, 'time@10': 6.1698}:  30%|███       | 3/10 [00:18<00:28,  4.13s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9272, 'compress@10': 0.7845, 'time@10': 6.1698}:  40%|████      | 4/10 [00:18<00:28,  4.69s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9301, 'compress@10': 0.8247, 'time@10': 7.3829}:  40%|████      | 4/10 [00:24<00:28,  4.69s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9301, 'compress@10': 0.8247, 'time@10': 7.3829}:  50%|█████     | 5/10 [00:24<00:26,  5.22s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9367, 'compress@10': 0.8514, 'time@10': 7.6932}:  50%|█████     | 5/10 [00:33<00:26,  5.22s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9367, 'compress@10': 0.8514, 'time@10': 7.6932}:  60%|██████    | 6/10 [00:33<00:26,  6.60s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9377, 'compress@10': 0.8706, 'time@10': 8.0206}:  60%|██████    | 6/10 [00:38<00:26,  6.60s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9377, 'compress@10': 0.8706, 'time@10': 8.0206}:  70%|███████   | 7/10 [00:38<00:18,  6.09s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9385, 'compress@10': 0.8849, 'time@10': 7.894}:  70%|███████   | 7/10 [00:45<00:18,  6.09s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9385, 'compress@10': 0.8849, 'time@10': 7.894}:  80%|████████  | 8/10 [00:45<00:12,  6.39s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9515, 'compress@10': 0.896, 'time@10': 8.4074}:  80%|████████  | 8/10 [00:52<00:12,  6.39s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9515, 'compress@10': 0.896, 'time@10': 8.4074}:  90%|█████████ | 9/10 [00:52<00:06,  6.36s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9531, 'compress@10': 0.902, 'time@10': 8.4603}:  90%|█████████ | 9/10 [01:01<00:06,  6.36s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9531, 'compress@10': 0.902, 'time@10': 8.4603}: 100%|██████████| 10/10 [01:01<00:00,  7.17s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9531, 'compress@10': 0.902, 'time@10': 8.4603}: 100%|██████████| 10/10 [01:01<00:00,  6.12s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.014135934277279277
Avg hit ratio: 0.8932557174951062
Avg ndcg: 0.953099189670452
Avg compression ratio: 0.9019967692370852
Avg train time: 8.460319638252258
Std train time: 2.433273470739413
[0.9852941176470587, 0.9852941176470587, 0.04411764705882354, 0.9852941176470587, 0.9852941176470587, 0.9852941176470587, 0.9852941176470587, 0.9852941176470587, 0.9852941176470587, 0.9558823529411764]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 0.9861, 'time@10': 7.2765}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 0.9861, 'time@10': 7.2765}:  10%|█         | 1/10 [00:03<00:33,  3.67s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9578, 'compress@10': 0.9859, 'time@10': 6.7648}:  10%|█         | 1/10 [00:09<00:33,  3.67s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9578, 'compress@10': 0.9859, 'time@10': 6.7648}:  20%|██        | 2/10 [00:09<00:41,  5.21s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9243, 'compress@10': 0.7175, 'time@10': 6.4015}:  20%|██        | 2/10 [00:12<00:41,  5.21s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9243, 'compress@10': 0.7175, 'time@10': 6.4015}:  30%|███       | 3/10 [00:12<00:29,  4.16s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.934, 'compress@10': 0.7846, 'time@10': 6.21}:  30%|███       | 3/10 [00:18<00:29,  4.16s/it]   {'epoch': 33, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.934, 'compress@10': 0.7846, 'time@10': 6.21}:  40%|████      | 4/10 [00:18<00:28,  4.76s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9353, 'compress@10': 0.8248, 'time@10': 7.4263}:  40%|████      | 4/10 [00:24<00:28,  4.76s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9353, 'compress@10': 0.8248, 'time@10': 7.4263}:  50%|█████     | 5/10 [00:24<00:26,  5.27s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9392, 'compress@10': 0.8516, 'time@10': 7.7142}:  50%|█████     | 5/10 [00:33<00:26,  5.27s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9392, 'compress@10': 0.8516, 'time@10': 7.7142}:  60%|██████    | 6/10 [00:33<00:26,  6.60s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0124, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9406, 'compress@10': 0.8708, 'time@10': 8.0366}:  60%|██████    | 6/10 [00:38<00:26,  6.60s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0124, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9406, 'compress@10': 0.8708, 'time@10': 8.0366}:  70%|███████   | 7/10 [00:38<00:18,  6.09s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9412, 'compress@10': 0.8851, 'time@10': 7.9291}:  70%|███████   | 7/10 [00:46<00:18,  6.09s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9412, 'compress@10': 0.8851, 'time@10': 7.9291}:  80%|████████  | 8/10 [00:46<00:12,  6.44s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9392, 'compress@10': 0.8963, 'time@10': 8.4618}:  80%|████████  | 8/10 [00:52<00:12,  6.44s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9392, 'compress@10': 0.8963, 'time@10': 8.4618}:  90%|█████████ | 9/10 [00:52<00:06,  6.43s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9429, 'compress@10': 0.9024, 'time@10': 8.4999}:  90%|█████████ | 9/10 [01:01<00:06,  6.43s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9429, 'compress@10': 0.9024, 'time@10': 8.4999}: 100%|██████████| 10/10 [01:01<00:00,  7.19s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9429, 'compress@10': 0.9024, 'time@10': 8.4999}: 100%|██████████| 10/10 [01:01<00:00,  6.14s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.014125316995456674
Avg hit ratio: 0.9056878731530684
Avg ndcg: 0.9428707249782017
Avg compression ratio: 0.9023583584993338
Avg train time: 8.499868488311767
Std train time: 2.4372801479372352
[0.9857142857142855, 0.9857142857142855, 0.042857142857142864, 0.9857142857142855, 0.9857142857142855, 0.9857142857142855, 0.9857142857142855, 0.9857142857142855, 0.9857142857142855, 0.9571428571428571]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9864, 'time@10': 7.061}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9864, 'time@10': 7.061}:  10%|█         | 1/10 [00:03<00:32,  3.57s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9448, 'compress@10': 0.9863, 'time@10': 6.648}:  10%|█         | 1/10 [00:09<00:32,  3.57s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9448, 'compress@10': 0.9863, 'time@10': 6.648}:  20%|██        | 2/10 [00:09<00:41,  5.16s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9156, 'compress@10': 0.7174, 'time@10': 6.2553}:  20%|██        | 2/10 [00:12<00:41,  5.16s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9156, 'compress@10': 0.7174, 'time@10': 6.2553}:  30%|███       | 3/10 [00:12<00:28,  4.07s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9281, 'compress@10': 0.7846, 'time@10': 6.094}:  30%|███       | 3/10 [00:18<00:28,  4.07s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9281, 'compress@10': 0.7846, 'time@10': 6.094}:  40%|████      | 4/10 [00:18<00:28,  4.69s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9312, 'compress@10': 0.8249, 'time@10': 7.3416}:  40%|████      | 4/10 [00:24<00:28,  4.69s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9312, 'compress@10': 0.8249, 'time@10': 7.3416}:  50%|█████     | 5/10 [00:24<00:26,  5.24s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9385, 'compress@10': 0.8517, 'time@10': 7.6467}:  50%|█████     | 5/10 [00:33<00:26,  5.24s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9385, 'compress@10': 0.8517, 'time@10': 7.6467}:  60%|██████    | 6/10 [00:33<00:26,  6.59s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9472, 'compress@10': 0.871, 'time@10': 7.9792}:  60%|██████    | 6/10 [00:38<00:26,  6.59s/it]  {'epoch': 34, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9472, 'compress@10': 0.871, 'time@10': 7.9792}:  70%|███████   | 7/10 [00:38<00:18,  6.08s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9493, 'compress@10': 0.8853, 'time@10': 7.8751}:  70%|███████   | 7/10 [00:45<00:18,  6.08s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9493, 'compress@10': 0.8853, 'time@10': 7.8751}:  80%|████████  | 8/10 [00:45<00:12,  6.43s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9635, 'compress@10': 0.8965, 'time@10': 8.4362}:  80%|████████  | 8/10 [00:52<00:12,  6.43s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9635, 'compress@10': 0.8965, 'time@10': 8.4362}:  90%|█████████ | 9/10 [00:52<00:06,  6.45s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9618, 'compress@10': 0.9027, 'time@10': 8.4815}:  90%|█████████ | 9/10 [01:01<00:06,  6.45s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9618, 'compress@10': 0.9027, 'time@10': 8.4815}: 100%|██████████| 10/10 [01:01<00:00,  7.21s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9618, 'compress@10': 0.9027, 'time@10': 8.4815}: 100%|██████████| 10/10 [01:01<00:00,  6.13s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.013802135098802048
Avg hit ratio: 0.9139930446840463
Avg ndcg: 0.9618108229790854
Avg compression ratio: 0.9026962459023524
Avg train time: 8.481540608406068
Std train time: 2.5220584005997013
[0.9861111111111109, 0.9861111111111109, 0.04166666666666667, 0.9861111111111109, 0.9861111111111109, 0.9861111111111109, 0.9861111111111109, 0.9861111111111109, 0.9861111111111109, 0.9583333333333333]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9868, 'time@10': 7.4658}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9868, 'time@10': 7.4658}:  10%|█         | 1/10 [00:03<00:33,  3.77s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9459, 'compress@10': 0.9867, 'time@10': 6.9462}:  10%|█         | 1/10 [00:10<00:33,  3.77s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9459, 'compress@10': 0.9867, 'time@10': 6.9462}:  20%|██        | 2/10 [00:10<00:42,  5.35s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9163, 'compress@10': 0.7173, 'time@10': 6.4538}:  20%|██        | 2/10 [00:13<00:42,  5.35s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9163, 'compress@10': 0.7173, 'time@10': 6.4538}:  30%|███       | 3/10 [00:13<00:29,  4.18s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9286, 'compress@10': 0.7846, 'time@10': 6.247}:  30%|███       | 3/10 [00:18<00:29,  4.18s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9286, 'compress@10': 0.7846, 'time@10': 6.247}:  40%|████      | 4/10 [00:18<00:28,  4.76s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9319, 'compress@10': 0.825, 'time@10': 7.5834}:  40%|████      | 4/10 [00:25<00:28,  4.76s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9319, 'compress@10': 0.825, 'time@10': 7.5834}:  50%|█████     | 5/10 [00:25<00:26,  5.39s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9429, 'compress@10': 0.8519, 'time@10': 7.8669}:  50%|█████     | 5/10 [00:34<00:26,  5.39s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9429, 'compress@10': 0.8519, 'time@10': 7.8669}:  60%|██████    | 6/10 [00:34<00:26,  6.73s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.012, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9428, 'compress@10': 0.8711, 'time@10': 8.1802}:  60%|██████    | 6/10 [00:39<00:26,  6.73s/it] {'epoch': 35, 'num_users': 6.2857, 'loss': 0.012, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9428, 'compress@10': 0.8711, 'time@10': 8.1802}:  70%|███████   | 7/10 [00:39<00:18,  6.18s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9444, 'compress@10': 0.8856, 'time@10': 8.0234}:  70%|███████   | 7/10 [00:46<00:18,  6.18s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9444, 'compress@10': 0.8856, 'time@10': 8.0234}:  80%|████████  | 8/10 [00:46<00:12,  6.43s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9437, 'compress@10': 0.8968, 'time@10': 8.5487}:  80%|████████  | 8/10 [00:52<00:12,  6.43s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9437, 'compress@10': 0.8968, 'time@10': 8.5487}:  90%|█████████ | 9/10 [00:52<00:06,  6.43s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9469, 'compress@10': 0.903, 'time@10': 8.6667}:  90%|█████████ | 9/10 [01:02<00:06,  6.43s/it]    {'epoch': 35, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9469, 'compress@10': 0.903, 'time@10': 8.6667}: 100%|██████████| 10/10 [01:02<00:00,  7.46s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9469, 'compress@10': 0.903, 'time@10': 8.6667}: 100%|██████████| 10/10 [01:02<00:00,  6.27s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.012673111973962698
Avg hit ratio: 0.9056878731530684
Avg ndcg: 0.946920201948398
Avg compression ratio: 0.903020527082175
Avg train time: 8.666690015792847
Std train time: 2.5933515287170676
[0.9864864864864863, 0.9864864864864863, 0.04054054054054054, 0.9864864864864863, 0.9864864864864863, 0.9864864864864863, 0.9864864864864863, 0.9864864864864863, 0.9864864864864863, 0.9594594594594594]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9872, 'time@10': 7.4837}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9872, 'time@10': 7.4837}:  10%|█         | 1/10 [00:03<00:34,  3.78s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9511, 'compress@10': 0.987, 'time@10': 6.9209}:  10%|█         | 1/10 [00:10<00:34,  3.78s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9511, 'compress@10': 0.987, 'time@10': 6.9209}:  20%|██        | 2/10 [00:10<00:42,  5.32s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9198, 'compress@10': 0.7172, 'time@10': 6.6163}:  20%|██        | 2/10 [00:13<00:42,  5.32s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9198, 'compress@10': 0.7172, 'time@10': 6.6163}:  30%|███       | 3/10 [00:13<00:29,  4.28s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9312, 'compress@10': 0.7847, 'time@10': 6.3708}:  30%|███       | 3/10 [00:18<00:29,  4.28s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9312, 'compress@10': 0.7847, 'time@10': 6.3708}:  40%|████      | 4/10 [00:18<00:28,  4.83s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9343, 'compress@10': 0.8251, 'time@10': 7.546}:  40%|████      | 4/10 [00:25<00:28,  4.83s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9343, 'compress@10': 0.8251, 'time@10': 7.546}:  50%|█████     | 5/10 [00:25<00:26,  5.31s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9408, 'compress@10': 0.852, 'time@10': 7.8266}:  50%|█████     | 5/10 [00:34<00:26,  5.31s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9408, 'compress@10': 0.852, 'time@10': 7.8266}:  60%|██████    | 6/10 [00:34<00:26,  6.65s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9425, 'compress@10': 0.8713, 'time@10': 8.1339}:  60%|██████    | 6/10 [00:39<00:26,  6.65s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9425, 'compress@10': 0.8713, 'time@10': 8.1339}:  70%|███████   | 7/10 [00:39<00:18,  6.12s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9419, 'compress@10': 0.8858, 'time@10': 8.0007}:  70%|███████   | 7/10 [00:46<00:18,  6.12s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9419, 'compress@10': 0.8858, 'time@10': 8.0007}:  80%|████████  | 8/10 [00:46<00:12,  6.43s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9466, 'compress@10': 0.897, 'time@10': 8.5289}:  80%|████████  | 8/10 [00:52<00:12,  6.43s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9466, 'compress@10': 0.897, 'time@10': 8.5289}:  90%|█████████ | 9/10 [00:52<00:06,  6.43s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9478, 'compress@10': 0.9033, 'time@10': 8.6185}:  90%|█████████ | 9/10 [01:02<00:06,  6.43s/it]  {'epoch': 36, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9478, 'compress@10': 0.9033, 'time@10': 8.6185}: 100%|██████████| 10/10 [01:02<00:00,  7.36s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9478, 'compress@10': 0.9033, 'time@10': 8.6185}: 100%|██████████| 10/10 [01:02<00:00,  6.23s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.01156872996588908
Avg hit ratio: 0.9053192095585982
Avg ndcg: 0.9477842452262856
Avg compression ratio: 0.9033261813804069
Avg train time: 8.618530321121217
Std train time: 2.4013270378384592
[0.9868421052631577, 0.9868421052631577, 0.03947368421052632, 0.9868421052631577, 0.9868421052631577, 0.9868421052631577, 0.9868421052631577, 0.9868421052631577, 0.9868421052631577, 0.9605263157894737]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.913, 'compress@10': 0.9875, 'time@10': 7.2081}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.913, 'compress@10': 0.9875, 'time@10': 7.2081}:  10%|█         | 1/10 [00:03<00:32,  3.64s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9424, 'compress@10': 0.9874, 'time@10': 6.7891}:  10%|█         | 1/10 [00:10<00:32,  3.64s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9424, 'compress@10': 0.9874, 'time@10': 6.7891}:  20%|██        | 2/10 [00:10<00:42,  5.27s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.914, 'compress@10': 0.7172, 'time@10': 6.3121}:  20%|██        | 2/10 [00:12<00:42,  5.27s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.914, 'compress@10': 0.7172, 'time@10': 6.3121}:  30%|███       | 3/10 [00:12<00:28,  4.10s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9263, 'compress@10': 0.7847, 'time@10': 6.1254}:  30%|███       | 3/10 [00:18<00:28,  4.10s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9263, 'compress@10': 0.7847, 'time@10': 6.1254}:  40%|████      | 4/10 [00:18<00:28,  4.69s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9308, 'compress@10': 0.8252, 'time@10': 7.3713}:  40%|████      | 4/10 [00:24<00:28,  4.69s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9308, 'compress@10': 0.8252, 'time@10': 7.3713}:  50%|█████     | 5/10 [00:24<00:26,  5.24s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.938, 'compress@10': 0.8522, 'time@10': 7.6331}:  50%|█████     | 5/10 [00:33<00:26,  5.24s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.938, 'compress@10': 0.8522, 'time@10': 7.6331}:  60%|██████    | 6/10 [00:33<00:26,  6.51s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9399, 'compress@10': 0.8715, 'time@10': 8.002}:  60%|██████    | 6/10 [00:38<00:26,  6.51s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9399, 'compress@10': 0.8715, 'time@10': 8.002}:  70%|███████   | 7/10 [00:38<00:18,  6.06s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9456, 'compress@10': 0.8859, 'time@10': 7.8905}:  70%|███████   | 7/10 [00:45<00:18,  6.06s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9456, 'compress@10': 0.8859, 'time@10': 7.8905}:  80%|████████  | 8/10 [00:45<00:12,  6.41s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9453, 'compress@10': 0.8972, 'time@10': 8.4321}:  80%|████████  | 8/10 [00:52<00:12,  6.41s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9453, 'compress@10': 0.8972, 'time@10': 8.4321}:  90%|█████████ | 9/10 [00:52<00:06,  6.42s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9484, 'compress@10': 0.9036, 'time@10': 8.5697}:  90%|█████████ | 9/10 [01:02<00:06,  6.42s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9484, 'compress@10': 0.9036, 'time@10': 8.5697}: 100%|██████████| 10/10 [01:02<00:00,  7.48s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9484, 'compress@10': 0.9036, 'time@10': 8.5697}: 100%|██████████| 10/10 [01:02<00:00,  6.21s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.01242239763854779
Avg hit ratio: 0.9016049238443127
Avg ndcg: 0.9483652610547224
Avg compression ratio: 0.9036149230789358
Avg train time: 8.569696068763733
Std train time: 2.5392743309567836
[0.987179487179487, 0.987179487179487, 0.038461538461538464, 0.987179487179487, 0.987179487179487, 0.987179487179487, 0.987179487179487, 0.987179487179487, 0.987179487179487, 0.9615384615384616]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9155, 'compress@10': 0.9878, 'time@10': 7.6355}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9155, 'compress@10': 0.9878, 'time@10': 7.6355}:  10%|█         | 1/10 [00:03<00:34,  3.85s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9405, 'compress@10': 0.9877, 'time@10': 6.9224}:  10%|█         | 1/10 [00:10<00:34,  3.85s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9405, 'compress@10': 0.9877, 'time@10': 6.9224}:  20%|██        | 2/10 [00:10<00:42,  5.27s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9127, 'compress@10': 0.7171, 'time@10': 6.4709}:  20%|██        | 2/10 [00:12<00:42,  5.27s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9127, 'compress@10': 0.7171, 'time@10': 6.4709}:  30%|███       | 3/10 [00:12<00:29,  4.15s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9251, 'compress@10': 0.7847, 'time@10': 6.2308}:  30%|███       | 3/10 [00:18<00:29,  4.15s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9251, 'compress@10': 0.7847, 'time@10': 6.2308}:  40%|████      | 4/10 [00:18<00:28,  4.70s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9299, 'compress@10': 0.8253, 'time@10': 7.386}:  40%|████      | 4/10 [00:24<00:28,  4.70s/it] {'epoch': 38, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9299, 'compress@10': 0.8253, 'time@10': 7.386}:  50%|█████     | 5/10 [00:24<00:25,  5.18s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9375, 'compress@10': 0.8523, 'time@10': 7.7073}:  50%|█████     | 5/10 [00:33<00:25,  5.18s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9375, 'compress@10': 0.8523, 'time@10': 7.7073}:  60%|██████    | 6/10 [00:33<00:26,  6.60s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9386, 'compress@10': 0.8716, 'time@10': 8.0577}:  60%|██████    | 6/10 [00:38<00:26,  6.60s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9386, 'compress@10': 0.8716, 'time@10': 8.0577}:  70%|███████   | 7/10 [00:38<00:18,  6.12s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9356, 'compress@10': 0.8861, 'time@10': 7.9263}:  70%|███████   | 7/10 [00:46<00:18,  6.12s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9356, 'compress@10': 0.8861, 'time@10': 7.9263}:  80%|████████  | 8/10 [00:46<00:12,  6.41s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0148, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9488, 'compress@10': 0.8974, 'time@10': 8.4608}:  80%|████████  | 8/10 [00:52<00:12,  6.41s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0148, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9488, 'compress@10': 0.8974, 'time@10': 8.4608}:  90%|█████████ | 9/10 [00:52<00:06,  6.41s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9509, 'compress@10': 0.9039, 'time@10': 8.5823}:  90%|█████████ | 9/10 [01:02<00:06,  6.41s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9509, 'compress@10': 0.9039, 'time@10': 8.5823}: 100%|██████████| 10/10 [01:02<00:00,  7.43s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9509, 'compress@10': 0.9039, 'time@10': 8.5823}: 100%|██████████| 10/10 [01:02<00:00,  6.22s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.015445224693790121
Avg hit ratio: 0.8966279653189669
Avg ndcg: 0.9509244032175275
Avg compression ratio: 0.9038845453203492
Avg train time: 8.58233015537262
Std train time: 2.4646515346596374
[0.9874999999999998, 0.9874999999999998, 0.037500000000000006, 0.9874999999999998, 0.9874999999999998, 0.9874999999999998, 0.9874999999999998, 0.9874999999999998, 0.9874999999999998, 0.9625]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9135, 'compress@10': 0.9881, 'time@10': 7.4675}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9135, 'compress@10': 0.9881, 'time@10': 7.4675}:  10%|█         | 1/10 [00:03<00:33,  3.77s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9406, 'compress@10': 0.988, 'time@10': 6.8491}:  10%|█         | 1/10 [00:10<00:33,  3.77s/it] {'epoch': 39, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9406, 'compress@10': 0.988, 'time@10': 6.8491}:  20%|██        | 2/10 [00:10<00:41,  5.24s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9128, 'compress@10': 0.717, 'time@10': 6.4199}:  20%|██        | 2/10 [00:12<00:41,  5.24s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9128, 'compress@10': 0.717, 'time@10': 6.4199}:  30%|███       | 3/10 [00:12<00:28,  4.13s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.926, 'compress@10': 0.7847, 'time@10': 6.2118}:  30%|███       | 3/10 [00:18<00:28,  4.13s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.926, 'compress@10': 0.7847, 'time@10': 6.2118}:  40%|████      | 4/10 [00:18<00:28,  4.72s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9327, 'compress@10': 0.8253, 'time@10': 7.4523}:  40%|████      | 4/10 [00:24<00:28,  4.72s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9327, 'compress@10': 0.8253, 'time@10': 7.4523}:  50%|█████     | 5/10 [00:24<00:26,  5.27s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9403, 'compress@10': 0.8524, 'time@10': 7.7205}:  50%|█████     | 5/10 [00:33<00:26,  5.27s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9403, 'compress@10': 0.8524, 'time@10': 7.7205}:  60%|██████    | 6/10 [00:33<00:26,  6.57s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0078, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9424, 'compress@10': 0.8718, 'time@10': 8.0654}:  60%|██████    | 6/10 [00:38<00:26,  6.57s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0078, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9424, 'compress@10': 0.8718, 'time@10': 8.0654}:  70%|███████   | 7/10 [00:38<00:18,  6.09s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9606, 'compress@10': 0.8863, 'time@10': 7.9484}:  70%|███████   | 7/10 [00:46<00:18,  6.09s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9606, 'compress@10': 0.8863, 'time@10': 7.9484}:  80%|████████  | 8/10 [00:46<00:12,  6.43s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9557, 'compress@10': 0.8976, 'time@10': 8.4669}:  80%|████████  | 8/10 [00:52<00:12,  6.43s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9557, 'compress@10': 0.8976, 'time@10': 8.4669}:  90%|█████████ | 9/10 [00:52<00:06,  6.41s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9577, 'compress@10': 0.9041, 'time@10': 8.5998}:  90%|█████████ | 9/10 [01:02<00:06,  6.41s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9577, 'compress@10': 0.9041, 'time@10': 8.5998}: 100%|██████████| 10/10 [01:02<00:00,  7.47s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9577, 'compress@10': 0.9041, 'time@10': 8.5998}: 100%|██████████| 10/10 [01:02<00:00,  6.23s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.011604390450038951
Avg hit ratio: 0.9066842889236778
Avg ndcg: 0.9577143028849446
Avg compression ratio: 0.9041463717536858
Avg train time: 8.599785971641541
Std train time: 2.4906937745369357
[0.9878048780487804, 0.9878048780487804, 0.03658536585365854, 0.9878048780487804, 0.9878048780487804, 0.9878048780487804, 0.9878048780487804, 0.9878048780487804, 0.9878048780487804, 0.9634146341463414]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 0.9884, 'time@10': 7.5007}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 0.9884, 'time@10': 7.5007}:  10%|█         | 1/10 [00:03<00:34,  3.79s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9453, 'compress@10': 0.9883, 'time@10': 6.9541}:  10%|█         | 1/10 [00:10<00:34,  3.79s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9453, 'compress@10': 0.9883, 'time@10': 6.9541}:  20%|██        | 2/10 [00:10<00:42,  5.35s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9159, 'compress@10': 0.7169, 'time@10': 6.4978}:  20%|██        | 2/10 [00:13<00:42,  5.35s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9159, 'compress@10': 0.7169, 'time@10': 6.4978}:  30%|███       | 3/10 [00:13<00:29,  4.20s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9275, 'compress@10': 0.7848, 'time@10': 6.3166}:  30%|███       | 3/10 [00:18<00:29,  4.20s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9275, 'compress@10': 0.7848, 'time@10': 6.3166}:  40%|████      | 4/10 [00:18<00:29,  4.84s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.934, 'compress@10': 0.8254, 'time@10': 7.6447}:  40%|████      | 4/10 [00:25<00:29,  4.84s/it] {'epoch': 40, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.934, 'compress@10': 0.8254, 'time@10': 7.6447}:  50%|█████     | 5/10 [00:25<00:27,  5.44s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9482, 'compress@10': 0.8525, 'time@10': 7.9111}:  50%|█████     | 5/10 [00:34<00:27,  5.44s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9482, 'compress@10': 0.8525, 'time@10': 7.9111}:  60%|██████    | 6/10 [00:34<00:26,  6.75s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0123, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9487, 'compress@10': 0.8719, 'time@10': 8.177}:  60%|██████    | 6/10 [00:39<00:26,  6.75s/it] {'epoch': 40, 'num_users': 6.2857, 'loss': 0.0123, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9487, 'compress@10': 0.8719, 'time@10': 8.177}:  70%|███████   | 7/10 [00:39<00:18,  6.15s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9741, 'compress@10': 0.8864, 'time@10': 8.0358}:  70%|███████   | 7/10 [00:46<00:18,  6.15s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9741, 'compress@10': 0.8864, 'time@10': 8.0358}:  80%|████████  | 8/10 [00:46<00:12,  6.45s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9775, 'compress@10': 0.8977, 'time@10': 8.555}:  80%|████████  | 8/10 [00:53<00:12,  6.45s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9775, 'compress@10': 0.8977, 'time@10': 8.555}:  90%|█████████ | 9/10 [00:53<00:06,  6.43s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9776, 'compress@10': 0.9044, 'time@10': 8.6927}:  90%|█████████ | 9/10 [01:03<00:06,  6.43s/it]  {'epoch': 40, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9776, 'compress@10': 0.9044, 'time@10': 8.6927}: 100%|██████████| 10/10 [01:03<00:00,  7.52s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9776, 'compress@10': 0.9044, 'time@10': 8.6927}: 100%|██████████| 10/10 [01:03<00:00,  6.30s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.016301869438775474
Avg hit ratio: 0.8984815239467192
Avg ndcg: 0.9775853653003687
Avg compression ratio: 0.9043934411237584
Avg train time: 8.692746186256409
Std train time: 2.5465768857577338
[0.988095238095238, 0.988095238095238, 0.03571428571428572, 0.988095238095238, 0.988095238095238, 0.988095238095238, 0.988095238095238, 0.988095238095238, 0.988095238095238, 0.9642857142857143]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 0.9887, 'time@10': 7.8889}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 0.9887, 'time@10': 7.8889}:  10%|█         | 1/10 [00:03<00:35,  3.98s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9528, 'compress@10': 0.9886, 'time@10': 7.1396}:  10%|█         | 1/10 [00:10<00:35,  3.98s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9528, 'compress@10': 0.9886, 'time@10': 7.1396}:  20%|██        | 2/10 [00:10<00:43,  5.42s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9209, 'compress@10': 0.7169, 'time@10': 6.5714}:  20%|██        | 2/10 [00:13<00:43,  5.42s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9209, 'compress@10': 0.7169, 'time@10': 6.5714}:  30%|███       | 3/10 [00:13<00:29,  4.21s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9312, 'compress@10': 0.7848, 'time@10': 6.343}:  30%|███       | 3/10 [00:18<00:29,  4.21s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9312, 'compress@10': 0.7848, 'time@10': 6.343}:  40%|████      | 4/10 [00:18<00:28,  4.80s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0084, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9368, 'compress@10': 0.8255, 'time@10': 7.5424}:  40%|████      | 4/10 [00:25<00:28,  4.80s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0084, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9368, 'compress@10': 0.8255, 'time@10': 7.5424}:  50%|█████     | 5/10 [00:25<00:26,  5.31s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0072, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9433, 'compress@10': 0.8526, 'time@10': 7.7939}:  50%|█████     | 5/10 [00:34<00:26,  5.31s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0072, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9433, 'compress@10': 0.8526, 'time@10': 7.7939}:  60%|██████    | 6/10 [00:34<00:26,  6.59s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0083, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9438, 'compress@10': 0.872, 'time@10': 8.0751}:  60%|██████    | 6/10 [00:39<00:26,  6.59s/it] {'epoch': 41, 'num_users': 6.2857, 'loss': 0.0083, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9438, 'compress@10': 0.872, 'time@10': 8.0751}:  70%|███████   | 7/10 [00:39<00:18,  6.04s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0078, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9466, 'compress@10': 0.8866, 'time@10': 7.9375}:  70%|███████   | 7/10 [00:46<00:18,  6.04s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0078, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9466, 'compress@10': 0.8866, 'time@10': 7.9375}:  80%|████████  | 8/10 [00:46<00:12,  6.35s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9479, 'compress@10': 0.8979, 'time@10': 8.48}:  80%|████████  | 8/10 [00:52<00:12,  6.35s/it] {'epoch': 41, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9479, 'compress@10': 0.8979, 'time@10': 8.48}:  90%|█████████ | 9/10 [00:52<00:06,  6.38s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9508, 'compress@10': 0.9046, 'time@10': 8.6019}:  90%|█████████ | 9/10 [01:02<00:06,  6.38s/it] {'epoch': 41, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9508, 'compress@10': 0.9046, 'time@10': 8.6019}: 100%|██████████| 10/10 [01:02<00:00,  7.42s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9508, 'compress@10': 0.9046, 'time@10': 8.6019}: 100%|██████████| 10/10 [01:02<00:00,  6.23s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.008922416426198305
Avg hit ratio: 0.8833192095585984
Avg ndcg: 0.9507685880708394
Avg compression ratio: 0.9046257621980931
Avg train time: 8.601882195472717
Std train time: 2.4750506016191576
[0.9883720930232558, 0.9883720930232558, 0.034883720930232565, 0.9883720930232558, 0.9883720930232558, 0.9883720930232558, 0.9883720930232558, 0.9883720930232558, 0.9883720930232558, 0.9651162790697675]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9169, 'compress@10': 0.989, 'time@10': 7.7689}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9169, 'compress@10': 0.989, 'time@10': 7.7689}:  10%|█         | 1/10 [00:03<00:35,  3.92s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9417, 'compress@10': 0.9888, 'time@10': 6.9252}:  10%|█         | 1/10 [00:10<00:35,  3.92s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9417, 'compress@10': 0.9888, 'time@10': 6.9252}:  20%|██        | 2/10 [00:10<00:41,  5.21s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9135, 'compress@10': 0.7168, 'time@10': 6.5047}:  20%|██        | 2/10 [00:12<00:41,  5.21s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9135, 'compress@10': 0.7168, 'time@10': 6.5047}:  30%|███       | 3/10 [00:12<00:29,  4.14s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9266, 'compress@10': 0.7848, 'time@10': 6.2427}:  30%|███       | 3/10 [00:18<00:29,  4.14s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9266, 'compress@10': 0.7848, 'time@10': 6.2427}:  40%|████      | 4/10 [00:18<00:28,  4.68s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9337, 'compress@10': 0.8256, 'time@10': 7.3981}:  40%|████      | 4/10 [00:24<00:28,  4.68s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9337, 'compress@10': 0.8256, 'time@10': 7.3981}:  50%|█████     | 5/10 [00:24<00:25,  5.17s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9412, 'compress@10': 0.8527, 'time@10': 7.7208}:  50%|█████     | 5/10 [00:33<00:25,  5.17s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9412, 'compress@10': 0.8527, 'time@10': 7.7208}:  60%|██████    | 6/10 [00:33<00:26,  6.60s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9435, 'compress@10': 0.8722, 'time@10': 8.0231}:  60%|██████    | 6/10 [00:38<00:26,  6.60s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9435, 'compress@10': 0.8722, 'time@10': 8.0231}:  70%|███████   | 7/10 [00:38<00:18,  6.06s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9463, 'compress@10': 0.8867, 'time@10': 7.8904}:  70%|███████   | 7/10 [00:45<00:18,  6.06s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9463, 'compress@10': 0.8867, 'time@10': 7.8904}:  80%|████████  | 8/10 [00:45<00:12,  6.36s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0103, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9481, 'compress@10': 0.8981, 'time@10': 8.3955}:  80%|████████  | 8/10 [00:52<00:12,  6.36s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0103, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9481, 'compress@10': 0.8981, 'time@10': 8.3955}:  90%|█████████ | 9/10 [00:52<00:06,  6.33s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0097, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.951, 'compress@10': 0.9049, 'time@10': 8.5185}:  90%|█████████ | 9/10 [01:01<00:06,  6.33s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.0097, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.951, 'compress@10': 0.9049, 'time@10': 8.5185}: 100%|██████████| 10/10 [01:01<00:00,  7.36s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0097, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.951, 'compress@10': 0.9049, 'time@10': 8.5185}: 100%|██████████| 10/10 [01:01<00:00,  6.17s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.009691913456204066
Avg hit ratio: 0.9027109146277228
Avg ndcg: 0.9509539770654764
Avg compression ratio: 0.904851651678414
Avg train time: 8.518541622161866
Std train time: 2.401850081786337
[0.9886363636363636, 0.9886363636363636, 0.034090909090909095, 0.9886363636363636, 0.9886363636363636, 0.9886363636363636, 0.9886363636363636, 0.9886363636363636, 0.9886363636363636, 0.9659090909090909]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9892, 'time@10': 7.7666}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9892, 'time@10': 7.7666}:  10%|█         | 1/10 [00:03<00:35,  3.92s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9542, 'compress@10': 0.9891, 'time@10': 7.0392}:  10%|█         | 1/10 [00:10<00:35,  3.92s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9542, 'compress@10': 0.9891, 'time@10': 7.0392}:  20%|██        | 2/10 [00:10<00:42,  5.35s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9219, 'compress@10': 0.7168, 'time@10': 6.5116}:  20%|██        | 2/10 [00:13<00:42,  5.35s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9219, 'compress@10': 0.7168, 'time@10': 6.5116}:  30%|███       | 3/10 [00:13<00:29,  4.17s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9318, 'compress@10': 0.7848, 'time@10': 6.2306}:  30%|███       | 3/10 [00:18<00:29,  4.17s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9318, 'compress@10': 0.7848, 'time@10': 6.2306}:  40%|████      | 4/10 [00:18<00:27,  4.67s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.009, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9374, 'compress@10': 0.8256, 'time@10': 7.4321}:  40%|████      | 4/10 [00:24<00:27,  4.67s/it] {'epoch': 43, 'num_users': 5.8, 'loss': 0.009, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9374, 'compress@10': 0.8256, 'time@10': 7.4321}:  50%|█████     | 5/10 [00:24<00:26,  5.20s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0079, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9438, 'compress@10': 0.8528, 'time@10': 7.7116}:  50%|█████     | 5/10 [00:33<00:26,  5.20s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0079, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9438, 'compress@10': 0.8528, 'time@10': 7.7116}:  60%|██████    | 6/10 [00:33<00:26,  6.56s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0081, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9454, 'compress@10': 0.8723, 'time@10': 8.0622}:  60%|██████    | 6/10 [00:38<00:26,  6.56s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0081, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9454, 'compress@10': 0.8723, 'time@10': 8.0622}:  70%|███████   | 7/10 [00:38<00:18,  6.09s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0074, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9478, 'compress@10': 0.8869, 'time@10': 7.9254}:  70%|███████   | 7/10 [00:45<00:18,  6.09s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0074, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9478, 'compress@10': 0.8869, 'time@10': 7.9254}:  80%|████████  | 8/10 [00:45<00:12,  6.38s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0085, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9485, 'compress@10': 0.8982, 'time@10': 8.438}:  80%|████████  | 8/10 [00:52<00:12,  6.38s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0085, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9485, 'compress@10': 0.8982, 'time@10': 8.438}:  90%|█████████ | 9/10 [00:52<00:06,  6.36s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9596, 'compress@10': 0.9051, 'time@10': 8.5561}:  90%|█████████ | 9/10 [01:01<00:06,  6.36s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9596, 'compress@10': 0.9051, 'time@10': 8.5561}: 100%|██████████| 10/10 [01:01<00:00,  7.37s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9596, 'compress@10': 0.9051, 'time@10': 8.5561}: 100%|██████████| 10/10 [01:01<00:00,  6.19s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.011103761905411133
Avg hit ratio: 0.8899100953752906
Avg ndcg: 0.9596339062227572
Avg compression ratio: 0.9050643814652515
Avg train time: 8.556126284599305
Std train time: 2.4754695073846564
[0.9888888888888889, 0.9888888888888889, 0.03333333333333334, 0.9888888888888889, 0.9888888888888889, 0.9888888888888889, 0.9888888888888889, 0.9888888888888889, 0.9888888888888889, 0.9666666666666667]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9895, 'time@10': 7.4596}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9895, 'time@10': 7.4596}:  10%|█         | 1/10 [00:03<00:33,  3.77s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9702, 'compress@10': 0.9893, 'time@10': 6.8389}:  10%|█         | 1/10 [00:10<00:33,  3.77s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9702, 'compress@10': 0.9893, 'time@10': 6.8389}:  20%|██        | 2/10 [00:10<00:41,  5.23s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9325, 'compress@10': 0.7167, 'time@10': 6.4249}:  20%|██        | 2/10 [00:12<00:41,  5.23s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9325, 'compress@10': 0.7167, 'time@10': 6.4249}:  30%|███       | 3/10 [00:12<00:28,  4.14s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9398, 'compress@10': 0.7848, 'time@10': 6.1911}:  30%|███       | 3/10 [00:18<00:28,  4.14s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9398, 'compress@10': 0.7848, 'time@10': 6.1911}:  40%|████      | 4/10 [00:18<00:28,  4.68s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9436, 'compress@10': 0.8257, 'time@10': 7.4014}:  40%|████      | 4/10 [00:24<00:28,  4.68s/it]  {'epoch': 44, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9436, 'compress@10': 0.8257, 'time@10': 7.4014}:  50%|█████     | 5/10 [00:24<00:26,  5.22s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.956, 'compress@10': 0.8529, 'time@10': 7.7192}:  50%|█████     | 5/10 [00:33<00:26,  5.22s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.956, 'compress@10': 0.8529, 'time@10': 7.7192}:  60%|██████    | 6/10 [00:33<00:26,  6.62s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.958, 'compress@10': 0.8724, 'time@10': 8.0517}:  60%|██████    | 6/10 [00:38<00:26,  6.62s/it] {'epoch': 44, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.958, 'compress@10': 0.8724, 'time@10': 8.0517}:  70%|███████   | 7/10 [00:38<00:18,  6.11s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9583, 'compress@10': 0.887, 'time@10': 7.9389}:  70%|███████   | 7/10 [00:46<00:18,  6.11s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9583, 'compress@10': 0.887, 'time@10': 7.9389}:  80%|████████  | 8/10 [00:46<00:12,  6.45s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.959, 'compress@10': 0.8984, 'time@10': 8.4454}:  80%|████████  | 8/10 [00:52<00:12,  6.45s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.959, 'compress@10': 0.8984, 'time@10': 8.4454}:  90%|█████████ | 9/10 [00:52<00:06,  6.40s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9609, 'compress@10': 0.9053, 'time@10': 8.5973}:  90%|█████████ | 9/10 [01:02<00:06,  6.40s/it]  {'epoch': 44, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9609, 'compress@10': 0.9053, 'time@10': 8.5973}: 100%|██████████| 10/10 [01:02<00:00,  7.51s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9609, 'compress@10': 0.9053, 'time@10': 8.5973}: 100%|██████████| 10/10 [01:02<00:00,  6.24s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.012735759794691982
Avg hit ratio: 0.9152557174951064
Avg ndcg: 0.9608561943026832
Avg compression ratio: 0.9052706938306541
Avg train time: 8.597321891784668
Std train time: 2.463508037711662
[0.9891304347826088, 0.9891304347826088, 0.03260869565217392, 0.9891304347826088, 0.9891304347826088, 0.9891304347826088, 0.9891304347826088, 0.9891304347826088, 0.9891304347826088, 0.967391304347826]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9897, 'time@10': 7.3447}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9897, 'time@10': 7.3447}:  10%|█         | 1/10 [00:03<00:33,  3.71s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9379, 'compress@10': 0.9896, 'time@10': 6.87}:  10%|█         | 1/10 [00:10<00:33,  3.71s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9379, 'compress@10': 0.9896, 'time@10': 6.87}:  20%|██        | 2/10 [00:10<00:42,  5.31s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.911, 'compress@10': 0.7167, 'time@10': 6.4536}:  20%|██        | 2/10 [00:12<00:42,  5.31s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.911, 'compress@10': 0.7167, 'time@10': 6.4536}:  30%|███       | 3/10 [00:12<00:29,  4.19s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9236, 'compress@10': 0.7849, 'time@10': 6.2052}:  30%|███       | 3/10 [00:18<00:29,  4.19s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9236, 'compress@10': 0.7849, 'time@10': 6.2052}:  40%|████      | 4/10 [00:18<00:28,  4.70s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9311, 'compress@10': 0.8258, 'time@10': 7.4235}:  40%|████      | 4/10 [00:24<00:28,  4.70s/it] {'epoch': 45, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9311, 'compress@10': 0.8258, 'time@10': 7.4235}:  50%|█████     | 5/10 [00:24<00:26,  5.24s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9387, 'compress@10': 0.853, 'time@10': 7.7106}:  50%|█████     | 5/10 [00:33<00:26,  5.24s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9387, 'compress@10': 0.853, 'time@10': 7.7106}:  60%|██████    | 6/10 [00:33<00:26,  6.58s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9411, 'compress@10': 0.8725, 'time@10': 8.0078}:  60%|██████    | 6/10 [00:38<00:26,  6.58s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9411, 'compress@10': 0.8725, 'time@10': 8.0078}:  70%|███████   | 7/10 [00:38<00:18,  6.04s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9505, 'compress@10': 0.8871, 'time@10': 7.8709}:  70%|███████   | 7/10 [00:45<00:18,  6.04s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9505, 'compress@10': 0.8871, 'time@10': 7.8709}:  80%|████████  | 8/10 [00:45<00:12,  6.33s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9592, 'compress@10': 0.8985, 'time@10': 8.3983}:  80%|████████  | 8/10 [00:52<00:12,  6.33s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9592, 'compress@10': 0.8985, 'time@10': 8.3983}:  90%|█████████ | 9/10 [00:52<00:06,  6.33s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9642, 'compress@10': 0.9055, 'time@10': 8.5185}:  90%|█████████ | 9/10 [01:01<00:06,  6.33s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9642, 'compress@10': 0.9055, 'time@10': 8.5185}: 100%|██████████| 10/10 [01:01<00:00,  7.35s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9642, 'compress@10': 0.9055, 'time@10': 8.5185}: 100%|██████████| 10/10 [01:01<00:00,  6.17s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.012361628591742153
Avg hit ratio: 0.9008573559999705
Avg ndcg: 0.9642016050429595
Avg compression ratio: 0.9054646878741448
Avg train time: 8.518486213684081
Std train time: 2.459238502591177
[0.9893617021276596, 0.9893617021276596, 0.03191489361702128, 0.9893617021276596, 0.9893617021276596, 0.9893617021276596, 0.9893617021276596, 0.9893617021276596, 0.9893617021276596, 0.9680851063829787]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9899, 'time@10': 7.3386}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9899, 'time@10': 7.3386}:  10%|█         | 1/10 [00:03<00:33,  3.71s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.893, 'ndcg@10': 0.952, 'compress@10': 0.9898, 'time@10': 6.8208}:  10%|█         | 1/10 [00:10<00:33,  3.71s/it] {'epoch': 46, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.893, 'ndcg@10': 0.952, 'compress@10': 0.9898, 'time@10': 6.8208}:  20%|██        | 2/10 [00:10<00:42,  5.26s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9204, 'compress@10': 0.7166, 'time@10': 6.3804}:  20%|██        | 2/10 [00:12<00:42,  5.26s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9204, 'compress@10': 0.7166, 'time@10': 6.3804}:  30%|███       | 3/10 [00:12<00:28,  4.13s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9317, 'compress@10': 0.7849, 'time@10': 6.1618}:  30%|███       | 3/10 [00:18<00:28,  4.13s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9317, 'compress@10': 0.7849, 'time@10': 6.1618}:  40%|████      | 4/10 [00:18<00:28,  4.69s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9382, 'compress@10': 0.8258, 'time@10': 7.4537}:  40%|████      | 4/10 [00:24<00:28,  4.69s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9382, 'compress@10': 0.8258, 'time@10': 7.4537}:  50%|█████     | 5/10 [00:24<00:26,  5.29s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9468, 'compress@10': 0.8531, 'time@10': 7.7385}:  50%|█████     | 5/10 [00:33<00:26,  5.29s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9468, 'compress@10': 0.8531, 'time@10': 7.7385}:  60%|██████    | 6/10 [00:33<00:26,  6.62s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.9483, 'compress@10': 0.8726, 'time@10': 8.0294}:  60%|██████    | 6/10 [00:38<00:26,  6.62s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.9483, 'compress@10': 0.8726, 'time@10': 8.0294}:  70%|███████   | 7/10 [00:38<00:18,  6.07s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9569, 'compress@10': 0.8873, 'time@10': 7.9151}:  70%|███████   | 7/10 [00:46<00:18,  6.07s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9569, 'compress@10': 0.8873, 'time@10': 7.9151}:  80%|████████  | 8/10 [00:46<00:12,  6.42s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9498, 'compress@10': 0.8986, 'time@10': 8.4346}:  80%|████████  | 8/10 [00:52<00:12,  6.42s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9498, 'compress@10': 0.8986, 'time@10': 8.4346}:  90%|█████████ | 9/10 [00:52<00:06,  6.39s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9525, 'compress@10': 0.9057, 'time@10': 8.5325}:  90%|█████████ | 9/10 [01:01<00:06,  6.39s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9525, 'compress@10': 0.9057, 'time@10': 8.5325}: 100%|██████████| 10/10 [01:01<00:00,  7.34s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9525, 'compress@10': 0.9057, 'time@10': 8.5325}: 100%|██████████| 10/10 [01:01<00:00,  6.18s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.016830387761474393
Avg hit ratio: 0.9101763524157411
Avg ndcg: 0.9525157029432529
Avg compression ratio: 0.9056537791010733
Avg train time: 8.532533597946166
Std train time: 2.503282667073592
[0.9895833333333334, 0.9895833333333334, 0.03125000000000001, 0.9895833333333334, 0.9895833333333334, 0.9895833333333334, 0.9895833333333334, 0.9895833333333334, 0.9895833333333334, 0.96875]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9901, 'time@10': 7.3605}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9901, 'time@10': 7.3605}:  10%|█         | 1/10 [00:03<00:33,  3.72s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9459, 'compress@10': 0.99, 'time@10': 6.7153}:  10%|█         | 1/10 [00:09<00:33,  3.72s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9459, 'compress@10': 0.99, 'time@10': 6.7153}:  20%|██        | 2/10 [00:09<00:40,  5.12s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9163, 'compress@10': 0.7166, 'time@10': 6.3342}:  20%|██        | 2/10 [00:12<00:40,  5.12s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9163, 'compress@10': 0.7166, 'time@10': 6.3342}:  30%|███       | 3/10 [00:12<00:28,  4.07s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9281, 'compress@10': 0.7849, 'time@10': 6.1889}:  30%|███       | 3/10 [00:18<00:28,  4.07s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9281, 'compress@10': 0.7849, 'time@10': 6.1889}:  40%|████      | 4/10 [00:18<00:28,  4.75s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0077, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9357, 'compress@10': 0.8259, 'time@10': 7.4399}:  40%|████      | 4/10 [00:24<00:28,  4.75s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0077, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9357, 'compress@10': 0.8259, 'time@10': 7.4399}:  50%|█████     | 5/10 [00:24<00:26,  5.30s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0067, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9426, 'compress@10': 0.8532, 'time@10': 7.7287}:  50%|█████     | 5/10 [00:33<00:26,  5.30s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0067, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9426, 'compress@10': 0.8532, 'time@10': 7.7287}:  60%|██████    | 6/10 [00:33<00:26,  6.63s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0065, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9449, 'compress@10': 0.8727, 'time@10': 8.006}:  60%|██████    | 6/10 [00:38<00:26,  6.63s/it] {'epoch': 47, 'num_users': 6.2857, 'loss': 0.0065, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9449, 'compress@10': 0.8727, 'time@10': 8.006}:  70%|███████   | 7/10 [00:38<00:18,  6.05s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9403, 'compress@10': 0.8874, 'time@10': 7.8664}:  70%|███████   | 7/10 [00:45<00:18,  6.05s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9403, 'compress@10': 0.8874, 'time@10': 7.8664}:  80%|████████  | 8/10 [00:45<00:12,  6.33s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.907, 'ndcg@10': 0.943, 'compress@10': 0.8988, 'time@10': 8.3907}:  80%|████████  | 8/10 [00:52<00:12,  6.33s/it] {'epoch': 47, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.907, 'ndcg@10': 0.943, 'compress@10': 0.8988, 'time@10': 8.3907}:  90%|█████████ | 9/10 [00:52<00:06,  6.33s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9464, 'compress@10': 0.9058, 'time@10': 8.5175}:  90%|█████████ | 9/10 [01:01<00:06,  6.33s/it]  {'epoch': 47, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9464, 'compress@10': 0.9058, 'time@10': 8.5175}: 100%|██████████| 10/10 [01:01<00:00,  7.37s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9464, 'compress@10': 0.9058, 'time@10': 8.5175}: 100%|██████████| 10/10 [01:01<00:00,  6.17s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.008266614011539929
Avg hit ratio: 0.9140370795022748
Avg ndcg: 0.946442171677105
Avg compression ratio: 0.9058326288195714
Avg train time: 8.51747407913208
Std train time: 2.4762938089260498
[0.9897959183673469, 0.9897959183673469, 0.03061224489795919, 0.9897959183673469, 0.9897959183673469, 0.9897959183673469, 0.9897959183673469, 0.9897959183673469, 0.9897959183673469, 0.9693877551020408]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9903, 'time@10': 7.4482}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9903, 'time@10': 7.4482}:  10%|█         | 1/10 [00:03<00:33,  3.76s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0063, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9459, 'compress@10': 0.9902, 'time@10': 6.7692}:  10%|█         | 1/10 [00:10<00:33,  3.76s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0063, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9459, 'compress@10': 0.9902, 'time@10': 6.7692}:  20%|██        | 2/10 [00:10<00:43,  5.44s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9163, 'compress@10': 0.7165, 'time@10': 6.3254}:  20%|██        | 2/10 [00:13<00:43,  5.44s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9163, 'compress@10': 0.7165, 'time@10': 6.3254}:  30%|███       | 3/10 [00:13<00:29,  4.21s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9281, 'compress@10': 0.7849, 'time@10': 6.1234}:  30%|███       | 3/10 [00:18<00:29,  4.21s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9281, 'compress@10': 0.7849, 'time@10': 6.1234}:  40%|████      | 4/10 [00:18<00:28,  4.74s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0069, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9352, 'compress@10': 0.8259, 'time@10': 7.414}:  40%|████      | 4/10 [00:25<00:28,  4.74s/it] {'epoch': 48, 'num_users': 5.8, 'loss': 0.0069, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9352, 'compress@10': 0.8259, 'time@10': 7.414}:  50%|█████     | 5/10 [00:25<00:26,  5.31s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9409, 'compress@10': 0.8533, 'time@10': 7.703}:  50%|█████     | 5/10 [00:34<00:26,  5.31s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9409, 'compress@10': 0.8533, 'time@10': 7.703}:  60%|██████    | 6/10 [00:34<00:26,  6.63s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9478, 'compress@10': 0.8728, 'time@10': 7.9929}:  60%|██████    | 6/10 [00:39<00:26,  6.63s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9478, 'compress@10': 0.8728, 'time@10': 7.9929}:  70%|███████   | 7/10 [00:39<00:18,  6.07s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9506, 'compress@10': 0.8875, 'time@10': 7.8524}:  70%|███████   | 7/10 [00:45<00:18,  6.07s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9506, 'compress@10': 0.8875, 'time@10': 7.8524}:  80%|████████  | 8/10 [00:45<00:12,  6.33s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9518, 'compress@10': 0.8989, 'time@10': 8.3854}:  80%|████████  | 8/10 [00:52<00:12,  6.33s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9518, 'compress@10': 0.8989, 'time@10': 8.3854}:  90%|█████████ | 9/10 [00:52<00:06,  6.34s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9502, 'compress@10': 0.906, 'time@10': 8.4993}:  90%|█████████ | 9/10 [01:01<00:06,  6.34s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9502, 'compress@10': 0.906, 'time@10': 8.4993}: 100%|██████████| 10/10 [01:01<00:00,  7.34s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9502, 'compress@10': 0.906, 'time@10': 8.4993}: 100%|██████████| 10/10 [01:01<00:00,  6.19s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.012555245015511179
Avg hit ratio: 0.9063386668038621
Avg ndcg: 0.9502192663142314
Avg compression ratio: 0.906006120877892
Avg train time: 8.499303436279297
Std train time: 2.5430144098275047
[0.99, 0.99, 0.030000000000000006, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.97]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.9905, 'time@10': 7.5452}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.9905, 'time@10': 7.5452}:  10%|█         | 1/10 [00:03<00:34,  3.81s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9487, 'compress@10': 0.9904, 'time@10': 6.8593}:  10%|█         | 1/10 [00:10<00:34,  3.81s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9487, 'compress@10': 0.9904, 'time@10': 6.8593}:  20%|██        | 2/10 [00:10<00:41,  5.22s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9182, 'compress@10': 0.7165, 'time@10': 6.4456}:  20%|██        | 2/10 [00:12<00:41,  5.22s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9182, 'compress@10': 0.7165, 'time@10': 6.4456}:  30%|███       | 3/10 [00:12<00:28,  4.14s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9295, 'compress@10': 0.7849, 'time@10': 6.2543}:  30%|███       | 3/10 [00:18<00:28,  4.14s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9295, 'compress@10': 0.7849, 'time@10': 6.2543}:  40%|████      | 4/10 [00:18<00:28,  4.76s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9363, 'compress@10': 0.826, 'time@10': 7.4355}:  40%|████      | 4/10 [00:24<00:28,  4.76s/it] {'epoch': 49, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9363, 'compress@10': 0.826, 'time@10': 7.4355}:  50%|█████     | 5/10 [00:24<00:26,  5.25s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9437, 'compress@10': 0.8534, 'time@10': 7.6407}:  50%|█████     | 5/10 [00:33<00:26,  5.25s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9437, 'compress@10': 0.8534, 'time@10': 7.6407}:  60%|██████    | 6/10 [00:33<00:25,  6.42s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9457, 'compress@10': 0.8729, 'time@10': 7.9085}:  60%|██████    | 6/10 [00:38<00:25,  6.42s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9457, 'compress@10': 0.8729, 'time@10': 7.9085}:  70%|███████   | 7/10 [00:38<00:17,  5.89s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0097, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9549, 'compress@10': 0.8876, 'time@10': 7.7638}:  70%|███████   | 7/10 [00:44<00:17,  5.89s/it]  {'epoch': 49, 'num_users': 6.125, 'loss': 0.0097, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9549, 'compress@10': 0.8876, 'time@10': 7.7638}:  80%|████████  | 8/10 [00:44<00:12,  6.18s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9566, 'compress@10': 0.899, 'time@10': 8.3259}:  80%|████████  | 8/10 [00:51<00:12,  6.18s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9566, 'compress@10': 0.899, 'time@10': 8.3259}:  90%|█████████ | 9/10 [00:51<00:06,  6.26s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9586, 'compress@10': 0.9062, 'time@10': 8.408}:  90%|█████████ | 9/10 [01:00<00:06,  6.26s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9586, 'compress@10': 0.9062, 'time@10': 8.408}: 100%|██████████| 10/10 [01:00<00:00,  7.16s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9586, 'compress@10': 0.9062, 'time@10': 8.408}: 100%|██████████| 10/10 [01:00<00:00,  6.06s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.008839863726600386
Avg hit ratio: 0.9048307302959255
Avg ndcg: 0.9586439769103452
Avg compression ratio: 0.9061688684327086
Avg train time: 8.408014488220214
Std train time: 2.4314444067327217
[0.9901960784313726, 0.9901960784313726, 0.02941176470588236, 0.9901960784313726, 0.9901960784313726, 0.9901960784313726, 0.9901960784313726, 0.9901960784313726, 0.9901960784313726, 0.9705882352941176]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
