  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.191, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.5139, 'compress@10': 0.5263, 'time@10': 9.9867}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.191, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.5139, 'compress@10': 0.5263, 'time@10': 9.9867}:  10%|█         | 1/10 [00:05<00:45,  5.04s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1363, 'hit_ratio@10': 0.6239, 'ndcg@10': 0.6266, 'compress@10': 0.5212, 'time@10': 8.5991}:  10%|█         | 1/10 [00:12<00:45,  5.04s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1363, 'hit_ratio@10': 0.6239, 'ndcg@10': 0.6266, 'compress@10': 0.5212, 'time@10': 8.5991}:  20%|██        | 2/10 [00:12<00:50,  6.34s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8187, 'hit_ratio@10': 0.4636, 'ndcg@10': 0.4177, 'compress@10': 0.538, 'time@10': 6.6882}:  20%|██        | 2/10 [00:13<00:50,  6.34s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.8187, 'hit_ratio@10': 0.4636, 'ndcg@10': 0.4177, 'compress@10': 0.538, 'time@10': 6.6882}:  30%|███       | 3/10 [00:13<00:28,  4.12s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6421, 'hit_ratio@10': 0.5441, 'ndcg@10': 0.4647, 'compress@10': 0.5329, 'time@10': 6.5979}:  30%|███       | 3/10 [00:20<00:28,  4.12s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6421, 'hit_ratio@10': 0.5441, 'ndcg@10': 0.4647, 'compress@10': 0.5329, 'time@10': 6.5979}:  40%|████      | 4/10 [00:20<00:30,  5.00s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5324, 'hit_ratio@10': 0.5993, 'ndcg@10': 0.5225, 'compress@10': 0.5283, 'time@10': 10.03}:  40%|████      | 4/10 [00:32<00:30,  5.00s/it] {'epoch': 0, 'num_users': 5.8, 'loss': 0.5324, 'hit_ratio@10': 0.5993, 'ndcg@10': 0.5225, 'compress@10': 0.5283, 'time@10': 10.03}:  50%|█████     | 5/10 [00:32<00:37,  7.50s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4583, 'hit_ratio@10': 0.6179, 'ndcg@10': 0.5637, 'compress@10': 0.5255, 'time@10': 10.1296}:  50%|█████     | 5/10 [00:42<00:37,  7.50s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4583, 'hit_ratio@10': 0.6179, 'ndcg@10': 0.5637, 'compress@10': 0.5255, 'time@10': 10.1296}:  60%|██████    | 6/10 [00:42<00:34,  8.58s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4093, 'hit_ratio@10': 0.6268, 'ndcg@10': 0.5656, 'compress@10': 0.5247, 'time@10': 10.3567}:  60%|██████    | 6/10 [00:48<00:34,  8.58s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4093, 'hit_ratio@10': 0.6268, 'ndcg@10': 0.5656, 'compress@10': 0.5247, 'time@10': 10.3567}:  70%|███████   | 7/10 [00:48<00:23,  7.70s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3646, 'hit_ratio@10': 0.6627, 'ndcg@10': 0.5917, 'compress@10': 0.5234, 'time@10': 10.0615}:  70%|███████   | 7/10 [00:56<00:23,  7.70s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3646, 'hit_ratio@10': 0.6627, 'ndcg@10': 0.5917, 'compress@10': 0.5234, 'time@10': 10.0615}:  80%|████████  | 8/10 [00:56<00:15,  7.81s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3305, 'hit_ratio@10': 0.6748, 'ndcg@10': 0.6259, 'compress@10': 0.5224, 'time@10': 10.7731}:  80%|████████  | 8/10 [01:04<00:15,  7.81s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3305, 'hit_ratio@10': 0.6748, 'ndcg@10': 0.6259, 'compress@10': 0.5224, 'time@10': 10.7731}:  90%|█████████ | 9/10 [01:04<00:07,  7.95s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3028, 'hit_ratio@10': 0.7005, 'ndcg@10': 0.6472, 'compress@10': 0.5213, 'time@10': 10.7179}:  90%|█████████ | 9/10 [01:15<00:07,  7.95s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.3028, 'hit_ratio@10': 0.7005, 'ndcg@10': 0.6472, 'compress@10': 0.5213, 'time@10': 10.7179}: 100%|██████████| 10/10 [01:15<00:00,  8.66s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3028, 'hit_ratio@10': 0.7005, 'ndcg@10': 0.6472, 'compress@10': 0.5213, 'time@10': 10.7179}: 100%|██████████| 10/10 [01:15<00:00,  7.52s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.3027622007253159
Avg hit ratio: 0.700509276612842
Avg ndcg: 0.6471700101716131
Avg compression ratio: 0.5212749006657823
Avg train time: 10.717926406860352
Std train time: 5.527238511854709
[0.75, 0.25, 0.75, 0.25, 0.25, 0.25, 0.75, 0.25, 0.25, 0.25]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0538, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8482, 'compress@10': 0.7632, 'time@10': 8.5566}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0538, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8482, 'compress@10': 0.7632, 'time@10': 8.5566}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0534, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8506, 'compress@10': 0.5187, 'time@10': 7.8547}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0534, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8506, 'compress@10': 0.5187, 'time@10': 7.8547}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0436, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.812, 'compress@10': 0.6077, 'time@10': 6.324}:  20%|██        | 2/10 [00:13<00:48,  6.01s/it]  {'epoch': 1, 'num_users': 5.0, 'loss': 0.0436, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.812, 'compress@10': 0.6077, 'time@10': 6.324}:  30%|███       | 3/10 [00:13<00:28,  4.03s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0451, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.82, 'compress@10': 0.525, 'time@10': 6.3246}:  30%|███       | 3/10 [00:19<00:28,  4.03s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.0451, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.82, 'compress@10': 0.525, 'time@10': 6.3246}:  40%|████      | 4/10 [00:19<00:29,  4.95s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0533, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8142, 'compress@10': 0.473, 'time@10': 9.2032}:  40%|████      | 4/10 [00:29<00:29,  4.95s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0533, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8142, 'compress@10': 0.473, 'time@10': 9.2032}:  50%|█████     | 5/10 [00:29<00:34,  6.92s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0572, 'hit_ratio@10': 0.7877, 'ndcg@10': 0.8139, 'compress@10': 0.4386, 'time@10': 9.4034}:  50%|█████     | 5/10 [00:40<00:34,  6.92s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0572, 'hit_ratio@10': 0.7877, 'ndcg@10': 0.8139, 'compress@10': 0.4386, 'time@10': 9.4034}:  60%|██████    | 6/10 [00:40<00:32,  8.12s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0553, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.8224, 'compress@10': 0.4845, 'time@10': 9.7136}:  60%|██████    | 6/10 [00:46<00:32,  8.12s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0553, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.8224, 'compress@10': 0.4845, 'time@10': 9.7136}:  70%|███████   | 7/10 [00:46<00:22,  7.37s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.053, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8286, 'compress@10': 0.4579, 'time@10': 9.4879}:  70%|███████   | 7/10 [00:54<00:22,  7.37s/it]   {'epoch': 1, 'num_users': 6.125, 'loss': 0.053, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8286, 'compress@10': 0.4579, 'time@10': 9.4879}:  80%|████████  | 8/10 [00:54<00:15,  7.55s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.051, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.8381, 'compress@10': 0.4372, 'time@10': 10.0437}:  80%|████████  | 8/10 [01:01<00:15,  7.55s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.051, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.8381, 'compress@10': 0.4372, 'time@10': 10.0437}:  90%|█████████ | 9/10 [01:01<00:07,  7.47s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0505, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8386, 'compress@10': 0.4201, 'time@10': 9.9956}:  90%|█████████ | 9/10 [01:11<00:07,  7.47s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0505, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8386, 'compress@10': 0.4201, 'time@10': 9.9956}: 100%|██████████| 10/10 [01:11<00:00,  8.13s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0505, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8386, 'compress@10': 0.4201, 'time@10': 9.9956}: 100%|██████████| 10/10 [01:11<00:00,  7.10s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.0505200425916177
Avg hit ratio: 0.8246381741254407
Avg ndcg: 0.838641059764116
Avg compression ratio: 0.4201398849998804
Avg train time: 9.995565676689148
Std train time: 4.5967256870966775
[0.8333333333333334, 0.16666666666666669, 0.5, 0.16666666666666669, 0.5, 0.5, 0.5, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8427, 'compress@10': 0.8421, 'time@10': 8.4817}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8427, 'compress@10': 0.8421, 'time@10': 8.4817}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8471, 'compress@10': 0.5178, 'time@10': 7.6432}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8471, 'compress@10': 0.5178, 'time@10': 7.6432}:  20%|██        | 2/10 [00:11<00:46,  5.79s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8483, 'compress@10': 0.5357, 'time@10': 6.2258}:  20%|██        | 2/10 [00:12<00:46,  5.79s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8483, 'compress@10': 0.5357, 'time@10': 6.2258}:  30%|███       | 3/10 [00:12<00:27,  3.94s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0379, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8475, 'compress@10': 0.4509, 'time@10': 6.2376}:  30%|███       | 3/10 [00:19<00:27,  3.94s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.0379, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8475, 'compress@10': 0.4509, 'time@10': 6.2376}:  40%|████      | 4/10 [00:19<00:29,  4.87s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0474, 'hit_ratio@10': 0.7696, 'ndcg@10': 0.8352, 'compress@10': 0.4627, 'time@10': 8.737}:  40%|████      | 4/10 [00:28<00:29,  4.87s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0474, 'hit_ratio@10': 0.7696, 'ndcg@10': 0.8352, 'compress@10': 0.4627, 'time@10': 8.737}:  50%|█████     | 5/10 [00:28<00:32,  6.51s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0518, 'hit_ratio@10': 0.7673, 'ndcg@10': 0.832, 'compress@10': 0.4708, 'time@10': 9.0775}:  50%|█████     | 5/10 [00:39<00:32,  6.51s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0518, 'hit_ratio@10': 0.7673, 'ndcg@10': 0.832, 'compress@10': 0.4708, 'time@10': 9.0775}:  60%|██████    | 6/10 [00:39<00:31,  7.98s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.8359, 'compress@10': 0.4778, 'time@10': 9.4468}:  60%|██████    | 6/10 [00:45<00:31,  7.98s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.8359, 'compress@10': 0.4778, 'time@10': 9.4468}:  70%|███████   | 7/10 [00:45<00:21,  7.29s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0512, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8364, 'compress@10': 0.4419, 'time@10': 9.3376}:  70%|███████   | 7/10 [00:53<00:21,  7.29s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0512, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8364, 'compress@10': 0.4419, 'time@10': 9.3376}:  80%|████████  | 8/10 [00:53<00:15,  7.71s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8443, 'compress@10': 0.414, 'time@10': 9.8867}:  80%|████████  | 8/10 [01:01<00:15,  7.71s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8443, 'compress@10': 0.414, 'time@10': 9.8867}:  90%|█████████ | 9/10 [01:01<00:07,  7.54s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8453, 'compress@10': 0.3911, 'time@10': 9.8733}:  90%|█████████ | 9/10 [01:10<00:07,  7.54s/it]  {'epoch': 2, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8453, 'compress@10': 0.3911, 'time@10': 9.8733}: 100%|██████████| 10/10 [01:10<00:00,  8.24s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8453, 'compress@10': 0.3911, 'time@10': 9.8733}: 100%|██████████| 10/10 [01:10<00:00,  7.09s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04910393732739517
Avg hit ratio: 0.8181040969971362
Avg ndcg: 0.8452625781297666
Avg compression ratio: 0.3911207921032266
Avg train time: 9.873298406600952
Std train time: 4.123169931747388
[0.625, 0.125, 0.375, 0.125, 0.625, 0.625, 0.375, 0.375, 0.125, 0.125]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8544, 'compress@10': 0.6447, 'time@10': 8.7912}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8544, 'compress@10': 0.6447, 'time@10': 8.7912}:  10%|█         | 1/10 [00:04<00:39,  4.43s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.853, 'compress@10': 0.399, 'time@10': 7.8502}:  10%|█         | 1/10 [00:11<00:39,  4.43s/it]  {'epoch': 3, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.853, 'compress@10': 0.399, 'time@10': 7.8502}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8544, 'compress@10': 0.4207, 'time@10': 6.4656}:  20%|██        | 2/10 [00:13<00:47,  5.92s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8544, 'compress@10': 0.4207, 'time@10': 6.4656}:  30%|███       | 3/10 [00:13<00:28,  4.08s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8539, 'compress@10': 0.3546, 'time@10': 6.4193}:  30%|███       | 3/10 [00:19<00:28,  4.08s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8539, 'compress@10': 0.3546, 'time@10': 6.4193}:  40%|████      | 4/10 [00:19<00:29,  4.96s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8415, 'compress@10': 0.4102, 'time@10': 8.5114}:  40%|████      | 4/10 [00:28<00:29,  4.96s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8415, 'compress@10': 0.4102, 'time@10': 8.5114}:  50%|█████     | 5/10 [00:28<00:31,  6.24s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0496, 'hit_ratio@10': 0.7813, 'ndcg@10': 0.8384, 'compress@10': 0.4474, 'time@10': 8.8871}:  50%|█████     | 5/10 [00:38<00:31,  6.24s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0496, 'hit_ratio@10': 0.7813, 'ndcg@10': 0.8384, 'compress@10': 0.4474, 'time@10': 8.8871}:  60%|██████    | 6/10 [00:38<00:31,  7.79s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0491, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8402, 'compress@10': 0.4406, 'time@10': 9.2494}:  60%|██████    | 6/10 [00:44<00:31,  7.79s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0491, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8402, 'compress@10': 0.4406, 'time@10': 9.2494}:  70%|███████   | 7/10 [00:44<00:21,  7.12s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8432, 'compress@10': 0.4346, 'time@10': 9.1027}:  70%|███████   | 7/10 [00:52<00:21,  7.12s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8432, 'compress@10': 0.4346, 'time@10': 9.1027}:  80%|████████  | 8/10 [00:52<00:14,  7.44s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0499, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.852, 'compress@10': 0.403, 'time@10': 9.6165}:  80%|████████  | 8/10 [00:59<00:14,  7.44s/it] {'epoch': 3, 'num_users': 6.3333, 'loss': 0.0499, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.852, 'compress@10': 0.403, 'time@10': 9.6165}:  90%|█████████ | 9/10 [00:59<00:07,  7.27s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8512, 'compress@10': 0.3772, 'time@10': 9.6181}:  90%|█████████ | 9/10 [01:09<00:07,  7.27s/it] {'epoch': 3, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8512, 'compress@10': 0.3772, 'time@10': 9.6181}: 100%|██████████| 10/10 [01:09<00:00,  8.01s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8512, 'compress@10': 0.3772, 'time@10': 9.6181}: 100%|██████████| 10/10 [01:09<00:00,  6.93s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.04954183537651921
Avg hit ratio: 0.8322699956146475
Avg ndcg: 0.8511721526836464
Avg compression ratio: 0.37720557581041086
Avg train time: 9.618100333213807
Std train time: 3.6167394634337198
[0.5, 0.1, 0.3, 0.1, 0.7, 0.7, 0.3, 0.5, 0.1, 0.1]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8461, 'compress@10': 0.5263, 'time@10': 8.7341}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8461, 'compress@10': 0.5263, 'time@10': 8.7341}:  10%|█         | 1/10 [00:04<00:39,  4.41s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0487, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.851, 'compress@10': 0.3277, 'time@10': 7.6815}:  10%|█         | 1/10 [00:11<00:39,  4.41s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0487, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.851, 'compress@10': 0.3277, 'time@10': 7.6815}:  20%|██        | 2/10 [00:11<00:45,  5.74s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0327, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8531, 'compress@10': 0.3518, 'time@10': 6.3819}:  20%|██        | 2/10 [00:12<00:45,  5.74s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0327, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8531, 'compress@10': 0.3518, 'time@10': 6.3819}:  30%|███       | 3/10 [00:12<00:27,  4.00s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8491, 'compress@10': 0.2969, 'time@10': 6.2703}:  30%|███       | 3/10 [00:18<00:27,  4.00s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8491, 'compress@10': 0.2969, 'time@10': 6.2703}:  40%|████      | 4/10 [00:18<00:28,  4.78s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8369, 'compress@10': 0.3787, 'time@10': 7.8738}:  40%|████      | 4/10 [00:26<00:28,  4.78s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8369, 'compress@10': 0.3787, 'time@10': 7.8738}:  50%|█████     | 5/10 [00:26<00:28,  5.64s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0491, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8352, 'compress@10': 0.4334, 'time@10': 8.3029}:  50%|█████     | 5/10 [00:36<00:28,  5.64s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0491, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8352, 'compress@10': 0.4334, 'time@10': 8.3029}:  60%|██████    | 6/10 [00:36<00:29,  7.29s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0489, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8352, 'compress@10': 0.4183, 'time@10': 8.6968}:  60%|██████    | 6/10 [00:42<00:29,  7.29s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0489, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8352, 'compress@10': 0.4183, 'time@10': 8.6968}:  70%|███████   | 7/10 [00:42<00:20,  6.73s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0498, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8419, 'compress@10': 0.4303, 'time@10': 8.7158}:  70%|███████   | 7/10 [00:51<00:20,  6.73s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0498, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8419, 'compress@10': 0.4303, 'time@10': 8.7158}:  80%|████████  | 8/10 [00:51<00:14,  7.42s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.049, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8501, 'compress@10': 0.3965, 'time@10': 9.2622}:  80%|████████  | 8/10 [00:57<00:14,  7.42s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.049, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8501, 'compress@10': 0.3965, 'time@10': 9.2622}:  90%|█████████ | 9/10 [00:57<00:07,  7.24s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0484, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8497, 'compress@10': 0.3689, 'time@10': 9.2443}:  90%|█████████ | 9/10 [01:07<00:07,  7.24s/it]  {'epoch': 4, 'num_users': 6.3, 'loss': 0.0484, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8497, 'compress@10': 0.3689, 'time@10': 9.2443}: 100%|██████████| 10/10 [01:07<00:00,  7.82s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0484, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8497, 'compress@10': 0.3689, 'time@10': 9.2443}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04844078983192999
Avg hit ratio: 0.8425080908527429
Avg ndcg: 0.8496844266792964
Avg compression ratio: 0.3688634871750995
Avg train time: 9.24429817199707
Std train time: 3.1225335444737885
[0.4166666666666667, 0.08333333333333334, 0.25, 0.08333333333333334, 0.75, 0.75, 0.25, 0.5833333333333334, 0.08333333333333334, 0.08333333333333334]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0479, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8639, 'compress@10': 0.4474, 'time@10': 8.7559}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0479, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8639, 'compress@10': 0.4474, 'time@10': 8.7559}:  10%|█         | 1/10 [00:04<00:39,  4.42s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8626, 'compress@10': 0.2801, 'time@10': 7.5876}:  10%|█         | 1/10 [00:10<00:39,  4.42s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8626, 'compress@10': 0.2801, 'time@10': 7.5876}:  20%|██        | 2/10 [00:10<00:44,  5.62s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8608, 'compress@10': 0.3058, 'time@10': 6.4536}:  20%|██        | 2/10 [00:12<00:44,  5.62s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8608, 'compress@10': 0.3058, 'time@10': 6.4536}:  30%|███       | 3/10 [00:12<00:28,  4.02s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8535, 'compress@10': 0.2584, 'time@10': 6.283}:  30%|███       | 3/10 [00:18<00:28,  4.02s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8535, 'compress@10': 0.2584, 'time@10': 6.283}:  40%|████      | 4/10 [00:18<00:28,  4.73s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0452, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8404, 'compress@10': 0.3577, 'time@10': 7.9816}:  40%|████      | 4/10 [00:26<00:28,  4.73s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0452, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8404, 'compress@10': 0.3577, 'time@10': 7.9816}:  50%|█████     | 5/10 [00:26<00:28,  5.70s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0478, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8385, 'compress@10': 0.424, 'time@10': 8.3989}:  50%|█████     | 5/10 [00:36<00:28,  5.70s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0478, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8385, 'compress@10': 0.424, 'time@10': 8.3989}:  60%|██████    | 6/10 [00:36<00:29,  7.34s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0473, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.842, 'compress@10': 0.4034, 'time@10': 8.9197}:  60%|██████    | 6/10 [00:42<00:29,  7.34s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0473, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.842, 'compress@10': 0.4034, 'time@10': 8.9197}:  70%|███████   | 7/10 [00:42<00:20,  6.92s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0478, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8457, 'compress@10': 0.4274, 'time@10': 8.8349}:  70%|███████   | 7/10 [00:51<00:20,  6.92s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0478, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8457, 'compress@10': 0.4274, 'time@10': 8.8349}:  80%|████████  | 8/10 [00:51<00:14,  7.35s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0475, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8538, 'compress@10': 0.3921, 'time@10': 9.3324}:  80%|████████  | 8/10 [00:57<00:14,  7.35s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0475, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8538, 'compress@10': 0.3921, 'time@10': 9.3324}:  90%|█████████ | 9/10 [00:57<00:07,  7.15s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0466, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8542, 'compress@10': 0.3633, 'time@10': 9.3299}:  90%|█████████ | 9/10 [01:07<00:07,  7.15s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0466, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8542, 'compress@10': 0.3633, 'time@10': 9.3299}: 100%|██████████| 10/10 [01:07<00:00,  7.83s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0466, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8542, 'compress@10': 0.3633, 'time@10': 9.3299}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04655418193350107
Avg hit ratio: 0.8532223765670285
Avg ndcg: 0.8542483591446075
Avg compression ratio: 0.36330012292347286
Avg train time: 9.329911637306214
Std train time: 3.2144762706515206
[0.35714285714285715, 0.07142857142857144, 0.2142857142857143, 0.07142857142857144, 0.7857142857142857, 0.7857142857142857, 0.2142857142857143, 0.6428571428571429, 0.07142857142857144, 0.07142857142857144]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8429, 'compress@10': 0.391, 'time@10': 8.6174}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8429, 'compress@10': 0.391, 'time@10': 8.6174}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0456, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8518, 'compress@10': 0.2462, 'time@10': 7.4823}:  10%|█         | 1/10 [00:10<00:39,  4.35s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0456, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8518, 'compress@10': 0.2462, 'time@10': 7.4823}:  20%|██        | 2/10 [00:10<00:44,  5.55s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8536, 'compress@10': 0.273, 'time@10': 6.4263}:  20%|██        | 2/10 [00:12<00:44,  5.55s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8536, 'compress@10': 0.273, 'time@10': 6.4263}:  30%|███       | 3/10 [00:12<00:28,  4.02s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8466, 'compress@10': 0.2309, 'time@10': 6.2469}:  30%|███       | 3/10 [00:18<00:28,  4.02s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8466, 'compress@10': 0.2309, 'time@10': 6.2469}:  40%|████      | 4/10 [00:18<00:28,  4.70s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0442, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8347, 'compress@10': 0.3427, 'time@10': 7.8934}:  40%|████      | 4/10 [00:25<00:28,  4.70s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0442, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8347, 'compress@10': 0.3427, 'time@10': 7.8934}:  50%|█████     | 5/10 [00:25<00:28,  5.63s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0461, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8361, 'compress@10': 0.4173, 'time@10': 8.2686}:  50%|█████     | 5/10 [00:36<00:28,  5.63s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0461, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8361, 'compress@10': 0.4173, 'time@10': 8.2686}:  60%|██████    | 6/10 [00:36<00:28,  7.18s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0451, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8368, 'compress@10': 0.3928, 'time@10': 8.6664}:  60%|██████    | 6/10 [00:41<00:28,  7.18s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0451, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8368, 'compress@10': 0.3928, 'time@10': 8.6664}:  70%|███████   | 7/10 [00:41<00:19,  6.65s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0453, 'hit_ratio@10': 0.882, 'ndcg@10': 0.8398, 'compress@10': 0.4253, 'time@10': 8.5875}:  70%|███████   | 7/10 [00:49<00:19,  6.65s/it]  {'epoch': 6, 'num_users': 6.125, 'loss': 0.0453, 'hit_ratio@10': 0.882, 'ndcg@10': 0.8398, 'compress@10': 0.4253, 'time@10': 8.5875}:  80%|████████  | 8/10 [00:49<00:14,  7.11s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0442, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8487, 'compress@10': 0.389, 'time@10': 9.0945}:  80%|████████  | 8/10 [00:56<00:14,  7.11s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0442, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8487, 'compress@10': 0.389, 'time@10': 9.0945}:  90%|█████████ | 9/10 [00:56<00:06,  6.95s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0434, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.8514, 'compress@10': 0.3593, 'time@10': 9.0957}:  90%|█████████ | 9/10 [01:05<00:06,  6.95s/it]  {'epoch': 6, 'num_users': 6.3, 'loss': 0.0434, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.8514, 'compress@10': 0.3593, 'time@10': 9.0957}: 100%|██████████| 10/10 [01:05<00:00,  7.63s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0434, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.8514, 'compress@10': 0.3593, 'time@10': 9.0957}: 100%|██████████| 10/10 [01:05<00:00,  6.55s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04338474469087502
Avg hit ratio: 0.8787497703202287
Avg ndcg: 0.8514396774996656
Avg compression ratio: 0.35932615557848874
Avg train time: 9.095693707466125
Std train time: 3.0594015075000445
[0.3125, 0.06250000000000001, 0.1875, 0.1875, 0.8125, 0.8125, 0.1875, 0.5625, 0.06250000000000001, 0.06250000000000001]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8605, 'compress@10': 0.3487, 'time@10': 8.4546}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8605, 'compress@10': 0.3487, 'time@10': 8.4546}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8601, 'compress@10': 0.2207, 'time@10': 7.4558}:  10%|█         | 1/10 [00:10<00:38,  4.26s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8601, 'compress@10': 0.2207, 'time@10': 7.4558}:  20%|██        | 2/10 [00:10<00:44,  5.58s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8591, 'compress@10': 0.2483, 'time@10': 6.5633}:  20%|██        | 2/10 [00:13<00:44,  5.58s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8591, 'compress@10': 0.2483, 'time@10': 6.5633}:  30%|███       | 3/10 [00:13<00:28,  4.14s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8552, 'compress@10': 0.2404, 'time@10': 6.497}:  30%|███       | 3/10 [00:19<00:28,  4.14s/it]  {'epoch': 7, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8552, 'compress@10': 0.2404, 'time@10': 6.497}:  40%|████      | 4/10 [00:19<00:30,  5.01s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.043, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8424, 'compress@10': 0.3556, 'time@10': 7.985}:  40%|████      | 4/10 [00:26<00:30,  5.01s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.043, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8424, 'compress@10': 0.3556, 'time@10': 7.985}:  50%|█████     | 5/10 [00:26<00:28,  5.73s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0441, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8426, 'compress@10': 0.4324, 'time@10': 8.3683}:  50%|█████     | 5/10 [00:36<00:28,  5.73s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0441, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8426, 'compress@10': 0.4324, 'time@10': 8.3683}:  60%|██████    | 6/10 [00:36<00:29,  7.29s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.044, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8487, 'compress@10': 0.4021, 'time@10': 8.7346}:  60%|██████    | 6/10 [00:42<00:29,  7.29s/it] {'epoch': 7, 'num_users': 6.2857, 'loss': 0.044, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8487, 'compress@10': 0.4021, 'time@10': 8.7346}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0445, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8497, 'compress@10': 0.4237, 'time@10': 8.6516}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0445, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8497, 'compress@10': 0.4237, 'time@10': 8.6516}:  80%|████████  | 8/10 [00:50<00:14,  7.15s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0441, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.8583, 'compress@10': 0.3865, 'time@10': 9.0913}:  80%|████████  | 8/10 [00:56<00:14,  7.15s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0441, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.8583, 'compress@10': 0.3865, 'time@10': 9.0913}:  90%|█████████ | 9/10 [00:56<00:06,  6.90s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0427, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8609, 'compress@10': 0.3563, 'time@10': 9.0799}:  90%|█████████ | 9/10 [01:05<00:06,  6.90s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0427, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8609, 'compress@10': 0.3563, 'time@10': 9.0799}: 100%|██████████| 10/10 [01:05<00:00,  7.55s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0427, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8609, 'compress@10': 0.3563, 'time@10': 9.0799}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04272273439849075
Avg hit ratio: 0.8568890432336952
Avg ndcg: 0.8608827998355043
Avg compression ratio: 0.35625063511004995
Avg train time: 9.079907560348511
Std train time: 2.7471673979939286
[0.2777777777777778, 0.055555555555555566, 0.16666666666666666, 0.2777777777777778, 0.8333333333333334, 0.8333333333333334, 0.16666666666666666, 0.5, 0.055555555555555566, 0.055555555555555566]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8388, 'compress@10': 0.3158, 'time@10': 8.4369}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8388, 'compress@10': 0.3158, 'time@10': 8.4369}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8549, 'compress@10': 0.2009, 'time@10': 7.4331}:  10%|█         | 1/10 [00:10<00:38,  4.25s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8549, 'compress@10': 0.2009, 'time@10': 7.4331}:  20%|██        | 2/10 [00:10<00:45,  5.65s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8557, 'compress@10': 0.2292, 'time@10': 6.6398}:  20%|██        | 2/10 [00:13<00:45,  5.65s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8557, 'compress@10': 0.2292, 'time@10': 6.6398}:  30%|███       | 3/10 [00:13<00:29,  4.24s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8594, 'compress@10': 0.2478, 'time@10': 6.5435}:  30%|███       | 3/10 [00:19<00:29,  4.24s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8594, 'compress@10': 0.2478, 'time@10': 6.5435}:  40%|████      | 4/10 [00:19<00:30,  5.05s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.041, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8459, 'compress@10': 0.3656, 'time@10': 8.1289}:  40%|████      | 4/10 [00:27<00:30,  5.05s/it] {'epoch': 8, 'num_users': 5.8, 'loss': 0.041, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8459, 'compress@10': 0.3656, 'time@10': 8.1289}:  50%|█████     | 5/10 [00:27<00:29,  5.85s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.042, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8469, 'compress@10': 0.4441, 'time@10': 8.4886}:  50%|█████     | 5/10 [00:37<00:29,  5.85s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.042, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8469, 'compress@10': 0.4441, 'time@10': 8.4886}:  60%|██████    | 6/10 [00:37<00:29,  7.37s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0416, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8463, 'compress@10': 0.4093, 'time@10': 8.8516}:  60%|██████    | 6/10 [00:42<00:29,  7.37s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0416, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8463, 'compress@10': 0.4093, 'time@10': 8.8516}:  70%|███████   | 7/10 [00:42<00:20,  6.78s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0424, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.8462, 'compress@10': 0.4224, 'time@10': 8.7514}:  70%|███████   | 7/10 [00:50<00:20,  6.78s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0424, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.8462, 'compress@10': 0.4224, 'time@10': 8.7514}:  80%|████████  | 8/10 [00:50<00:14,  7.19s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0413, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8575, 'compress@10': 0.3846, 'time@10': 9.1767}:  80%|████████  | 8/10 [00:57<00:14,  7.19s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0413, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8575, 'compress@10': 0.3846, 'time@10': 9.1767}:  90%|█████████ | 9/10 [00:57<00:06,  6.92s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0409, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8607, 'compress@10': 0.3539, 'time@10': 9.1861}:  90%|█████████ | 9/10 [01:06<00:06,  6.92s/it]  {'epoch': 8, 'num_users': 6.3, 'loss': 0.0409, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8607, 'compress@10': 0.3539, 'time@10': 9.1861}: 100%|██████████| 10/10 [01:06<00:00,  7.66s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0409, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8607, 'compress@10': 0.3539, 'time@10': 9.1861}: 100%|██████████| 10/10 [01:06<00:00,  6.66s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.040900784012244104
Avg hit ratio: 0.8757106426868736
Avg ndcg: 0.8606588210208678
Avg compression ratio: 0.35386669061336007
Avg train time: 9.186060905456543
Std train time: 2.8139558391591595
[0.25, 0.05000000000000001, 0.15, 0.35, 0.8500000000000001, 0.75, 0.15, 0.55, 0.05000000000000001, 0.05000000000000001]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.2895, 'time@10': 8.5319}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.2895, 'time@10': 8.5319}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0416, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8617, 'compress@10': 0.1851, 'time@10': 7.644}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it] {'epoch': 9, 'num_users': 7.0, 'loss': 0.0416, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8617, 'compress@10': 0.1851, 'time@10': 7.644}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8602, 'compress@10': 0.2139, 'time@10': 6.8652}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8602, 'compress@10': 0.2139, 'time@10': 6.8652}:  30%|███       | 3/10 [00:13<00:30,  4.36s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8627, 'compress@10': 0.2537, 'time@10': 6.6954}:  30%|███       | 3/10 [00:20<00:30,  4.36s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8627, 'compress@10': 0.2537, 'time@10': 6.6954}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.04, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8486, 'compress@10': 0.3736, 'time@10': 8.1588}:  40%|████      | 4/10 [00:27<00:30,  5.10s/it]  {'epoch': 9, 'num_users': 5.8, 'loss': 0.04, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8486, 'compress@10': 0.3736, 'time@10': 8.1588}:  50%|█████     | 5/10 [00:27<00:29,  5.80s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0402, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8515, 'compress@10': 0.4372, 'time@10': 8.5288}:  50%|█████     | 5/10 [00:37<00:29,  5.80s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0402, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8515, 'compress@10': 0.4372, 'time@10': 8.5288}:  60%|██████    | 6/10 [00:37<00:29,  7.37s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0405, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8587, 'compress@10': 0.401, 'time@10': 8.8899}:  60%|██████    | 6/10 [00:43<00:29,  7.37s/it] {'epoch': 9, 'num_users': 6.2857, 'loss': 0.0405, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8587, 'compress@10': 0.401, 'time@10': 8.8899}:  70%|███████   | 7/10 [00:43<00:20,  6.78s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0404, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8586, 'compress@10': 0.4213, 'time@10': 8.8017}:  70%|███████   | 7/10 [00:51<00:20,  6.78s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0404, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8586, 'compress@10': 0.4213, 'time@10': 8.8017}:  80%|████████  | 8/10 [00:51<00:14,  7.24s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0407, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8689, 'compress@10': 0.383, 'time@10': 9.2355}:  80%|████████  | 8/10 [00:57<00:14,  7.24s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0407, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8689, 'compress@10': 0.383, 'time@10': 9.2355}:  90%|█████████ | 9/10 [00:57<00:06,  6.97s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8693, 'compress@10': 0.3519, 'time@10': 9.2485}:  90%|█████████ | 9/10 [01:07<00:06,  6.97s/it]  {'epoch': 9, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8693, 'compress@10': 0.3519, 'time@10': 9.2485}: 100%|██████████| 10/10 [01:07<00:00,  7.72s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8693, 'compress@10': 0.3519, 'time@10': 9.2485}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.040193902946753235
Avg hit ratio: 0.864682694027346
Avg ndcg: 0.8693439623305098
Avg compression ratio: 0.3518938692970991
Avg train time: 9.248533344268798
Std train time: 2.6829239251929193
[0.3181818181818182, 0.04545454545454546, 0.13636363636363635, 0.40909090909090906, 0.8636363636363638, 0.6818181818181819, 0.13636363636363635, 0.5, 0.04545454545454546, 0.04545454545454546]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8502, 'compress@10': 0.3541, 'time@10': 8.6842}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8502, 'compress@10': 0.3541, 'time@10': 8.6842}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.862, 'compress@10': 0.2152, 'time@10': 7.624}:  10%|█         | 1/10 [00:10<00:39,  4.38s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.862, 'compress@10': 0.2152, 'time@10': 7.624}:  20%|██        | 2/10 [00:10<00:45,  5.69s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0282, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8604, 'compress@10': 0.23, 'time@10': 6.7899}:  20%|██        | 2/10 [00:13<00:45,  5.69s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0282, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8604, 'compress@10': 0.23, 'time@10': 6.7899}:  30%|███       | 3/10 [00:13<00:29,  4.28s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8642, 'compress@10': 0.2801, 'time@10': 6.669}:  30%|███       | 3/10 [00:19<00:29,  4.28s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8642, 'compress@10': 0.2801, 'time@10': 6.669}:  40%|████      | 4/10 [00:19<00:30,  5.09s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0389, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8512, 'compress@10': 0.3973, 'time@10': 8.1747}:  40%|████      | 4/10 [00:27<00:30,  5.09s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0389, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8512, 'compress@10': 0.3973, 'time@10': 8.1747}:  50%|█████     | 5/10 [00:27<00:29,  5.83s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0393, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8546, 'compress@10': 0.4459, 'time@10': 8.5523}:  50%|█████     | 5/10 [00:37<00:29,  5.83s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0393, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8546, 'compress@10': 0.4459, 'time@10': 8.5523}:  60%|██████    | 6/10 [00:37<00:29,  7.42s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0386, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8534, 'compress@10': 0.4066, 'time@10': 8.8412}:  60%|██████    | 6/10 [00:42<00:29,  7.42s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0386, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8534, 'compress@10': 0.4066, 'time@10': 8.8412}:  70%|███████   | 7/10 [00:42<00:20,  6.73s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0376, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8583, 'compress@10': 0.4201, 'time@10': 8.7489}:  70%|███████   | 7/10 [00:51<00:20,  6.73s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0376, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8583, 'compress@10': 0.4201, 'time@10': 8.7489}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0375, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.873, 'compress@10': 0.3815, 'time@10': 9.1954}:  80%|████████  | 8/10 [00:57<00:14,  7.18s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0375, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.873, 'compress@10': 0.3815, 'time@10': 9.1954}:  90%|█████████ | 9/10 [00:57<00:06,  6.94s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0361, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.878, 'compress@10': 0.3501, 'time@10': 9.2072}:  90%|█████████ | 9/10 [01:06<00:06,  6.94s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0361, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.878, 'compress@10': 0.3501, 'time@10': 9.2072}: 100%|██████████| 10/10 [01:06<00:00,  7.69s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0361, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.878, 'compress@10': 0.3501, 'time@10': 9.2072}: 100%|██████████| 10/10 [01:06<00:00,  6.68s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.036062284499240795
Avg hit ratio: 0.8777995771442291
Avg ndcg: 0.877955000127795
Avg compression ratio: 0.35005967685291933
Avg train time: 9.207231187820435
Std train time: 2.730626133729969
[0.375, 0.04166666666666667, 0.12499999999999999, 0.4583333333333333, 0.8750000000000001, 0.625, 0.12499999999999999, 0.4583333333333333, 0.04166666666666667, 0.04166666666666667]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8531, 'compress@10': 0.4079, 'time@10': 8.7343}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8531, 'compress@10': 0.4079, 'time@10': 8.7343}:  10%|█         | 1/10 [00:04<00:39,  4.40s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8715, 'compress@10': 0.2402, 'time@10': 7.7044}:  10%|█         | 1/10 [00:11<00:39,  4.40s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8715, 'compress@10': 0.2402, 'time@10': 7.7044}:  20%|██        | 2/10 [00:11<00:46,  5.76s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8667, 'compress@10': 0.2435, 'time@10': 7.0191}:  20%|██        | 2/10 [00:13<00:46,  5.76s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8667, 'compress@10': 0.2435, 'time@10': 7.0191}:  30%|███       | 3/10 [00:13<00:31,  4.44s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8697, 'compress@10': 0.302, 'time@10': 6.829}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]  {'epoch': 11, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8697, 'compress@10': 0.302, 'time@10': 6.829}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0366, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.856, 'compress@10': 0.4171, 'time@10': 8.2822}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0366, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.856, 'compress@10': 0.4171, 'time@10': 8.2822}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0373, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8581, 'compress@10': 0.4532, 'time@10': 8.6532}:  50%|█████     | 5/10 [00:37<00:29,  5.86s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0373, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8581, 'compress@10': 0.4532, 'time@10': 8.6532}:  60%|██████    | 6/10 [00:37<00:29,  7.45s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.037, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8652, 'compress@10': 0.4113, 'time@10': 8.9151}:  60%|██████    | 6/10 [00:43<00:29,  7.45s/it] {'epoch': 11, 'num_users': 6.2857, 'loss': 0.037, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8652, 'compress@10': 0.4113, 'time@10': 8.9151}:  70%|███████   | 7/10 [00:43<00:20,  6.74s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0353, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8698, 'compress@10': 0.4191, 'time@10': 8.7971}:  70%|███████   | 7/10 [00:51<00:20,  6.74s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0353, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8698, 'compress@10': 0.4191, 'time@10': 8.7971}:  80%|████████  | 8/10 [00:51<00:14,  7.15s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0357, 'hit_ratio@10': 0.866, 'ndcg@10': 0.8798, 'compress@10': 0.3802, 'time@10': 9.2497}:  80%|████████  | 8/10 [00:57<00:14,  7.15s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0357, 'hit_ratio@10': 0.866, 'ndcg@10': 0.8798, 'compress@10': 0.3802, 'time@10': 9.2497}:  90%|█████████ | 9/10 [00:57<00:06,  6.93s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0353, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8796, 'compress@10': 0.3485, 'time@10': 9.2422}:  90%|█████████ | 9/10 [01:06<00:06,  6.93s/it]  {'epoch': 11, 'num_users': 6.3, 'loss': 0.0353, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8796, 'compress@10': 0.3485, 'time@10': 9.2422}: 100%|██████████| 10/10 [01:06<00:00,  7.64s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0353, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8796, 'compress@10': 0.3485, 'time@10': 9.2422}: 100%|██████████| 10/10 [01:06<00:00,  6.69s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.035341545131948066
Avg hit ratio: 0.8771646565093084
Avg ndcg: 0.8795884898767046
Avg compression ratio: 0.3485308656265472
Avg train time: 9.242202258110046
Std train time: 2.6486505392636235
[0.4230769230769231, 0.038461538461538464, 0.11538461538461538, 0.5, 0.8846153846153847, 0.5769230769230769, 0.11538461538461538, 0.4230769230769231, 0.038461538461538464, 0.038461538461538464]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8395, 'compress@10': 0.4534, 'time@10': 8.6509}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8395, 'compress@10': 0.4534, 'time@10': 8.6509}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8688, 'compress@10': 0.2615, 'time@10': 7.6314}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8688, 'compress@10': 0.2615, 'time@10': 7.6314}:  20%|██        | 2/10 [00:11<00:45,  5.71s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8649, 'compress@10': 0.2549, 'time@10': 6.9427}:  20%|██        | 2/10 [00:13<00:45,  5.71s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8649, 'compress@10': 0.2549, 'time@10': 6.9427}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8692, 'compress@10': 0.3206, 'time@10': 6.7868}:  30%|███       | 3/10 [00:20<00:30,  4.39s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8692, 'compress@10': 0.3206, 'time@10': 6.7868}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0351, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.855, 'compress@10': 0.4339, 'time@10': 8.2217}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it] {'epoch': 12, 'num_users': 5.8, 'loss': 0.0351, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.855, 'compress@10': 0.4339, 'time@10': 8.2217}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0343, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8594, 'compress@10': 0.4593, 'time@10': 8.6207}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0343, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8594, 'compress@10': 0.4593, 'time@10': 8.6207}:  60%|██████    | 6/10 [00:37<00:29,  7.47s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0339, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.8617, 'compress@10': 0.4152, 'time@10': 8.9189}:  60%|██████    | 6/10 [00:43<00:29,  7.47s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0339, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.8617, 'compress@10': 0.4152, 'time@10': 8.9189}:  70%|███████   | 7/10 [00:43<00:20,  6.79s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0327, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.867, 'compress@10': 0.4183, 'time@10': 8.8112}:  70%|███████   | 7/10 [00:51<00:20,  6.79s/it]  {'epoch': 12, 'num_users': 6.125, 'loss': 0.0327, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.867, 'compress@10': 0.4183, 'time@10': 8.8112}:  80%|████████  | 8/10 [00:51<00:14,  7.21s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0329, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8768, 'compress@10': 0.3791, 'time@10': 9.2869}:  80%|████████  | 8/10 [00:57<00:14,  7.21s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0329, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8768, 'compress@10': 0.3791, 'time@10': 9.2869}:  90%|█████████ | 9/10 [00:57<00:07,  7.01s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8836, 'compress@10': 0.3472, 'time@10': 9.3037}:  90%|█████████ | 9/10 [01:07<00:07,  7.01s/it]    {'epoch': 12, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8836, 'compress@10': 0.3472, 'time@10': 9.3037}: 100%|██████████| 10/10 [01:07<00:00,  7.78s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8836, 'compress@10': 0.3472, 'time@10': 9.3037}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03101148051083367
Avg hit ratio: 0.8824278144040454
Avg ndcg: 0.8835576474617369
Avg compression ratio: 0.34723874012295464
Avg train time: 9.303688359260558
Std train time: 2.68104234389218
[0.4642857142857143, 0.03571428571428572, 0.10714285714285714, 0.5357142857142857, 0.8928571428571429, 0.5357142857142857, 0.10714285714285714, 0.39285714285714285, 0.03571428571428572, 0.03571428571428572]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8469, 'compress@10': 0.4925, 'time@10': 8.8346}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8469, 'compress@10': 0.4925, 'time@10': 8.8346}:  10%|█         | 1/10 [00:04<00:40,  4.46s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0396, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8655, 'compress@10': 0.2797, 'time@10': 7.6611}:  10%|█         | 1/10 [00:10<00:40,  4.46s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0396, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8655, 'compress@10': 0.2797, 'time@10': 7.6611}:  20%|██        | 2/10 [00:10<00:45,  5.67s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8627, 'compress@10': 0.2647, 'time@10': 6.9553}:  20%|██        | 2/10 [00:13<00:45,  5.67s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8627, 'compress@10': 0.2647, 'time@10': 6.9553}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8674, 'compress@10': 0.3366, 'time@10': 6.793}:  30%|███       | 3/10 [00:20<00:30,  4.37s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8674, 'compress@10': 0.3366, 'time@10': 6.793}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0344, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8553, 'compress@10': 0.4483, 'time@10': 8.1883}:  40%|████      | 4/10 [00:27<00:30,  5.15s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0344, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8553, 'compress@10': 0.4483, 'time@10': 8.1883}:  50%|█████     | 5/10 [00:27<00:28,  5.79s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0355, 'hit_ratio@10': 0.85, 'ndcg@10': 0.86, 'compress@10': 0.4646, 'time@10': 8.6152}:  50%|█████     | 5/10 [00:37<00:28,  5.79s/it] {'epoch': 13, 'num_users': 6.1667, 'loss': 0.0355, 'hit_ratio@10': 0.85, 'ndcg@10': 0.86, 'compress@10': 0.4646, 'time@10': 8.6152}:  60%|██████    | 6/10 [00:37<00:29,  7.49s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0344, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8669, 'compress@10': 0.4186, 'time@10': 8.8753}:  60%|██████    | 6/10 [00:43<00:29,  7.49s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0344, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8669, 'compress@10': 0.4186, 'time@10': 8.8753}:  70%|███████   | 7/10 [00:43<00:20,  6.76s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0331, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.8723, 'compress@10': 0.4175, 'time@10': 8.7782}:  70%|███████   | 7/10 [00:51<00:20,  6.76s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0331, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.8723, 'compress@10': 0.4175, 'time@10': 8.7782}:  80%|████████  | 8/10 [00:51<00:14,  7.20s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0328, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8815, 'compress@10': 0.3782, 'time@10': 9.228}:  80%|████████  | 8/10 [00:57<00:14,  7.20s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0328, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8815, 'compress@10': 0.3782, 'time@10': 9.228}:  90%|█████████ | 9/10 [00:57<00:06,  6.96s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.8794, 'compress@10': 0.3461, 'time@10': 9.2384}:  90%|█████████ | 9/10 [01:07<00:06,  6.96s/it]  {'epoch': 13, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.8794, 'compress@10': 0.3461, 'time@10': 9.2384}: 100%|██████████| 10/10 [01:07<00:00,  7.71s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.8794, 'compress@10': 0.3461, 'time@10': 9.2384}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.033161344132911295
Avg hit ratio: 0.8808789422235941
Avg ndcg: 0.879377504506383
Avg compression ratio: 0.3461311259803396
Avg train time: 9.238350653648377
Std train time: 2.615504693343323
[0.5, 0.03333333333333334, 0.09999999999999999, 0.5, 0.9, 0.5666666666666667, 0.09999999999999999, 0.36666666666666664, 0.03333333333333334, 0.03333333333333334]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8684, 'compress@10': 0.5263, 'time@10': 8.6054}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8684, 'compress@10': 0.5263, 'time@10': 8.6054}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0312, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8869, 'compress@10': 0.2954, 'time@10': 7.5751}:  10%|█         | 1/10 [00:10<00:39,  4.34s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0312, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8869, 'compress@10': 0.2954, 'time@10': 7.5751}:  20%|██        | 2/10 [00:10<00:45,  5.66s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.877, 'compress@10': 0.2731, 'time@10': 6.8816}:  20%|██        | 2/10 [00:13<00:45,  5.66s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.877, 'compress@10': 0.2731, 'time@10': 6.8816}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8806, 'compress@10': 0.3343, 'time@10': 6.7601}:  30%|███       | 3/10 [00:20<00:30,  4.35s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8806, 'compress@10': 0.3343, 'time@10': 6.7601}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.867, 'compress@10': 0.4479, 'time@10': 8.2311}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it] {'epoch': 14, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.867, 'compress@10': 0.4479, 'time@10': 8.2311}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0313, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8755, 'compress@10': 0.4693, 'time@10': 8.6166}:  50%|█████     | 5/10 [00:37<00:29,  5.87s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0313, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8755, 'compress@10': 0.4693, 'time@10': 8.6166}:  60%|██████    | 6/10 [00:37<00:29,  7.47s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0318, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8792, 'compress@10': 0.4217, 'time@10': 8.8811}:  60%|██████    | 6/10 [00:43<00:29,  7.47s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0318, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8792, 'compress@10': 0.4217, 'time@10': 8.8811}:  70%|███████   | 7/10 [00:43<00:20,  6.75s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0307, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.8835, 'compress@10': 0.417, 'time@10': 8.7898}:  70%|███████   | 7/10 [00:51<00:20,  6.75s/it]  {'epoch': 14, 'num_users': 6.125, 'loss': 0.0307, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.8835, 'compress@10': 0.417, 'time@10': 8.7898}:  80%|████████  | 8/10 [00:51<00:14,  7.21s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8927, 'compress@10': 0.3775, 'time@10': 9.2666}:  80%|████████  | 8/10 [00:57<00:14,  7.21s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8927, 'compress@10': 0.3775, 'time@10': 9.2666}:  90%|█████████ | 9/10 [00:57<00:07,  7.01s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.8972, 'compress@10': 0.3453, 'time@10': 9.2889}:  90%|█████████ | 9/10 [01:07<00:07,  7.01s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.8972, 'compress@10': 0.3453, 'time@10': 9.2889}: 100%|██████████| 10/10 [01:07<00:00,  7.79s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.8972, 'compress@10': 0.3453, 'time@10': 9.2889}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.028599503922643127
Avg hit ratio: 0.8903643223405533
Avg ndcg: 0.8971585266118589
Avg compression ratio: 0.3452605378525876
Avg train time: 9.288884687423707
Std train time: 2.6970286002910044
[0.53125, 0.03125000000000001, 0.09374999999999999, 0.46875, 0.90625, 0.59375, 0.09374999999999999, 0.34375, 0.03125000000000001, 0.03125000000000001]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0416, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8783, 'compress@10': 0.5559, 'time@10': 8.5466}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0416, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8783, 'compress@10': 0.5559, 'time@10': 8.5466}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8944, 'compress@10': 0.3092, 'time@10': 7.5795}:  10%|█         | 1/10 [00:10<00:38,  4.31s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8944, 'compress@10': 0.3092, 'time@10': 7.5795}:  20%|██        | 2/10 [00:10<00:45,  5.69s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.882, 'compress@10': 0.2805, 'time@10': 6.89}:  20%|██        | 2/10 [00:13<00:45,  5.69s/it]   {'epoch': 15, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.882, 'compress@10': 0.2805, 'time@10': 6.89}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8856, 'compress@10': 0.3323, 'time@10': 6.7445}:  30%|███       | 3/10 [00:20<00:30,  4.37s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8856, 'compress@10': 0.3323, 'time@10': 6.7445}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0297, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8726, 'compress@10': 0.4475, 'time@10': 8.191}:  40%|████      | 4/10 [00:27<00:30,  5.15s/it] {'epoch': 15, 'num_users': 5.8, 'loss': 0.0297, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8726, 'compress@10': 0.4475, 'time@10': 8.191}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0287, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8806, 'compress@10': 0.4734, 'time@10': 8.5761}:  50%|█████     | 5/10 [00:37<00:29,  5.82s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0287, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8806, 'compress@10': 0.4734, 'time@10': 8.5761}:  60%|██████    | 6/10 [00:37<00:29,  7.43s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0289, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8817, 'compress@10': 0.4243, 'time@10': 8.864}:  60%|██████    | 6/10 [00:43<00:29,  7.43s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0289, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8817, 'compress@10': 0.4243, 'time@10': 8.864}:  70%|███████   | 7/10 [00:43<00:20,  6.74s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0281, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.8856, 'compress@10': 0.4166, 'time@10': 8.7583}:  70%|███████   | 7/10 [00:51<00:20,  6.74s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0281, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.8856, 'compress@10': 0.4166, 'time@10': 8.7583}:  80%|████████  | 8/10 [00:51<00:14,  7.16s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0282, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8949, 'compress@10': 0.3769, 'time@10': 9.2108}:  80%|████████  | 8/10 [00:57<00:14,  7.16s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0282, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8949, 'compress@10': 0.3769, 'time@10': 9.2108}:  90%|█████████ | 9/10 [00:57<00:06,  6.94s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.901, 'compress@10': 0.3445, 'time@10': 9.2353}:  90%|█████████ | 9/10 [01:06<00:06,  6.94s/it]    {'epoch': 15, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.901, 'compress@10': 0.3445, 'time@10': 9.2353}: 100%|██████████| 10/10 [01:06<00:00,  7.73s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.901, 'compress@10': 0.3445, 'time@10': 9.2353}: 100%|██████████| 10/10 [01:06<00:00,  6.70s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.028062068383511572
Avg hit ratio: 0.8815201664963974
Avg ndcg: 0.9009618770143379
Avg compression ratio: 0.3444950342771412
Avg train time: 9.235278511047364
Std train time: 2.6490778441724045
[0.5588235294117647, 0.02941176470588236, 0.08823529411764705, 0.5, 0.9117647058823529, 0.5588235294117647, 0.08823529411764705, 0.3235294117647059, 0.02941176470588236, 0.02941176470588236]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0409, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8705, 'compress@10': 0.582, 'time@10': 8.9933}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0409, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8705, 'compress@10': 0.582, 'time@10': 8.9933}:  10%|█         | 1/10 [00:04<00:40,  4.54s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0326, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.892, 'compress@10': 0.3214, 'time@10': 7.8655}:  10%|█         | 1/10 [00:11<00:40,  4.54s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0326, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.892, 'compress@10': 0.3214, 'time@10': 7.8655}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8804, 'compress@10': 0.2871, 'time@10': 7.1365}:  20%|██        | 2/10 [00:14<00:46,  5.85s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8804, 'compress@10': 0.2871, 'time@10': 7.1365}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.884, 'compress@10': 0.3448, 'time@10': 6.9727}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]  {'epoch': 16, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.884, 'compress@10': 0.3448, 'time@10': 6.9727}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0283, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8735, 'compress@10': 0.4585, 'time@10': 8.3544}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0283, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8735, 'compress@10': 0.4585, 'time@10': 8.3544}:  50%|█████     | 5/10 [00:27<00:29,  5.90s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0279, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8804, 'compress@10': 0.4769, 'time@10': 8.7898}:  50%|█████     | 5/10 [00:38<00:29,  5.90s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0279, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8804, 'compress@10': 0.4769, 'time@10': 8.7898}:  60%|██████    | 6/10 [00:38<00:30,  7.65s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0275, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8856, 'compress@10': 0.4266, 'time@10': 9.0669}:  60%|██████    | 6/10 [00:44<00:30,  7.65s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0275, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8856, 'compress@10': 0.4266, 'time@10': 9.0669}:  70%|███████   | 7/10 [00:44<00:20,  6.91s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0268, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.8891, 'compress@10': 0.4161, 'time@10': 8.9387}:  70%|███████   | 7/10 [00:52<00:20,  6.91s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0268, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.8891, 'compress@10': 0.4161, 'time@10': 8.9387}:  80%|████████  | 8/10 [00:52<00:14,  7.29s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0278, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9098, 'compress@10': 0.3762, 'time@10': 9.38}:  80%|████████  | 8/10 [00:58<00:14,  7.29s/it]  {'epoch': 16, 'num_users': 6.3333, 'loss': 0.0278, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9098, 'compress@10': 0.3762, 'time@10': 9.38}:  90%|█████████ | 9/10 [00:58<00:07,  7.04s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9094, 'compress@10': 0.3437, 'time@10': 9.3957}:  90%|█████████ | 9/10 [01:08<00:07,  7.04s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9094, 'compress@10': 0.3437, 'time@10': 9.3957}: 100%|██████████| 10/10 [01:08<00:00,  7.82s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9094, 'compress@10': 0.3437, 'time@10': 9.3957}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.027733563127092593
Avg hit ratio: 0.8888722588484897
Avg ndcg: 0.90937652140723
Avg compression ratio: 0.3437482866314882
Avg train time: 9.395656657218932
Std train time: 2.6097345147849027
[0.5833333333333334, 0.027777777777777783, 0.08333333333333333, 0.4722222222222222, 0.9166666666666666, 0.5277777777777778, 0.08333333333333333, 0.3055555555555556, 0.08333333333333334, 0.027777777777777783]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8768, 'compress@10': 0.6053, 'time@10': 8.9442}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8768, 'compress@10': 0.6053, 'time@10': 8.9442}:  10%|█         | 1/10 [00:04<00:40,  4.51s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0278, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8995, 'compress@10': 0.3322, 'time@10': 7.8044}:  10%|█         | 1/10 [00:11<00:40,  4.51s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0278, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8995, 'compress@10': 0.3322, 'time@10': 7.8044}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8854, 'compress@10': 0.2929, 'time@10': 7.06}:  20%|██        | 2/10 [00:14<00:46,  5.80s/it]  {'epoch': 17, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8854, 'compress@10': 0.2929, 'time@10': 7.06}:  30%|███       | 3/10 [00:14<00:31,  4.44s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8891, 'compress@10': 0.3424, 'time@10': 6.8681}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8891, 'compress@10': 0.3424, 'time@10': 6.8681}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0252, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8812, 'compress@10': 0.4576, 'time@10': 8.2772}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0252, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8812, 'compress@10': 0.4576, 'time@10': 8.2772}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0265, 'hit_ratio@10': 0.885, 'ndcg@10': 0.888, 'compress@10': 0.4711, 'time@10': 8.666}:  50%|█████     | 5/10 [00:38<00:29,  5.89s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0265, 'hit_ratio@10': 0.885, 'ndcg@10': 0.888, 'compress@10': 0.4711, 'time@10': 8.666}:  60%|██████    | 6/10 [00:38<00:30,  7.50s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0277, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.8865, 'compress@10': 0.4209, 'time@10': 8.946}:  60%|██████    | 6/10 [00:43<00:30,  7.50s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0277, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.8865, 'compress@10': 0.4209, 'time@10': 8.946}:  70%|███████   | 7/10 [00:43<00:20,  6.80s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0268, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.8908, 'compress@10': 0.409, 'time@10': 8.861}:  70%|███████   | 7/10 [00:51<00:20,  6.80s/it]  {'epoch': 17, 'num_users': 6.125, 'loss': 0.0268, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.8908, 'compress@10': 0.409, 'time@10': 8.861}:  80%|████████  | 8/10 [00:51<00:14,  7.28s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0304, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9179, 'compress@10': 0.3757, 'time@10': 9.3525}:  80%|████████  | 8/10 [00:58<00:14,  7.28s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0304, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9179, 'compress@10': 0.3757, 'time@10': 9.3525}:  90%|█████████ | 9/10 [00:58<00:07,  7.09s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0279, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9223, 'compress@10': 0.3431, 'time@10': 9.365}:  90%|█████████ | 9/10 [01:08<00:07,  7.09s/it]    {'epoch': 17, 'num_users': 6.3, 'loss': 0.0279, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9223, 'compress@10': 0.3431, 'time@10': 9.365}: 100%|██████████| 10/10 [01:08<00:00,  7.84s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0279, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9223, 'compress@10': 0.3431, 'time@10': 9.365}: 100%|██████████| 10/10 [01:08<00:00,  6.80s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02794041994240461
Avg hit ratio: 0.9018497024575123
Avg ndcg: 0.9223332866310093
Avg compression ratio: 0.3431191139148209
Avg train time: 9.364984893798828
Std train time: 2.678055257405874
[0.5526315789473685, 0.026315789473684216, 0.07894736842105263, 0.4473684210526316, 0.9210526315789473, 0.5, 0.13157894736842105, 0.2894736842105263, 0.13157894736842107, 0.026315789473684216]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8798, 'compress@10': 0.5762, 'time@10': 8.5924}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8798, 'compress@10': 0.5762, 'time@10': 8.5924}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.904, 'compress@10': 0.317, 'time@10': 7.5386}:  10%|█         | 1/10 [00:10<00:38,  4.33s/it]  {'epoch': 18, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.904, 'compress@10': 0.317, 'time@10': 7.5386}:  20%|██        | 2/10 [00:10<00:44,  5.62s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8884, 'compress@10': 0.2815, 'time@10': 6.8428}:  20%|██        | 2/10 [00:13<00:44,  5.62s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8884, 'compress@10': 0.2815, 'time@10': 6.8428}:  30%|███       | 3/10 [00:13<00:30,  4.32s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8958, 'compress@10': 0.3279, 'time@10': 6.7199}:  30%|███       | 3/10 [00:20<00:30,  4.32s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8958, 'compress@10': 0.3279, 'time@10': 6.7199}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0237, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8868, 'compress@10': 0.4468, 'time@10': 8.2733}:  40%|████      | 4/10 [00:27<00:30,  5.14s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0237, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8868, 'compress@10': 0.4468, 'time@10': 8.2733}:  50%|█████     | 5/10 [00:27<00:29,  5.91s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0235, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8952, 'compress@10': 0.4575, 'time@10': 8.64}:  50%|█████     | 5/10 [00:37<00:29,  5.91s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0235, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8952, 'compress@10': 0.4575, 'time@10': 8.64}:  60%|██████    | 6/10 [00:37<00:29,  7.47s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0235, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.8962, 'compress@10': 0.4159, 'time@10': 8.9236}:  60%|██████    | 6/10 [00:43<00:29,  7.47s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0235, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.8962, 'compress@10': 0.4159, 'time@10': 8.9236}:  70%|███████   | 7/10 [00:43<00:20,  6.78s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0227, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9012, 'compress@10': 0.4027, 'time@10': 8.8307}:  70%|███████   | 7/10 [00:51<00:20,  6.78s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0227, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9012, 'compress@10': 0.4027, 'time@10': 8.8307}:  80%|████████  | 8/10 [00:51<00:14,  7.24s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.8989, 'compress@10': 0.3753, 'time@10': 9.3446}:  80%|████████  | 8/10 [00:58<00:14,  7.24s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.8989, 'compress@10': 0.3753, 'time@10': 9.3446}:  90%|█████████ | 9/10 [00:58<00:07,  7.09s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9048, 'compress@10': 0.3426, 'time@10': 9.3625}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9048, 'compress@10': 0.3426, 'time@10': 9.3625}: 100%|██████████| 10/10 [01:07<00:00,  7.85s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9048, 'compress@10': 0.3426, 'time@10': 9.3625}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.0276460772098096
Avg hit ratio: 0.8954211310289409
Avg ndcg: 0.9047959983245649
Avg compression ratio: 0.34262224207130265
Avg train time: 9.362484002113343
Std train time: 2.837404600637865
[0.525, 0.025000000000000005, 0.075, 0.425, 0.9249999999999999, 0.475, 0.125, 0.275, 0.17500000000000002, 0.07500000000000001]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8833, 'compress@10': 0.55, 'time@10': 8.6628}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8833, 'compress@10': 0.55, 'time@10': 8.6628}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.904, 'compress@10': 0.3032, 'time@10': 7.7152}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.904, 'compress@10': 0.3032, 'time@10': 7.7152}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8884, 'compress@10': 0.2712, 'time@10': 7.0499}:  20%|██        | 2/10 [00:14<00:46,  5.80s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8884, 'compress@10': 0.2712, 'time@10': 7.0499}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8956, 'compress@10': 0.3148, 'time@10': 6.9365}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8956, 'compress@10': 0.3148, 'time@10': 6.9365}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.8888, 'compress@10': 0.4371, 'time@10': 8.3231}:  40%|████      | 4/10 [00:27<00:31,  5.33s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.8888, 'compress@10': 0.4371, 'time@10': 8.3231}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0219, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.8981, 'compress@10': 0.4454, 'time@10': 8.7091}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0219, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.8981, 'compress@10': 0.4454, 'time@10': 8.7091}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0215, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9029, 'compress@10': 0.4046, 'time@10': 9.0075}:  60%|██████    | 6/10 [00:43<00:30,  7.54s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.0215, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9029, 'compress@10': 0.4046, 'time@10': 9.0075}:  70%|███████   | 7/10 [00:43<00:20,  6.85s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0211, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9037, 'compress@10': 0.391, 'time@10': 8.9056}:  70%|███████   | 7/10 [00:52<00:20,  6.85s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0211, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9037, 'compress@10': 0.391, 'time@10': 8.9056}:  80%|████████  | 8/10 [00:52<00:14,  7.29s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9093, 'compress@10': 0.3696, 'time@10': 9.4451}:  80%|████████  | 8/10 [00:58<00:14,  7.29s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9093, 'compress@10': 0.3696, 'time@10': 9.4451}:  90%|█████████ | 9/10 [00:58<00:07,  7.17s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.904, 'ndcg@10': 0.915, 'compress@10': 0.3423, 'time@10': 9.4426}:  90%|█████████ | 9/10 [01:08<00:07,  7.17s/it]     {'epoch': 19, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.904, 'ndcg@10': 0.915, 'compress@10': 0.3423, 'time@10': 9.4426}: 100%|██████████| 10/10 [01:08<00:00,  7.88s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.904, 'ndcg@10': 0.915, 'compress@10': 0.3423, 'time@10': 9.4426}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.02042210346032431
Avg hit ratio: 0.9039925596003693
Avg ndcg: 0.9150091267133977
Avg compression ratio: 0.3422620102270849
Avg train time: 9.44262762069702
Std train time: 2.6983471208845438
[0.5476190476190477, 0.023809523809523815, 0.07142857142857142, 0.4523809523809524, 0.9285714285714285, 0.4523809523809524, 0.11904761904761904, 0.2619047619047619, 0.16666666666666669, 0.07142857142857144]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8875, 'compress@10': 0.5714, 'time@10': 8.5519}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8875, 'compress@10': 0.5714, 'time@10': 8.5519}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9157, 'compress@10': 0.3134, 'time@10': 7.615}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it] {'epoch': 20, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9157, 'compress@10': 0.3134, 'time@10': 7.615}:  20%|██        | 2/10 [00:11<00:45,  5.73s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8962, 'compress@10': 0.2769, 'time@10': 6.9121}:  20%|██        | 2/10 [00:13<00:45,  5.73s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8962, 'compress@10': 0.2769, 'time@10': 6.9121}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9058, 'compress@10': 0.3257, 'time@10': 6.8203}:  30%|███       | 3/10 [00:20<00:30,  4.39s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9058, 'compress@10': 0.3257, 'time@10': 6.8203}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8976, 'compress@10': 0.4465, 'time@10': 8.1952}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8976, 'compress@10': 0.4465, 'time@10': 8.1952}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0221, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9095, 'compress@10': 0.4495, 'time@10': 8.6019}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0221, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9095, 'compress@10': 0.4495, 'time@10': 8.6019}:  60%|██████    | 6/10 [00:37<00:29,  7.49s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0233, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9079, 'compress@10': 0.4074, 'time@10': 8.9201}:  60%|██████    | 6/10 [00:43<00:29,  7.49s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0233, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9079, 'compress@10': 0.4074, 'time@10': 8.9201}:  70%|███████   | 7/10 [00:43<00:20,  6.82s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.9145, 'ndcg@10': 0.9112, 'compress@10': 0.3918, 'time@10': 8.829}:  70%|███████   | 7/10 [00:51<00:20,  6.82s/it]  {'epoch': 20, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.9145, 'ndcg@10': 0.9112, 'compress@10': 0.3918, 'time@10': 8.829}:  80%|████████  | 8/10 [00:51<00:14,  7.27s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9168, 'compress@10': 0.3695, 'time@10': 9.3868}:  80%|████████  | 8/10 [00:58<00:14,  7.27s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9168, 'compress@10': 0.3695, 'time@10': 9.3868}:  90%|█████████ | 9/10 [00:58<00:07,  7.17s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9229, 'compress@10': 0.3418, 'time@10': 9.3949}:  90%|█████████ | 9/10 [01:08<00:07,  7.17s/it]    {'epoch': 20, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9229, 'compress@10': 0.3418, 'time@10': 9.3949}: 100%|██████████| 10/10 [01:08<00:00,  7.89s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9229, 'compress@10': 0.3418, 'time@10': 9.3949}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.023027902816560374
Avg hit ratio: 0.9007667531487564
Avg ndcg: 0.9228563774436795
Avg compression ratio: 0.3417623127077608
Avg train time: 9.394912433624267
Std train time: 2.7334612496265667
[0.5227272727272728, 0.02272727272727273, 0.06818181818181818, 0.4318181818181818, 0.9318181818181818, 0.4772727272727273, 0.1590909090909091, 0.25, 0.15909090909090912, 0.06818181818181819]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.89, 'compress@10': 0.5478, 'time@10': 8.4711}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.89, 'compress@10': 0.5478, 'time@10': 8.4711}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9211, 'compress@10': 0.3011, 'time@10': 7.5211}:  10%|█         | 1/10 [00:10<00:38,  4.28s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9211, 'compress@10': 0.3011, 'time@10': 7.5211}:  20%|██        | 2/10 [00:10<00:45,  5.65s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8998, 'compress@10': 0.2678, 'time@10': 6.8655}:  20%|██        | 2/10 [00:13<00:45,  5.65s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8998, 'compress@10': 0.2678, 'time@10': 6.8655}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.909, 'compress@10': 0.3139, 'time@10': 6.748}:  30%|███       | 3/10 [00:20<00:30,  4.35s/it]  {'epoch': 21, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.909, 'compress@10': 0.3139, 'time@10': 6.748}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0188, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.902, 'compress@10': 0.4377, 'time@10': 8.2165}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0188, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.902, 'compress@10': 0.4377, 'time@10': 8.2165}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9105, 'compress@10': 0.4463, 'time@10': 8.6357}:  50%|█████     | 5/10 [00:37<00:29,  5.86s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9105, 'compress@10': 0.4463, 'time@10': 8.6357}:  60%|██████    | 6/10 [00:37<00:30,  7.53s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0184, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9114, 'compress@10': 0.41, 'time@10': 8.9891}:  60%|██████    | 6/10 [00:43<00:30,  7.53s/it]   {'epoch': 21, 'num_users': 6.2857, 'loss': 0.0184, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9114, 'compress@10': 0.41, 'time@10': 8.9891}:  70%|███████   | 7/10 [00:43<00:20,  6.90s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9136, 'compress@10': 0.3927, 'time@10': 8.9071}:  70%|███████   | 7/10 [00:51<00:20,  6.90s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9136, 'compress@10': 0.3927, 'time@10': 8.9071}:  80%|████████  | 8/10 [00:51<00:14,  7.37s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9177, 'compress@10': 0.3694, 'time@10': 9.4686}:  80%|████████  | 8/10 [00:58<00:14,  7.37s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9177, 'compress@10': 0.3694, 'time@10': 9.4686}:  90%|█████████ | 9/10 [00:58<00:07,  7.26s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.9068, 'ndcg@10': 0.9228, 'compress@10': 0.3414, 'time@10': 9.4873}:  90%|█████████ | 9/10 [01:08<00:07,  7.26s/it]  {'epoch': 21, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.9068, 'ndcg@10': 0.9228, 'compress@10': 0.3414, 'time@10': 9.4873}: 100%|██████████| 10/10 [01:08<00:00,  8.01s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.9068, 'ndcg@10': 0.9228, 'compress@10': 0.3414, 'time@10': 9.4873}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.018420381610099176
Avg hit ratio: 0.9068497024575123
Avg ndcg: 0.9228023273444659
Avg compression ratio: 0.3414244688629733
Avg train time: 9.487256741523742
Std train time: 2.8514432639076457
[0.5434782608695653, 0.02173913043478261, 0.06521739130434782, 0.4565217391304348, 0.9347826086956521, 0.4565217391304348, 0.15217391304347827, 0.2391304347826087, 0.1521739130434783, 0.06521739130434784]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8896, 'compress@10': 0.5675, 'time@10': 8.6568}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8896, 'compress@10': 0.5675, 'time@10': 8.6568}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9176, 'compress@10': 0.3104, 'time@10': 7.6459}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9176, 'compress@10': 0.3104, 'time@10': 7.6459}:  20%|██        | 2/10 [00:11<00:45,  5.72s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8975, 'compress@10': 0.2732, 'time@10': 6.9086}:  20%|██        | 2/10 [00:13<00:45,  5.72s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8975, 'compress@10': 0.2732, 'time@10': 6.9086}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9098, 'compress@10': 0.3239, 'time@10': 6.7772}:  30%|███       | 3/10 [00:20<00:30,  4.37s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9098, 'compress@10': 0.3239, 'time@10': 6.7772}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0186, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9044, 'compress@10': 0.4463, 'time@10': 8.2056}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0186, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9044, 'compress@10': 0.4463, 'time@10': 8.2056}:  50%|█████     | 5/10 [00:27<00:29,  5.83s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9134, 'compress@10': 0.45, 'time@10': 8.6253}:  50%|█████     | 5/10 [00:37<00:29,  5.83s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9134, 'compress@10': 0.45, 'time@10': 8.6253}:  60%|██████    | 6/10 [00:37<00:30,  7.51s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0175, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9167, 'compress@10': 0.4123, 'time@10': 8.9725}:  60%|██████    | 6/10 [00:43<00:30,  7.51s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0175, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9167, 'compress@10': 0.4123, 'time@10': 8.9725}:  70%|███████   | 7/10 [00:43<00:20,  6.88s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9176, 'compress@10': 0.3934, 'time@10': 8.8998}:  70%|███████   | 7/10 [00:51<00:20,  6.88s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9176, 'compress@10': 0.3934, 'time@10': 8.8998}:  80%|████████  | 8/10 [00:51<00:14,  7.37s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9218, 'compress@10': 0.3693, 'time@10': 9.413}:  80%|████████  | 8/10 [00:58<00:14,  7.37s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9218, 'compress@10': 0.3693, 'time@10': 9.413}:  90%|█████████ | 9/10 [00:58<00:07,  7.19s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.904, 'ndcg@10': 0.9282, 'compress@10': 0.341, 'time@10': 9.416}:  90%|█████████ | 9/10 [01:08<00:07,  7.19s/it]     {'epoch': 22, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.904, 'ndcg@10': 0.9282, 'compress@10': 0.341, 'time@10': 9.416}: 100%|██████████| 10/10 [01:08<00:00,  7.90s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.904, 'ndcg@10': 0.9282, 'compress@10': 0.341, 'time@10': 9.416}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.016703842326281096
Avg hit ratio: 0.9039925596003693
Avg ndcg: 0.9281540264821475
Avg compression ratio: 0.34100237711855086
Avg train time: 9.415986371040344
Std train time: 2.7554240336061
[0.5625000000000001, 0.020833333333333336, 0.0625, 0.4791666666666667, 0.9374999999999999, 0.4375, 0.14583333333333334, 0.22916666666666669, 0.14583333333333337, 0.06250000000000001]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0217, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8962, 'compress@10': 0.5855, 'time@10': 8.7691}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0217, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8962, 'compress@10': 0.5855, 'time@10': 8.7691}:  10%|█         | 1/10 [00:04<00:39,  4.42s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9365, 'compress@10': 0.319, 'time@10': 7.7159}:  10%|█         | 1/10 [00:11<00:39,  4.42s/it] {'epoch': 23, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9365, 'compress@10': 0.319, 'time@10': 7.7159}:  20%|██        | 2/10 [00:11<00:46,  5.76s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9101, 'compress@10': 0.2781, 'time@10': 6.9732}:  20%|██        | 2/10 [00:13<00:46,  5.76s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9101, 'compress@10': 0.2781, 'time@10': 6.9732}:  30%|███       | 3/10 [00:13<00:30,  4.40s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9194, 'compress@10': 0.333, 'time@10': 6.8491}:  30%|███       | 3/10 [00:20<00:30,  4.40s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9194, 'compress@10': 0.333, 'time@10': 6.8491}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0173, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9127, 'compress@10': 0.4542, 'time@10': 8.2303}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0173, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9127, 'compress@10': 0.4542, 'time@10': 8.2303}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0198, 'hit_ratio@10': 0.879, 'ndcg@10': 0.924, 'compress@10': 0.4535, 'time@10': 8.63}:  50%|█████     | 5/10 [00:38<00:29,  5.84s/it] {'epoch': 23, 'num_users': 6.1667, 'loss': 0.0198, 'hit_ratio@10': 0.879, 'ndcg@10': 0.924, 'compress@10': 0.4535, 'time@10': 8.63}:  60%|██████    | 6/10 [00:38<00:29,  7.48s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0214, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9258, 'compress@10': 0.4144, 'time@10': 8.9622}:  60%|██████    | 6/10 [00:43<00:29,  7.48s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0214, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9258, 'compress@10': 0.4144, 'time@10': 8.9622}:  70%|███████   | 7/10 [00:43<00:20,  6.84s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.02, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9288, 'compress@10': 0.394, 'time@10': 8.8522}:  70%|███████   | 7/10 [00:51<00:20,  6.84s/it]    {'epoch': 23, 'num_users': 6.125, 'loss': 0.02, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9288, 'compress@10': 0.394, 'time@10': 8.8522}:  80%|████████  | 8/10 [00:51<00:14,  7.25s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9328, 'compress@10': 0.3692, 'time@10': 9.3918}:  80%|████████  | 8/10 [00:58<00:14,  7.25s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9328, 'compress@10': 0.3692, 'time@10': 9.3918}:  90%|█████████ | 9/10 [00:58<00:07,  7.14s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9329, 'compress@10': 0.3406, 'time@10': 9.4075}:  90%|█████████ | 9/10 [01:08<00:07,  7.14s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9329, 'compress@10': 0.3406, 'time@10': 9.4075}: 100%|██████████| 10/10 [01:08<00:00,  7.89s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9329, 'compress@10': 0.3406, 'time@10': 9.4075}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.019727354246596832
Avg hit ratio: 0.8954211310289409
Avg ndcg: 0.9329481552377233
Avg compression ratio: 0.3406159939541834
Avg train time: 9.407529020309449
Std train time: 2.7378547958635693
[0.5400000000000001, 0.020000000000000004, 0.06, 0.46, 0.94, 0.46, 0.18, 0.22000000000000003, 0.14000000000000004, 0.06000000000000001]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9042, 'compress@10': 0.5642, 'time@10': 8.4537}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9042, 'compress@10': 0.5642, 'time@10': 8.4537}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9341, 'compress@10': 0.3079, 'time@10': 7.6011}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9341, 'compress@10': 0.3079, 'time@10': 7.6011}:  20%|██        | 2/10 [00:11<00:45,  5.75s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9084, 'compress@10': 0.27, 'time@10': 6.8979}:  20%|██        | 2/10 [00:13<00:45,  5.75s/it]  {'epoch': 24, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9084, 'compress@10': 0.27, 'time@10': 6.8979}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9182, 'compress@10': 0.3224, 'time@10': 6.7747}:  30%|███       | 3/10 [00:20<00:30,  4.39s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9182, 'compress@10': 0.3224, 'time@10': 6.7747}:  40%|████      | 4/10 [00:20<00:31,  5.20s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0144, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9135, 'compress@10': 0.4461, 'time@10': 8.294}:  40%|████      | 4/10 [00:27<00:31,  5.20s/it] {'epoch': 24, 'num_users': 5.8, 'loss': 0.0144, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9135, 'compress@10': 0.4461, 'time@10': 8.294}:  50%|█████     | 5/10 [00:27<00:29,  5.93s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9214, 'compress@10': 0.4504, 'time@10': 8.7209}:  50%|█████     | 5/10 [00:38<00:29,  5.93s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9214, 'compress@10': 0.4504, 'time@10': 8.7209}:  60%|██████    | 6/10 [00:38<00:30,  7.62s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9218, 'compress@10': 0.4165, 'time@10': 9.0589}:  60%|██████    | 6/10 [00:43<00:30,  7.62s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9218, 'compress@10': 0.4165, 'time@10': 9.0589}:  70%|███████   | 7/10 [00:43<00:20,  6.95s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0145, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9234, 'compress@10': 0.3947, 'time@10': 8.9416}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0145, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9234, 'compress@10': 0.3947, 'time@10': 8.9416}:  80%|████████  | 8/10 [00:52<00:14,  7.34s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9269, 'compress@10': 0.3691, 'time@10': 9.4433}:  80%|████████  | 8/10 [00:58<00:14,  7.34s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9269, 'compress@10': 0.3691, 'time@10': 9.4433}:  90%|█████████ | 9/10 [00:58<00:07,  7.16s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9318, 'compress@10': 0.3404, 'time@10': 9.4841}:  90%|█████████ | 9/10 [01:08<00:07,  7.16s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9318, 'compress@10': 0.3404, 'time@10': 9.4841}: 100%|██████████| 10/10 [01:08<00:00,  8.00s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9318, 'compress@10': 0.3404, 'time@10': 9.4841}: 100%|██████████| 10/10 [01:08<00:00,  6.88s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.014352151611077979
Avg hit ratio: 0.90425881664082
Avg ndcg: 0.9317906206381817
Avg compression ratio: 0.3403632118929433
Avg train time: 9.484102988243103
Std train time: 2.8297140626138675
[0.5576923076923078, 0.019230769230769235, 0.05769230769230769, 0.44230769230769235, 0.9423076923076923, 0.44230769230769235, 0.17307692307692307, 0.21153846153846156, 0.17307692307692313, 0.0576923076923077]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9102, 'compress@10': 0.581, 'time@10': 8.8865}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9102, 'compress@10': 0.581, 'time@10': 8.8865}:  10%|█         | 1/10 [00:04<00:40,  4.48s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9368, 'compress@10': 0.3159, 'time@10': 7.7893}:  10%|█         | 1/10 [00:11<00:40,  4.48s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9368, 'compress@10': 0.3159, 'time@10': 7.7893}:  20%|██        | 2/10 [00:11<00:46,  5.81s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9103, 'compress@10': 0.2747, 'time@10': 7.065}:  20%|██        | 2/10 [00:14<00:46,  5.81s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9103, 'compress@10': 0.2747, 'time@10': 7.065}:  30%|███       | 3/10 [00:14<00:31,  4.45s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9202, 'compress@10': 0.3216, 'time@10': 6.9089}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9202, 'compress@10': 0.3216, 'time@10': 6.9089}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.9164, 'compress@10': 0.446, 'time@10': 8.3048}:  40%|████      | 4/10 [00:27<00:31,  5.25s/it] {'epoch': 25, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.9164, 'compress@10': 0.446, 'time@10': 8.3048}:  50%|█████     | 5/10 [00:27<00:29,  5.88s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0152, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9244, 'compress@10': 0.4474, 'time@10': 8.7082}:  50%|█████     | 5/10 [00:38<00:29,  5.88s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0152, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9244, 'compress@10': 0.4474, 'time@10': 8.7082}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0148, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9278, 'compress@10': 0.413, 'time@10': 9.0959}:  60%|██████    | 6/10 [00:44<00:30,  7.54s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.0148, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9278, 'compress@10': 0.413, 'time@10': 9.0959}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9298, 'compress@10': 0.3906, 'time@10': 8.9981}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9298, 'compress@10': 0.3906, 'time@10': 8.9981}:  80%|████████  | 8/10 [00:52<00:14,  7.40s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9365, 'compress@10': 0.3691, 'time@10': 9.5312}:  80%|████████  | 8/10 [00:59<00:14,  7.40s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9365, 'compress@10': 0.3691, 'time@10': 9.5312}:  90%|█████████ | 9/10 [00:59<00:07,  7.25s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9435, 'compress@10': 0.3401, 'time@10': 9.5481}:  90%|█████████ | 9/10 [01:09<00:07,  7.25s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9435, 'compress@10': 0.3401, 'time@10': 9.5481}: 100%|██████████| 10/10 [01:09<00:00,  8.02s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9435, 'compress@10': 0.3401, 'time@10': 9.5481}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.017426993856040497
Avg hit ratio: 0.8811354167432265
Avg ndcg: 0.9434690002381887
Avg compression ratio: 0.34005883984088314
Avg train time: 9.54813301563263
Std train time: 2.775525282673082
[0.5370370370370372, 0.018518518518518524, 0.05555555555555555, 0.425925925925926, 0.9444444444444444, 0.425925925925926, 0.16666666666666666, 0.20370370370370372, 0.20370370370370375, 0.0925925925925926]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9119, 'compress@10': 0.5614, 'time@10': 8.6765}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9119, 'compress@10': 0.5614, 'time@10': 8.6765}:  10%|█         | 1/10 [00:04<00:39,  4.40s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9488, 'compress@10': 0.3058, 'time@10': 7.7177}:  10%|█         | 1/10 [00:11<00:39,  4.40s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9488, 'compress@10': 0.3058, 'time@10': 7.7177}:  20%|██        | 2/10 [00:11<00:46,  5.81s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9182, 'compress@10': 0.2674, 'time@10': 7.095}:  20%|██        | 2/10 [00:14<00:46,  5.81s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9182, 'compress@10': 0.2674, 'time@10': 7.095}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9256, 'compress@10': 0.3121, 'time@10': 6.9465}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9256, 'compress@10': 0.3121, 'time@10': 6.9465}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.9214, 'compress@10': 0.4388, 'time@10': 8.3707}:  40%|████      | 4/10 [00:27<00:31,  5.31s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.9214, 'compress@10': 0.4388, 'time@10': 8.3707}:  50%|█████     | 5/10 [00:27<00:29,  5.95s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.936, 'compress@10': 0.4388, 'time@10': 8.7418}:  50%|█████     | 5/10 [00:38<00:29,  5.95s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.936, 'compress@10': 0.4388, 'time@10': 8.7418}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.019, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9365, 'compress@10': 0.4047, 'time@10': 9.1051}:  60%|██████    | 6/10 [00:44<00:30,  7.54s/it] {'epoch': 26, 'num_users': 6.2857, 'loss': 0.019, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9365, 'compress@10': 0.4047, 'time@10': 9.1051}:  70%|███████   | 7/10 [00:44<00:20,  6.93s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.018, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9392, 'compress@10': 0.3824, 'time@10': 8.9686}:  70%|███████   | 7/10 [00:52<00:20,  6.93s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.018, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9392, 'compress@10': 0.3824, 'time@10': 8.9686}:  80%|████████  | 8/10 [00:52<00:14,  7.29s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9617, 'compress@10': 0.3651, 'time@10': 9.5274}:  80%|████████  | 8/10 [00:59<00:14,  7.29s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9617, 'compress@10': 0.3651, 'time@10': 9.5274}:  90%|█████████ | 9/10 [00:59<00:07,  7.21s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9627, 'compress@10': 0.3399, 'time@10': 9.5544}:  90%|█████████ | 9/10 [01:09<00:07,  7.21s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9627, 'compress@10': 0.3399, 'time@10': 9.5544}: 100%|██████████| 10/10 [01:09<00:00,  8.02s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9627, 'compress@10': 0.3399, 'time@10': 9.5544}: 100%|██████████| 10/10 [01:09<00:00,  6.90s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.02130427270297248
Avg hit ratio: 0.8774211310289409
Avg ndcg: 0.9626993857773227
Avg compression ratio: 0.3398890018180888
Avg train time: 9.554438424110412
Std train time: 2.797476241763132
[0.517857142857143, 0.017857142857142863, 0.05357142857142857, 0.41071428571428575, 0.9107142857142857, 0.4464285714285715, 0.1607142857142857, 0.19642857142857145, 0.23214285714285718, 0.125]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9119, 'compress@10': 0.5432, 'time@10': 9.6512}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9119, 'compress@10': 0.5432, 'time@10': 9.6512}:  10%|█         | 1/10 [00:04<00:43,  4.88s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9386, 'compress@10': 0.2964, 'time@10': 8.2268}:  10%|█         | 1/10 [00:11<00:43,  4.88s/it] {'epoch': 27, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9386, 'compress@10': 0.2964, 'time@10': 8.2268}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9115, 'compress@10': 0.2605, 'time@10': 7.2976}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9115, 'compress@10': 0.2605, 'time@10': 7.2976}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9209, 'compress@10': 0.3033, 'time@10': 7.1108}:  30%|███       | 3/10 [00:21<00:31,  4.54s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9209, 'compress@10': 0.3033, 'time@10': 7.1108}:  40%|████      | 4/10 [00:21<00:32,  5.35s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.9186, 'compress@10': 0.4252, 'time@10': 8.4739}:  40%|████      | 4/10 [00:28<00:32,  5.35s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.9186, 'compress@10': 0.4252, 'time@10': 8.4739}:  50%|█████     | 5/10 [00:28<00:29,  5.94s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9273, 'compress@10': 0.4308, 'time@10': 8.8632}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9273, 'compress@10': 0.4308, 'time@10': 8.8632}:  60%|██████    | 6/10 [00:38<00:30,  7.61s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9284, 'compress@10': 0.397, 'time@10': 9.2224}:  60%|██████    | 6/10 [00:44<00:30,  7.61s/it] {'epoch': 27, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9284, 'compress@10': 0.397, 'time@10': 9.2224}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.876, 'ndcg@10': 0.933, 'compress@10': 0.3748, 'time@10': 9.1119}:  70%|███████   | 7/10 [00:53<00:20,  6.99s/it]   {'epoch': 27, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.876, 'ndcg@10': 0.933, 'compress@10': 0.3748, 'time@10': 9.1119}:  80%|████████  | 8/10 [00:53<00:14,  7.44s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9333, 'compress@10': 0.3614, 'time@10': 9.6765}:  80%|████████  | 8/10 [01:00<00:14,  7.44s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9333, 'compress@10': 0.3614, 'time@10': 9.6765}:  90%|█████████ | 9/10 [01:00<00:07,  7.34s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9374, 'compress@10': 0.3397, 'time@10': 9.7015}:  90%|█████████ | 9/10 [01:10<00:07,  7.34s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9374, 'compress@10': 0.3397, 'time@10': 9.7015}: 100%|██████████| 10/10 [01:10<00:00,  8.15s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9374, 'compress@10': 0.3397, 'time@10': 9.7015}: 100%|██████████| 10/10 [01:10<00:00,  7.01s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.015900692117990865
Avg hit ratio: 0.8728302452122486
Avg ndcg: 0.9373716627856993
Avg compression ratio: 0.3397199486688637
Avg train time: 9.701525688171387
Std train time: 2.8368009004998345
[0.5344827586206898, 0.017241379310344834, 0.05172413793103448, 0.39655172413793105, 0.9137931034482758, 0.4310344827586208, 0.15517241379310343, 0.18965517241379312, 0.25862068965517243, 0.1206896551724138]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.559, 'time@10': 8.6679}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.559, 'time@10': 8.6679}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9438, 'compress@10': 0.304, 'time@10': 7.7628}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it]  {'epoch': 28, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9438, 'compress@10': 0.304, 'time@10': 7.7628}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9149, 'compress@10': 0.265, 'time@10': 7.1625}:  20%|██        | 2/10 [00:14<00:46,  5.86s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9149, 'compress@10': 0.265, 'time@10': 7.1625}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9238, 'compress@10': 0.3033, 'time@10': 6.9969}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9238, 'compress@10': 0.3033, 'time@10': 6.9969}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9226, 'compress@10': 0.4257, 'time@10': 8.4117}:  40%|████      | 4/10 [00:27<00:32,  5.34s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9226, 'compress@10': 0.4257, 'time@10': 8.4117}:  50%|█████     | 5/10 [00:27<00:29,  5.97s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9299, 'compress@10': 0.4287, 'time@10': 8.7991}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9299, 'compress@10': 0.4287, 'time@10': 8.7991}:  60%|██████    | 6/10 [00:38<00:30,  7.61s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9326, 'compress@10': 0.3945, 'time@10': 9.1673}:  60%|██████    | 6/10 [00:44<00:30,  7.61s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9326, 'compress@10': 0.3945, 'time@10': 9.1673}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9321, 'compress@10': 0.3718, 'time@10': 9.0283}:  70%|███████   | 7/10 [00:52<00:20,  6.99s/it]   {'epoch': 28, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9321, 'compress@10': 0.3718, 'time@10': 9.0283}:  80%|████████  | 8/10 [00:52<00:14,  7.34s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.94, 'compress@10': 0.3616, 'time@10': 9.6235}:  80%|████████  | 8/10 [00:59<00:14,  7.34s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.94, 'compress@10': 0.3616, 'time@10': 9.6235}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9427, 'compress@10': 0.3395, 'time@10': 9.6372}:  90%|█████████ | 9/10 [01:09<00:07,  7.31s/it] {'epoch': 28, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9427, 'compress@10': 0.3395, 'time@10': 9.6372}: 100%|██████████| 10/10 [01:09<00:00,  8.08s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9427, 'compress@10': 0.3395, 'time@10': 9.6372}: 100%|██████████| 10/10 [01:09<00:00,  6.95s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.015830585896276214
Avg hit ratio: 0.8918906381300269
Avg ndcg: 0.9426903462577817
Avg compression ratio: 0.33946970326445314
Avg train time: 9.637204313278199
Std train time: 2.845565106515259
[0.5166666666666668, 0.016666666666666673, 0.05, 0.4166666666666667, 0.9166666666666666, 0.41666666666666674, 0.14999999999999997, 0.18333333333333335, 0.2833333333333333, 0.11666666666666667]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.5421, 'time@10': 8.6718}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.5421, 'time@10': 8.6718}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9782, 'compress@10': 0.2953, 'time@10': 7.6476}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9782, 'compress@10': 0.2953, 'time@10': 7.6476}:  20%|██        | 2/10 [00:11<00:45,  5.72s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9378, 'compress@10': 0.2587, 'time@10': 7.0289}:  20%|██        | 2/10 [00:13<00:45,  5.72s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9378, 'compress@10': 0.2587, 'time@10': 7.0289}:  30%|███       | 3/10 [00:13<00:31,  4.45s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9407, 'compress@10': 0.3034, 'time@10': 6.866}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9407, 'compress@10': 0.3034, 'time@10': 6.866}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.015, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9378, 'compress@10': 0.4264, 'time@10': 8.2487}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.015, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9378, 'compress@10': 0.4264, 'time@10': 8.2487}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0177, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9524, 'compress@10': 0.4269, 'time@10': 8.6782}:  50%|█████     | 5/10 [00:38<00:29,  5.84s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0177, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9524, 'compress@10': 0.4269, 'time@10': 8.6782}:  60%|██████    | 6/10 [00:38<00:30,  7.55s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9512, 'compress@10': 0.3922, 'time@10': 9.0296}:  60%|██████    | 6/10 [00:43<00:30,  7.55s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9512, 'compress@10': 0.3922, 'time@10': 9.0296}:  70%|███████   | 7/10 [00:43<00:20,  6.91s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.017, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9521, 'compress@10': 0.369, 'time@10': 8.9326}:  70%|███████   | 7/10 [00:52<00:20,  6.91s/it]   {'epoch': 29, 'num_users': 6.125, 'loss': 0.017, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9521, 'compress@10': 0.369, 'time@10': 8.9326}:  80%|████████  | 8/10 [00:52<00:14,  7.35s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9622, 'compress@10': 0.3618, 'time@10': 9.5584}:  80%|████████  | 8/10 [00:59<00:14,  7.35s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9622, 'compress@10': 0.3618, 'time@10': 9.5584}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9666, 'compress@10': 0.3393, 'time@10': 9.5802}:  90%|█████████ | 9/10 [01:09<00:07,  7.34s/it]  {'epoch': 29, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9666, 'compress@10': 0.3393, 'time@10': 9.5802}: 100%|██████████| 10/10 [01:09<00:00,  8.10s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9666, 'compress@10': 0.3393, 'time@10': 9.5802}: 100%|██████████| 10/10 [01:09<00:00,  6.92s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.019485606098142177
Avg hit ratio: 0.9043156253292077
Avg ndcg: 0.9666168167868825
Avg compression ratio: 0.3392909239443577
Avg train time: 9.58019711971283
Std train time: 2.871113837263088
[0.5000000000000001, 0.016129032258064523, 0.048387096774193554, 0.40322580645161293, 0.8870967741935484, 0.435483870967742, 0.1451612903225806, 0.1774193548387097, 0.3064516129032258, 0.14516129032258066]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.5263, 'time@10': 8.9109}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.5263, 'time@10': 8.9109}:  10%|█         | 1/10 [00:04<00:40,  4.50s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9407, 'compress@10': 0.2871, 'time@10': 7.985}:  10%|█         | 1/10 [00:11<00:40,  4.50s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9407, 'compress@10': 0.2871, 'time@10': 7.985}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9128, 'compress@10': 0.2528, 'time@10': 7.259}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9128, 'compress@10': 0.2528, 'time@10': 7.259}:  30%|███       | 3/10 [00:14<00:32,  4.62s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9243, 'compress@10': 0.2958, 'time@10': 7.1012}:  30%|███       | 3/10 [00:21<00:32,  4.62s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9243, 'compress@10': 0.2958, 'time@10': 7.1012}:  40%|████      | 4/10 [00:21<00:32,  5.43s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9248, 'compress@10': 0.4145, 'time@10': 8.5399}:  40%|████      | 4/10 [00:28<00:32,  5.43s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9248, 'compress@10': 0.4145, 'time@10': 8.5399}:  50%|█████     | 5/10 [00:28<00:30,  6.06s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.933, 'compress@10': 0.4201, 'time@10': 8.9135}:  50%|█████     | 5/10 [00:39<00:30,  6.06s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.933, 'compress@10': 0.4201, 'time@10': 8.9135}:  60%|██████    | 6/10 [00:39<00:30,  7.68s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9323, 'compress@10': 0.3857, 'time@10': 9.2646}:  60%|██████    | 6/10 [00:44<00:30,  7.68s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9323, 'compress@10': 0.3857, 'time@10': 9.2646}:  70%|███████   | 7/10 [00:44<00:21,  7.04s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9365, 'compress@10': 0.3626, 'time@10': 9.1165}:  70%|███████   | 7/10 [00:53<00:21,  7.04s/it]  {'epoch': 30, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9365, 'compress@10': 0.3626, 'time@10': 9.1165}:  80%|████████  | 8/10 [00:53<00:14,  7.38s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9378, 'compress@10': 0.3586, 'time@10': 9.7191}:  80%|████████  | 8/10 [01:00<00:14,  7.38s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9378, 'compress@10': 0.3586, 'time@10': 9.7191}:  90%|█████████ | 9/10 [01:00<00:07,  7.36s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9416, 'compress@10': 0.3392, 'time@10': 9.7399}:  90%|█████████ | 9/10 [01:10<00:07,  7.36s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9416, 'compress@10': 0.3392, 'time@10': 9.7399}: 100%|██████████| 10/10 [01:10<00:00,  8.17s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9416, 'compress@10': 0.3392, 'time@10': 9.7399}: 100%|██████████| 10/10 [01:10<00:00,  7.04s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.01186139197142164
Avg hit ratio: 0.9028307302959255
Avg ndcg: 0.9415649843409668
Avg compression ratio: 0.339162303263394
Avg train time: 9.739893436431885
Std train time: 2.8869373610298164
[0.4843750000000001, 0.015625000000000007, 0.04687500000000001, 0.39062500000000006, 0.890625, 0.42187500000000006, 0.17187499999999994, 0.171875, 0.328125, 0.140625]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.5115, 'time@10': 8.5468}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.5115, 'time@10': 8.5468}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9412, 'compress@10': 0.2794, 'time@10': 7.6949}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it] {'epoch': 31, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9412, 'compress@10': 0.2794, 'time@10': 7.6949}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9132, 'compress@10': 0.2473, 'time@10': 6.988}:  20%|██        | 2/10 [00:14<00:46,  5.83s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9132, 'compress@10': 0.2473, 'time@10': 6.988}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9245, 'compress@10': 0.2886, 'time@10': 6.9033}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9245, 'compress@10': 0.2886, 'time@10': 6.9033}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9261, 'compress@10': 0.4094, 'time@10': 8.3633}:  40%|████      | 4/10 [00:27<00:32,  5.34s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9261, 'compress@10': 0.4094, 'time@10': 8.3633}:  50%|█████     | 5/10 [00:27<00:29,  5.99s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9344, 'compress@10': 0.4136, 'time@10': 8.7297}:  50%|█████     | 5/10 [00:38<00:29,  5.99s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9344, 'compress@10': 0.4136, 'time@10': 8.7297}:  60%|██████    | 6/10 [00:38<00:30,  7.56s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9367, 'compress@10': 0.3838, 'time@10': 9.1299}:  60%|██████    | 6/10 [00:44<00:30,  7.56s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9367, 'compress@10': 0.3838, 'time@10': 9.1299}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9391, 'compress@10': 0.3603, 'time@10': 9.016}:  70%|███████   | 7/10 [00:52<00:20,  6.99s/it]  {'epoch': 31, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9391, 'compress@10': 0.3603, 'time@10': 9.016}:  80%|████████  | 8/10 [00:52<00:14,  7.39s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9462, 'compress@10': 0.3589, 'time@10': 9.6116}:  80%|████████  | 8/10 [00:59<00:14,  7.39s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9462, 'compress@10': 0.3589, 'time@10': 9.6116}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9487, 'compress@10': 0.339, 'time@10': 9.6226}:  90%|█████████ | 9/10 [01:09<00:07,  7.34s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9487, 'compress@10': 0.339, 'time@10': 9.6226}: 100%|██████████| 10/10 [01:09<00:00,  8.09s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9487, 'compress@10': 0.339, 'time@10': 9.6226}: 100%|██████████| 10/10 [01:09<00:00,  6.95s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.011926214201542138
Avg hit ratio: 0.9081763524157411
Avg ndcg: 0.9486602123865108
Avg compression ratio: 0.3389865504650384
Avg train time: 9.622574806213379
Std train time: 2.901738359622261
[0.4696969696969698, 0.015151515151515159, 0.04545454545454546, 0.40909090909090917, 0.8939393939393939, 0.40909090909090917, 0.1666666666666666, 0.16666666666666666, 0.3484848484848485, 0.13636363636363635]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.4976, 'time@10': 8.3753}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.4976, 'time@10': 8.3753}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9589, 'compress@10': 0.2723, 'time@10': 7.5859}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it] {'epoch': 32, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9589, 'compress@10': 0.2723, 'time@10': 7.5859}:  20%|██        | 2/10 [00:11<00:46,  5.76s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.925, 'compress@10': 0.2421, 'time@10': 7.0125}:  20%|██        | 2/10 [00:14<00:46,  5.76s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.925, 'compress@10': 0.2421, 'time@10': 7.0125}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9311, 'compress@10': 0.2891, 'time@10': 6.8615}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9311, 'compress@10': 0.2891, 'time@10': 6.8615}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9318, 'compress@10': 0.4105, 'time@10': 8.3445}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9318, 'compress@10': 0.4105, 'time@10': 8.3445}:  50%|█████     | 5/10 [00:27<00:29,  5.95s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9476, 'compress@10': 0.4125, 'time@10': 8.7618}:  50%|█████     | 5/10 [00:38<00:29,  5.95s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9476, 'compress@10': 0.4125, 'time@10': 8.7618}:  60%|██████    | 6/10 [00:38<00:30,  7.63s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9479, 'compress@10': 0.3821, 'time@10': 9.11}:  60%|██████    | 6/10 [00:44<00:30,  7.63s/it]  {'epoch': 32, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9479, 'compress@10': 0.3821, 'time@10': 9.11}:  70%|███████   | 7/10 [00:44<00:20,  6.98s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0145, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9486, 'compress@10': 0.3582, 'time@10': 8.967}:  70%|███████   | 7/10 [00:52<00:20,  6.98s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0145, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9486, 'compress@10': 0.3582, 'time@10': 8.967}:  80%|████████  | 8/10 [00:52<00:14,  7.32s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9468, 'compress@10': 0.3592, 'time@10': 9.6022}:  80%|████████  | 8/10 [00:59<00:14,  7.32s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9468, 'compress@10': 0.3592, 'time@10': 9.6022}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9503, 'compress@10': 0.3388, 'time@10': 9.6451}:  90%|█████████ | 9/10 [01:09<00:07,  7.34s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9503, 'compress@10': 0.3388, 'time@10': 9.6451}: 100%|██████████| 10/10 [01:09<00:00,  8.18s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9503, 'compress@10': 0.3388, 'time@10': 9.6451}: 100%|██████████| 10/10 [01:09<00:00,  6.97s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.01770591984671507
Avg hit ratio: 0.9024620667014555
Avg ndcg: 0.9502897470251375
Avg compression ratio: 0.33884437993554195
Avg train time: 9.645074820518493
Std train time: 2.969056481266096
[0.45588235294117657, 0.014705882352941183, 0.04411764705882354, 0.39705882352941185, 0.8676470588235294, 0.4264705882352942, 0.16176470588235287, 0.16176470588235292, 0.36764705882352944, 0.16176470588235292]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9146, 'compress@10': 0.4845, 'time@10': 8.5556}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9146, 'compress@10': 0.4845, 'time@10': 8.5556}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9405, 'compress@10': 0.2655, 'time@10': 7.7054}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it]  {'epoch': 33, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9405, 'compress@10': 0.2655, 'time@10': 7.7054}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9127, 'compress@10': 0.2372, 'time@10': 7.0239}:  20%|██        | 2/10 [00:14<00:46,  5.83s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9127, 'compress@10': 0.2372, 'time@10': 7.0239}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9246, 'compress@10': 0.2826, 'time@10': 6.9346}:  30%|███       | 3/10 [00:21<00:32,  4.58s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9246, 'compress@10': 0.2826, 'time@10': 6.9346}:  40%|████      | 4/10 [00:21<00:32,  5.42s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9267, 'compress@10': 0.4001, 'time@10': 8.3569}:  40%|████      | 4/10 [00:28<00:32,  5.42s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9267, 'compress@10': 0.4001, 'time@10': 8.3569}:  50%|█████     | 5/10 [00:28<00:30,  6.01s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9345, 'compress@10': 0.4066, 'time@10': 8.7687}:  50%|█████     | 5/10 [00:38<00:30,  6.01s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9345, 'compress@10': 0.4066, 'time@10': 8.7687}:  60%|██████    | 6/10 [00:38<00:30,  7.66s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9382, 'compress@10': 0.3764, 'time@10': 9.1169}:  60%|██████    | 6/10 [00:44<00:30,  7.66s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9382, 'compress@10': 0.3764, 'time@10': 9.1169}:  70%|███████   | 7/10 [00:44<00:21,  7.00s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9417, 'compress@10': 0.3526, 'time@10': 8.982}:  70%|███████   | 7/10 [00:52<00:21,  7.00s/it]   {'epoch': 33, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9417, 'compress@10': 0.3526, 'time@10': 8.982}:  80%|████████  | 8/10 [00:52<00:14,  7.34s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9576, 'compress@10': 0.3563, 'time@10': 9.6171}:  80%|████████  | 8/10 [01:00<00:14,  7.34s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9576, 'compress@10': 0.3563, 'time@10': 9.6171}:  90%|█████████ | 9/10 [01:00<00:07,  7.36s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9594, 'compress@10': 0.3387, 'time@10': 9.6677}:  90%|█████████ | 9/10 [01:10<00:07,  7.36s/it]  {'epoch': 33, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9594, 'compress@10': 0.3387, 'time@10': 9.6677}: 100%|██████████| 10/10 [01:10<00:00,  8.22s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9594, 'compress@10': 0.3387, 'time@10': 9.6677}: 100%|██████████| 10/10 [01:10<00:00,  7.02s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.014120294994949286
Avg hit ratio: 0.9073192095585985
Avg ndcg: 0.959354449597234
Avg compression ratio: 0.33873442035795365
Avg train time: 9.66772165298462
Std train time: 2.9198226482462477
[0.44285714285714295, 0.014285714285714292, 0.042857142857142864, 0.3857142857142858, 0.8714285714285714, 0.41428571428571437, 0.18571428571428564, 0.1571428571428571, 0.38571428571428573, 0.1571428571428571]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9176, 'compress@10': 0.4722, 'time@10': 8.6488}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9176, 'compress@10': 0.4722, 'time@10': 8.6488}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9427, 'compress@10': 0.2591, 'time@10': 7.5725}:  10%|█         | 1/10 [00:10<00:39,  4.36s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9427, 'compress@10': 0.2591, 'time@10': 7.5725}:  20%|██        | 2/10 [00:10<00:45,  5.64s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9142, 'compress@10': 0.2326, 'time@10': 6.8867}:  20%|██        | 2/10 [00:13<00:45,  5.64s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9142, 'compress@10': 0.2326, 'time@10': 6.8867}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9257, 'compress@10': 0.2764, 'time@10': 6.7635}:  30%|███       | 3/10 [00:20<00:30,  4.34s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9257, 'compress@10': 0.2764, 'time@10': 6.7635}:  40%|████      | 4/10 [00:20<00:30,  5.17s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9277, 'compress@10': 0.3959, 'time@10': 8.2266}:  40%|████      | 4/10 [00:27<00:30,  5.17s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9277, 'compress@10': 0.3959, 'time@10': 8.2266}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9355, 'compress@10': 0.4011, 'time@10': 8.6426}:  50%|█████     | 5/10 [00:37<00:29,  5.86s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9355, 'compress@10': 0.4011, 'time@10': 8.6426}:  60%|██████    | 6/10 [00:37<00:30,  7.52s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.01, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9368, 'compress@10': 0.375, 'time@10': 8.9886}:  60%|██████    | 6/10 [00:43<00:30,  7.52s/it]  {'epoch': 34, 'num_users': 6.2857, 'loss': 0.01, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9368, 'compress@10': 0.375, 'time@10': 8.9886}:  70%|███████   | 7/10 [00:43<00:20,  6.88s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9406, 'compress@10': 0.3508, 'time@10': 8.8849}:  70%|███████   | 7/10 [00:51<00:20,  6.88s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9406, 'compress@10': 0.3508, 'time@10': 8.8849}:  80%|████████  | 8/10 [00:51<00:14,  7.31s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9446, 'compress@10': 0.3566, 'time@10': 9.5116}:  80%|████████  | 8/10 [00:59<00:14,  7.31s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9446, 'compress@10': 0.3566, 'time@10': 9.5116}:  90%|█████████ | 9/10 [00:59<00:07,  7.30s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9482, 'compress@10': 0.3386, 'time@10': 9.558}:  90%|█████████ | 9/10 [01:09<00:07,  7.30s/it]    {'epoch': 34, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9482, 'compress@10': 0.3386, 'time@10': 9.558}: 100%|██████████| 10/10 [01:09<00:00,  8.14s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9482, 'compress@10': 0.3386, 'time@10': 9.558}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.013308494208225118
Avg hit ratio: 0.9034584824720648
Avg ndcg: 0.9481854418648432
Avg compression ratio: 0.33859151035513624
Avg train time: 9.557966423034667
Std train time: 2.9568678936051076
[0.43055555555555564, 0.013888888888888895, 0.04166666666666667, 0.40277777777777785, 0.8472222222222222, 0.40277777777777785, 0.18055555555555547, 0.15277777777777773, 0.4027777777777778, 0.18055555555555552]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9093, 'compress@10': 0.4605, 'time@10': 8.152}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9093, 'compress@10': 0.4605, 'time@10': 8.152}:  10%|█         | 1/10 [00:04<00:37,  4.11s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9453, 'compress@10': 0.2531, 'time@10': 7.4849}:  10%|█         | 1/10 [00:10<00:37,  4.11s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9453, 'compress@10': 0.2531, 'time@10': 7.4849}:  20%|██        | 2/10 [00:10<00:45,  5.73s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9159, 'compress@10': 0.2283, 'time@10': 6.8482}:  20%|██        | 2/10 [00:13<00:45,  5.73s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9159, 'compress@10': 0.2283, 'time@10': 6.8482}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9252, 'compress@10': 0.2772, 'time@10': 6.7627}:  30%|███       | 3/10 [00:20<00:30,  4.41s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9252, 'compress@10': 0.2772, 'time@10': 6.7627}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9282, 'compress@10': 0.3918, 'time@10': 8.2113}:  40%|████      | 4/10 [00:27<00:31,  5.25s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9282, 'compress@10': 0.3918, 'time@10': 8.2113}:  50%|█████     | 5/10 [00:27<00:29,  5.90s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9423, 'compress@10': 0.3959, 'time@10': 8.6136}:  50%|█████     | 5/10 [00:38<00:29,  5.90s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9423, 'compress@10': 0.3959, 'time@10': 8.6136}:  60%|██████    | 6/10 [00:38<00:30,  7.52s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9435, 'compress@10': 0.3698, 'time@10': 9.0009}:  60%|██████    | 6/10 [00:43<00:30,  7.52s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9435, 'compress@10': 0.3698, 'time@10': 9.0009}:  70%|███████   | 7/10 [00:43<00:20,  6.93s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9476, 'compress@10': 0.3457, 'time@10': 8.8917}:  70%|███████   | 7/10 [00:51<00:20,  6.93s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9476, 'compress@10': 0.3457, 'time@10': 8.8917}:  80%|████████  | 8/10 [00:51<00:14,  7.32s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0167, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9636, 'compress@10': 0.3539, 'time@10': 9.5239}:  80%|████████  | 8/10 [00:59<00:14,  7.32s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0167, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9636, 'compress@10': 0.3539, 'time@10': 9.5239}:  90%|█████████ | 9/10 [00:59<00:07,  7.32s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9697, 'compress@10': 0.3385, 'time@10': 9.5609}:  90%|█████████ | 9/10 [01:09<00:07,  7.32s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9697, 'compress@10': 0.3385, 'time@10': 9.5609}: 100%|██████████| 10/10 [01:09<00:00,  8.13s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9697, 'compress@10': 0.3385, 'time@10': 9.5609}: 100%|██████████| 10/10 [01:09<00:00,  6.92s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.017379238022030587
Avg hit ratio: 0.9099100953752906
Avg ndcg: 0.9696854189599666
Avg compression ratio: 0.33846083396578747
Avg train time: 9.560934734344482
Std train time: 2.9343808900112927
[0.41891891891891897, 0.01351351351351352, 0.04054054054054054, 0.39189189189189194, 0.8243243243243243, 0.41891891891891897, 0.1756756756756756, 0.1486486486486486, 0.4189189189189189, 0.2027027027027027]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.4495, 'time@10': 8.6437}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.4495, 'time@10': 8.6437}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9795, 'compress@10': 0.2474, 'time@10': 7.7665}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9795, 'compress@10': 0.2474, 'time@10': 7.7665}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9387, 'compress@10': 0.2242, 'time@10': 7.0325}:  20%|██        | 2/10 [00:14<00:46,  5.87s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9387, 'compress@10': 0.2242, 'time@10': 7.0325}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9429, 'compress@10': 0.2715, 'time@10': 6.8688}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9429, 'compress@10': 0.2715, 'time@10': 6.8688}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9423, 'compress@10': 0.3828, 'time@10': 8.3052}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9423, 'compress@10': 0.3828, 'time@10': 8.3052}:  50%|█████     | 5/10 [00:27<00:29,  5.90s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.9478, 'compress@10': 0.391, 'time@10': 8.6882}:  50%|█████     | 5/10 [00:38<00:29,  5.90s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.9478, 'compress@10': 0.391, 'time@10': 8.6882}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9483, 'compress@10': 0.3649, 'time@10': 9.0393}:  60%|██████    | 6/10 [00:43<00:30,  7.51s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9483, 'compress@10': 0.3649, 'time@10': 9.0393}:  70%|███████   | 7/10 [00:43<00:20,  6.90s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9507, 'compress@10': 0.3409, 'time@10': 8.9118}:  70%|███████   | 7/10 [00:51<00:20,  6.90s/it]  {'epoch': 36, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9507, 'compress@10': 0.3409, 'time@10': 8.9118}:  80%|████████  | 8/10 [00:51<00:14,  7.27s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9491, 'compress@10': 0.3514, 'time@10': 9.5453}:  80%|████████  | 8/10 [00:59<00:14,  7.27s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9491, 'compress@10': 0.3514, 'time@10': 9.5453}:  90%|█████████ | 9/10 [00:59<00:07,  7.29s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9519, 'compress@10': 0.3384, 'time@10': 9.5932}:  90%|█████████ | 9/10 [01:09<00:07,  7.29s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9519, 'compress@10': 0.3384, 'time@10': 9.5932}: 100%|██████████| 10/10 [01:09<00:00,  8.15s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9519, 'compress@10': 0.3384, 'time@10': 9.5932}: 100%|██████████| 10/10 [01:09<00:00,  6.93s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.013510632796258132
Avg hit ratio: 0.8869505459641284
Avg ndcg: 0.9518664858084062
Avg compression ratio: 0.3383722098321827
Avg train time: 9.59322612285614
Std train time: 2.931720457450672
[0.4078947368421053, 0.03947368421052632, 0.03947368421052632, 0.38157894736842113, 0.8026315789473685, 0.4078947368421053, 0.1710526315789473, 0.1447368421052631, 0.4342105263157895, 0.22368421052631576]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.4391, 'time@10': 8.7895}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.4391, 'time@10': 8.7895}:  10%|█         | 1/10 [00:04<00:39,  4.43s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9448, 'compress@10': 0.2548, 'time@10': 7.8583}:  10%|█         | 1/10 [00:11<00:39,  4.43s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9448, 'compress@10': 0.2548, 'time@10': 7.8583}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9156, 'compress@10': 0.2287, 'time@10': 7.0994}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9156, 'compress@10': 0.2287, 'time@10': 7.0994}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9271, 'compress@10': 0.2725, 'time@10': 6.9683}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9271, 'compress@10': 0.2725, 'time@10': 6.9683}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.931, 'compress@10': 0.3793, 'time@10': 8.4438}:  40%|████      | 4/10 [00:28<00:32,  5.34s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.931, 'compress@10': 0.3793, 'time@10': 8.4438}:  50%|█████     | 5/10 [00:28<00:30,  6.01s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0073, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9386, 'compress@10': 0.3863, 'time@10': 8.8289}:  50%|█████     | 5/10 [00:38<00:30,  6.01s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0073, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9386, 'compress@10': 0.3863, 'time@10': 8.8289}:  60%|██████    | 6/10 [00:38<00:30,  7.64s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0079, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9401, 'compress@10': 0.3602, 'time@10': 9.1725}:  60%|██████    | 6/10 [00:44<00:30,  7.64s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0079, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9401, 'compress@10': 0.3602, 'time@10': 9.1725}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0078, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9435, 'compress@10': 0.3364, 'time@10': 9.0323}:  70%|███████   | 7/10 [00:52<00:20,  6.99s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0078, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9435, 'compress@10': 0.3364, 'time@10': 9.0323}:  80%|████████  | 8/10 [00:52<00:14,  7.34s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0098, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9588, 'compress@10': 0.349, 'time@10': 9.7095}:  80%|████████  | 8/10 [01:00<00:14,  7.34s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0098, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9588, 'compress@10': 0.349, 'time@10': 9.7095}:  90%|█████████ | 9/10 [01:00<00:07,  7.42s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9605, 'compress@10': 0.3383, 'time@10': 9.7481}:  90%|█████████ | 9/10 [01:10<00:07,  7.42s/it]  {'epoch': 37, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9605, 'compress@10': 0.3383, 'time@10': 9.7481}: 100%|██████████| 10/10 [01:10<00:00,  8.26s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9605, 'compress@10': 0.3383, 'time@10': 9.7481}: 100%|██████████| 10/10 [01:10<00:00,  7.03s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.00915687364400355
Avg hit ratio: 0.8994851081761098
Avg ndcg: 0.9605290835000625
Avg compression ratio: 0.3382622582584989
Avg train time: 9.748092126846313
Std train time: 3.04296423827629
[0.39743589743589747, 0.038461538461538464, 0.038461538461538464, 0.3974358974358975, 0.8076923076923077, 0.39743589743589747, 0.1666666666666666, 0.14102564102564097, 0.44871794871794873, 0.21794871794871792]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9455, 'compress@10': 0.4292, 'time@10': 8.7494}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9455, 'compress@10': 0.4292, 'time@10': 8.7494}:  10%|█         | 1/10 [00:04<00:39,  4.41s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9558, 'compress@10': 0.2493, 'time@10': 7.8173}:  10%|█         | 1/10 [00:11<00:39,  4.41s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9558, 'compress@10': 0.2493, 'time@10': 7.8173}:  20%|██        | 2/10 [00:11<00:47,  5.89s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9229, 'compress@10': 0.2248, 'time@10': 7.0129}:  20%|██        | 2/10 [00:14<00:47,  5.89s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9229, 'compress@10': 0.2248, 'time@10': 7.0129}:  30%|███       | 3/10 [00:14<00:31,  4.45s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9323, 'compress@10': 0.2734, 'time@10': 6.8336}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9323, 'compress@10': 0.2734, 'time@10': 6.8336}:  40%|████      | 4/10 [00:20<00:31,  5.19s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.9346, 'compress@10': 0.381, 'time@10': 8.2288}:  40%|████      | 4/10 [00:27<00:31,  5.19s/it] {'epoch': 38, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.9346, 'compress@10': 0.381, 'time@10': 8.2288}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9407, 'compress@10': 0.386, 'time@10': 8.6435}:  50%|█████     | 5/10 [00:38<00:29,  5.82s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9407, 'compress@10': 0.386, 'time@10': 8.6435}:  60%|██████    | 6/10 [00:38<00:30,  7.50s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9429, 'compress@10': 0.3594, 'time@10': 9.012}:  60%|██████    | 6/10 [00:43<00:30,  7.50s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9429, 'compress@10': 0.3594, 'time@10': 9.012}:  70%|███████   | 7/10 [00:43<00:20,  6.90s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9459, 'compress@10': 0.3352, 'time@10': 8.8907}:  70%|███████   | 7/10 [00:51<00:20,  6.90s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9459, 'compress@10': 0.3352, 'time@10': 8.8907}:  80%|████████  | 8/10 [00:51<00:14,  7.27s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9503, 'compress@10': 0.3495, 'time@10': 9.5346}:  80%|████████  | 8/10 [00:59<00:14,  7.27s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9503, 'compress@10': 0.3495, 'time@10': 9.5346}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9516, 'compress@10': 0.3382, 'time@10': 9.606}:  90%|█████████ | 9/10 [01:09<00:07,  7.31s/it]    {'epoch': 38, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9516, 'compress@10': 0.3382, 'time@10': 9.606}: 100%|██████████| 10/10 [01:09<00:00,  8.23s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9516, 'compress@10': 0.3382, 'time@10': 9.606}: 100%|██████████| 10/10 [01:09<00:00,  6.95s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.014705295203919272
Avg hit ratio: 0.8748870539006364
Avg ndcg: 0.9516002107627983
Avg compression ratio: 0.33815767848748857
Avg train time: 9.605969715118409
Std train time: 2.9483311586868743
[0.3875, 0.037500000000000006, 0.037500000000000006, 0.4125000000000001, 0.7875, 0.3875, 0.16249999999999995, 0.13749999999999996, 0.4625, 0.2375]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9193, 'compress@10': 0.4197, 'time@10': 8.8396}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9193, 'compress@10': 0.4197, 'time@10': 8.8396}:  10%|█         | 1/10 [00:04<00:40,  4.46s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.952, 'compress@10': 0.2441, 'time@10': 7.771}:  10%|█         | 1/10 [00:11<00:40,  4.46s/it]  {'epoch': 39, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.952, 'compress@10': 0.2441, 'time@10': 7.771}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9204, 'compress@10': 0.2211, 'time@10': 7.1652}:  20%|██        | 2/10 [00:14<00:46,  5.80s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9204, 'compress@10': 0.2211, 'time@10': 7.1652}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9297, 'compress@10': 0.2742, 'time@10': 7.006}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9297, 'compress@10': 0.2742, 'time@10': 7.006}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.9328, 'compress@10': 0.3777, 'time@10': 8.388}:  40%|████      | 4/10 [00:27<00:32,  5.34s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.9328, 'compress@10': 0.3777, 'time@10': 8.388}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9396, 'compress@10': 0.3816, 'time@10': 8.8273}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9396, 'compress@10': 0.3816, 'time@10': 8.8273}:  60%|██████    | 6/10 [00:38<00:30,  7.69s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9416, 'compress@10': 0.3551, 'time@10': 9.1762}:  60%|██████    | 6/10 [00:44<00:30,  7.69s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9416, 'compress@10': 0.3551, 'time@10': 9.1762}:  70%|███████   | 7/10 [00:44<00:21,  7.03s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9448, 'compress@10': 0.331, 'time@10': 9.0567}:  70%|███████   | 7/10 [00:52<00:21,  7.03s/it]  {'epoch': 39, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9448, 'compress@10': 0.331, 'time@10': 9.0567}:  80%|████████  | 8/10 [00:52<00:14,  7.42s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0149, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.959, 'compress@10': 0.3473, 'time@10': 9.6645}:  80%|████████  | 8/10 [01:00<00:14,  7.42s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0149, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.959, 'compress@10': 0.3473, 'time@10': 9.6645}:  90%|█████████ | 9/10 [01:00<00:07,  7.39s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9629, 'compress@10': 0.338, 'time@10': 9.7055}:  90%|█████████ | 9/10 [01:10<00:07,  7.39s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9629, 'compress@10': 0.338, 'time@10': 9.7055}: 100%|██████████| 10/10 [01:10<00:00,  8.23s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9629, 'compress@10': 0.338, 'time@10': 9.7055}: 100%|██████████| 10/10 [01:10<00:00,  7.02s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.015398196134861469
Avg hit ratio: 0.8698076888212712
Avg ndcg: 0.9629481899967107
Avg compression ratio: 0.3380494442323707
Avg train time: 9.705518460273742
Std train time: 2.8537473259132797
[0.3780487804878049, 0.03658536585365854, 0.03658536585365854, 0.402439024390244, 0.7682926829268293, 0.4024390243902439, 0.1585365853658536, 0.1341463414634146, 0.475609756097561, 0.25609756097560976]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9203, 'compress@10': 0.4108, 'time@10': 8.522}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9203, 'compress@10': 0.4108, 'time@10': 8.522}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.944, 'compress@10': 0.2392, 'time@10': 7.7741}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.944, 'compress@10': 0.2392, 'time@10': 7.7741}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9151, 'compress@10': 0.2176, 'time@10': 7.0365}:  20%|██        | 2/10 [00:14<00:47,  5.94s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9151, 'compress@10': 0.2176, 'time@10': 7.0365}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9269, 'compress@10': 0.2691, 'time@10': 6.9014}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9269, 'compress@10': 0.2691, 'time@10': 6.9014}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9321, 'compress@10': 0.3699, 'time@10': 8.3268}:  40%|████      | 4/10 [00:27<00:31,  5.31s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9321, 'compress@10': 0.3699, 'time@10': 8.3268}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0071, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.9395, 'compress@10': 0.3775, 'time@10': 8.7269}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0071, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.9395, 'compress@10': 0.3775, 'time@10': 8.7269}:  60%|██████    | 6/10 [00:38<00:30,  7.58s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9445, 'compress@10': 0.351, 'time@10': 9.1531}:  60%|██████    | 6/10 [00:44<00:30,  7.58s/it] {'epoch': 40, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9445, 'compress@10': 0.351, 'time@10': 9.1531}:  70%|███████   | 7/10 [00:44<00:21,  7.03s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0088, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.947, 'compress@10': 0.327, 'time@10': 9.0486}:  70%|███████   | 7/10 [00:52<00:21,  7.03s/it]  {'epoch': 40, 'num_users': 6.125, 'loss': 0.0088, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.947, 'compress@10': 0.327, 'time@10': 9.0486}:  80%|████████  | 8/10 [00:52<00:14,  7.45s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9464, 'compress@10': 0.3452, 'time@10': 9.6454}:  80%|████████  | 8/10 [01:00<00:14,  7.45s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9464, 'compress@10': 0.3452, 'time@10': 9.6454}:  90%|█████████ | 9/10 [01:00<00:07,  7.39s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.887, 'ndcg@10': 0.949, 'compress@10': 0.338, 'time@10': 9.6793}:  90%|█████████ | 9/10 [01:10<00:07,  7.39s/it]      {'epoch': 40, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.887, 'ndcg@10': 0.949, 'compress@10': 0.338, 'time@10': 9.6793}: 100%|██████████| 10/10 [01:10<00:00,  8.20s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.887, 'ndcg@10': 0.949, 'compress@10': 0.338, 'time@10': 9.6793}: 100%|██████████| 10/10 [01:10<00:00,  7.01s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.011621233608464811
Avg hit ratio: 0.8869505459641284
Avg ndcg: 0.9489797792247788
Avg compression ratio: 0.33797852970864434
Avg train time: 9.67928433418274
Std train time: 2.8987800601398925
[0.36904761904761907, 0.03571428571428572, 0.03571428571428572, 0.39285714285714296, 0.75, 0.3928571428571429, 0.17857142857142852, 0.1309523809523809, 0.48809523809523814, 0.27380952380952384]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0071, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.4023, 'time@10': 8.46}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0071, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.4023, 'time@10': 8.46}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0054, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9459, 'compress@10': 0.2345, 'time@10': 7.603}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0054, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9459, 'compress@10': 0.2345, 'time@10': 7.603}:  20%|██        | 2/10 [00:11<00:45,  5.75s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0036, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9163, 'compress@10': 0.2142, 'time@10': 6.9667}:  20%|██        | 2/10 [00:13<00:45,  5.75s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0036, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9163, 'compress@10': 0.2142, 'time@10': 6.9667}:  30%|███       | 3/10 [00:13<00:31,  4.44s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9276, 'compress@10': 0.2643, 'time@10': 6.8244}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9276, 'compress@10': 0.2643, 'time@10': 6.8244}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9335, 'compress@10': 0.3624, 'time@10': 8.2774}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9335, 'compress@10': 0.3624, 'time@10': 8.2774}:  50%|█████     | 5/10 [00:27<00:29,  5.90s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9391, 'compress@10': 0.3697, 'time@10': 8.6959}:  50%|█████     | 5/10 [00:38<00:29,  5.90s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9391, 'compress@10': 0.3697, 'time@10': 8.6959}:  60%|██████    | 6/10 [00:38<00:30,  7.58s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9411, 'compress@10': 0.3471, 'time@10': 9.1044}:  60%|██████    | 6/10 [00:44<00:30,  7.58s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9411, 'compress@10': 0.3471, 'time@10': 9.1044}:  70%|███████   | 7/10 [00:44<00:20,  7.00s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.945, 'compress@10': 0.3232, 'time@10': 8.9905}:  70%|███████   | 7/10 [00:52<00:20,  7.00s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.945, 'compress@10': 0.3232, 'time@10': 8.9905}:  80%|████████  | 8/10 [00:52<00:14,  7.39s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9553, 'compress@10': 0.3432, 'time@10': 9.6263}:  80%|████████  | 8/10 [00:59<00:14,  7.39s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9553, 'compress@10': 0.3432, 'time@10': 9.6263}:  90%|█████████ | 9/10 [00:59<00:07,  7.39s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9574, 'compress@10': 0.3379, 'time@10': 9.6769}:  90%|█████████ | 9/10 [01:09<00:07,  7.39s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9574, 'compress@10': 0.3379, 'time@10': 9.6769}: 100%|██████████| 10/10 [01:09<00:00,  8.25s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9574, 'compress@10': 0.3379, 'time@10': 9.6769}: 100%|██████████| 10/10 [01:09<00:00,  6.99s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.010060195741055324
Avg hit ratio: 0.8901763524157411
Avg ndcg: 0.95737354054436
Avg compression ratio: 0.33787197908614447
Avg train time: 9.676854753494263
Std train time: 2.97796340989637
[0.3604651162790698, 0.034883720930232565, 0.034883720930232565, 0.4069767441860466, 0.7325581395348837, 0.40697674418604657, 0.17441860465116274, 0.127906976744186, 0.5, 0.2674418604651163]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.3941, 'time@10': 8.6254}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.3941, 'time@10': 8.6254}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9462, 'compress@10': 0.2301, 'time@10': 7.814}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9462, 'compress@10': 0.2301, 'time@10': 7.814}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9165, 'compress@10': 0.211, 'time@10': 7.0882}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9165, 'compress@10': 0.211, 'time@10': 7.0882}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9267, 'compress@10': 0.2653, 'time@10': 6.89}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9267, 'compress@10': 0.2653, 'time@10': 6.89}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.9336, 'compress@10': 0.3598, 'time@10': 8.3778}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.9336, 'compress@10': 0.3598, 'time@10': 8.3778}:  50%|█████     | 5/10 [00:27<00:29,  5.95s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9401, 'compress@10': 0.3699, 'time@10': 8.755}:  50%|█████     | 5/10 [00:38<00:29,  5.95s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9401, 'compress@10': 0.3699, 'time@10': 8.755}:  60%|██████    | 6/10 [00:38<00:30,  7.56s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9426, 'compress@10': 0.3467, 'time@10': 9.0907}:  60%|██████    | 6/10 [00:44<00:30,  7.56s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9426, 'compress@10': 0.3467, 'time@10': 9.0907}:  70%|███████   | 7/10 [00:44<00:20,  6.91s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0097, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9455, 'compress@10': 0.3224, 'time@10': 8.9464}:  70%|███████   | 7/10 [00:52<00:20,  6.91s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0097, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9455, 'compress@10': 0.3224, 'time@10': 8.9464}:  80%|████████  | 8/10 [00:52<00:14,  7.25s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9446, 'compress@10': 0.3437, 'time@10': 9.6262}:  80%|████████  | 8/10 [00:59<00:14,  7.25s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9446, 'compress@10': 0.3437, 'time@10': 9.6262}:  90%|█████████ | 9/10 [00:59<00:07,  7.35s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9449, 'compress@10': 0.3378, 'time@10': 9.6626}:  90%|█████████ | 9/10 [01:09<00:07,  7.35s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9449, 'compress@10': 0.3378, 'time@10': 9.6626}: 100%|██████████| 10/10 [01:09<00:00,  8.18s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9449, 'compress@10': 0.3378, 'time@10': 9.6626}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.012751070183539857
Avg hit ratio: 0.87911644458164
Avg ndcg: 0.9448968450470764
Avg compression ratio: 0.33777942261608535
Avg train time: 9.662613224983215
Std train time: 3.0458938832377918
[0.3522727272727273, 0.034090909090909095, 0.034090909090909095, 0.3977272727272728, 0.7159090909090908, 0.4204545454545455, 0.17045454545454541, 0.12499999999999994, 0.5113636363636364, 0.2840909090909091]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9339, 'compress@10': 0.3864, 'time@10': 8.3303}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9339, 'compress@10': 0.3864, 'time@10': 8.3303}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9593, 'compress@10': 0.2258, 'time@10': 7.631}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9593, 'compress@10': 0.2258, 'time@10': 7.631}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9252, 'compress@10': 0.2079, 'time@10': 7.0747}:  20%|██        | 2/10 [00:14<00:46,  5.83s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9252, 'compress@10': 0.2079, 'time@10': 7.0747}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9339, 'compress@10': 0.2607, 'time@10': 6.9044}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9339, 'compress@10': 0.2607, 'time@10': 6.9044}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.9389, 'compress@10': 0.3529, 'time@10': 8.3718}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.9389, 'compress@10': 0.3529, 'time@10': 8.3718}:  50%|█████     | 5/10 [00:27<00:29,  5.96s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9452, 'compress@10': 0.3663, 'time@10': 8.7297}:  50%|█████     | 5/10 [00:38<00:29,  5.96s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9452, 'compress@10': 0.3663, 'time@10': 8.7297}:  60%|██████    | 6/10 [00:38<00:30,  7.53s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0098, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9464, 'compress@10': 0.3431, 'time@10': 9.0626}:  60%|██████    | 6/10 [00:43<00:30,  7.53s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0098, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9464, 'compress@10': 0.3431, 'time@10': 9.0626}:  70%|███████   | 7/10 [00:43<00:20,  6.89s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9488, 'compress@10': 0.3189, 'time@10': 8.9463}:  70%|███████   | 7/10 [00:52<00:20,  6.89s/it]  {'epoch': 43, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9488, 'compress@10': 0.3189, 'time@10': 8.9463}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9643, 'compress@10': 0.3419, 'time@10': 9.5692}:  80%|████████  | 8/10 [00:59<00:14,  7.30s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9643, 'compress@10': 0.3419, 'time@10': 9.5692}:  90%|█████████ | 9/10 [00:59<00:07,  7.30s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9667, 'compress@10': 0.3377, 'time@10': 9.6395}:  90%|█████████ | 9/10 [01:09<00:07,  7.30s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9667, 'compress@10': 0.3377, 'time@10': 9.6395}: 100%|██████████| 10/10 [01:09<00:00,  8.23s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9667, 'compress@10': 0.3377, 'time@10': 9.6395}: 100%|██████████| 10/10 [01:09<00:00,  6.97s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.011863757435473781
Avg hit ratio: 0.8748870539006364
Avg ndcg: 0.9666538684944441
Avg compression ratio: 0.3377199530135179
Avg train time: 9.639532542228698
Std train time: 2.8961916778148415
[0.3666666666666667, 0.05555555555555556, 0.03333333333333334, 0.38888888888888895, 0.7, 0.4111111111111112, 0.16666666666666663, 0.12222222222222216, 0.5222222222222223, 0.2777777777777778]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.924, 'compress@10': 0.4, 'time@10': 8.4908}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.924, 'compress@10': 0.4, 'time@10': 8.4908}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9472, 'compress@10': 0.243, 'time@10': 7.5491}:  10%|█         | 1/10 [00:10<00:38,  4.29s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9472, 'compress@10': 0.243, 'time@10': 7.5491}:  20%|██        | 2/10 [00:10<00:45,  5.68s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.7207, 'ndcg@10': 0.9172, 'compress@10': 0.2192, 'time@10': 6.8407}:  20%|██        | 2/10 [00:13<00:45,  5.68s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.7207, 'ndcg@10': 0.9172, 'compress@10': 0.2192, 'time@10': 6.8407}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.9289, 'compress@10': 0.267, 'time@10': 6.786}:  30%|███       | 3/10 [00:20<00:30,  4.34s/it]  {'epoch': 44, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.9289, 'compress@10': 0.267, 'time@10': 6.786}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.9357, 'compress@10': 0.3548, 'time@10': 8.224}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.9357, 'compress@10': 0.3548, 'time@10': 8.224}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.9432, 'compress@10': 0.3664, 'time@10': 8.6446}:  50%|█████     | 5/10 [00:38<00:29,  5.89s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.9432, 'compress@10': 0.3664, 'time@10': 8.6446}:  60%|██████    | 6/10 [00:38<00:30,  7.56s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.9461, 'compress@10': 0.3426, 'time@10': 8.962}:  60%|██████    | 6/10 [00:43<00:30,  7.56s/it] {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.9461, 'compress@10': 0.3426, 'time@10': 8.962}:  70%|███████   | 7/10 [00:43<00:20,  6.88s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9494, 'compress@10': 0.3182, 'time@10': 8.8325}:  70%|███████   | 7/10 [00:51<00:20,  6.88s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9494, 'compress@10': 0.3182, 'time@10': 8.8325}:  80%|████████  | 8/10 [00:51<00:14,  7.22s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9514, 'compress@10': 0.3424, 'time@10': 9.458}:  80%|████████  | 8/10 [00:58<00:14,  7.22s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9514, 'compress@10': 0.3424, 'time@10': 9.458}:  90%|█████████ | 9/10 [00:58<00:07,  7.24s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9529, 'compress@10': 0.3376, 'time@10': 9.5413}:  90%|█████████ | 9/10 [01:09<00:07,  7.24s/it]     {'epoch': 44, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9529, 'compress@10': 0.3376, 'time@10': 9.5413}: 100%|██████████| 10/10 [01:09<00:00,  8.19s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9529, 'compress@10': 0.3376, 'time@10': 9.5413}: 100%|██████████| 10/10 [01:09<00:00,  6.92s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.013954536194021257
Avg hit ratio: 0.8699925596003695
Avg ndcg: 0.9528609252712364
Avg compression ratio: 0.3375758137891301
Avg train time: 9.541291856765747
Std train time: 2.9232113049345214
[0.3586956521739131, 0.05434782608695653, 0.03260869565217392, 0.38043478260869573, 0.6847826086956521, 0.423913043478261, 0.16304347826086954, 0.1195652173913043, 0.532608695652174, 0.29347826086956524]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0054, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.3925, 'time@10': 8.4484}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0054, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.3925, 'time@10': 8.4484}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0039, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9459, 'compress@10': 0.2387, 'time@10': 7.6558}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0039, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9459, 'compress@10': 0.2387, 'time@10': 7.6558}:  20%|██        | 2/10 [00:11<00:46,  5.81s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0026, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9163, 'compress@10': 0.216, 'time@10': 6.9426}:  20%|██        | 2/10 [00:13<00:46,  5.81s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.0026, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9163, 'compress@10': 0.216, 'time@10': 6.9426}:  30%|███       | 3/10 [00:13<00:31,  4.44s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9278, 'compress@10': 0.2627, 'time@10': 6.826}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9278, 'compress@10': 0.2627, 'time@10': 6.826}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0063, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.9353, 'compress@10': 0.3484, 'time@10': 8.2146}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0063, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.9353, 'compress@10': 0.3484, 'time@10': 8.2146}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.9424, 'compress@10': 0.3631, 'time@10': 8.6392}:  50%|█████     | 5/10 [00:38<00:29,  5.86s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.9424, 'compress@10': 0.3631, 'time@10': 8.6392}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.944, 'compress@10': 0.3393, 'time@10': 9.0059}:  60%|██████    | 6/10 [00:43<00:30,  7.54s/it] {'epoch': 45, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.944, 'compress@10': 0.3393, 'time@10': 9.0059}:  70%|███████   | 7/10 [00:43<00:20,  6.92s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9473, 'compress@10': 0.315, 'time@10': 8.9056}:  70%|███████   | 7/10 [00:52<00:20,  6.92s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9473, 'compress@10': 0.315, 'time@10': 8.9056}:  80%|████████  | 8/10 [00:52<00:14,  7.34s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9525, 'compress@10': 0.3406, 'time@10': 9.5154}:  80%|████████  | 8/10 [00:59<00:14,  7.34s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9525, 'compress@10': 0.3406, 'time@10': 9.5154}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.955, 'compress@10': 0.3375, 'time@10': 9.5549}:  90%|█████████ | 9/10 [01:09<00:07,  7.31s/it]    {'epoch': 45, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.955, 'compress@10': 0.3375, 'time@10': 9.5549}: 100%|██████████| 10/10 [01:09<00:00,  8.12s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.955, 'compress@10': 0.3375, 'time@10': 9.5549}: 100%|██████████| 10/10 [01:09<00:00,  6.93s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.00926532893662585
Avg hit ratio: 0.8704426094561917
Avg ndcg: 0.9550071587979897
Avg compression ratio: 0.3375258443395995
Avg train time: 9.55493152141571
Std train time: 2.8560629163577174
[0.3510638297872341, 0.053191489361702135, 0.03191489361702128, 0.3936170212765958, 0.6702127659574467, 0.4361702127659576, 0.15957446808510636, 0.11702127659574463, 0.5425531914893618, 0.2872340425531915]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.3852, 'time@10': 8.2857}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.3852, 'time@10': 8.2857}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9489, 'compress@10': 0.2345, 'time@10': 7.4489}:  10%|█         | 1/10 [00:10<00:37,  4.18s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9489, 'compress@10': 0.2345, 'time@10': 7.4489}:  20%|██        | 2/10 [00:10<00:45,  5.63s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9183, 'compress@10': 0.2131, 'time@10': 6.7547}:  20%|██        | 2/10 [00:13<00:45,  5.63s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9183, 'compress@10': 0.2131, 'time@10': 6.7547}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9288, 'compress@10': 0.2636, 'time@10': 6.5914}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9288, 'compress@10': 0.2636, 'time@10': 6.5914}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.9367, 'compress@10': 0.3463, 'time@10': 7.83}:  40%|████      | 4/10 [00:26<00:30,  5.03s/it]  {'epoch': 46, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.9367, 'compress@10': 0.3463, 'time@10': 7.83}:  50%|█████     | 5/10 [00:26<00:27,  5.53s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0078, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.9434, 'compress@10': 0.3633, 'time@10': 8.1825}:  50%|█████     | 5/10 [00:36<00:27,  5.53s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0078, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.9434, 'compress@10': 0.3633, 'time@10': 8.1825}:  60%|██████    | 6/10 [00:36<00:28,  7.05s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.007, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9454, 'compress@10': 0.339, 'time@10': 8.503}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it]   {'epoch': 46, 'num_users': 6.2857, 'loss': 0.007, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9454, 'compress@10': 0.339, 'time@10': 8.503}:  70%|███████   | 7/10 [00:41<00:19,  6.46s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0074, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9473, 'compress@10': 0.3144, 'time@10': 8.3852}:  70%|███████   | 7/10 [00:48<00:19,  6.46s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0074, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9473, 'compress@10': 0.3144, 'time@10': 8.3852}:  80%|████████  | 8/10 [00:48<00:13,  6.82s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0086, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.948, 'compress@10': 0.3412, 'time@10': 8.9704}:  80%|████████  | 8/10 [00:55<00:13,  6.82s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0086, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.948, 'compress@10': 0.3412, 'time@10': 8.9704}:  90%|█████████ | 9/10 [00:55<00:06,  6.83s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9498, 'compress@10': 0.3374, 'time@10': 9.0051}:  90%|█████████ | 9/10 [01:05<00:06,  6.83s/it]  {'epoch': 46, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9498, 'compress@10': 0.3374, 'time@10': 9.0051}: 100%|██████████| 10/10 [01:05<00:00,  7.61s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9498, 'compress@10': 0.3374, 'time@10': 9.0051}: 100%|██████████| 10/10 [01:05<00:00,  6.52s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.010228383813972524
Avg hit ratio: 0.8768942223594175
Avg ndcg: 0.9497608177624531
Avg compression ratio: 0.33744772144177143
Avg train time: 9.005071759223938
Std train time: 2.624544709141047
[0.34375000000000006, 0.05208333333333334, 0.03125000000000001, 0.40625000000000006, 0.6562499999999999, 0.4270833333333335, 0.15624999999999997, 0.11458333333333329, 0.5520833333333334, 0.30208333333333337]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9339, 'compress@10': 0.3783, 'time@10': 7.9156}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9339, 'compress@10': 0.3783, 'time@10': 7.9156}:  10%|█         | 1/10 [00:03<00:35,  3.99s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9603, 'compress@10': 0.2305, 'time@10': 7.1042}:  10%|█         | 1/10 [00:10<00:35,  3.99s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9603, 'compress@10': 0.2305, 'time@10': 7.1042}:  20%|██        | 2/10 [00:10<00:42,  5.37s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.7597, 'ndcg@10': 0.9259, 'compress@10': 0.2102, 'time@10': 6.4427}:  20%|██        | 2/10 [00:12<00:42,  5.37s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.7597, 'ndcg@10': 0.9259, 'compress@10': 0.2102, 'time@10': 6.4427}:  30%|███       | 3/10 [00:12<00:28,  4.11s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8019, 'ndcg@10': 0.9349, 'compress@10': 0.2645, 'time@10': 6.3312}:  30%|███       | 3/10 [00:18<00:28,  4.11s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8019, 'ndcg@10': 0.9349, 'compress@10': 0.2645, 'time@10': 6.3312}:  40%|████      | 4/10 [00:18<00:29,  4.87s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.9418, 'compress@10': 0.3442, 'time@10': 7.6817}:  40%|████      | 4/10 [00:25<00:29,  4.87s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.9418, 'compress@10': 0.3442, 'time@10': 7.6817}:  50%|█████     | 5/10 [00:25<00:27,  5.48s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9474, 'compress@10': 0.3602, 'time@10': 8.1201}:  50%|█████     | 5/10 [00:35<00:27,  5.48s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9474, 'compress@10': 0.3602, 'time@10': 8.1201}:  60%|██████    | 6/10 [00:35<00:28,  7.14s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0098, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9483, 'compress@10': 0.3359, 'time@10': 8.4855}:  60%|██████    | 6/10 [00:41<00:28,  7.14s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0098, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9483, 'compress@10': 0.3359, 'time@10': 8.4855}:  70%|███████   | 7/10 [00:41<00:19,  6.56s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9505, 'compress@10': 0.3114, 'time@10': 8.3557}:  70%|███████   | 7/10 [00:48<00:19,  6.56s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9505, 'compress@10': 0.3114, 'time@10': 8.3557}:  80%|████████  | 8/10 [00:48<00:13,  6.86s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.966, 'compress@10': 0.3395, 'time@10': 8.9886}:  80%|████████  | 8/10 [00:55<00:13,  6.86s/it] {'epoch': 47, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.966, 'compress@10': 0.3395, 'time@10': 8.9886}:  90%|█████████ | 9/10 [00:55<00:06,  6.92s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9674, 'compress@10': 0.3374, 'time@10': 9.0382}:  90%|█████████ | 9/10 [01:05<00:06,  6.92s/it] {'epoch': 47, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9674, 'compress@10': 0.3374, 'time@10': 9.0382}: 100%|██████████| 10/10 [01:05<00:00,  7.72s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9674, 'compress@10': 0.3374, 'time@10': 9.0382}: 100%|██████████| 10/10 [01:05<00:00,  6.53s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.010850088289465685
Avg hit ratio: 0.8823422510332527
Avg ndcg: 0.9674482058745804
Avg compression ratio: 0.33737204338480775
Avg train time: 9.038198399543763
Std train time: 2.8625443543331244
[0.3571428571428572, 0.07142857142857144, 0.03061224489795919, 0.39795918367346944, 0.6428571428571428, 0.41836734693877564, 0.1530612244897959, 0.11224489795918363, 0.5612244897959184, 0.2959183673469388]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.93, 'compress@10': 0.391, 'time@10': 8.1007}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.93, 'compress@10': 0.391, 'time@10': 8.1007}:  10%|█         | 1/10 [00:04<00:36,  4.09s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9822, 'compress@10': 0.2462, 'time@10': 7.246}:  10%|█         | 1/10 [00:10<00:36,  4.09s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9822, 'compress@10': 0.2462, 'time@10': 7.246}:  20%|██        | 2/10 [00:10<00:43,  5.47s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.7099, 'ndcg@10': 0.9405, 'compress@10': 0.2205, 'time@10': 6.7086}:  20%|██        | 2/10 [00:13<00:43,  5.47s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.7099, 'ndcg@10': 0.9405, 'compress@10': 0.2205, 'time@10': 6.7086}:  30%|███       | 3/10 [00:13<00:30,  4.29s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7646, 'ndcg@10': 0.9465, 'compress@10': 0.2702, 'time@10': 6.5578}:  30%|███       | 3/10 [00:19<00:30,  4.29s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7646, 'ndcg@10': 0.9465, 'compress@10': 0.2702, 'time@10': 6.5578}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.009, 'hit_ratio@10': 0.8077, 'ndcg@10': 0.9517, 'compress@10': 0.3462, 'time@10': 7.9163}:  40%|████      | 4/10 [00:26<00:30,  5.02s/it] {'epoch': 48, 'num_users': 5.8, 'loss': 0.009, 'hit_ratio@10': 0.8077, 'ndcg@10': 0.9517, 'compress@10': 0.3462, 'time@10': 7.9163}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9628, 'compress@10': 0.3604, 'time@10': 8.2722}:  50%|█████     | 5/10 [00:36<00:28,  5.63s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9628, 'compress@10': 0.3604, 'time@10': 8.2722}:  60%|██████    | 6/10 [00:36<00:28,  7.15s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.962, 'compress@10': 0.3356, 'time@10': 8.5921}:  60%|██████    | 6/10 [00:41<00:28,  7.15s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.962, 'compress@10': 0.3356, 'time@10': 8.5921}:  70%|███████   | 7/10 [00:41<00:19,  6.54s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9629, 'compress@10': 0.3108, 'time@10': 8.4419}:  70%|███████   | 7/10 [00:49<00:19,  6.54s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9629, 'compress@10': 0.3108, 'time@10': 8.4419}:  80%|████████  | 8/10 [00:49<00:13,  6.83s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.961, 'compress@10': 0.3401, 'time@10': 9.0204}:  80%|████████  | 8/10 [00:55<00:13,  6.83s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.961, 'compress@10': 0.3401, 'time@10': 9.0204}:  90%|█████████ | 9/10 [00:55<00:06,  6.84s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9614, 'compress@10': 0.3372, 'time@10': 9.0826}:  90%|█████████ | 9/10 [01:05<00:06,  6.84s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9614, 'compress@10': 0.3372, 'time@10': 9.0826}: 100%|██████████| 10/10 [01:05<00:00,  7.72s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9614, 'compress@10': 0.3372, 'time@10': 9.0826}: 100%|██████████| 10/10 [01:05<00:00,  6.56s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.014700046509579567
Avg hit ratio: 0.8696238960058993
Avg ndcg: 0.9613637924315895
Avg compression ratio: 0.3372458466356024
Avg train time: 9.082619333267212
Std train time: 2.7235755211067736
[0.3500000000000001, 0.07, 0.030000000000000006, 0.39000000000000007, 0.6299999999999999, 0.4300000000000001, 0.14999999999999997, 0.10999999999999996, 0.5700000000000001, 0.31000000000000005]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0054, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.93, 'compress@10': 0.3842, 'time@10': 7.8131}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0054, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.93, 'compress@10': 0.3842, 'time@10': 7.8131}:  10%|█         | 1/10 [00:03<00:35,  3.94s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0056, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9489, 'compress@10': 0.2421, 'time@10': 7.0152}:  10%|█         | 1/10 [00:10<00:35,  3.94s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0056, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9489, 'compress@10': 0.2421, 'time@10': 7.0152}:  20%|██        | 2/10 [00:10<00:42,  5.30s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0037, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9183, 'compress@10': 0.2176, 'time@10': 6.4318}:  20%|██        | 2/10 [00:12<00:42,  5.30s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0037, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9183, 'compress@10': 0.2176, 'time@10': 6.4318}:  30%|███       | 3/10 [00:12<00:28,  4.10s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.9298, 'compress@10': 0.2661, 'time@10': 6.3207}:  30%|███       | 3/10 [00:18<00:28,  4.10s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.9298, 'compress@10': 0.2661, 'time@10': 6.3207}:  40%|████      | 4/10 [00:18<00:29,  4.86s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0062, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9379, 'compress@10': 0.3404, 'time@10': 7.6889}:  40%|████      | 4/10 [00:25<00:29,  4.86s/it] {'epoch': 49, 'num_users': 5.8, 'loss': 0.0062, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9379, 'compress@10': 0.3404, 'time@10': 7.6889}:  50%|█████     | 5/10 [00:25<00:27,  5.50s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0057, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9444, 'compress@10': 0.3574, 'time@10': 8.0659}:  50%|█████     | 5/10 [00:35<00:27,  5.50s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0057, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9444, 'compress@10': 0.3574, 'time@10': 8.0659}:  60%|██████    | 6/10 [00:35<00:28,  7.02s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0061, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9463, 'compress@10': 0.3327, 'time@10': 8.4426}:  60%|██████    | 6/10 [00:40<00:28,  7.02s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0061, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9463, 'compress@10': 0.3327, 'time@10': 8.4426}:  70%|███████   | 7/10 [00:40<00:19,  6.49s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0065, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9482, 'compress@10': 0.308, 'time@10': 8.325}:  70%|███████   | 7/10 [00:48<00:19,  6.49s/it]   {'epoch': 49, 'num_users': 6.125, 'loss': 0.0065, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9482, 'compress@10': 0.308, 'time@10': 8.325}:  80%|████████  | 8/10 [00:48<00:13,  6.82s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0086, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9642, 'compress@10': 0.3385, 'time@10': 8.877}:  80%|████████  | 8/10 [00:55<00:13,  6.82s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0086, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9642, 'compress@10': 0.3385, 'time@10': 8.877}:  90%|█████████ | 9/10 [00:55<00:06,  6.78s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0079, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9655, 'compress@10': 0.3372, 'time@10': 8.9287}:  90%|█████████ | 9/10 [01:04<00:06,  6.78s/it]  {'epoch': 49, 'num_users': 6.3, 'loss': 0.0079, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9655, 'compress@10': 0.3372, 'time@10': 8.9287}: 100%|██████████| 10/10 [01:04<00:00,  7.60s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0079, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9655, 'compress@10': 0.3372, 'time@10': 8.9287}: 100%|██████████| 10/10 [01:04<00:00,  6.45s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.007944862788365625
Avg hit ratio: 0.8945906138758432
Avg ndcg: 0.9654889318809742
Avg compression ratio: 0.3372061147960322
Avg train time: 8.928674960136414
Std train time: 2.7217269800246116
[0.3431372549019609, 0.06862745098039216, 0.02941176470588236, 0.40196078431372556, 0.6176470588235293, 0.4215686274509805, 0.14705882352941174, 0.12745098039215683, 0.5784313725490197, 0.303921568627451]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
