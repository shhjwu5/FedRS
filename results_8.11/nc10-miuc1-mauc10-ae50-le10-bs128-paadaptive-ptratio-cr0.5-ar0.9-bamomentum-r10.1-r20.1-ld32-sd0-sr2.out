  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2115, 'hit_ratio@10': 0.4211, 'ndcg@10': 0.5222, 'compress@10': 0.4835, 'time@10': 5.6011}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2115, 'hit_ratio@10': 0.4211, 'ndcg@10': 0.5222, 'compress@10': 0.4835, 'time@10': 5.6011}:  10%|█         | 1/10 [00:02<00:25,  2.84s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1525, 'hit_ratio@10': 0.5654, 'ndcg@10': 0.5755, 'compress@10': 0.4574, 'time@10': 4.8546}:  10%|█         | 1/10 [00:06<00:25,  2.84s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1525, 'hit_ratio@10': 0.5654, 'ndcg@10': 0.5755, 'compress@10': 0.4574, 'time@10': 4.8546}:  20%|██        | 2/10 [00:06<00:28,  3.61s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8172, 'hit_ratio@10': 0.5674, 'ndcg@10': 0.3836, 'compress@10': 0.4897, 'time@10': 3.7837}:  20%|██        | 2/10 [00:07<00:28,  3.61s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8172, 'hit_ratio@10': 0.5674, 'ndcg@10': 0.3836, 'compress@10': 0.4897, 'time@10': 3.7837}:  30%|███       | 3/10 [00:07<00:16,  2.36s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6459, 'hit_ratio@10': 0.6041, 'ndcg@10': 0.429, 'compress@10': 0.4794, 'time@10': 3.7615}:  30%|███       | 3/10 [00:11<00:16,  2.36s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.6459, 'hit_ratio@10': 0.6041, 'ndcg@10': 0.429, 'compress@10': 0.4794, 'time@10': 3.7615}:  40%|████      | 4/10 [00:11<00:17,  2.90s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5358, 'hit_ratio@10': 0.6473, 'ndcg@10': 0.4934, 'compress@10': 0.4787, 'time@10': 5.7015}:  40%|████      | 4/10 [00:18<00:17,  2.90s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5358, 'hit_ratio@10': 0.6473, 'ndcg@10': 0.4934, 'compress@10': 0.4787, 'time@10': 5.7015}:  50%|█████     | 5/10 [00:18<00:21,  4.30s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4615, 'hit_ratio@10': 0.6505, 'ndcg@10': 0.5374, 'compress@10': 0.4612, 'time@10': 5.7621}:  50%|█████     | 5/10 [00:24<00:21,  4.30s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4615, 'hit_ratio@10': 0.6505, 'ndcg@10': 0.5374, 'compress@10': 0.4612, 'time@10': 5.7621}:  60%|██████    | 6/10 [00:24<00:19,  4.92s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4161, 'hit_ratio@10': 0.6433, 'ndcg@10': 0.5372, 'compress@10': 0.465, 'time@10': 5.8824}:  60%|██████    | 6/10 [00:27<00:19,  4.92s/it] {'epoch': 0, 'num_users': 6.2857, 'loss': 0.4161, 'hit_ratio@10': 0.6433, 'ndcg@10': 0.5372, 'compress@10': 0.465, 'time@10': 5.8824}:  70%|███████   | 7/10 [00:27<00:13,  4.40s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3724, 'hit_ratio@10': 0.6772, 'ndcg@10': 0.5651, 'compress@10': 0.4774, 'time@10': 5.7294}:  70%|███████   | 7/10 [00:32<00:13,  4.40s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3724, 'hit_ratio@10': 0.6772, 'ndcg@10': 0.5651, 'compress@10': 0.4774, 'time@10': 5.7294}:  80%|████████  | 8/10 [00:32<00:08,  4.50s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3383, 'hit_ratio@10': 0.6876, 'ndcg@10': 0.6019, 'compress@10': 0.4703, 'time@10': 6.1419}:  80%|████████  | 8/10 [00:37<00:08,  4.50s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3383, 'hit_ratio@10': 0.6876, 'ndcg@10': 0.6019, 'compress@10': 0.4703, 'time@10': 6.1419}:  90%|█████████ | 9/10 [00:37<00:04,  4.58s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3106, 'hit_ratio@10': 0.7121, 'ndcg@10': 0.62, 'compress@10': 0.47, 'time@10': 6.1156}:  90%|█████████ | 9/10 [00:43<00:04,  4.58s/it]       {'epoch': 0, 'num_users': 6.3, 'loss': 0.3106, 'hit_ratio@10': 0.7121, 'ndcg@10': 0.62, 'compress@10': 0.47, 'time@10': 6.1156}: 100%|██████████| 10/10 [00:43<00:00,  4.99s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3106, 'hit_ratio@10': 0.7121, 'ndcg@10': 0.62, 'compress@10': 0.47, 'time@10': 6.1156}: 100%|██████████| 10/10 [00:43<00:00,  4.32s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.3105650301650315
Avg hit ratio: 0.7120643470847206
Avg ndcg: 0.6199697713910142
Avg compression ratio: 0.46996313021095987
Avg train time: 6.1155674934387205
Std train time: 3.124236617997694
[0.25, 0.25, 0.75, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0576, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8289, 'compress@10': 0.0608, 'time@10': 4.8091}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0576, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8289, 'compress@10': 0.0608, 'time@10': 4.8091}:  10%|█         | 1/10 [00:02<00:22,  2.44s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0557, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8431, 'compress@10': 0.0503, 'time@10': 4.4672}:  10%|█         | 1/10 [00:06<00:22,  2.44s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0557, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8431, 'compress@10': 0.0503, 'time@10': 4.4672}:  20%|██        | 2/10 [00:06<00:27,  3.46s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0477, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.802, 'compress@10': 0.3644, 'time@10': 3.5598}:  20%|██        | 2/10 [00:07<00:27,  3.46s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.0477, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.802, 'compress@10': 0.3644, 'time@10': 3.5598}:  30%|███       | 3/10 [00:07<00:16,  2.29s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0484, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8125, 'compress@10': 0.2847, 'time@10': 3.5838}:  30%|███       | 3/10 [00:11<00:16,  2.29s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0484, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8125, 'compress@10': 0.2847, 'time@10': 3.5838}:  40%|████      | 4/10 [00:11<00:17,  2.85s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0563, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8068, 'compress@10': 0.2337, 'time@10': 5.2863}:  40%|████      | 4/10 [00:17<00:17,  2.85s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0563, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8068, 'compress@10': 0.2337, 'time@10': 5.2863}:  50%|█████     | 5/10 [00:17<00:20,  4.02s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0601, 'hit_ratio@10': 0.7803, 'ndcg@10': 0.8073, 'compress@10': 0.1998, 'time@10': 5.4203}:  50%|█████     | 5/10 [00:23<00:20,  4.02s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0601, 'hit_ratio@10': 0.7803, 'ndcg@10': 0.8073, 'compress@10': 0.1998, 'time@10': 5.4203}:  60%|██████    | 6/10 [00:23<00:18,  4.73s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.058, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.8158, 'compress@10': 0.1782, 'time@10': 5.583}:  60%|██████    | 6/10 [00:26<00:18,  4.73s/it]  {'epoch': 1, 'num_users': 6.2857, 'loss': 0.058, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.8158, 'compress@10': 0.1782, 'time@10': 5.583}:  70%|███████   | 7/10 [00:26<00:12,  4.27s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0555, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8233, 'compress@10': 0.1604, 'time@10': 5.4608}:  70%|███████   | 7/10 [00:31<00:12,  4.27s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0555, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8233, 'compress@10': 0.1604, 'time@10': 5.4608}:  80%|████████  | 8/10 [00:31<00:08,  4.39s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0533, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.8331, 'compress@10': 0.1469, 'time@10': 5.7936}:  80%|████████  | 8/10 [00:35<00:08,  4.39s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0533, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.8331, 'compress@10': 0.1469, 'time@10': 5.7936}:  90%|█████████ | 9/10 [00:35<00:04,  4.35s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0527, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8348, 'compress@10': 0.1355, 'time@10': 5.7953}:  90%|█████████ | 9/10 [00:41<00:04,  4.35s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0527, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8348, 'compress@10': 0.1355, 'time@10': 5.7953}: 100%|██████████| 10/10 [00:41<00:00,  4.82s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0527, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8348, 'compress@10': 0.1355, 'time@10': 5.7953}: 100%|██████████| 10/10 [00:41<00:00,  4.15s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.052655847343684545
Avg hit ratio: 0.8201937296809962
Avg ndcg: 0.8347606432847803
Avg compression ratio: 0.13552977042240397
Avg train time: 5.795343375205993
Std train time: 2.71307927201235
[0.16666666666666669, 0.16666666666666669, 0.5, 0.16666666666666669, 0.5, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8427, 'compress@10': 0.0551, 'time@10': 4.6868}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8427, 'compress@10': 0.0551, 'time@10': 4.6868}:  10%|█         | 1/10 [00:02<00:21,  2.38s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.7657, 'ndcg@10': 0.8496, 'compress@10': 0.0447, 'time@10': 4.4434}:  10%|█         | 1/10 [00:06<00:21,  2.38s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.7657, 'ndcg@10': 0.8496, 'compress@10': 0.0447, 'time@10': 4.4434}:  20%|██        | 2/10 [00:06<00:27,  3.48s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0354, 'hit_ratio@10': 0.7486, 'ndcg@10': 0.85, 'compress@10': 0.1986, 'time@10': 3.6209}:  20%|██        | 2/10 [00:07<00:27,  3.48s/it]  {'epoch': 2, 'num_users': 5.0, 'loss': 0.0354, 'hit_ratio@10': 0.7486, 'ndcg@10': 0.85, 'compress@10': 0.1986, 'time@10': 3.6209}:  30%|███       | 3/10 [00:07<00:16,  2.37s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0391, 'hit_ratio@10': 0.7846, 'ndcg@10': 0.848, 'compress@10': 0.1585, 'time@10': 3.6483}:  30%|███       | 3/10 [00:11<00:16,  2.37s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0391, 'hit_ratio@10': 0.7846, 'ndcg@10': 0.848, 'compress@10': 0.1585, 'time@10': 3.6483}:  40%|████      | 4/10 [00:11<00:17,  2.92s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0487, 'hit_ratio@10': 0.7957, 'ndcg@10': 0.8356, 'compress@10': 0.2111, 'time@10': 5.1022}:  40%|████      | 4/10 [00:16<00:17,  2.92s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0487, 'hit_ratio@10': 0.7957, 'ndcg@10': 0.8356, 'compress@10': 0.2111, 'time@10': 5.1022}:  50%|█████     | 5/10 [00:16<00:19,  3.85s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0534, 'hit_ratio@10': 0.7853, 'ndcg@10': 0.8332, 'compress@10': 0.1801, 'time@10': 5.2754}:  50%|█████     | 5/10 [00:23<00:19,  3.85s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0534, 'hit_ratio@10': 0.7853, 'ndcg@10': 0.8332, 'compress@10': 0.1801, 'time@10': 5.2754}:  60%|██████    | 6/10 [00:23<00:18,  4.64s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0523, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8395, 'compress@10': 0.1605, 'time@10': 5.4648}:  60%|██████    | 6/10 [00:26<00:18,  4.64s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0523, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8395, 'compress@10': 0.1605, 'time@10': 5.4648}:  70%|███████   | 7/10 [00:26<00:12,  4.22s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0518, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.8419, 'compress@10': 0.1444, 'time@10': 5.3626}:  70%|███████   | 7/10 [00:31<00:12,  4.22s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0518, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.8419, 'compress@10': 0.1444, 'time@10': 5.3626}:  80%|████████  | 8/10 [00:31<00:08,  4.37s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0506, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.851, 'compress@10': 0.1317, 'time@10': 5.7147}:  80%|████████  | 8/10 [00:35<00:08,  4.37s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0506, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.851, 'compress@10': 0.1317, 'time@10': 5.7147}:  90%|█████████ | 9/10 [00:35<00:04,  4.35s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.851, 'compress@10': 0.1212, 'time@10': 5.7223}:  90%|█████████ | 9/10 [00:41<00:04,  4.35s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.851, 'compress@10': 0.1212, 'time@10': 5.7223}: 100%|██████████| 10/10 [00:41<00:00,  4.81s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.851, 'compress@10': 0.1212, 'time@10': 5.7223}: 100%|██████████| 10/10 [00:41<00:00,  4.13s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.05013871732630537
Avg hit ratio: 0.834656068323301
Avg ndcg: 0.8509982534691828
Avg compression ratio: 0.12119460376496735
Avg train time: 5.722283577919006
Std train time: 2.4164260809978946
[0.125, 0.125, 0.375, 0.125, 0.625, 0.125, 0.125, 0.125, 0.125, 0.125]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.0538, 'time@10': 4.7687}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.0538, 'time@10': 4.7687}:  10%|█         | 1/10 [00:02<00:21,  2.42s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8456, 'compress@10': 0.0435, 'time@10': 4.488}:  10%|█         | 1/10 [00:06<00:21,  2.42s/it]  {'epoch': 3, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8456, 'compress@10': 0.0435, 'time@10': 4.488}:  20%|██        | 2/10 [00:06<00:27,  3.50s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0337, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8494, 'compress@10': 0.0956, 'time@10': 3.7142}:  20%|██        | 2/10 [00:07<00:27,  3.50s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0337, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8494, 'compress@10': 0.0956, 'time@10': 3.7142}:  30%|███       | 3/10 [00:07<00:16,  2.41s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0387, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.851, 'compress@10': 0.0809, 'time@10': 3.7213}:  30%|███       | 3/10 [00:11<00:16,  2.41s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0387, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.851, 'compress@10': 0.0809, 'time@10': 3.7213}:  40%|████      | 4/10 [00:11<00:17,  2.95s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0482, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8395, 'compress@10': 0.2515, 'time@10': 4.9011}:  40%|████      | 4/10 [00:16<00:17,  2.95s/it] {'epoch': 3, 'num_users': 5.8, 'loss': 0.0482, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8395, 'compress@10': 0.2515, 'time@10': 4.9011}:  50%|█████     | 5/10 [00:16<00:18,  3.64s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0524, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8364, 'compress@10': 0.2135, 'time@10': 5.1043}:  50%|█████     | 5/10 [00:22<00:18,  3.64s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0524, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8364, 'compress@10': 0.2135, 'time@10': 5.1043}:  60%|██████    | 6/10 [00:22<00:17,  4.50s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0511, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8397, 'compress@10': 0.1889, 'time@10': 5.3303}:  60%|██████    | 6/10 [00:25<00:17,  4.50s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0511, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8397, 'compress@10': 0.1889, 'time@10': 5.3303}:  70%|███████   | 7/10 [00:25<00:12,  4.13s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.052, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8392, 'compress@10': 0.169, 'time@10': 5.2467}:  70%|███████   | 7/10 [00:30<00:12,  4.13s/it]   {'epoch': 3, 'num_users': 6.125, 'loss': 0.052, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8392, 'compress@10': 0.169, 'time@10': 5.2467}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0503, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8473, 'compress@10': 0.1535, 'time@10': 5.6078}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0503, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8473, 'compress@10': 0.1535, 'time@10': 5.6078}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8469, 'compress@10': 0.1405, 'time@10': 5.62}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]     {'epoch': 3, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8469, 'compress@10': 0.1405, 'time@10': 5.62}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8469, 'compress@10': 0.1405, 'time@10': 5.62}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.049948328764030867
Avg hit ratio: 0.8233299034487491
Avg ndcg: 0.8469418938009217
Avg compression ratio: 0.14054354264130722
Avg train time: 5.6200432777404785
Std train time: 2.1159000541799022
[0.1, 0.1, 0.3, 0.1, 0.7, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.0534, 'time@10': 4.6877}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.0534, 'time@10': 4.6877}:  10%|█         | 1/10 [00:02<00:21,  2.38s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8465, 'compress@10': 0.0431, 'time@10': 4.4284}:  10%|█         | 1/10 [00:06<00:21,  2.38s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8465, 'compress@10': 0.0431, 'time@10': 4.4284}:  20%|██        | 2/10 [00:06<00:27,  3.46s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.85, 'compress@10': 0.0808, 'time@10': 3.7217}:  20%|██        | 2/10 [00:07<00:27,  3.46s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.85, 'compress@10': 0.0808, 'time@10': 3.7217}:  30%|███       | 3/10 [00:07<00:16,  2.42s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0393, 'hit_ratio@10': 0.774, 'ndcg@10': 0.842, 'compress@10': 0.0697, 'time@10': 3.7181}:  30%|███       | 3/10 [00:11<00:16,  2.42s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0393, 'hit_ratio@10': 0.774, 'ndcg@10': 0.842, 'compress@10': 0.0697, 'time@10': 3.7181}:  40%|████      | 4/10 [00:11<00:17,  2.95s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0488, 'hit_ratio@10': 0.7872, 'ndcg@10': 0.8306, 'compress@10': 0.2522, 'time@10': 4.6084}:  40%|████      | 4/10 [00:15<00:17,  2.95s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0488, 'hit_ratio@10': 0.7872, 'ndcg@10': 0.8306, 'compress@10': 0.2522, 'time@10': 4.6084}:  50%|█████     | 5/10 [00:15<00:16,  3.37s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0523, 'hit_ratio@10': 0.7893, 'ndcg@10': 0.8294, 'compress@10': 0.214, 'time@10': 4.8554}:  50%|█████     | 5/10 [00:21<00:16,  3.37s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0523, 'hit_ratio@10': 0.7893, 'ndcg@10': 0.8294, 'compress@10': 0.214, 'time@10': 4.8554}:  60%|██████    | 6/10 [00:21<00:17,  4.31s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0518, 'hit_ratio@10': 0.8137, 'ndcg@10': 0.8356, 'compress@10': 0.1893, 'time@10': 4.9858}:  60%|██████    | 6/10 [00:24<00:17,  4.31s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0518, 'hit_ratio@10': 0.8137, 'ndcg@10': 0.8356, 'compress@10': 0.1893, 'time@10': 4.9858}:  70%|███████   | 7/10 [00:24<00:11,  3.86s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0521, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.836, 'compress@10': 0.1693, 'time@10': 4.9088}:  70%|███████   | 7/10 [00:29<00:11,  3.86s/it]  {'epoch': 4, 'num_users': 6.125, 'loss': 0.0521, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.836, 'compress@10': 0.1693, 'time@10': 4.9088}:  80%|████████  | 8/10 [00:29<00:08,  4.03s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0513, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8471, 'compress@10': 0.1537, 'time@10': 5.1993}:  80%|████████  | 8/10 [00:32<00:08,  4.03s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0513, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8471, 'compress@10': 0.1537, 'time@10': 5.1993}:  90%|█████████ | 9/10 [00:32<00:03,  3.96s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0506, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8472, 'compress@10': 0.1407, 'time@10': 5.2587}:  90%|█████████ | 9/10 [00:38<00:03,  3.96s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0506, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8472, 'compress@10': 0.1407, 'time@10': 5.2587}: 100%|██████████| 10/10 [00:38<00:00,  4.54s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0506, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8472, 'compress@10': 0.1407, 'time@10': 5.2587}: 100%|██████████| 10/10 [00:38<00:00,  3.88s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.05063279002068825
Avg hit ratio: 0.8313457764646219
Avg ndcg: 0.8471637586467053
Avg compression ratio: 0.14071266409159186
Avg train time: 5.258693814277649
Std train time: 1.6808332464873748
[0.08333333333333334, 0.08333333333333334, 0.25, 0.08333333333333334, 0.75, 0.08333333333333334, 0.08333333333333334, 0.08333333333333334, 0.08333333333333334, 0.08333333333333334]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8627, 'compress@10': 0.0532, 'time@10': 4.8865}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8627, 'compress@10': 0.0532, 'time@10': 4.8865}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8578, 'compress@10': 0.0429, 'time@10': 4.5495}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it] {'epoch': 5, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8578, 'compress@10': 0.0429, 'time@10': 4.5495}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8576, 'compress@10': 0.0782, 'time@10': 3.8307}:  20%|██        | 2/10 [00:07<00:28,  3.52s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8576, 'compress@10': 0.0782, 'time@10': 3.8307}:  30%|███       | 3/10 [00:07<00:17,  2.48s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8483, 'compress@10': 0.0677, 'time@10': 3.7989}:  30%|███       | 3/10 [00:11<00:17,  2.48s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8483, 'compress@10': 0.0677, 'time@10': 3.7989}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0469, 'hit_ratio@10': 0.8158, 'ndcg@10': 0.8354, 'compress@10': 0.2528, 'time@10': 4.6815}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0469, 'hit_ratio@10': 0.8158, 'ndcg@10': 0.8354, 'compress@10': 0.2528, 'time@10': 4.6815}:  50%|█████     | 5/10 [00:15<00:16,  3.40s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0501, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8338, 'compress@10': 0.2145, 'time@10': 4.9179}:  50%|█████     | 5/10 [00:21<00:16,  3.40s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0501, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8338, 'compress@10': 0.2145, 'time@10': 4.9179}:  60%|██████    | 6/10 [00:21<00:17,  4.33s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.049, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8361, 'compress@10': 0.1896, 'time@10': 5.1618}:  60%|██████    | 6/10 [00:25<00:17,  4.33s/it] {'epoch': 5, 'num_users': 6.2857, 'loss': 0.049, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8361, 'compress@10': 0.1896, 'time@10': 5.1618}:  70%|███████   | 7/10 [00:25<00:12,  4.01s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0489, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8369, 'compress@10': 0.1696, 'time@10': 5.0996}:  70%|███████   | 7/10 [00:30<00:12,  4.01s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0489, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8369, 'compress@10': 0.1696, 'time@10': 5.0996}:  80%|████████  | 8/10 [00:30<00:08,  4.23s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8516, 'compress@10': 0.1539, 'time@10': 5.4706}:  80%|████████  | 8/10 [00:34<00:08,  4.23s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8516, 'compress@10': 0.1539, 'time@10': 5.4706}:  90%|█████████ | 9/10 [00:34<00:04,  4.24s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0492, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8524, 'compress@10': 0.1409, 'time@10': 5.4887}:  90%|█████████ | 9/10 [00:39<00:04,  4.24s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0492, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8524, 'compress@10': 0.1409, 'time@10': 5.4887}: 100%|██████████| 10/10 [00:39<00:00,  4.69s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0492, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8524, 'compress@10': 0.1409, 'time@10': 5.4887}: 100%|██████████| 10/10 [00:39<00:00,  4.00s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04921115946249136
Avg hit ratio: 0.8557902209090663
Avg ndcg: 0.8524161684081062
Avg compression ratio: 0.14088184127750278
Avg train time: 5.488679265975952
Std train time: 1.8233830957001944
[0.07142857142857144, 0.07142857142857144, 0.2142857142857143, 0.07142857142857144, 0.7857142857142857, 0.07142857142857144, 0.07142857142857144, 0.07142857142857144, 0.07142857142857144, 0.07142857142857144]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8399, 'compress@10': 0.053, 'time@10': 4.8842}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8399, 'compress@10': 0.053, 'time@10': 4.8842}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8439, 'compress@10': 0.0427, 'time@10': 4.5052}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8439, 'compress@10': 0.0427, 'time@10': 4.5052}:  20%|██        | 2/10 [00:06<00:27,  3.47s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8483, 'compress@10': 0.0773, 'time@10': 3.8811}:  20%|██        | 2/10 [00:08<00:27,  3.47s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8483, 'compress@10': 0.0773, 'time@10': 3.8811}:  30%|███       | 3/10 [00:08<00:17,  2.51s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8427, 'compress@10': 0.067, 'time@10': 3.8279}:  30%|███       | 3/10 [00:11<00:17,  2.51s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8427, 'compress@10': 0.067, 'time@10': 3.8279}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0453, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8314, 'compress@10': 0.2528, 'time@10': 4.6922}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0453, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8314, 'compress@10': 0.2528, 'time@10': 4.6922}:  50%|█████     | 5/10 [00:15<00:16,  3.39s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0479, 'hit_ratio@10': 0.833, 'ndcg@10': 0.8319, 'compress@10': 0.2145, 'time@10': 4.9293}:  50%|█████     | 5/10 [00:21<00:16,  3.39s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0479, 'hit_ratio@10': 0.833, 'ndcg@10': 0.8319, 'compress@10': 0.2145, 'time@10': 4.9293}:  60%|██████    | 6/10 [00:21<00:17,  4.33s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0482, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8388, 'compress@10': 0.1896, 'time@10': 5.1796}:  60%|██████    | 6/10 [00:25<00:17,  4.33s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0482, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8388, 'compress@10': 0.1896, 'time@10': 5.1796}:  70%|███████   | 7/10 [00:25<00:12,  4.02s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.048, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8418, 'compress@10': 0.1695, 'time@10': 5.1082}:  70%|███████   | 7/10 [00:30<00:12,  4.02s/it]  {'epoch': 6, 'num_users': 6.125, 'loss': 0.048, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8418, 'compress@10': 0.1695, 'time@10': 5.1082}:  80%|████████  | 8/10 [00:30<00:08,  4.22s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.047, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8491, 'compress@10': 0.1539, 'time@10': 5.4908}:  80%|████████  | 8/10 [00:34<00:08,  4.22s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.047, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8491, 'compress@10': 0.1539, 'time@10': 5.4908}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0462, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8504, 'compress@10': 0.1408, 'time@10': 5.5323}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]  {'epoch': 6, 'num_users': 6.3, 'loss': 0.0462, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8504, 'compress@10': 0.1408, 'time@10': 5.5323}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0462, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8504, 'compress@10': 0.1408, 'time@10': 5.5323}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04615734536664684
Avg hit ratio: 0.8547072716003108
Avg ndcg: 0.8503838967305544
Avg compression ratio: 0.14081587640439236
Avg train time: 5.532337737083435
Std train time: 1.8135986637127604
[0.06250000000000001, 0.06250000000000001, 0.1875, 0.06250000000000001, 0.8125, 0.06250000000000001, 0.06250000000000001, 0.06250000000000001, 0.06250000000000001, 0.06250000000000001]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.865, 'compress@10': 0.0529, 'time@10': 5.0227}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.865, 'compress@10': 0.0529, 'time@10': 5.0227}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8642, 'compress@10': 0.0427, 'time@10': 4.5691}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8642, 'compress@10': 0.0427, 'time@10': 4.5691}:  20%|██        | 2/10 [00:06<00:28,  3.50s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8618, 'compress@10': 0.0768, 'time@10': 3.9678}:  20%|██        | 2/10 [00:08<00:28,  3.50s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8618, 'compress@10': 0.0768, 'time@10': 3.9678}:  30%|███       | 3/10 [00:08<00:17,  2.55s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8558, 'compress@10': 0.0666, 'time@10': 3.9141}:  30%|███       | 3/10 [00:11<00:17,  2.55s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8558, 'compress@10': 0.0666, 'time@10': 3.9141}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0433, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8418, 'compress@10': 0.2528, 'time@10': 4.7875}:  40%|████      | 4/10 [00:16<00:18,  3.04s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.0433, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8418, 'compress@10': 0.2528, 'time@10': 4.7875}:  50%|█████     | 5/10 [00:16<00:17,  3.45s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0454, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8411, 'compress@10': 0.2144, 'time@10': 5.0136}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0454, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8411, 'compress@10': 0.2144, 'time@10': 5.0136}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0445, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8424, 'compress@10': 0.1895, 'time@10': 5.254}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it] {'epoch': 7, 'num_users': 6.2857, 'loss': 0.0445, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8424, 'compress@10': 0.1895, 'time@10': 5.254}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0447, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8441, 'compress@10': 0.1694, 'time@10': 5.1876}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0447, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8441, 'compress@10': 0.1694, 'time@10': 5.1876}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.043, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8531, 'compress@10': 0.1538, 'time@10': 5.5957}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.043, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8531, 'compress@10': 0.1538, 'time@10': 5.5957}:  90%|█████████ | 9/10 [00:34<00:04,  4.34s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0421, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.8549, 'compress@10': 0.1407, 'time@10': 5.5979}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]  {'epoch': 7, 'num_users': 6.3, 'loss': 0.0421, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.8549, 'compress@10': 0.1407, 'time@10': 5.5979}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0421, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.8549, 'compress@10': 0.1407, 'time@10': 5.5979}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04213601427477943
Avg hit ratio: 0.8675644144574536
Avg ndcg: 0.8549062434742529
Avg compression ratio: 0.14071864933369188
Avg train time: 5.59787425994873
Std train time: 1.8459209698646108
[0.055555555555555566, 0.055555555555555566, 0.16666666666666666, 0.055555555555555566, 0.8333333333333334, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8388, 'compress@10': 0.0529, 'time@10': 5.3427}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8388, 'compress@10': 0.0529, 'time@10': 5.3427}:  10%|█         | 1/10 [00:02<00:24,  2.71s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8525, 'compress@10': 0.0426, 'time@10': 4.683}:  10%|█         | 1/10 [00:06<00:24,  2.71s/it] {'epoch': 8, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8525, 'compress@10': 0.0426, 'time@10': 4.683}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8541, 'compress@10': 0.0765, 'time@10': 4.0811}:  20%|██        | 2/10 [00:08<00:28,  3.51s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8541, 'compress@10': 0.0765, 'time@10': 4.0811}:  30%|███       | 3/10 [00:08<00:18,  2.58s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8487, 'compress@10': 0.0663, 'time@10': 3.9871}:  30%|███       | 3/10 [00:11<00:18,  2.58s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8487, 'compress@10': 0.0663, 'time@10': 3.9871}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0419, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8361, 'compress@10': 0.2527, 'time@10': 4.8498}:  40%|████      | 4/10 [00:16<00:18,  3.04s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0419, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8361, 'compress@10': 0.2527, 'time@10': 4.8498}:  50%|█████     | 5/10 [00:16<00:17,  3.46s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0435, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8372, 'compress@10': 0.2143, 'time@10': 5.0635}:  50%|█████     | 5/10 [00:22<00:17,  3.46s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0435, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8372, 'compress@10': 0.2143, 'time@10': 5.0635}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0432, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8459, 'compress@10': 0.1894, 'time@10': 5.2835}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0432, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8459, 'compress@10': 0.1894, 'time@10': 5.2835}:  70%|███████   | 7/10 [00:25<00:12,  4.04s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0432, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8465, 'compress@10': 0.1694, 'time@10': 5.2029}:  70%|███████   | 7/10 [00:30<00:12,  4.04s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0432, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8465, 'compress@10': 0.1694, 'time@10': 5.2029}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0431, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8641, 'compress@10': 0.1537, 'time@10': 5.5742}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0431, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8641, 'compress@10': 0.1537, 'time@10': 5.5742}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0427, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8654, 'compress@10': 0.1406, 'time@10': 5.5839}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]  {'epoch': 8, 'num_users': 6.3, 'loss': 0.0427, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8654, 'compress@10': 0.1406, 'time@10': 5.5839}: 100%|██████████| 10/10 [00:40<00:00,  4.71s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0427, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8654, 'compress@10': 0.1406, 'time@10': 5.5839}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04270697076567308
Avg hit ratio: 0.8649134076638321
Avg ndcg: 0.8653952077305312
Avg compression ratio: 0.14064048166682233
Avg train time: 5.583881664276123
Std train time: 1.7813969738486688
[0.05000000000000001, 0.05000000000000001, 0.15, 0.05000000000000001, 0.8500000000000001, 0.05000000000000001, 0.05000000000000001, 0.05000000000000001, 0.05000000000000001, 0.05000000000000001]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.0528, 'time@10': 4.9766}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.0528, 'time@10': 4.9766}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8628, 'compress@10': 0.0425, 'time@10': 4.4768}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it] {'epoch': 9, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8628, 'compress@10': 0.0425, 'time@10': 4.4768}:  20%|██        | 2/10 [00:06<00:27,  3.41s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8609, 'compress@10': 0.0763, 'time@10': 3.9361}:  20%|██        | 2/10 [00:08<00:27,  3.41s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8609, 'compress@10': 0.0763, 'time@10': 3.9361}:  30%|███       | 3/10 [00:08<00:17,  2.52s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8556, 'compress@10': 0.0662, 'time@10': 3.6853}:  30%|███       | 3/10 [00:10<00:17,  2.52s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8556, 'compress@10': 0.0662, 'time@10': 3.6853}:  40%|████      | 4/10 [00:11<00:16,  2.72s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0405, 'hit_ratio@10': 0.8158, 'ndcg@10': 0.8435, 'compress@10': 0.2527, 'time@10': 4.4972}:  40%|████      | 4/10 [00:14<00:16,  2.72s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0405, 'hit_ratio@10': 0.8158, 'ndcg@10': 0.8435, 'compress@10': 0.2527, 'time@10': 4.4972}:  50%|█████     | 5/10 [00:14<00:15,  3.15s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0417, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8443, 'compress@10': 0.2143, 'time@10': 4.6263}:  50%|█████     | 5/10 [00:20<00:15,  3.15s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0417, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8443, 'compress@10': 0.2143, 'time@10': 4.6263}:  60%|██████    | 6/10 [00:20<00:15,  3.88s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0408, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8455, 'compress@10': 0.1894, 'time@10': 4.8529}:  60%|██████    | 6/10 [00:23<00:15,  3.88s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0408, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8455, 'compress@10': 0.1894, 'time@10': 4.8529}:  70%|███████   | 7/10 [00:23<00:10,  3.64s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0401, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8489, 'compress@10': 0.1693, 'time@10': 4.8295}:  70%|███████   | 7/10 [00:28<00:10,  3.64s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0401, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8489, 'compress@10': 0.1693, 'time@10': 4.8295}:  80%|████████  | 8/10 [00:28<00:07,  3.98s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0415, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8756, 'compress@10': 0.1537, 'time@10': 5.2381}:  80%|████████  | 8/10 [00:32<00:07,  3.98s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0415, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8756, 'compress@10': 0.1537, 'time@10': 5.2381}:  90%|█████████ | 9/10 [00:32<00:04,  4.08s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8749, 'compress@10': 0.1406, 'time@10': 5.2891}:  90%|█████████ | 9/10 [00:38<00:04,  4.08s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8749, 'compress@10': 0.1406, 'time@10': 5.2891}: 100%|██████████| 10/10 [00:38<00:00,  4.61s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8749, 'compress@10': 0.1406, 'time@10': 5.2891}: 100%|██████████| 10/10 [00:38<00:00,  3.82s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.040722212879455925
Avg hit ratio: 0.8539359640548095
Avg ndcg: 0.8748900238257475
Avg compression ratio: 0.1406072143185359
Avg train time: 5.289086818695068
Std train time: 1.7645200382598896
[0.04545454545454546, 0.04545454545454546, 0.13636363636363635, 0.04545454545454546, 0.8636363636363638, 0.04545454545454546, 0.04545454545454546, 0.04545454545454546, 0.04545454545454546, 0.04545454545454546]
[10, 10, 20, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8446, 'compress@10': 0.0527, 'time@10': 4.9756}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8446, 'compress@10': 0.0527, 'time@10': 4.9756}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8523, 'compress@10': 0.0425, 'time@10': 4.5212}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8523, 'compress@10': 0.0425, 'time@10': 4.5212}:  20%|██        | 2/10 [00:06<00:27,  3.46s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0288, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8539, 'compress@10': 0.0762, 'time@10': 4.1075}:  20%|██        | 2/10 [00:08<00:27,  3.46s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0288, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8539, 'compress@10': 0.0762, 'time@10': 4.1075}:  30%|███       | 3/10 [00:08<00:18,  2.65s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0347, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8525, 'compress@10': 0.0661, 'time@10': 4.1086}:  30%|███       | 3/10 [00:12<00:18,  2.65s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0347, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8525, 'compress@10': 0.0661, 'time@10': 4.1086}:  40%|████      | 4/10 [00:12<00:19,  3.24s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0417, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8416, 'compress@10': 0.2526, 'time@10': 4.9346}:  40%|████      | 4/10 [00:16<00:19,  3.24s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0417, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8416, 'compress@10': 0.2526, 'time@10': 4.9346}:  50%|█████     | 5/10 [00:16<00:17,  3.57s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.042, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8444, 'compress@10': 0.2143, 'time@10': 5.135}:  50%|█████     | 5/10 [00:22<00:17,  3.57s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.042, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8444, 'compress@10': 0.2143, 'time@10': 5.135}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0414, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8512, 'compress@10': 0.1894, 'time@10': 5.3531}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0414, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8512, 'compress@10': 0.1894, 'time@10': 5.3531}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0396, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8571, 'compress@10': 0.1693, 'time@10': 5.2687}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0396, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8571, 'compress@10': 0.1693, 'time@10': 5.2687}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0402, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8664, 'compress@10': 0.1537, 'time@10': 5.6341}:  80%|████████  | 8/10 [00:35<00:08,  4.30s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0402, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8664, 'compress@10': 0.1537, 'time@10': 5.6341}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0391, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8697, 'compress@10': 0.1406, 'time@10': 5.6463}:  90%|█████████ | 9/10 [00:41<00:04,  4.31s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0391, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8697, 'compress@10': 0.1406, 'time@10': 5.6463}: 100%|██████████| 10/10 [00:41<00:00,  4.77s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0391, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8697, 'compress@10': 0.1406, 'time@10': 5.6463}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.039063261905301
Avg hit ratio: 0.8542086913275367
Avg ndcg: 0.8696898628699747
Avg compression ratio: 0.14058449900363443
Avg train time: 5.646317267417908
Std train time: 1.6825417530619358
[0.04166666666666667, 0.04166666666666667, 0.12499999999999999, 0.04166666666666667, 0.8750000000000001, 0.04166666666666667, 0.04166666666666667, 0.04166666666666667, 0.04166666666666667, 0.04166666666666667]
[10, 10, 20, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0464, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8524, 'compress@10': 0.0527, 'time@10': 4.9933}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0464, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8524, 'compress@10': 0.0527, 'time@10': 4.9933}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8648, 'compress@10': 0.0425, 'time@10': 4.5068}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8648, 'compress@10': 0.0425, 'time@10': 4.5068}:  20%|██        | 2/10 [00:06<00:27,  3.43s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8622, 'compress@10': 0.0761, 'time@10': 4.1004}:  20%|██        | 2/10 [00:08<00:27,  3.43s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8622, 'compress@10': 0.0761, 'time@10': 4.1004}:  30%|███       | 3/10 [00:08<00:18,  2.63s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8716, 'compress@10': 0.066, 'time@10': 4.0938}:  30%|███       | 3/10 [00:12<00:18,  2.63s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8716, 'compress@10': 0.066, 'time@10': 4.0938}:  40%|████      | 4/10 [00:12<00:19,  3.22s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0387, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8574, 'compress@10': 0.2526, 'time@10': 4.9267}:  40%|████      | 4/10 [00:16<00:19,  3.22s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0387, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8574, 'compress@10': 0.2526, 'time@10': 4.9267}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0387, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8587, 'compress@10': 0.2143, 'time@10': 5.1506}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0387, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8587, 'compress@10': 0.2143, 'time@10': 5.1506}:  60%|██████    | 6/10 [00:22<00:17,  4.50s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0377, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.861, 'compress@10': 0.1894, 'time@10': 5.3688}:  60%|██████    | 6/10 [00:26<00:17,  4.50s/it] {'epoch': 11, 'num_users': 6.2857, 'loss': 0.0377, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.861, 'compress@10': 0.1894, 'time@10': 5.3688}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0366, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8666, 'compress@10': 0.1693, 'time@10': 5.2829}:  70%|███████   | 7/10 [00:30<00:12,  4.13s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0366, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8666, 'compress@10': 0.1693, 'time@10': 5.2829}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0354, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8729, 'compress@10': 0.1537, 'time@10': 5.6233}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0354, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8729, 'compress@10': 0.1537, 'time@10': 5.6233}:  90%|█████████ | 9/10 [00:35<00:04,  4.29s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0353, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8729, 'compress@10': 0.1406, 'time@10': 5.6368}:  90%|█████████ | 9/10 [00:41<00:04,  4.29s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0353, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8729, 'compress@10': 0.1406, 'time@10': 5.6368}: 100%|██████████| 10/10 [00:41<00:00,  4.76s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0353, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8729, 'compress@10': 0.1406, 'time@10': 5.6368}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03527132317295265
Avg hit ratio: 0.864682694027346
Avg ndcg: 0.8728764692816817
Avg compression ratio: 0.14057589725938166
Avg train time: 5.636811399459839
Std train time: 1.6617510125442323
[0.038461538461538464, 0.038461538461538464, 0.11538461538461538, 0.038461538461538464, 0.8846153846153847, 0.038461538461538464, 0.038461538461538464, 0.038461538461538464, 0.038461538461538464, 0.038461538461538464]
[10, 10, 20, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8525, 'compress@10': 0.0527, 'time@10': 5.0134}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8525, 'compress@10': 0.0527, 'time@10': 5.0134}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8637, 'compress@10': 0.0425, 'time@10': 4.5222}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8637, 'compress@10': 0.0425, 'time@10': 4.5222}:  20%|██        | 2/10 [00:06<00:27,  3.44s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8615, 'compress@10': 0.0761, 'time@10': 4.1181}:  20%|██        | 2/10 [00:08<00:27,  3.44s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8615, 'compress@10': 0.0761, 'time@10': 4.1181}:  30%|███       | 3/10 [00:08<00:18,  2.64s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8696, 'compress@10': 0.066, 'time@10': 4.1158}:  30%|███       | 3/10 [00:12<00:18,  2.64s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8696, 'compress@10': 0.066, 'time@10': 4.1158}:  40%|████      | 4/10 [00:12<00:19,  3.24s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.035, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8563, 'compress@10': 0.2527, 'time@10': 4.934}:  40%|████      | 4/10 [00:16<00:19,  3.24s/it] {'epoch': 12, 'num_users': 5.8, 'loss': 0.035, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8563, 'compress@10': 0.2527, 'time@10': 4.934}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0363, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8567, 'compress@10': 0.2143, 'time@10': 5.1422}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0363, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8567, 'compress@10': 0.2143, 'time@10': 5.1422}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0357, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8626, 'compress@10': 0.1894, 'time@10': 5.3656}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0357, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8626, 'compress@10': 0.1894, 'time@10': 5.3656}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0347, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8673, 'compress@10': 0.1693, 'time@10': 5.2846}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0347, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8673, 'compress@10': 0.1693, 'time@10': 5.2846}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0334, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.8742, 'compress@10': 0.1537, 'time@10': 5.6309}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0334, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.8742, 'compress@10': 0.1537, 'time@10': 5.6309}:  90%|█████████ | 9/10 [00:35<00:04,  4.30s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.8792, 'compress@10': 0.1406, 'time@10': 5.6518}:  90%|█████████ | 9/10 [00:41<00:04,  4.30s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.8792, 'compress@10': 0.1406, 'time@10': 5.6518}: 100%|██████████| 10/10 [00:41<00:00,  4.79s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.8792, 'compress@10': 0.1406, 'time@10': 5.6518}: 100%|██████████| 10/10 [00:41<00:00,  4.11s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03181376893910037
Avg hit ratio: 0.8822055921818232
Avg ndcg: 0.8792044494415399
Avg compression ratio: 0.1405839024001374
Avg train time: 5.651781892776489
Std train time: 1.6519875342199075
[0.03571428571428572, 0.03571428571428572, 0.10714285714285714, 0.03571428571428572, 0.8928571428571429, 0.03571428571428572, 0.03571428571428572, 0.03571428571428572, 0.03571428571428572, 0.03571428571428572]
[10, 10, 20, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8515, 'compress@10': 0.0527, 'time@10': 5.0566}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8515, 'compress@10': 0.0527, 'time@10': 5.0566}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8693, 'compress@10': 0.0425, 'time@10': 4.5471}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8693, 'compress@10': 0.0425, 'time@10': 4.5471}:  20%|██        | 2/10 [00:06<00:27,  3.46s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8652, 'compress@10': 0.076, 'time@10': 4.1347}:  20%|██        | 2/10 [00:08<00:27,  3.46s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8652, 'compress@10': 0.076, 'time@10': 4.1347}:  30%|███       | 3/10 [00:08<00:18,  2.65s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0307, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8803, 'compress@10': 0.066, 'time@10': 4.1238}:  30%|███       | 3/10 [00:12<00:18,  2.65s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0307, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8803, 'compress@10': 0.066, 'time@10': 4.1238}:  40%|████      | 4/10 [00:12<00:19,  3.24s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0367, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.865, 'compress@10': 0.2527, 'time@10': 4.9511}:  40%|████      | 4/10 [00:16<00:19,  3.24s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0367, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.865, 'compress@10': 0.2527, 'time@10': 4.9511}:  50%|█████     | 5/10 [00:16<00:17,  3.57s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0365, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8665, 'compress@10': 0.2143, 'time@10': 5.1446}:  50%|█████     | 5/10 [00:22<00:17,  3.57s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0365, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8665, 'compress@10': 0.2143, 'time@10': 5.1446}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0359, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8701, 'compress@10': 0.1894, 'time@10': 5.3046}:  60%|██████    | 6/10 [00:25<00:17,  4.45s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0359, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8701, 'compress@10': 0.1894, 'time@10': 5.3046}:  70%|███████   | 7/10 [00:25<00:12,  4.03s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0346, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8755, 'compress@10': 0.1693, 'time@10': 5.1521}:  70%|███████   | 7/10 [00:30<00:12,  4.03s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0346, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8755, 'compress@10': 0.1693, 'time@10': 5.1521}:  80%|████████  | 8/10 [00:30<00:08,  4.06s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0336, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8826, 'compress@10': 0.1537, 'time@10': 5.43}:  80%|████████  | 8/10 [00:33<00:08,  4.06s/it] {'epoch': 13, 'num_users': 6.3333, 'loss': 0.0336, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8826, 'compress@10': 0.1537, 'time@10': 5.43}:  90%|█████████ | 9/10 [00:33<00:04,  4.01s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0336, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8806, 'compress@10': 0.1406, 'time@10': 5.4219}:  90%|█████████ | 9/10 [00:39<00:04,  4.01s/it] {'epoch': 13, 'num_users': 6.3, 'loss': 0.0336, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8806, 'compress@10': 0.1406, 'time@10': 5.4219}: 100%|██████████| 10/10 [00:39<00:00,  4.44s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0336, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8806, 'compress@10': 0.1406, 'time@10': 5.4219}: 100%|██████████| 10/10 [00:39<00:00,  3.94s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.033595707949370675
Avg hit ratio: 0.8763075136521655
Avg ndcg: 0.8805908213851671
Avg compression ratio: 0.1405797425142517
Avg train time: 5.421913051605225
Std train time: 1.5588268856068141
[0.03333333333333334, 0.03333333333333334, 0.09999999999999999, 0.03333333333333334, 0.9, 0.03333333333333334, 0.03333333333333334, 0.03333333333333334, 0.03333333333333334, 0.03333333333333334]
[10, 10, 20, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0434, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8557, 'compress@10': 0.0527, 'time@10': 4.2587}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0434, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8557, 'compress@10': 0.0527, 'time@10': 4.2587}:  10%|█         | 1/10 [00:02<00:19,  2.17s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0363, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8745, 'compress@10': 0.0425, 'time@10': 4.0389}:  10%|█         | 1/10 [00:06<00:19,  2.17s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0363, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8745, 'compress@10': 0.0425, 'time@10': 4.0389}:  20%|██        | 2/10 [00:06<00:25,  3.16s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8687, 'compress@10': 0.076, 'time@10': 3.8227}:  20%|██        | 2/10 [00:07<00:25,  3.16s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8687, 'compress@10': 0.076, 'time@10': 3.8227}:  30%|███       | 3/10 [00:07<00:17,  2.51s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0282, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8792, 'compress@10': 0.0659, 'time@10': 3.8837}:  30%|███       | 3/10 [00:11<00:17,  2.51s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0282, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8792, 'compress@10': 0.0659, 'time@10': 3.8837}:  40%|████      | 4/10 [00:11<00:18,  3.14s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0341, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8667, 'compress@10': 0.2527, 'time@10': 4.7597}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0341, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8667, 'compress@10': 0.2527, 'time@10': 4.7597}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0339, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8683, 'compress@10': 0.2143, 'time@10': 4.9893}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0339, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8683, 'compress@10': 0.2143, 'time@10': 4.9893}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8727, 'compress@10': 0.1894, 'time@10': 5.2242}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8727, 'compress@10': 0.1894, 'time@10': 5.2242}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.8795, 'compress@10': 0.1693, 'time@10': 5.1651}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.8795, 'compress@10': 0.1693, 'time@10': 5.1651}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0311, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.887, 'compress@10': 0.1537, 'time@10': 5.5283}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0311, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.887, 'compress@10': 0.1537, 'time@10': 5.5283}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.8905, 'compress@10': 0.1406, 'time@10': 5.5539}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]  {'epoch': 14, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.8905, 'compress@10': 0.1406, 'time@10': 5.5539}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.8905, 'compress@10': 0.1406, 'time@10': 5.5539}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.03020783368337706
Avg hit ratio: 0.8777099444603689
Avg ndcg: 0.8905342931442162
Avg compression ratio: 0.14057971767227145
Avg train time: 5.553850769996643
Std train time: 1.7151892715739858
[0.03125000000000001, 0.03125000000000001, 0.09374999999999999, 0.03125000000000001, 0.90625, 0.03125000000000001, 0.03125000000000001, 0.03125000000000001, 0.03125000000000001, 0.03125000000000001]
[10, 10, 20, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0511, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8417, 'compress@10': 0.0527, 'time@10': 5.0515}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0511, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8417, 'compress@10': 0.0527, 'time@10': 5.0515}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0394, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8702, 'compress@10': 0.0425, 'time@10': 4.5416}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0394, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8702, 'compress@10': 0.0425, 'time@10': 4.5416}:  20%|██        | 2/10 [00:06<00:27,  3.45s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8658, 'compress@10': 0.076, 'time@10': 4.1146}:  20%|██        | 2/10 [00:08<00:27,  3.45s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8658, 'compress@10': 0.076, 'time@10': 4.1146}:  30%|███       | 3/10 [00:08<00:18,  2.64s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8825, 'compress@10': 0.0659, 'time@10': 4.102}:  30%|███       | 3/10 [00:12<00:18,  2.64s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8825, 'compress@10': 0.0659, 'time@10': 4.102}:  40%|████      | 4/10 [00:12<00:19,  3.22s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0306, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8698, 'compress@10': 0.2527, 'time@10': 4.9276}:  40%|████      | 4/10 [00:16<00:19,  3.22s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0306, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8698, 'compress@10': 0.2527, 'time@10': 4.9276}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0317, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8718, 'compress@10': 0.2143, 'time@10': 5.1175}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0317, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8718, 'compress@10': 0.2143, 'time@10': 5.1175}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0319, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8756, 'compress@10': 0.1894, 'time@10': 5.3585}:  60%|██████    | 6/10 [00:26<00:17,  4.42s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0319, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8756, 'compress@10': 0.1894, 'time@10': 5.3585}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0307, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8818, 'compress@10': 0.1693, 'time@10': 5.2658}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0307, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8818, 'compress@10': 0.1693, 'time@10': 5.2658}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8889, 'compress@10': 0.1537, 'time@10': 5.5762}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8889, 'compress@10': 0.1537, 'time@10': 5.5762}:  90%|█████████ | 9/10 [00:34<00:04,  4.21s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8939, 'compress@10': 0.1406, 'time@10': 5.6058}:  90%|█████████ | 9/10 [00:40<00:04,  4.21s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8939, 'compress@10': 0.1406, 'time@10': 5.6058}: 100%|██████████| 10/10 [00:40<00:00,  4.74s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8939, 'compress@10': 0.1406, 'time@10': 5.6058}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.02910990505931892
Avg hit ratio: 0.8773643223405532
Avg ndcg: 0.8938724215308118
Avg compression ratio: 0.14057852948689958
Avg train time: 5.605763936042786
Std train time: 1.6206065186743035
[0.02941176470588236, 0.02941176470588236, 0.08823529411764705, 0.02941176470588236, 0.9117647058823529, 0.02941176470588236, 0.02941176470588236, 0.02941176470588236, 0.02941176470588236, 0.02941176470588236]
[10, 10, 20, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0412, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8622, 'compress@10': 0.0527, 'time@10': 5.0657}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0412, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8622, 'compress@10': 0.0527, 'time@10': 5.0657}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.886, 'compress@10': 0.0425, 'time@10': 4.5688}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it] {'epoch': 16, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.886, 'compress@10': 0.0425, 'time@10': 4.5688}:  20%|██        | 2/10 [00:06<00:27,  3.48s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8764, 'compress@10': 0.076, 'time@10': 4.1014}:  20%|██        | 2/10 [00:08<00:27,  3.48s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8764, 'compress@10': 0.076, 'time@10': 4.1014}:  30%|███       | 3/10 [00:08<00:18,  2.63s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8893, 'compress@10': 0.0659, 'time@10': 4.1163}:  30%|███       | 3/10 [00:12<00:18,  2.63s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8893, 'compress@10': 0.0659, 'time@10': 4.1163}:  40%|████      | 4/10 [00:12<00:19,  3.25s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0323, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8757, 'compress@10': 0.2527, 'time@10': 4.9655}:  40%|████      | 4/10 [00:16<00:19,  3.25s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0323, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8757, 'compress@10': 0.2527, 'time@10': 4.9655}:  50%|█████     | 5/10 [00:16<00:18,  3.60s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.032, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8827, 'compress@10': 0.2143, 'time@10': 5.1691}:  50%|█████     | 5/10 [00:22<00:18,  3.60s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.032, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8827, 'compress@10': 0.2143, 'time@10': 5.1691}:  60%|██████    | 6/10 [00:22<00:17,  4.49s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0317, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8838, 'compress@10': 0.1894, 'time@10': 5.3849}:  60%|██████    | 6/10 [00:26<00:17,  4.49s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0317, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8838, 'compress@10': 0.1894, 'time@10': 5.3849}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0302, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8895, 'compress@10': 0.1693, 'time@10': 5.2957}:  70%|███████   | 7/10 [00:31<00:12,  4.13s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0302, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8895, 'compress@10': 0.1693, 'time@10': 5.2957}:  80%|████████  | 8/10 [00:31<00:08,  4.31s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0301, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.9001, 'compress@10': 0.1537, 'time@10': 5.6504}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0301, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.9001, 'compress@10': 0.1537, 'time@10': 5.6504}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8996, 'compress@10': 0.1406, 'time@10': 5.674}:  90%|█████████ | 9/10 [00:41<00:04,  4.31s/it]    {'epoch': 16, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8996, 'compress@10': 0.1406, 'time@10': 5.674}: 100%|██████████| 10/10 [00:41<00:00,  4.81s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8996, 'compress@10': 0.1406, 'time@10': 5.674}: 100%|██████████| 10/10 [00:41<00:00,  4.13s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.029751435893381056
Avg hit ratio: 0.8734242301746546
Avg ndcg: 0.899612836864111
Avg compression ratio: 0.14057922462106237
Avg train time: 5.673989105224609
Std train time: 1.7026031633352143
[0.027777777777777783, 0.027777777777777783, 0.08333333333333333, 0.027777777777777783, 0.9166666666666666, 0.027777777777777783, 0.027777777777777783, 0.027777777777777783, 0.027777777777777783, 0.027777777777777783]
[10, 10, 20, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8634, 'compress@10': 0.0527, 'time@10': 5.121}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8634, 'compress@10': 0.0527, 'time@10': 5.121}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8883, 'compress@10': 0.0425, 'time@10': 4.6379}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8883, 'compress@10': 0.0425, 'time@10': 4.6379}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8779, 'compress@10': 0.076, 'time@10': 4.1383}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8779, 'compress@10': 0.076, 'time@10': 4.1383}:  30%|███       | 3/10 [00:08<00:18,  2.66s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9135, 'compress@10': 0.0659, 'time@10': 4.1238}:  30%|███       | 3/10 [00:12<00:18,  2.66s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9135, 'compress@10': 0.0659, 'time@10': 4.1238}:  40%|████      | 4/10 [00:12<00:19,  3.24s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8974, 'compress@10': 0.2527, 'time@10': 4.9495}:  40%|████      | 4/10 [00:16<00:19,  3.24s/it] {'epoch': 17, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8974, 'compress@10': 0.2527, 'time@10': 4.9495}:  50%|█████     | 5/10 [00:16<00:17,  3.57s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9009, 'compress@10': 0.2143, 'time@10': 5.1418}:  50%|█████     | 5/10 [00:22<00:17,  3.57s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9009, 'compress@10': 0.2143, 'time@10': 5.1418}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0279, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9012, 'compress@10': 0.1894, 'time@10': 5.3537}:  60%|██████    | 6/10 [00:26<00:17,  4.44s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0279, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9012, 'compress@10': 0.1894, 'time@10': 5.3537}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0266, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9055, 'compress@10': 0.1693, 'time@10': 5.2674}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]  {'epoch': 17, 'num_users': 6.125, 'loss': 0.0266, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9055, 'compress@10': 0.1693, 'time@10': 5.2674}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0285, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9275, 'compress@10': 0.1537, 'time@10': 5.6357}:  80%|████████  | 8/10 [00:35<00:08,  4.28s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0285, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9275, 'compress@10': 0.1537, 'time@10': 5.6357}:  90%|█████████ | 9/10 [00:35<00:04,  4.30s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9288, 'compress@10': 0.1406, 'time@10': 5.6043}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9288, 'compress@10': 0.1406, 'time@10': 5.6043}: 100%|██████████| 10/10 [00:40<00:00,  4.63s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9288, 'compress@10': 0.1406, 'time@10': 5.6043}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.026789143395248415
Avg hit ratio: 0.8851953245773279
Avg ndcg: 0.9288248892792496
Avg compression ratio: 0.14057981475582146
Avg train time: 5.604313015937805
Std train time: 1.6991210335744629
[0.026315789473684216, 0.026315789473684216, 0.07894736842105263, 0.026315789473684216, 0.9210526315789473, 0.026315789473684216, 0.026315789473684216, 0.026315789473684216, 0.026315789473684216, 0.026315789473684216]
[10, 10, 20, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.0527, 'time@10': 4.5246}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.0527, 'time@10': 4.5246}:  10%|█         | 1/10 [00:02<00:20,  2.30s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9064, 'compress@10': 0.0425, 'time@10': 4.0975}:  10%|█         | 1/10 [00:06<00:20,  2.30s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9064, 'compress@10': 0.0425, 'time@10': 4.0975}:  20%|██        | 2/10 [00:06<00:25,  3.13s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.89, 'compress@10': 0.076, 'time@10': 3.6928}:  20%|██        | 2/10 [00:07<00:25,  3.13s/it]   {'epoch': 18, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.89, 'compress@10': 0.076, 'time@10': 3.6928}:  30%|███       | 3/10 [00:07<00:16,  2.38s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9019, 'compress@10': 0.0659, 'time@10': 3.7784}:  30%|███       | 3/10 [00:11<00:16,  2.38s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9019, 'compress@10': 0.0659, 'time@10': 3.7784}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0233, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8886, 'compress@10': 0.2527, 'time@10': 4.5499}:  40%|████      | 4/10 [00:15<00:18,  3.05s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0233, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8886, 'compress@10': 0.2527, 'time@10': 4.5499}:  50%|█████     | 5/10 [00:15<00:16,  3.34s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0251, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9016, 'compress@10': 0.2143, 'time@10': 4.6826}:  50%|█████     | 5/10 [00:20<00:16,  3.34s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0251, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9016, 'compress@10': 0.2143, 'time@10': 4.6826}:  60%|██████    | 6/10 [00:20<00:16,  4.04s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0258, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9006, 'compress@10': 0.1894, 'time@10': 4.9347}:  60%|██████    | 6/10 [00:24<00:16,  4.04s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0258, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9006, 'compress@10': 0.1894, 'time@10': 4.9347}:  70%|███████   | 7/10 [00:24<00:11,  3.78s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0246, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9048, 'compress@10': 0.1693, 'time@10': 4.9005}:  70%|███████   | 7/10 [00:28<00:11,  3.78s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0246, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9048, 'compress@10': 0.1693, 'time@10': 4.9005}:  80%|████████  | 8/10 [00:28<00:08,  4.08s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9208, 'compress@10': 0.1537, 'time@10': 5.3006}:  80%|████████  | 8/10 [00:33<00:08,  4.08s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9208, 'compress@10': 0.1537, 'time@10': 5.3006}:  90%|█████████ | 9/10 [00:33<00:04,  4.14s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9243, 'compress@10': 0.1406, 'time@10': 5.3515}:  90%|█████████ | 9/10 [00:38<00:04,  4.14s/it]    {'epoch': 18, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9243, 'compress@10': 0.1406, 'time@10': 5.3515}: 100%|██████████| 10/10 [00:38<00:00,  4.67s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9243, 'compress@10': 0.1406, 'time@10': 5.3515}: 100%|██████████| 10/10 [00:38<00:00,  3.89s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.026952280971939975
Avg hit ratio: 0.9080524674344709
Avg ndcg: 0.9243344548192903
Avg compression ratio: 0.1405759738708591
Avg train time: 5.35146267414093
Std train time: 1.6840354383092426
[0.025000000000000005, 0.025000000000000005, 0.075, 0.025000000000000005, 0.875, 0.025000000000000005, 0.025000000000000005, 0.025000000000000005, 0.07500000000000001, 0.025000000000000005]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8766, 'compress@10': 0.0527, 'time@10': 4.988}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8766, 'compress@10': 0.0527, 'time@10': 4.988}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9034, 'compress@10': 0.0425, 'time@10': 4.5662}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9034, 'compress@10': 0.0425, 'time@10': 4.5662}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.888, 'compress@10': 0.076, 'time@10': 4.1059}:  20%|██        | 2/10 [00:08<00:28,  3.51s/it]  {'epoch': 19, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.888, 'compress@10': 0.076, 'time@10': 4.1059}:  30%|███       | 3/10 [00:08<00:18,  2.65s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8993, 'compress@10': 0.0659, 'time@10': 4.1058}:  30%|███       | 3/10 [00:12<00:18,  2.65s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8993, 'compress@10': 0.0659, 'time@10': 4.1058}:  40%|████      | 4/10 [00:12<00:19,  3.24s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0279, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8887, 'compress@10': 0.2526, 'time@10': 4.9407}:  40%|████      | 4/10 [00:16<00:19,  3.24s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0279, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8887, 'compress@10': 0.2526, 'time@10': 4.9407}:  50%|█████     | 5/10 [00:16<00:17,  3.58s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0281, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8967, 'compress@10': 0.2142, 'time@10': 5.1306}:  50%|█████     | 5/10 [00:22<00:17,  3.58s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0281, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8967, 'compress@10': 0.2142, 'time@10': 5.1306}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0271, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.8996, 'compress@10': 0.1893, 'time@10': 5.366}:  60%|██████    | 6/10 [00:26<00:17,  4.44s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.0271, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.8996, 'compress@10': 0.1893, 'time@10': 5.366}:  70%|███████   | 7/10 [00:26<00:12,  4.11s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0261, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9019, 'compress@10': 0.1693, 'time@10': 5.2668}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0261, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9019, 'compress@10': 0.1693, 'time@10': 5.2668}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9053, 'compress@10': 0.1536, 'time@10': 5.6155}:  80%|████████  | 8/10 [00:35<00:08,  4.28s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9053, 'compress@10': 0.1536, 'time@10': 5.6155}:  90%|█████████ | 9/10 [00:35<00:04,  4.27s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.026, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.908, 'compress@10': 0.1406, 'time@10': 5.6358}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]     {'epoch': 19, 'num_users': 6.3, 'loss': 0.026, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.908, 'compress@10': 0.1406, 'time@10': 5.6358}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.026, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.908, 'compress@10': 0.1406, 'time@10': 5.6358}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.02603647108730382
Avg hit ratio: 0.8884211310289409
Avg ndcg: 0.9079872303967788
Avg compression ratio: 0.14055746837078567
Avg train time: 5.635841059684753
Std train time: 1.6827196996706844
[0.023809523809523815, 0.023809523809523815, 0.07142857142857142, 0.023809523809523815, 0.8809523809523809, 0.023809523809523815, 0.023809523809523815, 0.023809523809523815, 0.07142857142857144, 0.023809523809523815]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8887, 'compress@10': 0.0527, 'time@10': 5.04}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8887, 'compress@10': 0.0527, 'time@10': 5.04}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9139, 'compress@10': 0.0425, 'time@10': 4.5885}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9139, 'compress@10': 0.0425, 'time@10': 4.5885}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.895, 'compress@10': 0.076, 'time@10': 4.1702}:  20%|██        | 2/10 [00:08<00:28,  3.51s/it]  {'epoch': 20, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.895, 'compress@10': 0.076, 'time@10': 4.1702}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9203, 'compress@10': 0.0659, 'time@10': 4.1462}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9203, 'compress@10': 0.0659, 'time@10': 4.1462}:  40%|████      | 4/10 [00:12<00:19,  3.25s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9068, 'compress@10': 0.2526, 'time@10': 4.9712}:  40%|████      | 4/10 [00:16<00:19,  3.25s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9068, 'compress@10': 0.2526, 'time@10': 4.9712}:  50%|█████     | 5/10 [00:16<00:17,  3.59s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0247, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9109, 'compress@10': 0.2142, 'time@10': 5.1627}:  50%|█████     | 5/10 [00:22<00:17,  3.59s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0247, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9109, 'compress@10': 0.2142, 'time@10': 5.1627}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0252, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9093, 'compress@10': 0.1894, 'time@10': 5.3876}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0252, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9093, 'compress@10': 0.1894, 'time@10': 5.3876}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0246, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9107, 'compress@10': 0.1693, 'time@10': 5.2948}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0246, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9107, 'compress@10': 0.1693, 'time@10': 5.2948}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0257, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.925, 'compress@10': 0.1536, 'time@10': 5.6624}:  80%|████████  | 8/10 [00:35<00:08,  4.30s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0257, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.925, 'compress@10': 0.1536, 'time@10': 5.6624}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9301, 'compress@10': 0.1406, 'time@10': 5.6867}:  90%|█████████ | 9/10 [00:41<00:04,  4.31s/it]  {'epoch': 20, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9301, 'compress@10': 0.1406, 'time@10': 5.6867}: 100%|██████████| 10/10 [00:41<00:00,  4.82s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9301, 'compress@10': 0.1406, 'time@10': 5.6867}: 100%|██████████| 10/10 [00:41<00:00,  4.13s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.023745892029153073
Avg hit ratio: 0.8994810388630421
Avg ndcg: 0.9300965449764125
Avg compression ratio: 0.1405583395082333
Avg train time: 5.686710405349731
Std train time: 1.6901164085280709
[0.02272727272727273, 0.02272727272727273, 0.06818181818181818, 0.02272727272727273, 0.8863636363636364, 0.02272727272727273, 0.02272727272727273, 0.02272727272727273, 0.06818181818181819, 0.02272727272727273]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8897, 'compress@10': 0.0527, 'time@10': 5.233}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8897, 'compress@10': 0.0527, 'time@10': 5.233}:  10%|█         | 1/10 [00:02<00:23,  2.66s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9199, 'compress@10': 0.0425, 'time@10': 4.6869}:  10%|█         | 1/10 [00:06<00:23,  2.66s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9199, 'compress@10': 0.0425, 'time@10': 4.6869}:  20%|██        | 2/10 [00:06<00:28,  3.55s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.899, 'compress@10': 0.076, 'time@10': 4.2117}:  20%|██        | 2/10 [00:08<00:28,  3.55s/it]  {'epoch': 21, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.899, 'compress@10': 0.076, 'time@10': 4.2117}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9088, 'compress@10': 0.0659, 'time@10': 4.1898}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9088, 'compress@10': 0.0659, 'time@10': 4.1898}:  40%|████      | 4/10 [00:12<00:19,  3.27s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8977, 'compress@10': 0.2526, 'time@10': 4.9905}:  40%|████      | 4/10 [00:16<00:19,  3.27s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8977, 'compress@10': 0.2526, 'time@10': 4.9905}:  50%|█████     | 5/10 [00:16<00:17,  3.59s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.02, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9049, 'compress@10': 0.2142, 'time@10': 5.1786}:  50%|█████     | 5/10 [00:22<00:17,  3.59s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.02, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9049, 'compress@10': 0.2142, 'time@10': 5.1786}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0207, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9047, 'compress@10': 0.1894, 'time@10': 5.3877}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0207, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9047, 'compress@10': 0.1894, 'time@10': 5.3877}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9102, 'compress@10': 0.1693, 'time@10': 5.2892}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9102, 'compress@10': 0.1693, 'time@10': 5.2892}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.915, 'compress@10': 0.1536, 'time@10': 5.6495}:  80%|████████  | 8/10 [00:35<00:08,  4.27s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.915, 'compress@10': 0.1536, 'time@10': 5.6495}:  90%|█████████ | 9/10 [00:35<00:04,  4.28s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9158, 'compress@10': 0.1406, 'time@10': 5.662}:  90%|█████████ | 9/10 [00:41<00:04,  4.28s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9158, 'compress@10': 0.1406, 'time@10': 5.662}: 100%|██████████| 10/10 [00:41<00:00,  4.76s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9158, 'compress@10': 0.1406, 'time@10': 5.662}: 100%|██████████| 10/10 [00:41<00:00,  4.11s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.02133529081867191
Avg hit ratio: 0.8877068453146553
Avg ndcg: 0.9158388497644013
Avg compression ratio: 0.14055758541543756
Avg train time: 5.661984658241272
Std train time: 1.660652196888758
[0.02173913043478261, 0.02173913043478261, 0.06521739130434782, 0.02173913043478261, 0.8913043478260869, 0.02173913043478261, 0.02173913043478261, 0.02173913043478261, 0.06521739130434784, 0.02173913043478261]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8986, 'compress@10': 0.0527, 'time@10': 5.0425}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8986, 'compress@10': 0.0527, 'time@10': 5.0425}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9212, 'compress@10': 0.0425, 'time@10': 4.6157}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9212, 'compress@10': 0.0425, 'time@10': 4.6157}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8999, 'compress@10': 0.076, 'time@10': 4.1162}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8999, 'compress@10': 0.076, 'time@10': 4.1162}:  30%|███       | 3/10 [00:08<00:18,  2.65s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.927, 'compress@10': 0.0659, 'time@10': 4.0219}:  30%|███       | 3/10 [00:12<00:18,  2.65s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.927, 'compress@10': 0.0659, 'time@10': 4.0219}:  40%|████      | 4/10 [00:12<00:18,  3.10s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9146, 'compress@10': 0.2527, 'time@10': 4.7462}:  40%|████      | 4/10 [00:16<00:18,  3.10s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9146, 'compress@10': 0.2527, 'time@10': 4.7462}:  50%|█████     | 5/10 [00:16<00:16,  3.37s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0224, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9201, 'compress@10': 0.2143, 'time@10': 4.8794}:  50%|█████     | 5/10 [00:21<00:16,  3.37s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0224, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9201, 'compress@10': 0.2143, 'time@10': 4.8794}:  60%|██████    | 6/10 [00:21<00:16,  4.13s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9227, 'compress@10': 0.1894, 'time@10': 5.133}:  60%|██████    | 6/10 [00:24<00:16,  4.13s/it] {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9227, 'compress@10': 0.1894, 'time@10': 5.133}:  70%|███████   | 7/10 [00:24<00:11,  3.88s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0212, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9243, 'compress@10': 0.1693, 'time@10': 5.0611}:  70%|███████   | 7/10 [00:29<00:11,  3.88s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0212, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9243, 'compress@10': 0.1693, 'time@10': 5.0611}:  80%|████████  | 8/10 [00:29<00:08,  4.11s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0199, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9284, 'compress@10': 0.1537, 'time@10': 5.4032}:  80%|████████  | 8/10 [00:33<00:08,  4.11s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0199, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9284, 'compress@10': 0.1537, 'time@10': 5.4032}:  90%|█████████ | 9/10 [00:33<00:04,  4.11s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9314, 'compress@10': 0.1406, 'time@10': 5.382}:  90%|█████████ | 9/10 [00:38<00:04,  4.11s/it]    {'epoch': 22, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9314, 'compress@10': 0.1406, 'time@10': 5.382}: 100%|██████████| 10/10 [00:38<00:00,  4.45s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9314, 'compress@10': 0.1406, 'time@10': 5.382}: 100%|██████████| 10/10 [00:38<00:00,  3.89s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.019548952624764148
Avg hit ratio: 0.8823381817201852
Avg ndcg: 0.931433486731026
Avg compression ratio: 0.14056390847653108
Avg train time: 5.382025289535522
Std train time: 1.5635529298649036
[0.020833333333333336, 0.020833333333333336, 0.0625, 0.020833333333333336, 0.8958333333333333, 0.020833333333333336, 0.020833333333333336, 0.020833333333333336, 0.06250000000000001, 0.020833333333333336]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8986, 'compress@10': 0.0527, 'time@10': 4.9469}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8986, 'compress@10': 0.0527, 'time@10': 4.9469}:  10%|█         | 1/10 [00:02<00:22,  2.52s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9256, 'compress@10': 0.0425, 'time@10': 4.5398}:  10%|█         | 1/10 [00:06<00:22,  2.52s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9256, 'compress@10': 0.0425, 'time@10': 4.5398}:  20%|██        | 2/10 [00:06<00:27,  3.50s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9028, 'compress@10': 0.076, 'time@10': 4.0681}:  20%|██        | 2/10 [00:08<00:27,  3.50s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9028, 'compress@10': 0.076, 'time@10': 4.0681}:  30%|███       | 3/10 [00:08<00:18,  2.63s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9135, 'compress@10': 0.0659, 'time@10': 4.068}:  30%|███       | 3/10 [00:12<00:18,  2.63s/it]  {'epoch': 23, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9135, 'compress@10': 0.0659, 'time@10': 4.068}:  40%|████      | 4/10 [00:12<00:19,  3.22s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.9052, 'compress@10': 0.2527, 'time@10': 4.9214}:  40%|████      | 4/10 [00:16<00:19,  3.22s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.9052, 'compress@10': 0.2527, 'time@10': 4.9214}:  50%|█████     | 5/10 [00:16<00:17,  3.57s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.018, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.912, 'compress@10': 0.2143, 'time@10': 5.1195}:  50%|█████     | 5/10 [00:22<00:17,  3.57s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.018, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.912, 'compress@10': 0.2143, 'time@10': 5.1195}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9098, 'compress@10': 0.1894, 'time@10': 5.3326}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9098, 'compress@10': 0.1894, 'time@10': 5.3326}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9153, 'compress@10': 0.1693, 'time@10': 5.2531}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9153, 'compress@10': 0.1693, 'time@10': 5.2531}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9205, 'compress@10': 0.1537, 'time@10': 5.618}:  80%|████████  | 8/10 [00:35<00:08,  4.29s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9205, 'compress@10': 0.1537, 'time@10': 5.618}:  90%|█████████ | 9/10 [00:35<00:04,  4.30s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9254, 'compress@10': 0.1406, 'time@10': 5.6305}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9254, 'compress@10': 0.1406, 'time@10': 5.6305}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9254, 'compress@10': 0.1406, 'time@10': 5.6305}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.0189830806290182
Avg hit ratio: 0.8844810388630423
Avg ndcg: 0.9254420674349653
Avg compression ratio: 0.1405656735266531
Avg train time: 5.630482482910156
Std train time: 1.7108232754184713
[0.020000000000000004, 0.020000000000000004, 0.06, 0.020000000000000004, 0.8999999999999999, 0.020000000000000004, 0.020000000000000004, 0.020000000000000004, 0.06000000000000001, 0.020000000000000004]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9052, 'compress@10': 0.0527, 'time@10': 4.9897}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9052, 'compress@10': 0.0527, 'time@10': 4.9897}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9315, 'compress@10': 0.0425, 'time@10': 4.5915}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9315, 'compress@10': 0.0425, 'time@10': 4.5915}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9067, 'compress@10': 0.076, 'time@10': 4.136}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it]  {'epoch': 24, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9067, 'compress@10': 0.076, 'time@10': 4.136}:  30%|███       | 3/10 [00:08<00:18,  2.67s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9414, 'compress@10': 0.0659, 'time@10': 4.1531}:  30%|███       | 3/10 [00:12<00:18,  2.67s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9414, 'compress@10': 0.0659, 'time@10': 4.1531}:  40%|████      | 4/10 [00:12<00:19,  3.29s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0203, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9283, 'compress@10': 0.2527, 'time@10': 4.9773}:  40%|████      | 4/10 [00:16<00:19,  3.29s/it] {'epoch': 24, 'num_users': 5.8, 'loss': 0.0203, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9283, 'compress@10': 0.2527, 'time@10': 4.9773}:  50%|█████     | 5/10 [00:16<00:18,  3.61s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9325, 'compress@10': 0.2143, 'time@10': 5.1698}:  50%|█████     | 5/10 [00:23<00:18,  3.61s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9325, 'compress@10': 0.2143, 'time@10': 5.1698}:  60%|██████    | 6/10 [00:23<00:17,  4.48s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9316, 'compress@10': 0.1894, 'time@10': 5.3815}:  60%|██████    | 6/10 [00:26<00:17,  4.48s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9316, 'compress@10': 0.1894, 'time@10': 5.3815}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0189, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9338, 'compress@10': 0.1693, 'time@10': 5.2899}:  70%|███████   | 7/10 [00:31<00:12,  4.12s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0189, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9338, 'compress@10': 0.1693, 'time@10': 5.2899}:  80%|████████  | 8/10 [00:31<00:08,  4.30s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9452, 'compress@10': 0.1537, 'time@10': 5.6674}:  80%|████████  | 8/10 [00:35<00:08,  4.30s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9452, 'compress@10': 0.1537, 'time@10': 5.6674}:  90%|█████████ | 9/10 [00:35<00:04,  4.33s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9446, 'compress@10': 0.1406, 'time@10': 5.6783}:  90%|█████████ | 9/10 [00:41<00:04,  4.33s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9446, 'compress@10': 0.1406, 'time@10': 5.6783}: 100%|██████████| 10/10 [00:41<00:00,  4.79s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9446, 'compress@10': 0.1406, 'time@10': 5.6783}: 100%|██████████| 10/10 [00:41<00:00,  4.13s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.022439637057381914
Avg hit ratio: 0.8857797401617435
Avg ndcg: 0.9446452585914006
Avg compression ratio: 0.1405633389689473
Avg train time: 5.678270530700684
Std train time: 1.699557017679809
[0.019230769230769235, 0.019230769230769235, 0.05769230769230769, 0.019230769230769235, 0.8653846153846153, 0.019230769230769235, 0.019230769230769235, 0.019230769230769235, 0.09615384615384617, 0.019230769230769235]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9052, 'compress@10': 0.0527, 'time@10': 5.0667}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9052, 'compress@10': 0.0527, 'time@10': 5.0667}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9347, 'compress@10': 0.0425, 'time@10': 4.637}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it] {'epoch': 25, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9347, 'compress@10': 0.0425, 'time@10': 4.637}:  20%|██        | 2/10 [00:06<00:28,  3.56s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9089, 'compress@10': 0.076, 'time@10': 4.1316}:  20%|██        | 2/10 [00:08<00:28,  3.56s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9089, 'compress@10': 0.076, 'time@10': 4.1316}:  30%|███       | 3/10 [00:08<00:18,  2.66s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9204, 'compress@10': 0.0659, 'time@10': 4.1177}:  30%|███       | 3/10 [00:12<00:18,  2.66s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9204, 'compress@10': 0.0659, 'time@10': 4.1177}:  40%|████      | 4/10 [00:12<00:19,  3.24s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0142, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.9122, 'compress@10': 0.2526, 'time@10': 4.9493}:  40%|████      | 4/10 [00:16<00:19,  3.24s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0142, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.9122, 'compress@10': 0.2526, 'time@10': 4.9493}:  50%|█████     | 5/10 [00:16<00:17,  3.58s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9215, 'compress@10': 0.2142, 'time@10': 5.1496}:  50%|█████     | 5/10 [00:22<00:17,  3.58s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9215, 'compress@10': 0.2142, 'time@10': 5.1496}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0162, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9253, 'compress@10': 0.1893, 'time@10': 5.3611}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0162, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9253, 'compress@10': 0.1893, 'time@10': 5.3611}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9292, 'compress@10': 0.1692, 'time@10': 5.2631}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9292, 'compress@10': 0.1692, 'time@10': 5.2631}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9279, 'compress@10': 0.1536, 'time@10': 5.6222}:  80%|████████  | 8/10 [00:35<00:08,  4.27s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9279, 'compress@10': 0.1536, 'time@10': 5.6222}:  90%|█████████ | 9/10 [00:35<00:04,  4.27s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.932, 'compress@10': 0.1406, 'time@10': 5.63}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]      {'epoch': 25, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.932, 'compress@10': 0.1406, 'time@10': 5.63}: 100%|██████████| 10/10 [00:40<00:00,  4.73s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.932, 'compress@10': 0.1406, 'time@10': 5.63}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.017310806730387616
Avg hit ratio: 0.8750524674344708
Avg ndcg: 0.9319603456924155
Avg compression ratio: 0.1405533435770329
Avg train time: 5.629954242706299
Std train time: 1.6925541660808947
[0.018518518518518524, 0.018518518518518524, 0.05555555555555555, 0.018518518518518524, 0.8333333333333333, 0.018518518518518524, 0.018518518518518524, 0.018518518518518524, 0.12962962962962965, 0.018518518518518524]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9151, 'compress@10': 0.0527, 'time@10': 4.9843}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9151, 'compress@10': 0.0527, 'time@10': 4.9843}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9386, 'compress@10': 0.0425, 'time@10': 4.5828}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9386, 'compress@10': 0.0425, 'time@10': 4.5828}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9114, 'compress@10': 0.076, 'time@10': 4.1635}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it]  {'epoch': 26, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9114, 'compress@10': 0.076, 'time@10': 4.1635}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9524, 'compress@10': 0.0659, 'time@10': 4.1249}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9524, 'compress@10': 0.0659, 'time@10': 4.1249}:  40%|████      | 4/10 [00:12<00:19,  3.23s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0193, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.9381, 'compress@10': 0.2525, 'time@10': 4.9362}:  40%|████      | 4/10 [00:16<00:19,  3.23s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0193, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.9381, 'compress@10': 0.2525, 'time@10': 4.9362}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.9416, 'compress@10': 0.2141, 'time@10': 5.11}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.9416, 'compress@10': 0.2141, 'time@10': 5.11}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0194, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9352, 'compress@10': 0.1893, 'time@10': 5.217}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0194, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9352, 'compress@10': 0.1893, 'time@10': 5.217}:  70%|███████   | 7/10 [00:25<00:11,  3.93s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9379, 'compress@10': 0.1692, 'time@10': 5.0908}:  70%|███████   | 7/10 [00:29<00:11,  3.93s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9379, 'compress@10': 0.1692, 'time@10': 5.0908}:  80%|████████  | 8/10 [00:29<00:08,  4.03s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.872, 'ndcg@10': 0.94, 'compress@10': 0.1536, 'time@10': 5.3915}:  80%|████████  | 8/10 [00:33<00:08,  4.03s/it]  {'epoch': 26, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.872, 'ndcg@10': 0.94, 'compress@10': 0.1536, 'time@10': 5.3915}:  90%|█████████ | 9/10 [00:33<00:04,  4.01s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9453, 'compress@10': 0.1405, 'time@10': 5.443}:  90%|█████████ | 9/10 [00:39<00:04,  4.01s/it] {'epoch': 26, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9453, 'compress@10': 0.1405, 'time@10': 5.443}: 100%|██████████| 10/10 [00:39<00:00,  4.61s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9453, 'compress@10': 0.1405, 'time@10': 5.443}: 100%|██████████| 10/10 [00:39<00:00,  3.98s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.01749301543092184
Avg hit ratio: 0.8824846230924329
Avg ndcg: 0.9452623622818302
Avg compression ratio: 0.14052341837117396
Avg train time: 5.4429981231689455
Std train time: 1.5358163643581833
[0.017857142857142863, 0.017857142857142863, 0.05357142857142857, 0.053571428571428575, 0.8035714285714285, 0.017857142857142863, 0.017857142857142863, 0.017857142857142863, 0.12500000000000003, 0.017857142857142863]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9157, 'compress@10': 0.0527, 'time@10': 4.7171}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9157, 'compress@10': 0.0527, 'time@10': 4.7171}:  10%|█         | 1/10 [00:02<00:21,  2.40s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9408, 'compress@10': 0.0425, 'time@10': 4.2514}:  10%|█         | 1/10 [00:06<00:21,  2.40s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9408, 'compress@10': 0.0425, 'time@10': 4.2514}:  20%|██        | 2/10 [00:06<00:25,  3.24s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9129, 'compress@10': 0.076, 'time@10': 3.7981}:  20%|██        | 2/10 [00:07<00:25,  3.24s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9129, 'compress@10': 0.076, 'time@10': 3.7981}:  30%|███       | 3/10 [00:07<00:17,  2.44s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9253, 'compress@10': 0.0659, 'time@10': 3.7764}:  30%|███       | 3/10 [00:11<00:17,  2.44s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9253, 'compress@10': 0.0659, 'time@10': 3.7764}:  40%|████      | 4/10 [00:11<00:17,  2.96s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9175, 'compress@10': 0.2524, 'time@10': 4.537}:  40%|████      | 4/10 [00:15<00:17,  2.96s/it] {'epoch': 27, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9175, 'compress@10': 0.2524, 'time@10': 4.537}:  50%|█████     | 5/10 [00:15<00:16,  3.27s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9263, 'compress@10': 0.214, 'time@10': 4.806}:  50%|█████     | 5/10 [00:21<00:16,  3.27s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9263, 'compress@10': 0.214, 'time@10': 4.806}:  60%|██████    | 6/10 [00:21<00:17,  4.26s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9285, 'compress@10': 0.1892, 'time@10': 5.0705}:  60%|██████    | 6/10 [00:24<00:17,  4.26s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9285, 'compress@10': 0.1892, 'time@10': 5.0705}:  70%|███████   | 7/10 [00:24<00:11,  3.97s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9319, 'compress@10': 0.1691, 'time@10': 5.0145}:  70%|███████   | 7/10 [00:29<00:11,  3.97s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9319, 'compress@10': 0.1691, 'time@10': 5.0145}:  80%|████████  | 8/10 [00:29<00:08,  4.19s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9364, 'compress@10': 0.1535, 'time@10': 5.3948}:  80%|████████  | 8/10 [00:33<00:08,  4.19s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9364, 'compress@10': 0.1535, 'time@10': 5.3948}:  90%|█████████ | 9/10 [00:33<00:04,  4.22s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9382, 'compress@10': 0.1405, 'time@10': 5.4426}:  90%|█████████ | 9/10 [00:39<00:04,  4.22s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9382, 'compress@10': 0.1405, 'time@10': 5.4426}: 100%|██████████| 10/10 [00:39<00:00,  4.74s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9382, 'compress@10': 0.1405, 'time@10': 5.4426}: 100%|██████████| 10/10 [00:39<00:00,  3.97s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.015703171364325093
Avg hit ratio: 0.88362748023529
Avg ndcg: 0.9381544260603933
Avg compression ratio: 0.14045048785781994
Avg train time: 5.442589855194091
Std train time: 1.7073498112563217
[0.017241379310344834, 0.017241379310344834, 0.05172413793103448, 0.05172413793103449, 0.8103448275862069, 0.017241379310344834, 0.017241379310344834, 0.017241379310344834, 0.12068965517241383, 0.017241379310344834]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9157, 'compress@10': 0.0527, 'time@10': 5.0548}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9157, 'compress@10': 0.0527, 'time@10': 5.0548}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9448, 'compress@10': 0.0425, 'time@10': 4.5979}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9448, 'compress@10': 0.0425, 'time@10': 4.5979}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.842, 'ndcg@10': 0.9156, 'compress@10': 0.076, 'time@10': 4.2148}:  20%|██        | 2/10 [00:08<00:28,  3.52s/it]  {'epoch': 28, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.842, 'ndcg@10': 0.9156, 'compress@10': 0.076, 'time@10': 4.2148}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9369, 'compress@10': 0.0659, 'time@10': 4.17}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9369, 'compress@10': 0.0659, 'time@10': 4.17}:  40%|████      | 4/10 [00:12<00:19,  3.26s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9271, 'compress@10': 0.2525, 'time@10': 4.9574}:  40%|████      | 4/10 [00:16<00:19,  3.26s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9271, 'compress@10': 0.2525, 'time@10': 4.9574}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9373, 'compress@10': 0.2141, 'time@10': 5.1543}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9373, 'compress@10': 0.2141, 'time@10': 5.1543}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0187, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.9384, 'compress@10': 0.1892, 'time@10': 5.3596}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0187, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.9384, 'compress@10': 0.1892, 'time@10': 5.3596}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.9174, 'ndcg@10': 0.9405, 'compress@10': 0.1692, 'time@10': 5.2717}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.9174, 'ndcg@10': 0.9405, 'compress@10': 0.1692, 'time@10': 5.2717}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.9556, 'compress@10': 0.1536, 'time@10': 5.6186}:  80%|████████  | 8/10 [00:35<00:08,  4.28s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.9556, 'compress@10': 0.1536, 'time@10': 5.6186}:  90%|█████████ | 9/10 [00:35<00:04,  4.27s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9572, 'compress@10': 0.1405, 'time@10': 5.6465}:  90%|█████████ | 9/10 [00:41<00:04,  4.27s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9572, 'compress@10': 0.1405, 'time@10': 5.6465}: 100%|██████████| 10/10 [00:41<00:00,  4.78s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9572, 'compress@10': 0.1405, 'time@10': 5.6465}: 100%|██████████| 10/10 [00:41<00:00,  4.11s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.019270881743211902
Avg hit ratio: 0.9088266609828579
Avg ndcg: 0.95715905228161
Avg compression ratio: 0.14049470925009291
Avg train time: 5.646498203277588
Std train time: 1.6067495882872374
[0.016666666666666673, 0.016666666666666673, 0.05, 0.05, 0.7833333333333333, 0.016666666666666673, 0.016666666666666673, 0.016666666666666673, 0.15000000000000002, 0.016666666666666673]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.0527, 'time@10': 5.0396}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.0527, 'time@10': 5.0396}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9399, 'compress@10': 0.0425, 'time@10': 4.6344}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9399, 'compress@10': 0.0425, 'time@10': 4.6344}:  20%|██        | 2/10 [00:06<00:28,  3.57s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9123, 'compress@10': 0.076, 'time@10': 4.2868}:  20%|██        | 2/10 [00:08<00:28,  3.57s/it]  {'epoch': 29, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9123, 'compress@10': 0.076, 'time@10': 4.2868}:  30%|███       | 3/10 [00:08<00:19,  2.78s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9237, 'compress@10': 0.0659, 'time@10': 4.2411}:  30%|███       | 3/10 [00:12<00:19,  2.78s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9237, 'compress@10': 0.0659, 'time@10': 4.2411}:  40%|████      | 4/10 [00:12<00:19,  3.32s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9164, 'compress@10': 0.2523, 'time@10': 5.0268}:  40%|████      | 4/10 [00:16<00:19,  3.32s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9164, 'compress@10': 0.2523, 'time@10': 5.0268}:  50%|█████     | 5/10 [00:16<00:18,  3.61s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9252, 'compress@10': 0.214, 'time@10': 5.2069}:  50%|█████     | 5/10 [00:23<00:18,  3.61s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9252, 'compress@10': 0.214, 'time@10': 5.2069}:  60%|██████    | 6/10 [00:23<00:17,  4.48s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.925, 'compress@10': 0.1891, 'time@10': 5.3931}:  60%|██████    | 6/10 [00:26<00:17,  4.48s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.925, 'compress@10': 0.1891, 'time@10': 5.3931}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9293, 'compress@10': 0.1691, 'time@10': 5.3081}:  70%|███████   | 7/10 [00:31<00:12,  4.09s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9293, 'compress@10': 0.1691, 'time@10': 5.3081}:  80%|████████  | 8/10 [00:31<00:08,  4.30s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0155, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9246, 'compress@10': 0.1535, 'time@10': 5.6649}:  80%|████████  | 8/10 [00:35<00:08,  4.30s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0155, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9246, 'compress@10': 0.1535, 'time@10': 5.6649}:  90%|█████████ | 9/10 [00:35<00:04,  4.30s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9318, 'compress@10': 0.1404, 'time@10': 5.69}:  90%|█████████ | 9/10 [00:41<00:04,  4.30s/it]     {'epoch': 29, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9318, 'compress@10': 0.1404, 'time@10': 5.69}: 100%|██████████| 10/10 [00:41<00:00,  4.81s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9318, 'compress@10': 0.1404, 'time@10': 5.69}: 100%|██████████| 10/10 [00:41<00:00,  4.14s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.016555476380798483
Avg hit ratio: 0.8985854665990489
Avg ndcg: 0.9317504662378597
Avg compression ratio: 0.14043887153021564
Avg train time: 5.690049815177917
Std train time: 1.5962166566595508
[0.016129032258064523, 0.016129032258064523, 0.048387096774193554, 0.048387096774193554, 0.7580645161290323, 0.016129032258064523, 0.016129032258064523, 0.016129032258064523, 0.1774193548387097, 0.016129032258064523]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.0527, 'time@10': 5.037}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.0527, 'time@10': 5.037}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9469, 'compress@10': 0.0425, 'time@10': 4.5861}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9469, 'compress@10': 0.0425, 'time@10': 4.5861}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.917, 'compress@10': 0.076, 'time@10': 4.2584}:  20%|██        | 2/10 [00:08<00:28,  3.51s/it]  {'epoch': 30, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.917, 'compress@10': 0.076, 'time@10': 4.2584}:  30%|███       | 3/10 [00:08<00:19,  2.75s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9254, 'compress@10': 0.0659, 'time@10': 4.1782}:  30%|███       | 3/10 [00:12<00:19,  2.75s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9254, 'compress@10': 0.0659, 'time@10': 4.1782}:  40%|████      | 4/10 [00:12<00:19,  3.23s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9181, 'compress@10': 0.2521, 'time@10': 4.9806}:  40%|████      | 4/10 [00:16<00:19,  3.23s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9181, 'compress@10': 0.2521, 'time@10': 4.9806}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.928, 'compress@10': 0.2138, 'time@10': 5.1689}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.928, 'compress@10': 0.2138, 'time@10': 5.1689}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9318, 'compress@10': 0.189, 'time@10': 5.3621}:  60%|██████    | 6/10 [00:26<00:17,  4.44s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9318, 'compress@10': 0.189, 'time@10': 5.3621}:  70%|███████   | 7/10 [00:26<00:12,  4.07s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9355, 'compress@10': 0.1689, 'time@10': 5.2767}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9355, 'compress@10': 0.1689, 'time@10': 5.2767}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0167, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9537, 'compress@10': 0.1534, 'time@10': 5.6073}:  80%|████████  | 8/10 [00:35<00:08,  4.28s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0167, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9537, 'compress@10': 0.1534, 'time@10': 5.6073}:  90%|█████████ | 9/10 [00:35<00:04,  4.24s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9553, 'compress@10': 0.1403, 'time@10': 5.5798}:  90%|█████████ | 9/10 [00:40<00:04,  4.24s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9553, 'compress@10': 0.1403, 'time@10': 5.5798}: 100%|██████████| 10/10 [00:40<00:00,  4.59s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9553, 'compress@10': 0.1403, 'time@10': 5.5798}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.016673674632768712
Avg hit ratio: 0.9135219745355568
Avg ndcg: 0.9553055535059478
Avg compression ratio: 0.14033840796861358
Avg train time: 5.579803800582885
Std train time: 1.5805848213722378
[0.015625000000000007, 0.015625000000000007, 0.04687500000000001, 0.04687500000000001, 0.734375, 0.015625000000000007, 0.015625000000000007, 0.015625000000000007, 0.203125, 0.015625000000000007]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9157, 'compress@10': 0.0527, 'time@10': 4.7611}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9157, 'compress@10': 0.0527, 'time@10': 4.7611}:  10%|█         | 1/10 [00:02<00:21,  2.42s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9529, 'compress@10': 0.0425, 'time@10': 4.347}:  10%|█         | 1/10 [00:06<00:21,  2.42s/it]  {'epoch': 31, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9529, 'compress@10': 0.0425, 'time@10': 4.347}:  20%|██        | 2/10 [00:06<00:26,  3.33s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.921, 'compress@10': 0.076, 'time@10': 3.9672}:  20%|██        | 2/10 [00:08<00:26,  3.33s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.921, 'compress@10': 0.076, 'time@10': 3.9672}:  30%|███       | 3/10 [00:08<00:17,  2.56s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9621, 'compress@10': 0.0659, 'time@10': 3.9434}:  30%|███       | 3/10 [00:11<00:17,  2.56s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9621, 'compress@10': 0.0659, 'time@10': 3.9434}:  40%|████      | 4/10 [00:11<00:18,  3.10s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.95, 'compress@10': 0.2519, 'time@10': 4.8121}:  40%|████      | 4/10 [00:16<00:18,  3.10s/it]  {'epoch': 31, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.95, 'compress@10': 0.2519, 'time@10': 4.8121}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.021, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9546, 'compress@10': 0.2136, 'time@10': 4.9448}:  50%|█████     | 5/10 [00:21<00:17,  3.49s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.021, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9546, 'compress@10': 0.2136, 'time@10': 4.9448}:  60%|██████    | 6/10 [00:21<00:16,  4.22s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0213, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9525, 'compress@10': 0.1888, 'time@10': 5.1146}:  60%|██████    | 6/10 [00:24<00:16,  4.22s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0213, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9525, 'compress@10': 0.1888, 'time@10': 5.1146}:  70%|███████   | 7/10 [00:24<00:11,  3.86s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0212, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9527, 'compress@10': 0.1688, 'time@10': 5.026}:  70%|███████   | 7/10 [00:29<00:11,  3.86s/it]   {'epoch': 31, 'num_users': 6.125, 'loss': 0.0212, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9527, 'compress@10': 0.1688, 'time@10': 5.026}:  80%|████████  | 8/10 [00:29<00:08,  4.05s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0223, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9492, 'compress@10': 0.1534, 'time@10': 5.3216}:  80%|████████  | 8/10 [00:33<00:08,  4.05s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0223, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9492, 'compress@10': 0.1534, 'time@10': 5.3216}:  90%|█████████ | 9/10 [00:33<00:03,  3.99s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0231, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9523, 'compress@10': 0.1403, 'time@10': 5.389}:  90%|█████████ | 9/10 [00:39<00:03,  3.99s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 0.0231, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9523, 'compress@10': 0.1403, 'time@10': 5.389}: 100%|██████████| 10/10 [00:39<00:00,  4.63s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0231, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9523, 'compress@10': 0.1403, 'time@10': 5.389}: 100%|██████████| 10/10 [00:39<00:00,  3.93s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.02305238660886972
Avg hit ratio: 0.9088906381300269
Avg ndcg: 0.9523056790126552
Avg compression ratio: 0.140345449101275
Avg train time: 5.389035892486572
Std train time: 1.587051867359196
[0.015151515151515159, 0.015151515151515159, 0.04545454545454546, 0.07575757575757576, 0.7121212121212122, 0.015151515151515159, 0.015151515151515159, 0.015151515151515159, 0.19696969696969696, 0.015151515151515159]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.0527, 'time@10': 5.0542}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.0527, 'time@10': 5.0542}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.9417, 'compress@10': 0.0425, 'time@10': 4.6113}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.9417, 'compress@10': 0.0425, 'time@10': 4.6113}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.7536, 'ndcg@10': 0.9135, 'compress@10': 0.076, 'time@10': 4.2751}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.7536, 'ndcg@10': 0.9135, 'compress@10': 0.076, 'time@10': 4.2751}:  30%|███       | 3/10 [00:08<00:19,  2.76s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.7973, 'ndcg@10': 0.9257, 'compress@10': 0.0659, 'time@10': 4.2001}:  30%|███       | 3/10 [00:12<00:19,  2.76s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.7973, 'ndcg@10': 0.9257, 'compress@10': 0.0659, 'time@10': 4.2001}:  40%|████      | 4/10 [00:12<00:19,  3.26s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.9203, 'compress@10': 0.2514, 'time@10': 5.0141}:  40%|████      | 4/10 [00:16<00:19,  3.26s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.9203, 'compress@10': 0.2514, 'time@10': 5.0141}:  50%|█████     | 5/10 [00:16<00:17,  3.59s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.9285, 'compress@10': 0.2132, 'time@10': 5.197}:  50%|█████     | 5/10 [00:22<00:17,  3.59s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.9285, 'compress@10': 0.2132, 'time@10': 5.197}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9295, 'compress@10': 0.1885, 'time@10': 5.3933}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9295, 'compress@10': 0.1885, 'time@10': 5.3933}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9451, 'compress@10': 0.1685, 'time@10': 5.3055}:  70%|███████   | 7/10 [00:31<00:12,  4.09s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9451, 'compress@10': 0.1685, 'time@10': 5.3055}:  80%|████████  | 8/10 [00:31<00:08,  4.29s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9567, 'compress@10': 0.1531, 'time@10': 5.629}:  80%|████████  | 8/10 [00:35<00:08,  4.29s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9567, 'compress@10': 0.1531, 'time@10': 5.629}:  90%|█████████ | 9/10 [00:35<00:04,  4.25s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9585, 'compress@10': 0.14, 'time@10': 5.6623}:  90%|█████████ | 9/10 [00:41<00:04,  4.25s/it]    {'epoch': 32, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9585, 'compress@10': 0.14, 'time@10': 5.6623}: 100%|██████████| 10/10 [00:41<00:00,  4.79s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9585, 'compress@10': 0.14, 'time@10': 5.6623}: 100%|██████████| 10/10 [00:41<00:00,  4.12s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.013310484606870765
Avg hit ratio: 0.8756417902037598
Avg ndcg: 0.9585069520102515
Avg compression ratio: 0.1400259265264931
Avg train time: 5.662336730957032
Std train time: 1.5835958276587412
[0.014705882352941183, 0.014705882352941183, 0.04411764705882354, 0.07352941176470588, 0.6911764705882353, 0.014705882352941183, 0.014705882352941183, 0.014705882352941183, 0.22058823529411764, 0.014705882352941183]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9204, 'compress@10': 0.0527, 'time@10': 5.1449}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9204, 'compress@10': 0.0527, 'time@10': 5.1449}:  10%|█         | 1/10 [00:02<00:23,  2.61s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9416, 'compress@10': 0.0425, 'time@10': 4.6688}:  10%|█         | 1/10 [00:06<00:23,  2.61s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9416, 'compress@10': 0.0425, 'time@10': 4.6688}:  20%|██        | 2/10 [00:06<00:28,  3.57s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9135, 'compress@10': 0.076, 'time@10': 4.3148}:  20%|██        | 2/10 [00:08<00:28,  3.57s/it]  {'epoch': 33, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9135, 'compress@10': 0.076, 'time@10': 4.3148}:  30%|███       | 3/10 [00:08<00:19,  2.78s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.931, 'compress@10': 0.0659, 'time@10': 4.2277}:  30%|███       | 3/10 [00:12<00:19,  2.78s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.931, 'compress@10': 0.0659, 'time@10': 4.2277}:  40%|████      | 4/10 [00:12<00:19,  3.27s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.9249, 'compress@10': 0.2507, 'time@10': 5.0297}:  40%|████      | 4/10 [00:16<00:19,  3.27s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.9249, 'compress@10': 0.2507, 'time@10': 5.0297}:  50%|█████     | 5/10 [00:16<00:17,  3.59s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9342, 'compress@10': 0.2126, 'time@10': 5.2158}:  50%|█████     | 5/10 [00:23<00:17,  3.59s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9342, 'compress@10': 0.2126, 'time@10': 5.2158}:  60%|██████    | 6/10 [00:23<00:17,  4.47s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9372, 'compress@10': 0.188, 'time@10': 5.3967}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9372, 'compress@10': 0.188, 'time@10': 5.3967}:  70%|███████   | 7/10 [00:26<00:12,  4.08s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9423, 'compress@10': 0.1681, 'time@10': 5.3105}:  70%|███████   | 7/10 [00:31<00:12,  4.08s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9423, 'compress@10': 0.1681, 'time@10': 5.3105}:  80%|████████  | 8/10 [00:31<00:08,  4.29s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9425, 'compress@10': 0.1528, 'time@10': 5.6618}:  80%|████████  | 8/10 [00:35<00:08,  4.29s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9425, 'compress@10': 0.1528, 'time@10': 5.6618}:  90%|█████████ | 9/10 [00:35<00:04,  4.29s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9453, 'compress@10': 0.1398, 'time@10': 5.6882}:  90%|█████████ | 9/10 [00:41<00:04,  4.29s/it]  {'epoch': 33, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9453, 'compress@10': 0.1398, 'time@10': 5.6882}: 100%|██████████| 10/10 [00:41<00:00,  4.81s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9453, 'compress@10': 0.1398, 'time@10': 5.6882}: 100%|██████████| 10/10 [00:41<00:00,  4.13s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.016070682543669244
Avg hit ratio: 0.8885219745355568
Avg ndcg: 0.9453392363730723
Avg compression ratio: 0.1398026096319787
Avg train time: 5.6881664276123045
Std train time: 1.6106065332454205
[0.014285714285714292, 0.014285714285714292, 0.042857142857142864, 0.07142857142857142, 0.6714285714285714, 0.04285714285714286, 0.014285714285714292, 0.014285714285714292, 0.21428571428571427, 0.014285714285714292]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.91, 'compress@10': 0.0527, 'time@10': 5.013}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.91, 'compress@10': 0.0527, 'time@10': 5.013}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9334, 'compress@10': 0.0425, 'time@10': 4.596}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9334, 'compress@10': 0.0425, 'time@10': 4.596}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.908, 'compress@10': 0.076, 'time@10': 4.2652}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.908, 'compress@10': 0.076, 'time@10': 4.2652}:  30%|███       | 3/10 [00:08<00:19,  2.76s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9216, 'compress@10': 0.0659, 'time@10': 4.1891}:  30%|███       | 3/10 [00:12<00:19,  2.76s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9216, 'compress@10': 0.0659, 'time@10': 4.1891}:  40%|████      | 4/10 [00:12<00:19,  3.25s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9185, 'compress@10': 0.25, 'time@10': 5.0006}:  40%|████      | 4/10 [00:16<00:19,  3.25s/it]  {'epoch': 34, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9185, 'compress@10': 0.25, 'time@10': 5.0006}:  50%|█████     | 5/10 [00:16<00:17,  3.58s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.928, 'compress@10': 0.212, 'time@10': 5.1869}:  50%|█████     | 5/10 [00:22<00:17,  3.58s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.928, 'compress@10': 0.212, 'time@10': 5.1869}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9315, 'compress@10': 0.1875, 'time@10': 5.3453}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9315, 'compress@10': 0.1875, 'time@10': 5.3453}:  70%|███████   | 7/10 [00:26<00:12,  4.04s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9508, 'compress@10': 0.1676, 'time@10': 5.2604}:  70%|███████   | 7/10 [00:30<00:12,  4.04s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9508, 'compress@10': 0.1676, 'time@10': 5.2604}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9621, 'compress@10': 0.1523, 'time@10': 5.5739}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9621, 'compress@10': 0.1523, 'time@10': 5.5739}:  90%|█████████ | 9/10 [00:34<00:04,  4.20s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9625, 'compress@10': 0.1394, 'time@10': 5.6118}:  90%|█████████ | 9/10 [00:40<00:04,  4.20s/it]  {'epoch': 34, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9625, 'compress@10': 0.1394, 'time@10': 5.6118}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9625, 'compress@10': 0.1394, 'time@10': 5.6118}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.016330389135652226
Avg hit ratio: 0.8843156253292077
Avg ndcg: 0.9624631656778873
Avg compression ratio: 0.1393705333087147
Avg train time: 5.611766839027405
Std train time: 1.5475104790938923
[0.013888888888888895, 0.013888888888888895, 0.04166666666666667, 0.06944444444444445, 0.6527777777777777, 0.041666666666666664, 0.013888888888888895, 0.013888888888888895, 0.2361111111111111, 0.013888888888888895]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9024, 'compress@10': 0.0527, 'time@10': 5.0235}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9024, 'compress@10': 0.0527, 'time@10': 5.0235}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.9401, 'compress@10': 0.0425, 'time@10': 4.5512}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.9401, 'compress@10': 0.0425, 'time@10': 4.5512}:  20%|██        | 2/10 [00:06<00:27,  3.47s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.706, 'ndcg@10': 0.9124, 'compress@10': 0.076, 'time@10': 4.141}:  20%|██        | 2/10 [00:08<00:27,  3.47s/it]   {'epoch': 35, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.706, 'ndcg@10': 0.9124, 'compress@10': 0.076, 'time@10': 4.141}:  30%|███       | 3/10 [00:08<00:18,  2.66s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.7705, 'ndcg@10': 0.9601, 'compress@10': 0.0659, 'time@10': 4.067}:  30%|███       | 3/10 [00:12<00:18,  2.66s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.7705, 'ndcg@10': 0.9601, 'compress@10': 0.0659, 'time@10': 4.067}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9503, 'compress@10': 0.2489, 'time@10': 4.754}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9503, 'compress@10': 0.2489, 'time@10': 4.754}:  50%|█████     | 5/10 [00:16<00:16,  3.39s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.833, 'ndcg@10': 0.962, 'compress@10': 0.2111, 'time@10': 4.931}:  50%|█████     | 5/10 [00:21<00:16,  3.39s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.833, 'ndcg@10': 0.962, 'compress@10': 0.2111, 'time@10': 4.931}:  60%|██████    | 6/10 [00:21<00:16,  4.23s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0184, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.9579, 'compress@10': 0.1867, 'time@10': 5.1289}:  60%|██████    | 6/10 [00:25<00:16,  4.23s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0184, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.9579, 'compress@10': 0.1867, 'time@10': 5.1289}:  70%|███████   | 7/10 [00:25<00:11,  3.89s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0178, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.958, 'compress@10': 0.1669, 'time@10': 5.0709}:  70%|███████   | 7/10 [00:29<00:11,  3.89s/it]  {'epoch': 35, 'num_users': 6.125, 'loss': 0.0178, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.958, 'compress@10': 0.1669, 'time@10': 5.0709}:  80%|████████  | 8/10 [00:29<00:08,  4.15s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0179, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9564, 'compress@10': 0.1519, 'time@10': 5.367}:  80%|████████  | 8/10 [00:33<00:08,  4.15s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0179, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9564, 'compress@10': 0.1519, 'time@10': 5.367}:  90%|█████████ | 9/10 [00:33<00:04,  4.07s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9584, 'compress@10': 0.139, 'time@10': 5.3632}:  90%|█████████ | 9/10 [00:39<00:04,  4.07s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9584, 'compress@10': 0.139, 'time@10': 5.3632}: 100%|██████████| 10/10 [00:39<00:00,  4.47s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9584, 'compress@10': 0.139, 'time@10': 5.3632}: 100%|██████████| 10/10 [00:39<00:00,  3.91s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.016799782052829032
Avg hit ratio: 0.8677846473466169
Avg ndcg: 0.9583528647727004
Avg compression ratio: 0.13900749018344383
Avg train time: 5.3632114887237545
Std train time: 1.4160455650219774
[0.01351351351351352, 0.01351351351351352, 0.04054054054054054, 0.0945945945945946, 0.6351351351351351, 0.040540540540540536, 0.01351351351351352, 0.01351351351351352, 0.22972972972972971, 0.01351351351351352]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9123, 'compress@10': 0.0527, 'time@10': 4.8624}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9123, 'compress@10': 0.0527, 'time@10': 4.8624}:  10%|█         | 1/10 [00:02<00:22,  2.47s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9382, 'compress@10': 0.0425, 'time@10': 4.3283}:  10%|█         | 1/10 [00:06<00:22,  2.47s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9382, 'compress@10': 0.0425, 'time@10': 4.3283}:  20%|██        | 2/10 [00:06<00:26,  3.27s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9112, 'compress@10': 0.076, 'time@10': 4.002}:  20%|██        | 2/10 [00:08<00:26,  3.27s/it]  {'epoch': 36, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9112, 'compress@10': 0.076, 'time@10': 4.002}:  30%|███       | 3/10 [00:08<00:17,  2.56s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.924, 'compress@10': 0.0659, 'time@10': 4.0053}:  30%|███       | 3/10 [00:12<00:17,  2.56s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.924, 'compress@10': 0.0659, 'time@10': 4.0053}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.9222, 'compress@10': 0.2477, 'time@10': 4.8182}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.9222, 'compress@10': 0.2477, 'time@10': 4.8182}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0079, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.931, 'compress@10': 0.2101, 'time@10': 5.0462}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0079, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.931, 'compress@10': 0.2101, 'time@10': 5.0462}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9345, 'compress@10': 0.1858, 'time@10': 5.267}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9345, 'compress@10': 0.1858, 'time@10': 5.267}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9566, 'compress@10': 0.1662, 'time@10': 5.1949}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9566, 'compress@10': 0.1662, 'time@10': 5.1949}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9696, 'compress@10': 0.1511, 'time@10': 5.5251}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9696, 'compress@10': 0.1511, 'time@10': 5.5251}:  90%|█████████ | 9/10 [00:34<00:04,  4.23s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9703, 'compress@10': 0.1383, 'time@10': 5.5701}:  90%|█████████ | 9/10 [00:40<00:04,  4.23s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9703, 'compress@10': 0.1383, 'time@10': 5.5701}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9703, 'compress@10': 0.1383, 'time@10': 5.5701}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.012440495135287433
Avg hit ratio: 0.8810898188775947
Avg ndcg: 0.9702952805470904
Avg compression ratio: 0.1383087209358916
Avg train time: 5.5700863122940065
Std train time: 1.6233748806167076
[0.013157894736842111, 0.013157894736842111, 0.03947368421052632, 0.09210526315789475, 0.6184210526315789, 0.039473684210526314, 0.013157894736842111, 0.013157894736842111, 0.25, 0.013157894736842111]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9123, 'compress@10': 0.0527, 'time@10': 4.948}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9123, 'compress@10': 0.0527, 'time@10': 4.948}:  10%|█         | 1/10 [00:02<00:22,  2.52s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9407, 'compress@10': 0.0425, 'time@10': 4.5777}:  10%|█         | 1/10 [00:06<00:22,  2.52s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9407, 'compress@10': 0.0425, 'time@10': 4.5777}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9128, 'compress@10': 0.0759, 'time@10': 4.2548}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9128, 'compress@10': 0.0759, 'time@10': 4.2548}:  30%|███       | 3/10 [00:08<00:19,  2.76s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9277, 'compress@10': 0.0659, 'time@10': 4.1778}:  30%|███       | 3/10 [00:12<00:19,  2.76s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9277, 'compress@10': 0.0659, 'time@10': 4.1778}:  40%|████      | 4/10 [00:12<00:19,  3.25s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.9256, 'compress@10': 0.2457, 'time@10': 4.9889}:  40%|████      | 4/10 [00:16<00:19,  3.25s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.9256, 'compress@10': 0.2457, 'time@10': 4.9889}:  50%|█████     | 5/10 [00:16<00:17,  3.58s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9428, 'compress@10': 0.2084, 'time@10': 5.1805}:  50%|█████     | 5/10 [00:22<00:17,  3.58s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9428, 'compress@10': 0.2084, 'time@10': 5.1805}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9448, 'compress@10': 0.1844, 'time@10': 5.3597}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9448, 'compress@10': 0.1844, 'time@10': 5.3597}:  70%|███████   | 7/10 [00:26<00:12,  4.08s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9688, 'compress@10': 0.1649, 'time@10': 5.273}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it]  {'epoch': 37, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9688, 'compress@10': 0.1649, 'time@10': 5.273}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9664, 'compress@10': 0.1504, 'time@10': 5.6032}:  80%|████████  | 8/10 [00:35<00:08,  4.28s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9664, 'compress@10': 0.1504, 'time@10': 5.6032}:  90%|█████████ | 9/10 [00:35<00:04,  4.24s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9655, 'compress@10': 0.1376, 'time@10': 5.6327}:  90%|█████████ | 9/10 [00:41<00:04,  4.24s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9655, 'compress@10': 0.1376, 'time@10': 5.6327}: 100%|██████████| 10/10 [00:41<00:00,  4.77s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9655, 'compress@10': 0.1376, 'time@10': 5.6327}: 100%|██████████| 10/10 [00:41<00:00,  4.11s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.01918357771353114
Avg hit ratio: 0.8885219745355568
Avg ndcg: 0.9655209326519252
Avg compression ratio: 0.13760045253554362
Avg train time: 5.6327417373657225
Std train time: 1.5789125364860666
[0.012820512820512827, 0.012820512820512827, 0.038461538461538464, 0.08974358974358976, 0.6025641025641025, 0.03846153846153846, 0.012820512820512827, 0.038461538461538464, 0.24358974358974358, 0.012820512820512827]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9123, 'compress@10': 0.0527, 'time@10': 5.1069}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9123, 'compress@10': 0.0527, 'time@10': 5.1069}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9603, 'compress@10': 0.0425, 'time@10': 4.6803}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9603, 'compress@10': 0.0425, 'time@10': 4.6803}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9259, 'compress@10': 0.0759, 'time@10': 4.3356}:  20%|██        | 2/10 [00:08<00:28,  3.59s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9259, 'compress@10': 0.0759, 'time@10': 4.3356}:  30%|███       | 3/10 [00:08<00:19,  2.80s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.9526, 'compress@10': 0.0659, 'time@10': 4.2524}:  30%|███       | 3/10 [00:12<00:19,  2.80s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.9526, 'compress@10': 0.0659, 'time@10': 4.2524}:  40%|████      | 4/10 [00:12<00:19,  3.29s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.9472, 'compress@10': 0.2443, 'time@10': 5.0233}:  40%|████      | 4/10 [00:16<00:19,  3.29s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.9472, 'compress@10': 0.2443, 'time@10': 5.0233}:  50%|█████     | 5/10 [00:16<00:17,  3.58s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9524, 'compress@10': 0.2073, 'time@10': 5.2139}:  50%|█████     | 5/10 [00:23<00:17,  3.58s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9524, 'compress@10': 0.2073, 'time@10': 5.2139}:  60%|██████    | 6/10 [00:23<00:17,  4.47s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9453, 'compress@10': 0.1834, 'time@10': 5.3835}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9453, 'compress@10': 0.1834, 'time@10': 5.3835}:  70%|███████   | 7/10 [00:26<00:12,  4.07s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9477, 'compress@10': 0.1641, 'time@10': 5.2879}:  70%|███████   | 7/10 [00:31<00:12,  4.07s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9477, 'compress@10': 0.1641, 'time@10': 5.2879}:  80%|████████  | 8/10 [00:31<00:08,  4.26s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9558, 'compress@10': 0.1495, 'time@10': 5.6338}:  80%|████████  | 8/10 [00:35<00:08,  4.26s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9558, 'compress@10': 0.1495, 'time@10': 5.6338}:  90%|█████████ | 9/10 [00:35<00:04,  4.26s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9578, 'compress@10': 0.1368, 'time@10': 5.6663}:  90%|█████████ | 9/10 [00:41<00:04,  4.26s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9578, 'compress@10': 0.1368, 'time@10': 5.6663}: 100%|██████████| 10/10 [00:41<00:00,  4.79s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9578, 'compress@10': 0.1368, 'time@10': 5.6663}: 100%|██████████| 10/10 [00:41<00:00,  4.12s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.013300002711777096
Avg hit ratio: 0.8875183903061663
Avg ndcg: 0.9578423149415066
Avg compression ratio: 0.13681845959225075
Avg train time: 5.666261148452759
Std train time: 1.5672492969187848
[0.012500000000000006, 0.012500000000000006, 0.037500000000000006, 0.08750000000000001, 0.5875, 0.0375, 0.012500000000000006, 0.037500000000000006, 0.2625, 0.012500000000000006]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9101, 'compress@10': 0.0527, 'time@10': 5.0033}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9101, 'compress@10': 0.0527, 'time@10': 5.0033}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9371, 'compress@10': 0.0425, 'time@10': 4.5917}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9371, 'compress@10': 0.0425, 'time@10': 4.5917}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9104, 'compress@10': 0.0759, 'time@10': 4.2686}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9104, 'compress@10': 0.0759, 'time@10': 4.2686}:  30%|███       | 3/10 [00:08<00:19,  2.76s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9234, 'compress@10': 0.0659, 'time@10': 4.2089}:  30%|███       | 3/10 [00:12<00:19,  2.76s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9234, 'compress@10': 0.0659, 'time@10': 4.2089}:  40%|████      | 4/10 [00:12<00:19,  3.28s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0083, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9247, 'compress@10': 0.2406, 'time@10': 4.9722}:  40%|████      | 4/10 [00:16<00:19,  3.28s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0083, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9247, 'compress@10': 0.2406, 'time@10': 4.9722}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9404, 'compress@10': 0.2042, 'time@10': 5.1246}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9404, 'compress@10': 0.2042, 'time@10': 5.1246}:  60%|██████    | 6/10 [00:22<00:17,  4.36s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0098, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9425, 'compress@10': 0.1807, 'time@10': 5.223}:  60%|██████    | 6/10 [00:25<00:17,  4.36s/it] {'epoch': 39, 'num_users': 6.2857, 'loss': 0.0098, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9425, 'compress@10': 0.1807, 'time@10': 5.223}:  70%|███████   | 7/10 [00:25<00:11,  3.90s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9475, 'compress@10': 0.1617, 'time@10': 5.1185}:  70%|███████   | 7/10 [00:30<00:11,  3.90s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9475, 'compress@10': 0.1617, 'time@10': 5.1185}:  80%|████████  | 8/10 [00:30<00:08,  4.07s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9485, 'compress@10': 0.1478, 'time@10': 5.4579}:  80%|████████  | 8/10 [00:34<00:08,  4.07s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9485, 'compress@10': 0.1478, 'time@10': 5.4579}:  90%|█████████ | 9/10 [00:34<00:04,  4.09s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9513, 'compress@10': 0.1353, 'time@10': 5.4748}:  90%|█████████ | 9/10 [00:39<00:04,  4.09s/it]  {'epoch': 39, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9513, 'compress@10': 0.1353, 'time@10': 5.4748}: 100%|██████████| 10/10 [00:39<00:00,  4.57s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9513, 'compress@10': 0.1353, 'time@10': 5.4748}: 100%|██████████| 10/10 [00:39<00:00,  3.98s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.011343090286432761
Avg hit ratio: 0.8942593017244971
Avg ndcg: 0.9513185802124113
Avg compression ratio: 0.13533581348721652
Avg train time: 5.474763345718384
Std train time: 1.50654669238231
[0.012195121951219518, 0.012195121951219518, 0.03658536585365854, 0.08536585365853659, 0.5731707317073171, 0.06097560975609756, 0.012195121951219518, 0.03658536585365854, 0.25609756097560976, 0.012195121951219518]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9123, 'compress@10': 0.0527, 'time@10': 5.0377}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9123, 'compress@10': 0.0527, 'time@10': 5.0377}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9558, 'compress@10': 0.0425, 'time@10': 4.6058}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9558, 'compress@10': 0.0425, 'time@10': 4.6058}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9229, 'compress@10': 0.0759, 'time@10': 4.2388}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9229, 'compress@10': 0.0759, 'time@10': 4.2388}:  30%|███       | 3/10 [00:08<00:19,  2.74s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9709, 'compress@10': 0.0659, 'time@10': 4.0764}:  30%|███       | 3/10 [00:12<00:19,  2.74s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9709, 'compress@10': 0.0659, 'time@10': 4.0764}:  40%|████      | 4/10 [00:12<00:18,  3.09s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.9632, 'compress@10': 0.2379, 'time@10': 4.8643}:  40%|████      | 4/10 [00:16<00:18,  3.09s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.9632, 'compress@10': 0.2379, 'time@10': 4.8643}:  50%|█████     | 5/10 [00:16<00:17,  3.44s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0149, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9652, 'compress@10': 0.202, 'time@10': 5.0153}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0149, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9652, 'compress@10': 0.202, 'time@10': 5.0153}:  60%|██████    | 6/10 [00:22<00:16,  4.24s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9641, 'compress@10': 0.1788, 'time@10': 5.157}:  60%|██████    | 6/10 [00:25<00:16,  4.24s/it] {'epoch': 40, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9641, 'compress@10': 0.1788, 'time@10': 5.157}:  70%|███████   | 7/10 [00:25<00:11,  3.85s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9871, 'compress@10': 0.1601, 'time@10': 5.082}:  70%|███████   | 7/10 [00:29<00:11,  3.85s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9871, 'compress@10': 0.1601, 'time@10': 5.082}:  80%|████████  | 8/10 [00:29<00:08,  4.09s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.997, 'compress@10': 0.1461, 'time@10': 5.4617}:  80%|████████  | 8/10 [00:33<00:08,  4.09s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.997, 'compress@10': 0.1461, 'time@10': 5.4617}:  90%|█████████ | 9/10 [00:33<00:04,  4.15s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.88, 'ndcg@10': 0.995, 'compress@10': 0.1338, 'time@10': 5.5108}:  90%|█████████ | 9/10 [00:39<00:04,  4.15s/it]     {'epoch': 40, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.88, 'ndcg@10': 0.995, 'compress@10': 0.1338, 'time@10': 5.5108}: 100%|██████████| 10/10 [00:39<00:00,  4.72s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.88, 'ndcg@10': 0.995, 'compress@10': 0.1338, 'time@10': 5.5108}: 100%|██████████| 10/10 [00:39<00:00,  4.00s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.020413233376610017
Avg hit ratio: 0.8799505459641284
Avg ndcg: 0.9949890016430853
Avg compression ratio: 0.13375012520580615
Avg train time: 5.510789775848389
Std train time: 1.623320960856547
[0.011904761904761911, 0.011904761904761911, 0.03571428571428572, 0.08333333333333334, 0.5595238095238095, 0.05952380952380952, 0.011904761904761911, 0.05952380952380953, 0.25, 0.011904761904761911]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9174, 'compress@10': 0.0527, 'time@10': 5.037}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9174, 'compress@10': 0.0527, 'time@10': 5.037}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9426, 'compress@10': 0.0425, 'time@10': 4.6091}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9426, 'compress@10': 0.0425, 'time@10': 4.6091}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9141, 'compress@10': 0.0759, 'time@10': 4.28}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it]   {'epoch': 41, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9141, 'compress@10': 0.0759, 'time@10': 4.28}:  30%|███       | 3/10 [00:08<00:19,  2.77s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0045, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9261, 'compress@10': 0.0659, 'time@10': 4.2156}:  30%|███       | 3/10 [00:12<00:19,  2.77s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0045, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9261, 'compress@10': 0.0659, 'time@10': 4.2156}:  40%|████      | 4/10 [00:12<00:19,  3.28s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0062, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9274, 'compress@10': 0.2354, 'time@10': 5.003}:  40%|████      | 4/10 [00:16<00:19,  3.28s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 0.0062, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9274, 'compress@10': 0.2354, 'time@10': 5.003}:  50%|█████     | 5/10 [00:16<00:17,  3.58s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9396, 'compress@10': 0.1999, 'time@10': 5.1832}:  50%|█████     | 5/10 [00:22<00:17,  3.58s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9396, 'compress@10': 0.1999, 'time@10': 5.1832}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9419, 'compress@10': 0.1771, 'time@10': 5.4043}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9419, 'compress@10': 0.1771, 'time@10': 5.4043}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9485, 'compress@10': 0.1585, 'time@10': 5.2926}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9485, 'compress@10': 0.1585, 'time@10': 5.2926}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9487, 'compress@10': 0.1446, 'time@10': 5.658}:  80%|████████  | 8/10 [00:35<00:08,  4.26s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9487, 'compress@10': 0.1446, 'time@10': 5.658}:  90%|█████████ | 9/10 [00:35<00:04,  4.28s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9514, 'compress@10': 0.1324, 'time@10': 5.6887}:  90%|█████████ | 9/10 [00:41<00:04,  4.28s/it]  {'epoch': 41, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9514, 'compress@10': 0.1324, 'time@10': 5.6887}: 100%|██████████| 10/10 [00:41<00:00,  4.81s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9514, 'compress@10': 0.1324, 'time@10': 5.6887}: 100%|██████████| 10/10 [00:41<00:00,  4.13s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.011594646413860234
Avg hit ratio: 0.8997073303983321
Avg ndcg: 0.9514443329694743
Avg compression ratio: 0.13242364005681406
Avg train time: 5.688729238510132
Std train time: 1.6398477902788882
[0.011627906976744193, 0.011627906976744193, 0.034883720930232565, 0.08139534883720931, 0.5465116279069767, 0.0813953488372093, 0.011627906976744193, 0.058139534883720936, 0.2441860465116279, 0.011627906976744193]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9174, 'compress@10': 0.0527, 'time@10': 5.0727}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9174, 'compress@10': 0.0527, 'time@10': 5.0727}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9443, 'compress@10': 0.0425, 'time@10': 4.6202}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9443, 'compress@10': 0.0425, 'time@10': 4.6202}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9153, 'compress@10': 0.0759, 'time@10': 4.2612}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9153, 'compress@10': 0.0759, 'time@10': 4.2612}:  30%|███       | 3/10 [00:08<00:19,  2.75s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9269, 'compress@10': 0.0659, 'time@10': 4.2102}:  30%|███       | 3/10 [00:12<00:19,  2.75s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9269, 'compress@10': 0.0659, 'time@10': 4.2102}:  40%|████      | 4/10 [00:12<00:19,  3.28s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9285, 'compress@10': 0.2302, 'time@10': 4.9632}:  40%|████      | 4/10 [00:16<00:19,  3.28s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9285, 'compress@10': 0.2302, 'time@10': 4.9632}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9365, 'compress@10': 0.1956, 'time@10': 5.1627}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9365, 'compress@10': 0.1956, 'time@10': 5.1627}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9377, 'compress@10': 0.1734, 'time@10': 5.3816}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9377, 'compress@10': 0.1734, 'time@10': 5.3816}:  70%|███████   | 7/10 [00:26<00:12,  4.11s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.952, 'compress@10': 0.1553, 'time@10': 5.2743}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.952, 'compress@10': 0.1553, 'time@10': 5.2743}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9676, 'compress@10': 0.1416, 'time@10': 5.6256}:  80%|████████  | 8/10 [00:35<00:08,  4.25s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9676, 'compress@10': 0.1416, 'time@10': 5.6256}:  90%|█████████ | 9/10 [00:35<00:04,  4.26s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.967, 'compress@10': 0.1297, 'time@10': 5.6578}:  90%|█████████ | 9/10 [00:41<00:04,  4.26s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.967, 'compress@10': 0.1297, 'time@10': 5.6578}: 100%|██████████| 10/10 [00:41<00:00,  4.79s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.967, 'compress@10': 0.1297, 'time@10': 5.6578}: 100%|██████████| 10/10 [00:41<00:00,  4.11s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.01497622971280583
Avg hit ratio: 0.8843156253292077
Avg ndcg: 0.9669843384269241
Avg compression ratio: 0.12968142146944978
Avg train time: 5.657794618606568
Std train time: 1.5931613987022684
[0.011363636363636371, 0.011363636363636371, 0.034090909090909095, 0.07954545454545456, 0.5340909090909091, 0.07954545454545454, 0.011363636363636371, 0.05681818181818182, 0.26136363636363635, 0.011363636363636371]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.0527, 'time@10': 5.0653}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.0527, 'time@10': 5.0653}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9431, 'compress@10': 0.0425, 'time@10': 4.6285}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9431, 'compress@10': 0.0425, 'time@10': 4.6285}:  20%|██        | 2/10 [00:06<00:28,  3.55s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9145, 'compress@10': 0.0759, 'time@10': 4.2779}:  20%|██        | 2/10 [00:08<00:28,  3.55s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9145, 'compress@10': 0.0759, 'time@10': 4.2779}:  30%|███       | 3/10 [00:08<00:19,  2.76s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9589, 'compress@10': 0.0659, 'time@10': 4.2319}:  30%|███       | 3/10 [00:12<00:19,  2.76s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9589, 'compress@10': 0.0659, 'time@10': 4.2319}:  40%|████      | 4/10 [00:12<00:19,  3.30s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.9551, 'compress@10': 0.2246, 'time@10': 4.9706}:  40%|████      | 4/10 [00:16<00:19,  3.30s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.9551, 'compress@10': 0.2246, 'time@10': 4.9706}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9681, 'compress@10': 0.1909, 'time@10': 5.1482}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9681, 'compress@10': 0.1909, 'time@10': 5.1482}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9664, 'compress@10': 0.1693, 'time@10': 5.3615}:  60%|██████    | 6/10 [00:26<00:17,  4.42s/it]  {'epoch': 43, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9664, 'compress@10': 0.1693, 'time@10': 5.3615}:  70%|███████   | 7/10 [00:26<00:12,  4.07s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9713, 'compress@10': 0.1517, 'time@10': 5.2617}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9713, 'compress@10': 0.1517, 'time@10': 5.2617}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.969, 'compress@10': 0.1386, 'time@10': 5.6081}:  80%|████████  | 8/10 [00:35<00:08,  4.24s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.969, 'compress@10': 0.1386, 'time@10': 5.6081}:  90%|█████████ | 9/10 [00:35<00:04,  4.24s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9728, 'compress@10': 0.127, 'time@10': 5.5943}:  90%|█████████ | 9/10 [00:40<00:04,  4.24s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9728, 'compress@10': 0.127, 'time@10': 5.5943}: 100%|██████████| 10/10 [00:40<00:00,  4.63s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9728, 'compress@10': 0.127, 'time@10': 5.5943}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.016705747615860217
Avg hit ratio: 0.8845818823696583
Avg ndcg: 0.9728070671567763
Avg compression ratio: 0.12703251377057462
Avg train time: 5.594340705871582
Std train time: 1.5533788087230833
[0.011111111111111118, 0.011111111111111118, 0.03333333333333334, 0.1, 0.5222222222222221, 0.07777777777777778, 0.011111111111111118, 0.05555555555555556, 0.25555555555555554, 0.011111111111111118]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.0527, 'time@10': 4.8299}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.0527, 'time@10': 4.8299}:  10%|█         | 1/10 [00:02<00:22,  2.47s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9437, 'compress@10': 0.0425, 'time@10': 4.3638}:  10%|█         | 1/10 [00:06<00:22,  2.47s/it] {'epoch': 44, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9437, 'compress@10': 0.0425, 'time@10': 4.3638}:  20%|██        | 2/10 [00:06<00:26,  3.33s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.004, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9148, 'compress@10': 0.0759, 'time@10': 4.072}:  20%|██        | 2/10 [00:08<00:26,  3.33s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.004, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9148, 'compress@10': 0.0759, 'time@10': 4.072}:  30%|███       | 3/10 [00:08<00:18,  2.63s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0038, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9267, 'compress@10': 0.0659, 'time@10': 3.9649}:  30%|███       | 3/10 [00:11<00:18,  2.63s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0038, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9267, 'compress@10': 0.0659, 'time@10': 3.9649}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0055, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9296, 'compress@10': 0.2164, 'time@10': 4.8052}:  40%|████      | 4/10 [00:15<00:18,  3.04s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0055, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9296, 'compress@10': 0.2164, 'time@10': 4.8052}:  50%|█████     | 5/10 [00:15<00:17,  3.43s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0048, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9375, 'compress@10': 0.184, 'time@10': 5.012}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0048, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9375, 'compress@10': 0.184, 'time@10': 5.012}:  60%|██████    | 6/10 [00:22<00:17,  4.33s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0052, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9403, 'compress@10': 0.1635, 'time@10': 5.2427}:  60%|██████    | 6/10 [00:25<00:17,  4.33s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0052, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9403, 'compress@10': 0.1635, 'time@10': 5.2427}:  70%|███████   | 7/10 [00:25<00:12,  4.01s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0065, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9451, 'compress@10': 0.1466, 'time@10': 5.0943}:  70%|███████   | 7/10 [00:29<00:12,  4.01s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0065, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9451, 'compress@10': 0.1466, 'time@10': 5.0943}:  80%|████████  | 8/10 [00:29<00:08,  4.04s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.957, 'compress@10': 0.1339, 'time@10': 5.4088}:  80%|████████  | 8/10 [00:33<00:08,  4.04s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.957, 'compress@10': 0.1339, 'time@10': 5.4088}:  90%|█████████ | 9/10 [00:33<00:04,  4.03s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9578, 'compress@10': 0.1228, 'time@10': 5.4463}:  90%|█████████ | 9/10 [00:39<00:04,  4.03s/it]  {'epoch': 44, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9578, 'compress@10': 0.1228, 'time@10': 5.4463}: 100%|██████████| 10/10 [00:39<00:00,  4.58s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9578, 'compress@10': 0.1228, 'time@10': 5.4463}: 100%|██████████| 10/10 [00:39<00:00,  3.94s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.009934824243066276
Avg hit ratio: 0.8828307302959256
Avg ndcg: 0.9577528311278524
Avg compression ratio: 0.12278922556090648
Avg train time: 5.446321177482605
Std train time: 1.649534372774141
[0.010869565217391311, 0.010869565217391311, 0.03260869565217392, 0.09782608695652174, 0.5108695652173912, 0.07608695652173914, 0.010869565217391311, 0.05434782608695653, 0.2717391304347826, 0.010869565217391311]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.0527, 'time@10': 4.8619}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.0527, 'time@10': 4.8619}:  10%|█         | 1/10 [00:02<00:22,  2.47s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0236, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9932, 'compress@10': 0.0425, 'time@10': 4.4749}:  10%|█         | 1/10 [00:06<00:22,  2.47s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.0236, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9932, 'compress@10': 0.0425, 'time@10': 4.4749}:  20%|██        | 2/10 [00:06<00:27,  3.45s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9479, 'compress@10': 0.0759, 'time@10': 4.1886}:  20%|██        | 2/10 [00:08<00:27,  3.45s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9479, 'compress@10': 0.0759, 'time@10': 4.1886}:  30%|███       | 3/10 [00:08<00:19,  2.72s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.9621, 'compress@10': 0.0659, 'time@10': 4.1652}:  30%|███       | 3/10 [00:12<00:19,  2.72s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.9621, 'compress@10': 0.0659, 'time@10': 4.1652}:  40%|████      | 4/10 [00:12<00:19,  3.28s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.9584, 'compress@10': 0.1925, 'time@10': 4.9161}:  40%|████      | 4/10 [00:16<00:19,  3.28s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.9584, 'compress@10': 0.1925, 'time@10': 4.9161}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9618, 'compress@10': 0.1642, 'time@10': 5.0949}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9618, 'compress@10': 0.1642, 'time@10': 5.0949}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.9614, 'compress@10': 0.1464, 'time@10': 5.3235}:  60%|██████    | 6/10 [00:26<00:17,  4.39s/it] {'epoch': 45, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.9614, 'compress@10': 0.1464, 'time@10': 5.3235}:  70%|███████   | 7/10 [00:26<00:12,  4.06s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.967, 'compress@10': 0.1317, 'time@10': 5.2285}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.967, 'compress@10': 0.1317, 'time@10': 5.2285}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9662, 'compress@10': 0.1209, 'time@10': 5.5883}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9662, 'compress@10': 0.1209, 'time@10': 5.5883}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.9674, 'compress@10': 0.1111, 'time@10': 5.6205}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]  {'epoch': 45, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.9674, 'compress@10': 0.1111, 'time@10': 5.6205}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.9674, 'compress@10': 0.1111, 'time@10': 5.6205}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.013298770708746865
Avg hit ratio: 0.8831763524157411
Avg ndcg: 0.9674332416919803
Avg compression ratio: 0.11112607317404621
Avg train time: 5.6204935073852536
Std train time: 1.5858342176567948
[0.010638297872340432, 0.03191489361702128, 0.03191489361702128, 0.09574468085106383, 0.49999999999999994, 0.07446808510638299, 0.010638297872340432, 0.053191489361702135, 0.26595744680851063, 0.010638297872340432]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.0527, 'time@10': 5.0846}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.0527, 'time@10': 5.0846}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.945, 'compress@10': 0.0425, 'time@10': 4.6357}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it] {'epoch': 46, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.945, 'compress@10': 0.0425, 'time@10': 4.6357}:  20%|██        | 2/10 [00:06<00:28,  3.56s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.7705, 'ndcg@10': 0.9157, 'compress@10': 0.076, 'time@10': 4.3079}:  20%|██        | 2/10 [00:08<00:28,  3.56s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.7705, 'ndcg@10': 0.9157, 'compress@10': 0.076, 'time@10': 4.3079}:  30%|███       | 3/10 [00:08<00:19,  2.79s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.81, 'ndcg@10': 0.9273, 'compress@10': 0.0659, 'time@10': 4.2504}:  30%|███       | 3/10 [00:12<00:19,  2.79s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.81, 'ndcg@10': 0.9273, 'compress@10': 0.0659, 'time@10': 4.2504}:  40%|████      | 4/10 [00:12<00:19,  3.31s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0061, 'hit_ratio@10': 0.84, 'ndcg@10': 0.9322, 'compress@10': 0.1556, 'time@10': 4.9799}:  40%|████      | 4/10 [00:16<00:19,  3.31s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0061, 'hit_ratio@10': 0.84, 'ndcg@10': 0.9322, 'compress@10': 0.1556, 'time@10': 4.9799}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9428, 'compress@10': 0.1334, 'time@10': 5.1551}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9428, 'compress@10': 0.1334, 'time@10': 5.1551}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9471, 'compress@10': 0.12, 'time@10': 5.3742}:  60%|██████    | 6/10 [00:26<00:17,  4.41s/it]  {'epoch': 46, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9471, 'compress@10': 0.12, 'time@10': 5.3742}:  70%|███████   | 7/10 [00:26<00:12,  4.08s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9543, 'compress@10': 0.1086, 'time@10': 5.2581}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9543, 'compress@10': 0.1086, 'time@10': 5.2581}:  80%|████████  | 8/10 [00:30<00:08,  4.21s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.9628, 'compress@10': 0.1002, 'time@10': 5.6189}:  80%|████████  | 8/10 [00:35<00:08,  4.21s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.9628, 'compress@10': 0.1002, 'time@10': 5.6189}:  90%|█████████ | 9/10 [00:35<00:04,  4.23s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.875, 'ndcg@10': 0.961, 'compress@10': 0.0925, 'time@10': 5.6507}:  90%|█████████ | 9/10 [00:41<00:04,  4.23s/it]     {'epoch': 46, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.875, 'ndcg@10': 0.961, 'compress@10': 0.0925, 'time@10': 5.6507}: 100%|██████████| 10/10 [00:41<00:00,  4.77s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.875, 'ndcg@10': 0.961, 'compress@10': 0.0925, 'time@10': 5.6507}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.014513467901438041
Avg hit ratio: 0.874996628913437
Avg ndcg: 0.9609512446972464
Avg compression ratio: 0.09247816134955522
Avg train time: 5.650685238838196
Std train time: 1.5776269635674476
[0.010416666666666673, 0.03125000000000001, 0.03125000000000001, 0.09375, 0.48958333333333326, 0.07291666666666667, 0.010416666666666673, 0.05208333333333334, 0.28125, 0.010416666666666673]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.0527, 'time@10': 4.9976}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.0527, 'time@10': 4.9976}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9809, 'compress@10': 0.0425, 'time@10': 4.6001}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9809, 'compress@10': 0.0425, 'time@10': 4.6001}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9396, 'compress@10': 0.076, 'time@10': 4.2811}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9396, 'compress@10': 0.076, 'time@10': 4.2811}:  30%|███       | 3/10 [00:08<00:19,  2.78s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9766, 'compress@10': 0.0659, 'time@10': 4.2402}:  30%|███       | 3/10 [00:12<00:19,  2.78s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9766, 'compress@10': 0.0659, 'time@10': 4.2402}:  40%|████      | 4/10 [00:12<00:19,  3.32s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0157, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9725, 'compress@10': 0.1395, 'time@10': 4.988}:  40%|████      | 4/10 [00:16<00:19,  3.32s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0157, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9725, 'compress@10': 0.1395, 'time@10': 4.988}:  50%|█████     | 5/10 [00:16<00:17,  3.58s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9731, 'compress@10': 0.1199, 'time@10': 5.1671}:  50%|█████     | 5/10 [00:22<00:17,  3.58s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9731, 'compress@10': 0.1199, 'time@10': 5.1671}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9705, 'compress@10': 0.1085, 'time@10': 5.3858}:  60%|██████    | 6/10 [00:26<00:17,  4.44s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9705, 'compress@10': 0.1085, 'time@10': 5.3858}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9734, 'compress@10': 0.0985, 'time@10': 5.2927}:  70%|███████   | 7/10 [00:31<00:12,  4.09s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9734, 'compress@10': 0.0985, 'time@10': 5.2927}:  80%|████████  | 8/10 [00:31<00:08,  4.28s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9722, 'compress@10': 0.0916, 'time@10': 5.6498}:  80%|████████  | 8/10 [00:35<00:08,  4.28s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9722, 'compress@10': 0.0916, 'time@10': 5.6498}:  90%|█████████ | 9/10 [00:35<00:04,  4.29s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9727, 'compress@10': 0.0847, 'time@10': 5.6767}:  90%|█████████ | 9/10 [00:41<00:04,  4.29s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9727, 'compress@10': 0.0847, 'time@10': 5.6767}: 100%|██████████| 10/10 [00:41<00:00,  4.80s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9727, 'compress@10': 0.0847, 'time@10': 5.6767}: 100%|██████████| 10/10 [00:41<00:00,  4.13s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.012413486121880582
Avg hit ratio: 0.8964815239467192
Avg ndcg: 0.9726814079413455
Avg compression ratio: 0.08474128789761633
Avg train time: 5.676728868484497
Std train time: 1.5758812162817835
[0.010204081632653067, 0.051020408163265314, 0.03061224489795919, 0.09183673469387756, 0.4795918367346938, 0.07142857142857144, 0.010204081632653067, 0.051020408163265314, 0.2755102040816326, 0.010204081632653067]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9282, 'compress@10': 0.0527, 'time@10': 4.9956}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9282, 'compress@10': 0.0527, 'time@10': 4.9956}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9777, 'compress@10': 0.0425, 'time@10': 4.5793}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9777, 'compress@10': 0.0425, 'time@10': 4.5793}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9375, 'compress@10': 0.076, 'time@10': 4.2086}:  20%|██        | 2/10 [00:08<00:28,  3.51s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9375, 'compress@10': 0.076, 'time@10': 4.2086}:  30%|███       | 3/10 [00:08<00:19,  2.72s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9442, 'compress@10': 0.0659, 'time@10': 4.1583}:  30%|███       | 3/10 [00:12<00:19,  2.72s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9442, 'compress@10': 0.0659, 'time@10': 4.1583}:  40%|████      | 4/10 [00:12<00:19,  3.25s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.946, 'compress@10': 0.13, 'time@10': 4.836}:  40%|████      | 4/10 [00:16<00:19,  3.25s/it]   {'epoch': 48, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.946, 'compress@10': 0.13, 'time@10': 4.836}:  50%|█████     | 5/10 [00:16<00:17,  3.45s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9574, 'compress@10': 0.1121, 'time@10': 4.9946}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9574, 'compress@10': 0.1121, 'time@10': 4.9946}:  60%|██████    | 6/10 [00:22<00:17,  4.26s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9578, 'compress@10': 0.1018, 'time@10': 5.202}:  60%|██████    | 6/10 [00:25<00:17,  4.26s/it] {'epoch': 48, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9578, 'compress@10': 0.1018, 'time@10': 5.202}:  70%|███████   | 7/10 [00:25<00:11,  3.95s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9643, 'compress@10': 0.0926, 'time@10': 5.0993}:  70%|███████   | 7/10 [00:29<00:11,  3.95s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9643, 'compress@10': 0.0926, 'time@10': 5.0993}:  80%|████████  | 8/10 [00:29<00:08,  4.10s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9777, 'compress@10': 0.0861, 'time@10': 5.4885}:  80%|████████  | 8/10 [00:34<00:08,  4.10s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9777, 'compress@10': 0.0861, 'time@10': 5.4885}:  90%|█████████ | 9/10 [00:34<00:04,  4.17s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9729, 'compress@10': 0.0798, 'time@10': 5.5357}:  90%|█████████ | 9/10 [00:40<00:04,  4.17s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9729, 'compress@10': 0.0798, 'time@10': 5.5357}: 100%|██████████| 10/10 [00:40<00:00,  4.74s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9729, 'compress@10': 0.0798, 'time@10': 5.5357}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.013945633474818822
Avg hit ratio: 0.8698076888212712
Avg ndcg: 0.9728887156476185
Avg compression ratio: 0.07978794417903591
Avg train time: 5.535668969154358
Std train time: 1.569794968702547
[0.010000000000000005, 0.05000000000000001, 0.030000000000000006, 0.09000000000000001, 0.4699999999999999, 0.07, 0.010000000000000005, 0.05000000000000001, 0.29, 0.010000000000000005]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9307, 'compress@10': 0.0527, 'time@10': 5.0394}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9307, 'compress@10': 0.0527, 'time@10': 5.0394}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9492, 'compress@10': 0.0425, 'time@10': 4.4241}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9492, 'compress@10': 0.0425, 'time@10': 4.4241}:  20%|██        | 2/10 [00:06<00:26,  3.32s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9185, 'compress@10': 0.076, 'time@10': 4.0372}:  20%|██        | 2/10 [00:08<00:26,  3.32s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9185, 'compress@10': 0.076, 'time@10': 4.0372}:  30%|███       | 3/10 [00:08<00:17,  2.57s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9381, 'compress@10': 0.0659, 'time@10': 4.0382}:  30%|███       | 3/10 [00:12<00:17,  2.57s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9381, 'compress@10': 0.0659, 'time@10': 4.0382}:  40%|████      | 4/10 [00:12<00:18,  3.17s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9428, 'compress@10': 0.1227, 'time@10': 4.766}:  40%|████      | 4/10 [00:16<00:18,  3.17s/it]  {'epoch': 49, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9428, 'compress@10': 0.1227, 'time@10': 4.766}:  50%|█████     | 5/10 [00:16<00:17,  3.42s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0068, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9485, 'compress@10': 0.106, 'time@10': 4.9059}:  50%|█████     | 5/10 [00:21<00:17,  3.42s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0068, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9485, 'compress@10': 0.106, 'time@10': 4.9059}:  60%|██████    | 6/10 [00:21<00:16,  4.18s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0063, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9501, 'compress@10': 0.0966, 'time@10': 5.0704}:  60%|██████    | 6/10 [00:24<00:16,  4.18s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0063, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9501, 'compress@10': 0.0966, 'time@10': 5.0704}:  70%|███████   | 7/10 [00:24<00:11,  3.82s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0077, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9578, 'compress@10': 0.0881, 'time@10': 4.9142}:  70%|███████   | 7/10 [00:28<00:11,  3.82s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0077, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9578, 'compress@10': 0.0881, 'time@10': 4.9142}:  80%|████████  | 8/10 [00:28<00:07,  3.83s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.009, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9582, 'compress@10': 0.0824, 'time@10': 5.1128}:  80%|████████  | 8/10 [00:32<00:07,  3.83s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.009, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9582, 'compress@10': 0.0824, 'time@10': 5.1128}:  90%|█████████ | 9/10 [00:32<00:03,  3.69s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9601, 'compress@10': 0.0765, 'time@10': 5.0685}:  90%|█████████ | 9/10 [00:36<00:03,  3.69s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9601, 'compress@10': 0.0765, 'time@10': 5.0685}: 100%|██████████| 10/10 [00:36<00:00,  4.01s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9601, 'compress@10': 0.0765, 'time@10': 5.0685}: 100%|██████████| 10/10 [00:36<00:00,  3.67s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.008326009739003982
Avg hit ratio: 0.8920299110434934
Avg ndcg: 0.9601422212972048
Avg compression ratio: 0.07645061401534106
Avg train time: 5.068510818481445
Std train time: 1.354824345940925
[0.009803921568627456, 0.04901960784313726, 0.02941176470588236, 0.08823529411764706, 0.4607843137254901, 0.06862745098039216, 0.009803921568627456, 0.04901960784313726, 0.30392156862745096, 0.009803921568627456]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
