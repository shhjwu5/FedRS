  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1425, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5145, 'compress@10': 0.4749, 'time@10': 5.5402}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1425, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5145, 'compress@10': 0.4749, 'time@10': 5.5402}:  10%|█         | 1/10 [00:02<00:25,  2.81s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.104, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.669, 'compress@10': 0.5253, 'time@10': 4.815}:  10%|█         | 1/10 [00:06<00:25,  2.81s/it]   {'epoch': 0, 'num_users': 7.0, 'loss': 0.104, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.669, 'compress@10': 0.5253, 'time@10': 4.815}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7434, 'hit_ratio@10': 0.5463, 'ndcg@10': 0.446, 'compress@10': 0.5339, 'time@10': 3.7498}:  20%|██        | 2/10 [00:07<00:28,  3.59s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7434, 'hit_ratio@10': 0.5463, 'ndcg@10': 0.446, 'compress@10': 0.5339, 'time@10': 3.7498}:  30%|███       | 3/10 [00:07<00:16,  2.34s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.58, 'hit_ratio@10': 0.6061, 'ndcg@10': 0.5065, 'compress@10': 0.5045, 'time@10': 3.7279}:  30%|███       | 3/10 [00:11<00:16,  2.34s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.58, 'hit_ratio@10': 0.6061, 'ndcg@10': 0.5065, 'compress@10': 0.5045, 'time@10': 3.7279}:  40%|████      | 4/10 [00:11<00:17,  2.88s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4825, 'hit_ratio@10': 0.6489, 'ndcg@10': 0.5581, 'compress@10': 0.4843, 'time@10': 5.6791}:  40%|████      | 4/10 [00:18<00:17,  2.88s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4825, 'hit_ratio@10': 0.6489, 'ndcg@10': 0.5581, 'compress@10': 0.4843, 'time@10': 5.6791}:  50%|█████     | 5/10 [00:18<00:21,  4.29s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4162, 'hit_ratio@10': 0.6556, 'ndcg@10': 0.5996, 'compress@10': 0.4921, 'time@10': 5.732}:  50%|█████     | 5/10 [00:24<00:21,  4.29s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4162, 'hit_ratio@10': 0.6556, 'ndcg@10': 0.5996, 'compress@10': 0.4921, 'time@10': 5.732}:  60%|██████    | 6/10 [00:24<00:19,  4.88s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.37, 'hit_ratio@10': 0.6762, 'ndcg@10': 0.6027, 'compress@10': 0.4789, 'time@10': 5.8489}:  60%|██████    | 6/10 [00:27<00:19,  4.88s/it] {'epoch': 0, 'num_users': 6.2857, 'loss': 0.37, 'hit_ratio@10': 0.6762, 'ndcg@10': 0.6027, 'compress@10': 0.4789, 'time@10': 5.8489}:  70%|███████   | 7/10 [00:27<00:13,  4.37s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3293, 'hit_ratio@10': 0.706, 'ndcg@10': 0.6284, 'compress@10': 0.4871, 'time@10': 5.6944}:  70%|███████   | 7/10 [00:32<00:13,  4.37s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3293, 'hit_ratio@10': 0.706, 'ndcg@10': 0.6284, 'compress@10': 0.4871, 'time@10': 5.6944}:  80%|████████  | 8/10 [00:32<00:08,  4.46s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2981, 'hit_ratio@10': 0.6942, 'ndcg@10': 0.6595, 'compress@10': 0.4888, 'time@10': 6.1083}:  80%|████████  | 8/10 [00:37<00:08,  4.46s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2981, 'hit_ratio@10': 0.6942, 'ndcg@10': 0.6595, 'compress@10': 0.4888, 'time@10': 6.1083}:  90%|█████████ | 9/10 [00:37<00:04,  4.55s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2734, 'hit_ratio@10': 0.718, 'ndcg@10': 0.6785, 'compress@10': 0.4872, 'time@10': 6.0821}:  90%|█████████ | 9/10 [00:42<00:04,  4.55s/it]    {'epoch': 0, 'num_users': 6.3, 'loss': 0.2734, 'hit_ratio@10': 0.718, 'ndcg@10': 0.6785, 'compress@10': 0.4872, 'time@10': 6.0821}: 100%|██████████| 10/10 [00:42<00:00,  4.96s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2734, 'hit_ratio@10': 0.718, 'ndcg@10': 0.6785, 'compress@10': 0.4872, 'time@10': 6.0821}: 100%|██████████| 10/10 [00:42<00:00,  4.29s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.2734268358760354
Avg hit ratio: 0.7179562273229505
Avg ndcg: 0.6785416203465601
Avg compression ratio: 0.4871996930309835
Avg train time: 6.082108902931213
Std train time: 3.1368342990029627
[0.75, 0.75, 0.75, 0.75, 0.75, 0.75, 0.75, 0.25, 0.75, 0.75]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0516, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8519, 'compress@10': 0.9899, 'time@10': 4.5085}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0516, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8519, 'compress@10': 0.9899, 'time@10': 4.5085}:  10%|█         | 1/10 [00:02<00:20,  2.30s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0523, 'hit_ratio@10': 0.798, 'ndcg@10': 0.854, 'compress@10': 0.9913, 'time@10': 4.2955}:  10%|█         | 1/10 [00:06<00:20,  2.30s/it]  {'epoch': 1, 'num_users': 7.0, 'loss': 0.0523, 'hit_ratio@10': 0.798, 'ndcg@10': 0.854, 'compress@10': 0.9913, 'time@10': 4.2955}:  20%|██        | 2/10 [00:06<00:27,  3.38s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0397, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8408, 'compress@10': 0.99, 'time@10': 3.4451}:  20%|██        | 2/10 [00:07<00:27,  3.38s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0397, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8408, 'compress@10': 0.99, 'time@10': 3.4451}:  30%|███       | 3/10 [00:07<00:15,  2.25s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0422, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8413, 'compress@10': 0.9902, 'time@10': 3.4868}:  30%|███       | 3/10 [00:10<00:15,  2.25s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0422, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8413, 'compress@10': 0.9902, 'time@10': 3.4868}:  40%|████      | 4/10 [00:10<00:16,  2.80s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0513, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8301, 'compress@10': 0.9896, 'time@10': 5.1968}:  40%|████      | 4/10 [00:17<00:16,  2.80s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0513, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8301, 'compress@10': 0.9896, 'time@10': 5.1968}:  50%|█████     | 5/10 [00:17<00:19,  3.98s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0556, 'hit_ratio@10': 0.7998, 'ndcg@10': 0.8268, 'compress@10': 0.9899, 'time@10': 5.3295}:  50%|█████     | 5/10 [00:23<00:19,  3.98s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0556, 'hit_ratio@10': 0.7998, 'ndcg@10': 0.8268, 'compress@10': 0.9899, 'time@10': 5.3295}:  60%|██████    | 6/10 [00:23<00:18,  4.68s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0537, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8322, 'compress@10': 0.99, 'time@10': 5.4904}:  60%|██████    | 6/10 [00:26<00:18,  4.68s/it]  {'epoch': 1, 'num_users': 6.2857, 'loss': 0.0537, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8322, 'compress@10': 0.99, 'time@10': 5.4904}:  70%|███████   | 7/10 [00:26<00:12,  4.22s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0518, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8379, 'compress@10': 0.8711, 'time@10': 5.3921}:  70%|███████   | 7/10 [00:31<00:12,  4.22s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0518, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8379, 'compress@10': 0.8711, 'time@10': 5.3921}:  80%|████████  | 8/10 [00:31<00:08,  4.38s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0499, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8464, 'compress@10': 0.8842, 'time@10': 5.7171}:  80%|████████  | 8/10 [00:35<00:08,  4.38s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0499, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8464, 'compress@10': 0.8842, 'time@10': 5.7171}:  90%|█████████ | 9/10 [00:35<00:04,  4.32s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0496, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8468, 'compress@10': 0.8946, 'time@10': 5.7344}:  90%|█████████ | 9/10 [00:41<00:04,  4.32s/it]    {'epoch': 1, 'num_users': 6.3, 'loss': 0.0496, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8468, 'compress@10': 0.8946, 'time@10': 5.7344}: 100%|██████████| 10/10 [00:41<00:00,  4.82s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0496, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8468, 'compress@10': 0.8946, 'time@10': 5.7344}: 100%|██████████| 10/10 [00:41<00:00,  4.12s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.049611280173011814
Avg hit ratio: 0.8290441891630348
Avg ndcg: 0.8467594948161903
Avg compression ratio: 0.8946497395485821
Avg train time: 5.734423995018005
Std train time: 2.69667853031064
[0.8333333333333334, 0.8333333333333334, 0.5, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.5, 0.8333333333333334, 0.8333333333333334]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.9978, 'time@10': 4.4279}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.9978, 'time@10': 4.4279}:  10%|█         | 1/10 [00:02<00:20,  2.25s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0499, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8497, 'compress@10': 0.9977, 'time@10': 4.3081}:  10%|█         | 1/10 [00:06<00:20,  2.25s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0499, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8497, 'compress@10': 0.9977, 'time@10': 4.3081}:  20%|██        | 2/10 [00:06<00:27,  3.41s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8522, 'compress@10': 0.8181, 'time@10': 3.5303}:  20%|██        | 2/10 [00:07<00:27,  3.41s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8522, 'compress@10': 0.8181, 'time@10': 3.5303}:  30%|███       | 3/10 [00:07<00:16,  2.32s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0379, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8498, 'compress@10': 0.863, 'time@10': 3.5685}:  30%|███       | 3/10 [00:11<00:16,  2.32s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.0379, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8498, 'compress@10': 0.863, 'time@10': 3.5685}:  40%|████      | 4/10 [00:11<00:17,  2.88s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0477, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8364, 'compress@10': 0.8898, 'time@10': 5.0281}:  40%|████      | 4/10 [00:16<00:17,  2.88s/it] {'epoch': 2, 'num_users': 5.8, 'loss': 0.0477, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8364, 'compress@10': 0.8898, 'time@10': 5.0281}:  50%|█████     | 5/10 [00:16<00:19,  3.81s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0522, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8334, 'compress@10': 0.9078, 'time@10': 5.2035}:  50%|█████     | 5/10 [00:22<00:19,  3.81s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0522, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8334, 'compress@10': 0.9078, 'time@10': 5.2035}:  60%|██████    | 6/10 [00:22<00:18,  4.60s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8357, 'compress@10': 0.9206, 'time@10': 5.4058}:  60%|██████    | 6/10 [00:26<00:18,  4.60s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8357, 'compress@10': 0.9206, 'time@10': 5.4058}:  70%|███████   | 7/10 [00:26<00:12,  4.19s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0508, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8437, 'compress@10': 0.8759, 'time@10': 5.3095}:  70%|███████   | 7/10 [00:30<00:12,  4.19s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0508, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8437, 'compress@10': 0.8759, 'time@10': 5.3095}:  80%|████████  | 8/10 [00:30<00:08,  4.34s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.852, 'compress@10': 0.8895, 'time@10': 5.66}:  80%|████████  | 8/10 [00:35<00:08,  4.34s/it]  {'epoch': 2, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.852, 'compress@10': 0.8895, 'time@10': 5.66}:  90%|█████████ | 9/10 [00:35<00:04,  4.32s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8518, 'compress@10': 0.9002, 'time@10': 5.684}:  90%|█████████ | 9/10 [00:41<00:04,  4.32s/it] {'epoch': 2, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8518, 'compress@10': 0.9002, 'time@10': 5.684}: 100%|██████████| 10/10 [00:41<00:00,  4.82s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8518, 'compress@10': 0.9002, 'time@10': 5.684}: 100%|██████████| 10/10 [00:41<00:00,  4.11s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.049881289224822115
Avg hit ratio: 0.8261870463058918
Avg ndcg: 0.8517980272476902
Avg compression ratio: 0.9002243646028919
Avg train time: 5.684038519859314
Std train time: 2.415439656915974
[0.875, 0.875, 0.375, 0.875, 0.875, 0.875, 0.875, 0.625, 0.875, 0.875]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.9989, 'time@10': 4.4768}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.9989, 'time@10': 4.4768}:  10%|█         | 1/10 [00:02<00:20,  2.27s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8535, 'compress@10': 0.9989, 'time@10': 4.257}:  10%|█         | 1/10 [00:06<00:20,  2.27s/it] {'epoch': 3, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8535, 'compress@10': 0.9989, 'time@10': 4.257}:  20%|██        | 2/10 [00:06<00:26,  3.33s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8547, 'compress@10': 0.7273, 'time@10': 3.5508}:  20%|██        | 2/10 [00:07<00:26,  3.33s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8547, 'compress@10': 0.7273, 'time@10': 3.5508}:  30%|███       | 3/10 [00:07<00:16,  2.32s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.853, 'compress@10': 0.7952, 'time@10': 3.5883}:  30%|███       | 3/10 [00:11<00:16,  2.32s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.853, 'compress@10': 0.7952, 'time@10': 3.5883}:  40%|████      | 4/10 [00:11<00:17,  2.88s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0464, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8405, 'compress@10': 0.8359, 'time@10': 4.7986}:  40%|████      | 4/10 [00:16<00:17,  2.88s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0464, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8405, 'compress@10': 0.8359, 'time@10': 4.7986}:  50%|█████     | 5/10 [00:16<00:17,  3.59s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0505, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8374, 'compress@10': 0.8631, 'time@10': 5.0042}:  50%|█████     | 5/10 [00:22<00:17,  3.59s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0505, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8374, 'compress@10': 0.8631, 'time@10': 5.0042}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0506, 'hit_ratio@10': 0.8244, 'ndcg@10': 0.8354, 'compress@10': 0.8825, 'time@10': 5.2303}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0506, 'hit_ratio@10': 0.8244, 'ndcg@10': 0.8354, 'compress@10': 0.8825, 'time@10': 5.2303}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0519, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8366, 'compress@10': 0.8908, 'time@10': 5.1564}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0519, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8366, 'compress@10': 0.8908, 'time@10': 5.1564}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8253, 'ndcg@10': 0.844, 'compress@10': 0.9028, 'time@10': 5.5348}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8253, 'ndcg@10': 0.844, 'compress@10': 0.9028, 'time@10': 5.5348}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8433, 'compress@10': 0.9124, 'time@10': 5.5702}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8433, 'compress@10': 0.9124, 'time@10': 5.5702}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8433, 'compress@10': 0.9124, 'time@10': 5.5702}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.050449980673050884
Avg hit ratio: 0.8359842813289333
Avg ndcg: 0.8433333361229967
Avg compression ratio: 0.9124260957258725
Avg train time: 5.570166206359863
Std train time: 2.1573942654538354
[0.9, 0.9, 0.3, 0.9, 0.9, 0.9, 0.9, 0.7, 0.9, 0.9]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.9993, 'time@10': 4.4013}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.9993, 'time@10': 4.4013}:  10%|█         | 1/10 [00:02<00:20,  2.24s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8598, 'compress@10': 0.9993, 'time@10': 4.2331}:  10%|█         | 1/10 [00:06<00:20,  2.24s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8598, 'compress@10': 0.9993, 'time@10': 4.2331}:  20%|██        | 2/10 [00:06<00:26,  3.34s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8589, 'compress@10': 0.7165, 'time@10': 3.5887}:  20%|██        | 2/10 [00:07<00:26,  3.34s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8589, 'compress@10': 0.7165, 'time@10': 3.5887}:  30%|███       | 3/10 [00:07<00:16,  2.35s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8554, 'compress@10': 0.7873, 'time@10': 3.6184}:  30%|███       | 3/10 [00:11<00:16,  2.35s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8554, 'compress@10': 0.7873, 'time@10': 3.6184}:  40%|████      | 4/10 [00:11<00:17,  2.90s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0458, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8416, 'compress@10': 0.8297, 'time@10': 4.5429}:  40%|████      | 4/10 [00:15<00:17,  2.90s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0458, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8416, 'compress@10': 0.8297, 'time@10': 4.5429}:  50%|█████     | 5/10 [00:15<00:16,  3.36s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0494, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.839, 'compress@10': 0.858, 'time@10': 4.7997}:  50%|█████     | 5/10 [00:21<00:16,  3.36s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0494, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.839, 'compress@10': 0.858, 'time@10': 4.7997}:  60%|██████    | 6/10 [00:21<00:17,  4.30s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0493, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8386, 'compress@10': 0.8782, 'time@10': 5.0056}:  60%|██████    | 6/10 [00:24<00:17,  4.30s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0493, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8386, 'compress@10': 0.8782, 'time@10': 5.0056}:  70%|███████   | 7/10 [00:24<00:11,  3.93s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8424, 'compress@10': 0.8913, 'time@10': 4.8742}:  70%|███████   | 7/10 [00:28<00:11,  3.93s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8424, 'compress@10': 0.8913, 'time@10': 4.8742}:  80%|████████  | 8/10 [00:28<00:07,  3.95s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0501, 'hit_ratio@10': 0.8453, 'ndcg@10': 0.8531, 'compress@10': 0.9033, 'time@10': 5.1687}:  80%|████████  | 8/10 [00:32<00:07,  3.95s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0501, 'hit_ratio@10': 0.8453, 'ndcg@10': 0.8531, 'compress@10': 0.9033, 'time@10': 5.1687}:  90%|█████████ | 9/10 [00:32<00:03,  3.90s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0498, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.853, 'compress@10': 0.9129, 'time@10': 5.2015}:  90%|█████████ | 9/10 [00:38<00:03,  3.90s/it]    {'epoch': 4, 'num_users': 6.3, 'loss': 0.0498, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.853, 'compress@10': 0.9129, 'time@10': 5.2015}: 100%|██████████| 10/10 [00:38<00:00,  4.41s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0498, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.853, 'compress@10': 0.9129, 'time@10': 5.2015}: 100%|██████████| 10/10 [00:38<00:00,  3.81s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04976093309958746
Avg hit ratio: 0.8539366622813143
Avg ndcg: 0.8529947316706676
Avg compression ratio: 0.9129471246841661
Avg train time: 5.201521563529968
Std train time: 1.7527637842512558
[0.9166666666666667, 0.9166666666666667, 0.25, 0.9166666666666667, 0.9166666666666667, 0.9166666666666667, 0.9166666666666667, 0.75, 0.9166666666666667, 0.9166666666666667]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.9995, 'time@10': 4.4461}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.9995, 'time@10': 4.4461}:  10%|█         | 1/10 [00:02<00:20,  2.26s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8517, 'compress@10': 0.9995, 'time@10': 4.2083}:  10%|█         | 1/10 [00:06<00:20,  2.26s/it] {'epoch': 5, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8517, 'compress@10': 0.9995, 'time@10': 4.2083}:  20%|██        | 2/10 [00:06<00:26,  3.29s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8535, 'compress@10': 0.7151, 'time@10': 3.6164}:  20%|██        | 2/10 [00:07<00:26,  3.29s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8535, 'compress@10': 0.7151, 'time@10': 3.6164}:  30%|███       | 3/10 [00:07<00:16,  2.36s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8472, 'compress@10': 0.7863, 'time@10': 3.6329}:  30%|███       | 3/10 [00:11<00:16,  2.36s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8472, 'compress@10': 0.7863, 'time@10': 3.6329}:  40%|████      | 4/10 [00:11<00:17,  2.90s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0454, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8351, 'compress@10': 0.8289, 'time@10': 4.5224}:  40%|████      | 4/10 [00:15<00:17,  2.90s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0454, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8351, 'compress@10': 0.8289, 'time@10': 4.5224}:  50%|█████     | 5/10 [00:15<00:16,  3.33s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0484, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8331, 'compress@10': 0.8574, 'time@10': 4.784}:  50%|█████     | 5/10 [00:21<00:16,  3.33s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0484, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8331, 'compress@10': 0.8574, 'time@10': 4.784}:  60%|██████    | 6/10 [00:21<00:17,  4.28s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0474, 'hit_ratio@10': 0.858, 'ndcg@10': 0.837, 'compress@10': 0.8777, 'time@10': 5.0466}:  60%|██████    | 6/10 [00:24<00:17,  4.28s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0474, 'hit_ratio@10': 0.858, 'ndcg@10': 0.837, 'compress@10': 0.8777, 'time@10': 5.0466}:  70%|███████   | 7/10 [00:24<00:11,  3.98s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0485, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8412, 'compress@10': 0.8921, 'time@10': 4.9956}:  70%|███████   | 7/10 [00:29<00:11,  3.98s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0485, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8412, 'compress@10': 0.8921, 'time@10': 4.9956}:  80%|████████  | 8/10 [00:29<00:08,  4.20s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0488, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8471, 'compress@10': 0.904, 'time@10': 5.3812}:  80%|████████  | 8/10 [00:33<00:08,  4.20s/it] {'epoch': 5, 'num_users': 6.3333, 'loss': 0.0488, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8471, 'compress@10': 0.904, 'time@10': 5.3812}:  90%|█████████ | 9/10 [00:33<00:04,  4.22s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0483, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8477, 'compress@10': 0.9136, 'time@10': 5.4343}:  90%|█████████ | 9/10 [00:39<00:04,  4.22s/it] {'epoch': 5, 'num_users': 6.3, 'loss': 0.0483, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8477, 'compress@10': 0.9136, 'time@10': 5.4343}: 100%|██████████| 10/10 [00:39<00:00,  4.76s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0483, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8477, 'compress@10': 0.9136, 'time@10': 5.4343}: 100%|██████████| 10/10 [00:39<00:00,  3.97s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.048312757679905914
Avg hit ratio: 0.8680759351947808
Avg ndcg: 0.8476736015124245
Avg compression ratio: 0.913560011801213
Avg train time: 5.43430655002594
Std train time: 1.8466531667410975
[0.9285714285714286, 0.9285714285714286, 0.2142857142857143, 0.9285714285714286, 0.9285714285714286, 0.9285714285714286, 0.9285714285714286, 0.7857142857142857, 0.9285714285714286, 0.9285714285714286]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8571, 'compress@10': 0.9996, 'time@10': 4.3527}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8571, 'compress@10': 0.9996, 'time@10': 4.3527}:  10%|█         | 1/10 [00:02<00:19,  2.21s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8551, 'compress@10': 0.9997, 'time@10': 4.1048}:  10%|█         | 1/10 [00:06<00:19,  2.21s/it] {'epoch': 6, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8551, 'compress@10': 0.9997, 'time@10': 4.1048}:  20%|██        | 2/10 [00:06<00:25,  3.20s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8558, 'compress@10': 0.7148, 'time@10': 3.6092}:  20%|██        | 2/10 [00:07<00:25,  3.20s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8558, 'compress@10': 0.7148, 'time@10': 3.6092}:  30%|███       | 3/10 [00:07<00:16,  2.36s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.038, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8495, 'compress@10': 0.786, 'time@10': 3.6273}:  30%|███       | 3/10 [00:11<00:16,  2.36s/it]  {'epoch': 6, 'num_users': 5.0, 'loss': 0.038, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8495, 'compress@10': 0.786, 'time@10': 3.6273}:  40%|████      | 4/10 [00:11<00:17,  2.90s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0466, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8372, 'compress@10': 0.8288, 'time@10': 4.5316}:  40%|████      | 4/10 [00:15<00:17,  2.90s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0466, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8372, 'compress@10': 0.8288, 'time@10': 4.5316}:  50%|█████     | 5/10 [00:15<00:16,  3.34s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0487, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8359, 'compress@10': 0.8573, 'time@10': 4.7936}:  50%|█████     | 5/10 [00:21<00:16,  3.34s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0487, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8359, 'compress@10': 0.8573, 'time@10': 4.7936}:  60%|██████    | 6/10 [00:21<00:17,  4.29s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0473, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8414, 'compress@10': 0.8776, 'time@10': 5.0643}:  60%|██████    | 6/10 [00:24<00:17,  4.29s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0473, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8414, 'compress@10': 0.8776, 'time@10': 5.0643}:  70%|███████   | 7/10 [00:24<00:11,  4.00s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0478, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8414, 'compress@10': 0.8924, 'time@10': 5.0169}:  70%|███████   | 7/10 [00:29<00:11,  4.00s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0478, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8414, 'compress@10': 0.8924, 'time@10': 5.0169}:  80%|████████  | 8/10 [00:29<00:08,  4.23s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0476, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8523, 'compress@10': 0.9043, 'time@10': 5.4087}:  80%|████████  | 8/10 [00:33<00:08,  4.23s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0476, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8523, 'compress@10': 0.9043, 'time@10': 5.4087}:  90%|█████████ | 9/10 [00:33<00:04,  4.25s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0478, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.855, 'compress@10': 0.9139, 'time@10': 5.4576}:  90%|█████████ | 9/10 [00:39<00:04,  4.25s/it]    {'epoch': 6, 'num_users': 6.3, 'loss': 0.0478, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.855, 'compress@10': 0.9139, 'time@10': 5.4576}: 100%|██████████| 10/10 [00:39<00:00,  4.77s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0478, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.855, 'compress@10': 0.9139, 'time@10': 5.4576}: 100%|██████████| 10/10 [00:39<00:00,  3.98s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04780340512546645
Avg hit ratio: 0.8616473637662093
Avg ndcg: 0.8550195587256013
Avg compression ratio: 0.913876774229163
Avg train time: 5.457622170448303
Std train time: 1.8570305804855207
[0.9375, 0.9375, 0.1875, 0.9375, 0.9375, 0.9375, 0.9375, 0.8125, 0.9375, 0.9375]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.9997, 'time@10': 4.4119}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.9997, 'time@10': 4.4119}:  10%|█         | 1/10 [00:02<00:20,  2.25s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0452, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8562, 'compress@10': 0.9998, 'time@10': 4.1978}:  10%|█         | 1/10 [00:06<00:20,  2.25s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0452, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8562, 'compress@10': 0.9998, 'time@10': 4.1978}:  20%|██        | 2/10 [00:06<00:26,  3.29s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8565, 'compress@10': 0.7146, 'time@10': 3.6557}:  20%|██        | 2/10 [00:07<00:26,  3.29s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8565, 'compress@10': 0.7146, 'time@10': 3.6557}:  30%|███       | 3/10 [00:07<00:16,  2.40s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0414, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8499, 'compress@10': 0.786, 'time@10': 3.6678}:  30%|███       | 3/10 [00:11<00:16,  2.40s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0414, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8499, 'compress@10': 0.786, 'time@10': 3.6678}:  40%|████      | 4/10 [00:11<00:17,  2.93s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0489, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8378, 'compress@10': 0.8287, 'time@10': 4.573}:  40%|████      | 4/10 [00:15<00:17,  2.93s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0489, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8378, 'compress@10': 0.8287, 'time@10': 4.573}:  50%|█████     | 5/10 [00:15<00:16,  3.36s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.05, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8377, 'compress@10': 0.8572, 'time@10': 4.8363}:  50%|█████     | 5/10 [00:21<00:16,  3.36s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.05, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8377, 'compress@10': 0.8572, 'time@10': 4.8363}:  60%|██████    | 6/10 [00:21<00:17,  4.32s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0485, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8429, 'compress@10': 0.8776, 'time@10': 5.0958}:  60%|██████    | 6/10 [00:25<00:17,  4.32s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0485, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8429, 'compress@10': 0.8776, 'time@10': 5.0958}:  70%|███████   | 7/10 [00:25<00:12,  4.01s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0476, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8413, 'compress@10': 0.8926, 'time@10': 5.0456}:  70%|███████   | 7/10 [00:29<00:12,  4.01s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0476, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8413, 'compress@10': 0.8926, 'time@10': 5.0456}:  80%|████████  | 8/10 [00:29<00:08,  4.24s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0472, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8479, 'compress@10': 0.9045, 'time@10': 5.427}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it] {'epoch': 7, 'num_users': 6.3333, 'loss': 0.0472, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8479, 'compress@10': 0.9045, 'time@10': 5.427}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0467, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8486, 'compress@10': 0.9141, 'time@10': 5.4775}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it] {'epoch': 7, 'num_users': 6.3, 'loss': 0.0467, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8486, 'compress@10': 0.9141, 'time@10': 5.4775}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0467, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8486, 'compress@10': 0.9141, 'time@10': 5.4775}: 100%|██████████| 10/10 [00:40<00:00,  4.00s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.046666396108710054
Avg hit ratio: 0.8554445987892507
Avg ndcg: 0.8486192401459999
Avg compression ratio: 0.9140553470854357
Avg train time: 5.4775423288345335
Std train time: 1.8437973522098674
[0.9444444444444444, 0.9444444444444444, 0.16666666666666666, 0.9444444444444444, 0.9444444444444444, 0.9444444444444444, 0.9444444444444444, 0.8333333333333334, 0.9444444444444444, 0.9444444444444444]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0516, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.838, 'compress@10': 0.9998, 'time@10': 4.7117}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0516, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.838, 'compress@10': 0.9998, 'time@10': 4.7117}:  10%|█         | 1/10 [00:02<00:21,  2.41s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8441, 'compress@10': 0.9999, 'time@10': 4.4744}:  10%|█         | 1/10 [00:06<00:21,  2.41s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8441, 'compress@10': 0.9999, 'time@10': 4.4744}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8485, 'compress@10': 0.7146, 'time@10': 3.8961}:  20%|██        | 2/10 [00:08<00:28,  3.51s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8485, 'compress@10': 0.7146, 'time@10': 3.8961}:  30%|███       | 3/10 [00:08<00:17,  2.56s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8293, 'compress@10': 0.7859, 'time@10': 3.8195}:  30%|███       | 3/10 [00:11<00:17,  2.56s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8293, 'compress@10': 0.7859, 'time@10': 3.8195}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.822, 'compress@10': 0.8287, 'time@10': 4.6973}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it] {'epoch': 8, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.822, 'compress@10': 0.8287, 'time@10': 4.6973}:  50%|█████     | 5/10 [00:15<00:17,  3.40s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.047, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8258, 'compress@10': 0.8572, 'time@10': 4.9213}:  50%|█████     | 5/10 [00:21<00:17,  3.40s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.047, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8258, 'compress@10': 0.8572, 'time@10': 4.9213}:  60%|██████    | 6/10 [00:21<00:17,  4.31s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0455, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8335, 'compress@10': 0.8776, 'time@10': 5.1648}:  60%|██████    | 6/10 [00:25<00:17,  4.31s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0455, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8335, 'compress@10': 0.8776, 'time@10': 5.1648}:  70%|███████   | 7/10 [00:25<00:12,  4.00s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0442, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8384, 'compress@10': 0.8927, 'time@10': 5.1083}:  70%|███████   | 7/10 [00:30<00:12,  4.00s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0442, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8384, 'compress@10': 0.8927, 'time@10': 5.1083}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0439, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8467, 'compress@10': 0.9046, 'time@10': 5.489}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0439, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8467, 'compress@10': 0.9046, 'time@10': 5.489}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.043, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.852, 'compress@10': 0.9141, 'time@10': 5.5319}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]    {'epoch': 8, 'num_users': 6.3, 'loss': 0.043, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.852, 'compress@10': 0.9141, 'time@10': 5.5319}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.043, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.852, 'compress@10': 0.9141, 'time@10': 5.5319}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04296789285973353
Avg hit ratio: 0.8561293262481717
Avg ndcg: 0.8520105277024251
Avg compression ratio: 0.9141341127259519
Avg train time: 5.531853103637696
Std train time: 1.7993013374136193
[0.95, 0.95, 0.15, 0.95, 0.95, 0.95, 0.95, 0.8500000000000001, 0.95, 0.95]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.9999, 'time@10': 4.9056}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.9999, 'time@10': 4.9056}:  10%|█         | 1/10 [00:02<00:22,  2.49s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8566, 'compress@10': 0.9999, 'time@10': 4.4574}:  10%|█         | 1/10 [00:06<00:22,  2.49s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8566, 'compress@10': 0.9999, 'time@10': 4.4574}:  20%|██        | 2/10 [00:06<00:27,  3.41s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8568, 'compress@10': 0.7145, 'time@10': 4.0171}:  20%|██        | 2/10 [00:08<00:27,  3.41s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8568, 'compress@10': 0.7145, 'time@10': 4.0171}:  30%|███       | 3/10 [00:08<00:18,  2.59s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8504, 'compress@10': 0.7858, 'time@10': 3.8752}:  30%|███       | 3/10 [00:11<00:18,  2.59s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8504, 'compress@10': 0.7858, 'time@10': 3.8752}:  40%|████      | 4/10 [00:11<00:17,  2.94s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0408, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8395, 'compress@10': 0.8286, 'time@10': 4.5333}:  40%|████      | 4/10 [00:15<00:17,  2.94s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0408, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8395, 'compress@10': 0.8286, 'time@10': 4.5333}:  50%|█████     | 5/10 [00:15<00:15,  3.19s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0422, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8407, 'compress@10': 0.8572, 'time@10': 4.6293}:  50%|█████     | 5/10 [00:20<00:15,  3.19s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0422, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8407, 'compress@10': 0.8572, 'time@10': 4.6293}:  60%|██████    | 6/10 [00:20<00:15,  3.86s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0418, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8485, 'compress@10': 0.8776, 'time@10': 4.7436}:  60%|██████    | 6/10 [00:23<00:15,  3.86s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0418, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8485, 'compress@10': 0.8776, 'time@10': 4.7436}:  70%|███████   | 7/10 [00:23<00:10,  3.50s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0409, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.8525, 'compress@10': 0.8927, 'time@10': 4.6553}:  70%|███████   | 7/10 [00:27<00:10,  3.50s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0409, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.8525, 'compress@10': 0.8927, 'time@10': 4.6553}:  80%|████████  | 8/10 [00:27<00:07,  3.68s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0406, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.8624, 'compress@10': 0.9047, 'time@10': 5.0762}:  80%|████████  | 8/10 [00:31<00:07,  3.68s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0406, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.8624, 'compress@10': 0.9047, 'time@10': 5.0762}:  90%|█████████ | 9/10 [00:31<00:03,  3.86s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0405, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8628, 'compress@10': 0.9142, 'time@10': 5.1652}:  90%|█████████ | 9/10 [00:37<00:03,  3.86s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0405, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8628, 'compress@10': 0.9142, 'time@10': 5.1652}: 100%|██████████| 10/10 [00:37<00:00,  4.52s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0405, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8628, 'compress@10': 0.9142, 'time@10': 5.1652}: 100%|██████████| 10/10 [00:37<00:00,  3.75s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.04053814414146593
Avg hit ratio: 0.8735268498715018
Avg ndcg: 0.8628119560745509
Avg compression ratio: 0.9141737433724618
Avg train time: 5.165225887298584
Std train time: 1.5874192516972254
[0.9545454545454545, 0.9545454545454545, 0.13636363636363635, 0.9545454545454545, 0.9545454545454545, 0.9545454545454545, 0.9545454545454545, 0.8636363636363638, 0.9545454545454545, 0.9545454545454545]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8623, 'compress@10': 0.9999, 'time@10': 5.0129}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8623, 'compress@10': 0.9999, 'time@10': 5.0129}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8646, 'compress@10': 0.9999, 'time@10': 4.4301}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8646, 'compress@10': 0.9999, 'time@10': 4.4301}:  20%|██        | 2/10 [00:06<00:26,  3.34s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8621, 'compress@10': 0.7144, 'time@10': 3.9743}:  20%|██        | 2/10 [00:08<00:26,  3.34s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8621, 'compress@10': 0.7144, 'time@10': 3.9743}:  30%|███       | 3/10 [00:08<00:17,  2.53s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8619, 'compress@10': 0.7858, 'time@10': 3.8712}:  30%|███       | 3/10 [00:11<00:17,  2.53s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8619, 'compress@10': 0.7858, 'time@10': 3.8712}:  40%|████      | 4/10 [00:11<00:17,  2.96s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0376, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.8494, 'compress@10': 0.8286, 'time@10': 4.719}:  40%|████      | 4/10 [00:15<00:17,  2.96s/it] {'epoch': 10, 'num_users': 5.8, 'loss': 0.0376, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.8494, 'compress@10': 0.8286, 'time@10': 4.719}:  50%|█████     | 5/10 [00:15<00:16,  3.37s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0396, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.8508, 'compress@10': 0.8571, 'time@10': 4.9463}:  50%|█████     | 5/10 [00:21<00:16,  3.37s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0396, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.8508, 'compress@10': 0.8571, 'time@10': 4.9463}:  60%|██████    | 6/10 [00:21<00:17,  4.30s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0409, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.8572, 'compress@10': 0.8775, 'time@10': 5.1901}:  60%|██████    | 6/10 [00:25<00:17,  4.30s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0409, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.8572, 'compress@10': 0.8775, 'time@10': 5.1901}:  70%|███████   | 7/10 [00:25<00:11,  4.00s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0397, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.8598, 'compress@10': 0.8928, 'time@10': 5.1254}:  70%|███████   | 7/10 [00:29<00:11,  4.00s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0397, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.8598, 'compress@10': 0.8928, 'time@10': 5.1254}:  80%|████████  | 8/10 [00:29<00:08,  4.23s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8818, 'compress@10': 0.9047, 'time@10': 5.5007}:  80%|████████  | 8/10 [00:34<00:08,  4.23s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8818, 'compress@10': 0.9047, 'time@10': 5.5007}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0386, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8852, 'compress@10': 0.9142, 'time@10': 5.5419}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0386, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8852, 'compress@10': 0.9142, 'time@10': 5.5419}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0386, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8852, 'compress@10': 0.9142, 'time@10': 5.5419}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.038618942946530864
Avg hit ratio: 0.8836182905945215
Avg ndcg: 0.885235676282251
Avg compression ratio: 0.9141977165362004
Avg train time: 5.541866421699524
Std train time: 1.760848712552129
[0.9583333333333333, 0.9583333333333333, 0.12499999999999999, 0.9583333333333333, 0.9583333333333333, 0.9583333333333333, 0.9583333333333333, 0.8750000000000001, 0.9583333333333333, 0.9583333333333333]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0526, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8483, 'compress@10': 0.9999, 'time@10': 5.003}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0526, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8483, 'compress@10': 0.9999, 'time@10': 5.003}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8627, 'compress@10': 0.9999, 'time@10': 4.3557}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8627, 'compress@10': 0.9999, 'time@10': 4.3557}:  20%|██        | 2/10 [00:06<00:26,  3.26s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8608, 'compress@10': 0.7143, 'time@10': 3.9347}:  20%|██        | 2/10 [00:07<00:26,  3.26s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8608, 'compress@10': 0.7143, 'time@10': 3.9347}:  30%|███       | 3/10 [00:07<00:17,  2.49s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8618, 'compress@10': 0.7857, 'time@10': 3.8534}:  30%|███       | 3/10 [00:11<00:17,  2.49s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8618, 'compress@10': 0.7857, 'time@10': 3.8534}:  40%|████      | 4/10 [00:11<00:17,  2.96s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0393, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8504, 'compress@10': 0.8286, 'time@10': 4.7022}:  40%|████      | 4/10 [00:15<00:17,  2.96s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0393, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8504, 'compress@10': 0.8286, 'time@10': 4.7022}:  50%|█████     | 5/10 [00:15<00:16,  3.37s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0411, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.8537, 'compress@10': 0.8571, 'time@10': 4.9335}:  50%|█████     | 5/10 [00:21<00:16,  3.37s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0411, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.8537, 'compress@10': 0.8571, 'time@10': 4.9335}:  60%|██████    | 6/10 [00:21<00:17,  4.31s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0407, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.8544, 'compress@10': 0.8775, 'time@10': 5.2059}:  60%|██████    | 6/10 [00:25<00:17,  4.31s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0407, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.8544, 'compress@10': 0.8775, 'time@10': 5.2059}:  70%|███████   | 7/10 [00:25<00:12,  4.03s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0392, 'hit_ratio@10': 0.894, 'ndcg@10': 0.8581, 'compress@10': 0.8928, 'time@10': 5.139}:  70%|███████   | 7/10 [00:29<00:12,  4.03s/it]   {'epoch': 11, 'num_users': 6.125, 'loss': 0.0392, 'hit_ratio@10': 0.894, 'ndcg@10': 0.8581, 'compress@10': 0.8928, 'time@10': 5.139}:  80%|████████  | 8/10 [00:29<00:08,  4.25s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0423, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8823, 'compress@10': 0.9047, 'time@10': 5.5179}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0423, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8823, 'compress@10': 0.9047, 'time@10': 5.5179}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0421, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8802, 'compress@10': 0.9142, 'time@10': 5.5576}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0421, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8802, 'compress@10': 0.9142, 'time@10': 5.5576}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0421, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8802, 'compress@10': 0.9142, 'time@10': 5.5576}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.042095565780579915
Avg hit ratio: 0.8849328649090958
Avg ndcg: 0.8802371056503644
Avg compression ratio: 0.9142052755114021
Avg train time: 5.557624506950378
Std train time: 1.78431667703926
[0.9615384615384615, 0.9615384615384615, 0.11538461538461538, 0.9615384615384615, 0.9615384615384615, 0.9615384615384615, 0.9615384615384615, 0.8846153846153847, 0.9615384615384615, 0.9615384615384615]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8685, 'compress@10': 0.9999, 'time@10': 4.9618}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8685, 'compress@10': 0.9999, 'time@10': 4.9618}:  10%|█         | 1/10 [00:02<00:22,  2.52s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0389, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8786, 'compress@10': 0.9999, 'time@10': 4.4241}:  10%|█         | 1/10 [00:06<00:22,  2.52s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0389, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8786, 'compress@10': 0.9999, 'time@10': 4.4241}:  20%|██        | 2/10 [00:06<00:26,  3.35s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8715, 'compress@10': 0.7143, 'time@10': 3.9679}:  20%|██        | 2/10 [00:08<00:26,  3.35s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8715, 'compress@10': 0.7143, 'time@10': 3.9679}:  30%|███       | 3/10 [00:08<00:17,  2.54s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0342, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8859, 'compress@10': 0.7857, 'time@10': 3.9095}:  30%|███       | 3/10 [00:11<00:17,  2.54s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0342, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8859, 'compress@10': 0.7857, 'time@10': 3.9095}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0401, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8703, 'compress@10': 0.8286, 'time@10': 4.7189}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0401, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8703, 'compress@10': 0.8286, 'time@10': 4.7189}:  50%|█████     | 5/10 [00:15<00:16,  3.38s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0401, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8701, 'compress@10': 0.8571, 'time@10': 4.9518}:  50%|█████     | 5/10 [00:22<00:16,  3.38s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0401, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8701, 'compress@10': 0.8571, 'time@10': 4.9518}:  60%|██████    | 6/10 [00:22<00:17,  4.34s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0387, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.8751, 'compress@10': 0.8775, 'time@10': 5.193}:  60%|██████    | 6/10 [00:25<00:17,  4.34s/it] {'epoch': 12, 'num_users': 6.2857, 'loss': 0.0387, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.8751, 'compress@10': 0.8775, 'time@10': 5.193}:  70%|███████   | 7/10 [00:25<00:12,  4.02s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0379, 'hit_ratio@10': 0.902, 'ndcg@10': 0.8741, 'compress@10': 0.8928, 'time@10': 5.1261}:  70%|███████   | 7/10 [00:30<00:12,  4.02s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0379, 'hit_ratio@10': 0.902, 'ndcg@10': 0.8741, 'compress@10': 0.8928, 'time@10': 5.1261}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0424, 'hit_ratio@10': 0.878, 'ndcg@10': 0.8872, 'compress@10': 0.9047, 'time@10': 5.504}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0424, 'hit_ratio@10': 0.878, 'ndcg@10': 0.8872, 'compress@10': 0.9047, 'time@10': 5.504}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0401, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8911, 'compress@10': 0.9142, 'time@10': 5.5472}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it] {'epoch': 12, 'num_users': 6.3, 'loss': 0.0401, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8911, 'compress@10': 0.9142, 'time@10': 5.5472}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0401, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8911, 'compress@10': 0.9142, 'time@10': 5.5472}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.0401406299733678
Avg hit ratio: 0.8879357509119818
Avg ndcg: 0.8910616054477585
Avg compression ratio: 0.9142124389241454
Avg train time: 5.5471961259841915
Std train time: 1.7245681569812474
[0.9642857142857142, 0.9642857142857142, 0.10714285714285714, 0.9642857142857142, 0.9642857142857142, 0.9642857142857142, 0.9642857142857142, 0.8928571428571429, 0.9642857142857142, 0.9642857142857142]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8745, 'compress@10': 0.9999, 'time@10': 4.9613}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8745, 'compress@10': 0.9999, 'time@10': 4.9613}:  10%|█         | 1/10 [00:02<00:22,  2.52s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0376, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8811, 'compress@10': 0.9999, 'time@10': 4.4989}:  10%|█         | 1/10 [00:06<00:22,  2.52s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0376, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8811, 'compress@10': 0.9999, 'time@10': 4.4989}:  20%|██        | 2/10 [00:06<00:27,  3.44s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8731, 'compress@10': 0.7143, 'time@10': 4.0507}:  20%|██        | 2/10 [00:08<00:27,  3.44s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8731, 'compress@10': 0.7143, 'time@10': 4.0507}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8732, 'compress@10': 0.7857, 'time@10': 3.972}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8732, 'compress@10': 0.7857, 'time@10': 3.972}:  40%|████      | 4/10 [00:11<00:18,  3.07s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0371, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8615, 'compress@10': 0.8286, 'time@10': 4.7492}:  40%|████      | 4/10 [00:15<00:18,  3.07s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0371, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8615, 'compress@10': 0.8286, 'time@10': 4.7492}:  50%|█████     | 5/10 [00:15<00:16,  3.39s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0365, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8631, 'compress@10': 0.8571, 'time@10': 4.9738}:  50%|█████     | 5/10 [00:22<00:16,  3.39s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0365, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8631, 'compress@10': 0.8571, 'time@10': 4.9738}:  60%|██████    | 6/10 [00:22<00:17,  4.33s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0372, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8686, 'compress@10': 0.8775, 'time@10': 5.2197}:  60%|██████    | 6/10 [00:25<00:17,  4.33s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0372, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8686, 'compress@10': 0.8775, 'time@10': 5.2197}:  70%|███████   | 7/10 [00:25<00:12,  4.02s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0367, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.8669, 'compress@10': 0.8928, 'time@10': 5.1534}:  70%|███████   | 7/10 [00:30<00:12,  4.02s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0367, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.8669, 'compress@10': 0.8928, 'time@10': 5.1534}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0381, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8706, 'compress@10': 0.9047, 'time@10': 5.4472}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0381, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8706, 'compress@10': 0.9047, 'time@10': 5.4472}:  90%|█████████ | 9/10 [00:34<00:04,  4.15s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8699, 'compress@10': 0.9142, 'time@10': 5.3912}:  90%|█████████ | 9/10 [00:39<00:04,  4.15s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8699, 'compress@10': 0.9142, 'time@10': 5.3912}: 100%|██████████| 10/10 [00:39<00:00,  4.39s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8699, 'compress@10': 0.9142, 'time@10': 5.3912}: 100%|██████████| 10/10 [00:39<00:00,  3.91s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03794666348046309
Avg hit ratio: 0.8799487379249689
Avg ndcg: 0.8698863507272909
Avg compression ratio: 0.9142255633311287
Avg train time: 5.391241812705994
Std train time: 1.5679232099384661
[0.9666666666666666, 0.9666666666666666, 0.09999999999999999, 0.9666666666666666, 0.9666666666666666, 0.9666666666666666, 0.9666666666666666, 0.9, 0.9666666666666666, 0.9666666666666666]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0407, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8835, 'compress@10': 0.9999, 'time@10': 4.6411}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0407, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8835, 'compress@10': 0.9999, 'time@10': 4.6411}:  10%|█         | 1/10 [00:02<00:21,  2.36s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8857, 'compress@10': 0.9999, 'time@10': 4.1776}:  10%|█         | 1/10 [00:06<00:21,  2.36s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8857, 'compress@10': 0.9999, 'time@10': 4.1776}:  20%|██        | 2/10 [00:06<00:25,  3.18s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8762, 'compress@10': 0.7143, 'time@10': 3.6267}:  20%|██        | 2/10 [00:07<00:25,  3.18s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8762, 'compress@10': 0.7143, 'time@10': 3.6267}:  30%|███       | 3/10 [00:07<00:16,  2.33s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.874, 'compress@10': 0.7857, 'time@10': 3.5083}:  30%|███       | 3/10 [00:10<00:16,  2.33s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.874, 'compress@10': 0.7857, 'time@10': 3.5083}:  40%|████      | 4/10 [00:10<00:16,  2.67s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0328, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8625, 'compress@10': 0.8286, 'time@10': 4.3063}:  40%|████      | 4/10 [00:14<00:16,  2.67s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0328, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8625, 'compress@10': 0.8286, 'time@10': 4.3063}:  50%|█████     | 5/10 [00:14<00:15,  3.07s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0346, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8647, 'compress@10': 0.8571, 'time@10': 4.6012}:  50%|█████     | 5/10 [00:20<00:15,  3.07s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0346, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8647, 'compress@10': 0.8571, 'time@10': 4.6012}:  60%|██████    | 6/10 [00:20<00:16,  4.11s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0349, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.8639, 'compress@10': 0.8775, 'time@10': 4.897}:  60%|██████    | 6/10 [00:23<00:16,  4.11s/it] {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0349, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.8639, 'compress@10': 0.8775, 'time@10': 4.897}:  70%|███████   | 7/10 [00:23<00:11,  3.87s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0338, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.8683, 'compress@10': 0.8928, 'time@10': 4.8686}:  70%|███████   | 7/10 [00:28<00:11,  3.87s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0338, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.8683, 'compress@10': 0.8928, 'time@10': 4.8686}:  80%|████████  | 8/10 [00:28<00:08,  4.14s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0349, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8895, 'compress@10': 0.9047, 'time@10': 5.2723}:  80%|████████  | 8/10 [00:32<00:08,  4.14s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0349, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8895, 'compress@10': 0.9047, 'time@10': 5.2723}:  90%|█████████ | 9/10 [00:32<00:04,  4.18s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.8945, 'compress@10': 0.9142, 'time@10': 5.3408}:  90%|█████████ | 9/10 [00:38<00:04,  4.18s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.8945, 'compress@10': 0.9142, 'time@10': 5.3408}: 100%|██████████| 10/10 [00:38<00:00,  4.74s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.8945, 'compress@10': 0.9142, 'time@10': 5.3408}: 100%|██████████| 10/10 [00:38<00:00,  3.89s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.03253393205103458
Avg hit ratio: 0.8925107637128011
Avg ndcg: 0.8944540460584444
Avg compression ratio: 0.9142296667940881
Avg train time: 5.340846538543701
Std train time: 1.8341071246821266
[0.9687499999999999, 0.9687499999999999, 0.09374999999999999, 0.9687499999999999, 0.9687499999999999, 0.9687499999999999, 0.9687499999999999, 0.90625, 0.9687499999999999, 0.9687499999999999]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.88, 'compress@10': 0.9999, 'time@10': 5.0956}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.88, 'compress@10': 0.9999, 'time@10': 5.0956}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0339, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8883, 'compress@10': 0.9999, 'time@10': 4.5244}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0339, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8883, 'compress@10': 0.9999, 'time@10': 4.5244}:  20%|██        | 2/10 [00:06<00:27,  3.42s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0226, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.8779, 'compress@10': 0.7143, 'time@10': 4.0889}:  20%|██        | 2/10 [00:08<00:27,  3.42s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0226, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.8779, 'compress@10': 0.7143, 'time@10': 4.0889}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8787, 'compress@10': 0.7857, 'time@10': 3.9639}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8787, 'compress@10': 0.7857, 'time@10': 3.9639}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0306, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8679, 'compress@10': 0.8285, 'time@10': 4.7575}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0306, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8679, 'compress@10': 0.8285, 'time@10': 4.7575}:  50%|█████     | 5/10 [00:15<00:16,  3.37s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0317, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8737, 'compress@10': 0.8571, 'time@10': 4.9818}:  50%|█████     | 5/10 [00:22<00:16,  3.37s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0317, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8737, 'compress@10': 0.8571, 'time@10': 4.9818}:  60%|██████    | 6/10 [00:22<00:17,  4.31s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0305, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.878, 'compress@10': 0.8775, 'time@10': 5.2191}:  60%|██████    | 6/10 [00:25<00:17,  4.31s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0305, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.878, 'compress@10': 0.8775, 'time@10': 5.2191}:  70%|███████   | 7/10 [00:25<00:12,  4.00s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0297, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.8815, 'compress@10': 0.8928, 'time@10': 5.1421}:  70%|███████   | 7/10 [00:30<00:12,  4.00s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0297, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.8815, 'compress@10': 0.8928, 'time@10': 5.1421}:  80%|████████  | 8/10 [00:30<00:08,  4.21s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0293, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8876, 'compress@10': 0.9047, 'time@10': 5.5053}:  80%|████████  | 8/10 [00:34<00:08,  4.21s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0293, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8876, 'compress@10': 0.9047, 'time@10': 5.5053}:  90%|█████████ | 9/10 [00:34<00:04,  4.22s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8963, 'compress@10': 0.9142, 'time@10': 5.5389}:  90%|█████████ | 9/10 [00:40<00:04,  4.22s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8963, 'compress@10': 0.9142, 'time@10': 5.5389}: 100%|██████████| 10/10 [00:40<00:00,  4.73s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8963, 'compress@10': 0.9142, 'time@10': 5.5389}: 100%|██████████| 10/10 [00:40<00:00,  4.01s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.029413530802938494
Avg hit ratio: 0.8718758430778804
Avg ndcg: 0.8962969409574443
Avg compression ratio: 0.9142308280956222
Avg train time: 5.538914346694947
Std train time: 1.6847305649388085
[0.9705882352941175, 0.9705882352941175, 0.08823529411764705, 0.9705882352941175, 0.9705882352941175, 0.9705882352941175, 0.9705882352941175, 0.9117647058823529, 0.9705882352941175, 0.9705882352941175]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0378, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8819, 'compress@10': 1.0, 'time@10': 5.3427}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0378, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8819, 'compress@10': 1.0, 'time@10': 5.3427}:  10%|█         | 1/10 [00:02<00:24,  2.71s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8929, 'compress@10': 0.9999, 'time@10': 4.7355}:  10%|█         | 1/10 [00:06<00:24,  2.71s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8929, 'compress@10': 0.9999, 'time@10': 4.7355}:  20%|██        | 2/10 [00:06<00:28,  3.57s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.881, 'compress@10': 0.7143, 'time@10': 4.1629}:  20%|██        | 2/10 [00:08<00:28,  3.57s/it]  {'epoch': 16, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.881, 'compress@10': 0.7143, 'time@10': 4.1629}:  30%|███       | 3/10 [00:08<00:18,  2.65s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8862, 'compress@10': 0.7857, 'time@10': 4.018}:  30%|███       | 3/10 [00:12<00:18,  2.65s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8862, 'compress@10': 0.7857, 'time@10': 4.018}:  40%|████      | 4/10 [00:12<00:18,  3.04s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0301, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8749, 'compress@10': 0.8285, 'time@10': 4.8567}:  40%|████      | 4/10 [00:16<00:18,  3.04s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0301, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8749, 'compress@10': 0.8285, 'time@10': 4.8567}:  50%|█████     | 5/10 [00:16<00:17,  3.44s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0296, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.8802, 'compress@10': 0.8571, 'time@10': 5.0439}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0296, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.8802, 'compress@10': 0.8571, 'time@10': 5.0439}:  60%|██████    | 6/10 [00:22<00:17,  4.32s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0299, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.8851, 'compress@10': 0.8775, 'time@10': 5.2737}:  60%|██████    | 6/10 [00:25<00:17,  4.32s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0299, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.8851, 'compress@10': 0.8775, 'time@10': 5.2737}:  70%|███████   | 7/10 [00:25<00:12,  4.01s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0291, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.8854, 'compress@10': 0.8928, 'time@10': 5.2005}:  70%|███████   | 7/10 [00:30<00:12,  4.01s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0291, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.8854, 'compress@10': 0.8928, 'time@10': 5.2005}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0277, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.8929, 'compress@10': 0.9047, 'time@10': 5.563}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0277, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.8929, 'compress@10': 0.9047, 'time@10': 5.563}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.8935, 'compress@10': 0.9142, 'time@10': 5.6007}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]  {'epoch': 16, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.8935, 'compress@10': 0.9142, 'time@10': 5.6007}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.8935, 'compress@10': 0.9142, 'time@10': 5.6007}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.02764954316168191
Avg hit ratio: 0.902853286686903
Avg ndcg: 0.8935482551208496
Avg compression ratio: 0.9142322145533331
Avg train time: 5.600740194320679
Std train time: 1.7372212108943605
[0.9722222222222221, 0.9722222222222221, 0.08333333333333333, 0.9722222222222221, 0.9722222222222221, 0.9722222222222221, 0.9722222222222221, 0.9166666666666666, 0.9722222222222221, 0.9722222222222221]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8871, 'compress@10': 1.0, 'time@10': 5.0325}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8871, 'compress@10': 1.0, 'time@10': 5.0325}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8974, 'compress@10': 0.9999, 'time@10': 4.5654}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8974, 'compress@10': 0.9999, 'time@10': 4.5654}:  20%|██        | 2/10 [00:06<00:27,  3.49s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.884, 'compress@10': 0.7143, 'time@10': 4.0608}:  20%|██        | 2/10 [00:08<00:27,  3.49s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.884, 'compress@10': 0.7143, 'time@10': 4.0608}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8838, 'compress@10': 0.7857, 'time@10': 3.9468}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8838, 'compress@10': 0.7857, 'time@10': 3.9468}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0302, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8745, 'compress@10': 0.8285, 'time@10': 4.8086}:  40%|████      | 4/10 [00:16<00:18,  3.02s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0302, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8745, 'compress@10': 0.8285, 'time@10': 4.8086}:  50%|█████     | 5/10 [00:16<00:17,  3.43s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0314, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8837, 'compress@10': 0.8571, 'time@10': 4.9962}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0314, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8837, 'compress@10': 0.8571, 'time@10': 4.9962}:  60%|██████    | 6/10 [00:22<00:17,  4.30s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0327, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.8872, 'compress@10': 0.8775, 'time@10': 5.2276}:  60%|██████    | 6/10 [00:25<00:17,  4.30s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0327, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.8872, 'compress@10': 0.8775, 'time@10': 5.2276}:  70%|███████   | 7/10 [00:25<00:11,  3.99s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.8868, 'compress@10': 0.8928, 'time@10': 5.1547}:  70%|███████   | 7/10 [00:30<00:11,  3.99s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.8868, 'compress@10': 0.8928, 'time@10': 5.1547}:  80%|████████  | 8/10 [00:30<00:08,  4.21s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0308, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.8957, 'compress@10': 0.9047, 'time@10': 5.5211}:  80%|████████  | 8/10 [00:34<00:08,  4.21s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0308, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.8957, 'compress@10': 0.9047, 'time@10': 5.5211}:  90%|█████████ | 9/10 [00:34<00:04,  4.23s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0284, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9017, 'compress@10': 0.9142, 'time@10': 5.5581}:  90%|█████████ | 9/10 [00:40<00:04,  4.23s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0284, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9017, 'compress@10': 0.9142, 'time@10': 5.5581}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0284, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9017, 'compress@10': 0.9142, 'time@10': 5.5581}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.028424695835803565
Avg hit ratio: 0.8920596358932522
Avg ndcg: 0.901737929939164
Avg compression ratio: 0.91423238958879
Avg train time: 5.5580979347229
Std train time: 1.7424942110161978
[0.9736842105263157, 0.9736842105263157, 0.07894736842105263, 0.9736842105263157, 0.9736842105263157, 0.9736842105263157, 0.9736842105263157, 0.9210526315789473, 0.9736842105263157, 0.9736842105263157]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0332, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 5.0032}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0332, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 5.0032}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8993, 'compress@10': 0.9999, 'time@10': 4.5732}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8993, 'compress@10': 0.9999, 'time@10': 4.5732}:  20%|██        | 2/10 [00:06<00:28,  3.50s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8853, 'compress@10': 0.7143, 'time@10': 4.0211}:  20%|██        | 2/10 [00:08<00:28,  3.50s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8853, 'compress@10': 0.7143, 'time@10': 4.0211}:  30%|███       | 3/10 [00:08<00:18,  2.59s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8818, 'compress@10': 0.7857, 'time@10': 3.7682}:  30%|███       | 3/10 [00:11<00:18,  2.59s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8818, 'compress@10': 0.7857, 'time@10': 3.7682}:  40%|████      | 4/10 [00:11<00:16,  2.77s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0275, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8749, 'compress@10': 0.8285, 'time@10': 4.3874}:  40%|████      | 4/10 [00:14<00:16,  2.77s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0275, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8749, 'compress@10': 0.8285, 'time@10': 4.3874}:  50%|█████     | 5/10 [00:14<00:15,  3.02s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0282, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.8818, 'compress@10': 0.8571, 'time@10': 4.5651}:  50%|█████     | 5/10 [00:20<00:15,  3.02s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0282, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.8818, 'compress@10': 0.8571, 'time@10': 4.5651}:  60%|██████    | 6/10 [00:20<00:15,  3.86s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0281, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.8827, 'compress@10': 0.8775, 'time@10': 4.8779}:  60%|██████    | 6/10 [00:23<00:15,  3.86s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0281, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.8827, 'compress@10': 0.8775, 'time@10': 4.8779}:  70%|███████   | 7/10 [00:23<00:11,  3.72s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0285, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.8845, 'compress@10': 0.8928, 'time@10': 4.7821}:  70%|███████   | 7/10 [00:27<00:11,  3.72s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0285, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.8845, 'compress@10': 0.8928, 'time@10': 4.7821}:  80%|████████  | 8/10 [00:27<00:07,  3.85s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0292, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9073, 'compress@10': 0.9047, 'time@10': 5.0604}:  80%|████████  | 8/10 [00:31<00:07,  3.85s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0292, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9073, 'compress@10': 0.9047, 'time@10': 5.0604}:  90%|█████████ | 9/10 [00:31<00:03,  3.80s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9085, 'compress@10': 0.9142, 'time@10': 5.1305}:  90%|█████████ | 9/10 [00:37<00:03,  3.80s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9085, 'compress@10': 0.9142, 'time@10': 5.1305}: 100%|██████████| 10/10 [00:37<00:00,  4.42s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9085, 'compress@10': 0.9142, 'time@10': 5.1305}: 100%|██████████| 10/10 [00:37<00:00,  3.73s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.03036411588731497
Avg hit ratio: 0.902853286686903
Avg ndcg: 0.908498119976312
Avg compression ratio: 0.9142346519678284
Avg train time: 5.1305382490158085
Std train time: 1.4908713756795084
[0.9749999999999999, 0.9749999999999999, 0.075, 0.9749999999999999, 0.9749999999999999, 0.9749999999999999, 0.9749999999999999, 0.9249999999999999, 0.9749999999999999, 0.9749999999999999]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9005, 'compress@10': 0.9999, 'time@10': 4.9988}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9005, 'compress@10': 0.9999, 'time@10': 4.9988}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0286, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9014, 'compress@10': 0.9999, 'time@10': 4.5817}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0286, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9014, 'compress@10': 0.9999, 'time@10': 4.5817}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8866, 'compress@10': 0.7143, 'time@10': 4.1822}:  20%|██        | 2/10 [00:08<00:28,  3.52s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8866, 'compress@10': 0.7143, 'time@10': 4.1822}:  30%|███       | 3/10 [00:08<00:18,  2.71s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8917, 'compress@10': 0.7857, 'time@10': 4.1053}:  30%|███       | 3/10 [00:12<00:18,  2.71s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8917, 'compress@10': 0.7857, 'time@10': 4.1053}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8837, 'compress@10': 0.8285, 'time@10': 4.92}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]  {'epoch': 19, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8837, 'compress@10': 0.8285, 'time@10': 4.92}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0256, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8917, 'compress@10': 0.8571, 'time@10': 5.0911}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0256, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8917, 'compress@10': 0.8571, 'time@10': 5.0911}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0244, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.8984, 'compress@10': 0.8775, 'time@10': 5.312}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.0244, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.8984, 'compress@10': 0.8775, 'time@10': 5.312}:  70%|███████   | 7/10 [00:25<00:12,  4.04s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0235, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9009, 'compress@10': 0.8928, 'time@10': 5.2327}:  70%|███████   | 7/10 [00:30<00:12,  4.04s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0235, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9009, 'compress@10': 0.8928, 'time@10': 5.2327}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0267, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9281, 'compress@10': 0.9047, 'time@10': 5.5826}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0267, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9281, 'compress@10': 0.9047, 'time@10': 5.5826}:  90%|█████████ | 9/10 [00:35<00:04,  4.29s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0254, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9298, 'compress@10': 0.9142, 'time@10': 5.6165}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0254, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9298, 'compress@10': 0.9142, 'time@10': 5.6165}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0254, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9298, 'compress@10': 0.9142, 'time@10': 5.6165}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.025355249714287514
Avg hit ratio: 0.8957897946234109
Avg ndcg: 0.9297631881815385
Avg compression ratio: 0.9142387524078476
Avg train time: 5.616531896591186
Std train time: 1.6385854722096211
[0.976190476190476, 0.976190476190476, 0.07142857142857142, 0.976190476190476, 0.976190476190476, 0.976190476190476, 0.976190476190476, 0.9285714285714285, 0.976190476190476, 0.976190476190476]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8969, 'compress@10': 0.9999, 'time@10': 5.0072}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8969, 'compress@10': 0.9999, 'time@10': 5.0072}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0281, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9029, 'compress@10': 0.9999, 'time@10': 4.5889}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0281, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9029, 'compress@10': 0.9999, 'time@10': 4.5889}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8877, 'compress@10': 0.7143, 'time@10': 4.161}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8877, 'compress@10': 0.7143, 'time@10': 4.161}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.91, 'compress@10': 0.7857, 'time@10': 4.0774}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.91, 'compress@10': 0.7857, 'time@10': 4.0774}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0246, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8987, 'compress@10': 0.8285, 'time@10': 4.9088}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0246, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8987, 'compress@10': 0.8285, 'time@10': 4.9088}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0252, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9051, 'compress@10': 0.8571, 'time@10': 5.0928}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0252, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9051, 'compress@10': 0.8571, 'time@10': 5.0928}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0268, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9096, 'compress@10': 0.8775, 'time@10': 5.3065}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0268, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9096, 'compress@10': 0.8775, 'time@10': 5.3065}:  70%|███████   | 7/10 [00:25<00:12,  4.04s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0258, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9119, 'compress@10': 0.8928, 'time@10': 5.2236}:  70%|███████   | 7/10 [00:30<00:12,  4.04s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0258, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9119, 'compress@10': 0.8928, 'time@10': 5.2236}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0282, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.923, 'compress@10': 0.9047, 'time@10': 5.5898}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0282, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.923, 'compress@10': 0.9047, 'time@10': 5.5898}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9296, 'compress@10': 0.9142, 'time@10': 5.6261}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]  {'epoch': 20, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9296, 'compress@10': 0.9142, 'time@10': 5.6261}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9296, 'compress@10': 0.9142, 'time@10': 5.6261}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.028258143395672935
Avg hit ratio: 0.8985040803376965
Avg ndcg: 0.929557398386395
Avg compression ratio: 0.9142413148253311
Avg train time: 5.626127552986145
Std train time: 1.686674533431125
[0.9772727272727272, 0.9772727272727272, 0.06818181818181818, 0.9772727272727272, 0.9772727272727272, 0.9772727272727272, 0.9772727272727272, 0.9318181818181818, 0.9772727272727272, 0.9772727272727272]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8993, 'compress@10': 0.9999, 'time@10': 5.0287}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8993, 'compress@10': 0.9999, 'time@10': 5.0287}:  10%|█         | 1/10 [00:02<00:22,  2.56s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8972, 'compress@10': 0.9999, 'time@10': 4.5815}:  10%|█         | 1/10 [00:06<00:22,  2.56s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8972, 'compress@10': 0.9999, 'time@10': 4.5815}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8838, 'compress@10': 0.7143, 'time@10': 4.1311}:  20%|██        | 2/10 [00:08<00:28,  3.51s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8838, 'compress@10': 0.7143, 'time@10': 4.1311}:  30%|███       | 3/10 [00:08<00:18,  2.66s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9011, 'compress@10': 0.7857, 'time@10': 4.09}:  30%|███       | 3/10 [00:12<00:18,  2.66s/it]  {'epoch': 21, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9011, 'compress@10': 0.7857, 'time@10': 4.09}:  40%|████      | 4/10 [00:12<00:19,  3.19s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0221, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8924, 'compress@10': 0.8285, 'time@10': 4.9287}:  40%|████      | 4/10 [00:16<00:19,  3.19s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0221, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8924, 'compress@10': 0.8285, 'time@10': 4.9287}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0232, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.8984, 'compress@10': 0.8571, 'time@10': 5.106}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0232, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.8984, 'compress@10': 0.8571, 'time@10': 5.106}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0234, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.8984, 'compress@10': 0.8775, 'time@10': 5.3335}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0234, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.8984, 'compress@10': 0.8775, 'time@10': 5.3335}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0234, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.8964, 'compress@10': 0.8928, 'time@10': 5.2499}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0234, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.8964, 'compress@10': 0.8928, 'time@10': 5.2499}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9013, 'compress@10': 0.9047, 'time@10': 5.6101}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9013, 'compress@10': 0.9047, 'time@10': 5.6101}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9018, 'compress@10': 0.9142, 'time@10': 5.6357}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9018, 'compress@10': 0.9142, 'time@10': 5.6357}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9018, 'compress@10': 0.9142, 'time@10': 5.6357}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.023540386860193514
Avg hit ratio: 0.9042183660519824
Avg ndcg: 0.9018025349669498
Avg compression ratio: 0.9142418823009384
Avg train time: 5.635735750198364
Std train time: 1.6916739935283576
[0.9782608695652173, 0.9782608695652173, 0.06521739130434782, 0.9782608695652173, 0.9782608695652173, 0.9782608695652173, 0.9782608695652173, 0.9347826086956521, 0.9782608695652173, 0.9782608695652173]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9014, 'compress@10': 0.9999, 'time@10': 5.0186}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9014, 'compress@10': 0.9999, 'time@10': 5.0186}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9411, 'compress@10': 0.9999, 'time@10': 4.5778}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9411, 'compress@10': 0.9999, 'time@10': 4.5778}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9131, 'compress@10': 0.7143, 'time@10': 4.131}:  20%|██        | 2/10 [00:08<00:28,  3.51s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9131, 'compress@10': 0.7143, 'time@10': 4.131}:  30%|███       | 3/10 [00:08<00:18,  2.66s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9195, 'compress@10': 0.7857, 'time@10': 4.0756}:  30%|███       | 3/10 [00:12<00:18,  2.66s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9195, 'compress@10': 0.7857, 'time@10': 4.0756}:  40%|████      | 4/10 [00:12<00:19,  3.17s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0226, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9083, 'compress@10': 0.8285, 'time@10': 4.8823}:  40%|████      | 4/10 [00:16<00:19,  3.17s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0226, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9083, 'compress@10': 0.8285, 'time@10': 4.8823}:  50%|█████     | 5/10 [00:16<00:17,  3.50s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0228, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.9144, 'compress@10': 0.8571, 'time@10': 5.0323}:  50%|█████     | 5/10 [00:22<00:17,  3.50s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0228, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.9144, 'compress@10': 0.8571, 'time@10': 5.0323}:  60%|██████    | 6/10 [00:22<00:17,  4.29s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0215, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.9183, 'compress@10': 0.8775, 'time@10': 5.1628}:  60%|██████    | 6/10 [00:25<00:17,  4.29s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0215, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.9183, 'compress@10': 0.8775, 'time@10': 5.1628}:  70%|███████   | 7/10 [00:25<00:11,  3.88s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9157, 'compress@10': 0.8928, 'time@10': 5.0202}:  70%|███████   | 7/10 [00:29<00:11,  3.88s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9157, 'compress@10': 0.8928, 'time@10': 5.0202}:  80%|████████  | 8/10 [00:29<00:07,  3.94s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0214, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9211, 'compress@10': 0.9047, 'time@10': 5.3123}:  80%|████████  | 8/10 [00:33<00:07,  3.94s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0214, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9211, 'compress@10': 0.9047, 'time@10': 5.3123}:  90%|█████████ | 9/10 [00:33<00:03,  3.92s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9264, 'compress@10': 0.9142, 'time@10': 5.3626}:  90%|█████████ | 9/10 [00:39<00:03,  3.92s/it]    {'epoch': 22, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9264, 'compress@10': 0.9142, 'time@10': 5.3626}: 100%|██████████| 10/10 [00:39<00:00,  4.52s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9264, 'compress@10': 0.9142, 'time@10': 5.3626}: 100%|██████████| 10/10 [00:39<00:00,  3.91s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.019737721597299408
Avg hit ratio: 0.9109925596003695
Avg ndcg: 0.9264057162212425
Avg compression ratio: 0.9142431819079848
Avg train time: 5.36256353855133
Std train time: 1.5342221884098826
[0.9791666666666665, 0.9791666666666665, 0.0625, 0.9791666666666665, 0.9791666666666665, 0.9791666666666665, 0.9791666666666665, 0.9374999999999999, 0.9791666666666665, 0.9791666666666665]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 4.5056}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 4.5056}:  10%|█         | 1/10 [00:02<00:20,  2.29s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9297, 'compress@10': 0.9999, 'time@10': 4.0748}:  10%|█         | 1/10 [00:05<00:20,  2.29s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9297, 'compress@10': 0.9999, 'time@10': 4.0748}:  20%|██        | 2/10 [00:05<00:24,  3.11s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9055, 'compress@10': 0.7143, 'time@10': 3.7027}:  20%|██        | 2/10 [00:07<00:24,  3.11s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9055, 'compress@10': 0.7143, 'time@10': 3.7027}:  30%|███       | 3/10 [00:07<00:16,  2.38s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9115, 'compress@10': 0.7857, 'time@10': 3.7129}:  30%|███       | 3/10 [00:11<00:16,  2.38s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9115, 'compress@10': 0.7857, 'time@10': 3.7129}:  40%|████      | 4/10 [00:11<00:17,  2.93s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0282, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9026, 'compress@10': 0.8285, 'time@10': 4.5359}:  40%|████      | 4/10 [00:15<00:17,  2.93s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0282, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9026, 'compress@10': 0.8285, 'time@10': 4.5359}:  50%|█████     | 5/10 [00:15<00:16,  3.30s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0276, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9093, 'compress@10': 0.8571, 'time@10': 4.765}:  50%|█████     | 5/10 [00:21<00:16,  3.30s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0276, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9093, 'compress@10': 0.8571, 'time@10': 4.765}:  60%|██████    | 6/10 [00:21<00:16,  4.20s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0284, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9124, 'compress@10': 0.8775, 'time@10': 5.0447}:  60%|██████    | 6/10 [00:24<00:16,  4.20s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0284, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9124, 'compress@10': 0.8775, 'time@10': 5.0447}:  70%|███████   | 7/10 [00:24<00:11,  3.94s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.026, 'hit_ratio@10': 0.9215, 'ndcg@10': 0.9179, 'compress@10': 0.8928, 'time@10': 4.9975}:  70%|███████   | 7/10 [00:29<00:11,  3.94s/it]  {'epoch': 23, 'num_users': 6.125, 'loss': 0.026, 'hit_ratio@10': 0.9215, 'ndcg@10': 0.9179, 'compress@10': 0.8928, 'time@10': 4.9975}:  80%|████████  | 8/10 [00:29<00:08,  4.19s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0277, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9372, 'compress@10': 0.9047, 'time@10': 5.392}:  80%|████████  | 8/10 [00:33<00:08,  4.19s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0277, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9372, 'compress@10': 0.9047, 'time@10': 5.392}:  90%|█████████ | 9/10 [00:33<00:04,  4.23s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9422, 'compress@10': 0.9142, 'time@10': 5.4423}:  90%|█████████ | 9/10 [00:39<00:04,  4.23s/it]  {'epoch': 23, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9422, 'compress@10': 0.9142, 'time@10': 5.4423}: 100%|██████████| 10/10 [00:39<00:00,  4.76s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9422, 'compress@10': 0.9142, 'time@10': 5.4423}: 100%|██████████| 10/10 [00:39<00:00,  3.95s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.02940989754889774
Avg hit ratio: 0.9092183660519823
Avg ndcg: 0.9421775666132148
Avg compression ratio: 0.9142445283334972
Avg train time: 5.44225709438324
Std train time: 1.7654756569682417
[0.9799999999999999, 0.9799999999999999, 0.06, 0.9799999999999999, 0.9799999999999999, 0.9799999999999999, 0.9799999999999999, 0.94, 0.9799999999999999, 0.9799999999999999]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 4.9799}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 4.9799}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.935, 'compress@10': 1.0, 'time@10': 4.5798}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it] {'epoch': 24, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.935, 'compress@10': 1.0, 'time@10': 4.5798}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9091, 'compress@10': 0.7143, 'time@10': 4.2763}:  20%|██        | 2/10 [00:08<00:28,  3.52s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9091, 'compress@10': 0.7143, 'time@10': 4.2763}:  30%|███       | 3/10 [00:08<00:19,  2.77s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9376, 'compress@10': 0.7857, 'time@10': 4.186}:  30%|███       | 3/10 [00:12<00:19,  2.77s/it]  {'epoch': 24, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9376, 'compress@10': 0.7857, 'time@10': 4.186}:  40%|████      | 4/10 [00:12<00:19,  3.24s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9259, 'compress@10': 0.8286, 'time@10': 4.9273}:  40%|████      | 4/10 [00:16<00:19,  3.24s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9259, 'compress@10': 0.8286, 'time@10': 4.9273}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0185, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9295, 'compress@10': 0.8571, 'time@10': 5.1092}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0185, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9295, 'compress@10': 0.8571, 'time@10': 5.1092}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9278, 'compress@10': 0.8775, 'time@10': 5.3106}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9278, 'compress@10': 0.8775, 'time@10': 5.3106}:  70%|███████   | 7/10 [00:25<00:12,  4.02s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9263, 'compress@10': 0.8928, 'time@10': 5.23}:  70%|███████   | 7/10 [00:30<00:12,  4.02s/it]   {'epoch': 24, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9263, 'compress@10': 0.8928, 'time@10': 5.23}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0217, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9291, 'compress@10': 0.9047, 'time@10': 5.5901}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0217, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9291, 'compress@10': 0.9047, 'time@10': 5.5901}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9329, 'compress@10': 0.9143, 'time@10': 5.6295}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9329, 'compress@10': 0.9143, 'time@10': 5.6295}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9329, 'compress@10': 0.9143, 'time@10': 5.6295}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.020281591183419902
Avg hit ratio: 0.8932782738860837
Avg ndcg: 0.9329297568240932
Avg compression ratio: 0.9142523334540211
Avg train time: 5.629468846321106
Std train time: 1.5652426528959902
[0.9807692307692306, 0.9807692307692306, 0.05769230769230769, 0.9807692307692306, 0.9807692307692306, 0.9807692307692306, 0.9807692307692306, 0.9423076923076923, 0.9807692307692306, 0.9807692307692306]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 4.9396}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 4.9396}:  10%|█         | 1/10 [00:02<00:22,  2.51s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 4.5221}:  10%|█         | 1/10 [00:06<00:22,  2.51s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 4.5221}:  20%|██        | 2/10 [00:06<00:27,  3.47s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8998, 'compress@10': 0.7143, 'time@10': 4.2094}:  20%|██        | 2/10 [00:08<00:27,  3.47s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8998, 'compress@10': 0.7143, 'time@10': 4.2094}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9144, 'compress@10': 0.7857, 'time@10': 4.1554}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it]  {'epoch': 25, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9144, 'compress@10': 0.7857, 'time@10': 4.1554}:  40%|████      | 4/10 [00:12<00:19,  3.24s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9078, 'compress@10': 0.8286, 'time@10': 4.9259}:  40%|████      | 4/10 [00:16<00:19,  3.24s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9078, 'compress@10': 0.8286, 'time@10': 4.9259}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0187, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9162, 'compress@10': 0.8571, 'time@10': 5.1232}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0187, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9162, 'compress@10': 0.8571, 'time@10': 5.1232}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0175, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9209, 'compress@10': 0.8775, 'time@10': 5.3096}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0175, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9209, 'compress@10': 0.8775, 'time@10': 5.3096}:  70%|███████   | 7/10 [00:25<00:12,  4.04s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9178, 'compress@10': 0.8928, 'time@10': 5.2294}:  70%|███████   | 7/10 [00:30<00:12,  4.04s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9178, 'compress@10': 0.8928, 'time@10': 5.2294}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9206, 'compress@10': 0.9047, 'time@10': 5.5979}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9206, 'compress@10': 0.9047, 'time@10': 5.5979}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9262, 'compress@10': 0.9143, 'time@10': 5.63}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]     {'epoch': 25, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9262, 'compress@10': 0.9143, 'time@10': 5.63}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9262, 'compress@10': 0.9143, 'time@10': 5.63}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.017235002416714933
Avg hit ratio: 0.8932782738860837
Avg ndcg: 0.9262400828457817
Avg compression ratio: 0.9142516441385837
Avg train time: 5.629984426498413
Std train time: 1.6032013647956256
[0.9814814814814813, 0.9814814814814813, 0.05555555555555555, 0.9814814814814813, 0.9814814814814813, 0.9814814814814813, 0.9814814814814813, 0.9444444444444444, 0.9814814814814813, 0.9814814814814813]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 5.0163}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 5.0163}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0305, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9829, 'compress@10': 1.0, 'time@10': 4.5947}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0305, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9829, 'compress@10': 1.0, 'time@10': 4.5947}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.941, 'compress@10': 0.7143, 'time@10': 4.217}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.941, 'compress@10': 0.7143, 'time@10': 4.217}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9521, 'compress@10': 0.7857, 'time@10': 4.1751}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9521, 'compress@10': 0.7857, 'time@10': 4.1751}:  40%|████      | 4/10 [00:12<00:19,  3.27s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0246, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9378, 'compress@10': 0.8286, 'time@10': 4.9247}:  40%|████      | 4/10 [00:16<00:19,  3.27s/it]  {'epoch': 26, 'num_users': 5.8, 'loss': 0.0246, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9378, 'compress@10': 0.8286, 'time@10': 4.9247}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.024, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9413, 'compress@10': 0.8571, 'time@10': 5.1127}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.024, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9413, 'compress@10': 0.8571, 'time@10': 5.1127}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0249, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9411, 'compress@10': 0.8775, 'time@10': 5.3042}:  60%|██████    | 6/10 [00:26<00:17,  4.40s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0249, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9411, 'compress@10': 0.8775, 'time@10': 5.3042}:  70%|███████   | 7/10 [00:26<00:12,  4.03s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0228, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9437, 'compress@10': 0.8928, 'time@10': 5.2199}:  70%|███████   | 7/10 [00:30<00:12,  4.03s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0228, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9437, 'compress@10': 0.8928, 'time@10': 5.2199}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9467, 'compress@10': 0.9047, 'time@10': 5.5752}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9467, 'compress@10': 0.9047, 'time@10': 5.5752}:  90%|█████████ | 9/10 [00:34<00:04,  4.24s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9473, 'compress@10': 0.9143, 'time@10': 5.55}:  90%|█████████ | 9/10 [00:40<00:04,  4.24s/it]      {'epoch': 26, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9473, 'compress@10': 0.9143, 'time@10': 5.55}: 100%|██████████| 10/10 [00:40<00:00,  4.59s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9473, 'compress@10': 0.9143, 'time@10': 5.55}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.022022535160018113
Avg hit ratio: 0.8986238960058994
Avg ndcg: 0.947272101573969
Avg compression ratio: 0.9142503958332405
Avg train time: 5.550032305717468
Std train time: 1.5687698065127598
[0.982142857142857, 0.982142857142857, 0.05357142857142857, 0.982142857142857, 0.982142857142857, 0.982142857142857, 0.982142857142857, 0.9464285714285714, 0.982142857142857, 0.982142857142857]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 4.5404}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 4.5404}:  10%|█         | 1/10 [00:02<00:20,  2.31s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9358, 'compress@10': 1.0, 'time@10': 4.1699}:  10%|█         | 1/10 [00:06<00:20,  2.31s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9358, 'compress@10': 1.0, 'time@10': 4.1699}:  20%|██        | 2/10 [00:06<00:25,  3.21s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9096, 'compress@10': 0.7143, 'time@10': 3.8738}:  20%|██        | 2/10 [00:07<00:25,  3.21s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9096, 'compress@10': 0.7143, 'time@10': 3.8738}:  30%|███       | 3/10 [00:07<00:17,  2.52s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9566, 'compress@10': 0.7857, 'time@10': 3.865}:  30%|███       | 3/10 [00:11<00:17,  2.52s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9566, 'compress@10': 0.7857, 'time@10': 3.865}:  40%|████      | 4/10 [00:11<00:18,  3.06s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.943, 'compress@10': 0.8285, 'time@10': 4.6933}:  40%|████      | 4/10 [00:15<00:18,  3.06s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.943, 'compress@10': 0.8285, 'time@10': 4.6933}:  50%|█████     | 5/10 [00:15<00:17,  3.41s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9455, 'compress@10': 0.8571, 'time@10': 4.8195}:  50%|█████     | 5/10 [00:21<00:17,  3.41s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9455, 'compress@10': 0.8571, 'time@10': 4.8195}:  60%|██████    | 6/10 [00:21<00:16,  4.12s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0167, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9416, 'compress@10': 0.8775, 'time@10': 4.9791}:  60%|██████    | 6/10 [00:24<00:16,  4.12s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0167, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9416, 'compress@10': 0.8775, 'time@10': 4.9791}:  70%|███████   | 7/10 [00:24<00:11,  3.75s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0165, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.941, 'compress@10': 0.8928, 'time@10': 4.8815}:  70%|███████   | 7/10 [00:28<00:11,  3.75s/it]  {'epoch': 27, 'num_users': 6.125, 'loss': 0.0165, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.941, 'compress@10': 0.8928, 'time@10': 4.8815}:  80%|████████  | 8/10 [00:28<00:07,  3.91s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0207, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9631, 'compress@10': 0.9047, 'time@10': 5.2678}:  80%|████████  | 8/10 [00:32<00:07,  3.91s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0207, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9631, 'compress@10': 0.9047, 'time@10': 5.2678}:  90%|█████████ | 9/10 [00:32<00:04,  4.01s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9644, 'compress@10': 0.9142, 'time@10': 5.335}:  90%|█████████ | 9/10 [00:38<00:04,  4.01s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9644, 'compress@10': 0.9142, 'time@10': 5.335}: 100%|██████████| 10/10 [00:38<00:00,  4.61s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9644, 'compress@10': 0.9142, 'time@10': 5.335}: 100%|██████████| 10/10 [00:38<00:00,  3.87s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.01938733751030414
Avg hit ratio: 0.8822183660519822
Avg ndcg: 0.9644026108896947
Avg compression ratio: 0.9142489929998836
Avg train time: 5.334965229034424
Std train time: 1.6659130774366477
[0.982758620689655, 0.982758620689655, 0.05172413793103448, 0.982758620689655, 0.982758620689655, 0.982758620689655, 0.982758620689655, 0.9482758620689655, 0.982758620689655, 0.982758620689655]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9044, 'compress@10': 1.0, 'time@10': 4.9374}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9044, 'compress@10': 1.0, 'time@10': 4.9374}:  10%|█         | 1/10 [00:02<00:22,  2.51s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.893, 'ndcg@10': 0.932, 'compress@10': 1.0, 'time@10': 4.576}:  10%|█         | 1/10 [00:06<00:22,  2.51s/it]   {'epoch': 28, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.893, 'ndcg@10': 0.932, 'compress@10': 1.0, 'time@10': 4.576}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.907, 'compress@10': 0.7143, 'time@10': 4.2222}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.907, 'compress@10': 0.7143, 'time@10': 4.2222}:  30%|███       | 3/10 [00:08<00:19,  2.74s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9208, 'compress@10': 0.7857, 'time@10': 4.1495}:  30%|███       | 3/10 [00:12<00:19,  2.74s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9208, 'compress@10': 0.7857, 'time@10': 4.1495}:  40%|████      | 4/10 [00:12<00:19,  3.23s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9159, 'compress@10': 0.8285, 'time@10': 4.8901}:  40%|████      | 4/10 [00:16<00:19,  3.23s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9159, 'compress@10': 0.8285, 'time@10': 4.8901}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9288, 'compress@10': 0.8571, 'time@10': 5.0946}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9288, 'compress@10': 0.8571, 'time@10': 5.0946}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9317, 'compress@10': 0.8775, 'time@10': 5.2683}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9317, 'compress@10': 0.8775, 'time@10': 5.2683}:  70%|███████   | 7/10 [00:25<00:12,  4.00s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9288, 'compress@10': 0.8928, 'time@10': 5.1933}:  70%|███████   | 7/10 [00:30<00:12,  4.00s/it]  {'epoch': 28, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9288, 'compress@10': 0.8928, 'time@10': 5.1933}:  80%|████████  | 8/10 [00:30<00:08,  4.23s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9233, 'compress@10': 0.9047, 'time@10': 5.5625}:  80%|████████  | 8/10 [00:34<00:08,  4.23s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9233, 'compress@10': 0.9047, 'time@10': 5.5625}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9295, 'compress@10': 0.9142, 'time@10': 5.5936}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]     {'epoch': 28, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9295, 'compress@10': 0.9142, 'time@10': 5.5936}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9295, 'compress@10': 0.9142, 'time@10': 5.5936}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.018056518273563603
Avg hit ratio: 0.889970003209392
Avg ndcg: 0.9295307313347889
Avg compression ratio: 0.9142491459561182
Avg train time: 5.593613767623902
Std train time: 1.5742277899369541
[0.9833333333333332, 0.9833333333333332, 0.05, 0.9833333333333332, 0.9833333333333332, 0.9833333333333332, 0.9833333333333332, 0.95, 0.9833333333333332, 0.9833333333333332]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 5.027}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 5.027}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0236, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.934, 'compress@10': 1.0, 'time@10': 4.5926}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0236, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.934, 'compress@10': 1.0, 'time@10': 4.5926}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9084, 'compress@10': 0.7143, 'time@10': 4.2678}:  20%|██        | 2/10 [00:08<00:28,  3.52s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9084, 'compress@10': 0.7143, 'time@10': 4.2678}:  30%|███       | 3/10 [00:08<00:19,  2.76s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9108, 'compress@10': 0.7857, 'time@10': 4.1861}:  30%|███       | 3/10 [00:12<00:19,  2.76s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9108, 'compress@10': 0.7857, 'time@10': 4.1861}:  40%|████      | 4/10 [00:12<00:19,  3.24s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0197, 'hit_ratio@10': 0.8062, 'ndcg@10': 0.9087, 'compress@10': 0.8285, 'time@10': 4.9393}:  40%|████      | 4/10 [00:16<00:19,  3.24s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0197, 'hit_ratio@10': 0.8062, 'ndcg@10': 0.9087, 'compress@10': 0.8285, 'time@10': 4.9393}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0187, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.9172, 'compress@10': 0.8571, 'time@10': 5.1393}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0187, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.9172, 'compress@10': 0.8571, 'time@10': 5.1393}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9224, 'compress@10': 0.8775, 'time@10': 5.3387}:  60%|██████    | 6/10 [00:26<00:17,  4.42s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9224, 'compress@10': 0.8775, 'time@10': 5.3387}:  70%|███████   | 7/10 [00:26<00:12,  4.06s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9252, 'compress@10': 0.8928, 'time@10': 5.2547}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9252, 'compress@10': 0.8928, 'time@10': 5.2547}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9297, 'compress@10': 0.9047, 'time@10': 5.6094}:  80%|████████  | 8/10 [00:35<00:08,  4.26s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9297, 'compress@10': 0.9047, 'time@10': 5.6094}:  90%|█████████ | 9/10 [00:35<00:04,  4.26s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9317, 'compress@10': 0.9142, 'time@10': 5.6387}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9317, 'compress@10': 0.9142, 'time@10': 5.6387}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9317, 'compress@10': 0.9142, 'time@10': 5.6387}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.018528462823330812
Avg hit ratio: 0.8723791173926998
Avg ndcg: 0.9316871623363883
Avg compression ratio: 0.9142493911650197
Avg train time: 5.638739013671875
Std train time: 1.576069084011737
[0.9838709677419353, 0.9838709677419353, 0.048387096774193554, 0.9838709677419353, 0.9838709677419353, 0.9838709677419353, 0.9838709677419353, 0.9516129032258064, 0.9838709677419353, 0.9838709677419353]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 4.9142}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 4.9142}:  10%|█         | 1/10 [00:02<00:22,  2.50s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9883, 'compress@10': 1.0, 'time@10': 4.5291}:  10%|█         | 1/10 [00:06<00:22,  2.50s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9883, 'compress@10': 1.0, 'time@10': 4.5291}:  20%|██        | 2/10 [00:06<00:27,  3.49s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9446, 'compress@10': 0.7143, 'time@10': 4.173}:  20%|██        | 2/10 [00:08<00:27,  3.49s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9446, 'compress@10': 0.7143, 'time@10': 4.173}:  30%|███       | 3/10 [00:08<00:18,  2.70s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9899, 'compress@10': 0.7857, 'time@10': 4.1134}:  30%|███       | 3/10 [00:12<00:18,  2.70s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9899, 'compress@10': 0.7857, 'time@10': 4.1134}:  40%|████      | 4/10 [00:12<00:19,  3.21s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0227, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.9722, 'compress@10': 0.8286, 'time@10': 4.8726}:  40%|████      | 4/10 [00:16<00:19,  3.21s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0227, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.9722, 'compress@10': 0.8286, 'time@10': 4.8726}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0198, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.9717, 'compress@10': 0.8571, 'time@10': 5.0793}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0198, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.9717, 'compress@10': 0.8571, 'time@10': 5.0793}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0222, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.971, 'compress@10': 0.8775, 'time@10': 5.2635}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it] {'epoch': 30, 'num_users': 6.2857, 'loss': 0.0222, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.971, 'compress@10': 0.8775, 'time@10': 5.2635}:  70%|███████   | 7/10 [00:25<00:12,  4.02s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0202, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9706, 'compress@10': 0.8928, 'time@10': 5.1775}:  70%|███████   | 7/10 [00:30<00:12,  4.02s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0202, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9706, 'compress@10': 0.8928, 'time@10': 5.1775}:  80%|████████  | 8/10 [00:30<00:08,  4.21s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9845, 'compress@10': 0.9047, 'time@10': 5.5317}:  80%|████████  | 8/10 [00:34<00:08,  4.21s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9845, 'compress@10': 0.9047, 'time@10': 5.5317}:  90%|█████████ | 9/10 [00:34<00:04,  4.21s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9837, 'compress@10': 0.9143, 'time@10': 5.5678}:  90%|█████████ | 9/10 [00:40<00:04,  4.21s/it]  {'epoch': 30, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9837, 'compress@10': 0.9143, 'time@10': 5.5678}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9837, 'compress@10': 0.9143, 'time@10': 5.5678}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.02015807017669963
Avg hit ratio: 0.889601339614922
Avg ndcg: 0.9836922720296833
Avg compression ratio: 0.9142515758546889
Avg train time: 5.567821311950683
Std train time: 1.578018729226435
[0.9843749999999998, 0.9843749999999998, 0.04687500000000001, 0.9843749999999998, 0.9843749999999998, 0.9843749999999998, 0.9843749999999998, 0.9531249999999999, 0.9843749999999998, 0.9843749999999998]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8978, 'compress@10': 1.0, 'time@10': 5.0927}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8978, 'compress@10': 1.0, 'time@10': 5.0927}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9293, 'compress@10': 1.0, 'time@10': 4.6213}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9293, 'compress@10': 1.0, 'time@10': 4.6213}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9052, 'compress@10': 0.7143, 'time@10': 4.2068}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9052, 'compress@10': 0.7143, 'time@10': 4.2068}:  30%|███       | 3/10 [00:08<00:18,  2.71s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.919, 'compress@10': 0.7857, 'time@10': 4.038}:  30%|███       | 3/10 [00:12<00:18,  2.71s/it]   {'epoch': 31, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.919, 'compress@10': 0.7857, 'time@10': 4.038}:  40%|████      | 4/10 [00:12<00:18,  3.05s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.9182, 'compress@10': 0.8286, 'time@10': 4.6524}:  40%|████      | 4/10 [00:15<00:18,  3.05s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.9182, 'compress@10': 0.8286, 'time@10': 4.6524}:  50%|█████     | 5/10 [00:15<00:16,  3.24s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0161, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9338, 'compress@10': 0.8571, 'time@10': 4.8267}:  50%|█████     | 5/10 [00:21<00:16,  3.24s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0161, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9338, 'compress@10': 0.8571, 'time@10': 4.8267}:  60%|██████    | 6/10 [00:21<00:16,  4.10s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0162, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9339, 'compress@10': 0.8775, 'time@10': 5.0016}:  60%|██████    | 6/10 [00:24<00:16,  4.10s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0162, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9339, 'compress@10': 0.8775, 'time@10': 5.0016}:  70%|███████   | 7/10 [00:24<00:11,  3.76s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0176, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9328, 'compress@10': 0.8928, 'time@10': 4.9476}:  70%|███████   | 7/10 [00:29<00:11,  3.76s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0176, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9328, 'compress@10': 0.8928, 'time@10': 4.9476}:  80%|████████  | 8/10 [00:29<00:08,  4.03s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9266, 'compress@10': 0.9047, 'time@10': 5.3119}:  80%|████████  | 8/10 [00:33<00:08,  4.03s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9266, 'compress@10': 0.9047, 'time@10': 5.3119}:  90%|█████████ | 9/10 [00:33<00:04,  4.07s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9322, 'compress@10': 0.9143, 'time@10': 5.3146}:  90%|█████████ | 9/10 [00:38<00:04,  4.07s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9322, 'compress@10': 0.9143, 'time@10': 5.3146}: 100%|██████████| 10/10 [00:38<00:00,  4.48s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9322, 'compress@10': 0.9143, 'time@10': 5.3146}: 100%|██████████| 10/10 [00:38<00:00,  3.86s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.017711155288204702
Avg hit ratio: 0.8894815239467192
Avg ndcg: 0.9321717910750316
Avg compression ratio: 0.9142511143562689
Avg train time: 5.314578294754028
Std train time: 1.4588065232326934
[0.9848484848484846, 0.9848484848484846, 0.04545454545454546, 0.9848484848484846, 0.9848484848484846, 0.9848484848484846, 0.9848484848484846, 0.9545454545454545, 0.9848484848484846, 0.9848484848484846]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 4.8508}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 4.8508}:  10%|█         | 1/10 [00:02<00:22,  2.47s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9904, 'compress@10': 1.0, 'time@10': 4.3224}:  10%|█         | 1/10 [00:06<00:22,  2.47s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9904, 'compress@10': 1.0, 'time@10': 4.3224}:  20%|██        | 2/10 [00:06<00:26,  3.27s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.946, 'compress@10': 0.7143, 'time@10': 4.0121}:  20%|██        | 2/10 [00:08<00:26,  3.27s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.946, 'compress@10': 0.7143, 'time@10': 4.0121}:  30%|███       | 3/10 [00:08<00:17,  2.57s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9477, 'compress@10': 0.7857, 'time@10': 4.003}:  30%|███       | 3/10 [00:12<00:17,  2.57s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9477, 'compress@10': 0.7857, 'time@10': 4.003}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0164, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9413, 'compress@10': 0.8285, 'time@10': 4.8073}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0164, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9413, 'compress@10': 0.8285, 'time@10': 4.8073}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.9456, 'compress@10': 0.8571, 'time@10': 5.0266}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.9456, 'compress@10': 0.8571, 'time@10': 5.0266}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9469, 'compress@10': 0.8775, 'time@10': 5.2583}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9469, 'compress@10': 0.8775, 'time@10': 5.2583}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0148, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9554, 'compress@10': 0.8928, 'time@10': 5.167}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.0148, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9554, 'compress@10': 0.8928, 'time@10': 5.167}:  80%|████████  | 8/10 [00:30<00:08,  4.22s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9559, 'compress@10': 0.9047, 'time@10': 5.5345}:  80%|████████  | 8/10 [00:34<00:08,  4.22s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9559, 'compress@10': 0.9047, 'time@10': 5.5345}:  90%|█████████ | 9/10 [00:34<00:04,  4.23s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9559, 'compress@10': 0.9143, 'time@10': 5.5772}:  90%|█████████ | 9/10 [00:40<00:04,  4.23s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9559, 'compress@10': 0.9143, 'time@10': 5.5772}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9559, 'compress@10': 0.9143, 'time@10': 5.5772}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.014361635392556693
Avg hit ratio: 0.8898076888212711
Avg ndcg: 0.9558680899844022
Avg compression ratio: 0.9142513658435911
Avg train time: 5.577224826812744
Std train time: 1.6772009898918983
[0.9852941176470587, 0.9852941176470587, 0.04411764705882354, 0.9852941176470587, 0.9852941176470587, 0.9852941176470587, 0.9852941176470587, 0.9558823529411764, 0.9852941176470587, 0.9852941176470587]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9106, 'compress@10': 1.0, 'time@10': 4.993}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9106, 'compress@10': 1.0, 'time@10': 4.993}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9357, 'compress@10': 1.0, 'time@10': 4.5687}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9357, 'compress@10': 1.0, 'time@10': 4.5687}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9095, 'compress@10': 0.7143, 'time@10': 4.1613}:  20%|██        | 2/10 [00:08<00:28,  3.51s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9095, 'compress@10': 0.7143, 'time@10': 4.1613}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9628, 'compress@10': 0.7857, 'time@10': 4.123}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9628, 'compress@10': 0.7857, 'time@10': 4.123}:  40%|████      | 4/10 [00:12<00:19,  3.22s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0164, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9552, 'compress@10': 0.8285, 'time@10': 4.9014}:  40%|████      | 4/10 [00:16<00:19,  3.22s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0164, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9552, 'compress@10': 0.8285, 'time@10': 4.9014}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9578, 'compress@10': 0.8571, 'time@10': 5.0992}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9578, 'compress@10': 0.8571, 'time@10': 5.0992}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9588, 'compress@10': 0.8775, 'time@10': 5.3317}:  60%|██████    | 6/10 [00:26<00:17,  4.41s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9588, 'compress@10': 0.8775, 'time@10': 5.3317}:  70%|███████   | 7/10 [00:26<00:12,  4.08s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9596, 'compress@10': 0.8928, 'time@10': 5.2272}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9596, 'compress@10': 0.8928, 'time@10': 5.2272}:  80%|████████  | 8/10 [00:30<00:08,  4.23s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9799, 'compress@10': 0.9047, 'time@10': 5.5997}:  80%|████████  | 8/10 [00:34<00:08,  4.23s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9799, 'compress@10': 0.9047, 'time@10': 5.5997}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9795, 'compress@10': 0.9143, 'time@10': 5.6323}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9795, 'compress@10': 0.9143, 'time@10': 5.6323}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9795, 'compress@10': 0.9143, 'time@10': 5.6323}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.017132721547590712
Avg hit ratio: 0.8971958096610049
Avg ndcg: 0.9794937437727679
Avg compression ratio: 0.9142511368361783
Avg train time: 5.6322669506073
Std train time: 1.662135229797475
[0.9857142857142855, 0.9857142857142855, 0.042857142857142864, 0.9857142857142855, 0.9857142857142855, 0.9857142857142855, 0.9857142857142855, 0.9571428571428571, 0.9857142857142855, 0.9857142857142855]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9006, 'compress@10': 1.0, 'time@10': 5.1355}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9006, 'compress@10': 1.0, 'time@10': 5.1355}:  10%|█         | 1/10 [00:02<00:23,  2.62s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9317, 'compress@10': 1.0, 'time@10': 4.6714}:  10%|█         | 1/10 [00:06<00:23,  2.62s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9317, 'compress@10': 1.0, 'time@10': 4.6714}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9069, 'compress@10': 0.7143, 'time@10': 4.253}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9069, 'compress@10': 0.7143, 'time@10': 4.253}:  30%|███       | 3/10 [00:08<00:19,  2.77s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9255, 'compress@10': 0.7857, 'time@10': 4.2357}:  30%|███       | 3/10 [00:12<00:19,  2.77s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9255, 'compress@10': 0.7857, 'time@10': 4.2357}:  40%|████      | 4/10 [00:12<00:20,  3.35s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.9265, 'compress@10': 0.8285, 'time@10': 5.0113}:  40%|████      | 4/10 [00:17<00:20,  3.35s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.9265, 'compress@10': 0.8285, 'time@10': 5.0113}:  50%|█████     | 5/10 [00:17<00:18,  3.62s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9342, 'compress@10': 0.8571, 'time@10': 5.1995}:  50%|█████     | 5/10 [00:23<00:18,  3.62s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9342, 'compress@10': 0.8571, 'time@10': 5.1995}:  60%|██████    | 6/10 [00:23<00:17,  4.49s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9354, 'compress@10': 0.8775, 'time@10': 5.4095}:  60%|██████    | 6/10 [00:26<00:17,  4.49s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9354, 'compress@10': 0.8775, 'time@10': 5.4095}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.015, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9383, 'compress@10': 0.8928, 'time@10': 5.3023}:  70%|███████   | 7/10 [00:31<00:12,  4.13s/it]  {'epoch': 34, 'num_users': 6.125, 'loss': 0.015, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9383, 'compress@10': 0.8928, 'time@10': 5.3023}:  80%|████████  | 8/10 [00:31<00:08,  4.27s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9361, 'compress@10': 0.9047, 'time@10': 5.6509}:  80%|████████  | 8/10 [00:35<00:08,  4.27s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9361, 'compress@10': 0.9047, 'time@10': 5.6509}:  90%|█████████ | 9/10 [00:35<00:04,  4.27s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9402, 'compress@10': 0.9143, 'time@10': 5.6776}:  90%|█████████ | 9/10 [00:41<00:04,  4.27s/it]    {'epoch': 34, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9402, 'compress@10': 0.9143, 'time@10': 5.6776}: 100%|██████████| 10/10 [00:41<00:00,  4.79s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9402, 'compress@10': 0.9143, 'time@10': 5.6776}: 100%|██████████| 10/10 [00:41<00:00,  4.14s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.017618207945155527
Avg hit ratio: 0.8850299110434934
Avg ndcg: 0.9402146782773629
Avg compression ratio: 0.9142514841002585
Avg train time: 5.677636957168579
Std train time: 1.608976208443355
[0.9861111111111109, 0.9861111111111109, 0.04166666666666667, 0.9861111111111109, 0.9861111111111109, 0.9861111111111109, 0.9861111111111109, 0.9583333333333333, 0.9861111111111109, 0.9861111111111109]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9157, 'compress@10': 1.0, 'time@10': 4.9842}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9157, 'compress@10': 1.0, 'time@10': 4.9842}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.953, 'compress@10': 1.0, 'time@10': 4.54}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]   {'epoch': 35, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.953, 'compress@10': 1.0, 'time@10': 4.54}:  20%|██        | 2/10 [00:06<00:27,  3.47s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9211, 'compress@10': 0.7143, 'time@10': 4.1752}:  20%|██        | 2/10 [00:08<00:27,  3.47s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9211, 'compress@10': 0.7143, 'time@10': 4.1752}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9314, 'compress@10': 0.7857, 'time@10': 4.1525}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9314, 'compress@10': 0.7857, 'time@10': 4.1525}:  40%|████      | 4/10 [00:12<00:19,  3.26s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9302, 'compress@10': 0.8285, 'time@10': 4.9123}:  40%|████      | 4/10 [00:16<00:19,  3.26s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9302, 'compress@10': 0.8285, 'time@10': 4.9123}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.939, 'compress@10': 0.8571, 'time@10': 5.1172}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.939, 'compress@10': 0.8571, 'time@10': 5.1172}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9408, 'compress@10': 0.8775, 'time@10': 5.2627}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9408, 'compress@10': 0.8775, 'time@10': 5.2627}:  70%|███████   | 7/10 [00:25<00:12,  4.01s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9435, 'compress@10': 0.8928, 'time@10': 5.1267}:  70%|███████   | 7/10 [00:30<00:12,  4.01s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9435, 'compress@10': 0.8928, 'time@10': 5.1267}:  80%|████████  | 8/10 [00:30<00:08,  4.07s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9468, 'compress@10': 0.9047, 'time@10': 5.4388}:  80%|████████  | 8/10 [00:34<00:08,  4.07s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9468, 'compress@10': 0.9047, 'time@10': 5.4388}:  90%|█████████ | 9/10 [00:34<00:04,  4.05s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9473, 'compress@10': 0.9143, 'time@10': 5.4481}:  90%|█████████ | 9/10 [00:39<00:04,  4.05s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9473, 'compress@10': 0.9143, 'time@10': 5.4481}: 100%|██████████| 10/10 [00:39<00:00,  4.52s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9473, 'compress@10': 0.9143, 'time@10': 5.4481}: 100%|██████████| 10/10 [00:39<00:00,  3.97s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.014050584620261184
Avg hit ratio: 0.8871727681863506
Avg ndcg: 0.9473110156562505
Avg compression ratio: 0.9142510873227717
Avg train time: 5.448128724098206
Std train time: 1.514838556409018
[0.9864864864864863, 0.9864864864864863, 0.04054054054054054, 0.9864864864864863, 0.9864864864864863, 0.9864864864864863, 0.9864864864864863, 0.9594594594594594, 0.9864864864864863, 0.9864864864864863]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 1.0, 'time@10': 4.9892}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 1.0, 'time@10': 4.9892}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9753, 'compress@10': 1.0, 'time@10': 4.5621}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9753, 'compress@10': 1.0, 'time@10': 4.5621}:  20%|██        | 2/10 [00:06<00:27,  3.50s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9359, 'compress@10': 0.7143, 'time@10': 4.2113}:  20%|██        | 2/10 [00:08<00:27,  3.50s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9359, 'compress@10': 0.7143, 'time@10': 4.2113}:  30%|███       | 3/10 [00:08<00:19,  2.72s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9695, 'compress@10': 0.7857, 'time@10': 4.0746}:  30%|███       | 3/10 [00:12<00:19,  2.72s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9695, 'compress@10': 0.7857, 'time@10': 4.0746}:  40%|████      | 4/10 [00:12<00:18,  3.11s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.9627, 'compress@10': 0.8285, 'time@10': 4.7547}:  40%|████      | 4/10 [00:15<00:18,  3.11s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.9627, 'compress@10': 0.8285, 'time@10': 4.7547}:  50%|█████     | 5/10 [00:15<00:16,  3.35s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.9646, 'compress@10': 0.8571, 'time@10': 4.905}:  50%|█████     | 5/10 [00:21<00:16,  3.35s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.9646, 'compress@10': 0.8571, 'time@10': 4.905}:  60%|██████    | 6/10 [00:21<00:16,  4.15s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9631, 'compress@10': 0.8775, 'time@10': 5.0737}:  60%|██████    | 6/10 [00:24<00:16,  4.15s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9631, 'compress@10': 0.8775, 'time@10': 5.0737}:  70%|███████   | 7/10 [00:24<00:11,  3.80s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9639, 'compress@10': 0.8928, 'time@10': 4.9993}:  70%|███████   | 7/10 [00:29<00:11,  3.80s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9639, 'compress@10': 0.8928, 'time@10': 4.9993}:  80%|████████  | 8/10 [00:29<00:08,  4.03s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.9587, 'compress@10': 0.9047, 'time@10': 5.3816}:  80%|████████  | 8/10 [00:33<00:08,  4.03s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.9587, 'compress@10': 0.9047, 'time@10': 5.3816}:  90%|█████████ | 9/10 [00:33<00:04,  4.10s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9604, 'compress@10': 0.9143, 'time@10': 5.4375}:  90%|█████████ | 9/10 [00:39<00:04,  4.10s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9604, 'compress@10': 0.9143, 'time@10': 5.4375}: 100%|██████████| 10/10 [00:39<00:00,  4.68s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9604, 'compress@10': 0.9143, 'time@10': 5.4375}: 100%|██████████| 10/10 [00:39<00:00,  3.95s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.012523818653084051
Avg hit ratio: 0.8629505459641283
Avg ndcg: 0.9604301176037131
Avg compression ratio: 0.9142523030199173
Avg train time: 5.437488079071045
Std train time: 1.5350474759500383
[0.9868421052631577, 0.9868421052631577, 0.03947368421052632, 0.9868421052631577, 0.9868421052631577, 0.9868421052631577, 0.9868421052631577, 0.9605263157894737, 0.9868421052631577, 0.9868421052631577]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 4.9394}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 4.9394}:  10%|█         | 1/10 [00:02<00:22,  2.51s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9387, 'compress@10': 1.0, 'time@10': 4.5082}:  10%|█         | 1/10 [00:06<00:22,  2.51s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9387, 'compress@10': 1.0, 'time@10': 4.5082}:  20%|██        | 2/10 [00:06<00:27,  3.45s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9115, 'compress@10': 0.7143, 'time@10': 4.162}:  20%|██        | 2/10 [00:08<00:27,  3.45s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9115, 'compress@10': 0.7143, 'time@10': 4.162}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8028, 'ndcg@10': 0.936, 'compress@10': 0.7857, 'time@10': 4.148}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8028, 'ndcg@10': 0.936, 'compress@10': 0.7857, 'time@10': 4.148}:  40%|████      | 4/10 [00:12<00:19,  3.27s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.9362, 'compress@10': 0.8285, 'time@10': 4.9702}:  40%|████      | 4/10 [00:17<00:19,  3.27s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.9362, 'compress@10': 0.8285, 'time@10': 4.9702}:  50%|█████     | 5/10 [00:17<00:18,  3.72s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9466, 'compress@10': 0.8571, 'time@10': 5.1515}:  50%|█████     | 5/10 [00:23<00:18,  3.72s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9466, 'compress@10': 0.8571, 'time@10': 5.1515}:  60%|██████    | 6/10 [00:23<00:18,  4.53s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.016, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9491, 'compress@10': 0.8775, 'time@10': 5.3579}:  60%|██████    | 6/10 [00:26<00:18,  4.53s/it] {'epoch': 37, 'num_users': 6.2857, 'loss': 0.016, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9491, 'compress@10': 0.8775, 'time@10': 5.3579}:  70%|███████   | 7/10 [00:26<00:12,  4.14s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9499, 'compress@10': 0.8928, 'time@10': 5.2489}:  70%|███████   | 7/10 [00:31<00:12,  4.14s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9499, 'compress@10': 0.8928, 'time@10': 5.2489}:  80%|████████  | 8/10 [00:31<00:08,  4.26s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.951, 'compress@10': 0.9047, 'time@10': 5.605}:  80%|████████  | 8/10 [00:35<00:08,  4.26s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.951, 'compress@10': 0.9047, 'time@10': 5.605}:  90%|█████████ | 9/10 [00:35<00:04,  4.26s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9535, 'compress@10': 0.9143, 'time@10': 5.6385}:  90%|█████████ | 9/10 [00:41<00:04,  4.26s/it] {'epoch': 37, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9535, 'compress@10': 0.9143, 'time@10': 5.6385}: 100%|██████████| 10/10 [00:41<00:00,  4.79s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9535, 'compress@10': 0.9143, 'time@10': 5.6385}: 100%|██████████| 10/10 [00:41<00:00,  4.13s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.013450790069244758
Avg hit ratio: 0.8886243810895763
Avg ndcg: 0.9535087933417783
Avg compression ratio: 0.9142525182864848
Avg train time: 5.638537788391114
Std train time: 1.651819252053306
[0.987179487179487, 0.987179487179487, 0.038461538461538464, 0.987179487179487, 0.987179487179487, 0.987179487179487, 0.987179487179487, 0.9615384615384616, 0.987179487179487, 0.987179487179487]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9172, 'compress@10': 1.0, 'time@10': 5.0345}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9172, 'compress@10': 1.0, 'time@10': 5.0345}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9813, 'compress@10': 1.0, 'time@10': 4.5196}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9813, 'compress@10': 1.0, 'time@10': 4.5196}:  20%|██        | 2/10 [00:06<00:27,  3.43s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9399, 'compress@10': 0.7143, 'time@10': 4.1713}:  20%|██        | 2/10 [00:08<00:27,  3.43s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9399, 'compress@10': 0.7143, 'time@10': 4.1713}:  30%|███       | 3/10 [00:08<00:18,  2.68s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9455, 'compress@10': 0.7857, 'time@10': 4.1623}:  30%|███       | 3/10 [00:12<00:18,  2.68s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9455, 'compress@10': 0.7857, 'time@10': 4.1623}:  40%|████      | 4/10 [00:12<00:19,  3.27s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.9428, 'compress@10': 0.8285, 'time@10': 4.9488}:  40%|████      | 4/10 [00:16<00:19,  3.27s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.9428, 'compress@10': 0.8285, 'time@10': 4.9488}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.9463, 'compress@10': 0.8571, 'time@10': 5.1469}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.9463, 'compress@10': 0.8571, 'time@10': 5.1469}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9423, 'compress@10': 0.8775, 'time@10': 5.3762}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9423, 'compress@10': 0.8775, 'time@10': 5.3762}:  70%|███████   | 7/10 [00:26<00:12,  4.11s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9425, 'compress@10': 0.8928, 'time@10': 5.268}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9425, 'compress@10': 0.8928, 'time@10': 5.268}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9586, 'compress@10': 0.9047, 'time@10': 5.6216}:  80%|████████  | 8/10 [00:35<00:08,  4.26s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9586, 'compress@10': 0.9047, 'time@10': 5.6216}:  90%|█████████ | 9/10 [00:35<00:04,  4.26s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9554, 'compress@10': 0.9143, 'time@10': 5.652}:  90%|█████████ | 9/10 [00:41<00:04,  4.26s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9554, 'compress@10': 0.9143, 'time@10': 5.652}: 100%|██████████| 10/10 [00:41<00:00,  4.79s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9554, 'compress@10': 0.9143, 'time@10': 5.652}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.020112216214076113
Avg hit ratio: 0.8735219745355568
Avg ndcg: 0.9554461663496845
Avg compression ratio: 0.9142535189385532
Avg train time: 5.652024817466736
Std train time: 1.6357387321202266
[0.9874999999999998, 0.9874999999999998, 0.037500000000000006, 0.9874999999999998, 0.9874999999999998, 0.9874999999999998, 0.9874999999999998, 0.9625, 0.9874999999999998, 0.9874999999999998]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9164, 'compress@10': 1.0, 'time@10': 5.0031}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9164, 'compress@10': 1.0, 'time@10': 5.0031}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 4.5074}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it] {'epoch': 39, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 4.5074}:  20%|██        | 2/10 [00:06<00:27,  3.44s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9155, 'compress@10': 0.7143, 'time@10': 4.1723}:  20%|██        | 2/10 [00:08<00:27,  3.44s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9155, 'compress@10': 0.7143, 'time@10': 4.1723}:  30%|███       | 3/10 [00:08<00:18,  2.68s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9422, 'compress@10': 0.7857, 'time@10': 4.1386}:  30%|███       | 3/10 [00:12<00:18,  2.68s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9422, 'compress@10': 0.7857, 'time@10': 4.1386}:  40%|████      | 4/10 [00:12<00:19,  3.23s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9417, 'compress@10': 0.8285, 'time@10': 4.9451}:  40%|████      | 4/10 [00:16<00:19,  3.23s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9417, 'compress@10': 0.8285, 'time@10': 4.9451}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9471, 'compress@10': 0.8571, 'time@10': 5.1226}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9471, 'compress@10': 0.8571, 'time@10': 5.1226}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9483, 'compress@10': 0.8775, 'time@10': 5.3492}:  60%|██████    | 6/10 [00:26<00:17,  4.40s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9483, 'compress@10': 0.8775, 'time@10': 5.3492}:  70%|███████   | 7/10 [00:26<00:12,  4.07s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9496, 'compress@10': 0.8928, 'time@10': 5.25}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]   {'epoch': 39, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9496, 'compress@10': 0.8928, 'time@10': 5.25}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9422, 'compress@10': 0.9047, 'time@10': 5.5985}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9422, 'compress@10': 0.9047, 'time@10': 5.5985}:  90%|█████████ | 9/10 [00:34<00:04,  4.24s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9455, 'compress@10': 0.9143, 'time@10': 5.6002}:  90%|█████████ | 9/10 [00:40<00:04,  4.24s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9455, 'compress@10': 0.9143, 'time@10': 5.6002}: 100%|██████████| 10/10 [00:40<00:00,  4.67s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9455, 'compress@10': 0.9143, 'time@10': 5.6002}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.013597611736922963
Avg hit ratio: 0.8875414317808206
Avg ndcg: 0.9454819820951972
Avg compression ratio: 0.91425285498013
Avg train time: 5.600151515007019
Std train time: 1.6304374304153668
[0.9878048780487804, 0.9878048780487804, 0.03658536585365854, 0.9878048780487804, 0.9878048780487804, 0.9878048780487804, 0.9878048780487804, 0.9634146341463414, 0.9878048780487804, 0.9878048780487804]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 1.0, 'time@10': 4.9699}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 1.0, 'time@10': 4.9699}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0053, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9435, 'compress@10': 1.0, 'time@10': 4.3182}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0053, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9435, 'compress@10': 1.0, 'time@10': 4.3182}:  20%|██        | 2/10 [00:06<00:25,  3.22s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0036, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9147, 'compress@10': 0.7143, 'time@10': 4.0079}:  20%|██        | 2/10 [00:07<00:25,  3.22s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0036, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9147, 'compress@10': 0.7143, 'time@10': 4.0079}:  30%|███       | 3/10 [00:07<00:17,  2.54s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.9607, 'compress@10': 0.7857, 'time@10': 3.9305}:  30%|███       | 3/10 [00:11<00:17,  2.54s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.9607, 'compress@10': 0.7857, 'time@10': 3.9305}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.9576, 'compress@10': 0.8285, 'time@10': 4.6938}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.9576, 'compress@10': 0.8285, 'time@10': 4.6938}:  50%|█████     | 5/10 [00:15<00:16,  3.34s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9689, 'compress@10': 0.8571, 'time@10': 4.9093}:  50%|█████     | 5/10 [00:21<00:16,  3.34s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9689, 'compress@10': 0.8571, 'time@10': 4.9093}:  60%|██████    | 6/10 [00:21<00:17,  4.26s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9669, 'compress@10': 0.8775, 'time@10': 5.152}:  60%|██████    | 6/10 [00:25<00:17,  4.26s/it] {'epoch': 40, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9669, 'compress@10': 0.8775, 'time@10': 5.152}:  70%|███████   | 7/10 [00:25<00:11,  3.96s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9673, 'compress@10': 0.8928, 'time@10': 5.0235}:  70%|███████   | 7/10 [00:29<00:11,  3.96s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9673, 'compress@10': 0.8928, 'time@10': 5.0235}:  80%|████████  | 8/10 [00:29<00:08,  4.02s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9674, 'compress@10': 0.9047, 'time@10': 5.3265}:  80%|████████  | 8/10 [00:33<00:08,  4.02s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9674, 'compress@10': 0.9047, 'time@10': 5.3265}:  90%|█████████ | 9/10 [00:33<00:03,  3.99s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9684, 'compress@10': 0.9143, 'time@10': 5.3549}:  90%|█████████ | 9/10 [00:38<00:03,  3.99s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9684, 'compress@10': 0.9143, 'time@10': 5.3549}: 100%|██████████| 10/10 [00:38<00:00,  4.50s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9684, 'compress@10': 0.9143, 'time@10': 5.3549}: 100%|██████████| 10/10 [00:38<00:00,  3.87s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.011546331814079991
Avg hit ratio: 0.8875183903061663
Avg ndcg: 0.9683690463954712
Avg compression ratio: 0.9142548979111458
Avg train time: 5.354884147644043
Std train time: 1.5692504240554364
[0.988095238095238, 0.988095238095238, 0.03571428571428572, 0.988095238095238, 0.988095238095238, 0.988095238095238, 0.988095238095238, 0.9642857142857143, 0.988095238095238, 0.988095238095238]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 4.6889}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 4.6889}:  10%|█         | 1/10 [00:02<00:21,  2.38s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 4.3618}:  10%|█         | 1/10 [00:06<00:21,  2.38s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 4.3618}:  20%|██        | 2/10 [00:06<00:27,  3.38s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.913, 'compress@10': 0.7143, 'time@10': 4.1258}:  20%|██        | 2/10 [00:08<00:27,  3.38s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.913, 'compress@10': 0.7143, 'time@10': 4.1258}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9258, 'compress@10': 0.7857, 'time@10': 4.1133}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9258, 'compress@10': 0.7857, 'time@10': 4.1133}:  40%|████      | 4/10 [00:12<00:19,  3.25s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.9285, 'compress@10': 0.8285, 'time@10': 4.9187}:  40%|████      | 4/10 [00:16<00:19,  3.25s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.9285, 'compress@10': 0.8285, 'time@10': 4.9187}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9364, 'compress@10': 0.8571, 'time@10': 5.099}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9364, 'compress@10': 0.8571, 'time@10': 5.099}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9417, 'compress@10': 0.8775, 'time@10': 5.3134}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9417, 'compress@10': 0.8775, 'time@10': 5.3134}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9446, 'compress@10': 0.8928, 'time@10': 5.2291}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9446, 'compress@10': 0.8928, 'time@10': 5.2291}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9484, 'compress@10': 0.9047, 'time@10': 5.553}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9484, 'compress@10': 0.9047, 'time@10': 5.553}:  90%|█████████ | 9/10 [00:34<00:04,  4.21s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9492, 'compress@10': 0.9143, 'time@10': 5.5925}:  90%|█████████ | 9/10 [00:40<00:04,  4.21s/it]  {'epoch': 41, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9492, 'compress@10': 0.9143, 'time@10': 5.5925}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9492, 'compress@10': 0.9143, 'time@10': 5.5925}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.014395736757572348
Avg hit ratio: 0.8885219745355568
Avg ndcg: 0.9492134792905844
Avg compression ratio: 0.9142544803980952
Avg train time: 5.592541599273682
Std train time: 1.5660547854598077
[0.9883720930232558, 0.9883720930232558, 0.034883720930232565, 0.9883720930232558, 0.9883720930232558, 0.9883720930232558, 0.9883720930232558, 0.9651162790697675, 0.9883720930232558, 0.9883720930232558]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.916, 'compress@10': 1.0, 'time@10': 4.9724}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.916, 'compress@10': 1.0, 'time@10': 4.9724}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9622, 'compress@10': 1.0, 'time@10': 4.4742}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9622, 'compress@10': 1.0, 'time@10': 4.4742}:  20%|██        | 2/10 [00:06<00:27,  3.41s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9272, 'compress@10': 0.7143, 'time@10': 4.1924}:  20%|██        | 2/10 [00:08<00:27,  3.41s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9272, 'compress@10': 0.7143, 'time@10': 4.1924}:  30%|███       | 3/10 [00:08<00:18,  2.70s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9365, 'compress@10': 0.7857, 'time@10': 4.1564}:  30%|███       | 3/10 [00:12<00:18,  2.70s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9365, 'compress@10': 0.7857, 'time@10': 4.1564}:  40%|████      | 4/10 [00:12<00:19,  3.25s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9379, 'compress@10': 0.8285, 'time@10': 4.9509}:  40%|████      | 4/10 [00:16<00:19,  3.25s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9379, 'compress@10': 0.8285, 'time@10': 4.9509}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9438, 'compress@10': 0.8571, 'time@10': 5.1182}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9438, 'compress@10': 0.8571, 'time@10': 5.1182}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9457, 'compress@10': 0.8775, 'time@10': 5.3322}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9457, 'compress@10': 0.8775, 'time@10': 5.3322}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9489, 'compress@10': 0.8928, 'time@10': 5.2506}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9489, 'compress@10': 0.8928, 'time@10': 5.2506}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9532, 'compress@10': 0.9047, 'time@10': 5.5752}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9532, 'compress@10': 0.9047, 'time@10': 5.5752}:  90%|█████████ | 9/10 [00:34<00:04,  4.22s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9556, 'compress@10': 0.9143, 'time@10': 5.6116}:  90%|█████████ | 9/10 [00:40<00:04,  4.22s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9556, 'compress@10': 0.9143, 'time@10': 5.6116}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9556, 'compress@10': 0.9143, 'time@10': 5.6116}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.013955787367081649
Avg hit ratio: 0.889179936645132
Avg ndcg: 0.9555865696508941
Avg compression ratio: 0.9142549723375923
Avg train time: 5.61156644821167
Std train time: 1.5638391688921822
[0.9886363636363636, 0.9886363636363636, 0.034090909090909095, 0.9886363636363636, 0.9886363636363636, 0.9886363636363636, 0.9886363636363636, 0.9659090909090909, 0.9886363636363636, 0.9886363636363636]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9245, 'compress@10': 1.0, 'time@10': 5.0081}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9245, 'compress@10': 1.0, 'time@10': 5.0081}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.005, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9437, 'compress@10': 1.0, 'time@10': 4.4966}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.005, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9437, 'compress@10': 1.0, 'time@10': 4.4966}:  20%|██        | 2/10 [00:06<00:27,  3.41s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0033, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9149, 'compress@10': 0.7143, 'time@10': 4.2108}:  20%|██        | 2/10 [00:08<00:27,  3.41s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0033, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9149, 'compress@10': 0.7143, 'time@10': 4.2108}:  30%|███       | 3/10 [00:08<00:19,  2.81s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9607, 'compress@10': 0.7857, 'time@10': 4.1909}:  30%|███       | 3/10 [00:12<00:19,  2.81s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9607, 'compress@10': 0.7857, 'time@10': 4.1909}:  40%|████      | 4/10 [00:12<00:20,  3.35s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.012, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9573, 'compress@10': 0.8285, 'time@10': 4.9829}:  40%|████      | 4/10 [00:16<00:20,  3.35s/it] {'epoch': 43, 'num_users': 5.8, 'loss': 0.012, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9573, 'compress@10': 0.8285, 'time@10': 4.9829}:  50%|█████     | 5/10 [00:16<00:18,  3.62s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9602, 'compress@10': 0.8571, 'time@10': 5.1383}:  50%|█████     | 5/10 [00:22<00:18,  3.62s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9602, 'compress@10': 0.8571, 'time@10': 5.1383}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9596, 'compress@10': 0.8775, 'time@10': 5.3547}:  60%|██████    | 6/10 [00:26<00:17,  4.42s/it] {'epoch': 43, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9596, 'compress@10': 0.8775, 'time@10': 5.3547}:  70%|███████   | 7/10 [00:26<00:12,  4.07s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.9201, 'ndcg@10': 0.9607, 'compress@10': 0.8928, 'time@10': 5.2703}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.9201, 'ndcg@10': 0.9607, 'compress@10': 0.8928, 'time@10': 5.2703}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9649, 'compress@10': 0.9047, 'time@10': 5.5927}:  80%|████████  | 8/10 [00:35<00:08,  4.28s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9649, 'compress@10': 0.9047, 'time@10': 5.5927}:  90%|█████████ | 9/10 [00:35<00:04,  4.23s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9661, 'compress@10': 0.9143, 'time@10': 5.6236}:  90%|█████████ | 9/10 [00:41<00:04,  4.23s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9661, 'compress@10': 0.9143, 'time@10': 5.6236}: 100%|██████████| 10/10 [00:41<00:00,  4.76s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9661, 'compress@10': 0.9143, 'time@10': 5.6236}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.015918558338624475
Avg hit ratio: 0.9109136796046814
Avg ndcg: 0.9661163542518837
Avg compression ratio: 0.9142565389717519
Avg train time: 5.623606657981872
Std train time: 1.5563707307340517
[0.9888888888888889, 0.9888888888888889, 0.03333333333333334, 0.9888888888888889, 0.9888888888888889, 0.9888888888888889, 0.9888888888888889, 0.9666666666666667, 0.9888888888888889, 0.9888888888888889]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 1.0, 'time@10': 4.9546}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 1.0, 'time@10': 4.9546}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.8769, 'ndcg@10': 1.0279, 'compress@10': 1.0, 'time@10': 4.4584}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.8769, 'ndcg@10': 1.0279, 'compress@10': 1.0, 'time@10': 4.4584}:  20%|██        | 2/10 [00:06<00:27,  3.39s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.971, 'compress@10': 0.7143, 'time@10': 4.1516}:  20%|██        | 2/10 [00:08<00:27,  3.39s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.971, 'compress@10': 0.7143, 'time@10': 4.1516}:  30%|███       | 3/10 [00:08<00:18,  2.67s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9752, 'compress@10': 0.7857, 'time@10': 4.1018}:  30%|███       | 3/10 [00:12<00:18,  2.67s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9752, 'compress@10': 0.7857, 'time@10': 4.1018}:  40%|████      | 4/10 [00:12<00:19,  3.19s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9693, 'compress@10': 0.8285, 'time@10': 4.8045}:  40%|████      | 4/10 [00:16<00:19,  3.19s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9693, 'compress@10': 0.8285, 'time@10': 4.8045}:  50%|█████     | 5/10 [00:16<00:17,  3.43s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9704, 'compress@10': 0.8571, 'time@10': 4.9815}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9704, 'compress@10': 0.8571, 'time@10': 4.9815}:  60%|██████    | 6/10 [00:22<00:17,  4.27s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9683, 'compress@10': 0.8775, 'time@10': 5.1934}:  60%|██████    | 6/10 [00:25<00:17,  4.27s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9683, 'compress@10': 0.8775, 'time@10': 5.1934}:  70%|███████   | 7/10 [00:25<00:11,  3.94s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9661, 'compress@10': 0.8928, 'time@10': 5.0811}:  70%|███████   | 7/10 [00:29<00:11,  3.94s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9661, 'compress@10': 0.8928, 'time@10': 5.0811}:  80%|████████  | 8/10 [00:29<00:08,  4.07s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.968, 'compress@10': 0.9047, 'time@10': 5.401}:  80%|████████  | 8/10 [00:33<00:08,  4.07s/it]  {'epoch': 44, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.968, 'compress@10': 0.9047, 'time@10': 5.401}:  90%|█████████ | 9/10 [00:33<00:04,  4.05s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.9773, 'compress@10': 0.9143, 'time@10': 5.4514}:  90%|█████████ | 9/10 [00:39<00:04,  4.05s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.9773, 'compress@10': 0.9143, 'time@10': 5.4514}: 100%|██████████| 10/10 [00:39<00:00,  4.64s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.9773, 'compress@10': 0.9143, 'time@10': 5.4514}: 100%|██████████| 10/10 [00:39<00:00,  3.97s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.01563109619453826
Avg hit ratio: 0.9078870539006362
Avg ndcg: 0.9773233252967352
Avg compression ratio: 0.9142559302734197
Avg train time: 5.451362609863281
Std train time: 1.4863335947217862
[0.9891304347826088, 0.9891304347826088, 0.03260869565217392, 0.9891304347826088, 0.9891304347826088, 0.9891304347826088, 0.9891304347826088, 0.967391304347826, 0.9891304347826088, 0.9891304347826088]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9315, 'compress@10': 1.0, 'time@10': 4.9896}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9315, 'compress@10': 1.0, 'time@10': 4.9896}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9496, 'compress@10': 1.0, 'time@10': 4.4644}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9496, 'compress@10': 1.0, 'time@10': 4.4644}:  20%|██        | 2/10 [00:06<00:27,  3.38s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9188, 'compress@10': 0.7143, 'time@10': 4.0297}:  20%|██        | 2/10 [00:08<00:27,  3.38s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9188, 'compress@10': 0.7143, 'time@10': 4.0297}:  30%|███       | 3/10 [00:08<00:18,  2.58s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9302, 'compress@10': 0.7857, 'time@10': 3.9581}:  30%|███       | 3/10 [00:11<00:18,  2.58s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9302, 'compress@10': 0.7857, 'time@10': 3.9581}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0077, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.9337, 'compress@10': 0.8285, 'time@10': 4.7499}:  40%|████      | 4/10 [00:15<00:18,  3.05s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0077, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.9337, 'compress@10': 0.8285, 'time@10': 4.7499}:  50%|█████     | 5/10 [00:15<00:16,  3.39s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.9284, 'ndcg@10': 0.9406, 'compress@10': 0.8571, 'time@10': 4.8775}:  50%|█████     | 5/10 [00:21<00:16,  3.39s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.9284, 'ndcg@10': 0.9406, 'compress@10': 0.8571, 'time@10': 4.8775}:  60%|██████    | 6/10 [00:21<00:16,  4.13s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0073, 'hit_ratio@10': 0.9329, 'ndcg@10': 0.9431, 'compress@10': 0.8775, 'time@10': 5.1345}:  60%|██████    | 6/10 [00:24<00:16,  4.13s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0073, 'hit_ratio@10': 0.9329, 'ndcg@10': 0.9431, 'compress@10': 0.8775, 'time@10': 5.1345}:  70%|███████   | 7/10 [00:24<00:11,  3.88s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9378, 'ndcg@10': 0.9483, 'compress@10': 0.8928, 'time@10': 5.0754}:  70%|███████   | 7/10 [00:29<00:11,  3.88s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9378, 'ndcg@10': 0.9483, 'compress@10': 0.8928, 'time@10': 5.0754}:  80%|████████  | 8/10 [00:29<00:08,  4.14s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9492, 'compress@10': 0.9047, 'time@10': 5.4191}:  80%|████████  | 8/10 [00:33<00:08,  4.14s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9492, 'compress@10': 0.9047, 'time@10': 5.4191}:  90%|█████████ | 9/10 [00:33<00:04,  4.14s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.9251, 'ndcg@10': 0.952, 'compress@10': 0.9143, 'time@10': 5.4684}:  90%|█████████ | 9/10 [00:39<00:04,  4.14s/it]    {'epoch': 45, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.9251, 'ndcg@10': 0.952, 'compress@10': 0.9143, 'time@10': 5.4684}: 100%|██████████| 10/10 [00:39<00:00,  4.70s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.9251, 'ndcg@10': 0.952, 'compress@10': 0.9143, 'time@10': 5.4684}: 100%|██████████| 10/10 [00:39<00:00,  3.96s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.01059406547263555
Avg hit ratio: 0.9250759939928022
Avg ndcg: 0.9520337776258266
Avg compression ratio: 0.9142564632278358
Avg train time: 5.468353509902954
Std train time: 1.6269448714903576
[0.9893617021276596, 0.9893617021276596, 0.03191489361702128, 0.9893617021276596, 0.9893617021276596, 0.9893617021276596, 0.9893617021276596, 0.9680851063829787, 0.9893617021276596, 0.9893617021276596]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9252, 'compress@10': 1.0, 'time@10': 5.0158}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9252, 'compress@10': 1.0, 'time@10': 5.0158}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9879, 'compress@10': 1.0, 'time@10': 4.5099}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9879, 'compress@10': 1.0, 'time@10': 4.5099}:  20%|██        | 2/10 [00:06<00:27,  3.43s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9443, 'compress@10': 0.7143, 'time@10': 4.2088}:  20%|██        | 2/10 [00:08<00:27,  3.43s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9443, 'compress@10': 0.7143, 'time@10': 4.2088}:  30%|███       | 3/10 [00:08<00:18,  2.71s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9672, 'compress@10': 0.7857, 'time@10': 4.1911}:  30%|███       | 3/10 [00:12<00:18,  2.71s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9672, 'compress@10': 0.7857, 'time@10': 4.1911}:  40%|████      | 4/10 [00:12<00:19,  3.29s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9636, 'compress@10': 0.8285, 'time@10': 4.9922}:  40%|████      | 4/10 [00:16<00:19,  3.29s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9636, 'compress@10': 0.8285, 'time@10': 4.9922}:  50%|█████     | 5/10 [00:16<00:17,  3.59s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9675, 'compress@10': 0.8571, 'time@10': 5.1617}:  50%|█████     | 5/10 [00:22<00:17,  3.59s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9675, 'compress@10': 0.8571, 'time@10': 5.1617}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9678, 'compress@10': 0.8775, 'time@10': 5.3718}:  60%|██████    | 6/10 [00:26<00:17,  4.43s/it] {'epoch': 46, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9678, 'compress@10': 0.8775, 'time@10': 5.3718}:  70%|███████   | 7/10 [00:26<00:12,  4.08s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9785, 'compress@10': 0.8928, 'time@10': 5.2866}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9785, 'compress@10': 0.8928, 'time@10': 5.2866}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9792, 'compress@10': 0.9047, 'time@10': 5.6216}:  80%|████████  | 8/10 [00:35<00:08,  4.29s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9792, 'compress@10': 0.9047, 'time@10': 5.6216}:  90%|█████████ | 9/10 [00:35<00:04,  4.26s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9136, 'ndcg@10': 0.979, 'compress@10': 0.9143, 'time@10': 5.6418}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]    {'epoch': 46, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9136, 'ndcg@10': 0.979, 'compress@10': 0.9143, 'time@10': 5.6418}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9136, 'ndcg@10': 0.979, 'compress@10': 0.9143, 'time@10': 5.6418}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.015106002790816775
Avg hit ratio: 0.9136243810895763
Avg ndcg: 0.9790102916713659
Avg compression ratio: 0.9142566317527905
Avg train time: 5.641816520690918
Std train time: 1.5854210974631067
[0.9895833333333334, 0.9895833333333334, 0.03125000000000001, 0.9895833333333334, 0.9895833333333334, 0.9895833333333334, 0.9895833333333334, 0.96875, 0.9895833333333334, 0.9895833333333334]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9282, 'compress@10': 1.0, 'time@10': 4.969}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9282, 'compress@10': 1.0, 'time@10': 4.969}:  10%|█         | 1/10 [00:02<00:22,  2.52s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.944, 'compress@10': 1.0, 'time@10': 4.5058}:  10%|█         | 1/10 [00:06<00:22,  2.52s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.944, 'compress@10': 1.0, 'time@10': 4.5058}:  20%|██        | 2/10 [00:06<00:27,  3.44s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.915, 'compress@10': 0.7143, 'time@10': 4.2399}:  20%|██        | 2/10 [00:08<00:27,  3.44s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.915, 'compress@10': 0.7143, 'time@10': 4.2399}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9328, 'compress@10': 0.7857, 'time@10': 4.2015}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9328, 'compress@10': 0.7857, 'time@10': 4.2015}:  40%|████      | 4/10 [00:12<00:19,  3.28s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9357, 'compress@10': 0.8285, 'time@10': 4.9993}:  40%|████      | 4/10 [00:16<00:19,  3.28s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9357, 'compress@10': 0.8285, 'time@10': 4.9993}:  50%|█████     | 5/10 [00:16<00:17,  3.59s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.9199, 'ndcg@10': 0.9424, 'compress@10': 0.8571, 'time@10': 5.1638}:  50%|█████     | 5/10 [00:22<00:17,  3.59s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.9199, 'ndcg@10': 0.9424, 'compress@10': 0.8571, 'time@10': 5.1638}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.9256, 'ndcg@10': 0.9447, 'compress@10': 0.8775, 'time@10': 5.3776}:  60%|██████    | 6/10 [00:26<00:17,  4.42s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.9256, 'ndcg@10': 0.9447, 'compress@10': 0.8775, 'time@10': 5.3776}:  70%|███████   | 7/10 [00:26<00:12,  4.08s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.9313, 'ndcg@10': 0.961, 'compress@10': 0.8928, 'time@10': 5.2876}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it]   {'epoch': 47, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.9313, 'ndcg@10': 0.961, 'compress@10': 0.8928, 'time@10': 5.2876}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9559, 'compress@10': 0.9047, 'time@10': 5.6508}:  80%|████████  | 8/10 [00:35<00:08,  4.27s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9559, 'compress@10': 0.9047, 'time@10': 5.6508}:  90%|█████████ | 9/10 [00:35<00:04,  4.29s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9562, 'compress@10': 0.9143, 'time@10': 5.6583}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]  {'epoch': 47, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9562, 'compress@10': 0.9143, 'time@10': 5.6583}: 100%|██████████| 10/10 [00:40<00:00,  4.74s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9562, 'compress@10': 0.9143, 'time@10': 5.6583}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.014756368481192042
Avg hit ratio: 0.9170759939928022
Avg ndcg: 0.9561841386923211
Avg compression ratio: 0.9142561606237756
Avg train time: 5.658303427696228
Std train time: 1.6213999959692171
[0.9897959183673469, 0.9897959183673469, 0.03061224489795919, 0.9897959183673469, 0.9897959183673469, 0.9897959183673469, 0.9897959183673469, 0.9693877551020408, 0.9897959183673469, 0.9897959183673469]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9252, 'compress@10': 1.0, 'time@10': 4.9877}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9252, 'compress@10': 1.0, 'time@10': 4.9877}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9559, 'compress@10': 1.0, 'time@10': 4.4788}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9559, 'compress@10': 1.0, 'time@10': 4.4788}:  20%|██        | 2/10 [00:06<00:27,  3.40s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.923, 'compress@10': 0.7143, 'time@10': 4.224}:  20%|██        | 2/10 [00:08<00:27,  3.40s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.923, 'compress@10': 0.7143, 'time@10': 4.224}:  30%|███       | 3/10 [00:08<00:18,  2.71s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9333, 'compress@10': 0.7857, 'time@10': 4.1856}:  30%|███       | 3/10 [00:12<00:18,  2.71s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9333, 'compress@10': 0.7857, 'time@10': 4.1856}:  40%|████      | 4/10 [00:12<00:19,  3.26s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9376, 'compress@10': 0.8286, 'time@10': 4.9849}:  40%|████      | 4/10 [00:16<00:19,  3.26s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9376, 'compress@10': 0.8286, 'time@10': 4.9849}:  50%|█████     | 5/10 [00:16<00:17,  3.58s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.9286, 'ndcg@10': 0.9426, 'compress@10': 0.8571, 'time@10': 5.1676}:  50%|█████     | 5/10 [00:22<00:17,  3.58s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.9286, 'ndcg@10': 0.9426, 'compress@10': 0.8571, 'time@10': 5.1676}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.9331, 'ndcg@10': 0.9444, 'compress@10': 0.8775, 'time@10': 5.3766}:  60%|██████    | 6/10 [00:26<00:17,  4.44s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.9331, 'ndcg@10': 0.9444, 'compress@10': 0.8775, 'time@10': 5.3766}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9379, 'ndcg@10': 0.9422, 'compress@10': 0.8928, 'time@10': 5.2594}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]  {'epoch': 48, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9379, 'ndcg@10': 0.9422, 'compress@10': 0.8928, 'time@10': 5.2594}:  80%|████████  | 8/10 [00:30<00:08,  4.22s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0107, 'hit_ratio@10': 0.9162, 'ndcg@10': 0.9446, 'compress@10': 0.9047, 'time@10': 5.5128}:  80%|████████  | 8/10 [00:34<00:08,  4.22s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0107, 'hit_ratio@10': 0.9162, 'ndcg@10': 0.9446, 'compress@10': 0.9047, 'time@10': 5.5128}:  90%|█████████ | 9/10 [00:34<00:04,  4.09s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.9223, 'ndcg@10': 0.9478, 'compress@10': 0.9143, 'time@10': 5.5021}:  90%|█████████ | 9/10 [00:39<00:04,  4.09s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.9223, 'ndcg@10': 0.9478, 'compress@10': 0.9143, 'time@10': 5.5021}: 100%|██████████| 10/10 [00:39<00:00,  4.51s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.9223, 'ndcg@10': 0.9478, 'compress@10': 0.9143, 'time@10': 5.5021}: 100%|██████████| 10/10 [00:39<00:00,  3.99s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.009928758803237065
Avg hit ratio: 0.9223422510332526
Avg ndcg: 0.9478316461934678
Avg compression ratio: 0.9142575350835023
Avg train time: 5.502073049545288
Std train time: 1.4812085507765502
[0.99, 0.99, 0.030000000000000006, 0.99, 0.99, 0.99, 0.99, 0.97, 0.99, 0.99]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0039, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9352, 'compress@10': 1.0, 'time@10': 4.7464}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0039, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9352, 'compress@10': 1.0, 'time@10': 4.7464}:  10%|█         | 1/10 [00:02<00:21,  2.41s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9615, 'compress@10': 1.0, 'time@10': 4.236}:  10%|█         | 1/10 [00:06<00:21,  2.41s/it]  {'epoch': 49, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9615, 'compress@10': 1.0, 'time@10': 4.236}:  20%|██        | 2/10 [00:06<00:25,  3.21s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9267, 'compress@10': 0.7143, 'time@10': 3.9411}:  20%|██        | 2/10 [00:07<00:25,  3.21s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9267, 'compress@10': 0.7143, 'time@10': 3.9411}:  30%|███       | 3/10 [00:07<00:17,  2.53s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9585, 'compress@10': 0.7857, 'time@10': 3.9859}:  30%|███       | 3/10 [00:12<00:17,  2.53s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9585, 'compress@10': 0.7857, 'time@10': 3.9859}:  40%|████      | 4/10 [00:12<00:19,  3.17s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9589, 'compress@10': 0.8286, 'time@10': 4.8456}:  40%|████      | 4/10 [00:16<00:19,  3.17s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9589, 'compress@10': 0.8286, 'time@10': 4.8456}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9608, 'compress@10': 0.8571, 'time@10': 5.0352}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9608, 'compress@10': 0.8571, 'time@10': 5.0352}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.9604, 'compress@10': 0.8775, 'time@10': 5.2141}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.9604, 'compress@10': 0.8775, 'time@10': 5.2141}:  70%|███████   | 7/10 [00:25<00:11,  3.99s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.969, 'compress@10': 0.8928, 'time@10': 5.1016}:  70%|███████   | 7/10 [00:29<00:11,  3.99s/it]  {'epoch': 49, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.969, 'compress@10': 0.8928, 'time@10': 5.1016}:  80%|████████  | 8/10 [00:29<00:08,  4.11s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.9122, 'ndcg@10': 0.9668, 'compress@10': 0.9047, 'time@10': 5.4784}:  80%|████████  | 8/10 [00:34<00:08,  4.11s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.9122, 'ndcg@10': 0.9668, 'compress@10': 0.9047, 'time@10': 5.4784}:  90%|█████████ | 9/10 [00:34<00:04,  4.16s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9187, 'ndcg@10': 0.9679, 'compress@10': 0.9143, 'time@10': 5.4642}:  90%|█████████ | 9/10 [00:39<00:04,  4.16s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9187, 'ndcg@10': 0.9679, 'compress@10': 0.9143, 'time@10': 5.4642}: 100%|██████████| 10/10 [00:39<00:00,  4.54s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9187, 'ndcg@10': 0.9679, 'compress@10': 0.9143, 'time@10': 5.4642}: 100%|██████████| 10/10 [00:39<00:00,  3.95s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.011078451490867686
Avg hit ratio: 0.9187477809871698
Avg ndcg: 0.9678720110584174
Avg compression ratio: 0.9142581922519201
Avg train time: 5.464191484451294
Std train time: 1.70942382190532
[0.9901960784313726, 0.9901960784313726, 0.02941176470588236, 0.9901960784313726, 0.9901960784313726, 0.9901960784313726, 0.9901960784313726, 0.9705882352941176, 0.9901960784313726, 0.9901960784313726]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
