  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2263, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.5041, 'compress@10': 1.0, 'time@10': 4.3152}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2263, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.5041, 'compress@10': 1.0, 'time@10': 4.3152}:   3%|▎         | 1/30 [00:02<01:03,  2.20s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1656, 'hit_ratio@10': 0.5068, 'ndcg@10': 0.5491, 'compress@10': 1.0, 'time@10': 3.5115}:   3%|▎         | 1/30 [00:04<01:03,  2.20s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1656, 'hit_ratio@10': 0.5068, 'ndcg@10': 0.5491, 'compress@10': 1.0, 'time@10': 3.5115}:   7%|▋         | 2/30 [00:04<01:10,  2.52s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9006, 'hit_ratio@10': 0.4807, 'ndcg@10': 0.3661, 'compress@10': 1.0, 'time@10': 2.7099}:   7%|▋         | 2/30 [00:05<01:10,  2.52s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9006, 'hit_ratio@10': 0.4807, 'ndcg@10': 0.3661, 'compress@10': 1.0, 'time@10': 2.7099}:  10%|█         | 3/30 [00:05<00:44,  1.64s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7117, 'hit_ratio@10': 0.5391, 'ndcg@10': 0.4119, 'compress@10': 1.0, 'time@10': 2.6385}:  10%|█         | 3/30 [00:08<00:44,  1.64s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7117, 'hit_ratio@10': 0.5391, 'ndcg@10': 0.4119, 'compress@10': 1.0, 'time@10': 2.6385}:  13%|█▎        | 4/30 [00:08<00:51,  1.97s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.589, 'hit_ratio@10': 0.5953, 'ndcg@10': 0.4752, 'compress@10': 1.0, 'time@10': 3.8866}:  13%|█▎        | 4/30 [00:12<00:51,  1.97s/it] {'epoch': 0, 'num_users': 5.8, 'loss': 0.589, 'hit_ratio@10': 0.5953, 'ndcg@10': 0.4752, 'compress@10': 1.0, 'time@10': 3.8866}:  17%|█▋        | 5/30 [00:12<01:11,  2.88s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5068, 'hit_ratio@10': 0.6109, 'ndcg@10': 0.5187, 'compress@10': 1.0, 'time@10': 3.9053}:  17%|█▋        | 5/30 [00:16<01:11,  2.88s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5068, 'hit_ratio@10': 0.6109, 'ndcg@10': 0.5187, 'compress@10': 1.0, 'time@10': 3.9053}:  20%|██        | 6/30 [00:16<01:18,  3.27s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4559, 'hit_ratio@10': 0.6093, 'ndcg@10': 0.5206, 'compress@10': 1.0, 'time@10': 3.9266}:  20%|██        | 6/30 [00:18<01:18,  3.27s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4559, 'hit_ratio@10': 0.6093, 'ndcg@10': 0.5206, 'compress@10': 1.0, 'time@10': 3.9266}:  23%|██▎       | 7/30 [00:18<01:06,  2.88s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.4074, 'hit_ratio@10': 0.6439, 'ndcg@10': 0.5417, 'compress@10': 1.0, 'time@10': 3.7949}:  23%|██▎       | 7/30 [00:21<01:06,  2.88s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.4074, 'hit_ratio@10': 0.6439, 'ndcg@10': 0.5417, 'compress@10': 1.0, 'time@10': 3.7949}:  27%|██▋       | 8/30 [00:21<01:03,  2.89s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3703, 'hit_ratio@10': 0.6612, 'ndcg@10': 0.5802, 'compress@10': 1.0, 'time@10': 4.0572}:  27%|██▋       | 8/30 [00:24<01:03,  2.89s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3703, 'hit_ratio@10': 0.6612, 'ndcg@10': 0.5802, 'compress@10': 1.0, 'time@10': 4.0572}:  30%|███       | 9/30 [00:24<01:02,  2.96s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3395, 'hit_ratio@10': 0.6883, 'ndcg@10': 0.5993, 'compress@10': 1.0, 'time@10': 4.0368}:  30%|███       | 9/30 [00:28<01:02,  2.96s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.3395, 'hit_ratio@10': 0.6883, 'ndcg@10': 0.5993, 'compress@10': 1.0, 'time@10': 4.0368}:  33%|███▎      | 10/30 [00:28<01:05,  3.25s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.3233, 'hit_ratio@10': 0.6887, 'ndcg@10': 0.596, 'compress@10': 1.0, 'time@10': 4.0794}:  33%|███▎      | 10/30 [00:30<01:05,  3.25s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.3233, 'hit_ratio@10': 0.6887, 'ndcg@10': 0.596, 'compress@10': 1.0, 'time@10': 4.0794}:  37%|███▋      | 11/30 [00:30<00:56,  2.96s/it]{'epoch': 0, 'num_users': 6.4167, 'loss': 0.5201, 'hit_ratio@10': 0.659, 'ndcg@10': 0.5489, 'compress@10': 1.0, 'time@10': 3.8196}:  37%|███▋      | 11/30 [00:31<00:56,  2.96s/it]{'epoch': 0, 'num_users': 6.4167, 'loss': 0.5201, 'hit_ratio@10': 0.659, 'ndcg@10': 0.5489, 'compress@10': 1.0, 'time@10': 3.8196}:  40%|████      | 12/30 [00:31<00:42,  2.36s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.4948, 'hit_ratio@10': 0.6643, 'ndcg@10': 0.5448, 'compress@10': 1.0, 'time@10': 3.8206}:  40%|████      | 12/30 [00:33<00:42,  2.36s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.4948, 'hit_ratio@10': 0.6643, 'ndcg@10': 0.5448, 'compress@10': 1.0, 'time@10': 3.8206}:  43%|████▎     | 13/30 [00:33<00:38,  2.24s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.6673, 'hit_ratio@10': 0.6287, 'ndcg@10': 0.5059, 'compress@10': 1.0, 'time@10': 3.5792}:  43%|████▎     | 13/30 [00:34<00:38,  2.24s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.6673, 'hit_ratio@10': 0.6287, 'ndcg@10': 0.5059, 'compress@10': 1.0, 'time@10': 3.5792}:  47%|████▋     | 14/30 [00:34<00:27,  1.71s/it]{'epoch': 0, 'num_users': 6.2667, 'loss': 0.6309, 'hit_ratio@10': 0.6427, 'ndcg@10': 0.514, 'compress@10': 1.0, 'time@10': 3.7023}:  47%|████▋     | 14/30 [00:37<00:27,  1.71s/it] {'epoch': 0, 'num_users': 6.2667, 'loss': 0.6309, 'hit_ratio@10': 0.6427, 'ndcg@10': 0.514, 'compress@10': 1.0, 'time@10': 3.7023}:  50%|█████     | 15/30 [00:37<00:30,  2.02s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.7468, 'hit_ratio@10': 0.6234, 'ndcg@10': 0.4837, 'compress@10': 1.0, 'time@10': 3.5331}:  50%|█████     | 15/30 [00:38<00:30,  2.02s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.7468, 'hit_ratio@10': 0.6234, 'ndcg@10': 0.4837, 'compress@10': 1.0, 'time@10': 3.5331}:  53%|█████▎    | 16/30 [00:38<00:24,  1.72s/it]{'epoch': 0, 'num_users': 5.8235, 'loss': 0.8471, 'hit_ratio@10': 0.622, 'ndcg@10': 0.4553, 'compress@10': 1.0, 'time@10': 3.366}:  53%|█████▎    | 16/30 [00:38<00:24,  1.72s/it]  {'epoch': 0, 'num_users': 5.8235, 'loss': 0.8471, 'hit_ratio@10': 0.622, 'ndcg@10': 0.4553, 'compress@10': 1.0, 'time@10': 3.366}:  57%|█████▋    | 17/30 [00:38<00:17,  1.32s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 0.8072, 'hit_ratio@10': 0.6291, 'ndcg@10': 0.4675, 'compress@10': 1.0, 'time@10': 3.3169}:  57%|█████▋    | 17/30 [00:40<00:17,  1.32s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 0.8072, 'hit_ratio@10': 0.6291, 'ndcg@10': 0.4675, 'compress@10': 1.0, 'time@10': 3.3169}:  60%|██████    | 18/30 [00:40<00:20,  1.68s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.8513, 'hit_ratio@10': 0.6223, 'ndcg@10': 0.4448, 'compress@10': 1.0, 'time@10': 3.2658}:  60%|██████    | 18/30 [00:42<00:20,  1.68s/it]   {'epoch': 0, 'num_users': 6.0, 'loss': 0.8513, 'hit_ratio@10': 0.6223, 'ndcg@10': 0.4448, 'compress@10': 1.0, 'time@10': 3.2658}:  63%|██████▎   | 19/30 [00:42<00:16,  1.54s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.8124, 'hit_ratio@10': 0.6325, 'ndcg@10': 0.4615, 'compress@10': 1.0, 'time@10': 3.356}:  63%|██████▎   | 19/30 [00:47<00:16,  1.54s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.8124, 'hit_ratio@10': 0.6325, 'ndcg@10': 0.4615, 'compress@10': 1.0, 'time@10': 3.356}:  67%|██████▋   | 20/30 [00:47<00:26,  2.61s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.7787, 'hit_ratio@10': 0.6369, 'ndcg@10': 0.4732, 'compress@10': 1.0, 'time@10': 3.5382}:  67%|██████▋   | 20/30 [00:50<00:26,  2.61s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.7787, 'hit_ratio@10': 0.6369, 'ndcg@10': 0.4732, 'compress@10': 1.0, 'time@10': 3.5382}:  70%|███████   | 21/30 [00:50<00:26,  2.92s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 0.7579, 'hit_ratio@10': 0.643, 'ndcg@10': 0.4652, 'compress@10': 1.0, 'time@10': 3.4581}:  70%|███████   | 21/30 [00:52<00:26,  2.92s/it] {'epoch': 0, 'num_users': 6.1818, 'loss': 0.7579, 'hit_ratio@10': 0.643, 'ndcg@10': 0.4652, 'compress@10': 1.0, 'time@10': 3.4581}:  73%|███████▎  | 22/30 [00:52<00:20,  2.59s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 0.7323, 'hit_ratio@10': 0.6455, 'ndcg@10': 0.467, 'compress@10': 1.0, 'time@10': 3.4546}:  73%|███████▎  | 22/30 [00:54<00:20,  2.59s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 0.7323, 'hit_ratio@10': 0.6455, 'ndcg@10': 0.467, 'compress@10': 1.0, 'time@10': 3.4546}:  77%|███████▋  | 23/30 [00:54<00:16,  2.33s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.8098, 'hit_ratio@10': 0.6269, 'ndcg@10': 0.4475, 'compress@10': 1.0, 'time@10': 3.3249}:  77%|███████▋  | 23/30 [00:54<00:16,  2.33s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.8098, 'hit_ratio@10': 0.6269, 'ndcg@10': 0.4475, 'compress@10': 1.0, 'time@10': 3.3249}:  80%|████████  | 24/30 [00:54<00:10,  1.75s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.8624, 'hit_ratio@10': 0.6019, 'ndcg@10': 0.4296, 'compress@10': 1.0, 'time@10': 3.2056}:  80%|████████  | 24/30 [00:55<00:10,  1.75s/it]   {'epoch': 0, 'num_users': 5.8, 'loss': 0.8624, 'hit_ratio@10': 0.6019, 'ndcg@10': 0.4296, 'compress@10': 1.0, 'time@10': 3.2056}:  83%|████████▎ | 25/30 [00:55<00:06,  1.29s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.8328, 'hit_ratio@10': 0.6106, 'ndcg@10': 0.4425, 'compress@10': 1.0, 'time@10': 3.3502}:  83%|████████▎ | 25/30 [01:02<00:06,  1.29s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.8328, 'hit_ratio@10': 0.6106, 'ndcg@10': 0.4425, 'compress@10': 1.0, 'time@10': 3.3502}:  87%|████████▋ | 26/30 [01:02<00:12,  3.00s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 0.8057, 'hit_ratio@10': 0.6158, 'ndcg@10': 0.4472, 'compress@10': 1.0, 'time@10': 3.4077}:  87%|████████▋ | 26/30 [01:04<00:12,  3.00s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 0.8057, 'hit_ratio@10': 0.6158, 'ndcg@10': 0.4472, 'compress@10': 1.0, 'time@10': 3.4077}:  90%|█████████ | 27/30 [01:04<00:08,  2.85s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.7791, 'hit_ratio@10': 0.6225, 'ndcg@10': 0.4627, 'compress@10': 1.0, 'time@10': 3.4525}:  90%|█████████ | 27/30 [01:09<00:08,  2.85s/it]   {'epoch': 0, 'num_users': 6.0, 'loss': 0.7791, 'hit_ratio@10': 0.6225, 'ndcg@10': 0.4627, 'compress@10': 1.0, 'time@10': 3.4525}:  93%|█████████▎| 28/30 [01:09<00:06,  3.40s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.7581, 'hit_ratio@10': 0.6308, 'ndcg@10': 0.4655, 'compress@10': 1.0, 'time@10': 3.4546}:  93%|█████████▎| 28/30 [01:11<00:06,  3.40s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.7581, 'hit_ratio@10': 0.6308, 'ndcg@10': 0.4655, 'compress@10': 1.0, 'time@10': 3.4546}:  97%|█████████▋| 29/30 [01:11<00:02,  2.92s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.7351, 'hit_ratio@10': 0.6359, 'ndcg@10': 0.4774, 'compress@10': 1.0, 'time@10': 3.4382}:  97%|█████████▋| 29/30 [01:14<00:02,  2.92s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.7351, 'hit_ratio@10': 0.6359, 'ndcg@10': 0.4774, 'compress@10': 1.0, 'time@10': 3.4382}: 100%|██████████| 30/30 [01:14<00:00,  2.94s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.7351, 'hit_ratio@10': 0.6359, 'ndcg@10': 0.4774, 'compress@10': 1.0, 'time@10': 3.4382}: 100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch: 0
Avg # of users: 5.866666666666666
Avg Loss: 0.7351312848083812
Avg hit ratio: 0.635912765251078
Avg ndcg: 0.47740813245288016
Avg compression ratio: 0.9999999860153537
Avg train time: 3.4382160981496175
Std train time: 2.1358746823270143
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[7, 12, 17, 13, 1, 8, 8, 12, 2, 9, 7, 17, 9, 19, 4, 17, 18, 13, 13, 5, 1, 15, 10, 19, 19, 1, 6, 6, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.1096, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5877, 'compress@10': 1.0, 'time@10': 2.223}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.1096, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5877, 'compress@10': 1.0, 'time@10': 2.223}:   3%|▎         | 1/30 [00:01<00:33,  1.15s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0812, 'hit_ratio@10': 0.6927, 'ndcg@10': 0.7204, 'compress@10': 1.0, 'time@10': 2.7506}:   3%|▎         | 1/30 [00:04<00:33,  1.15s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0812, 'hit_ratio@10': 0.6927, 'ndcg@10': 0.7204, 'compress@10': 1.0, 'time@10': 2.7506}:   7%|▋         | 2/30 [00:04<01:07,  2.42s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0594, 'hit_ratio@10': 0.6999, 'ndcg@10': 0.7464, 'compress@10': 1.0, 'time@10': 2.4343}:   7%|▋         | 2/30 [00:05<01:07,  2.42s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0594, 'hit_ratio@10': 0.6999, 'ndcg@10': 0.7464, 'compress@10': 1.0, 'time@10': 2.4343}:  10%|█         | 3/30 [00:05<00:47,  1.74s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0571, 'hit_ratio@10': 0.7481, 'ndcg@10': 0.7708, 'compress@10': 1.0, 'time@10': 2.6305}:  10%|█         | 3/30 [00:08<00:47,  1.74s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0571, 'hit_ratio@10': 0.7481, 'ndcg@10': 0.7708, 'compress@10': 1.0, 'time@10': 2.6305}:  13%|█▎        | 4/30 [00:08<01:00,  2.34s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.1349, 'hit_ratio@10': 0.7046, 'ndcg@10': 0.6876, 'compress@10': 1.0, 'time@10': 2.2735}:  13%|█▎        | 4/30 [00:09<01:00,  2.34s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.1349, 'hit_ratio@10': 0.7046, 'ndcg@10': 0.6876, 'compress@10': 1.0, 'time@10': 2.2735}:  17%|█▋        | 5/30 [00:09<00:41,  1.66s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.1263, 'hit_ratio@10': 0.6983, 'ndcg@10': 0.7078, 'compress@10': 1.0, 'time@10': 2.4224}:  17%|█▋        | 5/30 [00:12<00:41,  1.66s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.1263, 'hit_ratio@10': 0.6983, 'ndcg@10': 0.7078, 'compress@10': 1.0, 'time@10': 2.4224}:  20%|██        | 6/30 [00:12<00:52,  2.19s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.1179, 'hit_ratio@10': 0.7185, 'ndcg@10': 0.7096, 'compress@10': 1.0, 'time@10': 2.5744}:  20%|██        | 6/30 [00:14<00:52,  2.19s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.1179, 'hit_ratio@10': 0.7185, 'ndcg@10': 0.7096, 'compress@10': 1.0, 'time@10': 2.5744}:  23%|██▎       | 7/30 [00:14<00:47,  2.06s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.1078, 'hit_ratio@10': 0.743, 'ndcg@10': 0.7302, 'compress@10': 1.0, 'time@10': 2.7009}:  23%|██▎       | 7/30 [00:17<00:47,  2.06s/it]  {'epoch': 1, 'num_users': 6.125, 'loss': 0.1078, 'hit_ratio@10': 0.743, 'ndcg@10': 0.7302, 'compress@10': 1.0, 'time@10': 2.7009}:  27%|██▋       | 8/30 [00:17<00:56,  2.56s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.118, 'hit_ratio@10': 0.7208, 'ndcg@10': 0.7293, 'compress@10': 1.0, 'time@10': 2.5321}:  27%|██▋       | 8/30 [00:18<00:56,  2.56s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.118, 'hit_ratio@10': 0.7208, 'ndcg@10': 0.7293, 'compress@10': 1.0, 'time@10': 2.5321}:  30%|███       | 9/30 [00:18<00:41,  1.95s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.1111, 'hit_ratio@10': 0.7419, 'ndcg@10': 0.7414, 'compress@10': 1.0, 'time@10': 2.6309}:  30%|███       | 9/30 [00:21<00:41,  1.95s/it]  {'epoch': 1, 'num_users': 6.3, 'loss': 0.1111, 'hit_ratio@10': 0.7419, 'ndcg@10': 0.7414, 'compress@10': 1.0, 'time@10': 2.6309}:  33%|███▎      | 10/30 [00:21<00:48,  2.45s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.1107, 'hit_ratio@10': 0.7409, 'ndcg@10': 0.7384, 'compress@10': 1.0, 'time@10': 2.6377}:  33%|███▎      | 10/30 [00:23<00:48,  2.45s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.1107, 'hit_ratio@10': 0.7409, 'ndcg@10': 0.7384, 'compress@10': 1.0, 'time@10': 2.6377}:  37%|███▋      | 11/30 [00:23<00:40,  2.13s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.1032, 'hit_ratio@10': 0.7416, 'ndcg@10': 0.754, 'compress@10': 1.0, 'time@10': 2.5289}:  37%|███▋      | 11/30 [00:24<00:40,  2.13s/it] {'epoch': 1, 'num_users': 6.4167, 'loss': 0.1032, 'hit_ratio@10': 0.7416, 'ndcg@10': 0.754, 'compress@10': 1.0, 'time@10': 2.5289}:  40%|████      | 12/30 [00:24<00:34,  1.90s/it]{'epoch': 1, 'num_users': 6.6154, 'loss': 0.1014, 'hit_ratio@10': 0.751, 'ndcg@10': 0.7562, 'compress@10': 1.0, 'time@10': 2.5591}:  40%|████      | 12/30 [00:26<00:34,  1.90s/it]{'epoch': 1, 'num_users': 6.6154, 'loss': 0.1014, 'hit_ratio@10': 0.751, 'ndcg@10': 0.7562, 'compress@10': 1.0, 'time@10': 2.5591}:  43%|████▎     | 13/30 [00:26<00:30,  1.78s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.0988, 'hit_ratio@10': 0.745, 'ndcg@10': 0.7491, 'compress@10': 1.0, 'time@10': 2.4308}:  43%|████▎     | 13/30 [00:27<00:30,  1.78s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.0988, 'hit_ratio@10': 0.745, 'ndcg@10': 0.7491, 'compress@10': 1.0, 'time@10': 2.4308}:  47%|████▋     | 14/30 [00:27<00:25,  1.57s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.1031, 'hit_ratio@10': 0.7426, 'ndcg@10': 0.7363, 'compress@10': 1.0, 'time@10': 2.4039}:  47%|████▋     | 14/30 [00:28<00:25,  1.57s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.1031, 'hit_ratio@10': 0.7426, 'ndcg@10': 0.7363, 'compress@10': 1.0, 'time@10': 2.4039}:  50%|█████     | 15/30 [00:28<00:21,  1.41s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.0978, 'hit_ratio@10': 0.7535, 'ndcg@10': 0.7462, 'compress@10': 1.0, 'time@10': 2.3622}:  50%|█████     | 15/30 [00:30<00:21,  1.41s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.0978, 'hit_ratio@10': 0.7535, 'ndcg@10': 0.7462, 'compress@10': 1.0, 'time@10': 2.3622}:  53%|█████▎    | 16/30 [00:30<00:21,  1.52s/it]{'epoch': 1, 'num_users': 5.8235, 'loss': 0.0997, 'hit_ratio@10': 0.7445, 'ndcg@10': 0.7295, 'compress@10': 1.0, 'time@10': 2.298}:  53%|█████▎    | 16/30 [00:30<00:21,  1.52s/it] {'epoch': 1, 'num_users': 5.8235, 'loss': 0.0997, 'hit_ratio@10': 0.7445, 'ndcg@10': 0.7295, 'compress@10': 1.0, 'time@10': 2.298}:  57%|█████▋    | 17/30 [00:30<00:16,  1.27s/it]{'epoch': 1, 'num_users': 6.0556, 'loss': 0.0978, 'hit_ratio@10': 0.7448, 'ndcg@10': 0.7359, 'compress@10': 1.0, 'time@10': 2.3512}:  57%|█████▋    | 17/30 [00:34<00:16,  1.27s/it]{'epoch': 1, 'num_users': 6.0556, 'loss': 0.0978, 'hit_ratio@10': 0.7448, 'ndcg@10': 0.7359, 'compress@10': 1.0, 'time@10': 2.3512}:  60%|██████    | 18/30 [00:34<00:22,  1.88s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.094, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.7442, 'compress@10': 1.0, 'time@10': 2.3845}:  60%|██████    | 18/30 [00:35<00:22,  1.88s/it]    {'epoch': 1, 'num_users': 6.0, 'loss': 0.094, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.7442, 'compress@10': 1.0, 'time@10': 2.3845}:  63%|██████▎   | 19/30 [00:35<00:19,  1.78s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.0933, 'hit_ratio@10': 0.7544, 'ndcg@10': 0.743, 'compress@10': 1.0, 'time@10': 2.3929}:  63%|██████▎   | 19/30 [00:38<00:19,  1.78s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.0933, 'hit_ratio@10': 0.7544, 'ndcg@10': 0.743, 'compress@10': 1.0, 'time@10': 2.3929}:  67%|██████▋   | 20/30 [00:38<00:20,  2.02s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.1235, 'hit_ratio@10': 0.7441, 'ndcg@10': 0.7217, 'compress@10': 1.0, 'time@10': 2.3136}:  67%|██████▋   | 20/30 [00:38<00:20,  2.02s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.1235, 'hit_ratio@10': 0.7441, 'ndcg@10': 0.7217, 'compress@10': 1.0, 'time@10': 2.3136}:  70%|███████   | 21/30 [00:38<00:13,  1.53s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.1196, 'hit_ratio@10': 0.7516, 'ndcg@10': 0.7295, 'compress@10': 1.0, 'time@10': 2.3309}:  70%|███████   | 21/30 [00:41<00:13,  1.53s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.1196, 'hit_ratio@10': 0.7516, 'ndcg@10': 0.7295, 'compress@10': 1.0, 'time@10': 2.3309}:  73%|███████▎  | 22/30 [00:41<00:15,  1.89s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.1163, 'hit_ratio@10': 0.7559, 'ndcg@10': 0.7337, 'compress@10': 1.0, 'time@10': 2.3685}:  73%|███████▎  | 22/30 [00:42<00:15,  1.89s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.1163, 'hit_ratio@10': 0.7559, 'ndcg@10': 0.7337, 'compress@10': 1.0, 'time@10': 2.3685}:  77%|███████▋  | 23/30 [00:42<00:12,  1.82s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.1165, 'hit_ratio@10': 0.7494, 'ndcg@10': 0.723, 'compress@10': 1.0, 'time@10': 2.2963}:  77%|███████▋  | 23/30 [00:43<00:12,  1.82s/it] {'epoch': 1, 'num_users': 5.9583, 'loss': 0.1165, 'hit_ratio@10': 0.7494, 'ndcg@10': 0.723, 'compress@10': 1.0, 'time@10': 2.2963}:  80%|████████  | 24/30 [00:43<00:08,  1.47s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.1358, 'hit_ratio@10': 0.7328, 'ndcg@10': 0.6968, 'compress@10': 1.0, 'time@10': 2.2318}:  80%|████████  | 24/30 [00:44<00:08,  1.47s/it]  {'epoch': 1, 'num_users': 5.8, 'loss': 0.1358, 'hit_ratio@10': 0.7328, 'ndcg@10': 0.6968, 'compress@10': 1.0, 'time@10': 2.2318}:  83%|████████▎ | 25/30 [00:44<00:05,  1.15s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.1446, 'hit_ratio@10': 0.724, 'ndcg@10': 0.6868, 'compress@10': 1.0, 'time@10': 2.1734}:  83%|████████▎ | 25/30 [00:44<00:05,  1.15s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.1446, 'hit_ratio@10': 0.724, 'ndcg@10': 0.6868, 'compress@10': 1.0, 'time@10': 2.1734}:  87%|████████▋ | 26/30 [00:44<00:04,  1.03s/it]{'epoch': 1, 'num_users': 5.8889, 'loss': 0.1419, 'hit_ratio@10': 0.7303, 'ndcg@10': 0.6874, 'compress@10': 1.0, 'time@10': 2.201}:  87%|████████▋ | 26/30 [00:46<00:04,  1.03s/it]{'epoch': 1, 'num_users': 5.8889, 'loss': 0.1419, 'hit_ratio@10': 0.7303, 'ndcg@10': 0.6874, 'compress@10': 1.0, 'time@10': 2.201}:  90%|█████████ | 27/30 [00:46<00:03,  1.17s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.1391, 'hit_ratio@10': 0.7336, 'ndcg@10': 0.694, 'compress@10': 1.0, 'time@10': 2.2222}:  90%|█████████ | 27/30 [00:49<00:03,  1.17s/it]   {'epoch': 1, 'num_users': 6.0, 'loss': 0.1391, 'hit_ratio@10': 0.7336, 'ndcg@10': 0.694, 'compress@10': 1.0, 'time@10': 2.2222}:  93%|█████████▎| 28/30 [00:49<00:03,  1.67s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.1352, 'hit_ratio@10': 0.7397, 'ndcg@10': 0.7001, 'compress@10': 1.0, 'time@10': 2.2673}:  93%|█████████▎| 28/30 [00:50<00:03,  1.67s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.1352, 'hit_ratio@10': 0.7397, 'ndcg@10': 0.7001, 'compress@10': 1.0, 'time@10': 2.2673}:  97%|█████████▋| 29/30 [00:50<00:01,  1.71s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.132, 'hit_ratio@10': 0.7402, 'ndcg@10': 0.7068, 'compress@10': 1.0, 'time@10': 2.3082}:  97%|█████████▋| 29/30 [00:54<00:01,  1.71s/it] {'epoch': 1, 'num_users': 5.8667, 'loss': 0.132, 'hit_ratio@10': 0.7402, 'ndcg@10': 0.7068, 'compress@10': 1.0, 'time@10': 2.3082}: 100%|██████████| 30/30 [00:54<00:00,  2.26s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.132, 'hit_ratio@10': 0.7402, 'ndcg@10': 0.7068, 'compress@10': 1.0, 'time@10': 2.3082}: 100%|██████████| 30/30 [00:54<00:00,  1.82s/it]
Epoch: 1
Avg # of users: 5.866666666666666
Avg Loss: 0.13200340105969266
Avg hit ratio: 0.7402398412533222
Avg ndcg: 0.706779414332231
Avg compression ratio: 0.9999999860166272
Avg train time: 2.3081897338231405
Std train time: 1.038643782563162
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 12, 22, 14, 9, 9, 8, 12, 9, 9, 9, 23, 11, 27, 8, 22, 24, 14, 14, 8, 9, 17, 11, 27, 27, 9, 8, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8376, 'compress@10': 1.0, 'time@10': 3.5898}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8376, 'compress@10': 1.0, 'time@10': 3.5898}:   3%|▎         | 1/30 [00:01<00:53,  1.84s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 3.4268}:   3%|▎         | 1/30 [00:05<00:53,  1.84s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 3.4268}:   7%|▋         | 2/30 [00:05<01:15,  2.70s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 3.033}:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 3.033}:  10%|█         | 3/30 [00:06<00:53,  1.99s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 3.0551}:  10%|█         | 3/30 [00:09<00:53,  1.99s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 3.0551}:  13%|█▎        | 4/30 [00:09<01:03,  2.45s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0476, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8356, 'compress@10': 1.0, 'time@10': 3.9057}:  13%|█▎        | 4/30 [00:13<01:03,  2.45s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0476, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8356, 'compress@10': 1.0, 'time@10': 3.9057}:  17%|█▋        | 5/30 [00:13<01:12,  2.90s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0531, 'hit_ratio@10': 0.7981, 'ndcg@10': 0.8316, 'compress@10': 1.0, 'time@10': 3.841}:  17%|█▋        | 5/30 [00:16<01:12,  2.90s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0531, 'hit_ratio@10': 0.7981, 'ndcg@10': 0.8316, 'compress@10': 1.0, 'time@10': 3.841}:  20%|██        | 6/30 [00:16<01:14,  3.12s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0523, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.8352, 'compress@10': 1.0, 'time@10': 3.7714}:  20%|██        | 6/30 [00:18<01:14,  3.12s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0523, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.8352, 'compress@10': 1.0, 'time@10': 3.7714}:  23%|██▎       | 7/30 [00:18<01:01,  2.66s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0504, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.7468}:  23%|██▎       | 7/30 [00:22<01:01,  2.66s/it]  {'epoch': 2, 'num_users': 6.125, 'loss': 0.0504, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.7468}:  27%|██▋       | 8/30 [00:22<01:05,  2.96s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0487, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8464, 'compress@10': 1.0, 'time@10': 3.9421}:  27%|██▋       | 8/30 [00:24<01:05,  2.96s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0487, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8464, 'compress@10': 1.0, 'time@10': 3.9421}:  30%|███       | 9/30 [00:24<01:01,  2.91s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0485, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8469, 'compress@10': 1.0, 'time@10': 3.8904}:  30%|███       | 9/30 [00:28<01:01,  2.91s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0485, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8469, 'compress@10': 1.0, 'time@10': 3.8904}:  33%|███▎      | 10/30 [00:28<01:01,  3.09s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.0503, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 3.9166}:  33%|███▎      | 10/30 [00:30<01:01,  3.09s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.0503, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 3.9166}:  37%|███▋      | 11/30 [00:30<00:53,  2.80s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0475, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8538, 'compress@10': 1.0, 'time@10': 3.7725}:  37%|███▋      | 11/30 [00:32<00:53,  2.80s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0475, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8538, 'compress@10': 1.0, 'time@10': 3.7725}:  40%|████      | 12/30 [00:32<00:47,  2.62s/it]{'epoch': 2, 'num_users': 6.6154, 'loss': 0.0478, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8557, 'compress@10': 1.0, 'time@10': 3.8129}:  40%|████      | 12/30 [00:34<00:47,  2.62s/it]{'epoch': 2, 'num_users': 6.6154, 'loss': 0.0478, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8557, 'compress@10': 1.0, 'time@10': 3.8129}:  43%|████▎     | 13/30 [00:34<00:42,  2.49s/it]{'epoch': 2, 'num_users': 6.3571, 'loss': 0.0454, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 3.6237}:  43%|████▎     | 13/30 [00:36<00:42,  2.49s/it] {'epoch': 2, 'num_users': 6.3571, 'loss': 0.0454, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 3.6237}:  47%|████▋     | 14/30 [00:36<00:33,  2.10s/it]{'epoch': 2, 'num_users': 6.2667, 'loss': 0.0463, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 3.6628}:  47%|████▋     | 14/30 [00:38<00:33,  2.10s/it]{'epoch': 2, 'num_users': 6.2667, 'loss': 0.0463, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 3.6628}:  50%|█████     | 15/30 [00:38<00:31,  2.11s/it]{'epoch': 2, 'num_users': 6.0625, 'loss': 0.0444, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8553, 'compress@10': 1.0, 'time@10': 3.5588}:  50%|█████     | 15/30 [00:40<00:31,  2.11s/it]{'epoch': 2, 'num_users': 6.0625, 'loss': 0.0444, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8553, 'compress@10': 1.0, 'time@10': 3.5588}:  53%|█████▎    | 16/30 [00:40<00:29,  2.09s/it]{'epoch': 2, 'num_users': 5.8235, 'loss': 0.043, 'hit_ratio@10': 0.8137, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 3.4423}:  53%|█████▎    | 16/30 [00:41<00:29,  2.09s/it]{'epoch': 2, 'num_users': 5.8235, 'loss': 0.043, 'hit_ratio@10': 0.8137, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 3.4423}:  57%|█████▋    | 17/30 [00:41<00:22,  1.71s/it]{'epoch': 2, 'num_users': 6.0556, 'loss': 0.044, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8474, 'compress@10': 1.0, 'time@10': 3.4478}:  57%|█████▋    | 17/30 [00:44<00:22,  1.71s/it]{'epoch': 2, 'num_users': 6.0556, 'loss': 0.044, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8474, 'compress@10': 1.0, 'time@10': 3.4478}:  60%|██████    | 18/30 [00:44<00:27,  2.27s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.0427, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 3.4429}:  60%|██████    | 18/30 [00:46<00:27,  2.27s/it]  {'epoch': 2, 'num_users': 6.0, 'loss': 0.0427, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 3.4429}:  63%|██████▎   | 19/30 [00:46<00:23,  2.11s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.0439, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8476, 'compress@10': 1.0, 'time@10': 3.4795}:  63%|██████▎   | 19/30 [00:50<00:23,  2.11s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.0439, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8476, 'compress@10': 1.0, 'time@10': 3.4795}:  67%|██████▋   | 20/30 [00:50<00:27,  2.74s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0454, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8457, 'compress@10': 1.0, 'time@10': 3.624}:  67%|██████▋   | 20/30 [00:53<00:27,  2.74s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0454, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8457, 'compress@10': 1.0, 'time@10': 3.624}:  70%|███████   | 21/30 [00:53<00:26,  2.91s/it]{'epoch': 2, 'num_users': 6.1818, 'loss': 0.0449, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8479, 'compress@10': 1.0, 'time@10': 3.5994}:  70%|███████   | 21/30 [00:57<00:26,  2.91s/it]{'epoch': 2, 'num_users': 6.1818, 'loss': 0.0449, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8479, 'compress@10': 1.0, 'time@10': 3.5994}:  73%|███████▎  | 22/30 [00:57<00:23,  2.98s/it]{'epoch': 2, 'num_users': 6.1304, 'loss': 0.044, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 3.6053}:  73%|███████▎  | 22/30 [00:58<00:23,  2.98s/it] {'epoch': 2, 'num_users': 6.1304, 'loss': 0.044, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 3.6053}:  77%|███████▋  | 23/30 [00:58<00:18,  2.66s/it]{'epoch': 2, 'num_users': 5.9583, 'loss': 0.044, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8435, 'compress@10': 1.0, 'time@10': 3.4936}:  77%|███████▋  | 23/30 [00:59<00:18,  2.66s/it]{'epoch': 2, 'num_users': 5.9583, 'loss': 0.044, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8435, 'compress@10': 1.0, 'time@10': 3.4936}:  80%|████████  | 24/30 [00:59<00:12,  2.16s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0433, 'hit_ratio@10': 0.8031, 'ndcg@10': 0.8295, 'compress@10': 1.0, 'time@10': 3.3929}:  80%|████████  | 24/30 [01:00<00:12,  2.16s/it]  {'epoch': 2, 'num_users': 5.8, 'loss': 0.0433, 'hit_ratio@10': 0.8031, 'ndcg@10': 0.8295, 'compress@10': 1.0, 'time@10': 3.3929}:  83%|████████▎ | 25/30 [01:00<00:08,  1.67s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.0449, 'hit_ratio@10': 0.805, 'ndcg@10': 0.8272, 'compress@10': 1.0, 'time@10': 3.4912}:  83%|████████▎ | 25/30 [01:06<00:08,  1.67s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.0449, 'hit_ratio@10': 0.805, 'ndcg@10': 0.8272, 'compress@10': 1.0, 'time@10': 3.4912}:  87%|████████▋ | 26/30 [01:06<00:11,  2.96s/it]{'epoch': 2, 'num_users': 5.8889, 'loss': 0.0446, 'hit_ratio@10': 0.8109, 'ndcg@10': 0.8291, 'compress@10': 1.0, 'time@10': 3.4956}:  87%|████████▋ | 26/30 [01:08<00:11,  2.96s/it]{'epoch': 2, 'num_users': 5.8889, 'loss': 0.0446, 'hit_ratio@10': 0.8109, 'ndcg@10': 0.8291, 'compress@10': 1.0, 'time@10': 3.4956}:  90%|█████████ | 27/30 [01:08<00:07,  2.63s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.045, 'hit_ratio@10': 0.8128, 'ndcg@10': 0.8307, 'compress@10': 1.0, 'time@10': 3.5017}:  90%|█████████ | 27/30 [01:12<00:07,  2.63s/it]    {'epoch': 2, 'num_users': 6.0, 'loss': 0.045, 'hit_ratio@10': 0.8128, 'ndcg@10': 0.8307, 'compress@10': 1.0, 'time@10': 3.5017}:  93%|█████████▎| 28/30 [01:12<00:05,  2.96s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.0441, 'hit_ratio@10': 0.8161, 'ndcg@10': 0.8331, 'compress@10': 1.0, 'time@10': 3.529}:  93%|█████████▎| 28/30 [01:14<00:05,  2.96s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.0441, 'hit_ratio@10': 0.8161, 'ndcg@10': 0.8331, 'compress@10': 1.0, 'time@10': 3.529}:  97%|█████████▋| 29/30 [01:14<00:02,  2.73s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0438, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8354, 'compress@10': 1.0, 'time@10': 3.5367}:  97%|█████████▋| 29/30 [01:17<00:02,  2.73s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0438, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8354, 'compress@10': 1.0, 'time@10': 3.5367}: 100%|██████████| 30/30 [01:17<00:00,  3.05s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0438, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8354, 'compress@10': 1.0, 'time@10': 3.5367}: 100%|██████████| 30/30 [01:18<00:00,  2.60s/it]
Epoch: 2
Avg # of users: 5.866666666666666
Avg Loss: 0.04382362648942751
Avg hit ratio: 0.8141259814696227
Avg ndcg: 0.8353578549715832
Avg compression ratio: 0.9999999860153537
Avg train time: 3.536684274673462
Std train time: 1.46680317775469
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 25, 15, 1, 9, 8, 12, 3, 9, 7, 27, 9, 34, 6, 26, 29, 14, 14, 6, 1, 18, 10, 34, 34, 2, 8, 7, 8, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 3.5133}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 3.5133}:   3%|▎         | 1/30 [00:01<00:52,  1.79s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 3.4447}:   3%|▎         | 1/30 [00:05<00:52,  1.79s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 3.4447}:   7%|▋         | 2/30 [00:05<01:16,  2.75s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0322, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8517, 'compress@10': 1.0, 'time@10': 3.0958}:   7%|▋         | 2/30 [00:06<01:16,  2.75s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0322, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8517, 'compress@10': 1.0, 'time@10': 3.0958}:  10%|█         | 3/30 [00:06<00:55,  2.06s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0357, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8478, 'compress@10': 1.0, 'time@10': 3.1873}:  10%|█         | 3/30 [00:09<00:55,  2.06s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0357, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8478, 'compress@10': 1.0, 'time@10': 3.1873}:  13%|█▎        | 4/30 [00:09<01:08,  2.63s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0733, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.7871, 'compress@10': 1.0, 'time@10': 2.7348}:  13%|█▎        | 4/30 [00:10<01:08,  2.63s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0733, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.7871, 'compress@10': 1.0, 'time@10': 2.7348}:  17%|█▋        | 5/30 [00:10<00:46,  1.86s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0741, 'hit_ratio@10': 0.7623, 'ndcg@10': 0.7928, 'compress@10': 1.0, 'time@10': 2.8733}:  17%|█▋        | 5/30 [00:14<00:46,  1.86s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0741, 'hit_ratio@10': 0.7623, 'ndcg@10': 0.7928, 'compress@10': 1.0, 'time@10': 2.8733}:  20%|██        | 6/30 [00:14<00:58,  2.45s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0698, 'hit_ratio@10': 0.7906, 'ndcg@10': 0.802, 'compress@10': 1.0, 'time@10': 2.983}:  20%|██        | 6/30 [00:15<00:58,  2.45s/it]  {'epoch': 3, 'num_users': 6.2857, 'loss': 0.0698, 'hit_ratio@10': 0.7906, 'ndcg@10': 0.802, 'compress@10': 1.0, 'time@10': 2.983}:  23%|██▎       | 7/30 [00:15<00:51,  2.26s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0689, 'hit_ratio@10': 0.806, 'ndcg@10': 0.8121, 'compress@10': 1.0, 'time@10': 3.0752}:  23%|██▎       | 7/30 [00:19<00:51,  2.26s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0689, 'hit_ratio@10': 0.806, 'ndcg@10': 0.8121, 'compress@10': 1.0, 'time@10': 3.0752}:  27%|██▋       | 8/30 [00:19<01:00,  2.74s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0685, 'hit_ratio@10': 0.7958, 'ndcg@10': 0.8199, 'compress@10': 1.0, 'time@10': 2.9437}:  27%|██▋       | 8/30 [00:20<01:00,  2.74s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0685, 'hit_ratio@10': 0.7958, 'ndcg@10': 0.8199, 'compress@10': 1.0, 'time@10': 2.9437}:  30%|███       | 9/30 [00:20<00:45,  2.19s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0663, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8219, 'compress@10': 1.0, 'time@10': 2.9898}:  30%|███       | 9/30 [00:24<00:45,  2.19s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0663, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8219, 'compress@10': 1.0, 'time@10': 2.9898}:  33%|███▎      | 10/30 [00:24<00:51,  2.57s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.0663, 'hit_ratio@10': 0.8093, 'ndcg@10': 0.8255, 'compress@10': 1.0, 'time@10': 3.0128}:  33%|███▎      | 10/30 [00:25<00:51,  2.57s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.0663, 'hit_ratio@10': 0.8093, 'ndcg@10': 0.8255, 'compress@10': 1.0, 'time@10': 3.0128}:  37%|███▋      | 11/30 [00:25<00:43,  2.29s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.0621, 'hit_ratio@10': 0.7974, 'ndcg@10': 0.8331, 'compress@10': 1.0, 'time@10': 2.9716}:  37%|███▋      | 11/30 [00:28<00:43,  2.29s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.0621, 'hit_ratio@10': 0.7974, 'ndcg@10': 0.8331, 'compress@10': 1.0, 'time@10': 2.9716}:  40%|████      | 12/30 [00:28<00:42,  2.37s/it]{'epoch': 3, 'num_users': 6.6154, 'loss': 0.0613, 'hit_ratio@10': 0.8025, 'ndcg@10': 0.8363, 'compress@10': 1.0, 'time@10': 3.0091}:  40%|████      | 12/30 [00:30<00:42,  2.37s/it]{'epoch': 3, 'num_users': 6.6154, 'loss': 0.0613, 'hit_ratio@10': 0.8025, 'ndcg@10': 0.8363, 'compress@10': 1.0, 'time@10': 3.0091}:  43%|████▎     | 13/30 [00:30<00:37,  2.19s/it]{'epoch': 3, 'num_users': 6.3571, 'loss': 0.0577, 'hit_ratio@10': 0.8047, 'ndcg@10': 0.8345, 'compress@10': 1.0, 'time@10': 2.8988}:  43%|████▎     | 13/30 [00:31<00:37,  2.19s/it]{'epoch': 3, 'num_users': 6.3571, 'loss': 0.0577, 'hit_ratio@10': 0.8047, 'ndcg@10': 0.8345, 'compress@10': 1.0, 'time@10': 2.8988}:  47%|████▋     | 14/30 [00:31<00:31,  1.98s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.0579, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8359, 'compress@10': 1.0, 'time@10': 2.9153}:  47%|████▋     | 14/30 [00:33<00:31,  1.98s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.0579, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8359, 'compress@10': 1.0, 'time@10': 2.9153}:  50%|█████     | 15/30 [00:33<00:28,  1.87s/it]{'epoch': 3, 'num_users': 6.0625, 'loss': 0.0552, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8391, 'compress@10': 1.0, 'time@10': 2.8879}:  50%|█████     | 15/30 [00:35<00:28,  1.87s/it]{'epoch': 3, 'num_users': 6.0625, 'loss': 0.0552, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8391, 'compress@10': 1.0, 'time@10': 2.8879}:  53%|█████▎    | 16/30 [00:35<00:28,  2.06s/it]{'epoch': 3, 'num_users': 5.8235, 'loss': 0.0527, 'hit_ratio@10': 0.805, 'ndcg@10': 0.8336, 'compress@10': 1.0, 'time@10': 2.8337}:  53%|█████▎    | 16/30 [00:36<00:28,  2.06s/it] {'epoch': 3, 'num_users': 5.8235, 'loss': 0.0527, 'hit_ratio@10': 0.805, 'ndcg@10': 0.8336, 'compress@10': 1.0, 'time@10': 2.8337}:  57%|█████▋    | 17/30 [00:36<00:22,  1.75s/it]{'epoch': 3, 'num_users': 6.0556, 'loss': 0.053, 'hit_ratio@10': 0.802, 'ndcg@10': 0.835, 'compress@10': 1.0, 'time@10': 2.8752}:  57%|█████▋    | 17/30 [00:40<00:22,  1.75s/it]  {'epoch': 3, 'num_users': 6.0556, 'loss': 0.053, 'hit_ratio@10': 0.802, 'ndcg@10': 0.835, 'compress@10': 1.0, 'time@10': 2.8752}:  60%|██████    | 18/30 [00:40<00:27,  2.31s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.0511, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8383, 'compress@10': 1.0, 'time@10': 2.8896}:  60%|██████    | 18/30 [00:41<00:27,  2.31s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.0511, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8383, 'compress@10': 1.0, 'time@10': 2.8896}:  63%|██████▎   | 19/30 [00:41<00:23,  2.10s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.052, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8361, 'compress@10': 1.0, 'time@10': 2.8974}:  63%|██████▎   | 19/30 [00:45<00:23,  2.10s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.052, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8361, 'compress@10': 1.0, 'time@10': 2.8974}:  67%|██████▋   | 20/30 [00:45<00:23,  2.40s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0599, 'hit_ratio@10': 0.7964, 'ndcg@10': 0.8243, 'compress@10': 1.0, 'time@10': 2.7944}:  67%|██████▋   | 20/30 [00:45<00:23,  2.40s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0599, 'hit_ratio@10': 0.7964, 'ndcg@10': 0.8243, 'compress@10': 1.0, 'time@10': 2.7944}:  70%|███████   | 21/30 [00:45<00:16,  1.80s/it]{'epoch': 3, 'num_users': 6.1818, 'loss': 0.0594, 'hit_ratio@10': 0.8015, 'ndcg@10': 0.8286, 'compress@10': 1.0, 'time@10': 2.8127}:  70%|███████   | 21/30 [00:48<00:16,  1.80s/it]{'epoch': 3, 'num_users': 6.1818, 'loss': 0.0594, 'hit_ratio@10': 0.8015, 'ndcg@10': 0.8286, 'compress@10': 1.0, 'time@10': 2.8127}:  73%|███████▎  | 22/30 [00:48<00:17,  2.23s/it]{'epoch': 3, 'num_users': 6.1304, 'loss': 0.0579, 'hit_ratio@10': 0.8036, 'ndcg@10': 0.8317, 'compress@10': 1.0, 'time@10': 2.8377}:  73%|███████▎  | 22/30 [00:50<00:17,  2.23s/it]{'epoch': 3, 'num_users': 6.1304, 'loss': 0.0579, 'hit_ratio@10': 0.8036, 'ndcg@10': 0.8317, 'compress@10': 1.0, 'time@10': 2.8377}:  77%|███████▋  | 23/30 [00:50<00:14,  2.08s/it]{'epoch': 3, 'num_users': 5.9583, 'loss': 0.0567, 'hit_ratio@10': 0.8035, 'ndcg@10': 0.8259, 'compress@10': 1.0, 'time@10': 2.7688}:  77%|███████▋  | 23/30 [00:51<00:14,  2.08s/it]{'epoch': 3, 'num_users': 5.9583, 'loss': 0.0567, 'hit_ratio@10': 0.8035, 'ndcg@10': 0.8259, 'compress@10': 1.0, 'time@10': 2.7688}:  80%|████████  | 24/30 [00:51<00:10,  1.82s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0547, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8177, 'compress@10': 1.0, 'time@10': 2.7031}:  80%|████████  | 24/30 [00:52<00:10,  1.82s/it]    {'epoch': 3, 'num_users': 5.8, 'loss': 0.0547, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8177, 'compress@10': 1.0, 'time@10': 2.7031}:  83%|████████▎ | 25/30 [00:52<00:07,  1.46s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.0575, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8116, 'compress@10': 1.0, 'time@10': 2.6544}:  83%|████████▎ | 25/30 [00:53<00:07,  1.46s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.0575, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8116, 'compress@10': 1.0, 'time@10': 2.6544}:  87%|████████▋ | 26/30 [00:53<00:05,  1.46s/it]{'epoch': 3, 'num_users': 5.8889, 'loss': 0.0566, 'hit_ratio@10': 0.7999, 'ndcg@10': 0.8143, 'compress@10': 1.0, 'time@10': 2.7023}:  87%|████████▋ | 26/30 [00:55<00:05,  1.46s/it]{'epoch': 3, 'num_users': 5.8889, 'loss': 0.0566, 'hit_ratio@10': 0.7999, 'ndcg@10': 0.8143, 'compress@10': 1.0, 'time@10': 2.7023}:  90%|█████████ | 27/30 [00:55<00:04,  1.63s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.0566, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8163, 'compress@10': 1.0, 'time@10': 2.7193}:  90%|█████████ | 27/30 [00:58<00:04,  1.63s/it]   {'epoch': 3, 'num_users': 6.0, 'loss': 0.0566, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8163, 'compress@10': 1.0, 'time@10': 2.7193}:  93%|█████████▎| 28/30 [00:58<00:04,  2.10s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.0553, 'hit_ratio@10': 0.8058, 'ndcg@10': 0.8192, 'compress@10': 1.0, 'time@10': 2.727}:  93%|█████████▎| 28/30 [01:00<00:04,  2.10s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.0553, 'hit_ratio@10': 0.8058, 'ndcg@10': 0.8192, 'compress@10': 1.0, 'time@10': 2.727}:  97%|█████████▋| 29/30 [01:00<00:01,  1.92s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0549, 'hit_ratio@10': 0.8042, 'ndcg@10': 0.8214, 'compress@10': 1.0, 'time@10': 2.746}:  97%|█████████▋| 29/30 [01:03<00:01,  1.92s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0549, 'hit_ratio@10': 0.8042, 'ndcg@10': 0.8214, 'compress@10': 1.0, 'time@10': 2.746}: 100%|██████████| 30/30 [01:03<00:00,  2.35s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0549, 'hit_ratio@10': 0.8042, 'ndcg@10': 0.8214, 'compress@10': 1.0, 'time@10': 2.746}: 100%|██████████| 30/30 [01:03<00:00,  2.13s/it]
Epoch: 3
Avg # of users: 5.866666666666666
Avg Loss: 0.05485136811419353
Avg hit ratio: 0.8042051232790463
Avg ndcg: 0.8214395954027661
Avg compression ratio: 0.9999999860166272
Avg train time: 2.746024656295776
Std train time: 0.9339987966518241
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 28, 15, 8, 9, 7, 11, 7, 9, 8, 30, 9, 40, 7, 29, 33, 14, 15, 7, 9, 19, 10, 41, 41, 8, 7, 8, 9, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 3.5415}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 3.5415}:   3%|▎         | 1/30 [00:01<00:52,  1.81s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8551, 'compress@10': 1.0, 'time@10': 3.5375}:   3%|▎         | 1/30 [00:05<00:52,  1.81s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8551, 'compress@10': 1.0, 'time@10': 3.5375}:   7%|▋         | 2/30 [00:05<01:19,  2.85s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 3.3319}:   7%|▋         | 2/30 [00:06<01:19,  2.85s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 3.3319}:  10%|█         | 3/30 [00:06<01:00,  2.23s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8565, 'compress@10': 1.0, 'time@10': 3.3481}:  10%|█         | 3/30 [00:10<01:00,  2.23s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8565, 'compress@10': 1.0, 'time@10': 3.3481}:  13%|█▎        | 4/30 [00:10<01:10,  2.71s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0455, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8419, 'compress@10': 1.0, 'time@10': 3.9633}:  13%|█▎        | 4/30 [00:13<01:10,  2.71s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0455, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8419, 'compress@10': 1.0, 'time@10': 3.9633}:  17%|█▋        | 5/30 [00:13<01:12,  2.90s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0506, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.8375, 'compress@10': 1.0, 'time@10': 3.8448}:  17%|█▋        | 5/30 [00:16<01:12,  2.90s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0506, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.8375, 'compress@10': 1.0, 'time@10': 3.8448}:  20%|██        | 6/30 [00:16<01:12,  3.04s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0499, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8379, 'compress@10': 1.0, 'time@10': 3.7204}:  20%|██        | 6/30 [00:18<01:12,  3.04s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0499, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8379, 'compress@10': 1.0, 'time@10': 3.7204}:  23%|██▎       | 7/30 [00:18<00:58,  2.55s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 3.6746}:  23%|██▎       | 7/30 [00:21<00:58,  2.55s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 3.6746}:  27%|██▋       | 8/30 [00:21<01:01,  2.82s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0493, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.8517, 'compress@10': 1.0, 'time@10': 3.7503}:  27%|██▋       | 8/30 [00:24<01:01,  2.82s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0493, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.8517, 'compress@10': 1.0, 'time@10': 3.7503}:  30%|███       | 9/30 [00:24<00:55,  2.64s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8509, 'compress@10': 1.0, 'time@10': 3.7014}:  30%|███       | 9/30 [00:27<00:55,  2.64s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8509, 'compress@10': 1.0, 'time@10': 3.7014}:  33%|███▎      | 10/30 [00:27<00:56,  2.84s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.0507, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8522, 'compress@10': 1.0, 'time@10': 3.7068}:  33%|███▎      | 10/30 [00:29<00:56,  2.84s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.0507, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8522, 'compress@10': 1.0, 'time@10': 3.7068}:  37%|███▋      | 11/30 [00:29<00:48,  2.56s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0478, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.8557, 'compress@10': 1.0, 'time@10': 3.6418}:  37%|███▋      | 11/30 [00:32<00:48,  2.56s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0478, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.8557, 'compress@10': 1.0, 'time@10': 3.6418}:  40%|████      | 12/30 [00:32<00:48,  2.69s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.048, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 3.6372}:  40%|████      | 12/30 [00:34<00:48,  2.69s/it] {'epoch': 4, 'num_users': 6.6154, 'loss': 0.048, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 3.6372}:  43%|████▎     | 13/30 [00:34<00:41,  2.43s/it]{'epoch': 4, 'num_users': 6.3571, 'loss': 0.0452, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 3.506}:  43%|████▎     | 13/30 [00:35<00:41,  2.43s/it] {'epoch': 4, 'num_users': 6.3571, 'loss': 0.0452, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 3.506}:  47%|████▋     | 14/30 [00:35<00:35,  2.25s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.0463, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 3.5262}:  47%|████▋     | 14/30 [00:37<00:35,  2.25s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.0463, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 3.5262}:  50%|█████     | 15/30 [00:37<00:32,  2.16s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.0442, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 3.4782}:  50%|█████     | 15/30 [00:40<00:32,  2.16s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.0442, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 3.4782}:  53%|█████▎    | 16/30 [00:40<00:32,  2.35s/it]{'epoch': 4, 'num_users': 5.8235, 'loss': 0.0422, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 3.41}:  53%|█████▎    | 16/30 [00:41<00:32,  2.35s/it]  {'epoch': 4, 'num_users': 5.8235, 'loss': 0.0422, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 3.41}:  57%|█████▋    | 17/30 [00:41<00:26,  2.00s/it]{'epoch': 4, 'num_users': 6.0556, 'loss': 0.0431, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 3.4159}:  57%|█████▋    | 17/30 [00:45<00:26,  2.00s/it]{'epoch': 4, 'num_users': 6.0556, 'loss': 0.0431, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 3.4159}:  60%|██████    | 18/30 [00:45<00:29,  2.47s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.0417, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8519, 'compress@10': 1.0, 'time@10': 3.4267}:  60%|██████    | 18/30 [00:47<00:29,  2.47s/it]   {'epoch': 4, 'num_users': 6.0, 'loss': 0.0417, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8519, 'compress@10': 1.0, 'time@10': 3.4267}:  63%|██████▎   | 19/30 [00:47<00:25,  2.28s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.0429, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 3.4353}:  63%|██████▎   | 19/30 [00:50<00:25,  2.28s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.0429, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 3.4353}:  67%|██████▋   | 20/30 [00:50<00:26,  2.69s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0445, 'hit_ratio@10': 0.8201, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 3.5819}:  67%|██████▋   | 20/30 [00:54<00:26,  2.69s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0445, 'hit_ratio@10': 0.8201, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 3.5819}:  70%|███████   | 21/30 [00:54<00:25,  2.87s/it]{'epoch': 4, 'num_users': 6.1818, 'loss': 0.044, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8492, 'compress@10': 1.0, 'time@10': 3.5784}:  70%|███████   | 21/30 [00:57<00:25,  2.87s/it] {'epoch': 4, 'num_users': 6.1818, 'loss': 0.044, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8492, 'compress@10': 1.0, 'time@10': 3.5784}:  73%|███████▎  | 22/30 [00:57<00:24,  3.07s/it]{'epoch': 4, 'num_users': 6.1304, 'loss': 0.0431, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 3.5704}:  73%|███████▎  | 22/30 [00:59<00:24,  3.07s/it]{'epoch': 4, 'num_users': 6.1304, 'loss': 0.0431, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 3.5704}:  77%|███████▋  | 23/30 [00:59<00:18,  2.67s/it]{'epoch': 4, 'num_users': 5.9583, 'loss': 0.0421, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8469, 'compress@10': 1.0, 'time@10': 3.4816}:  77%|███████▋  | 23/30 [01:00<00:18,  2.67s/it]{'epoch': 4, 'num_users': 5.9583, 'loss': 0.0421, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8469, 'compress@10': 1.0, 'time@10': 3.4816}:  80%|████████  | 24/30 [01:00<00:13,  2.31s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0407, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8379, 'compress@10': 1.0, 'time@10': 3.3954}:  80%|████████  | 24/30 [01:01<00:13,  2.31s/it]   {'epoch': 4, 'num_users': 5.8, 'loss': 0.0407, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8379, 'compress@10': 1.0, 'time@10': 3.3954}:  83%|████████▎ | 25/30 [01:01<00:09,  1.83s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.0423, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8355, 'compress@10': 1.0, 'time@10': 3.4858}:  83%|████████▎ | 25/30 [01:07<00:09,  1.83s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.0423, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8355, 'compress@10': 1.0, 'time@10': 3.4858}:  87%|████████▋ | 26/30 [01:07<00:12,  3.02s/it]{'epoch': 4, 'num_users': 5.8889, 'loss': 0.0419, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8379, 'compress@10': 1.0, 'time@10': 3.4841}:  87%|████████▋ | 26/30 [01:09<00:12,  3.02s/it]{'epoch': 4, 'num_users': 5.8889, 'loss': 0.0419, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8379, 'compress@10': 1.0, 'time@10': 3.4841}:  90%|█████████ | 27/30 [01:09<00:07,  2.64s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.0425, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8388, 'compress@10': 1.0, 'time@10': 3.4891}:  90%|█████████ | 27/30 [01:12<00:07,  2.64s/it]   {'epoch': 4, 'num_users': 6.0, 'loss': 0.0425, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8388, 'compress@10': 1.0, 'time@10': 3.4891}:  93%|█████████▎| 28/30 [01:12<00:05,  2.95s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.0417, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8409, 'compress@10': 1.0, 'time@10': 3.4821}:  93%|█████████▎| 28/30 [01:14<00:05,  2.95s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.0417, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8409, 'compress@10': 1.0, 'time@10': 3.4821}:  97%|█████████▋| 29/30 [01:14<00:02,  2.57s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0418, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8424, 'compress@10': 1.0, 'time@10': 3.4684}:  97%|█████████▋| 29/30 [01:17<00:02,  2.57s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0418, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8424, 'compress@10': 1.0, 'time@10': 3.4684}: 100%|██████████| 30/30 [01:17<00:00,  2.73s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0418, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8424, 'compress@10': 1.0, 'time@10': 3.4684}: 100%|██████████| 30/30 [01:17<00:00,  2.59s/it]
Epoch: 4
Avg # of users: 5.866666666666666
Avg Loss: 0.04175620521251647
Avg hit ratio: 0.8211326871218391
Avg ndcg: 0.8423822527466535
Avg compression ratio: 0.9999999860153537
Avg train time: 3.4683818499247234
Std train time: 1.136186587640564
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 30, 15, 1, 10, 8, 11, 4, 10, 7, 31, 9, 45, 6, 31, 36, 14, 14, 7, 1, 19, 10, 47, 47, 1, 7, 7, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8511, 'compress@10': 1.0, 'time@10': 3.3718}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8511, 'compress@10': 1.0, 'time@10': 3.3718}:   3%|▎         | 1/30 [00:01<00:49,  1.72s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8494, 'compress@10': 1.0, 'time@10': 3.4271}:   3%|▎         | 1/30 [00:05<00:49,  1.72s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8494, 'compress@10': 1.0, 'time@10': 3.4271}:   7%|▋         | 2/30 [00:05<01:17,  2.78s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 3.3197}:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 3.3197}:  10%|█         | 3/30 [00:06<01:00,  2.24s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8216, 'compress@10': 1.0, 'time@10': 3.3722}:  10%|█         | 3/30 [00:10<01:00,  2.24s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8216, 'compress@10': 1.0, 'time@10': 3.3722}:  13%|█▎        | 4/30 [00:10<01:11,  2.76s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0748, 'hit_ratio@10': 0.78, 'ndcg@10': 0.7684, 'compress@10': 1.0, 'time@10': 2.8702}:  13%|█▎        | 4/30 [00:10<01:11,  2.76s/it]  {'epoch': 5, 'num_users': 5.8, 'loss': 0.0748, 'hit_ratio@10': 0.78, 'ndcg@10': 0.7684, 'compress@10': 1.0, 'time@10': 2.8702}:  17%|█▋        | 5/30 [00:10<00:48,  1.94s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0743, 'hit_ratio@10': 0.776, 'ndcg@10': 0.7774, 'compress@10': 1.0, 'time@10': 3.0481}:  17%|█▋        | 5/30 [00:14<00:48,  1.94s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0743, 'hit_ratio@10': 0.776, 'ndcg@10': 0.7774, 'compress@10': 1.0, 'time@10': 3.0481}:  20%|██        | 6/30 [00:14<01:03,  2.63s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0704, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.7924, 'compress@10': 1.0, 'time@10': 3.1097}:  20%|██        | 6/30 [00:16<01:03,  2.63s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0704, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.7924, 'compress@10': 1.0, 'time@10': 3.1097}:  23%|██▎       | 7/30 [00:16<00:54,  2.35s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0681, 'hit_ratio@10': 0.8184, 'ndcg@10': 0.802, 'compress@10': 1.0, 'time@10': 3.1296}:  23%|██▎       | 7/30 [00:19<00:54,  2.35s/it]  {'epoch': 5, 'num_users': 6.125, 'loss': 0.0681, 'hit_ratio@10': 0.8184, 'ndcg@10': 0.802, 'compress@10': 1.0, 'time@10': 3.1296}:  27%|██▋       | 8/30 [00:19<00:58,  2.65s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0655, 'hit_ratio@10': 0.8068, 'ndcg@10': 0.8127, 'compress@10': 1.0, 'time@10': 3.0575}:  27%|██▋       | 8/30 [00:21<00:58,  2.65s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0655, 'hit_ratio@10': 0.8068, 'ndcg@10': 0.8127, 'compress@10': 1.0, 'time@10': 3.0575}:  30%|███       | 9/30 [00:21<00:46,  2.22s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0641, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.8163, 'compress@10': 1.0, 'time@10': 3.1126}:  30%|███       | 9/30 [00:24<00:46,  2.22s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0641, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.8163, 'compress@10': 1.0, 'time@10': 3.1126}:  33%|███▎      | 10/30 [00:24<00:53,  2.66s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0642, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.8201, 'compress@10': 1.0, 'time@10': 3.0851}:  33%|███▎      | 10/30 [00:26<00:53,  2.66s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0642, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.8201, 'compress@10': 1.0, 'time@10': 3.0851}:  37%|███▋      | 11/30 [00:26<00:43,  2.29s/it]{'epoch': 5, 'num_users': 6.4167, 'loss': 0.06, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.8263, 'compress@10': 1.0, 'time@10': 3.0489}:  37%|███▋      | 11/30 [00:28<00:43,  2.29s/it]  {'epoch': 5, 'num_users': 6.4167, 'loss': 0.06, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.8263, 'compress@10': 1.0, 'time@10': 3.0489}:  40%|████      | 12/30 [00:28<00:43,  2.41s/it]{'epoch': 5, 'num_users': 6.6154, 'loss': 0.0594, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.8311, 'compress@10': 1.0, 'time@10': 3.0498}:  40%|████      | 12/30 [00:30<00:43,  2.41s/it]{'epoch': 5, 'num_users': 6.6154, 'loss': 0.0594, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.8311, 'compress@10': 1.0, 'time@10': 3.0498}:  43%|████▎     | 13/30 [00:30<00:36,  2.15s/it]{'epoch': 5, 'num_users': 6.3571, 'loss': 0.0557, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8299, 'compress@10': 1.0, 'time@10': 2.962}:  43%|████▎     | 13/30 [00:32<00:36,  2.15s/it] {'epoch': 5, 'num_users': 6.3571, 'loss': 0.0557, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8299, 'compress@10': 1.0, 'time@10': 2.962}:  47%|████▋     | 14/30 [00:32<00:33,  2.06s/it]{'epoch': 5, 'num_users': 6.2667, 'loss': 0.0561, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.832, 'compress@10': 1.0, 'time@10': 2.9811}:  47%|████▋     | 14/30 [00:34<00:33,  2.06s/it]{'epoch': 5, 'num_users': 6.2667, 'loss': 0.0561, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.832, 'compress@10': 1.0, 'time@10': 2.9811}:  50%|█████     | 15/30 [00:34<00:29,  1.94s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.0533, 'hit_ratio@10': 0.8174, 'ndcg@10': 0.8348, 'compress@10': 1.0, 'time@10': 2.9822}:  50%|█████     | 15/30 [00:37<00:29,  1.94s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.0533, 'hit_ratio@10': 0.8174, 'ndcg@10': 0.8348, 'compress@10': 1.0, 'time@10': 2.9822}:  53%|█████▎    | 16/30 [00:37<00:31,  2.27s/it]{'epoch': 5, 'num_users': 5.8235, 'loss': 0.0507, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.831, 'compress@10': 1.0, 'time@10': 2.9484}:  53%|█████▎    | 16/30 [00:38<00:31,  2.27s/it] {'epoch': 5, 'num_users': 5.8235, 'loss': 0.0507, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.831, 'compress@10': 1.0, 'time@10': 2.9484}:  57%|█████▋    | 17/30 [00:38<00:25,  1.96s/it]{'epoch': 5, 'num_users': 6.0556, 'loss': 0.051, 'hit_ratio@10': 0.7996, 'ndcg@10': 0.8337, 'compress@10': 1.0, 'time@10': 2.9724}:  57%|█████▋    | 17/30 [00:41<00:25,  1.96s/it]{'epoch': 5, 'num_users': 6.0556, 'loss': 0.051, 'hit_ratio@10': 0.7996, 'ndcg@10': 0.8337, 'compress@10': 1.0, 'time@10': 2.9724}:  60%|██████    | 18/30 [00:41<00:28,  2.40s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.0492, 'hit_ratio@10': 0.8026, 'ndcg@10': 0.8372, 'compress@10': 1.0, 'time@10': 2.972}:  60%|██████    | 18/30 [00:43<00:28,  2.40s/it]   {'epoch': 5, 'num_users': 6.0, 'loss': 0.0492, 'hit_ratio@10': 0.8026, 'ndcg@10': 0.8372, 'compress@10': 1.0, 'time@10': 2.972}:  63%|██████▎   | 19/30 [00:43<00:23,  2.13s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.0499, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8355, 'compress@10': 1.0, 'time@10': 2.9954}:  63%|██████▎   | 19/30 [00:46<00:23,  2.13s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.0499, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8355, 'compress@10': 1.0, 'time@10': 2.9954}:  67%|██████▋   | 20/30 [00:46<00:25,  2.54s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0576, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8251, 'compress@10': 1.0, 'time@10': 2.892}:  67%|██████▋   | 20/30 [00:47<00:25,  2.54s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0576, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8251, 'compress@10': 1.0, 'time@10': 2.892}:  70%|███████   | 21/30 [00:47<00:17,  1.92s/it]{'epoch': 5, 'num_users': 6.1818, 'loss': 0.0563, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8293, 'compress@10': 1.0, 'time@10': 2.9433}:  70%|███████   | 21/30 [00:51<00:17,  1.92s/it]{'epoch': 5, 'num_users': 6.1818, 'loss': 0.0563, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8293, 'compress@10': 1.0, 'time@10': 2.9433}:  73%|███████▎  | 22/30 [00:51<00:20,  2.56s/it]{'epoch': 5, 'num_users': 6.1304, 'loss': 0.0549, 'hit_ratio@10': 0.7985, 'ndcg@10': 0.8321, 'compress@10': 1.0, 'time@10': 2.9598}:  73%|███████▎  | 22/30 [00:52<00:20,  2.56s/it]{'epoch': 5, 'num_users': 6.1304, 'loss': 0.0549, 'hit_ratio@10': 0.7985, 'ndcg@10': 0.8321, 'compress@10': 1.0, 'time@10': 2.9598}:  77%|███████▋  | 23/30 [00:52<00:16,  2.30s/it]{'epoch': 5, 'num_users': 5.9583, 'loss': 0.0532, 'hit_ratio@10': 0.7986, 'ndcg@10': 0.8285, 'compress@10': 1.0, 'time@10': 2.9025}:  77%|███████▋  | 23/30 [00:54<00:16,  2.30s/it]{'epoch': 5, 'num_users': 5.9583, 'loss': 0.0532, 'hit_ratio@10': 0.7986, 'ndcg@10': 0.8285, 'compress@10': 1.0, 'time@10': 2.9025}:  80%|████████  | 24/30 [00:54<00:12,  2.10s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0512, 'hit_ratio@10': 0.7933, 'ndcg@10': 0.8202, 'compress@10': 1.0, 'time@10': 2.8551}:  80%|████████  | 24/30 [00:55<00:12,  2.10s/it]   {'epoch': 5, 'num_users': 5.8, 'loss': 0.0512, 'hit_ratio@10': 0.7933, 'ndcg@10': 0.8202, 'compress@10': 1.0, 'time@10': 2.8551}:  83%|████████▎ | 25/30 [00:55<00:08,  1.74s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.0565, 'hit_ratio@10': 0.7832, 'ndcg@10': 0.8112, 'compress@10': 1.0, 'time@10': 2.7724}:  83%|████████▎ | 25/30 [00:56<00:08,  1.74s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.0565, 'hit_ratio@10': 0.7832, 'ndcg@10': 0.8112, 'compress@10': 1.0, 'time@10': 2.7724}:  87%|████████▋ | 26/30 [00:56<00:05,  1.44s/it]{'epoch': 5, 'num_users': 5.8889, 'loss': 0.0557, 'hit_ratio@10': 0.7899, 'ndcg@10': 0.8142, 'compress@10': 1.0, 'time@10': 2.7979}:  87%|████████▋ | 26/30 [00:58<00:05,  1.44s/it]{'epoch': 5, 'num_users': 5.8889, 'loss': 0.0557, 'hit_ratio@10': 0.7899, 'ndcg@10': 0.8142, 'compress@10': 1.0, 'time@10': 2.7979}:  90%|█████████ | 27/30 [00:58<00:04,  1.54s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.0557, 'hit_ratio@10': 0.7932, 'ndcg@10': 0.8165, 'compress@10': 1.0, 'time@10': 2.8124}:  90%|█████████ | 27/30 [01:01<00:04,  1.54s/it]   {'epoch': 5, 'num_users': 6.0, 'loss': 0.0557, 'hit_ratio@10': 0.7932, 'ndcg@10': 0.8165, 'compress@10': 1.0, 'time@10': 2.8124}:  93%|█████████▎| 28/30 [01:01<00:04,  2.05s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.0558, 'hit_ratio@10': 0.7972, 'ndcg@10': 0.8201, 'compress@10': 1.0, 'time@10': 2.8274}:  93%|█████████▎| 28/30 [01:02<00:04,  2.05s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.0558, 'hit_ratio@10': 0.7972, 'ndcg@10': 0.8201, 'compress@10': 1.0, 'time@10': 2.8274}:  97%|█████████▋| 29/30 [01:02<00:01,  1.93s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0557, 'hit_ratio@10': 0.7958, 'ndcg@10': 0.8228, 'compress@10': 1.0, 'time@10': 2.8502}:  97%|█████████▋| 29/30 [01:06<00:01,  1.93s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0557, 'hit_ratio@10': 0.7958, 'ndcg@10': 0.8228, 'compress@10': 1.0, 'time@10': 2.8502}: 100%|██████████| 30/30 [01:06<00:00,  2.42s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0557, 'hit_ratio@10': 0.7958, 'ndcg@10': 0.8228, 'compress@10': 1.0, 'time@10': 2.8502}: 100%|██████████| 30/30 [01:06<00:00,  2.22s/it]
Epoch: 5
Avg # of users: 5.866666666666666
Avg Loss: 0.05568798031398204
Avg hit ratio: 0.7958410133091683
Avg ndcg: 0.8227576350434518
Avg compression ratio: 0.9999999860166272
Avg train time: 2.8502019087473554
Std train time: 0.8953369816974923
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 31, 15, 8, 9, 8, 11, 7, 10, 9, 33, 10, 50, 7, 32, 39, 14, 15, 7, 9, 17, 10, 52, 52, 9, 7, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8498, 'compress@10': 1.0, 'time@10': 3.5593}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8498, 'compress@10': 1.0, 'time@10': 3.5593}:   3%|▎         | 1/30 [00:01<00:52,  1.82s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.3934}:   3%|▎         | 1/30 [00:05<00:52,  1.82s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.3934}:   7%|▋         | 2/30 [00:05<01:14,  2.67s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.6963, 'ndcg@10': 0.8641, 'compress@10': 1.0, 'time@10': 3.2734}:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.6963, 'ndcg@10': 0.8641, 'compress@10': 1.0, 'time@10': 3.2734}:  10%|█         | 3/30 [00:06<00:58,  2.16s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.7633, 'ndcg@10': 0.8656, 'compress@10': 1.0, 'time@10': 3.3584}:  10%|█         | 3/30 [00:10<00:58,  2.16s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.7633, 'ndcg@10': 0.8656, 'compress@10': 1.0, 'time@10': 3.3584}:  13%|█▎        | 4/30 [00:10<01:11,  2.75s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0456, 'hit_ratio@10': 0.7787, 'ndcg@10': 0.8494, 'compress@10': 1.0, 'time@10': 4.0953}:  13%|█▎        | 4/30 [00:13<01:11,  2.75s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0456, 'hit_ratio@10': 0.7787, 'ndcg@10': 0.8494, 'compress@10': 1.0, 'time@10': 4.0953}:  17%|█▋        | 5/30 [00:13<01:16,  3.04s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0499, 'hit_ratio@10': 0.7785, 'ndcg@10': 0.8448, 'compress@10': 1.0, 'time@10': 4.0167}:  17%|█▋        | 5/30 [00:17<01:16,  3.04s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0499, 'hit_ratio@10': 0.7785, 'ndcg@10': 0.8448, 'compress@10': 1.0, 'time@10': 4.0167}:  20%|██        | 6/30 [00:17<01:18,  3.26s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0492, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.8454, 'compress@10': 1.0, 'time@10': 3.9414}:  20%|██        | 6/30 [00:19<01:18,  3.26s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0492, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.8454, 'compress@10': 1.0, 'time@10': 3.9414}:  23%|██▎       | 7/30 [00:19<01:04,  2.79s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0495, 'hit_ratio@10': 0.8253, 'ndcg@10': 0.8522, 'compress@10': 1.0, 'time@10': 3.8631}:  23%|██▎       | 7/30 [00:22<01:04,  2.79s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0495, 'hit_ratio@10': 0.8253, 'ndcg@10': 0.8522, 'compress@10': 1.0, 'time@10': 3.8631}:  27%|██▋       | 8/30 [00:22<01:05,  2.97s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0485, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8593, 'compress@10': 1.0, 'time@10': 3.9166}:  27%|██▋       | 8/30 [00:24<01:05,  2.97s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0485, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8593, 'compress@10': 1.0, 'time@10': 3.9166}:  30%|███       | 9/30 [00:24<00:57,  2.73s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 3.9045}:  30%|███       | 9/30 [00:28<00:57,  2.73s/it]  {'epoch': 6, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 3.9045}:  33%|███▎      | 10/30 [00:28<01:01,  3.07s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.0503, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 3.9155}:  33%|███▎      | 10/30 [00:30<01:01,  3.07s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.0503, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 3.9155}:  37%|███▋      | 11/30 [00:30<00:52,  2.76s/it]{'epoch': 6, 'num_users': 6.4167, 'loss': 0.0472, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.8618, 'compress@10': 1.0, 'time@10': 3.8493}:  37%|███▋      | 11/30 [00:33<00:52,  2.76s/it]{'epoch': 6, 'num_users': 6.4167, 'loss': 0.0472, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.8618, 'compress@10': 1.0, 'time@10': 3.8493}:  40%|████      | 12/30 [00:33<00:51,  2.88s/it]{'epoch': 6, 'num_users': 6.6154, 'loss': 0.048, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8634, 'compress@10': 1.0, 'time@10': 3.8533}:  40%|████      | 12/30 [00:35<00:51,  2.88s/it] {'epoch': 6, 'num_users': 6.6154, 'loss': 0.048, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8634, 'compress@10': 1.0, 'time@10': 3.8533}:  43%|████▎     | 13/30 [00:35<00:44,  2.62s/it]{'epoch': 6, 'num_users': 6.3571, 'loss': 0.045, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 3.7338}:  43%|████▎     | 13/30 [00:38<00:44,  2.62s/it]{'epoch': 6, 'num_users': 6.3571, 'loss': 0.045, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 3.7338}:  47%|████▋     | 14/30 [00:38<00:40,  2.50s/it]{'epoch': 6, 'num_users': 6.2667, 'loss': 0.0461, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 3.731}:  47%|████▋     | 14/30 [00:40<00:40,  2.50s/it]{'epoch': 6, 'num_users': 6.2667, 'loss': 0.0461, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 3.731}:  50%|█████     | 15/30 [00:40<00:34,  2.31s/it]{'epoch': 6, 'num_users': 6.0625, 'loss': 0.0439, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 3.6858}:  50%|█████     | 15/30 [00:43<00:34,  2.31s/it]{'epoch': 6, 'num_users': 6.0625, 'loss': 0.0439, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 3.6858}:  53%|█████▎    | 16/30 [00:43<00:36,  2.64s/it]{'epoch': 6, 'num_users': 5.8235, 'loss': 0.0418, 'hit_ratio@10': 0.813, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 3.6305}:  53%|█████▎    | 16/30 [00:44<00:36,  2.64s/it]  {'epoch': 6, 'num_users': 5.8235, 'loss': 0.0418, 'hit_ratio@10': 0.813, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 3.6305}:  57%|█████▋    | 17/30 [00:44<00:29,  2.27s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.0425, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.8544, 'compress@10': 1.0, 'time@10': 3.6227}:  57%|█████▋    | 17/30 [00:48<00:29,  2.27s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.0425, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.8544, 'compress@10': 1.0, 'time@10': 3.6227}:  60%|██████    | 18/30 [00:48<00:31,  2.65s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.0411, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 3.5992}:  60%|██████    | 18/30 [00:50<00:31,  2.65s/it]   {'epoch': 6, 'num_users': 6.0, 'loss': 0.0411, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 3.5992}:  63%|██████▎   | 19/30 [00:50<00:25,  2.34s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.0423, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.8544, 'compress@10': 1.0, 'time@10': 3.5847}:  63%|██████▎   | 19/30 [00:53<00:25,  2.34s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.0423, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.8544, 'compress@10': 1.0, 'time@10': 3.5847}:  67%|██████▋   | 20/30 [00:53<00:26,  2.64s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0438, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 3.6873}:  67%|██████▋   | 20/30 [00:56<00:26,  2.64s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0438, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 3.6873}:  70%|███████   | 21/30 [00:56<00:24,  2.72s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.0435, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 3.6519}:  70%|███████   | 21/30 [00:59<00:24,  2.72s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.0435, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 3.6519}:  73%|███████▎  | 22/30 [00:59<00:22,  2.79s/it]{'epoch': 6, 'num_users': 6.1304, 'loss': 0.0428, 'hit_ratio@10': 0.8128, 'ndcg@10': 0.8576, 'compress@10': 1.0, 'time@10': 3.6433}:  73%|███████▎  | 22/30 [01:01<00:22,  2.79s/it]{'epoch': 6, 'num_users': 6.1304, 'loss': 0.0428, 'hit_ratio@10': 0.8128, 'ndcg@10': 0.8576, 'compress@10': 1.0, 'time@10': 3.6433}:  77%|███████▋  | 23/30 [01:01<00:17,  2.48s/it]{'epoch': 6, 'num_users': 5.9583, 'loss': 0.0414, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8528, 'compress@10': 1.0, 'time@10': 3.5679}:  77%|███████▋  | 23/30 [01:02<00:17,  2.48s/it]{'epoch': 6, 'num_users': 5.9583, 'loss': 0.0414, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8528, 'compress@10': 1.0, 'time@10': 3.5679}:  80%|████████  | 24/30 [01:02<00:13,  2.30s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0399, 'hit_ratio@10': 0.8064, 'ndcg@10': 0.8436, 'compress@10': 1.0, 'time@10': 3.5013}:  80%|████████  | 24/30 [01:03<00:13,  2.30s/it]   {'epoch': 6, 'num_users': 5.8, 'loss': 0.0399, 'hit_ratio@10': 0.8064, 'ndcg@10': 0.8436, 'compress@10': 1.0, 'time@10': 3.5013}:  83%|████████▎ | 25/30 [01:03<00:09,  1.91s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.0412, 'hit_ratio@10': 0.8082, 'ndcg@10': 0.8417, 'compress@10': 1.0, 'time@10': 3.6154}:  83%|████████▎ | 25/30 [01:10<00:09,  1.91s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.0412, 'hit_ratio@10': 0.8082, 'ndcg@10': 0.8417, 'compress@10': 1.0, 'time@10': 3.6154}:  87%|████████▋ | 26/30 [01:10<00:13,  3.29s/it]{'epoch': 6, 'num_users': 5.8889, 'loss': 0.0409, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.8431, 'compress@10': 1.0, 'time@10': 3.6089}:  87%|████████▋ | 26/30 [01:12<00:13,  3.29s/it]{'epoch': 6, 'num_users': 5.8889, 'loss': 0.0409, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.8431, 'compress@10': 1.0, 'time@10': 3.6089}:  90%|█████████ | 27/30 [01:12<00:08,  2.83s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.0413, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8441, 'compress@10': 1.0, 'time@10': 3.6096}:  90%|█████████ | 27/30 [01:15<00:08,  2.83s/it]   {'epoch': 6, 'num_users': 6.0, 'loss': 0.0413, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8441, 'compress@10': 1.0, 'time@10': 3.6096}:  93%|█████████▎| 28/30 [01:15<00:06,  3.08s/it]{'epoch': 6, 'num_users': 5.8621, 'loss': 0.0407, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.8455, 'compress@10': 1.0, 'time@10': 3.5989}:  93%|█████████▎| 28/30 [01:17<00:06,  3.08s/it]{'epoch': 6, 'num_users': 5.8621, 'loss': 0.0407, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.8455, 'compress@10': 1.0, 'time@10': 3.5989}:  97%|█████████▋| 29/30 [01:17<00:02,  2.66s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0412, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8487, 'compress@10': 1.0, 'time@10': 3.5911}:  97%|█████████▋| 29/30 [01:20<00:02,  2.66s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0412, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8487, 'compress@10': 1.0, 'time@10': 3.5911}: 100%|██████████| 30/30 [01:20<00:00,  2.89s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0412, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8487, 'compress@10': 1.0, 'time@10': 3.5911}: 100%|██████████| 30/30 [01:20<00:00,  2.70s/it]
Epoch: 6
Avg # of users: 5.866666666666666
Avg Loss: 0.041217251027704835
Avg hit ratio: 0.8141497341227572
Avg ndcg: 0.8486717762609021
Avg compression ratio: 0.9999999860153537
Avg train time: 3.591050561269124
Std train time: 1.1009772617467692
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 14, 32, 14, 1, 8, 8, 11, 4, 9, 7, 34, 9, 54, 6, 33, 41, 14, 16, 7, 2, 19, 10, 57, 56, 1, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0487, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 3.5591}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0487, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 3.5591}:   3%|▎         | 1/30 [00:01<00:52,  1.82s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0611, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8344, 'compress@10': 1.0, 'time@10': 3.6422}:   3%|▎         | 1/30 [00:05<00:52,  1.82s/it] {'epoch': 7, 'num_users': 7.0, 'loss': 0.0611, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8344, 'compress@10': 1.0, 'time@10': 3.6422}:   7%|▋         | 2/30 [00:05<01:22,  2.96s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0407, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.842, 'compress@10': 1.0, 'time@10': 3.4534}:   7%|▋         | 2/30 [00:07<01:22,  2.96s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0407, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.842, 'compress@10': 1.0, 'time@10': 3.4534}:  10%|█         | 3/30 [00:07<01:02,  2.33s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0459, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 3.4255}:  10%|█         | 3/30 [00:10<01:02,  2.33s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0459, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 3.4255}:  13%|█▎        | 4/30 [00:10<01:11,  2.74s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0804, 'hit_ratio@10': 0.7784, 'ndcg@10': 0.8054, 'compress@10': 1.0, 'time@10': 2.9186}:  13%|█▎        | 4/30 [00:11<01:11,  2.74s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0804, 'hit_ratio@10': 0.7784, 'ndcg@10': 0.8054, 'compress@10': 1.0, 'time@10': 2.9186}:  17%|█▋        | 5/30 [00:11<00:48,  1.93s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0786, 'hit_ratio@10': 0.7783, 'ndcg@10': 0.8081, 'compress@10': 1.0, 'time@10': 2.9788}:  17%|█▋        | 5/30 [00:14<00:48,  1.93s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0786, 'hit_ratio@10': 0.7783, 'ndcg@10': 0.8081, 'compress@10': 1.0, 'time@10': 2.9788}:  20%|██        | 6/30 [00:14<00:57,  2.40s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.075, 'hit_ratio@10': 0.7985, 'ndcg@10': 0.8165, 'compress@10': 1.0, 'time@10': 3.0398}:  20%|██        | 6/30 [00:16<00:57,  2.40s/it] {'epoch': 7, 'num_users': 6.2857, 'loss': 0.075, 'hit_ratio@10': 0.7985, 'ndcg@10': 0.8165, 'compress@10': 1.0, 'time@10': 3.0398}:  23%|██▎       | 7/30 [00:16<00:50,  2.19s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0722, 'hit_ratio@10': 0.8201, 'ndcg@10': 0.8251, 'compress@10': 1.0, 'time@10': 3.0822}:  23%|██▎       | 7/30 [00:19<00:50,  2.19s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0722, 'hit_ratio@10': 0.8201, 'ndcg@10': 0.8251, 'compress@10': 1.0, 'time@10': 3.0822}:  27%|██▋       | 8/30 [00:19<00:56,  2.58s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.069, 'hit_ratio@10': 0.8115, 'ndcg@10': 0.8328, 'compress@10': 1.0, 'time@10': 3.0127}:  27%|██▋       | 8/30 [00:20<00:56,  2.58s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.069, 'hit_ratio@10': 0.8115, 'ndcg@10': 0.8328, 'compress@10': 1.0, 'time@10': 3.0127}:  30%|███       | 9/30 [00:20<00:45,  2.17s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0659, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8352, 'compress@10': 1.0, 'time@10': 3.0562}:  30%|███       | 9/30 [00:24<00:45,  2.17s/it]  {'epoch': 7, 'num_users': 6.3, 'loss': 0.0659, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8352, 'compress@10': 1.0, 'time@10': 3.0562}:  33%|███▎      | 10/30 [00:24<00:51,  2.58s/it]{'epoch': 7, 'num_users': 6.6364, 'loss': 0.0656, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8378, 'compress@10': 1.0, 'time@10': 3.0687}:  33%|███▎      | 10/30 [00:25<00:51,  2.58s/it]{'epoch': 7, 'num_users': 6.6364, 'loss': 0.0656, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8378, 'compress@10': 1.0, 'time@10': 3.0687}:  37%|███▋      | 11/30 [00:25<00:43,  2.29s/it]{'epoch': 7, 'num_users': 6.4167, 'loss': 0.0611, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.8433, 'compress@10': 1.0, 'time@10': 3.0882}:  37%|███▋      | 11/30 [00:29<00:43,  2.29s/it]{'epoch': 7, 'num_users': 6.4167, 'loss': 0.0611, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.8433, 'compress@10': 1.0, 'time@10': 3.0882}:  40%|████      | 12/30 [00:29<00:47,  2.62s/it]{'epoch': 7, 'num_users': 6.6154, 'loss': 0.0612, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.8467, 'compress@10': 1.0, 'time@10': 3.124}:  40%|████      | 12/30 [00:31<00:47,  2.62s/it] {'epoch': 7, 'num_users': 6.6154, 'loss': 0.0612, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.8467, 'compress@10': 1.0, 'time@10': 3.124}:  43%|████▎     | 13/30 [00:31<00:40,  2.38s/it]{'epoch': 7, 'num_users': 6.3571, 'loss': 0.0572, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8444, 'compress@10': 1.0, 'time@10': 3.0686}:  43%|████▎     | 13/30 [00:33<00:40,  2.38s/it]{'epoch': 7, 'num_users': 6.3571, 'loss': 0.0572, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8444, 'compress@10': 1.0, 'time@10': 3.0686}:  47%|████▋     | 14/30 [00:33<00:38,  2.38s/it]{'epoch': 7, 'num_users': 6.2667, 'loss': 0.0575, 'hit_ratio@10': 0.8228, 'ndcg@10': 0.8458, 'compress@10': 1.0, 'time@10': 3.0708}:  47%|████▋     | 14/30 [00:35<00:38,  2.38s/it]{'epoch': 7, 'num_users': 6.2667, 'loss': 0.0575, 'hit_ratio@10': 0.8228, 'ndcg@10': 0.8458, 'compress@10': 1.0, 'time@10': 3.0708}:  50%|█████     | 15/30 [00:35<00:32,  2.14s/it]{'epoch': 7, 'num_users': 6.0625, 'loss': 0.0545, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8488, 'compress@10': 1.0, 'time@10': 3.0737}:  50%|█████     | 15/30 [00:38<00:32,  2.14s/it]{'epoch': 7, 'num_users': 6.0625, 'loss': 0.0545, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8488, 'compress@10': 1.0, 'time@10': 3.0737}:  53%|█████▎    | 16/30 [00:38<00:34,  2.45s/it]{'epoch': 7, 'num_users': 5.8235, 'loss': 0.0517, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8438, 'compress@10': 1.0, 'time@10': 3.0584}:  53%|█████▎    | 16/30 [00:39<00:34,  2.45s/it]{'epoch': 7, 'num_users': 5.8235, 'loss': 0.0517, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8438, 'compress@10': 1.0, 'time@10': 3.0584}:  57%|█████▋    | 17/30 [00:39<00:27,  2.14s/it]{'epoch': 7, 'num_users': 6.0556, 'loss': 0.0518, 'hit_ratio@10': 0.807, 'ndcg@10': 0.8452, 'compress@10': 1.0, 'time@10': 3.0825}:  57%|█████▋    | 17/30 [00:43<00:27,  2.14s/it] {'epoch': 7, 'num_users': 6.0556, 'loss': 0.0518, 'hit_ratio@10': 0.807, 'ndcg@10': 0.8452, 'compress@10': 1.0, 'time@10': 3.0825}:  60%|██████    | 18/30 [00:43<00:30,  2.56s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.0499, 'hit_ratio@10': 0.8096, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 3.1171}:  60%|██████    | 18/30 [00:45<00:30,  2.56s/it]   {'epoch': 7, 'num_users': 6.0, 'loss': 0.0499, 'hit_ratio@10': 0.8096, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 3.1171}:  63%|██████▎   | 19/30 [00:45<00:25,  2.36s/it]{'epoch': 7, 'num_users': 6.15, 'loss': 0.0505, 'hit_ratio@10': 0.8121, 'ndcg@10': 0.8461, 'compress@10': 1.0, 'time@10': 3.1469}:  63%|██████▎   | 19/30 [00:48<00:25,  2.36s/it]{'epoch': 7, 'num_users': 6.15, 'loss': 0.0505, 'hit_ratio@10': 0.8121, 'ndcg@10': 0.8461, 'compress@10': 1.0, 'time@10': 3.1469}:  67%|██████▋   | 20/30 [00:48<00:27,  2.78s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0536, 'hit_ratio@10': 0.8068, 'ndcg@10': 0.8409, 'compress@10': 1.0, 'time@10': 3.0651}:  67%|██████▋   | 20/30 [00:49<00:27,  2.78s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0536, 'hit_ratio@10': 0.8068, 'ndcg@10': 0.8409, 'compress@10': 1.0, 'time@10': 3.0651}:  70%|███████   | 21/30 [00:49<00:19,  2.17s/it]{'epoch': 7, 'num_users': 6.1818, 'loss': 0.0524, 'hit_ratio@10': 0.8114, 'ndcg@10': 0.8445, 'compress@10': 1.0, 'time@10': 3.0788}:  70%|███████   | 21/30 [00:53<00:19,  2.17s/it]{'epoch': 7, 'num_users': 6.1818, 'loss': 0.0524, 'hit_ratio@10': 0.8114, 'ndcg@10': 0.8445, 'compress@10': 1.0, 'time@10': 3.0788}:  73%|███████▎  | 22/30 [00:53<00:20,  2.54s/it]{'epoch': 7, 'num_users': 6.1304, 'loss': 0.0512, 'hit_ratio@10': 0.8131, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 3.0838}:  73%|███████▎  | 22/30 [00:54<00:20,  2.54s/it]{'epoch': 7, 'num_users': 6.1304, 'loss': 0.0512, 'hit_ratio@10': 0.8131, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 3.0838}:  77%|███████▋  | 23/30 [00:54<00:15,  2.27s/it]{'epoch': 7, 'num_users': 5.9583, 'loss': 0.0494, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8437, 'compress@10': 1.0, 'time@10': 3.0324}:  77%|███████▋  | 23/30 [00:56<00:15,  2.27s/it]{'epoch': 7, 'num_users': 5.9583, 'loss': 0.0494, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8437, 'compress@10': 1.0, 'time@10': 3.0324}:  80%|████████  | 24/30 [00:56<00:12,  2.15s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8348, 'compress@10': 1.0, 'time@10': 2.9842}:  80%|████████  | 24/30 [00:57<00:12,  2.15s/it]   {'epoch': 7, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8348, 'compress@10': 1.0, 'time@10': 2.9842}:  83%|████████▎ | 25/30 [00:57<00:08,  1.79s/it]{'epoch': 7, 'num_users': 5.8077, 'loss': 0.0528, 'hit_ratio@10': 0.7952, 'ndcg@10': 0.8255, 'compress@10': 1.0, 'time@10': 2.8955}:  83%|████████▎ | 25/30 [00:58<00:08,  1.79s/it]{'epoch': 7, 'num_users': 5.8077, 'loss': 0.0528, 'hit_ratio@10': 0.7952, 'ndcg@10': 0.8255, 'compress@10': 1.0, 'time@10': 2.8955}:  87%|████████▋ | 26/30 [00:58<00:05,  1.47s/it]{'epoch': 7, 'num_users': 5.8889, 'loss': 0.0521, 'hit_ratio@10': 0.8014, 'ndcg@10': 0.8281, 'compress@10': 1.0, 'time@10': 2.9063}:  87%|████████▋ | 26/30 [01:00<00:05,  1.47s/it]{'epoch': 7, 'num_users': 5.8889, 'loss': 0.0521, 'hit_ratio@10': 0.8014, 'ndcg@10': 0.8281, 'compress@10': 1.0, 'time@10': 2.9063}:  90%|█████████ | 27/30 [01:00<00:04,  1.60s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.0522, 'hit_ratio@10': 0.8043, 'ndcg@10': 0.8298, 'compress@10': 1.0, 'time@10': 2.9059}:  90%|█████████ | 27/30 [01:03<00:04,  1.60s/it]   {'epoch': 7, 'num_users': 6.0, 'loss': 0.0522, 'hit_ratio@10': 0.8043, 'ndcg@10': 0.8298, 'compress@10': 1.0, 'time@10': 2.9059}:  93%|█████████▎| 28/30 [01:03<00:03,  2.00s/it]{'epoch': 7, 'num_users': 5.8621, 'loss': 0.0513, 'hit_ratio@10': 0.8079, 'ndcg@10': 0.8325, 'compress@10': 1.0, 'time@10': 2.9244}:  93%|█████████▎| 28/30 [01:04<00:03,  2.00s/it]{'epoch': 7, 'num_users': 5.8621, 'loss': 0.0513, 'hit_ratio@10': 0.8079, 'ndcg@10': 0.8325, 'compress@10': 1.0, 'time@10': 2.9244}:  97%|█████████▋| 29/30 [01:04<00:01,  1.94s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0513, 'hit_ratio@10': 0.8062, 'ndcg@10': 0.8362, 'compress@10': 1.0, 'time@10': 2.9262}:  97%|█████████▋| 29/30 [01:07<00:01,  1.94s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0513, 'hit_ratio@10': 0.8062, 'ndcg@10': 0.8362, 'compress@10': 1.0, 'time@10': 2.9262}: 100%|██████████| 30/30 [01:07<00:00,  2.26s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0513, 'hit_ratio@10': 0.8062, 'ndcg@10': 0.8362, 'compress@10': 1.0, 'time@10': 2.9262}: 100%|██████████| 30/30 [01:07<00:00,  2.26s/it]
Epoch: 7
Avg # of users: 5.866666666666666
Avg Loss: 0.05130618756853259
Avg hit ratio: 0.8062359976831864
Avg ndcg: 0.8361631525773611
Avg compression ratio: 0.9999999860153537
Avg train time: 2.926231376330058
Std train time: 0.8022592717574757
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 33, 14, 8, 8, 8, 11, 7, 9, 8, 34, 9, 57, 7, 34, 43, 14, 15, 6, 8, 19, 11, 62, 61, 9, 8, 9, 10, 12]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0494, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 3.5392}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0494, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 3.5392}:   3%|▎         | 1/30 [00:01<00:52,  1.81s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 3.5467}:   3%|▎         | 1/30 [00:05<00:52,  1.81s/it] {'epoch': 8, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 3.5467}:   7%|▋         | 2/30 [00:05<01:20,  2.86s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8682, 'compress@10': 1.0, 'time@10': 3.4785}:   7%|▋         | 2/30 [00:07<01:20,  2.86s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8682, 'compress@10': 1.0, 'time@10': 3.4785}:  10%|█         | 3/30 [00:07<01:03,  2.34s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.038, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.9054, 'compress@10': 1.0, 'time@10': 3.4653}:  10%|█         | 3/30 [00:10<01:03,  2.34s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.038, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.9054, 'compress@10': 1.0, 'time@10': 3.4653}:  13%|█▎        | 4/30 [00:10<01:12,  2.79s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 4.2298}:  13%|█▎        | 4/30 [00:14<01:12,  2.79s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 4.2298}:  17%|█▋        | 5/30 [00:14<01:17,  3.12s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.051, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 4.0393}:  17%|█▋        | 5/30 [00:17<01:17,  3.12s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.051, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 4.0393}:  20%|██        | 6/30 [00:17<01:14,  3.12s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8711, 'compress@10': 1.0, 'time@10': 3.9886}:  20%|██        | 6/30 [00:19<01:14,  3.12s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8711, 'compress@10': 1.0, 'time@10': 3.9886}:  23%|██▎       | 7/30 [00:19<01:02,  2.72s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0504, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 3.9213}:  23%|██▎       | 7/30 [00:22<01:02,  2.72s/it]  {'epoch': 8, 'num_users': 6.125, 'loss': 0.0504, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 3.9213}:  27%|██▋       | 8/30 [00:22<01:05,  2.96s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8783, 'compress@10': 1.0, 'time@10': 3.9576}:  27%|██▋       | 8/30 [00:24<01:05,  2.96s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8783, 'compress@10': 1.0, 'time@10': 3.9576}:  30%|███       | 9/30 [00:24<00:56,  2.71s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8767, 'compress@10': 1.0, 'time@10': 3.9014}:  30%|███       | 9/30 [00:28<00:56,  2.71s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8767, 'compress@10': 1.0, 'time@10': 3.9014}:  33%|███▎      | 10/30 [00:28<00:58,  2.93s/it]{'epoch': 8, 'num_users': 6.6364, 'loss': 0.0511, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8752, 'compress@10': 1.0, 'time@10': 3.8854}:  33%|███▎      | 10/30 [00:30<00:58,  2.93s/it]{'epoch': 8, 'num_users': 6.6364, 'loss': 0.0511, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8752, 'compress@10': 1.0, 'time@10': 3.8854}:  37%|███▋      | 11/30 [00:30<00:49,  2.62s/it]{'epoch': 8, 'num_users': 6.4167, 'loss': 0.0478, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8776, 'compress@10': 1.0, 'time@10': 3.8339}:  37%|███▋      | 11/30 [00:33<00:49,  2.62s/it]{'epoch': 8, 'num_users': 6.4167, 'loss': 0.0478, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8776, 'compress@10': 1.0, 'time@10': 3.8339}:  40%|████      | 12/30 [00:33<00:50,  2.83s/it]{'epoch': 8, 'num_users': 6.6154, 'loss': 0.0482, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 3.7996}:  40%|████      | 12/30 [00:35<00:50,  2.83s/it]{'epoch': 8, 'num_users': 6.6154, 'loss': 0.0482, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 3.7996}:  43%|████▎     | 13/30 [00:35<00:42,  2.49s/it]{'epoch': 8, 'num_users': 6.3571, 'loss': 0.0451, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8729, 'compress@10': 1.0, 'time@10': 3.7081}:  43%|████▎     | 13/30 [00:37<00:42,  2.49s/it]{'epoch': 8, 'num_users': 6.3571, 'loss': 0.0451, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8729, 'compress@10': 1.0, 'time@10': 3.7081}:  47%|████▋     | 14/30 [00:37<00:40,  2.51s/it]{'epoch': 8, 'num_users': 6.2667, 'loss': 0.0465, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 3.7034}:  47%|████▋     | 14/30 [00:39<00:40,  2.51s/it]{'epoch': 8, 'num_users': 6.2667, 'loss': 0.0465, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 3.7034}:  50%|█████     | 15/30 [00:39<00:34,  2.32s/it]{'epoch': 8, 'num_users': 6.0625, 'loss': 0.0441, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.872, 'compress@10': 1.0, 'time@10': 3.6772}:  50%|█████     | 15/30 [00:43<00:34,  2.32s/it] {'epoch': 8, 'num_users': 6.0625, 'loss': 0.0441, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.872, 'compress@10': 1.0, 'time@10': 3.6772}:  53%|█████▎    | 16/30 [00:43<00:36,  2.62s/it]{'epoch': 8, 'num_users': 5.8235, 'loss': 0.0419, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8656, 'compress@10': 1.0, 'time@10': 3.6388}:  53%|█████▎    | 16/30 [00:44<00:36,  2.62s/it]{'epoch': 8, 'num_users': 5.8235, 'loss': 0.0419, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8656, 'compress@10': 1.0, 'time@10': 3.6388}:  57%|█████▋    | 17/30 [00:44<00:29,  2.30s/it]{'epoch': 8, 'num_users': 6.0556, 'loss': 0.0425, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 3.6395}:  57%|█████▋    | 17/30 [00:48<00:29,  2.30s/it]{'epoch': 8, 'num_users': 6.0556, 'loss': 0.0425, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 3.6395}:  60%|██████    | 18/30 [00:48<00:32,  2.72s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.0411, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8675, 'compress@10': 1.0, 'time@10': 3.6233}:  60%|██████    | 18/30 [00:50<00:32,  2.72s/it]   {'epoch': 8, 'num_users': 6.0, 'loss': 0.0411, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8675, 'compress@10': 1.0, 'time@10': 3.6233}:  63%|██████▎   | 19/30 [00:50<00:26,  2.41s/it]{'epoch': 8, 'num_users': 6.15, 'loss': 0.0422, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 3.5965}:  63%|██████▎   | 19/30 [00:53<00:26,  2.41s/it]{'epoch': 8, 'num_users': 6.15, 'loss': 0.0422, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 3.5965}:  67%|██████▋   | 20/30 [00:53<00:26,  2.63s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0437, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 3.6978}:  67%|██████▋   | 20/30 [00:56<00:26,  2.63s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0437, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 3.6978}:  70%|███████   | 21/30 [00:56<00:24,  2.71s/it]{'epoch': 8, 'num_users': 6.1818, 'loss': 0.0432, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8644, 'compress@10': 1.0, 'time@10': 3.6839}:  70%|███████   | 21/30 [00:59<00:24,  2.71s/it]{'epoch': 8, 'num_users': 6.1818, 'loss': 0.0432, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8644, 'compress@10': 1.0, 'time@10': 3.6839}:  73%|███████▎  | 22/30 [00:59<00:23,  2.93s/it]{'epoch': 8, 'num_users': 6.1304, 'loss': 0.0426, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 3.6874}:  73%|███████▎  | 22/30 [01:01<00:23,  2.93s/it]{'epoch': 8, 'num_users': 6.1304, 'loss': 0.0426, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 3.6874}:  77%|███████▋  | 23/30 [01:01<00:18,  2.63s/it]{'epoch': 8, 'num_users': 5.9583, 'loss': 0.0411, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 3.6224}:  77%|███████▋  | 23/30 [01:03<00:18,  2.63s/it]{'epoch': 8, 'num_users': 5.9583, 'loss': 0.0411, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 3.6224}:  80%|████████  | 24/30 [01:03<00:14,  2.49s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0396, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8521, 'compress@10': 1.0, 'time@10': 3.5644}:  80%|████████  | 24/30 [01:04<00:14,  2.49s/it]   {'epoch': 8, 'num_users': 5.8, 'loss': 0.0396, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8521, 'compress@10': 1.0, 'time@10': 3.5644}:  83%|████████▎ | 25/30 [01:04<00:10,  2.08s/it]{'epoch': 8, 'num_users': 5.8077, 'loss': 0.0407, 'hit_ratio@10': 0.83, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 3.6649}:  83%|████████▎ | 25/30 [01:10<00:10,  2.08s/it]{'epoch': 8, 'num_users': 5.8077, 'loss': 0.0407, 'hit_ratio@10': 0.83, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 3.6649}:  87%|████████▋ | 26/30 [01:10<00:13,  3.32s/it]{'epoch': 8, 'num_users': 5.8889, 'loss': 0.0404, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 3.6749}:  87%|████████▋ | 26/30 [01:12<00:13,  3.32s/it]{'epoch': 8, 'num_users': 5.8889, 'loss': 0.0404, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 3.6749}:  90%|█████████ | 27/30 [01:12<00:08,  2.92s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.0407, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8528, 'compress@10': 1.0, 'time@10': 3.6942}:  90%|█████████ | 27/30 [01:17<00:08,  2.92s/it]  {'epoch': 8, 'num_users': 6.0, 'loss': 0.0407, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8528, 'compress@10': 1.0, 'time@10': 3.6942}:  93%|█████████▎| 28/30 [01:17<00:06,  3.32s/it]{'epoch': 8, 'num_users': 5.8621, 'loss': 0.0405, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8539, 'compress@10': 1.0, 'time@10': 3.6923}:  93%|█████████▎| 28/30 [01:19<00:06,  3.32s/it]{'epoch': 8, 'num_users': 5.8621, 'loss': 0.0405, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8539, 'compress@10': 1.0, 'time@10': 3.6923}:  97%|█████████▋| 29/30 [01:19<00:02,  2.88s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0411, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8579, 'compress@10': 1.0, 'time@10': 3.6972}:  97%|█████████▋| 29/30 [01:22<00:02,  2.88s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0411, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8579, 'compress@10': 1.0, 'time@10': 3.6972}: 100%|██████████| 30/30 [01:22<00:00,  3.18s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0411, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8579, 'compress@10': 1.0, 'time@10': 3.6972}: 100%|██████████| 30/30 [01:22<00:00,  2.76s/it]
Epoch: 8
Avg # of users: 5.866666666666666
Avg Loss: 0.041078011454540486
Avg hit ratio: 0.8382349345132959
Avg ndcg: 0.8578761808709061
Avg compression ratio: 0.9999999860153537
Avg train time: 3.697200051943461
Std train time: 1.0369875379384978
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 33, 14, 1, 9, 7, 11, 5, 9, 7, 34, 9, 60, 6, 34, 44, 13, 15, 7, 1, 19, 10, 66, 65, 1, 7, 7, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 3.3251}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 3.3251}:   3%|▎         | 1/30 [00:01<00:50,  1.74s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 3.2867}:   3%|▎         | 1/30 [00:05<00:50,  1.74s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 3.2867}:   7%|▋         | 2/30 [00:05<01:14,  2.65s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 3.18}:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]  {'epoch': 9, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 3.18}:  10%|█         | 3/30 [00:06<00:57,  2.13s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8675, 'compress@10': 1.0, 'time@10': 3.1663}:  10%|█         | 3/30 [00:09<00:57,  2.13s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8675, 'compress@10': 1.0, 'time@10': 3.1663}:  13%|█▎        | 4/30 [00:09<01:06,  2.54s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0683, 'hit_ratio@10': 0.8158, 'ndcg@10': 0.8092, 'compress@10': 1.0, 'time@10': 2.7145}:  13%|█▎        | 4/30 [00:10<01:06,  2.54s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0683, 'hit_ratio@10': 0.8158, 'ndcg@10': 0.8092, 'compress@10': 1.0, 'time@10': 2.7145}:  17%|█▋        | 5/30 [00:10<00:45,  1.80s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0678, 'hit_ratio@10': 0.8168, 'ndcg@10': 0.8124, 'compress@10': 1.0, 'time@10': 2.8692}:  17%|█▋        | 5/30 [00:13<00:45,  1.80s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0678, 'hit_ratio@10': 0.8168, 'ndcg@10': 0.8124, 'compress@10': 1.0, 'time@10': 2.8692}:  20%|██        | 6/30 [00:13<00:58,  2.44s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.065, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8163, 'compress@10': 1.0, 'time@10': 2.8889}:  20%|██        | 6/30 [00:15<00:58,  2.44s/it] {'epoch': 9, 'num_users': 6.2857, 'loss': 0.065, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8163, 'compress@10': 1.0, 'time@10': 2.8889}:  23%|██▎       | 7/30 [00:15<00:49,  2.15s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0629, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.827, 'compress@10': 1.0, 'time@10': 2.9453}:  23%|██▎       | 7/30 [00:18<00:49,  2.15s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0629, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.827, 'compress@10': 1.0, 'time@10': 2.9453}:  27%|██▋       | 8/30 [00:18<00:55,  2.54s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0608, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8342, 'compress@10': 1.0, 'time@10': 2.944}:  27%|██▋       | 8/30 [00:20<00:55,  2.54s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0608, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8342, 'compress@10': 1.0, 'time@10': 2.944}:  30%|███       | 9/30 [00:20<00:46,  2.22s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0589, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8369, 'compress@10': 1.0, 'time@10': 2.9874}:  30%|███       | 9/30 [00:23<00:46,  2.22s/it]  {'epoch': 9, 'num_users': 6.3, 'loss': 0.0589, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8369, 'compress@10': 1.0, 'time@10': 2.9874}:  33%|███▎      | 10/30 [00:23<00:51,  2.59s/it]{'epoch': 9, 'num_users': 6.6364, 'loss': 0.0591, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8396, 'compress@10': 1.0, 'time@10': 3.0182}:  33%|███▎      | 10/30 [00:25<00:51,  2.59s/it]{'epoch': 9, 'num_users': 6.6364, 'loss': 0.0591, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8396, 'compress@10': 1.0, 'time@10': 3.0182}:  37%|███▋      | 11/30 [00:25<00:44,  2.32s/it]{'epoch': 9, 'num_users': 6.4167, 'loss': 0.055, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.845, 'compress@10': 1.0, 'time@10': 3.0403}:  37%|███▋      | 11/30 [00:28<00:44,  2.32s/it]  {'epoch': 9, 'num_users': 6.4167, 'loss': 0.055, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.845, 'compress@10': 1.0, 'time@10': 3.0403}:  40%|████      | 12/30 [00:28<00:47,  2.62s/it]{'epoch': 9, 'num_users': 6.6154, 'loss': 0.0551, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 3.0872}:  40%|████      | 12/30 [00:30<00:47,  2.62s/it]{'epoch': 9, 'num_users': 6.6154, 'loss': 0.0551, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 3.0872}:  43%|████▎     | 13/30 [00:30<00:40,  2.39s/it]{'epoch': 9, 'num_users': 6.3571, 'loss': 0.0514, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8447, 'compress@10': 1.0, 'time@10': 3.0561}:  43%|████▎     | 13/30 [00:33<00:40,  2.39s/it]{'epoch': 9, 'num_users': 6.3571, 'loss': 0.0514, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8447, 'compress@10': 1.0, 'time@10': 3.0561}:  47%|████▋     | 14/30 [00:33<00:39,  2.48s/it]{'epoch': 9, 'num_users': 6.2667, 'loss': 0.052, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8443, 'compress@10': 1.0, 'time@10': 3.0715}:  47%|████▋     | 14/30 [00:34<00:39,  2.48s/it]  {'epoch': 9, 'num_users': 6.2667, 'loss': 0.052, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8443, 'compress@10': 1.0, 'time@10': 3.0715}:  50%|█████     | 15/30 [00:34<00:33,  2.24s/it]{'epoch': 9, 'num_users': 6.0625, 'loss': 0.0491, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8474, 'compress@10': 1.0, 'time@10': 3.0846}:  50%|█████     | 15/30 [00:38<00:33,  2.24s/it]{'epoch': 9, 'num_users': 6.0625, 'loss': 0.0491, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8474, 'compress@10': 1.0, 'time@10': 3.0846}:  53%|█████▎    | 16/30 [00:38<00:35,  2.57s/it]{'epoch': 9, 'num_users': 5.8235, 'loss': 0.0466, 'hit_ratio@10': 0.8197, 'ndcg@10': 0.8425, 'compress@10': 1.0, 'time@10': 3.0859}:  53%|█████▎    | 16/30 [00:39<00:35,  2.57s/it]{'epoch': 9, 'num_users': 5.8235, 'loss': 0.0466, 'hit_ratio@10': 0.8197, 'ndcg@10': 0.8425, 'compress@10': 1.0, 'time@10': 3.0859}:  57%|█████▋    | 17/30 [00:39<00:29,  2.27s/it]{'epoch': 9, 'num_users': 6.0556, 'loss': 0.0468, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8435, 'compress@10': 1.0, 'time@10': 3.0985}:  57%|█████▋    | 17/30 [00:43<00:29,  2.27s/it]{'epoch': 9, 'num_users': 6.0556, 'loss': 0.0468, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8435, 'compress@10': 1.0, 'time@10': 3.0985}:  60%|██████    | 18/30 [00:43<00:31,  2.60s/it]{'epoch': 9, 'num_users': 6.0, 'loss': 0.0451, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8464, 'compress@10': 1.0, 'time@10': 3.1102}:  60%|██████    | 18/30 [00:44<00:31,  2.60s/it]   {'epoch': 9, 'num_users': 6.0, 'loss': 0.0451, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8464, 'compress@10': 1.0, 'time@10': 3.1102}:  63%|██████▎   | 19/30 [00:44<00:25,  2.33s/it]{'epoch': 9, 'num_users': 6.15, 'loss': 0.0458, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8447, 'compress@10': 1.0, 'time@10': 3.1334}:  63%|██████▎   | 19/30 [00:48<00:25,  2.33s/it]{'epoch': 9, 'num_users': 6.15, 'loss': 0.0458, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8447, 'compress@10': 1.0, 'time@10': 3.1334}:  67%|██████▋   | 20/30 [00:48<00:27,  2.71s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0533, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.8347, 'compress@10': 1.0, 'time@10': 3.0173}:  67%|██████▋   | 20/30 [00:48<00:27,  2.71s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0533, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.8347, 'compress@10': 1.0, 'time@10': 3.0173}:  70%|███████   | 21/30 [00:48<00:18,  2.01s/it]{'epoch': 9, 'num_users': 6.1818, 'loss': 0.0525, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8378, 'compress@10': 1.0, 'time@10': 3.0299}:  70%|███████   | 21/30 [00:52<00:18,  2.01s/it]{'epoch': 9, 'num_users': 6.1818, 'loss': 0.0525, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8378, 'compress@10': 1.0, 'time@10': 3.0299}:  73%|███████▎  | 22/30 [00:52<00:19,  2.41s/it]{'epoch': 9, 'num_users': 6.1304, 'loss': 0.0515, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8401, 'compress@10': 1.0, 'time@10': 3.0349}:  73%|███████▎  | 22/30 [00:53<00:19,  2.41s/it]{'epoch': 9, 'num_users': 6.1304, 'loss': 0.0515, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8401, 'compress@10': 1.0, 'time@10': 3.0349}:  77%|███████▋  | 23/30 [00:53<00:15,  2.17s/it]{'epoch': 9, 'num_users': 5.9583, 'loss': 0.0495, 'hit_ratio@10': 0.8121, 'ndcg@10': 0.8382, 'compress@10': 1.0, 'time@10': 2.9952}:  77%|███████▋  | 23/30 [00:55<00:15,  2.17s/it]{'epoch': 9, 'num_users': 5.9583, 'loss': 0.0495, 'hit_ratio@10': 0.8121, 'ndcg@10': 0.8382, 'compress@10': 1.0, 'time@10': 2.9952}:  80%|████████  | 24/30 [00:55<00:12,  2.15s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0477, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.8296, 'compress@10': 1.0, 'time@10': 2.9611}:  80%|████████  | 24/30 [00:57<00:12,  2.15s/it]   {'epoch': 9, 'num_users': 5.8, 'loss': 0.0477, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.8296, 'compress@10': 1.0, 'time@10': 2.9611}:  83%|████████▎ | 25/30 [00:57<00:09,  1.84s/it]{'epoch': 9, 'num_users': 5.8077, 'loss': 0.0527, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.8207, 'compress@10': 1.0, 'time@10': 2.8756}:  83%|████████▎ | 25/30 [00:57<00:09,  1.84s/it]{'epoch': 9, 'num_users': 5.8077, 'loss': 0.0527, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.8207, 'compress@10': 1.0, 'time@10': 2.8756}:  87%|████████▋ | 26/30 [00:57<00:06,  1.52s/it]{'epoch': 9, 'num_users': 5.8889, 'loss': 0.052, 'hit_ratio@10': 0.8028, 'ndcg@10': 0.8238, 'compress@10': 1.0, 'time@10': 2.8963}:  87%|████████▋ | 26/30 [00:59<00:06,  1.52s/it] {'epoch': 9, 'num_users': 5.8889, 'loss': 0.052, 'hit_ratio@10': 0.8028, 'ndcg@10': 0.8238, 'compress@10': 1.0, 'time@10': 2.8963}:  90%|█████████ | 27/30 [00:59<00:04,  1.59s/it]{'epoch': 9, 'num_users': 6.0, 'loss': 0.0523, 'hit_ratio@10': 0.8064, 'ndcg@10': 0.8246, 'compress@10': 1.0, 'time@10': 2.9071}:  90%|█████████ | 27/30 [01:02<00:04,  1.59s/it]  {'epoch': 9, 'num_users': 6.0, 'loss': 0.0523, 'hit_ratio@10': 0.8064, 'ndcg@10': 0.8246, 'compress@10': 1.0, 'time@10': 2.9071}:  93%|█████████▎| 28/30 [01:02<00:04,  2.08s/it]{'epoch': 9, 'num_users': 5.8621, 'loss': 0.0511, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8274, 'compress@10': 1.0, 'time@10': 2.9199}:  93%|█████████▎| 28/30 [01:04<00:04,  2.08s/it]{'epoch': 9, 'num_users': 5.8621, 'loss': 0.0511, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8274, 'compress@10': 1.0, 'time@10': 2.9199}:  97%|█████████▋| 29/30 [01:04<00:01,  1.96s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.051, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8312, 'compress@10': 1.0, 'time@10': 2.9397}:  97%|█████████▋| 29/30 [01:08<00:01,  1.96s/it] {'epoch': 9, 'num_users': 5.8667, 'loss': 0.051, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8312, 'compress@10': 1.0, 'time@10': 2.9397}: 100%|██████████| 30/30 [01:08<00:00,  2.44s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.051, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8312, 'compress@10': 1.0, 'time@10': 2.9397}: 100%|██████████| 30/30 [01:08<00:00,  2.27s/it]
Epoch: 9
Avg # of users: 5.866666666666666
Avg Loss: 0.05100313186174201
Avg hit ratio: 0.8099448451907114
Avg ndcg: 0.8311692578037664
Avg compression ratio: 0.9999999860166272
Avg train time: 2.939714527130127
Std train time: 0.8008108453064758
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 14, 34, 15, 8, 8, 8, 11, 6, 9, 7, 34, 8, 62, 6, 34, 45, 13, 15, 7, 9, 19, 11, 70, 69, 9, 7, 8, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 3.437}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 3.437}:   3%|▎         | 1/30 [00:01<00:50,  1.75s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0588, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8594, 'compress@10': 1.0, 'time@10': 3.5734}:   3%|▎         | 1/30 [00:05<00:50,  1.75s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0588, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8594, 'compress@10': 1.0, 'time@10': 3.5734}:   7%|▋         | 2/30 [00:05<01:21,  2.93s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0392, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8587, 'compress@10': 1.0, 'time@10': 3.494}:   7%|▋         | 2/30 [00:07<01:21,  2.93s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0392, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8587, 'compress@10': 1.0, 'time@10': 3.494}:  10%|█         | 3/30 [00:07<01:03,  2.37s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0475, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8452, 'compress@10': 1.0, 'time@10': 3.5282}:  10%|█         | 3/30 [00:10<01:03,  2.37s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0475, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8452, 'compress@10': 1.0, 'time@10': 3.5282}:  13%|█▎        | 4/30 [00:10<01:14,  2.88s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0548, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8316, 'compress@10': 1.0, 'time@10': 4.2636}:  13%|█▎        | 4/30 [00:14<01:14,  2.88s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0548, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8316, 'compress@10': 1.0, 'time@10': 4.2636}:  17%|█▋        | 5/30 [00:14<01:18,  3.15s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0562, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8307, 'compress@10': 1.0, 'time@10': 4.0791}:  17%|█▋        | 5/30 [00:17<01:18,  3.15s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0562, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8307, 'compress@10': 1.0, 'time@10': 4.0791}:  20%|██        | 6/30 [00:17<01:16,  3.17s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0558, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.836, 'compress@10': 1.0, 'time@10': 3.9997}:  20%|██        | 6/30 [00:19<01:16,  3.17s/it] {'epoch': 10, 'num_users': 6.2857, 'loss': 0.0558, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.836, 'compress@10': 1.0, 'time@10': 3.9997}:  23%|██▎       | 7/30 [00:19<01:02,  2.72s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0541, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8449, 'compress@10': 1.0, 'time@10': 3.9046}:  23%|██▎       | 7/30 [00:22<01:02,  2.72s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0541, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8449, 'compress@10': 1.0, 'time@10': 3.9046}:  27%|██▋       | 8/30 [00:22<01:03,  2.90s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0537, 'hit_ratio@10': 0.83, 'ndcg@10': 0.851, 'compress@10': 1.0, 'time@10': 3.8383}:  27%|██▋       | 8/30 [00:24<01:03,  2.90s/it]  {'epoch': 10, 'num_users': 6.3333, 'loss': 0.0537, 'hit_ratio@10': 0.83, 'ndcg@10': 0.851, 'compress@10': 1.0, 'time@10': 3.8383}:  30%|███       | 9/30 [00:24<00:52,  2.52s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.052, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 3.7613}:  30%|███       | 9/30 [00:27<00:52,  2.52s/it] {'epoch': 10, 'num_users': 6.3, 'loss': 0.052, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 3.7613}:  33%|███▎      | 10/30 [00:27<00:54,  2.70s/it]{'epoch': 10, 'num_users': 6.6364, 'loss': 0.0528, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 3.6965}:  33%|███▎      | 10/30 [00:29<00:54,  2.70s/it]{'epoch': 10, 'num_users': 6.6364, 'loss': 0.0528, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 3.6965}:  37%|███▋      | 11/30 [00:29<00:44,  2.35s/it]{'epoch': 10, 'num_users': 6.4167, 'loss': 0.0492, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8585, 'compress@10': 1.0, 'time@10': 3.6368}:  37%|███▋      | 11/30 [00:32<00:44,  2.35s/it]{'epoch': 10, 'num_users': 6.4167, 'loss': 0.0492, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8585, 'compress@10': 1.0, 'time@10': 3.6368}:  40%|████      | 12/30 [00:32<00:45,  2.55s/it]{'epoch': 10, 'num_users': 6.6154, 'loss': 0.0497, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8607, 'compress@10': 1.0, 'time@10': 3.5634}:  40%|████      | 12/30 [00:33<00:45,  2.55s/it]{'epoch': 10, 'num_users': 6.6154, 'loss': 0.0497, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8607, 'compress@10': 1.0, 'time@10': 3.5634}:  43%|████▎     | 13/30 [00:33<00:37,  2.20s/it]{'epoch': 10, 'num_users': 6.3571, 'loss': 0.0463, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 3.5089}:  43%|████▎     | 13/30 [00:36<00:37,  2.20s/it]{'epoch': 10, 'num_users': 6.3571, 'loss': 0.0463, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 3.5089}:  47%|████▋     | 14/30 [00:36<00:38,  2.39s/it]{'epoch': 10, 'num_users': 6.2667, 'loss': 0.0471, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8576, 'compress@10': 1.0, 'time@10': 3.4807}:  47%|████▋     | 14/30 [00:37<00:38,  2.39s/it]{'epoch': 10, 'num_users': 6.2667, 'loss': 0.0471, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8576, 'compress@10': 1.0, 'time@10': 3.4807}:  50%|█████     | 15/30 [00:37<00:32,  2.15s/it]{'epoch': 10, 'num_users': 6.0625, 'loss': 0.0445, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 3.4665}:  50%|█████     | 15/30 [00:41<00:32,  2.15s/it]{'epoch': 10, 'num_users': 6.0625, 'loss': 0.0445, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 3.4665}:  53%|█████▎    | 16/30 [00:41<00:34,  2.49s/it]{'epoch': 10, 'num_users': 5.8235, 'loss': 0.0422, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8545, 'compress@10': 1.0, 'time@10': 3.4517}:  53%|█████▎    | 16/30 [00:42<00:34,  2.49s/it]{'epoch': 10, 'num_users': 5.8235, 'loss': 0.0422, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8545, 'compress@10': 1.0, 'time@10': 3.4517}:  57%|█████▋    | 17/30 [00:42<00:29,  2.24s/it]{'epoch': 10, 'num_users': 6.0556, 'loss': 0.0425, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8551, 'compress@10': 1.0, 'time@10': 3.4331}:  57%|█████▋    | 17/30 [00:46<00:29,  2.24s/it]{'epoch': 10, 'num_users': 6.0556, 'loss': 0.0425, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8551, 'compress@10': 1.0, 'time@10': 3.4331}:  60%|██████    | 18/30 [00:46<00:30,  2.52s/it]{'epoch': 10, 'num_users': 6.0, 'loss': 0.041, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.8572, 'compress@10': 1.0, 'time@10': 3.4312}:  60%|██████    | 18/30 [00:47<00:30,  2.52s/it]    {'epoch': 10, 'num_users': 6.0, 'loss': 0.041, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.8572, 'compress@10': 1.0, 'time@10': 3.4312}:  63%|██████▎   | 19/30 [00:47<00:25,  2.28s/it]{'epoch': 10, 'num_users': 6.15, 'loss': 0.042, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8553, 'compress@10': 1.0, 'time@10': 3.4471}:  63%|██████▎   | 19/30 [00:51<00:25,  2.28s/it]{'epoch': 10, 'num_users': 6.15, 'loss': 0.042, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8553, 'compress@10': 1.0, 'time@10': 3.4471}:  67%|██████▋   | 20/30 [00:51<00:27,  2.74s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0436, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 3.5943}:  67%|██████▋   | 20/30 [00:54<00:27,  2.74s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0436, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 3.5943}:  70%|███████   | 21/30 [00:54<00:26,  2.91s/it]{'epoch': 10, 'num_users': 6.1818, 'loss': 0.0427, 'hit_ratio@10': 0.8234, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 3.5785}:  70%|███████   | 21/30 [00:58<00:26,  2.91s/it]{'epoch': 10, 'num_users': 6.1818, 'loss': 0.0427, 'hit_ratio@10': 0.8234, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 3.5785}:  73%|███████▎  | 22/30 [00:58<00:24,  3.02s/it]{'epoch': 10, 'num_users': 6.1304, 'loss': 0.0421, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 3.5878}:  73%|███████▎  | 22/30 [01:00<00:24,  3.02s/it]{'epoch': 10, 'num_users': 6.1304, 'loss': 0.0421, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 3.5878}:  77%|███████▋  | 23/30 [01:00<00:18,  2.69s/it]{'epoch': 10, 'num_users': 5.9583, 'loss': 0.0405, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8557, 'compress@10': 1.0, 'time@10': 3.5413}:  77%|███████▋  | 23/30 [01:02<00:18,  2.69s/it]{'epoch': 10, 'num_users': 5.9583, 'loss': 0.0405, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8557, 'compress@10': 1.0, 'time@10': 3.5413}:  80%|████████  | 24/30 [01:02<00:15,  2.64s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.039, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 3.4951}:  80%|████████  | 24/30 [01:03<00:15,  2.64s/it]    {'epoch': 10, 'num_users': 5.8, 'loss': 0.039, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 3.4951}:  83%|████████▎ | 25/30 [01:03<00:11,  2.22s/it]{'epoch': 10, 'num_users': 5.8077, 'loss': 0.0399, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8469, 'compress@10': 1.0, 'time@10': 3.6029}:  83%|████████▎ | 25/30 [01:10<00:11,  2.22s/it]{'epoch': 10, 'num_users': 5.8077, 'loss': 0.0399, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8469, 'compress@10': 1.0, 'time@10': 3.6029}:  87%|████████▋ | 26/30 [01:10<00:13,  3.45s/it]{'epoch': 10, 'num_users': 5.8889, 'loss': 0.0398, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8479, 'compress@10': 1.0, 'time@10': 3.5973}:  87%|████████▋ | 26/30 [01:11<00:13,  3.45s/it]{'epoch': 10, 'num_users': 5.8889, 'loss': 0.0398, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8479, 'compress@10': 1.0, 'time@10': 3.5973}:  90%|█████████ | 27/30 [01:11<00:08,  2.95s/it]{'epoch': 10, 'num_users': 6.0, 'loss': 0.0403, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 3.6017}:  90%|█████████ | 27/30 [01:15<00:08,  2.95s/it]   {'epoch': 10, 'num_users': 6.0, 'loss': 0.0403, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 3.6017}:  93%|█████████▎| 28/30 [01:15<00:06,  3.19s/it]{'epoch': 10, 'num_users': 5.8621, 'loss': 0.0398, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.851, 'compress@10': 1.0, 'time@10': 3.5881}:  93%|█████████▎| 28/30 [01:17<00:06,  3.19s/it]{'epoch': 10, 'num_users': 5.8621, 'loss': 0.0398, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.851, 'compress@10': 1.0, 'time@10': 3.5881}:  97%|█████████▋| 29/30 [01:17<00:02,  2.73s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.0398, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 3.5879}:  97%|█████████▋| 29/30 [01:20<00:02,  2.73s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.0398, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 3.5879}: 100%|██████████| 30/30 [01:20<00:00,  3.00s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.0398, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 3.5879}: 100%|██████████| 30/30 [01:20<00:00,  2.70s/it]
Epoch: 10
Avg # of users: 5.866666666666666
Avg Loss: 0.03981838507305288
Avg hit ratio: 0.8325962875104153
Avg ndcg: 0.8529068753866602
Avg compression ratio: 0.9999999860153537
Avg train time: 3.5878687858581544
Std train time: 1.092596728405526
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 34, 14, 1, 9, 8, 12, 6, 10, 8, 35, 10, 64, 7, 35, 46, 14, 15, 6, 1, 20, 10, 73, 72, 1, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.05, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 3.7367}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.05, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 3.7367}:   3%|▎         | 1/30 [00:01<00:55,  1.91s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8778, 'compress@10': 1.0, 'time@10': 3.6611}:   3%|▎         | 1/30 [00:05<00:55,  1.91s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8778, 'compress@10': 1.0, 'time@10': 3.6611}:   7%|▋         | 2/30 [00:05<01:21,  2.92s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.6748, 'ndcg@10': 0.8709, 'compress@10': 1.0, 'time@10': 3.6011}:   7%|▋         | 2/30 [00:07<01:21,  2.92s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.6748, 'ndcg@10': 0.8709, 'compress@10': 1.0, 'time@10': 3.6011}:  10%|█         | 3/30 [00:07<01:04,  2.40s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.7383, 'ndcg@10': 0.8826, 'compress@10': 1.0, 'time@10': 3.5189}:  10%|█         | 3/30 [00:10<01:04,  2.40s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.7383, 'ndcg@10': 0.8826, 'compress@10': 1.0, 'time@10': 3.5189}:  13%|█▎        | 4/30 [00:10<01:11,  2.77s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0716, 'hit_ratio@10': 0.7131, 'ndcg@10': 0.8221, 'compress@10': 1.0, 'time@10': 3.0082}:  13%|█▎        | 4/30 [00:11<01:11,  2.77s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0716, 'hit_ratio@10': 0.7131, 'ndcg@10': 0.8221, 'compress@10': 1.0, 'time@10': 3.0082}:  17%|█▋        | 5/30 [00:11<00:49,  1.96s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0698, 'hit_ratio@10': 0.735, 'ndcg@10': 0.8242, 'compress@10': 1.0, 'time@10': 3.1245}:  17%|█▋        | 5/30 [00:14<00:49,  1.96s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0698, 'hit_ratio@10': 0.735, 'ndcg@10': 0.8242, 'compress@10': 1.0, 'time@10': 3.1245}:  20%|██        | 6/30 [00:14<01:01,  2.57s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0667, 'hit_ratio@10': 0.7614, 'ndcg@10': 0.8299, 'compress@10': 1.0, 'time@10': 3.1672}:  20%|██        | 6/30 [00:16<01:01,  2.57s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0667, 'hit_ratio@10': 0.7614, 'ndcg@10': 0.8299, 'compress@10': 1.0, 'time@10': 3.1672}:  23%|██▎       | 7/30 [00:16<00:52,  2.30s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0651, 'hit_ratio@10': 0.7841, 'ndcg@10': 0.8296, 'compress@10': 1.0, 'time@10': 3.223}:  23%|██▎       | 7/30 [00:20<00:52,  2.30s/it]  {'epoch': 11, 'num_users': 6.125, 'loss': 0.0651, 'hit_ratio@10': 0.7841, 'ndcg@10': 0.8296, 'compress@10': 1.0, 'time@10': 3.223}:  27%|██▋       | 8/30 [00:20<01:00,  2.73s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0623, 'hit_ratio@10': 0.7763, 'ndcg@10': 0.8377, 'compress@10': 1.0, 'time@10': 3.2764}:  27%|██▋       | 8/30 [00:22<01:00,  2.73s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0623, 'hit_ratio@10': 0.7763, 'ndcg@10': 0.8377, 'compress@10': 1.0, 'time@10': 3.2764}:  30%|███       | 9/30 [00:22<00:51,  2.47s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0613, 'hit_ratio@10': 0.7919, 'ndcg@10': 0.8424, 'compress@10': 1.0, 'time@10': 3.3398}:  30%|███       | 9/30 [00:26<00:51,  2.47s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0613, 'hit_ratio@10': 0.7919, 'ndcg@10': 0.8424, 'compress@10': 1.0, 'time@10': 3.3398}:  33%|███▎      | 10/30 [00:26<00:58,  2.93s/it]{'epoch': 11, 'num_users': 6.6364, 'loss': 0.0611, 'hit_ratio@10': 0.7933, 'ndcg@10': 0.8447, 'compress@10': 1.0, 'time@10': 3.3873}:  33%|███▎      | 10/30 [00:28<00:58,  2.93s/it]{'epoch': 11, 'num_users': 6.6364, 'loss': 0.0611, 'hit_ratio@10': 0.7933, 'ndcg@10': 0.8447, 'compress@10': 1.0, 'time@10': 3.3873}:  37%|███▋      | 11/30 [00:28<00:50,  2.64s/it]{'epoch': 11, 'num_users': 6.4167, 'loss': 0.0567, 'hit_ratio@10': 0.7828, 'ndcg@10': 0.8499, 'compress@10': 1.0, 'time@10': 3.3862}:  37%|███▋      | 11/30 [00:31<00:50,  2.64s/it]{'epoch': 11, 'num_users': 6.4167, 'loss': 0.0567, 'hit_ratio@10': 0.7828, 'ndcg@10': 0.8499, 'compress@10': 1.0, 'time@10': 3.3862}:  40%|████      | 12/30 [00:31<00:51,  2.87s/it]{'epoch': 11, 'num_users': 6.6154, 'loss': 0.0569, 'hit_ratio@10': 0.789, 'ndcg@10': 0.8534, 'compress@10': 1.0, 'time@10': 3.43}:  40%|████      | 12/30 [00:33<00:51,  2.87s/it]   {'epoch': 11, 'num_users': 6.6154, 'loss': 0.0569, 'hit_ratio@10': 0.789, 'ndcg@10': 0.8534, 'compress@10': 1.0, 'time@10': 3.43}:  43%|████▎     | 13/30 [00:33<00:44,  2.61s/it]{'epoch': 11, 'num_users': 6.3571, 'loss': 0.053, 'hit_ratio@10': 0.7921, 'ndcg@10': 0.8511, 'compress@10': 1.0, 'time@10': 3.3681}:  43%|████▎     | 13/30 [00:36<00:44,  2.61s/it]{'epoch': 11, 'num_users': 6.3571, 'loss': 0.053, 'hit_ratio@10': 0.7921, 'ndcg@10': 0.8511, 'compress@10': 1.0, 'time@10': 3.3681}:  47%|████▋     | 14/30 [00:36<00:41,  2.61s/it]{'epoch': 11, 'num_users': 6.2667, 'loss': 0.0532, 'hit_ratio@10': 0.8039, 'ndcg@10': 0.8504, 'compress@10': 1.0, 'time@10': 3.3682}:  47%|████▋     | 14/30 [00:37<00:41,  2.61s/it]{'epoch': 11, 'num_users': 6.2667, 'loss': 0.0532, 'hit_ratio@10': 0.8039, 'ndcg@10': 0.8504, 'compress@10': 1.0, 'time@10': 3.3682}:  50%|█████     | 15/30 [00:37<00:35,  2.34s/it]{'epoch': 11, 'num_users': 6.0625, 'loss': 0.0502, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.8534, 'compress@10': 1.0, 'time@10': 3.3565}:  50%|█████     | 15/30 [00:41<00:35,  2.34s/it]{'epoch': 11, 'num_users': 6.0625, 'loss': 0.0502, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.8534, 'compress@10': 1.0, 'time@10': 3.3565}:  53%|█████▎    | 16/30 [00:41<00:36,  2.61s/it]{'epoch': 11, 'num_users': 5.8235, 'loss': 0.0476, 'hit_ratio@10': 0.7887, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 3.3215}:  53%|█████▎    | 16/30 [00:42<00:36,  2.61s/it]{'epoch': 11, 'num_users': 5.8235, 'loss': 0.0476, 'hit_ratio@10': 0.7887, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 3.3215}:  57%|█████▋    | 17/30 [00:42<00:29,  2.26s/it]{'epoch': 11, 'num_users': 6.0556, 'loss': 0.0474, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 3.3188}:  57%|█████▋    | 17/30 [00:45<00:29,  2.26s/it]{'epoch': 11, 'num_users': 6.0556, 'loss': 0.0474, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 3.3188}:  60%|██████    | 18/30 [00:45<00:30,  2.57s/it]{'epoch': 11, 'num_users': 6.0, 'loss': 0.0456, 'hit_ratio@10': 0.7903, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 3.3055}:  60%|██████    | 18/30 [00:47<00:30,  2.57s/it]   {'epoch': 11, 'num_users': 6.0, 'loss': 0.0456, 'hit_ratio@10': 0.7903, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 3.3055}:  63%|██████▎   | 19/30 [00:47<00:25,  2.27s/it]{'epoch': 11, 'num_users': 6.15, 'loss': 0.0463, 'hit_ratio@10': 0.7946, 'ndcg@10': 0.851, 'compress@10': 1.0, 'time@10': 3.2882}:  63%|██████▎   | 19/30 [00:50<00:25,  2.27s/it]{'epoch': 11, 'num_users': 6.15, 'loss': 0.0463, 'hit_ratio@10': 0.7946, 'ndcg@10': 0.851, 'compress@10': 1.0, 'time@10': 3.2882}:  67%|██████▋   | 20/30 [00:50<00:24,  2.49s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0537, 'hit_ratio@10': 0.7849, 'ndcg@10': 0.8404, 'compress@10': 1.0, 'time@10': 3.1684}:  67%|██████▋   | 20/30 [00:50<00:24,  2.49s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0537, 'hit_ratio@10': 0.7849, 'ndcg@10': 0.8404, 'compress@10': 1.0, 'time@10': 3.1684}:  70%|███████   | 21/30 [00:50<00:16,  1.87s/it]{'epoch': 11, 'num_users': 6.1818, 'loss': 0.0523, 'hit_ratio@10': 0.7905, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 3.1898}:  70%|███████   | 21/30 [00:54<00:16,  1.87s/it]{'epoch': 11, 'num_users': 6.1818, 'loss': 0.0523, 'hit_ratio@10': 0.7905, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 3.1898}:  73%|███████▎  | 22/30 [00:54<00:19,  2.41s/it]{'epoch': 11, 'num_users': 6.1304, 'loss': 0.0513, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8456, 'compress@10': 1.0, 'time@10': 3.2022}:  73%|███████▎  | 22/30 [00:56<00:19,  2.41s/it]{'epoch': 11, 'num_users': 6.1304, 'loss': 0.0513, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8456, 'compress@10': 1.0, 'time@10': 3.2022}:  77%|███████▋  | 23/30 [00:56<00:15,  2.22s/it]{'epoch': 11, 'num_users': 5.9583, 'loss': 0.0493, 'hit_ratio@10': 0.7934, 'ndcg@10': 0.8437, 'compress@10': 1.0, 'time@10': 3.1729}:  77%|███████▋  | 23/30 [00:58<00:15,  2.22s/it]{'epoch': 11, 'num_users': 5.9583, 'loss': 0.0493, 'hit_ratio@10': 0.7934, 'ndcg@10': 0.8437, 'compress@10': 1.0, 'time@10': 3.1729}:  80%|████████  | 24/30 [00:58<00:13,  2.32s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0474, 'hit_ratio@10': 0.7883, 'ndcg@10': 0.8366, 'compress@10': 1.0, 'time@10': 3.1484}:  80%|████████  | 24/30 [01:00<00:13,  2.32s/it]   {'epoch': 11, 'num_users': 5.8, 'loss': 0.0474, 'hit_ratio@10': 0.7883, 'ndcg@10': 0.8366, 'compress@10': 1.0, 'time@10': 3.1484}:  83%|████████▎ | 25/30 [01:00<00:10,  2.02s/it]{'epoch': 11, 'num_users': 5.8077, 'loss': 0.0524, 'hit_ratio@10': 0.7798, 'ndcg@10': 0.8279, 'compress@10': 1.0, 'time@10': 3.0557}:  83%|████████▎ | 25/30 [01:00<00:10,  2.02s/it]{'epoch': 11, 'num_users': 5.8077, 'loss': 0.0524, 'hit_ratio@10': 0.7798, 'ndcg@10': 0.8279, 'compress@10': 1.0, 'time@10': 3.0557}:  87%|████████▋ | 26/30 [01:00<00:06,  1.64s/it]{'epoch': 11, 'num_users': 5.8889, 'loss': 0.0516, 'hit_ratio@10': 0.7867, 'ndcg@10': 0.8304, 'compress@10': 1.0, 'time@10': 3.0728}:  87%|████████▋ | 26/30 [01:02<00:06,  1.64s/it]{'epoch': 11, 'num_users': 5.8889, 'loss': 0.0516, 'hit_ratio@10': 0.7867, 'ndcg@10': 0.8304, 'compress@10': 1.0, 'time@10': 3.0728}:  90%|█████████ | 27/30 [01:02<00:05,  1.70s/it]{'epoch': 11, 'num_users': 6.0, 'loss': 0.0514, 'hit_ratio@10': 0.7915, 'ndcg@10': 0.8324, 'compress@10': 1.0, 'time@10': 3.0783}:  90%|█████████ | 27/30 [01:06<00:05,  1.70s/it]   {'epoch': 11, 'num_users': 6.0, 'loss': 0.0514, 'hit_ratio@10': 0.7915, 'ndcg@10': 0.8324, 'compress@10': 1.0, 'time@10': 3.0783}:  93%|█████████▎| 28/30 [01:06<00:04,  2.17s/it]{'epoch': 11, 'num_users': 5.8621, 'loss': 0.0504, 'hit_ratio@10': 0.7955, 'ndcg@10': 0.8345, 'compress@10': 1.0, 'time@10': 3.0992}:  93%|█████████▎| 28/30 [01:07<00:04,  2.17s/it]{'epoch': 11, 'num_users': 5.8621, 'loss': 0.0504, 'hit_ratio@10': 0.7955, 'ndcg@10': 0.8345, 'compress@10': 1.0, 'time@10': 3.0992}:  97%|█████████▋| 29/30 [01:07<00:02,  2.09s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0502, 'hit_ratio@10': 0.7969, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.114}:  97%|█████████▋| 29/30 [01:11<00:02,  2.09s/it]  {'epoch': 11, 'num_users': 5.8667, 'loss': 0.0502, 'hit_ratio@10': 0.7969, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.114}: 100%|██████████| 30/30 [01:11<00:00,  2.54s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0502, 'hit_ratio@10': 0.7969, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.114}: 100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch: 11
Avg # of users: 5.866666666666666
Avg Loss: 0.050205697523405375
Avg hit ratio: 0.796943682358911
Avg ndcg: 0.8379649223825214
Avg compression ratio: 0.9999999860166272
Avg train time: 3.1139537652333575
Std train time: 0.8534988433240273
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 34, 14, 8, 8, 8, 11, 5, 9, 7, 35, 8, 67, 7, 36, 48, 14, 16, 7, 9, 19, 10, 76, 75, 9, 7, 8, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0433, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 3.2641}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0433, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 3.2641}:   3%|▎         | 1/30 [00:01<00:48,  1.67s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8633, 'compress@10': 1.0, 'time@10': 3.4352}:   3%|▎         | 1/30 [00:05<00:48,  1.67s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8633, 'compress@10': 1.0, 'time@10': 3.4352}:   7%|▋         | 2/30 [00:05<01:19,  2.83s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.6963, 'ndcg@10': 0.8613, 'compress@10': 1.0, 'time@10': 3.4687}:   7%|▋         | 2/30 [00:07<01:19,  2.83s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.6963, 'ndcg@10': 0.8613, 'compress@10': 1.0, 'time@10': 3.4687}:  10%|█         | 3/30 [00:07<01:03,  2.36s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7633, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 3.4341}:  10%|█         | 3/30 [00:10<01:03,  2.36s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7633, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 3.4341}:  13%|█▎        | 4/30 [00:10<01:11,  2.76s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0404, 'hit_ratio@10': 0.7787, 'ndcg@10': 0.8449, 'compress@10': 1.0, 'time@10': 4.1724}:  13%|█▎        | 4/30 [00:14<01:11,  2.76s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0404, 'hit_ratio@10': 0.7787, 'ndcg@10': 0.8449, 'compress@10': 1.0, 'time@10': 4.1724}:  17%|█▋        | 5/30 [00:14<01:16,  3.07s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0437, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8426, 'compress@10': 1.0, 'time@10': 4.0134}:  17%|█▋        | 5/30 [00:17<01:16,  3.07s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0437, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8426, 'compress@10': 1.0, 'time@10': 4.0134}:  20%|██        | 6/30 [00:17<01:15,  3.13s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0439, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 3.9538}:  20%|██        | 6/30 [00:19<01:15,  3.13s/it] {'epoch': 12, 'num_users': 6.2857, 'loss': 0.0439, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 3.9538}:  23%|██▎       | 7/30 [00:19<01:02,  2.71s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.045, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 3.8665}:  23%|██▎       | 7/30 [00:22<01:02,  2.71s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.045, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 3.8665}:  27%|██▋       | 8/30 [00:22<01:03,  2.89s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0445, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 3.7598}:  27%|██▋       | 8/30 [00:23<01:03,  2.89s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0445, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 3.7598}:  30%|███       | 9/30 [00:23<00:51,  2.46s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0434, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8705, 'compress@10': 1.0, 'time@10': 3.7228}:  30%|███       | 9/30 [00:27<00:51,  2.46s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0434, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8705, 'compress@10': 1.0, 'time@10': 3.7228}:  33%|███▎      | 10/30 [00:27<00:55,  2.76s/it]{'epoch': 12, 'num_users': 6.6364, 'loss': 0.0448, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 3.679}:  33%|███▎      | 10/30 [00:29<00:55,  2.76s/it]{'epoch': 12, 'num_users': 6.6364, 'loss': 0.0448, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 3.679}:  37%|███▋      | 11/30 [00:29<00:45,  2.42s/it]{'epoch': 12, 'num_users': 6.4167, 'loss': 0.0417, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 3.655}:  37%|███▋      | 11/30 [00:32<00:45,  2.42s/it]{'epoch': 12, 'num_users': 6.4167, 'loss': 0.0417, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 3.655}:  40%|████      | 12/30 [00:32<00:49,  2.73s/it]{'epoch': 12, 'num_users': 6.6154, 'loss': 0.0423, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.8727, 'compress@10': 1.0, 'time@10': 3.6063}:  40%|████      | 12/30 [00:34<00:49,  2.73s/it]{'epoch': 12, 'num_users': 6.6154, 'loss': 0.0423, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.8727, 'compress@10': 1.0, 'time@10': 3.6063}:  43%|████▎     | 13/30 [00:34<00:40,  2.37s/it]{'epoch': 12, 'num_users': 6.3571, 'loss': 0.0394, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.869, 'compress@10': 1.0, 'time@10': 3.56}:  43%|████▎     | 13/30 [00:37<00:40,  2.37s/it]   {'epoch': 12, 'num_users': 6.3571, 'loss': 0.0394, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.869, 'compress@10': 1.0, 'time@10': 3.56}:  47%|████▋     | 14/30 [00:37<00:40,  2.56s/it]{'epoch': 12, 'num_users': 6.2667, 'loss': 0.0406, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8674, 'compress@10': 1.0, 'time@10': 3.5679}:  47%|████▋     | 14/30 [00:38<00:40,  2.56s/it]{'epoch': 12, 'num_users': 6.2667, 'loss': 0.0406, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8674, 'compress@10': 1.0, 'time@10': 3.5679}:  50%|█████     | 15/30 [00:38<00:35,  2.35s/it]{'epoch': 12, 'num_users': 6.0625, 'loss': 0.0384, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8695, 'compress@10': 1.0, 'time@10': 3.5562}:  50%|█████     | 15/30 [00:42<00:35,  2.35s/it]{'epoch': 12, 'num_users': 6.0625, 'loss': 0.0384, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8695, 'compress@10': 1.0, 'time@10': 3.5562}:  53%|█████▎    | 16/30 [00:42<00:37,  2.67s/it]{'epoch': 12, 'num_users': 5.8235, 'loss': 0.0364, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 3.5311}:  53%|█████▎    | 16/30 [00:43<00:37,  2.67s/it]{'epoch': 12, 'num_users': 5.8235, 'loss': 0.0364, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 3.5311}:  57%|█████▋    | 17/30 [00:43<00:30,  2.35s/it]{'epoch': 12, 'num_users': 6.0556, 'loss': 0.0366, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 3.5134}:  57%|█████▋    | 17/30 [00:47<00:30,  2.35s/it]{'epoch': 12, 'num_users': 6.0556, 'loss': 0.0366, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 3.5134}:  60%|██████    | 18/30 [00:47<00:31,  2.62s/it]{'epoch': 12, 'num_users': 6.0, 'loss': 0.0354, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8665, 'compress@10': 1.0, 'time@10': 3.5185}:  60%|██████    | 18/30 [00:49<00:31,  2.62s/it]   {'epoch': 12, 'num_users': 6.0, 'loss': 0.0354, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8665, 'compress@10': 1.0, 'time@10': 3.5185}:  63%|██████▎   | 19/30 [00:49<00:26,  2.39s/it]{'epoch': 12, 'num_users': 6.15, 'loss': 0.0364, 'hit_ratio@10': 0.8174, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 3.5202}:  63%|██████▎   | 19/30 [00:52<00:26,  2.39s/it]{'epoch': 12, 'num_users': 6.15, 'loss': 0.0364, 'hit_ratio@10': 0.8174, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 3.5202}:  67%|██████▋   | 20/30 [00:52<00:27,  2.75s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.038, 'hit_ratio@10': 0.8165, 'ndcg@10': 0.8623, 'compress@10': 1.0, 'time@10': 3.6635}:  67%|██████▋   | 20/30 [00:55<00:27,  2.75s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.038, 'hit_ratio@10': 0.8165, 'ndcg@10': 0.8623, 'compress@10': 1.0, 'time@10': 3.6635}:  70%|███████   | 21/30 [00:55<00:26,  2.91s/it]{'epoch': 12, 'num_users': 6.1818, 'loss': 0.0373, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 3.6446}:  70%|███████   | 21/30 [00:59<00:26,  2.91s/it]{'epoch': 12, 'num_users': 6.1818, 'loss': 0.0373, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 3.6446}:  73%|███████▎  | 22/30 [00:59<00:24,  3.02s/it]{'epoch': 12, 'num_users': 6.1304, 'loss': 0.0368, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8669, 'compress@10': 1.0, 'time@10': 3.6308}:  73%|███████▎  | 22/30 [01:00<00:24,  3.02s/it] {'epoch': 12, 'num_users': 6.1304, 'loss': 0.0368, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8669, 'compress@10': 1.0, 'time@10': 3.6308}:  77%|███████▋  | 23/30 [01:00<00:18,  2.63s/it]{'epoch': 12, 'num_users': 5.9583, 'loss': 0.0353, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8641, 'compress@10': 1.0, 'time@10': 3.5759}:  77%|███████▋  | 23/30 [01:03<00:18,  2.63s/it]{'epoch': 12, 'num_users': 5.9583, 'loss': 0.0353, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8641, 'compress@10': 1.0, 'time@10': 3.5759}:  80%|████████  | 24/30 [01:03<00:15,  2.54s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.034, 'hit_ratio@10': 0.8149, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 3.5239}:  80%|████████  | 24/30 [01:04<00:15,  2.54s/it]    {'epoch': 12, 'num_users': 5.8, 'loss': 0.034, 'hit_ratio@10': 0.8149, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 3.5239}:  83%|████████▎ | 25/30 [01:04<00:10,  2.13s/it]{'epoch': 12, 'num_users': 5.8077, 'loss': 0.0349, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 3.621}:  83%|████████▎ | 25/30 [01:10<00:10,  2.13s/it]{'epoch': 12, 'num_users': 5.8077, 'loss': 0.0349, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 3.621}:  87%|████████▋ | 26/30 [01:10<00:13,  3.32s/it]{'epoch': 12, 'num_users': 5.8889, 'loss': 0.0348, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8568, 'compress@10': 1.0, 'time@10': 3.6179}:  87%|████████▋ | 26/30 [01:12<00:13,  3.32s/it]{'epoch': 12, 'num_users': 5.8889, 'loss': 0.0348, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8568, 'compress@10': 1.0, 'time@10': 3.6179}:  90%|█████████ | 27/30 [01:12<00:08,  2.86s/it]{'epoch': 12, 'num_users': 6.0, 'loss': 0.0352, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 3.62}:  90%|█████████ | 27/30 [01:16<00:08,  2.86s/it]     {'epoch': 12, 'num_users': 6.0, 'loss': 0.0352, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 3.62}:  93%|█████████▎| 28/30 [01:16<00:06,  3.12s/it]{'epoch': 12, 'num_users': 5.8621, 'loss': 0.0349, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8596, 'compress@10': 1.0, 'time@10': 3.6021}:  93%|█████████▎| 28/30 [01:17<00:06,  3.12s/it]{'epoch': 12, 'num_users': 5.8621, 'loss': 0.0349, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8596, 'compress@10': 1.0, 'time@10': 3.6021}:  97%|█████████▋| 29/30 [01:17<00:02,  2.66s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0352, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 3.5965}:  97%|█████████▋| 29/30 [01:21<00:02,  2.66s/it] {'epoch': 12, 'num_users': 5.8667, 'loss': 0.0352, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 3.5965}: 100%|██████████| 30/30 [01:21<00:00,  2.90s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0352, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 3.5965}: 100%|██████████| 30/30 [01:21<00:00,  2.70s/it]
Epoch: 12
Avg # of users: 5.866666666666666
Avg Loss: 0.035217743347778836
Avg hit ratio: 0.828962916279064
Avg ndcg: 0.8624576419293547
Avg compression ratio: 0.9999999860153537
Avg train time: 3.596461613972982
Std train time: 1.052312221359279
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 34, 14, 1, 9, 8, 12, 7, 9, 8, 35, 9, 68, 6, 36, 49, 15, 16, 7, 1, 20, 10, 79, 78, 1, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 3.7779}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 3.7779}:   3%|▎         | 1/30 [00:01<00:55,  1.93s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 3.6645}:   3%|▎         | 1/30 [00:05<00:55,  1.93s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 3.6645}:   7%|▋         | 2/30 [00:05<01:21,  2.91s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.6856, 'ndcg@10': 0.8616, 'compress@10': 1.0, 'time@10': 3.6315}:   7%|▋         | 2/30 [00:07<01:21,  2.91s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.6856, 'ndcg@10': 0.8616, 'compress@10': 1.0, 'time@10': 3.6315}:  10%|█         | 3/30 [00:07<01:05,  2.41s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.7553, 'ndcg@10': 0.8603, 'compress@10': 1.0, 'time@10': 3.5461}:  10%|█         | 3/30 [00:10<01:05,  2.41s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.7553, 'ndcg@10': 0.8603, 'compress@10': 1.0, 'time@10': 3.5461}:  13%|█▎        | 4/30 [00:10<01:12,  2.77s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.067, 'hit_ratio@10': 0.7267, 'ndcg@10': 0.8043, 'compress@10': 1.0, 'time@10': 3.0202}:  13%|█▎        | 4/30 [00:11<01:12,  2.77s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.067, 'hit_ratio@10': 0.7267, 'ndcg@10': 0.8043, 'compress@10': 1.0, 'time@10': 3.0202}:  17%|█▋        | 5/30 [00:11<00:48,  1.95s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0653, 'hit_ratio@10': 0.7463, 'ndcg@10': 0.8099, 'compress@10': 1.0, 'time@10': 3.1047}:  17%|█▋        | 5/30 [00:14<00:48,  1.95s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0653, 'hit_ratio@10': 0.7463, 'ndcg@10': 0.8099, 'compress@10': 1.0, 'time@10': 3.1047}:  20%|██        | 6/30 [00:14<01:00,  2.50s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0621, 'hit_ratio@10': 0.7768, 'ndcg@10': 0.8206, 'compress@10': 1.0, 'time@10': 3.1486}:  20%|██        | 6/30 [00:16<01:00,  2.50s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0621, 'hit_ratio@10': 0.7768, 'ndcg@10': 0.8206, 'compress@10': 1.0, 'time@10': 3.1486}:  23%|██▎       | 7/30 [00:16<00:51,  2.25s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0609, 'hit_ratio@10': 0.7976, 'ndcg@10': 0.828, 'compress@10': 1.0, 'time@10': 3.2086}:  23%|██▎       | 7/30 [00:20<00:51,  2.25s/it]  {'epoch': 13, 'num_users': 6.125, 'loss': 0.0609, 'hit_ratio@10': 0.7976, 'ndcg@10': 0.828, 'compress@10': 1.0, 'time@10': 3.2086}:  27%|██▋       | 8/30 [00:20<00:59,  2.70s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0586, 'hit_ratio@10': 0.7883, 'ndcg@10': 0.8377, 'compress@10': 1.0, 'time@10': 3.3397}:  27%|██▋       | 8/30 [00:22<00:59,  2.70s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0586, 'hit_ratio@10': 0.7883, 'ndcg@10': 0.8377, 'compress@10': 1.0, 'time@10': 3.3397}:  30%|███       | 9/30 [00:22<00:53,  2.56s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0568, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8423, 'compress@10': 1.0, 'time@10': 3.3517}:  30%|███       | 9/30 [00:25<00:53,  2.56s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0568, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8423, 'compress@10': 1.0, 'time@10': 3.3517}:  33%|███▎      | 10/30 [00:25<00:56,  2.85s/it]{'epoch': 13, 'num_users': 6.6364, 'loss': 0.0569, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8441, 'compress@10': 1.0, 'time@10': 3.3912}:  33%|███▎      | 10/30 [00:27<00:56,  2.85s/it]{'epoch': 13, 'num_users': 6.6364, 'loss': 0.0569, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8441, 'compress@10': 1.0, 'time@10': 3.3912}:  37%|███▋      | 11/30 [00:27<00:48,  2.57s/it]{'epoch': 13, 'num_users': 6.4167, 'loss': 0.0527, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8496, 'compress@10': 1.0, 'time@10': 3.3918}:  37%|███▋      | 11/30 [00:31<00:48,  2.57s/it]{'epoch': 13, 'num_users': 6.4167, 'loss': 0.0527, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8496, 'compress@10': 1.0, 'time@10': 3.3918}:  40%|████      | 12/30 [00:31<00:51,  2.84s/it]{'epoch': 13, 'num_users': 6.6154, 'loss': 0.0525, 'hit_ratio@10': 0.799, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 3.397}:  40%|████      | 12/30 [00:33<00:51,  2.84s/it]  {'epoch': 13, 'num_users': 6.6154, 'loss': 0.0525, 'hit_ratio@10': 0.799, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 3.397}:  43%|████▎     | 13/30 [00:33<00:42,  2.51s/it]{'epoch': 13, 'num_users': 6.3571, 'loss': 0.0489, 'hit_ratio@10': 0.8015, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 3.3474}:  43%|████▎     | 13/30 [00:35<00:42,  2.51s/it]{'epoch': 13, 'num_users': 6.3571, 'loss': 0.0489, 'hit_ratio@10': 0.8015, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 3.3474}:  47%|████▋     | 14/30 [00:35<00:41,  2.58s/it]{'epoch': 13, 'num_users': 6.2667, 'loss': 0.0494, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 3.339}:  47%|████▋     | 14/30 [00:37<00:41,  2.58s/it] {'epoch': 13, 'num_users': 6.2667, 'loss': 0.0494, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 3.339}:  50%|█████     | 15/30 [00:37<00:34,  2.30s/it]{'epoch': 13, 'num_users': 6.0625, 'loss': 0.0466, 'hit_ratio@10': 0.8066, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 3.3453}:  50%|█████     | 15/30 [00:40<00:34,  2.30s/it]{'epoch': 13, 'num_users': 6.0625, 'loss': 0.0466, 'hit_ratio@10': 0.8066, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 3.3453}:  53%|█████▎    | 16/30 [00:40<00:37,  2.65s/it]{'epoch': 13, 'num_users': 5.8235, 'loss': 0.044, 'hit_ratio@10': 0.7945, 'ndcg@10': 0.8486, 'compress@10': 1.0, 'time@10': 3.3511}:  53%|█████▎    | 16/30 [00:42<00:37,  2.65s/it] {'epoch': 13, 'num_users': 5.8235, 'loss': 0.044, 'hit_ratio@10': 0.7945, 'ndcg@10': 0.8486, 'compress@10': 1.0, 'time@10': 3.3511}:  57%|█████▋    | 17/30 [00:42<00:31,  2.38s/it]{'epoch': 13, 'num_users': 6.0556, 'loss': 0.0437, 'hit_ratio@10': 0.792, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 3.3725}:  57%|█████▋    | 17/30 [00:46<00:31,  2.38s/it]{'epoch': 13, 'num_users': 6.0556, 'loss': 0.0437, 'hit_ratio@10': 0.792, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 3.3725}:  60%|██████    | 18/30 [00:46<00:33,  2.80s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 0.0421, 'hit_ratio@10': 0.7992, 'ndcg@10': 0.8534, 'compress@10': 1.0, 'time@10': 3.3959}:  60%|██████    | 18/30 [00:48<00:33,  2.80s/it]  {'epoch': 13, 'num_users': 6.0, 'loss': 0.0421, 'hit_ratio@10': 0.7992, 'ndcg@10': 0.8534, 'compress@10': 1.0, 'time@10': 3.3959}:  63%|██████▎   | 19/30 [00:48<00:27,  2.54s/it]{'epoch': 13, 'num_users': 6.15, 'loss': 0.0427, 'hit_ratio@10': 0.8031, 'ndcg@10': 0.8522, 'compress@10': 1.0, 'time@10': 3.4063}:  63%|██████▎   | 19/30 [00:52<00:27,  2.54s/it]{'epoch': 13, 'num_users': 6.15, 'loss': 0.0427, 'hit_ratio@10': 0.8031, 'ndcg@10': 0.8522, 'compress@10': 1.0, 'time@10': 3.4063}:  67%|██████▋   | 20/30 [00:52<00:28,  2.87s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.7929, 'ndcg@10': 0.8413, 'compress@10': 1.0, 'time@10': 3.2779}:  67%|██████▋   | 20/30 [00:52<00:28,  2.87s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.7929, 'ndcg@10': 0.8413, 'compress@10': 1.0, 'time@10': 3.2779}:  70%|███████   | 21/30 [00:52<00:19,  2.13s/it]{'epoch': 13, 'num_users': 6.1818, 'loss': 0.0489, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8447, 'compress@10': 1.0, 'time@10': 3.2856}:  70%|███████   | 21/30 [00:55<00:19,  2.13s/it]{'epoch': 13, 'num_users': 6.1818, 'loss': 0.0489, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8447, 'compress@10': 1.0, 'time@10': 3.2856}:  73%|███████▎  | 22/30 [00:55<00:20,  2.54s/it]{'epoch': 13, 'num_users': 6.1304, 'loss': 0.0478, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.847, 'compress@10': 1.0, 'time@10': 3.2919}:  73%|███████▎  | 22/30 [00:57<00:20,  2.54s/it] {'epoch': 13, 'num_users': 6.1304, 'loss': 0.0478, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.847, 'compress@10': 1.0, 'time@10': 3.2919}:  77%|███████▋  | 23/30 [00:57<00:16,  2.30s/it]{'epoch': 13, 'num_users': 5.9583, 'loss': 0.0459, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.845, 'compress@10': 1.0, 'time@10': 3.2695}:  77%|███████▋  | 23/30 [01:00<00:16,  2.30s/it]{'epoch': 13, 'num_users': 5.9583, 'loss': 0.0459, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.845, 'compress@10': 1.0, 'time@10': 3.2695}:  80%|████████  | 24/30 [01:00<00:14,  2.45s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0441, 'hit_ratio@10': 0.7951, 'ndcg@10': 0.8379, 'compress@10': 1.0, 'time@10': 3.2473}:  80%|████████  | 24/30 [01:01<00:14,  2.45s/it]  {'epoch': 13, 'num_users': 5.8, 'loss': 0.0441, 'hit_ratio@10': 0.7951, 'ndcg@10': 0.8379, 'compress@10': 1.0, 'time@10': 3.2473}:  83%|████████▎ | 25/30 [01:01<00:10,  2.13s/it]{'epoch': 13, 'num_users': 5.8077, 'loss': 0.049, 'hit_ratio@10': 0.7868, 'ndcg@10': 0.8293, 'compress@10': 1.0, 'time@10': 3.1491}:  83%|████████▎ | 25/30 [01:02<00:10,  2.13s/it]{'epoch': 13, 'num_users': 5.8077, 'loss': 0.049, 'hit_ratio@10': 0.7868, 'ndcg@10': 0.8293, 'compress@10': 1.0, 'time@10': 3.1491}:  87%|████████▋ | 26/30 [01:02<00:06,  1.71s/it]{'epoch': 13, 'num_users': 5.8889, 'loss': 0.0484, 'hit_ratio@10': 0.7934, 'ndcg@10': 0.8313, 'compress@10': 1.0, 'time@10': 3.1604}:  87%|████████▋ | 26/30 [01:04<00:06,  1.71s/it]{'epoch': 13, 'num_users': 5.8889, 'loss': 0.0484, 'hit_ratio@10': 0.7934, 'ndcg@10': 0.8313, 'compress@10': 1.0, 'time@10': 3.1604}:  90%|█████████ | 27/30 [01:04<00:05,  1.73s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 0.0483, 'hit_ratio@10': 0.798, 'ndcg@10': 0.833, 'compress@10': 1.0, 'time@10': 3.165}:  90%|█████████ | 27/30 [01:07<00:05,  1.73s/it]      {'epoch': 13, 'num_users': 6.0, 'loss': 0.0483, 'hit_ratio@10': 0.798, 'ndcg@10': 0.833, 'compress@10': 1.0, 'time@10': 3.165}:  93%|█████████▎| 28/30 [01:07<00:04,  2.21s/it]{'epoch': 13, 'num_users': 5.8621, 'loss': 0.0475, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8353, 'compress@10': 1.0, 'time@10': 3.177}:  93%|█████████▎| 28/30 [01:09<00:04,  2.21s/it]{'epoch': 13, 'num_users': 5.8621, 'loss': 0.0475, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8353, 'compress@10': 1.0, 'time@10': 3.177}:  97%|█████████▋| 29/30 [01:09<00:02,  2.08s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0473, 'hit_ratio@10': 0.803, 'ndcg@10': 0.8385, 'compress@10': 1.0, 'time@10': 3.1784}:  97%|█████████▋| 29/30 [01:12<00:02,  2.08s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0473, 'hit_ratio@10': 0.803, 'ndcg@10': 0.8385, 'compress@10': 1.0, 'time@10': 3.1784}: 100%|██████████| 30/30 [01:12<00:00,  2.44s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0473, 'hit_ratio@10': 0.803, 'ndcg@10': 0.8385, 'compress@10': 1.0, 'time@10': 3.1784}: 100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch: 13
Avg # of users: 5.866666666666666
Avg Loss: 0.04731912389340786
Avg hit ratio: 0.8030175426549934
Avg ndcg: 0.8385347054840239
Avg compression ratio: 0.9999999860166272
Avg train time: 3.178408153851827
Std train time: 0.8652829434055486
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 34, 14, 8, 9, 8, 11, 4, 9, 7, 35, 9, 70, 7, 36, 49, 14, 15, 7, 9, 20, 10, 81, 80, 9, 7, 7, 10, 12]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.9829}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.9829}:   3%|▎         | 1/30 [00:01<00:44,  1.53s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0392, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 3.0486}:   3%|▎         | 1/30 [00:04<00:44,  1.53s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0392, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 3.0486}:   7%|▋         | 2/30 [00:04<01:09,  2.49s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.7071, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 3.1589}:   7%|▋         | 2/30 [00:06<01:09,  2.49s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.7071, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 3.1589}:  10%|█         | 3/30 [00:06<00:57,  2.14s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7714, 'ndcg@10': 0.9125, 'compress@10': 1.0, 'time@10': 3.2101}:  10%|█         | 3/30 [00:09<00:57,  2.14s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7714, 'ndcg@10': 0.9125, 'compress@10': 1.0, 'time@10': 3.2101}:  13%|█▎        | 4/30 [00:09<01:08,  2.64s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.042, 'hit_ratio@10': 0.7851, 'ndcg@10': 0.887, 'compress@10': 1.0, 'time@10': 4.0052}:  13%|█▎        | 4/30 [00:13<01:08,  2.64s/it]  {'epoch': 14, 'num_users': 5.8, 'loss': 0.042, 'hit_ratio@10': 0.7851, 'ndcg@10': 0.887, 'compress@10': 1.0, 'time@10': 4.0052}:  17%|█▋        | 5/30 [00:13<01:15,  3.02s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0441, 'hit_ratio@10': 0.795, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 3.9498}:  17%|█▋        | 5/30 [00:17<01:15,  3.02s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0441, 'hit_ratio@10': 0.795, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 3.9498}:  20%|██        | 6/30 [00:17<01:18,  3.25s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0439, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8802, 'compress@10': 1.0, 'time@10': 3.8682}:  20%|██        | 6/30 [00:18<01:18,  3.25s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0439, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8802, 'compress@10': 1.0, 'time@10': 3.8682}:  23%|██▎       | 7/30 [00:18<01:03,  2.75s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0444, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8891, 'compress@10': 1.0, 'time@10': 3.8002}:  23%|██▎       | 7/30 [00:22<01:03,  2.75s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0444, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8891, 'compress@10': 1.0, 'time@10': 3.8002}:  27%|██▋       | 8/30 [00:22<01:04,  2.95s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0439, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 3.6463}:  27%|██▋       | 8/30 [00:23<01:04,  2.95s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0439, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 3.6463}:  30%|███       | 9/30 [00:23<00:50,  2.42s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0425, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 3.6277}:  30%|███       | 9/30 [00:27<00:50,  2.42s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0425, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 3.6277}:  33%|███▎      | 10/30 [00:27<00:55,  2.75s/it]{'epoch': 14, 'num_users': 6.6364, 'loss': 0.0438, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8875, 'compress@10': 1.0, 'time@10': 3.5977}:  33%|███▎      | 10/30 [00:28<00:55,  2.75s/it]{'epoch': 14, 'num_users': 6.6364, 'loss': 0.0438, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8875, 'compress@10': 1.0, 'time@10': 3.5977}:  37%|███▋      | 11/30 [00:28<00:46,  2.42s/it]{'epoch': 14, 'num_users': 6.4167, 'loss': 0.0407, 'hit_ratio@10': 0.8087, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 3.5548}:  37%|███▋      | 11/30 [00:31<00:46,  2.42s/it]  {'epoch': 14, 'num_users': 6.4167, 'loss': 0.0407, 'hit_ratio@10': 0.8087, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 3.5548}:  40%|████      | 12/30 [00:31<00:47,  2.64s/it]{'epoch': 14, 'num_users': 6.6154, 'loss': 0.0413, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.8883, 'compress@10': 1.0, 'time@10': 3.52}:  40%|████      | 12/30 [00:33<00:47,  2.64s/it]{'epoch': 14, 'num_users': 6.6154, 'loss': 0.0413, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.8883, 'compress@10': 1.0, 'time@10': 3.52}:  43%|████▎     | 13/30 [00:33<00:39,  2.32s/it]{'epoch': 14, 'num_users': 6.3571, 'loss': 0.0384, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8843, 'compress@10': 1.0, 'time@10': 3.4935}:  43%|████▎     | 13/30 [00:36<00:39,  2.32s/it]{'epoch': 14, 'num_users': 6.3571, 'loss': 0.0384, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8843, 'compress@10': 1.0, 'time@10': 3.4935}:  47%|████▋     | 14/30 [00:36<00:41,  2.58s/it]{'epoch': 14, 'num_users': 6.2667, 'loss': 0.0396, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 3.4993}:  47%|████▋     | 14/30 [00:38<00:41,  2.58s/it]{'epoch': 14, 'num_users': 6.2667, 'loss': 0.0396, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 3.4993}:  50%|█████     | 15/30 [00:38<00:35,  2.35s/it]{'epoch': 14, 'num_users': 6.0625, 'loss': 0.0374, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 3.4905}:  50%|█████     | 15/30 [00:41<00:35,  2.35s/it]{'epoch': 14, 'num_users': 6.0625, 'loss': 0.0374, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 3.4905}:  53%|█████▎    | 16/30 [00:41<00:37,  2.67s/it]{'epoch': 14, 'num_users': 5.8235, 'loss': 0.0353, 'hit_ratio@10': 0.807, 'ndcg@10': 0.8766, 'compress@10': 1.0, 'time@10': 3.4832}:  53%|█████▎    | 16/30 [00:43<00:37,  2.67s/it] {'epoch': 14, 'num_users': 5.8235, 'loss': 0.0353, 'hit_ratio@10': 0.807, 'ndcg@10': 0.8766, 'compress@10': 1.0, 'time@10': 3.4832}:  57%|█████▋    | 17/30 [00:43<00:30,  2.38s/it]{'epoch': 14, 'num_users': 6.0556, 'loss': 0.0355, 'hit_ratio@10': 0.8038, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.4861}:  57%|█████▋    | 17/30 [00:47<00:30,  2.38s/it]{'epoch': 14, 'num_users': 6.0556, 'loss': 0.0355, 'hit_ratio@10': 0.8038, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.4861}:  60%|██████    | 18/30 [00:47<00:32,  2.74s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 0.0343, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.8782, 'compress@10': 1.0, 'time@10': 3.4852}:  60%|██████    | 18/30 [00:48<00:32,  2.74s/it]   {'epoch': 14, 'num_users': 6.0, 'loss': 0.0343, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.8782, 'compress@10': 1.0, 'time@10': 3.4852}:  63%|██████▎   | 19/30 [00:48<00:26,  2.45s/it]{'epoch': 14, 'num_users': 6.15, 'loss': 0.0352, 'hit_ratio@10': 0.8137, 'ndcg@10': 0.8761, 'compress@10': 1.0, 'time@10': 3.4948}:  63%|██████▎   | 19/30 [00:52<00:26,  2.45s/it]{'epoch': 14, 'num_users': 6.15, 'loss': 0.0352, 'hit_ratio@10': 0.8137, 'ndcg@10': 0.8761, 'compress@10': 1.0, 'time@10': 3.4948}:  67%|██████▋   | 20/30 [00:52<00:28,  2.83s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0369, 'hit_ratio@10': 0.8131, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 3.6324}:  67%|██████▋   | 20/30 [00:55<00:28,  2.83s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0369, 'hit_ratio@10': 0.8131, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 3.6324}:  70%|███████   | 21/30 [00:55<00:26,  2.95s/it]{'epoch': 14, 'num_users': 6.1818, 'loss': 0.0361, 'hit_ratio@10': 0.8174, 'ndcg@10': 0.8764, 'compress@10': 1.0, 'time@10': 3.6338}:  70%|███████   | 21/30 [00:59<00:26,  2.95s/it]{'epoch': 14, 'num_users': 6.1818, 'loss': 0.0361, 'hit_ratio@10': 0.8174, 'ndcg@10': 0.8764, 'compress@10': 1.0, 'time@10': 3.6338}:  73%|███████▎  | 22/30 [00:59<00:25,  3.18s/it]{'epoch': 14, 'num_users': 6.1304, 'loss': 0.0356, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8774, 'compress@10': 1.0, 'time@10': 3.6296}:  73%|███████▎  | 22/30 [01:01<00:25,  3.18s/it] {'epoch': 14, 'num_users': 6.1304, 'loss': 0.0356, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8774, 'compress@10': 1.0, 'time@10': 3.6296}:  77%|███████▋  | 23/30 [01:01<00:19,  2.76s/it]{'epoch': 14, 'num_users': 5.9583, 'loss': 0.0341, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 3.5965}:  77%|███████▋  | 23/30 [01:04<00:19,  2.76s/it]{'epoch': 14, 'num_users': 5.9583, 'loss': 0.0341, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 3.5965}:  80%|████████  | 24/30 [01:04<00:16,  2.80s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0328, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 3.5665}:  80%|████████  | 24/30 [01:05<00:16,  2.80s/it]    {'epoch': 14, 'num_users': 5.8, 'loss': 0.0328, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 3.5665}:  83%|████████▎ | 25/30 [01:05<00:11,  2.40s/it]{'epoch': 14, 'num_users': 5.8077, 'loss': 0.0336, 'hit_ratio@10': 0.8174, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 3.6799}:  83%|████████▎ | 25/30 [01:12<00:11,  2.40s/it]{'epoch': 14, 'num_users': 5.8077, 'loss': 0.0336, 'hit_ratio@10': 0.8174, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 3.6799}:  87%|████████▋ | 26/30 [01:12<00:14,  3.64s/it]{'epoch': 14, 'num_users': 5.8889, 'loss': 0.0335, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8661, 'compress@10': 1.0, 'time@10': 3.6735}:  87%|████████▋ | 26/30 [01:14<00:14,  3.64s/it]{'epoch': 14, 'num_users': 5.8889, 'loss': 0.0335, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8661, 'compress@10': 1.0, 'time@10': 3.6735}:  90%|█████████ | 27/30 [01:14<00:09,  3.09s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 0.0339, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 3.6551}:  90%|█████████ | 27/30 [01:17<00:09,  3.09s/it]   {'epoch': 14, 'num_users': 6.0, 'loss': 0.0339, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 3.6551}:  93%|█████████▎| 28/30 [01:17<00:06,  3.12s/it]{'epoch': 14, 'num_users': 5.8621, 'loss': 0.0337, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8681, 'compress@10': 1.0, 'time@10': 3.6597}:  93%|█████████▎| 28/30 [01:19<00:06,  3.12s/it]{'epoch': 14, 'num_users': 5.8621, 'loss': 0.0337, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8681, 'compress@10': 1.0, 'time@10': 3.6597}:  97%|█████████▋| 29/30 [01:19<00:02,  2.76s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.0343, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.6692}:  97%|█████████▋| 29/30 [01:23<00:02,  2.76s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.0343, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.6692}: 100%|██████████| 30/30 [01:23<00:00,  3.13s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.0343, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.6692}: 100%|██████████| 30/30 [01:23<00:00,  2.77s/it]
Epoch: 14
Avg # of users: 5.866666666666666
Avg Loss: 0.034267731438903826
Avg hit ratio: 0.8295199778133552
Avg ndcg: 0.8723187914790338
Avg compression ratio: 0.9999999860153537
Avg train time: 3.669210688273112
Std train time: 1.0598747436837952
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 14, 34, 14, 1, 8, 8, 11, 7, 9, 7, 36, 10, 71, 7, 36, 49, 14, 15, 6, 1, 19, 10, 83, 82, 1, 7, 8, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0548, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8249, 'compress@10': 1.0, 'time@10': 3.4457}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0548, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8249, 'compress@10': 1.0, 'time@10': 3.4457}:   3%|▎         | 1/30 [00:01<00:51,  1.76s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0552, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8448, 'compress@10': 1.0, 'time@10': 3.4614}:   3%|▎         | 1/30 [00:05<00:51,  1.76s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0552, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8448, 'compress@10': 1.0, 'time@10': 3.4614}:   7%|▋         | 2/30 [00:05<01:18,  2.79s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0368, 'hit_ratio@10': 0.7071, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 3.3418}:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0368, 'hit_ratio@10': 0.7071, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 3.3418}:  10%|█         | 3/30 [00:06<01:00,  2.25s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0357, 'hit_ratio@10': 0.7714, 'ndcg@10': 0.8689, 'compress@10': 1.0, 'time@10': 3.2655}:  10%|█         | 3/30 [00:09<01:00,  2.25s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0357, 'hit_ratio@10': 0.7714, 'ndcg@10': 0.8689, 'compress@10': 1.0, 'time@10': 3.2655}:  13%|█▎        | 4/30 [00:09<01:06,  2.57s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0702, 'hit_ratio@10': 0.7477, 'ndcg@10': 0.8109, 'compress@10': 1.0, 'time@10': 2.7724}:  13%|█▎        | 4/30 [00:10<01:06,  2.57s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0702, 'hit_ratio@10': 0.7477, 'ndcg@10': 0.8109, 'compress@10': 1.0, 'time@10': 2.7724}:  17%|█▋        | 5/30 [00:10<00:45,  1.80s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0675, 'hit_ratio@10': 0.7675, 'ndcg@10': 0.817, 'compress@10': 1.0, 'time@10': 2.8381}:  17%|█▋        | 5/30 [00:13<00:45,  1.80s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0675, 'hit_ratio@10': 0.7675, 'ndcg@10': 0.817, 'compress@10': 1.0, 'time@10': 2.8381}:  20%|██        | 6/30 [00:13<00:54,  2.28s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0642, 'hit_ratio@10': 0.795, 'ndcg@10': 0.8245, 'compress@10': 1.0, 'time@10': 2.9121}:  20%|██        | 6/30 [00:15<00:54,  2.28s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0642, 'hit_ratio@10': 0.795, 'ndcg@10': 0.8245, 'compress@10': 1.0, 'time@10': 2.9121}:  23%|██▎       | 7/30 [00:15<00:48,  2.10s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0605, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.8241, 'compress@10': 1.0, 'time@10': 2.9346}:  23%|██▎       | 7/30 [00:18<00:48,  2.10s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0605, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.8241, 'compress@10': 1.0, 'time@10': 2.9346}:  27%|██▋       | 8/30 [00:18<00:53,  2.43s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0588, 'hit_ratio@10': 0.8057, 'ndcg@10': 0.8373, 'compress@10': 1.0, 'time@10': 3.0509}:  27%|██▋       | 8/30 [00:20<00:53,  2.43s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0588, 'hit_ratio@10': 0.8057, 'ndcg@10': 0.8373, 'compress@10': 1.0, 'time@10': 3.0509}:  30%|███       | 9/30 [00:20<00:48,  2.31s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0572, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.843, 'compress@10': 1.0, 'time@10': 3.0885}:  30%|███       | 9/30 [00:23<00:48,  2.31s/it]    {'epoch': 15, 'num_users': 6.3, 'loss': 0.0572, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.843, 'compress@10': 1.0, 'time@10': 3.0885}:  33%|███▎      | 10/30 [00:23<00:53,  2.67s/it]{'epoch': 15, 'num_users': 6.6364, 'loss': 0.0572, 'hit_ratio@10': 0.8194, 'ndcg@10': 0.8453, 'compress@10': 1.0, 'time@10': 3.1055}:  33%|███▎      | 10/30 [00:25<00:53,  2.67s/it]{'epoch': 15, 'num_users': 6.6364, 'loss': 0.0572, 'hit_ratio@10': 0.8194, 'ndcg@10': 0.8453, 'compress@10': 1.0, 'time@10': 3.1055}:  37%|███▋      | 11/30 [00:25<00:45,  2.37s/it]{'epoch': 15, 'num_users': 6.4167, 'loss': 0.0529, 'hit_ratio@10': 0.7997, 'ndcg@10': 0.8512, 'compress@10': 1.0, 'time@10': 3.1545}:  37%|███▋      | 11/30 [00:29<00:45,  2.37s/it]{'epoch': 15, 'num_users': 6.4167, 'loss': 0.0529, 'hit_ratio@10': 0.7997, 'ndcg@10': 0.8512, 'compress@10': 1.0, 'time@10': 3.1545}:  40%|████      | 12/30 [00:29<00:50,  2.79s/it]{'epoch': 15, 'num_users': 6.6154, 'loss': 0.0529, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8545, 'compress@10': 1.0, 'time@10': 3.2284}:  40%|████      | 12/30 [00:31<00:50,  2.79s/it]{'epoch': 15, 'num_users': 6.6154, 'loss': 0.0529, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8545, 'compress@10': 1.0, 'time@10': 3.2284}:  43%|████▎     | 13/30 [00:31<00:43,  2.58s/it]{'epoch': 15, 'num_users': 6.3571, 'loss': 0.0492, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.853, 'compress@10': 1.0, 'time@10': 3.2224}:  43%|████▎     | 13/30 [00:34<00:43,  2.58s/it] {'epoch': 15, 'num_users': 6.3571, 'loss': 0.0492, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.853, 'compress@10': 1.0, 'time@10': 3.2224}:  47%|████▋     | 14/30 [00:34<00:44,  2.76s/it]{'epoch': 15, 'num_users': 6.2667, 'loss': 0.0495, 'hit_ratio@10': 0.8174, 'ndcg@10': 0.8523, 'compress@10': 1.0, 'time@10': 3.2564}:  47%|████▋     | 14/30 [00:36<00:44,  2.76s/it]{'epoch': 15, 'num_users': 6.2667, 'loss': 0.0495, 'hit_ratio@10': 0.8174, 'ndcg@10': 0.8523, 'compress@10': 1.0, 'time@10': 3.2564}:  50%|█████     | 15/30 [00:36<00:37,  2.50s/it]{'epoch': 15, 'num_users': 6.0625, 'loss': 0.0466, 'hit_ratio@10': 0.8184, 'ndcg@10': 0.8553, 'compress@10': 1.0, 'time@10': 3.2748}:  50%|█████     | 15/30 [00:40<00:37,  2.50s/it]{'epoch': 15, 'num_users': 6.0625, 'loss': 0.0466, 'hit_ratio@10': 0.8184, 'ndcg@10': 0.8553, 'compress@10': 1.0, 'time@10': 3.2748}:  53%|█████▎    | 16/30 [00:40<00:39,  2.83s/it]{'epoch': 15, 'num_users': 5.8235, 'loss': 0.044, 'hit_ratio@10': 0.8056, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 3.2851}:  53%|█████▎    | 16/30 [00:41<00:39,  2.83s/it] {'epoch': 15, 'num_users': 5.8235, 'loss': 0.044, 'hit_ratio@10': 0.8056, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 3.2851}:  57%|█████▋    | 17/30 [00:41<00:32,  2.51s/it]{'epoch': 15, 'num_users': 6.0556, 'loss': 0.0435, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 3.299}:  57%|█████▋    | 17/30 [00:45<00:32,  2.51s/it]{'epoch': 15, 'num_users': 6.0556, 'loss': 0.0435, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 3.299}:  60%|██████    | 18/30 [00:45<00:33,  2.83s/it]{'epoch': 15, 'num_users': 6.0, 'loss': 0.0419, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8548, 'compress@10': 1.0, 'time@10': 3.3161}:  60%|██████    | 18/30 [00:47<00:33,  2.83s/it]   {'epoch': 15, 'num_users': 6.0, 'loss': 0.0419, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8548, 'compress@10': 1.0, 'time@10': 3.3161}:  63%|██████▎   | 19/30 [00:47<00:27,  2.54s/it]{'epoch': 15, 'num_users': 6.15, 'loss': 0.0424, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.8539, 'compress@10': 1.0, 'time@10': 3.306}:  63%|██████▎   | 19/30 [00:50<00:27,  2.54s/it]{'epoch': 15, 'num_users': 6.15, 'loss': 0.0424, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.8539, 'compress@10': 1.0, 'time@10': 3.306}:  67%|██████▋   | 20/30 [00:50<00:27,  2.72s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0499, 'hit_ratio@10': 0.8036, 'ndcg@10': 0.8424, 'compress@10': 1.0, 'time@10': 3.1787}:  67%|██████▋   | 20/30 [00:50<00:27,  2.72s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0499, 'hit_ratio@10': 0.8036, 'ndcg@10': 0.8424, 'compress@10': 1.0, 'time@10': 3.1787}:  70%|███████   | 21/30 [00:50<00:18,  2.01s/it]{'epoch': 15, 'num_users': 6.1818, 'loss': 0.0484, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.8461, 'compress@10': 1.0, 'time@10': 3.1867}:  70%|███████   | 21/30 [00:54<00:18,  2.01s/it]{'epoch': 15, 'num_users': 6.1818, 'loss': 0.0484, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.8461, 'compress@10': 1.0, 'time@10': 3.1867}:  73%|███████▎  | 22/30 [00:54<00:19,  2.43s/it]{'epoch': 15, 'num_users': 6.1304, 'loss': 0.0473, 'hit_ratio@10': 0.8124, 'ndcg@10': 0.8485, 'compress@10': 1.0, 'time@10': 3.1928}:  73%|███████▎  | 22/30 [00:55<00:19,  2.43s/it]{'epoch': 15, 'num_users': 6.1304, 'loss': 0.0473, 'hit_ratio@10': 0.8124, 'ndcg@10': 0.8485, 'compress@10': 1.0, 'time@10': 3.1928}:  77%|███████▋  | 23/30 [00:55<00:15,  2.21s/it]{'epoch': 15, 'num_users': 5.9583, 'loss': 0.0453, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.8465, 'compress@10': 1.0, 'time@10': 3.1796}:  77%|███████▋  | 23/30 [00:58<00:15,  2.21s/it]{'epoch': 15, 'num_users': 5.9583, 'loss': 0.0453, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.8465, 'compress@10': 1.0, 'time@10': 3.1796}:  80%|████████  | 24/30 [00:58<00:14,  2.42s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0436, 'hit_ratio@10': 0.8061, 'ndcg@10': 0.8393, 'compress@10': 1.0, 'time@10': 3.1685}:  80%|████████  | 24/30 [01:00<00:14,  2.42s/it]   {'epoch': 15, 'num_users': 5.8, 'loss': 0.0436, 'hit_ratio@10': 0.8061, 'ndcg@10': 0.8393, 'compress@10': 1.0, 'time@10': 3.1685}:  83%|████████▎ | 25/30 [01:00<00:10,  2.14s/it]{'epoch': 15, 'num_users': 5.8077, 'loss': 0.0483, 'hit_ratio@10': 0.7979, 'ndcg@10': 0.831, 'compress@10': 1.0, 'time@10': 3.0735}:  83%|████████▎ | 25/30 [01:01<00:10,  2.14s/it]{'epoch': 15, 'num_users': 5.8077, 'loss': 0.0483, 'hit_ratio@10': 0.7979, 'ndcg@10': 0.831, 'compress@10': 1.0, 'time@10': 3.0735}:  87%|████████▋ | 26/30 [01:01<00:06,  1.72s/it]{'epoch': 15, 'num_users': 5.8889, 'loss': 0.0476, 'hit_ratio@10': 0.804, 'ndcg@10': 0.8332, 'compress@10': 1.0, 'time@10': 3.085}:  87%|████████▋ | 26/30 [01:02<00:06,  1.72s/it] {'epoch': 15, 'num_users': 5.8889, 'loss': 0.0476, 'hit_ratio@10': 0.804, 'ndcg@10': 0.8332, 'compress@10': 1.0, 'time@10': 3.085}:  90%|█████████ | 27/30 [01:02<00:05,  1.72s/it]{'epoch': 15, 'num_users': 6.0, 'loss': 0.0474, 'hit_ratio@10': 0.8082, 'ndcg@10': 0.8357, 'compress@10': 1.0, 'time@10': 3.1041}:  90%|█████████ | 27/30 [01:06<00:05,  1.72s/it] {'epoch': 15, 'num_users': 6.0, 'loss': 0.0474, 'hit_ratio@10': 0.8082, 'ndcg@10': 0.8357, 'compress@10': 1.0, 'time@10': 3.1041}:  93%|█████████▎| 28/30 [01:06<00:04,  2.30s/it]{'epoch': 15, 'num_users': 5.8621, 'loss': 0.0464, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.8382, 'compress@10': 1.0, 'time@10': 3.1036}:  93%|█████████▎| 28/30 [01:08<00:04,  2.30s/it]{'epoch': 15, 'num_users': 5.8621, 'loss': 0.0464, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.8382, 'compress@10': 1.0, 'time@10': 3.1036}:  97%|█████████▋| 29/30 [01:08<00:02,  2.09s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0459, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 3.1156}:  97%|█████████▋| 29/30 [01:11<00:02,  2.09s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0459, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 3.1156}: 100%|██████████| 30/30 [01:11<00:00,  2.51s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0459, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 3.1156}: 100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch: 15
Avg # of users: 5.866666666666666
Avg Loss: 0.04590136491269738
Avg hit ratio: 0.8134665814092038
Avg ndcg: 0.8407145779892891
Avg compression ratio: 0.9999999860166272
Avg train time: 3.115593600273132
Std train time: 0.8497720347248624
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 14, 35, 15, 9, 9, 8, 12, 5, 9, 7, 35, 8, 72, 6, 36, 49, 14, 14, 7, 9, 19, 10, 85, 84, 9, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8671, 'compress@10': 1.0, 'time@10': 3.8209}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8671, 'compress@10': 1.0, 'time@10': 3.8209}:   3%|▎         | 1/30 [00:01<00:56,  1.95s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.9415, 'compress@10': 1.0, 'time@10': 3.8218}:   3%|▎         | 1/30 [00:05<00:56,  1.95s/it] {'epoch': 16, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.9415, 'compress@10': 1.0, 'time@10': 3.8218}:   7%|▋         | 2/30 [00:05<01:26,  3.07s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.9134, 'compress@10': 1.0, 'time@10': 3.7735}:   7%|▋         | 2/30 [00:07<01:26,  3.07s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.9134, 'compress@10': 1.0, 'time@10': 3.7735}:  10%|█         | 3/30 [00:07<01:08,  2.53s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.7748, 'ndcg@10': 0.916, 'compress@10': 1.0, 'time@10': 3.7438}:  10%|█         | 3/30 [00:11<01:08,  2.53s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.7748, 'ndcg@10': 0.916, 'compress@10': 1.0, 'time@10': 3.7438}:  13%|█▎        | 4/30 [00:11<01:17,  2.99s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0373, 'hit_ratio@10': 0.7839, 'ndcg@10': 0.893, 'compress@10': 1.0, 'time@10': 4.5978}:  13%|█▎        | 4/30 [00:15<01:17,  2.99s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0373, 'hit_ratio@10': 0.7839, 'ndcg@10': 0.893, 'compress@10': 1.0, 'time@10': 4.5978}:  17%|█▋        | 5/30 [00:15<01:24,  3.37s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0393, 'hit_ratio@10': 0.8014, 'ndcg@10': 0.8863, 'compress@10': 1.0, 'time@10': 4.3996}:  17%|█▋        | 5/30 [00:18<01:24,  3.37s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0393, 'hit_ratio@10': 0.8014, 'ndcg@10': 0.8863, 'compress@10': 1.0, 'time@10': 4.3996}:  20%|██        | 6/30 [00:18<01:21,  3.40s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0404, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8838, 'compress@10': 1.0, 'time@10': 4.2637}:  20%|██        | 6/30 [00:20<01:21,  3.40s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0404, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8838, 'compress@10': 1.0, 'time@10': 4.2637}:  23%|██▎       | 7/30 [00:20<01:05,  2.86s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0393, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8797, 'compress@10': 1.0, 'time@10': 4.1907}:  23%|██▎       | 7/30 [00:24<01:05,  2.86s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0393, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8797, 'compress@10': 1.0, 'time@10': 4.1907}:  27%|██▋       | 8/30 [00:24<01:08,  3.13s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.039, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 4.0573}:  27%|██▋       | 8/30 [00:25<01:08,  3.13s/it] {'epoch': 16, 'num_users': 6.3333, 'loss': 0.039, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 4.0573}:  30%|███       | 9/30 [00:25<00:55,  2.63s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.039, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8835, 'compress@10': 1.0, 'time@10': 3.9612}:  30%|███       | 9/30 [00:29<00:55,  2.63s/it]  {'epoch': 16, 'num_users': 6.3, 'loss': 0.039, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8835, 'compress@10': 1.0, 'time@10': 3.9612}:  33%|███▎      | 10/30 [00:29<00:55,  2.79s/it]{'epoch': 16, 'num_users': 6.6364, 'loss': 0.0406, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.882, 'compress@10': 1.0, 'time@10': 3.8788}:  33%|███▎      | 10/30 [00:30<00:55,  2.79s/it]{'epoch': 16, 'num_users': 6.6364, 'loss': 0.0406, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.882, 'compress@10': 1.0, 'time@10': 3.8788}:  37%|███▋      | 11/30 [00:30<00:45,  2.41s/it]{'epoch': 16, 'num_users': 6.4167, 'loss': 0.0376, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 3.8121}:  37%|███▋      | 11/30 [00:33<00:45,  2.41s/it]{'epoch': 16, 'num_users': 6.4167, 'loss': 0.0376, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 3.8121}:  40%|████      | 12/30 [00:33<00:47,  2.63s/it]{'epoch': 16, 'num_users': 6.6154, 'loss': 0.0384, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8838, 'compress@10': 1.0, 'time@10': 3.7576}:  40%|████      | 12/30 [00:35<00:47,  2.63s/it]{'epoch': 16, 'num_users': 6.6154, 'loss': 0.0384, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8838, 'compress@10': 1.0, 'time@10': 3.7576}:  43%|████▎     | 13/30 [00:35<00:39,  2.31s/it]{'epoch': 16, 'num_users': 6.3571, 'loss': 0.0357, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8802, 'compress@10': 1.0, 'time@10': 3.706}:  43%|████▎     | 13/30 [00:38<00:39,  2.31s/it] {'epoch': 16, 'num_users': 6.3571, 'loss': 0.0357, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8802, 'compress@10': 1.0, 'time@10': 3.706}:  47%|████▋     | 14/30 [00:38<00:40,  2.54s/it]{'epoch': 16, 'num_users': 6.2667, 'loss': 0.0369, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8792, 'compress@10': 1.0, 'time@10': 3.6507}:  47%|████▋     | 14/30 [00:39<00:40,  2.54s/it]{'epoch': 16, 'num_users': 6.2667, 'loss': 0.0369, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8792, 'compress@10': 1.0, 'time@10': 3.6507}:  50%|█████     | 15/30 [00:39<00:33,  2.22s/it]{'epoch': 16, 'num_users': 6.0625, 'loss': 0.0348, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8808, 'compress@10': 1.0, 'time@10': 3.6306}:  50%|█████     | 15/30 [00:43<00:33,  2.22s/it]{'epoch': 16, 'num_users': 6.0625, 'loss': 0.0348, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8808, 'compress@10': 1.0, 'time@10': 3.6306}:  53%|█████▎    | 16/30 [00:43<00:35,  2.57s/it]{'epoch': 16, 'num_users': 5.8235, 'loss': 0.0329, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8743, 'compress@10': 1.0, 'time@10': 3.6066}:  53%|█████▎    | 16/30 [00:44<00:35,  2.57s/it]{'epoch': 16, 'num_users': 5.8235, 'loss': 0.0329, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8743, 'compress@10': 1.0, 'time@10': 3.6066}:  57%|█████▋    | 17/30 [00:44<00:29,  2.29s/it]{'epoch': 16, 'num_users': 6.0556, 'loss': 0.0329, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8752, 'compress@10': 1.0, 'time@10': 3.6002}:  57%|█████▋    | 17/30 [00:48<00:29,  2.29s/it]{'epoch': 16, 'num_users': 6.0556, 'loss': 0.0329, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8752, 'compress@10': 1.0, 'time@10': 3.6002}:  60%|██████    | 18/30 [00:48<00:31,  2.66s/it]{'epoch': 16, 'num_users': 6.0, 'loss': 0.0318, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8767, 'compress@10': 1.0, 'time@10': 3.5806}:  60%|██████    | 18/30 [00:50<00:31,  2.66s/it]   {'epoch': 16, 'num_users': 6.0, 'loss': 0.0318, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8767, 'compress@10': 1.0, 'time@10': 3.5806}:  63%|██████▎   | 19/30 [00:50<00:25,  2.36s/it]{'epoch': 16, 'num_users': 6.15, 'loss': 0.0327, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8748, 'compress@10': 1.0, 'time@10': 3.5823}:  63%|██████▎   | 19/30 [00:53<00:25,  2.36s/it]{'epoch': 16, 'num_users': 6.15, 'loss': 0.0327, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8748, 'compress@10': 1.0, 'time@10': 3.5823}:  67%|██████▋   | 20/30 [00:53<00:27,  2.75s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0346, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8722, 'compress@10': 1.0, 'time@10': 3.7207}:  67%|██████▋   | 20/30 [00:56<00:27,  2.75s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0346, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8722, 'compress@10': 1.0, 'time@10': 3.7207}:  70%|███████   | 21/30 [00:56<00:26,  2.91s/it]{'epoch': 16, 'num_users': 6.1818, 'loss': 0.0338, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 3.71}:  70%|███████   | 21/30 [01:00<00:26,  2.91s/it]  {'epoch': 16, 'num_users': 6.1818, 'loss': 0.0338, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 3.71}:  73%|███████▎  | 22/30 [01:00<00:24,  3.09s/it]{'epoch': 16, 'num_users': 6.1304, 'loss': 0.0334, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8756, 'compress@10': 1.0, 'time@10': 3.6975}:  73%|███████▎  | 22/30 [01:02<00:24,  3.09s/it]{'epoch': 16, 'num_users': 6.1304, 'loss': 0.0334, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8756, 'compress@10': 1.0, 'time@10': 3.6975}:  77%|███████▋  | 23/30 [01:02<00:18,  2.69s/it]{'epoch': 16, 'num_users': 5.9583, 'loss': 0.032, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8725, 'compress@10': 1.0, 'time@10': 3.6632}:  77%|███████▋  | 23/30 [01:05<00:18,  2.69s/it] {'epoch': 16, 'num_users': 5.9583, 'loss': 0.032, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8725, 'compress@10': 1.0, 'time@10': 3.6632}:  80%|████████  | 24/30 [01:05<00:16,  2.76s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0307, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8643, 'compress@10': 1.0, 'time@10': 3.6343}:  80%|████████  | 24/30 [01:06<00:16,  2.76s/it]   {'epoch': 16, 'num_users': 5.8, 'loss': 0.0307, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8643, 'compress@10': 1.0, 'time@10': 3.6343}:  83%|████████▎ | 25/30 [01:06<00:11,  2.38s/it]{'epoch': 16, 'num_users': 5.8077, 'loss': 0.0315, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 3.7382}:  83%|████████▎ | 25/30 [01:13<00:11,  2.38s/it]{'epoch': 16, 'num_users': 5.8077, 'loss': 0.0315, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 3.7382}:  87%|████████▋ | 26/30 [01:13<00:14,  3.58s/it]{'epoch': 16, 'num_users': 5.8889, 'loss': 0.0314, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 3.7268}:  87%|████████▋ | 26/30 [01:14<00:14,  3.58s/it]{'epoch': 16, 'num_users': 5.8889, 'loss': 0.0314, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 3.7268}:  90%|█████████ | 27/30 [01:14<00:09,  3.03s/it]{'epoch': 16, 'num_users': 6.0, 'loss': 0.0318, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 3.7036}:  90%|█████████ | 27/30 [01:17<00:09,  3.03s/it]   {'epoch': 16, 'num_users': 6.0, 'loss': 0.0318, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 3.7036}:  93%|█████████▎| 28/30 [01:17<00:06,  3.06s/it]{'epoch': 16, 'num_users': 5.8621, 'loss': 0.0315, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.8668, 'compress@10': 1.0, 'time@10': 3.6928}:  93%|█████████▎| 28/30 [01:19<00:06,  3.06s/it]{'epoch': 16, 'num_users': 5.8621, 'loss': 0.0315, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.8668, 'compress@10': 1.0, 'time@10': 3.6928}:  97%|█████████▋| 29/30 [01:19<00:02,  2.66s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0316, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8687, 'compress@10': 1.0, 'time@10': 3.6861}:  97%|█████████▋| 29/30 [01:23<00:02,  2.66s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0316, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8687, 'compress@10': 1.0, 'time@10': 3.6861}: 100%|██████████| 30/30 [01:23<00:00,  2.92s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0316, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8687, 'compress@10': 1.0, 'time@10': 3.6861}: 100%|██████████| 30/30 [01:23<00:00,  2.77s/it]
Epoch: 16
Avg # of users: 5.866666666666666
Avg Loss: 0.03158173187753368
Avg hit ratio: 0.8411516875524606
Avg ndcg: 0.868664304558112
Avg compression ratio: 0.9999999860153537
Avg train time: 3.6860588073730467
Std train time: 1.1441273028637315
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 34, 14, 1, 9, 8, 11, 6, 10, 8, 36, 9, 73, 8, 36, 50, 14, 15, 6, 1, 19, 10, 87, 85, 1, 7, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 3.1945}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 3.1945}:   3%|▎         | 1/30 [00:01<00:47,  1.64s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 3.2335}:   3%|▎         | 1/30 [00:04<00:47,  1.64s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 3.2335}:   7%|▋         | 2/30 [00:04<01:13,  2.62s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.6963, 'ndcg@10': 0.8565, 'compress@10': 1.0, 'time@10': 3.3229}:   7%|▋         | 2/30 [00:06<01:13,  2.62s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.6963, 'ndcg@10': 0.8565, 'compress@10': 1.0, 'time@10': 3.3229}:  10%|█         | 3/30 [00:06<01:00,  2.24s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0404, 'hit_ratio@10': 0.7455, 'ndcg@10': 0.84, 'compress@10': 1.0, 'time@10': 3.3447}:  10%|█         | 3/30 [00:10<01:00,  2.24s/it]  {'epoch': 17, 'num_users': 5.0, 'loss': 0.0404, 'hit_ratio@10': 0.7455, 'ndcg@10': 0.84, 'compress@10': 1.0, 'time@10': 3.3447}:  13%|█▎        | 4/30 [00:10<01:10,  2.72s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0733, 'hit_ratio@10': 0.7229, 'ndcg@10': 0.7839, 'compress@10': 1.0, 'time@10': 2.874}:  13%|█▎        | 4/30 [00:10<01:10,  2.72s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0733, 'hit_ratio@10': 0.7229, 'ndcg@10': 0.7839, 'compress@10': 1.0, 'time@10': 2.874}:  17%|█▋        | 5/30 [00:10<00:48,  1.93s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.069, 'hit_ratio@10': 0.7469, 'ndcg@10': 0.7956, 'compress@10': 1.0, 'time@10': 3.0321}:  17%|█▋        | 5/30 [00:14<00:48,  1.93s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.069, 'hit_ratio@10': 0.7469, 'ndcg@10': 0.7956, 'compress@10': 1.0, 'time@10': 3.0321}:  20%|██        | 6/30 [00:14<01:02,  2.59s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.066, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.806, 'compress@10': 1.0, 'time@10': 3.095}:  20%|██        | 6/30 [00:16<01:02,  2.59s/it]  {'epoch': 17, 'num_users': 6.2857, 'loss': 0.066, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.806, 'compress@10': 1.0, 'time@10': 3.095}:  23%|██▎       | 7/30 [00:16<00:53,  2.32s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0621, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.8232, 'compress@10': 1.0, 'time@10': 3.1343}:  23%|██▎       | 7/30 [00:19<00:53,  2.32s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0621, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.8232, 'compress@10': 1.0, 'time@10': 3.1343}:  27%|██▋       | 8/30 [00:19<00:58,  2.68s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0591, 'hit_ratio@10': 0.7843, 'ndcg@10': 0.8321, 'compress@10': 1.0, 'time@10': 3.1998}:  27%|██▋       | 8/30 [00:21<00:58,  2.68s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0591, 'hit_ratio@10': 0.7843, 'ndcg@10': 0.8321, 'compress@10': 1.0, 'time@10': 3.1998}:  30%|███       | 9/30 [00:21<00:51,  2.44s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0561, 'hit_ratio@10': 0.8013, 'ndcg@10': 0.8377, 'compress@10': 1.0, 'time@10': 3.2441}:  30%|███       | 9/30 [00:25<00:51,  2.44s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0561, 'hit_ratio@10': 0.8013, 'ndcg@10': 0.8377, 'compress@10': 1.0, 'time@10': 3.2441}:  33%|███▎      | 10/30 [00:25<00:56,  2.82s/it]{'epoch': 17, 'num_users': 6.6364, 'loss': 0.056, 'hit_ratio@10': 0.8019, 'ndcg@10': 0.8401, 'compress@10': 1.0, 'time@10': 3.2709}:  33%|███▎      | 10/30 [00:27<00:56,  2.82s/it]{'epoch': 17, 'num_users': 6.6364, 'loss': 0.056, 'hit_ratio@10': 0.8019, 'ndcg@10': 0.8401, 'compress@10': 1.0, 'time@10': 3.2709}:  37%|███▋      | 11/30 [00:27<00:47,  2.51s/it]{'epoch': 17, 'num_users': 6.4167, 'loss': 0.0518, 'hit_ratio@10': 0.7837, 'ndcg@10': 0.8465, 'compress@10': 1.0, 'time@10': 3.2849}:  37%|███▋      | 11/30 [00:30<00:47,  2.51s/it]{'epoch': 17, 'num_users': 6.4167, 'loss': 0.0518, 'hit_ratio@10': 0.7837, 'ndcg@10': 0.8465, 'compress@10': 1.0, 'time@10': 3.2849}:  40%|████      | 12/30 [00:30<00:50,  2.80s/it]{'epoch': 17, 'num_users': 6.6154, 'loss': 0.0522, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 3.3106}:  40%|████      | 12/30 [00:32<00:50,  2.80s/it]{'epoch': 17, 'num_users': 6.6154, 'loss': 0.0522, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 3.3106}:  43%|████▎     | 13/30 [00:32<00:42,  2.51s/it]{'epoch': 17, 'num_users': 6.3571, 'loss': 0.0485, 'hit_ratio@10': 0.7929, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 3.3026}:  43%|████▎     | 13/30 [00:35<00:42,  2.51s/it] {'epoch': 17, 'num_users': 6.3571, 'loss': 0.0485, 'hit_ratio@10': 0.7929, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 3.3026}:  47%|████▋     | 14/30 [00:35<00:43,  2.73s/it]{'epoch': 17, 'num_users': 6.2667, 'loss': 0.0489, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 3.3557}:  47%|████▋     | 14/30 [00:37<00:43,  2.73s/it]{'epoch': 17, 'num_users': 6.2667, 'loss': 0.0489, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 3.3557}:  50%|█████     | 15/30 [00:37<00:38,  2.54s/it]{'epoch': 17, 'num_users': 6.0625, 'loss': 0.0461, 'hit_ratio@10': 0.8064, 'ndcg@10': 0.8525, 'compress@10': 1.0, 'time@10': 3.3388}:  50%|█████     | 15/30 [00:40<00:38,  2.54s/it]{'epoch': 17, 'num_users': 6.0625, 'loss': 0.0461, 'hit_ratio@10': 0.8064, 'ndcg@10': 0.8525, 'compress@10': 1.0, 'time@10': 3.3388}:  53%|█████▎    | 16/30 [00:40<00:37,  2.71s/it]{'epoch': 17, 'num_users': 5.8235, 'loss': 0.0435, 'hit_ratio@10': 0.7942, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 3.3322}:  53%|█████▎    | 16/30 [00:42<00:37,  2.71s/it]{'epoch': 17, 'num_users': 5.8235, 'loss': 0.0435, 'hit_ratio@10': 0.7942, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 3.3322}:  57%|█████▋    | 17/30 [00:42<00:31,  2.39s/it]{'epoch': 17, 'num_users': 6.0556, 'loss': 0.043, 'hit_ratio@10': 0.7938, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 3.3431}:  57%|█████▋    | 17/30 [00:46<00:31,  2.39s/it] {'epoch': 17, 'num_users': 6.0556, 'loss': 0.043, 'hit_ratio@10': 0.7938, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 3.3431}:  60%|██████    | 18/30 [00:46<00:32,  2.75s/it]{'epoch': 17, 'num_users': 6.0, 'loss': 0.0413, 'hit_ratio@10': 0.8009, 'ndcg@10': 0.8532, 'compress@10': 1.0, 'time@10': 3.3489}:  60%|██████    | 18/30 [00:47<00:32,  2.75s/it]  {'epoch': 17, 'num_users': 6.0, 'loss': 0.0413, 'hit_ratio@10': 0.8009, 'ndcg@10': 0.8532, 'compress@10': 1.0, 'time@10': 3.3489}:  63%|██████▎   | 19/30 [00:47<00:26,  2.45s/it]{'epoch': 17, 'num_users': 6.15, 'loss': 0.0417, 'hit_ratio@10': 0.8047, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 3.3202}:  63%|██████▎   | 19/30 [00:50<00:26,  2.45s/it]{'epoch': 17, 'num_users': 6.15, 'loss': 0.0417, 'hit_ratio@10': 0.8047, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 3.3202}:  67%|██████▋   | 20/30 [00:50<00:25,  2.56s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0491, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8413, 'compress@10': 1.0, 'time@10': 3.1934}:  67%|██████▋   | 20/30 [00:51<00:25,  2.56s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0491, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8413, 'compress@10': 1.0, 'time@10': 3.1934}:  70%|███████   | 21/30 [00:51<00:17,  1.90s/it]{'epoch': 17, 'num_users': 6.1818, 'loss': 0.0479, 'hit_ratio@10': 0.7996, 'ndcg@10': 0.8454, 'compress@10': 1.0, 'time@10': 3.2006}:  70%|███████   | 21/30 [00:54<00:17,  1.90s/it]{'epoch': 17, 'num_users': 6.1818, 'loss': 0.0479, 'hit_ratio@10': 0.7996, 'ndcg@10': 0.8454, 'compress@10': 1.0, 'time@10': 3.2006}:  73%|███████▎  | 22/30 [00:54<00:18,  2.35s/it]{'epoch': 17, 'num_users': 6.1304, 'loss': 0.0468, 'hit_ratio@10': 0.804, 'ndcg@10': 0.8479, 'compress@10': 1.0, 'time@10': 3.2121}:  73%|███████▎  | 22/30 [00:56<00:18,  2.35s/it] {'epoch': 17, 'num_users': 6.1304, 'loss': 0.0468, 'hit_ratio@10': 0.804, 'ndcg@10': 0.8479, 'compress@10': 1.0, 'time@10': 3.2121}:  77%|███████▋  | 23/30 [00:56<00:15,  2.17s/it]{'epoch': 17, 'num_users': 5.9583, 'loss': 0.0449, 'hit_ratio@10': 0.8038, 'ndcg@10': 0.8459, 'compress@10': 1.0, 'time@10': 3.2046}:  77%|███████▋  | 23/30 [00:59<00:15,  2.17s/it]{'epoch': 17, 'num_users': 5.9583, 'loss': 0.0449, 'hit_ratio@10': 0.8038, 'ndcg@10': 0.8459, 'compress@10': 1.0, 'time@10': 3.2046}:  80%|████████  | 24/30 [00:59<00:14,  2.45s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0431, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8387, 'compress@10': 1.0, 'time@10': 3.1953}:  80%|████████  | 24/30 [01:00<00:14,  2.45s/it]   {'epoch': 17, 'num_users': 5.8, 'loss': 0.0431, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8387, 'compress@10': 1.0, 'time@10': 3.1953}:  83%|████████▎ | 25/30 [01:00<00:10,  2.17s/it]{'epoch': 17, 'num_users': 5.8077, 'loss': 0.0477, 'hit_ratio@10': 0.7919, 'ndcg@10': 0.8306, 'compress@10': 1.0, 'time@10': 3.1006}:  83%|████████▎ | 25/30 [01:01<00:10,  2.17s/it]{'epoch': 17, 'num_users': 5.8077, 'loss': 0.0477, 'hit_ratio@10': 0.7919, 'ndcg@10': 0.8306, 'compress@10': 1.0, 'time@10': 3.1006}:  87%|████████▋ | 26/30 [01:01<00:06,  1.75s/it]{'epoch': 17, 'num_users': 5.8889, 'loss': 0.047, 'hit_ratio@10': 0.7983, 'ndcg@10': 0.8329, 'compress@10': 1.0, 'time@10': 3.1281}:  87%|████████▋ | 26/30 [01:03<00:06,  1.75s/it] {'epoch': 17, 'num_users': 5.8889, 'loss': 0.047, 'hit_ratio@10': 0.7983, 'ndcg@10': 0.8329, 'compress@10': 1.0, 'time@10': 3.1281}:  90%|█████████ | 27/30 [01:03<00:05,  1.81s/it]{'epoch': 17, 'num_users': 6.0, 'loss': 0.0467, 'hit_ratio@10': 0.8027, 'ndcg@10': 0.8354, 'compress@10': 1.0, 'time@10': 3.1496}:  90%|█████████ | 27/30 [01:07<00:05,  1.81s/it]  {'epoch': 17, 'num_users': 6.0, 'loss': 0.0467, 'hit_ratio@10': 0.8027, 'ndcg@10': 0.8354, 'compress@10': 1.0, 'time@10': 3.1496}:  93%|█████████▎| 28/30 [01:07<00:04,  2.40s/it]{'epoch': 17, 'num_users': 5.8621, 'loss': 0.046, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.8378, 'compress@10': 1.0, 'time@10': 3.1696}:  93%|█████████▎| 28/30 [01:09<00:04,  2.40s/it]{'epoch': 17, 'num_users': 5.8621, 'loss': 0.046, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.8378, 'compress@10': 1.0, 'time@10': 3.1696}:  97%|█████████▋| 29/30 [01:09<00:02,  2.25s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.0454, 'hit_ratio@10': 0.8083, 'ndcg@10': 0.8404, 'compress@10': 1.0, 'time@10': 3.1818}:  97%|█████████▋| 29/30 [01:12<00:02,  2.25s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.0454, 'hit_ratio@10': 0.8083, 'ndcg@10': 0.8404, 'compress@10': 1.0, 'time@10': 3.1818}: 100%|██████████| 30/30 [01:12<00:00,  2.65s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.0454, 'hit_ratio@10': 0.8083, 'ndcg@10': 0.8404, 'compress@10': 1.0, 'time@10': 3.1818}: 100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch: 17
Avg # of users: 5.866666666666666
Avg Loss: 0.04544062417736432
Avg hit ratio: 0.8082789417177239
Avg ndcg: 0.8404337335647997
Avg compression ratio: 0.9999999860166272
Avg train time: 3.181848955154419
Std train time: 0.8429857743810533
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 34, 14, 8, 8, 8, 11, 5, 9, 8, 36, 8, 74, 6, 37, 51, 14, 15, 8, 9, 19, 10, 88, 86, 9, 6, 7, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0446, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8439, 'compress@10': 1.0, 'time@10': 3.2162}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0446, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8439, 'compress@10': 1.0, 'time@10': 3.2162}:   3%|▎         | 1/30 [00:01<00:47,  1.65s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.9255, 'compress@10': 1.0, 'time@10': 3.381}:   3%|▎         | 1/30 [00:05<00:47,  1.65s/it] {'epoch': 18, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.9255, 'compress@10': 1.0, 'time@10': 3.381}:   7%|▋         | 2/30 [00:05<01:18,  2.79s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.6641, 'ndcg@10': 0.9027, 'compress@10': 1.0, 'time@10': 3.3305}:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.6641, 'ndcg@10': 0.9027, 'compress@10': 1.0, 'time@10': 3.3305}:  10%|█         | 3/30 [00:06<01:01,  2.28s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.7391, 'ndcg@10': 0.9392, 'compress@10': 1.0, 'time@10': 3.3233}:  10%|█         | 3/30 [00:10<01:01,  2.28s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.7391, 'ndcg@10': 0.9392, 'compress@10': 1.0, 'time@10': 3.3233}:  13%|█▎        | 4/30 [00:10<01:10,  2.70s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0399, 'hit_ratio@10': 0.7633, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 4.1148}:  13%|█▎        | 4/30 [00:13<01:10,  2.70s/it]  {'epoch': 18, 'num_users': 5.8, 'loss': 0.0399, 'hit_ratio@10': 0.7633, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 4.1148}:  17%|█▋        | 5/30 [00:13<01:16,  3.05s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0411, 'hit_ratio@10': 0.7842, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.962}:  17%|█▋        | 5/30 [00:17<01:16,  3.05s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0411, 'hit_ratio@10': 0.7842, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.962}:  20%|██        | 6/30 [00:17<01:14,  3.11s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0416, 'hit_ratio@10': 0.8036, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 3.8764}:  20%|██        | 6/30 [00:18<01:14,  3.11s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0416, 'hit_ratio@10': 0.8036, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 3.8764}:  23%|██▎       | 7/30 [00:18<01:01,  2.66s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0422, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8966, 'compress@10': 1.0, 'time@10': 3.8093}:  23%|██▎       | 7/30 [00:22<01:01,  2.66s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0422, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8966, 'compress@10': 1.0, 'time@10': 3.8093}:  27%|██▋       | 8/30 [00:22<01:03,  2.89s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0415, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.7263}:  27%|██▋       | 8/30 [00:23<01:03,  2.89s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0415, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.7263}:  30%|███       | 9/30 [00:23<00:52,  2.48s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0405, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 3.7015}:  30%|███       | 9/30 [00:27<00:52,  2.48s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0405, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 3.7015}:  33%|███▎      | 10/30 [00:27<00:55,  2.80s/it]{'epoch': 18, 'num_users': 6.6364, 'loss': 0.0416, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8973, 'compress@10': 1.0, 'time@10': 3.6957}:  33%|███▎      | 10/30 [00:29<00:55,  2.80s/it]{'epoch': 18, 'num_users': 6.6364, 'loss': 0.0416, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8973, 'compress@10': 1.0, 'time@10': 3.6957}:  37%|███▋      | 11/30 [00:29<00:47,  2.51s/it]{'epoch': 18, 'num_users': 6.4167, 'loss': 0.0386, 'hit_ratio@10': 0.8066, 'ndcg@10': 0.8989, 'compress@10': 1.0, 'time@10': 3.6787}:  37%|███▋      | 11/30 [00:32<00:47,  2.51s/it]{'epoch': 18, 'num_users': 6.4167, 'loss': 0.0386, 'hit_ratio@10': 0.8066, 'ndcg@10': 0.8989, 'compress@10': 1.0, 'time@10': 3.6787}:  40%|████      | 12/30 [00:32<00:50,  2.82s/it]{'epoch': 18, 'num_users': 6.6154, 'loss': 0.0389, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8978, 'compress@10': 1.0, 'time@10': 3.6394}:  40%|████      | 12/30 [00:34<00:50,  2.82s/it] {'epoch': 18, 'num_users': 6.6154, 'loss': 0.0389, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8978, 'compress@10': 1.0, 'time@10': 3.6394}:  43%|████▎     | 13/30 [00:34<00:41,  2.46s/it]{'epoch': 18, 'num_users': 6.3571, 'loss': 0.0362, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8932, 'compress@10': 1.0, 'time@10': 3.6123}:  43%|████▎     | 13/30 [00:37<00:41,  2.46s/it]{'epoch': 18, 'num_users': 6.3571, 'loss': 0.0362, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8932, 'compress@10': 1.0, 'time@10': 3.6123}:  47%|████▋     | 14/30 [00:37<00:43,  2.71s/it]{'epoch': 18, 'num_users': 6.2667, 'loss': 0.037, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.586}:  47%|████▋     | 14/30 [00:39<00:43,  2.71s/it]  {'epoch': 18, 'num_users': 6.2667, 'loss': 0.037, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.586}:  50%|█████     | 15/30 [00:39<00:35,  2.39s/it]{'epoch': 18, 'num_users': 6.0625, 'loss': 0.0349, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 3.5841}:  50%|█████     | 15/30 [00:42<00:35,  2.39s/it]{'epoch': 18, 'num_users': 6.0625, 'loss': 0.0349, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 3.5841}:  53%|█████▎    | 16/30 [00:42<00:38,  2.75s/it]{'epoch': 18, 'num_users': 5.8235, 'loss': 0.033, 'hit_ratio@10': 0.8085, 'ndcg@10': 0.8864, 'compress@10': 1.0, 'time@10': 3.5908}:  53%|█████▎    | 16/30 [00:44<00:38,  2.75s/it] {'epoch': 18, 'num_users': 5.8235, 'loss': 0.033, 'hit_ratio@10': 0.8085, 'ndcg@10': 0.8864, 'compress@10': 1.0, 'time@10': 3.5908}:  57%|█████▋    | 17/30 [00:44<00:32,  2.49s/it]{'epoch': 18, 'num_users': 6.0556, 'loss': 0.0329, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.8865, 'compress@10': 1.0, 'time@10': 3.5877}:  57%|█████▋    | 17/30 [00:48<00:32,  2.49s/it]{'epoch': 18, 'num_users': 6.0556, 'loss': 0.0329, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.8865, 'compress@10': 1.0, 'time@10': 3.5877}:  60%|██████    | 18/30 [00:48<00:33,  2.82s/it]{'epoch': 18, 'num_users': 6.0, 'loss': 0.0318, 'hit_ratio@10': 0.8137, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 3.59}:  60%|██████    | 18/30 [00:50<00:33,  2.82s/it]     {'epoch': 18, 'num_users': 6.0, 'loss': 0.0318, 'hit_ratio@10': 0.8137, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 3.59}:  63%|██████▎   | 19/30 [00:50<00:27,  2.53s/it]{'epoch': 18, 'num_users': 6.15, 'loss': 0.0324, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8855, 'compress@10': 1.0, 'time@10': 3.614}:  63%|██████▎   | 19/30 [00:54<00:27,  2.53s/it]{'epoch': 18, 'num_users': 6.15, 'loss': 0.0324, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8855, 'compress@10': 1.0, 'time@10': 3.614}:  67%|██████▋   | 20/30 [00:54<00:30,  3.01s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0341, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 3.7509}:  67%|██████▋   | 20/30 [00:57<00:30,  3.01s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0341, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 3.7509}:  70%|███████   | 21/30 [00:57<00:27,  3.09s/it]{'epoch': 18, 'num_users': 6.1818, 'loss': 0.0332, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8844, 'compress@10': 1.0, 'time@10': 3.7356}:  70%|███████   | 21/30 [01:01<00:27,  3.09s/it]{'epoch': 18, 'num_users': 6.1818, 'loss': 0.0332, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8844, 'compress@10': 1.0, 'time@10': 3.7356}:  73%|███████▎  | 22/30 [01:01<00:25,  3.21s/it]{'epoch': 18, 'num_users': 6.1304, 'loss': 0.0328, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8851, 'compress@10': 1.0, 'time@10': 3.7072}:  73%|███████▎  | 22/30 [01:02<00:25,  3.21s/it]{'epoch': 18, 'num_users': 6.1304, 'loss': 0.0328, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8851, 'compress@10': 1.0, 'time@10': 3.7072}:  77%|███████▋  | 23/30 [01:02<00:19,  2.72s/it]{'epoch': 18, 'num_users': 5.9583, 'loss': 0.0314, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8816, 'compress@10': 1.0, 'time@10': 3.6666}:  77%|███████▋  | 23/30 [01:05<00:19,  2.72s/it]{'epoch': 18, 'num_users': 5.9583, 'loss': 0.0314, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8816, 'compress@10': 1.0, 'time@10': 3.6666}:  80%|████████  | 24/30 [01:05<00:16,  2.73s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0302, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 3.6328}:  80%|████████  | 24/30 [01:06<00:16,  2.73s/it]    {'epoch': 18, 'num_users': 5.8, 'loss': 0.0302, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 3.6328}:  83%|████████▎ | 25/30 [01:06<00:11,  2.35s/it]{'epoch': 18, 'num_users': 5.8077, 'loss': 0.0307, 'hit_ratio@10': 0.8228, 'ndcg@10': 0.8725, 'compress@10': 1.0, 'time@10': 3.7276}:  83%|████████▎ | 25/30 [01:13<00:11,  2.35s/it]{'epoch': 18, 'num_users': 5.8077, 'loss': 0.0307, 'hit_ratio@10': 0.8228, 'ndcg@10': 0.8725, 'compress@10': 1.0, 'time@10': 3.7276}:  87%|████████▋ | 26/30 [01:13<00:13,  3.48s/it]{'epoch': 18, 'num_users': 5.8889, 'loss': 0.0307, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 3.6864}:  87%|████████▋ | 26/30 [01:14<00:13,  3.48s/it] {'epoch': 18, 'num_users': 5.8889, 'loss': 0.0307, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 3.6864}:  90%|█████████ | 27/30 [01:14<00:08,  2.84s/it]{'epoch': 18, 'num_users': 6.0, 'loss': 0.031, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8732, 'compress@10': 1.0, 'time@10': 3.6622}:  90%|█████████ | 27/30 [01:17<00:08,  2.84s/it]   {'epoch': 18, 'num_users': 6.0, 'loss': 0.031, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8732, 'compress@10': 1.0, 'time@10': 3.6622}:  93%|█████████▎| 28/30 [01:17<00:05,  2.90s/it]{'epoch': 18, 'num_users': 5.8621, 'loss': 0.0306, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 3.6466}:  93%|█████████▎| 28/30 [01:19<00:05,  2.90s/it]{'epoch': 18, 'num_users': 5.8621, 'loss': 0.0306, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 3.6466}:  97%|█████████▋| 29/30 [01:19<00:02,  2.52s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0306, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8759, 'compress@10': 1.0, 'time@10': 3.6435}:  97%|█████████▋| 29/30 [01:22<00:02,  2.52s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0306, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8759, 'compress@10': 1.0, 'time@10': 3.6435}: 100%|██████████| 30/30 [01:22<00:00,  2.85s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0306, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8759, 'compress@10': 1.0, 'time@10': 3.6435}: 100%|██████████| 30/30 [01:22<00:00,  2.76s/it]
Epoch: 18
Avg # of users: 5.866666666666666
Avg Loss: 0.030575720397838645
Avg hit ratio: 0.8351275819237335
Avg ndcg: 0.875890886456231
Avg compression ratio: 0.9999999860153537
Avg train time: 3.6434850772221883
Std train time: 1.0468768386941887
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 13, 35, 14, 1, 9, 8, 11, 6, 9, 7, 36, 9, 75, 7, 37, 50, 14, 14, 6, 1, 19, 11, 90, 88, 1, 8, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0368, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 3.9838}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0368, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 3.9838}:   3%|▎         | 1/30 [00:02<00:58,  2.03s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0411, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8766, 'compress@10': 1.0, 'time@10': 3.7749}:   3%|▎         | 1/30 [00:05<00:58,  2.03s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0411, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8766, 'compress@10': 1.0, 'time@10': 3.7749}:   7%|▋         | 2/30 [00:05<01:22,  2.96s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8701, 'compress@10': 1.0, 'time@10': 3.7305}:   7%|▋         | 2/30 [00:07<01:22,  2.96s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8701, 'compress@10': 1.0, 'time@10': 3.7305}:  10%|█         | 3/30 [00:07<01:06,  2.46s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.799, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.6729}:  10%|█         | 3/30 [00:11<01:06,  2.46s/it]  {'epoch': 19, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.799, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.6729}:  13%|█▎        | 4/30 [00:11<01:15,  2.89s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0596, 'hit_ratio@10': 0.7698, 'ndcg@10': 0.8277, 'compress@10': 1.0, 'time@10': 3.1146}:  13%|█▎        | 4/30 [00:11<01:15,  2.89s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0596, 'hit_ratio@10': 0.7698, 'ndcg@10': 0.8277, 'compress@10': 1.0, 'time@10': 3.1146}:  17%|█▋        | 5/30 [00:11<00:50,  2.02s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0566, 'hit_ratio@10': 0.7897, 'ndcg@10': 0.8333, 'compress@10': 1.0, 'time@10': 3.2048}:  17%|█▋        | 5/30 [00:15<00:50,  2.02s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0566, 'hit_ratio@10': 0.7897, 'ndcg@10': 0.8333, 'compress@10': 1.0, 'time@10': 3.2048}:  20%|██        | 6/30 [00:15<01:02,  2.59s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0544, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8401, 'compress@10': 1.0, 'time@10': 3.2507}:  20%|██        | 6/30 [00:17<01:02,  2.59s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.0544, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8401, 'compress@10': 1.0, 'time@10': 3.2507}:  23%|██▎       | 7/30 [00:17<00:53,  2.33s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0513, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8418, 'compress@10': 1.0, 'time@10': 3.2571}:  23%|██▎       | 7/30 [00:20<00:53,  2.33s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0513, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8418, 'compress@10': 1.0, 'time@10': 3.2571}:  27%|██▋       | 8/30 [00:20<00:58,  2.65s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0498, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8485, 'compress@10': 1.0, 'time@10': 3.29}:  27%|██▋       | 8/30 [00:22<00:58,  2.65s/it] {'epoch': 19, 'num_users': 6.3333, 'loss': 0.0498, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8485, 'compress@10': 1.0, 'time@10': 3.29}:  30%|███       | 9/30 [00:22<00:50,  2.39s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0484, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 3.2993}:  30%|███       | 9/30 [00:25<00:50,  2.39s/it] {'epoch': 19, 'num_users': 6.3, 'loss': 0.0484, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 3.2993}:  33%|███▎      | 10/30 [00:25<00:54,  2.71s/it]{'epoch': 19, 'num_users': 6.6364, 'loss': 0.0488, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8561, 'compress@10': 1.0, 'time@10': 3.3035}:  33%|███▎      | 10/30 [00:27<00:54,  2.71s/it]{'epoch': 19, 'num_users': 6.6364, 'loss': 0.0488, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8561, 'compress@10': 1.0, 'time@10': 3.3035}:  37%|███▋      | 11/30 [00:27<00:45,  2.40s/it]{'epoch': 19, 'num_users': 6.4167, 'loss': 0.045, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.8611, 'compress@10': 1.0, 'time@10': 3.3208}:  37%|███▋      | 11/30 [00:30<00:45,  2.40s/it]{'epoch': 19, 'num_users': 6.4167, 'loss': 0.045, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.8611, 'compress@10': 1.0, 'time@10': 3.3208}:  40%|████      | 12/30 [00:30<00:49,  2.75s/it]{'epoch': 19, 'num_users': 6.6154, 'loss': 0.0453, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 3.3686}:  40%|████      | 12/30 [00:32<00:49,  2.75s/it]{'epoch': 19, 'num_users': 6.6154, 'loss': 0.0453, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 3.3686}:  43%|████▎     | 13/30 [00:32<00:43,  2.53s/it]{'epoch': 19, 'num_users': 6.3571, 'loss': 0.0421, 'hit_ratio@10': 0.8194, 'ndcg@10': 0.8603, 'compress@10': 1.0, 'time@10': 3.3633}:  43%|████▎     | 13/30 [00:36<00:43,  2.53s/it]{'epoch': 19, 'num_users': 6.3571, 'loss': 0.0421, 'hit_ratio@10': 0.8194, 'ndcg@10': 0.8603, 'compress@10': 1.0, 'time@10': 3.3633}:  47%|████▋     | 14/30 [00:36<00:44,  2.78s/it]{'epoch': 19, 'num_users': 6.2667, 'loss': 0.0429, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 3.3766}:  47%|████▋     | 14/30 [00:38<00:44,  2.78s/it]{'epoch': 19, 'num_users': 6.2667, 'loss': 0.0429, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 3.3766}:  50%|█████     | 15/30 [00:38<00:37,  2.49s/it]{'epoch': 19, 'num_users': 6.0625, 'loss': 0.0405, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 3.3776}:  50%|█████     | 15/30 [00:41<00:37,  2.49s/it]{'epoch': 19, 'num_users': 6.0625, 'loss': 0.0405, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 3.3776}:  53%|█████▎    | 16/30 [00:41<00:38,  2.77s/it]{'epoch': 19, 'num_users': 5.8235, 'loss': 0.0382, 'hit_ratio@10': 0.816, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 3.38}:  53%|█████▎    | 16/30 [00:43<00:38,  2.77s/it]   {'epoch': 19, 'num_users': 5.8235, 'loss': 0.0382, 'hit_ratio@10': 0.816, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 3.38}:  57%|█████▋    | 17/30 [00:43<00:32,  2.47s/it]{'epoch': 19, 'num_users': 6.0556, 'loss': 0.0379, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 3.3844}:  57%|█████▋    | 17/30 [00:46<00:32,  2.47s/it]{'epoch': 19, 'num_users': 6.0556, 'loss': 0.0379, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 3.3844}:  60%|██████    | 18/30 [00:46<00:33,  2.78s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 0.0364, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 3.3745}:  60%|██████    | 18/30 [00:48<00:33,  2.78s/it]   {'epoch': 19, 'num_users': 6.0, 'loss': 0.0364, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 3.3745}:  63%|██████▎   | 19/30 [00:48<00:26,  2.44s/it]{'epoch': 19, 'num_users': 6.15, 'loss': 0.0369, 'hit_ratio@10': 0.8232, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 3.3596}:  63%|██████▎   | 19/30 [00:51<00:26,  2.44s/it]{'epoch': 19, 'num_users': 6.15, 'loss': 0.0369, 'hit_ratio@10': 0.8232, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 3.3596}:  67%|██████▋   | 20/30 [00:51<00:26,  2.65s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0443, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.8504, 'compress@10': 1.0, 'time@10': 3.2362}:  67%|██████▋   | 20/30 [00:51<00:26,  2.65s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0443, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.8504, 'compress@10': 1.0, 'time@10': 3.2362}:  70%|███████   | 21/30 [00:51<00:17,  1.98s/it]{'epoch': 19, 'num_users': 6.1818, 'loss': 0.0428, 'hit_ratio@10': 0.8209, 'ndcg@10': 0.8536, 'compress@10': 1.0, 'time@10': 3.2514}:  70%|███████   | 21/30 [00:55<00:17,  1.98s/it]{'epoch': 19, 'num_users': 6.1818, 'loss': 0.0428, 'hit_ratio@10': 0.8209, 'ndcg@10': 0.8536, 'compress@10': 1.0, 'time@10': 3.2514}:  73%|███████▎  | 22/30 [00:55<00:19,  2.47s/it]{'epoch': 19, 'num_users': 6.1304, 'loss': 0.0421, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 3.2708}:  73%|███████▎  | 22/30 [00:57<00:19,  2.47s/it]{'epoch': 19, 'num_users': 6.1304, 'loss': 0.0421, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 3.2708}:  77%|███████▋  | 23/30 [00:57<00:16,  2.29s/it]{'epoch': 19, 'num_users': 5.9583, 'loss': 0.0403, 'hit_ratio@10': 0.815, 'ndcg@10': 0.8536, 'compress@10': 1.0, 'time@10': 3.2601}:  77%|███████▋  | 23/30 [01:00<00:16,  2.29s/it] {'epoch': 19, 'num_users': 5.9583, 'loss': 0.0403, 'hit_ratio@10': 0.815, 'ndcg@10': 0.8536, 'compress@10': 1.0, 'time@10': 3.2601}:  80%|████████  | 24/30 [01:00<00:15,  2.52s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0387, 'hit_ratio@10': 0.809, 'ndcg@10': 0.8461, 'compress@10': 1.0, 'time@10': 3.2414}:  80%|████████  | 24/30 [01:01<00:15,  2.52s/it]   {'epoch': 19, 'num_users': 5.8, 'loss': 0.0387, 'hit_ratio@10': 0.809, 'ndcg@10': 0.8461, 'compress@10': 1.0, 'time@10': 3.2414}:  83%|████████▎ | 25/30 [01:01<00:10,  2.19s/it]{'epoch': 19, 'num_users': 5.8077, 'loss': 0.0432, 'hit_ratio@10': 0.8021, 'ndcg@10': 0.8378, 'compress@10': 1.0, 'time@10': 3.1441}:  83%|████████▎ | 25/30 [01:02<00:10,  2.19s/it]{'epoch': 19, 'num_users': 5.8077, 'loss': 0.0432, 'hit_ratio@10': 0.8021, 'ndcg@10': 0.8378, 'compress@10': 1.0, 'time@10': 3.1441}:  87%|████████▋ | 26/30 [01:02<00:07,  1.76s/it]{'epoch': 19, 'num_users': 5.8889, 'loss': 0.0427, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8397, 'compress@10': 1.0, 'time@10': 3.1741}:  87%|████████▋ | 26/30 [01:04<00:07,  1.76s/it]{'epoch': 19, 'num_users': 5.8889, 'loss': 0.0427, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8397, 'compress@10': 1.0, 'time@10': 3.1741}:  90%|█████████ | 27/30 [01:04<00:05,  1.84s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 0.0424, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.842, 'compress@10': 1.0, 'time@10': 3.1906}:  90%|█████████ | 27/30 [01:08<00:05,  1.84s/it]    {'epoch': 19, 'num_users': 6.0, 'loss': 0.0424, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.842, 'compress@10': 1.0, 'time@10': 3.1906}:  93%|█████████▎| 28/30 [01:08<00:04,  2.39s/it]{'epoch': 19, 'num_users': 5.8621, 'loss': 0.0416, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.8446, 'compress@10': 1.0, 'time@10': 3.2074}:  93%|█████████▎| 28/30 [01:10<00:04,  2.39s/it]{'epoch': 19, 'num_users': 5.8621, 'loss': 0.0416, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.8446, 'compress@10': 1.0, 'time@10': 3.2074}:  97%|█████████▋| 29/30 [01:10<00:02,  2.24s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0415, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 3.2159}:  97%|█████████▋| 29/30 [01:13<00:02,  2.24s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0415, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 3.2159}: 100%|██████████| 30/30 [01:13<00:00,  2.62s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0415, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 3.2159}: 100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch: 19
Avg # of users: 5.866666666666666
Avg Loss: 0.041469212082962635
Avg hit ratio: 0.8153803372476908
Avg ndcg: 0.8477343638502062
Avg compression ratio: 0.9999999860166272
Avg train time: 3.215908749898275
Std train time: 0.8489078647677463
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 34, 14, 8, 8, 8, 11, 6, 9, 7, 36, 8, 75, 7, 37, 50, 14, 15, 7, 9, 19, 10, 91, 90, 9, 6, 7, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 3.2719}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 3.2719}:   3%|▎         | 1/30 [00:01<00:49,  1.70s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9171, 'compress@10': 1.0, 'time@10': 3.3914}:   3%|▎         | 1/30 [00:05<00:49,  1.70s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9171, 'compress@10': 1.0, 'time@10': 3.3914}:   7%|▋         | 2/30 [00:05<01:18,  2.79s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.7031, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.3042}:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.7031, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.3042}:  10%|█         | 3/30 [00:06<01:00,  2.25s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.7416, 'ndcg@10': 0.8779, 'compress@10': 1.0, 'time@10': 3.2549}:  10%|█         | 3/30 [00:10<01:00,  2.25s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.7416, 'ndcg@10': 0.8779, 'compress@10': 1.0, 'time@10': 3.2549}:  13%|█▎        | 4/30 [00:10<01:07,  2.60s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0386, 'hit_ratio@10': 0.7573, 'ndcg@10': 0.8629, 'compress@10': 1.0, 'time@10': 4.0248}:  13%|█▎        | 4/30 [00:13<01:07,  2.60s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0386, 'hit_ratio@10': 0.7573, 'ndcg@10': 0.8629, 'compress@10': 1.0, 'time@10': 4.0248}:  17%|█▋        | 5/30 [00:13<01:13,  2.96s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0393, 'hit_ratio@10': 0.7792, 'ndcg@10': 0.8641, 'compress@10': 1.0, 'time@10': 3.8952}:  17%|█▋        | 5/30 [00:16<01:13,  2.96s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0393, 'hit_ratio@10': 0.7792, 'ndcg@10': 0.8641, 'compress@10': 1.0, 'time@10': 3.8952}:  20%|██        | 6/30 [00:16<01:13,  3.07s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0394, 'hit_ratio@10': 0.8051, 'ndcg@10': 0.8667, 'compress@10': 1.0, 'time@10': 3.8383}:  20%|██        | 6/30 [00:18<01:13,  3.07s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0394, 'hit_ratio@10': 0.8051, 'ndcg@10': 0.8667, 'compress@10': 1.0, 'time@10': 3.8383}:  23%|██▎       | 7/30 [00:18<01:00,  2.65s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0378, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 3.7516}:  23%|██▎       | 7/30 [00:21<01:00,  2.65s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0378, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 3.7516}:  27%|██▋       | 8/30 [00:21<01:02,  2.82s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0373, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8763, 'compress@10': 1.0, 'time@10': 3.7662}:  27%|██▋       | 8/30 [00:23<01:02,  2.82s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0373, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8763, 'compress@10': 1.0, 'time@10': 3.7662}:  30%|███       | 9/30 [00:23<00:53,  2.56s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0364, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8792, 'compress@10': 1.0, 'time@10': 3.7472}:  30%|███       | 9/30 [00:27<00:53,  2.56s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0364, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8792, 'compress@10': 1.0, 'time@10': 3.7472}:  33%|███▎      | 10/30 [00:27<00:57,  2.89s/it]{'epoch': 20, 'num_users': 6.6364, 'loss': 0.0379, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 3.7009}:  33%|███▎      | 10/30 [00:29<00:57,  2.89s/it]{'epoch': 20, 'num_users': 6.6364, 'loss': 0.0379, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 3.7009}:  37%|███▋      | 11/30 [00:29<00:47,  2.51s/it]{'epoch': 20, 'num_users': 6.4167, 'loss': 0.0351, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8816, 'compress@10': 1.0, 'time@10': 3.6762}:  37%|███▋      | 11/30 [00:32<00:47,  2.51s/it]{'epoch': 20, 'num_users': 6.4167, 'loss': 0.0351, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8816, 'compress@10': 1.0, 'time@10': 3.6762}:  40%|████      | 12/30 [00:32<00:50,  2.79s/it]{'epoch': 20, 'num_users': 6.6154, 'loss': 0.0355, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 3.6345}:  40%|████      | 12/30 [00:34<00:50,  2.79s/it]{'epoch': 20, 'num_users': 6.6154, 'loss': 0.0355, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 3.6345}:  43%|████▎     | 13/30 [00:34<00:41,  2.43s/it]{'epoch': 20, 'num_users': 6.3571, 'loss': 0.033, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8786, 'compress@10': 1.0, 'time@10': 3.6129}:  43%|████▎     | 13/30 [00:37<00:41,  2.43s/it] {'epoch': 20, 'num_users': 6.3571, 'loss': 0.033, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8786, 'compress@10': 1.0, 'time@10': 3.6129}:  47%|████▋     | 14/30 [00:37<00:43,  2.72s/it]{'epoch': 20, 'num_users': 6.2667, 'loss': 0.0341, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 3.6291}:  47%|████▋     | 14/30 [00:39<00:43,  2.72s/it]{'epoch': 20, 'num_users': 6.2667, 'loss': 0.0341, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 3.6291}:  50%|█████     | 15/30 [00:39<00:37,  2.49s/it]{'epoch': 20, 'num_users': 6.0625, 'loss': 0.0323, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 3.6272}:  50%|█████     | 15/30 [00:43<00:37,  2.49s/it]{'epoch': 20, 'num_users': 6.0625, 'loss': 0.0323, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 3.6272}:  53%|█████▎    | 16/30 [00:43<00:39,  2.83s/it]{'epoch': 20, 'num_users': 5.8235, 'loss': 0.0304, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8732, 'compress@10': 1.0, 'time@10': 3.6114}:  53%|█████▎    | 16/30 [00:44<00:39,  2.83s/it]{'epoch': 20, 'num_users': 5.8235, 'loss': 0.0304, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8732, 'compress@10': 1.0, 'time@10': 3.6114}:  57%|█████▋    | 17/30 [00:44<00:32,  2.50s/it]{'epoch': 20, 'num_users': 6.0556, 'loss': 0.0306, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 3.6059}:  57%|█████▋    | 17/30 [00:48<00:32,  2.50s/it]{'epoch': 20, 'num_users': 6.0556, 'loss': 0.0306, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 3.6059}:  60%|██████    | 18/30 [00:48<00:33,  2.82s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 0.0296, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8753, 'compress@10': 1.0, 'time@10': 3.6016}:  60%|██████    | 18/30 [00:50<00:33,  2.82s/it]   {'epoch': 20, 'num_users': 6.0, 'loss': 0.0296, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8753, 'compress@10': 1.0, 'time@10': 3.6016}:  63%|██████▎   | 19/30 [00:50<00:27,  2.51s/it]{'epoch': 20, 'num_users': 6.15, 'loss': 0.0303, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 3.5953}:  63%|██████▎   | 19/30 [00:53<00:27,  2.51s/it]{'epoch': 20, 'num_users': 6.15, 'loss': 0.0303, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 3.5953}:  67%|██████▋   | 20/30 [00:53<00:28,  2.81s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 3.721}:  67%|██████▋   | 20/30 [00:56<00:28,  2.81s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 3.721}:  70%|███████   | 21/30 [00:56<00:26,  2.92s/it]{'epoch': 20, 'num_users': 6.1818, 'loss': 0.0323, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 3.6986}:  70%|███████   | 21/30 [01:00<00:26,  2.92s/it]{'epoch': 20, 'num_users': 6.1818, 'loss': 0.0323, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 3.6986}:  73%|███████▎  | 22/30 [01:00<00:24,  3.02s/it]{'epoch': 20, 'num_users': 6.1304, 'loss': 0.0318, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 3.6815}:  73%|███████▎  | 22/30 [01:01<00:24,  3.02s/it]{'epoch': 20, 'num_users': 6.1304, 'loss': 0.0318, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 3.6815}:  77%|███████▋  | 23/30 [01:01<00:18,  2.62s/it]{'epoch': 20, 'num_users': 5.9583, 'loss': 0.0304, 'hit_ratio@10': 0.833, 'ndcg@10': 0.8674, 'compress@10': 1.0, 'time@10': 3.6609}:  77%|███████▋  | 23/30 [01:05<00:18,  2.62s/it] {'epoch': 20, 'num_users': 5.9583, 'loss': 0.0304, 'hit_ratio@10': 0.833, 'ndcg@10': 0.8674, 'compress@10': 1.0, 'time@10': 3.6609}:  80%|████████  | 24/30 [01:05<00:16,  2.80s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0292, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8594, 'compress@10': 1.0, 'time@10': 3.6427}:  80%|████████  | 24/30 [01:06<00:16,  2.80s/it]  {'epoch': 20, 'num_users': 5.8, 'loss': 0.0292, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8594, 'compress@10': 1.0, 'time@10': 3.6427}:  83%|████████▎ | 25/30 [01:06<00:12,  2.45s/it]{'epoch': 20, 'num_users': 5.8077, 'loss': 0.0297, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8597, 'compress@10': 1.0, 'time@10': 3.7522}:  83%|████████▎ | 25/30 [01:13<00:12,  2.45s/it]{'epoch': 20, 'num_users': 5.8077, 'loss': 0.0297, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8597, 'compress@10': 1.0, 'time@10': 3.7522}:  87%|████████▋ | 26/30 [01:13<00:14,  3.68s/it]{'epoch': 20, 'num_users': 5.8889, 'loss': 0.0296, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8607, 'compress@10': 1.0, 'time@10': 3.7215}:  87%|████████▋ | 26/30 [01:14<00:14,  3.68s/it]{'epoch': 20, 'num_users': 5.8889, 'loss': 0.0296, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8607, 'compress@10': 1.0, 'time@10': 3.7215}:  90%|█████████ | 27/30 [01:14<00:09,  3.02s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 0.0299, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8616, 'compress@10': 1.0, 'time@10': 3.7025}:  90%|█████████ | 27/30 [01:17<00:09,  3.02s/it]   {'epoch': 20, 'num_users': 6.0, 'loss': 0.0299, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8616, 'compress@10': 1.0, 'time@10': 3.7025}:  93%|█████████▎| 28/30 [01:17<00:06,  3.08s/it]{'epoch': 20, 'num_users': 5.8621, 'loss': 0.0296, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8631, 'compress@10': 1.0, 'time@10': 3.6829}:  93%|█████████▎| 28/30 [01:19<00:06,  3.08s/it]{'epoch': 20, 'num_users': 5.8621, 'loss': 0.0296, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8631, 'compress@10': 1.0, 'time@10': 3.6829}:  97%|█████████▋| 29/30 [01:19<00:02,  2.64s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.0293, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 3.6745}:  97%|█████████▋| 29/30 [01:23<00:02,  2.64s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.0293, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 3.6745}: 100%|██████████| 30/30 [01:23<00:00,  2.89s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.0293, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 3.6745}: 100%|██████████| 30/30 [01:23<00:00,  2.77s/it]
Epoch: 20
Avg # of users: 5.866666666666666
Avg Loss: 0.029346127109601536
Avg hit ratio: 0.8433094236202137
Avg ndcg: 0.8654474199197622
Avg compression ratio: 0.9999999860153537
Avg train time: 3.674475606282552
Std train time: 1.0076475624467363
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 35, 15, 1, 9, 8, 12, 5, 9, 8, 36, 9, 75, 6, 37, 50, 14, 15, 7, 1, 20, 10, 92, 91, 1, 8, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8712, 'compress@10': 1.0, 'time@10': 3.349}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8712, 'compress@10': 1.0, 'time@10': 3.349}:   3%|▎         | 1/30 [00:01<00:49,  1.71s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0434, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9045, 'compress@10': 1.0, 'time@10': 3.4167}:   3%|▎         | 1/30 [00:05<00:49,  1.71s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0434, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9045, 'compress@10': 1.0, 'time@10': 3.4167}:   7%|▋         | 2/30 [00:05<01:17,  2.78s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0289, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 3.5391}:   7%|▋         | 2/30 [00:07<01:17,  2.78s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0289, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 3.5391}:  10%|█         | 3/30 [00:07<01:04,  2.39s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0331, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.9391, 'compress@10': 1.0, 'time@10': 3.4266}:  10%|█         | 3/30 [00:10<01:04,  2.39s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0331, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.9391, 'compress@10': 1.0, 'time@10': 3.4266}:  13%|█▎        | 4/30 [00:10<01:09,  2.68s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0664, 'hit_ratio@10': 0.7739, 'ndcg@10': 0.8672, 'compress@10': 1.0, 'time@10': 2.8772}:  13%|█▎        | 4/30 [00:10<01:09,  2.68s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0664, 'hit_ratio@10': 0.7739, 'ndcg@10': 0.8672, 'compress@10': 1.0, 'time@10': 2.8772}:  17%|█▋        | 5/30 [00:10<00:46,  1.85s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0617, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 2.9786}:  17%|█▋        | 5/30 [00:14<00:46,  1.85s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0617, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 2.9786}:  20%|██        | 6/30 [00:14<00:58,  2.42s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0585, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8695, 'compress@10': 1.0, 'time@10': 3.0464}:  20%|██        | 6/30 [00:15<00:58,  2.42s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0585, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8695, 'compress@10': 1.0, 'time@10': 3.0464}:  23%|██▎       | 7/30 [00:15<00:50,  2.20s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0572, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 3.098}:  23%|██▎       | 7/30 [00:19<00:50,  2.20s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 0.0572, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 3.098}:  27%|██▋       | 8/30 [00:19<00:57,  2.62s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0549, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8695, 'compress@10': 1.0, 'time@10': 3.0744}:  27%|██▋       | 8/30 [00:20<00:57,  2.62s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0549, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8695, 'compress@10': 1.0, 'time@10': 3.0744}:  30%|███       | 9/30 [00:20<00:47,  2.26s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0517, 'hit_ratio@10': 0.833, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 3.0997}:  30%|███       | 9/30 [00:24<00:47,  2.26s/it]    {'epoch': 21, 'num_users': 6.3, 'loss': 0.0517, 'hit_ratio@10': 0.833, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 3.0997}:  33%|███▎      | 10/30 [00:24<00:52,  2.60s/it]{'epoch': 21, 'num_users': 6.6364, 'loss': 0.0516, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 3.1536}:  33%|███▎      | 10/30 [00:26<00:52,  2.60s/it]{'epoch': 21, 'num_users': 6.6364, 'loss': 0.0516, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 3.1536}:  37%|███▋      | 11/30 [00:26<00:45,  2.39s/it]{'epoch': 21, 'num_users': 6.4167, 'loss': 0.0476, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.878, 'compress@10': 1.0, 'time@10': 3.1771}:  37%|███▋      | 11/30 [00:29<00:45,  2.39s/it] {'epoch': 21, 'num_users': 6.4167, 'loss': 0.0476, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.878, 'compress@10': 1.0, 'time@10': 3.1771}:  40%|████      | 12/30 [00:29<00:49,  2.73s/it]{'epoch': 21, 'num_users': 6.6154, 'loss': 0.0475, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8779, 'compress@10': 1.0, 'time@10': 3.193}:  40%|████      | 12/30 [00:31<00:49,  2.73s/it]{'epoch': 21, 'num_users': 6.6154, 'loss': 0.0475, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8779, 'compress@10': 1.0, 'time@10': 3.193}:  43%|████▎     | 13/30 [00:31<00:41,  2.42s/it]{'epoch': 21, 'num_users': 6.3571, 'loss': 0.0441, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8747, 'compress@10': 1.0, 'time@10': 3.199}:  43%|████▎     | 13/30 [00:34<00:41,  2.42s/it]{'epoch': 21, 'num_users': 6.3571, 'loss': 0.0441, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8747, 'compress@10': 1.0, 'time@10': 3.199}:  47%|████▋     | 14/30 [00:34<00:43,  2.69s/it]{'epoch': 21, 'num_users': 6.2667, 'loss': 0.0442, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.874, 'compress@10': 1.0, 'time@10': 3.2}:  47%|████▋     | 14/30 [00:36<00:43,  2.69s/it]   {'epoch': 21, 'num_users': 6.2667, 'loss': 0.0442, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.874, 'compress@10': 1.0, 'time@10': 3.2}:  50%|█████     | 15/30 [00:36<00:35,  2.38s/it]{'epoch': 21, 'num_users': 6.0625, 'loss': 0.0416, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8766, 'compress@10': 1.0, 'time@10': 3.2153}:  50%|█████     | 15/30 [00:39<00:35,  2.38s/it]{'epoch': 21, 'num_users': 6.0625, 'loss': 0.0416, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8766, 'compress@10': 1.0, 'time@10': 3.2153}:  53%|█████▎    | 16/30 [00:39<00:37,  2.71s/it]{'epoch': 21, 'num_users': 5.8235, 'loss': 0.0392, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 3.2321}:  53%|█████▎    | 16/30 [00:41<00:37,  2.71s/it]{'epoch': 21, 'num_users': 5.8235, 'loss': 0.0392, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 3.2321}:  57%|█████▋    | 17/30 [00:41<00:31,  2.44s/it]{'epoch': 21, 'num_users': 6.0556, 'loss': 0.0395, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 3.2347}:  57%|█████▋    | 17/30 [00:44<00:31,  2.44s/it]{'epoch': 21, 'num_users': 6.0556, 'loss': 0.0395, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 3.2347}:  60%|██████    | 18/30 [00:44<00:32,  2.70s/it]{'epoch': 21, 'num_users': 6.0, 'loss': 0.038, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8791, 'compress@10': 1.0, 'time@10': 3.2418}:  60%|██████    | 18/30 [00:46<00:32,  2.70s/it]     {'epoch': 21, 'num_users': 6.0, 'loss': 0.038, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8791, 'compress@10': 1.0, 'time@10': 3.2418}:  63%|██████▎   | 19/30 [00:46<00:26,  2.41s/it]{'epoch': 21, 'num_users': 6.15, 'loss': 0.0382, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8781, 'compress@10': 1.0, 'time@10': 3.2542}:  63%|██████▎   | 19/30 [00:50<00:26,  2.41s/it]{'epoch': 21, 'num_users': 6.15, 'loss': 0.0382, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8781, 'compress@10': 1.0, 'time@10': 3.2542}:  67%|██████▋   | 20/30 [00:50<00:27,  2.74s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0454, 'hit_ratio@10': 0.8255, 'ndcg@10': 0.8661, 'compress@10': 1.0, 'time@10': 3.1312}:  67%|██████▋   | 20/30 [00:50<00:27,  2.74s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0454, 'hit_ratio@10': 0.8255, 'ndcg@10': 0.8661, 'compress@10': 1.0, 'time@10': 3.1312}:  70%|███████   | 21/30 [00:50<00:18,  2.03s/it]{'epoch': 21, 'num_users': 6.1818, 'loss': 0.0439, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8687, 'compress@10': 1.0, 'time@10': 3.1519}:  70%|███████   | 21/30 [00:54<00:18,  2.03s/it]{'epoch': 21, 'num_users': 6.1818, 'loss': 0.0439, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8687, 'compress@10': 1.0, 'time@10': 3.1519}:  73%|███████▎  | 22/30 [00:54<00:20,  2.51s/it]{'epoch': 21, 'num_users': 6.1304, 'loss': 0.0429, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 3.1649}:  73%|███████▎  | 22/30 [00:55<00:20,  2.51s/it]{'epoch': 21, 'num_users': 6.1304, 'loss': 0.0429, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 3.1649}:  77%|███████▋  | 23/30 [00:55<00:16,  2.29s/it]{'epoch': 21, 'num_users': 5.9583, 'loss': 0.0411, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.1646}:  77%|███████▋  | 23/30 [00:59<00:16,  2.29s/it]{'epoch': 21, 'num_users': 5.9583, 'loss': 0.0411, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.1646}:  80%|████████  | 24/30 [00:59<00:15,  2.56s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0395, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8596, 'compress@10': 1.0, 'time@10': 3.1634}:  80%|████████  | 24/30 [01:00<00:15,  2.56s/it]   {'epoch': 21, 'num_users': 5.8, 'loss': 0.0395, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8596, 'compress@10': 1.0, 'time@10': 3.1634}:  83%|████████▎ | 25/30 [01:00<00:11,  2.27s/it]{'epoch': 21, 'num_users': 5.8077, 'loss': 0.0438, 'hit_ratio@10': 0.8124, 'ndcg@10': 0.8512, 'compress@10': 1.0, 'time@10': 3.0711}:  83%|████████▎ | 25/30 [01:01<00:11,  2.27s/it]{'epoch': 21, 'num_users': 5.8077, 'loss': 0.0438, 'hit_ratio@10': 0.8124, 'ndcg@10': 0.8512, 'compress@10': 1.0, 'time@10': 3.0711}:  87%|████████▋ | 26/30 [01:01<00:07,  1.83s/it]{'epoch': 21, 'num_users': 5.8889, 'loss': 0.0431, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8526, 'compress@10': 1.0, 'time@10': 3.1032}:  87%|████████▋ | 26/30 [01:03<00:07,  1.83s/it]{'epoch': 21, 'num_users': 5.8889, 'loss': 0.0431, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8526, 'compress@10': 1.0, 'time@10': 3.1032}:  90%|█████████ | 27/30 [01:03<00:05,  1.88s/it]{'epoch': 21, 'num_users': 6.0, 'loss': 0.0428, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.8545, 'compress@10': 1.0, 'time@10': 3.1214}:  90%|█████████ | 27/30 [01:07<00:05,  1.88s/it]   {'epoch': 21, 'num_users': 6.0, 'loss': 0.0428, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.8545, 'compress@10': 1.0, 'time@10': 3.1214}:  93%|█████████▎| 28/30 [01:07<00:04,  2.42s/it]{'epoch': 21, 'num_users': 5.8621, 'loss': 0.0418, 'hit_ratio@10': 0.8255, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 3.1316}:  93%|█████████▎| 28/30 [01:09<00:04,  2.42s/it]{'epoch': 21, 'num_users': 5.8621, 'loss': 0.0418, 'hit_ratio@10': 0.8255, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 3.1316}:  97%|█████████▋| 29/30 [01:09<00:02,  2.22s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0415, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 3.1436}:  97%|█████████▋| 29/30 [01:12<00:02,  2.22s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0415, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 3.1436}: 100%|██████████| 30/30 [01:12<00:00,  2.61s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0415, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 3.1436}: 100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch: 21
Avg # of users: 5.866666666666666
Avg Loss: 0.04154648535956926
Avg hit ratio: 0.8258659167179236
Avg ndcg: 0.8598837028421124
Avg compression ratio: 0.9999999860166272
Avg train time: 3.143594439824422
Std train time: 0.8372330240668275
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 34, 16, 9, 9, 8, 12, 7, 9, 7, 36, 9, 75, 7, 37, 50, 14, 15, 7, 9, 20, 10, 93, 92, 9, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0413, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.3012}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0413, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.3012}:   3%|▎         | 1/30 [00:01<00:48,  1.69s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8981, 'compress@10': 1.0, 'time@10': 3.4492}:   3%|▎         | 1/30 [00:05<00:48,  1.69s/it] {'epoch': 22, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8981, 'compress@10': 1.0, 'time@10': 3.4492}:   7%|▋         | 2/30 [00:05<01:19,  2.83s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.8844, 'compress@10': 1.0, 'time@10': 3.4214}:   7%|▋         | 2/30 [00:07<01:19,  2.83s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.8844, 'compress@10': 1.0, 'time@10': 3.4214}:  10%|█         | 3/30 [00:07<01:02,  2.33s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.7863, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 3.5202}:  10%|█         | 3/30 [00:10<01:02,  2.33s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.7863, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 3.5202}:  13%|█▎        | 4/30 [00:10<01:16,  2.93s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0321, 'hit_ratio@10': 0.797, 'ndcg@10': 0.8778, 'compress@10': 1.0, 'time@10': 4.4278}:  13%|█▎        | 4/30 [00:14<01:16,  2.93s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.0321, 'hit_ratio@10': 0.797, 'ndcg@10': 0.8778, 'compress@10': 1.0, 'time@10': 4.4278}:  17%|█▋        | 5/30 [00:14<01:23,  3.34s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0328, 'hit_ratio@10': 0.816, 'ndcg@10': 0.8763, 'compress@10': 1.0, 'time@10': 4.2954}:  17%|█▋        | 5/30 [00:18<01:23,  3.34s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0328, 'hit_ratio@10': 0.816, 'ndcg@10': 0.8763, 'compress@10': 1.0, 'time@10': 4.2954}:  20%|██        | 6/30 [00:18<01:22,  3.46s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0334, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 4.1953}:  20%|██        | 6/30 [00:20<01:22,  3.46s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0334, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 4.1953}:  23%|██▎       | 7/30 [00:20<01:07,  2.93s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0327, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 4.1303}:  23%|██▎       | 7/30 [00:24<01:07,  2.93s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0327, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 4.1303}:  27%|██▋       | 8/30 [00:24<01:09,  3.18s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0335, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8895, 'compress@10': 1.0, 'time@10': 4.1965}:  27%|██▋       | 8/30 [00:26<01:09,  3.18s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0335, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8895, 'compress@10': 1.0, 'time@10': 4.1965}:  30%|███       | 9/30 [00:26<01:01,  2.93s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0338, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 4.1269}:  30%|███       | 9/30 [00:30<01:01,  2.93s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0338, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 4.1269}:  33%|███▎      | 10/30 [00:30<01:02,  3.12s/it]{'epoch': 22, 'num_users': 6.6364, 'loss': 0.0353, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8904, 'compress@10': 1.0, 'time@10': 4.0084}:  33%|███▎      | 10/30 [00:31<01:02,  3.12s/it]{'epoch': 22, 'num_users': 6.6364, 'loss': 0.0353, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8904, 'compress@10': 1.0, 'time@10': 4.0084}:  37%|███▋      | 11/30 [00:31<00:49,  2.61s/it]{'epoch': 22, 'num_users': 6.4167, 'loss': 0.0326, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 3.9249}:  37%|███▋      | 11/30 [00:34<00:49,  2.61s/it] {'epoch': 22, 'num_users': 6.4167, 'loss': 0.0326, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 3.9249}:  40%|████      | 12/30 [00:34<00:49,  2.74s/it]{'epoch': 22, 'num_users': 6.6154, 'loss': 0.033, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.891, 'compress@10': 1.0, 'time@10': 3.9002}:  40%|████      | 12/30 [00:36<00:49,  2.74s/it] {'epoch': 22, 'num_users': 6.6154, 'loss': 0.033, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.891, 'compress@10': 1.0, 'time@10': 3.9002}:  43%|████▎     | 13/30 [00:36<00:41,  2.47s/it]{'epoch': 22, 'num_users': 6.3571, 'loss': 0.0307, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8869, 'compress@10': 1.0, 'time@10': 3.857}:  43%|████▎     | 13/30 [00:39<00:41,  2.47s/it]{'epoch': 22, 'num_users': 6.3571, 'loss': 0.0307, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8869, 'compress@10': 1.0, 'time@10': 3.857}:  47%|████▋     | 14/30 [00:39<00:43,  2.73s/it]{'epoch': 22, 'num_users': 6.2667, 'loss': 0.0319, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8843, 'compress@10': 1.0, 'time@10': 3.8334}:  47%|████▋     | 14/30 [00:41<00:43,  2.73s/it]{'epoch': 22, 'num_users': 6.2667, 'loss': 0.0319, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8843, 'compress@10': 1.0, 'time@10': 3.8334}:  50%|█████     | 15/30 [00:41<00:36,  2.44s/it]{'epoch': 22, 'num_users': 6.0625, 'loss': 0.0302, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8863, 'compress@10': 1.0, 'time@10': 3.7967}:  50%|█████     | 15/30 [00:44<00:36,  2.44s/it]{'epoch': 22, 'num_users': 6.0625, 'loss': 0.0302, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8863, 'compress@10': 1.0, 'time@10': 3.7967}:  53%|█████▎    | 16/30 [00:44<00:37,  2.70s/it]{'epoch': 22, 'num_users': 5.8235, 'loss': 0.0285, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 3.78}:  53%|█████▎    | 16/30 [00:46<00:37,  2.70s/it]  {'epoch': 22, 'num_users': 5.8235, 'loss': 0.0285, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 3.78}:  57%|█████▋    | 17/30 [00:46<00:31,  2.43s/it]{'epoch': 22, 'num_users': 6.0556, 'loss': 0.0286, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 3.7776}:  57%|█████▋    | 17/30 [00:50<00:31,  2.43s/it]{'epoch': 22, 'num_users': 6.0556, 'loss': 0.0286, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 3.7776}:  60%|██████    | 18/30 [00:50<00:34,  2.83s/it]{'epoch': 22, 'num_users': 6.0, 'loss': 0.0275, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 3.7709}:  60%|██████    | 18/30 [00:52<00:34,  2.83s/it]   {'epoch': 22, 'num_users': 6.0, 'loss': 0.0275, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 3.7709}:  63%|██████▎   | 19/30 [00:52<00:28,  2.55s/it]{'epoch': 22, 'num_users': 6.15, 'loss': 0.0282, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8803, 'compress@10': 1.0, 'time@10': 3.768}:  63%|██████▎   | 19/30 [00:56<00:28,  2.55s/it]{'epoch': 22, 'num_users': 6.15, 'loss': 0.0282, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8803, 'compress@10': 1.0, 'time@10': 3.768}:  67%|██████▋   | 20/30 [00:56<00:29,  2.92s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0301, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 3.9063}:  67%|██████▋   | 20/30 [00:59<00:29,  2.92s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0301, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 3.9063}:  70%|███████   | 21/30 [00:59<00:27,  3.05s/it]{'epoch': 22, 'num_users': 6.1818, 'loss': 0.0299, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 3.8936}:  70%|███████   | 21/30 [01:03<00:27,  3.05s/it] {'epoch': 22, 'num_users': 6.1818, 'loss': 0.0299, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 3.8936}:  73%|███████▎  | 22/30 [01:03<00:25,  3.24s/it]{'epoch': 22, 'num_users': 6.1304, 'loss': 0.0295, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8816, 'compress@10': 1.0, 'time@10': 3.8707}:  73%|███████▎  | 22/30 [01:04<00:25,  3.24s/it]{'epoch': 22, 'num_users': 6.1304, 'loss': 0.0295, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8816, 'compress@10': 1.0, 'time@10': 3.8707}:  77%|███████▋  | 23/30 [01:04<00:19,  2.79s/it]{'epoch': 22, 'num_users': 5.9583, 'loss': 0.0283, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8782, 'compress@10': 1.0, 'time@10': 3.8457}:  77%|███████▋  | 23/30 [01:08<00:19,  2.79s/it]{'epoch': 22, 'num_users': 5.9583, 'loss': 0.0283, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8782, 'compress@10': 1.0, 'time@10': 3.8457}:  80%|████████  | 24/30 [01:08<00:18,  3.09s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0271, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8698, 'compress@10': 1.0, 'time@10': 3.8211}:  80%|████████  | 24/30 [01:10<00:18,  3.09s/it]   {'epoch': 22, 'num_users': 5.8, 'loss': 0.0271, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8698, 'compress@10': 1.0, 'time@10': 3.8211}:  83%|████████▎ | 25/30 [01:10<00:13,  2.66s/it]{'epoch': 22, 'num_users': 5.8077, 'loss': 0.0275, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 3.9164}:  83%|████████▎ | 25/30 [01:16<00:13,  2.66s/it]{'epoch': 22, 'num_users': 5.8077, 'loss': 0.0275, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 3.9164}:  87%|████████▋ | 26/30 [01:16<00:15,  3.76s/it]{'epoch': 22, 'num_users': 5.8889, 'loss': 0.0274, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8708, 'compress@10': 1.0, 'time@10': 3.895}:  87%|████████▋ | 26/30 [01:18<00:15,  3.76s/it]{'epoch': 22, 'num_users': 5.8889, 'loss': 0.0274, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8708, 'compress@10': 1.0, 'time@10': 3.895}:  90%|█████████ | 27/30 [01:18<00:09,  3.15s/it]{'epoch': 22, 'num_users': 6.0, 'loss': 0.0277, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 3.8703}:  90%|█████████ | 27/30 [01:21<00:09,  3.15s/it]  {'epoch': 22, 'num_users': 6.0, 'loss': 0.0277, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 3.8703}:  93%|█████████▎| 28/30 [01:21<00:06,  3.17s/it]{'epoch': 22, 'num_users': 5.8621, 'loss': 0.0277, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8733, 'compress@10': 1.0, 'time@10': 3.8597}:  93%|█████████▎| 28/30 [01:23<00:06,  3.17s/it]{'epoch': 22, 'num_users': 5.8621, 'loss': 0.0277, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8733, 'compress@10': 1.0, 'time@10': 3.8597}:  97%|█████████▋| 29/30 [01:23<00:02,  2.77s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0275, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8752, 'compress@10': 1.0, 'time@10': 3.8537}:  97%|█████████▋| 29/30 [01:27<00:02,  2.77s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0275, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8752, 'compress@10': 1.0, 'time@10': 3.8537}: 100%|██████████| 30/30 [01:27<00:00,  3.05s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0275, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8752, 'compress@10': 1.0, 'time@10': 3.8537}: 100%|██████████| 30/30 [01:27<00:00,  2.91s/it]
Epoch: 22
Avg # of users: 5.866666666666666
Avg Loss: 0.027511682917235956
Avg hit ratio: 0.8445203334113546
Avg ndcg: 0.8752232891828585
Avg compression ratio: 0.9999999860153537
Avg train time: 3.8536932865778604
Std train time: 1.12421016125096
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 34, 15, 1, 8, 8, 11, 3, 9, 9, 37, 9, 75, 7, 38, 50, 13, 14, 6, 1, 19, 10, 93, 93, 1, 7, 8, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.4874}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.4874}:   3%|▎         | 1/30 [00:01<00:51,  1.79s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 3.4188}:   3%|▎         | 1/30 [00:05<00:51,  1.79s/it] {'epoch': 23, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 3.4188}:   7%|▋         | 2/30 [00:05<01:16,  2.73s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 3.4439}:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 3.4439}:  10%|█         | 3/30 [00:06<01:02,  2.30s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.9104, 'compress@10': 1.0, 'time@10': 3.453}:  10%|█         | 3/30 [00:10<01:02,  2.30s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.9104, 'compress@10': 1.0, 'time@10': 3.453}:  13%|█▎        | 4/30 [00:10<01:12,  2.79s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0642, 'hit_ratio@10': 0.7732, 'ndcg@10': 0.841, 'compress@10': 1.0, 'time@10': 2.9343}:  13%|█▎        | 4/30 [00:10<01:12,  2.79s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0642, 'hit_ratio@10': 0.7732, 'ndcg@10': 0.841, 'compress@10': 1.0, 'time@10': 2.9343}:  17%|█▋        | 5/30 [00:10<00:48,  1.95s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0597, 'hit_ratio@10': 0.7925, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 2.9768}:  17%|█▋        | 5/30 [00:14<00:48,  1.95s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0597, 'hit_ratio@10': 0.7925, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 2.9768}:  20%|██        | 6/30 [00:14<00:57,  2.38s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0563, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8539, 'compress@10': 1.0, 'time@10': 3.041}:  20%|██        | 6/30 [00:15<00:57,  2.38s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0563, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8539, 'compress@10': 1.0, 'time@10': 3.041}:  23%|██▎       | 7/30 [00:15<00:50,  2.18s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0527, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8631, 'compress@10': 1.0, 'time@10': 3.0572}:  23%|██▎       | 7/30 [00:19<00:50,  2.18s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0527, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8631, 'compress@10': 1.0, 'time@10': 3.0572}:  27%|██▋       | 8/30 [00:19<00:55,  2.51s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0516, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8675, 'compress@10': 1.0, 'time@10': 2.9073}:  27%|██▋       | 8/30 [00:20<00:55,  2.51s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0516, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8675, 'compress@10': 1.0, 'time@10': 2.9073}:  30%|███       | 9/30 [00:20<00:42,  2.00s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8722, 'compress@10': 1.0, 'time@10': 2.9665}:  30%|███       | 9/30 [00:23<00:42,  2.00s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8722, 'compress@10': 1.0, 'time@10': 2.9665}:  33%|███▎      | 10/30 [00:23<00:49,  2.47s/it]{'epoch': 23, 'num_users': 6.6364, 'loss': 0.0488, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 3.0482}:  33%|███▎      | 10/30 [00:25<00:49,  2.47s/it]{'epoch': 23, 'num_users': 6.6364, 'loss': 0.0488, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 3.0482}:  37%|███▋      | 11/30 [00:25<00:44,  2.32s/it]{'epoch': 23, 'num_users': 6.4167, 'loss': 0.0449, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8756, 'compress@10': 1.0, 'time@10': 3.0853}:  37%|███▋      | 11/30 [00:29<00:44,  2.32s/it]{'epoch': 23, 'num_users': 6.4167, 'loss': 0.0449, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8756, 'compress@10': 1.0, 'time@10': 3.0853}:  40%|████      | 12/30 [00:29<00:48,  2.69s/it]{'epoch': 23, 'num_users': 6.6154, 'loss': 0.0446, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8753, 'compress@10': 1.0, 'time@10': 3.1225}:  40%|████      | 12/30 [00:30<00:48,  2.69s/it]{'epoch': 23, 'num_users': 6.6154, 'loss': 0.0446, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8753, 'compress@10': 1.0, 'time@10': 3.1225}:  43%|████▎     | 13/30 [00:30<00:41,  2.43s/it]{'epoch': 23, 'num_users': 6.3571, 'loss': 0.0414, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.131}:  43%|████▎     | 13/30 [00:34<00:41,  2.43s/it] {'epoch': 23, 'num_users': 6.3571, 'loss': 0.0414, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.131}:  47%|████▋     | 14/30 [00:34<00:42,  2.68s/it]{'epoch': 23, 'num_users': 6.2667, 'loss': 0.0417, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8714, 'compress@10': 1.0, 'time@10': 3.163}:  47%|████▋     | 14/30 [00:36<00:42,  2.68s/it] {'epoch': 23, 'num_users': 6.2667, 'loss': 0.0417, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8714, 'compress@10': 1.0, 'time@10': 3.163}:  50%|█████     | 15/30 [00:36<00:36,  2.43s/it]{'epoch': 23, 'num_users': 6.0625, 'loss': 0.0391, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8743, 'compress@10': 1.0, 'time@10': 3.1838}:  50%|█████     | 15/30 [00:39<00:36,  2.43s/it]{'epoch': 23, 'num_users': 6.0625, 'loss': 0.0391, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8743, 'compress@10': 1.0, 'time@10': 3.1838}:  53%|█████▎    | 16/30 [00:39<00:38,  2.76s/it]{'epoch': 23, 'num_users': 5.8235, 'loss': 0.0369, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8699, 'compress@10': 1.0, 'time@10': 3.1733}:  53%|█████▎    | 16/30 [00:41<00:38,  2.76s/it]{'epoch': 23, 'num_users': 5.8235, 'loss': 0.0369, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8699, 'compress@10': 1.0, 'time@10': 3.1733}:  57%|█████▋    | 17/30 [00:41<00:31,  2.40s/it]{'epoch': 23, 'num_users': 6.0556, 'loss': 0.0363, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.1667}:  57%|█████▋    | 17/30 [00:44<00:31,  2.40s/it]{'epoch': 23, 'num_users': 6.0556, 'loss': 0.0363, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.1667}:  60%|██████    | 18/30 [00:44<00:31,  2.61s/it]{'epoch': 23, 'num_users': 6.0, 'loss': 0.0349, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 3.1716}:  60%|██████    | 18/30 [00:45<00:31,  2.61s/it]   {'epoch': 23, 'num_users': 6.0, 'loss': 0.0349, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 3.1716}:  63%|██████▎   | 19/30 [00:45<00:25,  2.32s/it]{'epoch': 23, 'num_users': 6.15, 'loss': 0.0351, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 3.1683}:  63%|██████▎   | 19/30 [00:49<00:25,  2.32s/it]{'epoch': 23, 'num_users': 6.15, 'loss': 0.0351, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 3.1683}:  67%|██████▋   | 20/30 [00:49<00:25,  2.57s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0424, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 3.0508}:  67%|██████▋   | 20/30 [00:49<00:25,  2.57s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0424, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 3.0508}:  70%|███████   | 21/30 [00:49<00:17,  1.91s/it]{'epoch': 23, 'num_users': 6.1818, 'loss': 0.0412, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.8657, 'compress@10': 1.0, 'time@10': 3.0588}:  70%|███████   | 21/30 [00:52<00:17,  1.91s/it]{'epoch': 23, 'num_users': 6.1818, 'loss': 0.0412, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.8657, 'compress@10': 1.0, 'time@10': 3.0588}:  73%|███████▎  | 22/30 [00:52<00:18,  2.32s/it]{'epoch': 23, 'num_users': 6.1304, 'loss': 0.0403, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.0677}:  73%|███████▎  | 22/30 [00:54<00:18,  2.32s/it]{'epoch': 23, 'num_users': 6.1304, 'loss': 0.0403, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.0677}:  77%|███████▋  | 23/30 [00:54<00:14,  2.12s/it]{'epoch': 23, 'num_users': 5.9583, 'loss': 0.0386, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8648, 'compress@10': 1.0, 'time@10': 3.0736}:  77%|███████▋  | 23/30 [00:57<00:14,  2.12s/it]{'epoch': 23, 'num_users': 5.9583, 'loss': 0.0386, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8648, 'compress@10': 1.0, 'time@10': 3.0736}:  80%|████████  | 24/30 [00:57<00:14,  2.46s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0371, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.8569, 'compress@10': 1.0, 'time@10': 3.0793}:  80%|████████  | 24/30 [00:59<00:14,  2.46s/it]   {'epoch': 23, 'num_users': 5.8, 'loss': 0.0371, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.8569, 'compress@10': 1.0, 'time@10': 3.0793}:  83%|████████▎ | 25/30 [00:59<00:11,  2.22s/it]{'epoch': 23, 'num_users': 5.8077, 'loss': 0.0413, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8488, 'compress@10': 1.0, 'time@10': 2.9902}:  83%|████████▎ | 25/30 [01:00<00:11,  2.22s/it]{'epoch': 23, 'num_users': 5.8077, 'loss': 0.0413, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8488, 'compress@10': 1.0, 'time@10': 2.9902}:  87%|████████▋ | 26/30 [01:00<00:07,  1.79s/it]{'epoch': 23, 'num_users': 5.8889, 'loss': 0.0406, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.8506, 'compress@10': 1.0, 'time@10': 3.0081}:  87%|████████▋ | 26/30 [01:01<00:07,  1.79s/it]{'epoch': 23, 'num_users': 5.8889, 'loss': 0.0406, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.8506, 'compress@10': 1.0, 'time@10': 3.0081}:  90%|█████████ | 27/30 [01:01<00:05,  1.79s/it]{'epoch': 23, 'num_users': 6.0, 'loss': 0.0403, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8528, 'compress@10': 1.0, 'time@10': 3.024}:  90%|█████████ | 27/30 [01:05<00:05,  1.79s/it]    {'epoch': 23, 'num_users': 6.0, 'loss': 0.0403, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8528, 'compress@10': 1.0, 'time@10': 3.024}:  93%|█████████▎| 28/30 [01:05<00:04,  2.30s/it]{'epoch': 23, 'num_users': 5.8621, 'loss': 0.0397, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 3.0431}:  93%|█████████▎| 28/30 [01:07<00:04,  2.30s/it]{'epoch': 23, 'num_users': 5.8621, 'loss': 0.0397, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 3.0431}:  97%|█████████▋| 29/30 [01:07<00:02,  2.16s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0392, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.857, 'compress@10': 1.0, 'time@10': 3.0514}:  97%|█████████▋| 29/30 [01:10<00:02,  2.16s/it] {'epoch': 23, 'num_users': 5.8667, 'loss': 0.0392, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.857, 'compress@10': 1.0, 'time@10': 3.0514}: 100%|██████████| 30/30 [01:10<00:00,  2.51s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0392, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.857, 'compress@10': 1.0, 'time@10': 3.0514}: 100%|██████████| 30/30 [01:10<00:00,  2.35s/it]
Epoch: 23
Avg # of users: 5.866666666666666
Avg Loss: 0.039173750763586423
Avg hit ratio: 0.8347419707854509
Avg ndcg: 0.8569997821710853
Avg compression ratio: 0.9999999860166272
Avg train time: 3.051440445582072
Std train time: 0.8350803803158251
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 34, 15, 9, 9, 8, 12, 8, 9, 8, 37, 9, 76, 6, 38, 51, 14, 15, 7, 9, 20, 11, 94, 94, 9, 7, 8, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 3.2823}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 3.2823}:   3%|▎         | 1/30 [00:01<00:48,  1.68s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8984, 'compress@10': 1.0, 'time@10': 3.4116}:   3%|▎         | 1/30 [00:05<00:48,  1.68s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8984, 'compress@10': 1.0, 'time@10': 3.4116}:   7%|▋         | 2/30 [00:05<01:18,  2.80s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.74, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 3.4342}:   7%|▋         | 2/30 [00:07<01:18,  2.80s/it]  {'epoch': 24, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.74, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 3.4342}:  10%|█         | 3/30 [00:07<01:02,  2.33s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.9035, 'compress@10': 1.0, 'time@10': 3.4775}:  10%|█         | 3/30 [00:10<01:02,  2.33s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.9035, 'compress@10': 1.0, 'time@10': 3.4775}:  13%|█▎        | 4/30 [00:10<01:14,  2.85s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0288, 'hit_ratio@10': 0.8089, 'ndcg@10': 0.8851, 'compress@10': 1.0, 'time@10': 4.4102}:  13%|█▎        | 4/30 [00:14<01:14,  2.85s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0288, 'hit_ratio@10': 0.8089, 'ndcg@10': 0.8851, 'compress@10': 1.0, 'time@10': 4.4102}:  17%|█▋        | 5/30 [00:14<01:22,  3.31s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0294, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 4.2665}:  17%|█▋        | 5/30 [00:18<01:22,  3.31s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0294, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 4.2665}:  20%|██        | 6/30 [00:18<01:21,  3.40s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0305, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 4.1695}:  20%|██        | 6/30 [00:20<01:21,  3.40s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0305, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 4.1695}:  23%|██▎       | 7/30 [00:20<01:06,  2.89s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0311, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.8819, 'compress@10': 1.0, 'time@10': 4.0903}:  23%|██▎       | 7/30 [00:23<01:06,  2.89s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0311, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.8819, 'compress@10': 1.0, 'time@10': 4.0903}:  27%|██▋       | 8/30 [00:23<01:08,  3.11s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0325, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 4.1399}:  27%|██▋       | 8/30 [00:26<01:08,  3.11s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0325, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 4.1399}:  30%|███       | 9/30 [00:26<01:00,  2.86s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8926, 'compress@10': 1.0, 'time@10': 4.0763}:  30%|███       | 9/30 [00:29<01:00,  2.86s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8926, 'compress@10': 1.0, 'time@10': 4.0763}:  33%|███▎      | 10/30 [00:29<01:01,  3.07s/it]{'epoch': 24, 'num_users': 6.6364, 'loss': 0.0331, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.891, 'compress@10': 1.0, 'time@10': 4.0361}:  33%|███▎      | 10/30 [00:31<01:01,  3.07s/it]{'epoch': 24, 'num_users': 6.6364, 'loss': 0.0331, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.891, 'compress@10': 1.0, 'time@10': 4.0361}:  37%|███▋      | 11/30 [00:31<00:51,  2.70s/it]{'epoch': 24, 'num_users': 6.4167, 'loss': 0.0305, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8932, 'compress@10': 1.0, 'time@10': 3.9879}:  37%|███▋      | 11/30 [00:35<00:51,  2.70s/it]{'epoch': 24, 'num_users': 6.4167, 'loss': 0.0305, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8932, 'compress@10': 1.0, 'time@10': 3.9879}:  40%|████      | 12/30 [00:35<00:53,  2.94s/it]{'epoch': 24, 'num_users': 6.6154, 'loss': 0.0312, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 3.9561}:  40%|████      | 12/30 [00:36<00:53,  2.94s/it]{'epoch': 24, 'num_users': 6.6154, 'loss': 0.0312, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 3.9561}:  43%|████▎     | 13/30 [00:36<00:44,  2.61s/it]{'epoch': 24, 'num_users': 6.3571, 'loss': 0.0289, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 3.9079}:  43%|████▎     | 13/30 [00:40<00:44,  2.61s/it]{'epoch': 24, 'num_users': 6.3571, 'loss': 0.0289, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 3.9079}:  47%|████▋     | 14/30 [00:40<00:45,  2.82s/it]{'epoch': 24, 'num_users': 6.2667, 'loss': 0.0298, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 3.8534}:  47%|████▋     | 14/30 [00:41<00:45,  2.82s/it] {'epoch': 24, 'num_users': 6.2667, 'loss': 0.0298, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 3.8534}:  50%|█████     | 15/30 [00:41<00:36,  2.45s/it]{'epoch': 24, 'num_users': 6.0625, 'loss': 0.028, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.888, 'compress@10': 1.0, 'time@10': 3.8374}:  50%|█████     | 15/30 [00:45<00:36,  2.45s/it] {'epoch': 24, 'num_users': 6.0625, 'loss': 0.028, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.888, 'compress@10': 1.0, 'time@10': 3.8374}:  53%|█████▎    | 16/30 [00:45<00:39,  2.81s/it]{'epoch': 24, 'num_users': 5.8235, 'loss': 0.0264, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8828, 'compress@10': 1.0, 'time@10': 3.8184}:  53%|█████▎    | 16/30 [00:47<00:39,  2.81s/it]{'epoch': 24, 'num_users': 5.8235, 'loss': 0.0264, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8828, 'compress@10': 1.0, 'time@10': 3.8184}:  57%|█████▋    | 17/30 [00:47<00:32,  2.50s/it]{'epoch': 24, 'num_users': 6.0556, 'loss': 0.0265, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8835, 'compress@10': 1.0, 'time@10': 3.7958}:  57%|█████▋    | 17/30 [00:50<00:32,  2.50s/it]{'epoch': 24, 'num_users': 6.0556, 'loss': 0.0265, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8835, 'compress@10': 1.0, 'time@10': 3.7958}:  60%|██████    | 18/30 [00:50<00:33,  2.79s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 0.0256, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8851, 'compress@10': 1.0, 'time@10': 3.7876}:  60%|██████    | 18/30 [00:52<00:33,  2.79s/it]   {'epoch': 24, 'num_users': 6.0, 'loss': 0.0256, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8851, 'compress@10': 1.0, 'time@10': 3.7876}:  63%|██████▎   | 19/30 [00:52<00:27,  2.51s/it]{'epoch': 24, 'num_users': 6.15, 'loss': 0.0262, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8843, 'compress@10': 1.0, 'time@10': 3.7783}:  63%|██████▎   | 19/30 [00:56<00:27,  2.51s/it]{'epoch': 24, 'num_users': 6.15, 'loss': 0.0262, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8843, 'compress@10': 1.0, 'time@10': 3.7783}:  67%|██████▋   | 20/30 [00:56<00:28,  2.85s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.028, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8814, 'compress@10': 1.0, 'time@10': 3.9063}:  67%|██████▋   | 20/30 [00:59<00:28,  2.85s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.028, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8814, 'compress@10': 1.0, 'time@10': 3.9063}:  70%|███████   | 21/30 [00:59<00:26,  2.98s/it]{'epoch': 24, 'num_users': 6.1818, 'loss': 0.0273, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8834, 'compress@10': 1.0, 'time@10': 3.8972}:  70%|███████   | 21/30 [01:03<00:26,  2.98s/it]{'epoch': 24, 'num_users': 6.1818, 'loss': 0.0273, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8834, 'compress@10': 1.0, 'time@10': 3.8972}:  73%|███████▎  | 22/30 [01:03<00:25,  3.21s/it]{'epoch': 24, 'num_users': 6.1304, 'loss': 0.0272, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8844, 'compress@10': 1.0, 'time@10': 3.8683}:  73%|███████▎  | 22/30 [01:04<00:25,  3.21s/it] {'epoch': 24, 'num_users': 6.1304, 'loss': 0.0272, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8844, 'compress@10': 1.0, 'time@10': 3.8683}:  77%|███████▋  | 23/30 [01:04<00:19,  2.74s/it]{'epoch': 24, 'num_users': 5.9583, 'loss': 0.0261, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 3.8297}:  77%|███████▋  | 23/30 [01:07<00:19,  2.74s/it]{'epoch': 24, 'num_users': 5.9583, 'loss': 0.0261, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 3.8297}:  80%|████████  | 24/30 [01:07<00:16,  2.82s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.025, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.807}:  80%|████████  | 24/30 [01:09<00:16,  2.82s/it]     {'epoch': 24, 'num_users': 5.8, 'loss': 0.025, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.807}:  83%|████████▎ | 25/30 [01:09<00:12,  2.47s/it]{'epoch': 24, 'num_users': 5.8077, 'loss': 0.0254, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8729, 'compress@10': 1.0, 'time@10': 3.9031}:  83%|████████▎ | 25/30 [01:15<00:12,  2.47s/it]{'epoch': 24, 'num_users': 5.8077, 'loss': 0.0254, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8729, 'compress@10': 1.0, 'time@10': 3.9031}:  87%|████████▋ | 26/30 [01:15<00:14,  3.63s/it]{'epoch': 24, 'num_users': 5.8889, 'loss': 0.0253, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8739, 'compress@10': 1.0, 'time@10': 3.8722}:  87%|████████▋ | 26/30 [01:17<00:14,  3.63s/it]{'epoch': 24, 'num_users': 5.8889, 'loss': 0.0253, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8739, 'compress@10': 1.0, 'time@10': 3.8722}:  90%|█████████ | 27/30 [01:17<00:09,  3.01s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 0.0255, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.8753, 'compress@10': 1.0, 'time@10': 3.8649}:  90%|█████████ | 27/30 [01:21<00:09,  3.01s/it]   {'epoch': 24, 'num_users': 6.0, 'loss': 0.0255, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.8753, 'compress@10': 1.0, 'time@10': 3.8649}:  93%|█████████▎| 28/30 [01:21<00:06,  3.24s/it]{'epoch': 24, 'num_users': 5.8621, 'loss': 0.0254, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.8586}:  93%|█████████▎| 28/30 [01:23<00:06,  3.24s/it]{'epoch': 24, 'num_users': 5.8621, 'loss': 0.0254, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.8586}:  97%|█████████▋| 29/30 [01:23<00:02,  2.83s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0255, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8783, 'compress@10': 1.0, 'time@10': 3.8443}:  97%|█████████▋| 29/30 [01:26<00:02,  2.83s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0255, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8783, 'compress@10': 1.0, 'time@10': 3.8443}: 100%|██████████| 30/30 [01:26<00:00,  3.02s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0255, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8783, 'compress@10': 1.0, 'time@10': 3.8443}: 100%|██████████| 30/30 [01:26<00:00,  2.88s/it]
Epoch: 24
Avg # of users: 5.866666666666666
Avg Loss: 0.025467360875096583
Avg hit ratio: 0.851066351827991
Avg ndcg: 0.8783404338205533
Avg compression ratio: 0.9999999860153537
Avg train time: 3.844310744603475
Std train time: 1.107989336249646
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 34, 15, 1, 9, 8, 12, 5, 9, 7, 37, 9, 76, 7, 38, 51, 14, 14, 7, 1, 19, 12, 95, 95, 1, 8, 7, 9, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0364, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 3.3655}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0364, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 3.3655}:   3%|▎         | 1/30 [00:01<00:49,  1.72s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9011, 'compress@10': 1.0, 'time@10': 3.4018}:   3%|▎         | 1/30 [00:05<00:49,  1.72s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9011, 'compress@10': 1.0, 'time@10': 3.4018}:   7%|▋         | 2/30 [00:05<01:17,  2.75s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.8865, 'compress@10': 1.0, 'time@10': 3.3275}:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.8865, 'compress@10': 1.0, 'time@10': 3.3275}:  10%|█         | 3/30 [00:06<01:00,  2.24s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 3.3105}:  10%|█         | 3/30 [00:10<01:00,  2.24s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 3.3105}:  13%|█▎        | 4/30 [00:10<01:09,  2.66s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0575, 'hit_ratio@10': 0.7773, 'ndcg@10': 0.8351, 'compress@10': 1.0, 'time@10': 2.8178}:  13%|█▎        | 4/30 [00:10<01:09,  2.66s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0575, 'hit_ratio@10': 0.7773, 'ndcg@10': 0.8351, 'compress@10': 1.0, 'time@10': 2.8178}:  17%|█▋        | 5/30 [00:10<00:46,  1.87s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0533, 'hit_ratio@10': 0.7996, 'ndcg@10': 0.8434, 'compress@10': 1.0, 'time@10': 2.9498}:  17%|█▋        | 5/30 [00:14<00:46,  1.87s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0533, 'hit_ratio@10': 0.7996, 'ndcg@10': 0.8434, 'compress@10': 1.0, 'time@10': 2.9498}:  20%|██        | 6/30 [00:14<00:59,  2.47s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.8499, 'compress@10': 1.0, 'time@10': 3.0073}:  20%|██        | 6/30 [00:15<00:59,  2.47s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.8499, 'compress@10': 1.0, 'time@10': 3.0073}:  23%|██▎       | 7/30 [00:15<00:51,  2.23s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0483, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.864, 'compress@10': 1.0, 'time@10': 3.0555}:  23%|██▎       | 7/30 [00:19<00:51,  2.23s/it]  {'epoch': 25, 'num_users': 6.125, 'loss': 0.0483, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.864, 'compress@10': 1.0, 'time@10': 3.0555}:  27%|██▋       | 8/30 [00:19<00:57,  2.61s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0464, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.8701, 'compress@10': 1.0, 'time@10': 3.0439}:  27%|██▋       | 8/30 [00:20<00:57,  2.61s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0464, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.8701, 'compress@10': 1.0, 'time@10': 3.0439}:  30%|███       | 9/30 [00:20<00:47,  2.27s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0447, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.0763}:  30%|███       | 9/30 [00:24<00:47,  2.27s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0447, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.0763}:  33%|███▎      | 10/30 [00:24<00:52,  2.62s/it]{'epoch': 25, 'num_users': 6.6364, 'loss': 0.0449, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.098}:  33%|███▎      | 10/30 [00:25<00:52,  2.62s/it]{'epoch': 25, 'num_users': 6.6364, 'loss': 0.0449, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.098}:  37%|███▋      | 11/30 [00:25<00:44,  2.34s/it]{'epoch': 25, 'num_users': 6.4167, 'loss': 0.0414, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 3.1405}:  37%|███▋      | 11/30 [00:29<00:44,  2.34s/it]{'epoch': 25, 'num_users': 6.4167, 'loss': 0.0414, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 3.1405}:  40%|████      | 12/30 [00:29<00:49,  2.73s/it]{'epoch': 25, 'num_users': 6.6154, 'loss': 0.0412, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 3.1601}:  40%|████      | 12/30 [00:31<00:49,  2.73s/it]{'epoch': 25, 'num_users': 6.6154, 'loss': 0.0412, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 3.1601}:  43%|████▎     | 13/30 [00:31<00:41,  2.43s/it]{'epoch': 25, 'num_users': 6.3571, 'loss': 0.0383, 'hit_ratio@10': 0.8255, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 3.1679}:  43%|████▎     | 13/30 [00:34<00:41,  2.43s/it]{'epoch': 25, 'num_users': 6.3571, 'loss': 0.0383, 'hit_ratio@10': 0.8255, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 3.1679}:  47%|████▋     | 14/30 [00:34<00:43,  2.70s/it]{'epoch': 25, 'num_users': 6.2667, 'loss': 0.0388, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8741, 'compress@10': 1.0, 'time@10': 3.2015}:  47%|████▋     | 14/30 [00:36<00:43,  2.70s/it] {'epoch': 25, 'num_users': 6.2667, 'loss': 0.0388, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8741, 'compress@10': 1.0, 'time@10': 3.2015}:  50%|█████     | 15/30 [00:36<00:36,  2.45s/it]{'epoch': 25, 'num_users': 6.0625, 'loss': 0.0364, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8768, 'compress@10': 1.0, 'time@10': 3.2266}:  50%|█████     | 15/30 [00:40<00:36,  2.45s/it]{'epoch': 25, 'num_users': 6.0625, 'loss': 0.0364, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8768, 'compress@10': 1.0, 'time@10': 3.2266}:  53%|█████▎    | 16/30 [00:40<00:39,  2.81s/it]{'epoch': 25, 'num_users': 5.8235, 'loss': 0.0343, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.2356}:  53%|█████▎    | 16/30 [00:41<00:39,  2.81s/it]{'epoch': 25, 'num_users': 5.8235, 'loss': 0.0343, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.2356}:  57%|█████▋    | 17/30 [00:41<00:32,  2.48s/it]{'epoch': 25, 'num_users': 6.0556, 'loss': 0.0345, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 3.2421}:  57%|█████▋    | 17/30 [00:45<00:32,  2.48s/it]{'epoch': 25, 'num_users': 6.0556, 'loss': 0.0345, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 3.2421}:  60%|██████    | 18/30 [00:45<00:33,  2.76s/it]{'epoch': 25, 'num_users': 6.0, 'loss': 0.0332, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8793, 'compress@10': 1.0, 'time@10': 3.2281}:  60%|██████    | 18/30 [00:46<00:33,  2.76s/it]   {'epoch': 25, 'num_users': 6.0, 'loss': 0.0332, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8793, 'compress@10': 1.0, 'time@10': 3.2281}:  63%|██████▎   | 19/30 [00:46<00:26,  2.39s/it]{'epoch': 25, 'num_users': 6.15, 'loss': 0.0334, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.879, 'compress@10': 1.0, 'time@10': 3.2455}:  63%|██████▎   | 19/30 [00:50<00:26,  2.39s/it]{'epoch': 25, 'num_users': 6.15, 'loss': 0.0334, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.879, 'compress@10': 1.0, 'time@10': 3.2455}:  67%|██████▋   | 20/30 [00:50<00:27,  2.76s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0407, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 3.1251}:  67%|██████▋   | 20/30 [00:50<00:27,  2.76s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0407, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 3.1251}:  70%|███████   | 21/30 [00:50<00:18,  2.05s/it]{'epoch': 25, 'num_users': 6.1818, 'loss': 0.0397, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.8701, 'compress@10': 1.0, 'time@10': 3.1391}:  70%|███████   | 21/30 [00:54<00:18,  2.05s/it]{'epoch': 25, 'num_users': 6.1818, 'loss': 0.0397, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.8701, 'compress@10': 1.0, 'time@10': 3.1391}:  73%|███████▎  | 22/30 [00:54<00:19,  2.47s/it]{'epoch': 25, 'num_users': 6.1304, 'loss': 0.0386, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.1726}:  73%|███████▎  | 22/30 [00:56<00:19,  2.47s/it]{'epoch': 25, 'num_users': 6.1304, 'loss': 0.0386, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.1726}:  77%|███████▋  | 23/30 [00:56<00:16,  2.33s/it]{'epoch': 25, 'num_users': 5.9583, 'loss': 0.037, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.8693, 'compress@10': 1.0, 'time@10': 3.1765}:  77%|███████▋  | 23/30 [00:59<00:16,  2.33s/it] {'epoch': 25, 'num_users': 5.9583, 'loss': 0.037, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.8693, 'compress@10': 1.0, 'time@10': 3.1765}:  80%|████████  | 24/30 [00:59<00:15,  2.62s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0355, 'hit_ratio@10': 0.8146, 'ndcg@10': 0.8612, 'compress@10': 1.0, 'time@10': 3.1803}:  80%|████████  | 24/30 [01:01<00:15,  2.62s/it]  {'epoch': 25, 'num_users': 5.8, 'loss': 0.0355, 'hit_ratio@10': 0.8146, 'ndcg@10': 0.8612, 'compress@10': 1.0, 'time@10': 3.1803}:  83%|████████▎ | 25/30 [01:01<00:11,  2.34s/it]{'epoch': 25, 'num_users': 5.8077, 'loss': 0.0396, 'hit_ratio@10': 0.8098, 'ndcg@10': 0.8532, 'compress@10': 1.0, 'time@10': 3.0845}:  83%|████████▎ | 25/30 [01:02<00:11,  2.34s/it]{'epoch': 25, 'num_users': 5.8077, 'loss': 0.0396, 'hit_ratio@10': 0.8098, 'ndcg@10': 0.8532, 'compress@10': 1.0, 'time@10': 3.0845}:  87%|████████▋ | 26/30 [01:02<00:07,  1.85s/it]{'epoch': 25, 'num_users': 5.8889, 'loss': 0.039, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.8548, 'compress@10': 1.0, 'time@10': 3.1193}:  87%|████████▋ | 26/30 [01:04<00:07,  1.85s/it] {'epoch': 25, 'num_users': 5.8889, 'loss': 0.039, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.8548, 'compress@10': 1.0, 'time@10': 3.1193}:  90%|█████████ | 27/30 [01:04<00:05,  1.92s/it]{'epoch': 25, 'num_users': 6.0, 'loss': 0.0387, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 3.1253}:  90%|█████████ | 27/30 [01:07<00:05,  1.92s/it]    {'epoch': 25, 'num_users': 6.0, 'loss': 0.0387, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 3.1253}:  93%|█████████▎| 28/30 [01:07<00:04,  2.34s/it]{'epoch': 25, 'num_users': 5.8621, 'loss': 0.0379, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8584, 'compress@10': 1.0, 'time@10': 3.1309}:  93%|█████████▎| 28/30 [01:09<00:04,  2.34s/it]{'epoch': 25, 'num_users': 5.8621, 'loss': 0.0379, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8584, 'compress@10': 1.0, 'time@10': 3.1309}:  97%|█████████▋| 29/30 [01:09<00:02,  2.14s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.0373, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8611, 'compress@10': 1.0, 'time@10': 3.1322}:  97%|█████████▋| 29/30 [01:12<00:02,  2.14s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.0373, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8611, 'compress@10': 1.0, 'time@10': 3.1322}: 100%|██████████| 30/30 [01:12<00:00,  2.46s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.0373, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8611, 'compress@10': 1.0, 'time@10': 3.1322}: 100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch: 25
Avg # of users: 5.866666666666666
Avg Loss: 0.03734227051216366
Avg hit ratio: 0.8236047705505063
Avg ndcg: 0.8611383913900944
Avg compression ratio: 0.9999999860166272
Avg train time: 3.132228128115336
Std train time: 0.8242068635683352
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 35, 16, 9, 9, 8, 12, 6, 9, 7, 37, 9, 76, 6, 38, 51, 14, 15, 7, 9, 19, 11, 95, 95, 9, 6, 7, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0362, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 3.0409}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0362, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 3.0409}:   3%|▎         | 1/30 [00:01<00:45,  1.58s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0341, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.9262, 'compress@10': 1.0, 'time@10': 3.1768}:   3%|▎         | 1/30 [00:04<00:45,  1.58s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0341, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.9262, 'compress@10': 1.0, 'time@10': 3.1768}:   7%|▋         | 2/30 [00:04<01:13,  2.62s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.7292, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 3.2495}:   7%|▋         | 2/30 [00:06<01:13,  2.62s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.7292, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 3.2495}:  10%|█         | 3/30 [00:06<01:00,  2.24s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.7791, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.3851}:  10%|█         | 3/30 [00:10<01:00,  2.24s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.7791, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.3851}:  13%|█▎        | 4/30 [00:10<01:14,  2.87s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0315, 'hit_ratio@10': 0.7993, 'ndcg@10': 0.8752, 'compress@10': 1.0, 'time@10': 4.2261}:  13%|█▎        | 4/30 [00:14<01:14,  2.87s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0315, 'hit_ratio@10': 0.7993, 'ndcg@10': 0.8752, 'compress@10': 1.0, 'time@10': 4.2261}:  17%|█▋        | 5/30 [00:14<01:20,  3.22s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0313, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 4.1347}:  17%|█▋        | 5/30 [00:18<01:20,  3.22s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0313, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 4.1347}:  20%|██        | 6/30 [00:18<01:21,  3.39s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0318, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8797, 'compress@10': 1.0, 'time@10': 4.0646}:  20%|██        | 6/30 [00:19<01:21,  3.39s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0318, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8797, 'compress@10': 1.0, 'time@10': 4.0646}:  23%|██▎       | 7/30 [00:19<01:06,  2.89s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.033, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8827, 'compress@10': 1.0, 'time@10': 4.014}:  23%|██▎       | 7/30 [00:23<01:06,  2.89s/it]   {'epoch': 26, 'num_users': 6.125, 'loss': 0.033, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8827, 'compress@10': 1.0, 'time@10': 4.014}:  27%|██▋       | 8/30 [00:23<01:09,  3.15s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0327, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.886, 'compress@10': 1.0, 'time@10': 3.9783}:  27%|██▋       | 8/30 [00:25<01:09,  3.15s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0327, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.886, 'compress@10': 1.0, 'time@10': 3.9783}:  30%|███       | 9/30 [00:25<00:57,  2.75s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 3.9277}:  30%|███       | 9/30 [00:29<00:57,  2.75s/it]  {'epoch': 26, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 3.9277}:  33%|███▎      | 10/30 [00:29<00:59,  2.99s/it]{'epoch': 26, 'num_users': 6.6364, 'loss': 0.0331, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8888, 'compress@10': 1.0, 'time@10': 3.8859}:  33%|███▎      | 10/30 [00:30<00:59,  2.99s/it]{'epoch': 26, 'num_users': 6.6364, 'loss': 0.0331, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8888, 'compress@10': 1.0, 'time@10': 3.8859}:  37%|███▋      | 11/30 [00:30<00:49,  2.62s/it]{'epoch': 26, 'num_users': 6.4167, 'loss': 0.0307, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 3.8669}:  37%|███▋      | 11/30 [00:34<00:49,  2.62s/it]{'epoch': 26, 'num_users': 6.4167, 'loss': 0.0307, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 3.8669}:  40%|████      | 12/30 [00:34<00:53,  2.95s/it]{'epoch': 26, 'num_users': 6.6154, 'loss': 0.0312, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 3.8272}:  40%|████      | 12/30 [00:36<00:53,  2.95s/it] {'epoch': 26, 'num_users': 6.6154, 'loss': 0.0312, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 3.8272}:  43%|████▎     | 13/30 [00:36<00:43,  2.57s/it]{'epoch': 26, 'num_users': 6.3571, 'loss': 0.029, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8859, 'compress@10': 1.0, 'time@10': 3.7984}:  43%|████▎     | 13/30 [00:39<00:43,  2.57s/it]{'epoch': 26, 'num_users': 6.3571, 'loss': 0.029, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8859, 'compress@10': 1.0, 'time@10': 3.7984}:  47%|████▋     | 14/30 [00:39<00:45,  2.84s/it]{'epoch': 26, 'num_users': 6.2667, 'loss': 0.03, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 3.7498}:  47%|████▋     | 14/30 [00:41<00:45,  2.84s/it] {'epoch': 26, 'num_users': 6.2667, 'loss': 0.03, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 3.7498}:  50%|█████     | 15/30 [00:41<00:36,  2.46s/it]{'epoch': 26, 'num_users': 6.0625, 'loss': 0.0281, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8867, 'compress@10': 1.0, 'time@10': 3.7399}:  50%|█████     | 15/30 [00:44<00:36,  2.46s/it]{'epoch': 26, 'num_users': 6.0625, 'loss': 0.0281, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8867, 'compress@10': 1.0, 'time@10': 3.7399}:  53%|█████▎    | 16/30 [00:44<00:39,  2.81s/it]{'epoch': 26, 'num_users': 5.8235, 'loss': 0.0265, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8816, 'compress@10': 1.0, 'time@10': 3.7269}:  53%|█████▎    | 16/30 [00:46<00:39,  2.81s/it]{'epoch': 26, 'num_users': 5.8235, 'loss': 0.0265, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8816, 'compress@10': 1.0, 'time@10': 3.7269}:  57%|█████▋    | 17/30 [00:46<00:32,  2.51s/it]{'epoch': 26, 'num_users': 6.0556, 'loss': 0.0274, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8892, 'compress@10': 1.0, 'time@10': 3.7122}:  57%|█████▋    | 17/30 [00:50<00:32,  2.51s/it]{'epoch': 26, 'num_users': 6.0556, 'loss': 0.0274, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8892, 'compress@10': 1.0, 'time@10': 3.7122}:  60%|██████    | 18/30 [00:50<00:33,  2.81s/it]{'epoch': 26, 'num_users': 6.0, 'loss': 0.0264, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 3.6958}:  60%|██████    | 18/30 [00:51<00:33,  2.81s/it]   {'epoch': 26, 'num_users': 6.0, 'loss': 0.0264, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 3.6958}:  63%|██████▎   | 19/30 [00:51<00:27,  2.49s/it]{'epoch': 26, 'num_users': 6.15, 'loss': 0.0269, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 3.6943}:  63%|██████▎   | 19/30 [00:55<00:27,  2.49s/it] {'epoch': 26, 'num_users': 6.15, 'loss': 0.0269, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 3.6943}:  67%|██████▋   | 20/30 [00:55<00:28,  2.85s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.888, 'compress@10': 1.0, 'time@10': 3.8159}:  67%|██████▋   | 20/30 [00:58<00:28,  2.85s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.888, 'compress@10': 1.0, 'time@10': 3.8159}:  70%|███████   | 21/30 [00:58<00:26,  2.95s/it]{'epoch': 26, 'num_users': 6.1818, 'loss': 0.0278, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 3.7927}:  70%|███████   | 21/30 [01:02<00:26,  2.95s/it]{'epoch': 26, 'num_users': 6.1818, 'loss': 0.0278, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 3.7927}:  73%|███████▎  | 22/30 [01:02<00:24,  3.06s/it]{'epoch': 26, 'num_users': 6.1304, 'loss': 0.0275, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8912, 'compress@10': 1.0, 'time@10': 3.7808}:  73%|███████▎  | 22/30 [01:03<00:24,  3.06s/it]{'epoch': 26, 'num_users': 6.1304, 'loss': 0.0275, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8912, 'compress@10': 1.0, 'time@10': 3.7808}:  77%|███████▋  | 23/30 [01:03<00:18,  2.69s/it]{'epoch': 26, 'num_users': 5.9583, 'loss': 0.0264, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8874, 'compress@10': 1.0, 'time@10': 3.7623}:  77%|███████▋  | 23/30 [01:07<00:18,  2.69s/it]{'epoch': 26, 'num_users': 5.9583, 'loss': 0.0264, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8874, 'compress@10': 1.0, 'time@10': 3.7623}:  80%|████████  | 24/30 [01:07<00:17,  2.89s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8786, 'compress@10': 1.0, 'time@10': 3.7427}:  80%|████████  | 24/30 [01:09<00:17,  2.89s/it]   {'epoch': 26, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8786, 'compress@10': 1.0, 'time@10': 3.7427}:  83%|████████▎ | 25/30 [01:09<00:12,  2.53s/it]{'epoch': 26, 'num_users': 5.8077, 'loss': 0.0255, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8794, 'compress@10': 1.0, 'time@10': 3.8545}:  83%|████████▎ | 25/30 [01:15<00:12,  2.53s/it]{'epoch': 26, 'num_users': 5.8077, 'loss': 0.0255, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8794, 'compress@10': 1.0, 'time@10': 3.8545}:  87%|████████▋ | 26/30 [01:15<00:15,  3.78s/it]{'epoch': 26, 'num_users': 5.8889, 'loss': 0.0255, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 3.8224}:  87%|████████▋ | 26/30 [01:17<00:15,  3.78s/it]{'epoch': 26, 'num_users': 5.8889, 'loss': 0.0255, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 3.8224}:  90%|█████████ | 27/30 [01:17<00:09,  3.11s/it]{'epoch': 26, 'num_users': 6.0, 'loss': 0.0256, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8808, 'compress@10': 1.0, 'time@10': 3.788}:  90%|█████████ | 27/30 [01:20<00:09,  3.11s/it]    {'epoch': 26, 'num_users': 6.0, 'loss': 0.0256, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8808, 'compress@10': 1.0, 'time@10': 3.788}:  93%|█████████▎| 28/30 [01:20<00:06,  3.05s/it]{'epoch': 26, 'num_users': 5.8621, 'loss': 0.0251, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8824, 'compress@10': 1.0, 'time@10': 3.7688}:  93%|█████████▎| 28/30 [01:21<00:06,  3.05s/it]{'epoch': 26, 'num_users': 5.8621, 'loss': 0.0251, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8824, 'compress@10': 1.0, 'time@10': 3.7688}:  97%|█████████▋| 29/30 [01:21<00:02,  2.63s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0251, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 3.76}:  97%|█████████▋| 29/30 [01:25<00:02,  2.63s/it]  {'epoch': 26, 'num_users': 5.8667, 'loss': 0.0251, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 3.76}: 100%|██████████| 30/30 [01:25<00:00,  2.90s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0251, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 3.76}: 100%|██████████| 30/30 [01:25<00:00,  2.85s/it]
Epoch: 26
Avg # of users: 5.866666666666666
Avg Loss: 0.02514542035323157
Avg hit ratio: 0.8472251625651074
Avg ndcg: 0.8831456177433683
Avg compression ratio: 0.9999999860153537
Avg train time: 3.7599843740463257
Std train time: 1.0610736141575328
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 35, 15, 1, 8, 7, 11, 5, 9, 7, 36, 9, 76, 7, 38, 51, 14, 15, 6, 1, 19, 11, 95, 95, 1, 7, 9, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0363, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 3.614}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0363, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 3.614}:   3%|▎         | 1/30 [00:01<00:53,  1.84s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0344, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.882, 'compress@10': 1.0, 'time@10': 3.6232}:   3%|▎         | 1/30 [00:05<00:53,  1.84s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0344, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.882, 'compress@10': 1.0, 'time@10': 3.6232}:   7%|▋         | 2/30 [00:05<01:21,  2.92s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 3.5068}:   7%|▋         | 2/30 [00:07<01:21,  2.92s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 3.5068}:  10%|█         | 3/30 [00:07<01:03,  2.35s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 3.443}:  10%|█         | 3/30 [00:10<01:03,  2.35s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 3.443}:  13%|█▎        | 4/30 [00:10<01:10,  2.72s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0565, 'hit_ratio@10': 0.7773, 'ndcg@10': 0.8295, 'compress@10': 1.0, 'time@10': 2.917}:  13%|█▎        | 4/30 [00:10<01:10,  2.72s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0565, 'hit_ratio@10': 0.7773, 'ndcg@10': 0.8295, 'compress@10': 1.0, 'time@10': 2.917}:  17%|█▋        | 5/30 [00:10<00:47,  1.90s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0521, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 2.9234}:  17%|█▋        | 5/30 [00:13<00:47,  1.90s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0521, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 2.9234}:  20%|██        | 6/30 [00:13<00:54,  2.28s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0493, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8443, 'compress@10': 1.0, 'time@10': 2.9434}:  20%|██        | 6/30 [00:15<00:54,  2.28s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0493, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8443, 'compress@10': 1.0, 'time@10': 2.9434}:  23%|██▎       | 7/30 [00:15<00:47,  2.05s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0464, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8575, 'compress@10': 1.0, 'time@10': 2.9882}:  23%|██▎       | 7/30 [00:18<00:47,  2.05s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0464, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8575, 'compress@10': 1.0, 'time@10': 2.9882}:  27%|██▋       | 8/30 [00:18<00:54,  2.46s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0447, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 2.9751}:  27%|██▋       | 8/30 [00:20<00:54,  2.46s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0447, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 2.9751}:  30%|███       | 9/30 [00:20<00:45,  2.15s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0427, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8707, 'compress@10': 1.0, 'time@10': 3.021}:  30%|███       | 9/30 [00:23<00:45,  2.15s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0427, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8707, 'compress@10': 1.0, 'time@10': 3.021}:  33%|███▎      | 10/30 [00:23<00:51,  2.56s/it]{'epoch': 27, 'num_users': 6.6364, 'loss': 0.0432, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.871, 'compress@10': 1.0, 'time@10': 3.0494}:  33%|███▎      | 10/30 [00:25<00:51,  2.56s/it]{'epoch': 27, 'num_users': 6.6364, 'loss': 0.0432, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.871, 'compress@10': 1.0, 'time@10': 3.0494}:  37%|███▋      | 11/30 [00:25<00:43,  2.30s/it]{'epoch': 27, 'num_users': 6.4167, 'loss': 0.0397, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8748, 'compress@10': 1.0, 'time@10': 3.1007}:  37%|███▋      | 11/30 [00:29<00:43,  2.30s/it]{'epoch': 27, 'num_users': 6.4167, 'loss': 0.0397, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8748, 'compress@10': 1.0, 'time@10': 3.1007}:  40%|████      | 12/30 [00:29<00:49,  2.74s/it]{'epoch': 27, 'num_users': 6.6154, 'loss': 0.0395, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8746, 'compress@10': 1.0, 'time@10': 3.1354}:  40%|████      | 12/30 [00:31<00:49,  2.74s/it]{'epoch': 27, 'num_users': 6.6154, 'loss': 0.0395, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8746, 'compress@10': 1.0, 'time@10': 3.1354}:  43%|████▎     | 13/30 [00:31<00:41,  2.46s/it]{'epoch': 27, 'num_users': 6.3571, 'loss': 0.0367, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8717, 'compress@10': 1.0, 'time@10': 3.1467}:  43%|████▎     | 13/30 [00:34<00:41,  2.46s/it]{'epoch': 27, 'num_users': 6.3571, 'loss': 0.0367, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8717, 'compress@10': 1.0, 'time@10': 3.1467}:  47%|████▋     | 14/30 [00:34<00:43,  2.72s/it]{'epoch': 27, 'num_users': 6.2667, 'loss': 0.0371, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8718, 'compress@10': 1.0, 'time@10': 3.1816}:  47%|████▋     | 14/30 [00:36<00:43,  2.72s/it]{'epoch': 27, 'num_users': 6.2667, 'loss': 0.0371, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8718, 'compress@10': 1.0, 'time@10': 3.1816}:  50%|█████     | 15/30 [00:36<00:36,  2.47s/it]{'epoch': 27, 'num_users': 6.0625, 'loss': 0.0349, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8746, 'compress@10': 1.0, 'time@10': 3.2023}:  50%|█████     | 15/30 [00:39<00:36,  2.47s/it]{'epoch': 27, 'num_users': 6.0625, 'loss': 0.0349, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8746, 'compress@10': 1.0, 'time@10': 3.2023}:  53%|█████▎    | 16/30 [00:39<00:39,  2.79s/it]{'epoch': 27, 'num_users': 5.8235, 'loss': 0.0328, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 3.21}:  53%|█████▎    | 16/30 [00:41<00:39,  2.79s/it]  {'epoch': 27, 'num_users': 5.8235, 'loss': 0.0328, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 3.21}:  57%|█████▋    | 17/30 [00:41<00:32,  2.47s/it]{'epoch': 27, 'num_users': 6.0556, 'loss': 0.0322, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 3.2253}:  57%|█████▋    | 17/30 [00:45<00:32,  2.47s/it]{'epoch': 27, 'num_users': 6.0556, 'loss': 0.0322, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 3.2253}:  60%|██████    | 18/30 [00:45<00:33,  2.78s/it]{'epoch': 27, 'num_users': 6.0, 'loss': 0.031, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.875, 'compress@10': 1.0, 'time@10': 3.2411}:  60%|██████    | 18/30 [00:46<00:33,  2.78s/it]    {'epoch': 27, 'num_users': 6.0, 'loss': 0.031, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.875, 'compress@10': 1.0, 'time@10': 3.2411}:  63%|██████▎   | 19/30 [00:46<00:27,  2.49s/it]{'epoch': 27, 'num_users': 6.15, 'loss': 0.0312, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.2313}:  63%|██████▎   | 19/30 [00:49<00:27,  2.49s/it]{'epoch': 27, 'num_users': 6.15, 'loss': 0.0312, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.2313}:  67%|██████▋   | 20/30 [00:49<00:26,  2.67s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0385, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 3.1132}:  67%|██████▋   | 20/30 [00:50<00:26,  2.67s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0385, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 3.1132}:  70%|███████   | 21/30 [00:50<00:17,  1.99s/it]{'epoch': 27, 'num_users': 6.1818, 'loss': 0.0372, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8667, 'compress@10': 1.0, 'time@10': 3.1296}:  70%|███████   | 21/30 [00:53<00:17,  1.99s/it]{'epoch': 27, 'num_users': 6.1818, 'loss': 0.0372, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8667, 'compress@10': 1.0, 'time@10': 3.1296}:  73%|███████▎  | 22/30 [00:53<00:19,  2.45s/it]{'epoch': 27, 'num_users': 6.1304, 'loss': 0.0363, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 3.1568}:  73%|███████▎  | 22/30 [00:55<00:19,  2.45s/it]{'epoch': 27, 'num_users': 6.1304, 'loss': 0.0363, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 3.1568}:  77%|███████▋  | 23/30 [00:55<00:16,  2.29s/it]{'epoch': 27, 'num_users': 5.9583, 'loss': 0.0348, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 3.1591}:  77%|███████▋  | 23/30 [00:59<00:16,  2.29s/it] {'epoch': 27, 'num_users': 5.9583, 'loss': 0.0348, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 3.1591}:  80%|████████  | 24/30 [00:59<00:15,  2.58s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0334, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 3.1696}:  80%|████████  | 24/30 [01:00<00:15,  2.58s/it]   {'epoch': 27, 'num_users': 5.8, 'loss': 0.0334, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 3.1696}:  83%|████████▎ | 25/30 [01:00<00:11,  2.33s/it]{'epoch': 27, 'num_users': 5.8077, 'loss': 0.0374, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8505, 'compress@10': 1.0, 'time@10': 3.0746}:  83%|████████▎ | 25/30 [01:01<00:11,  2.33s/it]{'epoch': 27, 'num_users': 5.8077, 'loss': 0.0374, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8505, 'compress@10': 1.0, 'time@10': 3.0746}:  87%|████████▋ | 26/30 [01:01<00:07,  1.85s/it]{'epoch': 27, 'num_users': 5.8889, 'loss': 0.0368, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8522, 'compress@10': 1.0, 'time@10': 3.0775}:  87%|████████▋ | 26/30 [01:03<00:07,  1.85s/it]{'epoch': 27, 'num_users': 5.8889, 'loss': 0.0368, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8522, 'compress@10': 1.0, 'time@10': 3.0775}:  90%|█████████ | 27/30 [01:03<00:05,  1.78s/it]{'epoch': 27, 'num_users': 6.0, 'loss': 0.0368, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 3.1028}:  90%|█████████ | 27/30 [01:06<00:05,  1.78s/it]    {'epoch': 27, 'num_users': 6.0, 'loss': 0.0368, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 3.1028}:  93%|█████████▎| 28/30 [01:06<00:04,  2.40s/it]{'epoch': 27, 'num_users': 5.8621, 'loss': 0.0362, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8565, 'compress@10': 1.0, 'time@10': 3.1177}:  93%|█████████▎| 28/30 [01:08<00:04,  2.40s/it]{'epoch': 27, 'num_users': 5.8621, 'loss': 0.0362, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8565, 'compress@10': 1.0, 'time@10': 3.1177}:  97%|█████████▋| 29/30 [01:08<00:02,  2.22s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.0354, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8597, 'compress@10': 1.0, 'time@10': 3.133}:  97%|█████████▋| 29/30 [01:12<00:02,  2.22s/it] {'epoch': 27, 'num_users': 5.8667, 'loss': 0.0354, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8597, 'compress@10': 1.0, 'time@10': 3.133}: 100%|██████████| 30/30 [01:12<00:00,  2.64s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.0354, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8597, 'compress@10': 1.0, 'time@10': 3.133}: 100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch: 27
Avg # of users: 5.866666666666666
Avg Loss: 0.03540006651596962
Avg hit ratio: 0.8332775168899192
Avg ndcg: 0.8596799590726297
Avg compression ratio: 0.9999999860166272
Avg train time: 3.1330039262771607
Std train time: 0.8241382244400708
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 35, 16, 9, 9, 8, 11, 7, 9, 7, 35, 9, 76, 6, 38, 51, 14, 15, 7, 9, 19, 10, 96, 95, 9, 8, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0298, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8766, 'compress@10': 1.0, 'time@10': 3.1665}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0298, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8766, 'compress@10': 1.0, 'time@10': 3.1665}:   3%|▎         | 1/30 [00:01<00:46,  1.62s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9107, 'compress@10': 1.0, 'time@10': 3.1515}:   3%|▎         | 1/30 [00:04<00:46,  1.62s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9107, 'compress@10': 1.0, 'time@10': 3.1515}:   7%|▋         | 2/30 [00:04<01:10,  2.53s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.74, 'ndcg@10': 0.8929, 'compress@10': 1.0, 'time@10': 3.217}:   7%|▋         | 2/30 [00:06<01:10,  2.53s/it]   {'epoch': 28, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.74, 'ndcg@10': 0.8929, 'compress@10': 1.0, 'time@10': 3.217}:  10%|█         | 3/30 [00:06<00:58,  2.16s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.7871, 'ndcg@10': 0.9093, 'compress@10': 1.0, 'time@10': 3.3381}:  10%|█         | 3/30 [00:10<00:58,  2.16s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.7871, 'ndcg@10': 0.9093, 'compress@10': 1.0, 'time@10': 3.3381}:  13%|█▎        | 4/30 [00:10<01:12,  2.78s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 4.3192}:  13%|█▎        | 4/30 [00:14<01:12,  2.78s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 4.3192}:  17%|█▋        | 5/30 [00:14<01:21,  3.28s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0262, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 4.1895}:  17%|█▋        | 5/30 [00:17<01:21,  3.28s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0262, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 4.1895}:  20%|██        | 6/30 [00:17<01:21,  3.38s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0272, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 4.0598}:  20%|██        | 6/30 [00:19<01:21,  3.38s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0272, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 4.0598}:  23%|██▎       | 7/30 [00:19<01:04,  2.82s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0276, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8932, 'compress@10': 1.0, 'time@10': 3.9521}:  23%|██▎       | 7/30 [00:22<01:04,  2.82s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0276, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8932, 'compress@10': 1.0, 'time@10': 3.9521}:  27%|██▋       | 8/30 [00:22<01:05,  2.96s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.028, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.9808}:  27%|██▋       | 8/30 [00:25<01:05,  2.96s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.028, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.9808}:  30%|███       | 9/30 [00:25<00:56,  2.70s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.9085}:  30%|███       | 9/30 [00:28<00:56,  2.70s/it]  {'epoch': 28, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.9085}:  33%|███▎      | 10/30 [00:28<00:57,  2.89s/it]{'epoch': 28, 'num_users': 6.6364, 'loss': 0.0293, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.8446}:  33%|███▎      | 10/30 [00:29<00:57,  2.89s/it]{'epoch': 28, 'num_users': 6.6364, 'loss': 0.0293, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.8446}:  37%|███▋      | 11/30 [00:29<00:47,  2.50s/it]{'epoch': 28, 'num_users': 6.4167, 'loss': 0.027, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.898, 'compress@10': 1.0, 'time@10': 3.7871}:  37%|███▋      | 11/30 [00:33<00:47,  2.50s/it]  {'epoch': 28, 'num_users': 6.4167, 'loss': 0.027, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.898, 'compress@10': 1.0, 'time@10': 3.7871}:  40%|████      | 12/30 [00:33<00:48,  2.71s/it]{'epoch': 28, 'num_users': 6.6154, 'loss': 0.0278, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.757}:  40%|████      | 12/30 [00:34<00:48,  2.71s/it]{'epoch': 28, 'num_users': 6.6154, 'loss': 0.0278, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.757}:  43%|████▎     | 13/30 [00:34<00:41,  2.42s/it]{'epoch': 28, 'num_users': 6.3571, 'loss': 0.0258, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8918, 'compress@10': 1.0, 'time@10': 3.717}:  43%|████▎     | 13/30 [00:38<00:41,  2.42s/it] {'epoch': 28, 'num_users': 6.3571, 'loss': 0.0258, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8918, 'compress@10': 1.0, 'time@10': 3.717}:  47%|████▋     | 14/30 [00:38<00:42,  2.66s/it]{'epoch': 28, 'num_users': 6.2667, 'loss': 0.0268, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8904, 'compress@10': 1.0, 'time@10': 3.6749}:  47%|████▋     | 14/30 [00:39<00:42,  2.66s/it]{'epoch': 28, 'num_users': 6.2667, 'loss': 0.0268, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8904, 'compress@10': 1.0, 'time@10': 3.6749}:  50%|█████     | 15/30 [00:39<00:35,  2.34s/it]{'epoch': 28, 'num_users': 6.0625, 'loss': 0.0252, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.6756}:  50%|█████     | 15/30 [00:43<00:35,  2.34s/it]{'epoch': 28, 'num_users': 6.0625, 'loss': 0.0252, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.6756}:  53%|█████▎    | 16/30 [00:43<00:38,  2.76s/it]{'epoch': 28, 'num_users': 5.8235, 'loss': 0.0237, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8867, 'compress@10': 1.0, 'time@10': 3.657}:  53%|█████▎    | 16/30 [00:45<00:38,  2.76s/it] {'epoch': 28, 'num_users': 5.8235, 'loss': 0.0237, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8867, 'compress@10': 1.0, 'time@10': 3.657}:  57%|█████▋    | 17/30 [00:45<00:31,  2.44s/it]{'epoch': 28, 'num_users': 6.0556, 'loss': 0.0236, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.63}:  57%|█████▋    | 17/30 [00:48<00:31,  2.44s/it] {'epoch': 28, 'num_users': 6.0556, 'loss': 0.0236, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.63}:  60%|██████    | 18/30 [00:48<00:32,  2.68s/it]{'epoch': 28, 'num_users': 6.0, 'loss': 0.0228, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 3.6222}:  60%|██████    | 18/30 [00:50<00:32,  2.68s/it] {'epoch': 28, 'num_users': 6.0, 'loss': 0.0228, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 3.6222}:  63%|██████▎   | 19/30 [00:50<00:26,  2.42s/it]{'epoch': 28, 'num_users': 6.15, 'loss': 0.0233, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 3.628}:  63%|██████▎   | 19/30 [00:53<00:26,  2.42s/it]{'epoch': 28, 'num_users': 6.15, 'loss': 0.0233, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 3.628}:  67%|██████▋   | 20/30 [00:53<00:28,  2.82s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 3.7672}:  67%|██████▋   | 20/30 [00:57<00:28,  2.82s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 3.7672}:  70%|███████   | 21/30 [00:57<00:26,  2.97s/it]{'epoch': 28, 'num_users': 6.1818, 'loss': 0.024, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8896, 'compress@10': 1.0, 'time@10': 3.7493}:  70%|███████   | 21/30 [01:00<00:26,  2.97s/it] {'epoch': 28, 'num_users': 6.1818, 'loss': 0.024, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8896, 'compress@10': 1.0, 'time@10': 3.7493}:  73%|███████▎  | 22/30 [01:00<00:24,  3.10s/it]{'epoch': 28, 'num_users': 6.1304, 'loss': 0.0237, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 3.7193}:  73%|███████▎  | 22/30 [01:02<00:24,  3.10s/it]{'epoch': 28, 'num_users': 6.1304, 'loss': 0.0237, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 3.7193}:  77%|███████▋  | 23/30 [01:02<00:18,  2.64s/it]{'epoch': 28, 'num_users': 5.9583, 'loss': 0.0227, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 3.7017}:  77%|███████▋  | 23/30 [01:05<00:18,  2.64s/it]{'epoch': 28, 'num_users': 5.9583, 'loss': 0.0227, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 3.7017}:  80%|████████  | 24/30 [01:05<00:17,  2.85s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0218, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8785, 'compress@10': 1.0, 'time@10': 3.692}:  80%|████████  | 24/30 [01:07<00:17,  2.85s/it]    {'epoch': 28, 'num_users': 5.8, 'loss': 0.0218, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8785, 'compress@10': 1.0, 'time@10': 3.692}:  83%|████████▎ | 25/30 [01:07<00:12,  2.53s/it]{'epoch': 28, 'num_users': 5.8077, 'loss': 0.022, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 3.7996}:  83%|████████▎ | 25/30 [01:13<00:12,  2.53s/it]{'epoch': 28, 'num_users': 5.8077, 'loss': 0.022, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 3.7996}:  87%|████████▋ | 26/30 [01:13<00:14,  3.73s/it]{'epoch': 28, 'num_users': 5.8889, 'loss': 0.022, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8802, 'compress@10': 1.0, 'time@10': 3.8039}:  87%|████████▋ | 26/30 [01:15<00:14,  3.73s/it]{'epoch': 28, 'num_users': 5.8889, 'loss': 0.022, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8802, 'compress@10': 1.0, 'time@10': 3.8039}:  90%|█████████ | 27/30 [01:15<00:09,  3.21s/it]{'epoch': 28, 'num_users': 6.0, 'loss': 0.0222, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8819, 'compress@10': 1.0, 'time@10': 3.7907}:  90%|█████████ | 27/30 [01:19<00:09,  3.21s/it]  {'epoch': 28, 'num_users': 6.0, 'loss': 0.0222, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8819, 'compress@10': 1.0, 'time@10': 3.7907}:  93%|█████████▎| 28/30 [01:19<00:06,  3.29s/it]{'epoch': 28, 'num_users': 5.8621, 'loss': 0.0222, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8834, 'compress@10': 1.0, 'time@10': 3.7769}:  93%|█████████▎| 28/30 [01:21<00:06,  3.29s/it]{'epoch': 28, 'num_users': 5.8621, 'loss': 0.0222, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8834, 'compress@10': 1.0, 'time@10': 3.7769}:  97%|█████████▋| 29/30 [01:21<00:02,  2.82s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.0223, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8845, 'compress@10': 1.0, 'time@10': 3.7647}:  97%|█████████▋| 29/30 [01:24<00:02,  2.82s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.0223, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8845, 'compress@10': 1.0, 'time@10': 3.7647}: 100%|██████████| 30/30 [01:24<00:00,  3.01s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.0223, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8845, 'compress@10': 1.0, 'time@10': 3.7647}: 100%|██████████| 30/30 [01:24<00:00,  2.82s/it]
Epoch: 28
Avg # of users: 5.866666666666666
Avg Loss: 0.02229691155943231
Avg hit ratio: 0.8555526605299193
Avg ndcg: 0.8845295349927258
Avg compression ratio: 0.9999999860153537
Avg train time: 3.7647022247314452
Std train time: 1.1661555330231446
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 35, 15, 1, 9, 8, 12, 5, 10, 8, 36, 9, 77, 7, 37, 51, 15, 15, 6, 1, 19, 11, 96, 95, 1, 7, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8672, 'compress@10': 1.0, 'time@10': 3.6875}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8672, 'compress@10': 1.0, 'time@10': 3.6875}:   3%|▎         | 1/30 [00:01<00:54,  1.90s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9076, 'compress@10': 1.0, 'time@10': 3.6015}:   3%|▎         | 1/30 [00:05<00:54,  1.90s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9076, 'compress@10': 1.0, 'time@10': 3.6015}:   7%|▋         | 2/30 [00:05<01:20,  2.87s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8908, 'compress@10': 1.0, 'time@10': 3.6013}:   7%|▋         | 2/30 [00:07<01:20,  2.87s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8908, 'compress@10': 1.0, 'time@10': 3.6013}:  10%|█         | 3/30 [00:07<01:04,  2.40s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 3.6121}:  10%|█         | 3/30 [00:10<01:04,  2.40s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 3.6121}:  13%|█▎        | 4/30 [00:10<01:15,  2.91s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0493, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8421, 'compress@10': 1.0, 'time@10': 3.0719}:  13%|█▎        | 4/30 [00:11<01:15,  2.91s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0493, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8421, 'compress@10': 1.0, 'time@10': 3.0719}:  17%|█▋        | 5/30 [00:11<00:50,  2.04s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0453, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 3.1988}:  17%|█▋        | 5/30 [00:15<00:50,  2.04s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0453, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 3.1988}:  20%|██        | 6/30 [00:15<01:03,  2.66s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0437, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 3.2319}:  20%|██        | 6/30 [00:17<01:03,  2.66s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0437, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 3.2319}:  23%|██▎       | 7/30 [00:17<00:54,  2.36s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0418, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.8603, 'compress@10': 1.0, 'time@10': 3.274}:  23%|██▎       | 7/30 [00:20<00:54,  2.36s/it]  {'epoch': 29, 'num_users': 6.125, 'loss': 0.0418, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.8603, 'compress@10': 1.0, 'time@10': 3.274}:  27%|██▋       | 8/30 [00:20<01:00,  2.76s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0404, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 3.2643}:  27%|██▋       | 8/30 [00:22<01:00,  2.76s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0404, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 3.2643}:  30%|███       | 9/30 [00:22<00:50,  2.41s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.039, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8728, 'compress@10': 1.0, 'time@10': 3.3187}:  30%|███       | 9/30 [00:26<00:50,  2.41s/it]    {'epoch': 29, 'num_users': 6.3, 'loss': 0.039, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8728, 'compress@10': 1.0, 'time@10': 3.3187}:  33%|███▎      | 10/30 [00:26<00:57,  2.85s/it]{'epoch': 29, 'num_users': 6.6364, 'loss': 0.0394, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 3.3579}:  33%|███▎      | 10/30 [00:28<00:57,  2.85s/it]{'epoch': 29, 'num_users': 6.6364, 'loss': 0.0394, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 3.3579}:  37%|███▋      | 11/30 [00:28<00:48,  2.56s/it]{'epoch': 29, 'num_users': 6.4167, 'loss': 0.0363, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 3.3706}:  37%|███▋      | 11/30 [00:31<00:48,  2.56s/it]{'epoch': 29, 'num_users': 6.4167, 'loss': 0.0363, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 3.3706}:  40%|████      | 12/30 [00:31<00:51,  2.86s/it]{'epoch': 29, 'num_users': 6.6154, 'loss': 0.0363, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8774, 'compress@10': 1.0, 'time@10': 3.3862}:  40%|████      | 12/30 [00:33<00:51,  2.86s/it]{'epoch': 29, 'num_users': 6.6154, 'loss': 0.0363, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8774, 'compress@10': 1.0, 'time@10': 3.3862}:  43%|████▎     | 13/30 [00:33<00:43,  2.55s/it]{'epoch': 29, 'num_users': 6.3571, 'loss': 0.0337, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8743, 'compress@10': 1.0, 'time@10': 3.3763}:  43%|████▎     | 13/30 [00:36<00:43,  2.55s/it]  {'epoch': 29, 'num_users': 6.3571, 'loss': 0.0337, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8743, 'compress@10': 1.0, 'time@10': 3.3763}:  47%|████▋     | 14/30 [00:36<00:44,  2.77s/it]{'epoch': 29, 'num_users': 6.2667, 'loss': 0.0342, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 3.405}:  47%|████▋     | 14/30 [00:38<00:44,  2.77s/it]{'epoch': 29, 'num_users': 6.2667, 'loss': 0.0342, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 3.405}:  50%|█████     | 15/30 [00:38<00:37,  2.52s/it]{'epoch': 29, 'num_users': 6.0625, 'loss': 0.0321, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.877, 'compress@10': 1.0, 'time@10': 3.4062}:  50%|█████     | 15/30 [00:42<00:37,  2.52s/it]{'epoch': 29, 'num_users': 6.0625, 'loss': 0.0321, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.877, 'compress@10': 1.0, 'time@10': 3.4062}:  53%|█████▎    | 16/30 [00:42<00:39,  2.81s/it]{'epoch': 29, 'num_users': 5.8235, 'loss': 0.0303, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8725, 'compress@10': 1.0, 'time@10': 3.3979}:  53%|█████▎    | 16/30 [00:43<00:39,  2.81s/it]{'epoch': 29, 'num_users': 5.8235, 'loss': 0.0303, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8725, 'compress@10': 1.0, 'time@10': 3.3979}:  57%|█████▋    | 17/30 [00:43<00:32,  2.46s/it]{'epoch': 29, 'num_users': 6.0556, 'loss': 0.0301, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 3.3982}:  57%|█████▋    | 17/30 [00:47<00:32,  2.46s/it]{'epoch': 29, 'num_users': 6.0556, 'loss': 0.0301, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 3.3982}:  60%|██████    | 18/30 [00:47<00:33,  2.76s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 0.0289, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 3.37}:  60%|██████    | 18/30 [00:48<00:33,  2.76s/it]     {'epoch': 29, 'num_users': 6.0, 'loss': 0.0289, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 3.37}:  63%|██████▎   | 19/30 [00:48<00:26,  2.37s/it]{'epoch': 29, 'num_users': 6.15, 'loss': 0.0291, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 3.3487}:  63%|██████▎   | 19/30 [00:51<00:26,  2.37s/it]{'epoch': 29, 'num_users': 6.15, 'loss': 0.0291, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 3.3487}:  67%|██████▋   | 20/30 [00:51<00:25,  2.55s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0365, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 3.2302}:  67%|██████▋   | 20/30 [00:52<00:25,  2.55s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0365, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 3.2302}:  70%|███████   | 21/30 [00:52<00:17,  1.93s/it]{'epoch': 29, 'num_users': 6.1818, 'loss': 0.0351, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8711, 'compress@10': 1.0, 'time@10': 3.2456}:  70%|███████   | 21/30 [00:55<00:17,  1.93s/it]{'epoch': 29, 'num_users': 6.1818, 'loss': 0.0351, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8711, 'compress@10': 1.0, 'time@10': 3.2456}:  73%|███████▎  | 22/30 [00:55<00:19,  2.44s/it]{'epoch': 29, 'num_users': 6.1304, 'loss': 0.0345, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 3.2473}:  73%|███████▎  | 22/30 [00:57<00:19,  2.44s/it] {'epoch': 29, 'num_users': 6.1304, 'loss': 0.0345, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 3.2473}:  77%|███████▋  | 23/30 [00:57<00:15,  2.21s/it]{'epoch': 29, 'num_users': 5.9583, 'loss': 0.033, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 3.2467}:  77%|███████▋  | 23/30 [01:00<00:15,  2.21s/it]  {'epoch': 29, 'num_users': 5.9583, 'loss': 0.033, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 3.2467}:  80%|████████  | 24/30 [01:00<00:15,  2.53s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0317, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 3.2565}:  80%|████████  | 24/30 [01:02<00:15,  2.53s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0317, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 3.2565}:  83%|████████▎ | 25/30 [01:02<00:11,  2.30s/it]{'epoch': 29, 'num_users': 5.8077, 'loss': 0.0355, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8542, 'compress@10': 1.0, 'time@10': 3.1585}:  83%|████████▎ | 25/30 [01:03<00:11,  2.30s/it]{'epoch': 29, 'num_users': 5.8077, 'loss': 0.0355, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8542, 'compress@10': 1.0, 'time@10': 3.1585}:  87%|████████▋ | 26/30 [01:03<00:07,  1.84s/it]{'epoch': 29, 'num_users': 5.8889, 'loss': 0.035, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 3.1688}:  87%|████████▋ | 26/30 [01:05<00:07,  1.84s/it] {'epoch': 29, 'num_users': 5.8889, 'loss': 0.035, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 3.1688}:  90%|█████████ | 27/30 [01:05<00:05,  1.81s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 0.0346, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8582, 'compress@10': 1.0, 'time@10': 3.189}:  90%|█████████ | 27/30 [01:08<00:05,  1.81s/it]   {'epoch': 29, 'num_users': 6.0, 'loss': 0.0346, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8582, 'compress@10': 1.0, 'time@10': 3.189}:  93%|█████████▎| 28/30 [01:08<00:04,  2.40s/it]{'epoch': 29, 'num_users': 5.8621, 'loss': 0.034, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 3.2067}:  93%|█████████▎| 28/30 [01:10<00:04,  2.40s/it]{'epoch': 29, 'num_users': 5.8621, 'loss': 0.034, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 3.2067}:  97%|█████████▋| 29/30 [01:10<00:02,  2.25s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.0335, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8633, 'compress@10': 1.0, 'time@10': 3.2172}:  97%|█████████▋| 29/30 [01:14<00:02,  2.25s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.0335, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8633, 'compress@10': 1.0, 'time@10': 3.2172}: 100%|██████████| 30/30 [01:14<00:00,  2.64s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.0335, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8633, 'compress@10': 1.0, 'time@10': 3.2172}: 100%|██████████| 30/30 [01:14<00:00,  2.48s/it]
Epoch: 29
Avg # of users: 5.866666666666666
Avg Loss: 0.033469069251322016
Avg hit ratio: 0.8497354739935765
Avg ndcg: 0.8633270621212028
Avg compression ratio: 0.9999999860166272
Avg train time: 3.217181587219238
Std train time: 0.8302370065453912
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 35, 14, 8, 8, 8, 12, 6, 9, 7, 36, 9, 78, 6, 37, 52, 15, 17, 7, 9, 19, 11, 97, 95, 9, 7, 7, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 3.3141}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 3.3141}:   3%|▎         | 1/30 [00:01<00:49,  1.69s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8938, 'compress@10': 1.0, 'time@10': 3.4475}:   3%|▎         | 1/30 [00:05<00:49,  1.69s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8938, 'compress@10': 1.0, 'time@10': 3.4475}:   7%|▋         | 2/30 [00:05<01:19,  2.83s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8816, 'compress@10': 1.0, 'time@10': 3.4876}:   7%|▋         | 2/30 [00:07<01:19,  2.83s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8816, 'compress@10': 1.0, 'time@10': 3.4876}:  10%|█         | 3/30 [00:07<01:03,  2.37s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9002, 'compress@10': 1.0, 'time@10': 3.4791}:  10%|█         | 3/30 [00:10<01:03,  2.37s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9002, 'compress@10': 1.0, 'time@10': 3.4791}:  13%|█▎        | 4/30 [00:10<01:13,  2.81s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0241, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8843, 'compress@10': 1.0, 'time@10': 4.2342}:  13%|█▎        | 4/30 [00:14<01:13,  2.81s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0241, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8843, 'compress@10': 1.0, 'time@10': 4.2342}:  17%|█▋        | 5/30 [00:14<01:17,  3.12s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0245, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8859, 'compress@10': 1.0, 'time@10': 4.0836}:  17%|█▋        | 5/30 [00:17<01:17,  3.12s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0245, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8859, 'compress@10': 1.0, 'time@10': 4.0836}:  20%|██        | 6/30 [00:17<01:16,  3.20s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0256, 'hit_ratio@10': 0.896, 'ndcg@10': 0.8865, 'compress@10': 1.0, 'time@10': 3.9958}:  20%|██        | 6/30 [00:19<01:16,  3.20s/it] {'epoch': 30, 'num_users': 6.2857, 'loss': 0.0256, 'hit_ratio@10': 0.896, 'ndcg@10': 0.8865, 'compress@10': 1.0, 'time@10': 3.9958}:  23%|██▎       | 7/30 [00:19<01:02,  2.74s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0266, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 3.9632}:  23%|██▎       | 7/30 [00:23<01:02,  2.74s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0266, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 3.9632}:  27%|██▋       | 8/30 [00:23<01:07,  3.07s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0267, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 3.9253}:  27%|██▋       | 8/30 [00:25<01:07,  3.07s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0267, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 3.9253}:  30%|███       | 9/30 [00:25<00:56,  2.69s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.8809}:  30%|███       | 9/30 [00:28<00:56,  2.69s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.8809}:  33%|███▎      | 10/30 [00:28<00:58,  2.94s/it]{'epoch': 30, 'num_users': 6.6364, 'loss': 0.0269, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.8307}:  33%|███▎      | 10/30 [00:30<00:58,  2.94s/it]{'epoch': 30, 'num_users': 6.6364, 'loss': 0.0269, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.8307}:  37%|███▋      | 11/30 [00:30<00:48,  2.56s/it]{'epoch': 30, 'num_users': 6.4167, 'loss': 0.0247, 'hit_ratio@10': 0.876, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.7922}:  37%|███▋      | 11/30 [00:33<00:48,  2.56s/it] {'epoch': 30, 'num_users': 6.4167, 'loss': 0.0247, 'hit_ratio@10': 0.876, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.7922}:  40%|████      | 12/30 [00:33<00:50,  2.82s/it]{'epoch': 30, 'num_users': 6.6154, 'loss': 0.0255, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.898, 'compress@10': 1.0, 'time@10': 3.7636}:  40%|████      | 12/30 [00:35<00:50,  2.82s/it]{'epoch': 30, 'num_users': 6.6154, 'loss': 0.0255, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.898, 'compress@10': 1.0, 'time@10': 3.7636}:  43%|████▎     | 13/30 [00:35<00:42,  2.50s/it]{'epoch': 30, 'num_users': 6.3571, 'loss': 0.0237, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.8934, 'compress@10': 1.0, 'time@10': 3.7311}:  43%|████▎     | 13/30 [00:38<00:42,  2.50s/it]{'epoch': 30, 'num_users': 6.3571, 'loss': 0.0237, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.8934, 'compress@10': 1.0, 'time@10': 3.7311}:  47%|████▋     | 14/30 [00:38<00:44,  2.75s/it]{'epoch': 30, 'num_users': 6.2667, 'loss': 0.0247, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8917, 'compress@10': 1.0, 'time@10': 3.6925}:  47%|████▋     | 14/30 [00:40<00:44,  2.75s/it]{'epoch': 30, 'num_users': 6.2667, 'loss': 0.0247, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8917, 'compress@10': 1.0, 'time@10': 3.6925}:  50%|█████     | 15/30 [00:40<00:36,  2.41s/it]{'epoch': 30, 'num_users': 6.0625, 'loss': 0.0233, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.8932, 'compress@10': 1.0, 'time@10': 3.6777}:  50%|█████     | 15/30 [00:43<00:36,  2.41s/it]{'epoch': 30, 'num_users': 6.0625, 'loss': 0.0233, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.8932, 'compress@10': 1.0, 'time@10': 3.6777}:  53%|█████▎    | 16/30 [00:43<00:38,  2.74s/it]{'epoch': 30, 'num_users': 5.8235, 'loss': 0.0219, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 3.6661}:  53%|█████▎    | 16/30 [00:45<00:38,  2.74s/it]{'epoch': 30, 'num_users': 5.8235, 'loss': 0.0219, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 3.6661}:  57%|█████▋    | 17/30 [00:45<00:31,  2.45s/it]{'epoch': 30, 'num_users': 6.0556, 'loss': 0.0222, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 3.6701}:  57%|█████▋    | 17/30 [00:49<00:31,  2.45s/it]{'epoch': 30, 'num_users': 6.0556, 'loss': 0.0222, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 3.6701}:  60%|██████    | 18/30 [00:49<00:34,  2.85s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 0.0214, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 3.6911}:  60%|██████    | 18/30 [00:51<00:34,  2.85s/it]   {'epoch': 30, 'num_users': 6.0, 'loss': 0.0214, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 3.6911}:  63%|██████▎   | 19/30 [00:51<00:28,  2.62s/it]{'epoch': 30, 'num_users': 6.15, 'loss': 0.0219, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 3.688}:  63%|██████▎   | 19/30 [00:55<00:28,  2.62s/it]{'epoch': 30, 'num_users': 6.15, 'loss': 0.0219, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 3.688}:  67%|██████▋   | 20/30 [00:55<00:29,  2.93s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0235, 'hit_ratio@10': 0.87, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.8266}:  67%|██████▋   | 20/30 [00:58<00:29,  2.93s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0235, 'hit_ratio@10': 0.87, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.8266}:  70%|███████   | 21/30 [00:58<00:27,  3.06s/it]{'epoch': 30, 'num_users': 6.1818, 'loss': 0.0228, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 3.8101}:  70%|███████   | 21/30 [01:02<00:27,  3.06s/it]{'epoch': 30, 'num_users': 6.1818, 'loss': 0.0228, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 3.8101}:  73%|███████▎  | 22/30 [01:02<00:25,  3.19s/it]{'epoch': 30, 'num_users': 6.1304, 'loss': 0.0225, 'hit_ratio@10': 0.875, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.7908}:  73%|███████▎  | 22/30 [01:03<00:25,  3.19s/it] {'epoch': 30, 'num_users': 6.1304, 'loss': 0.0225, 'hit_ratio@10': 0.875, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.7908}:  77%|███████▋  | 23/30 [01:03<00:19,  2.75s/it]{'epoch': 30, 'num_users': 5.9583, 'loss': 0.0215, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 3.7647}:  77%|███████▋  | 23/30 [01:06<00:19,  2.75s/it]{'epoch': 30, 'num_users': 5.9583, 'loss': 0.0215, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 3.7647}:  80%|████████  | 24/30 [01:06<00:17,  2.89s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8819, 'compress@10': 1.0, 'time@10': 3.7461}:  80%|████████  | 24/30 [01:08<00:17,  2.89s/it]   {'epoch': 30, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8819, 'compress@10': 1.0, 'time@10': 3.7461}:  83%|████████▎ | 25/30 [01:08<00:12,  2.53s/it]{'epoch': 30, 'num_users': 5.8077, 'loss': 0.0209, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8833, 'compress@10': 1.0, 'time@10': 3.8345}:  83%|████████▎ | 25/30 [01:14<00:12,  2.53s/it]{'epoch': 30, 'num_users': 5.8077, 'loss': 0.0209, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8833, 'compress@10': 1.0, 'time@10': 3.8345}:  87%|████████▋ | 26/30 [01:14<00:14,  3.59s/it]{'epoch': 30, 'num_users': 5.8889, 'loss': 0.0209, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.884, 'compress@10': 1.0, 'time@10': 3.8177}:  87%|████████▋ | 26/30 [01:16<00:14,  3.59s/it]{'epoch': 30, 'num_users': 5.8889, 'loss': 0.0209, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.884, 'compress@10': 1.0, 'time@10': 3.8177}:  90%|█████████ | 27/30 [01:16<00:09,  3.03s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 0.021, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 3.793}:  90%|█████████ | 27/30 [01:19<00:09,  3.03s/it]    {'epoch': 30, 'num_users': 6.0, 'loss': 0.021, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 3.793}:  93%|█████████▎| 28/30 [01:19<00:06,  3.08s/it]{'epoch': 30, 'num_users': 5.8621, 'loss': 0.0208, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.8863, 'compress@10': 1.0, 'time@10': 3.7624}:  93%|█████████▎| 28/30 [01:21<00:06,  3.08s/it]{'epoch': 30, 'num_users': 5.8621, 'loss': 0.0208, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.8863, 'compress@10': 1.0, 'time@10': 3.7624}:  97%|█████████▋| 29/30 [01:21<00:02,  2.60s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.0208, 'hit_ratio@10': 0.875, 'ndcg@10': 0.8876, 'compress@10': 1.0, 'time@10': 3.7532}:  97%|█████████▋| 29/30 [01:24<00:02,  2.60s/it] {'epoch': 30, 'num_users': 5.8667, 'loss': 0.0208, 'hit_ratio@10': 0.875, 'ndcg@10': 0.8876, 'compress@10': 1.0, 'time@10': 3.7532}: 100%|██████████| 30/30 [01:24<00:00,  2.88s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.0208, 'hit_ratio@10': 0.875, 'ndcg@10': 0.8876, 'compress@10': 1.0, 'time@10': 3.7532}: 100%|██████████| 30/30 [01:24<00:00,  2.82s/it]
Epoch: 30
Avg # of users: 5.866666666666666
Avg Loss: 0.020761353804867395
Avg hit ratio: 0.8749694319305618
Avg ndcg: 0.8876026448098148
Avg compression ratio: 0.9999999860153537
Avg train time: 3.7532080809275308
Std train time: 0.99459335578847
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 35, 14, 1, 8, 8, 11, 5, 9, 7, 36, 9, 78, 7, 37, 52, 14, 15, 6, 1, 19, 11, 98, 95, 1, 7, 8, 11, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8843, 'compress@10': 1.0, 'time@10': 3.3179}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8843, 'compress@10': 1.0, 'time@10': 3.3179}:   3%|▎         | 1/30 [00:01<00:49,  1.70s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9375, 'compress@10': 1.0, 'time@10': 3.3635}:   3%|▎         | 1/30 [00:05<00:49,  1.70s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9375, 'compress@10': 1.0, 'time@10': 3.3635}:   7%|▋         | 2/30 [00:05<01:16,  2.73s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9107, 'compress@10': 1.0, 'time@10': 3.3957}:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9107, 'compress@10': 1.0, 'time@10': 3.3957}:  10%|█         | 3/30 [00:06<01:01,  2.29s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.3737}:  10%|█         | 3/30 [00:10<01:01,  2.29s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.3737}:  13%|█▎        | 4/30 [00:10<01:10,  2.71s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0631, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8339, 'compress@10': 1.0, 'time@10': 2.8814}:  13%|█▎        | 4/30 [00:10<01:10,  2.71s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0631, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8339, 'compress@10': 1.0, 'time@10': 2.8814}:  17%|█▋        | 5/30 [00:10<00:47,  1.91s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.057, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.845, 'compress@10': 1.0, 'time@10': 2.9188}:  17%|█▋        | 5/30 [00:13<00:47,  1.91s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.057, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.845, 'compress@10': 1.0, 'time@10': 2.9188}:  20%|██        | 6/30 [00:13<00:55,  2.33s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0533, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8512, 'compress@10': 1.0, 'time@10': 2.9859}:  20%|██        | 6/30 [00:15<00:55,  2.33s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0533, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8512, 'compress@10': 1.0, 'time@10': 2.9859}:  23%|██▎       | 7/30 [00:15<00:49,  2.13s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0494, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 3.0347}:  23%|██▎       | 7/30 [00:19<00:49,  2.13s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0494, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 3.0347}:  27%|██▋       | 8/30 [00:19<00:58,  2.65s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0472, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8634, 'compress@10': 1.0, 'time@10': 3.0498}:  27%|██▋       | 8/30 [00:21<00:58,  2.65s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0472, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8634, 'compress@10': 1.0, 'time@10': 3.0498}:  30%|███       | 9/30 [00:21<00:48,  2.33s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0446, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8709, 'compress@10': 1.0, 'time@10': 3.0904}:  30%|███       | 9/30 [00:24<00:48,  2.33s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0446, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8709, 'compress@10': 1.0, 'time@10': 3.0904}:  33%|███▎      | 10/30 [00:24<00:53,  2.69s/it]{'epoch': 31, 'num_users': 6.6364, 'loss': 0.0446, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8722, 'compress@10': 1.0, 'time@10': 3.1007}:  33%|███▎      | 10/30 [00:26<00:53,  2.69s/it]{'epoch': 31, 'num_users': 6.6364, 'loss': 0.0446, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8722, 'compress@10': 1.0, 'time@10': 3.1007}:  37%|███▋      | 11/30 [00:26<00:44,  2.37s/it]{'epoch': 31, 'num_users': 6.4167, 'loss': 0.041, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8759, 'compress@10': 1.0, 'time@10': 3.1021}:  37%|███▋      | 11/30 [00:29<00:44,  2.37s/it]  {'epoch': 31, 'num_users': 6.4167, 'loss': 0.041, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8759, 'compress@10': 1.0, 'time@10': 3.1021}:  40%|████      | 12/30 [00:29<00:46,  2.61s/it]{'epoch': 31, 'num_users': 6.6154, 'loss': 0.0405, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8761, 'compress@10': 1.0, 'time@10': 3.1233}:  40%|████      | 12/30 [00:31<00:46,  2.61s/it]{'epoch': 31, 'num_users': 6.6154, 'loss': 0.0405, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8761, 'compress@10': 1.0, 'time@10': 3.1233}:  43%|████▎     | 13/30 [00:31<00:39,  2.34s/it]{'epoch': 31, 'num_users': 6.3571, 'loss': 0.0376, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.8731, 'compress@10': 1.0, 'time@10': 3.1471}:  43%|████▎     | 13/30 [00:34<00:39,  2.34s/it]{'epoch': 31, 'num_users': 6.3571, 'loss': 0.0376, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.8731, 'compress@10': 1.0, 'time@10': 3.1471}:  47%|████▋     | 14/30 [00:34<00:43,  2.69s/it]{'epoch': 31, 'num_users': 6.2667, 'loss': 0.0378, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 3.1856}:  47%|████▋     | 14/30 [00:36<00:43,  2.69s/it]{'epoch': 31, 'num_users': 6.2667, 'loss': 0.0378, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 3.1856}:  50%|█████     | 15/30 [00:36<00:36,  2.45s/it]{'epoch': 31, 'num_users': 6.0625, 'loss': 0.0355, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 3.2175}:  50%|█████     | 15/30 [00:40<00:36,  2.45s/it]{'epoch': 31, 'num_users': 6.0625, 'loss': 0.0355, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 3.2175}:  53%|█████▎    | 16/30 [00:40<00:39,  2.84s/it]{'epoch': 31, 'num_users': 5.8235, 'loss': 0.0334, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8726, 'compress@10': 1.0, 'time@10': 3.2421}:  53%|█████▎    | 16/30 [00:41<00:39,  2.84s/it]{'epoch': 31, 'num_users': 5.8235, 'loss': 0.0334, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8726, 'compress@10': 1.0, 'time@10': 3.2421}:  57%|█████▋    | 17/30 [00:41<00:33,  2.54s/it]{'epoch': 31, 'num_users': 6.0556, 'loss': 0.0328, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 3.2538}:  57%|█████▋    | 17/30 [00:45<00:33,  2.54s/it]{'epoch': 31, 'num_users': 6.0556, 'loss': 0.0328, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 3.2538}:  60%|██████    | 18/30 [00:45<00:33,  2.83s/it]{'epoch': 31, 'num_users': 6.0, 'loss': 0.0314, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 3.2597}:  60%|██████    | 18/30 [00:47<00:33,  2.83s/it]   {'epoch': 31, 'num_users': 6.0, 'loss': 0.0314, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 3.2597}:  63%|██████▎   | 19/30 [00:47<00:27,  2.49s/it]{'epoch': 31, 'num_users': 6.15, 'loss': 0.0314, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8798, 'compress@10': 1.0, 'time@10': 3.2513}:  63%|██████▎   | 19/30 [00:50<00:27,  2.49s/it]{'epoch': 31, 'num_users': 6.15, 'loss': 0.0314, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8798, 'compress@10': 1.0, 'time@10': 3.2513}:  67%|██████▋   | 20/30 [00:50<00:26,  2.68s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0385, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 3.1285}:  67%|██████▋   | 20/30 [00:50<00:26,  2.68s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0385, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 3.1285}:  70%|███████   | 21/30 [00:50<00:17,  1.99s/it]{'epoch': 31, 'num_users': 6.1818, 'loss': 0.0371, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 3.1437}:  70%|███████   | 21/30 [00:54<00:17,  1.99s/it]{'epoch': 31, 'num_users': 6.1818, 'loss': 0.0371, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 3.1437}:  73%|███████▎  | 22/30 [00:54<00:19,  2.50s/it]{'epoch': 31, 'num_users': 6.1304, 'loss': 0.0362, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8732, 'compress@10': 1.0, 'time@10': 3.1608}:  73%|███████▎  | 22/30 [00:56<00:19,  2.50s/it]{'epoch': 31, 'num_users': 6.1304, 'loss': 0.0362, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8732, 'compress@10': 1.0, 'time@10': 3.1608}:  77%|███████▋  | 23/30 [00:56<00:16,  2.29s/it]{'epoch': 31, 'num_users': 5.9583, 'loss': 0.0347, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 3.1625}:  77%|███████▋  | 23/30 [00:59<00:16,  2.29s/it]{'epoch': 31, 'num_users': 5.9583, 'loss': 0.0347, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 3.1625}:  80%|████████  | 24/30 [00:59<00:15,  2.57s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0333, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 3.1648}:  80%|████████  | 24/30 [01:01<00:15,  2.57s/it]    {'epoch': 31, 'num_users': 5.8, 'loss': 0.0333, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 3.1648}:  83%|████████▎ | 25/30 [01:01<00:11,  2.30s/it]{'epoch': 31, 'num_users': 5.8077, 'loss': 0.0369, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 3.0672}:  83%|████████▎ | 25/30 [01:01<00:11,  2.30s/it]{'epoch': 31, 'num_users': 5.8077, 'loss': 0.0369, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 3.0672}:  87%|████████▋ | 26/30 [01:01<00:07,  1.81s/it]{'epoch': 31, 'num_users': 5.8889, 'loss': 0.0363, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 3.0818}:  87%|████████▋ | 26/30 [01:03<00:07,  1.81s/it]{'epoch': 31, 'num_users': 5.8889, 'loss': 0.0363, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 3.0818}:  90%|█████████ | 27/30 [01:03<00:05,  1.80s/it]{'epoch': 31, 'num_users': 6.0, 'loss': 0.0358, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8591, 'compress@10': 1.0, 'time@10': 3.0983}:  90%|█████████ | 27/30 [01:07<00:05,  1.80s/it]   {'epoch': 31, 'num_users': 6.0, 'loss': 0.0358, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8591, 'compress@10': 1.0, 'time@10': 3.0983}:  93%|█████████▎| 28/30 [01:07<00:04,  2.33s/it]{'epoch': 31, 'num_users': 5.8621, 'loss': 0.0352, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 3.1211}:  93%|█████████▎| 28/30 [01:09<00:04,  2.33s/it]{'epoch': 31, 'num_users': 5.8621, 'loss': 0.0352, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 3.1211}:  97%|█████████▋| 29/30 [01:09<00:02,  2.21s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0346, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8627, 'compress@10': 1.0, 'time@10': 3.1374}:  97%|█████████▋| 29/30 [01:12<00:02,  2.21s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0346, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8627, 'compress@10': 1.0, 'time@10': 3.1374}: 100%|██████████| 30/30 [01:12<00:00,  2.64s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0346, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8627, 'compress@10': 1.0, 'time@10': 3.1374}: 100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch: 31
Avg # of users: 5.866666666666666
Avg Loss: 0.034626989224681305
Avg hit ratio: 0.8594560291621604
Avg ndcg: 0.862718764719897
Avg compression ratio: 0.9999999860166272
Avg train time: 3.1374349037806195
Std train time: 0.8197878708874788
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 35, 14, 8, 9, 8, 11, 6, 9, 8, 37, 9, 78, 6, 36, 51, 14, 15, 7, 9, 19, 11, 99, 96, 9, 7, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8844, 'compress@10': 1.0, 'time@10': 3.1353}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8844, 'compress@10': 1.0, 'time@10': 3.1353}:   3%|▎         | 1/30 [00:01<00:46,  1.60s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0344, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.916, 'compress@10': 1.0, 'time@10': 3.3692}:   3%|▎         | 1/30 [00:05<00:46,  1.60s/it] {'epoch': 32, 'num_users': 7.0, 'loss': 0.0344, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.916, 'compress@10': 1.0, 'time@10': 3.3692}:   7%|▋         | 2/30 [00:05<01:18,  2.80s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.4078}:   7%|▋         | 2/30 [00:07<01:18,  2.80s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.4078}:  10%|█         | 3/30 [00:07<01:03,  2.34s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9111, 'compress@10': 1.0, 'time@10': 3.4541}:  10%|█         | 3/30 [00:10<01:03,  2.34s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9111, 'compress@10': 1.0, 'time@10': 3.4541}:  13%|█▎        | 4/30 [00:10<01:13,  2.85s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0279, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 4.1992}:  13%|█▎        | 4/30 [00:14<01:13,  2.85s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0279, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 4.1992}:  17%|█▋        | 5/30 [00:14<01:18,  3.13s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0273, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.8959, 'compress@10': 1.0, 'time@10': 4.0738}:  17%|█▋        | 5/30 [00:17<01:18,  3.13s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0273, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.8959, 'compress@10': 1.0, 'time@10': 4.0738}:  20%|██        | 6/30 [00:17<01:17,  3.25s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0278, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.9917}:  20%|██        | 6/30 [00:19<01:17,  3.25s/it] {'epoch': 32, 'num_users': 6.2857, 'loss': 0.0278, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.9917}:  23%|██▎       | 7/30 [00:19<01:03,  2.77s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0261, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 3.9234}:  23%|██▎       | 7/30 [00:23<01:03,  2.77s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0261, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 3.9234}:  27%|██▋       | 8/30 [00:23<01:05,  3.00s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9036, 'compress@10': 1.0, 'time@10': 3.8813}:  27%|██▋       | 8/30 [00:24<01:05,  3.00s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9036, 'compress@10': 1.0, 'time@10': 3.8813}:  30%|███       | 9/30 [00:24<00:55,  2.63s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9062, 'compress@10': 1.0, 'time@10': 3.8147}:  30%|███       | 9/30 [00:28<00:55,  2.63s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9062, 'compress@10': 1.0, 'time@10': 3.8147}:  33%|███▎      | 10/30 [00:28<00:56,  2.82s/it]{'epoch': 32, 'num_users': 6.6364, 'loss': 0.0274, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9043, 'compress@10': 1.0, 'time@10': 3.8139}:  33%|███▎      | 10/30 [00:30<00:56,  2.82s/it]{'epoch': 32, 'num_users': 6.6364, 'loss': 0.0274, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9043, 'compress@10': 1.0, 'time@10': 3.8139}:  37%|███▋      | 11/30 [00:30<00:48,  2.55s/it]{'epoch': 32, 'num_users': 6.4167, 'loss': 0.0253, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9053, 'compress@10': 1.0, 'time@10': 3.7957}:  37%|███▋      | 11/30 [00:33<00:48,  2.55s/it]{'epoch': 32, 'num_users': 6.4167, 'loss': 0.0253, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9053, 'compress@10': 1.0, 'time@10': 3.7957}:  40%|████      | 12/30 [00:33<00:51,  2.88s/it]{'epoch': 32, 'num_users': 6.6154, 'loss': 0.026, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9034, 'compress@10': 1.0, 'time@10': 3.7779}:  40%|████      | 12/30 [00:35<00:51,  2.88s/it]  {'epoch': 32, 'num_users': 6.6154, 'loss': 0.026, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9034, 'compress@10': 1.0, 'time@10': 3.7779}:  43%|████▎     | 13/30 [00:35<00:43,  2.56s/it]{'epoch': 32, 'num_users': 6.3571, 'loss': 0.0242, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8984, 'compress@10': 1.0, 'time@10': 3.7464}:  43%|████▎     | 13/30 [00:38<00:43,  2.56s/it]{'epoch': 32, 'num_users': 6.3571, 'loss': 0.0242, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8984, 'compress@10': 1.0, 'time@10': 3.7464}:  47%|████▋     | 14/30 [00:38<00:44,  2.81s/it]{'epoch': 32, 'num_users': 6.2667, 'loss': 0.025, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.7065}:  47%|████▋     | 14/30 [00:40<00:44,  2.81s/it] {'epoch': 32, 'num_users': 6.2667, 'loss': 0.025, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.7065}:  50%|█████     | 15/30 [00:40<00:36,  2.45s/it]{'epoch': 32, 'num_users': 6.0625, 'loss': 0.0235, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.898, 'compress@10': 1.0, 'time@10': 3.6903}:  50%|█████     | 15/30 [00:43<00:36,  2.45s/it]{'epoch': 32, 'num_users': 6.0625, 'loss': 0.0235, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.898, 'compress@10': 1.0, 'time@10': 3.6903}:  53%|█████▎    | 16/30 [00:43<00:38,  2.76s/it]{'epoch': 32, 'num_users': 5.8235, 'loss': 0.0221, 'hit_ratio@10': 0.851, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.6908}:  53%|█████▎    | 16/30 [00:45<00:38,  2.76s/it]{'epoch': 32, 'num_users': 5.8235, 'loss': 0.0221, 'hit_ratio@10': 0.851, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.6908}:  57%|█████▋    | 17/30 [00:45<00:32,  2.50s/it]{'epoch': 32, 'num_users': 6.0556, 'loss': 0.0221, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 3.6748}:  57%|█████▋    | 17/30 [00:49<00:32,  2.50s/it]{'epoch': 32, 'num_users': 6.0556, 'loss': 0.0221, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 3.6748}:  60%|██████    | 18/30 [00:49<00:33,  2.79s/it]{'epoch': 32, 'num_users': 6.0, 'loss': 0.0214, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 3.6576}:  60%|██████    | 18/30 [00:51<00:33,  2.79s/it]    {'epoch': 32, 'num_users': 6.0, 'loss': 0.0214, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 3.6576}:  63%|██████▎   | 19/30 [00:51<00:27,  2.46s/it]{'epoch': 32, 'num_users': 6.15, 'loss': 0.0218, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.659}:  63%|██████▎   | 19/30 [00:54<00:27,  2.46s/it]{'epoch': 32, 'num_users': 6.15, 'loss': 0.0218, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.659}:  67%|██████▋   | 20/30 [00:54<00:28,  2.84s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0232, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 3.7938}:  67%|██████▋   | 20/30 [00:58<00:28,  2.84s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0232, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 3.7938}:  70%|███████   | 21/30 [00:58<00:26,  2.97s/it]{'epoch': 32, 'num_users': 6.1818, 'loss': 0.0226, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.7823}:  70%|███████   | 21/30 [01:01<00:26,  2.97s/it] {'epoch': 32, 'num_users': 6.1818, 'loss': 0.0226, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.7823}:  73%|███████▎  | 22/30 [01:01<00:25,  3.16s/it]{'epoch': 32, 'num_users': 6.1304, 'loss': 0.0225, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 3.7766}:  73%|███████▎  | 22/30 [01:03<00:25,  3.16s/it]{'epoch': 32, 'num_users': 6.1304, 'loss': 0.0225, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 3.7766}:  77%|███████▋  | 23/30 [01:03<00:19,  2.77s/it]{'epoch': 32, 'num_users': 5.9583, 'loss': 0.0215, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8935, 'compress@10': 1.0, 'time@10': 3.77}:  77%|███████▋  | 23/30 [01:07<00:19,  2.77s/it]   {'epoch': 32, 'num_users': 5.9583, 'loss': 0.0215, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8935, 'compress@10': 1.0, 'time@10': 3.77}:  80%|████████  | 24/30 [01:07<00:18,  3.04s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8844, 'compress@10': 1.0, 'time@10': 3.7519}:  80%|████████  | 24/30 [01:08<00:18,  3.04s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8844, 'compress@10': 1.0, 'time@10': 3.7519}:  83%|████████▎ | 25/30 [01:08<00:13,  2.63s/it]{'epoch': 32, 'num_users': 5.8077, 'loss': 0.0208, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8859, 'compress@10': 1.0, 'time@10': 3.8578}:  83%|████████▎ | 25/30 [01:15<00:13,  2.63s/it]{'epoch': 32, 'num_users': 5.8077, 'loss': 0.0208, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8859, 'compress@10': 1.0, 'time@10': 3.8578}:  87%|████████▋ | 26/30 [01:15<00:15,  3.81s/it]{'epoch': 32, 'num_users': 5.8889, 'loss': 0.0208, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8866, 'compress@10': 1.0, 'time@10': 3.8458}:  87%|████████▋ | 26/30 [01:17<00:15,  3.81s/it]{'epoch': 32, 'num_users': 5.8889, 'loss': 0.0208, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8866, 'compress@10': 1.0, 'time@10': 3.8458}:  90%|█████████ | 27/30 [01:17<00:09,  3.21s/it]{'epoch': 32, 'num_users': 6.0, 'loss': 0.0209, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8881, 'compress@10': 1.0, 'time@10': 3.845}:  90%|█████████ | 27/30 [01:21<00:09,  3.21s/it]   {'epoch': 32, 'num_users': 6.0, 'loss': 0.0209, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8881, 'compress@10': 1.0, 'time@10': 3.845}:  93%|█████████▎| 28/30 [01:21<00:06,  3.40s/it]{'epoch': 32, 'num_users': 5.8621, 'loss': 0.0209, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8896, 'compress@10': 1.0, 'time@10': 3.8374}:  93%|█████████▎| 28/30 [01:22<00:06,  3.40s/it]{'epoch': 32, 'num_users': 5.8621, 'loss': 0.0209, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8896, 'compress@10': 1.0, 'time@10': 3.8374}:  97%|█████████▋| 29/30 [01:22<00:02,  2.94s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0207, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 3.831}:  97%|█████████▋| 29/30 [01:26<00:02,  2.94s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0207, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 3.831}: 100%|██████████| 30/30 [01:26<00:00,  3.16s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0207, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 3.831}: 100%|██████████| 30/30 [01:26<00:00,  2.89s/it]
Epoch: 32
Avg # of users: 5.866666666666666
Avg Loss: 0.020699183625210636
Avg hit ratio: 0.866913431648755
Avg ndcg: 0.8918638446765962
Avg compression ratio: 0.9999999860153537
Avg train time: 3.8309501806894937
Std train time: 0.9840303472901042
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 35, 14, 1, 9, 8, 11, 6, 10, 7, 37, 9, 78, 7, 36, 50, 14, 15, 6, 1, 19, 10, 98, 96, 1, 7, 7, 9, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0335, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 3.6348}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0335, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 3.6348}:   3%|▎         | 1/30 [00:01<00:53,  1.86s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 3.5963}:   3%|▎         | 1/30 [00:05<00:53,  1.86s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 3.5963}:   7%|▋         | 2/30 [00:05<01:20,  2.88s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8894, 'compress@10': 1.0, 'time@10': 3.5028}:   7%|▋         | 2/30 [00:07<01:20,  2.88s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8894, 'compress@10': 1.0, 'time@10': 3.5028}:  10%|█         | 3/30 [00:07<01:03,  2.34s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9459, 'compress@10': 1.0, 'time@10': 3.4048}:  10%|█         | 3/30 [00:10<01:03,  2.34s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9459, 'compress@10': 1.0, 'time@10': 3.4048}:  13%|█▎        | 4/30 [00:10<01:09,  2.66s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0531, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8762, 'compress@10': 1.0, 'time@10': 2.8872}:  13%|█▎        | 4/30 [00:10<01:09,  2.66s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0531, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8762, 'compress@10': 1.0, 'time@10': 2.8872}:  17%|█▋        | 5/30 [00:10<00:46,  1.86s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0478, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 3.0126}:  17%|█▋        | 5/30 [00:14<00:46,  1.86s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0478, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 3.0126}:  20%|██        | 6/30 [00:14<00:59,  2.48s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0452, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8836, 'compress@10': 1.0, 'time@10': 3.0687}:  20%|██        | 6/30 [00:16<00:59,  2.48s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0452, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8836, 'compress@10': 1.0, 'time@10': 3.0687}:  23%|██▎       | 7/30 [00:16<00:51,  2.24s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.045, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.8897, 'compress@10': 1.0, 'time@10': 3.0607}:  23%|██▎       | 7/30 [00:19<00:51,  2.24s/it]  {'epoch': 33, 'num_users': 6.125, 'loss': 0.045, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.8897, 'compress@10': 1.0, 'time@10': 3.0607}:  27%|██▋       | 8/30 [00:19<00:54,  2.49s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0429, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8934, 'compress@10': 1.0, 'time@10': 3.1174}:  27%|██▋       | 8/30 [00:21<00:54,  2.49s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0429, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8934, 'compress@10': 1.0, 'time@10': 3.1174}:  30%|███       | 9/30 [00:21<00:47,  2.28s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0412, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.178}:  30%|███       | 9/30 [00:24<00:47,  2.28s/it]    {'epoch': 33, 'num_users': 6.3, 'loss': 0.0412, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.178}:  33%|███▎      | 10/30 [00:24<00:54,  2.74s/it]{'epoch': 33, 'num_users': 6.6364, 'loss': 0.0412, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8972, 'compress@10': 1.0, 'time@10': 3.1513}:  33%|███▎      | 10/30 [00:26<00:54,  2.74s/it]{'epoch': 33, 'num_users': 6.6364, 'loss': 0.0412, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8972, 'compress@10': 1.0, 'time@10': 3.1513}:  37%|███▋      | 11/30 [00:26<00:44,  2.35s/it]{'epoch': 33, 'num_users': 6.4167, 'loss': 0.0378, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 3.1771}:  37%|███▋      | 11/30 [00:29<00:44,  2.35s/it]{'epoch': 33, 'num_users': 6.4167, 'loss': 0.0378, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 3.1771}:  40%|████      | 12/30 [00:29<00:48,  2.70s/it]{'epoch': 33, 'num_users': 6.6154, 'loss': 0.0375, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8976, 'compress@10': 1.0, 'time@10': 3.198}:  40%|████      | 12/30 [00:31<00:48,  2.70s/it] {'epoch': 33, 'num_users': 6.6154, 'loss': 0.0375, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8976, 'compress@10': 1.0, 'time@10': 3.198}:  43%|████▎     | 13/30 [00:31<00:41,  2.42s/it]{'epoch': 33, 'num_users': 6.3571, 'loss': 0.0348, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 3.2157}:  43%|████▎     | 13/30 [00:35<00:41,  2.42s/it]{'epoch': 33, 'num_users': 6.3571, 'loss': 0.0348, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 3.2157}:  47%|████▋     | 14/30 [00:35<00:43,  2.74s/it]{'epoch': 33, 'num_users': 6.2667, 'loss': 0.0351, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 3.2591}:  47%|████▋     | 14/30 [00:36<00:43,  2.74s/it] {'epoch': 33, 'num_users': 6.2667, 'loss': 0.0351, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 3.2591}:  50%|█████     | 15/30 [00:36<00:37,  2.51s/it]{'epoch': 33, 'num_users': 6.0625, 'loss': 0.0329, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8946, 'compress@10': 1.0, 'time@10': 3.272}:  50%|█████     | 15/30 [00:40<00:37,  2.51s/it] {'epoch': 33, 'num_users': 6.0625, 'loss': 0.0329, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8946, 'compress@10': 1.0, 'time@10': 3.272}:  53%|█████▎    | 16/30 [00:40<00:39,  2.81s/it]{'epoch': 33, 'num_users': 5.8235, 'loss': 0.031, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.2761}:  53%|█████▎    | 16/30 [00:42<00:39,  2.81s/it]{'epoch': 33, 'num_users': 5.8235, 'loss': 0.031, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.2761}:  57%|█████▋    | 17/30 [00:42<00:32,  2.48s/it]{'epoch': 33, 'num_users': 6.0556, 'loss': 0.0305, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 3.2892}:  57%|█████▋    | 17/30 [00:45<00:32,  2.48s/it]{'epoch': 33, 'num_users': 6.0556, 'loss': 0.0305, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 3.2892}:  60%|██████    | 18/30 [00:45<00:33,  2.80s/it]{'epoch': 33, 'num_users': 6.0, 'loss': 0.0292, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.3016}:  60%|██████    | 18/30 [00:47<00:33,  2.80s/it]   {'epoch': 33, 'num_users': 6.0, 'loss': 0.0292, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.3016}:  63%|██████▎   | 19/30 [00:47<00:27,  2.50s/it]{'epoch': 33, 'num_users': 6.15, 'loss': 0.0292, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.2907}:  63%|██████▎   | 19/30 [00:50<00:27,  2.50s/it]{'epoch': 33, 'num_users': 6.15, 'loss': 0.0292, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.2907}:  67%|██████▋   | 20/30 [00:50<00:26,  2.69s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0364, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 3.1681}:  67%|██████▋   | 20/30 [00:51<00:26,  2.69s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0364, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 3.1681}:  70%|███████   | 21/30 [00:51<00:18,  2.00s/it]{'epoch': 33, 'num_users': 6.1818, 'loss': 0.035, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8826, 'compress@10': 1.0, 'time@10': 3.1855}:  70%|███████   | 21/30 [00:54<00:18,  2.00s/it]{'epoch': 33, 'num_users': 6.1818, 'loss': 0.035, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8826, 'compress@10': 1.0, 'time@10': 3.1855}:  73%|███████▎  | 22/30 [00:54<00:19,  2.48s/it]{'epoch': 33, 'num_users': 6.1304, 'loss': 0.0342, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 3.1884}:  73%|███████▎  | 22/30 [00:56<00:19,  2.48s/it]{'epoch': 33, 'num_users': 6.1304, 'loss': 0.0342, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 3.1884}:  77%|███████▋  | 23/30 [00:56<00:15,  2.23s/it]{'epoch': 33, 'num_users': 5.9583, 'loss': 0.0328, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 3.198}:  77%|███████▋  | 23/30 [00:59<00:15,  2.23s/it] {'epoch': 33, 'num_users': 5.9583, 'loss': 0.0328, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 3.198}:  80%|████████  | 24/30 [00:59<00:15,  2.60s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0315, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.8725, 'compress@10': 1.0, 'time@10': 3.2007}:  80%|████████  | 24/30 [01:01<00:15,  2.60s/it]  {'epoch': 33, 'num_users': 5.8, 'loss': 0.0315, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.8725, 'compress@10': 1.0, 'time@10': 3.2007}:  83%|████████▎ | 25/30 [01:01<00:11,  2.32s/it]{'epoch': 33, 'num_users': 5.8077, 'loss': 0.0349, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 3.1034}:  83%|████████▎ | 25/30 [01:02<00:11,  2.32s/it]{'epoch': 33, 'num_users': 5.8077, 'loss': 0.0349, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 3.1034}:  87%|████████▋ | 26/30 [01:02<00:07,  1.84s/it]{'epoch': 33, 'num_users': 5.8889, 'loss': 0.0344, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8668, 'compress@10': 1.0, 'time@10': 3.1116}:  87%|████████▋ | 26/30 [01:03<00:07,  1.84s/it]{'epoch': 33, 'num_users': 5.8889, 'loss': 0.0344, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8668, 'compress@10': 1.0, 'time@10': 3.1116}:  90%|█████████ | 27/30 [01:03<00:05,  1.80s/it]{'epoch': 33, 'num_users': 6.0, 'loss': 0.034, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 3.1164}:  90%|█████████ | 27/30 [01:07<00:05,  1.80s/it]    {'epoch': 33, 'num_users': 6.0, 'loss': 0.034, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 3.1164}:  93%|█████████▎| 28/30 [01:07<00:04,  2.24s/it]{'epoch': 33, 'num_users': 5.8621, 'loss': 0.0333, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 3.1247}:  93%|█████████▎| 28/30 [01:08<00:04,  2.24s/it]{'epoch': 33, 'num_users': 5.8621, 'loss': 0.0333, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 3.1247}:  97%|█████████▋| 29/30 [01:08<00:02,  2.08s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0329, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8763, 'compress@10': 1.0, 'time@10': 3.1244}:  97%|█████████▋| 29/30 [01:12<00:02,  2.08s/it] {'epoch': 33, 'num_users': 5.8667, 'loss': 0.0329, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8763, 'compress@10': 1.0, 'time@10': 3.1244}: 100%|██████████| 30/30 [01:12<00:00,  2.41s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0329, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8763, 'compress@10': 1.0, 'time@10': 3.1244}: 100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch: 33
Avg # of users: 5.866666666666666
Avg Loss: 0.03292042155808815
Avg hit ratio: 0.847996611372361
Avg ndcg: 0.8763056452547798
Avg compression ratio: 0.9999999860166272
Avg train time: 3.1243699550628663
Std train time: 0.8239612212552673
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 35, 15, 9, 8, 8, 12, 6, 9, 9, 37, 9, 78, 6, 36, 50, 14, 15, 7, 9, 19, 11, 98, 97, 9, 7, 8, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.883, 'compress@10': 1.0, 'time@10': 3.2781}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.883, 'compress@10': 1.0, 'time@10': 3.2781}:   3%|▎         | 1/30 [00:01<00:48,  1.68s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9206, 'compress@10': 1.0, 'time@10': 3.3377}:   3%|▎         | 1/30 [00:05<00:48,  1.68s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9206, 'compress@10': 1.0, 'time@10': 3.3377}:   7%|▋         | 2/30 [00:05<01:15,  2.71s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8994, 'compress@10': 1.0, 'time@10': 3.2761}:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8994, 'compress@10': 1.0, 'time@10': 3.2761}:  10%|█         | 3/30 [00:06<00:59,  2.21s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9079, 'compress@10': 1.0, 'time@10': 3.3113}:  10%|█         | 3/30 [00:10<00:59,  2.21s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9079, 'compress@10': 1.0, 'time@10': 3.3113}:  13%|█▎        | 4/30 [00:10<01:10,  2.70s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 4.2735}:  13%|█▎        | 4/30 [00:14<01:10,  2.70s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 4.2735}:  17%|█▋        | 5/30 [00:14<01:20,  3.21s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0214, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8974, 'compress@10': 1.0, 'time@10': 4.1036}:  17%|█▋        | 5/30 [00:17<01:20,  3.21s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0214, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8974, 'compress@10': 1.0, 'time@10': 4.1036}:  20%|██        | 6/30 [00:17<01:17,  3.24s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 4.0037}:  20%|██        | 6/30 [00:19<01:17,  3.24s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 4.0037}:  23%|██▎       | 7/30 [00:19<01:03,  2.75s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0237, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9034, 'compress@10': 1.0, 'time@10': 3.952}:  23%|██▎       | 7/30 [00:22<01:03,  2.75s/it]  {'epoch': 34, 'num_users': 6.125, 'loss': 0.0237, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9034, 'compress@10': 1.0, 'time@10': 3.952}:  27%|██▋       | 8/30 [00:22<01:06,  3.03s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 3.874}:  27%|██▋       | 8/30 [00:24<01:06,  3.03s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 3.874}:  30%|███       | 9/30 [00:24<00:54,  2.60s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0226, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.911, 'compress@10': 1.0, 'time@10': 3.8338}:  30%|███       | 9/30 [00:28<00:54,  2.60s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0226, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.911, 'compress@10': 1.0, 'time@10': 3.8338}:  33%|███▎      | 10/30 [00:28<00:57,  2.88s/it]{'epoch': 34, 'num_users': 6.6364, 'loss': 0.0243, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9088, 'compress@10': 1.0, 'time@10': 3.8627}:  33%|███▎      | 10/30 [00:30<00:57,  2.88s/it]{'epoch': 34, 'num_users': 6.6364, 'loss': 0.0243, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9088, 'compress@10': 1.0, 'time@10': 3.8627}:  37%|███▋      | 11/30 [00:30<00:50,  2.65s/it]{'epoch': 34, 'num_users': 6.4167, 'loss': 0.0225, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9095, 'compress@10': 1.0, 'time@10': 3.8086}:  37%|███▋      | 11/30 [00:33<00:50,  2.65s/it]{'epoch': 34, 'num_users': 6.4167, 'loss': 0.0225, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9095, 'compress@10': 1.0, 'time@10': 3.8086}:  40%|████      | 12/30 [00:33<00:50,  2.83s/it]{'epoch': 34, 'num_users': 6.6154, 'loss': 0.0234, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.9076, 'compress@10': 1.0, 'time@10': 3.7653}:  40%|████      | 12/30 [00:35<00:50,  2.83s/it]{'epoch': 34, 'num_users': 6.6154, 'loss': 0.0234, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.9076, 'compress@10': 1.0, 'time@10': 3.7653}:  43%|████▎     | 13/30 [00:35<00:42,  2.48s/it]{'epoch': 34, 'num_users': 6.3571, 'loss': 0.0217, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.9023, 'compress@10': 1.0, 'time@10': 3.7455}:  43%|████▎     | 13/30 [00:38<00:42,  2.48s/it]{'epoch': 34, 'num_users': 6.3571, 'loss': 0.0217, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.9023, 'compress@10': 1.0, 'time@10': 3.7455}:  47%|████▋     | 14/30 [00:38<00:44,  2.80s/it]{'epoch': 34, 'num_users': 6.2667, 'loss': 0.0227, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.9004, 'compress@10': 1.0, 'time@10': 3.6978}:  47%|████▋     | 14/30 [00:40<00:44,  2.80s/it]{'epoch': 34, 'num_users': 6.2667, 'loss': 0.0227, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.9004, 'compress@10': 1.0, 'time@10': 3.6978}:  50%|█████     | 15/30 [00:40<00:36,  2.42s/it]{'epoch': 34, 'num_users': 6.0625, 'loss': 0.0213, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.9014, 'compress@10': 1.0, 'time@10': 3.686}:  50%|█████     | 15/30 [00:43<00:36,  2.42s/it] {'epoch': 34, 'num_users': 6.0625, 'loss': 0.0213, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.9014, 'compress@10': 1.0, 'time@10': 3.686}:  53%|█████▎    | 16/30 [00:43<00:38,  2.76s/it]{'epoch': 34, 'num_users': 5.8235, 'loss': 0.02, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 3.6503}:  53%|█████▎    | 16/30 [00:45<00:38,  2.76s/it] {'epoch': 34, 'num_users': 5.8235, 'loss': 0.02, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 3.6503}:  57%|█████▋    | 17/30 [00:45<00:31,  2.40s/it]{'epoch': 34, 'num_users': 6.0556, 'loss': 0.0206, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.6418}:  57%|█████▋    | 17/30 [00:48<00:31,  2.40s/it]{'epoch': 34, 'num_users': 6.0556, 'loss': 0.0206, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.6418}:  60%|██████    | 18/30 [00:48<00:32,  2.74s/it]{'epoch': 34, 'num_users': 6.0, 'loss': 0.0199, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.6131}:  60%|██████    | 18/30 [00:50<00:32,  2.74s/it]   {'epoch': 34, 'num_users': 6.0, 'loss': 0.0199, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.6131}:  63%|██████▎   | 19/30 [00:50<00:26,  2.40s/it]{'epoch': 34, 'num_users': 6.15, 'loss': 0.0203, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.6021}:  63%|██████▎   | 19/30 [00:53<00:26,  2.40s/it]{'epoch': 34, 'num_users': 6.15, 'loss': 0.0203, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.6021}:  67%|██████▋   | 20/30 [00:53<00:27,  2.71s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.7391}:  67%|██████▋   | 20/30 [00:57<00:27,  2.71s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.7391}:  70%|███████   | 21/30 [00:57<00:25,  2.88s/it]{'epoch': 34, 'num_users': 6.1818, 'loss': 0.0209, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.7268}:  70%|███████   | 21/30 [01:00<00:25,  2.88s/it]{'epoch': 34, 'num_users': 6.1818, 'loss': 0.0209, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.7268}:  73%|███████▎  | 22/30 [01:00<00:24,  3.07s/it]{'epoch': 34, 'num_users': 6.1304, 'loss': 0.0209, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.899, 'compress@10': 1.0, 'time@10': 3.7303}:  73%|███████▎  | 22/30 [01:02<00:24,  3.07s/it] {'epoch': 34, 'num_users': 6.1304, 'loss': 0.0209, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.899, 'compress@10': 1.0, 'time@10': 3.7303}:  77%|███████▋  | 23/30 [01:02<00:19,  2.73s/it]{'epoch': 34, 'num_users': 5.9583, 'loss': 0.02, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.7087}:  77%|███████▋  | 23/30 [01:05<00:19,  2.73s/it] {'epoch': 34, 'num_users': 5.9583, 'loss': 0.02, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.7087}:  80%|████████  | 24/30 [01:05<00:17,  2.89s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0192, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8858, 'compress@10': 1.0, 'time@10': 3.7022}:  80%|████████  | 24/30 [01:07<00:17,  2.89s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 0.0192, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8858, 'compress@10': 1.0, 'time@10': 3.7022}:  83%|████████▎ | 25/30 [01:07<00:12,  2.56s/it]{'epoch': 34, 'num_users': 5.8077, 'loss': 0.0194, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8875, 'compress@10': 1.0, 'time@10': 3.8074}:  83%|████████▎ | 25/30 [01:14<00:12,  2.56s/it]{'epoch': 34, 'num_users': 5.8077, 'loss': 0.0194, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8875, 'compress@10': 1.0, 'time@10': 3.8074}:  87%|████████▋ | 26/30 [01:14<00:14,  3.74s/it]{'epoch': 34, 'num_users': 5.8889, 'loss': 0.0194, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8883, 'compress@10': 1.0, 'time@10': 3.7927}:  87%|████████▋ | 26/30 [01:15<00:14,  3.74s/it]{'epoch': 34, 'num_users': 5.8889, 'loss': 0.0194, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8883, 'compress@10': 1.0, 'time@10': 3.7927}:  90%|█████████ | 27/30 [01:15<00:09,  3.14s/it]{'epoch': 34, 'num_users': 6.0, 'loss': 0.0195, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 3.7866}:  90%|█████████ | 27/30 [01:19<00:09,  3.14s/it]   {'epoch': 34, 'num_users': 6.0, 'loss': 0.0195, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 3.7866}:  93%|█████████▎| 28/30 [01:19<00:06,  3.30s/it]{'epoch': 34, 'num_users': 5.8621, 'loss': 0.0191, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8916, 'compress@10': 1.0, 'time@10': 3.7638}:  93%|█████████▎| 28/30 [01:21<00:06,  3.30s/it]{'epoch': 34, 'num_users': 5.8621, 'loss': 0.0191, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8916, 'compress@10': 1.0, 'time@10': 3.7638}:  97%|█████████▋| 29/30 [01:21<00:02,  2.79s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.0208, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 3.7497}:  97%|█████████▋| 29/30 [01:24<00:02,  2.79s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.0208, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 3.7497}: 100%|██████████| 30/30 [01:24<00:00,  2.96s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.0208, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 3.7497}: 100%|██████████| 30/30 [01:24<00:00,  2.82s/it]
Epoch: 34
Avg # of users: 5.866666666666666
Avg Loss: 0.02076176678511059
Avg hit ratio: 0.8542128793486747
Avg ndcg: 0.8958151819886312
Avg compression ratio: 0.9999999860153537
Avg train time: 3.7496584971745808
Std train time: 1.1380491373736603
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 36, 15, 1, 9, 8, 12, 7, 9, 7, 38, 10, 78, 7, 36, 51, 14, 16, 7, 1, 19, 10, 99, 97, 1, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 3.3645}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 3.3645}:   3%|▎         | 1/30 [00:01<00:49,  1.72s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9162, 'compress@10': 1.0, 'time@10': 3.4601}:   3%|▎         | 1/30 [00:05<00:49,  1.72s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9162, 'compress@10': 1.0, 'time@10': 3.4601}:   7%|▋         | 2/30 [00:05<01:19,  2.84s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8965, 'compress@10': 1.0, 'time@10': 3.5297}:   7%|▋         | 2/30 [00:07<01:19,  2.84s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8965, 'compress@10': 1.0, 'time@10': 3.5297}:  10%|█         | 3/30 [00:07<01:04,  2.40s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.9004, 'compress@10': 1.0, 'time@10': 3.5737}:  10%|█         | 3/30 [00:10<01:04,  2.40s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.9004, 'compress@10': 1.0, 'time@10': 3.5737}:  13%|█▎        | 4/30 [00:10<01:16,  2.93s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.05, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8363, 'compress@10': 1.0, 'time@10': 3.0383}:  13%|█▎        | 4/30 [00:11<01:16,  2.93s/it]  {'epoch': 35, 'num_users': 5.8, 'loss': 0.05, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8363, 'compress@10': 1.0, 'time@10': 3.0383}:  17%|█▋        | 5/30 [00:11<00:51,  2.05s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0459, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8473, 'compress@10': 1.0, 'time@10': 3.1114}:  17%|█▋        | 5/30 [00:14<00:51,  2.05s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0459, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8473, 'compress@10': 1.0, 'time@10': 3.1114}:  20%|██        | 6/30 [00:14<01:01,  2.55s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0434, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8539, 'compress@10': 1.0, 'time@10': 3.1384}:  20%|██        | 6/30 [00:16<01:01,  2.55s/it]  {'epoch': 35, 'num_users': 6.2857, 'loss': 0.0434, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8539, 'compress@10': 1.0, 'time@10': 3.1384}:  23%|██▎       | 7/30 [00:16<00:52,  2.27s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0406, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.8601, 'compress@10': 1.0, 'time@10': 3.2112}:  23%|██▎       | 7/30 [00:20<00:52,  2.27s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0406, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.8601, 'compress@10': 1.0, 'time@10': 3.2112}:  27%|██▋       | 8/30 [00:20<01:00,  2.74s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0398, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8677, 'compress@10': 1.0, 'time@10': 3.3527}:  27%|██▋       | 8/30 [00:22<01:00,  2.74s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0398, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8677, 'compress@10': 1.0, 'time@10': 3.3527}:  30%|███       | 9/30 [00:22<00:54,  2.60s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8767, 'compress@10': 1.0, 'time@10': 3.3709}:  30%|███       | 9/30 [00:26<00:54,  2.60s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8767, 'compress@10': 1.0, 'time@10': 3.3709}:  33%|███▎      | 10/30 [00:26<00:58,  2.93s/it]{'epoch': 35, 'num_users': 6.6364, 'loss': 0.038, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8779, 'compress@10': 1.0, 'time@10': 3.3725}:  33%|███▎      | 10/30 [00:28<00:58,  2.93s/it]{'epoch': 35, 'num_users': 6.6364, 'loss': 0.038, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8779, 'compress@10': 1.0, 'time@10': 3.3725}:  37%|███▋      | 11/30 [00:28<00:48,  2.56s/it]{'epoch': 35, 'num_users': 6.4167, 'loss': 0.0349, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 3.4035}:  37%|███▋      | 11/30 [00:31<00:48,  2.56s/it]{'epoch': 35, 'num_users': 6.4167, 'loss': 0.0349, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 3.4035}:  40%|████      | 12/30 [00:31<00:52,  2.93s/it]{'epoch': 35, 'num_users': 6.6154, 'loss': 0.035, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8813, 'compress@10': 1.0, 'time@10': 3.4411}:  40%|████      | 12/30 [00:33<00:52,  2.93s/it] {'epoch': 35, 'num_users': 6.6154, 'loss': 0.035, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8813, 'compress@10': 1.0, 'time@10': 3.4411}:  43%|████▎     | 13/30 [00:33<00:45,  2.65s/it]{'epoch': 35, 'num_users': 6.3571, 'loss': 0.0325, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8779, 'compress@10': 1.0, 'time@10': 3.4367}:  43%|████▎     | 13/30 [00:37<00:45,  2.65s/it]{'epoch': 35, 'num_users': 6.3571, 'loss': 0.0325, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8779, 'compress@10': 1.0, 'time@10': 3.4367}:  47%|████▋     | 14/30 [00:37<00:46,  2.88s/it]{'epoch': 35, 'num_users': 6.2667, 'loss': 0.0329, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8791, 'compress@10': 1.0, 'time@10': 3.4562}:  47%|████▋     | 14/30 [00:39<00:46,  2.88s/it]{'epoch': 35, 'num_users': 6.2667, 'loss': 0.0329, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8791, 'compress@10': 1.0, 'time@10': 3.4562}:  50%|█████     | 15/30 [00:39<00:38,  2.59s/it]{'epoch': 35, 'num_users': 6.0625, 'loss': 0.0308, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.8814, 'compress@10': 1.0, 'time@10': 3.4522}:  50%|█████     | 15/30 [00:42<00:38,  2.59s/it]{'epoch': 35, 'num_users': 6.0625, 'loss': 0.0308, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.8814, 'compress@10': 1.0, 'time@10': 3.4522}:  53%|█████▎    | 16/30 [00:42<00:39,  2.84s/it]{'epoch': 35, 'num_users': 5.8235, 'loss': 0.029, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8767, 'compress@10': 1.0, 'time@10': 3.4447}:  53%|█████▎    | 16/30 [00:44<00:39,  2.84s/it]  {'epoch': 35, 'num_users': 5.8235, 'loss': 0.029, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8767, 'compress@10': 1.0, 'time@10': 3.4447}:  57%|█████▋    | 17/30 [00:44<00:32,  2.50s/it]{'epoch': 35, 'num_users': 6.0556, 'loss': 0.0288, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8792, 'compress@10': 1.0, 'time@10': 3.4389}:  57%|█████▋    | 17/30 [00:47<00:32,  2.50s/it]{'epoch': 35, 'num_users': 6.0556, 'loss': 0.0288, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8792, 'compress@10': 1.0, 'time@10': 3.4389}:  60%|██████    | 18/30 [00:47<00:33,  2.76s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 0.0275, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8815, 'compress@10': 1.0, 'time@10': 3.4411}:  60%|██████    | 18/30 [00:49<00:33,  2.76s/it]   {'epoch': 35, 'num_users': 6.0, 'loss': 0.0275, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8815, 'compress@10': 1.0, 'time@10': 3.4411}:  63%|██████▎   | 19/30 [00:49<00:27,  2.47s/it]{'epoch': 35, 'num_users': 6.15, 'loss': 0.0275, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8827, 'compress@10': 1.0, 'time@10': 3.4452}:  63%|██████▎   | 19/30 [00:53<00:27,  2.47s/it]{'epoch': 35, 'num_users': 6.15, 'loss': 0.0275, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8827, 'compress@10': 1.0, 'time@10': 3.4452}:  67%|██████▋   | 20/30 [00:53<00:27,  2.80s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0347, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 3.3145}:  67%|██████▋   | 20/30 [00:53<00:27,  2.80s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0347, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 3.3145}:  70%|███████   | 21/30 [00:53<00:18,  2.07s/it]{'epoch': 35, 'num_users': 6.1818, 'loss': 0.0333, 'hit_ratio@10': 0.8401, 'ndcg@10': 0.8747, 'compress@10': 1.0, 'time@10': 3.3154}:  70%|███████   | 21/30 [00:56<00:18,  2.07s/it]{'epoch': 35, 'num_users': 6.1818, 'loss': 0.0333, 'hit_ratio@10': 0.8401, 'ndcg@10': 0.8747, 'compress@10': 1.0, 'time@10': 3.3154}:  73%|███████▎  | 22/30 [00:56<00:19,  2.46s/it]{'epoch': 35, 'num_users': 6.1304, 'loss': 0.0325, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.877, 'compress@10': 1.0, 'time@10': 3.3111}:  73%|███████▎  | 22/30 [00:58<00:19,  2.46s/it] {'epoch': 35, 'num_users': 6.1304, 'loss': 0.0325, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.877, 'compress@10': 1.0, 'time@10': 3.3111}:  77%|███████▋  | 23/30 [00:58<00:15,  2.22s/it]{'epoch': 35, 'num_users': 5.9583, 'loss': 0.0311, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.8738, 'compress@10': 1.0, 'time@10': 3.3165}:  77%|███████▋  | 23/30 [01:01<00:15,  2.22s/it]{'epoch': 35, 'num_users': 5.9583, 'loss': 0.0311, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.8738, 'compress@10': 1.0, 'time@10': 3.3165}:  80%|████████  | 24/30 [01:01<00:15,  2.60s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 3.3047}:  80%|████████  | 24/30 [01:03<00:15,  2.60s/it]    {'epoch': 35, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 3.3047}:  83%|████████▎ | 25/30 [01:03<00:11,  2.28s/it]{'epoch': 35, 'num_users': 5.8077, 'loss': 0.0332, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8587, 'compress@10': 1.0, 'time@10': 3.202}:  83%|████████▎ | 25/30 [01:04<00:11,  2.28s/it]{'epoch': 35, 'num_users': 5.8077, 'loss': 0.0332, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8587, 'compress@10': 1.0, 'time@10': 3.202}:  87%|████████▋ | 26/30 [01:04<00:07,  1.80s/it]{'epoch': 35, 'num_users': 5.8889, 'loss': 0.0328, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 3.1964}:  87%|████████▋ | 26/30 [01:05<00:07,  1.80s/it]{'epoch': 35, 'num_users': 5.8889, 'loss': 0.0328, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 3.1964}:  90%|█████████ | 27/30 [01:05<00:05,  1.73s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 0.0324, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 3.1918}:  90%|█████████ | 27/30 [01:08<00:05,  1.73s/it]   {'epoch': 35, 'num_users': 6.0, 'loss': 0.0324, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 3.1918}:  93%|█████████▎| 28/30 [01:08<00:04,  2.15s/it]{'epoch': 35, 'num_users': 5.8621, 'loss': 0.0318, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8656, 'compress@10': 1.0, 'time@10': 3.2092}:  93%|█████████▎| 28/30 [01:10<00:04,  2.15s/it]{'epoch': 35, 'num_users': 5.8621, 'loss': 0.0318, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8656, 'compress@10': 1.0, 'time@10': 3.2092}:  97%|█████████▋| 29/30 [01:10<00:02,  2.07s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0322, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8691, 'compress@10': 1.0, 'time@10': 3.222}:  97%|█████████▋| 29/30 [01:14<00:02,  2.07s/it]  {'epoch': 35, 'num_users': 5.8667, 'loss': 0.0322, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8691, 'compress@10': 1.0, 'time@10': 3.222}: 100%|██████████| 30/30 [01:14<00:00,  2.54s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0322, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8691, 'compress@10': 1.0, 'time@10': 3.222}: 100%|██████████| 30/30 [01:14<00:00,  2.48s/it]
Epoch: 35
Avg # of users: 5.866666666666666
Avg Loss: 0.03220899757290535
Avg hit ratio: 0.845952469135303
Avg ndcg: 0.8690570243692549
Avg compression ratio: 0.9999999860166272
Avg train time: 3.222021460533142
Std train time: 0.8716351732295525
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 35, 14, 8, 9, 8, 11, 4, 9, 7, 37, 9, 78, 6, 36, 51, 14, 16, 7, 9, 19, 11, 99, 98, 9, 8, 8, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 3.3096}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 3.3096}:   3%|▎         | 1/30 [00:01<00:49,  1.69s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9925, 'compress@10': 1.0, 'time@10': 3.4342}:   3%|▎         | 1/30 [00:05<00:49,  1.69s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9925, 'compress@10': 1.0, 'time@10': 3.4342}:   7%|▋         | 2/30 [00:05<01:18,  2.81s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.846, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 3.4839}:   7%|▋         | 2/30 [00:07<01:18,  2.81s/it]  {'epoch': 36, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.846, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 3.4839}:  10%|█         | 3/30 [00:07<01:03,  2.36s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9498, 'compress@10': 1.0, 'time@10': 3.452}:  10%|█         | 3/30 [00:10<01:03,  2.36s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9498, 'compress@10': 1.0, 'time@10': 3.452}:  13%|█▎        | 4/30 [00:10<01:12,  2.77s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0292, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9266, 'compress@10': 1.0, 'time@10': 4.2365}:  13%|█▎        | 4/30 [00:14<01:12,  2.77s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0292, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9266, 'compress@10': 1.0, 'time@10': 4.2365}:  17%|█▋        | 5/30 [00:14<01:17,  3.11s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0273, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9258, 'compress@10': 1.0, 'time@10': 4.1376}:  17%|█▋        | 5/30 [00:17<01:17,  3.11s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0273, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9258, 'compress@10': 1.0, 'time@10': 4.1376}:  20%|██        | 6/30 [00:17<01:19,  3.31s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0274, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 4.0466}:  20%|██        | 6/30 [00:19<01:19,  3.31s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0274, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 4.0466}:  23%|██▎       | 7/30 [00:19<01:04,  2.81s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0254, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9247, 'compress@10': 1.0, 'time@10': 3.9712}:  23%|██▎       | 7/30 [00:23<01:04,  2.81s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0254, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9247, 'compress@10': 1.0, 'time@10': 3.9712}:  27%|██▋       | 8/30 [00:23<01:06,  3.03s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0256, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9245, 'compress@10': 1.0, 'time@10': 3.8017}:  27%|██▋       | 8/30 [00:24<01:06,  3.03s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0256, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9245, 'compress@10': 1.0, 'time@10': 3.8017}:  30%|███       | 9/30 [00:24<00:51,  2.48s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9262, 'compress@10': 1.0, 'time@10': 3.7633}:  30%|███       | 9/30 [00:27<00:51,  2.48s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9262, 'compress@10': 1.0, 'time@10': 3.7633}:  33%|███▎      | 10/30 [00:27<00:55,  2.78s/it]{'epoch': 36, 'num_users': 6.6364, 'loss': 0.0266, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9228, 'compress@10': 1.0, 'time@10': 3.7061}:  33%|███▎      | 10/30 [00:29<00:55,  2.78s/it]{'epoch': 36, 'num_users': 6.6364, 'loss': 0.0266, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9228, 'compress@10': 1.0, 'time@10': 3.7061}:  37%|███▋      | 11/30 [00:29<00:45,  2.42s/it]{'epoch': 36, 'num_users': 6.4167, 'loss': 0.0246, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 3.6934}:  37%|███▋      | 11/30 [00:33<00:45,  2.42s/it] {'epoch': 36, 'num_users': 6.4167, 'loss': 0.0246, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 3.6934}:  40%|████      | 12/30 [00:33<00:49,  2.77s/it]{'epoch': 36, 'num_users': 6.6154, 'loss': 0.025, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9199, 'compress@10': 1.0, 'time@10': 3.6644}:  40%|████      | 12/30 [00:34<00:49,  2.77s/it]{'epoch': 36, 'num_users': 6.6154, 'loss': 0.025, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9199, 'compress@10': 1.0, 'time@10': 3.6644}:  43%|████▎     | 13/30 [00:34<00:41,  2.45s/it]{'epoch': 36, 'num_users': 6.3571, 'loss': 0.0232, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9137, 'compress@10': 1.0, 'time@10': 3.6477}:  43%|████▎     | 13/30 [00:38<00:41,  2.45s/it]{'epoch': 36, 'num_users': 6.3571, 'loss': 0.0232, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9137, 'compress@10': 1.0, 'time@10': 3.6477}:  47%|████▋     | 14/30 [00:38<00:44,  2.76s/it]{'epoch': 36, 'num_users': 6.2667, 'loss': 0.024, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.9112, 'compress@10': 1.0, 'time@10': 3.6194}:  47%|████▋     | 14/30 [00:39<00:44,  2.76s/it] {'epoch': 36, 'num_users': 6.2667, 'loss': 0.024, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.9112, 'compress@10': 1.0, 'time@10': 3.6194}:  50%|█████     | 15/30 [00:39<00:36,  2.42s/it]{'epoch': 36, 'num_users': 6.0625, 'loss': 0.0225, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9116, 'compress@10': 1.0, 'time@10': 3.6036}:  50%|█████     | 15/30 [00:43<00:36,  2.42s/it]{'epoch': 36, 'num_users': 6.0625, 'loss': 0.0225, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9116, 'compress@10': 1.0, 'time@10': 3.6036}:  53%|█████▎    | 16/30 [00:43<00:38,  2.72s/it]{'epoch': 36, 'num_users': 5.8235, 'loss': 0.0212, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 3.601}:  53%|█████▎    | 16/30 [00:45<00:38,  2.72s/it] {'epoch': 36, 'num_users': 5.8235, 'loss': 0.0212, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 3.601}:  57%|█████▋    | 17/30 [00:45<00:31,  2.45s/it]{'epoch': 36, 'num_users': 6.0556, 'loss': 0.021, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.9066, 'compress@10': 1.0, 'time@10': 3.5974}:  57%|█████▋    | 17/30 [00:48<00:31,  2.45s/it]{'epoch': 36, 'num_users': 6.0556, 'loss': 0.021, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.9066, 'compress@10': 1.0, 'time@10': 3.5974}:  60%|██████    | 18/30 [00:48<00:33,  2.78s/it]{'epoch': 36, 'num_users': 6.0, 'loss': 0.0202, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.9076, 'compress@10': 1.0, 'time@10': 3.6101}:  60%|██████    | 18/30 [00:50<00:33,  2.78s/it]  {'epoch': 36, 'num_users': 6.0, 'loss': 0.0202, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.9076, 'compress@10': 1.0, 'time@10': 3.6101}:  63%|██████▎   | 19/30 [00:50<00:27,  2.54s/it]{'epoch': 36, 'num_users': 6.15, 'loss': 0.0205, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.9078, 'compress@10': 1.0, 'time@10': 3.6085}:  63%|██████▎   | 19/30 [00:54<00:27,  2.54s/it]{'epoch': 36, 'num_users': 6.15, 'loss': 0.0205, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.9078, 'compress@10': 1.0, 'time@10': 3.6085}:  67%|██████▋   | 20/30 [00:54<00:28,  2.86s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 3.758}:  67%|██████▋   | 20/30 [00:57<00:28,  2.86s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 3.758}:  70%|███████   | 21/30 [00:57<00:27,  3.03s/it]{'epoch': 36, 'num_users': 6.1818, 'loss': 0.0213, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.9071, 'compress@10': 1.0, 'time@10': 3.7393}:  70%|███████   | 21/30 [01:01<00:27,  3.03s/it]{'epoch': 36, 'num_users': 6.1818, 'loss': 0.0213, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.9071, 'compress@10': 1.0, 'time@10': 3.7393}:  73%|███████▎  | 22/30 [01:01<00:25,  3.13s/it]{'epoch': 36, 'num_users': 6.1304, 'loss': 0.0211, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9076, 'compress@10': 1.0, 'time@10': 3.7199}:  73%|███████▎  | 22/30 [01:02<00:25,  3.13s/it]{'epoch': 36, 'num_users': 6.1304, 'loss': 0.0211, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9076, 'compress@10': 1.0, 'time@10': 3.7199}:  77%|███████▋  | 23/30 [01:02<00:18,  2.70s/it]{'epoch': 36, 'num_users': 5.9583, 'loss': 0.0203, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 3.6898}:  77%|███████▋  | 23/30 [01:05<00:18,  2.70s/it]{'epoch': 36, 'num_users': 5.9583, 'loss': 0.0203, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 3.6898}:  80%|████████  | 24/30 [01:05<00:16,  2.80s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0195, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 3.6747}:  80%|████████  | 24/30 [01:07<00:16,  2.80s/it]   {'epoch': 36, 'num_users': 5.8, 'loss': 0.0195, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 3.6747}:  83%|████████▎ | 25/30 [01:07<00:12,  2.47s/it]{'epoch': 36, 'num_users': 5.8077, 'loss': 0.0195, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.7853}:  83%|████████▎ | 25/30 [01:14<00:12,  2.47s/it]{'epoch': 36, 'num_users': 5.8077, 'loss': 0.0195, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.7853}:  87%|████████▋ | 26/30 [01:14<00:14,  3.70s/it]{'epoch': 36, 'num_users': 5.8889, 'loss': 0.0196, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.7945}:  87%|████████▋ | 26/30 [01:16<00:14,  3.70s/it]{'epoch': 36, 'num_users': 5.8889, 'loss': 0.0196, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.7945}:  90%|█████████ | 27/30 [01:16<00:09,  3.21s/it]{'epoch': 36, 'num_users': 6.0, 'loss': 0.0196, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 3.7802}:  90%|█████████ | 27/30 [01:19<00:09,  3.21s/it]   {'epoch': 36, 'num_users': 6.0, 'loss': 0.0196, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 3.7802}:  93%|█████████▎| 28/30 [01:19<00:06,  3.28s/it]{'epoch': 36, 'num_users': 5.8621, 'loss': 0.0196, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8978, 'compress@10': 1.0, 'time@10': 3.7633}:  93%|█████████▎| 28/30 [01:21<00:06,  3.28s/it]{'epoch': 36, 'num_users': 5.8621, 'loss': 0.0196, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8978, 'compress@10': 1.0, 'time@10': 3.7633}:  97%|█████████▋| 29/30 [01:21<00:02,  2.80s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0197, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.899, 'compress@10': 1.0, 'time@10': 3.7516}:  97%|█████████▋| 29/30 [01:24<00:02,  2.80s/it] {'epoch': 36, 'num_users': 5.8667, 'loss': 0.0197, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.899, 'compress@10': 1.0, 'time@10': 3.7516}: 100%|██████████| 30/30 [01:24<00:00,  2.99s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0197, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.899, 'compress@10': 1.0, 'time@10': 3.7516}: 100%|██████████| 30/30 [01:24<00:00,  2.82s/it]
Epoch: 36
Avg # of users: 5.866666666666666
Avg Loss: 0.019681727406290293
Avg hit ratio: 0.8630625719403029
Avg ndcg: 0.8990124889149391
Avg compression ratio: 0.9999999860153537
Avg train time: 3.7515774250030516
Std train time: 1.08444712762907
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 35, 14, 1, 8, 8, 11, 7, 9, 8, 37, 9, 78, 7, 36, 51, 14, 15, 7, 1, 19, 11, 100, 98, 1, 6, 8, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 3.5634}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 3.5634}:   3%|▎         | 1/30 [00:01<00:52,  1.82s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.9362, 'compress@10': 1.0, 'time@10': 3.6292}:   3%|▎         | 1/30 [00:05<00:52,  1.82s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.9362, 'compress@10': 1.0, 'time@10': 3.6292}:   7%|▋         | 2/30 [00:05<01:22,  2.95s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.9098, 'compress@10': 1.0, 'time@10': 3.6746}:   7%|▋         | 2/30 [00:07<01:22,  2.95s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.9098, 'compress@10': 1.0, 'time@10': 3.6746}:  10%|█         | 3/30 [00:07<01:06,  2.48s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.923, 'compress@10': 1.0, 'time@10': 3.5739}:  10%|█         | 3/30 [00:11<01:06,  2.48s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.923, 'compress@10': 1.0, 'time@10': 3.5739}:  13%|█▎        | 4/30 [00:11<01:16,  2.92s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0499, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8594, 'compress@10': 1.0, 'time@10': 3.0434}:  13%|█▎        | 4/30 [00:11<01:16,  2.92s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0499, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8594, 'compress@10': 1.0, 'time@10': 3.0434}:  17%|█▋        | 5/30 [00:11<00:51,  2.05s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0454, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8693, 'compress@10': 1.0, 'time@10': 3.0683}:  17%|█▋        | 5/30 [00:14<00:51,  2.05s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0454, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8693, 'compress@10': 1.0, 'time@10': 3.0683}:  20%|██        | 6/30 [00:14<00:58,  2.45s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0429, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.1209}:  20%|██        | 6/30 [00:16<00:58,  2.45s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0429, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.1209}:  23%|██▎       | 7/30 [00:16<00:51,  2.23s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0413, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 3.1333}:  23%|██▎       | 7/30 [00:19<00:51,  2.23s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0413, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 3.1333}:  27%|██▋       | 8/30 [00:19<00:56,  2.56s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0402, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8942, 'compress@10': 1.0, 'time@10': 3.2602}:  27%|██▋       | 8/30 [00:22<00:56,  2.56s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0402, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8942, 'compress@10': 1.0, 'time@10': 3.2602}:  30%|███       | 9/30 [00:22<00:51,  2.44s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0378, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9009, 'compress@10': 1.0, 'time@10': 3.2795}:  30%|███       | 9/30 [00:25<00:51,  2.44s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0378, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9009, 'compress@10': 1.0, 'time@10': 3.2795}:  33%|███▎      | 10/30 [00:25<00:55,  2.77s/it]{'epoch': 37, 'num_users': 6.6364, 'loss': 0.038, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8997, 'compress@10': 1.0, 'time@10': 3.3264}:  33%|███▎      | 10/30 [00:27<00:55,  2.77s/it]{'epoch': 37, 'num_users': 6.6364, 'loss': 0.038, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8997, 'compress@10': 1.0, 'time@10': 3.3264}:  37%|███▋      | 11/30 [00:27<00:47,  2.51s/it]{'epoch': 37, 'num_users': 6.4167, 'loss': 0.0349, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.9011, 'compress@10': 1.0, 'time@10': 3.3472}:  37%|███▋      | 11/30 [00:31<00:47,  2.51s/it]{'epoch': 37, 'num_users': 6.4167, 'loss': 0.0349, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.9011, 'compress@10': 1.0, 'time@10': 3.3472}:  40%|████      | 12/30 [00:31<00:51,  2.85s/it]{'epoch': 37, 'num_users': 6.6154, 'loss': 0.0351, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8997, 'compress@10': 1.0, 'time@10': 3.3469}:  40%|████      | 12/30 [00:32<00:51,  2.85s/it]{'epoch': 37, 'num_users': 6.6154, 'loss': 0.0351, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8997, 'compress@10': 1.0, 'time@10': 3.3469}:  43%|████▎     | 13/30 [00:32<00:42,  2.51s/it]{'epoch': 37, 'num_users': 6.3571, 'loss': 0.0326, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.3465}:  43%|████▎     | 13/30 [00:36<00:42,  2.51s/it]{'epoch': 37, 'num_users': 6.3571, 'loss': 0.0326, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.3465}:  47%|████▋     | 14/30 [00:36<00:44,  2.77s/it]{'epoch': 37, 'num_users': 6.2667, 'loss': 0.0328, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 3.3691}:  47%|████▋     | 14/30 [00:38<00:44,  2.77s/it] {'epoch': 37, 'num_users': 6.2667, 'loss': 0.0328, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 3.3691}:  50%|█████     | 15/30 [00:38<00:37,  2.51s/it]{'epoch': 37, 'num_users': 6.0625, 'loss': 0.0308, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.3735}:  50%|█████     | 15/30 [00:41<00:37,  2.51s/it]{'epoch': 37, 'num_users': 6.0625, 'loss': 0.0308, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.3735}:  53%|█████▎    | 16/30 [00:41<00:39,  2.80s/it]{'epoch': 37, 'num_users': 5.8235, 'loss': 0.029, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.8907, 'compress@10': 1.0, 'time@10': 3.3769}:  53%|█████▎    | 16/30 [00:43<00:39,  2.80s/it]{'epoch': 37, 'num_users': 5.8235, 'loss': 0.029, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.8907, 'compress@10': 1.0, 'time@10': 3.3769}:  57%|█████▋    | 17/30 [00:43<00:32,  2.48s/it]{'epoch': 37, 'num_users': 6.0556, 'loss': 0.0283, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 3.3774}:  57%|█████▋    | 17/30 [00:46<00:32,  2.48s/it]{'epoch': 37, 'num_users': 6.0556, 'loss': 0.0283, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 3.3774}:  60%|██████    | 18/30 [00:46<00:33,  2.77s/it]{'epoch': 37, 'num_users': 6.0, 'loss': 0.0271, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 3.3638}:  60%|██████    | 18/30 [00:48<00:33,  2.77s/it]   {'epoch': 37, 'num_users': 6.0, 'loss': 0.0271, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 3.3638}:  63%|██████▎   | 19/30 [00:48<00:26,  2.41s/it]{'epoch': 37, 'num_users': 6.15, 'loss': 0.027, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 3.3727}:  63%|██████▎   | 19/30 [00:51<00:26,  2.41s/it]{'epoch': 37, 'num_users': 6.15, 'loss': 0.027, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 3.3727}:  67%|██████▋   | 20/30 [00:51<00:27,  2.76s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0341, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8839, 'compress@10': 1.0, 'time@10': 3.2464}:  67%|██████▋   | 20/30 [00:52<00:27,  2.76s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0341, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8839, 'compress@10': 1.0, 'time@10': 3.2464}:  70%|███████   | 21/30 [00:52<00:18,  2.05s/it]{'epoch': 37, 'num_users': 6.1818, 'loss': 0.0328, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8864, 'compress@10': 1.0, 'time@10': 3.2545}:  70%|███████   | 21/30 [00:55<00:18,  2.05s/it]{'epoch': 37, 'num_users': 6.1818, 'loss': 0.0328, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8864, 'compress@10': 1.0, 'time@10': 3.2545}:  73%|███████▎  | 22/30 [00:55<00:19,  2.48s/it]{'epoch': 37, 'num_users': 6.1304, 'loss': 0.032, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 3.2702}:  73%|███████▎  | 22/30 [00:57<00:19,  2.48s/it] {'epoch': 37, 'num_users': 6.1304, 'loss': 0.032, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 3.2702}:  77%|███████▋  | 23/30 [00:57<00:16,  2.29s/it]{'epoch': 37, 'num_users': 5.9583, 'loss': 0.0307, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8841, 'compress@10': 1.0, 'time@10': 3.2785}:  77%|███████▋  | 23/30 [01:01<00:16,  2.29s/it]{'epoch': 37, 'num_users': 5.9583, 'loss': 0.0307, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8841, 'compress@10': 1.0, 'time@10': 3.2785}:  80%|████████  | 24/30 [01:01<00:15,  2.66s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8754, 'compress@10': 1.0, 'time@10': 3.2889}:  80%|████████  | 24/30 [01:02<00:15,  2.66s/it]   {'epoch': 37, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8754, 'compress@10': 1.0, 'time@10': 3.2889}:  83%|████████▎ | 25/30 [01:02<00:12,  2.40s/it]{'epoch': 37, 'num_users': 5.8077, 'loss': 0.0327, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8682, 'compress@10': 1.0, 'time@10': 3.1886}:  83%|████████▎ | 25/30 [01:03<00:12,  2.40s/it]{'epoch': 37, 'num_users': 5.8077, 'loss': 0.0327, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8682, 'compress@10': 1.0, 'time@10': 3.1886}:  87%|████████▋ | 26/30 [01:03<00:07,  1.90s/it]{'epoch': 37, 'num_users': 5.8889, 'loss': 0.0322, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8696, 'compress@10': 1.0, 'time@10': 3.1787}:  87%|████████▋ | 26/30 [01:05<00:07,  1.90s/it] {'epoch': 37, 'num_users': 5.8889, 'loss': 0.0322, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8696, 'compress@10': 1.0, 'time@10': 3.1787}:  90%|█████████ | 27/30 [01:05<00:05,  1.78s/it]{'epoch': 37, 'num_users': 6.0, 'loss': 0.0318, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 3.1954}:  90%|█████████ | 27/30 [01:08<00:05,  1.78s/it]   {'epoch': 37, 'num_users': 6.0, 'loss': 0.0318, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 3.1954}:  93%|█████████▎| 28/30 [01:08<00:04,  2.35s/it]{'epoch': 37, 'num_users': 5.8621, 'loss': 0.031, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 3.1959}:  93%|█████████▎| 28/30 [01:10<00:04,  2.35s/it]{'epoch': 37, 'num_users': 5.8621, 'loss': 0.031, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 3.1959}:  97%|█████████▋| 29/30 [01:10<00:02,  2.14s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0303, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.2057}:  97%|█████████▋| 29/30 [01:14<00:02,  2.14s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0303, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.2057}: 100%|██████████| 30/30 [01:14<00:00,  2.56s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0303, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.2057}: 100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch: 37
Avg # of users: 5.866666666666666
Avg Loss: 0.030321213731940393
Avg hit ratio: 0.8362803739434945
Avg ndcg: 0.8771419721894638
Avg compression ratio: 0.9999999860166272
Avg train time: 3.2056959867477417
Std train time: 0.8459361919987848
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 34, 14, 8, 9, 8, 12, 5, 9, 7, 37, 9, 78, 6, 36, 51, 14, 16, 7, 9, 19, 10, 100, 98, 9, 8, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 3.4187}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 3.4187}:   3%|▎         | 1/30 [00:01<00:50,  1.75s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 3.286}:   3%|▎         | 1/30 [00:04<00:50,  1.75s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 3.286}:   7%|▋         | 2/30 [00:04<01:12,  2.60s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8894, 'compress@10': 1.0, 'time@10': 3.3554}:   7%|▋         | 2/30 [00:06<01:12,  2.60s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8894, 'compress@10': 1.0, 'time@10': 3.3554}:  10%|█         | 3/30 [00:06<01:00,  2.23s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9043, 'compress@10': 1.0, 'time@10': 3.3553}:  10%|█         | 3/30 [00:10<01:00,  2.23s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9043, 'compress@10': 1.0, 'time@10': 3.3553}:  13%|█▎        | 4/30 [00:10<01:10,  2.70s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.8896, 'compress@10': 1.0, 'time@10': 4.0755}:  13%|█▎        | 4/30 [00:13<01:10,  2.70s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.8896, 'compress@10': 1.0, 'time@10': 4.0755}:  17%|█▋        | 5/30 [00:13<01:14,  2.99s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.9437}:  17%|█▋        | 5/30 [00:16<01:14,  2.99s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.9437}:  20%|██        | 6/30 [00:16<01:14,  3.10s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0244, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.8947, 'compress@10': 1.0, 'time@10': 3.8771}:  20%|██        | 6/30 [00:18<01:14,  3.10s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0244, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.8947, 'compress@10': 1.0, 'time@10': 3.8771}:  23%|██▎       | 7/30 [00:18<01:01,  2.67s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0267, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 3.8171}:  23%|██▎       | 7/30 [00:22<01:01,  2.67s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.0267, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 3.8171}:  27%|██▋       | 8/30 [00:22<01:04,  2.91s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0263, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9066, 'compress@10': 1.0, 'time@10': 3.7197}:  27%|██▋       | 8/30 [00:23<01:04,  2.91s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0263, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9066, 'compress@10': 1.0, 'time@10': 3.7197}:  30%|███       | 9/30 [00:23<00:51,  2.47s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9114, 'compress@10': 1.0, 'time@10': 3.6943}:  30%|███       | 9/30 [00:27<00:51,  2.47s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9114, 'compress@10': 1.0, 'time@10': 3.6943}:  33%|███▎      | 10/30 [00:27<00:55,  2.79s/it]{'epoch': 38, 'num_users': 6.6364, 'loss': 0.0268, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 3.6579}:  33%|███▎      | 10/30 [00:28<00:55,  2.79s/it]{'epoch': 38, 'num_users': 6.6364, 'loss': 0.0268, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 3.6579}:  37%|███▋      | 11/30 [00:28<00:46,  2.45s/it]{'epoch': 38, 'num_users': 6.4167, 'loss': 0.0247, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9103, 'compress@10': 1.0, 'time@10': 3.6521}:  37%|███▋      | 11/30 [00:32<00:46,  2.45s/it] {'epoch': 38, 'num_users': 6.4167, 'loss': 0.0247, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9103, 'compress@10': 1.0, 'time@10': 3.6521}:  40%|████      | 12/30 [00:32<00:50,  2.82s/it]{'epoch': 38, 'num_users': 6.6154, 'loss': 0.0249, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9092, 'compress@10': 1.0, 'time@10': 3.6324}:  40%|████      | 12/30 [00:34<00:50,  2.82s/it]{'epoch': 38, 'num_users': 6.6154, 'loss': 0.0249, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9092, 'compress@10': 1.0, 'time@10': 3.6324}:  43%|████▎     | 13/30 [00:34<00:42,  2.49s/it]{'epoch': 38, 'num_users': 6.3571, 'loss': 0.0231, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9038, 'compress@10': 1.0, 'time@10': 3.6131}:  43%|████▎     | 13/30 [00:37<00:42,  2.49s/it]{'epoch': 38, 'num_users': 6.3571, 'loss': 0.0231, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9038, 'compress@10': 1.0, 'time@10': 3.6131}:  47%|████▋     | 14/30 [00:37<00:44,  2.76s/it]{'epoch': 38, 'num_users': 6.2667, 'loss': 0.0238, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.9021, 'compress@10': 1.0, 'time@10': 3.5865}:  47%|████▋     | 14/30 [00:39<00:44,  2.76s/it]{'epoch': 38, 'num_users': 6.2667, 'loss': 0.0238, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.9021, 'compress@10': 1.0, 'time@10': 3.5865}:  50%|█████     | 15/30 [00:39<00:36,  2.43s/it]{'epoch': 38, 'num_users': 6.0625, 'loss': 0.0223, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 3.5799}:  50%|█████     | 15/30 [00:42<00:36,  2.43s/it] {'epoch': 38, 'num_users': 6.0625, 'loss': 0.0223, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 3.5799}:  53%|█████▎    | 16/30 [00:42<00:38,  2.76s/it]{'epoch': 38, 'num_users': 5.8235, 'loss': 0.021, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 3.5605}:  53%|█████▎    | 16/30 [00:44<00:38,  2.76s/it]{'epoch': 38, 'num_users': 5.8235, 'loss': 0.021, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 3.5605}:  57%|█████▋    | 17/30 [00:44<00:31,  2.43s/it]{'epoch': 38, 'num_users': 6.0556, 'loss': 0.0212, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 3.5494}:  57%|█████▋    | 17/30 [00:47<00:31,  2.43s/it]{'epoch': 38, 'num_users': 6.0556, 'loss': 0.0212, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 3.5494}:  60%|██████    | 18/30 [00:47<00:32,  2.72s/it]{'epoch': 38, 'num_users': 6.0, 'loss': 0.0204, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.9008, 'compress@10': 1.0, 'time@10': 3.5544}:  60%|██████    | 18/30 [00:49<00:32,  2.72s/it]   {'epoch': 38, 'num_users': 6.0, 'loss': 0.0204, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.9008, 'compress@10': 1.0, 'time@10': 3.5544}:  63%|██████▎   | 19/30 [00:49<00:27,  2.46s/it]{'epoch': 38, 'num_users': 6.15, 'loss': 0.0205, 'hit_ratio@10': 0.845, 'ndcg@10': 0.9018, 'compress@10': 1.0, 'time@10': 3.5553}:  63%|██████▎   | 19/30 [00:53<00:27,  2.46s/it]{'epoch': 38, 'num_users': 6.15, 'loss': 0.0205, 'hit_ratio@10': 0.845, 'ndcg@10': 0.9018, 'compress@10': 1.0, 'time@10': 3.5553}:  67%|██████▋   | 20/30 [00:53<00:28,  2.81s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0218, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.6938}:  67%|██████▋   | 20/30 [00:56<00:28,  2.81s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0218, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.6938}:  70%|███████   | 21/30 [00:56<00:26,  2.95s/it]{'epoch': 38, 'num_users': 6.1818, 'loss': 0.0211, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.6831}:  70%|███████   | 21/30 [01:00<00:26,  2.95s/it]{'epoch': 38, 'num_users': 6.1818, 'loss': 0.0211, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.6831}:  73%|███████▎  | 22/30 [01:00<00:24,  3.11s/it]{'epoch': 38, 'num_users': 6.1304, 'loss': 0.0207, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 3.6662}:  73%|███████▎  | 22/30 [01:01<00:24,  3.11s/it]{'epoch': 38, 'num_users': 6.1304, 'loss': 0.0207, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 3.6662}:  77%|███████▋  | 23/30 [01:01<00:18,  2.68s/it]{'epoch': 38, 'num_users': 5.9583, 'loss': 0.0198, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8989, 'compress@10': 1.0, 'time@10': 3.6555}:  77%|███████▋  | 23/30 [01:05<00:18,  2.68s/it]{'epoch': 38, 'num_users': 5.9583, 'loss': 0.0198, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8989, 'compress@10': 1.0, 'time@10': 3.6555}:  80%|████████  | 24/30 [01:05<00:17,  2.91s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8896, 'compress@10': 1.0, 'time@10': 3.6441}:  80%|████████  | 24/30 [01:07<00:17,  2.91s/it]    {'epoch': 38, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8896, 'compress@10': 1.0, 'time@10': 3.6441}:  83%|████████▎ | 25/30 [01:07<00:12,  2.55s/it]{'epoch': 38, 'num_users': 5.8077, 'loss': 0.019, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8917, 'compress@10': 1.0, 'time@10': 3.7538}:  83%|████████▎ | 25/30 [01:13<00:12,  2.55s/it]{'epoch': 38, 'num_users': 5.8077, 'loss': 0.019, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8917, 'compress@10': 1.0, 'time@10': 3.7538}:  87%|████████▋ | 26/30 [01:13<00:14,  3.75s/it]{'epoch': 38, 'num_users': 5.8889, 'loss': 0.019, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8923, 'compress@10': 1.0, 'time@10': 3.7594}:  87%|████████▋ | 26/30 [01:15<00:14,  3.75s/it]{'epoch': 38, 'num_users': 5.8889, 'loss': 0.019, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8923, 'compress@10': 1.0, 'time@10': 3.7594}:  90%|█████████ | 27/30 [01:15<00:09,  3.22s/it]{'epoch': 38, 'num_users': 6.0, 'loss': 0.019, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 3.7361}:  90%|█████████ | 27/30 [01:18<00:09,  3.22s/it]   {'epoch': 38, 'num_users': 6.0, 'loss': 0.019, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 3.7361}:  93%|█████████▎| 28/30 [01:18<00:06,  3.20s/it]{'epoch': 38, 'num_users': 5.8621, 'loss': 0.0191, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.7311}:  93%|█████████▎| 28/30 [01:20<00:06,  3.20s/it]{'epoch': 38, 'num_users': 5.8621, 'loss': 0.0191, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.7311}:  97%|█████████▋| 29/30 [01:20<00:02,  2.79s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0201, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 3.7222}:  97%|█████████▋| 29/30 [01:24<00:02,  2.79s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0201, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 3.7222}: 100%|██████████| 30/30 [01:24<00:00,  3.00s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0201, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 3.7222}: 100%|██████████| 30/30 [01:24<00:00,  2.80s/it]
Epoch: 38
Avg # of users: 5.866666666666666
Avg Loss: 0.02010217778720728
Avg hit ratio: 0.8587677456293475
Avg ndcg: 0.8988466992426842
Avg compression ratio: 0.9999999860153537
Avg train time: 3.7222171068191527
Std train time: 0.9905264308220425
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 34, 14, 1, 9, 8, 12, 6, 9, 7, 37, 9, 78, 7, 36, 52, 14, 15, 7, 1, 19, 10, 100, 98, 1, 7, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 3.4743}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 3.4743}:   3%|▎         | 1/30 [00:01<00:51,  1.78s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 3.5608}:   3%|▎         | 1/30 [00:05<00:51,  1.78s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 3.5608}:   7%|▋         | 2/30 [00:05<01:21,  2.90s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 3.5431}:   7%|▋         | 2/30 [00:07<01:21,  2.90s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 3.5431}:  10%|█         | 3/30 [00:07<01:07,  2.49s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9275, 'compress@10': 1.0, 'time@10': 3.4865}:  10%|█         | 3/30 [00:10<01:07,  2.49s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9275, 'compress@10': 1.0, 'time@10': 3.4865}:  13%|█▎        | 4/30 [00:10<01:13,  2.83s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0512, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 2.9892}:  13%|█▎        | 4/30 [00:11<01:13,  2.83s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0512, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 2.9892}:  17%|█▋        | 5/30 [00:11<00:50,  2.00s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0462, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8714, 'compress@10': 1.0, 'time@10': 3.07}:  17%|█▋        | 5/30 [00:14<00:50,  2.00s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0462, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8714, 'compress@10': 1.0, 'time@10': 3.07}:  20%|██        | 6/30 [00:14<01:00,  2.52s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0433, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8755, 'compress@10': 1.0, 'time@10': 3.1366}:  20%|██        | 6/30 [00:16<01:00,  2.52s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0433, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8755, 'compress@10': 1.0, 'time@10': 3.1366}:  23%|██▎       | 7/30 [00:16<00:52,  2.29s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.04, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8843, 'compress@10': 1.0, 'time@10': 3.1726}:  23%|██▎       | 7/30 [00:20<00:52,  2.29s/it]   {'epoch': 39, 'num_users': 6.125, 'loss': 0.04, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8843, 'compress@10': 1.0, 'time@10': 3.1726}:  27%|██▋       | 8/30 [00:20<00:58,  2.67s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0381, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8886, 'compress@10': 1.0, 'time@10': 3.227}:  27%|██▋       | 8/30 [00:22<00:58,  2.67s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0381, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8886, 'compress@10': 1.0, 'time@10': 3.227}:  30%|███       | 9/30 [00:22<00:50,  2.42s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.036, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.896, 'compress@10': 1.0, 'time@10': 3.2541}:  30%|███       | 9/30 [00:25<00:50,  2.42s/it]    {'epoch': 39, 'num_users': 6.3, 'loss': 0.036, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.896, 'compress@10': 1.0, 'time@10': 3.2541}:  33%|███▎      | 10/30 [00:25<00:55,  2.76s/it]{'epoch': 39, 'num_users': 6.6364, 'loss': 0.0362, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 3.2568}:  33%|███▎      | 10/30 [00:27<00:55,  2.76s/it]{'epoch': 39, 'num_users': 6.6364, 'loss': 0.0362, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 3.2568}:  37%|███▋      | 11/30 [00:27<00:46,  2.43s/it]{'epoch': 39, 'num_users': 6.4167, 'loss': 0.0333, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 3.2506}:  37%|███▋      | 11/30 [00:30<00:46,  2.43s/it]{'epoch': 39, 'num_users': 6.4167, 'loss': 0.0333, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 3.2506}:  40%|████      | 12/30 [00:30<00:48,  2.67s/it]{'epoch': 39, 'num_users': 6.6154, 'loss': 0.0333, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.2404}:  40%|████      | 12/30 [00:32<00:48,  2.67s/it] {'epoch': 39, 'num_users': 6.6154, 'loss': 0.0333, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.2404}:  43%|████▎     | 13/30 [00:32<00:39,  2.35s/it]{'epoch': 39, 'num_users': 6.3571, 'loss': 0.0309, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.2429}:  43%|████▎     | 13/30 [00:35<00:39,  2.35s/it]{'epoch': 39, 'num_users': 6.3571, 'loss': 0.0309, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.2429}:  47%|████▋     | 14/30 [00:35<00:42,  2.64s/it]{'epoch': 39, 'num_users': 6.2667, 'loss': 0.0311, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 3.2413}:  47%|████▋     | 14/30 [00:37<00:42,  2.64s/it]{'epoch': 39, 'num_users': 6.2667, 'loss': 0.0311, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 3.2413}:  50%|█████     | 15/30 [00:37<00:35,  2.34s/it]{'epoch': 39, 'num_users': 6.0625, 'loss': 0.0292, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 3.2423}:  50%|█████     | 15/30 [00:40<00:35,  2.34s/it] {'epoch': 39, 'num_users': 6.0625, 'loss': 0.0292, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 3.2423}:  53%|█████▎    | 16/30 [00:40<00:36,  2.63s/it]{'epoch': 39, 'num_users': 5.8235, 'loss': 0.0275, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.2672}:  53%|█████▎    | 16/30 [00:42<00:36,  2.63s/it]{'epoch': 39, 'num_users': 5.8235, 'loss': 0.0275, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.2672}:  57%|█████▋    | 17/30 [00:42<00:31,  2.40s/it]{'epoch': 39, 'num_users': 6.0556, 'loss': 0.0274, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 3.2798}:  57%|█████▋    | 17/30 [00:45<00:31,  2.40s/it]{'epoch': 39, 'num_users': 6.0556, 'loss': 0.0274, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 3.2798}:  60%|██████    | 18/30 [00:45<00:32,  2.75s/it]{'epoch': 39, 'num_users': 6.0, 'loss': 0.0263, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8932, 'compress@10': 1.0, 'time@10': 3.2845}:  60%|██████    | 18/30 [00:47<00:32,  2.75s/it]    {'epoch': 39, 'num_users': 6.0, 'loss': 0.0263, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8932, 'compress@10': 1.0, 'time@10': 3.2845}:  63%|██████▎   | 19/30 [00:47<00:26,  2.44s/it]{'epoch': 39, 'num_users': 6.15, 'loss': 0.0261, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8946, 'compress@10': 1.0, 'time@10': 3.3018}:  63%|██████▎   | 19/30 [00:51<00:26,  2.44s/it]{'epoch': 39, 'num_users': 6.15, 'loss': 0.0261, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8946, 'compress@10': 1.0, 'time@10': 3.3018}:  67%|██████▋   | 20/30 [00:51<00:28,  2.81s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0331, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8827, 'compress@10': 1.0, 'time@10': 3.1789}:  67%|██████▋   | 20/30 [00:51<00:28,  2.81s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0331, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8827, 'compress@10': 1.0, 'time@10': 3.1789}:  70%|███████   | 21/30 [00:51<00:18,  2.08s/it]{'epoch': 39, 'num_users': 6.1818, 'loss': 0.0318, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 3.1914}:  70%|███████   | 21/30 [00:55<00:18,  2.08s/it]{'epoch': 39, 'num_users': 6.1818, 'loss': 0.0318, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 3.1914}:  73%|███████▎  | 22/30 [00:55<00:20,  2.51s/it]{'epoch': 39, 'num_users': 6.1304, 'loss': 0.0311, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 3.1957}:  73%|███████▎  | 22/30 [00:56<00:20,  2.51s/it]{'epoch': 39, 'num_users': 6.1304, 'loss': 0.0311, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 3.1957}:  77%|███████▋  | 23/30 [00:56<00:15,  2.26s/it]{'epoch': 39, 'num_users': 5.9583, 'loss': 0.0298, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8836, 'compress@10': 1.0, 'time@10': 3.2052}:  77%|███████▋  | 23/30 [01:00<00:15,  2.26s/it]{'epoch': 39, 'num_users': 5.9583, 'loss': 0.0298, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8836, 'compress@10': 1.0, 'time@10': 3.2052}:  80%|████████  | 24/30 [01:00<00:15,  2.62s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0286, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.2162}:  80%|████████  | 24/30 [01:01<00:15,  2.62s/it]   {'epoch': 39, 'num_users': 5.8, 'loss': 0.0286, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.2162}:  83%|████████▎ | 25/30 [01:01<00:11,  2.37s/it]{'epoch': 39, 'num_users': 5.8077, 'loss': 0.0317, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 3.1203}:  83%|████████▎ | 25/30 [01:02<00:11,  2.37s/it]{'epoch': 39, 'num_users': 5.8077, 'loss': 0.0317, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 3.1203}:  87%|████████▋ | 26/30 [01:02<00:07,  1.89s/it]{'epoch': 39, 'num_users': 5.8889, 'loss': 0.0311, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 3.1311}:  87%|████████▋ | 26/30 [01:04<00:07,  1.89s/it]  {'epoch': 39, 'num_users': 5.8889, 'loss': 0.0311, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 3.1311}:  90%|█████████ | 27/30 [01:04<00:05,  1.84s/it]{'epoch': 39, 'num_users': 6.0, 'loss': 0.0307, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8724, 'compress@10': 1.0, 'time@10': 3.1474}:  90%|█████████ | 27/30 [01:08<00:05,  1.84s/it]  {'epoch': 39, 'num_users': 6.0, 'loss': 0.0307, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8724, 'compress@10': 1.0, 'time@10': 3.1474}:  93%|█████████▎| 28/30 [01:08<00:04,  2.38s/it]{'epoch': 39, 'num_users': 5.8621, 'loss': 0.03, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8747, 'compress@10': 1.0, 'time@10': 3.1664}:  93%|█████████▎| 28/30 [01:09<00:04,  2.38s/it]{'epoch': 39, 'num_users': 5.8621, 'loss': 0.03, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8747, 'compress@10': 1.0, 'time@10': 3.1664}:  97%|█████████▋| 29/30 [01:09<00:02,  2.23s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0303, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 3.178}:  97%|█████████▋| 29/30 [01:13<00:02,  2.23s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0303, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 3.178}: 100%|██████████| 30/30 [01:13<00:00,  2.63s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0303, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 3.178}: 100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch: 39
Avg # of users: 5.866666666666666
Avg Loss: 0.03027027653746743
Avg hit ratio: 0.8446176772807977
Avg ndcg: 0.8777259619337373
Avg compression ratio: 0.9999999860166272
Avg train time: 3.1779574235280355
Std train time: 0.802629945814862
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 34, 14, 8, 9, 8, 12, 5, 9, 7, 38, 10, 78, 8, 37, 51, 14, 15, 6, 9, 19, 10, 100, 98, 9, 7, 8, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8876, 'compress@10': 1.0, 'time@10': 3.2859}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8876, 'compress@10': 1.0, 'time@10': 3.2859}:   3%|▎         | 1/30 [00:01<00:48,  1.69s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0249, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 3.2916}:   3%|▎         | 1/30 [00:05<00:48,  1.69s/it]  {'epoch': 40, 'num_users': 7.0, 'loss': 0.0249, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 3.2916}:   7%|▋         | 2/30 [00:05<01:14,  2.67s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 3.3583}:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 3.3583}:  10%|█         | 3/30 [00:06<01:01,  2.27s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.847, 'ndcg@10': 0.9069, 'compress@10': 1.0, 'time@10': 3.339}:  10%|█         | 3/30 [00:10<01:01,  2.27s/it]  {'epoch': 40, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.847, 'ndcg@10': 0.9069, 'compress@10': 1.0, 'time@10': 3.339}:  13%|█▎        | 4/30 [00:10<01:09,  2.68s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0232, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 4.0791}:  13%|█▎        | 4/30 [00:13<01:09,  2.68s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0232, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 4.0791}:  17%|█▋        | 5/30 [00:13<01:14,  3.00s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0227, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 4.0207}:  17%|█▋        | 5/30 [00:17<01:14,  3.00s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0227, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 4.0207}:  20%|██        | 6/30 [00:17<01:18,  3.26s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0232, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.898, 'compress@10': 1.0, 'time@10': 3.9364}:  20%|██        | 6/30 [00:19<01:18,  3.26s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0232, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.898, 'compress@10': 1.0, 'time@10': 3.9364}:  23%|██▎       | 7/30 [00:19<01:03,  2.77s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0222, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9046, 'compress@10': 1.0, 'time@10': 3.8961}:  23%|██▎       | 7/30 [00:22<01:03,  2.77s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0222, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9046, 'compress@10': 1.0, 'time@10': 3.8961}:  27%|██▋       | 8/30 [00:22<01:07,  3.05s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9076, 'compress@10': 1.0, 'time@10': 3.7933}:  27%|██▋       | 8/30 [00:24<01:07,  3.05s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9076, 'compress@10': 1.0, 'time@10': 3.7933}:  30%|███       | 9/30 [00:24<00:54,  2.57s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.913, 'compress@10': 1.0, 'time@10': 3.7488}:  30%|███       | 9/30 [00:27<00:54,  2.57s/it]    {'epoch': 40, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.913, 'compress@10': 1.0, 'time@10': 3.7488}:  33%|███▎      | 10/30 [00:27<00:56,  2.83s/it]{'epoch': 40, 'num_users': 6.6364, 'loss': 0.0236, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9113, 'compress@10': 1.0, 'time@10': 3.6689}:  33%|███▎      | 10/30 [00:29<00:56,  2.83s/it]{'epoch': 40, 'num_users': 6.6364, 'loss': 0.0236, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9113, 'compress@10': 1.0, 'time@10': 3.6689}:  37%|███▋      | 11/30 [00:29<00:45,  2.41s/it]{'epoch': 40, 'num_users': 6.4167, 'loss': 0.0218, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9117, 'compress@10': 1.0, 'time@10': 3.6488}:  37%|███▋      | 11/30 [00:32<00:45,  2.41s/it]{'epoch': 40, 'num_users': 6.4167, 'loss': 0.0218, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9117, 'compress@10': 1.0, 'time@10': 3.6488}:  40%|████      | 12/30 [00:32<00:49,  2.73s/it]{'epoch': 40, 'num_users': 6.6154, 'loss': 0.0223, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9101, 'compress@10': 1.0, 'time@10': 3.6706}:  40%|████      | 12/30 [00:34<00:49,  2.73s/it]{'epoch': 40, 'num_users': 6.6154, 'loss': 0.0223, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9101, 'compress@10': 1.0, 'time@10': 3.6706}:  43%|████▎     | 13/30 [00:34<00:42,  2.51s/it]{'epoch': 40, 'num_users': 6.3571, 'loss': 0.0207, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.9046, 'compress@10': 1.0, 'time@10': 3.6229}:  43%|████▎     | 13/30 [00:37<00:42,  2.51s/it]{'epoch': 40, 'num_users': 6.3571, 'loss': 0.0207, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.9046, 'compress@10': 1.0, 'time@10': 3.6229}:  47%|████▋     | 14/30 [00:37<00:42,  2.67s/it]{'epoch': 40, 'num_users': 6.2667, 'loss': 0.0215, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.9047, 'compress@10': 1.0, 'time@10': 3.661}:  47%|████▋     | 14/30 [00:39<00:42,  2.67s/it] {'epoch': 40, 'num_users': 6.2667, 'loss': 0.0215, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.9047, 'compress@10': 1.0, 'time@10': 3.661}:  50%|█████     | 15/30 [00:39<00:37,  2.51s/it]{'epoch': 40, 'num_users': 6.0625, 'loss': 0.0202, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9054, 'compress@10': 1.0, 'time@10': 3.6444}:  50%|█████     | 15/30 [00:43<00:37,  2.51s/it]{'epoch': 40, 'num_users': 6.0625, 'loss': 0.0202, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9054, 'compress@10': 1.0, 'time@10': 3.6444}:  53%|█████▎    | 16/30 [00:43<00:39,  2.79s/it]{'epoch': 40, 'num_users': 5.8235, 'loss': 0.019, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8992, 'compress@10': 1.0, 'time@10': 3.6291}:  53%|█████▎    | 16/30 [00:45<00:39,  2.79s/it] {'epoch': 40, 'num_users': 5.8235, 'loss': 0.019, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8992, 'compress@10': 1.0, 'time@10': 3.6291}:  57%|█████▋    | 17/30 [00:45<00:32,  2.47s/it]{'epoch': 40, 'num_users': 6.0556, 'loss': 0.0189, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 3.6197}:  57%|█████▋    | 17/30 [00:48<00:32,  2.47s/it]{'epoch': 40, 'num_users': 6.0556, 'loss': 0.0189, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 3.6197}:  60%|██████    | 18/30 [00:48<00:33,  2.78s/it]{'epoch': 40, 'num_users': 6.0, 'loss': 0.0182, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.9027, 'compress@10': 1.0, 'time@10': 3.6067}:  60%|██████    | 18/30 [00:50<00:33,  2.78s/it]   {'epoch': 40, 'num_users': 6.0, 'loss': 0.0182, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.9027, 'compress@10': 1.0, 'time@10': 3.6067}:  63%|██████▎   | 19/30 [00:50<00:27,  2.49s/it]{'epoch': 40, 'num_users': 6.15, 'loss': 0.0184, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 3.5801}:  63%|██████▎   | 19/30 [00:53<00:27,  2.49s/it]{'epoch': 40, 'num_users': 6.15, 'loss': 0.0184, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 3.5801}:  67%|██████▋   | 20/30 [00:53<00:26,  2.68s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.9011, 'compress@10': 1.0, 'time@10': 3.6891}:  67%|██████▋   | 20/30 [00:56<00:26,  2.68s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.9011, 'compress@10': 1.0, 'time@10': 3.6891}:  70%|███████   | 21/30 [00:56<00:24,  2.77s/it]{'epoch': 40, 'num_users': 6.1818, 'loss': 0.019, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 3.6773}:  70%|███████   | 21/30 [00:59<00:24,  2.77s/it] {'epoch': 40, 'num_users': 6.1818, 'loss': 0.019, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 3.6773}:  73%|███████▎  | 22/30 [00:59<00:23,  2.98s/it]{'epoch': 40, 'num_users': 6.1304, 'loss': 0.0189, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 3.6602}:  73%|███████▎  | 22/30 [01:01<00:23,  2.98s/it]{'epoch': 40, 'num_users': 6.1304, 'loss': 0.0189, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 3.6602}:  77%|███████▋  | 23/30 [01:01<00:18,  2.59s/it]{'epoch': 40, 'num_users': 5.9583, 'loss': 0.0181, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.6477}:  77%|███████▋  | 23/30 [01:05<00:18,  2.59s/it]{'epoch': 40, 'num_users': 5.9583, 'loss': 0.0181, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.6477}:  80%|████████  | 24/30 [01:05<00:16,  2.83s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8905, 'compress@10': 1.0, 'time@10': 3.6319}:  80%|████████  | 24/30 [01:06<00:16,  2.83s/it]   {'epoch': 40, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8905, 'compress@10': 1.0, 'time@10': 3.6319}:  83%|████████▎ | 25/30 [01:06<00:12,  2.48s/it]{'epoch': 40, 'num_users': 5.8077, 'loss': 0.0174, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8926, 'compress@10': 1.0, 'time@10': 3.7372}:  83%|████████▎ | 25/30 [01:13<00:12,  2.48s/it]{'epoch': 40, 'num_users': 5.8077, 'loss': 0.0174, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8926, 'compress@10': 1.0, 'time@10': 3.7372}:  87%|████████▋ | 26/30 [01:13<00:14,  3.66s/it]{'epoch': 40, 'num_users': 5.8889, 'loss': 0.0174, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 3.7208}:  87%|████████▋ | 26/30 [01:14<00:14,  3.66s/it]{'epoch': 40, 'num_users': 5.8889, 'loss': 0.0174, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 3.7208}:  90%|█████████ | 27/30 [01:14<00:09,  3.07s/it]{'epoch': 40, 'num_users': 6.0, 'loss': 0.0174, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 3.7192}:  90%|█████████ | 27/30 [01:18<00:09,  3.07s/it]   {'epoch': 40, 'num_users': 6.0, 'loss': 0.0174, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 3.7192}:  93%|█████████▎| 28/30 [01:18<00:06,  3.26s/it]{'epoch': 40, 'num_users': 5.8621, 'loss': 0.0172, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.7002}:  93%|█████████▎| 28/30 [01:20<00:06,  3.26s/it]{'epoch': 40, 'num_users': 5.8621, 'loss': 0.0172, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.7002}:  97%|█████████▋| 29/30 [01:20<00:02,  2.77s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0174, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 3.6912}:  97%|█████████▋| 29/30 [01:23<00:02,  2.77s/it] {'epoch': 40, 'num_users': 5.8667, 'loss': 0.0174, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 3.6912}: 100%|██████████| 30/30 [01:23<00:00,  2.98s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0174, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 3.6912}: 100%|██████████| 30/30 [01:23<00:00,  2.79s/it]
Epoch: 40
Avg # of users: 5.866666666666666
Avg Loss: 0.017365994987909507
Avg hit ratio: 0.8559695253311274
Avg ndcg: 0.8975187310307994
Avg compression ratio: 0.9999999860153537
Avg train time: 3.691203514734904
Std train time: 0.9602048362183893
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 34, 14, 1, 8, 8, 11, 6, 9, 9, 38, 9, 79, 6, 37, 51, 14, 15, 7, 2, 19, 10, 100, 99, 1, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0259, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8905, 'compress@10': 1.0, 'time@10': 3.2529}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0259, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8905, 'compress@10': 1.0, 'time@10': 3.2529}:   3%|▎         | 1/30 [00:01<00:48,  1.66s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.926, 'compress@10': 1.0, 'time@10': 3.2723}:   3%|▎         | 1/30 [00:04<00:48,  1.66s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.926, 'compress@10': 1.0, 'time@10': 3.2723}:   7%|▋         | 2/30 [00:04<01:14,  2.64s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 3.3323}:   7%|▋         | 2/30 [00:06<01:14,  2.64s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 3.3323}:  10%|█         | 3/30 [00:06<01:00,  2.24s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9161, 'compress@10': 1.0, 'time@10': 3.3376}:  10%|█         | 3/30 [00:10<01:00,  2.24s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9161, 'compress@10': 1.0, 'time@10': 3.3376}:  13%|█▎        | 4/30 [00:10<01:10,  2.70s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8538, 'compress@10': 1.0, 'time@10': 2.8469}:  13%|█▎        | 4/30 [00:10<01:10,  2.70s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8538, 'compress@10': 1.0, 'time@10': 2.8469}:  17%|█▋        | 5/30 [00:10<00:47,  1.90s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0435, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8656, 'compress@10': 1.0, 'time@10': 2.8912}:  17%|█▋        | 5/30 [00:13<00:47,  1.90s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0435, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8656, 'compress@10': 1.0, 'time@10': 2.8912}:  20%|██        | 6/30 [00:13<00:55,  2.32s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0408, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 2.9141}:  20%|██        | 6/30 [00:15<00:55,  2.32s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0408, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 2.9141}:  23%|██▎       | 7/30 [00:15<00:47,  2.07s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0388, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 2.9194}:  23%|██▎       | 7/30 [00:18<00:47,  2.07s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0388, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 2.9194}:  27%|██▋       | 8/30 [00:18<00:52,  2.37s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0371, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8952, 'compress@10': 1.0, 'time@10': 3.0387}:  27%|██▋       | 8/30 [00:20<00:52,  2.37s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0371, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8952, 'compress@10': 1.0, 'time@10': 3.0387}:  30%|███       | 9/30 [00:20<00:47,  2.27s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0352, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 3.0968}:  30%|███       | 9/30 [00:24<00:47,  2.27s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0352, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 3.0968}:  33%|███▎      | 10/30 [00:24<00:53,  2.70s/it]{'epoch': 41, 'num_users': 6.6364, 'loss': 0.0352, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 3.2016}:  33%|███▎      | 10/30 [00:26<00:53,  2.70s/it]{'epoch': 41, 'num_users': 6.6364, 'loss': 0.0352, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 3.2016}:  37%|███▋      | 11/30 [00:26<00:48,  2.53s/it]{'epoch': 41, 'num_users': 6.4167, 'loss': 0.0325, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.2585}:  37%|███▋      | 11/30 [00:30<00:48,  2.53s/it]{'epoch': 41, 'num_users': 6.4167, 'loss': 0.0325, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.2585}:  40%|████      | 12/30 [00:30<00:53,  2.96s/it]{'epoch': 41, 'num_users': 6.6154, 'loss': 0.032, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9015, 'compress@10': 1.0, 'time@10': 3.277}:  40%|████      | 12/30 [00:31<00:53,  2.96s/it]  {'epoch': 41, 'num_users': 6.6154, 'loss': 0.032, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9015, 'compress@10': 1.0, 'time@10': 3.277}:  43%|████▎     | 13/30 [00:31<00:44,  2.60s/it]{'epoch': 41, 'num_users': 6.3571, 'loss': 0.0297, 'hit_ratio@10': 0.8201, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.2895}:  43%|████▎     | 13/30 [00:35<00:44,  2.60s/it]{'epoch': 41, 'num_users': 6.3571, 'loss': 0.0297, 'hit_ratio@10': 0.8201, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.2895}:  47%|████▋     | 14/30 [00:35<00:45,  2.87s/it]{'epoch': 41, 'num_users': 6.2667, 'loss': 0.0298, 'hit_ratio@10': 0.83, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 3.2801}:  47%|████▋     | 14/30 [00:37<00:45,  2.87s/it]  {'epoch': 41, 'num_users': 6.2667, 'loss': 0.0298, 'hit_ratio@10': 0.83, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 3.2801}:  50%|█████     | 15/30 [00:37<00:37,  2.49s/it]{'epoch': 41, 'num_users': 6.0625, 'loss': 0.0279, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 3.2977}:  50%|█████     | 15/30 [00:40<00:37,  2.49s/it]{'epoch': 41, 'num_users': 6.0625, 'loss': 0.0279, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 3.2977}:  53%|█████▎    | 16/30 [00:40<00:39,  2.82s/it]{'epoch': 41, 'num_users': 5.8235, 'loss': 0.0263, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 3.3116}:  53%|█████▎    | 16/30 [00:42<00:39,  2.82s/it]{'epoch': 41, 'num_users': 5.8235, 'loss': 0.0263, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 3.3116}:  57%|█████▋    | 17/30 [00:42<00:32,  2.52s/it]{'epoch': 41, 'num_users': 6.0556, 'loss': 0.0256, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 3.3226}:  57%|█████▋    | 17/30 [00:45<00:32,  2.52s/it]{'epoch': 41, 'num_users': 6.0556, 'loss': 0.0256, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 3.3226}:  60%|██████    | 18/30 [00:45<00:33,  2.83s/it]{'epoch': 41, 'num_users': 6.0, 'loss': 0.0245, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8953, 'compress@10': 1.0, 'time@10': 3.3257}:  60%|██████    | 18/30 [00:47<00:33,  2.83s/it]   {'epoch': 41, 'num_users': 6.0, 'loss': 0.0245, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8953, 'compress@10': 1.0, 'time@10': 3.3257}:  63%|██████▎   | 19/30 [00:47<00:27,  2.50s/it]{'epoch': 41, 'num_users': 6.15, 'loss': 0.0244, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.3277}:  63%|██████▎   | 19/30 [00:51<00:27,  2.50s/it]{'epoch': 41, 'num_users': 6.15, 'loss': 0.0244, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.3277}:  67%|██████▋   | 20/30 [00:51<00:27,  2.77s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8897, 'compress@10': 1.0, 'time@10': 3.2294}:  67%|██████▋   | 20/30 [00:51<00:27,  2.77s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8897, 'compress@10': 1.0, 'time@10': 3.2294}:  70%|███████   | 21/30 [00:51<00:19,  2.14s/it]{'epoch': 41, 'num_users': 6.1818, 'loss': 0.0264, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 3.236}:  70%|███████   | 21/30 [00:55<00:19,  2.14s/it] {'epoch': 41, 'num_users': 6.1818, 'loss': 0.0264, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 3.236}:  73%|███████▎  | 22/30 [00:55<00:20,  2.52s/it]{'epoch': 41, 'num_users': 6.1304, 'loss': 0.0258, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 3.2335}:  73%|███████▎  | 22/30 [00:56<00:20,  2.52s/it]{'epoch': 41, 'num_users': 6.1304, 'loss': 0.0258, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 3.2335}:  77%|███████▋  | 23/30 [00:56<00:15,  2.25s/it]{'epoch': 41, 'num_users': 5.9583, 'loss': 0.0247, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 3.2318}:  77%|███████▋  | 23/30 [01:00<00:15,  2.25s/it]{'epoch': 41, 'num_users': 5.9583, 'loss': 0.0247, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 3.2318}:  80%|████████  | 24/30 [01:00<00:15,  2.55s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0237, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8814, 'compress@10': 1.0, 'time@10': 3.2415}:  80%|████████  | 24/30 [01:01<00:15,  2.55s/it]   {'epoch': 41, 'num_users': 5.8, 'loss': 0.0237, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8814, 'compress@10': 1.0, 'time@10': 3.2415}:  83%|████████▎ | 25/30 [01:01<00:11,  2.32s/it]{'epoch': 41, 'num_users': 5.8077, 'loss': 0.0268, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.1456}:  83%|████████▎ | 25/30 [01:02<00:11,  2.32s/it]{'epoch': 41, 'num_users': 5.8077, 'loss': 0.0268, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.1456}:  87%|████████▋ | 26/30 [01:02<00:07,  1.86s/it]{'epoch': 41, 'num_users': 5.8889, 'loss': 0.0264, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8765, 'compress@10': 1.0, 'time@10': 3.1558}:  87%|████████▋ | 26/30 [01:04<00:07,  1.86s/it]{'epoch': 41, 'num_users': 5.8889, 'loss': 0.0264, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8765, 'compress@10': 1.0, 'time@10': 3.1558}:  90%|█████████ | 27/30 [01:04<00:05,  1.82s/it]{'epoch': 41, 'num_users': 6.0, 'loss': 0.0261, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8783, 'compress@10': 1.0, 'time@10': 3.1569}:  90%|█████████ | 27/30 [01:07<00:05,  1.82s/it]   {'epoch': 41, 'num_users': 6.0, 'loss': 0.0261, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8783, 'compress@10': 1.0, 'time@10': 3.1569}:  93%|█████████▎| 28/30 [01:07<00:04,  2.24s/it]{'epoch': 41, 'num_users': 5.8621, 'loss': 0.0255, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.8804, 'compress@10': 1.0, 'time@10': 3.1718}:  93%|█████████▎| 28/30 [01:09<00:04,  2.24s/it]{'epoch': 41, 'num_users': 5.8621, 'loss': 0.0255, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.8804, 'compress@10': 1.0, 'time@10': 3.1718}:  97%|█████████▋| 29/30 [01:09<00:02,  2.12s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0251, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 3.1775}:  97%|█████████▋| 29/30 [01:12<00:02,  2.12s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0251, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 3.1775}: 100%|██████████| 30/30 [01:12<00:00,  2.50s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0251, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 3.1775}: 100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch: 41
Avg # of users: 5.866666666666666
Avg Loss: 0.025067248772370185
Avg hit ratio: 0.8388342778981449
Avg ndcg: 0.8832437874965471
Avg compression ratio: 0.9999999860153537
Avg train time: 3.177514998118083
Std train time: 0.7864834342474444
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 12, 34, 14, 8, 9, 9, 12, 4, 8, 7, 37, 9, 79, 7, 37, 51, 14, 15, 7, 8, 19, 11, 101, 99, 9, 7, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0263, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8794, 'compress@10': 1.0, 'time@10': 3.234}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0263, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8794, 'compress@10': 1.0, 'time@10': 3.234}:   3%|▎         | 1/30 [00:01<00:47,  1.65s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0217, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9111, 'compress@10': 1.0, 'time@10': 3.2155}:   3%|▎         | 1/30 [00:04<00:47,  1.65s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0217, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9111, 'compress@10': 1.0, 'time@10': 3.2155}:   7%|▋         | 2/30 [00:04<01:12,  2.59s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 3.2727}:   7%|▋         | 2/30 [00:06<01:12,  2.59s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 3.2727}:  10%|█         | 3/30 [00:06<00:59,  2.20s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9078, 'compress@10': 1.0, 'time@10': 3.291}:  10%|█         | 3/30 [00:10<00:59,  2.20s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9078, 'compress@10': 1.0, 'time@10': 3.291}:  13%|█▎        | 4/30 [00:10<01:09,  2.67s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.9998}:  13%|█▎        | 4/30 [00:13<01:09,  2.67s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.9998}:  17%|█▋        | 5/30 [00:13<01:13,  2.95s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0198, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.8925}:  17%|█▋        | 5/30 [00:16<01:13,  2.95s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0198, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.8925}:  20%|██        | 6/30 [00:16<01:14,  3.11s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9064, 'compress@10': 1.0, 'time@10': 3.8915}:  20%|██        | 6/30 [00:18<01:14,  3.11s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9064, 'compress@10': 1.0, 'time@10': 3.8915}:  23%|██▎       | 7/30 [00:18<01:03,  2.74s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0232, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 3.8549}:  23%|██▎       | 7/30 [00:22<01:03,  2.74s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0232, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 3.8549}:  27%|██▋       | 8/30 [00:22<01:06,  3.03s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9093, 'compress@10': 1.0, 'time@10': 3.6939}:  27%|██▋       | 8/30 [00:23<01:06,  3.03s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9093, 'compress@10': 1.0, 'time@10': 3.6939}:  30%|███       | 9/30 [00:23<00:51,  2.47s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9149, 'compress@10': 1.0, 'time@10': 3.6331}:  30%|███       | 9/30 [00:26<00:51,  2.47s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9149, 'compress@10': 1.0, 'time@10': 3.6331}:  33%|███▎      | 10/30 [00:26<00:53,  2.67s/it]{'epoch': 42, 'num_users': 6.6364, 'loss': 0.0233, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.9132, 'compress@10': 1.0, 'time@10': 3.5979}:  33%|███▎      | 10/30 [00:28<00:53,  2.67s/it]{'epoch': 42, 'num_users': 6.6364, 'loss': 0.0233, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.9132, 'compress@10': 1.0, 'time@10': 3.5979}:  37%|███▋      | 11/30 [00:28<00:44,  2.36s/it]{'epoch': 42, 'num_users': 6.4167, 'loss': 0.0216, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.9135, 'compress@10': 1.0, 'time@10': 3.5878}:  37%|███▋      | 11/30 [00:32<00:44,  2.36s/it]{'epoch': 42, 'num_users': 6.4167, 'loss': 0.0216, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.9135, 'compress@10': 1.0, 'time@10': 3.5878}:  40%|████      | 12/30 [00:32<00:48,  2.71s/it]{'epoch': 42, 'num_users': 6.6154, 'loss': 0.0224, 'hit_ratio@10': 0.852, 'ndcg@10': 0.9113, 'compress@10': 1.0, 'time@10': 3.5706}:  40%|████      | 12/30 [00:33<00:48,  2.71s/it] {'epoch': 42, 'num_users': 6.6154, 'loss': 0.0224, 'hit_ratio@10': 0.852, 'ndcg@10': 0.9113, 'compress@10': 1.0, 'time@10': 3.5706}:  43%|████▎     | 13/30 [00:33<00:41,  2.41s/it]{'epoch': 42, 'num_users': 6.3571, 'loss': 0.0208, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.9057, 'compress@10': 1.0, 'time@10': 3.5636}:  43%|████▎     | 13/30 [00:37<00:41,  2.41s/it]{'epoch': 42, 'num_users': 6.3571, 'loss': 0.0208, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.9057, 'compress@10': 1.0, 'time@10': 3.5636}:  47%|████▋     | 14/30 [00:37<00:43,  2.75s/it]{'epoch': 42, 'num_users': 6.2667, 'loss': 0.0214, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.9048, 'compress@10': 1.0, 'time@10': 3.5758}:  47%|████▋     | 14/30 [00:39<00:43,  2.75s/it]{'epoch': 42, 'num_users': 6.2667, 'loss': 0.0214, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.9048, 'compress@10': 1.0, 'time@10': 3.5758}:  50%|█████     | 15/30 [00:39<00:37,  2.49s/it]{'epoch': 42, 'num_users': 6.0625, 'loss': 0.0201, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 3.5741}:  50%|█████     | 15/30 [00:42<00:37,  2.49s/it] {'epoch': 42, 'num_users': 6.0625, 'loss': 0.0201, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 3.5741}:  53%|█████▎    | 16/30 [00:42<00:39,  2.82s/it]{'epoch': 42, 'num_users': 5.8235, 'loss': 0.0189, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8994, 'compress@10': 1.0, 'time@10': 3.5667}:  53%|█████▎    | 16/30 [00:44<00:39,  2.82s/it]{'epoch': 42, 'num_users': 5.8235, 'loss': 0.0189, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8994, 'compress@10': 1.0, 'time@10': 3.5667}:  57%|█████▋    | 17/30 [00:44<00:32,  2.50s/it]{'epoch': 42, 'num_users': 6.0556, 'loss': 0.019, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.9018, 'compress@10': 1.0, 'time@10': 3.5636}:  57%|█████▋    | 17/30 [00:48<00:32,  2.50s/it] {'epoch': 42, 'num_users': 6.0556, 'loss': 0.019, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.9018, 'compress@10': 1.0, 'time@10': 3.5636}:  60%|██████    | 18/30 [00:48<00:33,  2.82s/it]{'epoch': 42, 'num_users': 6.0, 'loss': 0.0182, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.9029, 'compress@10': 1.0, 'time@10': 3.5549}:  60%|██████    | 18/30 [00:49<00:33,  2.82s/it]  {'epoch': 42, 'num_users': 6.0, 'loss': 0.0182, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.9029, 'compress@10': 1.0, 'time@10': 3.5549}:  63%|██████▎   | 19/30 [00:49<00:27,  2.49s/it]{'epoch': 42, 'num_users': 6.15, 'loss': 0.0184, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.9038, 'compress@10': 1.0, 'time@10': 3.5602}:  63%|██████▎   | 19/30 [00:53<00:27,  2.49s/it]{'epoch': 42, 'num_users': 6.15, 'loss': 0.0184, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.9038, 'compress@10': 1.0, 'time@10': 3.5602}:  67%|██████▋   | 20/30 [00:53<00:28,  2.85s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.9015, 'compress@10': 1.0, 'time@10': 3.6674}:  67%|██████▋   | 20/30 [00:56<00:28,  2.85s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.9015, 'compress@10': 1.0, 'time@10': 3.6674}:  70%|███████   | 21/30 [00:56<00:25,  2.88s/it]{'epoch': 42, 'num_users': 6.1818, 'loss': 0.019, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9037, 'compress@10': 1.0, 'time@10': 3.6558}:  70%|███████   | 21/30 [00:59<00:25,  2.88s/it] {'epoch': 42, 'num_users': 6.1818, 'loss': 0.019, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9037, 'compress@10': 1.0, 'time@10': 3.6558}:  73%|███████▎  | 22/30 [00:59<00:24,  3.06s/it]{'epoch': 42, 'num_users': 6.1304, 'loss': 0.0186, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.9052, 'compress@10': 1.0, 'time@10': 3.6606}:  73%|███████▎  | 22/30 [01:01<00:24,  3.06s/it]{'epoch': 42, 'num_users': 6.1304, 'loss': 0.0186, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.9052, 'compress@10': 1.0, 'time@10': 3.6606}:  77%|███████▋  | 23/30 [01:01<00:19,  2.72s/it]{'epoch': 42, 'num_users': 5.9583, 'loss': 0.0178, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9008, 'compress@10': 1.0, 'time@10': 3.6485}:  77%|███████▋  | 23/30 [01:05<00:19,  2.72s/it]{'epoch': 42, 'num_users': 5.9583, 'loss': 0.0178, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9008, 'compress@10': 1.0, 'time@10': 3.6485}:  80%|████████  | 24/30 [01:05<00:17,  2.94s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8914, 'compress@10': 1.0, 'time@10': 3.6434}:  80%|████████  | 24/30 [01:07<00:17,  2.94s/it]   {'epoch': 42, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8914, 'compress@10': 1.0, 'time@10': 3.6434}:  83%|████████▎ | 25/30 [01:07<00:12,  2.60s/it]{'epoch': 42, 'num_users': 5.8077, 'loss': 0.0172, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8934, 'compress@10': 1.0, 'time@10': 3.7513}:  83%|████████▎ | 25/30 [01:13<00:12,  2.60s/it]{'epoch': 42, 'num_users': 5.8077, 'loss': 0.0172, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8934, 'compress@10': 1.0, 'time@10': 3.7513}:  87%|████████▋ | 26/30 [01:13<00:15,  3.77s/it]{'epoch': 42, 'num_users': 5.8889, 'loss': 0.0172, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 3.7256}:  87%|████████▋ | 26/30 [01:15<00:15,  3.77s/it]{'epoch': 42, 'num_users': 5.8889, 'loss': 0.0172, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 3.7256}:  90%|█████████ | 27/30 [01:15<00:09,  3.11s/it]{'epoch': 42, 'num_users': 6.0, 'loss': 0.0171, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 3.7108}:  90%|█████████ | 27/30 [01:18<00:09,  3.11s/it]   {'epoch': 42, 'num_users': 6.0, 'loss': 0.0171, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 3.7108}:  93%|█████████▎| 28/30 [01:18<00:06,  3.18s/it]{'epoch': 42, 'num_users': 5.8621, 'loss': 0.0172, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 3.7029}:  93%|█████████▎| 28/30 [01:20<00:06,  3.18s/it]{'epoch': 42, 'num_users': 5.8621, 'loss': 0.0172, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 3.7029}:  97%|█████████▋| 29/30 [01:20<00:02,  2.76s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0185, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 3.6932}:  97%|█████████▋| 29/30 [01:23<00:02,  2.76s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0185, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 3.6932}: 100%|██████████| 30/30 [01:23<00:00,  2.97s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0185, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 3.6932}: 100%|██████████| 30/30 [01:23<00:00,  2.79s/it]
Epoch: 42
Avg # of users: 5.866666666666666
Avg Loss: 0.01850407138778598
Avg hit ratio: 0.8557296401593607
Avg ndcg: 0.9031450580700919
Avg compression ratio: 0.9999999860153537
Avg train time: 3.6932215213775637
Std train time: 0.9364886944597461
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 13, 34, 14, 1, 9, 8, 12, 7, 9, 8, 37, 9, 79, 6, 37, 51, 14, 15, 6, 1, 19, 10, 101, 99, 1, 8, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0217, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8895, 'compress@10': 1.0, 'time@10': 3.535}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0217, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8895, 'compress@10': 1.0, 'time@10': 3.535}:   3%|▎         | 1/30 [00:01<00:52,  1.81s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9668, 'compress@10': 1.0, 'time@10': 3.493}:   3%|▎         | 1/30 [00:05<00:52,  1.81s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9668, 'compress@10': 1.0, 'time@10': 3.493}:   7%|▋         | 2/30 [00:05<01:18,  2.81s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9302, 'compress@10': 1.0, 'time@10': 3.4514}:   7%|▋         | 2/30 [00:07<01:18,  2.81s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9302, 'compress@10': 1.0, 'time@10': 3.4514}:  10%|█         | 3/30 [00:07<01:02,  2.31s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9373, 'compress@10': 1.0, 'time@10': 3.3346}:  10%|█         | 3/30 [00:10<01:02,  2.31s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9373, 'compress@10': 1.0, 'time@10': 3.3346}:  13%|█▎        | 4/30 [00:10<01:07,  2.59s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0481, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8712, 'compress@10': 1.0, 'time@10': 2.8304}:  13%|█▎        | 4/30 [00:10<01:07,  2.59s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0481, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8712, 'compress@10': 1.0, 'time@10': 2.8304}:  17%|█▋        | 5/30 [00:10<00:45,  1.82s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0448, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8779, 'compress@10': 1.0, 'time@10': 2.9384}:  17%|█▋        | 5/30 [00:14<00:45,  1.82s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0448, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8779, 'compress@10': 1.0, 'time@10': 2.9384}:  20%|██        | 6/30 [00:14<00:57,  2.40s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0411, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 2.952}:  20%|██        | 6/30 [00:15<00:57,  2.40s/it] {'epoch': 43, 'num_users': 6.2857, 'loss': 0.0411, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 2.952}:  23%|██▎       | 7/30 [00:15<00:48,  2.12s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0379, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 3.0111}:  23%|██▎       | 7/30 [00:19<00:48,  2.12s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0379, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 3.0111}:  27%|██▋       | 8/30 [00:19<00:56,  2.55s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0372, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8978, 'compress@10': 1.0, 'time@10': 3.1379}:  27%|██▋       | 8/30 [00:21<00:56,  2.55s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0372, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8978, 'compress@10': 1.0, 'time@10': 3.1379}:  30%|███       | 9/30 [00:21<00:50,  2.41s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0352, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9047, 'compress@10': 1.0, 'time@10': 3.1688}:  30%|███       | 9/30 [00:24<00:50,  2.41s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0352, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9047, 'compress@10': 1.0, 'time@10': 3.1688}:  33%|███▎      | 10/30 [00:24<00:54,  2.74s/it]{'epoch': 43, 'num_users': 6.6364, 'loss': 0.0352, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9044, 'compress@10': 1.0, 'time@10': 3.2134}:  33%|███▎      | 10/30 [00:26<00:54,  2.74s/it]{'epoch': 43, 'num_users': 6.6364, 'loss': 0.0352, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9044, 'compress@10': 1.0, 'time@10': 3.2134}:  37%|███▋      | 11/30 [00:26<00:47,  2.48s/it]{'epoch': 43, 'num_users': 6.4167, 'loss': 0.0323, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.9054, 'compress@10': 1.0, 'time@10': 3.2393}:  37%|███▋      | 11/30 [00:30<00:47,  2.48s/it]{'epoch': 43, 'num_users': 6.4167, 'loss': 0.0323, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.9054, 'compress@10': 1.0, 'time@10': 3.2393}:  40%|████      | 12/30 [00:30<00:50,  2.81s/it]{'epoch': 43, 'num_users': 6.6154, 'loss': 0.0317, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 3.2631}:  40%|████      | 12/30 [00:31<00:50,  2.81s/it] {'epoch': 43, 'num_users': 6.6154, 'loss': 0.0317, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 3.2631}:  43%|████▎     | 13/30 [00:31<00:42,  2.51s/it]{'epoch': 43, 'num_users': 6.3571, 'loss': 0.0295, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 3.271}:  43%|████▎     | 13/30 [00:35<00:42,  2.51s/it]{'epoch': 43, 'num_users': 6.3571, 'loss': 0.0295, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 3.271}:  47%|████▋     | 14/30 [00:35<00:44,  2.78s/it]{'epoch': 43, 'num_users': 6.2667, 'loss': 0.0296, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8993, 'compress@10': 1.0, 'time@10': 3.2581}:  47%|████▋     | 14/30 [00:36<00:44,  2.78s/it]{'epoch': 43, 'num_users': 6.2667, 'loss': 0.0296, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8993, 'compress@10': 1.0, 'time@10': 3.2581}:  50%|█████     | 15/30 [00:36<00:36,  2.42s/it]{'epoch': 43, 'num_users': 6.0625, 'loss': 0.0278, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.9004, 'compress@10': 1.0, 'time@10': 3.2727}:  50%|█████     | 15/30 [00:40<00:36,  2.42s/it]{'epoch': 43, 'num_users': 6.0625, 'loss': 0.0278, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.9004, 'compress@10': 1.0, 'time@10': 3.2727}:  53%|█████▎    | 16/30 [00:40<00:38,  2.75s/it]{'epoch': 43, 'num_users': 5.8235, 'loss': 0.0261, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 3.2927}:  53%|█████▎    | 16/30 [00:42<00:38,  2.75s/it]{'epoch': 43, 'num_users': 5.8235, 'loss': 0.0261, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 3.2927}:  57%|█████▋    | 17/30 [00:42<00:32,  2.48s/it]{'epoch': 43, 'num_users': 6.0556, 'loss': 0.0262, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8974, 'compress@10': 1.0, 'time@10': 3.3205}:  57%|█████▋    | 17/30 [00:46<00:32,  2.48s/it]{'epoch': 43, 'num_users': 6.0556, 'loss': 0.0262, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8974, 'compress@10': 1.0, 'time@10': 3.3205}:  60%|██████    | 18/30 [00:46<00:34,  2.89s/it]{'epoch': 43, 'num_users': 6.0, 'loss': 0.025, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 3.3218}:  60%|██████    | 18/30 [00:47<00:34,  2.89s/it]    {'epoch': 43, 'num_users': 6.0, 'loss': 0.025, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 3.3218}:  63%|██████▎   | 19/30 [00:47<00:27,  2.53s/it]{'epoch': 43, 'num_users': 6.15, 'loss': 0.0247, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8996, 'compress@10': 1.0, 'time@10': 3.3128}:  63%|██████▎   | 19/30 [00:50<00:27,  2.53s/it]{'epoch': 43, 'num_users': 6.15, 'loss': 0.0247, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8996, 'compress@10': 1.0, 'time@10': 3.3128}:  67%|██████▋   | 20/30 [00:50<00:27,  2.73s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0316, 'hit_ratio@10': 0.8232, 'ndcg@10': 0.8872, 'compress@10': 1.0, 'time@10': 3.1918}:  67%|██████▋   | 20/30 [00:51<00:27,  2.73s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0316, 'hit_ratio@10': 0.8232, 'ndcg@10': 0.8872, 'compress@10': 1.0, 'time@10': 3.1918}:  70%|███████   | 21/30 [00:51<00:18,  2.04s/it]{'epoch': 43, 'num_users': 6.1818, 'loss': 0.0304, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 3.2051}:  70%|███████   | 21/30 [00:54<00:18,  2.04s/it]{'epoch': 43, 'num_users': 6.1818, 'loss': 0.0304, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 3.2051}:  73%|███████▎  | 22/30 [00:54<00:19,  2.48s/it]{'epoch': 43, 'num_users': 6.1304, 'loss': 0.0295, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.2074}:  73%|███████▎  | 22/30 [00:56<00:19,  2.48s/it]{'epoch': 43, 'num_users': 6.1304, 'loss': 0.0295, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.2074}:  77%|███████▋  | 23/30 [00:56<00:15,  2.24s/it]{'epoch': 43, 'num_users': 5.9583, 'loss': 0.0283, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 3.2201}:  77%|███████▋  | 23/30 [01:00<00:15,  2.24s/it]{'epoch': 43, 'num_users': 5.9583, 'loss': 0.0283, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 3.2201}:  80%|████████  | 24/30 [01:00<00:15,  2.63s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0272, 'hit_ratio@10': 0.8244, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 3.2288}:  80%|████████  | 24/30 [01:01<00:15,  2.63s/it]   {'epoch': 43, 'num_users': 5.8, 'loss': 0.0272, 'hit_ratio@10': 0.8244, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 3.2288}:  83%|████████▎ | 25/30 [01:01<00:11,  2.37s/it]{'epoch': 43, 'num_users': 5.8077, 'loss': 0.03, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8734, 'compress@10': 1.0, 'time@10': 3.132}:  83%|████████▎ | 25/30 [01:02<00:11,  2.37s/it]{'epoch': 43, 'num_users': 5.8077, 'loss': 0.03, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8734, 'compress@10': 1.0, 'time@10': 3.132}:  87%|████████▋ | 26/30 [01:02<00:07,  1.88s/it]{'epoch': 43, 'num_users': 5.8889, 'loss': 0.0295, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8748, 'compress@10': 1.0, 'time@10': 3.1584}:  87%|████████▋ | 26/30 [01:04<00:07,  1.88s/it]{'epoch': 43, 'num_users': 5.8889, 'loss': 0.0295, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8748, 'compress@10': 1.0, 'time@10': 3.1584}:  90%|█████████ | 27/30 [01:04<00:05,  1.91s/it]{'epoch': 43, 'num_users': 6.0, 'loss': 0.029, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 3.1759}:  90%|█████████ | 27/30 [01:08<00:05,  1.91s/it]    {'epoch': 43, 'num_users': 6.0, 'loss': 0.029, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 3.1759}:  93%|█████████▎| 28/30 [01:08<00:05,  2.53s/it]{'epoch': 43, 'num_users': 5.8621, 'loss': 0.0284, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 3.191}:  93%|█████████▎| 28/30 [01:10<00:05,  2.53s/it]{'epoch': 43, 'num_users': 5.8621, 'loss': 0.0284, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 3.191}:  97%|█████████▋| 29/30 [01:10<00:02,  2.33s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0289, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 3.2011}:  97%|█████████▋| 29/30 [01:13<00:02,  2.33s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0289, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 3.2011}: 100%|██████████| 30/30 [01:13<00:00,  2.69s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0289, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 3.2011}: 100%|██████████| 30/30 [01:13<00:00,  2.47s/it]
Epoch: 43
Avg # of users: 5.866666666666666
Avg Loss: 0.02887665314727323
Avg hit ratio: 0.8388686883297177
Avg ndcg: 0.8831022758672409
Avg compression ratio: 0.9999999860166272
Avg train time: 3.2011052052179974
Std train time: 0.8444049478719163
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 13, 34, 15, 9, 9, 9, 12, 5, 9, 7, 37, 9, 79, 7, 37, 50, 13, 15, 7, 9, 19, 11, 101, 99, 9, 7, 7, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9025, 'compress@10': 1.0, 'time@10': 3.7454}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9025, 'compress@10': 1.0, 'time@10': 3.7454}:   3%|▎         | 1/30 [00:01<00:55,  1.91s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9562, 'compress@10': 1.0, 'time@10': 3.6692}:   3%|▎         | 1/30 [00:05<00:55,  1.91s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9562, 'compress@10': 1.0, 'time@10': 3.6692}:   7%|▋         | 2/30 [00:05<01:21,  2.92s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.9232, 'compress@10': 1.0, 'time@10': 3.6717}:   7%|▋         | 2/30 [00:07<01:21,  2.92s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.9232, 'compress@10': 1.0, 'time@10': 3.6717}:  10%|█         | 3/30 [00:07<01:06,  2.45s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.822, 'ndcg@10': 0.9341, 'compress@10': 1.0, 'time@10': 3.5963}:  10%|█         | 3/30 [00:10<01:06,  2.45s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.822, 'ndcg@10': 0.9341, 'compress@10': 1.0, 'time@10': 3.5963}:  13%|█▎        | 4/30 [00:10<01:13,  2.83s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9208, 'compress@10': 1.0, 'time@10': 4.4364}:  13%|█▎        | 4/30 [00:14<01:13,  2.83s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9208, 'compress@10': 1.0, 'time@10': 4.4364}:  17%|█▋        | 5/30 [00:14<01:20,  3.23s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0197, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 4.3089}:  17%|█▋        | 5/30 [00:18<01:20,  3.23s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0197, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 4.3089}:  20%|██        | 6/30 [00:18<01:21,  3.39s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0196, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9266, 'compress@10': 1.0, 'time@10': 4.2432}:  20%|██        | 6/30 [00:20<01:21,  3.39s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0196, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9266, 'compress@10': 1.0, 'time@10': 4.2432}:  23%|██▎       | 7/30 [00:20<01:07,  2.92s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9267, 'compress@10': 1.0, 'time@10': 4.1306}:  23%|██▎       | 7/30 [00:23<01:07,  2.92s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9267, 'compress@10': 1.0, 'time@10': 4.1306}:  27%|██▋       | 8/30 [00:23<01:07,  3.07s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9281, 'compress@10': 1.0, 'time@10': 4.0168}:  27%|██▋       | 8/30 [00:25<01:07,  3.07s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9281, 'compress@10': 1.0, 'time@10': 4.0168}:  30%|███       | 9/30 [00:25<00:54,  2.61s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9297, 'compress@10': 1.0, 'time@10': 3.9537}:  30%|███       | 9/30 [00:28<00:54,  2.61s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9297, 'compress@10': 1.0, 'time@10': 3.9537}:  33%|███▎      | 10/30 [00:28<00:57,  2.86s/it]{'epoch': 44, 'num_users': 6.6364, 'loss': 0.0215, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 3.8948}:  33%|███▎      | 10/30 [00:30<00:57,  2.86s/it]{'epoch': 44, 'num_users': 6.6364, 'loss': 0.0215, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 3.8948}:  37%|███▋      | 11/30 [00:30<00:47,  2.50s/it]{'epoch': 44, 'num_users': 6.4167, 'loss': 0.0198, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.9263, 'compress@10': 1.0, 'time@10': 3.8472}:  37%|███▋      | 11/30 [00:33<00:47,  2.50s/it]{'epoch': 44, 'num_users': 6.4167, 'loss': 0.0198, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.9263, 'compress@10': 1.0, 'time@10': 3.8472}:  40%|████      | 12/30 [00:33<00:49,  2.76s/it]{'epoch': 44, 'num_users': 6.6154, 'loss': 0.0206, 'hit_ratio@10': 0.854, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 3.8063}:  40%|████      | 12/30 [00:35<00:49,  2.76s/it] {'epoch': 44, 'num_users': 6.6154, 'loss': 0.0206, 'hit_ratio@10': 0.854, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 3.8063}:  43%|████▎     | 13/30 [00:35<00:41,  2.44s/it]{'epoch': 44, 'num_users': 6.3571, 'loss': 0.0191, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.7728}:  43%|████▎     | 13/30 [00:38<00:41,  2.44s/it]{'epoch': 44, 'num_users': 6.3571, 'loss': 0.0191, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.7728}:  47%|████▋     | 14/30 [00:38<00:43,  2.72s/it]{'epoch': 44, 'num_users': 6.2667, 'loss': 0.0201, 'hit_ratio@10': 0.838, 'ndcg@10': 0.9161, 'compress@10': 1.0, 'time@10': 3.7419}:  47%|████▋     | 14/30 [00:40<00:43,  2.72s/it] {'epoch': 44, 'num_users': 6.2667, 'loss': 0.0201, 'hit_ratio@10': 0.838, 'ndcg@10': 0.9161, 'compress@10': 1.0, 'time@10': 3.7419}:  50%|█████     | 15/30 [00:40<00:36,  2.41s/it]{'epoch': 44, 'num_users': 6.0625, 'loss': 0.0189, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.9161, 'compress@10': 1.0, 'time@10': 3.7192}:  50%|█████     | 15/30 [00:44<00:36,  2.41s/it]{'epoch': 44, 'num_users': 6.0625, 'loss': 0.0189, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.9161, 'compress@10': 1.0, 'time@10': 3.7192}:  53%|█████▎    | 16/30 [00:44<00:37,  2.71s/it]{'epoch': 44, 'num_users': 5.8235, 'loss': 0.0177, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.9093, 'compress@10': 1.0, 'time@10': 3.7107}:  53%|█████▎    | 16/30 [00:45<00:37,  2.71s/it]{'epoch': 44, 'num_users': 5.8235, 'loss': 0.0177, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.9093, 'compress@10': 1.0, 'time@10': 3.7107}:  57%|█████▋    | 17/30 [00:45<00:31,  2.45s/it]{'epoch': 44, 'num_users': 6.0556, 'loss': 0.0176, 'hit_ratio@10': 0.8255, 'ndcg@10': 0.9108, 'compress@10': 1.0, 'time@10': 3.6823}:  57%|█████▋    | 17/30 [00:49<00:31,  2.45s/it]{'epoch': 44, 'num_users': 6.0556, 'loss': 0.0176, 'hit_ratio@10': 0.8255, 'ndcg@10': 0.9108, 'compress@10': 1.0, 'time@10': 3.6823}:  60%|██████    | 18/30 [00:49<00:32,  2.68s/it]{'epoch': 44, 'num_users': 6.0, 'loss': 0.0169, 'hit_ratio@10': 0.831, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 3.6687}:  60%|██████    | 18/30 [00:50<00:32,  2.68s/it]    {'epoch': 44, 'num_users': 6.0, 'loss': 0.0169, 'hit_ratio@10': 0.831, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 3.6687}:  63%|██████▎   | 19/30 [00:50<00:26,  2.40s/it]{'epoch': 44, 'num_users': 6.15, 'loss': 0.0171, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.9121, 'compress@10': 1.0, 'time@10': 3.6606}:  63%|██████▎   | 19/30 [00:54<00:26,  2.40s/it]{'epoch': 44, 'num_users': 6.15, 'loss': 0.0171, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.9121, 'compress@10': 1.0, 'time@10': 3.6606}:  67%|██████▋   | 20/30 [00:54<00:27,  2.75s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.9094, 'compress@10': 1.0, 'time@10': 3.7966}:  67%|██████▋   | 20/30 [00:57<00:27,  2.75s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.9094, 'compress@10': 1.0, 'time@10': 3.7966}:  70%|███████   | 21/30 [00:57<00:26,  2.91s/it]{'epoch': 44, 'num_users': 6.1818, 'loss': 0.0178, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9113, 'compress@10': 1.0, 'time@10': 3.7835}:  70%|███████   | 21/30 [01:01<00:26,  2.91s/it]{'epoch': 44, 'num_users': 6.1818, 'loss': 0.0178, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9113, 'compress@10': 1.0, 'time@10': 3.7835}:  73%|███████▎  | 22/30 [01:01<00:24,  3.10s/it]{'epoch': 44, 'num_users': 6.1304, 'loss': 0.0176, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9123, 'compress@10': 1.0, 'time@10': 3.7817}:  73%|███████▎  | 22/30 [01:03<00:24,  3.10s/it]{'epoch': 44, 'num_users': 6.1304, 'loss': 0.0176, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9123, 'compress@10': 1.0, 'time@10': 3.7817}:  77%|███████▋  | 23/30 [01:03<00:19,  2.74s/it]{'epoch': 44, 'num_users': 5.9583, 'loss': 0.0169, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.9076, 'compress@10': 1.0, 'time@10': 3.7662}:  77%|███████▋  | 23/30 [01:06<00:19,  2.74s/it]{'epoch': 44, 'num_users': 5.9583, 'loss': 0.0169, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.9076, 'compress@10': 1.0, 'time@10': 3.7662}:  80%|████████  | 24/30 [01:06<00:17,  2.95s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 3.7551}:  80%|████████  | 24/30 [01:08<00:17,  2.95s/it]   {'epoch': 44, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 3.7551}:  83%|████████▎ | 25/30 [01:08<00:13,  2.60s/it]{'epoch': 44, 'num_users': 5.8077, 'loss': 0.0163, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.8469}:  83%|████████▎ | 25/30 [01:14<00:13,  2.60s/it]{'epoch': 44, 'num_users': 5.8077, 'loss': 0.0163, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.8469}:  87%|████████▋ | 26/30 [01:14<00:14,  3.68s/it]{'epoch': 44, 'num_users': 5.8889, 'loss': 0.0162, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9008, 'compress@10': 1.0, 'time@10': 3.8273}:  87%|████████▋ | 26/30 [01:16<00:14,  3.68s/it]{'epoch': 44, 'num_users': 5.8889, 'loss': 0.0162, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9008, 'compress@10': 1.0, 'time@10': 3.8273}:  90%|█████████ | 27/30 [01:16<00:09,  3.08s/it]{'epoch': 44, 'num_users': 6.0, 'loss': 0.0162, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 3.804}:  90%|█████████ | 27/30 [01:19<00:09,  3.08s/it]    {'epoch': 44, 'num_users': 6.0, 'loss': 0.0162, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 3.804}:  93%|█████████▎| 28/30 [01:19<00:06,  3.12s/it]{'epoch': 44, 'num_users': 5.8621, 'loss': 0.0159, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.9033, 'compress@10': 1.0, 'time@10': 3.7838}:  93%|█████████▎| 28/30 [01:21<00:06,  3.12s/it]{'epoch': 44, 'num_users': 5.8621, 'loss': 0.0159, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.9033, 'compress@10': 1.0, 'time@10': 3.7838}:  97%|█████████▋| 29/30 [01:21<00:02,  2.68s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0167, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.9062, 'compress@10': 1.0, 'time@10': 3.7717}:  97%|█████████▋| 29/30 [01:24<00:02,  2.68s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0167, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.9062, 'compress@10': 1.0, 'time@10': 3.7717}: 100%|██████████| 30/30 [01:24<00:00,  2.91s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0167, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.9062, 'compress@10': 1.0, 'time@10': 3.7717}: 100%|██████████| 30/30 [01:24<00:00,  2.82s/it]
Epoch: 44
Avg # of users: 5.866666666666666
Avg Loss: 0.01669415880107366
Avg hit ratio: 0.853263087323745
Avg ndcg: 0.9061886611891059
Avg compression ratio: 0.9999999860153537
Avg train time: 3.7717291275660196
Std train time: 1.054335238363123
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 33, 15, 1, 8, 8, 12, 6, 9, 7, 37, 9, 79, 7, 37, 50, 14, 15, 7, 1, 19, 10, 101, 99, 1, 7, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8829, 'compress@10': 1.0, 'time@10': 3.6976}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8829, 'compress@10': 1.0, 'time@10': 3.6976}:   3%|▎         | 1/30 [00:01<00:54,  1.89s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.929, 'compress@10': 1.0, 'time@10': 3.6357}:   3%|▎         | 1/30 [00:05<00:54,  1.89s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.929, 'compress@10': 1.0, 'time@10': 3.6357}:   7%|▋         | 2/30 [00:05<01:21,  2.90s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 3.5654}:   7%|▋         | 2/30 [00:07<01:21,  2.90s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 3.5654}:  10%|█         | 3/30 [00:07<01:04,  2.38s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 3.567}:  10%|█         | 3/30 [00:10<01:04,  2.38s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 3.567}:  13%|█▎        | 4/30 [00:10<01:14,  2.87s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0434, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 3.022}:  13%|█▎        | 4/30 [00:11<01:14,  2.87s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0434, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 3.022}:  17%|█▋        | 5/30 [00:11<00:49,  2.00s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0386, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 3.0665}:  17%|█▋        | 5/30 [00:14<00:49,  2.00s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0386, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 3.0665}:  20%|██        | 6/30 [00:14<00:58,  2.45s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0358, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8728, 'compress@10': 1.0, 'time@10': 3.1142}:  20%|██        | 6/30 [00:16<00:58,  2.45s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0358, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8728, 'compress@10': 1.0, 'time@10': 3.1142}:  23%|██▎       | 7/30 [00:16<00:50,  2.22s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0352, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8908, 'compress@10': 1.0, 'time@10': 3.1885}:  23%|██▎       | 7/30 [00:20<00:50,  2.22s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0352, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8908, 'compress@10': 1.0, 'time@10': 3.1885}:  27%|██▋       | 8/30 [00:20<00:59,  2.71s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0336, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8948, 'compress@10': 1.0, 'time@10': 3.2539}:  27%|██▋       | 8/30 [00:22<00:59,  2.71s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0336, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8948, 'compress@10': 1.0, 'time@10': 3.2539}:  30%|███       | 9/30 [00:22<00:51,  2.46s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0315, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9023, 'compress@10': 1.0, 'time@10': 3.237}:  30%|███       | 9/30 [00:25<00:51,  2.46s/it]    {'epoch': 45, 'num_users': 6.3, 'loss': 0.0315, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9023, 'compress@10': 1.0, 'time@10': 3.237}:  33%|███▎      | 10/30 [00:25<00:53,  2.67s/it]{'epoch': 45, 'num_users': 6.6364, 'loss': 0.0316, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9021, 'compress@10': 1.0, 'time@10': 3.2102}:  33%|███▎      | 10/30 [00:26<00:53,  2.67s/it]{'epoch': 45, 'num_users': 6.6364, 'loss': 0.0316, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9021, 'compress@10': 1.0, 'time@10': 3.2102}:  37%|███▋      | 11/30 [00:26<00:43,  2.31s/it]{'epoch': 45, 'num_users': 6.4167, 'loss': 0.0292, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.9033, 'compress@10': 1.0, 'time@10': 3.2372}:  37%|███▋      | 11/30 [00:30<00:43,  2.31s/it]{'epoch': 45, 'num_users': 6.4167, 'loss': 0.0292, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.9033, 'compress@10': 1.0, 'time@10': 3.2372}:  40%|████      | 12/30 [00:30<00:48,  2.70s/it]{'epoch': 45, 'num_users': 6.6154, 'loss': 0.0288, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 3.2609}:  40%|████      | 12/30 [00:32<00:48,  2.70s/it]{'epoch': 45, 'num_users': 6.6154, 'loss': 0.0288, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 3.2609}:  43%|████▎     | 13/30 [00:32<00:41,  2.43s/it]{'epoch': 45, 'num_users': 6.3571, 'loss': 0.0267, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.2749}:  43%|████▎     | 13/30 [00:35<00:41,  2.43s/it]{'epoch': 45, 'num_users': 6.3571, 'loss': 0.0267, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.2749}:  47%|████▋     | 14/30 [00:35<00:44,  2.75s/it]{'epoch': 45, 'num_users': 6.2667, 'loss': 0.0269, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8981, 'compress@10': 1.0, 'time@10': 3.2757}:  47%|████▋     | 14/30 [00:37<00:44,  2.75s/it]{'epoch': 45, 'num_users': 6.2667, 'loss': 0.0269, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8981, 'compress@10': 1.0, 'time@10': 3.2757}:  50%|█████     | 15/30 [00:37<00:36,  2.43s/it]{'epoch': 45, 'num_users': 6.0625, 'loss': 0.0252, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8993, 'compress@10': 1.0, 'time@10': 3.2888}:  50%|█████     | 15/30 [00:40<00:36,  2.43s/it]{'epoch': 45, 'num_users': 6.0625, 'loss': 0.0252, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8993, 'compress@10': 1.0, 'time@10': 3.2888}:  53%|█████▎    | 16/30 [00:40<00:38,  2.76s/it]{'epoch': 45, 'num_users': 5.8235, 'loss': 0.0237, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8934, 'compress@10': 1.0, 'time@10': 3.3016}:  53%|█████▎    | 16/30 [00:42<00:38,  2.76s/it]{'epoch': 45, 'num_users': 5.8235, 'loss': 0.0237, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8934, 'compress@10': 1.0, 'time@10': 3.3016}:  57%|█████▋    | 17/30 [00:42<00:32,  2.47s/it]{'epoch': 45, 'num_users': 6.0556, 'loss': 0.0232, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 3.3095}:  57%|█████▋    | 17/30 [00:46<00:32,  2.47s/it] {'epoch': 45, 'num_users': 6.0556, 'loss': 0.0232, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 3.3095}:  60%|██████    | 18/30 [00:46<00:33,  2.77s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 0.0222, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8976, 'compress@10': 1.0, 'time@10': 3.3081}:  60%|██████    | 18/30 [00:47<00:33,  2.77s/it]  {'epoch': 45, 'num_users': 6.0, 'loss': 0.0222, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8976, 'compress@10': 1.0, 'time@10': 3.3081}:  63%|██████▎   | 19/30 [00:47<00:26,  2.45s/it]{'epoch': 45, 'num_users': 6.15, 'loss': 0.0221, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8989, 'compress@10': 1.0, 'time@10': 3.3065}:  63%|██████▎   | 19/30 [00:51<00:26,  2.45s/it]{'epoch': 45, 'num_users': 6.15, 'loss': 0.0221, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8989, 'compress@10': 1.0, 'time@10': 3.3065}:  67%|██████▋   | 20/30 [00:51<00:27,  2.72s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0288, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8875, 'compress@10': 1.0, 'time@10': 3.185}:  67%|██████▋   | 20/30 [00:51<00:27,  2.72s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0288, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8875, 'compress@10': 1.0, 'time@10': 3.185}:  70%|███████   | 21/30 [00:51<00:18,  2.03s/it]{'epoch': 45, 'num_users': 6.1818, 'loss': 0.0277, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8904, 'compress@10': 1.0, 'time@10': 3.1797}:  70%|███████   | 21/30 [00:54<00:18,  2.03s/it]{'epoch': 45, 'num_users': 6.1818, 'loss': 0.0277, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8904, 'compress@10': 1.0, 'time@10': 3.1797}:  73%|███████▎  | 22/30 [00:54<00:18,  2.35s/it]{'epoch': 45, 'num_users': 6.1304, 'loss': 0.027, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 3.1757}:  73%|███████▎  | 22/30 [00:56<00:18,  2.35s/it] {'epoch': 45, 'num_users': 6.1304, 'loss': 0.027, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 3.1757}:  77%|███████▋  | 23/30 [00:56<00:14,  2.12s/it]{'epoch': 45, 'num_users': 5.9583, 'loss': 0.0258, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 3.1815}:  77%|███████▋  | 23/30 [00:59<00:14,  2.12s/it]{'epoch': 45, 'num_users': 5.9583, 'loss': 0.0258, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 3.1815}:  80%|████████  | 24/30 [00:59<00:14,  2.49s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8798, 'compress@10': 1.0, 'time@10': 3.1782}:  80%|████████  | 24/30 [01:01<00:14,  2.49s/it]   {'epoch': 45, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8798, 'compress@10': 1.0, 'time@10': 3.1782}:  83%|████████▎ | 25/30 [01:01<00:11,  2.22s/it]{'epoch': 45, 'num_users': 5.8077, 'loss': 0.0276, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 3.0796}:  83%|████████▎ | 25/30 [01:01<00:11,  2.22s/it]{'epoch': 45, 'num_users': 5.8077, 'loss': 0.0276, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 3.0796}:  87%|████████▋ | 26/30 [01:01<00:06,  1.75s/it]{'epoch': 45, 'num_users': 5.8889, 'loss': 0.0271, 'hit_ratio@10': 0.832, 'ndcg@10': 0.876, 'compress@10': 1.0, 'time@10': 3.081}:  87%|████████▋ | 26/30 [01:03<00:06,  1.75s/it]   {'epoch': 45, 'num_users': 5.8889, 'loss': 0.0271, 'hit_ratio@10': 0.832, 'ndcg@10': 0.876, 'compress@10': 1.0, 'time@10': 3.081}:  90%|█████████ | 27/30 [01:03<00:05,  1.70s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 0.0267, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8786, 'compress@10': 1.0, 'time@10': 3.0946}:  90%|█████████ | 27/30 [01:06<00:05,  1.70s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 0.0267, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8786, 'compress@10': 1.0, 'time@10': 3.0946}:  93%|█████████▎| 28/30 [01:06<00:04,  2.25s/it]{'epoch': 45, 'num_users': 5.8621, 'loss': 0.026, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8808, 'compress@10': 1.0, 'time@10': 3.1124}:  93%|█████████▎| 28/30 [01:08<00:04,  2.25s/it]{'epoch': 45, 'num_users': 5.8621, 'loss': 0.026, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8808, 'compress@10': 1.0, 'time@10': 3.1124}:  97%|█████████▋| 29/30 [01:08<00:02,  2.12s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.0262, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 3.1199}:  97%|█████████▋| 29/30 [01:12<00:02,  2.12s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.0262, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 3.1199}: 100%|██████████| 30/30 [01:12<00:00,  2.50s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.0262, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 3.1199}: 100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch: 45
Avg # of users: 5.866666666666666
Avg Loss: 0.02624574489615751
Avg hit ratio: 0.8419967801722426
Avg ndcg: 0.8830786159021989
Avg compression ratio: 0.9999999860166272
Avg train time: 3.1198800802230835
Std train time: 0.8203987216117976
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 33, 15, 9, 8, 8, 11, 5, 10, 8, 37, 9, 79, 7, 37, 50, 14, 15, 7, 9, 20, 11, 101, 100, 9, 8, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 2.9147}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 2.9147}:   3%|▎         | 1/30 [00:01<00:43,  1.50s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9725, 'compress@10': 1.0, 'time@10': 3.0353}:   3%|▎         | 1/30 [00:04<00:43,  1.50s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9725, 'compress@10': 1.0, 'time@10': 3.0353}:   7%|▋         | 2/30 [00:04<01:09,  2.50s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9341, 'compress@10': 1.0, 'time@10': 3.1041}:   7%|▋         | 2/30 [00:06<01:09,  2.50s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9341, 'compress@10': 1.0, 'time@10': 3.1041}:  10%|█         | 3/30 [00:06<00:57,  2.11s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9496, 'compress@10': 1.0, 'time@10': 3.1371}:  10%|█         | 3/30 [00:09<00:57,  2.11s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9496, 'compress@10': 1.0, 'time@10': 3.1371}:  13%|█▎        | 4/30 [00:09<01:06,  2.57s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0237, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9347, 'compress@10': 1.0, 'time@10': 3.9967}:  13%|█▎        | 4/30 [00:13<01:06,  2.57s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0237, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9347, 'compress@10': 1.0, 'time@10': 3.9967}:  17%|█▋        | 5/30 [00:13<01:14,  3.00s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0222, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9348, 'compress@10': 1.0, 'time@10': 3.8248}:  17%|█▋        | 5/30 [00:16<01:14,  3.00s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0222, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9348, 'compress@10': 1.0, 'time@10': 3.8248}:  20%|██        | 6/30 [00:16<01:11,  3.00s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0223, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9307, 'compress@10': 1.0, 'time@10': 3.7419}:  20%|██        | 6/30 [00:18<01:11,  3.00s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0223, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9307, 'compress@10': 1.0, 'time@10': 3.7419}:  23%|██▎       | 7/30 [00:18<00:58,  2.56s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0221, 'hit_ratio@10': 0.906, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 3.665}:  23%|██▎       | 7/30 [00:21<00:58,  2.56s/it]    {'epoch': 46, 'num_users': 6.125, 'loss': 0.0221, 'hit_ratio@10': 0.906, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 3.665}:  27%|██▋       | 8/30 [00:21<01:00,  2.76s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0222, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9267, 'compress@10': 1.0, 'time@10': 3.5675}:  27%|██▋       | 8/30 [00:22<01:00,  2.76s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0222, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9267, 'compress@10': 1.0, 'time@10': 3.5675}:  30%|███       | 9/30 [00:22<00:49,  2.34s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9305, 'compress@10': 1.0, 'time@10': 3.5719}:  30%|███       | 9/30 [00:26<00:49,  2.34s/it]    {'epoch': 46, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9305, 'compress@10': 1.0, 'time@10': 3.5719}:  33%|███▎      | 10/30 [00:26<00:54,  2.74s/it]{'epoch': 46, 'num_users': 6.6364, 'loss': 0.0233, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9282, 'compress@10': 1.0, 'time@10': 3.5696}:  33%|███▎      | 10/30 [00:28<00:54,  2.74s/it]{'epoch': 46, 'num_users': 6.6364, 'loss': 0.0233, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9282, 'compress@10': 1.0, 'time@10': 3.5696}:  37%|███▋      | 11/30 [00:28<00:46,  2.46s/it]{'epoch': 46, 'num_users': 6.4167, 'loss': 0.0216, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 3.5481}:  37%|███▋      | 11/30 [00:31<00:46,  2.46s/it]{'epoch': 46, 'num_users': 6.4167, 'loss': 0.0216, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 3.5481}:  40%|████      | 12/30 [00:31<00:49,  2.73s/it]{'epoch': 46, 'num_users': 6.6154, 'loss': 0.0221, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 3.5219}:  40%|████      | 12/30 [00:33<00:49,  2.73s/it] {'epoch': 46, 'num_users': 6.6154, 'loss': 0.0221, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 3.5219}:  43%|████▎     | 13/30 [00:33<00:40,  2.40s/it]{'epoch': 46, 'num_users': 6.3571, 'loss': 0.0205, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.9185, 'compress@10': 1.0, 'time@10': 3.5124}:  43%|████▎     | 13/30 [00:36<00:40,  2.40s/it]{'epoch': 46, 'num_users': 6.3571, 'loss': 0.0205, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.9185, 'compress@10': 1.0, 'time@10': 3.5124}:  47%|████▋     | 14/30 [00:36<00:43,  2.71s/it]{'epoch': 46, 'num_users': 6.2667, 'loss': 0.0207, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.5074}:  47%|████▋     | 14/30 [00:38<00:43,  2.71s/it]{'epoch': 46, 'num_users': 6.2667, 'loss': 0.0207, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.5074}:  50%|█████     | 15/30 [00:38<00:36,  2.43s/it]{'epoch': 46, 'num_users': 6.0625, 'loss': 0.0195, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9172, 'compress@10': 1.0, 'time@10': 3.4983}:  50%|█████     | 15/30 [00:41<00:36,  2.43s/it]{'epoch': 46, 'num_users': 6.0625, 'loss': 0.0195, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9172, 'compress@10': 1.0, 'time@10': 3.4983}:  53%|█████▎    | 16/30 [00:41<00:38,  2.72s/it]{'epoch': 46, 'num_users': 5.8235, 'loss': 0.0183, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9104, 'compress@10': 1.0, 'time@10': 3.4918}:  53%|█████▎    | 16/30 [00:43<00:38,  2.72s/it]{'epoch': 46, 'num_users': 5.8235, 'loss': 0.0183, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9104, 'compress@10': 1.0, 'time@10': 3.4918}:  57%|█████▋    | 17/30 [00:43<00:31,  2.43s/it]{'epoch': 46, 'num_users': 6.0556, 'loss': 0.0186, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.9125, 'compress@10': 1.0, 'time@10': 3.4722}:  57%|█████▋    | 17/30 [00:46<00:31,  2.43s/it]{'epoch': 46, 'num_users': 6.0556, 'loss': 0.0186, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.9125, 'compress@10': 1.0, 'time@10': 3.4722}:  60%|██████    | 18/30 [00:46<00:31,  2.66s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 0.0179, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.9134, 'compress@10': 1.0, 'time@10': 3.4532}:  60%|██████    | 18/30 [00:48<00:31,  2.66s/it]   {'epoch': 46, 'num_users': 6.0, 'loss': 0.0179, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.9134, 'compress@10': 1.0, 'time@10': 3.4532}:  63%|██████▎   | 19/30 [00:48<00:25,  2.34s/it]{'epoch': 46, 'num_users': 6.15, 'loss': 0.0179, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.914, 'compress@10': 1.0, 'time@10': 3.4482}:  63%|██████▎   | 19/30 [00:51<00:25,  2.34s/it]{'epoch': 46, 'num_users': 6.15, 'loss': 0.0179, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.914, 'compress@10': 1.0, 'time@10': 3.4482}:  67%|██████▋   | 20/30 [00:51<00:26,  2.65s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9118, 'compress@10': 1.0, 'time@10': 3.5777}:  67%|██████▋   | 20/30 [00:54<00:26,  2.65s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9118, 'compress@10': 1.0, 'time@10': 3.5777}:  70%|███████   | 21/30 [00:54<00:25,  2.79s/it]{'epoch': 46, 'num_users': 6.1818, 'loss': 0.0184, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.9135, 'compress@10': 1.0, 'time@10': 3.5694}:  70%|███████   | 21/30 [00:58<00:25,  2.79s/it]{'epoch': 46, 'num_users': 6.1818, 'loss': 0.0184, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.9135, 'compress@10': 1.0, 'time@10': 3.5694}:  73%|███████▎  | 22/30 [00:58<00:23,  2.99s/it]{'epoch': 46, 'num_users': 6.1304, 'loss': 0.0182, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 3.5479}:  73%|███████▎  | 22/30 [00:59<00:23,  2.99s/it]{'epoch': 46, 'num_users': 6.1304, 'loss': 0.0182, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 3.5479}:  77%|███████▋  | 23/30 [00:59<00:17,  2.56s/it]{'epoch': 46, 'num_users': 5.9583, 'loss': 0.0174, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 3.5328}:  77%|███████▋  | 23/30 [01:02<00:17,  2.56s/it]{'epoch': 46, 'num_users': 5.9583, 'loss': 0.0174, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 3.5328}:  80%|████████  | 24/30 [01:02<00:16,  2.76s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.5184}:  80%|████████  | 24/30 [01:04<00:16,  2.76s/it]   {'epoch': 46, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.5184}:  83%|████████▎ | 25/30 [01:04<00:12,  2.42s/it]{'epoch': 46, 'num_users': 5.8077, 'loss': 0.0167, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 3.6057}:  83%|████████▎ | 25/30 [01:10<00:12,  2.42s/it]{'epoch': 46, 'num_users': 5.8077, 'loss': 0.0167, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 3.6057}:  87%|████████▋ | 26/30 [01:10<00:13,  3.44s/it]{'epoch': 46, 'num_users': 5.8889, 'loss': 0.0166, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9022, 'compress@10': 1.0, 'time@10': 3.5971}:  87%|████████▋ | 26/30 [01:12<00:13,  3.44s/it]{'epoch': 46, 'num_users': 5.8889, 'loss': 0.0166, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9022, 'compress@10': 1.0, 'time@10': 3.5971}:  90%|█████████ | 27/30 [01:12<00:08,  2.93s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 0.0167, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.9039, 'compress@10': 1.0, 'time@10': 3.5845}:  90%|█████████ | 27/30 [01:15<00:08,  2.93s/it]   {'epoch': 46, 'num_users': 6.0, 'loss': 0.0167, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.9039, 'compress@10': 1.0, 'time@10': 3.5845}:  93%|█████████▎| 28/30 [01:15<00:06,  3.04s/it]{'epoch': 46, 'num_users': 5.8621, 'loss': 0.0168, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 3.5663}:  93%|█████████▎| 28/30 [01:17<00:06,  3.04s/it]{'epoch': 46, 'num_users': 5.8621, 'loss': 0.0168, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 3.5663}:  97%|█████████▋| 29/30 [01:17<00:02,  2.60s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.0173, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9075, 'compress@10': 1.0, 'time@10': 3.554}:  97%|█████████▋| 29/30 [01:20<00:02,  2.60s/it] {'epoch': 46, 'num_users': 5.8667, 'loss': 0.0173, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9075, 'compress@10': 1.0, 'time@10': 3.554}: 100%|██████████| 30/30 [01:20<00:00,  2.79s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.0173, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9075, 'compress@10': 1.0, 'time@10': 3.554}: 100%|██████████| 30/30 [01:20<00:00,  2.68s/it]
Epoch: 46
Avg # of users: 5.866666666666666
Avg Loss: 0.017320709716955977
Avg hit ratio: 0.8588726789215946
Avg ndcg: 0.9075239216891534
Avg compression ratio: 0.9999999860153537
Avg train time: 3.553993995984395
Std train time: 1.0098489982669843
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 14, 34, 16, 1, 9, 9, 12, 7, 9, 8, 37, 10, 79, 7, 37, 50, 15, 16, 7, 1, 20, 12, 102, 101, 2, 8, 9, 11, 12]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0278, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 3.846}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0278, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 3.846}:   3%|▎         | 1/30 [00:01<00:57,  1.97s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9269, 'compress@10': 1.0, 'time@10': 3.6866}:   3%|▎         | 1/30 [00:05<00:57,  1.97s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9269, 'compress@10': 1.0, 'time@10': 3.6866}:   7%|▋         | 2/30 [00:05<01:21,  2.91s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9036, 'compress@10': 1.0, 'time@10': 3.5443}:   7%|▋         | 2/30 [00:07<01:21,  2.91s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9036, 'compress@10': 1.0, 'time@10': 3.5443}:  10%|█         | 3/30 [00:07<01:03,  2.35s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 3.5634}:  10%|█         | 3/30 [00:10<01:03,  2.35s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 3.5634}:  13%|█▎        | 4/30 [00:10<01:14,  2.87s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0424, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8553, 'compress@10': 1.0, 'time@10': 3.0132}:  13%|█▎        | 4/30 [00:11<01:14,  2.87s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0424, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8553, 'compress@10': 1.0, 'time@10': 3.0132}:  17%|█▋        | 5/30 [00:11<00:49,  2.00s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0386, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8693, 'compress@10': 1.0, 'time@10': 3.0777}:  17%|█▋        | 5/30 [00:14<00:49,  2.00s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0386, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8693, 'compress@10': 1.0, 'time@10': 3.0777}:  20%|██        | 6/30 [00:14<00:59,  2.49s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0371, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.8782, 'compress@10': 1.0, 'time@10': 3.1664}:  20%|██        | 6/30 [00:16<00:59,  2.49s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0371, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.8782, 'compress@10': 1.0, 'time@10': 3.1664}:  23%|██▎       | 7/30 [00:16<00:52,  2.29s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0334, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.8886, 'compress@10': 1.0, 'time@10': 3.1923}:  23%|██▎       | 7/30 [00:20<00:52,  2.29s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0334, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.8886, 'compress@10': 1.0, 'time@10': 3.1923}:  27%|██▋       | 8/30 [00:20<00:58,  2.65s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0326, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 3.2813}:  27%|██▋       | 8/30 [00:22<00:58,  2.65s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0326, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 3.2813}:  30%|███       | 9/30 [00:22<00:51,  2.46s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0299, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 3.2733}:  30%|███       | 9/30 [00:25<00:51,  2.46s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0299, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 3.2733}:  33%|███▎      | 10/30 [00:25<00:53,  2.70s/it]{'epoch': 47, 'num_users': 6.6364, 'loss': 0.0298, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 3.2836}:  33%|███▎      | 10/30 [00:27<00:53,  2.70s/it]{'epoch': 47, 'num_users': 6.6364, 'loss': 0.0298, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 3.2836}:  37%|███▋      | 11/30 [00:27<00:45,  2.40s/it]{'epoch': 47, 'num_users': 6.4167, 'loss': 0.0275, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 3.2887}:  37%|███▋      | 11/30 [00:30<00:45,  2.40s/it]{'epoch': 47, 'num_users': 6.4167, 'loss': 0.0275, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 3.2887}:  40%|████      | 12/30 [00:30<00:48,  2.70s/it]{'epoch': 47, 'num_users': 6.6154, 'loss': 0.0274, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9029, 'compress@10': 1.0, 'time@10': 3.3045}:  40%|████      | 12/30 [00:32<00:48,  2.70s/it]{'epoch': 47, 'num_users': 6.6154, 'loss': 0.0274, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9029, 'compress@10': 1.0, 'time@10': 3.3045}:  43%|████▎     | 13/30 [00:32<00:41,  2.42s/it]{'epoch': 47, 'num_users': 6.3571, 'loss': 0.0254, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 3.3008}:  43%|████▎     | 13/30 [00:35<00:41,  2.42s/it]{'epoch': 47, 'num_users': 6.3571, 'loss': 0.0254, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 3.3008}:  47%|████▋     | 14/30 [00:35<00:42,  2.69s/it]{'epoch': 47, 'num_users': 6.2667, 'loss': 0.0257, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.8976, 'compress@10': 1.0, 'time@10': 3.3078}:  47%|████▋     | 14/30 [00:37<00:42,  2.69s/it]{'epoch': 47, 'num_users': 6.2667, 'loss': 0.0257, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.8976, 'compress@10': 1.0, 'time@10': 3.3078}:  50%|█████     | 15/30 [00:37<00:36,  2.40s/it]{'epoch': 47, 'num_users': 6.0625, 'loss': 0.0241, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8987, 'compress@10': 1.0, 'time@10': 3.3117}:  50%|█████     | 15/30 [00:40<00:36,  2.40s/it]{'epoch': 47, 'num_users': 6.0625, 'loss': 0.0241, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8987, 'compress@10': 1.0, 'time@10': 3.3117}:  53%|█████▎    | 16/30 [00:40<00:37,  2.71s/it]{'epoch': 47, 'num_users': 5.8235, 'loss': 0.0227, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8929, 'compress@10': 1.0, 'time@10': 3.3027}:  53%|█████▎    | 16/30 [00:42<00:37,  2.71s/it]{'epoch': 47, 'num_users': 5.8235, 'loss': 0.0227, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8929, 'compress@10': 1.0, 'time@10': 3.3027}:  57%|█████▋    | 17/30 [00:42<00:30,  2.38s/it]{'epoch': 47, 'num_users': 6.0556, 'loss': 0.0224, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8974, 'compress@10': 1.0, 'time@10': 3.3188}:  57%|█████▋    | 17/30 [00:45<00:30,  2.38s/it]{'epoch': 47, 'num_users': 6.0556, 'loss': 0.0224, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8974, 'compress@10': 1.0, 'time@10': 3.3188}:  60%|██████    | 18/30 [00:45<00:33,  2.75s/it]{'epoch': 47, 'num_users': 6.0, 'loss': 0.0213, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 3.3322}:  60%|██████    | 18/30 [00:47<00:33,  2.75s/it]   {'epoch': 47, 'num_users': 6.0, 'loss': 0.0213, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 3.3322}:  63%|██████▎   | 19/30 [00:47<00:27,  2.47s/it]{'epoch': 47, 'num_users': 6.15, 'loss': 0.0212, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.9006, 'compress@10': 1.0, 'time@10': 3.3378}:  63%|██████▎   | 19/30 [00:51<00:27,  2.47s/it]{'epoch': 47, 'num_users': 6.15, 'loss': 0.0212, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.9006, 'compress@10': 1.0, 'time@10': 3.3378}:  67%|██████▋   | 20/30 [00:51<00:27,  2.78s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0279, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8894, 'compress@10': 1.0, 'time@10': 3.2118}:  67%|██████▋   | 20/30 [00:51<00:27,  2.78s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0279, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8894, 'compress@10': 1.0, 'time@10': 3.2118}:  70%|███████   | 21/30 [00:51<00:18,  2.06s/it]{'epoch': 47, 'num_users': 6.1818, 'loss': 0.0269, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.2203}:  70%|███████   | 21/30 [00:55<00:18,  2.06s/it]{'epoch': 47, 'num_users': 6.1818, 'loss': 0.0269, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.2203}:  73%|███████▎  | 22/30 [00:55<00:19,  2.47s/it]{'epoch': 47, 'num_users': 6.1304, 'loss': 0.0261, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 3.2384}:  73%|███████▎  | 22/30 [00:56<00:19,  2.47s/it]{'epoch': 47, 'num_users': 6.1304, 'loss': 0.0261, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 3.2384}:  77%|███████▋  | 23/30 [00:56<00:16,  2.29s/it]{'epoch': 47, 'num_users': 5.9583, 'loss': 0.0251, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8897, 'compress@10': 1.0, 'time@10': 3.2274}:  77%|███████▋  | 23/30 [00:59<00:16,  2.29s/it]{'epoch': 47, 'num_users': 5.9583, 'loss': 0.0251, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8897, 'compress@10': 1.0, 'time@10': 3.2274}:  80%|████████  | 24/30 [00:59<00:15,  2.51s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0241, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8808, 'compress@10': 1.0, 'time@10': 3.2247}:  80%|████████  | 24/30 [01:01<00:15,  2.51s/it]   {'epoch': 47, 'num_users': 5.8, 'loss': 0.0241, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8808, 'compress@10': 1.0, 'time@10': 3.2247}:  83%|████████▎ | 25/30 [01:01<00:11,  2.24s/it]{'epoch': 47, 'num_users': 5.8077, 'loss': 0.0249, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8804, 'compress@10': 1.0, 'time@10': 3.1533}:  83%|████████▎ | 25/30 [01:02<00:11,  2.24s/it]{'epoch': 47, 'num_users': 5.8077, 'loss': 0.0249, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8804, 'compress@10': 1.0, 'time@10': 3.1533}:  87%|████████▋ | 26/30 [01:02<00:07,  1.99s/it]{'epoch': 47, 'num_users': 5.8889, 'loss': 0.0244, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 3.1717}:  87%|████████▋ | 26/30 [01:04<00:07,  1.99s/it]{'epoch': 47, 'num_users': 5.8889, 'loss': 0.0244, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 3.1717}:  90%|█████████ | 27/30 [01:04<00:05,  1.95s/it]{'epoch': 47, 'num_users': 6.0, 'loss': 0.0244, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 3.1981}:  90%|█████████ | 27/30 [01:08<00:05,  1.95s/it]   {'epoch': 47, 'num_users': 6.0, 'loss': 0.0244, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 3.1981}:  93%|█████████▎| 28/30 [01:08<00:05,  2.55s/it]{'epoch': 47, 'num_users': 5.8621, 'loss': 0.0239, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 3.2099}:  93%|█████████▎| 28/30 [01:10<00:05,  2.55s/it]{'epoch': 47, 'num_users': 5.8621, 'loss': 0.0239, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 3.2099}:  97%|█████████▋| 29/30 [01:10<00:02,  2.33s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0245, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.893, 'compress@10': 1.0, 'time@10': 3.2206}:  97%|█████████▋| 29/30 [01:14<00:02,  2.33s/it] {'epoch': 47, 'num_users': 5.8667, 'loss': 0.0245, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.893, 'compress@10': 1.0, 'time@10': 3.2206}: 100%|██████████| 30/30 [01:14<00:00,  2.70s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0245, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.893, 'compress@10': 1.0, 'time@10': 3.2206}: 100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch: 47
Avg # of users: 5.866666666666666
Avg Loss: 0.024457197640112373
Avg hit ratio: 0.8517497676751876
Avg ndcg: 0.8929939098836047
Avg compression ratio: 0.9999999860166272
Avg train time: 3.2205830494562786
Std train time: 0.791015775483098
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 14, 35, 15, 9, 9, 8, 12, 5, 10, 8, 37, 10, 80, 7, 37, 51, 15, 16, 7, 9, 20, 11, 103, 102, 8, 7, 8, 11, 12]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8819, 'compress@10': 1.0, 'time@10': 3.2852}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8819, 'compress@10': 1.0, 'time@10': 3.2852}:   3%|▎         | 1/30 [00:01<00:48,  1.68s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9517, 'compress@10': 1.0, 'time@10': 3.2551}:   3%|▎         | 1/30 [00:04<00:48,  1.68s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9517, 'compress@10': 1.0, 'time@10': 3.2551}:   7%|▋         | 2/30 [00:04<01:13,  2.61s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9202, 'compress@10': 1.0, 'time@10': 3.1645}:   7%|▋         | 2/30 [00:06<01:13,  2.61s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9202, 'compress@10': 1.0, 'time@10': 3.1645}:  10%|█         | 3/30 [00:06<00:57,  2.12s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9322, 'compress@10': 1.0, 'time@10': 3.2006}:  10%|█         | 3/30 [00:09<00:57,  2.12s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9322, 'compress@10': 1.0, 'time@10': 3.2006}:  13%|█▎        | 4/30 [00:09<01:07,  2.60s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0217, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.921, 'compress@10': 1.0, 'time@10': 3.9383}:  13%|█▎        | 4/30 [00:13<01:07,  2.60s/it] {'epoch': 48, 'num_users': 5.8, 'loss': 0.0217, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.921, 'compress@10': 1.0, 'time@10': 3.9383}:  17%|█▋        | 5/30 [00:13<01:13,  2.92s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0215, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9255, 'compress@10': 1.0, 'time@10': 3.8411}:  17%|█▋        | 5/30 [00:16<01:13,  2.92s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0215, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9255, 'compress@10': 1.0, 'time@10': 3.8411}:  20%|██        | 6/30 [00:16<01:13,  3.08s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.781}:  20%|██        | 6/30 [00:18<01:13,  3.08s/it] {'epoch': 48, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.781}:  23%|██▎       | 7/30 [00:18<01:00,  2.65s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0221, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9164, 'compress@10': 1.0, 'time@10': 3.7434}:  23%|██▎       | 7/30 [00:21<01:00,  2.65s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0221, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9164, 'compress@10': 1.0, 'time@10': 3.7434}:  27%|██▋       | 8/30 [00:21<01:04,  2.92s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0218, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 3.6537}:  27%|██▋       | 8/30 [00:23<01:04,  2.92s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0218, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 3.6537}:  30%|███       | 9/30 [00:23<00:52,  2.48s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9225, 'compress@10': 1.0, 'time@10': 3.6399}:  30%|███       | 9/30 [00:27<00:52,  2.48s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9225, 'compress@10': 1.0, 'time@10': 3.6399}:  33%|███▎      | 10/30 [00:27<00:56,  2.81s/it]{'epoch': 48, 'num_users': 6.6364, 'loss': 0.0231, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9213, 'compress@10': 1.0, 'time@10': 3.6306}:  33%|███▎      | 10/30 [00:28<00:56,  2.81s/it]{'epoch': 48, 'num_users': 6.6364, 'loss': 0.0231, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9213, 'compress@10': 1.0, 'time@10': 3.6306}:  37%|███▋      | 11/30 [00:28<00:47,  2.50s/it]{'epoch': 48, 'num_users': 6.4167, 'loss': 0.0214, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9209, 'compress@10': 1.0, 'time@10': 3.6084}:  37%|███▋      | 11/30 [00:32<00:47,  2.50s/it]{'epoch': 48, 'num_users': 6.4167, 'loss': 0.0214, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9209, 'compress@10': 1.0, 'time@10': 3.6084}:  40%|████      | 12/30 [00:32<00:49,  2.78s/it]{'epoch': 48, 'num_users': 6.6154, 'loss': 0.0218, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 3.6086}:  40%|████      | 12/30 [00:34<00:49,  2.78s/it]{'epoch': 48, 'num_users': 6.6154, 'loss': 0.0218, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 3.6086}:  43%|████▎     | 13/30 [00:34<00:42,  2.49s/it]{'epoch': 48, 'num_users': 6.3571, 'loss': 0.0202, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9133, 'compress@10': 1.0, 'time@10': 3.5874}:  43%|████▎     | 13/30 [00:37<00:42,  2.49s/it]{'epoch': 48, 'num_users': 6.3571, 'loss': 0.0202, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9133, 'compress@10': 1.0, 'time@10': 3.5874}:  47%|████▋     | 14/30 [00:37<00:44,  2.75s/it]{'epoch': 48, 'num_users': 6.2667, 'loss': 0.0208, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.9127, 'compress@10': 1.0, 'time@10': 3.5766}:  47%|████▋     | 14/30 [00:39<00:44,  2.75s/it]{'epoch': 48, 'num_users': 6.2667, 'loss': 0.0208, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.9127, 'compress@10': 1.0, 'time@10': 3.5766}:  50%|█████     | 15/30 [00:39<00:36,  2.45s/it]{'epoch': 48, 'num_users': 6.0625, 'loss': 0.0195, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 3.5555}:  50%|█████     | 15/30 [00:42<00:36,  2.45s/it]{'epoch': 48, 'num_users': 6.0625, 'loss': 0.0195, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 3.5555}:  53%|█████▎    | 16/30 [00:42<00:37,  2.70s/it]{'epoch': 48, 'num_users': 5.8235, 'loss': 0.0184, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9063, 'compress@10': 1.0, 'time@10': 3.5395}:  53%|█████▎    | 16/30 [00:44<00:37,  2.70s/it]{'epoch': 48, 'num_users': 5.8235, 'loss': 0.0184, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9063, 'compress@10': 1.0, 'time@10': 3.5395}:  57%|█████▋    | 17/30 [00:44<00:31,  2.39s/it]{'epoch': 48, 'num_users': 6.0556, 'loss': 0.0177, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.909, 'compress@10': 1.0, 'time@10': 3.5414}:  57%|█████▋    | 17/30 [00:47<00:31,  2.39s/it] {'epoch': 48, 'num_users': 6.0556, 'loss': 0.0177, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.909, 'compress@10': 1.0, 'time@10': 3.5414}:  60%|██████    | 18/30 [00:47<00:33,  2.76s/it]{'epoch': 48, 'num_users': 6.0, 'loss': 0.017, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9101, 'compress@10': 1.0, 'time@10': 3.5372}:  60%|██████    | 18/30 [00:49<00:33,  2.76s/it]   {'epoch': 48, 'num_users': 6.0, 'loss': 0.017, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9101, 'compress@10': 1.0, 'time@10': 3.5372}:  63%|██████▎   | 19/30 [00:49<00:27,  2.46s/it]{'epoch': 48, 'num_users': 6.15, 'loss': 0.017, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9114, 'compress@10': 1.0, 'time@10': 3.5244}:  63%|██████▎   | 19/30 [00:52<00:27,  2.46s/it]{'epoch': 48, 'num_users': 6.15, 'loss': 0.017, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9114, 'compress@10': 1.0, 'time@10': 3.5244}:  67%|██████▋   | 20/30 [00:52<00:27,  2.72s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9095, 'compress@10': 1.0, 'time@10': 3.6466}:  67%|██████▋   | 20/30 [00:55<00:27,  2.72s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9095, 'compress@10': 1.0, 'time@10': 3.6466}:  70%|███████   | 21/30 [00:55<00:25,  2.83s/it]{'epoch': 48, 'num_users': 6.1818, 'loss': 0.0176, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.9113, 'compress@10': 1.0, 'time@10': 3.6332}:  70%|███████   | 21/30 [00:59<00:25,  2.83s/it]{'epoch': 48, 'num_users': 6.1818, 'loss': 0.0176, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.9113, 'compress@10': 1.0, 'time@10': 3.6332}:  73%|███████▎  | 22/30 [00:59<00:23,  3.00s/it]{'epoch': 48, 'num_users': 6.1304, 'loss': 0.0173, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9126, 'compress@10': 1.0, 'time@10': 3.6171}:  73%|███████▎  | 22/30 [01:00<00:23,  3.00s/it]{'epoch': 48, 'num_users': 6.1304, 'loss': 0.0173, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9126, 'compress@10': 1.0, 'time@10': 3.6171}:  77%|███████▋  | 23/30 [01:00<00:18,  2.60s/it]{'epoch': 48, 'num_users': 5.9583, 'loss': 0.0166, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9079, 'compress@10': 1.0, 'time@10': 3.5996}:  77%|███████▋  | 23/30 [01:04<00:18,  2.60s/it]{'epoch': 48, 'num_users': 5.9583, 'loss': 0.0166, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9079, 'compress@10': 1.0, 'time@10': 3.5996}:  80%|████████  | 24/30 [01:04<00:16,  2.79s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0159, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.5883}:  80%|████████  | 24/30 [01:05<00:16,  2.79s/it]   {'epoch': 48, 'num_users': 5.8, 'loss': 0.0159, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.5883}:  83%|████████▎ | 25/30 [01:05<00:12,  2.46s/it]{'epoch': 48, 'num_users': 5.8077, 'loss': 0.0158, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 3.657}:  83%|████████▎ | 25/30 [01:11<00:12,  2.46s/it]{'epoch': 48, 'num_users': 5.8077, 'loss': 0.0158, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 3.657}:  87%|████████▋ | 26/30 [01:11<00:13,  3.35s/it]{'epoch': 48, 'num_users': 5.8889, 'loss': 0.0157, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9014, 'compress@10': 1.0, 'time@10': 3.6462}:  87%|████████▋ | 26/30 [01:13<00:13,  3.35s/it]{'epoch': 48, 'num_users': 5.8889, 'loss': 0.0157, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9014, 'compress@10': 1.0, 'time@10': 3.6462}:  90%|█████████ | 27/30 [01:13<00:08,  2.86s/it]{'epoch': 48, 'num_users': 6.0, 'loss': 0.0155, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 3.6316}:  90%|█████████ | 27/30 [01:16<00:08,  2.86s/it]   {'epoch': 48, 'num_users': 6.0, 'loss': 0.0155, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 3.6316}:  93%|█████████▎| 28/30 [01:16<00:05,  2.98s/it]{'epoch': 48, 'num_users': 5.8621, 'loss': 0.0154, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.904, 'compress@10': 1.0, 'time@10': 3.6198}:  93%|█████████▎| 28/30 [01:18<00:05,  2.98s/it]{'epoch': 48, 'num_users': 5.8621, 'loss': 0.0154, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.904, 'compress@10': 1.0, 'time@10': 3.6198}:  97%|█████████▋| 29/30 [01:18<00:02,  2.59s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0161, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9122, 'compress@10': 1.0, 'time@10': 3.617}:  97%|█████████▋| 29/30 [01:21<00:02,  2.59s/it] {'epoch': 48, 'num_users': 5.8667, 'loss': 0.0161, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9122, 'compress@10': 1.0, 'time@10': 3.617}: 100%|██████████| 30/30 [01:21<00:00,  2.89s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0161, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9122, 'compress@10': 1.0, 'time@10': 3.617}: 100%|██████████| 30/30 [01:21<00:00,  2.72s/it]
Epoch: 48
Avg # of users: 5.866666666666666
Avg Loss: 0.01612666681297152
Avg hit ratio: 0.8639683292620196
Avg ndcg: 0.9121806750750181
Avg compression ratio: 0.9999999860153537
Avg train time: 3.617004672686259
Std train time: 0.8688160298814844
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 15, 36, 15, 1, 9, 8, 12, 6, 10, 8, 37, 9, 80, 7, 38, 51, 15, 16, 7, 1, 20, 12, 104, 102, 2, 7, 9, 11, 12]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 3.5201}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 3.5201}:   3%|▎         | 1/30 [00:01<00:52,  1.80s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9264, 'compress@10': 1.0, 'time@10': 3.5998}:   3%|▎         | 1/30 [00:05<00:52,  1.80s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9264, 'compress@10': 1.0, 'time@10': 3.5998}:   7%|▋         | 2/30 [00:05<01:21,  2.93s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9033, 'compress@10': 1.0, 'time@10': 3.5255}:   7%|▋         | 2/30 [00:07<01:21,  2.93s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9033, 'compress@10': 1.0, 'time@10': 3.5255}:  10%|█         | 3/30 [00:07<01:04,  2.38s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9121, 'compress@10': 1.0, 'time@10': 3.5006}:  10%|█         | 3/30 [00:10<01:04,  2.38s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9121, 'compress@10': 1.0, 'time@10': 3.5006}:  13%|█▎        | 4/30 [00:10<01:13,  2.81s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0423, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8513, 'compress@10': 1.0, 'time@10': 2.9785}:  13%|█▎        | 4/30 [00:11<01:13,  2.81s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0423, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8513, 'compress@10': 1.0, 'time@10': 2.9785}:  17%|█▋        | 5/30 [00:11<00:49,  1.97s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0374, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8686, 'compress@10': 1.0, 'time@10': 3.0351}:  17%|█▋        | 5/30 [00:14<00:49,  1.97s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0374, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8686, 'compress@10': 1.0, 'time@10': 3.0351}:  20%|██        | 6/30 [00:14<00:58,  2.44s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0346, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8748, 'compress@10': 1.0, 'time@10': 3.0402}:  20%|██        | 6/30 [00:16<00:58,  2.44s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0346, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8748, 'compress@10': 1.0, 'time@10': 3.0402}:  23%|██▎       | 7/30 [00:16<00:49,  2.16s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0313, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8859, 'compress@10': 1.0, 'time@10': 3.0404}:  23%|██▎       | 7/30 [00:19<00:49,  2.16s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0313, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8859, 'compress@10': 1.0, 'time@10': 3.0404}:  27%|██▋       | 8/30 [00:19<00:53,  2.45s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0299, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8907, 'compress@10': 1.0, 'time@10': 3.0849}:  27%|██▋       | 8/30 [00:20<00:53,  2.45s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0299, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8907, 'compress@10': 1.0, 'time@10': 3.0849}:  30%|███       | 9/30 [00:20<00:46,  2.24s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0278, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.8991, 'compress@10': 1.0, 'time@10': 3.1163}:  30%|███       | 9/30 [00:24<00:46,  2.24s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0278, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.8991, 'compress@10': 1.0, 'time@10': 3.1163}:  33%|███▎      | 10/30 [00:24<00:52,  2.61s/it]{'epoch': 49, 'num_users': 6.6364, 'loss': 0.0277, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8997, 'compress@10': 1.0, 'time@10': 3.1369}:  33%|███▎      | 10/30 [00:26<00:52,  2.61s/it]{'epoch': 49, 'num_users': 6.6364, 'loss': 0.0277, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8997, 'compress@10': 1.0, 'time@10': 3.1369}:  37%|███▋      | 11/30 [00:26<00:44,  2.34s/it]{'epoch': 49, 'num_users': 6.4167, 'loss': 0.0255, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.9012, 'compress@10': 1.0, 'time@10': 3.1558}:  37%|███▋      | 11/30 [00:29<00:44,  2.34s/it]{'epoch': 49, 'num_users': 6.4167, 'loss': 0.0255, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.9012, 'compress@10': 1.0, 'time@10': 3.1558}:  40%|████      | 12/30 [00:29<00:47,  2.66s/it]{'epoch': 49, 'num_users': 6.6154, 'loss': 0.0253, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.9014, 'compress@10': 1.0, 'time@10': 3.1585}:  40%|████      | 12/30 [00:31<00:47,  2.66s/it]{'epoch': 49, 'num_users': 6.6154, 'loss': 0.0253, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.9014, 'compress@10': 1.0, 'time@10': 3.1585}:  43%|████▎     | 13/30 [00:31<00:40,  2.35s/it]{'epoch': 49, 'num_users': 6.3571, 'loss': 0.0235, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8965, 'compress@10': 1.0, 'time@10': 3.1713}:  43%|████▎     | 13/30 [00:34<00:40,  2.35s/it]{'epoch': 49, 'num_users': 6.3571, 'loss': 0.0235, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8965, 'compress@10': 1.0, 'time@10': 3.1713}:  47%|████▋     | 14/30 [00:34<00:42,  2.66s/it]{'epoch': 49, 'num_users': 6.2667, 'loss': 0.0237, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.1931}:  47%|████▋     | 14/30 [00:36<00:42,  2.66s/it]{'epoch': 49, 'num_users': 6.2667, 'loss': 0.0237, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.1931}:  50%|█████     | 15/30 [00:36<00:36,  2.41s/it]{'epoch': 49, 'num_users': 6.0625, 'loss': 0.0222, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.2075}:  50%|█████     | 15/30 [00:39<00:36,  2.41s/it]{'epoch': 49, 'num_users': 6.0625, 'loss': 0.0222, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.2075}:  53%|█████▎    | 16/30 [00:39<00:38,  2.72s/it]{'epoch': 49, 'num_users': 5.8235, 'loss': 0.0209, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 3.2168}:  53%|█████▎    | 16/30 [00:41<00:38,  2.72s/it]{'epoch': 49, 'num_users': 5.8235, 'loss': 0.0209, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 3.2168}:  57%|█████▋    | 17/30 [00:41<00:31,  2.43s/it]{'epoch': 49, 'num_users': 6.0556, 'loss': 0.0218, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.229}:  57%|█████▋    | 17/30 [00:45<00:31,  2.43s/it] {'epoch': 49, 'num_users': 6.0556, 'loss': 0.0218, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.229}:  60%|██████    | 18/30 [00:45<00:32,  2.74s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 0.0208, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.9014, 'compress@10': 1.0, 'time@10': 3.2397}:  60%|██████    | 18/30 [00:46<00:32,  2.74s/it]  {'epoch': 49, 'num_users': 6.0, 'loss': 0.0208, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.9014, 'compress@10': 1.0, 'time@10': 3.2397}:  63%|██████▎   | 19/30 [00:46<00:26,  2.44s/it]{'epoch': 49, 'num_users': 6.15, 'loss': 0.0206, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.9029, 'compress@10': 1.0, 'time@10': 3.2458}:  63%|██████▎   | 19/30 [00:50<00:26,  2.44s/it]{'epoch': 49, 'num_users': 6.15, 'loss': 0.0206, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.9029, 'compress@10': 1.0, 'time@10': 3.2458}:  67%|██████▋   | 20/30 [00:50<00:27,  2.73s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0273, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 3.1222}:  67%|██████▋   | 20/30 [00:50<00:27,  2.73s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0273, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 3.1222}:  70%|███████   | 21/30 [00:50<00:18,  2.02s/it]{'epoch': 49, 'num_users': 6.1818, 'loss': 0.0262, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 3.1349}:  70%|███████   | 21/30 [00:54<00:18,  2.02s/it]{'epoch': 49, 'num_users': 6.1818, 'loss': 0.0262, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 3.1349}:  73%|███████▎  | 22/30 [00:54<00:19,  2.45s/it]{'epoch': 49, 'num_users': 6.1304, 'loss': 0.0255, 'hit_ratio@10': 0.8343, 'ndcg@10': 0.8962, 'compress@10': 1.0, 'time@10': 3.1637}:  73%|███████▎  | 22/30 [00:55<00:19,  2.45s/it]{'epoch': 49, 'num_users': 6.1304, 'loss': 0.0255, 'hit_ratio@10': 0.8343, 'ndcg@10': 0.8962, 'compress@10': 1.0, 'time@10': 3.1637}:  77%|███████▋  | 23/30 [00:55<00:16,  2.29s/it]{'epoch': 49, 'num_users': 5.9583, 'loss': 0.0244, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.1679}:  77%|███████▋  | 23/30 [00:59<00:16,  2.29s/it]{'epoch': 49, 'num_users': 5.9583, 'loss': 0.0244, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.1679}:  80%|████████  | 24/30 [00:59<00:15,  2.60s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0234, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 3.1754}:  80%|████████  | 24/30 [01:01<00:15,  2.60s/it]   {'epoch': 49, 'num_users': 5.8, 'loss': 0.0234, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 3.1754}:  83%|████████▎ | 25/30 [01:01<00:11,  2.35s/it]{'epoch': 49, 'num_users': 5.8077, 'loss': 0.0242, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8833, 'compress@10': 1.0, 'time@10': 3.1089}:  83%|████████▎ | 25/30 [01:02<00:11,  2.35s/it]{'epoch': 49, 'num_users': 5.8077, 'loss': 0.0242, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8833, 'compress@10': 1.0, 'time@10': 3.1089}:  87%|████████▋ | 26/30 [01:02<00:08,  2.09s/it]{'epoch': 49, 'num_users': 5.8889, 'loss': 0.0237, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8851, 'compress@10': 1.0, 'time@10': 3.1126}:  87%|████████▋ | 26/30 [01:04<00:08,  2.09s/it]{'epoch': 49, 'num_users': 5.8889, 'loss': 0.0237, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8851, 'compress@10': 1.0, 'time@10': 3.1126}:  90%|█████████ | 27/30 [01:04<00:05,  1.95s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 0.0235, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8876, 'compress@10': 1.0, 'time@10': 3.144}:  90%|█████████ | 27/30 [01:08<00:05,  1.95s/it]    {'epoch': 49, 'num_users': 6.0, 'loss': 0.0235, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8876, 'compress@10': 1.0, 'time@10': 3.144}:  93%|█████████▎| 28/30 [01:08<00:05,  2.58s/it]{'epoch': 49, 'num_users': 5.8621, 'loss': 0.0232, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.1672}:  93%|█████████▎| 28/30 [01:10<00:05,  2.58s/it]{'epoch': 49, 'num_users': 5.8621, 'loss': 0.0232, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.1672}:  97%|█████████▋| 29/30 [01:10<00:02,  2.39s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0233, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 3.1807}:  97%|█████████▋| 29/30 [01:13<00:02,  2.39s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0233, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 3.1807}: 100%|██████████| 30/30 [01:13<00:00,  2.75s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0233, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 3.1807}: 100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch: 49
Avg # of users: 5.866666666666666
Avg Loss: 0.02327775366927465
Avg hit ratio: 0.8441280661885819
Avg ndcg: 0.8955421174487859
Avg compression ratio: 0.9999999860166272
Avg train time: 3.180677318572998
Std train time: 0.7618313784607222
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 14, 36, 15, 8, 9, 9, 13, 6, 10, 8, 37, 10, 80, 7, 38, 51, 15, 16, 7, 9, 20, 11, 105, 102, 8, 8, 7, 10, 12]
