  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1339, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5337, 'compress@10': 0.6206, 'time@10': 6.7159}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1339, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5337, 'compress@10': 0.6206, 'time@10': 6.7159}:   3%|▎         | 1/30 [00:03<01:38,  3.40s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0987, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.6817, 'compress@10': 0.5737, 'time@10': 5.8564}:   3%|▎         | 1/30 [00:08<01:38,  3.40s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0987, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.6817, 'compress@10': 0.5737, 'time@10': 5.8564}:   7%|▋         | 2/30 [00:08<02:02,  4.37s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6228, 'hit_ratio@10': 0.4987, 'ndcg@10': 0.4717, 'compress@10': 0.5559, 'time@10': 4.57}:   7%|▋         | 2/30 [00:09<02:02,  4.37s/it]  {'epoch': 0, 'num_users': 5.0, 'loss': 0.6228, 'hit_ratio@10': 0.4987, 'ndcg@10': 0.4717, 'compress@10': 0.5559, 'time@10': 4.57}:  10%|█         | 3/30 [00:09<01:16,  2.85s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.4856, 'hit_ratio@10': 0.5883, 'ndcg@10': 0.5437, 'compress@10': 0.5558, 'time@10': 4.5325}:  10%|█         | 3/30 [00:13<01:16,  2.85s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.4856, 'hit_ratio@10': 0.5883, 'ndcg@10': 0.5437, 'compress@10': 0.5558, 'time@10': 4.5325}:  13%|█▎        | 4/30 [00:13<01:30,  3.49s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4069, 'hit_ratio@10': 0.6346, 'ndcg@10': 0.5905, 'compress@10': 0.545, 'time@10': 6.8604}:  13%|█▎        | 4/30 [00:22<01:30,  3.49s/it] {'epoch': 0, 'num_users': 5.8, 'loss': 0.4069, 'hit_ratio@10': 0.6346, 'ndcg@10': 0.5905, 'compress@10': 0.545, 'time@10': 6.8604}:  17%|█▋        | 5/30 [00:22<02:09,  5.16s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.353, 'hit_ratio@10': 0.64, 'ndcg@10': 0.6278, 'compress@10': 0.5487, 'time@10': 6.9344}:  17%|█▋        | 5/30 [00:29<02:09,  5.16s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.353, 'hit_ratio@10': 0.64, 'ndcg@10': 0.6278, 'compress@10': 0.5487, 'time@10': 6.9344}:  20%|██        | 6/30 [00:29<02:21,  5.90s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3137, 'hit_ratio@10': 0.6685, 'ndcg@10': 0.6307, 'compress@10': 0.5476, 'time@10': 7.074}:  20%|██        | 6/30 [00:33<02:21,  5.90s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3137, 'hit_ratio@10': 0.6685, 'ndcg@10': 0.6307, 'compress@10': 0.5476, 'time@10': 7.074}:  23%|██▎       | 7/30 [00:33<02:01,  5.28s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.2796, 'hit_ratio@10': 0.6993, 'ndcg@10': 0.6571, 'compress@10': 0.5398, 'time@10': 6.8895}:  23%|██▎       | 7/30 [00:39<02:01,  5.28s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.2796, 'hit_ratio@10': 0.6993, 'ndcg@10': 0.6571, 'compress@10': 0.5398, 'time@10': 6.8895}:  27%|██▋       | 8/30 [00:39<01:58,  5.40s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2532, 'hit_ratio@10': 0.6978, 'ndcg@10': 0.6856, 'compress@10': 0.5438, 'time@10': 7.3777}:  27%|██▋       | 8/30 [00:44<01:58,  5.40s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2532, 'hit_ratio@10': 0.6978, 'ndcg@10': 0.6856, 'compress@10': 0.5438, 'time@10': 7.3777}:  30%|███       | 9/30 [00:44<01:55,  5.49s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2329, 'hit_ratio@10': 0.7212, 'ndcg@10': 0.7017, 'compress@10': 0.5367, 'time@10': 7.3466}:  30%|███       | 9/30 [00:51<01:55,  5.49s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2329, 'hit_ratio@10': 0.7212, 'ndcg@10': 0.7017, 'compress@10': 0.5367, 'time@10': 7.3466}:  33%|███▎      | 10/30 [00:51<01:59,  5.99s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.2207, 'hit_ratio@10': 0.722, 'ndcg@10': 0.7053, 'compress@10': 0.536, 'time@10': 7.431}:  33%|███▎      | 10/30 [00:56<01:59,  5.99s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.2207, 'hit_ratio@10': 0.722, 'ndcg@10': 0.7053, 'compress@10': 0.536, 'time@10': 7.431}:  37%|███▋      | 11/30 [00:56<01:43,  5.44s/it]{'epoch': 0, 'num_users': 6.4167, 'loss': 0.2393, 'hit_ratio@10': 0.7035, 'ndcg@10': 0.6658, 'compress@10': 0.5298, 'time@10': 6.9607}:  37%|███▋      | 11/30 [00:57<01:43,  5.44s/it]{'epoch': 0, 'num_users': 6.4167, 'loss': 0.2393, 'hit_ratio@10': 0.7035, 'ndcg@10': 0.6658, 'compress@10': 0.5298, 'time@10': 6.9607}:  40%|████      | 12/30 [00:57<01:18,  4.34s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.2297, 'hit_ratio@10': 0.7054, 'ndcg@10': 0.6676, 'compress@10': 0.5258, 'time@10': 6.9549}:  40%|████      | 12/30 [01:01<01:18,  4.34s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.2297, 'hit_ratio@10': 0.7054, 'ndcg@10': 0.6676, 'compress@10': 0.5258, 'time@10': 6.9549}:  43%|████▎     | 13/30 [01:01<01:09,  4.08s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.3846, 'hit_ratio@10': 0.6788, 'ndcg@10': 0.6204, 'compress@10': 0.5277, 'time@10': 6.5162}:  43%|████▎     | 13/30 [01:02<01:09,  4.08s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.3846, 'hit_ratio@10': 0.6788, 'ndcg@10': 0.6204, 'compress@10': 0.5277, 'time@10': 6.5162}:  47%|████▋     | 14/30 [01:02<00:49,  3.11s/it]{'epoch': 0, 'num_users': 6.2667, 'loss': 0.3633, 'hit_ratio@10': 0.6959, 'ndcg@10': 0.6308, 'compress@10': 0.53, 'time@10': 6.7387}:  47%|████▋     | 14/30 [01:07<00:49,  3.11s/it]  {'epoch': 0, 'num_users': 6.2667, 'loss': 0.3633, 'hit_ratio@10': 0.6959, 'ndcg@10': 0.6308, 'compress@10': 0.53, 'time@10': 6.7387}:  50%|█████     | 15/30 [01:07<00:55,  3.67s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.3681, 'hit_ratio@10': 0.6837, 'ndcg@10': 0.6053, 'compress@10': 0.5348, 'time@10': 6.4299}:  50%|█████     | 15/30 [01:09<00:55,  3.67s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.3681, 'hit_ratio@10': 0.6837, 'ndcg@10': 0.6053, 'compress@10': 0.5348, 'time@10': 6.4299}:  53%|█████▎    | 16/30 [01:09<00:43,  3.12s/it]{'epoch': 0, 'num_users': 5.8235, 'loss': 0.4681, 'hit_ratio@10': 0.6787, 'ndcg@10': 0.5697, 'compress@10': 0.5338, 'time@10': 6.1292}:  53%|█████▎    | 16/30 [01:09<00:43,  3.12s/it]{'epoch': 0, 'num_users': 5.8235, 'loss': 0.4681, 'hit_ratio@10': 0.6787, 'ndcg@10': 0.5697, 'compress@10': 0.5338, 'time@10': 6.1292}:  57%|█████▋    | 17/30 [01:09<00:31,  2.39s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 0.4468, 'hit_ratio@10': 0.6847, 'ndcg@10': 0.5822, 'compress@10': 0.5382, 'time@10': 6.0385}:  57%|█████▋    | 17/30 [01:14<00:31,  2.39s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 0.4468, 'hit_ratio@10': 0.6847, 'ndcg@10': 0.5822, 'compress@10': 0.5382, 'time@10': 6.0385}:  60%|██████    | 18/30 [01:14<00:36,  3.04s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.4344, 'hit_ratio@10': 0.6862, 'ndcg@10': 0.5783, 'compress@10': 0.5295, 'time@10': 5.9468}:  60%|██████    | 18/30 [01:16<00:36,  3.04s/it]   {'epoch': 0, 'num_users': 6.0, 'loss': 0.4344, 'hit_ratio@10': 0.6862, 'ndcg@10': 0.5783, 'compress@10': 0.5295, 'time@10': 5.9468}:  63%|██████▎   | 19/30 [01:16<00:30,  2.78s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.4162, 'hit_ratio@10': 0.6949, 'ndcg@10': 0.589, 'compress@10': 0.5245, 'time@10': 6.1107}:  63%|██████▎   | 19/30 [01:25<00:30,  2.78s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.4162, 'hit_ratio@10': 0.6949, 'ndcg@10': 0.589, 'compress@10': 0.5245, 'time@10': 6.1107}:  67%|██████▋   | 20/30 [01:25<00:47,  4.73s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.4002, 'hit_ratio@10': 0.6999, 'ndcg@10': 0.5992, 'compress@10': 0.5234, 'time@10': 6.4315}:  67%|██████▋   | 20/30 [01:32<00:47,  4.73s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.4002, 'hit_ratio@10': 0.6999, 'ndcg@10': 0.5992, 'compress@10': 0.5234, 'time@10': 6.4315}:  70%|███████   | 21/30 [01:32<00:47,  5.25s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 0.3872, 'hit_ratio@10': 0.7094, 'ndcg@10': 0.5979, 'compress@10': 0.5218, 'time@10': 6.2943}:  70%|███████   | 21/30 [01:35<00:47,  5.25s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 0.3872, 'hit_ratio@10': 0.7094, 'ndcg@10': 0.5979, 'compress@10': 0.5218, 'time@10': 6.2943}:  73%|███████▎  | 22/30 [01:35<00:37,  4.71s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 0.3745, 'hit_ratio@10': 0.7134, 'ndcg@10': 0.5963, 'compress@10': 0.5231, 'time@10': 6.292}:  73%|███████▎  | 22/30 [01:38<00:37,  4.71s/it] {'epoch': 0, 'num_users': 6.1304, 'loss': 0.3745, 'hit_ratio@10': 0.7134, 'ndcg@10': 0.5963, 'compress@10': 0.5231, 'time@10': 6.292}:  77%|███████▋  | 23/30 [01:38<00:29,  4.24s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.4506, 'hit_ratio@10': 0.7086, 'ndcg@10': 0.5714, 'compress@10': 0.5258, 'time@10': 6.057}:  77%|███████▋  | 23/30 [01:39<00:29,  4.24s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.4506, 'hit_ratio@10': 0.7086, 'ndcg@10': 0.5714, 'compress@10': 0.5258, 'time@10': 6.057}:  80%|████████  | 24/30 [01:39<00:19,  3.18s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5081, 'hit_ratio@10': 0.6803, 'ndcg@10': 0.5486, 'compress@10': 0.5307, 'time@10': 5.8415}:  80%|████████  | 24/30 [01:39<00:19,  3.18s/it]  {'epoch': 0, 'num_users': 5.8, 'loss': 0.5081, 'hit_ratio@10': 0.6803, 'ndcg@10': 0.5486, 'compress@10': 0.5307, 'time@10': 5.8415}:  83%|████████▎ | 25/30 [01:39<00:11,  2.34s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.4921, 'hit_ratio@10': 0.6865, 'ndcg@10': 0.5568, 'compress@10': 0.5304, 'time@10': 6.1291}:  83%|████████▎ | 25/30 [01:53<00:11,  2.34s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.4921, 'hit_ratio@10': 0.6865, 'ndcg@10': 0.5568, 'compress@10': 0.5304, 'time@10': 6.1291}:  87%|████████▋ | 26/30 [01:53<00:22,  5.64s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 0.4757, 'hit_ratio@10': 0.6941, 'ndcg@10': 0.5659, 'compress@10': 0.5309, 'time@10': 6.2341}:  87%|████████▋ | 26/30 [01:57<00:22,  5.64s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 0.4757, 'hit_ratio@10': 0.6941, 'ndcg@10': 0.5659, 'compress@10': 0.5309, 'time@10': 6.2341}:  90%|█████████ | 27/30 [01:57<00:15,  5.31s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.4608, 'hit_ratio@10': 0.6995, 'ndcg@10': 0.5769, 'compress@10': 0.5276, 'time@10': 6.3053}:  90%|█████████ | 27/30 [02:06<00:15,  5.31s/it]   {'epoch': 0, 'num_users': 6.0, 'loss': 0.4608, 'hit_ratio@10': 0.6995, 'ndcg@10': 0.5769, 'compress@10': 0.5276, 'time@10': 6.3053}:  93%|█████████▎| 28/30 [02:06<00:12,  6.20s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.4478, 'hit_ratio@10': 0.7067, 'ndcg@10': 0.5769, 'compress@10': 0.5254, 'time@10': 6.3262}:  93%|█████████▎| 28/30 [02:09<00:12,  6.20s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.4478, 'hit_ratio@10': 0.7067, 'ndcg@10': 0.5769, 'compress@10': 0.5254, 'time@10': 6.3262}:  97%|█████████▋| 29/30 [02:09<00:05,  5.39s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.4343, 'hit_ratio@10': 0.7084, 'ndcg@10': 0.5878, 'compress@10': 0.5245, 'time@10': 6.3115}:  97%|█████████▋| 29/30 [02:15<00:05,  5.39s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.4343, 'hit_ratio@10': 0.7084, 'ndcg@10': 0.5878, 'compress@10': 0.5245, 'time@10': 6.3115}: 100%|██████████| 30/30 [02:15<00:00,  5.55s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.4343, 'hit_ratio@10': 0.7084, 'ndcg@10': 0.5878, 'compress@10': 0.5245, 'time@10': 6.3115}: 100%|██████████| 30/30 [02:15<00:00,  4.51s/it]
Epoch: 0
Avg # of users: 5.866666666666666
Avg Loss: 0.4342900999715551
Avg hit ratio: 0.7083510145924958
Avg ndcg: 0.5878389693469149
Avg compression ratio: 0.524494354728959
Avg train time: 6.311525821685791
Std train time: 3.892721744911118
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 11, 10, 8, 10, 10, 10, 9, 10, 10, 11, 10, 11, 9, 11, 11, 10, 10, 10, 9, 10, 10, 11, 11, 9, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0522, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8424, 'compress@10': 0.5789, 'time@10': 5.3382}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0522, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8424, 'compress@10': 0.5789, 'time@10': 5.3382}:   3%|▎         | 1/30 [00:02<01:18,  2.71s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0525, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8492, 'compress@10': 0.5089, 'time@10': 5.1519}:   3%|▎         | 1/30 [00:07<01:18,  2.71s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0525, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8492, 'compress@10': 0.5089, 'time@10': 5.1519}:   7%|▋         | 2/30 [00:07<01:53,  4.06s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0392, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8428, 'compress@10': 0.5274, 'time@10': 4.1585}:   7%|▋         | 2/30 [00:08<01:53,  4.06s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0392, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8428, 'compress@10': 0.5274, 'time@10': 4.1585}:  10%|█         | 3/30 [00:08<01:13,  2.72s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0418, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8428, 'compress@10': 0.5266, 'time@10': 4.2217}:  10%|█         | 3/30 [00:13<01:13,  2.72s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.0418, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8428, 'compress@10': 0.5266, 'time@10': 4.2217}:  13%|█▎        | 4/30 [00:13<01:28,  3.40s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0513, 'hit_ratio@10': 0.7696, 'ndcg@10': 0.832, 'compress@10': 0.5585, 'time@10': 5.9793}:  13%|█▎        | 4/30 [00:19<01:28,  3.40s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0513, 'hit_ratio@10': 0.7696, 'ndcg@10': 0.832, 'compress@10': 0.5585, 'time@10': 5.9793}:  17%|█▋        | 5/30 [00:19<01:53,  4.54s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0556, 'hit_ratio@10': 0.7635, 'ndcg@10': 0.8289, 'compress@10': 0.5401, 'time@10': 6.1962}:  17%|█▋        | 5/30 [00:27<01:53,  4.54s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0556, 'hit_ratio@10': 0.7635, 'ndcg@10': 0.8289, 'compress@10': 0.5401, 'time@10': 6.1962}:  20%|██        | 6/30 [00:27<02:11,  5.48s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0537, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.834, 'compress@10': 0.5372, 'time@10': 6.4394}:  20%|██        | 6/30 [00:31<02:11,  5.48s/it] {'epoch': 1, 'num_users': 6.2857, 'loss': 0.0537, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.834, 'compress@10': 0.5372, 'time@10': 6.4394}:  23%|██▎       | 7/30 [00:31<01:54,  4.99s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8385, 'compress@10': 0.531, 'time@10': 6.3314}:  23%|██▎       | 7/30 [00:36<01:54,  4.99s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8385, 'compress@10': 0.531, 'time@10': 6.3314}:  27%|██▋       | 8/30 [00:36<01:54,  5.19s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0498, 'hit_ratio@10': 0.7935, 'ndcg@10': 0.847, 'compress@10': 0.5389, 'time@10': 6.7502}:  27%|██▋       | 8/30 [00:41<01:54,  5.19s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0498, 'hit_ratio@10': 0.7935, 'ndcg@10': 0.847, 'compress@10': 0.5389, 'time@10': 6.7502}:  30%|███       | 9/30 [00:41<01:48,  5.16s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.8466, 'compress@10': 0.5413, 'time@10': 6.7809}:  30%|███       | 9/30 [00:48<01:48,  5.16s/it]  {'epoch': 1, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.8466, 'compress@10': 0.5413, 'time@10': 6.7809}:  33%|███▎      | 10/30 [00:48<01:55,  5.76s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.051, 'hit_ratio@10': 0.8038, 'ndcg@10': 0.8483, 'compress@10': 0.5515, 'time@10': 6.9282}:  33%|███▎      | 10/30 [00:53<01:55,  5.76s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.051, 'hit_ratio@10': 0.8038, 'ndcg@10': 0.8483, 'compress@10': 0.5515, 'time@10': 6.9282}:  37%|███▋      | 11/30 [00:53<01:40,  5.29s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.0491, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.8529, 'compress@10': 0.5486, 'time@10': 6.514}:  37%|███▋      | 11/30 [00:55<01:40,  5.29s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.0491, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.8529, 'compress@10': 0.5486, 'time@10': 6.514}:  40%|████      | 12/30 [00:55<01:17,  4.29s/it]{'epoch': 1, 'num_users': 6.6154, 'loss': 0.0494, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8546, 'compress@10': 0.5524, 'time@10': 6.5455}:  40%|████      | 12/30 [00:58<01:17,  4.29s/it]{'epoch': 1, 'num_users': 6.6154, 'loss': 0.0494, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8546, 'compress@10': 0.5524, 'time@10': 6.5455}:  43%|████▎     | 13/30 [00:58<01:08,  4.05s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.0522, 'hit_ratio@10': 0.7912, 'ndcg@10': 0.8399, 'compress@10': 0.5532, 'time@10': 6.1412}:  43%|████▎     | 13/30 [00:59<01:08,  4.05s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.0522, 'hit_ratio@10': 0.7912, 'ndcg@10': 0.8399, 'compress@10': 0.5532, 'time@10': 6.1412}:  47%|████▋     | 14/30 [00:59<00:49,  3.11s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.0526, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8423, 'compress@10': 0.5497, 'time@10': 6.2969}:  47%|████▋     | 14/30 [01:03<00:49,  3.11s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.0526, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8423, 'compress@10': 0.5497, 'time@10': 6.2969}:  50%|█████     | 15/30 [01:03<00:51,  3.46s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.0506, 'hit_ratio@10': 0.8029, 'ndcg@10': 0.8437, 'compress@10': 0.5532, 'time@10': 6.0339}:  50%|█████     | 15/30 [01:06<00:51,  3.46s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.0506, 'hit_ratio@10': 0.8029, 'ndcg@10': 0.8437, 'compress@10': 0.5532, 'time@10': 6.0339}:  53%|█████▎    | 16/30 [01:06<00:43,  3.07s/it]{'epoch': 1, 'num_users': 5.8235, 'loss': 0.0551, 'hit_ratio@10': 0.7792, 'ndcg@10': 0.8227, 'compress@10': 0.55, 'time@10': 5.7922}:  53%|█████▎    | 16/30 [01:07<00:43,  3.07s/it]  {'epoch': 1, 'num_users': 5.8235, 'loss': 0.0551, 'hit_ratio@10': 0.7792, 'ndcg@10': 0.8227, 'compress@10': 0.55, 'time@10': 5.7922}:  57%|█████▋    | 17/30 [01:07<00:32,  2.46s/it]{'epoch': 1, 'num_users': 6.0556, 'loss': 0.0556, 'hit_ratio@10': 0.7776, 'ndcg@10': 0.8242, 'compress@10': 0.5504, 'time@10': 5.717}:  57%|█████▋    | 17/30 [01:11<00:32,  2.46s/it]{'epoch': 1, 'num_users': 6.0556, 'loss': 0.0556, 'hit_ratio@10': 0.7776, 'ndcg@10': 0.8242, 'compress@10': 0.5504, 'time@10': 5.717}:  60%|██████    | 18/30 [01:11<00:36,  3.07s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.0541, 'hit_ratio@10': 0.7817, 'ndcg@10': 0.8267, 'compress@10': 0.5482, 'time@10': 5.6207}:  60%|██████    | 18/30 [01:13<00:36,  3.07s/it]  {'epoch': 1, 'num_users': 6.0, 'loss': 0.0541, 'hit_ratio@10': 0.7817, 'ndcg@10': 0.8267, 'compress@10': 0.5482, 'time@10': 5.6207}:  63%|██████▎   | 19/30 [01:13<00:30,  2.75s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.0547, 'hit_ratio@10': 0.7856, 'ndcg@10': 0.8254, 'compress@10': 0.542, 'time@10': 5.8146}:  63%|██████▎   | 19/30 [01:23<00:30,  2.75s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.0547, 'hit_ratio@10': 0.7856, 'ndcg@10': 0.8254, 'compress@10': 0.542, 'time@10': 5.8146}:  67%|██████▋   | 20/30 [01:23<00:47,  4.79s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0556, 'hit_ratio@10': 0.7863, 'ndcg@10': 0.8247, 'compress@10': 0.5462, 'time@10': 6.0881}:  67%|██████▋   | 20/30 [01:28<00:47,  4.79s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0556, 'hit_ratio@10': 0.7863, 'ndcg@10': 0.8247, 'compress@10': 0.5462, 'time@10': 6.0881}:  70%|███████   | 21/30 [01:28<00:45,  5.10s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.0549, 'hit_ratio@10': 0.7919, 'ndcg@10': 0.8278, 'compress@10': 0.5465, 'time@10': 5.9673}:  70%|███████   | 21/30 [01:32<00:45,  5.10s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.0549, 'hit_ratio@10': 0.7919, 'ndcg@10': 0.8278, 'compress@10': 0.5465, 'time@10': 5.9673}:  73%|███████▎  | 22/30 [01:32<00:36,  4.61s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.0536, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8311, 'compress@10': 0.5476, 'time@10': 5.9802}:  73%|███████▎  | 22/30 [01:35<00:36,  4.61s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.0536, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8311, 'compress@10': 0.5476, 'time@10': 5.9802}:  77%|███████▋  | 23/30 [01:35<00:29,  4.18s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.0569, 'hit_ratio@10': 0.7863, 'ndcg@10': 0.8182, 'compress@10': 0.5482, 'time@10': 5.7607}:  77%|███████▋  | 23/30 [01:36<00:29,  4.18s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.0569, 'hit_ratio@10': 0.7863, 'ndcg@10': 0.8182, 'compress@10': 0.5482, 'time@10': 5.7607}:  80%|████████  | 24/30 [01:36<00:18,  3.15s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.071, 'hit_ratio@10': 0.7682, 'ndcg@10': 0.7898, 'compress@10': 0.5517, 'time@10': 5.5586}:  80%|████████  | 24/30 [01:36<00:18,  3.15s/it]    {'epoch': 1, 'num_users': 5.8, 'loss': 0.071, 'hit_ratio@10': 0.7682, 'ndcg@10': 0.7898, 'compress@10': 0.5517, 'time@10': 5.5586}:  83%|████████▎ | 25/30 [01:36<00:11,  2.32s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.0714, 'hit_ratio@10': 0.7715, 'ndcg@10': 0.7891, 'compress@10': 0.5514, 'time@10': 5.8069}:  83%|████████▎ | 25/30 [01:48<00:11,  2.32s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.0714, 'hit_ratio@10': 0.7715, 'ndcg@10': 0.7891, 'compress@10': 0.5514, 'time@10': 5.8069}:  87%|████████▋ | 26/30 [01:48<00:20,  5.24s/it]{'epoch': 1, 'num_users': 5.8889, 'loss': 0.07, 'hit_ratio@10': 0.7786, 'ndcg@10': 0.7928, 'compress@10': 0.5456, 'time@10': 5.9203}:  87%|████████▋ | 26/30 [01:53<00:20,  5.24s/it]  {'epoch': 1, 'num_users': 5.8889, 'loss': 0.07, 'hit_ratio@10': 0.7786, 'ndcg@10': 0.7928, 'compress@10': 0.5456, 'time@10': 5.9203}:  90%|█████████ | 27/30 [01:53<00:15,  5.01s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.0694, 'hit_ratio@10': 0.7809, 'ndcg@10': 0.7957, 'compress@10': 0.5412, 'time@10': 6.0042}:  90%|█████████ | 27/30 [02:01<00:15,  5.01s/it] {'epoch': 1, 'num_users': 6.0, 'loss': 0.0694, 'hit_ratio@10': 0.7809, 'ndcg@10': 0.7957, 'compress@10': 0.5412, 'time@10': 6.0042}:  93%|█████████▎| 28/30 [02:01<00:12,  6.00s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.0677, 'hit_ratio@10': 0.7854, 'ndcg@10': 0.7994, 'compress@10': 0.5417, 'time@10': 6.0334}:  93%|█████████▎| 28/30 [02:05<00:12,  6.00s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.0677, 'hit_ratio@10': 0.7854, 'ndcg@10': 0.7994, 'compress@10': 0.5417, 'time@10': 6.0334}:  97%|█████████▋| 29/30 [02:05<00:05,  5.24s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.0666, 'hit_ratio@10': 0.7844, 'ndcg@10': 0.8027, 'compress@10': 0.5402, 'time@10': 6.0306}:  97%|█████████▋| 29/30 [02:11<00:05,  5.24s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.0666, 'hit_ratio@10': 0.7844, 'ndcg@10': 0.8027, 'compress@10': 0.5402, 'time@10': 6.0306}: 100%|██████████| 30/30 [02:11<00:00,  5.47s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.0666, 'hit_ratio@10': 0.7844, 'ndcg@10': 0.8027, 'compress@10': 0.5402, 'time@10': 6.0306}: 100%|██████████| 30/30 [02:11<00:00,  4.37s/it]
Epoch: 1
Avg # of users: 5.866666666666666
Avg Loss: 0.06662582980735472
Avg hit ratio: 0.7844048771470004
Avg ndcg: 0.8026942634600582
Avg compression ratio: 0.5402199203763705
Avg train time: 6.030560723940531
Std train time: 3.3726752341053303
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 12, 10, 7, 10, 10, 10, 8, 10, 10, 12, 10, 12, 9, 12, 12, 10, 10, 9, 8, 10, 10, 12, 12, 8, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.845, 'compress@10': 0.6321, 'time@10': 7.1577}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.845, 'compress@10': 0.6321, 'time@10': 7.1577}:   3%|▎         | 1/30 [00:03<01:44,  3.62s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8445, 'compress@10': 0.5367, 'time@10': 6.1351}:   3%|▎         | 1/30 [00:08<01:44,  3.62s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8445, 'compress@10': 0.5367, 'time@10': 6.1351}:   7%|▋         | 2/30 [00:08<02:06,  4.52s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8487, 'compress@10': 0.5545, 'time@10': 4.883}:   7%|▋         | 2/30 [00:10<02:06,  4.52s/it]  {'epoch': 2, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8487, 'compress@10': 0.5545, 'time@10': 4.883}:  10%|█         | 3/30 [00:10<01:21,  3.02s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0384, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8469, 'compress@10': 0.5385, 'time@10': 4.7667}:  10%|█         | 3/30 [00:14<01:21,  3.02s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0384, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8469, 'compress@10': 0.5385, 'time@10': 4.7667}:  13%|█▎        | 4/30 [00:14<01:35,  3.67s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0487, 'hit_ratio@10': 0.7696, 'ndcg@10': 0.8341, 'compress@10': 0.5545, 'time@10': 6.083}:  13%|█▎        | 4/30 [00:20<01:35,  3.67s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0487, 'hit_ratio@10': 0.7696, 'ndcg@10': 0.8341, 'compress@10': 0.5545, 'time@10': 6.083}:  17%|█▋        | 5/30 [00:20<01:50,  4.41s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0533, 'hit_ratio@10': 0.7635, 'ndcg@10': 0.8317, 'compress@10': 0.5374, 'time@10': 6.2843}:  17%|█▋        | 5/30 [00:27<01:50,  4.41s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0533, 'hit_ratio@10': 0.7635, 'ndcg@10': 0.8317, 'compress@10': 0.5374, 'time@10': 6.2843}:  20%|██        | 6/30 [00:27<02:09,  5.40s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0519, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8327, 'compress@10': 0.5394, 'time@10': 6.5191}:  20%|██        | 6/30 [00:31<02:09,  5.40s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0519, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8327, 'compress@10': 0.5394, 'time@10': 6.5191}:  23%|██▎       | 7/30 [00:31<01:53,  4.94s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0524, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8351, 'compress@10': 0.5221, 'time@10': 6.3995}:  23%|██▎       | 7/30 [00:37<01:53,  4.94s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0524, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8351, 'compress@10': 0.5221, 'time@10': 6.3995}:  27%|██▋       | 8/30 [00:37<01:53,  5.15s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0516, 'hit_ratio@10': 0.803, 'ndcg@10': 0.8445, 'compress@10': 0.5271, 'time@10': 6.678}:  27%|██▋       | 8/30 [00:41<01:53,  5.15s/it] {'epoch': 2, 'num_users': 6.3333, 'loss': 0.0516, 'hit_ratio@10': 0.803, 'ndcg@10': 0.8445, 'compress@10': 0.5271, 'time@10': 6.678}:  30%|███       | 9/30 [00:41<01:43,  4.95s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0515, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8445, 'compress@10': 0.5228, 'time@10': 6.7248}:  30%|███       | 9/30 [00:49<01:43,  4.95s/it] {'epoch': 2, 'num_users': 6.3, 'loss': 0.0515, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8445, 'compress@10': 0.5228, 'time@10': 6.7248}:  33%|███▎      | 10/30 [00:49<01:52,  5.64s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.0525, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8465, 'compress@10': 0.5285, 'time@10': 6.8721}:  33%|███▎      | 10/30 [00:53<01:52,  5.64s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.0525, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8465, 'compress@10': 0.5285, 'time@10': 6.8721}:  37%|███▋      | 11/30 [00:53<01:38,  5.20s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0496, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8528, 'compress@10': 0.5275, 'time@10': 6.4795}:  37%|███▋      | 11/30 [00:55<01:38,  5.20s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0496, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8528, 'compress@10': 0.5275, 'time@10': 6.4795}:  40%|████      | 12/30 [00:55<01:17,  4.29s/it]{'epoch': 2, 'num_users': 6.6154, 'loss': 0.0496, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8544, 'compress@10': 0.5328, 'time@10': 6.5121}:  40%|████      | 12/30 [00:58<01:17,  4.29s/it]{'epoch': 2, 'num_users': 6.6154, 'loss': 0.0496, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8544, 'compress@10': 0.5328, 'time@10': 6.5121}:  43%|████▎     | 13/30 [00:58<01:08,  4.05s/it]{'epoch': 2, 'num_users': 6.3571, 'loss': 0.0483, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.8505, 'compress@10': 0.5359, 'time@10': 6.1158}:  43%|████▎     | 13/30 [00:59<01:08,  4.05s/it]{'epoch': 2, 'num_users': 6.3571, 'loss': 0.0483, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.8505, 'compress@10': 0.5359, 'time@10': 6.1158}:  47%|████▋     | 14/30 [00:59<00:50,  3.13s/it]{'epoch': 2, 'num_users': 6.2667, 'loss': 0.0491, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8527, 'compress@10': 0.5353, 'time@10': 6.2928}:  47%|████▋     | 14/30 [01:04<00:50,  3.13s/it]{'epoch': 2, 'num_users': 6.2667, 'loss': 0.0491, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8527, 'compress@10': 0.5353, 'time@10': 6.2928}:  50%|█████     | 15/30 [01:04<00:52,  3.52s/it]{'epoch': 2, 'num_users': 6.0625, 'loss': 0.0471, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.855, 'compress@10': 0.5383, 'time@10': 6.0344}:  50%|█████     | 15/30 [01:06<00:52,  3.52s/it] {'epoch': 2, 'num_users': 6.0625, 'loss': 0.0471, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.855, 'compress@10': 0.5383, 'time@10': 6.0344}:  53%|█████▎    | 16/30 [01:06<00:43,  3.12s/it]{'epoch': 2, 'num_users': 5.8235, 'loss': 0.0464, 'hit_ratio@10': 0.8058, 'ndcg@10': 0.8415, 'compress@10': 0.5362, 'time@10': 5.7697}:  53%|█████▎    | 16/30 [01:07<00:43,  3.12s/it]{'epoch': 2, 'num_users': 5.8235, 'loss': 0.0464, 'hit_ratio@10': 0.8058, 'ndcg@10': 0.8415, 'compress@10': 0.5362, 'time@10': 5.7697}:  57%|█████▋    | 17/30 [01:07<00:31,  2.43s/it]{'epoch': 2, 'num_users': 6.0556, 'loss': 0.0474, 'hit_ratio@10': 0.8007, 'ndcg@10': 0.8419, 'compress@10': 0.5361, 'time@10': 5.6957}:  57%|█████▋    | 17/30 [01:11<00:31,  2.43s/it]{'epoch': 2, 'num_users': 6.0556, 'loss': 0.0474, 'hit_ratio@10': 0.8007, 'ndcg@10': 0.8419, 'compress@10': 0.5361, 'time@10': 5.6957}:  60%|██████    | 18/30 [01:11<00:36,  3.04s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.0459, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.8449, 'compress@10': 0.5368, 'time@10': 5.6185}:  60%|██████    | 18/30 [01:13<00:36,  3.04s/it]   {'epoch': 2, 'num_users': 6.0, 'loss': 0.0459, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.8449, 'compress@10': 0.5368, 'time@10': 5.6185}:  63%|██████▎   | 19/30 [01:13<00:30,  2.78s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.0468, 'hit_ratio@10': 0.8074, 'ndcg@10': 0.8432, 'compress@10': 0.5284, 'time@10': 5.7545}:  63%|██████▎   | 19/30 [01:22<00:30,  2.78s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.0468, 'hit_ratio@10': 0.8074, 'ndcg@10': 0.8432, 'compress@10': 0.5284, 'time@10': 5.7545}:  67%|██████▋   | 20/30 [01:22<00:44,  4.46s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0482, 'hit_ratio@10': 0.8058, 'ndcg@10': 0.8414, 'compress@10': 0.5303, 'time@10': 5.9691}:  67%|██████▋   | 20/30 [01:27<00:44,  4.46s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0482, 'hit_ratio@10': 0.8058, 'ndcg@10': 0.8414, 'compress@10': 0.5303, 'time@10': 5.9691}:  70%|███████   | 21/30 [01:27<00:42,  4.67s/it]{'epoch': 2, 'num_users': 6.1818, 'loss': 0.0477, 'hit_ratio@10': 0.8105, 'ndcg@10': 0.844, 'compress@10': 0.53, 'time@10': 5.8527}:  70%|███████   | 21/30 [01:30<00:42,  4.67s/it]   {'epoch': 2, 'num_users': 6.1818, 'loss': 0.0477, 'hit_ratio@10': 0.8105, 'ndcg@10': 0.844, 'compress@10': 0.53, 'time@10': 5.8527}:  73%|███████▎  | 22/30 [01:30<00:34,  4.31s/it]{'epoch': 2, 'num_users': 6.1304, 'loss': 0.0467, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8464, 'compress@10': 0.5287, 'time@10': 5.8664}:  73%|███████▎  | 22/30 [01:34<00:34,  4.31s/it]{'epoch': 2, 'num_users': 6.1304, 'loss': 0.0467, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8464, 'compress@10': 0.5287, 'time@10': 5.8664}:  77%|███████▋  | 23/30 [01:34<00:27,  3.95s/it]{'epoch': 2, 'num_users': 5.9583, 'loss': 0.0473, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.8351, 'compress@10': 0.5301, 'time@10': 5.6543}:  77%|███████▋  | 23/30 [01:34<00:27,  3.95s/it]{'epoch': 2, 'num_users': 5.9583, 'loss': 0.0473, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.8351, 'compress@10': 0.5301, 'time@10': 5.6543}:  80%|████████  | 24/30 [01:34<00:18,  3.01s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.049, 'hit_ratio@10': 0.7926, 'ndcg@10': 0.8187, 'compress@10': 0.534, 'time@10': 5.4587}:  80%|████████  | 24/30 [01:35<00:18,  3.01s/it]     {'epoch': 2, 'num_users': 5.8, 'loss': 0.049, 'hit_ratio@10': 0.7926, 'ndcg@10': 0.8187, 'compress@10': 0.534, 'time@10': 5.4587}:  83%|████████▎ | 25/30 [01:35<00:11,  2.23s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.0502, 'hit_ratio@10': 0.7954, 'ndcg@10': 0.8174, 'compress@10': 0.5332, 'time@10': 5.658}:  83%|████████▎ | 25/30 [01:46<00:11,  2.23s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.0502, 'hit_ratio@10': 0.7954, 'ndcg@10': 0.8174, 'compress@10': 0.5332, 'time@10': 5.658}:  87%|████████▋ | 26/30 [01:46<00:19,  4.77s/it]{'epoch': 2, 'num_users': 5.8889, 'loss': 0.0497, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.8195, 'compress@10': 0.5302, 'time@10': 5.7885}:  87%|████████▋ | 26/30 [01:50<00:19,  4.77s/it]{'epoch': 2, 'num_users': 5.8889, 'loss': 0.0497, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.8195, 'compress@10': 0.5302, 'time@10': 5.7885}:  90%|█████████ | 27/30 [01:50<00:14,  4.73s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.0499, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.8213, 'compress@10': 0.5293, 'time@10': 5.8858}:  90%|█████████ | 27/30 [01:59<00:14,  4.73s/it]   {'epoch': 2, 'num_users': 6.0, 'loss': 0.0499, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.8213, 'compress@10': 0.5293, 'time@10': 5.8858}:  93%|█████████▎| 28/30 [01:59<00:11,  5.88s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.0488, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8236, 'compress@10': 0.5289, 'time@10': 5.9189}:  93%|█████████▎| 28/30 [02:02<00:11,  5.88s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.0488, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8236, 'compress@10': 0.5289, 'time@10': 5.9189}:  97%|█████████▋| 29/30 [02:02<00:05,  5.15s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0485, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8258, 'compress@10': 0.5285, 'time@10': 5.9166}:  97%|█████████▋| 29/30 [02:08<00:05,  5.15s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0485, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8258, 'compress@10': 0.5285, 'time@10': 5.9166}: 100%|██████████| 30/30 [02:08<00:00,  5.38s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0485, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8258, 'compress@10': 0.5285, 'time@10': 5.9166}: 100%|██████████| 30/30 [02:08<00:00,  4.29s/it]
Epoch: 2
Avg # of users: 5.866666666666666
Avg Loss: 0.048491899229826725
Avg hit ratio: 0.8052545371273331
Avg ndcg: 0.8257976868332227
Avg compression ratio: 0.5285334268391085
Avg train time: 5.916573206583659
Std train time: 3.052978618014685
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 13, 10, 6, 10, 10, 10, 8, 10, 10, 13, 10, 13, 9, 13, 13, 10, 10, 9, 7, 10, 10, 13, 13, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8553, 'compress@10': 0.6438, 'time@10': 5.307}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8553, 'compress@10': 0.6438, 'time@10': 5.307}:   3%|▎         | 1/30 [00:02<01:17,  2.69s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8514, 'compress@10': 0.5153, 'time@10': 5.2998}:   3%|▎         | 1/30 [00:08<01:17,  2.69s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8514, 'compress@10': 0.5153, 'time@10': 5.2998}:   7%|▋         | 2/30 [00:08<01:58,  4.25s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8533, 'compress@10': 0.5348, 'time@10': 4.3823}:   7%|▋         | 2/30 [00:09<01:58,  4.25s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8533, 'compress@10': 0.5348, 'time@10': 4.3823}:  10%|█         | 3/30 [00:09<01:18,  2.91s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.039, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8458, 'compress@10': 0.5243, 'time@10': 4.5685}:  10%|█         | 3/30 [00:14<01:18,  2.91s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.039, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8458, 'compress@10': 0.5243, 'time@10': 4.5685}:  13%|█▎        | 4/30 [00:14<01:38,  3.81s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0494, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8331, 'compress@10': 0.5238, 'time@10': 5.6485}:  13%|█▎        | 4/30 [00:19<01:38,  3.81s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0494, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8331, 'compress@10': 0.5238, 'time@10': 5.6485}:  17%|█▋        | 5/30 [00:19<01:46,  4.26s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0534, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8308, 'compress@10': 0.5136, 'time@10': 5.9334}:  17%|█▋        | 5/30 [00:27<01:46,  4.26s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0534, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8308, 'compress@10': 0.5136, 'time@10': 5.9334}:  20%|██        | 6/30 [00:27<02:07,  5.33s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0536, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8323, 'compress@10': 0.5161, 'time@10': 6.1898}:  20%|██        | 6/30 [00:30<02:07,  5.33s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0536, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8323, 'compress@10': 0.5161, 'time@10': 6.1898}:  23%|██▎       | 7/30 [00:30<01:51,  4.86s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0553, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8427, 'compress@10': 0.5097, 'time@10': 6.1126}:  23%|██▎       | 7/30 [00:36<01:51,  4.86s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0553, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8427, 'compress@10': 0.5097, 'time@10': 6.1126}:  27%|██▋       | 8/30 [00:36<01:52,  5.10s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0538, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8535, 'compress@10': 0.5129, 'time@10': 6.4342}:  27%|██▋       | 8/30 [00:41<01:52,  5.10s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0538, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8535, 'compress@10': 0.5129, 'time@10': 6.4342}:  30%|███       | 9/30 [00:41<01:43,  4.93s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0534, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8518, 'compress@10': 0.5152, 'time@10': 6.4989}:  30%|███       | 9/30 [00:48<01:43,  4.93s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0534, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8518, 'compress@10': 0.5152, 'time@10': 6.4989}:  33%|███▎      | 10/30 [00:48<01:52,  5.61s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.0542, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.853, 'compress@10': 0.5213, 'time@10': 6.6603}:  33%|███▎      | 10/30 [00:52<01:52,  5.61s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.0542, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.853, 'compress@10': 0.5213, 'time@10': 6.6603}:  37%|███▋      | 11/30 [00:52<01:38,  5.17s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.0512, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.858, 'compress@10': 0.5251, 'time@10': 6.2982}:  37%|███▋      | 11/30 [00:54<01:38,  5.17s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.0512, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.858, 'compress@10': 0.5251, 'time@10': 6.2982}:  40%|████      | 12/30 [00:54<01:17,  4.31s/it]{'epoch': 3, 'num_users': 6.6154, 'loss': 0.0518, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.861, 'compress@10': 0.5295, 'time@10': 6.3406}:  40%|████      | 12/30 [00:58<01:17,  4.31s/it]{'epoch': 3, 'num_users': 6.6154, 'loss': 0.0518, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.861, 'compress@10': 0.5295, 'time@10': 6.3406}:  43%|████▎     | 13/30 [00:58<01:08,  4.06s/it]{'epoch': 3, 'num_users': 6.3571, 'loss': 0.0494, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8567, 'compress@10': 0.53, 'time@10': 5.9634}:  43%|████▎     | 13/30 [00:59<01:08,  4.06s/it] {'epoch': 3, 'num_users': 6.3571, 'loss': 0.0494, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8567, 'compress@10': 0.53, 'time@10': 5.9634}:  47%|████▋     | 14/30 [00:59<00:50,  3.16s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.0507, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.855, 'compress@10': 0.5288, 'time@10': 6.1527}:  47%|████▋     | 14/30 [01:03<00:50,  3.16s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.0507, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.855, 'compress@10': 0.5288, 'time@10': 6.1527}:  50%|█████     | 15/30 [01:03<00:53,  3.55s/it]{'epoch': 3, 'num_users': 6.0625, 'loss': 0.0485, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.856, 'compress@10': 0.5289, 'time@10': 5.9124}:  50%|█████     | 15/30 [01:06<00:53,  3.55s/it]{'epoch': 3, 'num_users': 6.0625, 'loss': 0.0485, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.856, 'compress@10': 0.5289, 'time@10': 5.9124}:  53%|█████▎    | 16/30 [01:06<00:44,  3.19s/it]{'epoch': 3, 'num_users': 5.8235, 'loss': 0.0469, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8486, 'compress@10': 0.5321, 'time@10': 5.6631}:  53%|█████▎    | 16/30 [01:06<00:44,  3.19s/it]{'epoch': 3, 'num_users': 5.8235, 'loss': 0.0469, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8486, 'compress@10': 0.5321, 'time@10': 5.6631}:  57%|█████▋    | 17/30 [01:06<00:32,  2.49s/it]{'epoch': 3, 'num_users': 6.0556, 'loss': 0.0478, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8486, 'compress@10': 0.5296, 'time@10': 5.5972}:  57%|█████▋    | 17/30 [01:11<00:32,  2.49s/it]{'epoch': 3, 'num_users': 6.0556, 'loss': 0.0478, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8486, 'compress@10': 0.5296, 'time@10': 5.5972}:  60%|██████    | 18/30 [01:11<00:37,  3.10s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.0462, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8512, 'compress@10': 0.5342, 'time@10': 5.5369}:  60%|██████    | 18/30 [01:13<00:37,  3.10s/it]   {'epoch': 3, 'num_users': 6.0, 'loss': 0.0462, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8512, 'compress@10': 0.5342, 'time@10': 5.5369}:  63%|██████▎   | 19/30 [01:13<00:31,  2.85s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.047, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8487, 'compress@10': 0.524, 'time@10': 5.6854}:  63%|██████▎   | 19/30 [01:22<00:31,  2.85s/it] {'epoch': 3, 'num_users': 6.15, 'loss': 0.047, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8487, 'compress@10': 0.524, 'time@10': 5.6854}:  67%|██████▋   | 20/30 [01:22<00:45,  4.56s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0485, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8465, 'compress@10': 0.5265, 'time@10': 5.8445}:  67%|██████▋   | 20/30 [01:26<00:45,  4.56s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0485, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8465, 'compress@10': 0.5265, 'time@10': 5.8445}:  70%|███████   | 21/30 [01:26<00:41,  4.56s/it]{'epoch': 3, 'num_users': 6.1818, 'loss': 0.0489, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8463, 'compress@10': 0.523, 'time@10': 5.7334}:  70%|███████   | 21/30 [01:30<00:41,  4.56s/it]  {'epoch': 3, 'num_users': 6.1818, 'loss': 0.0489, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8463, 'compress@10': 0.523, 'time@10': 5.7334}:  73%|███████▎  | 22/30 [01:30<00:33,  4.22s/it]{'epoch': 3, 'num_users': 6.1304, 'loss': 0.0482, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8483, 'compress@10': 0.5216, 'time@10': 5.7537}:  73%|███████▎  | 22/30 [01:33<00:33,  4.22s/it]{'epoch': 3, 'num_users': 6.1304, 'loss': 0.0482, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8483, 'compress@10': 0.5216, 'time@10': 5.7537}:  77%|███████▋  | 23/30 [01:33<00:27,  3.90s/it]{'epoch': 3, 'num_users': 5.9583, 'loss': 0.0482, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8412, 'compress@10': 0.5221, 'time@10': 5.5492}:  77%|███████▋  | 23/30 [01:34<00:27,  3.90s/it]{'epoch': 3, 'num_users': 5.9583, 'loss': 0.0482, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8412, 'compress@10': 0.5221, 'time@10': 5.5492}:  80%|████████  | 24/30 [01:34<00:17,  2.99s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0479, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.826, 'compress@10': 0.5276, 'time@10': 5.3604}:  80%|████████  | 24/30 [01:34<00:17,  2.99s/it]    {'epoch': 3, 'num_users': 5.8, 'loss': 0.0479, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.826, 'compress@10': 0.5276, 'time@10': 5.3604}:  83%|████████▎ | 25/30 [01:34<00:11,  2.23s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.0491, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.8242, 'compress@10': 0.5245, 'time@10': 5.5127}:  83%|████████▎ | 25/30 [01:44<00:11,  2.23s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.0491, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.8242, 'compress@10': 0.5245, 'time@10': 5.5127}:  87%|████████▋ | 26/30 [01:44<00:17,  4.37s/it]{'epoch': 3, 'num_users': 5.8889, 'loss': 0.0497, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8236, 'compress@10': 0.5236, 'time@10': 5.6372}:  87%|████████▋ | 26/30 [01:48<00:17,  4.37s/it]{'epoch': 3, 'num_users': 5.8889, 'loss': 0.0497, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8236, 'compress@10': 0.5236, 'time@10': 5.6372}:  90%|█████████ | 27/30 [01:48<00:13,  4.40s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.05, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8244, 'compress@10': 0.5228, 'time@10': 5.7318}:  90%|█████████ | 27/30 [01:56<00:13,  4.40s/it]     {'epoch': 3, 'num_users': 6.0, 'loss': 0.05, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8244, 'compress@10': 0.5228, 'time@10': 5.7318}:  93%|█████████▎| 28/30 [01:56<00:11,  5.58s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.0499, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8258, 'compress@10': 0.5214, 'time@10': 5.7716}:  93%|█████████▎| 28/30 [02:00<00:11,  5.58s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.0499, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8258, 'compress@10': 0.5214, 'time@10': 5.7716}:  97%|█████████▋| 29/30 [02:00<00:04,  4.95s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0497, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8278, 'compress@10': 0.5219, 'time@10': 5.7632}:  97%|█████████▋| 29/30 [02:05<00:04,  4.95s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0497, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8278, 'compress@10': 0.5219, 'time@10': 5.7632}: 100%|██████████| 30/30 [02:05<00:00,  5.13s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0497, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8278, 'compress@10': 0.5219, 'time@10': 5.7632}: 100%|██████████| 30/30 [02:05<00:00,  4.20s/it]
Epoch: 3
Avg # of users: 5.866666666666666
Avg Loss: 0.049691035289716225
Avg hit ratio: 0.8192472652494429
Avg ndcg: 0.8278129429413266
Avg compression ratio: 0.5218754134223552
Avg train time: 5.763183776537577
Std train time: 2.785918003926931
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 14, 10, 5, 10, 10, 10, 8, 10, 10, 14, 10, 14, 9, 14, 14, 10, 10, 9, 7, 10, 10, 14, 14, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0504, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8522, 'compress@10': 0.595, 'time@10': 5.482}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0504, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8522, 'compress@10': 0.595, 'time@10': 5.482}:   3%|▎         | 1/30 [00:02<01:21,  2.81s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0512, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8522, 'compress@10': 0.5023, 'time@10': 5.2498}:   3%|▎         | 1/30 [00:07<01:21,  2.81s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0512, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8522, 'compress@10': 0.5023, 'time@10': 5.2498}:   7%|▋         | 2/30 [00:07<01:55,  4.13s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0342, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8539, 'compress@10': 0.5151, 'time@10': 4.4196}:   7%|▋         | 2/30 [00:09<01:55,  4.13s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0342, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8539, 'compress@10': 0.5151, 'time@10': 4.4196}:  10%|█         | 3/30 [00:09<01:18,  2.89s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0411, 'hit_ratio@10': 0.7561, 'ndcg@10': 0.8427, 'compress@10': 0.5267, 'time@10': 4.4349}:  10%|█         | 3/30 [00:13<01:18,  2.89s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0411, 'hit_ratio@10': 0.7561, 'ndcg@10': 0.8427, 'compress@10': 0.5267, 'time@10': 4.4349}:  13%|█▎        | 4/30 [00:13<01:31,  3.54s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0514, 'hit_ratio@10': 0.7689, 'ndcg@10': 0.8273, 'compress@10': 0.5357, 'time@10': 5.1733}:  13%|█▎        | 4/30 [00:17<01:31,  3.54s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0514, 'hit_ratio@10': 0.7689, 'ndcg@10': 0.8273, 'compress@10': 0.5357, 'time@10': 5.1733}:  17%|█▋        | 5/30 [00:17<01:33,  3.75s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0546, 'hit_ratio@10': 0.7704, 'ndcg@10': 0.8263, 'compress@10': 0.524, 'time@10': 5.5345}:  17%|█▋        | 5/30 [00:25<01:33,  3.75s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0546, 'hit_ratio@10': 0.7704, 'ndcg@10': 0.8263, 'compress@10': 0.524, 'time@10': 5.5345}:  20%|██        | 6/30 [00:25<01:59,  4.98s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.053, 'hit_ratio@10': 0.7975, 'ndcg@10': 0.8352, 'compress@10': 0.5228, 'time@10': 5.872}:  20%|██        | 6/30 [00:29<01:59,  4.98s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.053, 'hit_ratio@10': 0.7975, 'ndcg@10': 0.8352, 'compress@10': 0.5228, 'time@10': 5.872}:  23%|██▎       | 7/30 [00:29<01:47,  4.66s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0551, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.8483, 'compress@10': 0.5157, 'time@10': 5.8351}:  23%|██▎       | 7/30 [00:34<01:47,  4.66s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0551, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.8483, 'compress@10': 0.5157, 'time@10': 5.8351}:  27%|██▋       | 8/30 [00:34<01:49,  4.96s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.055, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8607, 'compress@10': 0.5185, 'time@10': 6.1977}:  27%|██▋       | 8/30 [00:39<01:49,  4.96s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.055, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8607, 'compress@10': 0.5185, 'time@10': 6.1977}:  30%|███       | 9/30 [00:39<01:41,  4.85s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0541, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8606, 'compress@10': 0.5194, 'time@10': 6.2862}:  30%|███       | 9/30 [00:46<01:41,  4.85s/it]  {'epoch': 4, 'num_users': 6.3, 'loss': 0.0541, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8606, 'compress@10': 0.5194, 'time@10': 6.2862}:  33%|███▎      | 10/30 [00:46<01:51,  5.55s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.0549, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8603, 'compress@10': 0.5359, 'time@10': 6.4705}:  33%|███▎      | 10/30 [00:50<01:51,  5.55s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.0549, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8603, 'compress@10': 0.5359, 'time@10': 6.4705}:  37%|███▋      | 11/30 [00:50<01:37,  5.14s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0517, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8647, 'compress@10': 0.5456, 'time@10': 6.1423}:  37%|███▋      | 11/30 [00:53<01:37,  5.14s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0517, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8647, 'compress@10': 0.5456, 'time@10': 6.1423}:  40%|████      | 12/30 [00:53<01:18,  4.36s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.0521, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8664, 'compress@10': 0.5463, 'time@10': 6.2091}:  40%|████      | 12/30 [00:56<01:18,  4.36s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.0521, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8664, 'compress@10': 0.5463, 'time@10': 6.2091}:  43%|████▎     | 13/30 [00:56<01:09,  4.11s/it]{'epoch': 4, 'num_users': 6.3571, 'loss': 0.0495, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.862, 'compress@10': 0.5469, 'time@10': 5.8477}:  43%|████▎     | 13/30 [00:58<01:09,  4.11s/it] {'epoch': 4, 'num_users': 6.3571, 'loss': 0.0495, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.862, 'compress@10': 0.5469, 'time@10': 5.8477}:  47%|████▋     | 14/30 [00:58<00:51,  3.23s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.0503, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.8605, 'compress@10': 0.5459, 'time@10': 6.046}:  47%|████▋     | 14/30 [01:02<00:51,  3.23s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.0503, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.8605, 'compress@10': 0.5459, 'time@10': 6.046}:  50%|█████     | 15/30 [01:02<00:55,  3.67s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.0481, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.8611, 'compress@10': 0.5416, 'time@10': 5.8338}:  50%|█████     | 15/30 [01:05<00:55,  3.67s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.0481, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.8611, 'compress@10': 0.5416, 'time@10': 5.8338}:  53%|█████▎    | 16/30 [01:05<00:47,  3.38s/it]{'epoch': 4, 'num_users': 5.8235, 'loss': 0.0463, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8534, 'compress@10': 0.547, 'time@10': 5.5933}:  53%|█████▎    | 16/30 [01:06<00:47,  3.38s/it] {'epoch': 4, 'num_users': 5.8235, 'loss': 0.0463, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8534, 'compress@10': 0.547, 'time@10': 5.5933}:  57%|█████▋    | 17/30 [01:06<00:34,  2.64s/it]{'epoch': 4, 'num_users': 6.0556, 'loss': 0.0471, 'hit_ratio@10': 0.81, 'ndcg@10': 0.8534, 'compress@10': 0.543, 'time@10': 5.5244}:  57%|█████▋    | 17/30 [01:10<00:34,  2.64s/it]  {'epoch': 4, 'num_users': 6.0556, 'loss': 0.0471, 'hit_ratio@10': 0.81, 'ndcg@10': 0.8534, 'compress@10': 0.543, 'time@10': 5.5244}:  60%|██████    | 18/30 [01:10<00:37,  3.16s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.0455, 'hit_ratio@10': 0.8124, 'ndcg@10': 0.8558, 'compress@10': 0.5462, 'time@10': 5.4558}:  60%|██████    | 18/30 [01:13<00:37,  3.16s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.0455, 'hit_ratio@10': 0.8124, 'ndcg@10': 0.8558, 'compress@10': 0.5462, 'time@10': 5.4558}:  63%|██████▎   | 19/30 [01:13<00:31,  2.86s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.0462, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8536, 'compress@10': 0.5348, 'time@10': 5.6151}:  63%|██████▎   | 19/30 [01:21<00:31,  2.86s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.0462, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8536, 'compress@10': 0.5348, 'time@10': 5.6151}:  67%|██████▋   | 20/30 [01:21<00:46,  4.61s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0477, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.8512, 'compress@10': 0.5375, 'time@10': 5.7791}:  67%|██████▋   | 20/30 [01:26<00:46,  4.61s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0477, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.8512, 'compress@10': 0.5375, 'time@10': 5.7791}:  70%|███████   | 21/30 [01:26<00:41,  4.60s/it]{'epoch': 4, 'num_users': 6.1818, 'loss': 0.0475, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8532, 'compress@10': 0.5333, 'time@10': 5.6939}:  70%|███████   | 21/30 [01:30<00:41,  4.60s/it]{'epoch': 4, 'num_users': 6.1818, 'loss': 0.0475, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8532, 'compress@10': 0.5333, 'time@10': 5.6939}:  73%|███████▎  | 22/30 [01:30<00:35,  4.42s/it]{'epoch': 4, 'num_users': 6.1304, 'loss': 0.0464, 'hit_ratio@10': 0.8165, 'ndcg@10': 0.8553, 'compress@10': 0.5315, 'time@10': 5.7239}:  73%|███████▎  | 22/30 [01:33<00:35,  4.42s/it]{'epoch': 4, 'num_users': 6.1304, 'loss': 0.0464, 'hit_ratio@10': 0.8165, 'ndcg@10': 0.8553, 'compress@10': 0.5315, 'time@10': 5.7239}:  77%|███████▋  | 23/30 [01:33<00:28,  4.07s/it]{'epoch': 4, 'num_users': 5.9583, 'loss': 0.0462, 'hit_ratio@10': 0.8158, 'ndcg@10': 0.8485, 'compress@10': 0.5341, 'time@10': 5.5329}:  77%|███████▋  | 23/30 [01:34<00:28,  4.07s/it]{'epoch': 4, 'num_users': 5.9583, 'loss': 0.0462, 'hit_ratio@10': 0.8158, 'ndcg@10': 0.8485, 'compress@10': 0.5341, 'time@10': 5.5329}:  80%|████████  | 24/30 [01:34<00:19,  3.21s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0454, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.833, 'compress@10': 0.5398, 'time@10': 5.3536}:  80%|████████  | 24/30 [01:35<00:19,  3.21s/it]    {'epoch': 4, 'num_users': 5.8, 'loss': 0.0454, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.833, 'compress@10': 0.5398, 'time@10': 5.3536}:  83%|████████▎ | 25/30 [01:35<00:12,  2.42s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.0466, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8313, 'compress@10': 0.5348, 'time@10': 5.511}:  83%|████████▎ | 25/30 [01:44<00:12,  2.42s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.0466, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8313, 'compress@10': 0.5348, 'time@10': 5.511}:  87%|████████▋ | 26/30 [01:44<00:18,  4.54s/it]{'epoch': 4, 'num_users': 5.8889, 'loss': 0.0469, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8361, 'compress@10': 0.5324, 'time@10': 5.6322}:  87%|████████▋ | 26/30 [01:49<00:18,  4.54s/it]{'epoch': 4, 'num_users': 5.8889, 'loss': 0.0469, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8361, 'compress@10': 0.5324, 'time@10': 5.6322}:  90%|█████████ | 27/30 [01:49<00:13,  4.51s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.0472, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8366, 'compress@10': 0.5311, 'time@10': 5.7251}:  90%|█████████ | 27/30 [01:57<00:13,  4.51s/it]   {'epoch': 4, 'num_users': 6.0, 'loss': 0.0472, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8366, 'compress@10': 0.5311, 'time@10': 5.7251}:  93%|█████████▎| 28/30 [01:57<00:11,  5.64s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.0466, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8387, 'compress@10': 0.5304, 'time@10': 5.7642}:  93%|█████████▎| 28/30 [02:00<00:11,  5.64s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.0466, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8387, 'compress@10': 0.5304, 'time@10': 5.7642}:  97%|█████████▋| 29/30 [02:00<00:04,  4.99s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0464, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8407, 'compress@10': 0.5286, 'time@10': 5.7523}:  97%|█████████▋| 29/30 [02:06<00:04,  4.99s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0464, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8407, 'compress@10': 0.5286, 'time@10': 5.7523}: 100%|██████████| 30/30 [02:06<00:00,  5.13s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0464, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8407, 'compress@10': 0.5286, 'time@10': 5.7523}: 100%|██████████| 30/30 [02:06<00:00,  4.21s/it]
Epoch: 4
Avg # of users: 5.866666666666666
Avg Loss: 0.04641703820284736
Avg hit ratio: 0.8214527690725938
Avg ndcg: 0.8407338724904615
Avg compression ratio: 0.5285699053149422
Avg train time: 5.75230770111084
Std train time: 2.6639561264592113
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 15, 10, 5, 10, 10, 10, 8, 10, 10, 15, 10, 15, 9, 15, 15, 10, 10, 9, 7, 10, 10, 15, 15, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0507, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8463, 'compress@10': 0.4909, 'time@10': 5.3665}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0507, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8463, 'compress@10': 0.4909, 'time@10': 5.3665}:   3%|▎         | 1/30 [00:02<01:20,  2.79s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8443, 'compress@10': 0.4721, 'time@10': 5.2796}:   3%|▎         | 1/30 [00:08<01:20,  2.79s/it] {'epoch': 5, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8443, 'compress@10': 0.4721, 'time@10': 5.2796}:   7%|▋         | 2/30 [00:08<01:58,  4.23s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8486, 'compress@10': 0.4904, 'time@10': 4.5105}:   7%|▋         | 2/30 [00:09<01:58,  4.23s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8486, 'compress@10': 0.4904, 'time@10': 4.5105}:  10%|█         | 3/30 [00:09<01:20,  2.99s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0418, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.835, 'compress@10': 0.5184, 'time@10': 4.4879}:  10%|█         | 3/30 [00:14<01:20,  2.99s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0418, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.835, 'compress@10': 0.5184, 'time@10': 4.4879}:  13%|█▎        | 4/30 [00:14<01:32,  3.57s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0519, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8216, 'compress@10': 0.5435, 'time@10': 5.2059}:  13%|█▎        | 4/30 [00:18<01:32,  3.57s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0519, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8216, 'compress@10': 0.5435, 'time@10': 5.2059}:  17%|█▋        | 5/30 [00:18<01:33,  3.76s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0545, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8213, 'compress@10': 0.5412, 'time@10': 5.557}:  17%|█▋        | 5/30 [00:25<01:33,  3.76s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0545, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8213, 'compress@10': 0.5412, 'time@10': 5.557}:  20%|██        | 6/30 [00:25<01:59,  4.98s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0535, 'hit_ratio@10': 0.8057, 'ndcg@10': 0.8236, 'compress@10': 0.5378, 'time@10': 5.8922}:  20%|██        | 6/30 [00:29<01:59,  4.98s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0535, 'hit_ratio@10': 0.8057, 'ndcg@10': 0.8236, 'compress@10': 0.5378, 'time@10': 5.8922}:  23%|██▎       | 7/30 [00:29<01:47,  4.66s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0553, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8417, 'compress@10': 0.5238, 'time@10': 5.8523}:  23%|██▎       | 7/30 [00:35<01:47,  4.66s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0553, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8417, 'compress@10': 0.5238, 'time@10': 5.8523}:  27%|██▋       | 8/30 [00:35<01:49,  4.96s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0544, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8508, 'compress@10': 0.5278, 'time@10': 6.2111}:  27%|██▋       | 8/30 [00:39<01:49,  4.96s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0544, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8508, 'compress@10': 0.5278, 'time@10': 6.2111}:  30%|███       | 9/30 [00:39<01:41,  4.84s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0539, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8499, 'compress@10': 0.5298, 'time@10': 6.2958}:  30%|███       | 9/30 [00:46<01:41,  4.84s/it]  {'epoch': 5, 'num_users': 6.3, 'loss': 0.0539, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8499, 'compress@10': 0.5298, 'time@10': 6.2958}:  33%|███▎      | 10/30 [00:46<01:50,  5.54s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0551, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.8519, 'compress@10': 0.5496, 'time@10': 6.4822}:  33%|███▎      | 10/30 [00:50<01:50,  5.54s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0551, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.8519, 'compress@10': 0.5496, 'time@10': 6.4822}:  37%|███▋      | 11/30 [00:50<01:37,  5.13s/it]{'epoch': 5, 'num_users': 6.4167, 'loss': 0.0519, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8572, 'compress@10': 0.5639, 'time@10': 6.1655}:  37%|███▋      | 11/30 [00:53<01:37,  5.13s/it]{'epoch': 5, 'num_users': 6.4167, 'loss': 0.0519, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8572, 'compress@10': 0.5639, 'time@10': 6.1655}:  40%|████      | 12/30 [00:53<01:19,  4.40s/it]{'epoch': 5, 'num_users': 6.6154, 'loss': 0.0523, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8602, 'compress@10': 0.5573, 'time@10': 6.2229}:  40%|████      | 12/30 [00:57<01:19,  4.40s/it]{'epoch': 5, 'num_users': 6.6154, 'loss': 0.0523, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8602, 'compress@10': 0.5573, 'time@10': 6.2229}:  43%|████▎     | 13/30 [00:57<01:10,  4.13s/it]{'epoch': 5, 'num_users': 6.3571, 'loss': 0.0495, 'hit_ratio@10': 0.8077, 'ndcg@10': 0.8566, 'compress@10': 0.5586, 'time@10': 5.8649}:  43%|████▎     | 13/30 [00:58<01:10,  4.13s/it]{'epoch': 5, 'num_users': 6.3571, 'loss': 0.0495, 'hit_ratio@10': 0.8077, 'ndcg@10': 0.8566, 'compress@10': 0.5586, 'time@10': 5.8649}:  47%|████▋     | 14/30 [00:58<00:52,  3.26s/it]{'epoch': 5, 'num_users': 6.2667, 'loss': 0.0507, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.8579, 'compress@10': 0.562, 'time@10': 6.063}:  47%|████▋     | 14/30 [01:02<00:52,  3.26s/it]  {'epoch': 5, 'num_users': 6.2667, 'loss': 0.0507, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.8579, 'compress@10': 0.562, 'time@10': 6.063}:  50%|█████     | 15/30 [01:02<00:54,  3.62s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.0484, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.859, 'compress@10': 0.5546, 'time@10': 5.8517}:  50%|█████     | 15/30 [01:05<00:54,  3.62s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.0484, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.859, 'compress@10': 0.5546, 'time@10': 5.8517}:  53%|█████▎    | 16/30 [01:05<00:46,  3.35s/it]{'epoch': 5, 'num_users': 5.8235, 'loss': 0.0465, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8523, 'compress@10': 0.5583, 'time@10': 5.621}:  53%|█████▎    | 16/30 [01:06<00:46,  3.35s/it]{'epoch': 5, 'num_users': 5.8235, 'loss': 0.0465, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8523, 'compress@10': 0.5583, 'time@10': 5.621}:  57%|█████▋    | 17/30 [01:06<00:34,  2.64s/it]{'epoch': 5, 'num_users': 6.0556, 'loss': 0.0472, 'hit_ratio@10': 0.8061, 'ndcg@10': 0.8531, 'compress@10': 0.5523, 'time@10': 5.5555}:  57%|█████▋    | 17/30 [01:11<00:34,  2.64s/it]{'epoch': 5, 'num_users': 6.0556, 'loss': 0.0472, 'hit_ratio@10': 0.8061, 'ndcg@10': 0.8531, 'compress@10': 0.5523, 'time@10': 5.5555}:  60%|██████    | 18/30 [01:11<00:38,  3.20s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.0456, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8555, 'compress@10': 0.5544, 'time@10': 5.4862}:  60%|██████    | 18/30 [01:13<00:38,  3.20s/it]   {'epoch': 5, 'num_users': 6.0, 'loss': 0.0456, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8555, 'compress@10': 0.5544, 'time@10': 5.4862}:  63%|██████▎   | 19/30 [01:13<00:31,  2.89s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.0462, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8536, 'compress@10': 0.5448, 'time@10': 5.6287}:  63%|██████▎   | 19/30 [01:21<00:31,  2.89s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.0462, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8536, 'compress@10': 0.5448, 'time@10': 5.6287}:  67%|██████▋   | 20/30 [01:21<00:45,  4.53s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0477, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.8516, 'compress@10': 0.5482, 'time@10': 5.7943}:  67%|██████▋   | 20/30 [01:26<00:45,  4.53s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0477, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.8516, 'compress@10': 0.5482, 'time@10': 5.7943}:  70%|███████   | 21/30 [01:26<00:40,  4.55s/it]{'epoch': 5, 'num_users': 6.1818, 'loss': 0.0479, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8522, 'compress@10': 0.5453, 'time@10': 5.6862}:  70%|███████   | 21/30 [01:29<00:40,  4.55s/it]{'epoch': 5, 'num_users': 6.1818, 'loss': 0.0479, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8522, 'compress@10': 0.5453, 'time@10': 5.6862}:  73%|███████▎  | 22/30 [01:29<00:33,  4.22s/it]{'epoch': 5, 'num_users': 6.1304, 'loss': 0.047, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.854, 'compress@10': 0.5425, 'time@10': 5.7113}:  73%|███████▎  | 22/30 [01:32<00:33,  4.22s/it]  {'epoch': 5, 'num_users': 6.1304, 'loss': 0.047, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.854, 'compress@10': 0.5425, 'time@10': 5.7113}:  77%|███████▋  | 23/30 [01:32<00:27,  3.91s/it]{'epoch': 5, 'num_users': 5.9583, 'loss': 0.0467, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8473, 'compress@10': 0.5458, 'time@10': 5.5142}:  77%|███████▋  | 23/30 [01:33<00:27,  3.91s/it]{'epoch': 5, 'num_users': 5.9583, 'loss': 0.0467, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8473, 'compress@10': 0.5458, 'time@10': 5.5142}:  80%|████████  | 24/30 [01:33<00:18,  3.04s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0456, 'hit_ratio@10': 0.8068, 'ndcg@10': 0.8367, 'compress@10': 0.5509, 'time@10': 5.3328}:  80%|████████  | 24/30 [01:34<00:18,  3.04s/it]   {'epoch': 5, 'num_users': 5.8, 'loss': 0.0456, 'hit_ratio@10': 0.8068, 'ndcg@10': 0.8367, 'compress@10': 0.5509, 'time@10': 5.3328}:  83%|████████▎ | 25/30 [01:34<00:11,  2.29s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.0467, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.835, 'compress@10': 0.5443, 'time@10': 5.4866}:  83%|████████▎ | 25/30 [01:43<00:11,  2.29s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.0467, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.835, 'compress@10': 0.5443, 'time@10': 5.4866}:  87%|████████▋ | 26/30 [01:43<00:17,  4.41s/it]{'epoch': 5, 'num_users': 5.8889, 'loss': 0.046, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8372, 'compress@10': 0.5435, 'time@10': 5.6124}:  87%|████████▋ | 26/30 [01:48<00:17,  4.41s/it]{'epoch': 5, 'num_users': 5.8889, 'loss': 0.046, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8372, 'compress@10': 0.5435, 'time@10': 5.6124}:  90%|█████████ | 27/30 [01:48<00:13,  4.43s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.0465, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8377, 'compress@10': 0.5386, 'time@10': 5.7081}:  90%|█████████ | 27/30 [01:56<00:13,  4.43s/it]  {'epoch': 5, 'num_users': 6.0, 'loss': 0.0465, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8377, 'compress@10': 0.5386, 'time@10': 5.7081}:  93%|█████████▎| 28/30 [01:56<00:11,  5.60s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.0461, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8397, 'compress@10': 0.5376, 'time@10': 5.7276}:  93%|█████████▎| 28/30 [01:59<00:11,  5.60s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.0461, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8397, 'compress@10': 0.5376, 'time@10': 5.7276}:  97%|█████████▋| 29/30 [01:59<00:04,  4.88s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0462, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8433, 'compress@10': 0.5345, 'time@10': 5.7053}:  97%|█████████▋| 29/30 [02:04<00:04,  4.88s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0462, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8433, 'compress@10': 0.5345, 'time@10': 5.7053}: 100%|██████████| 30/30 [02:04<00:00,  4.94s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0462, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8433, 'compress@10': 0.5345, 'time@10': 5.7053}: 100%|██████████| 30/30 [02:04<00:00,  4.16s/it]
Epoch: 5
Avg # of users: 5.866666666666666
Avg Loss: 0.04624996532803453
Avg hit ratio: 0.8177674281174537
Avg ndcg: 0.8432941541913548
Avg compression ratio: 0.534455363269087
Avg train time: 5.705331389109293
Std train time: 2.645055091683976
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 16, 10, 5, 10, 10, 10, 8, 10, 10, 16, 10, 16, 9, 16, 16, 10, 10, 9, 7, 10, 10, 16, 16, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8527, 'compress@10': 0.4541, 'time@10': 5.2127}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8527, 'compress@10': 0.4541, 'time@10': 5.2127}:   3%|▎         | 1/30 [00:02<01:16,  2.64s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8505, 'compress@10': 0.4662, 'time@10': 5.1523}:   3%|▎         | 1/30 [00:07<01:16,  2.64s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8505, 'compress@10': 0.4662, 'time@10': 5.1523}:   7%|▋         | 2/30 [00:07<01:54,  4.11s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8527, 'compress@10': 0.4812, 'time@10': 4.5119}:   7%|▋         | 2/30 [00:09<01:54,  4.11s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8527, 'compress@10': 0.4812, 'time@10': 4.5119}:  10%|█         | 3/30 [00:09<01:20,  2.99s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0406, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8295, 'compress@10': 0.5118, 'time@10': 4.4953}:  10%|█         | 3/30 [00:13<01:20,  2.99s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0406, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8295, 'compress@10': 0.5118, 'time@10': 4.4953}:  13%|█▎        | 4/30 [00:13<01:33,  3.58s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0507, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8176, 'compress@10': 0.5344, 'time@10': 5.2576}:  13%|█▎        | 4/30 [00:18<01:33,  3.58s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0507, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8176, 'compress@10': 0.5344, 'time@10': 5.2576}:  17%|█▋        | 5/30 [00:18<01:35,  3.80s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0531, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8196, 'compress@10': 0.5481, 'time@10': 5.5854}:  17%|█▋        | 5/30 [00:25<01:35,  3.80s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0531, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8196, 'compress@10': 0.5481, 'time@10': 5.5854}:  20%|██        | 6/30 [00:25<01:59,  4.98s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0545, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8258, 'compress@10': 0.5504, 'time@10': 5.9814}:  20%|██        | 6/30 [00:29<01:59,  4.98s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0545, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8258, 'compress@10': 0.5504, 'time@10': 5.9814}:  23%|██▎       | 7/30 [00:29<01:48,  4.73s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.055, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8423, 'compress@10': 0.5417, 'time@10': 5.9489}:  23%|██▎       | 7/30 [00:35<01:48,  4.73s/it]  {'epoch': 6, 'num_users': 6.125, 'loss': 0.055, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8423, 'compress@10': 0.5417, 'time@10': 5.9489}:  27%|██▋       | 8/30 [00:35<01:51,  5.06s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0535, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8526, 'compress@10': 0.5448, 'time@10': 6.2938}:  27%|██▋       | 8/30 [00:39<01:51,  5.06s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0535, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8526, 'compress@10': 0.5448, 'time@10': 6.2938}:  30%|███       | 9/30 [00:39<01:43,  4.91s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0525, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8543, 'compress@10': 0.547, 'time@10': 6.4031}:  30%|███       | 9/30 [00:47<01:43,  4.91s/it]     {'epoch': 6, 'num_users': 6.3, 'loss': 0.0525, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8543, 'compress@10': 0.547, 'time@10': 6.4031}:  33%|███▎      | 10/30 [00:47<01:54,  5.71s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.0539, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8563, 'compress@10': 0.5669, 'time@10': 6.5576}:  33%|███▎      | 10/30 [00:51<01:54,  5.71s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.0539, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8563, 'compress@10': 0.5669, 'time@10': 6.5576}:  37%|███▋      | 11/30 [00:51<01:39,  5.21s/it]{'epoch': 6, 'num_users': 6.4167, 'loss': 0.0507, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8613, 'compress@10': 0.5796, 'time@10': 6.2484}:  37%|███▋      | 11/30 [00:54<01:39,  5.21s/it]{'epoch': 6, 'num_users': 6.4167, 'loss': 0.0507, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8613, 'compress@10': 0.5796, 'time@10': 6.2484}:  40%|████      | 12/30 [00:54<01:21,  4.51s/it]{'epoch': 6, 'num_users': 6.6154, 'loss': 0.0511, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8637, 'compress@10': 0.5672, 'time@10': 6.2764}:  40%|████      | 12/30 [00:57<01:21,  4.51s/it]{'epoch': 6, 'num_users': 6.6154, 'loss': 0.0511, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8637, 'compress@10': 0.5672, 'time@10': 6.2764}:  43%|████▎     | 13/30 [00:57<01:10,  4.15s/it]{'epoch': 6, 'num_users': 6.3571, 'loss': 0.0483, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8599, 'compress@10': 0.5691, 'time@10': 5.9213}:  43%|████▎     | 13/30 [00:59<01:10,  4.15s/it]{'epoch': 6, 'num_users': 6.3571, 'loss': 0.0483, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8599, 'compress@10': 0.5691, 'time@10': 5.9213}:  47%|████▋     | 14/30 [00:59<00:52,  3.31s/it]{'epoch': 6, 'num_users': 6.2667, 'loss': 0.0499, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8549, 'compress@10': 0.5736, 'time@10': 6.1119}:  47%|████▋     | 14/30 [01:03<00:52,  3.31s/it] {'epoch': 6, 'num_users': 6.2667, 'loss': 0.0499, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8549, 'compress@10': 0.5736, 'time@10': 6.1119}:  50%|█████     | 15/30 [01:03<00:54,  3.64s/it]{'epoch': 6, 'num_users': 6.0625, 'loss': 0.0476, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8562, 'compress@10': 0.5667, 'time@10': 5.9096}:  50%|█████     | 15/30 [01:06<00:54,  3.64s/it]{'epoch': 6, 'num_users': 6.0625, 'loss': 0.0476, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8562, 'compress@10': 0.5667, 'time@10': 5.9096}:  53%|█████▎    | 16/30 [01:06<00:47,  3.43s/it]{'epoch': 6, 'num_users': 5.8235, 'loss': 0.0456, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8496, 'compress@10': 0.5685, 'time@10': 5.6849}:  53%|█████▎    | 16/30 [01:07<00:47,  3.43s/it] {'epoch': 6, 'num_users': 5.8235, 'loss': 0.0456, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8496, 'compress@10': 0.5685, 'time@10': 5.6849}:  57%|█████▋    | 17/30 [01:07<00:35,  2.72s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.0462, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8509, 'compress@10': 0.5639, 'time@10': 5.6167}:  57%|█████▋    | 17/30 [01:12<00:35,  2.72s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.0462, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8509, 'compress@10': 0.5639, 'time@10': 5.6167}:  60%|██████    | 18/30 [01:12<00:39,  3.25s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.0447, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8535, 'compress@10': 0.5661, 'time@10': 5.5463}:  60%|██████    | 18/30 [01:14<00:39,  3.25s/it]   {'epoch': 6, 'num_users': 6.0, 'loss': 0.0447, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8535, 'compress@10': 0.5661, 'time@10': 5.5463}:  63%|██████▎   | 19/30 [01:14<00:32,  2.93s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.0452, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.852, 'compress@10': 0.5596, 'time@10': 5.6871}:  63%|██████▎   | 19/30 [01:22<00:32,  2.93s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.0452, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.852, 'compress@10': 0.5596, 'time@10': 5.6871}:  67%|██████▋   | 20/30 [01:22<00:45,  4.59s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0468, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.85, 'compress@10': 0.5633, 'time@10': 5.8504}:  67%|██████▋   | 20/30 [01:27<00:45,  4.59s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0468, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.85, 'compress@10': 0.5633, 'time@10': 5.8504}:  70%|███████   | 21/30 [01:27<00:41,  4.59s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.0473, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8524, 'compress@10': 0.5614, 'time@10': 5.7419}:  70%|███████   | 21/30 [01:30<00:41,  4.59s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.0473, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8524, 'compress@10': 0.5614, 'time@10': 5.7419}:  73%|███████▎  | 22/30 [01:30<00:34,  4.27s/it]{'epoch': 6, 'num_users': 6.1304, 'loss': 0.0465, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8546, 'compress@10': 0.5592, 'time@10': 5.7617}:  73%|███████▎  | 22/30 [01:33<00:34,  4.27s/it]{'epoch': 6, 'num_users': 6.1304, 'loss': 0.0465, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8546, 'compress@10': 0.5592, 'time@10': 5.7617}:  77%|███████▋  | 23/30 [01:33<00:27,  3.93s/it]{'epoch': 6, 'num_users': 5.9583, 'loss': 0.0461, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8479, 'compress@10': 0.5611, 'time@10': 5.5653}:  77%|███████▋  | 23/30 [01:35<00:27,  3.93s/it]{'epoch': 6, 'num_users': 5.9583, 'loss': 0.0461, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8479, 'compress@10': 0.5611, 'time@10': 5.5653}:  80%|████████  | 24/30 [01:35<00:18,  3.08s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0449, 'hit_ratio@10': 0.8194, 'ndcg@10': 0.8377, 'compress@10': 0.5663, 'time@10': 5.3845}:  80%|████████  | 24/30 [01:35<00:18,  3.08s/it]   {'epoch': 6, 'num_users': 5.8, 'loss': 0.0449, 'hit_ratio@10': 0.8194, 'ndcg@10': 0.8377, 'compress@10': 0.5663, 'time@10': 5.3845}:  83%|████████▎ | 25/30 [01:35<00:11,  2.32s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.0458, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.8366, 'compress@10': 0.558, 'time@10': 5.5345}:  83%|████████▎ | 25/30 [01:44<00:11,  2.32s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.0458, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.8366, 'compress@10': 0.558, 'time@10': 5.5345}:  87%|████████▋ | 26/30 [01:44<00:17,  4.42s/it]{'epoch': 6, 'num_users': 5.8889, 'loss': 0.0453, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8384, 'compress@10': 0.5575, 'time@10': 5.6588}:  87%|████████▋ | 26/30 [01:49<00:17,  4.42s/it]{'epoch': 6, 'num_users': 5.8889, 'loss': 0.0453, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8384, 'compress@10': 0.5575, 'time@10': 5.6588}:  90%|█████████ | 27/30 [01:49<00:13,  4.44s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.0455, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.839, 'compress@10': 0.5511, 'time@10': 5.7423}:  90%|█████████ | 27/30 [01:57<00:13,  4.44s/it]   {'epoch': 6, 'num_users': 6.0, 'loss': 0.0455, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.839, 'compress@10': 0.5511, 'time@10': 5.7423}:  93%|█████████▎| 28/30 [01:57<00:11,  5.52s/it]{'epoch': 6, 'num_users': 5.8621, 'loss': 0.045, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.841, 'compress@10': 0.5499, 'time@10': 5.7379}:  93%|█████████▎| 28/30 [02:00<00:11,  5.52s/it]{'epoch': 6, 'num_users': 5.8621, 'loss': 0.045, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.841, 'compress@10': 0.5499, 'time@10': 5.7379}:  97%|█████████▋| 29/30 [02:00<00:04,  4.72s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0449, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8429, 'compress@10': 0.546, 'time@10': 5.7233}:  97%|█████████▋| 29/30 [02:05<00:04,  4.72s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0449, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8429, 'compress@10': 0.546, 'time@10': 5.7233}: 100%|██████████| 30/30 [02:05<00:00,  4.90s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0449, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8429, 'compress@10': 0.546, 'time@10': 5.7233}: 100%|██████████| 30/30 [02:05<00:00,  4.19s/it]
Epoch: 6
Avg # of users: 5.866666666666666
Avg Loss: 0.044930825321373366
Avg hit ratio: 0.8294089944388436
Avg ndcg: 0.8428512431291808
Avg compression ratio: 0.5459668419098427
Avg train time: 5.723278331756592
Std train time: 2.5978146718559967
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 16, 10, 5, 10, 10, 10, 8, 10, 10, 17, 10, 17, 9, 17, 17, 10, 10, 9, 7, 10, 10, 17, 17, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8423, 'compress@10': 0.4531, 'time@10': 4.679}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8423, 'compress@10': 0.4531, 'time@10': 4.679}:   3%|▎         | 1/30 [00:02<01:08,  2.37s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8514, 'compress@10': 0.4872, 'time@10': 4.6144}:   3%|▎         | 1/30 [00:06<01:08,  2.37s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8514, 'compress@10': 0.4872, 'time@10': 4.6144}:   7%|▋         | 2/30 [00:06<01:42,  3.68s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8533, 'compress@10': 0.493, 'time@10': 4.1308}:   7%|▋         | 2/30 [00:08<01:42,  3.68s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8533, 'compress@10': 0.493, 'time@10': 4.1308}:  10%|█         | 3/30 [00:08<01:13,  2.74s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8415, 'compress@10': 0.5256, 'time@10': 4.2077}:  10%|█         | 3/30 [00:13<01:13,  2.74s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8415, 'compress@10': 0.5256, 'time@10': 4.2077}:  13%|█▎        | 4/30 [00:13<01:29,  3.43s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0481, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8265, 'compress@10': 0.5369, 'time@10': 4.9853}:  13%|█▎        | 4/30 [00:17<01:29,  3.43s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0481, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8265, 'compress@10': 0.5369, 'time@10': 4.9853}:  17%|█▋        | 5/30 [00:17<01:31,  3.66s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0502, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.826, 'compress@10': 0.5606, 'time@10': 5.3751}:  17%|█▋        | 5/30 [00:24<01:31,  3.66s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0502, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.826, 'compress@10': 0.5606, 'time@10': 5.3751}:  20%|██        | 6/30 [00:24<01:58,  4.92s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0503, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8247, 'compress@10': 0.5679, 'time@10': 5.7425}:  20%|██        | 6/30 [00:28<01:58,  4.92s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0503, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8247, 'compress@10': 0.5679, 'time@10': 5.7425}:  23%|██▎       | 7/30 [00:28<01:46,  4.63s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0509, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8399, 'compress@10': 0.5657, 'time@10': 5.7238}:  23%|██▎       | 7/30 [00:34<01:46,  4.63s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0509, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8399, 'compress@10': 0.5657, 'time@10': 5.7238}:  27%|██▋       | 8/30 [00:34<01:48,  4.95s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8502, 'compress@10': 0.565, 'time@10': 6.0776}:  27%|██▋       | 8/30 [00:38<01:48,  4.95s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8502, 'compress@10': 0.565, 'time@10': 6.0776}:  30%|███       | 9/30 [00:38<01:40,  4.81s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0502, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8496, 'compress@10': 0.5618, 'time@10': 6.18}:  30%|███       | 9/30 [00:45<01:40,  4.81s/it]    {'epoch': 7, 'num_users': 6.3, 'loss': 0.0502, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8496, 'compress@10': 0.5618, 'time@10': 6.18}:  33%|███▎      | 10/30 [00:45<01:50,  5.53s/it]{'epoch': 7, 'num_users': 6.6364, 'loss': 0.0521, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8523, 'compress@10': 0.5802, 'time@10': 6.3783}:  33%|███▎      | 10/30 [00:50<01:50,  5.53s/it]{'epoch': 7, 'num_users': 6.6364, 'loss': 0.0521, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8523, 'compress@10': 0.5802, 'time@10': 6.3783}:  37%|███▋      | 11/30 [00:50<01:37,  5.13s/it]{'epoch': 7, 'num_users': 6.4167, 'loss': 0.049, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8558, 'compress@10': 0.5915, 'time@10': 6.1008}:  37%|███▋      | 11/30 [00:53<01:37,  5.13s/it] {'epoch': 7, 'num_users': 6.4167, 'loss': 0.049, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8558, 'compress@10': 0.5915, 'time@10': 6.1008}:  40%|████      | 12/30 [00:53<01:21,  4.51s/it]{'epoch': 7, 'num_users': 6.6154, 'loss': 0.0493, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8584, 'compress@10': 0.5767, 'time@10': 6.1719}:  40%|████      | 12/30 [00:56<01:21,  4.51s/it]{'epoch': 7, 'num_users': 6.6154, 'loss': 0.0493, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8584, 'compress@10': 0.5767, 'time@10': 6.1719}:  43%|████▎     | 13/30 [00:56<01:11,  4.22s/it]{'epoch': 7, 'num_users': 6.3571, 'loss': 0.0466, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8549, 'compress@10': 0.5793, 'time@10': 5.8296}:  43%|████▎     | 13/30 [00:58<01:11,  4.22s/it]{'epoch': 7, 'num_users': 6.3571, 'loss': 0.0466, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8549, 'compress@10': 0.5793, 'time@10': 5.8296}:  47%|████▋     | 14/30 [00:58<00:53,  3.37s/it]{'epoch': 7, 'num_users': 6.2667, 'loss': 0.0473, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8542, 'compress@10': 0.5833, 'time@10': 6.0329}:  47%|████▋     | 14/30 [01:02<00:53,  3.37s/it]{'epoch': 7, 'num_users': 6.2667, 'loss': 0.0473, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8542, 'compress@10': 0.5833, 'time@10': 6.0329}:  50%|█████     | 15/30 [01:02<00:55,  3.71s/it]{'epoch': 7, 'num_users': 6.0625, 'loss': 0.0452, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8555, 'compress@10': 0.5811, 'time@10': 5.8449}:  50%|█████     | 15/30 [01:05<00:55,  3.71s/it]{'epoch': 7, 'num_users': 6.0625, 'loss': 0.0452, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8555, 'compress@10': 0.5811, 'time@10': 5.8449}:  53%|█████▎    | 16/30 [01:05<00:49,  3.51s/it]{'epoch': 7, 'num_users': 5.8235, 'loss': 0.0432, 'hit_ratio@10': 0.8109, 'ndcg@10': 0.8491, 'compress@10': 0.5804, 'time@10': 5.6314}:  53%|█████▎    | 16/30 [01:06<00:49,  3.51s/it]{'epoch': 7, 'num_users': 5.8235, 'loss': 0.0432, 'hit_ratio@10': 0.8109, 'ndcg@10': 0.8491, 'compress@10': 0.5804, 'time@10': 5.6314}:  57%|█████▋    | 17/30 [01:06<00:36,  2.80s/it]{'epoch': 7, 'num_users': 6.0556, 'loss': 0.0438, 'hit_ratio@10': 0.8056, 'ndcg@10': 0.8495, 'compress@10': 0.5765, 'time@10': 5.5654}:  57%|█████▋    | 17/30 [01:11<00:36,  2.80s/it]{'epoch': 7, 'num_users': 6.0556, 'loss': 0.0438, 'hit_ratio@10': 0.8056, 'ndcg@10': 0.8495, 'compress@10': 0.5765, 'time@10': 5.5654}:  60%|██████    | 18/30 [01:11<00:39,  3.31s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.0424, 'hit_ratio@10': 0.8083, 'ndcg@10': 0.8514, 'compress@10': 0.5778, 'time@10': 5.5038}:  60%|██████    | 18/30 [01:13<00:39,  3.31s/it]   {'epoch': 7, 'num_users': 6.0, 'loss': 0.0424, 'hit_ratio@10': 0.8083, 'ndcg@10': 0.8514, 'compress@10': 0.5778, 'time@10': 5.5038}:  63%|██████▎   | 19/30 [01:13<00:32,  2.99s/it]{'epoch': 7, 'num_users': 6.15, 'loss': 0.043, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8502, 'compress@10': 0.572, 'time@10': 5.6618}:  63%|██████▎   | 19/30 [01:22<00:32,  2.99s/it] {'epoch': 7, 'num_users': 6.15, 'loss': 0.043, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8502, 'compress@10': 0.572, 'time@10': 5.6618}:  67%|██████▋   | 20/30 [01:22<00:47,  4.71s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0445, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8485, 'compress@10': 0.5752, 'time@10': 5.8208}:  67%|██████▋   | 20/30 [01:26<00:47,  4.71s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0445, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8485, 'compress@10': 0.5752, 'time@10': 5.8208}:  70%|███████   | 21/30 [01:26<00:41,  4.66s/it]{'epoch': 7, 'num_users': 6.1818, 'loss': 0.0448, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8507, 'compress@10': 0.5752, 'time@10': 5.7135}:  70%|███████   | 21/30 [01:30<00:41,  4.66s/it]{'epoch': 7, 'num_users': 6.1818, 'loss': 0.0448, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8507, 'compress@10': 0.5752, 'time@10': 5.7135}:  73%|███████▎  | 22/30 [01:30<00:34,  4.31s/it]{'epoch': 7, 'num_users': 6.1304, 'loss': 0.044, 'hit_ratio@10': 0.819, 'ndcg@10': 0.8527, 'compress@10': 0.5747, 'time@10': 5.7349}:  73%|███████▎  | 22/30 [01:33<00:34,  4.31s/it]  {'epoch': 7, 'num_users': 6.1304, 'loss': 0.044, 'hit_ratio@10': 0.819, 'ndcg@10': 0.8527, 'compress@10': 0.5747, 'time@10': 5.7349}:  77%|███████▋  | 23/30 [01:33<00:27,  3.96s/it]{'epoch': 7, 'num_users': 5.9583, 'loss': 0.0436, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8466, 'compress@10': 0.5747, 'time@10': 5.5415}:  77%|███████▋  | 23/30 [01:34<00:27,  3.96s/it]{'epoch': 7, 'num_users': 5.9583, 'loss': 0.0436, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8466, 'compress@10': 0.5747, 'time@10': 5.5415}:  80%|████████  | 24/30 [01:34<00:18,  3.11s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0424, 'hit_ratio@10': 0.8121, 'ndcg@10': 0.8365, 'compress@10': 0.5802, 'time@10': 5.3638}:  80%|████████  | 24/30 [01:35<00:18,  3.11s/it]   {'epoch': 7, 'num_users': 5.8, 'loss': 0.0424, 'hit_ratio@10': 0.8121, 'ndcg@10': 0.8365, 'compress@10': 0.5802, 'time@10': 5.3638}:  83%|████████▎ | 25/30 [01:35<00:11,  2.36s/it]{'epoch': 7, 'num_users': 5.8077, 'loss': 0.0433, 'hit_ratio@10': 0.8137, 'ndcg@10': 0.8358, 'compress@10': 0.5704, 'time@10': 5.5379}:  83%|████████▎ | 25/30 [01:45<00:11,  2.36s/it]{'epoch': 7, 'num_users': 5.8077, 'loss': 0.0433, 'hit_ratio@10': 0.8137, 'ndcg@10': 0.8358, 'compress@10': 0.5704, 'time@10': 5.5379}:  87%|████████▋ | 26/30 [01:45<00:18,  4.63s/it]{'epoch': 7, 'num_users': 5.8889, 'loss': 0.0436, 'hit_ratio@10': 0.818, 'ndcg@10': 0.8342, 'compress@10': 0.5721, 'time@10': 5.6966}:  87%|████████▋ | 26/30 [01:50<00:18,  4.63s/it] {'epoch': 7, 'num_users': 5.8889, 'loss': 0.0436, 'hit_ratio@10': 0.818, 'ndcg@10': 0.8342, 'compress@10': 0.5721, 'time@10': 5.6966}:  90%|█████████ | 27/30 [01:50<00:14,  4.73s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.0438, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8354, 'compress@10': 0.5643, 'time@10': 5.7601}:  90%|█████████ | 27/30 [01:57<00:14,  4.73s/it]  {'epoch': 7, 'num_users': 6.0, 'loss': 0.0438, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8354, 'compress@10': 0.5643, 'time@10': 5.7601}:  93%|█████████▎| 28/30 [01:57<00:11,  5.56s/it]{'epoch': 7, 'num_users': 5.8621, 'loss': 0.0433, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8376, 'compress@10': 0.5633, 'time@10': 5.7564}:  93%|█████████▎| 28/30 [02:00<00:11,  5.56s/it]{'epoch': 7, 'num_users': 5.8621, 'loss': 0.0433, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8376, 'compress@10': 0.5633, 'time@10': 5.7564}:  97%|█████████▋| 29/30 [02:00<00:04,  4.75s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0433, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8397, 'compress@10': 0.5583, 'time@10': 5.7375}:  97%|█████████▋| 29/30 [02:05<00:04,  4.75s/it] {'epoch': 7, 'num_users': 5.8667, 'loss': 0.0433, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8397, 'compress@10': 0.5583, 'time@10': 5.7375}: 100%|██████████| 30/30 [02:05<00:00,  4.90s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0433, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8397, 'compress@10': 0.5583, 'time@10': 5.7375}: 100%|██████████| 30/30 [02:05<00:00,  4.19s/it]
Epoch: 7
Avg # of users: 5.866666666666666
Avg Loss: 0.04327930450795181
Avg hit ratio: 0.8239778147657284
Avg ndcg: 0.8396597486556381
Avg compression ratio: 0.55829286122944
Avg train time: 5.7374958276748655
Std train time: 2.636716875208734
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 16, 10, 5, 10, 10, 10, 8, 10, 10, 18, 10, 18, 9, 18, 18, 10, 10, 9, 7, 10, 10, 18, 18, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.053, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8749, 'compress@10': 0.4625, 'time@10': 5.2197}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.053, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8749, 'compress@10': 0.4625, 'time@10': 5.2197}:   3%|▎         | 1/30 [00:02<01:16,  2.64s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8748, 'compress@10': 0.5131, 'time@10': 5.1207}:   3%|▎         | 1/30 [00:07<01:16,  2.64s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8748, 'compress@10': 0.5131, 'time@10': 5.1207}:   7%|▋         | 2/30 [00:07<01:53,  4.07s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8689, 'compress@10': 0.5151, 'time@10': 4.4605}:   7%|▋         | 2/30 [00:09<01:53,  4.07s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8689, 'compress@10': 0.5151, 'time@10': 4.4605}:  10%|█         | 3/30 [00:09<01:19,  2.94s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0362, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8593, 'compress@10': 0.5455, 'time@10': 4.4588}:  10%|█         | 3/30 [00:13<01:19,  2.94s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0362, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8593, 'compress@10': 0.5455, 'time@10': 4.4588}:  13%|█▎        | 4/30 [00:13<01:32,  3.56s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0467, 'hit_ratio@10': 0.7942, 'ndcg@10': 0.8408, 'compress@10': 0.5427, 'time@10': 5.1692}:  13%|█▎        | 4/30 [00:17<01:32,  3.56s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0467, 'hit_ratio@10': 0.7942, 'ndcg@10': 0.8408, 'compress@10': 0.5427, 'time@10': 5.1692}:  17%|█▋        | 5/30 [00:17<01:33,  3.73s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0486, 'hit_ratio@10': 0.8025, 'ndcg@10': 0.8391, 'compress@10': 0.5724, 'time@10': 5.5181}:  17%|█▋        | 5/30 [00:25<01:33,  3.73s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0486, 'hit_ratio@10': 0.8025, 'ndcg@10': 0.8391, 'compress@10': 0.5724, 'time@10': 5.5181}:  20%|██        | 6/30 [00:25<01:58,  4.95s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0485, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8451, 'compress@10': 0.5817, 'time@10': 5.8568}:  20%|██        | 6/30 [00:29<01:58,  4.95s/it] {'epoch': 8, 'num_users': 6.2857, 'loss': 0.0485, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8451, 'compress@10': 0.5817, 'time@10': 5.8568}:  23%|██▎       | 7/30 [00:29<01:46,  4.63s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0492, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8576, 'compress@10': 0.5808, 'time@10': 5.8109}:  23%|██▎       | 7/30 [00:34<01:46,  4.63s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0492, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8576, 'compress@10': 0.5808, 'time@10': 5.8109}:  27%|██▋       | 8/30 [00:34<01:48,  4.92s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0487, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8663, 'compress@10': 0.5799, 'time@10': 6.1667}:  27%|██▋       | 8/30 [00:39<01:48,  4.92s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0487, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8663, 'compress@10': 0.5799, 'time@10': 6.1667}:  30%|███       | 9/30 [00:39<01:40,  4.80s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0474, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8676, 'compress@10': 0.5776, 'time@10': 6.2647}:  30%|███       | 9/30 [00:46<01:40,  4.80s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0474, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8676, 'compress@10': 0.5776, 'time@10': 6.2647}:  33%|███▎      | 10/30 [00:46<01:50,  5.54s/it]{'epoch': 8, 'num_users': 6.6364, 'loss': 0.0503, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8723, 'compress@10': 0.5948, 'time@10': 6.4571}:  33%|███▎      | 10/30 [00:50<01:50,  5.54s/it]{'epoch': 8, 'num_users': 6.6364, 'loss': 0.0503, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8723, 'compress@10': 0.5948, 'time@10': 6.4571}:  37%|███▋      | 11/30 [00:50<01:37,  5.14s/it]{'epoch': 8, 'num_users': 6.4167, 'loss': 0.0474, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8741, 'compress@10': 0.6053, 'time@10': 6.1897}:  37%|███▋      | 11/30 [00:53<01:37,  5.14s/it] {'epoch': 8, 'num_users': 6.4167, 'loss': 0.0474, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8741, 'compress@10': 0.6053, 'time@10': 6.1897}:  40%|████      | 12/30 [00:53<01:22,  4.58s/it]{'epoch': 8, 'num_users': 6.6154, 'loss': 0.0477, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8751, 'compress@10': 0.5891, 'time@10': 6.2552}:  40%|████      | 12/30 [00:57<01:22,  4.58s/it]{'epoch': 8, 'num_users': 6.6154, 'loss': 0.0477, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8751, 'compress@10': 0.5891, 'time@10': 6.2552}:  43%|████▎     | 13/30 [00:57<01:12,  4.27s/it]{'epoch': 8, 'num_users': 6.3571, 'loss': 0.045, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8704, 'compress@10': 0.5918, 'time@10': 5.9131}:  43%|████▎     | 13/30 [00:58<01:12,  4.27s/it] {'epoch': 8, 'num_users': 6.3571, 'loss': 0.045, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8704, 'compress@10': 0.5918, 'time@10': 5.9131}:  47%|████▋     | 14/30 [00:58<00:54,  3.43s/it]{'epoch': 8, 'num_users': 6.2667, 'loss': 0.0451, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.871, 'compress@10': 0.5964, 'time@10': 6.1144}:  47%|████▋     | 14/30 [01:03<00:54,  3.43s/it]{'epoch': 8, 'num_users': 6.2667, 'loss': 0.0451, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.871, 'compress@10': 0.5964, 'time@10': 6.1144}:  50%|█████     | 15/30 [01:03<00:56,  3.76s/it]{'epoch': 8, 'num_users': 6.0625, 'loss': 0.0431, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8712, 'compress@10': 0.5962, 'time@10': 5.9345}:  50%|█████     | 15/30 [01:06<00:56,  3.76s/it]{'epoch': 8, 'num_users': 6.0625, 'loss': 0.0431, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8712, 'compress@10': 0.5962, 'time@10': 5.9345}:  53%|█████▎    | 16/30 [01:06<00:50,  3.61s/it]{'epoch': 8, 'num_users': 5.8235, 'loss': 0.0412, 'hit_ratio@10': 0.8161, 'ndcg@10': 0.8638, 'compress@10': 0.5929, 'time@10': 5.7241}:  53%|█████▎    | 16/30 [01:07<00:50,  3.61s/it]{'epoch': 8, 'num_users': 5.8235, 'loss': 0.0412, 'hit_ratio@10': 0.8161, 'ndcg@10': 0.8638, 'compress@10': 0.5929, 'time@10': 5.7241}:  57%|█████▋    | 17/30 [01:07<00:37,  2.89s/it]{'epoch': 8, 'num_users': 6.0556, 'loss': 0.0417, 'hit_ratio@10': 0.8125, 'ndcg@10': 0.8642, 'compress@10': 0.5908, 'time@10': 5.6564}:  57%|█████▋    | 17/30 [01:12<00:37,  2.89s/it]{'epoch': 8, 'num_users': 6.0556, 'loss': 0.0417, 'hit_ratio@10': 0.8125, 'ndcg@10': 0.8642, 'compress@10': 0.5908, 'time@10': 5.6564}:  60%|██████    | 18/30 [01:12<00:40,  3.39s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.0405, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.865, 'compress@10': 0.592, 'time@10': 5.5838}:  60%|██████    | 18/30 [01:14<00:40,  3.39s/it]     {'epoch': 8, 'num_users': 6.0, 'loss': 0.0405, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.865, 'compress@10': 0.592, 'time@10': 5.5838}:  63%|██████▎   | 19/30 [01:14<00:33,  3.03s/it]{'epoch': 8, 'num_users': 6.15, 'loss': 0.041, 'hit_ratio@10': 0.8188, 'ndcg@10': 0.8631, 'compress@10': 0.5865, 'time@10': 5.7238}:  63%|██████▎   | 19/30 [01:23<00:33,  3.03s/it]{'epoch': 8, 'num_users': 6.15, 'loss': 0.041, 'hit_ratio@10': 0.8188, 'ndcg@10': 0.8631, 'compress@10': 0.5865, 'time@10': 5.7238}:  67%|██████▋   | 20/30 [01:23<00:46,  4.65s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0423, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8608, 'compress@10': 0.5884, 'time@10': 5.8915}:  67%|██████▋   | 20/30 [01:27<00:46,  4.65s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0423, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8608, 'compress@10': 0.5884, 'time@10': 5.8915}:  70%|███████   | 21/30 [01:27<00:41,  4.65s/it]{'epoch': 8, 'num_users': 6.1818, 'loss': 0.0428, 'hit_ratio@10': 0.8209, 'ndcg@10': 0.8624, 'compress@10': 0.589, 'time@10': 5.7804}:  70%|███████   | 21/30 [01:31<00:41,  4.65s/it] {'epoch': 8, 'num_users': 6.1818, 'loss': 0.0428, 'hit_ratio@10': 0.8209, 'ndcg@10': 0.8624, 'compress@10': 0.589, 'time@10': 5.7804}:  73%|███████▎  | 22/30 [01:31<00:34,  4.30s/it]{'epoch': 8, 'num_users': 6.1304, 'loss': 0.042, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8641, 'compress@10': 0.5901, 'time@10': 5.8006}:  73%|███████▎  | 22/30 [01:34<00:34,  4.30s/it]{'epoch': 8, 'num_users': 6.1304, 'loss': 0.042, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8641, 'compress@10': 0.5901, 'time@10': 5.8006}:  77%|███████▋  | 23/30 [01:34<00:27,  3.96s/it]{'epoch': 8, 'num_users': 5.9583, 'loss': 0.0416, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8575, 'compress@10': 0.5892, 'time@10': 5.6079}:  77%|███████▋  | 23/30 [01:35<00:27,  3.96s/it]{'epoch': 8, 'num_users': 5.9583, 'loss': 0.0416, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8575, 'compress@10': 0.5892, 'time@10': 5.6079}:  80%|████████  | 24/30 [01:35<00:18,  3.14s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0404, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8481, 'compress@10': 0.5947, 'time@10': 5.4313}:  80%|████████  | 24/30 [01:36<00:18,  3.14s/it]   {'epoch': 8, 'num_users': 5.8, 'loss': 0.0404, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8481, 'compress@10': 0.5947, 'time@10': 5.4313}:  83%|████████▎ | 25/30 [01:36<00:11,  2.39s/it]{'epoch': 8, 'num_users': 5.8077, 'loss': 0.0414, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8466, 'compress@10': 0.5838, 'time@10': 5.5296}:  83%|████████▎ | 25/30 [01:44<00:11,  2.39s/it]{'epoch': 8, 'num_users': 5.8077, 'loss': 0.0414, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8466, 'compress@10': 0.5838, 'time@10': 5.5296}:  87%|████████▋ | 26/30 [01:44<00:16,  4.08s/it]{'epoch': 8, 'num_users': 5.8889, 'loss': 0.042, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.8446, 'compress@10': 0.5866, 'time@10': 5.627}:  87%|████████▋ | 26/30 [01:48<00:16,  4.08s/it]  {'epoch': 8, 'num_users': 5.8889, 'loss': 0.042, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.8446, 'compress@10': 0.5866, 'time@10': 5.627}:  90%|█████████ | 27/30 [01:48<00:12,  4.09s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.0423, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8455, 'compress@10': 0.5775, 'time@10': 5.7189}:  90%|█████████ | 27/30 [01:56<00:12,  4.09s/it]  {'epoch': 8, 'num_users': 6.0, 'loss': 0.0423, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8455, 'compress@10': 0.5775, 'time@10': 5.7189}:  93%|█████████▎| 28/30 [01:56<00:10,  5.34s/it]{'epoch': 8, 'num_users': 5.8621, 'loss': 0.0418, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8475, 'compress@10': 0.5767, 'time@10': 5.7496}:  93%|█████████▎| 28/30 [02:00<00:10,  5.34s/it]{'epoch': 8, 'num_users': 5.8621, 'loss': 0.0418, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8475, 'compress@10': 0.5767, 'time@10': 5.7496}:  97%|█████████▋| 29/30 [02:00<00:04,  4.74s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0418, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8494, 'compress@10': 0.5711, 'time@10': 5.7301}:  97%|█████████▋| 29/30 [02:05<00:04,  4.74s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0418, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8494, 'compress@10': 0.5711, 'time@10': 5.7301}: 100%|██████████| 30/30 [02:05<00:00,  4.88s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0418, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8494, 'compress@10': 0.5711, 'time@10': 5.7301}: 100%|██████████| 30/30 [02:05<00:00,  4.17s/it]
Epoch: 8
Avg # of users: 5.866666666666666
Avg Loss: 0.041751237050621864
Avg hit ratio: 0.8264347807388234
Avg ndcg: 0.8494447974784277
Avg compression ratio: 0.5710645164148417
Avg train time: 5.730129416783651
Std train time: 2.470525153655615
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 18, 10, 19, 9, 18, 19, 10, 10, 9, 7, 10, 10, 19, 19, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8266, 'compress@10': 0.4962, 'time@10': 5.0924}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8266, 'compress@10': 0.4962, 'time@10': 5.0924}:   3%|▎         | 1/30 [00:02<01:14,  2.58s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.855, 'compress@10': 0.5442, 'time@10': 4.9573}:   3%|▎         | 1/30 [00:07<01:14,  2.58s/it] {'epoch': 9, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.855, 'compress@10': 0.5442, 'time@10': 4.9573}:   7%|▋         | 2/30 [00:07<01:49,  3.92s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.7769, 'ndcg@10': 0.8557, 'compress@10': 0.5417, 'time@10': 4.2964}:   7%|▋         | 2/30 [00:08<01:49,  3.92s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.7769, 'ndcg@10': 0.8557, 'compress@10': 0.5417, 'time@10': 4.2964}:  10%|█         | 3/30 [00:08<01:16,  2.83s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0362, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.8513, 'compress@10': 0.5658, 'time@10': 4.3485}:  10%|█         | 3/30 [00:13<01:16,  2.83s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0362, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.8513, 'compress@10': 0.5658, 'time@10': 4.3485}:  13%|█▎        | 4/30 [00:13<01:31,  3.51s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0464, 'hit_ratio@10': 0.8087, 'ndcg@10': 0.8346, 'compress@10': 0.5557, 'time@10': 5.2163}:  13%|█▎        | 4/30 [00:17<01:31,  3.51s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0464, 'hit_ratio@10': 0.8087, 'ndcg@10': 0.8346, 'compress@10': 0.5557, 'time@10': 5.2163}:  17%|█▋        | 5/30 [00:17<01:35,  3.83s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0483, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8357, 'compress@10': 0.5842, 'time@10': 5.5686}:  17%|█▋        | 5/30 [00:25<01:35,  3.83s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0483, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8357, 'compress@10': 0.5842, 'time@10': 5.5686}:  20%|██        | 6/30 [00:25<02:00,  5.03s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0469, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8368, 'compress@10': 0.5956, 'time@10': 5.9096}:  20%|██        | 6/30 [00:29<02:00,  5.03s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0469, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8368, 'compress@10': 0.5956, 'time@10': 5.9096}:  23%|██▎       | 7/30 [00:29<01:48,  4.70s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0475, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8469, 'compress@10': 0.5942, 'time@10': 5.873}:  23%|██▎       | 7/30 [00:34<01:48,  4.70s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0475, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8469, 'compress@10': 0.5942, 'time@10': 5.873}:  27%|██▋       | 8/30 [00:34<01:50,  5.00s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0473, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8574, 'compress@10': 0.5914, 'time@10': 6.2491}:  27%|██▋       | 8/30 [00:39<01:50,  5.00s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0473, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8574, 'compress@10': 0.5914, 'time@10': 6.2491}:  30%|███       | 9/30 [00:39<01:42,  4.90s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0471, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8563, 'compress@10': 0.5874, 'time@10': 6.3359}:  30%|███       | 9/30 [00:46<01:42,  4.90s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0471, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8563, 'compress@10': 0.5874, 'time@10': 6.3359}:  33%|███▎      | 10/30 [00:46<01:51,  5.60s/it]{'epoch': 9, 'num_users': 6.6364, 'loss': 0.0493, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8602, 'compress@10': 0.6045, 'time@10': 6.5966}:  33%|███▎      | 10/30 [00:51<01:51,  5.60s/it]{'epoch': 9, 'num_users': 6.6364, 'loss': 0.0493, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8602, 'compress@10': 0.6045, 'time@10': 6.5966}:  37%|███▋      | 11/30 [00:51<01:40,  5.30s/it]{'epoch': 9, 'num_users': 6.4167, 'loss': 0.0464, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8638, 'compress@10': 0.6135, 'time@10': 6.3016}:  37%|███▋      | 11/30 [00:54<01:40,  5.30s/it]{'epoch': 9, 'num_users': 6.4167, 'loss': 0.0464, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8638, 'compress@10': 0.6135, 'time@10': 6.3016}:  40%|████      | 12/30 [00:54<01:23,  4.63s/it]{'epoch': 9, 'num_users': 6.6154, 'loss': 0.0466, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.8662, 'compress@10': 0.597, 'time@10': 6.3372}:  40%|████      | 12/30 [00:57<01:23,  4.63s/it] {'epoch': 9, 'num_users': 6.6154, 'loss': 0.0466, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.8662, 'compress@10': 0.597, 'time@10': 6.3372}:  43%|████▎     | 13/30 [00:57<01:12,  4.27s/it]{'epoch': 9, 'num_users': 6.3571, 'loss': 0.0439, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8622, 'compress@10': 0.5991, 'time@10': 5.9964}:  43%|████▎     | 13/30 [00:59<01:12,  4.27s/it]{'epoch': 9, 'num_users': 6.3571, 'loss': 0.0439, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8622, 'compress@10': 0.5991, 'time@10': 5.9964}:  47%|████▋     | 14/30 [00:59<00:55,  3.46s/it]{'epoch': 9, 'num_users': 6.2667, 'loss': 0.0442, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8625, 'compress@10': 0.6013, 'time@10': 6.1877}:  47%|████▋     | 14/30 [01:04<00:55,  3.46s/it]{'epoch': 9, 'num_users': 6.2667, 'loss': 0.0442, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8625, 'compress@10': 0.6013, 'time@10': 6.1877}:  50%|█████     | 15/30 [01:04<00:56,  3.77s/it]{'epoch': 9, 'num_users': 6.0625, 'loss': 0.0423, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8632, 'compress@10': 0.6007, 'time@10': 5.9965}:  50%|█████     | 15/30 [01:07<00:56,  3.77s/it] {'epoch': 9, 'num_users': 6.0625, 'loss': 0.0423, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8632, 'compress@10': 0.6007, 'time@10': 5.9965}:  53%|█████▎    | 16/30 [01:07<00:50,  3.59s/it]{'epoch': 9, 'num_users': 5.8235, 'loss': 0.0404, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.8563, 'compress@10': 0.5975, 'time@10': 5.7894}:  53%|█████▎    | 16/30 [01:08<00:50,  3.59s/it]{'epoch': 9, 'num_users': 5.8235, 'loss': 0.0404, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.8563, 'compress@10': 0.5975, 'time@10': 5.7894}:  57%|█████▋    | 17/30 [01:08<00:37,  2.89s/it]{'epoch': 9, 'num_users': 6.0556, 'loss': 0.0408, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8574, 'compress@10': 0.5972, 'time@10': 5.7194}:  57%|█████▋    | 17/30 [01:13<00:37,  2.89s/it]{'epoch': 9, 'num_users': 6.0556, 'loss': 0.0408, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8574, 'compress@10': 0.5972, 'time@10': 5.7194}:  60%|██████    | 18/30 [01:13<00:40,  3.40s/it]{'epoch': 9, 'num_users': 6.0, 'loss': 0.0396, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8594, 'compress@10': 0.5991, 'time@10': 5.6433}:  60%|██████    | 18/30 [01:15<00:40,  3.40s/it]   {'epoch': 9, 'num_users': 6.0, 'loss': 0.0396, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8594, 'compress@10': 0.5991, 'time@10': 5.6433}:  63%|██████▎   | 19/30 [01:15<00:33,  3.03s/it]{'epoch': 9, 'num_users': 6.15, 'loss': 0.0401, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8585, 'compress@10': 0.5935, 'time@10': 5.7747}:  63%|██████▎   | 19/30 [01:23<00:33,  3.03s/it]{'epoch': 9, 'num_users': 6.15, 'loss': 0.0401, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8585, 'compress@10': 0.5935, 'time@10': 5.7747}:  67%|██████▋   | 20/30 [01:23<00:46,  4.62s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0418, 'hit_ratio@10': 0.825, 'ndcg@10': 0.856, 'compress@10': 0.5946, 'time@10': 5.9363}:  67%|██████▋   | 20/30 [01:28<00:46,  4.62s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0418, 'hit_ratio@10': 0.825, 'ndcg@10': 0.856, 'compress@10': 0.5946, 'time@10': 5.9363}:  70%|███████   | 21/30 [01:28<00:41,  4.62s/it]{'epoch': 9, 'num_users': 6.1818, 'loss': 0.0422, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.858, 'compress@10': 0.5952, 'time@10': 5.8237}:  70%|███████   | 21/30 [01:31<00:41,  4.62s/it]{'epoch': 9, 'num_users': 6.1818, 'loss': 0.0422, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.858, 'compress@10': 0.5952, 'time@10': 5.8237}:  73%|███████▎  | 22/30 [01:31<00:34,  4.28s/it]{'epoch': 9, 'num_users': 6.1304, 'loss': 0.0414, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8595, 'compress@10': 0.5979, 'time@10': 5.8433}:  73%|███████▎  | 22/30 [01:34<00:34,  4.28s/it]{'epoch': 9, 'num_users': 6.1304, 'loss': 0.0414, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8595, 'compress@10': 0.5979, 'time@10': 5.8433}:  77%|███████▋  | 23/30 [01:34<00:27,  3.95s/it]{'epoch': 9, 'num_users': 5.9583, 'loss': 0.0409, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8531, 'compress@10': 0.5977, 'time@10': 5.6515}:  77%|███████▋  | 23/30 [01:36<00:27,  3.95s/it]{'epoch': 9, 'num_users': 5.9583, 'loss': 0.0409, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8531, 'compress@10': 0.5977, 'time@10': 5.6515}:  80%|████████  | 24/30 [01:36<00:18,  3.15s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0396, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8439, 'compress@10': 0.6033, 'time@10': 5.4754}:  80%|████████  | 24/30 [01:36<00:18,  3.15s/it]   {'epoch': 9, 'num_users': 5.8, 'loss': 0.0396, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8439, 'compress@10': 0.6033, 'time@10': 5.4754}:  83%|████████▎ | 25/30 [01:36<00:12,  2.40s/it]{'epoch': 9, 'num_users': 5.8077, 'loss': 0.0406, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8431, 'compress@10': 0.5922, 'time@10': 5.5722}:  83%|████████▎ | 25/30 [01:44<00:12,  2.40s/it]{'epoch': 9, 'num_users': 5.8077, 'loss': 0.0406, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8431, 'compress@10': 0.5922, 'time@10': 5.5722}:  87%|████████▋ | 26/30 [01:44<00:16,  4.09s/it]{'epoch': 9, 'num_users': 5.8889, 'loss': 0.0407, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8417, 'compress@10': 0.5951, 'time@10': 5.6648}:  87%|████████▋ | 26/30 [01:48<00:16,  4.09s/it]{'epoch': 9, 'num_users': 5.8889, 'loss': 0.0407, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8417, 'compress@10': 0.5951, 'time@10': 5.6648}:  90%|█████████ | 27/30 [01:48<00:12,  4.09s/it]{'epoch': 9, 'num_users': 6.0, 'loss': 0.0409, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.8426, 'compress@10': 0.5852, 'time@10': 5.7413}:  90%|█████████ | 27/30 [01:56<00:12,  4.09s/it]   {'epoch': 9, 'num_users': 6.0, 'loss': 0.0409, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.8426, 'compress@10': 0.5852, 'time@10': 5.7413}:  93%|█████████▎| 28/30 [01:56<00:10,  5.22s/it]{'epoch': 9, 'num_users': 5.8621, 'loss': 0.0404, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8447, 'compress@10': 0.5848, 'time@10': 5.7592}:  93%|█████████▎| 28/30 [01:59<00:10,  5.22s/it]{'epoch': 9, 'num_users': 5.8621, 'loss': 0.0404, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8447, 'compress@10': 0.5848, 'time@10': 5.7592}:  97%|█████████▋| 29/30 [01:59<00:04,  4.60s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0403, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8469, 'compress@10': 0.5784, 'time@10': 5.7451}:  97%|█████████▋| 29/30 [02:05<00:04,  4.60s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0403, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8469, 'compress@10': 0.5784, 'time@10': 5.7451}: 100%|██████████| 30/30 [02:05<00:00,  4.83s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0403, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8469, 'compress@10': 0.5784, 'time@10': 5.7451}: 100%|██████████| 30/30 [02:05<00:00,  4.18s/it]
Epoch: 9
Avg # of users: 5.866666666666666
Avg Loss: 0.04034731657948847
Avg hit ratio: 0.8342137520095979
Avg ndcg: 0.8469148551539248
Avg compression ratio: 0.5783999386713812
Avg train time: 5.745147069295247
Std train time: 2.507918968662382
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 18, 10, 5, 10, 10, 10, 8, 10, 10, 19, 10, 20, 9, 19, 20, 10, 10, 9, 7, 10, 10, 20, 20, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.5205, 'time@10': 5.3029}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.5205, 'time@10': 5.3029}:   3%|▎         | 1/30 [00:02<01:18,  2.69s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8706, 'compress@10': 0.5653, 'time@10': 4.9211}:   3%|▎         | 1/30 [00:07<01:18,  2.69s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8706, 'compress@10': 0.5653, 'time@10': 4.9211}:   7%|▋         | 2/30 [00:07<01:46,  3.80s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8661, 'compress@10': 0.5591, 'time@10': 4.4535}:   7%|▋         | 2/30 [00:09<01:46,  3.80s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8661, 'compress@10': 0.5591, 'time@10': 4.4535}:  10%|█         | 3/30 [00:09<01:18,  2.90s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8558, 'compress@10': 0.5783, 'time@10': 4.4697}:  10%|█         | 3/30 [00:13<01:18,  2.90s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8558, 'compress@10': 0.5783, 'time@10': 4.4697}:  13%|█▎        | 4/30 [00:13<01:32,  3.56s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.8071, 'ndcg@10': 0.8383, 'compress@10': 0.5671, 'time@10': 5.2047}:  13%|█▎        | 4/30 [00:18<01:32,  3.56s/it] {'epoch': 10, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.8071, 'ndcg@10': 0.8383, 'compress@10': 0.5671, 'time@10': 5.2047}:  17%|█▋        | 5/30 [00:18<01:36,  3.88s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0489, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8389, 'compress@10': 0.5945, 'time@10': 5.5619}:  17%|█▋        | 5/30 [00:25<01:36,  3.88s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0489, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8389, 'compress@10': 0.5945, 'time@10': 5.5619}:  20%|██        | 6/30 [00:25<02:01,  5.07s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0479, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8465, 'compress@10': 0.6051, 'time@10': 5.9091}:  20%|██        | 6/30 [00:29<02:01,  5.07s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0479, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8465, 'compress@10': 0.6051, 'time@10': 5.9091}:  23%|██▎       | 7/30 [00:29<01:48,  4.73s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0481, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8543, 'compress@10': 0.6036, 'time@10': 5.8739}:  23%|██▎       | 7/30 [00:35<01:48,  4.73s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.0481, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8543, 'compress@10': 0.6036, 'time@10': 5.8739}:  27%|██▋       | 8/30 [00:35<01:50,  5.03s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0483, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8707, 'compress@10': 0.5997, 'time@10': 6.2228}:  27%|██▋       | 8/30 [00:39<01:50,  5.03s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0483, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8707, 'compress@10': 0.5997, 'time@10': 6.2228}:  30%|███       | 9/30 [00:39<01:42,  4.88s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0469, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8728, 'compress@10': 0.5979, 'time@10': 6.3121}:  30%|███       | 9/30 [00:46<01:42,  4.88s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0469, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8728, 'compress@10': 0.5979, 'time@10': 6.3121}:  33%|███▎      | 10/30 [00:46<01:51,  5.58s/it]{'epoch': 10, 'num_users': 6.6364, 'loss': 0.0474, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8724, 'compress@10': 0.6126, 'time@10': 6.5028}:  33%|███▎      | 10/30 [00:51<01:51,  5.58s/it]{'epoch': 10, 'num_users': 6.6364, 'loss': 0.0474, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8724, 'compress@10': 0.6126, 'time@10': 6.5028}:  37%|███▋      | 11/30 [00:51<01:38,  5.17s/it]{'epoch': 10, 'num_users': 6.4167, 'loss': 0.0446, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.875, 'compress@10': 0.6196, 'time@10': 6.2455}:  37%|███▋      | 11/30 [00:54<01:38,  5.17s/it] {'epoch': 10, 'num_users': 6.4167, 'loss': 0.0446, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.875, 'compress@10': 0.6196, 'time@10': 6.2455}:  40%|████      | 12/30 [00:54<01:23,  4.65s/it]{'epoch': 10, 'num_users': 6.6154, 'loss': 0.0448, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8768, 'compress@10': 0.6036, 'time@10': 6.3018}:  40%|████      | 12/30 [00:58<01:23,  4.65s/it]{'epoch': 10, 'num_users': 6.6154, 'loss': 0.0448, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8768, 'compress@10': 0.6036, 'time@10': 6.3018}:  43%|████▎     | 13/30 [00:58<01:13,  4.31s/it]{'epoch': 10, 'num_users': 6.3571, 'loss': 0.0422, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.872, 'compress@10': 0.605, 'time@10': 5.9686}:  43%|████▎     | 13/30 [00:59<01:13,  4.31s/it] {'epoch': 10, 'num_users': 6.3571, 'loss': 0.0422, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.872, 'compress@10': 0.605, 'time@10': 5.9686}:  47%|████▋     | 14/30 [00:59<00:56,  3.52s/it]{'epoch': 10, 'num_users': 6.2667, 'loss': 0.0429, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8716, 'compress@10': 0.6081, 'time@10': 6.1636}:  47%|████▋     | 14/30 [01:04<00:56,  3.52s/it]{'epoch': 10, 'num_users': 6.2667, 'loss': 0.0429, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8716, 'compress@10': 0.6081, 'time@10': 6.1636}:  50%|█████     | 15/30 [01:04<00:57,  3.81s/it]{'epoch': 10, 'num_users': 6.0625, 'loss': 0.0409, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.872, 'compress@10': 0.6064, 'time@10': 5.9924}:  50%|█████     | 15/30 [01:07<00:57,  3.81s/it] {'epoch': 10, 'num_users': 6.0625, 'loss': 0.0409, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.872, 'compress@10': 0.6064, 'time@10': 5.9924}:  53%|█████▎    | 16/30 [01:07<00:51,  3.71s/it]{'epoch': 10, 'num_users': 5.8235, 'loss': 0.039, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8654, 'compress@10': 0.6037, 'time@10': 5.793}:  53%|█████▎    | 16/30 [01:09<00:51,  3.71s/it]  {'epoch': 10, 'num_users': 5.8235, 'loss': 0.039, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8654, 'compress@10': 0.6037, 'time@10': 5.793}:  57%|█████▋    | 17/30 [01:09<00:38,  3.00s/it]{'epoch': 10, 'num_users': 6.0556, 'loss': 0.0394, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8656, 'compress@10': 0.6041, 'time@10': 5.7386}:  57%|█████▋    | 17/30 [01:13<00:38,  3.00s/it]{'epoch': 10, 'num_users': 6.0556, 'loss': 0.0394, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8656, 'compress@10': 0.6041, 'time@10': 5.7386}:  60%|██████    | 18/30 [01:13<00:42,  3.55s/it]{'epoch': 10, 'num_users': 6.0, 'loss': 0.0382, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8673, 'compress@10': 0.6068, 'time@10': 5.6912}:  60%|██████    | 18/30 [01:16<00:42,  3.55s/it]   {'epoch': 10, 'num_users': 6.0, 'loss': 0.0382, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8673, 'compress@10': 0.6068, 'time@10': 5.6912}:  63%|██████▎   | 19/30 [01:16<00:35,  3.23s/it]{'epoch': 10, 'num_users': 6.15, 'loss': 0.0386, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8662, 'compress@10': 0.602, 'time@10': 5.8249}:  63%|██████▎   | 19/30 [01:24<00:35,  3.23s/it]{'epoch': 10, 'num_users': 6.15, 'loss': 0.0386, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8662, 'compress@10': 0.602, 'time@10': 5.8249}:  67%|██████▋   | 20/30 [01:24<00:47,  4.78s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8637, 'compress@10': 0.6032, 'time@10': 5.9884}:  67%|██████▋   | 20/30 [01:29<00:47,  4.78s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8637, 'compress@10': 0.6032, 'time@10': 5.9884}:  70%|███████   | 21/30 [01:29<00:42,  4.75s/it]{'epoch': 10, 'num_users': 6.1818, 'loss': 0.0409, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8652, 'compress@10': 0.6033, 'time@10': 5.8739}:  70%|███████   | 21/30 [01:33<00:42,  4.75s/it]{'epoch': 10, 'num_users': 6.1818, 'loss': 0.0409, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8652, 'compress@10': 0.6033, 'time@10': 5.8739}:  73%|███████▎  | 22/30 [01:33<00:35,  4.38s/it]{'epoch': 10, 'num_users': 6.1304, 'loss': 0.0402, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.867, 'compress@10': 0.6072, 'time@10': 5.8917}:  73%|███████▎  | 22/30 [01:36<00:35,  4.38s/it] {'epoch': 10, 'num_users': 6.1304, 'loss': 0.0402, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.867, 'compress@10': 0.6072, 'time@10': 5.8917}:  77%|███████▋  | 23/30 [01:36<00:28,  4.02s/it]{'epoch': 10, 'num_users': 5.9583, 'loss': 0.0396, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8603, 'compress@10': 0.6071, 'time@10': 5.7014}:  77%|███████▋  | 23/30 [01:37<00:28,  4.02s/it]{'epoch': 10, 'num_users': 5.9583, 'loss': 0.0396, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8603, 'compress@10': 0.6071, 'time@10': 5.7014}:  80%|████████  | 24/30 [01:37<00:19,  3.22s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0384, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8507, 'compress@10': 0.6125, 'time@10': 5.5255}:  80%|████████  | 24/30 [01:38<00:19,  3.22s/it]   {'epoch': 10, 'num_users': 5.8, 'loss': 0.0384, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8507, 'compress@10': 0.6125, 'time@10': 5.5255}:  83%|████████▎ | 25/30 [01:38<00:12,  2.46s/it]{'epoch': 10, 'num_users': 5.8077, 'loss': 0.0393, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8497, 'compress@10': 0.6017, 'time@10': 5.628}:  83%|████████▎ | 25/30 [01:46<00:12,  2.46s/it]{'epoch': 10, 'num_users': 5.8077, 'loss': 0.0393, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8497, 'compress@10': 0.6017, 'time@10': 5.628}:  87%|████████▋ | 26/30 [01:46<00:16,  4.19s/it]{'epoch': 10, 'num_users': 5.8889, 'loss': 0.0391, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8504, 'compress@10': 0.6045, 'time@10': 5.7732}:  87%|████████▋ | 26/30 [01:51<00:16,  4.19s/it]{'epoch': 10, 'num_users': 5.8889, 'loss': 0.0391, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8504, 'compress@10': 0.6045, 'time@10': 5.7732}:  90%|█████████ | 27/30 [01:51<00:13,  4.38s/it]{'epoch': 10, 'num_users': 6.0, 'loss': 0.0393, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8512, 'compress@10': 0.5939, 'time@10': 5.8757}:  90%|█████████ | 27/30 [01:59<00:13,  4.38s/it]   {'epoch': 10, 'num_users': 6.0, 'loss': 0.0393, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8512, 'compress@10': 0.5939, 'time@10': 5.8757}:  93%|█████████▎| 28/30 [01:59<00:11,  5.67s/it]{'epoch': 10, 'num_users': 5.8621, 'loss': 0.0387, 'hit_ratio@10': 0.8401, 'ndcg@10': 0.8536, 'compress@10': 0.5937, 'time@10': 5.863}:  93%|█████████▎| 28/30 [02:02<00:11,  5.67s/it]{'epoch': 10, 'num_users': 5.8621, 'loss': 0.0387, 'hit_ratio@10': 0.8401, 'ndcg@10': 0.8536, 'compress@10': 0.5937, 'time@10': 5.863}:  97%|█████████▋| 29/30 [02:02<00:04,  4.81s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.0388, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8555, 'compress@10': 0.5865, 'time@10': 5.8398}:  97%|█████████▋| 29/30 [02:07<00:04,  4.81s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.0388, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8555, 'compress@10': 0.5865, 'time@10': 5.8398}: 100%|██████████| 30/30 [02:07<00:00,  4.93s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.0388, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8555, 'compress@10': 0.5865, 'time@10': 5.8398}: 100%|██████████| 30/30 [02:07<00:00,  4.27s/it]
Epoch: 10
Avg # of users: 5.866666666666666
Avg Loss: 0.03878295379550789
Avg hit ratio: 0.8391335267303169
Avg ndcg: 0.8554705341541069
Avg compression ratio: 0.5865111799756539
Avg train time: 5.8398443778355915
Std train time: 2.4817402492668417
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 18, 10, 5, 10, 10, 10, 8, 10, 10, 19, 10, 21, 9, 19, 21, 10, 10, 9, 7, 10, 10, 21, 21, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0512, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8283, 'compress@10': 0.5351, 'time@10': 5.4277}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0512, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8283, 'compress@10': 0.5351, 'time@10': 5.4277}:   3%|▎         | 1/30 [00:02<01:19,  2.75s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.044, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8564, 'compress@10': 0.5794, 'time@10': 5.0235}:   3%|▎         | 1/30 [00:07<01:19,  2.75s/it] {'epoch': 11, 'num_users': 7.0, 'loss': 0.044, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8564, 'compress@10': 0.5794, 'time@10': 5.0235}:   7%|▋         | 2/30 [00:07<01:48,  3.87s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8567, 'compress@10': 0.5722, 'time@10': 4.545}:   7%|▋         | 2/30 [00:09<01:48,  3.87s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8567, 'compress@10': 0.5722, 'time@10': 4.545}:  10%|█         | 3/30 [00:09<01:19,  2.94s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0361, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8389, 'compress@10': 0.5908, 'time@10': 4.6001}:  10%|█         | 3/30 [00:14<01:19,  2.94s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0361, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8389, 'compress@10': 0.5908, 'time@10': 4.6001}:  13%|█▎        | 4/30 [00:14<01:35,  3.68s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.825, 'compress@10': 0.5778, 'time@10': 5.3132}:  13%|█▎        | 4/30 [00:18<01:35,  3.68s/it] {'epoch': 11, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.825, 'compress@10': 0.5778, 'time@10': 5.3132}:  17%|█▋        | 5/30 [00:18<01:35,  3.84s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0476, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8267, 'compress@10': 0.6053, 'time@10': 5.6221}:  17%|█▋        | 5/30 [00:25<01:35,  3.84s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0476, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8267, 'compress@10': 0.6053, 'time@10': 5.6221}:  20%|██        | 6/30 [00:25<01:59,  4.98s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0458, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8323, 'compress@10': 0.6149, 'time@10': 5.9681}:  20%|██        | 6/30 [00:29<01:59,  4.98s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0458, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8323, 'compress@10': 0.6149, 'time@10': 5.9681}:  23%|██▎       | 7/30 [00:29<01:47,  4.68s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0462, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8418, 'compress@10': 0.613, 'time@10': 5.922}:  23%|██▎       | 7/30 [00:35<01:47,  4.68s/it]   {'epoch': 11, 'num_users': 6.125, 'loss': 0.0462, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8418, 'compress@10': 0.613, 'time@10': 5.922}:  27%|██▋       | 8/30 [00:35<01:49,  4.99s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0469, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8584, 'compress@10': 0.6104, 'time@10': 6.269}:  27%|██▋       | 8/30 [00:39<01:49,  4.99s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0469, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8584, 'compress@10': 0.6104, 'time@10': 6.269}:  30%|███       | 9/30 [00:39<01:41,  4.85s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0465, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8578, 'compress@10': 0.6074, 'time@10': 6.3519}:  30%|███       | 9/30 [00:46<01:41,  4.85s/it]  {'epoch': 11, 'num_users': 6.3, 'loss': 0.0465, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8578, 'compress@10': 0.6074, 'time@10': 6.3519}:  33%|███▎      | 10/30 [00:46<01:51,  5.56s/it]{'epoch': 11, 'num_users': 6.6364, 'loss': 0.0474, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8598, 'compress@10': 0.6201, 'time@10': 6.5363}:  33%|███▎      | 10/30 [00:51<01:51,  5.56s/it]{'epoch': 11, 'num_users': 6.6364, 'loss': 0.0474, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8598, 'compress@10': 0.6201, 'time@10': 6.5363}:  37%|███▋      | 11/30 [00:51<01:37,  5.15s/it]{'epoch': 11, 'num_users': 6.4167, 'loss': 0.0445, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8635, 'compress@10': 0.6264, 'time@10': 6.275}:  37%|███▋      | 11/30 [00:54<01:37,  5.15s/it] {'epoch': 11, 'num_users': 6.4167, 'loss': 0.0445, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8635, 'compress@10': 0.6264, 'time@10': 6.275}:  40%|████      | 12/30 [00:54<01:23,  4.63s/it]{'epoch': 11, 'num_users': 6.6154, 'loss': 0.0446, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8658, 'compress@10': 0.611, 'time@10': 6.329}:  40%|████      | 12/30 [00:57<01:23,  4.63s/it] {'epoch': 11, 'num_users': 6.6154, 'loss': 0.0446, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8658, 'compress@10': 0.611, 'time@10': 6.329}:  43%|████▎     | 13/30 [00:57<01:13,  4.30s/it]{'epoch': 11, 'num_users': 6.3571, 'loss': 0.0419, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8619, 'compress@10': 0.6099, 'time@10': 5.9992}:  43%|████▎     | 13/30 [00:59<01:13,  4.30s/it]{'epoch': 11, 'num_users': 6.3571, 'loss': 0.0419, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8619, 'compress@10': 0.6099, 'time@10': 5.9992}:  47%|████▋     | 14/30 [00:59<00:56,  3.53s/it]{'epoch': 11, 'num_users': 6.2667, 'loss': 0.0418, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.8628, 'compress@10': 0.6126, 'time@10': 6.1918}:  47%|████▋     | 14/30 [01:04<00:56,  3.53s/it]{'epoch': 11, 'num_users': 6.2667, 'loss': 0.0418, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.8628, 'compress@10': 0.6126, 'time@10': 6.1918}:  50%|█████     | 15/30 [01:04<00:57,  3.82s/it]{'epoch': 11, 'num_users': 6.0625, 'loss': 0.0399, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8637, 'compress@10': 0.6108, 'time@10': 6.0205}:  50%|█████     | 15/30 [01:07<00:57,  3.82s/it]{'epoch': 11, 'num_users': 6.0625, 'loss': 0.0399, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8637, 'compress@10': 0.6108, 'time@10': 6.0205}:  53%|█████▎    | 16/30 [01:07<00:52,  3.72s/it]{'epoch': 11, 'num_users': 5.8235, 'loss': 0.038, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.8582, 'compress@10': 0.6083, 'time@10': 5.8275}:  53%|█████▎    | 16/30 [01:09<00:52,  3.72s/it] {'epoch': 11, 'num_users': 5.8235, 'loss': 0.038, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.8582, 'compress@10': 0.6083, 'time@10': 5.8275}:  57%|█████▋    | 17/30 [01:09<00:39,  3.03s/it]{'epoch': 11, 'num_users': 6.0556, 'loss': 0.0383, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8589, 'compress@10': 0.6091, 'time@10': 5.7591}:  57%|█████▋    | 17/30 [01:13<00:39,  3.03s/it]{'epoch': 11, 'num_users': 6.0556, 'loss': 0.0383, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8589, 'compress@10': 0.6091, 'time@10': 5.7591}:  60%|██████    | 18/30 [01:13<00:42,  3.51s/it]{'epoch': 11, 'num_users': 6.0, 'loss': 0.0372, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8604, 'compress@10': 0.6123, 'time@10': 5.6912}:  60%|██████    | 18/30 [01:16<00:42,  3.51s/it]   {'epoch': 11, 'num_users': 6.0, 'loss': 0.0372, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8604, 'compress@10': 0.6123, 'time@10': 5.6912}:  63%|██████▎   | 19/30 [01:16<00:34,  3.14s/it]{'epoch': 11, 'num_users': 6.15, 'loss': 0.0376, 'hit_ratio@10': 0.833, 'ndcg@10': 0.8597, 'compress@10': 0.6081, 'time@10': 5.8335}:  63%|██████▎   | 19/30 [01:24<00:34,  3.14s/it]{'epoch': 11, 'num_users': 6.15, 'loss': 0.0376, 'hit_ratio@10': 0.833, 'ndcg@10': 0.8597, 'compress@10': 0.6081, 'time@10': 5.8335}:  67%|██████▋   | 20/30 [01:24<00:47,  4.77s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0388, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8581, 'compress@10': 0.6091, 'time@10': 5.985}:  67%|██████▋   | 20/30 [01:29<00:47,  4.77s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0388, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8581, 'compress@10': 0.6091, 'time@10': 5.985}:  70%|███████   | 21/30 [01:29<00:42,  4.70s/it]{'epoch': 11, 'num_users': 6.1818, 'loss': 0.0393, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8599, 'compress@10': 0.6086, 'time@10': 5.8697}:  70%|███████   | 21/30 [01:32<00:42,  4.70s/it]{'epoch': 11, 'num_users': 6.1818, 'loss': 0.0393, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8599, 'compress@10': 0.6086, 'time@10': 5.8697}:  73%|███████▎  | 22/30 [01:32<00:34,  4.34s/it]{'epoch': 11, 'num_users': 6.1304, 'loss': 0.0389, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8616, 'compress@10': 0.6131, 'time@10': 5.8863}:  73%|███████▎  | 22/30 [01:35<00:34,  4.34s/it]{'epoch': 11, 'num_users': 6.1304, 'loss': 0.0389, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8616, 'compress@10': 0.6131, 'time@10': 5.8863}:  77%|███████▋  | 23/30 [01:35<00:27,  3.99s/it]{'epoch': 11, 'num_users': 5.9583, 'loss': 0.0382, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8551, 'compress@10': 0.6134, 'time@10': 5.6986}:  77%|███████▋  | 23/30 [01:37<00:27,  3.99s/it]{'epoch': 11, 'num_users': 5.9583, 'loss': 0.0382, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8551, 'compress@10': 0.6134, 'time@10': 5.6986}:  80%|████████  | 24/30 [01:37<00:19,  3.22s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.037, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8458, 'compress@10': 0.6187, 'time@10': 5.5255}:  80%|████████  | 24/30 [01:37<00:19,  3.22s/it]    {'epoch': 11, 'num_users': 5.8, 'loss': 0.037, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8458, 'compress@10': 0.6187, 'time@10': 5.5255}:  83%|████████▎ | 25/30 [01:37<00:12,  2.47s/it]{'epoch': 11, 'num_users': 5.8077, 'loss': 0.0378, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8453, 'compress@10': 0.6081, 'time@10': 5.6219}:  83%|████████▎ | 25/30 [01:46<00:12,  2.47s/it]{'epoch': 11, 'num_users': 5.8077, 'loss': 0.0378, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8453, 'compress@10': 0.6081, 'time@10': 5.6219}:  87%|████████▋ | 26/30 [01:46<00:16,  4.15s/it]{'epoch': 11, 'num_users': 5.8889, 'loss': 0.0375, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8476, 'compress@10': 0.6116, 'time@10': 5.6789}:  87%|████████▋ | 26/30 [01:49<00:16,  4.15s/it]{'epoch': 11, 'num_users': 5.8889, 'loss': 0.0375, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8476, 'compress@10': 0.6116, 'time@10': 5.6789}:  90%|█████████ | 27/30 [01:49<00:11,  3.99s/it]{'epoch': 11, 'num_users': 6.0, 'loss': 0.0378, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.8486, 'compress@10': 0.6009, 'time@10': 5.7467}:  90%|█████████ | 27/30 [01:57<00:11,  3.99s/it]   {'epoch': 11, 'num_users': 6.0, 'loss': 0.0378, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.8486, 'compress@10': 0.6009, 'time@10': 5.7467}:  93%|█████████▎| 28/30 [01:57<00:10,  5.08s/it]{'epoch': 11, 'num_users': 5.8621, 'loss': 0.0374, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.8511, 'compress@10': 0.6008, 'time@10': 5.7353}:  93%|█████████▎| 28/30 [02:00<00:10,  5.08s/it]{'epoch': 11, 'num_users': 5.8621, 'loss': 0.0374, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.8511, 'compress@10': 0.6008, 'time@10': 5.7353}:  97%|█████████▋| 29/30 [02:00<00:04,  4.38s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0374, 'hit_ratio@10': 0.8401, 'ndcg@10': 0.8532, 'compress@10': 0.5928, 'time@10': 5.7288}:  97%|█████████▋| 29/30 [02:05<00:04,  4.38s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0374, 'hit_ratio@10': 0.8401, 'ndcg@10': 0.8532, 'compress@10': 0.5928, 'time@10': 5.7288}: 100%|██████████| 30/30 [02:05<00:00,  4.74s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0374, 'hit_ratio@10': 0.8401, 'ndcg@10': 0.8532, 'compress@10': 0.5928, 'time@10': 5.7288}: 100%|██████████| 30/30 [02:05<00:00,  4.19s/it]
Epoch: 11
Avg # of users: 5.866666666666666
Avg Loss: 0.03742810977848374
Avg hit ratio: 0.8400662715454146
Avg ndcg: 0.8532166956695839
Avg compression ratio: 0.5928215885544585
Avg train time: 5.728778966267904
Std train time: 2.3322138919864233
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 18, 10, 5, 10, 10, 10, 8, 10, 10, 19, 10, 22, 9, 19, 22, 10, 10, 9, 7, 10, 10, 22, 22, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8384, 'compress@10': 0.5472, 'time@10': 5.4835}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8384, 'compress@10': 0.5472, 'time@10': 5.4835}:   3%|▎         | 1/30 [00:02<01:20,  2.79s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0415, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8609, 'compress@10': 0.5892, 'time@10': 5.4497}:   3%|▎         | 1/30 [00:08<01:20,  2.79s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0415, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8609, 'compress@10': 0.5892, 'time@10': 5.4497}:   7%|▋         | 2/30 [00:08<02:02,  4.37s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8596, 'compress@10': 0.5808, 'time@10': 4.7993}:   7%|▋         | 2/30 [00:10<02:02,  4.37s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8596, 'compress@10': 0.5808, 'time@10': 4.7993}:  10%|█         | 3/30 [00:10<01:26,  3.19s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8518, 'compress@10': 0.5995, 'time@10': 4.9096}:  10%|█         | 3/30 [00:15<01:26,  3.19s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8518, 'compress@10': 0.5995, 'time@10': 4.9096}:  13%|█▎        | 4/30 [00:15<01:44,  4.02s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0424, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8365, 'compress@10': 0.5858, 'time@10': 5.5714}:  13%|█▎        | 4/30 [00:19<01:44,  4.02s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0424, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8365, 'compress@10': 0.5858, 'time@10': 5.5714}:  17%|█▋        | 5/30 [00:19<01:41,  4.06s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0443, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8383, 'compress@10': 0.6103, 'time@10': 5.8954}:  17%|█▋        | 5/30 [00:27<01:41,  4.06s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0443, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8383, 'compress@10': 0.6103, 'time@10': 5.8954}:  20%|██        | 6/30 [00:27<02:06,  5.25s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0431, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8475, 'compress@10': 0.6168, 'time@10': 6.2195}:  20%|██        | 6/30 [00:31<02:06,  5.25s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0431, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8475, 'compress@10': 0.6168, 'time@10': 6.2195}:  23%|██▎       | 7/30 [00:31<01:52,  4.88s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0436, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8544, 'compress@10': 0.6151, 'time@10': 6.1679}:  23%|██▎       | 7/30 [00:37<01:52,  4.88s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0436, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8544, 'compress@10': 0.6151, 'time@10': 6.1679}:  27%|██▋       | 8/30 [00:37<01:54,  5.19s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0442, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8671, 'compress@10': 0.6142, 'time@10': 6.5182}:  27%|██▋       | 8/30 [00:41<01:54,  5.19s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0442, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8671, 'compress@10': 0.6142, 'time@10': 6.5182}:  30%|███       | 9/30 [00:41<01:45,  5.04s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0425, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8707, 'compress@10': 0.613, 'time@10': 6.591}:  30%|███       | 9/30 [00:48<01:45,  5.04s/it]     {'epoch': 12, 'num_users': 6.3, 'loss': 0.0425, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8707, 'compress@10': 0.613, 'time@10': 6.591}:  33%|███▎      | 10/30 [00:48<01:54,  5.73s/it]{'epoch': 12, 'num_users': 6.6364, 'loss': 0.0455, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8715, 'compress@10': 0.625, 'time@10': 6.8759}:  33%|███▎      | 10/30 [00:53<01:54,  5.73s/it]{'epoch': 12, 'num_users': 6.6364, 'loss': 0.0455, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8715, 'compress@10': 0.625, 'time@10': 6.8759}:  37%|███▋      | 11/30 [00:53<01:44,  5.48s/it]{'epoch': 12, 'num_users': 6.4167, 'loss': 0.0428, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8742, 'compress@10': 0.6312, 'time@10': 6.6053}:  37%|███▋      | 11/30 [00:57<01:44,  5.48s/it]{'epoch': 12, 'num_users': 6.4167, 'loss': 0.0428, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8742, 'compress@10': 0.6312, 'time@10': 6.6053}:  40%|████      | 12/30 [00:57<01:28,  4.93s/it]{'epoch': 12, 'num_users': 6.6154, 'loss': 0.0429, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.8759, 'compress@10': 0.6168, 'time@10': 6.6339}:  40%|████      | 12/30 [01:01<01:28,  4.93s/it]{'epoch': 12, 'num_users': 6.6154, 'loss': 0.0429, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.8759, 'compress@10': 0.6168, 'time@10': 6.6339}:  43%|████▎     | 13/30 [01:01<01:16,  4.50s/it]{'epoch': 12, 'num_users': 6.3571, 'loss': 0.0403, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8721, 'compress@10': 0.6129, 'time@10': 6.2878}:  43%|████▎     | 13/30 [01:02<01:16,  4.50s/it]{'epoch': 12, 'num_users': 6.3571, 'loss': 0.0403, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8721, 'compress@10': 0.6129, 'time@10': 6.2878}:  47%|████▋     | 14/30 [01:02<00:59,  3.70s/it]{'epoch': 12, 'num_users': 6.2667, 'loss': 0.0408, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8717, 'compress@10': 0.6142, 'time@10': 6.4398}:  47%|████▋     | 14/30 [01:07<00:59,  3.70s/it]{'epoch': 12, 'num_users': 6.2667, 'loss': 0.0408, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8717, 'compress@10': 0.6142, 'time@10': 6.4398}:  50%|█████     | 15/30 [01:07<00:58,  3.88s/it]{'epoch': 12, 'num_users': 6.0625, 'loss': 0.0388, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8721, 'compress@10': 0.6117, 'time@10': 6.2341}:  50%|█████     | 15/30 [01:10<00:58,  3.88s/it]{'epoch': 12, 'num_users': 6.0625, 'loss': 0.0388, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8721, 'compress@10': 0.6117, 'time@10': 6.2341}:  53%|█████▎    | 16/30 [01:10<00:51,  3.67s/it]{'epoch': 12, 'num_users': 5.8235, 'loss': 0.0369, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8661, 'compress@10': 0.6092, 'time@10': 6.026}:  53%|█████▎    | 16/30 [01:11<00:51,  3.67s/it] {'epoch': 12, 'num_users': 5.8235, 'loss': 0.0369, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8661, 'compress@10': 0.6092, 'time@10': 6.026}:  57%|█████▋    | 17/30 [01:11<00:38,  2.99s/it]{'epoch': 12, 'num_users': 6.0556, 'loss': 0.0372, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8665, 'compress@10': 0.6102, 'time@10': 5.932}:  57%|█████▋    | 17/30 [01:16<00:38,  2.99s/it]{'epoch': 12, 'num_users': 6.0556, 'loss': 0.0372, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8665, 'compress@10': 0.6102, 'time@10': 5.932}:  60%|██████    | 18/30 [01:16<00:40,  3.40s/it]{'epoch': 12, 'num_users': 6.0, 'loss': 0.0361, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.868, 'compress@10': 0.6139, 'time@10': 5.8433}:  60%|██████    | 18/30 [01:18<00:40,  3.40s/it]   {'epoch': 12, 'num_users': 6.0, 'loss': 0.0361, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.868, 'compress@10': 0.6139, 'time@10': 5.8433}:  63%|██████▎   | 19/30 [01:18<00:33,  3.03s/it]{'epoch': 12, 'num_users': 6.15, 'loss': 0.0364, 'hit_ratio@10': 0.8277, 'ndcg@10': 0.8671, 'compress@10': 0.6103, 'time@10': 5.9699}:  63%|██████▎   | 19/30 [01:26<00:33,  3.03s/it]{'epoch': 12, 'num_users': 6.15, 'loss': 0.0364, 'hit_ratio@10': 0.8277, 'ndcg@10': 0.8671, 'compress@10': 0.6103, 'time@10': 5.9699}:  67%|██████▋   | 20/30 [01:26<00:46,  4.65s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.038, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8643, 'compress@10': 0.6119, 'time@10': 6.1181}:  67%|██████▋   | 20/30 [01:31<00:46,  4.65s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.038, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8643, 'compress@10': 0.6119, 'time@10': 6.1181}:  70%|███████   | 21/30 [01:31<00:41,  4.63s/it]{'epoch': 12, 'num_users': 6.1818, 'loss': 0.0386, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8652, 'compress@10': 0.6108, 'time@10': 5.9964}:  70%|███████   | 21/30 [01:34<00:41,  4.63s/it]{'epoch': 12, 'num_users': 6.1818, 'loss': 0.0386, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8652, 'compress@10': 0.6108, 'time@10': 5.9964}:  73%|███████▎  | 22/30 [01:34<00:34,  4.28s/it]{'epoch': 12, 'num_users': 6.1304, 'loss': 0.038, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8668, 'compress@10': 0.6154, 'time@10': 6.0012}:  73%|███████▎  | 22/30 [01:37<00:34,  4.28s/it] {'epoch': 12, 'num_users': 6.1304, 'loss': 0.038, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8668, 'compress@10': 0.6154, 'time@10': 6.0012}:  77%|███████▋  | 23/30 [01:37<00:27,  3.93s/it]{'epoch': 12, 'num_users': 5.9583, 'loss': 0.0372, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8608, 'compress@10': 0.6161, 'time@10': 5.8068}:  77%|███████▋  | 23/30 [01:39<00:27,  3.93s/it]{'epoch': 12, 'num_users': 5.9583, 'loss': 0.0372, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8608, 'compress@10': 0.6161, 'time@10': 5.8068}:  80%|████████  | 24/30 [01:39<00:18,  3.16s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.036, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.8512, 'compress@10': 0.6214, 'time@10': 5.633}:  80%|████████  | 24/30 [01:40<00:18,  3.16s/it]     {'epoch': 12, 'num_users': 5.8, 'loss': 0.036, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.8512, 'compress@10': 0.6214, 'time@10': 5.633}:  83%|████████▎ | 25/30 [01:40<00:12,  2.44s/it]{'epoch': 12, 'num_users': 5.8077, 'loss': 0.0368, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8506, 'compress@10': 0.6112, 'time@10': 5.7249}:  83%|████████▎ | 25/30 [01:48<00:12,  2.44s/it]{'epoch': 12, 'num_users': 5.8077, 'loss': 0.0368, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8506, 'compress@10': 0.6112, 'time@10': 5.7249}:  87%|████████▋ | 26/30 [01:48<00:16,  4.13s/it]{'epoch': 12, 'num_users': 5.8889, 'loss': 0.0364, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8525, 'compress@10': 0.6146, 'time@10': 5.7796}:  87%|████████▋ | 26/30 [01:51<00:16,  4.13s/it]{'epoch': 12, 'num_users': 5.8889, 'loss': 0.0364, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8525, 'compress@10': 0.6146, 'time@10': 5.7796}:  90%|█████████ | 27/30 [01:51<00:11,  3.98s/it]{'epoch': 12, 'num_users': 6.0, 'loss': 0.0366, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8533, 'compress@10': 0.6038, 'time@10': 5.8345}:  90%|█████████ | 27/30 [01:59<00:11,  3.98s/it]   {'epoch': 12, 'num_users': 6.0, 'loss': 0.0366, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8533, 'compress@10': 0.6038, 'time@10': 5.8345}:  93%|█████████▎| 28/30 [01:59<00:09,  5.00s/it]{'epoch': 12, 'num_users': 5.8621, 'loss': 0.0362, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8559, 'compress@10': 0.6037, 'time@10': 5.8482}:  93%|█████████▎| 28/30 [02:02<00:09,  5.00s/it]{'epoch': 12, 'num_users': 5.8621, 'loss': 0.0362, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8559, 'compress@10': 0.6037, 'time@10': 5.8482}:  97%|█████████▋| 29/30 [02:02<00:04,  4.44s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0362, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.858, 'compress@10': 0.5951, 'time@10': 5.8445}:  97%|█████████▋| 29/30 [02:08<00:04,  4.44s/it] {'epoch': 12, 'num_users': 5.8667, 'loss': 0.0362, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.858, 'compress@10': 0.5951, 'time@10': 5.8445}: 100%|██████████| 30/30 [02:08<00:00,  4.84s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0362, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.858, 'compress@10': 0.5951, 'time@10': 5.8445}: 100%|██████████| 30/30 [02:08<00:00,  4.27s/it]
Epoch: 12
Avg # of users: 5.866666666666666
Avg Loss: 0.03624874437365423
Avg hit ratio: 0.835260173397853
Avg ndcg: 0.8579549838253826
Avg compression ratio: 0.5951053566498956
Avg train time: 5.844491362571716
Std train time: 2.3968755368072414
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 18, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 23, 9, 20, 23, 10, 10, 9, 7, 10, 10, 23, 23, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0389, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.873, 'compress@10': 0.5642, 'time@10': 5.7433}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0389, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.873, 'compress@10': 0.5642, 'time@10': 5.7433}:   3%|▎         | 1/30 [00:02<01:24,  2.91s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0361, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8788, 'compress@10': 0.5988, 'time@10': 5.1352}:   3%|▎         | 1/30 [00:07<01:24,  2.91s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0361, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8788, 'compress@10': 0.5988, 'time@10': 5.1352}:   7%|▋         | 2/30 [00:07<01:48,  3.89s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8716, 'compress@10': 0.5902, 'time@10': 4.4558}:   7%|▋         | 2/30 [00:09<01:48,  3.89s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8716, 'compress@10': 0.5902, 'time@10': 4.4558}:  10%|█         | 3/30 [00:09<01:16,  2.84s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8666, 'compress@10': 0.6068, 'time@10': 4.4039}:  10%|█         | 3/30 [00:13<01:16,  2.84s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8666, 'compress@10': 0.6068, 'time@10': 4.4039}:  13%|█▎        | 4/30 [00:13<01:28,  3.41s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0391, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8487, 'compress@10': 0.5925, 'time@10': 5.1448}:  13%|█▎        | 4/30 [00:17<01:28,  3.41s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0391, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8487, 'compress@10': 0.5925, 'time@10': 5.1448}:  17%|█▋        | 5/30 [00:17<01:31,  3.66s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8499, 'compress@10': 0.6164, 'time@10': 5.5055}:  17%|█▋        | 5/30 [00:24<01:31,  3.66s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8499, 'compress@10': 0.6164, 'time@10': 5.5055}:  20%|██        | 6/30 [00:24<01:58,  4.92s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0401, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8549, 'compress@10': 0.6215, 'time@10': 5.8519}:  20%|██        | 6/30 [00:28<01:58,  4.92s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0401, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8549, 'compress@10': 0.6215, 'time@10': 5.8519}:  23%|██▎       | 7/30 [00:28<01:46,  4.62s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0408, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8603, 'compress@10': 0.6203, 'time@10': 5.8261}:  23%|██▎       | 7/30 [00:34<01:46,  4.62s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0408, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8603, 'compress@10': 0.6203, 'time@10': 5.8261}:  27%|██▋       | 8/30 [00:34<01:49,  4.96s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0406, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8695, 'compress@10': 0.6181, 'time@10': 6.1843}:  27%|██▋       | 8/30 [00:39<01:49,  4.96s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0406, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8695, 'compress@10': 0.6181, 'time@10': 6.1843}:  30%|███       | 9/30 [00:39<01:41,  4.84s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.868, 'compress@10': 0.6168, 'time@10': 6.2793}:  30%|███       | 9/30 [00:46<01:41,  4.84s/it]    {'epoch': 13, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.868, 'compress@10': 0.6168, 'time@10': 6.2793}:  33%|███▎      | 10/30 [00:46<01:51,  5.56s/it]{'epoch': 13, 'num_users': 6.6364, 'loss': 0.0429, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8667, 'compress@10': 0.628, 'time@10': 6.395}:  33%|███▎      | 10/30 [00:50<01:51,  5.56s/it]{'epoch': 13, 'num_users': 6.6364, 'loss': 0.0429, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8667, 'compress@10': 0.628, 'time@10': 6.395}:  37%|███▋      | 11/30 [00:50<01:35,  5.03s/it]{'epoch': 13, 'num_users': 6.4167, 'loss': 0.0403, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8701, 'compress@10': 0.6341, 'time@10': 6.1476}:  37%|███▋      | 11/30 [00:53<01:35,  5.03s/it]{'epoch': 13, 'num_users': 6.4167, 'loss': 0.0403, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8701, 'compress@10': 0.6341, 'time@10': 6.1476}:  40%|████      | 12/30 [00:53<01:21,  4.55s/it]{'epoch': 13, 'num_users': 6.6154, 'loss': 0.0405, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8722, 'compress@10': 0.6208, 'time@10': 6.2153}:  40%|████      | 12/30 [00:57<01:21,  4.55s/it]{'epoch': 13, 'num_users': 6.6154, 'loss': 0.0405, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8722, 'compress@10': 0.6208, 'time@10': 6.2153}:  43%|████▎     | 13/30 [00:57<01:12,  4.25s/it]{'epoch': 13, 'num_users': 6.3571, 'loss': 0.038, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.868, 'compress@10': 0.6148, 'time@10': 5.9063}:  43%|████▎     | 13/30 [00:59<01:12,  4.25s/it]  {'epoch': 13, 'num_users': 6.3571, 'loss': 0.038, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.868, 'compress@10': 0.6148, 'time@10': 5.9063}:  47%|████▋     | 14/30 [00:59<00:56,  3.55s/it]{'epoch': 13, 'num_users': 6.2667, 'loss': 0.0387, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8687, 'compress@10': 0.618, 'time@10': 6.1042}:  47%|████▋     | 14/30 [01:03<00:56,  3.55s/it]{'epoch': 13, 'num_users': 6.2667, 'loss': 0.0387, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8687, 'compress@10': 0.618, 'time@10': 6.1042}:  50%|█████     | 15/30 [01:03<00:57,  3.83s/it]{'epoch': 13, 'num_users': 6.0625, 'loss': 0.0369, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8699, 'compress@10': 0.6142, 'time@10': 5.9483}:  50%|█████     | 15/30 [01:07<00:57,  3.83s/it]{'epoch': 13, 'num_users': 6.0625, 'loss': 0.0369, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8699, 'compress@10': 0.6142, 'time@10': 5.9483}:  53%|█████▎    | 16/30 [01:07<00:52,  3.78s/it]{'epoch': 13, 'num_users': 5.8235, 'loss': 0.0351, 'hit_ratio@10': 0.832, 'ndcg@10': 0.864, 'compress@10': 0.6114, 'time@10': 5.7923}:  53%|█████▎    | 16/30 [01:08<00:52,  3.78s/it]  {'epoch': 13, 'num_users': 5.8235, 'loss': 0.0351, 'hit_ratio@10': 0.832, 'ndcg@10': 0.864, 'compress@10': 0.6114, 'time@10': 5.7923}:  57%|█████▋    | 17/30 [01:08<00:40,  3.15s/it]{'epoch': 13, 'num_users': 6.0556, 'loss': 0.0354, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8649, 'compress@10': 0.6123, 'time@10': 5.7503}:  57%|█████▋    | 17/30 [01:13<00:40,  3.15s/it]{'epoch': 13, 'num_users': 6.0556, 'loss': 0.0354, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8649, 'compress@10': 0.6123, 'time@10': 5.7503}:  60%|██████    | 18/30 [01:13<00:44,  3.73s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 0.0344, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8664, 'compress@10': 0.6162, 'time@10': 5.7175}:  60%|██████    | 18/30 [01:16<00:44,  3.73s/it]   {'epoch': 13, 'num_users': 6.0, 'loss': 0.0344, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8664, 'compress@10': 0.6162, 'time@10': 5.7175}:  63%|██████▎   | 19/30 [01:16<00:37,  3.39s/it]{'epoch': 13, 'num_users': 6.15, 'loss': 0.0347, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.8661, 'compress@10': 0.6129, 'time@10': 5.8542}:  63%|██████▎   | 19/30 [01:25<00:37,  3.39s/it]{'epoch': 13, 'num_users': 6.15, 'loss': 0.0347, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.8661, 'compress@10': 0.6129, 'time@10': 5.8542}:  67%|██████▋   | 20/30 [01:25<00:49,  4.92s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0363, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8636, 'compress@10': 0.6148, 'time@10': 6.0139}:  67%|██████▋   | 20/30 [01:29<00:49,  4.92s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0363, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8636, 'compress@10': 0.6148, 'time@10': 6.0139}:  70%|███████   | 21/30 [01:29<00:43,  4.84s/it]{'epoch': 13, 'num_users': 6.1818, 'loss': 0.0371, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8646, 'compress@10': 0.6129, 'time@10': 5.8977}:  70%|███████   | 21/30 [01:33<00:43,  4.84s/it]{'epoch': 13, 'num_users': 6.1818, 'loss': 0.0371, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8646, 'compress@10': 0.6129, 'time@10': 5.8977}:  73%|███████▎  | 22/30 [01:33<00:35,  4.44s/it]{'epoch': 13, 'num_users': 6.1304, 'loss': 0.0365, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8661, 'compress@10': 0.6176, 'time@10': 5.9197}:  73%|███████▎  | 22/30 [01:36<00:35,  4.44s/it]{'epoch': 13, 'num_users': 6.1304, 'loss': 0.0365, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8661, 'compress@10': 0.6176, 'time@10': 5.9197}:  77%|███████▋  | 23/30 [01:36<00:28,  4.08s/it]{'epoch': 13, 'num_users': 5.9583, 'loss': 0.0357, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.861, 'compress@10': 0.6186, 'time@10': 5.737}:  77%|███████▋  | 23/30 [01:37<00:28,  4.08s/it]  {'epoch': 13, 'num_users': 5.9583, 'loss': 0.0357, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.861, 'compress@10': 0.6186, 'time@10': 5.737}:  80%|████████  | 24/30 [01:37<00:19,  3.33s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0345, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8515, 'compress@10': 0.6238, 'time@10': 5.568}:  80%|████████  | 24/30 [01:38<00:19,  3.33s/it]  {'epoch': 13, 'num_users': 5.8, 'loss': 0.0345, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8515, 'compress@10': 0.6238, 'time@10': 5.568}:  83%|████████▎ | 25/30 [01:38<00:12,  2.57s/it]{'epoch': 13, 'num_users': 5.8077, 'loss': 0.0353, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8509, 'compress@10': 0.6142, 'time@10': 5.6619}:  83%|████████▎ | 25/30 [01:46<00:12,  2.57s/it]{'epoch': 13, 'num_users': 5.8077, 'loss': 0.0353, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8509, 'compress@10': 0.6142, 'time@10': 5.6619}:  87%|████████▋ | 26/30 [01:46<00:16,  4.21s/it]{'epoch': 13, 'num_users': 5.8889, 'loss': 0.0349, 'hit_ratio@10': 0.84, 'ndcg@10': 0.853, 'compress@10': 0.6173, 'time@10': 5.6966}:  87%|████████▋ | 26/30 [01:50<00:16,  4.21s/it]   {'epoch': 13, 'num_users': 5.8889, 'loss': 0.0349, 'hit_ratio@10': 0.84, 'ndcg@10': 0.853, 'compress@10': 0.6173, 'time@10': 5.6966}:  90%|█████████ | 27/30 [01:50<00:11,  3.95s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 0.0351, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8537, 'compress@10': 0.6063, 'time@10': 5.7658}:  90%|█████████ | 27/30 [01:57<00:11,  3.95s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 0.0351, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8537, 'compress@10': 0.6063, 'time@10': 5.7658}:  93%|█████████▎| 28/30 [01:57<00:10,  5.07s/it]{'epoch': 13, 'num_users': 5.8621, 'loss': 0.0347, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8562, 'compress@10': 0.6063, 'time@10': 5.7814}:  93%|█████████▎| 28/30 [02:00<00:10,  5.07s/it]{'epoch': 13, 'num_users': 5.8621, 'loss': 0.0347, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8562, 'compress@10': 0.6063, 'time@10': 5.7814}:  97%|█████████▋| 29/30 [02:00<00:04,  4.49s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0348, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8581, 'compress@10': 0.5972, 'time@10': 5.7737}:  97%|█████████▋| 29/30 [02:06<00:04,  4.49s/it] {'epoch': 13, 'num_users': 5.8667, 'loss': 0.0348, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8581, 'compress@10': 0.5972, 'time@10': 5.7737}: 100%|██████████| 30/30 [02:06<00:00,  4.82s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0348, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8581, 'compress@10': 0.5972, 'time@10': 5.7737}: 100%|██████████| 30/30 [02:06<00:00,  4.22s/it]
Epoch: 13
Avg # of users: 5.866666666666666
Avg Loss: 0.03481796658530966
Avg hit ratio: 0.8459988472066357
Avg ndcg: 0.8581401077938723
Avg compression ratio: 0.5972482270182876
Avg train time: 5.773668352762858
Std train time: 2.2588043709015997
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 24, 9, 20, 23, 10, 10, 9, 7, 10, 10, 24, 24, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0642, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8522, 'compress@10': 0.5668, 'time@10': 4.5708}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0642, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8522, 'compress@10': 0.5668, 'time@10': 4.5708}:   3%|▎         | 1/30 [00:02<01:07,  2.32s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8718, 'compress@10': 0.6017, 'time@10': 4.5874}:   3%|▎         | 1/30 [00:06<01:07,  2.32s/it] {'epoch': 14, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8718, 'compress@10': 0.6017, 'time@10': 4.5874}:   7%|▋         | 2/30 [00:06<01:43,  3.68s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8669, 'compress@10': 0.5939, 'time@10': 4.1798}:   7%|▋         | 2/30 [00:08<01:43,  3.68s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8669, 'compress@10': 0.5939, 'time@10': 4.1798}:  10%|█         | 3/30 [00:08<01:15,  2.81s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.036, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8602, 'compress@10': 0.6084, 'time@10': 4.2697}:  10%|█         | 3/30 [00:13<01:15,  2.81s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.036, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8602, 'compress@10': 0.6084, 'time@10': 4.2697}:  13%|█▎        | 4/30 [00:13<01:31,  3.51s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0447, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8435, 'compress@10': 0.5945, 'time@10': 5.0162}:  13%|█▎        | 4/30 [00:17<01:31,  3.51s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0447, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8435, 'compress@10': 0.5945, 'time@10': 5.0162}:  17%|█▋        | 5/30 [00:17<01:32,  3.70s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0451, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8456, 'compress@10': 0.6167, 'time@10': 5.4027}:  17%|█▋        | 5/30 [00:24<01:32,  3.70s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0451, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8456, 'compress@10': 0.6167, 'time@10': 5.4027}:  20%|██        | 6/30 [00:24<01:58,  4.95s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0435, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8496, 'compress@10': 0.6231, 'time@10': 5.7623}:  20%|██        | 6/30 [00:28<01:58,  4.95s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0435, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8496, 'compress@10': 0.6231, 'time@10': 5.7623}:  23%|██▎       | 7/30 [00:28<01:46,  4.64s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0435, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8546, 'compress@10': 0.6224, 'time@10': 5.7441}:  23%|██▎       | 7/30 [00:34<01:46,  4.64s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0435, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8546, 'compress@10': 0.6224, 'time@10': 5.7441}:  27%|██▋       | 8/30 [00:34<01:49,  4.96s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0427, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8646, 'compress@10': 0.6195, 'time@10': 6.1081}:  27%|██▋       | 8/30 [00:38<01:49,  4.96s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0427, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8646, 'compress@10': 0.6195, 'time@10': 6.1081}:  30%|███       | 9/30 [00:38<01:41,  4.83s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8706, 'compress@10': 0.6193, 'time@10': 6.1915}:  30%|███       | 9/30 [00:45<01:41,  4.83s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8706, 'compress@10': 0.6193, 'time@10': 6.1915}:  33%|███▎      | 10/30 [00:45<01:49,  5.50s/it]{'epoch': 14, 'num_users': 6.6364, 'loss': 0.0427, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.87, 'compress@10': 0.6312, 'time@10': 6.3032}:  33%|███▎      | 10/30 [00:49<01:49,  5.50s/it]{'epoch': 14, 'num_users': 6.6364, 'loss': 0.0427, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.87, 'compress@10': 0.6312, 'time@10': 6.3032}:  37%|███▋      | 11/30 [00:49<01:34,  4.96s/it]{'epoch': 14, 'num_users': 6.4167, 'loss': 0.0401, 'hit_ratio@10': 0.8343, 'ndcg@10': 0.8731, 'compress@10': 0.6371, 'time@10': 6.0658}:  37%|███▋      | 11/30 [00:53<01:34,  4.96s/it]{'epoch': 14, 'num_users': 6.4167, 'loss': 0.0401, 'hit_ratio@10': 0.8343, 'ndcg@10': 0.8731, 'compress@10': 0.6371, 'time@10': 6.0658}:  40%|████      | 12/30 [00:53<01:21,  4.52s/it]{'epoch': 14, 'num_users': 6.6154, 'loss': 0.0402, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8747, 'compress@10': 0.6252, 'time@10': 6.138}:  40%|████      | 12/30 [00:56<01:21,  4.52s/it] {'epoch': 14, 'num_users': 6.6154, 'loss': 0.0402, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8747, 'compress@10': 0.6252, 'time@10': 6.138}:  43%|████▎     | 13/30 [00:56<01:11,  4.22s/it]{'epoch': 14, 'num_users': 6.3571, 'loss': 0.0378, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8703, 'compress@10': 0.6177, 'time@10': 5.8394}:  43%|████▎     | 13/30 [00:58<01:11,  4.22s/it]{'epoch': 14, 'num_users': 6.3571, 'loss': 0.0378, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8703, 'compress@10': 0.6177, 'time@10': 5.8394}:  47%|████▋     | 14/30 [00:58<00:56,  3.55s/it]{'epoch': 14, 'num_users': 6.2667, 'loss': 0.0376, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8713, 'compress@10': 0.6212, 'time@10': 6.0461}:  47%|████▋     | 14/30 [01:03<00:56,  3.55s/it] {'epoch': 14, 'num_users': 6.2667, 'loss': 0.0376, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8713, 'compress@10': 0.6212, 'time@10': 6.0461}:  50%|█████     | 15/30 [01:03<00:57,  3.84s/it]{'epoch': 14, 'num_users': 6.0625, 'loss': 0.0359, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8721, 'compress@10': 0.6183, 'time@10': 5.894}:  50%|█████     | 15/30 [01:06<00:57,  3.84s/it]{'epoch': 14, 'num_users': 6.0625, 'loss': 0.0359, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8721, 'compress@10': 0.6183, 'time@10': 5.894}:  53%|█████▎    | 16/30 [01:06<00:52,  3.78s/it]{'epoch': 14, 'num_users': 5.8235, 'loss': 0.0341, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8655, 'compress@10': 0.6156, 'time@10': 5.7248}:  53%|█████▎    | 16/30 [01:08<00:52,  3.78s/it]{'epoch': 14, 'num_users': 5.8235, 'loss': 0.0341, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8655, 'compress@10': 0.6156, 'time@10': 5.7248}:  57%|█████▋    | 17/30 [01:08<00:40,  3.11s/it]{'epoch': 14, 'num_users': 6.0556, 'loss': 0.0343, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8661, 'compress@10': 0.6163, 'time@10': 5.6553}:  57%|█████▋    | 17/30 [01:12<00:40,  3.11s/it]{'epoch': 14, 'num_users': 6.0556, 'loss': 0.0343, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8661, 'compress@10': 0.6163, 'time@10': 5.6553}:  60%|██████    | 18/30 [01:12<00:42,  3.53s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 0.0333, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8676, 'compress@10': 0.6204, 'time@10': 5.5804}:  60%|██████    | 18/30 [01:15<00:42,  3.53s/it]   {'epoch': 14, 'num_users': 6.0, 'loss': 0.0333, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8676, 'compress@10': 0.6204, 'time@10': 5.5804}:  63%|██████▎   | 19/30 [01:15<00:34,  3.12s/it]{'epoch': 14, 'num_users': 6.15, 'loss': 0.0336, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.8673, 'compress@10': 0.6172, 'time@10': 5.7221}:  63%|██████▎   | 19/30 [01:23<00:34,  3.12s/it]{'epoch': 14, 'num_users': 6.15, 'loss': 0.0336, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.8673, 'compress@10': 0.6172, 'time@10': 5.7221}:  67%|██████▋   | 20/30 [01:23<00:47,  4.72s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0349, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8655, 'compress@10': 0.6192, 'time@10': 5.8817}:  67%|██████▋   | 20/30 [01:28<00:47,  4.72s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0349, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8655, 'compress@10': 0.6192, 'time@10': 5.8817}:  70%|███████   | 21/30 [01:28<00:42,  4.68s/it]{'epoch': 14, 'num_users': 6.1818, 'loss': 0.0354, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8664, 'compress@10': 0.6165, 'time@10': 5.7704}:  70%|███████   | 21/30 [01:31<00:42,  4.68s/it]{'epoch': 14, 'num_users': 6.1818, 'loss': 0.0354, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8664, 'compress@10': 0.6165, 'time@10': 5.7704}:  73%|███████▎  | 22/30 [01:31<00:34,  4.32s/it]{'epoch': 14, 'num_users': 6.1304, 'loss': 0.0349, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8678, 'compress@10': 0.6213, 'time@10': 5.7923}:  73%|███████▎  | 22/30 [01:34<00:34,  4.32s/it]{'epoch': 14, 'num_users': 6.1304, 'loss': 0.0349, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8678, 'compress@10': 0.6213, 'time@10': 5.7923}:  77%|███████▋  | 23/30 [01:34<00:27,  3.97s/it]{'epoch': 14, 'num_users': 5.9583, 'loss': 0.034, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8627, 'compress@10': 0.6223, 'time@10': 5.6159}:  77%|███████▋  | 23/30 [01:36<00:27,  3.97s/it] {'epoch': 14, 'num_users': 5.9583, 'loss': 0.034, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8627, 'compress@10': 0.6223, 'time@10': 5.6159}:  80%|████████  | 24/30 [01:36<00:19,  3.26s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0329, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.853, 'compress@10': 0.6274, 'time@10': 5.454}:  80%|████████  | 24/30 [01:37<00:19,  3.26s/it]    {'epoch': 14, 'num_users': 5.8, 'loss': 0.0329, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.853, 'compress@10': 0.6274, 'time@10': 5.454}:  83%|████████▎ | 25/30 [01:37<00:12,  2.53s/it]{'epoch': 14, 'num_users': 5.8077, 'loss': 0.0335, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8527, 'compress@10': 0.6183, 'time@10': 5.5523}:  83%|████████▎ | 25/30 [01:45<00:12,  2.53s/it]{'epoch': 14, 'num_users': 5.8077, 'loss': 0.0335, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8527, 'compress@10': 0.6183, 'time@10': 5.5523}:  87%|████████▋ | 26/30 [01:45<00:16,  4.19s/it]{'epoch': 14, 'num_users': 5.8889, 'loss': 0.0332, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8541, 'compress@10': 0.6213, 'time@10': 5.5985}:  87%|████████▋ | 26/30 [01:48<00:16,  4.19s/it]{'epoch': 14, 'num_users': 5.8889, 'loss': 0.0332, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8541, 'compress@10': 0.6213, 'time@10': 5.5985}:  90%|█████████ | 27/30 [01:48<00:11,  3.96s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 0.0334, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8549, 'compress@10': 0.6102, 'time@10': 5.6795}:  90%|█████████ | 27/30 [01:56<00:11,  3.96s/it]   {'epoch': 14, 'num_users': 6.0, 'loss': 0.0334, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8549, 'compress@10': 0.6102, 'time@10': 5.6795}:  93%|█████████▎| 28/30 [01:56<00:10,  5.15s/it]{'epoch': 14, 'num_users': 5.8621, 'loss': 0.033, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8574, 'compress@10': 0.6101, 'time@10': 5.6741}:  93%|█████████▎| 28/30 [01:59<00:10,  5.15s/it]{'epoch': 14, 'num_users': 5.8621, 'loss': 0.033, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8574, 'compress@10': 0.6101, 'time@10': 5.6741}:  97%|█████████▋| 29/30 [01:59<00:04,  4.44s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.0332, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8594, 'compress@10': 0.6009, 'time@10': 5.6727}:  97%|█████████▋| 29/30 [02:05<00:04,  4.44s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.0332, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8594, 'compress@10': 0.6009, 'time@10': 5.6727}: 100%|██████████| 30/30 [02:05<00:00,  4.81s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.0332, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8594, 'compress@10': 0.6009, 'time@10': 5.6727}: 100%|██████████| 30/30 [02:05<00:00,  4.17s/it]
Epoch: 14
Avg # of users: 5.866666666666666
Avg Loss: 0.03316656670244732
Avg hit ratio: 0.8453680771152071
Avg ndcg: 0.8593649499049258
Avg compression ratio: 0.6008529732337026
Avg train time: 5.672713907559713
Std train time: 2.2645554060082396
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 25, 9, 20, 24, 10, 10, 9, 7, 10, 10, 25, 25, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0396, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8741, 'compress@10': 0.5817, 'time@10': 5.6071}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0396, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8741, 'compress@10': 0.5817, 'time@10': 5.6071}:   3%|▎         | 1/30 [00:02<01:22,  2.84s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8869, 'compress@10': 0.61, 'time@10': 5.3081}:   3%|▎         | 1/30 [00:07<01:22,  2.84s/it]  {'epoch': 15, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8869, 'compress@10': 0.61, 'time@10': 5.3081}:   7%|▋         | 2/30 [00:07<01:56,  4.14s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.877, 'compress@10': 0.6024, 'time@10': 4.6392}:   7%|▋         | 2/30 [00:09<01:56,  4.14s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.877, 'compress@10': 0.6024, 'time@10': 4.6392}:  10%|█         | 3/30 [00:09<01:21,  3.02s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8642, 'compress@10': 0.6162, 'time@10': 4.5817}:  10%|█         | 3/30 [00:14<01:21,  3.02s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8642, 'compress@10': 0.6162, 'time@10': 4.5817}:  13%|█▎        | 4/30 [00:14<01:33,  3.59s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0394, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8468, 'compress@10': 0.6016, 'time@10': 5.3465}:  13%|█▎        | 4/30 [00:18<01:33,  3.59s/it] {'epoch': 15, 'num_users': 5.8, 'loss': 0.0394, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8468, 'compress@10': 0.6016, 'time@10': 5.3465}:  17%|█▋        | 5/30 [00:18<01:35,  3.82s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0405, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8488, 'compress@10': 0.6219, 'time@10': 5.6694}:  17%|█▋        | 5/30 [00:25<01:35,  3.82s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0405, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8488, 'compress@10': 0.6219, 'time@10': 5.6694}:  20%|██        | 6/30 [00:25<02:00,  5.01s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0391, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8554, 'compress@10': 0.626, 'time@10': 5.9946}:  20%|██        | 6/30 [00:29<02:00,  5.01s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0391, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8554, 'compress@10': 0.626, 'time@10': 5.9946}:  23%|██▎       | 7/30 [00:29<01:47,  4.69s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0395, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8575, 'compress@10': 0.6261, 'time@10': 5.9436}:  23%|██▎       | 7/30 [00:35<01:47,  4.69s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0395, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8575, 'compress@10': 0.6261, 'time@10': 5.9436}:  27%|██▋       | 8/30 [00:35<01:49,  4.99s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0392, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8673, 'compress@10': 0.6223, 'time@10': 6.3002}:  27%|██▋       | 8/30 [00:39<01:49,  4.99s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0392, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8673, 'compress@10': 0.6223, 'time@10': 6.3002}:  30%|███       | 9/30 [00:39<01:42,  4.87s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0394, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8681, 'compress@10': 0.6232, 'time@10': 6.3817}:  30%|███       | 9/30 [00:47<01:42,  4.87s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0394, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8681, 'compress@10': 0.6232, 'time@10': 6.3817}:  33%|███▎      | 10/30 [00:47<01:51,  5.58s/it]{'epoch': 15, 'num_users': 6.6364, 'loss': 0.0413, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8677, 'compress@10': 0.6352, 'time@10': 6.4802}:  33%|███▎      | 10/30 [00:50<01:51,  5.58s/it]{'epoch': 15, 'num_users': 6.6364, 'loss': 0.0413, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8677, 'compress@10': 0.6352, 'time@10': 6.4802}:  37%|███▋      | 11/30 [00:50<01:35,  5.03s/it]{'epoch': 15, 'num_users': 6.4167, 'loss': 0.0388, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.871, 'compress@10': 0.6408, 'time@10': 6.2673}:  37%|███▋      | 11/30 [00:54<01:35,  5.03s/it] {'epoch': 15, 'num_users': 6.4167, 'loss': 0.0388, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.871, 'compress@10': 0.6408, 'time@10': 6.2673}:  40%|████      | 12/30 [00:54<01:24,  4.71s/it]{'epoch': 15, 'num_users': 6.6154, 'loss': 0.0389, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8725, 'compress@10': 0.6306, 'time@10': 6.3502}:  40%|████      | 12/30 [00:58<01:24,  4.71s/it]{'epoch': 15, 'num_users': 6.6154, 'loss': 0.0389, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8725, 'compress@10': 0.6306, 'time@10': 6.3502}:  43%|████▎     | 13/30 [00:58<01:14,  4.41s/it]{'epoch': 15, 'num_users': 6.3571, 'loss': 0.0365, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8683, 'compress@10': 0.622, 'time@10': 6.0391}:  43%|████▎     | 13/30 [01:00<01:14,  4.41s/it] {'epoch': 15, 'num_users': 6.3571, 'loss': 0.0365, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8683, 'compress@10': 0.622, 'time@10': 6.0391}:  47%|████▋     | 14/30 [01:00<00:59,  3.69s/it]{'epoch': 15, 'num_users': 6.2667, 'loss': 0.0366, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.869, 'compress@10': 0.624, 'time@10': 6.2542}:  47%|████▋     | 14/30 [01:05<00:59,  3.69s/it] {'epoch': 15, 'num_users': 6.2667, 'loss': 0.0366, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.869, 'compress@10': 0.624, 'time@10': 6.2542}:  50%|█████     | 15/30 [01:05<00:59,  3.99s/it]{'epoch': 15, 'num_users': 6.0625, 'loss': 0.0348, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8707, 'compress@10': 0.6218, 'time@10': 6.0888}:  50%|█████     | 15/30 [01:08<00:59,  3.99s/it]{'epoch': 15, 'num_users': 6.0625, 'loss': 0.0348, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8707, 'compress@10': 0.6218, 'time@10': 6.0888}:  53%|█████▎    | 16/30 [01:08<00:54,  3.89s/it]{'epoch': 15, 'num_users': 5.8235, 'loss': 0.0331, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8642, 'compress@10': 0.6187, 'time@10': 5.9166}:  53%|█████▎    | 16/30 [01:10<00:54,  3.89s/it]{'epoch': 15, 'num_users': 5.8235, 'loss': 0.0331, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8642, 'compress@10': 0.6187, 'time@10': 5.9166}:  57%|█████▋    | 17/30 [01:10<00:41,  3.21s/it]{'epoch': 15, 'num_users': 6.0556, 'loss': 0.0333, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8647, 'compress@10': 0.6195, 'time@10': 5.8376}:  57%|█████▋    | 17/30 [01:15<00:41,  3.21s/it]{'epoch': 15, 'num_users': 6.0556, 'loss': 0.0333, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8647, 'compress@10': 0.6195, 'time@10': 5.8376}:  60%|██████    | 18/30 [01:15<00:43,  3.60s/it]{'epoch': 15, 'num_users': 6.0, 'loss': 0.0324, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8661, 'compress@10': 0.6236, 'time@10': 5.7547}:  60%|██████    | 18/30 [01:17<00:43,  3.60s/it]    {'epoch': 15, 'num_users': 6.0, 'loss': 0.0324, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8661, 'compress@10': 0.6236, 'time@10': 5.7547}:  63%|██████▎   | 19/30 [01:17<00:34,  3.17s/it]{'epoch': 15, 'num_users': 6.15, 'loss': 0.0326, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8658, 'compress@10': 0.6209, 'time@10': 5.8722}:  63%|██████▎   | 19/30 [01:25<00:34,  3.17s/it]{'epoch': 15, 'num_users': 6.15, 'loss': 0.0326, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8658, 'compress@10': 0.6209, 'time@10': 5.8722}:  67%|██████▋   | 20/30 [01:25<00:46,  4.67s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0341, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8642, 'compress@10': 0.6231, 'time@10': 6.0035}:  67%|██████▋   | 20/30 [01:29<00:46,  4.67s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0341, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8642, 'compress@10': 0.6231, 'time@10': 6.0035}:  70%|███████   | 21/30 [01:29<00:41,  4.57s/it]{'epoch': 15, 'num_users': 6.1818, 'loss': 0.0348, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8651, 'compress@10': 0.6205, 'time@10': 5.8887}:  70%|███████   | 21/30 [01:33<00:41,  4.57s/it]{'epoch': 15, 'num_users': 6.1818, 'loss': 0.0348, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8651, 'compress@10': 0.6205, 'time@10': 5.8887}:  73%|███████▎  | 22/30 [01:33<00:34,  4.26s/it]{'epoch': 15, 'num_users': 6.1304, 'loss': 0.0343, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8666, 'compress@10': 0.6253, 'time@10': 5.9047}:  73%|███████▎  | 22/30 [01:36<00:34,  4.26s/it]{'epoch': 15, 'num_users': 6.1304, 'loss': 0.0343, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8666, 'compress@10': 0.6253, 'time@10': 5.9047}:  77%|███████▋  | 23/30 [01:36<00:27,  3.93s/it]{'epoch': 15, 'num_users': 5.9583, 'loss': 0.0334, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8615, 'compress@10': 0.6265, 'time@10': 5.7262}:  77%|███████▋  | 23/30 [01:38<00:27,  3.93s/it]{'epoch': 15, 'num_users': 5.9583, 'loss': 0.0334, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8615, 'compress@10': 0.6265, 'time@10': 5.7262}:  80%|████████  | 24/30 [01:38<00:19,  3.25s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0322, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.8519, 'compress@10': 0.6314, 'time@10': 5.5628}:  80%|████████  | 24/30 [01:38<00:19,  3.25s/it]   {'epoch': 15, 'num_users': 5.8, 'loss': 0.0322, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.8519, 'compress@10': 0.6314, 'time@10': 5.5628}:  83%|████████▎ | 25/30 [01:38<00:12,  2.53s/it]{'epoch': 15, 'num_users': 5.8077, 'loss': 0.0329, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8518, 'compress@10': 0.6231, 'time@10': 5.6552}:  83%|████████▎ | 25/30 [01:46<00:12,  2.53s/it]{'epoch': 15, 'num_users': 5.8077, 'loss': 0.0329, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8518, 'compress@10': 0.6231, 'time@10': 5.6552}:  87%|████████▋ | 26/30 [01:46<00:16,  4.17s/it]{'epoch': 15, 'num_users': 5.8889, 'loss': 0.0325, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8542, 'compress@10': 0.626, 'time@10': 5.6817}:  87%|████████▋ | 26/30 [01:50<00:16,  4.17s/it] {'epoch': 15, 'num_users': 5.8889, 'loss': 0.0325, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8542, 'compress@10': 0.626, 'time@10': 5.6817}:  90%|█████████ | 27/30 [01:50<00:11,  3.89s/it]{'epoch': 15, 'num_users': 6.0, 'loss': 0.0328, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8552, 'compress@10': 0.6151, 'time@10': 5.7527}:  90%|█████████ | 27/30 [01:57<00:11,  3.89s/it]  {'epoch': 15, 'num_users': 6.0, 'loss': 0.0328, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8552, 'compress@10': 0.6151, 'time@10': 5.7527}:  93%|█████████▎| 28/30 [01:57<00:10,  5.03s/it]{'epoch': 15, 'num_users': 5.8621, 'loss': 0.0324, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8576, 'compress@10': 0.6151, 'time@10': 5.7698}:  93%|█████████▎| 28/30 [02:00<00:10,  5.03s/it]{'epoch': 15, 'num_users': 5.8621, 'loss': 0.0324, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8576, 'compress@10': 0.6151, 'time@10': 5.7698}:  97%|█████████▋| 29/30 [02:00<00:04,  4.47s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0325, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8596, 'compress@10': 0.606, 'time@10': 5.7604}:  97%|█████████▋| 29/30 [02:06<00:04,  4.47s/it] {'epoch': 15, 'num_users': 5.8667, 'loss': 0.0325, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8596, 'compress@10': 0.606, 'time@10': 5.7604}: 100%|██████████| 30/30 [02:06<00:00,  4.79s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0325, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8596, 'compress@10': 0.606, 'time@10': 5.7604}: 100%|██████████| 30/30 [02:06<00:00,  4.22s/it]
Epoch: 15
Avg # of users: 5.866666666666666
Avg Loss: 0.03248583851377735
Avg hit ratio: 0.8433856336327636
Avg ndcg: 0.8596344805342805
Avg compression ratio: 0.606004233696853
Avg train time: 5.760397084554037
Std train time: 2.22747538475826
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 26, 9, 20, 24, 10, 10, 9, 7, 10, 10, 26, 26, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8747, 'compress@10': 0.5994, 'time@10': 4.812}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8747, 'compress@10': 0.5994, 'time@10': 4.812}:   3%|▎         | 1/30 [00:02<01:10,  2.44s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.037, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.888, 'compress@10': 0.618, 'time@10': 4.6216}:   3%|▎         | 1/30 [00:06<01:10,  2.44s/it]  {'epoch': 16, 'num_users': 7.0, 'loss': 0.037, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.888, 'compress@10': 0.618, 'time@10': 4.6216}:   7%|▋         | 2/30 [00:06<01:42,  3.64s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8777, 'compress@10': 0.6098, 'time@10': 4.3472}:   7%|▋         | 2/30 [00:08<01:42,  3.64s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8777, 'compress@10': 0.6098, 'time@10': 4.3472}:  10%|█         | 3/30 [00:08<01:17,  2.86s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8674, 'compress@10': 0.6229, 'time@10': 4.4327}:  10%|█         | 3/30 [00:13<01:17,  2.86s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8674, 'compress@10': 0.6229, 'time@10': 4.4327}:  13%|█▎        | 4/30 [00:13<01:33,  3.60s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.039, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8493, 'compress@10': 0.6073, 'time@10': 5.1793}:  13%|█▎        | 4/30 [00:17<01:33,  3.60s/it]  {'epoch': 16, 'num_users': 5.8, 'loss': 0.039, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8493, 'compress@10': 0.6073, 'time@10': 5.1793}:  17%|█▋        | 5/30 [00:17<01:34,  3.79s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8504, 'compress@10': 0.6264, 'time@10': 5.5324}:  17%|█▋        | 5/30 [00:25<01:34,  3.79s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8504, 'compress@10': 0.6264, 'time@10': 5.5324}:  20%|██        | 6/30 [00:25<01:59,  5.00s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0399, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8564, 'compress@10': 0.6289, 'time@10': 5.8795}:  20%|██        | 6/30 [00:29<01:59,  5.00s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0399, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8564, 'compress@10': 0.6289, 'time@10': 5.8795}:  23%|██▎       | 7/30 [00:29<01:47,  4.68s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.04, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8578, 'compress@10': 0.6293, 'time@10': 5.8444}:  23%|██▎       | 7/30 [00:34<01:47,  4.68s/it]   {'epoch': 16, 'num_users': 6.125, 'loss': 0.04, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8578, 'compress@10': 0.6293, 'time@10': 5.8444}:  27%|██▋       | 8/30 [00:34<01:49,  4.98s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.04, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8672, 'compress@10': 0.6279, 'time@10': 6.1928}:  27%|██▋       | 8/30 [00:39<01:49,  4.98s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.04, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8672, 'compress@10': 0.6279, 'time@10': 6.1928}:  30%|███       | 9/30 [00:39<01:41,  4.84s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0398, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8688, 'compress@10': 0.628, 'time@10': 6.2829}:  30%|███       | 9/30 [00:46<01:41,  4.84s/it] {'epoch': 16, 'num_users': 6.3, 'loss': 0.0398, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8688, 'compress@10': 0.628, 'time@10': 6.2829}:  33%|███▎      | 10/30 [00:46<01:50,  5.55s/it]{'epoch': 16, 'num_users': 6.6364, 'loss': 0.0413, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8684, 'compress@10': 0.6393, 'time@10': 6.4009}:  33%|███▎      | 10/30 [00:50<01:50,  5.55s/it]{'epoch': 16, 'num_users': 6.6364, 'loss': 0.0413, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8684, 'compress@10': 0.6393, 'time@10': 6.4009}:  37%|███▋      | 11/30 [00:50<01:35,  5.02s/it]{'epoch': 16, 'num_users': 6.4167, 'loss': 0.0387, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8717, 'compress@10': 0.6446, 'time@10': 6.1528}:  37%|███▋      | 11/30 [00:53<01:35,  5.02s/it]{'epoch': 16, 'num_users': 6.4167, 'loss': 0.0387, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8717, 'compress@10': 0.6446, 'time@10': 6.1528}:  40%|████      | 12/30 [00:53<01:21,  4.55s/it]{'epoch': 16, 'num_users': 6.6154, 'loss': 0.0388, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8733, 'compress@10': 0.6358, 'time@10': 6.2202}:  40%|████      | 12/30 [00:57<01:21,  4.55s/it]{'epoch': 16, 'num_users': 6.6154, 'loss': 0.0388, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8733, 'compress@10': 0.6358, 'time@10': 6.2202}:  43%|████▎     | 13/30 [00:57<01:12,  4.25s/it]{'epoch': 16, 'num_users': 6.3571, 'loss': 0.0364, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8691, 'compress@10': 0.6269, 'time@10': 5.9274}:  43%|████▎     | 13/30 [00:59<01:12,  4.25s/it]{'epoch': 16, 'num_users': 6.3571, 'loss': 0.0364, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8691, 'compress@10': 0.6269, 'time@10': 5.9274}:  47%|████▋     | 14/30 [00:59<00:57,  3.62s/it]{'epoch': 16, 'num_users': 6.2667, 'loss': 0.0367, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.87, 'compress@10': 0.6286, 'time@10': 6.1276}:  47%|████▋     | 14/30 [01:03<00:57,  3.62s/it]  {'epoch': 16, 'num_users': 6.2667, 'loss': 0.0367, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.87, 'compress@10': 0.6286, 'time@10': 6.1276}:  50%|█████     | 15/30 [01:03<00:58,  3.89s/it]{'epoch': 16, 'num_users': 6.0625, 'loss': 0.035, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8718, 'compress@10': 0.6268, 'time@10': 5.97}:  50%|█████     | 15/30 [01:07<00:58,  3.89s/it] {'epoch': 16, 'num_users': 6.0625, 'loss': 0.035, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8718, 'compress@10': 0.6268, 'time@10': 5.97}:  53%|█████▎    | 16/30 [01:07<00:53,  3.81s/it]{'epoch': 16, 'num_users': 5.8235, 'loss': 0.0332, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8652, 'compress@10': 0.6244, 'time@10': 5.8021}:  53%|█████▎    | 16/30 [01:09<00:53,  3.81s/it]{'epoch': 16, 'num_users': 5.8235, 'loss': 0.0332, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8652, 'compress@10': 0.6244, 'time@10': 5.8021}:  57%|█████▋    | 17/30 [01:09<00:40,  3.15s/it]{'epoch': 16, 'num_users': 6.0556, 'loss': 0.0334, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8665, 'compress@10': 0.6251, 'time@10': 5.7304}:  57%|█████▋    | 17/30 [01:13<00:40,  3.15s/it]{'epoch': 16, 'num_users': 6.0556, 'loss': 0.0334, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8665, 'compress@10': 0.6251, 'time@10': 5.7304}:  60%|██████    | 18/30 [01:13<00:42,  3.57s/it]{'epoch': 16, 'num_users': 6.0, 'loss': 0.0324, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8679, 'compress@10': 0.6291, 'time@10': 5.6512}:  60%|██████    | 18/30 [01:15<00:42,  3.57s/it]   {'epoch': 16, 'num_users': 6.0, 'loss': 0.0324, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8679, 'compress@10': 0.6291, 'time@10': 5.6512}:  63%|██████▎   | 19/30 [01:15<00:34,  3.14s/it]{'epoch': 16, 'num_users': 6.15, 'loss': 0.0326, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8676, 'compress@10': 0.6264, 'time@10': 5.8089}:  63%|██████▎   | 19/30 [01:24<00:34,  3.14s/it]{'epoch': 16, 'num_users': 6.15, 'loss': 0.0326, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8676, 'compress@10': 0.6264, 'time@10': 5.8089}:  67%|██████▋   | 20/30 [01:24<00:48,  4.86s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0341, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8656, 'compress@10': 0.6289, 'time@10': 5.9664}:  67%|██████▋   | 20/30 [01:29<00:48,  4.86s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0341, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8656, 'compress@10': 0.6289, 'time@10': 5.9664}:  70%|███████   | 21/30 [01:29<00:43,  4.78s/it]{'epoch': 16, 'num_users': 6.1818, 'loss': 0.0347, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8665, 'compress@10': 0.6264, 'time@10': 5.8516}:  70%|███████   | 21/30 [01:32<00:43,  4.78s/it]{'epoch': 16, 'num_users': 6.1818, 'loss': 0.0347, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8665, 'compress@10': 0.6264, 'time@10': 5.8516}:  73%|███████▎  | 22/30 [01:32<00:35,  4.39s/it]{'epoch': 16, 'num_users': 6.1304, 'loss': 0.0341, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8682, 'compress@10': 0.631, 'time@10': 5.8675}:  73%|███████▎  | 22/30 [01:35<00:35,  4.39s/it] {'epoch': 16, 'num_users': 6.1304, 'loss': 0.0341, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8682, 'compress@10': 0.631, 'time@10': 5.8675}:  77%|███████▋  | 23/30 [01:35<00:28,  4.02s/it]{'epoch': 16, 'num_users': 5.9583, 'loss': 0.0331, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8631, 'compress@10': 0.632, 'time@10': 5.694}:  77%|███████▋  | 23/30 [01:37<00:28,  4.02s/it] {'epoch': 16, 'num_users': 5.9583, 'loss': 0.0331, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8631, 'compress@10': 0.632, 'time@10': 5.694}:  80%|████████  | 24/30 [01:37<00:20,  3.33s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.032, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8534, 'compress@10': 0.6367, 'time@10': 5.5341}:  80%|████████  | 24/30 [01:38<00:20,  3.33s/it]  {'epoch': 16, 'num_users': 5.8, 'loss': 0.032, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8534, 'compress@10': 0.6367, 'time@10': 5.5341}:  83%|████████▎ | 25/30 [01:38<00:13,  2.60s/it]{'epoch': 16, 'num_users': 5.8077, 'loss': 0.0325, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8535, 'compress@10': 0.6291, 'time@10': 5.6189}:  83%|████████▎ | 25/30 [01:46<00:13,  2.60s/it]{'epoch': 16, 'num_users': 5.8077, 'loss': 0.0325, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8535, 'compress@10': 0.6291, 'time@10': 5.6189}:  87%|████████▋ | 26/30 [01:46<00:16,  4.15s/it]{'epoch': 16, 'num_users': 5.8889, 'loss': 0.0321, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8551, 'compress@10': 0.6315, 'time@10': 5.6554}:  87%|████████▋ | 26/30 [01:49<00:16,  4.15s/it] {'epoch': 16, 'num_users': 5.8889, 'loss': 0.0321, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8551, 'compress@10': 0.6315, 'time@10': 5.6554}:  90%|█████████ | 27/30 [01:49<00:11,  3.91s/it]{'epoch': 16, 'num_users': 6.0, 'loss': 0.0325, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8562, 'compress@10': 0.6214, 'time@10': 5.7487}:  90%|█████████ | 27/30 [01:57<00:11,  3.91s/it]  {'epoch': 16, 'num_users': 6.0, 'loss': 0.0325, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8562, 'compress@10': 0.6214, 'time@10': 5.7487}:  93%|█████████▎| 28/30 [01:57<00:10,  5.23s/it]{'epoch': 16, 'num_users': 5.8621, 'loss': 0.0321, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8586, 'compress@10': 0.6213, 'time@10': 5.7956}:  93%|█████████▎| 28/30 [02:01<00:10,  5.23s/it]{'epoch': 16, 'num_users': 5.8621, 'loss': 0.0321, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8586, 'compress@10': 0.6213, 'time@10': 5.7956}:  97%|█████████▋| 29/30 [02:01<00:04,  4.74s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0322, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8613, 'compress@10': 0.6125, 'time@10': 5.7999}:  97%|█████████▋| 29/30 [02:07<00:04,  4.74s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0322, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8613, 'compress@10': 0.6125, 'time@10': 5.7999}: 100%|██████████| 30/30 [02:07<00:00,  5.11s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0322, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8613, 'compress@10': 0.6125, 'time@10': 5.7999}: 100%|██████████| 30/30 [02:07<00:00,  4.25s/it]
Epoch: 16
Avg # of users: 5.866666666666666
Avg Loss: 0.032224314843745806
Avg hit ratio: 0.8441548673382654
Avg ndcg: 0.8612618316767376
Avg compression ratio: 0.6125171538506623
Avg train time: 5.799868090947469
Std train time: 2.2645105548453857
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 27, 9, 20, 25, 10, 10, 9, 7, 10, 10, 27, 27, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0402, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8717, 'compress@10': 0.6236, 'time@10': 4.6202}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0402, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8717, 'compress@10': 0.6236, 'time@10': 4.6202}:   3%|▎         | 1/30 [00:02<01:08,  2.35s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8866, 'compress@10': 0.642, 'time@10': 4.4912}:   3%|▎         | 1/30 [00:06<01:08,  2.35s/it] {'epoch': 17, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8866, 'compress@10': 0.642, 'time@10': 4.4912}:   7%|▋         | 2/30 [00:06<01:39,  3.56s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8768, 'compress@10': 0.6298, 'time@10': 4.0124}:   7%|▋         | 2/30 [00:08<01:39,  3.56s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8768, 'compress@10': 0.6298, 'time@10': 4.0124}:  10%|█         | 3/30 [00:08<01:11,  2.65s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8705, 'compress@10': 0.6383, 'time@10': 4.137}:  10%|█         | 3/30 [00:12<01:11,  2.65s/it]  {'epoch': 17, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8705, 'compress@10': 0.6383, 'time@10': 4.137}:  13%|█▎        | 4/30 [00:12<01:28,  3.40s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0363, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8525, 'compress@10': 0.6196, 'time@10': 4.9217}:  13%|█▎        | 4/30 [00:16<01:28,  3.40s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0363, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8525, 'compress@10': 0.6196, 'time@10': 4.9217}:  17%|█▋        | 5/30 [00:16<01:31,  3.64s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0373, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8544, 'compress@10': 0.6367, 'time@10': 5.3008}:  17%|█▋        | 5/30 [00:24<01:31,  3.64s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0373, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8544, 'compress@10': 0.6367, 'time@10': 5.3008}:  20%|██        | 6/30 [00:24<01:56,  4.86s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0371, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8584, 'compress@10': 0.6392, 'time@10': 5.6007}:  20%|██        | 6/30 [00:27<01:56,  4.86s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0371, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8584, 'compress@10': 0.6392, 'time@10': 5.6007}:  23%|██▎       | 7/30 [00:27<01:43,  4.50s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0372, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.8611, 'compress@10': 0.6393, 'time@10': 5.5929}:  23%|██▎       | 7/30 [00:33<01:43,  4.50s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0372, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.8611, 'compress@10': 0.6393, 'time@10': 5.5929}:  27%|██▋       | 8/30 [00:33<01:46,  4.84s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0379, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8746, 'compress@10': 0.6392, 'time@10': 5.983}:  27%|██▋       | 8/30 [00:38<01:46,  4.84s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0379, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8746, 'compress@10': 0.6392, 'time@10': 5.983}:  30%|███       | 9/30 [00:38<01:40,  4.76s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0362, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8797, 'compress@10': 0.6377, 'time@10': 6.0905}:  30%|███       | 9/30 [00:45<01:40,  4.76s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0362, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8797, 'compress@10': 0.6377, 'time@10': 6.0905}:  33%|███▎      | 10/30 [00:45<01:49,  5.48s/it]{'epoch': 17, 'num_users': 6.6364, 'loss': 0.038, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8785, 'compress@10': 0.6481, 'time@10': 6.2151}:  33%|███▎      | 10/30 [00:48<01:49,  5.48s/it]{'epoch': 17, 'num_users': 6.6364, 'loss': 0.038, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8785, 'compress@10': 0.6481, 'time@10': 6.2151}:  37%|███▋      | 11/30 [00:48<01:34,  4.96s/it]{'epoch': 17, 'num_users': 6.4167, 'loss': 0.0356, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8809, 'compress@10': 0.6528, 'time@10': 5.9836}:  37%|███▋      | 11/30 [00:52<01:34,  4.96s/it]{'epoch': 17, 'num_users': 6.4167, 'loss': 0.0356, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8809, 'compress@10': 0.6528, 'time@10': 5.9836}:  40%|████      | 12/30 [00:52<01:21,  4.51s/it]{'epoch': 17, 'num_users': 6.6154, 'loss': 0.036, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8818, 'compress@10': 0.6453, 'time@10': 6.059}:  40%|████      | 12/30 [00:55<01:21,  4.51s/it]  {'epoch': 17, 'num_users': 6.6154, 'loss': 0.036, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8818, 'compress@10': 0.6453, 'time@10': 6.059}:  43%|████▎     | 13/30 [00:55<01:11,  4.21s/it]{'epoch': 17, 'num_users': 6.3571, 'loss': 0.0337, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8769, 'compress@10': 0.6359, 'time@10': 5.7845}:  43%|████▎     | 13/30 [00:58<01:11,  4.21s/it]{'epoch': 17, 'num_users': 6.3571, 'loss': 0.0337, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8769, 'compress@10': 0.6359, 'time@10': 5.7845}:  47%|████▋     | 14/30 [00:58<00:57,  3.62s/it]{'epoch': 17, 'num_users': 6.2667, 'loss': 0.0341, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8777, 'compress@10': 0.6385, 'time@10': 5.9902}:  47%|████▋     | 14/30 [01:02<00:57,  3.62s/it]{'epoch': 17, 'num_users': 6.2667, 'loss': 0.0341, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8777, 'compress@10': 0.6385, 'time@10': 5.9902}:  50%|█████     | 15/30 [01:02<00:58,  3.88s/it]{'epoch': 17, 'num_users': 6.0625, 'loss': 0.0324, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8792, 'compress@10': 0.6368, 'time@10': 5.8345}:  50%|█████     | 15/30 [01:06<00:58,  3.88s/it]{'epoch': 17, 'num_users': 6.0625, 'loss': 0.0324, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8792, 'compress@10': 0.6368, 'time@10': 5.8345}:  53%|█████▎    | 16/30 [01:06<00:52,  3.78s/it]{'epoch': 17, 'num_users': 5.8235, 'loss': 0.0307, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8722, 'compress@10': 0.6345, 'time@10': 5.6766}:  53%|█████▎    | 16/30 [01:07<00:52,  3.78s/it]{'epoch': 17, 'num_users': 5.8235, 'loss': 0.0307, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8722, 'compress@10': 0.6345, 'time@10': 5.6766}:  57%|█████▋    | 17/30 [01:07<00:40,  3.13s/it]{'epoch': 17, 'num_users': 6.0556, 'loss': 0.031, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8732, 'compress@10': 0.6348, 'time@10': 5.6097}:  57%|█████▋    | 17/30 [01:12<00:40,  3.13s/it] {'epoch': 17, 'num_users': 6.0556, 'loss': 0.031, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8732, 'compress@10': 0.6348, 'time@10': 5.6097}:  60%|██████    | 18/30 [01:12<00:42,  3.54s/it]{'epoch': 17, 'num_users': 6.0, 'loss': 0.0304, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8747, 'compress@10': 0.6385, 'time@10': 5.5389}:  60%|██████    | 18/30 [01:14<00:42,  3.54s/it]  {'epoch': 17, 'num_users': 6.0, 'loss': 0.0304, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8747, 'compress@10': 0.6385, 'time@10': 5.5389}:  63%|██████▎   | 19/30 [01:14<00:34,  3.13s/it]{'epoch': 17, 'num_users': 6.15, 'loss': 0.0306, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.874, 'compress@10': 0.636, 'time@10': 5.682}:  63%|██████▎   | 19/30 [01:22<00:34,  3.13s/it]  {'epoch': 17, 'num_users': 6.15, 'loss': 0.0306, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.874, 'compress@10': 0.636, 'time@10': 5.682}:  67%|██████▋   | 20/30 [01:22<00:47,  4.73s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8718, 'compress@10': 0.6385, 'time@10': 5.8441}:  67%|██████▋   | 20/30 [01:27<00:47,  4.73s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8718, 'compress@10': 0.6385, 'time@10': 5.8441}:  70%|███████   | 21/30 [01:27<00:42,  4.68s/it]{'epoch': 17, 'num_users': 6.1818, 'loss': 0.0326, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.8729, 'compress@10': 0.6357, 'time@10': 5.7346}:  70%|███████   | 21/30 [01:31<00:42,  4.68s/it]{'epoch': 17, 'num_users': 6.1818, 'loss': 0.0326, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.8729, 'compress@10': 0.6357, 'time@10': 5.7346}:  73%|███████▎  | 22/30 [01:31<00:34,  4.32s/it]{'epoch': 17, 'num_users': 6.1304, 'loss': 0.0321, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8743, 'compress@10': 0.6401, 'time@10': 5.759}:  73%|███████▎  | 22/30 [01:34<00:34,  4.32s/it] {'epoch': 17, 'num_users': 6.1304, 'loss': 0.0321, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8743, 'compress@10': 0.6401, 'time@10': 5.759}:  77%|███████▋  | 23/30 [01:34<00:27,  3.98s/it]{'epoch': 17, 'num_users': 5.9583, 'loss': 0.0312, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8689, 'compress@10': 0.6406, 'time@10': 5.5926}:  77%|███████▋  | 23/30 [01:36<00:27,  3.98s/it]{'epoch': 17, 'num_users': 5.9583, 'loss': 0.0312, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8689, 'compress@10': 0.6406, 'time@10': 5.5926}:  80%|████████  | 24/30 [01:36<00:19,  3.33s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0301, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.859, 'compress@10': 0.6451, 'time@10': 5.4389}:  80%|████████  | 24/30 [01:36<00:19,  3.33s/it]    {'epoch': 17, 'num_users': 5.8, 'loss': 0.0301, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.859, 'compress@10': 0.6451, 'time@10': 5.4389}:  83%|████████▎ | 25/30 [01:36<00:13,  2.60s/it]{'epoch': 17, 'num_users': 5.8077, 'loss': 0.0306, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8591, 'compress@10': 0.6385, 'time@10': 5.5185}:  83%|████████▎ | 25/30 [01:44<00:13,  2.60s/it]{'epoch': 17, 'num_users': 5.8077, 'loss': 0.0306, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8591, 'compress@10': 0.6385, 'time@10': 5.5185}:  87%|████████▋ | 26/30 [01:44<00:16,  4.09s/it]{'epoch': 17, 'num_users': 5.8889, 'loss': 0.0303, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8611, 'compress@10': 0.6406, 'time@10': 5.5794}:  87%|████████▋ | 26/30 [01:48<00:16,  4.09s/it]{'epoch': 17, 'num_users': 5.8889, 'loss': 0.0303, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8611, 'compress@10': 0.6406, 'time@10': 5.5794}:  90%|█████████ | 27/30 [01:48<00:11,  3.95s/it]{'epoch': 17, 'num_users': 6.0, 'loss': 0.0306, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8617, 'compress@10': 0.631, 'time@10': 5.6577}:  90%|█████████ | 27/30 [01:55<00:11,  3.95s/it]    {'epoch': 17, 'num_users': 6.0, 'loss': 0.0306, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8617, 'compress@10': 0.631, 'time@10': 5.6577}:  93%|█████████▎| 28/30 [01:55<00:10,  5.11s/it]{'epoch': 17, 'num_users': 5.8621, 'loss': 0.0302, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8639, 'compress@10': 0.6311, 'time@10': 5.6989}:  93%|█████████▎| 28/30 [01:59<00:10,  5.11s/it]{'epoch': 17, 'num_users': 5.8621, 'loss': 0.0302, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8639, 'compress@10': 0.6311, 'time@10': 5.6989}:  97%|█████████▋| 29/30 [01:59<00:04,  4.62s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.0304, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8662, 'compress@10': 0.6225, 'time@10': 5.6874}:  97%|█████████▋| 29/30 [02:04<00:04,  4.62s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.0304, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8662, 'compress@10': 0.6225, 'time@10': 5.6874}: 100%|██████████| 30/30 [02:04<00:00,  4.85s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.0304, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8662, 'compress@10': 0.6225, 'time@10': 5.6874}: 100%|██████████| 30/30 [02:04<00:00,  4.16s/it]
Epoch: 17
Avg # of users: 5.866666666666666
Avg Loss: 0.030384248687176218
Avg hit ratio: 0.8514707670102022
Avg ndcg: 0.8661726471226863
Avg compression ratio: 0.622458352865311
Avg train time: 5.687380846341451
Std train time: 2.227834730436814
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 28, 9, 20, 26, 10, 10, 9, 7, 10, 10, 28, 28, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8759, 'compress@10': 0.6509, 'time@10': 4.9538}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8759, 'compress@10': 0.6509, 'time@10': 4.9538}:   3%|▎         | 1/30 [00:02<01:13,  2.52s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8886, 'compress@10': 0.6737, 'time@10': 4.6641}:   3%|▎         | 1/30 [00:06<01:13,  2.52s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8886, 'compress@10': 0.6737, 'time@10': 4.6641}:   7%|▋         | 2/30 [00:06<01:41,  3.63s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8781, 'compress@10': 0.6573, 'time@10': 4.3005}:   7%|▋         | 2/30 [00:08<01:41,  3.63s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8781, 'compress@10': 0.6573, 'time@10': 4.3005}:  10%|█         | 3/30 [00:08<01:15,  2.81s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8727, 'compress@10': 0.6589, 'time@10': 4.2443}:  10%|█         | 3/30 [00:12<01:15,  2.81s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8727, 'compress@10': 0.6589, 'time@10': 4.2443}:  13%|█▎        | 4/30 [00:12<01:26,  3.33s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0362, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8539, 'compress@10': 0.6371, 'time@10': 5.2604}:  13%|█▎        | 4/30 [00:17<01:26,  3.33s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0362, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8539, 'compress@10': 0.6371, 'time@10': 5.2604}:  17%|█▋        | 5/30 [00:17<01:35,  3.82s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0374, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8563, 'compress@10': 0.6503, 'time@10': 5.6186}:  17%|█▋        | 5/30 [00:25<01:35,  3.82s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0374, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8563, 'compress@10': 0.6503, 'time@10': 5.6186}:  20%|██        | 6/30 [00:25<02:01,  5.06s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.036, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8623, 'compress@10': 0.6518, 'time@10': 6.0983}:  20%|██        | 6/30 [00:29<02:01,  5.06s/it] {'epoch': 18, 'num_users': 6.2857, 'loss': 0.036, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8623, 'compress@10': 0.6518, 'time@10': 6.0983}:  23%|██▎       | 7/30 [00:29<01:52,  4.89s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0361, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8654, 'compress@10': 0.6513, 'time@10': 6.0394}:  23%|██▎       | 7/30 [00:35<01:52,  4.89s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0361, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8654, 'compress@10': 0.6513, 'time@10': 6.0394}:  27%|██▋       | 8/30 [00:35<01:52,  5.14s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0373, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8798, 'compress@10': 0.6533, 'time@10': 6.3715}:  27%|██▋       | 8/30 [00:39<01:52,  5.14s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0373, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8798, 'compress@10': 0.6533, 'time@10': 6.3715}:  30%|███       | 9/30 [00:39<01:44,  4.95s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.037, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8802, 'compress@10': 0.6507, 'time@10': 6.4452}:  30%|███       | 9/30 [00:46<01:44,  4.95s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.037, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8802, 'compress@10': 0.6507, 'time@10': 6.4452}:  33%|███▎      | 10/30 [00:46<01:52,  5.63s/it]{'epoch': 18, 'num_users': 6.6364, 'loss': 0.0387, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8785, 'compress@10': 0.6599, 'time@10': 6.5435}:  33%|███▎      | 10/30 [00:50<01:52,  5.63s/it]{'epoch': 18, 'num_users': 6.6364, 'loss': 0.0387, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8785, 'compress@10': 0.6599, 'time@10': 6.5435}:  37%|███▋      | 11/30 [00:50<01:36,  5.07s/it]{'epoch': 18, 'num_users': 6.4167, 'loss': 0.0363, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8812, 'compress@10': 0.6638, 'time@10': 6.2853}:  37%|███▋      | 11/30 [00:54<01:36,  5.07s/it]{'epoch': 18, 'num_users': 6.4167, 'loss': 0.0363, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8812, 'compress@10': 0.6638, 'time@10': 6.2853}:  40%|████      | 12/30 [00:54<01:22,  4.59s/it]{'epoch': 18, 'num_users': 6.6154, 'loss': 0.0365, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.8818, 'compress@10': 0.6571, 'time@10': 6.35}:  40%|████      | 12/30 [00:57<01:22,  4.59s/it]  {'epoch': 18, 'num_users': 6.6154, 'loss': 0.0365, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.8818, 'compress@10': 0.6571, 'time@10': 6.35}:  43%|████▎     | 13/30 [00:57<01:13,  4.29s/it]{'epoch': 18, 'num_users': 6.3571, 'loss': 0.0342, 'hit_ratio@10': 0.838, 'ndcg@10': 0.877, 'compress@10': 0.6472, 'time@10': 6.0839}:  43%|████▎     | 13/30 [01:00<01:13,  4.29s/it]{'epoch': 18, 'num_users': 6.3571, 'loss': 0.0342, 'hit_ratio@10': 0.838, 'ndcg@10': 0.877, 'compress@10': 0.6472, 'time@10': 6.0839}:  47%|████▋     | 14/30 [01:00<01:00,  3.81s/it]{'epoch': 18, 'num_users': 6.2667, 'loss': 0.0341, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8781, 'compress@10': 0.6491, 'time@10': 6.2684}:  47%|████▋     | 14/30 [01:04<01:00,  3.81s/it]{'epoch': 18, 'num_users': 6.2667, 'loss': 0.0341, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8781, 'compress@10': 0.6491, 'time@10': 6.2684}:  50%|█████     | 15/30 [01:04<01:00,  4.01s/it]{'epoch': 18, 'num_users': 6.0625, 'loss': 0.0324, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8796, 'compress@10': 0.6475, 'time@10': 6.1136}:  50%|█████     | 15/30 [01:08<01:00,  4.01s/it]{'epoch': 18, 'num_users': 6.0625, 'loss': 0.0324, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8796, 'compress@10': 0.6475, 'time@10': 6.1136}:  53%|█████▎    | 16/30 [01:08<00:55,  3.95s/it]{'epoch': 18, 'num_users': 5.8235, 'loss': 0.0307, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8732, 'compress@10': 0.6454, 'time@10': 5.9778}:  53%|█████▎    | 16/30 [01:10<00:55,  3.95s/it]{'epoch': 18, 'num_users': 5.8235, 'loss': 0.0307, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8732, 'compress@10': 0.6454, 'time@10': 5.9778}:  57%|█████▋    | 17/30 [01:10<00:43,  3.35s/it]{'epoch': 18, 'num_users': 6.0556, 'loss': 0.031, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8749, 'compress@10': 0.6456, 'time@10': 5.8961}:  57%|█████▋    | 17/30 [01:15<00:43,  3.35s/it] {'epoch': 18, 'num_users': 6.0556, 'loss': 0.031, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8749, 'compress@10': 0.6456, 'time@10': 5.8961}:  60%|██████    | 18/30 [01:15<00:44,  3.71s/it]{'epoch': 18, 'num_users': 6.0, 'loss': 0.03, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8762, 'compress@10': 0.6487, 'time@10': 5.8098}:  60%|██████    | 18/30 [01:17<00:44,  3.71s/it]    {'epoch': 18, 'num_users': 6.0, 'loss': 0.03, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8762, 'compress@10': 0.6487, 'time@10': 5.8098}:  63%|██████▎   | 19/30 [01:17<00:35,  3.25s/it]{'epoch': 18, 'num_users': 6.15, 'loss': 0.0302, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8758, 'compress@10': 0.646, 'time@10': 5.9357}:  63%|██████▎   | 19/30 [01:25<00:35,  3.25s/it]{'epoch': 18, 'num_users': 6.15, 'loss': 0.0302, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8758, 'compress@10': 0.646, 'time@10': 5.9357}:  67%|██████▋   | 20/30 [01:25<00:47,  4.78s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0312, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8742, 'compress@10': 0.6484, 'time@10': 6.0851}:  67%|██████▋   | 20/30 [01:30<00:47,  4.78s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0312, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8742, 'compress@10': 0.6484, 'time@10': 6.0851}:  70%|███████   | 21/30 [01:30<00:42,  4.72s/it]{'epoch': 18, 'num_users': 6.1818, 'loss': 0.0319, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8752, 'compress@10': 0.6453, 'time@10': 5.9606}:  70%|███████   | 21/30 [01:33<00:42,  4.72s/it] {'epoch': 18, 'num_users': 6.1818, 'loss': 0.0319, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8752, 'compress@10': 0.6453, 'time@10': 5.9606}:  73%|███████▎  | 22/30 [01:33<00:34,  4.32s/it]{'epoch': 18, 'num_users': 6.1304, 'loss': 0.0314, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8765, 'compress@10': 0.6494, 'time@10': 5.9629}:  73%|███████▎  | 22/30 [01:36<00:34,  4.32s/it]{'epoch': 18, 'num_users': 6.1304, 'loss': 0.0314, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8765, 'compress@10': 0.6494, 'time@10': 5.9629}:  77%|███████▋  | 23/30 [01:36<00:27,  3.94s/it]{'epoch': 18, 'num_users': 5.9583, 'loss': 0.0304, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.871, 'compress@10': 0.6497, 'time@10': 5.7811}:  77%|███████▋  | 23/30 [01:38<00:27,  3.94s/it] {'epoch': 18, 'num_users': 5.9583, 'loss': 0.0304, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.871, 'compress@10': 0.6497, 'time@10': 5.7811}:  80%|████████  | 24/30 [01:38<00:19,  3.25s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.861, 'compress@10': 0.6541, 'time@10': 5.6137}:  80%|████████  | 24/30 [01:39<00:19,  3.25s/it]   {'epoch': 18, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.861, 'compress@10': 0.6541, 'time@10': 5.6137}:  83%|████████▎ | 25/30 [01:39<00:12,  2.52s/it]{'epoch': 18, 'num_users': 5.8077, 'loss': 0.0298, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.8611, 'compress@10': 0.6482, 'time@10': 5.6822}:  83%|████████▎ | 25/30 [01:46<00:12,  2.52s/it]{'epoch': 18, 'num_users': 5.8077, 'loss': 0.0298, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.8611, 'compress@10': 0.6482, 'time@10': 5.6822}:  87%|████████▋ | 26/30 [01:46<00:16,  4.01s/it]{'epoch': 18, 'num_users': 5.8889, 'loss': 0.0295, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.863, 'compress@10': 0.6498, 'time@10': 5.7438}:  87%|████████▋ | 26/30 [01:50<00:16,  4.01s/it] {'epoch': 18, 'num_users': 5.8889, 'loss': 0.0295, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.863, 'compress@10': 0.6498, 'time@10': 5.7438}:  90%|█████████ | 27/30 [01:50<00:11,  3.92s/it]{'epoch': 18, 'num_users': 6.0, 'loss': 0.0294, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8646, 'compress@10': 0.6404, 'time@10': 5.8169}:  90%|█████████ | 27/30 [01:58<00:11,  3.92s/it]  {'epoch': 18, 'num_users': 6.0, 'loss': 0.0294, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8646, 'compress@10': 0.6404, 'time@10': 5.8169}:  93%|█████████▎| 28/30 [01:58<00:10,  5.09s/it]{'epoch': 18, 'num_users': 5.8621, 'loss': 0.0291, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8666, 'compress@10': 0.6406, 'time@10': 5.8537}:  93%|█████████▎| 28/30 [02:01<00:10,  5.09s/it]{'epoch': 18, 'num_users': 5.8621, 'loss': 0.0291, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8666, 'compress@10': 0.6406, 'time@10': 5.8537}:  97%|█████████▋| 29/30 [02:01<00:04,  4.61s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0292, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8685, 'compress@10': 0.6323, 'time@10': 5.841}:  97%|█████████▋| 29/30 [02:07<00:04,  4.61s/it] {'epoch': 18, 'num_users': 5.8667, 'loss': 0.0292, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8685, 'compress@10': 0.6323, 'time@10': 5.841}: 100%|██████████| 30/30 [02:07<00:00,  4.88s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0292, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8685, 'compress@10': 0.6323, 'time@10': 5.841}: 100%|██████████| 30/30 [02:07<00:00,  4.24s/it]
Epoch: 18
Avg # of users: 5.866666666666666
Avg Loss: 0.029194739535412694
Avg hit ratio: 0.8497725446715625
Avg ndcg: 0.8684848052017846
Avg compression ratio: 0.6322861738925734
Avg train time: 5.841012565294902
Std train time: 2.29712696712253
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 29, 9, 20, 26, 10, 10, 9, 7, 10, 10, 29, 29, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0397, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8759, 'compress@10': 0.6763, 'time@10': 5.3007}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0397, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8759, 'compress@10': 0.6763, 'time@10': 5.3007}:   3%|▎         | 1/30 [00:02<01:19,  2.74s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8887, 'compress@10': 0.6992, 'time@10': 4.9164}:   3%|▎         | 1/30 [00:07<01:19,  2.74s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8887, 'compress@10': 0.6992, 'time@10': 4.9164}:   7%|▋         | 2/30 [00:07<01:46,  3.82s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8782, 'compress@10': 0.6795, 'time@10': 4.5441}:   7%|▋         | 2/30 [00:09<01:46,  3.82s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8782, 'compress@10': 0.6795, 'time@10': 4.5441}:  10%|█         | 3/30 [00:09<01:19,  2.96s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.028, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8646, 'compress@10': 0.6754, 'time@10': 4.4788}:  10%|█         | 3/30 [00:13<01:19,  2.96s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.028, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8646, 'compress@10': 0.6754, 'time@10': 4.4788}:  13%|█▎        | 4/30 [00:13<01:30,  3.50s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0368, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.8484, 'compress@10': 0.6536, 'time@10': 5.4243}:  13%|█▎        | 4/30 [00:18<01:30,  3.50s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0368, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.8484, 'compress@10': 0.6536, 'time@10': 5.4243}:  17%|█▋        | 5/30 [00:18<01:37,  3.91s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0366, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8544, 'compress@10': 0.6698, 'time@10': 5.7954}:  17%|█▋        | 5/30 [00:25<01:37,  3.91s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0366, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8544, 'compress@10': 0.6698, 'time@10': 5.7954}:  20%|██        | 6/30 [00:25<02:04,  5.20s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0358, 'hit_ratio@10': 0.88, 'ndcg@10': 0.8616, 'compress@10': 0.6681, 'time@10': 6.1295}:  20%|██        | 6/30 [00:30<02:04,  5.20s/it]  {'epoch': 19, 'num_users': 6.2857, 'loss': 0.0358, 'hit_ratio@10': 0.88, 'ndcg@10': 0.8616, 'compress@10': 0.6681, 'time@10': 6.1295}:  23%|██▎       | 7/30 [00:30<01:51,  4.84s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0356, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8649, 'compress@10': 0.6666, 'time@10': 6.0932}:  23%|██▎       | 7/30 [00:35<01:51,  4.84s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0356, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8649, 'compress@10': 0.6666, 'time@10': 6.0932}:  27%|██▋       | 8/30 [00:35<01:53,  5.17s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0365, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.8805, 'compress@10': 0.6689, 'time@10': 6.4217}:  27%|██▋       | 8/30 [00:40<01:53,  5.17s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0365, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.8805, 'compress@10': 0.6689, 'time@10': 6.4217}:  30%|███       | 9/30 [00:40<01:44,  4.98s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0344, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.8861, 'compress@10': 0.6648, 'time@10': 6.4896}:  30%|███       | 9/30 [00:47<01:44,  4.98s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0344, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.8861, 'compress@10': 0.6648, 'time@10': 6.4896}:  33%|███▎      | 10/30 [00:47<01:52,  5.65s/it]{'epoch': 19, 'num_users': 6.6364, 'loss': 0.0362, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8842, 'compress@10': 0.6727, 'time@10': 6.5859}:  33%|███▎      | 10/30 [00:51<01:52,  5.65s/it]{'epoch': 19, 'num_users': 6.6364, 'loss': 0.0362, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8842, 'compress@10': 0.6727, 'time@10': 6.5859}:  37%|███▋      | 11/30 [00:51<01:36,  5.09s/it]{'epoch': 19, 'num_users': 6.4167, 'loss': 0.0339, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8864, 'compress@10': 0.6755, 'time@10': 6.3235}:  37%|███▋      | 11/30 [00:54<01:36,  5.09s/it]{'epoch': 19, 'num_users': 6.4167, 'loss': 0.0339, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8864, 'compress@10': 0.6755, 'time@10': 6.3235}:  40%|████      | 12/30 [00:54<01:22,  4.60s/it]{'epoch': 19, 'num_users': 6.6154, 'loss': 0.0342, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8867, 'compress@10': 0.6698, 'time@10': 6.3752}:  40%|████      | 12/30 [00:58<01:22,  4.60s/it]{'epoch': 19, 'num_users': 6.6154, 'loss': 0.0342, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8867, 'compress@10': 0.6698, 'time@10': 6.3752}:  43%|████▎     | 13/30 [00:58<01:12,  4.28s/it]{'epoch': 19, 'num_users': 6.3571, 'loss': 0.032, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8815, 'compress@10': 0.6598, 'time@10': 6.0894}:  43%|████▎     | 13/30 [01:00<01:12,  4.28s/it] {'epoch': 19, 'num_users': 6.3571, 'loss': 0.032, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8815, 'compress@10': 0.6598, 'time@10': 6.0894}:  47%|████▋     | 14/30 [01:00<00:59,  3.71s/it]{'epoch': 19, 'num_users': 6.2667, 'loss': 0.032, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8824, 'compress@10': 0.6613, 'time@10': 6.2779}:  47%|████▋     | 14/30 [01:05<00:59,  3.71s/it]{'epoch': 19, 'num_users': 6.2667, 'loss': 0.032, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8824, 'compress@10': 0.6613, 'time@10': 6.2779}:  50%|█████     | 15/30 [01:05<00:59,  3.95s/it]{'epoch': 19, 'num_users': 6.0625, 'loss': 0.0304, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8836, 'compress@10': 0.6598, 'time@10': 6.1115}:  50%|█████     | 15/30 [01:09<00:59,  3.95s/it]{'epoch': 19, 'num_users': 6.0625, 'loss': 0.0304, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8836, 'compress@10': 0.6598, 'time@10': 6.1115}:  53%|█████▎    | 16/30 [01:09<00:54,  3.86s/it]{'epoch': 19, 'num_users': 5.8235, 'loss': 0.0288, 'hit_ratio@10': 0.839, 'ndcg@10': 0.877, 'compress@10': 0.6583, 'time@10': 5.9537}:  53%|█████▎    | 16/30 [01:10<00:54,  3.86s/it] {'epoch': 19, 'num_users': 5.8235, 'loss': 0.0288, 'hit_ratio@10': 0.839, 'ndcg@10': 0.877, 'compress@10': 0.6583, 'time@10': 5.9537}:  57%|█████▋    | 17/30 [01:10<00:41,  3.23s/it]{'epoch': 19, 'num_users': 6.0556, 'loss': 0.029, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8783, 'compress@10': 0.6577, 'time@10': 5.8695}:  57%|█████▋    | 17/30 [01:15<00:41,  3.23s/it]{'epoch': 19, 'num_users': 6.0556, 'loss': 0.029, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8783, 'compress@10': 0.6577, 'time@10': 5.8695}:  60%|██████    | 18/30 [01:15<00:43,  3.60s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 0.0287, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8794, 'compress@10': 0.6603, 'time@10': 5.7774}:  60%|██████    | 18/30 [01:17<00:43,  3.60s/it] {'epoch': 19, 'num_users': 6.0, 'loss': 0.0287, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8794, 'compress@10': 0.6603, 'time@10': 5.7774}:  63%|██████▎   | 19/30 [01:17<00:34,  3.15s/it]{'epoch': 19, 'num_users': 6.15, 'loss': 0.0288, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8789, 'compress@10': 0.6589, 'time@10': 5.9141}:  63%|██████▎   | 19/30 [01:25<00:34,  3.15s/it]{'epoch': 19, 'num_users': 6.15, 'loss': 0.0288, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8789, 'compress@10': 0.6589, 'time@10': 5.9141}:  67%|██████▋   | 20/30 [01:25<00:47,  4.78s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0304, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8772, 'compress@10': 0.6609, 'time@10': 6.0884}:  67%|██████▋   | 20/30 [01:30<00:47,  4.78s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0304, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8772, 'compress@10': 0.6609, 'time@10': 6.0884}:  70%|███████   | 21/30 [01:30<00:43,  4.79s/it]{'epoch': 19, 'num_users': 6.1818, 'loss': 0.031, 'hit_ratio@10': 0.848, 'ndcg@10': 0.878, 'compress@10': 0.6573, 'time@10': 5.9682}:  70%|███████   | 21/30 [01:34<00:43,  4.79s/it]  {'epoch': 19, 'num_users': 6.1818, 'loss': 0.031, 'hit_ratio@10': 0.848, 'ndcg@10': 0.878, 'compress@10': 0.6573, 'time@10': 5.9682}:  73%|███████▎  | 22/30 [01:34<00:35,  4.40s/it]{'epoch': 19, 'num_users': 6.1304, 'loss': 0.0306, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8793, 'compress@10': 0.661, 'time@10': 5.9889}:  73%|███████▎  | 22/30 [01:37<00:35,  4.40s/it]{'epoch': 19, 'num_users': 6.1304, 'loss': 0.0306, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8793, 'compress@10': 0.661, 'time@10': 5.9889}:  77%|███████▋  | 23/30 [01:37<00:28,  4.06s/it]{'epoch': 19, 'num_users': 5.9583, 'loss': 0.0296, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8737, 'compress@10': 0.6608, 'time@10': 5.8108}:  77%|███████▋  | 23/30 [01:39<00:28,  4.06s/it]{'epoch': 19, 'num_users': 5.9583, 'loss': 0.0296, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8737, 'compress@10': 0.6608, 'time@10': 5.8108}:  80%|████████  | 24/30 [01:39<00:20,  3.37s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0286, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8636, 'compress@10': 0.6649, 'time@10': 5.6388}:  80%|████████  | 24/30 [01:40<00:20,  3.37s/it]  {'epoch': 19, 'num_users': 5.8, 'loss': 0.0286, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8636, 'compress@10': 0.6649, 'time@10': 5.6388}:  83%|████████▎ | 25/30 [01:40<00:12,  2.60s/it]{'epoch': 19, 'num_users': 5.8077, 'loss': 0.029, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.864, 'compress@10': 0.6599, 'time@10': 5.73}:  83%|████████▎ | 25/30 [01:48<00:12,  2.60s/it] {'epoch': 19, 'num_users': 5.8077, 'loss': 0.029, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.864, 'compress@10': 0.6599, 'time@10': 5.73}:  87%|████████▋ | 26/30 [01:48<00:16,  4.23s/it]{'epoch': 19, 'num_users': 5.8889, 'loss': 0.0286, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8654, 'compress@10': 0.6608, 'time@10': 5.7822}:  87%|████████▋ | 26/30 [01:51<00:16,  4.23s/it]{'epoch': 19, 'num_users': 5.8889, 'loss': 0.0286, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8654, 'compress@10': 0.6608, 'time@10': 5.7822}:  90%|█████████ | 27/30 [01:51<00:12,  4.05s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 0.0294, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8672, 'compress@10': 0.6521, 'time@10': 5.8571}:  90%|█████████ | 27/30 [01:59<00:12,  4.05s/it]   {'epoch': 19, 'num_users': 6.0, 'loss': 0.0294, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8672, 'compress@10': 0.6521, 'time@10': 5.8571}:  93%|█████████▎| 28/30 [01:59<00:10,  5.21s/it]{'epoch': 19, 'num_users': 5.8621, 'loss': 0.029, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8691, 'compress@10': 0.6525, 'time@10': 5.8868}:  93%|█████████▎| 28/30 [02:03<00:10,  5.21s/it]{'epoch': 19, 'num_users': 5.8621, 'loss': 0.029, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8691, 'compress@10': 0.6525, 'time@10': 5.8868}:  97%|█████████▋| 29/30 [02:03<00:04,  4.67s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0292, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8721, 'compress@10': 0.6441, 'time@10': 5.8745}:  97%|█████████▋| 29/30 [02:08<00:04,  4.67s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0292, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8721, 'compress@10': 0.6441, 'time@10': 5.8745}: 100%|██████████| 30/30 [02:08<00:00,  4.93s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0292, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8721, 'compress@10': 0.6441, 'time@10': 5.8745}: 100%|██████████| 30/30 [02:08<00:00,  4.29s/it]
Epoch: 19
Avg # of users: 5.866666666666666
Avg Loss: 0.029208182242660006
Avg hit ratio: 0.8511610495777443
Avg ndcg: 0.8721049804815012
Avg compression ratio: 0.6441440161065977
Avg train time: 5.874485683441162
Std train time: 2.3229926264502136
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 30, 9, 20, 26, 10, 10, 9, 6, 10, 10, 30, 30, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0376, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8804, 'compress@10': 0.6968, 'time@10': 5.8446}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0376, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8804, 'compress@10': 0.6968, 'time@10': 5.8446}:   3%|▎         | 1/30 [00:02<01:26,  2.98s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8911, 'compress@10': 0.7171, 'time@10': 5.4107}:   3%|▎         | 1/30 [00:07<01:26,  2.98s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8911, 'compress@10': 0.7171, 'time@10': 5.4107}:   7%|▋         | 2/30 [00:07<01:56,  4.18s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8798, 'compress@10': 0.6957, 'time@10': 4.8888}:   7%|▋         | 2/30 [00:09<01:56,  4.18s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8798, 'compress@10': 0.6957, 'time@10': 4.8888}:  10%|█         | 3/30 [00:09<01:25,  3.17s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.839, 'ndcg@10': 0.865, 'compress@10': 0.6881, 'time@10': 4.7881}:  10%|█         | 3/30 [00:14<01:25,  3.17s/it]  {'epoch': 20, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.839, 'ndcg@10': 0.865, 'compress@10': 0.6881, 'time@10': 4.7881}:  13%|█▎        | 4/30 [00:14<01:36,  3.70s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0348, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8493, 'compress@10': 0.6679, 'time@10': 5.4961}:  13%|█▎        | 4/30 [00:18<01:36,  3.70s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0348, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8493, 'compress@10': 0.6679, 'time@10': 5.4961}:  17%|█▋        | 5/30 [00:18<01:37,  3.88s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0356, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8544, 'compress@10': 0.6823, 'time@10': 5.7884}:  17%|█▋        | 5/30 [00:25<01:37,  3.88s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0356, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8544, 'compress@10': 0.6823, 'time@10': 5.7884}:  20%|██        | 6/30 [00:25<02:00,  5.04s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0354, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8604, 'compress@10': 0.6811, 'time@10': 6.0694}:  20%|██        | 6/30 [00:29<02:00,  5.04s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0354, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8604, 'compress@10': 0.6811, 'time@10': 6.0694}:  23%|██▎       | 7/30 [00:29<01:47,  4.67s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0348, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8638, 'compress@10': 0.6788, 'time@10': 5.9974}:  23%|██▎       | 7/30 [00:35<01:47,  4.67s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0348, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8638, 'compress@10': 0.6788, 'time@10': 5.9974}:  27%|██▋       | 8/30 [00:35<01:48,  4.95s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0347, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8718, 'compress@10': 0.6799, 'time@10': 6.3359}:  27%|██▋       | 8/30 [00:39<01:48,  4.95s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0347, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8718, 'compress@10': 0.6799, 'time@10': 6.3359}:  30%|███       | 9/30 [00:39<01:41,  4.83s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0352, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8748, 'compress@10': 0.6759, 'time@10': 6.4007}:  30%|███       | 9/30 [00:47<01:41,  4.83s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0352, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8748, 'compress@10': 0.6759, 'time@10': 6.4007}:  33%|███▎      | 10/30 [00:47<01:50,  5.51s/it]{'epoch': 20, 'num_users': 6.6364, 'loss': 0.0368, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8739, 'compress@10': 0.6826, 'time@10': 6.514}:  33%|███▎      | 10/30 [00:50<01:50,  5.51s/it]{'epoch': 20, 'num_users': 6.6364, 'loss': 0.0368, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8739, 'compress@10': 0.6826, 'time@10': 6.514}:  37%|███▋      | 11/30 [00:50<01:35,  5.00s/it]{'epoch': 20, 'num_users': 6.4167, 'loss': 0.0344, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.8772, 'compress@10': 0.6845, 'time@10': 6.2557}:  37%|███▋      | 11/30 [00:54<01:35,  5.00s/it]{'epoch': 20, 'num_users': 6.4167, 'loss': 0.0344, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.8772, 'compress@10': 0.6845, 'time@10': 6.2557}:  40%|████      | 12/30 [00:54<01:21,  4.53s/it]{'epoch': 20, 'num_users': 6.6154, 'loss': 0.0346, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8779, 'compress@10': 0.6795, 'time@10': 6.3115}:  40%|████      | 12/30 [00:57<01:21,  4.53s/it]{'epoch': 20, 'num_users': 6.6154, 'loss': 0.0346, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8779, 'compress@10': 0.6795, 'time@10': 6.3115}:  43%|████▎     | 13/30 [00:57<01:11,  4.23s/it]{'epoch': 20, 'num_users': 6.3571, 'loss': 0.0324, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8739, 'compress@10': 0.6697, 'time@10': 6.0364}:  43%|████▎     | 13/30 [01:00<01:11,  4.23s/it]{'epoch': 20, 'num_users': 6.3571, 'loss': 0.0324, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8739, 'compress@10': 0.6697, 'time@10': 6.0364}:  47%|████▋     | 14/30 [01:00<00:59,  3.71s/it]{'epoch': 20, 'num_users': 6.2667, 'loss': 0.0327, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8751, 'compress@10': 0.6706, 'time@10': 6.2227}:  47%|████▋     | 14/30 [01:04<00:59,  3.71s/it]{'epoch': 20, 'num_users': 6.2667, 'loss': 0.0327, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8751, 'compress@10': 0.6706, 'time@10': 6.2227}:  50%|█████     | 15/30 [01:04<00:59,  3.93s/it]{'epoch': 20, 'num_users': 6.0625, 'loss': 0.031, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8771, 'compress@10': 0.6694, 'time@10': 6.0598}:  50%|█████     | 15/30 [01:08<00:59,  3.93s/it] {'epoch': 20, 'num_users': 6.0625, 'loss': 0.031, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8771, 'compress@10': 0.6694, 'time@10': 6.0598}:  53%|█████▎    | 16/30 [01:08<00:53,  3.85s/it]{'epoch': 20, 'num_users': 5.8235, 'loss': 0.0293, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8708, 'compress@10': 0.6685, 'time@10': 5.905}:  53%|█████▎    | 16/30 [01:10<00:53,  3.85s/it]{'epoch': 20, 'num_users': 5.8235, 'loss': 0.0293, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8708, 'compress@10': 0.6685, 'time@10': 5.905}:  57%|█████▋    | 17/30 [01:10<00:41,  3.22s/it]{'epoch': 20, 'num_users': 6.0556, 'loss': 0.0294, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8723, 'compress@10': 0.6673, 'time@10': 5.8277}:  57%|█████▋    | 17/30 [01:14<00:41,  3.22s/it]{'epoch': 20, 'num_users': 6.0556, 'loss': 0.0294, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8723, 'compress@10': 0.6673, 'time@10': 5.8277}:  60%|██████    | 18/30 [01:14<00:43,  3.62s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 0.0285, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8738, 'compress@10': 0.6693, 'time@10': 5.7486}:  60%|██████    | 18/30 [01:16<00:43,  3.62s/it]   {'epoch': 20, 'num_users': 6.0, 'loss': 0.0285, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8738, 'compress@10': 0.6693, 'time@10': 5.7486}:  63%|██████▎   | 19/30 [01:16<00:35,  3.20s/it]{'epoch': 20, 'num_users': 6.15, 'loss': 0.0286, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8739, 'compress@10': 0.6689, 'time@10': 5.8804}:  63%|██████▎   | 19/30 [01:25<00:35,  3.20s/it]{'epoch': 20, 'num_users': 6.15, 'loss': 0.0286, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8739, 'compress@10': 0.6689, 'time@10': 5.8804}:  67%|██████▋   | 20/30 [01:25<00:47,  4.77s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0299, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8721, 'compress@10': 0.6703, 'time@10': 5.9699}:  67%|██████▋   | 20/30 [01:29<00:47,  4.77s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0299, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8721, 'compress@10': 0.6703, 'time@10': 5.9699}:  70%|███████   | 21/30 [01:29<00:40,  4.51s/it]{'epoch': 20, 'num_users': 6.1818, 'loss': 0.0303, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.8737, 'compress@10': 0.6661, 'time@10': 5.848}:  70%|███████   | 21/30 [01:32<00:40,  4.51s/it] {'epoch': 20, 'num_users': 6.1818, 'loss': 0.0303, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.8737, 'compress@10': 0.6661, 'time@10': 5.848}:  73%|███████▎  | 22/30 [01:32<00:33,  4.16s/it]{'epoch': 20, 'num_users': 6.1304, 'loss': 0.0298, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8754, 'compress@10': 0.6694, 'time@10': 5.8512}:  73%|███████▎  | 22/30 [01:35<00:33,  4.16s/it]{'epoch': 20, 'num_users': 6.1304, 'loss': 0.0298, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8754, 'compress@10': 0.6694, 'time@10': 5.8512}:  77%|███████▋  | 23/30 [01:35<00:26,  3.81s/it]{'epoch': 20, 'num_users': 5.9583, 'loss': 0.0289, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8699, 'compress@10': 0.669, 'time@10': 5.6877}:  77%|███████▋  | 23/30 [01:37<00:26,  3.81s/it] {'epoch': 20, 'num_users': 5.9583, 'loss': 0.0289, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8699, 'compress@10': 0.669, 'time@10': 5.6877}:  80%|████████  | 24/30 [01:37<00:19,  3.26s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0279, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.86, 'compress@10': 0.6729, 'time@10': 5.5394}:  80%|████████  | 24/30 [01:38<00:19,  3.26s/it]    {'epoch': 20, 'num_users': 5.8, 'loss': 0.0279, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.86, 'compress@10': 0.6729, 'time@10': 5.5394}:  83%|████████▎ | 25/30 [01:38<00:12,  2.59s/it]{'epoch': 20, 'num_users': 5.8077, 'loss': 0.0282, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8609, 'compress@10': 0.6687, 'time@10': 5.6336}:  83%|████████▎ | 25/30 [01:46<00:12,  2.59s/it]{'epoch': 20, 'num_users': 5.8077, 'loss': 0.0282, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8609, 'compress@10': 0.6687, 'time@10': 5.6336}:  87%|████████▋ | 26/30 [01:46<00:16,  4.22s/it]{'epoch': 20, 'num_users': 5.8889, 'loss': 0.0278, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8626, 'compress@10': 0.6693, 'time@10': 5.6941}:  87%|████████▋ | 26/30 [01:50<00:16,  4.22s/it]{'epoch': 20, 'num_users': 5.8889, 'loss': 0.0278, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8626, 'compress@10': 0.6693, 'time@10': 5.6941}:  90%|█████████ | 27/30 [01:50<00:12,  4.06s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 0.0278, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8643, 'compress@10': 0.6598, 'time@10': 5.7775}:  90%|█████████ | 27/30 [01:58<00:12,  4.06s/it]   {'epoch': 20, 'num_users': 6.0, 'loss': 0.0278, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8643, 'compress@10': 0.6598, 'time@10': 5.7775}:  93%|█████████▎| 28/30 [01:58<00:10,  5.26s/it]{'epoch': 20, 'num_users': 5.8621, 'loss': 0.0274, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8664, 'compress@10': 0.6603, 'time@10': 5.7986}:  93%|█████████▎| 28/30 [02:01<00:10,  5.26s/it]{'epoch': 20, 'num_users': 5.8621, 'loss': 0.0274, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8664, 'compress@10': 0.6603, 'time@10': 5.7986}:  97%|█████████▋| 29/30 [02:01<00:04,  4.65s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.0276, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8681, 'compress@10': 0.6528, 'time@10': 5.7915}:  97%|█████████▋| 29/30 [02:07<00:04,  4.65s/it] {'epoch': 20, 'num_users': 5.8667, 'loss': 0.0276, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8681, 'compress@10': 0.6528, 'time@10': 5.7915}: 100%|██████████| 30/30 [02:07<00:00,  4.94s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.0276, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8681, 'compress@10': 0.6528, 'time@10': 5.7915}: 100%|██████████| 30/30 [02:07<00:00,  4.24s/it]
Epoch: 20
Avg # of users: 5.866666666666666
Avg Loss: 0.0275701953975883
Avg hit ratio: 0.8520133484481625
Avg ndcg: 0.86810831809138
Avg compression ratio: 0.6527693936789521
Avg train time: 5.791534916559855
Std train time: 2.116215037837661
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 31, 9, 20, 26, 10, 10, 9, 6, 10, 10, 31, 31, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0362, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8827, 'compress@10': 0.7149, 'time@10': 5.4694}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0362, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8827, 'compress@10': 0.7149, 'time@10': 5.4694}:   3%|▎         | 1/30 [00:02<01:20,  2.77s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0297, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8928, 'compress@10': 0.7316, 'time@10': 4.8731}:   3%|▎         | 1/30 [00:07<01:20,  2.77s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0297, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8928, 'compress@10': 0.7316, 'time@10': 4.8731}:   7%|▋         | 2/30 [00:07<01:43,  3.68s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8809, 'compress@10': 0.709, 'time@10': 4.5299}:   7%|▋         | 2/30 [00:09<01:43,  3.68s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8809, 'compress@10': 0.709, 'time@10': 4.5299}:  10%|█         | 3/30 [00:09<01:18,  2.90s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8769, 'compress@10': 0.697, 'time@10': 4.4879}:  10%|█         | 3/30 [00:13<01:18,  2.90s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8769, 'compress@10': 0.697, 'time@10': 4.4879}:  13%|█▎        | 4/30 [00:13<01:31,  3.50s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0328, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8595, 'compress@10': 0.6784, 'time@10': 5.361}:  13%|█▎        | 4/30 [00:17<01:31,  3.50s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0328, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8595, 'compress@10': 0.6784, 'time@10': 5.361}:  17%|█▋        | 5/30 [00:17<01:36,  3.85s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0337, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8636, 'compress@10': 0.6918, 'time@10': 5.8278}:  17%|█▋        | 5/30 [00:26<01:36,  3.85s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0337, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8636, 'compress@10': 0.6918, 'time@10': 5.8278}:  20%|██        | 6/30 [00:26<02:07,  5.33s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0329, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8678, 'compress@10': 0.694, 'time@10': 6.1277}:  20%|██        | 6/30 [00:30<02:07,  5.33s/it] {'epoch': 21, 'num_users': 6.2857, 'loss': 0.0329, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8678, 'compress@10': 0.694, 'time@10': 6.1277}:  23%|██▎       | 7/30 [00:30<01:52,  4.90s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.032, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.8716, 'compress@10': 0.6905, 'time@10': 6.1189}:  23%|██▎       | 7/30 [00:36<01:52,  4.90s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.032, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.8716, 'compress@10': 0.6905, 'time@10': 6.1189}:  27%|██▋       | 8/30 [00:36<01:56,  5.28s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0317, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8805, 'compress@10': 0.6909, 'time@10': 6.4416}:  27%|██▋       | 8/30 [00:40<01:56,  5.28s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0317, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8805, 'compress@10': 0.6909, 'time@10': 6.4416}:  30%|███       | 9/30 [00:40<01:46,  5.05s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.8839, 'compress@10': 0.6843, 'time@10': 6.5054}:  30%|███       | 9/30 [00:47<01:46,  5.05s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.8839, 'compress@10': 0.6843, 'time@10': 6.5054}:  33%|███▎      | 10/30 [00:47<01:53,  5.69s/it]{'epoch': 21, 'num_users': 6.6364, 'loss': 0.0333, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8822, 'compress@10': 0.6897, 'time@10': 6.5926}:  33%|███▎      | 10/30 [00:51<01:53,  5.69s/it]{'epoch': 21, 'num_users': 6.6364, 'loss': 0.0333, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8822, 'compress@10': 0.6897, 'time@10': 6.5926}:  37%|███▋      | 11/30 [00:51<01:36,  5.10s/it]{'epoch': 21, 'num_users': 6.4167, 'loss': 0.0312, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8848, 'compress@10': 0.6908, 'time@10': 6.3277}:  37%|███▋      | 11/30 [00:55<01:36,  5.10s/it] {'epoch': 21, 'num_users': 6.4167, 'loss': 0.0312, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8848, 'compress@10': 0.6908, 'time@10': 6.3277}:  40%|████      | 12/30 [00:55<01:22,  4.60s/it]{'epoch': 21, 'num_users': 6.6154, 'loss': 0.0316, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8847, 'compress@10': 0.6868, 'time@10': 6.3807}:  40%|████      | 12/30 [00:58<01:22,  4.60s/it]{'epoch': 21, 'num_users': 6.6154, 'loss': 0.0316, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8847, 'compress@10': 0.6868, 'time@10': 6.3807}:  43%|████▎     | 13/30 [00:58<01:12,  4.28s/it]{'epoch': 21, 'num_users': 6.3571, 'loss': 0.0295, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8802, 'compress@10': 0.6774, 'time@10': 6.1064}:  43%|████▎     | 13/30 [01:01<01:12,  4.28s/it]{'epoch': 21, 'num_users': 6.3571, 'loss': 0.0295, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8802, 'compress@10': 0.6774, 'time@10': 6.1064}:  47%|████▋     | 14/30 [01:01<01:00,  3.77s/it]{'epoch': 21, 'num_users': 6.2667, 'loss': 0.03, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8811, 'compress@10': 0.6778, 'time@10': 6.34}:  47%|████▋     | 14/30 [01:06<01:00,  3.77s/it]     {'epoch': 21, 'num_users': 6.2667, 'loss': 0.03, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8811, 'compress@10': 0.6778, 'time@10': 6.34}:  50%|█████     | 15/30 [01:06<01:01,  4.09s/it]{'epoch': 21, 'num_users': 6.0625, 'loss': 0.0284, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8827, 'compress@10': 0.6768, 'time@10': 6.1905}:  50%|█████     | 15/30 [01:10<01:01,  4.09s/it]{'epoch': 21, 'num_users': 6.0625, 'loss': 0.0284, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8827, 'compress@10': 0.6768, 'time@10': 6.1905}:  53%|█████▎    | 16/30 [01:10<00:56,  4.06s/it]{'epoch': 21, 'num_users': 5.8235, 'loss': 0.0269, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8761, 'compress@10': 0.6764, 'time@10': 6.0262}:  53%|█████▎    | 16/30 [01:11<00:56,  4.06s/it]{'epoch': 21, 'num_users': 5.8235, 'loss': 0.0269, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8761, 'compress@10': 0.6764, 'time@10': 6.0262}:  57%|█████▋    | 17/30 [01:11<00:43,  3.36s/it]{'epoch': 21, 'num_users': 6.0556, 'loss': 0.0271, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8775, 'compress@10': 0.675, 'time@10': 5.942}:  57%|█████▋    | 17/30 [01:16<00:43,  3.36s/it]  {'epoch': 21, 'num_users': 6.0556, 'loss': 0.0271, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8775, 'compress@10': 0.675, 'time@10': 5.942}:  60%|██████    | 18/30 [01:16<00:44,  3.72s/it]{'epoch': 21, 'num_users': 6.0, 'loss': 0.0268, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8789, 'compress@10': 0.6767, 'time@10': 5.8646}:  60%|██████    | 18/30 [01:18<00:44,  3.72s/it] {'epoch': 21, 'num_users': 6.0, 'loss': 0.0268, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8789, 'compress@10': 0.6767, 'time@10': 5.8646}:  63%|██████▎   | 19/30 [01:18<00:36,  3.29s/it]{'epoch': 21, 'num_users': 6.15, 'loss': 0.027, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8791, 'compress@10': 0.6771, 'time@10': 6.0107}:  63%|██████▎   | 19/30 [01:27<00:36,  3.29s/it]{'epoch': 21, 'num_users': 6.15, 'loss': 0.027, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8791, 'compress@10': 0.6771, 'time@10': 6.0107}:  67%|██████▋   | 20/30 [01:27<00:49,  4.95s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0283, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.877, 'compress@10': 0.6785, 'time@10': 6.0623}:  67%|██████▋   | 20/30 [01:31<00:49,  4.95s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0283, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.877, 'compress@10': 0.6785, 'time@10': 6.0623}:  70%|███████   | 21/30 [01:31<00:40,  4.54s/it]{'epoch': 21, 'num_users': 6.1818, 'loss': 0.029, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.878, 'compress@10': 0.6737, 'time@10': 5.933}:  70%|███████   | 21/30 [01:34<00:40,  4.54s/it]  {'epoch': 21, 'num_users': 6.1818, 'loss': 0.029, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.878, 'compress@10': 0.6737, 'time@10': 5.933}:  73%|███████▎  | 22/30 [01:34<00:33,  4.16s/it]{'epoch': 21, 'num_users': 6.1304, 'loss': 0.0286, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8794, 'compress@10': 0.6766, 'time@10': 5.9464}:  73%|███████▎  | 22/30 [01:37<00:33,  4.16s/it]{'epoch': 21, 'num_users': 6.1304, 'loss': 0.0286, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8794, 'compress@10': 0.6766, 'time@10': 5.9464}:  77%|███████▋  | 23/30 [01:37<00:27,  3.86s/it]{'epoch': 21, 'num_users': 5.9583, 'loss': 0.0277, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8738, 'compress@10': 0.6761, 'time@10': 5.7812}:  77%|███████▋  | 23/30 [01:39<00:27,  3.86s/it]{'epoch': 21, 'num_users': 5.9583, 'loss': 0.0277, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8738, 'compress@10': 0.6761, 'time@10': 5.7812}:  80%|████████  | 24/30 [01:39<00:19,  3.31s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0267, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8637, 'compress@10': 0.6798, 'time@10': 5.6262}:  80%|████████  | 24/30 [01:40<00:19,  3.31s/it]   {'epoch': 21, 'num_users': 5.8, 'loss': 0.0267, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8637, 'compress@10': 0.6798, 'time@10': 5.6262}:  83%|████████▎ | 25/30 [01:40<00:13,  2.61s/it]{'epoch': 21, 'num_users': 5.8077, 'loss': 0.027, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8647, 'compress@10': 0.6766, 'time@10': 5.7172}:  83%|████████▎ | 25/30 [01:48<00:13,  2.61s/it]{'epoch': 21, 'num_users': 5.8077, 'loss': 0.027, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8647, 'compress@10': 0.6766, 'time@10': 5.7172}:  87%|████████▋ | 26/30 [01:48<00:16,  4.24s/it]{'epoch': 21, 'num_users': 5.8889, 'loss': 0.0267, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8665, 'compress@10': 0.6766, 'time@10': 5.7562}:  87%|████████▋ | 26/30 [01:51<00:16,  4.24s/it]{'epoch': 21, 'num_users': 5.8889, 'loss': 0.0267, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8665, 'compress@10': 0.6766, 'time@10': 5.7562}:  90%|█████████ | 27/30 [01:51<00:11,  3.99s/it]{'epoch': 21, 'num_users': 6.0, 'loss': 0.0267, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.868, 'compress@10': 0.6675, 'time@10': 5.8277}:  90%|█████████ | 27/30 [01:59<00:11,  3.99s/it]    {'epoch': 21, 'num_users': 6.0, 'loss': 0.0267, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.868, 'compress@10': 0.6675, 'time@10': 5.8277}:  93%|█████████▎| 28/30 [01:59<00:10,  5.13s/it]{'epoch': 21, 'num_users': 5.8621, 'loss': 0.0263, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8701, 'compress@10': 0.6681, 'time@10': 5.8352}:  93%|█████████▎| 28/30 [02:02<00:10,  5.13s/it]{'epoch': 21, 'num_users': 5.8621, 'loss': 0.0263, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8701, 'compress@10': 0.6681, 'time@10': 5.8352}:  97%|█████████▋| 29/30 [02:02<00:04,  4.51s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0265, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8719, 'compress@10': 0.6607, 'time@10': 5.8181}:  97%|█████████▋| 29/30 [02:08<00:04,  4.51s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0265, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8719, 'compress@10': 0.6607, 'time@10': 5.8181}: 100%|██████████| 30/30 [02:08<00:00,  4.77s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0265, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8719, 'compress@10': 0.6607, 'time@10': 5.8181}: 100%|██████████| 30/30 [02:08<00:00,  4.27s/it]
Epoch: 21
Avg # of users: 5.866666666666666
Avg Loss: 0.02649687401354748
Avg hit ratio: 0.8519486408834548
Avg ndcg: 0.8718841021679185
Avg compression ratio: 0.6606604606445695
Avg train time: 5.81811691125234
Std train time: 2.1957763180220624
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 32, 8, 20, 26, 10, 10, 9, 6, 10, 10, 32, 32, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0336, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8849, 'compress@10': 0.7296, 'time@10': 5.1711}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0336, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8849, 'compress@10': 0.7296, 'time@10': 5.1711}:   3%|▎         | 1/30 [00:02<01:16,  2.62s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8992, 'compress@10': 0.7392, 'time@10': 4.7644}:   3%|▎         | 1/30 [00:07<01:16,  2.62s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8992, 'compress@10': 0.7392, 'time@10': 4.7644}:   7%|▋         | 2/30 [00:07<01:42,  3.67s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8852, 'compress@10': 0.7162, 'time@10': 4.4655}:   7%|▋         | 2/30 [00:08<01:42,  3.67s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8852, 'compress@10': 0.7162, 'time@10': 4.4655}:  10%|█         | 3/30 [00:08<01:18,  2.89s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8854, 'compress@10': 0.7028, 'time@10': 4.4424}:  10%|█         | 3/30 [00:13<01:18,  2.89s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8854, 'compress@10': 0.7028, 'time@10': 4.4424}:  13%|█▎        | 4/30 [00:13<01:30,  3.50s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0304, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8663, 'compress@10': 0.6862, 'time@10': 5.2104}:  13%|█▎        | 4/30 [00:17<01:30,  3.50s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0304, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8663, 'compress@10': 0.6862, 'time@10': 5.2104}:  17%|█▋        | 5/30 [00:17<01:33,  3.74s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0305, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.8728, 'compress@10': 0.7016, 'time@10': 5.5569}:  17%|█▋        | 5/30 [00:24<01:33,  3.74s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0305, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.8728, 'compress@10': 0.7016, 'time@10': 5.5569}:  20%|██        | 6/30 [00:24<01:59,  4.96s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0296, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8776, 'compress@10': 0.7078, 'time@10': 5.8996}:  20%|██        | 6/30 [00:28<01:59,  4.96s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0296, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8776, 'compress@10': 0.7078, 'time@10': 5.8996}:  23%|██▎       | 7/30 [00:28<01:47,  4.65s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.8799, 'compress@10': 0.7031, 'time@10': 5.866}:  23%|██▎       | 7/30 [00:34<01:47,  4.65s/it]  {'epoch': 22, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.8799, 'compress@10': 0.7031, 'time@10': 5.866}:  27%|██▋       | 8/30 [00:34<01:49,  4.98s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0292, 'hit_ratio@10': 0.884, 'ndcg@10': 0.8876, 'compress@10': 0.7022, 'time@10': 6.1868}:  27%|██▋       | 8/30 [00:39<01:49,  4.98s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0292, 'hit_ratio@10': 0.884, 'ndcg@10': 0.8876, 'compress@10': 0.7022, 'time@10': 6.1868}:  30%|███       | 9/30 [00:39<01:40,  4.80s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0279, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.8933, 'compress@10': 0.6956, 'time@10': 6.2861}:  30%|███       | 9/30 [00:46<01:40,  4.80s/it]  {'epoch': 22, 'num_users': 6.3, 'loss': 0.0279, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.8933, 'compress@10': 0.6956, 'time@10': 6.2861}:  33%|███▎      | 10/30 [00:46<01:51,  5.56s/it]{'epoch': 22, 'num_users': 6.6364, 'loss': 0.0299, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8906, 'compress@10': 0.6997, 'time@10': 6.3971}:  33%|███▎      | 10/30 [00:50<01:51,  5.56s/it]{'epoch': 22, 'num_users': 6.6364, 'loss': 0.0299, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8906, 'compress@10': 0.6997, 'time@10': 6.3971}:  37%|███▋      | 11/30 [00:50<01:35,  5.02s/it]{'epoch': 22, 'num_users': 6.4167, 'loss': 0.028, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8925, 'compress@10': 0.6997, 'time@10': 6.1552}:  37%|███▋      | 11/30 [00:53<01:35,  5.02s/it]  {'epoch': 22, 'num_users': 6.4167, 'loss': 0.028, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8925, 'compress@10': 0.6997, 'time@10': 6.1552}:  40%|████      | 12/30 [00:53<01:22,  4.57s/it]{'epoch': 22, 'num_users': 6.6154, 'loss': 0.0284, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8918, 'compress@10': 0.6971, 'time@10': 6.2295}:  40%|████      | 12/30 [00:57<01:22,  4.57s/it]{'epoch': 22, 'num_users': 6.6154, 'loss': 0.0284, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8918, 'compress@10': 0.6971, 'time@10': 6.2295}:  43%|████▎     | 13/30 [00:57<01:12,  4.28s/it]{'epoch': 22, 'num_users': 6.3571, 'loss': 0.0266, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8868, 'compress@10': 0.6878, 'time@10': 5.9765}:  43%|████▎     | 13/30 [00:59<01:12,  4.28s/it]{'epoch': 22, 'num_users': 6.3571, 'loss': 0.0266, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8868, 'compress@10': 0.6878, 'time@10': 5.9765}:  47%|████▋     | 14/30 [00:59<01:00,  3.81s/it]{'epoch': 22, 'num_users': 6.2667, 'loss': 0.0268, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8872, 'compress@10': 0.6881, 'time@10': 6.1024}:  47%|████▋     | 14/30 [01:03<01:00,  3.81s/it]{'epoch': 22, 'num_users': 6.2667, 'loss': 0.0268, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8872, 'compress@10': 0.6881, 'time@10': 6.1024}:  50%|█████     | 15/30 [01:03<00:57,  3.86s/it]{'epoch': 22, 'num_users': 6.0625, 'loss': 0.0254, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8887, 'compress@10': 0.6869, 'time@10': 5.9452}:  50%|█████     | 15/30 [01:07<00:57,  3.86s/it]{'epoch': 22, 'num_users': 6.0625, 'loss': 0.0254, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8887, 'compress@10': 0.6869, 'time@10': 5.9452}:  53%|█████▎    | 16/30 [01:07<00:53,  3.79s/it]{'epoch': 22, 'num_users': 5.8235, 'loss': 0.0241, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8818, 'compress@10': 0.6866, 'time@10': 5.7901}:  53%|█████▎    | 16/30 [01:09<00:53,  3.79s/it]{'epoch': 22, 'num_users': 5.8235, 'loss': 0.0241, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8818, 'compress@10': 0.6866, 'time@10': 5.7901}:  57%|█████▋    | 17/30 [01:09<00:41,  3.16s/it]{'epoch': 22, 'num_users': 6.0556, 'loss': 0.0243, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8828, 'compress@10': 0.6849, 'time@10': 5.7074}:  57%|█████▋    | 17/30 [01:13<00:41,  3.16s/it]{'epoch': 22, 'num_users': 6.0556, 'loss': 0.0243, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8828, 'compress@10': 0.6849, 'time@10': 5.7074}:  60%|██████    | 18/30 [01:13<00:42,  3.51s/it]{'epoch': 22, 'num_users': 6.0, 'loss': 0.0236, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8837, 'compress@10': 0.686, 'time@10': 5.6315}:  60%|██████    | 18/30 [01:15<00:42,  3.51s/it]    {'epoch': 22, 'num_users': 6.0, 'loss': 0.0236, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8837, 'compress@10': 0.686, 'time@10': 5.6315}:  63%|██████▎   | 19/30 [01:15<00:34,  3.11s/it]{'epoch': 22, 'num_users': 6.15, 'loss': 0.0238, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8838, 'compress@10': 0.6875, 'time@10': 5.7672}:  63%|██████▎   | 19/30 [01:24<00:34,  3.11s/it]{'epoch': 22, 'num_users': 6.15, 'loss': 0.0238, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8838, 'compress@10': 0.6875, 'time@10': 5.7672}:  67%|██████▋   | 20/30 [01:24<00:46,  4.70s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0249, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8823, 'compress@10': 0.6881, 'time@10': 5.8487}:  67%|██████▋   | 20/30 [01:27<00:46,  4.70s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0249, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8823, 'compress@10': 0.6881, 'time@10': 5.8487}:  70%|███████   | 21/30 [01:27<00:39,  4.42s/it]{'epoch': 22, 'num_users': 6.1818, 'loss': 0.0256, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8835, 'compress@10': 0.6825, 'time@10': 5.7241}:  70%|███████   | 21/30 [01:31<00:39,  4.42s/it]{'epoch': 22, 'num_users': 6.1818, 'loss': 0.0256, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8835, 'compress@10': 0.6825, 'time@10': 5.7241}:  73%|███████▎  | 22/30 [01:31<00:32,  4.04s/it]{'epoch': 22, 'num_users': 6.1304, 'loss': 0.0253, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8847, 'compress@10': 0.685, 'time@10': 5.7556}:  73%|███████▎  | 22/30 [01:34<00:32,  4.04s/it] {'epoch': 22, 'num_users': 6.1304, 'loss': 0.0253, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8847, 'compress@10': 0.685, 'time@10': 5.7556}:  77%|███████▋  | 23/30 [01:34<00:26,  3.81s/it]{'epoch': 22, 'num_users': 5.9583, 'loss': 0.0245, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8788, 'compress@10': 0.6844, 'time@10': 5.6072}:  77%|███████▋  | 23/30 [01:36<00:26,  3.81s/it] {'epoch': 22, 'num_users': 5.9583, 'loss': 0.0245, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8788, 'compress@10': 0.6844, 'time@10': 5.6072}:  80%|████████  | 24/30 [01:36<00:20,  3.34s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0236, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8685, 'compress@10': 0.6879, 'time@10': 5.4686}:  80%|████████  | 24/30 [01:37<00:20,  3.34s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.0236, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8685, 'compress@10': 0.6879, 'time@10': 5.4686}:  83%|████████▎ | 25/30 [01:37<00:13,  2.67s/it]{'epoch': 22, 'num_users': 5.8077, 'loss': 0.024, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8696, 'compress@10': 0.6858, 'time@10': 5.5734}:  83%|████████▎ | 25/30 [01:45<00:13,  2.67s/it]{'epoch': 22, 'num_users': 5.8077, 'loss': 0.024, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8696, 'compress@10': 0.6858, 'time@10': 5.5734}:  87%|████████▋ | 26/30 [01:45<00:17,  4.34s/it]{'epoch': 22, 'num_users': 5.8889, 'loss': 0.0237, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8712, 'compress@10': 0.6852, 'time@10': 5.6266}:  87%|████████▋ | 26/30 [01:49<00:17,  4.34s/it]{'epoch': 22, 'num_users': 5.8889, 'loss': 0.0237, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8712, 'compress@10': 0.6852, 'time@10': 5.6266}:  90%|█████████ | 27/30 [01:49<00:12,  4.10s/it]{'epoch': 22, 'num_users': 6.0, 'loss': 0.0247, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8743, 'compress@10': 0.6786, 'time@10': 5.7092}:  90%|█████████ | 27/30 [01:57<00:12,  4.10s/it]   {'epoch': 22, 'num_users': 6.0, 'loss': 0.0247, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8743, 'compress@10': 0.6786, 'time@10': 5.7092}:  93%|█████████▎| 28/30 [01:57<00:10,  5.26s/it]{'epoch': 22, 'num_users': 5.8621, 'loss': 0.0244, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8765, 'compress@10': 0.6788, 'time@10': 5.7307}:  93%|█████████▎| 28/30 [02:00<00:10,  5.26s/it]{'epoch': 22, 'num_users': 5.8621, 'loss': 0.0244, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8765, 'compress@10': 0.6788, 'time@10': 5.7307}:  97%|█████████▋| 29/30 [02:00<00:04,  4.65s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0247, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.879, 'compress@10': 0.6731, 'time@10': 5.7256}:  97%|█████████▋| 29/30 [02:06<00:04,  4.65s/it] {'epoch': 22, 'num_users': 5.8667, 'loss': 0.0247, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.879, 'compress@10': 0.6731, 'time@10': 5.7256}: 100%|██████████| 30/30 [02:06<00:00,  4.94s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0247, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.879, 'compress@10': 0.6731, 'time@10': 5.7256}: 100%|██████████| 30/30 [02:06<00:00,  4.21s/it]
Epoch: 22
Avg # of users: 5.866666666666666
Avg Loss: 0.024709043306297626
Avg hit ratio: 0.8571742171090313
Avg ndcg: 0.879024033303453
Avg compression ratio: 0.6730952278638775
Avg train time: 5.7255750815073645
Std train time: 2.0564082959887804
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 33, 8, 20, 26, 10, 10, 9, 6, 11, 10, 33, 33, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8864, 'compress@10': 0.7401, 'time@10': 6.8764}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8864, 'compress@10': 0.7401, 'time@10': 6.8764}:   3%|▎         | 1/30 [00:03<01:40,  3.48s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9013, 'compress@10': 0.7445, 'time@10': 5.69}:   3%|▎         | 1/30 [00:08<01:40,  3.48s/it]  {'epoch': 23, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9013, 'compress@10': 0.7445, 'time@10': 5.69}:   7%|▋         | 2/30 [00:08<01:54,  4.10s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8866, 'compress@10': 0.7219, 'time@10': 4.9303}:   7%|▋         | 2/30 [00:09<01:54,  4.10s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8866, 'compress@10': 0.7219, 'time@10': 4.9303}:  10%|█         | 3/30 [00:09<01:21,  3.03s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0256, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.883, 'compress@10': 0.7042, 'time@10': 4.7143}:  10%|█         | 3/30 [00:13<01:21,  3.03s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0256, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.883, 'compress@10': 0.7042, 'time@10': 4.7143}:  13%|█▎        | 4/30 [00:13<01:29,  3.45s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0334, 'hit_ratio@10': 0.844, 'ndcg@10': 0.865, 'compress@10': 0.6899, 'time@10': 5.4117}:  13%|█▎        | 4/30 [00:18<01:29,  3.45s/it] {'epoch': 23, 'num_users': 5.8, 'loss': 0.0334, 'hit_ratio@10': 0.844, 'ndcg@10': 0.865, 'compress@10': 0.6899, 'time@10': 5.4117}:  17%|█▋        | 5/30 [00:18<01:32,  3.70s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0341, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8728, 'compress@10': 0.7047, 'time@10': 5.8559}:  17%|█▋        | 5/30 [00:26<01:32,  3.70s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0341, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8728, 'compress@10': 0.7047, 'time@10': 5.8559}:  20%|██        | 6/30 [00:26<02:04,  5.20s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0342, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8773, 'compress@10': 0.713, 'time@10': 6.157}:  20%|██        | 6/30 [00:30<02:04,  5.20s/it]  {'epoch': 23, 'num_users': 6.2857, 'loss': 0.0342, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8773, 'compress@10': 0.713, 'time@10': 6.157}:  23%|██▎       | 7/30 [00:30<01:50,  4.82s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0327, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8798, 'compress@10': 0.7086, 'time@10': 6.0936}:  23%|██▎       | 7/30 [00:35<01:50,  4.82s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0327, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8798, 'compress@10': 0.7086, 'time@10': 6.0936}:  27%|██▋       | 8/30 [00:35<01:52,  5.10s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.033, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8878, 'compress@10': 0.7084, 'time@10': 6.395}:  27%|██▋       | 8/30 [00:40<01:52,  5.10s/it] {'epoch': 23, 'num_users': 6.3333, 'loss': 0.033, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8878, 'compress@10': 0.7084, 'time@10': 6.395}:  30%|███       | 9/30 [00:40<01:42,  4.89s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0331, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.8857, 'compress@10': 0.7028, 'time@10': 6.4637}:  30%|███       | 9/30 [00:47<01:42,  4.89s/it] {'epoch': 23, 'num_users': 6.3, 'loss': 0.0331, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.8857, 'compress@10': 0.7028, 'time@10': 6.4637}:  33%|███▎      | 10/30 [00:47<01:51,  5.58s/it]{'epoch': 23, 'num_users': 6.6364, 'loss': 0.0344, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.8841, 'compress@10': 0.706, 'time@10': 6.5644}:  33%|███▎      | 10/30 [00:51<01:51,  5.58s/it]{'epoch': 23, 'num_users': 6.6364, 'loss': 0.0344, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.8841, 'compress@10': 0.706, 'time@10': 6.5644}:  37%|███▋      | 11/30 [00:51<01:35,  5.04s/it]{'epoch': 23, 'num_users': 6.4167, 'loss': 0.0321, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8866, 'compress@10': 0.7054, 'time@10': 6.2929}:  37%|███▋      | 11/30 [00:54<01:35,  5.04s/it]{'epoch': 23, 'num_users': 6.4167, 'loss': 0.0321, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8866, 'compress@10': 0.7054, 'time@10': 6.2929}:  40%|████      | 12/30 [00:54<01:21,  4.53s/it]{'epoch': 23, 'num_users': 6.6154, 'loss': 0.0323, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8862, 'compress@10': 0.7043, 'time@10': 6.3462}:  40%|████      | 12/30 [00:58<01:21,  4.53s/it]{'epoch': 23, 'num_users': 6.6154, 'loss': 0.0323, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8862, 'compress@10': 0.7043, 'time@10': 6.3462}:  43%|████▎     | 13/30 [00:58<01:11,  4.23s/it]{'epoch': 23, 'num_users': 6.3571, 'loss': 0.0302, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8816, 'compress@10': 0.696, 'time@10': 6.0887}:  43%|████▎     | 13/30 [01:00<01:11,  4.23s/it] {'epoch': 23, 'num_users': 6.3571, 'loss': 0.0302, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8816, 'compress@10': 0.696, 'time@10': 6.0887}:  47%|████▋     | 14/30 [01:00<01:00,  3.79s/it]{'epoch': 23, 'num_users': 6.2667, 'loss': 0.0305, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8842, 'compress@10': 0.6966, 'time@10': 6.2097}:  47%|████▋     | 14/30 [01:04<01:00,  3.79s/it]{'epoch': 23, 'num_users': 6.2667, 'loss': 0.0305, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8842, 'compress@10': 0.6966, 'time@10': 6.2097}:  50%|█████     | 15/30 [01:04<00:57,  3.85s/it]{'epoch': 23, 'num_users': 6.0625, 'loss': 0.0289, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8859, 'compress@10': 0.6948, 'time@10': 6.0393}:  50%|█████     | 15/30 [01:08<00:57,  3.85s/it]{'epoch': 23, 'num_users': 6.0625, 'loss': 0.0289, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8859, 'compress@10': 0.6948, 'time@10': 6.0393}:  53%|█████▎    | 16/30 [01:08<00:52,  3.75s/it]{'epoch': 23, 'num_users': 5.8235, 'loss': 0.0273, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8791, 'compress@10': 0.6944, 'time@10': 5.8908}:  53%|█████▎    | 16/30 [01:10<00:52,  3.75s/it]{'epoch': 23, 'num_users': 5.8235, 'loss': 0.0273, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8791, 'compress@10': 0.6944, 'time@10': 5.8908}:  57%|█████▋    | 17/30 [01:10<00:41,  3.16s/it]{'epoch': 23, 'num_users': 6.0556, 'loss': 0.0273, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8804, 'compress@10': 0.6927, 'time@10': 5.8117}:  57%|█████▋    | 17/30 [01:14<00:41,  3.16s/it]{'epoch': 23, 'num_users': 6.0556, 'loss': 0.0273, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8804, 'compress@10': 0.6927, 'time@10': 5.8117}:  60%|██████    | 18/30 [01:14<00:42,  3.57s/it]{'epoch': 23, 'num_users': 6.0, 'loss': 0.0267, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8818, 'compress@10': 0.6933, 'time@10': 5.7308}:  60%|██████    | 18/30 [01:16<00:42,  3.57s/it]   {'epoch': 23, 'num_users': 6.0, 'loss': 0.0267, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8818, 'compress@10': 0.6933, 'time@10': 5.7308}:  63%|██████▎   | 19/30 [01:16<00:34,  3.15s/it]{'epoch': 23, 'num_users': 6.15, 'loss': 0.0268, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8821, 'compress@10': 0.6942, 'time@10': 5.8604}:  63%|██████▎   | 19/30 [01:25<00:34,  3.15s/it]{'epoch': 23, 'num_users': 6.15, 'loss': 0.0268, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8821, 'compress@10': 0.6942, 'time@10': 5.8604}:  67%|██████▋   | 20/30 [01:25<00:47,  4.72s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8801, 'compress@10': 0.6949, 'time@10': 5.9316}:  67%|██████▋   | 20/30 [01:28<00:47,  4.72s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8801, 'compress@10': 0.6949, 'time@10': 5.9316}:  70%|███████   | 21/30 [01:28<00:39,  4.42s/it]{'epoch': 23, 'num_users': 6.1818, 'loss': 0.0286, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8802, 'compress@10': 0.689, 'time@10': 5.8194}:  70%|███████   | 21/30 [01:32<00:39,  4.42s/it] {'epoch': 23, 'num_users': 6.1818, 'loss': 0.0286, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8802, 'compress@10': 0.689, 'time@10': 5.8194}:  73%|███████▎  | 22/30 [01:32<00:33,  4.14s/it]{'epoch': 23, 'num_users': 6.1304, 'loss': 0.028, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8822, 'compress@10': 0.6917, 'time@10': 5.8357}:  73%|███████▎  | 22/30 [01:35<00:33,  4.14s/it]{'epoch': 23, 'num_users': 6.1304, 'loss': 0.028, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8822, 'compress@10': 0.6917, 'time@10': 5.8357}:  77%|███████▋  | 23/30 [01:35<00:26,  3.84s/it]{'epoch': 23, 'num_users': 5.9583, 'loss': 0.027, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8764, 'compress@10': 0.6913, 'time@10': 5.683}:  77%|███████▋  | 23/30 [01:37<00:26,  3.84s/it] {'epoch': 23, 'num_users': 5.9583, 'loss': 0.027, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8764, 'compress@10': 0.6913, 'time@10': 5.683}:  80%|████████  | 24/30 [01:37<00:20,  3.35s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0261, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8674, 'compress@10': 0.6945, 'time@10': 5.5417}:  80%|████████  | 24/30 [01:38<00:20,  3.35s/it] {'epoch': 23, 'num_users': 5.8, 'loss': 0.0261, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8674, 'compress@10': 0.6945, 'time@10': 5.5417}:  83%|████████▎ | 25/30 [01:38<00:13,  2.68s/it]{'epoch': 23, 'num_users': 5.8077, 'loss': 0.0262, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8687, 'compress@10': 0.6932, 'time@10': 5.6378}:  83%|████████▎ | 25/30 [01:47<00:13,  2.68s/it]{'epoch': 23, 'num_users': 5.8077, 'loss': 0.0262, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8687, 'compress@10': 0.6932, 'time@10': 5.6378}:  87%|████████▋ | 26/30 [01:47<00:17,  4.31s/it]{'epoch': 23, 'num_users': 5.8889, 'loss': 0.0259, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8704, 'compress@10': 0.6921, 'time@10': 5.6908}:  87%|████████▋ | 26/30 [01:50<00:17,  4.31s/it]{'epoch': 23, 'num_users': 5.8889, 'loss': 0.0259, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8704, 'compress@10': 0.6921, 'time@10': 5.6908}:  90%|█████████ | 27/30 [01:50<00:12,  4.09s/it]{'epoch': 23, 'num_users': 6.0, 'loss': 0.0259, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8726, 'compress@10': 0.6823, 'time@10': 5.7646}:  90%|█████████ | 27/30 [01:58<00:12,  4.09s/it]   {'epoch': 23, 'num_users': 6.0, 'loss': 0.0259, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8726, 'compress@10': 0.6823, 'time@10': 5.7646}:  93%|█████████▎| 28/30 [01:58<00:10,  5.20s/it]{'epoch': 23, 'num_users': 5.8621, 'loss': 0.0255, 'hit_ratio@10': 0.861, 'ndcg@10': 0.875, 'compress@10': 0.6823, 'time@10': 5.7954}:  93%|█████████▎| 28/30 [02:01<00:10,  5.20s/it]{'epoch': 23, 'num_users': 5.8621, 'loss': 0.0255, 'hit_ratio@10': 0.861, 'ndcg@10': 0.875, 'compress@10': 0.6823, 'time@10': 5.7954}:  97%|█████████▋| 29/30 [02:01<00:04,  4.65s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0258, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8773, 'compress@10': 0.6761, 'time@10': 5.7879}:  97%|█████████▋| 29/30 [02:07<00:04,  4.65s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0258, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8773, 'compress@10': 0.6761, 'time@10': 5.7879}: 100%|██████████| 30/30 [02:07<00:00,  4.94s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0258, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8773, 'compress@10': 0.6761, 'time@10': 5.7879}: 100%|██████████| 30/30 [02:07<00:00,  4.25s/it]
Epoch: 23
Avg # of users: 5.866666666666666
Avg Loss: 0.025754427883184147
Avg hit ratio: 0.8601936976285116
Avg ndcg: 0.8772685422350462
Avg compression ratio: 0.6760655300725219
Avg train time: 5.7878913402557375
Std train time: 2.0755557529689055
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 34, 8, 20, 26, 10, 10, 9, 6, 11, 10, 34, 34, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8849, 'compress@10': 0.7457, 'time@10': 5.8056}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8849, 'compress@10': 0.7457, 'time@10': 5.8056}:   3%|▎         | 1/30 [00:02<01:25,  2.94s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.905, 'compress@10': 0.7396, 'time@10': 4.9842}:   3%|▎         | 1/30 [00:07<01:25,  2.94s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.905, 'compress@10': 0.7396, 'time@10': 4.9842}:   7%|▋         | 2/30 [00:07<01:43,  3.68s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8891, 'compress@10': 0.7196, 'time@10': 4.5021}:   7%|▋         | 2/30 [00:08<01:43,  3.68s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8891, 'compress@10': 0.7196, 'time@10': 4.5021}:  10%|█         | 3/30 [00:08<01:16,  2.83s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8769, 'compress@10': 0.7043, 'time@10': 4.4354}:  10%|█         | 3/30 [00:13<01:16,  2.83s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8769, 'compress@10': 0.7043, 'time@10': 4.4354}:  13%|█▎        | 4/30 [00:13<01:28,  3.40s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8617, 'compress@10': 0.6919, 'time@10': 5.0531}:  13%|█▎        | 4/30 [00:17<01:28,  3.40s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8617, 'compress@10': 0.6919, 'time@10': 5.0531}:  17%|█▋        | 5/30 [00:17<01:28,  3.54s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0312, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8696, 'compress@10': 0.7087, 'time@10': 5.4637}:  17%|█▋        | 5/30 [00:24<01:28,  3.54s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0312, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8696, 'compress@10': 0.7087, 'time@10': 5.4637}:  20%|██        | 6/30 [00:24<01:57,  4.91s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0311, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8718, 'compress@10': 0.7184, 'time@10': 5.8106}:  20%|██        | 6/30 [00:28<01:57,  4.91s/it] {'epoch': 24, 'num_users': 6.2857, 'loss': 0.0311, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8718, 'compress@10': 0.7184, 'time@10': 5.8106}:  23%|██▎       | 7/30 [00:28<01:45,  4.61s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0301, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.8738, 'compress@10': 0.7128, 'time@10': 5.8234}:  23%|██▎       | 7/30 [00:34<01:45,  4.61s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0301, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.8738, 'compress@10': 0.7128, 'time@10': 5.8234}:  27%|██▋       | 8/30 [00:34<01:50,  5.04s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0316, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8889, 'compress@10': 0.713, 'time@10': 6.1691}:  27%|██▋       | 8/30 [00:39<01:50,  5.04s/it] {'epoch': 24, 'num_users': 6.3333, 'loss': 0.0316, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8889, 'compress@10': 0.713, 'time@10': 6.1691}:  30%|███       | 9/30 [00:39<01:42,  4.87s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.8957, 'compress@10': 0.708, 'time@10': 6.2784}:  30%|███       | 9/30 [00:46<01:42,  4.87s/it]  {'epoch': 24, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.8957, 'compress@10': 0.708, 'time@10': 6.2784}:  33%|███▎      | 10/30 [00:46<01:52,  5.63s/it]{'epoch': 24, 'num_users': 6.6364, 'loss': 0.0307, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.8933, 'compress@10': 0.7104, 'time@10': 6.4071}:  33%|███▎      | 10/30 [00:50<01:52,  5.63s/it]{'epoch': 24, 'num_users': 6.6364, 'loss': 0.0307, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.8933, 'compress@10': 0.7104, 'time@10': 6.4071}:  37%|███▋      | 11/30 [00:50<01:36,  5.10s/it]{'epoch': 24, 'num_users': 6.4167, 'loss': 0.0286, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.895, 'compress@10': 0.7092, 'time@10': 6.1585}:  37%|███▋      | 11/30 [00:53<01:36,  5.10s/it] {'epoch': 24, 'num_users': 6.4167, 'loss': 0.0286, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.895, 'compress@10': 0.7092, 'time@10': 6.1585}:  40%|████      | 12/30 [00:53<01:22,  4.60s/it]{'epoch': 24, 'num_users': 6.6154, 'loss': 0.0289, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8938, 'compress@10': 0.7098, 'time@10': 6.2258}:  40%|████      | 12/30 [00:57<01:22,  4.60s/it]{'epoch': 24, 'num_users': 6.6154, 'loss': 0.0289, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8938, 'compress@10': 0.7098, 'time@10': 6.2258}:  43%|████▎     | 13/30 [00:57<01:12,  4.28s/it]{'epoch': 24, 'num_users': 6.3571, 'loss': 0.027, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8887, 'compress@10': 0.7022, 'time@10': 5.98}:  43%|████▎     | 13/30 [01:00<01:12,  4.28s/it]   {'epoch': 24, 'num_users': 6.3571, 'loss': 0.027, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8887, 'compress@10': 0.7022, 'time@10': 5.98}:  47%|████▋     | 14/30 [01:00<01:01,  3.84s/it]{'epoch': 24, 'num_users': 6.2667, 'loss': 0.0276, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8881, 'compress@10': 0.7008, 'time@10': 6.1073}:  47%|████▋     | 14/30 [01:04<01:01,  3.84s/it]{'epoch': 24, 'num_users': 6.2667, 'loss': 0.0276, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8881, 'compress@10': 0.7008, 'time@10': 6.1073}:  50%|█████     | 15/30 [01:04<00:58,  3.89s/it]{'epoch': 24, 'num_users': 6.0625, 'loss': 0.0262, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8896, 'compress@10': 0.6986, 'time@10': 5.955}:  50%|█████     | 15/30 [01:07<00:58,  3.89s/it] {'epoch': 24, 'num_users': 6.0625, 'loss': 0.0262, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8896, 'compress@10': 0.6986, 'time@10': 5.955}:  53%|█████▎    | 16/30 [01:07<00:53,  3.84s/it]{'epoch': 24, 'num_users': 5.8235, 'loss': 0.0248, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8826, 'compress@10': 0.6983, 'time@10': 5.8305}:  53%|█████▎    | 16/30 [01:09<00:53,  3.84s/it]{'epoch': 24, 'num_users': 5.8235, 'loss': 0.0248, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8826, 'compress@10': 0.6983, 'time@10': 5.8305}:  57%|█████▋    | 17/30 [01:09<00:42,  3.28s/it]{'epoch': 24, 'num_users': 6.0556, 'loss': 0.0248, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8842, 'compress@10': 0.697, 'time@10': 5.7727}:  57%|█████▋    | 17/30 [01:14<00:42,  3.28s/it]  {'epoch': 24, 'num_users': 6.0556, 'loss': 0.0248, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8842, 'compress@10': 0.697, 'time@10': 5.7727}:  60%|██████    | 18/30 [01:14<00:44,  3.75s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 0.0241, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8852, 'compress@10': 0.6973, 'time@10': 5.6923}:  60%|██████    | 18/30 [01:16<00:44,  3.75s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 0.0241, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8852, 'compress@10': 0.6973, 'time@10': 5.6923}:  63%|██████▎   | 19/30 [01:16<00:35,  3.27s/it]{'epoch': 24, 'num_users': 6.15, 'loss': 0.0242, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8855, 'compress@10': 0.6986, 'time@10': 5.8255}:  63%|██████▎   | 19/30 [01:25<00:35,  3.27s/it]{'epoch': 24, 'num_users': 6.15, 'loss': 0.0242, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8855, 'compress@10': 0.6986, 'time@10': 5.8255}:  67%|██████▋   | 20/30 [01:25<00:48,  4.81s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0257, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8837, 'compress@10': 0.6991, 'time@10': 5.8877}:  67%|██████▋   | 20/30 [01:28<00:48,  4.81s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0257, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8837, 'compress@10': 0.6991, 'time@10': 5.8877}:  70%|███████   | 21/30 [01:28<00:40,  4.45s/it]{'epoch': 24, 'num_users': 6.1818, 'loss': 0.0265, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8854, 'compress@10': 0.6932, 'time@10': 5.798}:  70%|███████   | 21/30 [01:32<00:40,  4.45s/it] {'epoch': 24, 'num_users': 6.1818, 'loss': 0.0265, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8854, 'compress@10': 0.6932, 'time@10': 5.798}:  73%|███████▎  | 22/30 [01:32<00:34,  4.30s/it]{'epoch': 24, 'num_users': 6.1304, 'loss': 0.0264, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8864, 'compress@10': 0.6965, 'time@10': 5.7975}:  73%|███████▎  | 22/30 [01:35<00:34,  4.30s/it]{'epoch': 24, 'num_users': 6.1304, 'loss': 0.0264, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8864, 'compress@10': 0.6965, 'time@10': 5.7975}:  77%|███████▋  | 23/30 [01:35<00:27,  3.89s/it]{'epoch': 24, 'num_users': 5.9583, 'loss': 0.0255, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8805, 'compress@10': 0.6962, 'time@10': 5.6492}:  77%|███████▋  | 23/30 [01:37<00:27,  3.89s/it]{'epoch': 24, 'num_users': 5.9583, 'loss': 0.0255, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8805, 'compress@10': 0.6962, 'time@10': 5.6492}:  80%|████████  | 24/30 [01:37<00:20,  3.41s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0246, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8712, 'compress@10': 0.6992, 'time@10': 5.5129}:  80%|████████  | 24/30 [01:39<00:20,  3.41s/it]   {'epoch': 24, 'num_users': 5.8, 'loss': 0.0246, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8712, 'compress@10': 0.6992, 'time@10': 5.5129}:  83%|████████▎ | 25/30 [01:39<00:13,  2.73s/it]{'epoch': 24, 'num_users': 5.8077, 'loss': 0.0247, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8727, 'compress@10': 0.6991, 'time@10': 5.6087}:  83%|████████▎ | 25/30 [01:47<00:13,  2.73s/it]{'epoch': 24, 'num_users': 5.8077, 'loss': 0.0247, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8727, 'compress@10': 0.6991, 'time@10': 5.6087}:  87%|████████▋ | 26/30 [01:47<00:17,  4.33s/it]{'epoch': 24, 'num_users': 5.8889, 'loss': 0.0244, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8741, 'compress@10': 0.6982, 'time@10': 5.6351}:  87%|████████▋ | 26/30 [01:50<00:17,  4.33s/it]{'epoch': 24, 'num_users': 5.8889, 'loss': 0.0244, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8741, 'compress@10': 0.6982, 'time@10': 5.6351}:  90%|█████████ | 27/30 [01:50<00:11,  3.99s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 0.0248, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8778, 'compress@10': 0.6905, 'time@10': 5.7165}:  90%|█████████ | 27/30 [01:58<00:11,  3.99s/it]   {'epoch': 24, 'num_users': 6.0, 'loss': 0.0248, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8778, 'compress@10': 0.6905, 'time@10': 5.7165}:  93%|█████████▎| 28/30 [01:58<00:10,  5.18s/it]{'epoch': 24, 'num_users': 5.8621, 'loss': 0.0245, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.88, 'compress@10': 0.6901, 'time@10': 5.746}:  93%|█████████▎| 28/30 [02:01<00:10,  5.18s/it]{'epoch': 24, 'num_users': 5.8621, 'loss': 0.0245, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.88, 'compress@10': 0.6901, 'time@10': 5.746}:  97%|█████████▋| 29/30 [02:01<00:04,  4.62s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0248, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8814, 'compress@10': 0.6857, 'time@10': 5.7335}:  97%|█████████▋| 29/30 [02:07<00:04,  4.62s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0248, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8814, 'compress@10': 0.6857, 'time@10': 5.7335}: 100%|██████████| 30/30 [02:07<00:00,  4.86s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0248, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8814, 'compress@10': 0.6857, 'time@10': 5.7335}: 100%|██████████| 30/30 [02:07<00:00,  4.23s/it]
Epoch: 24
Avg # of users: 5.866666666666666
Avg Loss: 0.024779257352862523
Avg hit ratio: 0.8596622455136609
Avg ndcg: 0.881392236495234
Avg compression ratio: 0.6857332485120584
Avg train time: 5.733459091186523
Std train time: 1.9665709959605617
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 35, 8, 20, 26, 10, 10, 9, 6, 11, 10, 35, 35, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8879, 'compress@10': 0.7754, 'time@10': 5.463}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8879, 'compress@10': 0.7754, 'time@10': 5.463}:   3%|▎         | 1/30 [00:02<01:20,  2.77s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9073, 'compress@10': 0.7464, 'time@10': 4.8642}:   3%|▎         | 1/30 [00:07<01:20,  2.77s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9073, 'compress@10': 0.7464, 'time@10': 4.8642}:   7%|▋         | 2/30 [00:07<01:42,  3.67s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8906, 'compress@10': 0.7259, 'time@10': 4.3997}:   7%|▋         | 2/30 [00:08<01:42,  3.67s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8906, 'compress@10': 0.7259, 'time@10': 4.3997}:  10%|█         | 3/30 [00:08<01:15,  2.81s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8865, 'compress@10': 0.7163, 'time@10': 4.4612}:  10%|█         | 3/30 [00:13<01:15,  2.81s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8865, 'compress@10': 0.7163, 'time@10': 4.4612}:  13%|█▎        | 4/30 [00:13<01:32,  3.55s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0284, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.87, 'compress@10': 0.7039, 'time@10': 4.9761}:  13%|█▎        | 4/30 [00:17<01:32,  3.55s/it]  {'epoch': 25, 'num_users': 5.8, 'loss': 0.0284, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.87, 'compress@10': 0.7039, 'time@10': 4.9761}:  17%|█▋        | 5/30 [00:17<01:29,  3.57s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0289, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8772, 'compress@10': 0.7197, 'time@10': 5.3628}:  17%|█▋        | 5/30 [00:24<01:29,  3.57s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0289, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8772, 'compress@10': 0.7197, 'time@10': 5.3628}:  20%|██        | 6/30 [00:24<01:56,  4.85s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0275, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.8817, 'compress@10': 0.7295, 'time@10': 5.7312}:  20%|██        | 6/30 [00:28<01:56,  4.85s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0275, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.8817, 'compress@10': 0.7295, 'time@10': 5.7312}:  23%|██▎       | 7/30 [00:28<01:45,  4.58s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0271, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.8824, 'compress@10': 0.7225, 'time@10': 5.7129}:  23%|██▎       | 7/30 [00:34<01:45,  4.58s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0271, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.8824, 'compress@10': 0.7225, 'time@10': 5.7129}:  27%|██▋       | 8/30 [00:34<01:48,  4.91s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0293, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9017, 'compress@10': 0.7227, 'time@10': 6.0743}:  27%|██▋       | 8/30 [00:38<01:48,  4.91s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0293, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9017, 'compress@10': 0.7227, 'time@10': 6.0743}:  30%|███       | 9/30 [00:38<01:40,  4.79s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.912, 'compress@10': 0.718, 'time@10': 6.1729}:  30%|███       | 9/30 [00:45<01:40,  4.79s/it]     {'epoch': 25, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.912, 'compress@10': 0.718, 'time@10': 6.1729}:  33%|███▎      | 10/30 [00:45<01:50,  5.50s/it]{'epoch': 25, 'num_users': 6.6364, 'loss': 0.0311, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9082, 'compress@10': 0.7201, 'time@10': 6.3142}:  33%|███▎      | 10/30 [00:49<01:50,  5.50s/it]{'epoch': 25, 'num_users': 6.6364, 'loss': 0.0311, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9082, 'compress@10': 0.7201, 'time@10': 6.3142}:  37%|███▋      | 11/30 [00:49<01:35,  5.01s/it]{'epoch': 25, 'num_users': 6.4167, 'loss': 0.0289, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.9087, 'compress@10': 0.7179, 'time@10': 6.0832}:  37%|███▋      | 11/30 [00:53<01:35,  5.01s/it]{'epoch': 25, 'num_users': 6.4167, 'loss': 0.0289, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.9087, 'compress@10': 0.7179, 'time@10': 6.0832}:  40%|████      | 12/30 [00:53<01:22,  4.58s/it]{'epoch': 25, 'num_users': 6.6154, 'loss': 0.0292, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.9068, 'compress@10': 0.7197, 'time@10': 6.1528}:  40%|████      | 12/30 [00:56<01:22,  4.58s/it]{'epoch': 25, 'num_users': 6.6154, 'loss': 0.0292, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.9068, 'compress@10': 0.7197, 'time@10': 6.1528}:  43%|████▎     | 13/30 [00:56<01:12,  4.26s/it]{'epoch': 25, 'num_users': 6.3571, 'loss': 0.0272, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.9007, 'compress@10': 0.7125, 'time@10': 5.9184}:  43%|████▎     | 13/30 [00:59<01:12,  4.26s/it]{'epoch': 25, 'num_users': 6.3571, 'loss': 0.0272, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.9007, 'compress@10': 0.7125, 'time@10': 5.9184}:  47%|████▋     | 14/30 [00:59<01:01,  3.85s/it]{'epoch': 25, 'num_users': 6.2667, 'loss': 0.027, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9005, 'compress@10': 0.7083, 'time@10': 6.0501}:  47%|████▋     | 14/30 [01:03<01:01,  3.85s/it] {'epoch': 25, 'num_users': 6.2667, 'loss': 0.027, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9005, 'compress@10': 0.7083, 'time@10': 6.0501}:  50%|█████     | 15/30 [01:03<00:58,  3.89s/it]{'epoch': 25, 'num_users': 6.0625, 'loss': 0.0257, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.9012, 'compress@10': 0.7056, 'time@10': 5.8854}:  50%|█████     | 15/30 [01:07<00:58,  3.89s/it]{'epoch': 25, 'num_users': 6.0625, 'loss': 0.0257, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.9012, 'compress@10': 0.7056, 'time@10': 5.8854}:  53%|█████▎    | 16/30 [01:07<00:52,  3.76s/it]{'epoch': 25, 'num_users': 5.8235, 'loss': 0.0243, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8935, 'compress@10': 0.7051, 'time@10': 5.7348}:  53%|█████▎    | 16/30 [01:08<00:52,  3.76s/it]{'epoch': 25, 'num_users': 5.8235, 'loss': 0.0243, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8935, 'compress@10': 0.7051, 'time@10': 5.7348}:  57%|█████▋    | 17/30 [01:08<00:40,  3.14s/it]{'epoch': 25, 'num_users': 6.0556, 'loss': 0.0244, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.895, 'compress@10': 0.7035, 'time@10': 5.6582}:  57%|█████▋    | 17/30 [01:13<00:40,  3.14s/it] {'epoch': 25, 'num_users': 6.0556, 'loss': 0.0244, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.895, 'compress@10': 0.7035, 'time@10': 5.6582}:  60%|██████    | 18/30 [01:13<00:42,  3.52s/it]{'epoch': 25, 'num_users': 6.0, 'loss': 0.024, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8958, 'compress@10': 0.7035, 'time@10': 5.5835}:  60%|██████    | 18/30 [01:15<00:42,  3.52s/it]   {'epoch': 25, 'num_users': 6.0, 'loss': 0.024, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8958, 'compress@10': 0.7035, 'time@10': 5.5835}:  63%|██████▎   | 19/30 [01:15<00:34,  3.11s/it]{'epoch': 25, 'num_users': 6.15, 'loss': 0.0241, 'hit_ratio@10': 0.851, 'ndcg@10': 0.896, 'compress@10': 0.705, 'time@10': 5.7222}:  63%|██████▎   | 19/30 [01:23<00:34,  3.11s/it] {'epoch': 25, 'num_users': 6.15, 'loss': 0.0241, 'hit_ratio@10': 0.851, 'ndcg@10': 0.896, 'compress@10': 0.705, 'time@10': 5.7222}:  67%|██████▋   | 20/30 [01:23<00:47,  4.70s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.025, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8944, 'compress@10': 0.7049, 'time@10': 5.7928}:  67%|██████▋   | 20/30 [01:27<00:47,  4.70s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.025, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8944, 'compress@10': 0.7049, 'time@10': 5.7928}:  70%|███████   | 21/30 [01:27<00:39,  4.39s/it]{'epoch': 25, 'num_users': 6.1818, 'loss': 0.0255, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8956, 'compress@10': 0.699, 'time@10': 5.6906}:  70%|███████   | 21/30 [01:31<00:39,  4.39s/it]{'epoch': 25, 'num_users': 6.1818, 'loss': 0.0255, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8956, 'compress@10': 0.699, 'time@10': 5.6906}:  73%|███████▎  | 22/30 [01:31<00:33,  4.15s/it]{'epoch': 25, 'num_users': 6.1304, 'loss': 0.0253, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8958, 'compress@10': 0.7025, 'time@10': 5.7147}:  73%|███████▎  | 22/30 [01:34<00:33,  4.15s/it]{'epoch': 25, 'num_users': 6.1304, 'loss': 0.0253, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8958, 'compress@10': 0.7025, 'time@10': 5.7147}:  77%|███████▋  | 23/30 [01:34<00:26,  3.85s/it]{'epoch': 25, 'num_users': 5.9583, 'loss': 0.0244, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8895, 'compress@10': 0.7022, 'time@10': 5.5725}:  77%|███████▋  | 23/30 [01:36<00:26,  3.85s/it]{'epoch': 25, 'num_users': 5.9583, 'loss': 0.0244, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8895, 'compress@10': 0.7022, 'time@10': 5.5725}:  80%|████████  | 24/30 [01:36<00:20,  3.40s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0235, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8799, 'compress@10': 0.705, 'time@10': 5.4426}:  80%|████████  | 24/30 [01:37<00:20,  3.40s/it]    {'epoch': 25, 'num_users': 5.8, 'loss': 0.0235, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8799, 'compress@10': 0.705, 'time@10': 5.4426}:  83%|████████▎ | 25/30 [01:37<00:13,  2.74s/it]{'epoch': 25, 'num_users': 5.8077, 'loss': 0.0237, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8812, 'compress@10': 0.7059, 'time@10': 5.562}:  83%|████████▎ | 25/30 [01:46<00:13,  2.74s/it]{'epoch': 25, 'num_users': 5.8077, 'loss': 0.0237, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8812, 'compress@10': 0.7059, 'time@10': 5.562}:  87%|████████▋ | 26/30 [01:46<00:17,  4.49s/it]{'epoch': 25, 'num_users': 5.8889, 'loss': 0.0235, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8824, 'compress@10': 0.7056, 'time@10': 5.628}:  87%|████████▋ | 26/30 [01:50<00:17,  4.49s/it]{'epoch': 25, 'num_users': 5.8889, 'loss': 0.0235, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8824, 'compress@10': 0.7056, 'time@10': 5.628}:  90%|█████████ | 27/30 [01:50<00:12,  4.26s/it]{'epoch': 25, 'num_users': 6.0, 'loss': 0.0235, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8855, 'compress@10': 0.6988, 'time@10': 5.7367}:  90%|█████████ | 27/30 [01:58<00:12,  4.26s/it]  {'epoch': 25, 'num_users': 6.0, 'loss': 0.0235, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8855, 'compress@10': 0.6988, 'time@10': 5.7367}:  93%|█████████▎| 28/30 [01:58<00:11,  5.60s/it]{'epoch': 25, 'num_users': 5.8621, 'loss': 0.0232, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8876, 'compress@10': 0.698, 'time@10': 5.7814}:  93%|█████████▎| 28/30 [02:02<00:11,  5.60s/it]{'epoch': 25, 'num_users': 5.8621, 'loss': 0.0232, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8876, 'compress@10': 0.698, 'time@10': 5.7814}:  97%|█████████▋| 29/30 [02:02<00:04,  4.98s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.0235, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8885, 'compress@10': 0.6941, 'time@10': 5.7722}:  97%|█████████▋| 29/30 [02:07<00:04,  4.98s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.0235, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8885, 'compress@10': 0.6941, 'time@10': 5.7722}: 100%|██████████| 30/30 [02:07<00:00,  5.15s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.0235, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8885, 'compress@10': 0.6941, 'time@10': 5.7722}: 100%|██████████| 30/30 [02:07<00:00,  4.26s/it]
Epoch: 25
Avg # of users: 5.866666666666666
Avg Loss: 0.02352490065698536
Avg hit ratio: 0.8601506304545076
Avg ndcg: 0.8884939925520009
Avg compression ratio: 0.6940817371709583
Avg train time: 5.772230410575867
Std train time: 2.0545082858441055
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 36, 8, 20, 26, 10, 10, 9, 6, 11, 10, 36, 36, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0302, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.889, 'compress@10': 0.7829, 'time@10': 5.4886}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0302, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.889, 'compress@10': 0.7829, 'time@10': 5.4886}:   3%|▎         | 1/30 [00:02<01:20,  2.78s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9086, 'compress@10': 0.7392, 'time@10': 5.0795}:   3%|▎         | 1/30 [00:07<01:20,  2.78s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9086, 'compress@10': 0.7392, 'time@10': 5.0795}:   7%|▋         | 2/30 [00:07<01:49,  3.91s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8914, 'compress@10': 0.7224, 'time@10': 4.7989}:   7%|▋         | 2/30 [00:09<01:49,  3.91s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8914, 'compress@10': 0.7224, 'time@10': 4.7989}:  10%|█         | 3/30 [00:09<01:24,  3.11s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.897, 'compress@10': 0.7154, 'time@10': 4.7415}:  10%|█         | 3/30 [00:14<01:24,  3.11s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.897, 'compress@10': 0.7154, 'time@10': 4.7415}:  13%|█▎        | 4/30 [00:14<01:36,  3.70s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8787, 'compress@10': 0.7047, 'time@10': 5.3032}:  13%|█▎        | 4/30 [00:18<01:36,  3.70s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8787, 'compress@10': 0.7047, 'time@10': 5.3032}:  17%|█▋        | 5/30 [00:18<01:33,  3.75s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0271, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8858, 'compress@10': 0.7196, 'time@10': 5.5729}:  17%|█▋        | 5/30 [00:25<01:33,  3.75s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0271, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8858, 'compress@10': 0.7196, 'time@10': 5.5729}:  20%|██        | 6/30 [00:25<01:56,  4.84s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.027, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.8909, 'compress@10': 0.7304, 'time@10': 5.9184}:  20%|██        | 6/30 [00:29<01:56,  4.84s/it] {'epoch': 26, 'num_users': 6.2857, 'loss': 0.027, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.8909, 'compress@10': 0.7304, 'time@10': 5.9184}:  23%|██▎       | 7/30 [00:29<01:45,  4.58s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0265, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.8912, 'compress@10': 0.7232, 'time@10': 5.8747}:  23%|██▎       | 7/30 [00:34<01:45,  4.58s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0265, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.8912, 'compress@10': 0.7232, 'time@10': 5.8747}:  27%|██▋       | 8/30 [00:34<01:47,  4.91s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0273, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.901, 'compress@10': 0.7219, 'time@10': 6.2171}:  27%|██▋       | 8/30 [00:39<01:47,  4.91s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0273, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.901, 'compress@10': 0.7219, 'time@10': 6.2171}:  30%|███       | 9/30 [00:39<01:40,  4.79s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0272, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9034, 'compress@10': 0.7178, 'time@10': 6.3078}:  30%|███       | 9/30 [00:46<01:40,  4.79s/it]  {'epoch': 26, 'num_users': 6.3, 'loss': 0.0272, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9034, 'compress@10': 0.7178, 'time@10': 6.3078}:  33%|███▎      | 10/30 [00:46<01:50,  5.52s/it]{'epoch': 26, 'num_users': 6.6364, 'loss': 0.0286, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9002, 'compress@10': 0.7216, 'time@10': 6.4088}:  33%|███▎      | 10/30 [00:50<01:50,  5.52s/it]{'epoch': 26, 'num_users': 6.6364, 'loss': 0.0286, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9002, 'compress@10': 0.7216, 'time@10': 6.4088}:  37%|███▋      | 11/30 [00:50<01:34,  4.98s/it]{'epoch': 26, 'num_users': 6.4167, 'loss': 0.0266, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.9016, 'compress@10': 0.7192, 'time@10': 6.1537}:  37%|███▋      | 11/30 [00:53<01:34,  4.98s/it]{'epoch': 26, 'num_users': 6.4167, 'loss': 0.0266, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.9016, 'compress@10': 0.7192, 'time@10': 6.1537}:  40%|████      | 12/30 [00:53<01:20,  4.49s/it]{'epoch': 26, 'num_users': 6.6154, 'loss': 0.027, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9003, 'compress@10': 0.7225, 'time@10': 6.2161}:  40%|████      | 12/30 [00:57<01:20,  4.49s/it] {'epoch': 26, 'num_users': 6.6154, 'loss': 0.027, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9003, 'compress@10': 0.7225, 'time@10': 6.2161}:  43%|████▎     | 13/30 [00:57<01:11,  4.20s/it]{'epoch': 26, 'num_users': 6.3571, 'loss': 0.0252, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8947, 'compress@10': 0.7162, 'time@10': 5.9841}:  43%|████▎     | 13/30 [01:00<01:11,  4.20s/it]{'epoch': 26, 'num_users': 6.3571, 'loss': 0.0252, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8947, 'compress@10': 0.7162, 'time@10': 5.9841}:  47%|████▋     | 14/30 [01:00<01:01,  3.84s/it]{'epoch': 26, 'num_users': 6.2667, 'loss': 0.0252, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8959, 'compress@10': 0.7114, 'time@10': 6.105}:  47%|████▋     | 14/30 [01:03<01:01,  3.84s/it]  {'epoch': 26, 'num_users': 6.2667, 'loss': 0.0252, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8959, 'compress@10': 0.7114, 'time@10': 6.105}:  50%|█████     | 15/30 [01:03<00:58,  3.87s/it]{'epoch': 26, 'num_users': 6.0625, 'loss': 0.0241, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8969, 'compress@10': 0.7088, 'time@10': 5.9438}:  50%|█████     | 15/30 [01:07<00:58,  3.87s/it]{'epoch': 26, 'num_users': 6.0625, 'loss': 0.0241, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8969, 'compress@10': 0.7088, 'time@10': 5.9438}:  53%|█████▎    | 16/30 [01:07<00:52,  3.78s/it]{'epoch': 26, 'num_users': 5.8235, 'loss': 0.0228, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8895, 'compress@10': 0.7079, 'time@10': 5.7951}:  53%|█████▎    | 16/30 [01:09<00:52,  3.78s/it]{'epoch': 26, 'num_users': 5.8235, 'loss': 0.0228, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8895, 'compress@10': 0.7079, 'time@10': 5.7951}:  57%|█████▋    | 17/30 [01:09<00:41,  3.17s/it]{'epoch': 26, 'num_users': 6.0556, 'loss': 0.0229, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.891, 'compress@10': 0.706, 'time@10': 5.7254}:  57%|█████▋    | 17/30 [01:13<00:41,  3.17s/it]  {'epoch': 26, 'num_users': 6.0556, 'loss': 0.0229, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.891, 'compress@10': 0.706, 'time@10': 5.7254}:  60%|██████    | 18/30 [01:13<00:43,  3.59s/it]{'epoch': 26, 'num_users': 6.0, 'loss': 0.0222, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8916, 'compress@10': 0.7057, 'time@10': 5.6496}:  60%|██████    | 18/30 [01:16<00:43,  3.59s/it] {'epoch': 26, 'num_users': 6.0, 'loss': 0.0222, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8916, 'compress@10': 0.7057, 'time@10': 5.6496}:  63%|██████▎   | 19/30 [01:16<00:34,  3.17s/it]{'epoch': 26, 'num_users': 6.15, 'loss': 0.0225, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8925, 'compress@10': 0.7073, 'time@10': 5.7747}:  63%|██████▎   | 19/30 [01:24<00:34,  3.17s/it]{'epoch': 26, 'num_users': 6.15, 'loss': 0.0225, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8925, 'compress@10': 0.7073, 'time@10': 5.7747}:  67%|██████▋   | 20/30 [01:24<00:46,  4.68s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8906, 'compress@10': 0.7073, 'time@10': 5.8412}:  67%|██████▋   | 20/30 [01:27<00:46,  4.68s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8906, 'compress@10': 0.7073, 'time@10': 5.8412}:  70%|███████   | 21/30 [01:27<00:39,  4.36s/it]{'epoch': 26, 'num_users': 6.1818, 'loss': 0.0238, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8918, 'compress@10': 0.7013, 'time@10': 5.7441}:  70%|███████   | 21/30 [01:31<00:39,  4.36s/it]{'epoch': 26, 'num_users': 6.1818, 'loss': 0.0238, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8918, 'compress@10': 0.7013, 'time@10': 5.7441}:  73%|███████▎  | 22/30 [01:31<00:33,  4.18s/it]{'epoch': 26, 'num_users': 6.1304, 'loss': 0.0234, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8929, 'compress@10': 0.7053, 'time@10': 5.7672}:  73%|███████▎  | 22/30 [01:34<00:33,  4.18s/it]{'epoch': 26, 'num_users': 6.1304, 'loss': 0.0234, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8929, 'compress@10': 0.7053, 'time@10': 5.7672}:  77%|███████▋  | 23/30 [01:34<00:27,  3.88s/it]{'epoch': 26, 'num_users': 5.9583, 'loss': 0.0226, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8867, 'compress@10': 0.7052, 'time@10': 5.6254}:  77%|███████▋  | 23/30 [01:37<00:27,  3.88s/it]{'epoch': 26, 'num_users': 5.9583, 'loss': 0.0226, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8867, 'compress@10': 0.7052, 'time@10': 5.6254}:  80%|████████  | 24/30 [01:37<00:20,  3.44s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0218, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8779, 'compress@10': 0.7079, 'time@10': 5.4954}:  80%|████████  | 24/30 [01:38<00:20,  3.44s/it]   {'epoch': 26, 'num_users': 5.8, 'loss': 0.0218, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8779, 'compress@10': 0.7079, 'time@10': 5.4954}:  83%|████████▎ | 25/30 [01:38<00:13,  2.78s/it]{'epoch': 26, 'num_users': 5.8077, 'loss': 0.0219, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8795, 'compress@10': 0.7095, 'time@10': 5.5933}:  83%|████████▎ | 25/30 [01:46<00:13,  2.78s/it]{'epoch': 26, 'num_users': 5.8077, 'loss': 0.0219, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8795, 'compress@10': 0.7095, 'time@10': 5.5933}:  87%|████████▋ | 26/30 [01:46<00:17,  4.37s/it]{'epoch': 26, 'num_users': 5.8889, 'loss': 0.0219, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.881, 'compress@10': 0.7087, 'time@10': 5.6506}:  87%|████████▋ | 26/30 [01:50<00:17,  4.37s/it] {'epoch': 26, 'num_users': 5.8889, 'loss': 0.0219, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.881, 'compress@10': 0.7087, 'time@10': 5.6506}:  90%|█████████ | 27/30 [01:50<00:12,  4.14s/it]{'epoch': 26, 'num_users': 6.0, 'loss': 0.0227, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8851, 'compress@10': 0.7041, 'time@10': 5.7305}:  90%|█████████ | 27/30 [01:58<00:12,  4.14s/it]  {'epoch': 26, 'num_users': 6.0, 'loss': 0.0227, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8851, 'compress@10': 0.7041, 'time@10': 5.7305}:  93%|█████████▎| 28/30 [01:58<00:10,  5.28s/it]{'epoch': 26, 'num_users': 5.8621, 'loss': 0.0224, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8873, 'compress@10': 0.7031, 'time@10': 5.7713}:  93%|█████████▎| 28/30 [02:01<00:10,  5.28s/it]{'epoch': 26, 'num_users': 5.8621, 'loss': 0.0224, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8873, 'compress@10': 0.7031, 'time@10': 5.7713}:  97%|█████████▋| 29/30 [02:01<00:04,  4.74s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0228, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8876, 'compress@10': 0.7017, 'time@10': 5.7632}:  97%|█████████▋| 29/30 [02:07<00:04,  4.74s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0228, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8876, 'compress@10': 0.7017, 'time@10': 5.7632}: 100%|██████████| 30/30 [02:07<00:00,  4.99s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0228, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8876, 'compress@10': 0.7017, 'time@10': 5.7632}: 100%|██████████| 30/30 [02:07<00:00,  4.24s/it]
Epoch: 26
Avg # of users: 5.866666666666666
Avg Loss: 0.02279768093224587
Avg hit ratio: 0.8598179076217847
Avg ndcg: 0.8875570164440929
Avg compression ratio: 0.7016843220386421
Avg train time: 5.7632103363672895
Std train time: 1.9232239729343241
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 37, 8, 20, 26, 10, 10, 9, 6, 11, 10, 37, 37, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8969, 'compress@10': 0.7845, 'time@10': 5.5221}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8969, 'compress@10': 0.7845, 'time@10': 5.5221}:   3%|▎         | 1/30 [00:02<01:21,  2.82s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9168, 'compress@10': 0.7296, 'time@10': 4.9419}:   3%|▎         | 1/30 [00:07<01:21,  2.82s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9168, 'compress@10': 0.7296, 'time@10': 4.9419}:   7%|▋         | 2/30 [00:07<01:45,  3.75s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8969, 'compress@10': 0.717, 'time@10': 4.4859}:   7%|▋         | 2/30 [00:09<01:45,  3.75s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8969, 'compress@10': 0.717, 'time@10': 4.4859}:  10%|█         | 3/30 [00:09<01:17,  2.87s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8898, 'compress@10': 0.7189, 'time@10': 4.5134}:  10%|█         | 3/30 [00:13<01:17,  2.87s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8898, 'compress@10': 0.7189, 'time@10': 4.5134}:  13%|█▎        | 4/30 [00:13<01:32,  3.57s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0298, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8748, 'compress@10': 0.7182, 'time@10': 5.1109}:  13%|█▎        | 4/30 [00:17<01:32,  3.57s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0298, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8748, 'compress@10': 0.7182, 'time@10': 5.1109}:  17%|█▋        | 5/30 [00:17<01:31,  3.65s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0294, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8825, 'compress@10': 0.7307, 'time@10': 5.4458}:  17%|█▋        | 5/30 [00:24<01:31,  3.65s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0294, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8825, 'compress@10': 0.7307, 'time@10': 5.4458}:  20%|██        | 6/30 [00:24<01:56,  4.85s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0299, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.8881, 'compress@10': 0.7396, 'time@10': 5.8069}:  20%|██        | 6/30 [00:28<01:56,  4.85s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0299, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.8881, 'compress@10': 0.7396, 'time@10': 5.8069}:  23%|██▎       | 7/30 [00:28<01:45,  4.58s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0294, 'hit_ratio@10': 0.895, 'ndcg@10': 0.8873, 'compress@10': 0.7314, 'time@10': 5.7794}:  23%|██▎       | 7/30 [00:34<01:45,  4.58s/it]  {'epoch': 27, 'num_users': 6.125, 'loss': 0.0294, 'hit_ratio@10': 0.895, 'ndcg@10': 0.8873, 'compress@10': 0.7314, 'time@10': 5.7794}:  27%|██▋       | 8/30 [00:34<01:48,  4.91s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.8948, 'compress@10': 0.729, 'time@10': 6.1396}:  27%|██▋       | 8/30 [00:38<01:48,  4.91s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.8948, 'compress@10': 0.729, 'time@10': 6.1396}:  30%|███       | 9/30 [00:38<01:40,  4.80s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9011, 'compress@10': 0.7249, 'time@10': 6.2387}:  30%|███       | 9/30 [00:46<01:40,  4.80s/it]  {'epoch': 27, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9011, 'compress@10': 0.7249, 'time@10': 6.2387}:  33%|███▎      | 10/30 [00:46<01:50,  5.53s/it]{'epoch': 27, 'num_users': 6.6364, 'loss': 0.0281, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8985, 'compress@10': 0.7291, 'time@10': 6.361}:  33%|███▎      | 10/30 [00:49<01:50,  5.53s/it]{'epoch': 27, 'num_users': 6.6364, 'loss': 0.0281, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8985, 'compress@10': 0.7291, 'time@10': 6.361}:  37%|███▋      | 11/30 [00:49<01:35,  5.01s/it]{'epoch': 27, 'num_users': 6.4167, 'loss': 0.0261, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.9, 'compress@10': 0.7262, 'time@10': 6.1175}:  37%|███▋      | 11/30 [00:53<01:35,  5.01s/it]  {'epoch': 27, 'num_users': 6.4167, 'loss': 0.0261, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.9, 'compress@10': 0.7262, 'time@10': 6.1175}:  40%|████      | 12/30 [00:53<01:21,  4.55s/it]{'epoch': 27, 'num_users': 6.6154, 'loss': 0.0264, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8993, 'compress@10': 0.7299, 'time@10': 6.1993}:  40%|████      | 12/30 [00:56<01:21,  4.55s/it]{'epoch': 27, 'num_users': 6.6154, 'loss': 0.0264, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8993, 'compress@10': 0.7299, 'time@10': 6.1993}:  43%|████▎     | 13/30 [00:56<01:12,  4.27s/it]{'epoch': 27, 'num_users': 6.3571, 'loss': 0.0246, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8937, 'compress@10': 0.7232, 'time@10': 5.9941}:  43%|████▎     | 13/30 [01:00<01:12,  4.27s/it]{'epoch': 27, 'num_users': 6.3571, 'loss': 0.0246, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8937, 'compress@10': 0.7232, 'time@10': 5.9941}:  47%|████▋     | 14/30 [01:00<01:03,  4.00s/it]{'epoch': 27, 'num_users': 6.2667, 'loss': 0.0251, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8961, 'compress@10': 0.7186, 'time@10': 6.1223}:  47%|████▋     | 14/30 [01:04<01:03,  4.00s/it]{'epoch': 27, 'num_users': 6.2667, 'loss': 0.0251, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8961, 'compress@10': 0.7186, 'time@10': 6.1223}:  50%|█████     | 15/30 [01:04<00:59,  4.00s/it]{'epoch': 27, 'num_users': 6.0625, 'loss': 0.0236, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8974, 'compress@10': 0.7159, 'time@10': 5.9653}:  50%|█████     | 15/30 [01:07<00:59,  4.00s/it]{'epoch': 27, 'num_users': 6.0625, 'loss': 0.0236, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8974, 'compress@10': 0.7159, 'time@10': 5.9653}:  53%|█████▎    | 16/30 [01:07<00:54,  3.89s/it]{'epoch': 27, 'num_users': 5.8235, 'loss': 0.0223, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8899, 'compress@10': 0.7143, 'time@10': 5.8143}:  53%|█████▎    | 16/30 [01:09<00:54,  3.89s/it]{'epoch': 27, 'num_users': 5.8235, 'loss': 0.0223, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8899, 'compress@10': 0.7143, 'time@10': 5.8143}:  57%|█████▋    | 17/30 [01:09<00:42,  3.25s/it]{'epoch': 27, 'num_users': 6.0556, 'loss': 0.0223, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8913, 'compress@10': 0.7116, 'time@10': 5.7399}:  57%|█████▋    | 17/30 [01:14<00:42,  3.25s/it] {'epoch': 27, 'num_users': 6.0556, 'loss': 0.0223, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8913, 'compress@10': 0.7116, 'time@10': 5.7399}:  60%|██████    | 18/30 [01:14<00:43,  3.63s/it]{'epoch': 27, 'num_users': 6.0, 'loss': 0.022, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8924, 'compress@10': 0.7111, 'time@10': 5.6779}:  60%|██████    | 18/30 [01:16<00:43,  3.63s/it]   {'epoch': 27, 'num_users': 6.0, 'loss': 0.022, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8924, 'compress@10': 0.7111, 'time@10': 5.6779}:  63%|██████▎   | 19/30 [01:16<00:35,  3.24s/it]{'epoch': 27, 'num_users': 6.15, 'loss': 0.0223, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8932, 'compress@10': 0.7135, 'time@10': 5.7949}:  63%|██████▎   | 19/30 [01:24<00:35,  3.24s/it]{'epoch': 27, 'num_users': 6.15, 'loss': 0.0223, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8932, 'compress@10': 0.7135, 'time@10': 5.7949}:  67%|██████▋   | 20/30 [01:24<00:46,  4.68s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8916, 'compress@10': 0.7134, 'time@10': 5.8747}:  67%|██████▋   | 20/30 [01:28<00:46,  4.68s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8916, 'compress@10': 0.7134, 'time@10': 5.8747}:  70%|███████   | 21/30 [01:28<00:39,  4.41s/it]{'epoch': 27, 'num_users': 6.1818, 'loss': 0.024, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8911, 'compress@10': 0.7053, 'time@10': 5.7803}:  70%|███████   | 21/30 [01:32<00:39,  4.41s/it] {'epoch': 27, 'num_users': 6.1818, 'loss': 0.024, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8911, 'compress@10': 0.7053, 'time@10': 5.7803}:  73%|███████▎  | 22/30 [01:32<00:33,  4.24s/it]{'epoch': 27, 'num_users': 6.1304, 'loss': 0.0237, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8921, 'compress@10': 0.7093, 'time@10': 5.7997}:  73%|███████▎  | 22/30 [01:35<00:33,  4.24s/it]{'epoch': 27, 'num_users': 6.1304, 'loss': 0.0237, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8921, 'compress@10': 0.7093, 'time@10': 5.7997}:  77%|███████▋  | 23/30 [01:35<00:27,  3.91s/it]{'epoch': 27, 'num_users': 5.9583, 'loss': 0.0228, 'hit_ratio@10': 0.851, 'ndcg@10': 0.8883, 'compress@10': 0.7091, 'time@10': 5.6602}:  77%|███████▋  | 23/30 [01:37<00:27,  3.91s/it] {'epoch': 27, 'num_users': 5.9583, 'loss': 0.0228, 'hit_ratio@10': 0.851, 'ndcg@10': 0.8883, 'compress@10': 0.7091, 'time@10': 5.6602}:  80%|████████  | 24/30 [01:37<00:20,  3.49s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8794, 'compress@10': 0.7116, 'time@10': 5.5318}:  80%|████████  | 24/30 [01:39<00:20,  3.49s/it]   {'epoch': 27, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8794, 'compress@10': 0.7116, 'time@10': 5.5318}:  83%|████████▎ | 25/30 [01:39<00:14,  2.82s/it]{'epoch': 27, 'num_users': 5.8077, 'loss': 0.0221, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.881, 'compress@10': 0.7129, 'time@10': 5.6421}:  83%|████████▎ | 25/30 [01:47<00:14,  2.82s/it]{'epoch': 27, 'num_users': 5.8077, 'loss': 0.0221, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.881, 'compress@10': 0.7129, 'time@10': 5.6421}:  87%|████████▋ | 26/30 [01:47<00:18,  4.51s/it]{'epoch': 27, 'num_users': 5.8889, 'loss': 0.0221, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8826, 'compress@10': 0.7134, 'time@10': 5.692}:  87%|████████▋ | 26/30 [01:51<00:18,  4.51s/it]{'epoch': 27, 'num_users': 5.8889, 'loss': 0.0221, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8826, 'compress@10': 0.7134, 'time@10': 5.692}:  90%|█████████ | 27/30 [01:51<00:12,  4.21s/it]{'epoch': 27, 'num_users': 6.0, 'loss': 0.0219, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8849, 'compress@10': 0.7067, 'time@10': 5.767}:  90%|█████████ | 27/30 [01:58<00:12,  4.21s/it]   {'epoch': 27, 'num_users': 6.0, 'loss': 0.0219, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8849, 'compress@10': 0.7067, 'time@10': 5.767}:  93%|█████████▎| 28/30 [01:58<00:10,  5.30s/it]{'epoch': 27, 'num_users': 5.8621, 'loss': 0.0216, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8871, 'compress@10': 0.7053, 'time@10': 5.8051}:  93%|█████████▎| 28/30 [02:02<00:10,  5.30s/it]{'epoch': 27, 'num_users': 5.8621, 'loss': 0.0216, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8871, 'compress@10': 0.7053, 'time@10': 5.8051}:  97%|█████████▋| 29/30 [02:02<00:04,  4.75s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.022, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8879, 'compress@10': 0.7042, 'time@10': 5.7857}:  97%|█████████▋| 29/30 [02:07<00:04,  4.75s/it]  {'epoch': 27, 'num_users': 5.8667, 'loss': 0.022, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8879, 'compress@10': 0.7042, 'time@10': 5.7857}: 100%|██████████| 30/30 [02:07<00:00,  4.91s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.022, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8879, 'compress@10': 0.7042, 'time@10': 5.7857}: 100%|██████████| 30/30 [02:07<00:00,  4.26s/it]
Epoch: 27
Avg # of users: 5.866666666666666
Avg Loss: 0.021987616921940126
Avg hit ratio: 0.8590425184640424
Avg ndcg: 0.8879318365750072
Avg compression ratio: 0.7042413228320974
Avg train time: 5.785742259025573
Std train time: 1.9424053762378697
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 37, 8, 20, 26, 10, 10, 9, 6, 11, 10, 38, 38, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8969, 'compress@10': 0.7789, 'time@10': 5.259}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8969, 'compress@10': 0.7789, 'time@10': 5.259}:   3%|▎         | 1/30 [00:02<01:18,  2.69s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9162, 'compress@10': 0.7148, 'time@10': 4.9581}:   3%|▎         | 1/30 [00:07<01:18,  2.69s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9162, 'compress@10': 0.7148, 'time@10': 4.9581}:   7%|▋         | 2/30 [00:07<01:48,  3.87s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8965, 'compress@10': 0.7074, 'time@10': 4.3982}:   7%|▋         | 2/30 [00:09<01:48,  3.87s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8965, 'compress@10': 0.7074, 'time@10': 4.3982}:  10%|█         | 3/30 [00:09<01:17,  2.87s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8758, 'compress@10': 0.7102, 'time@10': 4.4125}:  10%|█         | 3/30 [00:13<01:17,  2.87s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8758, 'compress@10': 0.7102, 'time@10': 4.4125}:  13%|█▎        | 4/30 [00:13<01:31,  3.52s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0278, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8646, 'compress@10': 0.7099, 'time@10': 5.0608}:  13%|█▎        | 4/30 [00:17<01:31,  3.52s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0278, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8646, 'compress@10': 0.7099, 'time@10': 5.0608}:  17%|█▋        | 5/30 [00:17<01:31,  3.64s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0282, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.8764, 'compress@10': 0.7202, 'time@10': 5.4968}:  17%|█▋        | 5/30 [00:25<01:31,  3.64s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0282, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.8764, 'compress@10': 0.7202, 'time@10': 5.4968}:  20%|██        | 6/30 [00:25<02:00,  5.03s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0271, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.8794, 'compress@10': 0.7291, 'time@10': 5.8534}:  20%|██        | 6/30 [00:29<02:00,  5.03s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0271, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.8794, 'compress@10': 0.7291, 'time@10': 5.8534}:  23%|██▎       | 7/30 [00:29<01:48,  4.70s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.8804, 'compress@10': 0.7235, 'time@10': 5.8286}:  23%|██▎       | 7/30 [00:34<01:48,  4.70s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.8804, 'compress@10': 0.7235, 'time@10': 5.8286}:  27%|██▋       | 8/30 [00:34<01:50,  5.02s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.892, 'ndcg@10': 0.8893, 'compress@10': 0.7221, 'time@10': 6.2012}:  27%|██▋       | 8/30 [00:39<01:50,  5.02s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.892, 'ndcg@10': 0.8893, 'compress@10': 0.7221, 'time@10': 6.2012}:  30%|███       | 9/30 [00:39<01:42,  4.90s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9008, 'compress@10': 0.7178, 'time@10': 6.289}:  30%|███       | 9/30 [00:46<01:42,  4.90s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9008, 'compress@10': 0.7178, 'time@10': 6.289}:  33%|███▎      | 10/30 [00:46<01:51,  5.58s/it]{'epoch': 28, 'num_users': 6.6364, 'loss': 0.0291, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.8981, 'compress@10': 0.7225, 'time@10': 6.4004}:  33%|███▎      | 10/30 [00:50<01:51,  5.58s/it]{'epoch': 28, 'num_users': 6.6364, 'loss': 0.0291, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.8981, 'compress@10': 0.7225, 'time@10': 6.4004}:  37%|███▋      | 11/30 [00:50<01:35,  5.04s/it]{'epoch': 28, 'num_users': 6.4167, 'loss': 0.027, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8996, 'compress@10': 0.72, 'time@10': 6.155}:  37%|███▋      | 11/30 [00:53<01:35,  5.04s/it]    {'epoch': 28, 'num_users': 6.4167, 'loss': 0.027, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8996, 'compress@10': 0.72, 'time@10': 6.155}:  40%|████      | 12/30 [00:53<01:22,  4.57s/it]{'epoch': 28, 'num_users': 6.6154, 'loss': 0.0272, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8986, 'compress@10': 0.7249, 'time@10': 6.2206}:  40%|████      | 12/30 [00:57<01:22,  4.57s/it]{'epoch': 28, 'num_users': 6.6154, 'loss': 0.0272, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8986, 'compress@10': 0.7249, 'time@10': 6.2206}:  43%|████▎     | 13/30 [00:57<01:12,  4.26s/it]{'epoch': 28, 'num_users': 6.3571, 'loss': 0.0253, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.894, 'compress@10': 0.7192, 'time@10': 5.9953}:  43%|████▎     | 13/30 [01:00<01:12,  4.26s/it] {'epoch': 28, 'num_users': 6.3571, 'loss': 0.0253, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.894, 'compress@10': 0.7192, 'time@10': 5.9953}:  47%|████▋     | 14/30 [01:00<01:02,  3.91s/it]{'epoch': 28, 'num_users': 6.2667, 'loss': 0.0256, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8946, 'compress@10': 0.7143, 'time@10': 6.1214}:  47%|████▋     | 14/30 [01:04<01:02,  3.91s/it]{'epoch': 28, 'num_users': 6.2667, 'loss': 0.0256, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8946, 'compress@10': 0.7143, 'time@10': 6.1214}:  50%|█████     | 15/30 [01:04<00:58,  3.93s/it]{'epoch': 28, 'num_users': 6.0625, 'loss': 0.0241, 'hit_ratio@10': 0.848, 'ndcg@10': 0.896, 'compress@10': 0.7126, 'time@10': 5.9608}:  50%|█████     | 15/30 [01:08<00:58,  3.93s/it]  {'epoch': 28, 'num_users': 6.0625, 'loss': 0.0241, 'hit_ratio@10': 0.848, 'ndcg@10': 0.896, 'compress@10': 0.7126, 'time@10': 5.9608}:  53%|█████▎    | 16/30 [01:08<00:53,  3.83s/it]{'epoch': 28, 'num_users': 5.8235, 'loss': 0.0228, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8886, 'compress@10': 0.711, 'time@10': 5.8099}:  53%|█████▎    | 16/30 [01:09<00:53,  3.83s/it]{'epoch': 28, 'num_users': 5.8235, 'loss': 0.0228, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8886, 'compress@10': 0.711, 'time@10': 5.8099}:  57%|█████▋    | 17/30 [01:09<00:41,  3.20s/it]{'epoch': 28, 'num_users': 6.0556, 'loss': 0.0228, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8903, 'compress@10': 0.7083, 'time@10': 5.7368}:  57%|█████▋    | 17/30 [01:14<00:41,  3.20s/it]{'epoch': 28, 'num_users': 6.0556, 'loss': 0.0228, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8903, 'compress@10': 0.7083, 'time@10': 5.7368}:  60%|██████    | 18/30 [01:14<00:43,  3.60s/it]{'epoch': 28, 'num_users': 6.0, 'loss': 0.0221, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.891, 'compress@10': 0.7077, 'time@10': 5.6608}:  60%|██████    | 18/30 [01:16<00:43,  3.60s/it]    {'epoch': 28, 'num_users': 6.0, 'loss': 0.0221, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.891, 'compress@10': 0.7077, 'time@10': 5.6608}:  63%|██████▎   | 19/30 [01:16<00:34,  3.18s/it]{'epoch': 28, 'num_users': 6.15, 'loss': 0.0222, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8922, 'compress@10': 0.7111, 'time@10': 5.7802}:  63%|██████▎   | 19/30 [01:24<00:34,  3.18s/it]{'epoch': 28, 'num_users': 6.15, 'loss': 0.0222, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8922, 'compress@10': 0.7111, 'time@10': 5.7802}:  67%|██████▋   | 20/30 [01:24<00:46,  4.65s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8913, 'compress@10': 0.7104, 'time@10': 5.8523}:  67%|██████▋   | 20/30 [01:28<00:46,  4.65s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8913, 'compress@10': 0.7104, 'time@10': 5.8523}:  70%|███████   | 21/30 [01:28<00:39,  4.36s/it]{'epoch': 28, 'num_users': 6.1818, 'loss': 0.0239, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8921, 'compress@10': 0.703, 'time@10': 5.7552}:  70%|███████   | 21/30 [01:32<00:39,  4.36s/it] {'epoch': 28, 'num_users': 6.1818, 'loss': 0.0239, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8921, 'compress@10': 0.703, 'time@10': 5.7552}:  73%|███████▎  | 22/30 [01:32<00:33,  4.18s/it]{'epoch': 28, 'num_users': 6.1304, 'loss': 0.0235, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8933, 'compress@10': 0.7072, 'time@10': 5.7648}:  73%|███████▎  | 22/30 [01:35<00:33,  4.18s/it]{'epoch': 28, 'num_users': 6.1304, 'loss': 0.0235, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8933, 'compress@10': 0.7072, 'time@10': 5.7648}:  77%|███████▋  | 23/30 [01:35<00:26,  3.83s/it]{'epoch': 28, 'num_users': 5.9583, 'loss': 0.0227, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8894, 'compress@10': 0.7071, 'time@10': 5.6277}:  77%|███████▋  | 23/30 [01:37<00:26,  3.83s/it]{'epoch': 28, 'num_users': 5.9583, 'loss': 0.0227, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8894, 'compress@10': 0.7071, 'time@10': 5.6277}:  80%|████████  | 24/30 [01:37<00:20,  3.44s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0218, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8805, 'compress@10': 0.7096, 'time@10': 5.5023}:  80%|████████  | 24/30 [01:38<00:20,  3.44s/it]   {'epoch': 28, 'num_users': 5.8, 'loss': 0.0218, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8805, 'compress@10': 0.7096, 'time@10': 5.5023}:  83%|████████▎ | 25/30 [01:38<00:13,  2.79s/it]{'epoch': 28, 'num_users': 5.8077, 'loss': 0.0219, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8823, 'compress@10': 0.7114, 'time@10': 5.598}:  83%|████████▎ | 25/30 [01:47<00:13,  2.79s/it]{'epoch': 28, 'num_users': 5.8077, 'loss': 0.0219, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8823, 'compress@10': 0.7114, 'time@10': 5.598}:  87%|████████▋ | 26/30 [01:47<00:17,  4.36s/it]{'epoch': 28, 'num_users': 5.8889, 'loss': 0.0218, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8846, 'compress@10': 0.7125, 'time@10': 5.6559}:  87%|████████▋ | 26/30 [01:50<00:17,  4.36s/it]{'epoch': 28, 'num_users': 5.8889, 'loss': 0.0218, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8846, 'compress@10': 0.7125, 'time@10': 5.6559}:  90%|█████████ | 27/30 [01:50<00:12,  4.14s/it]{'epoch': 28, 'num_users': 6.0, 'loss': 0.0229, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8887, 'compress@10': 0.7073, 'time@10': 5.762}:  90%|█████████ | 27/30 [01:59<00:12,  4.14s/it]    {'epoch': 28, 'num_users': 6.0, 'loss': 0.0229, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8887, 'compress@10': 0.7073, 'time@10': 5.762}:  93%|█████████▎| 28/30 [01:59<00:10,  5.50s/it]{'epoch': 28, 'num_users': 5.8621, 'loss': 0.0226, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8903, 'compress@10': 0.706, 'time@10': 5.8046}:  93%|█████████▎| 28/30 [02:02<00:10,  5.50s/it]{'epoch': 28, 'num_users': 5.8621, 'loss': 0.0226, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8903, 'compress@10': 0.706, 'time@10': 5.8046}:  97%|█████████▋| 29/30 [02:02<00:04,  4.91s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.023, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8914, 'compress@10': 0.706, 'time@10': 5.8068}:  97%|█████████▋| 29/30 [02:08<00:04,  4.91s/it] {'epoch': 28, 'num_users': 5.8667, 'loss': 0.023, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8914, 'compress@10': 0.706, 'time@10': 5.8068}: 100%|██████████| 30/30 [02:08<00:00,  5.21s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.023, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8914, 'compress@10': 0.706, 'time@10': 5.8068}: 100%|██████████| 30/30 [02:08<00:00,  4.29s/it]
Epoch: 28
Avg # of users: 5.866666666666666
Avg Loss: 0.022999743979188785
Avg hit ratio: 0.8608120441210144
Avg ndcg: 0.8913532185457792
Avg compression ratio: 0.7059794595774931
Avg train time: 5.806787753105164
Std train time: 2.007683987908251
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 38, 8, 20, 26, 10, 10, 9, 6, 11, 10, 39, 39, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9023, 'compress@10': 0.7591, 'time@10': 5.2411}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9023, 'compress@10': 0.7591, 'time@10': 5.2411}:   3%|▎         | 1/30 [00:02<01:17,  2.67s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9136, 'compress@10': 0.6915, 'time@10': 4.9905}:   3%|▎         | 1/30 [00:07<01:17,  2.67s/it] {'epoch': 29, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9136, 'compress@10': 0.6915, 'time@10': 4.9905}:   7%|▋         | 2/30 [00:07<01:49,  3.91s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8948, 'compress@10': 0.6918, 'time@10': 4.544}:   7%|▋         | 2/30 [00:09<01:49,  3.91s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8948, 'compress@10': 0.6918, 'time@10': 4.544}:  10%|█         | 3/30 [00:09<01:20,  2.98s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.8949, 'compress@10': 0.6894, 'time@10': 4.5803}:  10%|█         | 3/30 [00:14<01:20,  2.98s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.8949, 'compress@10': 0.6894, 'time@10': 4.5803}:  13%|█▎        | 4/30 [00:14<01:35,  3.68s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.8806, 'compress@10': 0.6926, 'time@10': 5.3865}:  13%|█▎        | 4/30 [00:18<01:35,  3.68s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.8806, 'compress@10': 0.6926, 'time@10': 5.3865}:  17%|█▋        | 5/30 [00:18<01:37,  3.92s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0251, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.8892, 'compress@10': 0.7048, 'time@10': 5.7274}:  17%|█▋        | 5/30 [00:25<01:37,  3.92s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0251, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.8892, 'compress@10': 0.7048, 'time@10': 5.7274}:  20%|██        | 6/30 [00:25<02:03,  5.13s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0238, 'hit_ratio@10': 0.9142, 'ndcg@10': 0.8968, 'compress@10': 0.7161, 'time@10': 6.0514}:  20%|██        | 6/30 [00:29<02:03,  5.13s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0238, 'hit_ratio@10': 0.9142, 'ndcg@10': 0.8968, 'compress@10': 0.7161, 'time@10': 6.0514}:  23%|██▎       | 7/30 [00:29<01:49,  4.77s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0229, 'hit_ratio@10': 0.9213, 'ndcg@10': 0.9017, 'compress@10': 0.7126, 'time@10': 5.9958}:  23%|██▎       | 7/30 [00:35<01:49,  4.77s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0229, 'hit_ratio@10': 0.9213, 'ndcg@10': 0.9017, 'compress@10': 0.7126, 'time@10': 5.9958}:  27%|██▋       | 8/30 [00:35<01:51,  5.05s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.9174, 'ndcg@10': 0.9115, 'compress@10': 0.7122, 'time@10': 6.3302}:  27%|██▋       | 8/30 [00:40<01:51,  5.05s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.9174, 'ndcg@10': 0.9115, 'compress@10': 0.7122, 'time@10': 6.3302}:  30%|███       | 9/30 [00:40<01:42,  4.89s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0227, 'hit_ratio@10': 0.9234, 'ndcg@10': 0.9168, 'compress@10': 0.7111, 'time@10': 6.4262}:  30%|███       | 9/30 [00:47<01:42,  4.89s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0227, 'hit_ratio@10': 0.9234, 'ndcg@10': 0.9168, 'compress@10': 0.7111, 'time@10': 6.4262}:  33%|███▎      | 10/30 [00:47<01:52,  5.64s/it]{'epoch': 29, 'num_users': 6.6364, 'loss': 0.024, 'hit_ratio@10': 0.9094, 'ndcg@10': 0.9134, 'compress@10': 0.7164, 'time@10': 6.5323}:  33%|███▎      | 10/30 [00:51<01:52,  5.64s/it]{'epoch': 29, 'num_users': 6.6364, 'loss': 0.024, 'hit_ratio@10': 0.9094, 'ndcg@10': 0.9134, 'compress@10': 0.7164, 'time@10': 6.5323}:  37%|███▋      | 11/30 [00:51<01:36,  5.09s/it]{'epoch': 29, 'num_users': 6.4167, 'loss': 0.0223, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9137, 'compress@10': 0.7144, 'time@10': 6.2767}:  37%|███▋      | 11/30 [00:54<01:36,  5.09s/it]{'epoch': 29, 'num_users': 6.4167, 'loss': 0.0223, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9137, 'compress@10': 0.7144, 'time@10': 6.2767}:  40%|████      | 12/30 [00:54<01:22,  4.61s/it]{'epoch': 29, 'num_users': 6.6154, 'loss': 0.0226, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9125, 'compress@10': 0.7184, 'time@10': 6.3372}:  40%|████      | 12/30 [00:58<01:22,  4.61s/it]{'epoch': 29, 'num_users': 6.6154, 'loss': 0.0226, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9125, 'compress@10': 0.7184, 'time@10': 6.3372}:  43%|████▎     | 13/30 [00:58<01:13,  4.29s/it]{'epoch': 29, 'num_users': 6.3571, 'loss': 0.0211, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9068, 'compress@10': 0.7137, 'time@10': 6.1084}:  43%|████▎     | 13/30 [01:01<01:13,  4.29s/it]{'epoch': 29, 'num_users': 6.3571, 'loss': 0.0211, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9068, 'compress@10': 0.7137, 'time@10': 6.1084}:  47%|████▋     | 14/30 [01:01<01:03,  3.96s/it]{'epoch': 29, 'num_users': 6.2667, 'loss': 0.0211, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9075, 'compress@10': 0.7073, 'time@10': 6.2118}:  47%|████▋     | 14/30 [01:05<01:03,  3.96s/it]{'epoch': 29, 'num_users': 6.2667, 'loss': 0.0211, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9075, 'compress@10': 0.7073, 'time@10': 6.2118}:  50%|█████     | 15/30 [01:05<00:58,  3.93s/it]{'epoch': 29, 'num_users': 6.0625, 'loss': 0.02, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.908, 'compress@10': 0.7056, 'time@10': 6.0435}:  50%|█████     | 15/30 [01:08<00:58,  3.93s/it]   {'epoch': 29, 'num_users': 6.0625, 'loss': 0.02, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.908, 'compress@10': 0.7056, 'time@10': 6.0435}:  53%|█████▎    | 16/30 [01:08<00:53,  3.82s/it]{'epoch': 29, 'num_users': 5.8235, 'loss': 0.0189, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.9, 'compress@10': 0.7042, 'time@10': 5.8883}:  53%|█████▎    | 16/30 [01:10<00:53,  3.82s/it]{'epoch': 29, 'num_users': 5.8235, 'loss': 0.0189, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.9, 'compress@10': 0.7042, 'time@10': 5.8883}:  57%|█████▋    | 17/30 [01:10<00:41,  3.19s/it]{'epoch': 29, 'num_users': 6.0556, 'loss': 0.0191, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9008, 'compress@10': 0.7023, 'time@10': 5.8079}:  57%|█████▋    | 17/30 [01:15<00:41,  3.19s/it]{'epoch': 29, 'num_users': 6.0556, 'loss': 0.0191, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9008, 'compress@10': 0.7023, 'time@10': 5.8079}:  60%|██████    | 18/30 [01:15<00:42,  3.58s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 0.0189, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9013, 'compress@10': 0.702, 'time@10': 5.7224}:  60%|██████    | 18/30 [01:17<00:42,  3.58s/it]    {'epoch': 29, 'num_users': 6.0, 'loss': 0.0189, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9013, 'compress@10': 0.702, 'time@10': 5.7224}:  63%|██████▎   | 19/30 [01:17<00:34,  3.15s/it]{'epoch': 29, 'num_users': 6.15, 'loss': 0.0191, 'hit_ratio@10': 0.855, 'ndcg@10': 0.902, 'compress@10': 0.7049, 'time@10': 5.8271}:  63%|██████▎   | 19/30 [01:25<00:34,  3.15s/it]{'epoch': 29, 'num_users': 6.15, 'loss': 0.0191, 'hit_ratio@10': 0.855, 'ndcg@10': 0.902, 'compress@10': 0.7049, 'time@10': 5.8271}:  67%|██████▋   | 20/30 [01:25<00:45,  4.56s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.9007, 'compress@10': 0.7048, 'time@10': 5.9174}:  67%|██████▋   | 20/30 [01:29<00:45,  4.56s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.9007, 'compress@10': 0.7048, 'time@10': 5.9174}:  70%|███████   | 21/30 [01:29<00:39,  4.36s/it]{'epoch': 29, 'num_users': 6.1818, 'loss': 0.0205, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9015, 'compress@10': 0.6977, 'time@10': 5.821}:  70%|███████   | 21/30 [01:32<00:39,  4.36s/it] {'epoch': 29, 'num_users': 6.1818, 'loss': 0.0205, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9015, 'compress@10': 0.6977, 'time@10': 5.821}:  73%|███████▎  | 22/30 [01:32<00:33,  4.21s/it]{'epoch': 29, 'num_users': 6.1304, 'loss': 0.0201, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.903, 'compress@10': 0.7023, 'time@10': 5.8387}:  73%|███████▎  | 22/30 [01:36<00:33,  4.21s/it]{'epoch': 29, 'num_users': 6.1304, 'loss': 0.0201, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.903, 'compress@10': 0.7023, 'time@10': 5.8387}:  77%|███████▋  | 23/30 [01:36<00:27,  3.89s/it]{'epoch': 29, 'num_users': 5.9583, 'loss': 0.0193, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8987, 'compress@10': 0.7024, 'time@10': 5.7033}:  77%|███████▋  | 23/30 [01:38<00:27,  3.89s/it]{'epoch': 29, 'num_users': 5.9583, 'loss': 0.0193, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8987, 'compress@10': 0.7024, 'time@10': 5.7033}:  80%|████████  | 24/30 [01:38<00:21,  3.51s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0186, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8894, 'compress@10': 0.7052, 'time@10': 5.5771}:  80%|████████  | 24/30 [01:40<00:21,  3.51s/it]   {'epoch': 29, 'num_users': 5.8, 'loss': 0.0186, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8894, 'compress@10': 0.7052, 'time@10': 5.5771}:  83%|████████▎ | 25/30 [01:40<00:14,  2.85s/it]{'epoch': 29, 'num_users': 5.8077, 'loss': 0.0188, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8908, 'compress@10': 0.7079, 'time@10': 5.6723}:  83%|████████▎ | 25/30 [01:48<00:14,  2.85s/it]{'epoch': 29, 'num_users': 5.8077, 'loss': 0.0188, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8908, 'compress@10': 0.7079, 'time@10': 5.6723}:  87%|████████▋ | 26/30 [01:48<00:17,  4.42s/it]{'epoch': 29, 'num_users': 5.8889, 'loss': 0.0188, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8925, 'compress@10': 0.7084, 'time@10': 5.7069}:  87%|████████▋ | 26/30 [01:51<00:17,  4.42s/it]{'epoch': 29, 'num_users': 5.8889, 'loss': 0.0188, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8925, 'compress@10': 0.7084, 'time@10': 5.7069}:  90%|█████████ | 27/30 [01:51<00:12,  4.10s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 0.019, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8953, 'compress@10': 0.7022, 'time@10': 5.7762}:  90%|█████████ | 27/30 [01:59<00:12,  4.10s/it]    {'epoch': 29, 'num_users': 6.0, 'loss': 0.019, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8953, 'compress@10': 0.7022, 'time@10': 5.7762}:  93%|█████████▎| 28/30 [01:59<00:10,  5.18s/it]{'epoch': 29, 'num_users': 5.8621, 'loss': 0.0192, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8964, 'compress@10': 0.7009, 'time@10': 5.8143}:  93%|█████████▎| 28/30 [02:02<00:10,  5.18s/it]{'epoch': 29, 'num_users': 5.8621, 'loss': 0.0192, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8964, 'compress@10': 0.7009, 'time@10': 5.8143}:  97%|█████████▋| 29/30 [02:02<00:04,  4.67s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.0197, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8985, 'compress@10': 0.7009, 'time@10': 5.808}:  97%|█████████▋| 29/30 [02:08<00:04,  4.67s/it] {'epoch': 29, 'num_users': 5.8667, 'loss': 0.0197, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8985, 'compress@10': 0.7009, 'time@10': 5.808}: 100%|██████████| 30/30 [02:08<00:00,  4.97s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.0197, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8985, 'compress@10': 0.7009, 'time@10': 5.808}: 100%|██████████| 30/30 [02:08<00:00,  4.28s/it]
Epoch: 29
Avg # of users: 5.866666666666666
Avg Loss: 0.019683085340003743
Avg hit ratio: 0.8667830992097165
Avg ndcg: 0.8984686589862901
Avg compression ratio: 0.7009149350556707
Avg train time: 5.808048979441325
Std train time: 1.9545664173951334
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 39, 8, 20, 26, 10, 10, 9, 6, 11, 10, 40, 40, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9093, 'compress@10': 0.7378, 'time@10': 5.352}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9093, 'compress@10': 0.7378, 'time@10': 5.352}:   3%|▎         | 1/30 [00:02<01:18,  2.71s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9187, 'compress@10': 0.6642, 'time@10': 4.8397}:   3%|▎         | 1/30 [00:07<01:18,  2.71s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9187, 'compress@10': 0.6642, 'time@10': 4.8397}:   7%|▋         | 2/30 [00:07<01:43,  3.68s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8982, 'compress@10': 0.6733, 'time@10': 4.4731}:   7%|▋         | 2/30 [00:08<01:43,  3.68s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8982, 'compress@10': 0.6733, 'time@10': 4.4731}:  10%|█         | 3/30 [00:08<01:17,  2.87s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9083, 'compress@10': 0.6752, 'time@10': 4.3952}:  10%|█         | 3/30 [00:13<01:17,  2.87s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9083, 'compress@10': 0.6752, 'time@10': 4.3952}:  13%|█▎        | 4/30 [00:13<01:28,  3.40s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.891, 'ndcg@10': 0.893, 'compress@10': 0.6811, 'time@10': 5.1214}:  13%|█▎        | 4/30 [00:17<01:28,  3.40s/it]   {'epoch': 30, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.891, 'ndcg@10': 0.893, 'compress@10': 0.6811, 'time@10': 5.1214}:  17%|█▋        | 5/30 [00:17<01:30,  3.64s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0232, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.903, 'compress@10': 0.6911, 'time@10': 5.4697}:  17%|█▋        | 5/30 [00:24<01:30,  3.64s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0232, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.903, 'compress@10': 0.6911, 'time@10': 5.4697}:  20%|██        | 6/30 [00:24<01:56,  4.87s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0262, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.9122, 'compress@10': 0.704, 'time@10': 5.8233}:  20%|██        | 6/30 [00:28<01:56,  4.87s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0262, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.9122, 'compress@10': 0.704, 'time@10': 5.8233}:  23%|██▎       | 7/30 [00:28<01:45,  4.59s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0265, 'hit_ratio@10': 0.9177, 'ndcg@10': 0.9134, 'compress@10': 0.7039, 'time@10': 5.7919}:  23%|██▎       | 7/30 [00:34<01:45,  4.59s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0265, 'hit_ratio@10': 0.9177, 'ndcg@10': 0.9134, 'compress@10': 0.7039, 'time@10': 5.7919}:  27%|██▋       | 8/30 [00:34<01:48,  4.91s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0291, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9311, 'compress@10': 0.7022, 'time@10': 6.1214}:  27%|██▋       | 8/30 [00:38<01:48,  4.91s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0291, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9311, 'compress@10': 0.7022, 'time@10': 6.1214}:  30%|███       | 9/30 [00:38<01:39,  4.76s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0295, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9358, 'compress@10': 0.701, 'time@10': 6.2205}:  30%|███       | 9/30 [00:45<01:39,  4.76s/it]    {'epoch': 30, 'num_users': 6.3, 'loss': 0.0295, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9358, 'compress@10': 0.701, 'time@10': 6.2205}:  33%|███▎      | 10/30 [00:45<01:50,  5.51s/it]{'epoch': 30, 'num_users': 6.6364, 'loss': 0.03, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9313, 'compress@10': 0.7053, 'time@10': 6.4719}:  33%|███▎      | 10/30 [00:50<01:50,  5.51s/it]{'epoch': 30, 'num_users': 6.6364, 'loss': 0.03, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9313, 'compress@10': 0.7053, 'time@10': 6.4719}:  37%|███▋      | 11/30 [00:50<01:39,  5.22s/it]{'epoch': 30, 'num_users': 6.4167, 'loss': 0.0277, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.93, 'compress@10': 0.704, 'time@10': 6.2771}:  37%|███▋      | 11/30 [00:54<01:39,  5.22s/it] {'epoch': 30, 'num_users': 6.4167, 'loss': 0.0277, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.93, 'compress@10': 0.704, 'time@10': 6.2771}:  40%|████      | 12/30 [00:54<01:28,  4.90s/it]{'epoch': 30, 'num_users': 6.6154, 'loss': 0.028, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9264, 'compress@10': 0.7073, 'time@10': 6.3349}:  40%|████      | 12/30 [00:58<01:28,  4.90s/it]{'epoch': 30, 'num_users': 6.6154, 'loss': 0.028, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9264, 'compress@10': 0.7073, 'time@10': 6.3349}:  43%|████▎     | 13/30 [00:58<01:16,  4.49s/it]{'epoch': 30, 'num_users': 6.3571, 'loss': 0.0261, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.9198, 'compress@10': 0.7031, 'time@10': 6.1093}:  43%|████▎     | 13/30 [01:01<01:16,  4.49s/it]{'epoch': 30, 'num_users': 6.3571, 'loss': 0.0261, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.9198, 'compress@10': 0.7031, 'time@10': 6.1093}:  47%|████▋     | 14/30 [01:01<01:05,  4.11s/it]{'epoch': 30, 'num_users': 6.2667, 'loss': 0.026, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9203, 'compress@10': 0.6977, 'time@10': 6.2163}:  47%|████▋     | 14/30 [01:05<01:05,  4.11s/it] {'epoch': 30, 'num_users': 6.2667, 'loss': 0.026, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9203, 'compress@10': 0.6977, 'time@10': 6.2163}:  50%|█████     | 15/30 [01:05<01:00,  4.04s/it]{'epoch': 30, 'num_users': 6.0625, 'loss': 0.0247, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.92, 'compress@10': 0.6966, 'time@10': 6.0515}:  50%|█████     | 15/30 [01:08<01:00,  4.04s/it] {'epoch': 30, 'num_users': 6.0625, 'loss': 0.0247, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.92, 'compress@10': 0.6966, 'time@10': 6.0515}:  53%|█████▎    | 16/30 [01:08<00:54,  3.92s/it]{'epoch': 30, 'num_users': 5.8235, 'loss': 0.0233, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9112, 'compress@10': 0.6957, 'time@10': 5.8949}:  53%|█████▎    | 16/30 [01:10<00:54,  3.92s/it]{'epoch': 30, 'num_users': 5.8235, 'loss': 0.0233, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9112, 'compress@10': 0.6957, 'time@10': 5.8949}:  57%|█████▋    | 17/30 [01:10<00:42,  3.26s/it]{'epoch': 30, 'num_users': 6.0556, 'loss': 0.0231, 'hit_ratio@10': 0.838, 'ndcg@10': 0.912, 'compress@10': 0.6937, 'time@10': 5.8174}:  57%|█████▋    | 17/30 [01:15<00:42,  3.26s/it]  {'epoch': 30, 'num_users': 6.0556, 'loss': 0.0231, 'hit_ratio@10': 0.838, 'ndcg@10': 0.912, 'compress@10': 0.6937, 'time@10': 5.8174}:  60%|██████    | 18/30 [01:15<00:43,  3.65s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 0.0223, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9127, 'compress@10': 0.6936, 'time@10': 5.7365}:  60%|██████    | 18/30 [01:17<00:43,  3.65s/it] {'epoch': 30, 'num_users': 6.0, 'loss': 0.0223, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9127, 'compress@10': 0.6936, 'time@10': 5.7365}:  63%|██████▎   | 19/30 [01:17<00:35,  3.21s/it]{'epoch': 30, 'num_users': 6.15, 'loss': 0.0225, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.9126, 'compress@10': 0.6954, 'time@10': 5.8499}:  63%|██████▎   | 19/30 [01:25<00:35,  3.21s/it]{'epoch': 30, 'num_users': 6.15, 'loss': 0.0225, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.9126, 'compress@10': 0.6954, 'time@10': 5.8499}:  67%|██████▋   | 20/30 [01:25<00:46,  4.66s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.9107, 'compress@10': 0.6961, 'time@10': 5.9572}:  67%|██████▋   | 20/30 [01:29<00:46,  4.66s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.9107, 'compress@10': 0.6961, 'time@10': 5.9572}:  70%|███████   | 21/30 [01:29<00:40,  4.49s/it]{'epoch': 30, 'num_users': 6.1818, 'loss': 0.0241, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9111, 'compress@10': 0.6897, 'time@10': 5.8581}:  70%|███████   | 21/30 [01:33<00:40,  4.49s/it]{'epoch': 30, 'num_users': 6.1818, 'loss': 0.0241, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9111, 'compress@10': 0.6897, 'time@10': 5.8581}:  73%|███████▎  | 22/30 [01:33<00:34,  4.29s/it]{'epoch': 30, 'num_users': 6.1304, 'loss': 0.0243, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.9111, 'compress@10': 0.6941, 'time@10': 5.8737}:  73%|███████▎  | 22/30 [01:36<00:34,  4.29s/it]{'epoch': 30, 'num_users': 6.1304, 'loss': 0.0243, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.9111, 'compress@10': 0.6941, 'time@10': 5.8737}:  77%|███████▋  | 23/30 [01:36<00:27,  3.95s/it]{'epoch': 30, 'num_users': 5.9583, 'loss': 0.0234, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.9065, 'compress@10': 0.6946, 'time@10': 5.7386}:  77%|███████▋  | 23/30 [01:39<00:27,  3.95s/it]{'epoch': 30, 'num_users': 5.9583, 'loss': 0.0234, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.9065, 'compress@10': 0.6946, 'time@10': 5.7386}:  80%|████████  | 24/30 [01:39<00:21,  3.56s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8969, 'compress@10': 0.6977, 'time@10': 5.6133}:  80%|████████  | 24/30 [01:40<00:21,  3.56s/it]    {'epoch': 30, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8969, 'compress@10': 0.6977, 'time@10': 5.6133}:  83%|████████▎ | 25/30 [01:40<00:14,  2.90s/it]{'epoch': 30, 'num_users': 5.8077, 'loss': 0.0225, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8983, 'compress@10': 0.7004, 'time@10': 5.7048}:  83%|████████▎ | 25/30 [01:48<00:14,  2.90s/it]{'epoch': 30, 'num_users': 5.8077, 'loss': 0.0225, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8983, 'compress@10': 0.7004, 'time@10': 5.7048}:  87%|████████▋ | 26/30 [01:48<00:17,  4.44s/it]{'epoch': 30, 'num_users': 5.8889, 'loss': 0.0223, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8993, 'compress@10': 0.7006, 'time@10': 5.7743}:  87%|████████▋ | 26/30 [01:52<00:17,  4.44s/it]{'epoch': 30, 'num_users': 5.8889, 'loss': 0.0223, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8993, 'compress@10': 0.7006, 'time@10': 5.7743}:  90%|█████████ | 27/30 [01:52<00:12,  4.27s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 0.0232, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9018, 'compress@10': 0.695, 'time@10': 5.8537}:  90%|█████████ | 27/30 [02:00<00:12,  4.27s/it]    {'epoch': 30, 'num_users': 6.0, 'loss': 0.0232, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9018, 'compress@10': 0.695, 'time@10': 5.8537}:  93%|█████████▎| 28/30 [02:00<00:10,  5.40s/it]{'epoch': 30, 'num_users': 5.8621, 'loss': 0.0228, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9037, 'compress@10': 0.6943, 'time@10': 5.8899}:  93%|█████████▎| 28/30 [02:03<00:10,  5.40s/it]{'epoch': 30, 'num_users': 5.8621, 'loss': 0.0228, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9037, 'compress@10': 0.6943, 'time@10': 5.8899}:  97%|█████████▋| 29/30 [02:03<00:04,  4.83s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.023, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.9054, 'compress@10': 0.6954, 'time@10': 5.8724}:  97%|█████████▋| 29/30 [02:09<00:04,  4.83s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.023, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.9054, 'compress@10': 0.6954, 'time@10': 5.8724}: 100%|██████████| 30/30 [02:09<00:00,  5.00s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.023, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.9054, 'compress@10': 0.6954, 'time@10': 5.8724}: 100%|██████████| 30/30 [02:09<00:00,  4.31s/it]
Epoch: 30
Avg # of users: 5.866666666666666
Avg Loss: 0.023049715584790062
Avg hit ratio: 0.8591677008342635
Avg ndcg: 0.9054488645543814
Avg compression ratio: 0.6954342919920836
Avg train time: 5.872428941726684
Std train time: 1.998546391778478
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 39, 8, 20, 26, 10, 10, 9, 6, 11, 10, 41, 41, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9093, 'compress@10': 0.718, 'time@10': 4.2361}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9093, 'compress@10': 0.718, 'time@10': 4.2361}:   3%|▎         | 1/30 [00:02<01:02,  2.15s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9069, 'compress@10': 0.6395, 'time@10': 4.2345}:   3%|▎         | 1/30 [00:06<01:02,  2.15s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9069, 'compress@10': 0.6395, 'time@10': 4.2345}:   7%|▋         | 2/30 [00:06<01:35,  3.40s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.8903, 'compress@10': 0.6578, 'time@10': 4.157}:   7%|▋         | 2/30 [00:08<01:35,  3.40s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.8903, 'compress@10': 0.6578, 'time@10': 4.157}:  10%|█         | 3/30 [00:08<01:15,  2.78s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9003, 'compress@10': 0.6701, 'time@10': 4.2751}:  10%|█         | 3/30 [00:13<01:15,  2.78s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9003, 'compress@10': 0.6701, 'time@10': 4.2751}:  13%|█▎        | 4/30 [00:13<01:32,  3.54s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.029, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.8876, 'compress@10': 0.6756, 'time@10': 5.0664}:  13%|█▎        | 4/30 [00:17<01:32,  3.54s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.029, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.8876, 'compress@10': 0.6756, 'time@10': 5.0664}:  17%|█▋        | 5/30 [00:17<01:34,  3.76s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0286, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.8968, 'compress@10': 0.6867, 'time@10': 5.4818}:  17%|█▋        | 5/30 [00:24<01:34,  3.76s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0286, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.8968, 'compress@10': 0.6867, 'time@10': 5.4818}:  20%|██        | 6/30 [00:24<02:01,  5.07s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.028, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.8965, 'compress@10': 0.6973, 'time@10': 5.8257}:  20%|██        | 6/30 [00:28<02:01,  5.07s/it] {'epoch': 31, 'num_users': 6.2857, 'loss': 0.028, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.8965, 'compress@10': 0.6973, 'time@10': 5.8257}:  23%|██▎       | 7/30 [00:28<01:48,  4.71s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0268, 'hit_ratio@10': 0.9198, 'ndcg@10': 0.9009, 'compress@10': 0.7026, 'time@10': 5.7931}:  23%|██▎       | 7/30 [00:34<01:48,  4.71s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0268, 'hit_ratio@10': 0.9198, 'ndcg@10': 0.9009, 'compress@10': 0.7026, 'time@10': 5.7931}:  27%|██▋       | 8/30 [00:34<01:49,  5.00s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9098, 'compress@10': 0.7011, 'time@10': 6.1471}:  27%|██▋       | 8/30 [00:39<01:49,  5.00s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9098, 'compress@10': 0.7011, 'time@10': 6.1471}:  30%|███       | 9/30 [00:39<01:41,  4.85s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0278, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9148, 'compress@10': 0.7005, 'time@10': 6.2479}:  30%|███       | 9/30 [00:46<01:41,  4.85s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0278, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9148, 'compress@10': 0.7005, 'time@10': 6.2479}:  33%|███▎      | 10/30 [00:46<01:51,  5.58s/it]{'epoch': 31, 'num_users': 6.6364, 'loss': 0.0281, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9127, 'compress@10': 0.7035, 'time@10': 6.3655}:  33%|███▎      | 10/30 [00:50<01:51,  5.58s/it]{'epoch': 31, 'num_users': 6.6364, 'loss': 0.0281, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9127, 'compress@10': 0.7035, 'time@10': 6.3655}:  37%|███▋      | 11/30 [00:50<01:35,  5.04s/it]{'epoch': 31, 'num_users': 6.4167, 'loss': 0.026, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9131, 'compress@10': 0.7025, 'time@10': 6.1186}:  37%|███▋      | 11/30 [00:53<01:35,  5.04s/it]  {'epoch': 31, 'num_users': 6.4167, 'loss': 0.026, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9131, 'compress@10': 0.7025, 'time@10': 6.1186}:  40%|████      | 12/30 [00:53<01:21,  4.55s/it]{'epoch': 31, 'num_users': 6.6154, 'loss': 0.0261, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.9117, 'compress@10': 0.7052, 'time@10': 6.1638}:  40%|████      | 12/30 [00:56<01:21,  4.55s/it]{'epoch': 31, 'num_users': 6.6154, 'loss': 0.0261, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.9117, 'compress@10': 0.7052, 'time@10': 6.1638}:  43%|████▎     | 13/30 [00:56<01:11,  4.20s/it]{'epoch': 31, 'num_users': 6.3571, 'loss': 0.0243, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.9061, 'compress@10': 0.7006, 'time@10': 5.9431}:  43%|████▎     | 13/30 [01:00<01:11,  4.20s/it]{'epoch': 31, 'num_users': 6.3571, 'loss': 0.0243, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.9061, 'compress@10': 0.7006, 'time@10': 5.9431}:  47%|████▋     | 14/30 [01:00<01:01,  3.87s/it]{'epoch': 31, 'num_users': 6.2667, 'loss': 0.0246, 'hit_ratio@10': 0.852, 'ndcg@10': 0.9041, 'compress@10': 0.6956, 'time@10': 6.0725}:  47%|████▋     | 14/30 [01:03<01:01,  3.87s/it] {'epoch': 31, 'num_users': 6.2667, 'loss': 0.0246, 'hit_ratio@10': 0.852, 'ndcg@10': 0.9041, 'compress@10': 0.6956, 'time@10': 6.0725}:  50%|█████     | 15/30 [01:03<00:58,  3.91s/it]{'epoch': 31, 'num_users': 6.0625, 'loss': 0.0231, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.9049, 'compress@10': 0.6939, 'time@10': 5.9193}:  50%|█████     | 15/30 [01:07<00:58,  3.91s/it]{'epoch': 31, 'num_users': 6.0625, 'loss': 0.0231, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.9049, 'compress@10': 0.6939, 'time@10': 5.9193}:  53%|█████▎    | 16/30 [01:07<00:53,  3.83s/it]{'epoch': 31, 'num_users': 5.8235, 'loss': 0.0218, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.897, 'compress@10': 0.6931, 'time@10': 5.7716}:  53%|█████▎    | 16/30 [01:09<00:53,  3.83s/it] {'epoch': 31, 'num_users': 5.8235, 'loss': 0.0218, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.897, 'compress@10': 0.6931, 'time@10': 5.7716}:  57%|█████▋    | 17/30 [01:09<00:41,  3.21s/it]{'epoch': 31, 'num_users': 6.0556, 'loss': 0.022, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8984, 'compress@10': 0.692, 'time@10': 5.7007}:  57%|█████▋    | 17/30 [01:13<00:41,  3.21s/it] {'epoch': 31, 'num_users': 6.0556, 'loss': 0.022, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8984, 'compress@10': 0.692, 'time@10': 5.7007}:  60%|██████    | 18/30 [01:13<00:43,  3.60s/it]{'epoch': 31, 'num_users': 6.0, 'loss': 0.0215, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8988, 'compress@10': 0.6921, 'time@10': 5.6256}:  60%|██████    | 18/30 [01:16<00:43,  3.60s/it] {'epoch': 31, 'num_users': 6.0, 'loss': 0.0215, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8988, 'compress@10': 0.6921, 'time@10': 5.6256}:  63%|██████▎   | 19/30 [01:16<00:34,  3.18s/it]{'epoch': 31, 'num_users': 6.15, 'loss': 0.0216, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8998, 'compress@10': 0.693, 'time@10': 5.7367}:  63%|██████▎   | 19/30 [01:24<00:34,  3.18s/it]{'epoch': 31, 'num_users': 6.15, 'loss': 0.0216, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8998, 'compress@10': 0.693, 'time@10': 5.7367}:  67%|██████▋   | 20/30 [01:24<00:45,  4.59s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0223, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8991, 'compress@10': 0.6935, 'time@10': 5.8377}:  67%|██████▋   | 20/30 [01:27<00:45,  4.59s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0223, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8991, 'compress@10': 0.6935, 'time@10': 5.8377}:  70%|███████   | 21/30 [01:27<00:39,  4.41s/it]{'epoch': 31, 'num_users': 6.1818, 'loss': 0.0225, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8991, 'compress@10': 0.686, 'time@10': 5.7445}:  70%|███████   | 21/30 [01:31<00:39,  4.41s/it] {'epoch': 31, 'num_users': 6.1818, 'loss': 0.0225, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8991, 'compress@10': 0.686, 'time@10': 5.7445}:  73%|███████▎  | 22/30 [01:31<00:33,  4.23s/it]{'epoch': 31, 'num_users': 6.1304, 'loss': 0.022, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9004, 'compress@10': 0.6897, 'time@10': 5.7658}:  73%|███████▎  | 22/30 [01:34<00:33,  4.23s/it]{'epoch': 31, 'num_users': 6.1304, 'loss': 0.022, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9004, 'compress@10': 0.6897, 'time@10': 5.7658}:  77%|███████▋  | 23/30 [01:34<00:27,  3.91s/it]{'epoch': 31, 'num_users': 5.9583, 'loss': 0.0211, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8962, 'compress@10': 0.6908, 'time@10': 5.6372}:  77%|███████▋  | 23/30 [01:37<00:27,  3.91s/it]{'epoch': 31, 'num_users': 5.9583, 'loss': 0.0211, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8962, 'compress@10': 0.6908, 'time@10': 5.6372}:  80%|████████  | 24/30 [01:37<00:21,  3.55s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0204, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.887, 'compress@10': 0.6941, 'time@10': 5.5189}:  80%|████████  | 24/30 [01:39<00:21,  3.55s/it]    {'epoch': 31, 'num_users': 5.8, 'loss': 0.0204, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.887, 'compress@10': 0.6941, 'time@10': 5.5189}:  83%|████████▎ | 25/30 [01:39<00:14,  2.90s/it]{'epoch': 31, 'num_users': 5.8077, 'loss': 0.0204, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8889, 'compress@10': 0.6967, 'time@10': 5.6158}:  83%|████████▎ | 25/30 [01:47<00:14,  2.90s/it]{'epoch': 31, 'num_users': 5.8077, 'loss': 0.0204, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8889, 'compress@10': 0.6967, 'time@10': 5.6158}:  87%|████████▋ | 26/30 [01:47<00:17,  4.46s/it]{'epoch': 31, 'num_users': 5.8889, 'loss': 0.0201, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8903, 'compress@10': 0.6964, 'time@10': 5.6668}:  87%|████████▋ | 26/30 [01:50<00:17,  4.46s/it]{'epoch': 31, 'num_users': 5.8889, 'loss': 0.0201, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8903, 'compress@10': 0.6964, 'time@10': 5.6668}:  90%|█████████ | 27/30 [01:50<00:12,  4.18s/it]{'epoch': 31, 'num_users': 6.0, 'loss': 0.0199, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8925, 'compress@10': 0.6919, 'time@10': 5.7479}:  90%|█████████ | 27/30 [01:58<00:12,  4.18s/it]   {'epoch': 31, 'num_users': 6.0, 'loss': 0.0199, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8925, 'compress@10': 0.6919, 'time@10': 5.7479}:  93%|█████████▎| 28/30 [01:58<00:10,  5.33s/it]{'epoch': 31, 'num_users': 5.8621, 'loss': 0.0196, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8947, 'compress@10': 0.6912, 'time@10': 5.7985}:  93%|█████████▎| 28/30 [02:02<00:10,  5.33s/it]{'epoch': 31, 'num_users': 5.8621, 'loss': 0.0196, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8947, 'compress@10': 0.6912, 'time@10': 5.7985}:  97%|█████████▋| 29/30 [02:02<00:04,  4.82s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.02, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.8969, 'compress@10': 0.692, 'time@10': 5.7903}:  97%|█████████▋| 29/30 [02:07<00:04,  4.82s/it]   {'epoch': 31, 'num_users': 5.8667, 'loss': 0.02, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.8969, 'compress@10': 0.692, 'time@10': 5.7903}: 100%|██████████| 30/30 [02:07<00:00,  5.06s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.02, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.8969, 'compress@10': 0.692, 'time@10': 5.7903}: 100%|██████████| 30/30 [02:07<00:00,  4.26s/it]
Epoch: 31
Avg # of users: 5.866666666666666
Avg Loss: 0.020034919761082348
Avg hit ratio: 0.859116718848297
Avg ndcg: 0.8968919193965955
Avg compression ratio: 0.6920128997964208
Avg train time: 5.790305296579997
Std train time: 1.9658581627448743
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 26, 10, 10, 9, 6, 11, 10, 42, 42, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9119, 'compress@10': 0.7043, 'time@10': 5.664}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9119, 'compress@10': 0.7043, 'time@10': 5.664}:   3%|▎         | 1/30 [00:02<01:23,  2.87s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0286, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9085, 'compress@10': 0.6317, 'time@10': 5.1862}:   3%|▎         | 1/30 [00:07<01:23,  2.87s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0286, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9085, 'compress@10': 0.6317, 'time@10': 5.1862}:   7%|▋         | 2/30 [00:07<01:51,  3.98s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8914, 'compress@10': 0.6532, 'time@10': 4.744}:   7%|▋         | 2/30 [00:09<01:51,  3.98s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8914, 'compress@10': 0.6532, 'time@10': 4.744}:  10%|█         | 3/30 [00:09<01:22,  3.06s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8715, 'compress@10': 0.6642, 'time@10': 4.7737}:  10%|█         | 3/30 [00:14<01:22,  3.06s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8715, 'compress@10': 0.6642, 'time@10': 4.7737}:  13%|█▎        | 4/30 [00:14<01:38,  3.79s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0278, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8645, 'compress@10': 0.6693, 'time@10': 5.4665}:  13%|█▎        | 4/30 [00:18<01:38,  3.79s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0278, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8645, 'compress@10': 0.6693, 'time@10': 5.4665}:  17%|█▋        | 5/30 [00:18<01:38,  3.92s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0278, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.8808, 'compress@10': 0.6782, 'time@10': 5.8633}:  17%|█▋        | 5/30 [00:26<01:38,  3.92s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0278, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.8808, 'compress@10': 0.6782, 'time@10': 5.8633}:  20%|██        | 6/30 [00:26<02:06,  5.28s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0274, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.8901, 'compress@10': 0.6892, 'time@10': 6.1537}:  20%|██        | 6/30 [00:30<02:06,  5.28s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0274, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.8901, 'compress@10': 0.6892, 'time@10': 6.1537}:  23%|██▎       | 7/30 [00:30<01:51,  4.86s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0275, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.894, 'compress@10': 0.6993, 'time@10': 6.0848}:  23%|██▎       | 7/30 [00:36<01:51,  4.86s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.0275, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.894, 'compress@10': 0.6993, 'time@10': 6.0848}:  27%|██▋       | 8/30 [00:36<01:52,  5.11s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.026, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9014, 'compress@10': 0.6983, 'time@10': 6.403}:  27%|██▋       | 8/30 [00:40<01:52,  5.11s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.026, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9014, 'compress@10': 0.6983, 'time@10': 6.403}:  30%|███       | 9/30 [00:40<01:43,  4.92s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.025, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9089, 'compress@10': 0.6956, 'time@10': 6.5007}:  30%|███       | 9/30 [00:48<01:43,  4.92s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 0.025, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9089, 'compress@10': 0.6956, 'time@10': 6.5007}:  33%|███▎      | 10/30 [00:48<01:53,  5.70s/it]{'epoch': 32, 'num_users': 6.6364, 'loss': 0.0255, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9096, 'compress@10': 0.6984, 'time@10': 6.6105}:  33%|███▎      | 10/30 [00:52<01:53,  5.70s/it]{'epoch': 32, 'num_users': 6.6364, 'loss': 0.0255, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9096, 'compress@10': 0.6984, 'time@10': 6.6105}:  37%|███▋      | 11/30 [00:52<01:37,  5.15s/it]{'epoch': 32, 'num_users': 6.4167, 'loss': 0.0235, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9102, 'compress@10': 0.6976, 'time@10': 6.3465}:  37%|███▋      | 11/30 [00:55<01:37,  5.15s/it]{'epoch': 32, 'num_users': 6.4167, 'loss': 0.0235, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9102, 'compress@10': 0.6976, 'time@10': 6.3465}:  40%|████      | 12/30 [00:55<01:23,  4.64s/it]{'epoch': 32, 'num_users': 6.6154, 'loss': 0.0242, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9076, 'compress@10': 0.6994, 'time@10': 6.4062}:  40%|████      | 12/30 [00:59<01:23,  4.64s/it]{'epoch': 32, 'num_users': 6.6154, 'loss': 0.0242, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9076, 'compress@10': 0.6994, 'time@10': 6.4062}:  43%|████▎     | 13/30 [00:59<01:13,  4.33s/it]{'epoch': 32, 'num_users': 6.3571, 'loss': 0.0225, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9023, 'compress@10': 0.6936, 'time@10': 6.1934}:  43%|████▎     | 13/30 [01:02<01:13,  4.33s/it] {'epoch': 32, 'num_users': 6.3571, 'loss': 0.0225, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9023, 'compress@10': 0.6936, 'time@10': 6.1934}:  47%|████▋     | 14/30 [01:02<01:05,  4.07s/it]{'epoch': 32, 'num_users': 6.2667, 'loss': 0.022, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9044, 'compress@10': 0.6891, 'time@10': 6.3093}:  47%|████▋     | 14/30 [01:06<01:05,  4.07s/it]{'epoch': 32, 'num_users': 6.2667, 'loss': 0.022, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9044, 'compress@10': 0.6891, 'time@10': 6.3093}:  50%|█████     | 15/30 [01:06<01:00,  4.05s/it]{'epoch': 32, 'num_users': 6.0625, 'loss': 0.0208, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9052, 'compress@10': 0.6875, 'time@10': 6.139}:  50%|█████     | 15/30 [01:10<01:00,  4.05s/it]{'epoch': 32, 'num_users': 6.0625, 'loss': 0.0208, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9052, 'compress@10': 0.6875, 'time@10': 6.139}:  53%|█████▎    | 16/30 [01:10<00:54,  3.92s/it]{'epoch': 32, 'num_users': 5.8235, 'loss': 0.0196, 'hit_ratio@10': 0.852, 'ndcg@10': 0.899, 'compress@10': 0.6869, 'time@10': 5.9772}:  53%|█████▎    | 16/30 [01:11<00:54,  3.92s/it] {'epoch': 32, 'num_users': 5.8235, 'loss': 0.0196, 'hit_ratio@10': 0.852, 'ndcg@10': 0.899, 'compress@10': 0.6869, 'time@10': 5.9772}:  57%|█████▋    | 17/30 [01:11<00:42,  3.26s/it]{'epoch': 32, 'num_users': 6.0556, 'loss': 0.02, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9025, 'compress@10': 0.686, 'time@10': 5.8893}:  57%|█████▋    | 17/30 [01:16<00:42,  3.26s/it] {'epoch': 32, 'num_users': 6.0556, 'loss': 0.02, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9025, 'compress@10': 0.686, 'time@10': 5.8893}:  60%|██████    | 18/30 [01:16<00:43,  3.62s/it]{'epoch': 32, 'num_users': 6.0, 'loss': 0.0193, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9038, 'compress@10': 0.6863, 'time@10': 5.787}:  60%|██████    | 18/30 [01:18<00:43,  3.62s/it]   {'epoch': 32, 'num_users': 6.0, 'loss': 0.0193, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9038, 'compress@10': 0.6863, 'time@10': 5.787}:  63%|██████▎   | 19/30 [01:18<00:34,  3.13s/it]{'epoch': 32, 'num_users': 6.15, 'loss': 0.0195, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9047, 'compress@10': 0.6865, 'time@10': 5.8913}:  63%|██████▎   | 19/30 [01:26<00:34,  3.13s/it]{'epoch': 32, 'num_users': 6.15, 'loss': 0.0195, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9047, 'compress@10': 0.6865, 'time@10': 5.8913}:  67%|██████▋   | 20/30 [01:26<00:45,  4.57s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9042, 'compress@10': 0.6869, 'time@10': 5.9759}:  67%|██████▋   | 20/30 [01:30<00:45,  4.57s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9042, 'compress@10': 0.6869, 'time@10': 5.9759}:  70%|███████   | 21/30 [01:30<00:39,  4.36s/it]{'epoch': 32, 'num_users': 6.1818, 'loss': 0.021, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9058, 'compress@10': 0.6798, 'time@10': 5.8773}:  70%|███████   | 21/30 [01:34<00:39,  4.36s/it] {'epoch': 32, 'num_users': 6.1818, 'loss': 0.021, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9058, 'compress@10': 0.6798, 'time@10': 5.8773}:  73%|███████▎  | 22/30 [01:34<00:33,  4.22s/it]{'epoch': 32, 'num_users': 6.1304, 'loss': 0.0207, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9067, 'compress@10': 0.684, 'time@10': 5.8955}:  73%|███████▎  | 22/30 [01:37<00:33,  4.22s/it]{'epoch': 32, 'num_users': 6.1304, 'loss': 0.0207, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9067, 'compress@10': 0.684, 'time@10': 5.8955}:  77%|███████▋  | 23/30 [01:37<00:27,  3.91s/it]{'epoch': 32, 'num_users': 5.9583, 'loss': 0.0199, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9022, 'compress@10': 0.6849, 'time@10': 5.7654}:  77%|███████▋  | 23/30 [01:40<00:27,  3.91s/it]{'epoch': 32, 'num_users': 5.9583, 'loss': 0.0199, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9022, 'compress@10': 0.6849, 'time@10': 5.7654}:  80%|████████  | 24/30 [01:40<00:21,  3.58s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0191, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8928, 'compress@10': 0.6884, 'time@10': 5.6453}:  80%|████████  | 24/30 [01:41<00:21,  3.58s/it]   {'epoch': 32, 'num_users': 5.8, 'loss': 0.0191, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8928, 'compress@10': 0.6884, 'time@10': 5.6453}:  83%|████████▎ | 25/30 [01:41<00:14,  2.93s/it]{'epoch': 32, 'num_users': 5.8077, 'loss': 0.0192, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8949, 'compress@10': 0.6905, 'time@10': 5.7334}:  83%|████████▎ | 25/30 [01:49<00:14,  2.93s/it]{'epoch': 32, 'num_users': 5.8077, 'loss': 0.0192, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8949, 'compress@10': 0.6905, 'time@10': 5.7334}:  87%|████████▋ | 26/30 [01:49<00:17,  4.45s/it]{'epoch': 32, 'num_users': 5.8889, 'loss': 0.0189, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.8969, 'compress@10': 0.6903, 'time@10': 5.7593}:  87%|████████▋ | 26/30 [01:52<00:17,  4.45s/it]{'epoch': 32, 'num_users': 5.8889, 'loss': 0.0189, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.8969, 'compress@10': 0.6903, 'time@10': 5.7593}:  90%|█████████ | 27/30 [01:52<00:12,  4.09s/it]{'epoch': 32, 'num_users': 6.0, 'loss': 0.0197, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9009, 'compress@10': 0.6884, 'time@10': 5.8499}:  90%|█████████ | 27/30 [02:01<00:12,  4.09s/it]   {'epoch': 32, 'num_users': 6.0, 'loss': 0.0197, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9009, 'compress@10': 0.6884, 'time@10': 5.8499}:  93%|█████████▎| 28/30 [02:01<00:10,  5.36s/it]{'epoch': 32, 'num_users': 5.8621, 'loss': 0.0193, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9026, 'compress@10': 0.688, 'time@10': 5.8759}:  93%|█████████▎| 28/30 [02:04<00:10,  5.36s/it]{'epoch': 32, 'num_users': 5.8621, 'loss': 0.0193, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9026, 'compress@10': 0.688, 'time@10': 5.8759}:  97%|█████████▋| 29/30 [02:04<00:04,  4.76s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0199, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9035, 'compress@10': 0.6898, 'time@10': 5.8611}:  97%|█████████▋| 29/30 [02:09<00:04,  4.76s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0199, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9035, 'compress@10': 0.6898, 'time@10': 5.8611}: 100%|██████████| 30/30 [02:09<00:00,  4.97s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0199, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9035, 'compress@10': 0.6898, 'time@10': 5.8611}: 100%|██████████| 30/30 [02:09<00:00,  4.33s/it]
Epoch: 32
Avg # of users: 5.866666666666666
Avg Loss: 0.019875233345053218
Avg hit ratio: 0.8719208668015013
Avg ndcg: 0.9035122253536814
Avg compression ratio: 0.6898477341295582
Avg train time: 5.861135816574096
Std train time: 1.9352400022323473
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 26, 10, 10, 9, 6, 11, 10, 43, 43, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9179, 'compress@10': 0.692, 'time@10': 5.7552}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9179, 'compress@10': 0.692, 'time@10': 5.7552}:   3%|▎         | 1/30 [00:02<01:24,  2.92s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9972, 'compress@10': 0.6459, 'time@10': 5.2804}:   3%|▎         | 1/30 [00:07<01:24,  2.92s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9972, 'compress@10': 0.6459, 'time@10': 5.2804}:   7%|▋         | 2/30 [00:07<01:53,  4.05s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9505, 'compress@10': 0.6637, 'time@10': 4.8087}:   7%|▋         | 2/30 [00:09<01:53,  4.05s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9505, 'compress@10': 0.6637, 'time@10': 4.8087}:  10%|█         | 3/30 [00:09<01:23,  3.10s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9413, 'compress@10': 0.6642, 'time@10': 4.7657}:  10%|█         | 3/30 [00:14<01:23,  3.10s/it]  {'epoch': 33, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9413, 'compress@10': 0.6642, 'time@10': 4.7657}:  13%|█▎        | 4/30 [00:14<01:36,  3.72s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0245, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9219, 'compress@10': 0.6672, 'time@10': 5.34}:  13%|█▎        | 4/30 [00:18<01:36,  3.72s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0245, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9219, 'compress@10': 0.6672, 'time@10': 5.34}:  17%|█▋        | 5/30 [00:18<01:34,  3.77s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0252, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9277, 'compress@10': 0.6747, 'time@10': 5.6227}:  17%|█▋        | 5/30 [00:25<01:34,  3.77s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0252, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9277, 'compress@10': 0.6747, 'time@10': 5.6227}:  20%|██        | 6/30 [00:25<01:57,  4.90s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0249, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9253, 'compress@10': 0.6859, 'time@10': 5.959}:  20%|██        | 6/30 [00:29<01:57,  4.90s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.0249, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9253, 'compress@10': 0.6859, 'time@10': 5.959}:  23%|██▎       | 7/30 [00:29<01:46,  4.61s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.024, 'hit_ratio@10': 0.9142, 'ndcg@10': 0.9261, 'compress@10': 0.6996, 'time@10': 5.9159}:  23%|██▎       | 7/30 [00:35<01:46,  4.61s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.024, 'hit_ratio@10': 0.9142, 'ndcg@10': 0.9261, 'compress@10': 0.6996, 'time@10': 5.9159}:  27%|██▋       | 8/30 [00:35<01:48,  4.94s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.024, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9307, 'compress@10': 0.7017, 'time@10': 6.2611}:  27%|██▋       | 8/30 [00:39<01:48,  4.94s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.024, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9307, 'compress@10': 0.7017, 'time@10': 6.2611}:  30%|███       | 9/30 [00:39<01:41,  4.82s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9293, 'compress@10': 0.6988, 'time@10': 6.3469}:  30%|███       | 9/30 [00:46<01:41,  4.82s/it]  {'epoch': 33, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9293, 'compress@10': 0.6988, 'time@10': 6.3469}:  33%|███▎      | 10/30 [00:46<01:50,  5.54s/it]{'epoch': 33, 'num_users': 6.6364, 'loss': 0.0259, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9283, 'compress@10': 0.7009, 'time@10': 6.4534}:  33%|███▎      | 10/30 [00:50<01:50,  5.54s/it]{'epoch': 33, 'num_users': 6.6364, 'loss': 0.0259, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9283, 'compress@10': 0.7009, 'time@10': 6.4534}:  37%|███▋      | 11/30 [00:50<01:35,  5.01s/it]{'epoch': 33, 'num_users': 6.4167, 'loss': 0.0239, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9274, 'compress@10': 0.6993, 'time@10': 6.2294}:  37%|███▋      | 11/30 [00:54<01:35,  5.01s/it]{'epoch': 33, 'num_users': 6.4167, 'loss': 0.0239, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9274, 'compress@10': 0.6993, 'time@10': 6.2294}:  40%|████      | 12/30 [00:54<01:23,  4.65s/it]{'epoch': 33, 'num_users': 6.6154, 'loss': 0.0247, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9256, 'compress@10': 0.7001, 'time@10': 6.3524}:  40%|████      | 12/30 [00:58<01:23,  4.65s/it]{'epoch': 33, 'num_users': 6.6154, 'loss': 0.0247, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9256, 'compress@10': 0.7001, 'time@10': 6.3524}:  43%|████▎     | 13/30 [00:58<01:15,  4.44s/it]{'epoch': 33, 'num_users': 6.3571, 'loss': 0.023, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.919, 'compress@10': 0.6951, 'time@10': 6.1259}:  43%|████▎     | 13/30 [01:01<01:15,  4.44s/it]  {'epoch': 33, 'num_users': 6.3571, 'loss': 0.023, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.919, 'compress@10': 0.6951, 'time@10': 6.1259}:  47%|████▋     | 14/30 [01:01<01:05,  4.07s/it]{'epoch': 33, 'num_users': 6.2667, 'loss': 0.0231, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9209, 'compress@10': 0.6904, 'time@10': 6.2445}:  47%|████▋     | 14/30 [01:05<01:05,  4.07s/it]{'epoch': 33, 'num_users': 6.2667, 'loss': 0.0231, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9209, 'compress@10': 0.6904, 'time@10': 6.2445}:  50%|█████     | 15/30 [01:05<01:00,  4.05s/it]{'epoch': 33, 'num_users': 6.0625, 'loss': 0.0218, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9207, 'compress@10': 0.6886, 'time@10': 6.0809}:  50%|█████     | 15/30 [01:09<01:00,  4.05s/it]{'epoch': 33, 'num_users': 6.0625, 'loss': 0.0218, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9207, 'compress@10': 0.6886, 'time@10': 6.0809}:  53%|█████▎    | 16/30 [01:09<00:55,  3.93s/it]{'epoch': 33, 'num_users': 5.8235, 'loss': 0.0205, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.9136, 'compress@10': 0.6879, 'time@10': 5.923}:  53%|█████▎    | 16/30 [01:10<00:55,  3.93s/it] {'epoch': 33, 'num_users': 5.8235, 'loss': 0.0205, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.9136, 'compress@10': 0.6879, 'time@10': 5.923}:  57%|█████▋    | 17/30 [01:10<00:42,  3.27s/it]{'epoch': 33, 'num_users': 6.0556, 'loss': 0.0202, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.9145, 'compress@10': 0.686, 'time@10': 5.8318}:  57%|█████▋    | 17/30 [01:15<00:42,  3.27s/it]{'epoch': 33, 'num_users': 6.0556, 'loss': 0.0202, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.9145, 'compress@10': 0.686, 'time@10': 5.8318}:  60%|██████    | 18/30 [01:15<00:43,  3.59s/it]{'epoch': 33, 'num_users': 6.0, 'loss': 0.0196, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9147, 'compress@10': 0.6862, 'time@10': 5.7476}:  60%|██████    | 18/30 [01:17<00:43,  3.59s/it]  {'epoch': 33, 'num_users': 6.0, 'loss': 0.0196, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9147, 'compress@10': 0.6862, 'time@10': 5.7476}:  63%|██████▎   | 19/30 [01:17<00:34,  3.16s/it]{'epoch': 33, 'num_users': 6.15, 'loss': 0.0199, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9147, 'compress@10': 0.6857, 'time@10': 5.8851}:  63%|██████▎   | 19/30 [01:26<00:34,  3.16s/it]{'epoch': 33, 'num_users': 6.15, 'loss': 0.0199, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9147, 'compress@10': 0.6857, 'time@10': 5.8851}:  67%|██████▋   | 20/30 [01:26<00:48,  4.82s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0211, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.9129, 'compress@10': 0.6864, 'time@10': 6.0101}:  67%|██████▋   | 20/30 [01:30<00:48,  4.82s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0211, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.9129, 'compress@10': 0.6864, 'time@10': 6.0101}:  70%|███████   | 21/30 [01:30<00:42,  4.67s/it]{'epoch': 33, 'num_users': 6.1818, 'loss': 0.0215, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9135, 'compress@10': 0.6794, 'time@10': 5.9118}:  70%|███████   | 21/30 [01:34<00:42,  4.67s/it]{'epoch': 33, 'num_users': 6.1818, 'loss': 0.0215, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9135, 'compress@10': 0.6794, 'time@10': 5.9118}:  73%|███████▎  | 22/30 [01:34<00:35,  4.43s/it]{'epoch': 33, 'num_users': 6.1304, 'loss': 0.0213, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9141, 'compress@10': 0.6828, 'time@10': 5.9317}:  73%|███████▎  | 22/30 [01:37<00:35,  4.43s/it]{'epoch': 33, 'num_users': 6.1304, 'loss': 0.0213, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9141, 'compress@10': 0.6828, 'time@10': 5.9317}:  77%|███████▋  | 23/30 [01:37<00:28,  4.07s/it]{'epoch': 33, 'num_users': 5.9583, 'loss': 0.0204, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9093, 'compress@10': 0.6835, 'time@10': 5.8031}:  77%|███████▋  | 23/30 [01:40<00:28,  4.07s/it]{'epoch': 33, 'num_users': 5.9583, 'loss': 0.0204, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9093, 'compress@10': 0.6835, 'time@10': 5.8031}:  80%|████████  | 24/30 [01:40<00:22,  3.72s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0197, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8996, 'compress@10': 0.6871, 'time@10': 5.6827}:  80%|████████  | 24/30 [01:41<00:22,  3.72s/it]   {'epoch': 33, 'num_users': 5.8, 'loss': 0.0197, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8996, 'compress@10': 0.6871, 'time@10': 5.6827}:  83%|████████▎ | 25/30 [01:41<00:15,  3.03s/it]{'epoch': 33, 'num_users': 5.8077, 'loss': 0.0197, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9015, 'compress@10': 0.6882, 'time@10': 5.7595}:  83%|████████▎ | 25/30 [01:49<00:15,  3.03s/it]{'epoch': 33, 'num_users': 5.8077, 'loss': 0.0197, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9015, 'compress@10': 0.6882, 'time@10': 5.7595}:  87%|████████▋ | 26/30 [01:49<00:17,  4.44s/it]{'epoch': 33, 'num_users': 5.8889, 'loss': 0.0195, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9032, 'compress@10': 0.6883, 'time@10': 5.8001}:  87%|████████▋ | 26/30 [01:53<00:17,  4.44s/it]{'epoch': 33, 'num_users': 5.8889, 'loss': 0.0195, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9032, 'compress@10': 0.6883, 'time@10': 5.8001}:  90%|█████████ | 27/30 [01:53<00:12,  4.15s/it]{'epoch': 33, 'num_users': 6.0, 'loss': 0.0197, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9059, 'compress@10': 0.6855, 'time@10': 5.8965}:  90%|█████████ | 27/30 [02:01<00:12,  4.15s/it]   {'epoch': 33, 'num_users': 6.0, 'loss': 0.0197, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9059, 'compress@10': 0.6855, 'time@10': 5.8965}:  93%|█████████▎| 28/30 [02:01<00:10,  5.47s/it]{'epoch': 33, 'num_users': 5.8621, 'loss': 0.0199, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.905, 'compress@10': 0.6864, 'time@10': 5.9104}:  93%|█████████▎| 28/30 [02:04<00:10,  5.47s/it]{'epoch': 33, 'num_users': 5.8621, 'loss': 0.0199, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.905, 'compress@10': 0.6864, 'time@10': 5.9104}:  97%|█████████▋| 29/30 [02:04<00:04,  4.78s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0206, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9057, 'compress@10': 0.688, 'time@10': 5.9043}:  97%|█████████▋| 29/30 [02:10<00:04,  4.78s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0206, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9057, 'compress@10': 0.688, 'time@10': 5.9043}: 100%|██████████| 30/30 [02:10<00:00,  5.08s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0206, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9057, 'compress@10': 0.688, 'time@10': 5.9043}: 100%|██████████| 30/30 [02:10<00:00,  4.35s/it]
Epoch: 33
Avg # of users: 5.866666666666666
Avg Loss: 0.020578111944570564
Avg hit ratio: 0.8758969781760946
Avg ndcg: 0.9056678285178766
Avg compression ratio: 0.6880178362422533
Avg train time: 5.904274368286133
Std train time: 1.9498059201475924
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 26, 10, 10, 9, 6, 11, 10, 44, 44, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.6821, 'time@10': 6.0273}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.6821, 'time@10': 6.0273}:   3%|▎         | 1/30 [00:03<01:28,  3.05s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9256, 'compress@10': 0.5839, 'time@10': 5.494}:   3%|▎         | 1/30 [00:08<01:28,  3.05s/it]  {'epoch': 34, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9256, 'compress@10': 0.5839, 'time@10': 5.494}:   7%|▋         | 2/30 [00:08<01:57,  4.20s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9028, 'compress@10': 0.6218, 'time@10': 4.8433}:   7%|▋         | 2/30 [00:09<01:57,  4.20s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9028, 'compress@10': 0.6218, 'time@10': 4.8433}:  10%|█         | 3/30 [00:09<01:23,  3.11s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9117, 'compress@10': 0.6238, 'time@10': 4.7484}:  10%|█         | 3/30 [00:14<01:23,  3.11s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9117, 'compress@10': 0.6238, 'time@10': 4.7484}:  13%|█▎        | 4/30 [00:14<01:35,  3.66s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0191, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9001, 'compress@10': 0.633, 'time@10': 5.5253}:  13%|█▎        | 4/30 [00:18<01:35,  3.66s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 0.0191, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9001, 'compress@10': 0.633, 'time@10': 5.5253}:  17%|█▋        | 5/30 [00:18<01:37,  3.91s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0192, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9089, 'compress@10': 0.6452, 'time@10': 5.8755}:  17%|█▋        | 5/30 [00:26<01:37,  3.91s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0192, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9089, 'compress@10': 0.6452, 'time@10': 5.8755}:  20%|██        | 6/30 [00:26<02:04,  5.19s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.9182, 'ndcg@10': 0.9132, 'compress@10': 0.6576, 'time@10': 6.1629}:  20%|██        | 6/30 [00:30<02:04,  5.19s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.9182, 'ndcg@10': 0.9132, 'compress@10': 0.6576, 'time@10': 6.1629}:  23%|██▎       | 7/30 [00:30<01:50,  4.80s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.9248, 'ndcg@10': 0.9153, 'compress@10': 0.6763, 'time@10': 6.0976}:  23%|██▎       | 7/30 [00:36<01:50,  4.80s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.9248, 'ndcg@10': 0.9153, 'compress@10': 0.6763, 'time@10': 6.0976}:  27%|██▋       | 8/30 [00:36<01:51,  5.08s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.023, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9347, 'compress@10': 0.6816, 'time@10': 6.4145}:  27%|██▋       | 8/30 [00:40<01:51,  5.08s/it] {'epoch': 34, 'num_users': 6.3333, 'loss': 0.023, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9347, 'compress@10': 0.6816, 'time@10': 6.4145}:  30%|███       | 9/30 [00:40<01:42,  4.90s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9385, 'compress@10': 0.6784, 'time@10': 6.4836}:  30%|███       | 9/30 [00:47<01:42,  4.90s/it] {'epoch': 34, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9385, 'compress@10': 0.6784, 'time@10': 6.4836}:  33%|███▎      | 10/30 [00:47<01:51,  5.59s/it]{'epoch': 34, 'num_users': 6.6364, 'loss': 0.0226, 'hit_ratio@10': 0.9146, 'ndcg@10': 0.939, 'compress@10': 0.6811, 'time@10': 6.5599}:  33%|███▎      | 10/30 [00:51<01:51,  5.59s/it]{'epoch': 34, 'num_users': 6.6364, 'loss': 0.0226, 'hit_ratio@10': 0.9146, 'ndcg@10': 0.939, 'compress@10': 0.6811, 'time@10': 6.5599}:  37%|███▋      | 11/30 [00:51<01:35,  5.02s/it]{'epoch': 34, 'num_users': 6.4167, 'loss': 0.0208, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9371, 'compress@10': 0.681, 'time@10': 6.3002}:  37%|███▋      | 11/30 [00:54<01:35,  5.02s/it] {'epoch': 34, 'num_users': 6.4167, 'loss': 0.0208, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9371, 'compress@10': 0.681, 'time@10': 6.3002}:  40%|████      | 12/30 [00:54<01:21,  4.55s/it]{'epoch': 34, 'num_users': 6.6154, 'loss': 0.0209, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9344, 'compress@10': 0.6835, 'time@10': 6.3553}:  40%|████      | 12/30 [00:58<01:21,  4.55s/it]{'epoch': 34, 'num_users': 6.6154, 'loss': 0.0209, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9344, 'compress@10': 0.6835, 'time@10': 6.3553}:  43%|████▎     | 13/30 [00:58<01:12,  4.25s/it]{'epoch': 34, 'num_users': 6.3571, 'loss': 0.0194, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9272, 'compress@10': 0.6793, 'time@10': 6.1366}:  43%|████▎     | 13/30 [01:01<01:12,  4.25s/it]{'epoch': 34, 'num_users': 6.3571, 'loss': 0.0194, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9272, 'compress@10': 0.6793, 'time@10': 6.1366}:  47%|████▋     | 14/30 [01:01<01:03,  3.97s/it]{'epoch': 34, 'num_users': 6.2667, 'loss': 0.0208, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9224, 'compress@10': 0.6763, 'time@10': 6.2573}:  47%|████▋     | 14/30 [01:05<01:03,  3.97s/it]{'epoch': 34, 'num_users': 6.2667, 'loss': 0.0208, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9224, 'compress@10': 0.6763, 'time@10': 6.2573}:  50%|█████     | 15/30 [01:05<00:59,  3.98s/it]{'epoch': 34, 'num_users': 6.0625, 'loss': 0.0196, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.922, 'compress@10': 0.6755, 'time@10': 6.0915}:  50%|█████     | 15/30 [01:09<00:59,  3.98s/it] {'epoch': 34, 'num_users': 6.0625, 'loss': 0.0196, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.922, 'compress@10': 0.6755, 'time@10': 6.0915}:  53%|█████▎    | 16/30 [01:09<00:54,  3.88s/it]{'epoch': 34, 'num_users': 5.8235, 'loss': 0.0185, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9149, 'compress@10': 0.6759, 'time@10': 5.9312}:  53%|█████▎    | 16/30 [01:11<00:54,  3.88s/it]{'epoch': 34, 'num_users': 5.8235, 'loss': 0.0185, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9149, 'compress@10': 0.6759, 'time@10': 5.9312}:  57%|█████▋    | 17/30 [01:11<00:42,  3.23s/it]{'epoch': 34, 'num_users': 6.0556, 'loss': 0.0184, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9157, 'compress@10': 0.6756, 'time@10': 5.8523}:  57%|█████▋    | 17/30 [01:15<00:42,  3.23s/it]{'epoch': 34, 'num_users': 6.0556, 'loss': 0.0184, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9157, 'compress@10': 0.6756, 'time@10': 5.8523}:  60%|██████    | 18/30 [01:15<00:43,  3.63s/it]{'epoch': 34, 'num_users': 6.0, 'loss': 0.0179, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9161, 'compress@10': 0.676, 'time@10': 5.7437}:  60%|██████    | 18/30 [01:17<00:43,  3.63s/it]    {'epoch': 34, 'num_users': 6.0, 'loss': 0.0179, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9161, 'compress@10': 0.676, 'time@10': 5.7437}:  63%|██████▎   | 19/30 [01:17<00:34,  3.12s/it]{'epoch': 34, 'num_users': 6.15, 'loss': 0.0181, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9165, 'compress@10': 0.6749, 'time@10': 5.8792}:  63%|██████▎   | 19/30 [01:26<00:34,  3.12s/it]{'epoch': 34, 'num_users': 6.15, 'loss': 0.0181, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9165, 'compress@10': 0.6749, 'time@10': 5.8792}:  67%|██████▋   | 20/30 [01:26<00:47,  4.73s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9148, 'compress@10': 0.6758, 'time@10': 5.9886}:  67%|██████▋   | 20/30 [01:30<00:47,  4.73s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9148, 'compress@10': 0.6758, 'time@10': 5.9886}:  70%|███████   | 21/30 [01:30<00:40,  4.55s/it]{'epoch': 34, 'num_users': 6.1818, 'loss': 0.0195, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9139, 'compress@10': 0.6682, 'time@10': 5.8881}:  70%|███████   | 21/30 [01:34<00:40,  4.55s/it]{'epoch': 34, 'num_users': 6.1818, 'loss': 0.0195, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9139, 'compress@10': 0.6682, 'time@10': 5.8881}:  73%|███████▎  | 22/30 [01:34<00:34,  4.33s/it]{'epoch': 34, 'num_users': 6.1304, 'loss': 0.0193, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9144, 'compress@10': 0.6717, 'time@10': 5.9033}:  73%|███████▎  | 22/30 [01:37<00:34,  4.33s/it]{'epoch': 34, 'num_users': 6.1304, 'loss': 0.0193, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9144, 'compress@10': 0.6717, 'time@10': 5.9033}:  77%|███████▋  | 23/30 [01:37<00:27,  3.98s/it]{'epoch': 34, 'num_users': 5.9583, 'loss': 0.0186, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9096, 'compress@10': 0.6726, 'time@10': 5.7775}:  77%|███████▋  | 23/30 [01:40<00:27,  3.98s/it]{'epoch': 34, 'num_users': 5.9583, 'loss': 0.0186, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9096, 'compress@10': 0.6726, 'time@10': 5.7775}:  80%|████████  | 24/30 [01:40<00:21,  3.66s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0179, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8999, 'compress@10': 0.6765, 'time@10': 5.663}:  80%|████████  | 24/30 [01:41<00:21,  3.66s/it]    {'epoch': 34, 'num_users': 5.8, 'loss': 0.0179, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8999, 'compress@10': 0.6765, 'time@10': 5.663}:  83%|████████▎ | 25/30 [01:41<00:15,  3.01s/it]{'epoch': 34, 'num_users': 5.8077, 'loss': 0.0179, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9018, 'compress@10': 0.6771, 'time@10': 5.7328}:  83%|████████▎ | 25/30 [01:49<00:15,  3.01s/it]{'epoch': 34, 'num_users': 5.8077, 'loss': 0.0179, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9018, 'compress@10': 0.6771, 'time@10': 5.7328}:  87%|████████▋ | 26/30 [01:49<00:17,  4.37s/it]{'epoch': 34, 'num_users': 5.8889, 'loss': 0.0181, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9038, 'compress@10': 0.6779, 'time@10': 5.7851}:  87%|████████▋ | 26/30 [01:52<00:17,  4.37s/it]{'epoch': 34, 'num_users': 5.8889, 'loss': 0.0181, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9038, 'compress@10': 0.6779, 'time@10': 5.7851}:  90%|█████████ | 27/30 [01:52<00:12,  4.14s/it]{'epoch': 34, 'num_users': 6.0, 'loss': 0.0189, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9051, 'compress@10': 0.6758, 'time@10': 5.8866}:  90%|█████████ | 27/30 [02:01<00:12,  4.14s/it]   {'epoch': 34, 'num_users': 6.0, 'loss': 0.0189, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9051, 'compress@10': 0.6758, 'time@10': 5.8866}:  93%|█████████▎| 28/30 [02:01<00:10,  5.50s/it]{'epoch': 34, 'num_users': 5.8621, 'loss': 0.0189, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9066, 'compress@10': 0.6766, 'time@10': 5.8936}:  93%|█████████▎| 28/30 [02:04<00:10,  5.50s/it]{'epoch': 34, 'num_users': 5.8621, 'loss': 0.0189, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9066, 'compress@10': 0.6766, 'time@10': 5.8936}:  97%|█████████▋| 29/30 [02:04<00:04,  4.77s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.0197, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9093, 'compress@10': 0.6783, 'time@10': 5.8886}:  97%|█████████▋| 29/30 [02:10<00:04,  4.77s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.0197, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9093, 'compress@10': 0.6783, 'time@10': 5.8886}: 100%|██████████| 30/30 [02:10<00:00,  5.08s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.0197, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9093, 'compress@10': 0.6783, 'time@10': 5.8886}: 100%|██████████| 30/30 [02:10<00:00,  4.35s/it]
Epoch: 34
Avg # of users: 5.866666666666666
Avg Loss: 0.01973523463782152
Avg hit ratio: 0.8790977933293715
Avg ndcg: 0.9093470211837272
Avg compression ratio: 0.678289713829358
Avg train time: 5.888581220308939
Std train time: 1.9831870406150682
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 26, 10, 10, 9, 6, 11, 10, 45, 45, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.6779, 'time@10': 5.5655}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.6779, 'time@10': 5.5655}:   3%|▎         | 1/30 [00:02<01:22,  2.83s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.893, 'ndcg@10': 1.0058, 'compress@10': 0.6361, 'time@10': 5.2792}:   3%|▎         | 1/30 [00:07<01:22,  2.83s/it] {'epoch': 35, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.893, 'ndcg@10': 1.0058, 'compress@10': 0.6361, 'time@10': 5.2792}:   7%|▋         | 2/30 [00:07<01:55,  4.13s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9562, 'compress@10': 0.6535, 'time@10': 4.8505}:   7%|▋         | 2/30 [00:09<01:55,  4.13s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9562, 'compress@10': 0.6535, 'time@10': 4.8505}:  10%|█         | 3/30 [00:09<01:25,  3.17s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9462, 'compress@10': 0.6356, 'time@10': 4.7505}:  10%|█         | 3/30 [00:14<01:25,  3.17s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9462, 'compress@10': 0.6356, 'time@10': 4.7505}:  13%|█▎        | 4/30 [00:14<01:35,  3.69s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0274, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9284, 'compress@10': 0.6432, 'time@10': 5.4424}:  13%|█▎        | 4/30 [00:18<01:35,  3.69s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0274, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9284, 'compress@10': 0.6432, 'time@10': 5.4424}:  17%|█▋        | 5/30 [00:18<01:36,  3.86s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0295, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9343, 'compress@10': 0.6465, 'time@10': 5.7789}:  17%|█▋        | 5/30 [00:26<01:36,  3.86s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0295, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9343, 'compress@10': 0.6465, 'time@10': 5.7789}:  20%|██        | 6/30 [00:26<02:02,  5.10s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0277, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9363, 'compress@10': 0.6585, 'time@10': 6.1741}:  20%|██        | 6/30 [00:30<02:02,  5.10s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0277, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9363, 'compress@10': 0.6585, 'time@10': 6.1741}:  23%|██▎       | 7/30 [00:30<01:51,  4.84s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0265, 'hit_ratio@10': 0.9204, 'ndcg@10': 0.9381, 'compress@10': 0.6772, 'time@10': 6.0991}:  23%|██▎       | 7/30 [00:35<01:51,  4.84s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0265, 'hit_ratio@10': 0.9204, 'ndcg@10': 0.9381, 'compress@10': 0.6772, 'time@10': 6.0991}:  27%|██▋       | 8/30 [00:35<01:51,  5.09s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0272, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9362, 'compress@10': 0.6815, 'time@10': 6.4113}:  27%|██▋       | 8/30 [00:40<01:51,  5.09s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0272, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9362, 'compress@10': 0.6815, 'time@10': 6.4113}:  30%|███       | 9/30 [00:40<01:42,  4.90s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.941, 'compress@10': 0.679, 'time@10': 6.4829}:  30%|███       | 9/30 [00:47<01:42,  4.90s/it]     {'epoch': 35, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.941, 'compress@10': 0.679, 'time@10': 6.4829}:  33%|███▎      | 10/30 [00:47<01:52,  5.60s/it]{'epoch': 35, 'num_users': 6.6364, 'loss': 0.0273, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9391, 'compress@10': 0.6802, 'time@10': 6.579}:  33%|███▎      | 10/30 [00:51<01:52,  5.60s/it]{'epoch': 35, 'num_users': 6.6364, 'loss': 0.0273, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9391, 'compress@10': 0.6802, 'time@10': 6.579}:  37%|███▋      | 11/30 [00:51<01:36,  5.05s/it]{'epoch': 35, 'num_users': 6.4167, 'loss': 0.0252, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.9373, 'compress@10': 0.681, 'time@10': 6.3189}:  37%|███▋      | 11/30 [00:54<01:36,  5.05s/it]{'epoch': 35, 'num_users': 6.4167, 'loss': 0.0252, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.9373, 'compress@10': 0.681, 'time@10': 6.3189}:  40%|████      | 12/30 [00:54<01:22,  4.58s/it]{'epoch': 35, 'num_users': 6.6154, 'loss': 0.0249, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9352, 'compress@10': 0.6836, 'time@10': 6.4244}:  40%|████      | 12/30 [00:58<01:22,  4.58s/it]{'epoch': 35, 'num_users': 6.6154, 'loss': 0.0249, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9352, 'compress@10': 0.6836, 'time@10': 6.4244}:  43%|████▎     | 13/30 [00:58<01:14,  4.38s/it]{'epoch': 35, 'num_users': 6.3571, 'loss': 0.0232, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9279, 'compress@10': 0.6799, 'time@10': 6.208}:  43%|████▎     | 13/30 [01:02<01:14,  4.38s/it]  {'epoch': 35, 'num_users': 6.3571, 'loss': 0.0232, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9279, 'compress@10': 0.6799, 'time@10': 6.208}:  47%|████▋     | 14/30 [01:02<01:05,  4.10s/it]{'epoch': 35, 'num_users': 6.2667, 'loss': 0.0227, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9289, 'compress@10': 0.6768, 'time@10': 6.3233}:  47%|████▋     | 14/30 [01:06<01:05,  4.10s/it]{'epoch': 35, 'num_users': 6.2667, 'loss': 0.0227, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9289, 'compress@10': 0.6768, 'time@10': 6.3233}:  50%|█████     | 15/30 [01:06<01:01,  4.07s/it]{'epoch': 35, 'num_users': 6.0625, 'loss': 0.0216, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9282, 'compress@10': 0.6755, 'time@10': 6.1533}:  50%|█████     | 15/30 [01:09<01:01,  4.07s/it]{'epoch': 35, 'num_users': 6.0625, 'loss': 0.0216, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9282, 'compress@10': 0.6755, 'time@10': 6.1533}:  53%|█████▎    | 16/30 [01:09<00:55,  3.94s/it]{'epoch': 35, 'num_users': 5.8235, 'loss': 0.0204, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9206, 'compress@10': 0.6759, 'time@10': 5.99}:  53%|█████▎    | 16/30 [01:11<00:55,  3.94s/it]  {'epoch': 35, 'num_users': 5.8235, 'loss': 0.0204, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9206, 'compress@10': 0.6759, 'time@10': 5.99}:  57%|█████▋    | 17/30 [01:11<00:42,  3.28s/it]{'epoch': 35, 'num_users': 6.0556, 'loss': 0.0206, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9221, 'compress@10': 0.6755, 'time@10': 5.8847}:  57%|█████▋    | 17/30 [01:15<00:42,  3.28s/it]{'epoch': 35, 'num_users': 6.0556, 'loss': 0.0206, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9221, 'compress@10': 0.6755, 'time@10': 5.8847}:  60%|██████    | 18/30 [01:15<00:42,  3.53s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 0.0201, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9219, 'compress@10': 0.6762, 'time@10': 5.7887}:  60%|██████    | 18/30 [01:17<00:42,  3.53s/it]   {'epoch': 35, 'num_users': 6.0, 'loss': 0.0201, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9219, 'compress@10': 0.6762, 'time@10': 5.7887}:  63%|██████▎   | 19/30 [01:17<00:34,  3.10s/it]{'epoch': 35, 'num_users': 6.15, 'loss': 0.0201, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9226, 'compress@10': 0.6744, 'time@10': 5.9107}:  63%|██████▎   | 19/30 [01:26<00:34,  3.10s/it]{'epoch': 35, 'num_users': 6.15, 'loss': 0.0201, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9226, 'compress@10': 0.6744, 'time@10': 5.9107}:  67%|██████▋   | 20/30 [01:26<00:46,  4.65s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0207, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9215, 'compress@10': 0.675, 'time@10': 5.9995}:  67%|██████▋   | 20/30 [01:30<00:46,  4.65s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0207, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9215, 'compress@10': 0.675, 'time@10': 5.9995}:  70%|███████   | 21/30 [01:30<00:39,  4.43s/it]{'epoch': 35, 'num_users': 6.1818, 'loss': 0.0212, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9209, 'compress@10': 0.6669, 'time@10': 5.8949}:  70%|███████   | 21/30 [01:33<00:39,  4.43s/it]{'epoch': 35, 'num_users': 6.1818, 'loss': 0.0212, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9209, 'compress@10': 0.6669, 'time@10': 5.8949}:  73%|███████▎  | 22/30 [01:33<00:33,  4.22s/it]{'epoch': 35, 'num_users': 6.1304, 'loss': 0.0211, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9214, 'compress@10': 0.6703, 'time@10': 5.9058}:  73%|███████▎  | 22/30 [01:36<00:33,  4.22s/it]{'epoch': 35, 'num_users': 6.1304, 'loss': 0.0211, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9214, 'compress@10': 0.6703, 'time@10': 5.9058}:  77%|███████▋  | 23/30 [01:36<00:27,  3.89s/it]{'epoch': 35, 'num_users': 5.9583, 'loss': 0.0202, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9163, 'compress@10': 0.6712, 'time@10': 5.7836}:  77%|███████▋  | 23/30 [01:39<00:27,  3.89s/it]{'epoch': 35, 'num_users': 5.9583, 'loss': 0.0202, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9163, 'compress@10': 0.6712, 'time@10': 5.7836}:  80%|████████  | 24/30 [01:39<00:21,  3.63s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9063, 'compress@10': 0.6754, 'time@10': 5.6703}:  80%|████████  | 24/30 [01:41<00:21,  3.63s/it]   {'epoch': 35, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9063, 'compress@10': 0.6754, 'time@10': 5.6703}:  83%|████████▎ | 25/30 [01:41<00:14,  2.99s/it]{'epoch': 35, 'num_users': 5.8077, 'loss': 0.0194, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.9082, 'compress@10': 0.6756, 'time@10': 5.739}:  83%|████████▎ | 25/30 [01:48<00:14,  2.99s/it]{'epoch': 35, 'num_users': 5.8077, 'loss': 0.0194, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.9082, 'compress@10': 0.6756, 'time@10': 5.739}:  87%|████████▋ | 26/30 [01:48<00:17,  4.35s/it]{'epoch': 35, 'num_users': 5.8889, 'loss': 0.02, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9115, 'compress@10': 0.676, 'time@10': 5.7833}:  87%|████████▋ | 26/30 [01:52<00:17,  4.35s/it]   {'epoch': 35, 'num_users': 5.8889, 'loss': 0.02, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9115, 'compress@10': 0.676, 'time@10': 5.7833}:  90%|█████████ | 27/30 [01:52<00:12,  4.09s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 0.0199, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9129, 'compress@10': 0.6755, 'time@10': 5.8714}:  90%|█████████ | 27/30 [02:00<00:12,  4.09s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 0.0199, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9129, 'compress@10': 0.6755, 'time@10': 5.8714}:  93%|█████████▎| 28/30 [02:00<00:10,  5.35s/it]{'epoch': 35, 'num_users': 5.8621, 'loss': 0.0197, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9142, 'compress@10': 0.6762, 'time@10': 5.8722}:  93%|█████████▎| 28/30 [02:03<00:10,  5.35s/it]{'epoch': 35, 'num_users': 5.8621, 'loss': 0.0197, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9142, 'compress@10': 0.6762, 'time@10': 5.8722}:  97%|█████████▋| 29/30 [02:03<00:04,  4.64s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0197, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9153, 'compress@10': 0.6785, 'time@10': 5.8833}:  97%|█████████▋| 29/30 [02:09<00:04,  4.64s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0197, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9153, 'compress@10': 0.6785, 'time@10': 5.8833}: 100%|██████████| 30/30 [02:09<00:00,  5.12s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0197, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9153, 'compress@10': 0.6785, 'time@10': 5.8833}: 100%|██████████| 30/30 [02:09<00:00,  4.33s/it]
Epoch: 35
Avg # of users: 5.866666666666666
Avg Loss: 0.019674119710611247
Avg hit ratio: 0.8765859958175741
Avg ndcg: 0.9153124201995925
Avg compression ratio: 0.6784959597280846
Avg train time: 5.883275405565898
Std train time: 1.939967108457974
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 26, 10, 10, 9, 6, 11, 10, 46, 46, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.6714, 'time@10': 5.851}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.6714, 'time@10': 5.851}:   3%|▎         | 1/30 [00:02<01:25,  2.96s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.93, 'compress@10': 0.5677, 'time@10': 5.3903}:   3%|▎         | 1/30 [00:07<01:25,  2.96s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.93, 'compress@10': 0.5677, 'time@10': 5.3903}:   7%|▋         | 2/30 [00:07<01:56,  4.14s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9057, 'compress@10': 0.6076, 'time@10': 4.731}:   7%|▋         | 2/30 [00:09<01:56,  4.14s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9057, 'compress@10': 0.6076, 'time@10': 4.731}:  10%|█         | 3/30 [00:09<01:22,  3.05s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.901, 'ndcg@10': 0.8808, 'compress@10': 0.6063, 'time@10': 4.5812}:  10%|█         | 3/30 [00:13<01:22,  3.05s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.901, 'ndcg@10': 0.8808, 'compress@10': 0.6063, 'time@10': 4.5812}:  13%|█▎        | 4/30 [00:13<01:30,  3.50s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0223, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.8782, 'compress@10': 0.6188, 'time@10': 5.3204}:  13%|█▎        | 4/30 [00:18<01:30,  3.50s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0223, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.8782, 'compress@10': 0.6188, 'time@10': 5.3204}:  17%|█▋        | 5/30 [00:18<01:33,  3.74s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0203, 'hit_ratio@10': 0.9129, 'ndcg@10': 0.8915, 'compress@10': 0.624, 'time@10': 5.685}:  17%|█▋        | 5/30 [00:25<01:33,  3.74s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0203, 'hit_ratio@10': 0.9129, 'ndcg@10': 0.8915, 'compress@10': 0.624, 'time@10': 5.685}:  20%|██        | 6/30 [00:25<02:00,  5.04s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0235, 'hit_ratio@10': 0.9196, 'ndcg@10': 0.8865, 'compress@10': 0.6386, 'time@10': 6.0072}:  20%|██        | 6/30 [00:29<02:00,  5.04s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0235, 'hit_ratio@10': 0.9196, 'ndcg@10': 0.8865, 'compress@10': 0.6386, 'time@10': 6.0072}:  23%|██▎       | 7/30 [00:29<01:48,  4.70s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0246, 'hit_ratio@10': 0.9261, 'ndcg@10': 0.8955, 'compress@10': 0.658, 'time@10': 5.9523}:  23%|██▎       | 7/30 [00:35<01:48,  4.70s/it]  {'epoch': 36, 'num_users': 6.125, 'loss': 0.0246, 'hit_ratio@10': 0.9261, 'ndcg@10': 0.8955, 'compress@10': 0.658, 'time@10': 5.9523}:  27%|██▋       | 8/30 [00:35<01:49,  4.99s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0229, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9022, 'compress@10': 0.6605, 'time@10': 6.2823}:  27%|██▋       | 8/30 [00:39<01:49,  4.99s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0229, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9022, 'compress@10': 0.6605, 'time@10': 6.2823}:  30%|███       | 9/30 [00:39<01:41,  4.84s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.9215, 'ndcg@10': 0.9066, 'compress@10': 0.657, 'time@10': 6.3649}:  30%|███       | 9/30 [00:46<01:41,  4.84s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.9215, 'ndcg@10': 0.9066, 'compress@10': 0.657, 'time@10': 6.3649}:  33%|███▎      | 10/30 [00:46<01:51,  5.55s/it]{'epoch': 36, 'num_users': 6.6364, 'loss': 0.0233, 'hit_ratio@10': 0.9216, 'ndcg@10': 0.9086, 'compress@10': 0.6596, 'time@10': 6.47}:  33%|███▎      | 10/30 [00:50<01:51,  5.55s/it]{'epoch': 36, 'num_users': 6.6364, 'loss': 0.0233, 'hit_ratio@10': 0.9216, 'ndcg@10': 0.9086, 'compress@10': 0.6596, 'time@10': 6.47}:  37%|███▋      | 11/30 [00:50<01:35,  5.02s/it]{'epoch': 36, 'num_users': 6.4167, 'loss': 0.0215, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9093, 'compress@10': 0.662, 'time@10': 6.2569}:  37%|███▋      | 11/30 [00:54<01:35,  5.02s/it]{'epoch': 36, 'num_users': 6.4167, 'loss': 0.0215, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9093, 'compress@10': 0.662, 'time@10': 6.2569}:  40%|████      | 12/30 [00:54<01:24,  4.69s/it]{'epoch': 36, 'num_users': 6.6154, 'loss': 0.0218, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.909, 'compress@10': 0.6689, 'time@10': 6.3168}:  40%|████      | 12/30 [00:58<01:24,  4.69s/it]{'epoch': 36, 'num_users': 6.6154, 'loss': 0.0218, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.909, 'compress@10': 0.6689, 'time@10': 6.3168}:  43%|████▎     | 13/30 [00:58<01:14,  4.37s/it]{'epoch': 36, 'num_users': 6.3571, 'loss': 0.0203, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9036, 'compress@10': 0.6667, 'time@10': 6.1016}:  43%|████▎     | 13/30 [01:01<01:14,  4.37s/it]{'epoch': 36, 'num_users': 6.3571, 'loss': 0.0203, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9036, 'compress@10': 0.6667, 'time@10': 6.1016}:  47%|████▋     | 14/30 [01:01<01:04,  4.06s/it]{'epoch': 36, 'num_users': 6.2667, 'loss': 0.0214, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.8996, 'compress@10': 0.6647, 'time@10': 6.2207}:  47%|████▋     | 14/30 [01:05<01:04,  4.06s/it]{'epoch': 36, 'num_users': 6.2667, 'loss': 0.0214, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.8996, 'compress@10': 0.6647, 'time@10': 6.2207}:  50%|█████     | 15/30 [01:05<01:00,  4.04s/it]{'epoch': 36, 'num_users': 6.0625, 'loss': 0.0201, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9007, 'compress@10': 0.6641, 'time@10': 6.0589}:  50%|█████     | 15/30 [01:09<01:00,  4.04s/it]{'epoch': 36, 'num_users': 6.0625, 'loss': 0.0201, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9007, 'compress@10': 0.6641, 'time@10': 6.0589}:  53%|█████▎    | 16/30 [01:09<00:54,  3.93s/it]{'epoch': 36, 'num_users': 5.8235, 'loss': 0.0189, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8948, 'compress@10': 0.6655, 'time@10': 5.9019}:  53%|█████▎    | 16/30 [01:10<00:54,  3.93s/it]{'epoch': 36, 'num_users': 5.8235, 'loss': 0.0189, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8948, 'compress@10': 0.6655, 'time@10': 5.9019}:  57%|█████▋    | 17/30 [01:10<00:42,  3.27s/it]{'epoch': 36, 'num_users': 6.0556, 'loss': 0.0189, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.8972, 'compress@10': 0.6643, 'time@10': 5.8112}:  57%|█████▋    | 17/30 [01:15<00:42,  3.27s/it]{'epoch': 36, 'num_users': 6.0556, 'loss': 0.0189, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.8972, 'compress@10': 0.6643, 'time@10': 5.8112}:  60%|██████    | 18/30 [01:15<00:42,  3.58s/it]{'epoch': 36, 'num_users': 6.0, 'loss': 0.0183, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8986, 'compress@10': 0.6653, 'time@10': 5.7078}:  60%|██████    | 18/30 [01:17<00:42,  3.58s/it]   {'epoch': 36, 'num_users': 6.0, 'loss': 0.0183, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8986, 'compress@10': 0.6653, 'time@10': 5.7078}:  63%|██████▎   | 19/30 [01:17<00:34,  3.10s/it]{'epoch': 36, 'num_users': 6.15, 'loss': 0.0186, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9, 'compress@10': 0.6638, 'time@10': 5.8413}:  63%|██████▎   | 19/30 [01:25<00:34,  3.10s/it]  {'epoch': 36, 'num_users': 6.15, 'loss': 0.0186, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9, 'compress@10': 0.6638, 'time@10': 5.8413}:  67%|██████▋   | 20/30 [01:25<00:46,  4.70s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0197, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9001, 'compress@10': 0.6652, 'time@10': 5.9533}:  67%|██████▋   | 20/30 [01:29<00:46,  4.70s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0197, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9001, 'compress@10': 0.6652, 'time@10': 5.9533}:  70%|███████   | 21/30 [01:29<00:40,  4.53s/it]{'epoch': 36, 'num_users': 6.1818, 'loss': 0.0199, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9016, 'compress@10': 0.6576, 'time@10': 5.8506}:  70%|███████   | 21/30 [01:33<00:40,  4.53s/it]{'epoch': 36, 'num_users': 6.1818, 'loss': 0.0199, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9016, 'compress@10': 0.6576, 'time@10': 5.8506}:  73%|███████▎  | 22/30 [01:33<00:34,  4.29s/it]{'epoch': 36, 'num_users': 6.1304, 'loss': 0.0196, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9033, 'compress@10': 0.6608, 'time@10': 5.8734}:  73%|███████▎  | 22/30 [01:36<00:34,  4.29s/it]{'epoch': 36, 'num_users': 6.1304, 'loss': 0.0196, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9033, 'compress@10': 0.6608, 'time@10': 5.8734}:  77%|███████▋  | 23/30 [01:36<00:27,  3.97s/it]{'epoch': 36, 'num_users': 5.9583, 'loss': 0.0188, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.899, 'compress@10': 0.662, 'time@10': 5.7513}:  77%|███████▋  | 23/30 [01:39<00:27,  3.97s/it]  {'epoch': 36, 'num_users': 5.9583, 'loss': 0.0188, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.899, 'compress@10': 0.662, 'time@10': 5.7513}:  80%|████████  | 24/30 [01:39<00:22,  3.68s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.8897, 'compress@10': 0.6665, 'time@10': 5.6315}:  80%|████████  | 24/30 [01:41<00:22,  3.68s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.8897, 'compress@10': 0.6665, 'time@10': 5.6315}:  83%|████████▎ | 25/30 [01:41<00:14,  3.00s/it]{'epoch': 36, 'num_users': 5.8077, 'loss': 0.0181, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8923, 'compress@10': 0.6664, 'time@10': 5.7122}:  83%|████████▎ | 25/30 [01:48<00:14,  3.00s/it]{'epoch': 36, 'num_users': 5.8077, 'loss': 0.0181, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8923, 'compress@10': 0.6664, 'time@10': 5.7122}:  87%|████████▋ | 26/30 [01:48<00:17,  4.43s/it]{'epoch': 36, 'num_users': 5.8889, 'loss': 0.0191, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.8915, 'compress@10': 0.6676, 'time@10': 5.769}:  87%|████████▋ | 26/30 [01:52<00:17,  4.43s/it] {'epoch': 36, 'num_users': 5.8889, 'loss': 0.0191, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.8915, 'compress@10': 0.6676, 'time@10': 5.769}:  90%|█████████ | 27/30 [01:52<00:12,  4.20s/it]{'epoch': 36, 'num_users': 6.0, 'loss': 0.0199, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8931, 'compress@10': 0.667, 'time@10': 5.8504}:  90%|█████████ | 27/30 [02:00<00:12,  4.20s/it]   {'epoch': 36, 'num_users': 6.0, 'loss': 0.0199, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8931, 'compress@10': 0.667, 'time@10': 5.8504}:  93%|█████████▎| 28/30 [02:00<00:10,  5.37s/it]{'epoch': 36, 'num_users': 5.8621, 'loss': 0.0198, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.8955, 'compress@10': 0.6679, 'time@10': 5.8716}:  93%|█████████▎| 28/30 [02:04<00:10,  5.37s/it]{'epoch': 36, 'num_users': 5.8621, 'loss': 0.0198, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.8955, 'compress@10': 0.6679, 'time@10': 5.8716}:  97%|█████████▋| 29/30 [02:04<00:04,  4.74s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0199, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.8982, 'compress@10': 0.6701, 'time@10': 5.8766}:  97%|█████████▋| 29/30 [02:10<00:04,  4.74s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0199, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.8982, 'compress@10': 0.6701, 'time@10': 5.8766}: 100%|██████████| 30/30 [02:10<00:00,  5.14s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0199, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.8982, 'compress@10': 0.6701, 'time@10': 5.8766}: 100%|██████████| 30/30 [02:10<00:00,  4.34s/it]
Epoch: 36
Avg # of users: 5.866666666666666
Avg Loss: 0.019892993523963183
Avg hit ratio: 0.8832988339308844
Avg ndcg: 0.8982189605274021
Avg compression ratio: 0.6701365411736028
Avg train time: 5.876642719904582
Std train time: 1.9617685402558593
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 26, 10, 10, 9, 6, 11, 10, 47, 47, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.6695, 'time@10': 6.0007}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.6695, 'time@10': 6.0007}:   3%|▎         | 1/30 [00:03<01:28,  3.04s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0292, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9889, 'compress@10': 0.6362, 'time@10': 5.4677}:   3%|▎         | 1/30 [00:08<01:28,  3.04s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0292, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9889, 'compress@10': 0.6362, 'time@10': 5.4677}:   7%|▋         | 2/30 [00:08<01:56,  4.18s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.945, 'compress@10': 0.6488, 'time@10': 4.8361}:   7%|▋         | 2/30 [00:09<01:56,  4.18s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.945, 'compress@10': 0.6488, 'time@10': 4.8361}:  10%|█         | 3/30 [00:09<01:23,  3.10s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9368, 'compress@10': 0.6249, 'time@10': 4.7705}:  10%|█         | 3/30 [00:14<01:23,  3.10s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9368, 'compress@10': 0.6249, 'time@10': 4.7705}:  13%|█▎        | 4/30 [00:14<01:36,  3.70s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9228, 'compress@10': 0.6349, 'time@10': 5.4339}:  13%|█▎        | 4/30 [00:18<01:36,  3.70s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9228, 'compress@10': 0.6349, 'time@10': 5.4339}:  17%|█▋        | 5/30 [00:18<01:35,  3.84s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0263, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9286, 'compress@10': 0.6308, 'time@10': 5.7211}:  17%|█▋        | 5/30 [00:25<01:35,  3.84s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0263, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9286, 'compress@10': 0.6308, 'time@10': 5.7211}:  20%|██        | 6/30 [00:25<01:59,  4.98s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0248, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9274, 'compress@10': 0.6432, 'time@10': 6.029}:  20%|██        | 6/30 [00:29<01:59,  4.98s/it] {'epoch': 37, 'num_users': 6.2857, 'loss': 0.0248, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9274, 'compress@10': 0.6432, 'time@10': 6.029}:  23%|██▎       | 7/30 [00:29<01:47,  4.65s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9316, 'compress@10': 0.6599, 'time@10': 5.955}:  23%|██▎       | 7/30 [00:35<01:47,  4.65s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9316, 'compress@10': 0.6599, 'time@10': 5.955}:  27%|██▋       | 8/30 [00:35<01:48,  4.91s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0239, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9487, 'compress@10': 0.6606, 'time@10': 6.2785}:  27%|██▋       | 8/30 [00:39<01:48,  4.91s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0239, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9487, 'compress@10': 0.6606, 'time@10': 6.2785}:  30%|███       | 9/30 [00:39<01:40,  4.78s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9512, 'compress@10': 0.6574, 'time@10': 6.3481}:  30%|███       | 9/30 [00:46<01:40,  4.78s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9512, 'compress@10': 0.6574, 'time@10': 6.3481}:  33%|███▎      | 10/30 [00:46<01:49,  5.47s/it]{'epoch': 37, 'num_users': 6.6364, 'loss': 0.023, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9496, 'compress@10': 0.6596, 'time@10': 6.4623}:  33%|███▎      | 10/30 [00:50<01:49,  5.47s/it]{'epoch': 37, 'num_users': 6.6364, 'loss': 0.023, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9496, 'compress@10': 0.6596, 'time@10': 6.4623}:  37%|███▋      | 11/30 [00:50<01:34,  4.97s/it]{'epoch': 37, 'num_users': 6.4167, 'loss': 0.0213, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9468, 'compress@10': 0.6617, 'time@10': 6.2094}:  37%|███▋      | 11/30 [00:53<01:34,  4.97s/it]{'epoch': 37, 'num_users': 6.4167, 'loss': 0.0213, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9468, 'compress@10': 0.6617, 'time@10': 6.2094}:  40%|████      | 12/30 [00:53<01:21,  4.51s/it]{'epoch': 37, 'num_users': 6.6154, 'loss': 0.0213, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9444, 'compress@10': 0.6635, 'time@10': 6.2676}:  40%|████      | 12/30 [00:57<01:21,  4.51s/it]{'epoch': 37, 'num_users': 6.6154, 'loss': 0.0213, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9444, 'compress@10': 0.6635, 'time@10': 6.2676}:  43%|████▎     | 13/30 [00:57<01:11,  4.21s/it]{'epoch': 37, 'num_users': 6.3571, 'loss': 0.0198, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9364, 'compress@10': 0.6621, 'time@10': 6.0547}:  43%|████▎     | 13/30 [01:00<01:11,  4.21s/it]{'epoch': 37, 'num_users': 6.3571, 'loss': 0.0198, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9364, 'compress@10': 0.6621, 'time@10': 6.0547}:  47%|████▋     | 14/30 [01:00<01:03,  3.95s/it]{'epoch': 37, 'num_users': 6.2667, 'loss': 0.0191, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9372, 'compress@10': 0.6603, 'time@10': 6.1833}:  47%|████▋     | 14/30 [01:04<01:03,  3.95s/it]{'epoch': 37, 'num_users': 6.2667, 'loss': 0.0191, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9372, 'compress@10': 0.6603, 'time@10': 6.1833}:  50%|█████     | 15/30 [01:04<00:59,  3.97s/it]{'epoch': 37, 'num_users': 6.0625, 'loss': 0.0181, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.936, 'compress@10': 0.6598, 'time@10': 6.0223}:  50%|█████     | 15/30 [01:08<00:59,  3.97s/it] {'epoch': 37, 'num_users': 6.0625, 'loss': 0.0181, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.936, 'compress@10': 0.6598, 'time@10': 6.0223}:  53%|█████▎    | 16/30 [01:08<00:54,  3.87s/it]{'epoch': 37, 'num_users': 5.8235, 'loss': 0.017, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.928, 'compress@10': 0.6618, 'time@10': 5.8707}:  53%|█████▎    | 16/30 [01:10<00:54,  3.87s/it] {'epoch': 37, 'num_users': 5.8235, 'loss': 0.017, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.928, 'compress@10': 0.6618, 'time@10': 5.8707}:  57%|█████▋    | 17/30 [01:10<00:42,  3.24s/it]{'epoch': 37, 'num_users': 6.0556, 'loss': 0.0175, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.9261, 'compress@10': 0.6621, 'time@10': 5.7806}:  57%|█████▋    | 17/30 [01:14<00:42,  3.24s/it]{'epoch': 37, 'num_users': 6.0556, 'loss': 0.0175, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.9261, 'compress@10': 0.6621, 'time@10': 5.7806}:  60%|██████    | 18/30 [01:14<00:42,  3.56s/it]{'epoch': 37, 'num_users': 6.0, 'loss': 0.017, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9257, 'compress@10': 0.6638, 'time@10': 5.6675}:  60%|██████    | 18/30 [01:16<00:42,  3.56s/it]    {'epoch': 37, 'num_users': 6.0, 'loss': 0.017, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9257, 'compress@10': 0.6638, 'time@10': 5.6675}:  63%|██████▎   | 19/30 [01:16<00:33,  3.04s/it]{'epoch': 37, 'num_users': 6.15, 'loss': 0.0172, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9261, 'compress@10': 0.6621, 'time@10': 5.8018}:  63%|██████▎   | 19/30 [01:24<00:33,  3.04s/it]{'epoch': 37, 'num_users': 6.15, 'loss': 0.0172, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9261, 'compress@10': 0.6621, 'time@10': 5.8018}:  67%|██████▋   | 20/30 [01:24<00:46,  4.65s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9241, 'compress@10': 0.6639, 'time@10': 5.8964}:  67%|██████▋   | 20/30 [01:28<00:46,  4.65s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9241, 'compress@10': 0.6639, 'time@10': 5.8964}:  70%|███████   | 21/30 [01:28<00:39,  4.44s/it]{'epoch': 37, 'num_users': 6.1818, 'loss': 0.0187, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9225, 'compress@10': 0.6556, 'time@10': 5.7926}:  70%|███████   | 21/30 [01:32<00:39,  4.44s/it]{'epoch': 37, 'num_users': 6.1818, 'loss': 0.0187, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9225, 'compress@10': 0.6556, 'time@10': 5.7926}:  73%|███████▎  | 22/30 [01:32<00:33,  4.20s/it]{'epoch': 37, 'num_users': 6.1304, 'loss': 0.0185, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9233, 'compress@10': 0.659, 'time@10': 5.8124}:  73%|███████▎  | 22/30 [01:35<00:33,  4.20s/it] {'epoch': 37, 'num_users': 6.1304, 'loss': 0.0185, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9233, 'compress@10': 0.659, 'time@10': 5.8124}:  77%|███████▋  | 23/30 [01:35<00:27,  3.89s/it]{'epoch': 37, 'num_users': 5.9583, 'loss': 0.0177, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9182, 'compress@10': 0.6597, 'time@10': 5.6977}:  77%|███████▋  | 23/30 [01:38<00:27,  3.89s/it]{'epoch': 37, 'num_users': 5.9583, 'loss': 0.0177, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9182, 'compress@10': 0.6597, 'time@10': 5.6977}:  80%|████████  | 24/30 [01:38<00:21,  3.65s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9081, 'compress@10': 0.6645, 'time@10': 5.5802}:  80%|████████  | 24/30 [01:40<00:21,  3.65s/it]    {'epoch': 37, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9081, 'compress@10': 0.6645, 'time@10': 5.5802}:  83%|████████▎ | 25/30 [01:40<00:14,  2.98s/it]{'epoch': 37, 'num_users': 5.8077, 'loss': 0.017, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.91, 'compress@10': 0.6639, 'time@10': 5.6628}:  83%|████████▎ | 25/30 [01:47<00:14,  2.98s/it]{'epoch': 37, 'num_users': 5.8077, 'loss': 0.017, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.91, 'compress@10': 0.6639, 'time@10': 5.6628}:  87%|████████▋ | 26/30 [01:47<00:17,  4.42s/it]{'epoch': 37, 'num_users': 5.8889, 'loss': 0.0181, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9131, 'compress@10': 0.6648, 'time@10': 5.7165}:  87%|████████▋ | 26/30 [01:51<00:17,  4.42s/it]{'epoch': 37, 'num_users': 5.8889, 'loss': 0.0181, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9131, 'compress@10': 0.6648, 'time@10': 5.7165}:  90%|█████████ | 27/30 [01:51<00:12,  4.17s/it]{'epoch': 37, 'num_users': 6.0, 'loss': 0.0182, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9142, 'compress@10': 0.6651, 'time@10': 5.8245}:  90%|█████████ | 27/30 [02:00<00:12,  4.17s/it]   {'epoch': 37, 'num_users': 6.0, 'loss': 0.0182, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9142, 'compress@10': 0.6651, 'time@10': 5.8245}:  93%|█████████▎| 28/30 [02:00<00:11,  5.55s/it]{'epoch': 37, 'num_users': 5.8621, 'loss': 0.0181, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9157, 'compress@10': 0.6656, 'time@10': 5.8306}:  93%|█████████▎| 28/30 [02:03<00:11,  5.55s/it]{'epoch': 37, 'num_users': 5.8621, 'loss': 0.0181, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9157, 'compress@10': 0.6656, 'time@10': 5.8306}:  97%|█████████▋| 29/30 [02:03<00:04,  4.80s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0195, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9159, 'compress@10': 0.6652, 'time@10': 5.8234}:  97%|█████████▋| 29/30 [02:08<00:04,  4.80s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0195, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9159, 'compress@10': 0.6652, 'time@10': 5.8234}: 100%|██████████| 30/30 [02:08<00:00,  5.06s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0195, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9159, 'compress@10': 0.6652, 'time@10': 5.8234}: 100%|██████████| 30/30 [02:08<00:00,  4.30s/it]
Epoch: 37
Avg # of users: 5.866666666666666
Avg Loss: 0.019535752403350884
Avg hit ratio: 0.8817402706303855
Avg ndcg: 0.9159409504781932
Avg compression ratio: 0.6651894856725752
Avg train time: 5.8233852307001746
Std train time: 1.9552474935470776
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 26, 10, 10, 9, 6, 11, 10, 48, 48, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.6699, 'time@10': 5.9144}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.6699, 'time@10': 5.9144}:   3%|▎         | 1/30 [00:02<01:26,  3.00s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9543, 'compress@10': 0.5652, 'time@10': 5.447}:   3%|▎         | 1/30 [00:08<01:26,  3.00s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9543, 'compress@10': 0.5652, 'time@10': 5.447}:   7%|▋         | 2/30 [00:08<01:57,  4.19s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9219, 'compress@10': 0.599, 'time@10': 4.9491}:   7%|▋         | 2/30 [00:10<01:57,  4.19s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9219, 'compress@10': 0.599, 'time@10': 4.9491}:  10%|█         | 3/30 [00:10<01:26,  3.20s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9269, 'compress@10': 0.58, 'time@10': 4.7892}:  10%|█         | 3/30 [00:14<01:26,  3.20s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9269, 'compress@10': 0.58, 'time@10': 4.7892}:  13%|█▎        | 4/30 [00:14<01:35,  3.66s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9168, 'compress@10': 0.5984, 'time@10': 5.5543}:  13%|█▎        | 4/30 [00:18<01:35,  3.66s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9168, 'compress@10': 0.5984, 'time@10': 5.5543}:  17%|█▋        | 5/30 [00:18<01:37,  3.91s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0202, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9243, 'compress@10': 0.5947, 'time@10': 5.9336}:  17%|█▋        | 5/30 [00:26<01:37,  3.91s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0202, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9243, 'compress@10': 0.5947, 'time@10': 5.9336}:  20%|██        | 6/30 [00:26<02:06,  5.26s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.931, 'compress@10': 0.6091, 'time@10': 6.2503}:  20%|██        | 6/30 [00:30<02:06,  5.26s/it] {'epoch': 38, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.931, 'compress@10': 0.6091, 'time@10': 6.2503}:  23%|██▎       | 7/30 [00:30<01:52,  4.89s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0267, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9416, 'compress@10': 0.6308, 'time@10': 6.1651}:  23%|██▎       | 7/30 [00:36<01:52,  4.89s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0267, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9416, 'compress@10': 0.6308, 'time@10': 6.1651}:  27%|██▋       | 8/30 [00:36<01:52,  5.12s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0287, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9474, 'compress@10': 0.6354, 'time@10': 6.4731}:  27%|██▋       | 8/30 [00:40<01:52,  5.12s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0287, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9474, 'compress@10': 0.6354, 'time@10': 6.4731}:  30%|███       | 9/30 [00:40<01:43,  4.93s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9481, 'compress@10': 0.6343, 'time@10': 6.5289}:  30%|███       | 9/30 [00:47<01:43,  4.93s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9481, 'compress@10': 0.6343, 'time@10': 6.5289}:  33%|███▎      | 10/30 [00:47<01:51,  5.59s/it]{'epoch': 38, 'num_users': 6.6364, 'loss': 0.029, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9456, 'compress@10': 0.6359, 'time@10': 6.622}:  33%|███▎      | 10/30 [00:51<01:51,  5.59s/it]{'epoch': 38, 'num_users': 6.6364, 'loss': 0.029, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9456, 'compress@10': 0.6359, 'time@10': 6.622}:  37%|███▋      | 11/30 [00:51<01:35,  5.05s/it]{'epoch': 38, 'num_users': 6.4167, 'loss': 0.0267, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9431, 'compress@10': 0.6397, 'time@10': 6.3586}:  37%|███▋      | 11/30 [00:55<01:35,  5.05s/it]{'epoch': 38, 'num_users': 6.4167, 'loss': 0.0267, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9431, 'compress@10': 0.6397, 'time@10': 6.3586}:  40%|████      | 12/30 [00:55<01:22,  4.58s/it]{'epoch': 38, 'num_users': 6.6154, 'loss': 0.027, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9378, 'compress@10': 0.6441, 'time@10': 6.4042}:  40%|████      | 12/30 [00:58<01:22,  4.58s/it] {'epoch': 38, 'num_users': 6.6154, 'loss': 0.027, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9378, 'compress@10': 0.6441, 'time@10': 6.4042}:  43%|████▎     | 13/30 [00:58<01:12,  4.26s/it]{'epoch': 38, 'num_users': 6.3571, 'loss': 0.0251, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9304, 'compress@10': 0.6441, 'time@10': 6.1862}:  43%|████▎     | 13/30 [01:02<01:12,  4.26s/it]{'epoch': 38, 'num_users': 6.3571, 'loss': 0.0251, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9304, 'compress@10': 0.6441, 'time@10': 6.1862}:  47%|████▋     | 14/30 [01:02<01:03,  3.99s/it]{'epoch': 38, 'num_users': 6.2667, 'loss': 0.0252, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9314, 'compress@10': 0.6435, 'time@10': 6.3511}:  47%|████▋     | 14/30 [01:06<01:03,  3.99s/it]{'epoch': 38, 'num_users': 6.2667, 'loss': 0.0252, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9314, 'compress@10': 0.6435, 'time@10': 6.3511}:  50%|█████     | 15/30 [01:06<01:01,  4.11s/it]{'epoch': 38, 'num_users': 6.0625, 'loss': 0.0237, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9304, 'compress@10': 0.6438, 'time@10': 6.1818}:  50%|█████     | 15/30 [01:10<01:01,  4.11s/it]{'epoch': 38, 'num_users': 6.0625, 'loss': 0.0237, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9304, 'compress@10': 0.6438, 'time@10': 6.1818}:  53%|█████▎    | 16/30 [01:10<00:55,  3.98s/it]{'epoch': 38, 'num_users': 5.8235, 'loss': 0.0223, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9228, 'compress@10': 0.6465, 'time@10': 6.015}:  53%|█████▎    | 16/30 [01:11<00:55,  3.98s/it] {'epoch': 38, 'num_users': 5.8235, 'loss': 0.0223, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9228, 'compress@10': 0.6465, 'time@10': 6.015}:  57%|█████▋    | 17/30 [01:11<00:42,  3.30s/it]{'epoch': 38, 'num_users': 6.0556, 'loss': 0.0253, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9277, 'compress@10': 0.651, 'time@10': 5.9012}:  57%|█████▋    | 17/30 [01:15<00:42,  3.30s/it]{'epoch': 38, 'num_users': 6.0556, 'loss': 0.0253, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9277, 'compress@10': 0.651, 'time@10': 5.9012}:  60%|██████    | 18/30 [01:15<00:42,  3.51s/it]{'epoch': 38, 'num_users': 6.0, 'loss': 0.0243, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9275, 'compress@10': 0.6531, 'time@10': 5.8137}:  60%|██████    | 18/30 [01:18<00:42,  3.51s/it]  {'epoch': 38, 'num_users': 6.0, 'loss': 0.0243, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9275, 'compress@10': 0.6531, 'time@10': 5.8137}:  63%|██████▎   | 19/30 [01:18<00:34,  3.15s/it]{'epoch': 38, 'num_users': 6.15, 'loss': 0.024, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9286, 'compress@10': 0.6503, 'time@10': 5.9392}:  63%|██████▎   | 19/30 [01:26<00:34,  3.15s/it]{'epoch': 38, 'num_users': 6.15, 'loss': 0.024, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9286, 'compress@10': 0.6503, 'time@10': 5.9392}:  67%|██████▋   | 20/30 [01:26<00:47,  4.71s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0246, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.928, 'compress@10': 0.6519, 'time@10': 6.0186}:  67%|██████▋   | 20/30 [01:30<00:47,  4.71s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0246, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.928, 'compress@10': 0.6519, 'time@10': 6.0186}:  70%|███████   | 21/30 [01:30<00:40,  4.45s/it]{'epoch': 38, 'num_users': 6.1818, 'loss': 0.0247, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.927, 'compress@10': 0.6435, 'time@10': 5.917}:  70%|███████   | 21/30 [01:34<00:40,  4.45s/it] {'epoch': 38, 'num_users': 6.1818, 'loss': 0.0247, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.927, 'compress@10': 0.6435, 'time@10': 5.917}:  73%|███████▎  | 22/30 [01:34<00:34,  4.26s/it]{'epoch': 38, 'num_users': 6.1304, 'loss': 0.0243, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9272, 'compress@10': 0.6465, 'time@10': 5.9252}:  73%|███████▎  | 22/30 [01:37<00:34,  4.26s/it]{'epoch': 38, 'num_users': 6.1304, 'loss': 0.0243, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9272, 'compress@10': 0.6465, 'time@10': 5.9252}:  77%|███████▋  | 23/30 [01:37<00:27,  3.91s/it]{'epoch': 38, 'num_users': 5.9583, 'loss': 0.0233, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9219, 'compress@10': 0.6473, 'time@10': 5.7919}:  77%|███████▋  | 23/30 [01:40<00:27,  3.91s/it]{'epoch': 38, 'num_users': 5.9583, 'loss': 0.0233, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9219, 'compress@10': 0.6473, 'time@10': 5.7919}:  80%|████████  | 24/30 [01:40<00:21,  3.57s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9117, 'compress@10': 0.6524, 'time@10': 5.6683}:  80%|████████  | 24/30 [01:41<00:21,  3.57s/it]    {'epoch': 38, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9117, 'compress@10': 0.6524, 'time@10': 5.6683}:  83%|████████▎ | 25/30 [01:41<00:14,  2.91s/it]{'epoch': 38, 'num_users': 5.8077, 'loss': 0.0221, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9136, 'compress@10': 0.6522, 'time@10': 5.7467}:  83%|████████▎ | 25/30 [01:49<00:14,  2.91s/it]{'epoch': 38, 'num_users': 5.8077, 'loss': 0.0221, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9136, 'compress@10': 0.6522, 'time@10': 5.7467}:  87%|████████▋ | 26/30 [01:49<00:17,  4.37s/it]{'epoch': 38, 'num_users': 5.8889, 'loss': 0.0223, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9179, 'compress@10': 0.6533, 'time@10': 5.7981}:  87%|████████▋ | 26/30 [01:52<00:17,  4.37s/it]{'epoch': 38, 'num_users': 5.8889, 'loss': 0.0223, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9179, 'compress@10': 0.6533, 'time@10': 5.7981}:  90%|█████████ | 27/30 [01:52<00:12,  4.14s/it]{'epoch': 38, 'num_users': 6.0, 'loss': 0.0228, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9179, 'compress@10': 0.6531, 'time@10': 5.8705}:  90%|█████████ | 27/30 [02:00<00:12,  4.14s/it]   {'epoch': 38, 'num_users': 6.0, 'loss': 0.0228, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9179, 'compress@10': 0.6531, 'time@10': 5.8705}:  93%|█████████▎| 28/30 [02:00<00:10,  5.27s/it]{'epoch': 38, 'num_users': 5.8621, 'loss': 0.0226, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9194, 'compress@10': 0.6537, 'time@10': 5.9234}:  93%|█████████▎| 28/30 [02:04<00:10,  5.27s/it]{'epoch': 38, 'num_users': 5.8621, 'loss': 0.0226, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9194, 'compress@10': 0.6537, 'time@10': 5.9234}:  97%|█████████▋| 29/30 [02:04<00:04,  4.82s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0237, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9233, 'compress@10': 0.6545, 'time@10': 5.9142}:  97%|█████████▋| 29/30 [02:10<00:04,  4.82s/it] {'epoch': 38, 'num_users': 5.8667, 'loss': 0.0237, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9233, 'compress@10': 0.6545, 'time@10': 5.9142}: 100%|██████████| 30/30 [02:10<00:00,  5.08s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0237, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9233, 'compress@10': 0.6545, 'time@10': 5.9142}: 100%|██████████| 30/30 [02:10<00:00,  4.34s/it]
Epoch: 38
Avg # of users: 5.866666666666666
Avg Loss: 0.02371339170398086
Avg hit ratio: 0.8779547629691663
Avg ndcg: 0.9232898775944242
Avg compression ratio: 0.6544760788663757
Avg train time: 5.914195076624552
Std train time: 2.003266178241963
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 26, 10, 10, 9, 6, 11, 10, 49, 49, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9228, 'compress@10': 0.6705, 'time@10': 5.9459}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9228, 'compress@10': 0.6705, 'time@10': 5.9459}:   3%|▎         | 1/30 [00:03<01:27,  3.01s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9309, 'compress@10': 0.5728, 'time@10': 5.4373}:   3%|▎         | 1/30 [00:07<01:27,  3.01s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9309, 'compress@10': 0.5728, 'time@10': 5.4373}:   7%|▋         | 2/30 [00:07<01:56,  4.16s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9063, 'compress@10': 0.6006, 'time@10': 4.8537}:   7%|▋         | 2/30 [00:09<01:56,  4.16s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9063, 'compress@10': 0.6006, 'time@10': 4.8537}:  10%|█         | 3/30 [00:09<01:24,  3.12s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9072, 'compress@10': 0.57, 'time@10': 4.7593}:  10%|█         | 3/30 [00:14<01:24,  3.12s/it]  {'epoch': 39, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9072, 'compress@10': 0.57, 'time@10': 4.7593}:  13%|█▎        | 4/30 [00:14<01:35,  3.67s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0217, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9003, 'compress@10': 0.5911, 'time@10': 5.4098}:  13%|█▎        | 4/30 [00:18<01:35,  3.67s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0217, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9003, 'compress@10': 0.5911, 'time@10': 5.4098}:  17%|█▋        | 5/30 [00:18<01:35,  3.81s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0233, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9091, 'compress@10': 0.5852, 'time@10': 5.7187}:  17%|█▋        | 5/30 [00:25<01:35,  3.81s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0233, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9091, 'compress@10': 0.5852, 'time@10': 5.7187}:  20%|██        | 6/30 [00:25<01:59,  5.00s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0231, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.909, 'compress@10': 0.6023, 'time@10': 6.0398}:  20%|██        | 6/30 [00:29<01:59,  5.00s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0231, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.909, 'compress@10': 0.6023, 'time@10': 6.0398}:  23%|██▎       | 7/30 [00:29<01:47,  4.68s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0227, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9087, 'compress@10': 0.619, 'time@10': 5.9605}:  23%|██▎       | 7/30 [00:35<01:47,  4.68s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0227, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9087, 'compress@10': 0.619, 'time@10': 5.9605}:  27%|██▋       | 8/30 [00:35<01:48,  4.92s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9122, 'compress@10': 0.6206, 'time@10': 6.2927}:  27%|██▋       | 8/30 [00:39<01:48,  4.92s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9122, 'compress@10': 0.6206, 'time@10': 6.2927}:  30%|███       | 9/30 [00:39<01:40,  4.80s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9187, 'compress@10': 0.6192, 'time@10': 6.3719}:  30%|███       | 9/30 [00:46<01:40,  4.80s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9187, 'compress@10': 0.6192, 'time@10': 6.3719}:  33%|███▎      | 10/30 [00:46<01:50,  5.52s/it]{'epoch': 39, 'num_users': 6.6364, 'loss': 0.021, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9196, 'compress@10': 0.623, 'time@10': 6.4811}:  33%|███▎      | 10/30 [00:50<01:50,  5.52s/it]{'epoch': 39, 'num_users': 6.6364, 'loss': 0.021, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9196, 'compress@10': 0.623, 'time@10': 6.4811}:  37%|███▋      | 11/30 [00:50<01:34,  5.00s/it]{'epoch': 39, 'num_users': 6.4167, 'loss': 0.0193, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9194, 'compress@10': 0.6277, 'time@10': 6.2198}:  37%|███▋      | 11/30 [00:54<01:34,  5.00s/it]{'epoch': 39, 'num_users': 6.4167, 'loss': 0.0193, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9194, 'compress@10': 0.6277, 'time@10': 6.2198}:  40%|████      | 12/30 [00:54<01:21,  4.51s/it]{'epoch': 39, 'num_users': 6.6154, 'loss': 0.02, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9199, 'compress@10': 0.6314, 'time@10': 6.2728}:  40%|████      | 12/30 [00:57<01:21,  4.51s/it]  {'epoch': 39, 'num_users': 6.6154, 'loss': 0.02, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9199, 'compress@10': 0.6314, 'time@10': 6.2728}:  43%|████▎     | 13/30 [00:57<01:11,  4.20s/it]{'epoch': 39, 'num_users': 6.3571, 'loss': 0.0186, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9137, 'compress@10': 0.6326, 'time@10': 6.0605}:  43%|████▎     | 13/30 [01:00<01:11,  4.20s/it]{'epoch': 39, 'num_users': 6.3571, 'loss': 0.0186, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9137, 'compress@10': 0.6326, 'time@10': 6.0605}:  47%|████▋     | 14/30 [01:00<01:03,  3.94s/it]{'epoch': 39, 'num_users': 6.2667, 'loss': 0.0209, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9172, 'compress@10': 0.633, 'time@10': 6.1884}:  47%|████▋     | 14/30 [01:04<01:03,  3.94s/it] {'epoch': 39, 'num_users': 6.2667, 'loss': 0.0209, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9172, 'compress@10': 0.633, 'time@10': 6.1884}:  50%|█████     | 15/30 [01:04<00:59,  3.97s/it]{'epoch': 39, 'num_users': 6.0625, 'loss': 0.0198, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9172, 'compress@10': 0.6337, 'time@10': 6.0282}:  50%|█████     | 15/30 [01:08<00:59,  3.97s/it]{'epoch': 39, 'num_users': 6.0625, 'loss': 0.0198, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9172, 'compress@10': 0.6337, 'time@10': 6.0282}:  53%|█████▎    | 16/30 [01:08<00:54,  3.88s/it]{'epoch': 39, 'num_users': 5.8235, 'loss': 0.0186, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9103, 'compress@10': 0.6367, 'time@10': 5.8745}:  53%|█████▎    | 16/30 [01:10<00:54,  3.88s/it]{'epoch': 39, 'num_users': 5.8235, 'loss': 0.0186, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9103, 'compress@10': 0.6367, 'time@10': 5.8745}:  57%|█████▋    | 17/30 [01:10<00:42,  3.24s/it]{'epoch': 39, 'num_users': 6.0556, 'loss': 0.0189, 'hit_ratio@10': 0.866, 'ndcg@10': 0.911, 'compress@10': 0.6412, 'time@10': 5.7769}:  57%|█████▋    | 17/30 [01:14<00:42,  3.24s/it]  {'epoch': 39, 'num_users': 6.0556, 'loss': 0.0189, 'hit_ratio@10': 0.866, 'ndcg@10': 0.911, 'compress@10': 0.6412, 'time@10': 5.7769}:  60%|██████    | 18/30 [01:14<00:42,  3.51s/it]{'epoch': 39, 'num_users': 6.0, 'loss': 0.0182, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.9117, 'compress@10': 0.6439, 'time@10': 5.6809}:  60%|██████    | 18/30 [01:16<00:42,  3.51s/it] {'epoch': 39, 'num_users': 6.0, 'loss': 0.0182, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.9117, 'compress@10': 0.6439, 'time@10': 5.6809}:  63%|██████▎   | 19/30 [01:16<00:33,  3.07s/it]{'epoch': 39, 'num_users': 6.15, 'loss': 0.0187, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9119, 'compress@10': 0.6414, 'time@10': 5.8227}:  63%|██████▎   | 19/30 [01:25<00:33,  3.07s/it]{'epoch': 39, 'num_users': 6.15, 'loss': 0.0187, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9119, 'compress@10': 0.6414, 'time@10': 5.8227}:  67%|██████▋   | 20/30 [01:25<00:47,  4.72s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9108, 'compress@10': 0.6441, 'time@10': 5.9582}:  67%|██████▋   | 20/30 [01:29<00:47,  4.72s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9108, 'compress@10': 0.6441, 'time@10': 5.9582}:  70%|███████   | 21/30 [01:29<00:41,  4.61s/it]{'epoch': 39, 'num_users': 6.1818, 'loss': 0.0197, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9116, 'compress@10': 0.6358, 'time@10': 5.8565}:  70%|███████   | 21/30 [01:33<00:41,  4.61s/it]{'epoch': 39, 'num_users': 6.1818, 'loss': 0.0197, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9116, 'compress@10': 0.6358, 'time@10': 5.8565}:  73%|███████▎  | 22/30 [01:33<00:34,  4.36s/it]{'epoch': 39, 'num_users': 6.1304, 'loss': 0.0193, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9124, 'compress@10': 0.6395, 'time@10': 5.8581}:  73%|███████▎  | 22/30 [01:36<00:34,  4.36s/it]{'epoch': 39, 'num_users': 6.1304, 'loss': 0.0193, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9124, 'compress@10': 0.6395, 'time@10': 5.8581}:  77%|███████▋  | 23/30 [01:36<00:27,  3.95s/it]{'epoch': 39, 'num_users': 5.9583, 'loss': 0.0185, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9077, 'compress@10': 0.6402, 'time@10': 5.7318}:  77%|███████▋  | 23/30 [01:39<00:27,  3.95s/it]{'epoch': 39, 'num_users': 5.9583, 'loss': 0.0185, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9077, 'compress@10': 0.6402, 'time@10': 5.7318}:  80%|████████  | 24/30 [01:39<00:21,  3.62s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8981, 'compress@10': 0.6456, 'time@10': 5.6242}:  80%|████████  | 24/30 [01:40<00:21,  3.62s/it]   {'epoch': 39, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8981, 'compress@10': 0.6456, 'time@10': 5.6242}:  83%|████████▎ | 25/30 [01:40<00:15,  3.00s/it]{'epoch': 39, 'num_users': 5.8077, 'loss': 0.0177, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9005, 'compress@10': 0.6458, 'time@10': 5.7082}:  83%|████████▎ | 25/30 [01:48<00:15,  3.00s/it]{'epoch': 39, 'num_users': 5.8077, 'loss': 0.0177, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9005, 'compress@10': 0.6458, 'time@10': 5.7082}:  87%|████████▋ | 26/30 [01:48<00:17,  4.46s/it]{'epoch': 39, 'num_users': 5.8889, 'loss': 0.0173, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9026, 'compress@10': 0.6474, 'time@10': 5.7623}:  87%|████████▋ | 26/30 [01:52<00:17,  4.46s/it]{'epoch': 39, 'num_users': 5.8889, 'loss': 0.0173, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9026, 'compress@10': 0.6474, 'time@10': 5.7623}:  90%|█████████ | 27/30 [01:52<00:12,  4.21s/it]{'epoch': 39, 'num_users': 6.0, 'loss': 0.0177, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.904, 'compress@10': 0.6474, 'time@10': 5.8385}:  90%|█████████ | 27/30 [02:00<00:12,  4.21s/it]    {'epoch': 39, 'num_users': 6.0, 'loss': 0.0177, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.904, 'compress@10': 0.6474, 'time@10': 5.8385}:  93%|█████████▎| 28/30 [02:00<00:10,  5.33s/it]{'epoch': 39, 'num_users': 5.8621, 'loss': 0.0176, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9057, 'compress@10': 0.6478, 'time@10': 5.8572}:  93%|█████████▎| 28/30 [02:03<00:10,  5.33s/it]{'epoch': 39, 'num_users': 5.8621, 'loss': 0.0176, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9057, 'compress@10': 0.6478, 'time@10': 5.8572}:  97%|█████████▋| 29/30 [02:03<00:04,  4.70s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0175, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9078, 'compress@10': 0.6502, 'time@10': 5.8443}:  97%|█████████▋| 29/30 [02:08<00:04,  4.70s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0175, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9078, 'compress@10': 0.6502, 'time@10': 5.8443}: 100%|██████████| 30/30 [02:08<00:00,  4.94s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0175, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9078, 'compress@10': 0.6502, 'time@10': 5.8443}: 100%|██████████| 30/30 [02:08<00:00,  4.29s/it]
Epoch: 39
Avg # of users: 5.866666666666666
Avg Loss: 0.017484732299209865
Avg hit ratio: 0.8811664534389212
Avg ndcg: 0.9077586395224837
Avg compression ratio: 0.6501549129650406
Avg train time: 5.8443029483159386
Std train time: 1.962799652778013
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 26, 10, 10, 9, 6, 11, 10, 50, 50, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9254, 'compress@10': 0.6626, 'time@10': 6.1558}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9254, 'compress@10': 0.6626, 'time@10': 6.1558}:   3%|▎         | 1/30 [00:03<01:30,  3.14s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9615, 'compress@10': 0.6111, 'time@10': 5.6609}:   3%|▎         | 1/30 [00:08<01:30,  3.14s/it] {'epoch': 40, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9615, 'compress@10': 0.6111, 'time@10': 5.6609}:   7%|▋         | 2/30 [00:08<02:01,  4.35s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9267, 'compress@10': 0.6225, 'time@10': 5.1746}:   7%|▋         | 2/30 [00:10<02:01,  4.35s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9267, 'compress@10': 0.6225, 'time@10': 5.1746}:  10%|█         | 3/30 [00:10<01:30,  3.35s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9394, 'compress@10': 0.5796, 'time@10': 5.0179}:  10%|█         | 3/30 [00:15<01:30,  3.35s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9394, 'compress@10': 0.5796, 'time@10': 5.0179}:  13%|█▎        | 4/30 [00:15<01:40,  3.85s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0217, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9275, 'compress@10': 0.5985, 'time@10': 5.6364}:  13%|█▎        | 4/30 [00:19<01:40,  3.85s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0217, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9275, 'compress@10': 0.5985, 'time@10': 5.6364}:  17%|█▋        | 5/30 [00:19<01:38,  3.94s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0204, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9322, 'compress@10': 0.584, 'time@10': 5.8913}:  17%|█▋        | 5/30 [00:26<01:38,  3.94s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0204, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9322, 'compress@10': 0.584, 'time@10': 5.8913}:  20%|██        | 6/30 [00:26<02:01,  5.05s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9334, 'compress@10': 0.597, 'time@10': 6.1686}:  20%|██        | 6/30 [00:30<02:01,  5.05s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9334, 'compress@10': 0.597, 'time@10': 6.1686}:  23%|██▎       | 7/30 [00:30<01:47,  4.69s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9368, 'compress@10': 0.6119, 'time@10': 6.0865}:  23%|██▎       | 7/30 [00:35<01:47,  4.69s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9368, 'compress@10': 0.6119, 'time@10': 6.0865}:  27%|██▋       | 8/30 [00:35<01:49,  4.97s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9439, 'compress@10': 0.6121, 'time@10': 6.3908}:  27%|██▋       | 8/30 [00:40<01:49,  4.97s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9439, 'compress@10': 0.6121, 'time@10': 6.3908}:  30%|███       | 9/30 [00:40<01:40,  4.81s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.9124, 'ndcg@10': 0.948, 'compress@10': 0.6113, 'time@10': 6.4433}:  30%|███       | 9/30 [00:47<01:40,  4.81s/it]    {'epoch': 40, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.9124, 'ndcg@10': 0.948, 'compress@10': 0.6113, 'time@10': 6.4433}:  33%|███▎      | 10/30 [00:47<01:49,  5.47s/it]{'epoch': 40, 'num_users': 6.6364, 'loss': 0.0245, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9595, 'compress@10': 0.6142, 'time@10': 6.5355}:  33%|███▎      | 10/30 [00:51<01:49,  5.47s/it]{'epoch': 40, 'num_users': 6.6364, 'loss': 0.0245, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9595, 'compress@10': 0.6142, 'time@10': 6.5355}:  37%|███▋      | 11/30 [00:51<01:34,  4.95s/it]{'epoch': 40, 'num_users': 6.4167, 'loss': 0.0226, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9559, 'compress@10': 0.619, 'time@10': 6.2762}:  37%|███▋      | 11/30 [00:54<01:34,  4.95s/it] {'epoch': 40, 'num_users': 6.4167, 'loss': 0.0226, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9559, 'compress@10': 0.619, 'time@10': 6.2762}:  40%|████      | 12/30 [00:54<01:20,  4.50s/it]{'epoch': 40, 'num_users': 6.6154, 'loss': 0.0223, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9526, 'compress@10': 0.6234, 'time@10': 6.3308}:  40%|████      | 12/30 [00:58<01:20,  4.50s/it]{'epoch': 40, 'num_users': 6.6154, 'loss': 0.0223, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9526, 'compress@10': 0.6234, 'time@10': 6.3308}:  43%|████▎     | 13/30 [00:58<01:11,  4.21s/it]{'epoch': 40, 'num_users': 6.3571, 'loss': 0.0207, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9441, 'compress@10': 0.6256, 'time@10': 6.1157}:  43%|████▎     | 13/30 [01:01<01:11,  4.21s/it]{'epoch': 40, 'num_users': 6.3571, 'loss': 0.0207, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9441, 'compress@10': 0.6256, 'time@10': 6.1157}:  47%|████▋     | 14/30 [01:01<01:03,  3.95s/it]{'epoch': 40, 'num_users': 6.2667, 'loss': 0.0215, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9359, 'compress@10': 0.6266, 'time@10': 6.2516}:  47%|████▋     | 14/30 [01:05<01:03,  3.95s/it]{'epoch': 40, 'num_users': 6.2667, 'loss': 0.0215, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9359, 'compress@10': 0.6266, 'time@10': 6.2516}:  50%|█████     | 15/30 [01:05<01:00,  4.00s/it]{'epoch': 40, 'num_users': 6.0625, 'loss': 0.0203, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9347, 'compress@10': 0.627, 'time@10': 6.0882}:  50%|█████     | 15/30 [01:09<01:00,  4.00s/it] {'epoch': 40, 'num_users': 6.0625, 'loss': 0.0203, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9347, 'compress@10': 0.627, 'time@10': 6.0882}:  53%|█████▎    | 16/30 [01:09<00:54,  3.90s/it]{'epoch': 40, 'num_users': 5.8235, 'loss': 0.0191, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9268, 'compress@10': 0.6299, 'time@10': 5.9289}:  53%|█████▎    | 16/30 [01:10<00:54,  3.90s/it]{'epoch': 40, 'num_users': 5.8235, 'loss': 0.0191, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9268, 'compress@10': 0.6299, 'time@10': 5.9289}:  57%|█████▋    | 17/30 [01:10<00:42,  3.25s/it]{'epoch': 40, 'num_users': 6.0556, 'loss': 0.0192, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9269, 'compress@10': 0.6326, 'time@10': 5.8297}:  57%|█████▋    | 17/30 [01:15<00:42,  3.25s/it]{'epoch': 40, 'num_users': 6.0556, 'loss': 0.0192, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9269, 'compress@10': 0.6326, 'time@10': 5.8297}:  60%|██████    | 18/30 [01:15<00:42,  3.53s/it]{'epoch': 40, 'num_users': 6.0, 'loss': 0.0185, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9267, 'compress@10': 0.6355, 'time@10': 5.7178}:  60%|██████    | 18/30 [01:17<00:42,  3.53s/it]   {'epoch': 40, 'num_users': 6.0, 'loss': 0.0185, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9267, 'compress@10': 0.6355, 'time@10': 5.7178}:  63%|██████▎   | 19/30 [01:17<00:33,  3.06s/it]{'epoch': 40, 'num_users': 6.15, 'loss': 0.0183, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9286, 'compress@10': 0.6321, 'time@10': 5.8496}:  63%|██████▎   | 19/30 [01:25<00:33,  3.06s/it]{'epoch': 40, 'num_users': 6.15, 'loss': 0.0183, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9286, 'compress@10': 0.6321, 'time@10': 5.8496}:  67%|██████▋   | 20/30 [01:25<00:46,  4.66s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9278, 'compress@10': 0.6352, 'time@10': 5.9474}:  67%|██████▋   | 20/30 [01:29<00:46,  4.66s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9278, 'compress@10': 0.6352, 'time@10': 5.9474}:  70%|███████   | 21/30 [01:29<00:40,  4.46s/it]{'epoch': 40, 'num_users': 6.1818, 'loss': 0.0192, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9283, 'compress@10': 0.6275, 'time@10': 5.8527}:  70%|███████   | 21/30 [01:33<00:40,  4.46s/it]{'epoch': 40, 'num_users': 6.1818, 'loss': 0.0192, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9283, 'compress@10': 0.6275, 'time@10': 5.8527}:  73%|███████▎  | 22/30 [01:33<00:34,  4.30s/it]{'epoch': 40, 'num_users': 6.1304, 'loss': 0.0189, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9285, 'compress@10': 0.6306, 'time@10': 5.8732}:  73%|███████▎  | 22/30 [01:36<00:34,  4.30s/it]{'epoch': 40, 'num_users': 6.1304, 'loss': 0.0189, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9285, 'compress@10': 0.6306, 'time@10': 5.8732}:  77%|███████▋  | 23/30 [01:36<00:27,  3.97s/it]{'epoch': 40, 'num_users': 5.9583, 'loss': 0.0181, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9231, 'compress@10': 0.6313, 'time@10': 5.7522}:  77%|███████▋  | 23/30 [01:39<00:27,  3.97s/it]{'epoch': 40, 'num_users': 5.9583, 'loss': 0.0181, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9231, 'compress@10': 0.6313, 'time@10': 5.7522}:  80%|████████  | 24/30 [01:39<00:22,  3.68s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9129, 'compress@10': 0.6371, 'time@10': 5.6365}:  80%|████████  | 24/30 [01:41<00:22,  3.68s/it]   {'epoch': 40, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9129, 'compress@10': 0.6371, 'time@10': 5.6365}:  83%|████████▎ | 25/30 [01:41<00:15,  3.02s/it]{'epoch': 40, 'num_users': 5.8077, 'loss': 0.0172, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9149, 'compress@10': 0.6372, 'time@10': 5.7257}:  83%|████████▎ | 25/30 [01:49<00:15,  3.02s/it]{'epoch': 40, 'num_users': 5.8077, 'loss': 0.0172, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9149, 'compress@10': 0.6372, 'time@10': 5.7257}:  87%|████████▋ | 26/30 [01:49<00:18,  4.51s/it]{'epoch': 40, 'num_users': 5.8889, 'loss': 0.0168, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9164, 'compress@10': 0.6388, 'time@10': 5.7719}:  87%|████████▋ | 26/30 [01:52<00:18,  4.51s/it]{'epoch': 40, 'num_users': 5.8889, 'loss': 0.0168, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9164, 'compress@10': 0.6388, 'time@10': 5.7719}:  90%|█████████ | 27/30 [01:52<00:12,  4.22s/it]{'epoch': 40, 'num_users': 6.0, 'loss': 0.0174, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9192, 'compress@10': 0.6389, 'time@10': 5.871}:  90%|█████████ | 27/30 [02:01<00:12,  4.22s/it]    {'epoch': 40, 'num_users': 6.0, 'loss': 0.0174, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9192, 'compress@10': 0.6389, 'time@10': 5.871}:  93%|█████████▎| 28/30 [02:01<00:11,  5.53s/it]{'epoch': 40, 'num_users': 5.8621, 'loss': 0.0173, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9204, 'compress@10': 0.6401, 'time@10': 5.9161}:  93%|█████████▎| 28/30 [02:04<00:11,  5.53s/it]{'epoch': 40, 'num_users': 5.8621, 'loss': 0.0173, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9204, 'compress@10': 0.6401, 'time@10': 5.9161}:  97%|█████████▋| 29/30 [02:04<00:04,  4.96s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0194, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9241, 'compress@10': 0.6383, 'time@10': 5.8968}:  97%|█████████▋| 29/30 [02:10<00:04,  4.96s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0194, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9241, 'compress@10': 0.6383, 'time@10': 5.8968}: 100%|██████████| 30/30 [02:10<00:00,  5.08s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0194, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9241, 'compress@10': 0.6383, 'time@10': 5.8968}: 100%|██████████| 30/30 [02:10<00:00,  4.34s/it]
Epoch: 40
Avg # of users: 5.866666666666666
Avg Loss: 0.01938448608022149
Avg hit ratio: 0.8836661150562299
Avg ndcg: 0.9240935208100055
Avg compression ratio: 0.6382551777421902
Avg train time: 5.896797561645508
Std train time: 1.9379057688628352
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 26, 10, 10, 9, 6, 11, 10, 51, 51, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9254, 'compress@10': 0.664, 'time@10': 5.9981}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9254, 'compress@10': 0.664, 'time@10': 5.9981}:   3%|▎         | 1/30 [00:03<01:28,  3.04s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9596, 'compress@10': 0.5697, 'time@10': 5.4666}:   3%|▎         | 1/30 [00:08<01:28,  3.04s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9596, 'compress@10': 0.5697, 'time@10': 5.4666}:   7%|▋         | 2/30 [00:08<01:56,  4.18s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9255, 'compress@10': 0.5892, 'time@10': 5.1001}:   7%|▋         | 2/30 [00:10<01:56,  4.18s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9255, 'compress@10': 0.5892, 'time@10': 5.1001}:  10%|█         | 3/30 [00:10<01:28,  3.28s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9306, 'compress@10': 0.5504, 'time@10': 4.9319}:  10%|█         | 3/30 [00:14<01:28,  3.28s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9306, 'compress@10': 0.5504, 'time@10': 4.9319}:  13%|█▎        | 4/30 [00:14<01:37,  3.75s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9209, 'compress@10': 0.5739, 'time@10': 5.5629}:  13%|█▎        | 4/30 [00:18<01:37,  3.75s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9209, 'compress@10': 0.5739, 'time@10': 5.5629}:  17%|█▋        | 5/30 [00:18<01:36,  3.87s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0228, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9268, 'compress@10': 0.5602, 'time@10': 5.8482}:  17%|█▋        | 5/30 [00:26<01:36,  3.87s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0228, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9268, 'compress@10': 0.5602, 'time@10': 5.8482}:  20%|██        | 6/30 [00:26<02:01,  5.05s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0228, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.924, 'compress@10': 0.581, 'time@10': 6.205}:  20%|██        | 6/30 [00:30<02:01,  5.05s/it]   {'epoch': 41, 'num_users': 6.2857, 'loss': 0.0228, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.924, 'compress@10': 0.581, 'time@10': 6.205}:  23%|██▎       | 7/30 [00:30<01:49,  4.77s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0279, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9416, 'compress@10': 0.5943, 'time@10': 6.1557}:  23%|██▎       | 7/30 [00:36<01:49,  4.77s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0279, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9416, 'compress@10': 0.5943, 'time@10': 6.1557}:  27%|██▋       | 8/30 [00:36<01:52,  5.12s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0308, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9565, 'compress@10': 0.5985, 'time@10': 6.4716}:  27%|██▋       | 8/30 [00:40<01:52,  5.12s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0308, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9565, 'compress@10': 0.5985, 'time@10': 6.4716}:  30%|███       | 9/30 [00:40<01:43,  4.94s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.029, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.958, 'compress@10': 0.5992, 'time@10': 6.5323}:  30%|███       | 9/30 [00:47<01:43,  4.94s/it]    {'epoch': 41, 'num_users': 6.3, 'loss': 0.029, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.958, 'compress@10': 0.5992, 'time@10': 6.5323}:  33%|███▎      | 10/30 [00:47<01:52,  5.61s/it]{'epoch': 41, 'num_users': 6.6364, 'loss': 0.0282, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9557, 'compress@10': 0.6033, 'time@10': 6.6072}:  33%|███▎      | 10/30 [00:51<01:52,  5.61s/it]{'epoch': 41, 'num_users': 6.6364, 'loss': 0.0282, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9557, 'compress@10': 0.6033, 'time@10': 6.6072}:  37%|███▋      | 11/30 [00:51<01:35,  5.03s/it]{'epoch': 41, 'num_users': 6.4167, 'loss': 0.0259, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9525, 'compress@10': 0.608, 'time@10': 6.342}:  37%|███▋      | 11/30 [00:55<01:35,  5.03s/it]  {'epoch': 41, 'num_users': 6.4167, 'loss': 0.0259, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9525, 'compress@10': 0.608, 'time@10': 6.342}:  40%|████      | 12/30 [00:55<01:22,  4.56s/it]{'epoch': 41, 'num_users': 6.6154, 'loss': 0.0254, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9496, 'compress@10': 0.6131, 'time@10': 6.4}:  40%|████      | 12/30 [00:58<01:22,  4.56s/it] {'epoch': 41, 'num_users': 6.6154, 'loss': 0.0254, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9496, 'compress@10': 0.6131, 'time@10': 6.4}:  43%|████▎     | 13/30 [00:58<01:12,  4.26s/it]{'epoch': 41, 'num_users': 6.3571, 'loss': 0.0236, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9413, 'compress@10': 0.6176, 'time@10': 6.1779}:  43%|████▎     | 13/30 [01:01<01:12,  4.26s/it]{'epoch': 41, 'num_users': 6.3571, 'loss': 0.0236, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9413, 'compress@10': 0.6176, 'time@10': 6.1779}:  47%|████▋     | 14/30 [01:01<01:03,  3.98s/it]{'epoch': 41, 'num_users': 6.2667, 'loss': 0.0225, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.942, 'compress@10': 0.6181, 'time@10': 6.2926}:  47%|████▋     | 14/30 [01:05<01:03,  3.98s/it] {'epoch': 41, 'num_users': 6.2667, 'loss': 0.0225, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.942, 'compress@10': 0.6181, 'time@10': 6.2926}:  50%|█████     | 15/30 [01:05<00:59,  3.98s/it]{'epoch': 41, 'num_users': 6.0625, 'loss': 0.0211, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9404, 'compress@10': 0.6184, 'time@10': 6.1263}:  50%|█████     | 15/30 [01:09<00:59,  3.98s/it]{'epoch': 41, 'num_users': 6.0625, 'loss': 0.0211, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9404, 'compress@10': 0.6184, 'time@10': 6.1263}:  53%|█████▎    | 16/30 [01:09<00:54,  3.89s/it]{'epoch': 41, 'num_users': 5.8235, 'loss': 0.0199, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.9321, 'compress@10': 0.6213, 'time@10': 5.9568}:  53%|█████▎    | 16/30 [01:11<00:54,  3.89s/it]{'epoch': 41, 'num_users': 5.8235, 'loss': 0.0199, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.9321, 'compress@10': 0.6213, 'time@10': 5.9568}:  57%|█████▋    | 17/30 [01:11<00:41,  3.22s/it]{'epoch': 41, 'num_users': 6.0556, 'loss': 0.0205, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.9339, 'compress@10': 0.6258, 'time@10': 5.8555}:  57%|█████▋    | 17/30 [01:15<00:41,  3.22s/it]{'epoch': 41, 'num_users': 6.0556, 'loss': 0.0205, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.9339, 'compress@10': 0.6258, 'time@10': 5.8555}:  60%|██████    | 18/30 [01:15<00:42,  3.51s/it]{'epoch': 41, 'num_users': 6.0, 'loss': 0.0198, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9334, 'compress@10': 0.6288, 'time@10': 5.7757}:  60%|██████    | 18/30 [01:17<00:42,  3.51s/it]   {'epoch': 41, 'num_users': 6.0, 'loss': 0.0198, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9334, 'compress@10': 0.6288, 'time@10': 5.7757}:  63%|██████▎   | 19/30 [01:17<00:34,  3.12s/it]{'epoch': 41, 'num_users': 6.15, 'loss': 0.0203, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9323, 'compress@10': 0.6252, 'time@10': 5.9238}:  63%|██████▎   | 19/30 [01:26<00:34,  3.12s/it]{'epoch': 41, 'num_users': 6.15, 'loss': 0.0203, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9323, 'compress@10': 0.6252, 'time@10': 5.9238}:  67%|██████▋   | 20/30 [01:26<00:48,  4.82s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0211, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.9303, 'compress@10': 0.6279, 'time@10': 6.0138}:  67%|██████▋   | 20/30 [01:30<00:48,  4.82s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0211, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.9303, 'compress@10': 0.6279, 'time@10': 6.0138}:  70%|███████   | 21/30 [01:30<00:41,  4.56s/it]{'epoch': 41, 'num_users': 6.1818, 'loss': 0.021, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9294, 'compress@10': 0.6192, 'time@10': 5.9039}:  70%|███████   | 21/30 [01:34<00:41,  4.56s/it] {'epoch': 41, 'num_users': 6.1818, 'loss': 0.021, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9294, 'compress@10': 0.6192, 'time@10': 5.9039}:  73%|███████▎  | 22/30 [01:34<00:34,  4.28s/it]{'epoch': 41, 'num_users': 6.1304, 'loss': 0.0206, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9296, 'compress@10': 0.6216, 'time@10': 5.8872}:  73%|███████▎  | 22/30 [01:36<00:34,  4.28s/it]{'epoch': 41, 'num_users': 6.1304, 'loss': 0.0206, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9296, 'compress@10': 0.6216, 'time@10': 5.8872}:  77%|███████▋  | 23/30 [01:36<00:26,  3.84s/it]{'epoch': 41, 'num_users': 5.9583, 'loss': 0.0197, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9242, 'compress@10': 0.6222, 'time@10': 5.7698}:  77%|███████▋  | 23/30 [01:39<00:26,  3.84s/it]{'epoch': 41, 'num_users': 5.9583, 'loss': 0.0197, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9242, 'compress@10': 0.6222, 'time@10': 5.7698}:  80%|████████  | 24/30 [01:39<00:21,  3.62s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9139, 'compress@10': 0.6283, 'time@10': 5.6719}:  80%|████████  | 24/30 [01:41<00:21,  3.62s/it]    {'epoch': 41, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9139, 'compress@10': 0.6283, 'time@10': 5.6719}:  83%|████████▎ | 25/30 [01:41<00:15,  3.04s/it]{'epoch': 41, 'num_users': 5.8077, 'loss': 0.0187, 'hit_ratio@10': 0.866, 'ndcg@10': 0.916, 'compress@10': 0.6283, 'time@10': 5.7615}:  83%|████████▎ | 25/30 [01:49<00:15,  3.04s/it]{'epoch': 41, 'num_users': 5.8077, 'loss': 0.0187, 'hit_ratio@10': 0.866, 'ndcg@10': 0.916, 'compress@10': 0.6283, 'time@10': 5.7615}:  87%|████████▋ | 26/30 [01:49<00:18,  4.54s/it]{'epoch': 41, 'num_users': 5.8889, 'loss': 0.0183, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9175, 'compress@10': 0.6307, 'time@10': 5.8098}:  87%|████████▋ | 26/30 [01:53<00:18,  4.54s/it]{'epoch': 41, 'num_users': 5.8889, 'loss': 0.0183, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9175, 'compress@10': 0.6307, 'time@10': 5.8098}:  90%|█████████ | 27/30 [01:53<00:12,  4.25s/it]{'epoch': 41, 'num_users': 6.0, 'loss': 0.0186, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9201, 'compress@10': 0.6311, 'time@10': 5.8898}:  90%|█████████ | 27/30 [02:01<00:12,  4.25s/it]   {'epoch': 41, 'num_users': 6.0, 'loss': 0.0186, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9201, 'compress@10': 0.6311, 'time@10': 5.8898}:  93%|█████████▎| 28/30 [02:01<00:10,  5.40s/it]{'epoch': 41, 'num_users': 5.8621, 'loss': 0.0184, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9213, 'compress@10': 0.632, 'time@10': 5.9246}:  93%|█████████▎| 28/30 [02:04<00:10,  5.40s/it]{'epoch': 41, 'num_users': 5.8621, 'loss': 0.0184, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9213, 'compress@10': 0.632, 'time@10': 5.9246}:  97%|█████████▋| 29/30 [02:04<00:04,  4.83s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0187, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9237, 'compress@10': 0.6336, 'time@10': 5.8982}:  97%|█████████▋| 29/30 [02:09<00:04,  4.83s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0187, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9237, 'compress@10': 0.6336, 'time@10': 5.8982}: 100%|██████████| 30/30 [02:09<00:00,  4.93s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0187, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9237, 'compress@10': 0.6336, 'time@10': 5.8982}: 100%|██████████| 30/30 [02:09<00:00,  4.33s/it]
Epoch: 41
Avg # of users: 5.866666666666666
Avg Loss: 0.01872482644640644
Avg hit ratio: 0.8762373115278984
Avg ndcg: 0.9237401501061488
Avg compression ratio: 0.6335907410727336
Avg train time: 5.898220062255859
Std train time: 1.9248302497035301
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 26, 10, 10, 9, 6, 11, 10, 52, 51, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9272, 'compress@10': 0.6625, 'time@10': 5.9734}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9272, 'compress@10': 0.6625, 'time@10': 5.9734}:   3%|▎         | 1/30 [00:03<01:27,  3.03s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9414, 'compress@10': 0.5662, 'time@10': 5.4097}:   3%|▎         | 1/30 [00:07<01:27,  3.03s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9414, 'compress@10': 0.5662, 'time@10': 5.4097}:   7%|▋         | 2/30 [00:07<01:55,  4.12s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9133, 'compress@10': 0.5839, 'time@10': 4.8878}:   7%|▋         | 2/30 [00:09<01:55,  4.12s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9133, 'compress@10': 0.5839, 'time@10': 4.8878}:  10%|█         | 3/30 [00:09<01:24,  3.14s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9224, 'compress@10': 0.5436, 'time@10': 4.7458}:  10%|█         | 3/30 [00:14<01:24,  3.14s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9224, 'compress@10': 0.5436, 'time@10': 4.7458}:  13%|█▎        | 4/30 [00:14<01:34,  3.62s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0164, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9137, 'compress@10': 0.5677, 'time@10': 5.4536}:  13%|█▎        | 4/30 [00:18<01:34,  3.62s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0164, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9137, 'compress@10': 0.5677, 'time@10': 5.4536}:  17%|█▋        | 5/30 [00:18<01:35,  3.83s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9221, 'compress@10': 0.5539, 'time@10': 5.7963}:  17%|█▋        | 5/30 [00:25<01:35,  3.83s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9221, 'compress@10': 0.5539, 'time@10': 5.7963}:  20%|██        | 6/30 [00:25<02:02,  5.10s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9259, 'compress@10': 0.5692, 'time@10': 6.1038}:  20%|██        | 6/30 [00:30<02:02,  5.10s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9259, 'compress@10': 0.5692, 'time@10': 6.1038}:  23%|██▎       | 7/30 [00:30<01:49,  4.74s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9245, 'compress@10': 0.5884, 'time@10': 6.0393}:  23%|██▎       | 7/30 [00:35<01:49,  4.74s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9245, 'compress@10': 0.5884, 'time@10': 6.0393}:  27%|██▋       | 8/30 [00:35<01:50,  5.02s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9211, 'compress@10': 0.5869, 'time@10': 6.3712}:  27%|██▋       | 8/30 [00:40<01:50,  5.02s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9211, 'compress@10': 0.5869, 'time@10': 6.3712}:  30%|███       | 9/30 [00:40<01:42,  4.88s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9276, 'compress@10': 0.5877, 'time@10': 6.4423}:  30%|███       | 9/30 [00:47<01:42,  4.88s/it] {'epoch': 42, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9276, 'compress@10': 0.5877, 'time@10': 6.4423}:  33%|███▎      | 10/30 [00:47<01:51,  5.57s/it]{'epoch': 42, 'num_users': 6.6364, 'loss': 0.0209, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9272, 'compress@10': 0.5923, 'time@10': 6.5402}:  33%|███▎      | 10/30 [00:51<01:51,  5.57s/it]{'epoch': 42, 'num_users': 6.6364, 'loss': 0.0209, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9272, 'compress@10': 0.5923, 'time@10': 6.5402}:  37%|███▋      | 11/30 [00:51<01:35,  5.03s/it]{'epoch': 42, 'num_users': 6.4167, 'loss': 0.0192, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9263, 'compress@10': 0.597, 'time@10': 6.2981}:  37%|███▋      | 11/30 [00:54<01:35,  5.03s/it]{'epoch': 42, 'num_users': 6.4167, 'loss': 0.0192, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9263, 'compress@10': 0.597, 'time@10': 6.2981}:  40%|████      | 12/30 [00:54<01:23,  4.62s/it]{'epoch': 42, 'num_users': 6.6154, 'loss': 0.0192, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9253, 'compress@10': 0.603, 'time@10': 6.3528}:  40%|████      | 12/30 [00:58<01:23,  4.62s/it]{'epoch': 42, 'num_users': 6.6154, 'loss': 0.0192, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9253, 'compress@10': 0.603, 'time@10': 6.3528}:  43%|████▎     | 13/30 [00:58<01:12,  4.29s/it]{'epoch': 42, 'num_users': 6.3571, 'loss': 0.0178, 'hit_ratio@10': 0.88, 'ndcg@10': 0.9187, 'compress@10': 0.6083, 'time@10': 6.1321}:  43%|████▎     | 13/30 [01:01<01:12,  4.29s/it] {'epoch': 42, 'num_users': 6.3571, 'loss': 0.0178, 'hit_ratio@10': 0.88, 'ndcg@10': 0.9187, 'compress@10': 0.6083, 'time@10': 6.1321}:  47%|████▋     | 14/30 [01:01<01:03,  3.99s/it]{'epoch': 42, 'num_users': 6.2667, 'loss': 0.0177, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9209, 'compress@10': 0.6092, 'time@10': 6.2561}:  47%|████▋     | 14/30 [01:05<01:03,  3.99s/it]{'epoch': 42, 'num_users': 6.2667, 'loss': 0.0177, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9209, 'compress@10': 0.6092, 'time@10': 6.2561}:  50%|█████     | 15/30 [01:05<01:00,  4.01s/it]{'epoch': 42, 'num_users': 6.0625, 'loss': 0.0167, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9206, 'compress@10': 0.6098, 'time@10': 6.0915}:  50%|█████     | 15/30 [01:09<01:00,  4.01s/it]{'epoch': 42, 'num_users': 6.0625, 'loss': 0.0167, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9206, 'compress@10': 0.6098, 'time@10': 6.0915}:  53%|█████▎    | 16/30 [01:09<00:54,  3.90s/it]{'epoch': 42, 'num_users': 5.8235, 'loss': 0.0157, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9135, 'compress@10': 0.613, 'time@10': 5.927}:  53%|█████▎    | 16/30 [01:11<00:54,  3.90s/it]  {'epoch': 42, 'num_users': 5.8235, 'loss': 0.0157, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9135, 'compress@10': 0.613, 'time@10': 5.927}:  57%|█████▋    | 17/30 [01:11<00:42,  3.24s/it]{'epoch': 42, 'num_users': 6.0556, 'loss': 0.0163, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9146, 'compress@10': 0.6194, 'time@10': 5.8178}:  57%|█████▋    | 17/30 [01:15<00:42,  3.24s/it]{'epoch': 42, 'num_users': 6.0556, 'loss': 0.0163, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9146, 'compress@10': 0.6194, 'time@10': 5.8178}:  60%|██████    | 18/30 [01:15<00:41,  3.47s/it]{'epoch': 42, 'num_users': 6.0, 'loss': 0.0159, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9151, 'compress@10': 0.623, 'time@10': 5.7359}:  60%|██████    | 18/30 [01:17<00:41,  3.47s/it]    {'epoch': 42, 'num_users': 6.0, 'loss': 0.0159, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9151, 'compress@10': 0.623, 'time@10': 5.7359}:  63%|██████▎   | 19/30 [01:17<00:33,  3.08s/it]{'epoch': 42, 'num_users': 6.15, 'loss': 0.0155, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9179, 'compress@10': 0.6193, 'time@10': 5.8962}:  63%|██████▎   | 19/30 [01:26<00:33,  3.08s/it]{'epoch': 42, 'num_users': 6.15, 'loss': 0.0155, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9179, 'compress@10': 0.6193, 'time@10': 5.8962}:  67%|██████▋   | 20/30 [01:26<00:48,  4.85s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9176, 'compress@10': 0.6215, 'time@10': 5.9873}:  67%|██████▋   | 20/30 [01:30<00:48,  4.85s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9176, 'compress@10': 0.6215, 'time@10': 5.9873}:  70%|███████   | 21/30 [01:30<00:41,  4.58s/it]{'epoch': 42, 'num_users': 6.1818, 'loss': 0.0169, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9138, 'compress@10': 0.613, 'time@10': 5.8809}:  70%|███████   | 21/30 [01:33<00:41,  4.58s/it] {'epoch': 42, 'num_users': 6.1818, 'loss': 0.0169, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9138, 'compress@10': 0.613, 'time@10': 5.8809}:  73%|███████▎  | 22/30 [01:33<00:34,  4.31s/it]{'epoch': 42, 'num_users': 6.1304, 'loss': 0.0166, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.9147, 'compress@10': 0.6143, 'time@10': 5.8782}:  73%|███████▎  | 22/30 [01:36<00:34,  4.31s/it]{'epoch': 42, 'num_users': 6.1304, 'loss': 0.0166, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.9147, 'compress@10': 0.6143, 'time@10': 5.8782}:  77%|███████▋  | 23/30 [01:36<00:27,  3.90s/it]{'epoch': 42, 'num_users': 5.9583, 'loss': 0.0159, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9099, 'compress@10': 0.6147, 'time@10': 5.7923}:  77%|███████▋  | 23/30 [01:40<00:27,  3.90s/it]{'epoch': 42, 'num_users': 5.9583, 'loss': 0.0159, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9099, 'compress@10': 0.6147, 'time@10': 5.7923}:  80%|████████  | 24/30 [01:40<00:23,  3.89s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0153, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9002, 'compress@10': 0.6209, 'time@10': 5.6968}:  80%|████████  | 24/30 [01:42<00:23,  3.89s/it]    {'epoch': 42, 'num_users': 5.8, 'loss': 0.0153, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9002, 'compress@10': 0.6209, 'time@10': 5.6968}:  83%|████████▎ | 25/30 [01:42<00:16,  3.25s/it]{'epoch': 42, 'num_users': 5.8077, 'loss': 0.0153, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9029, 'compress@10': 0.6204, 'time@10': 5.7844}:  83%|████████▎ | 25/30 [01:50<00:16,  3.25s/it]{'epoch': 42, 'num_users': 5.8077, 'loss': 0.0153, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9029, 'compress@10': 0.6204, 'time@10': 5.7844}:  87%|████████▋ | 26/30 [01:50<00:18,  4.68s/it]{'epoch': 42, 'num_users': 5.8889, 'loss': 0.0153, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9045, 'compress@10': 0.6225, 'time@10': 5.835}:  87%|████████▋ | 26/30 [01:54<00:18,  4.68s/it] {'epoch': 42, 'num_users': 5.8889, 'loss': 0.0153, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9045, 'compress@10': 0.6225, 'time@10': 5.835}:  90%|█████████ | 27/30 [01:54<00:13,  4.36s/it]{'epoch': 42, 'num_users': 6.0, 'loss': 0.0158, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9085, 'compress@10': 0.6238, 'time@10': 5.9154}:  90%|█████████ | 27/30 [02:02<00:13,  4.36s/it]  {'epoch': 42, 'num_users': 6.0, 'loss': 0.0158, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9085, 'compress@10': 0.6238, 'time@10': 5.9154}:  93%|█████████▎| 28/30 [02:02<00:10,  5.49s/it]{'epoch': 42, 'num_users': 5.8621, 'loss': 0.0158, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9101, 'compress@10': 0.6242, 'time@10': 5.9332}:  93%|█████████▎| 28/30 [02:05<00:10,  5.49s/it]{'epoch': 42, 'num_users': 5.8621, 'loss': 0.0158, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9101, 'compress@10': 0.6242, 'time@10': 5.9332}:  97%|█████████▋| 29/30 [02:05<00:04,  4.82s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0174, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9182, 'compress@10': 0.6252, 'time@10': 5.8965}:  97%|█████████▋| 29/30 [02:10<00:04,  4.82s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0174, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9182, 'compress@10': 0.6252, 'time@10': 5.8965}: 100%|██████████| 30/30 [02:10<00:00,  4.84s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0174, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9182, 'compress@10': 0.6252, 'time@10': 5.8965}: 100%|██████████| 30/30 [02:10<00:00,  4.34s/it]
Epoch: 42
Avg # of users: 5.866666666666666
Avg Loss: 0.01744616285721641
Avg hit ratio: 0.8858987893904223
Avg ndcg: 0.918221466021565
Avg compression ratio: 0.6252338125301352
Avg train time: 5.896531518300375
Std train time: 1.9229300529068885
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 26, 10, 10, 9, 6, 11, 10, 52, 51, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9272, 'compress@10': 0.6595, 'time@10': 5.9893}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9272, 'compress@10': 0.6595, 'time@10': 5.9893}:   3%|▎         | 1/30 [00:03<01:28,  3.04s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9717, 'compress@10': 0.6195, 'time@10': 5.4391}:   3%|▎         | 1/30 [00:07<01:28,  3.04s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9717, 'compress@10': 0.6195, 'time@10': 5.4391}:   7%|▋         | 2/30 [00:07<01:56,  4.16s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9335, 'compress@10': 0.616, 'time@10': 4.9806}:   7%|▋         | 2/30 [00:10<01:56,  4.16s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9335, 'compress@10': 0.616, 'time@10': 4.9806}:  10%|█         | 3/30 [00:10<01:26,  3.21s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9493, 'compress@10': 0.5621, 'time@10': 4.8196}:  10%|█         | 3/30 [00:14<01:26,  3.21s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9493, 'compress@10': 0.5621, 'time@10': 4.8196}:  13%|█▎        | 4/30 [00:14<01:35,  3.67s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9369, 'compress@10': 0.5799, 'time@10': 5.4019}:  13%|█▎        | 4/30 [00:18<01:35,  3.67s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9369, 'compress@10': 0.5799, 'time@10': 5.4019}:  17%|█▋        | 5/30 [00:18<01:33,  3.76s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.025, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9402, 'compress@10': 0.5607, 'time@10': 5.6844}:  17%|█▋        | 5/30 [00:25<01:33,  3.76s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.025, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9402, 'compress@10': 0.5607, 'time@10': 5.6844}:  20%|██        | 6/30 [00:25<01:57,  4.91s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0242, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9373, 'compress@10': 0.5809, 'time@10': 6.0128}:  20%|██        | 6/30 [00:29<01:57,  4.91s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0242, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9373, 'compress@10': 0.5809, 'time@10': 6.0128}:  23%|██▎       | 7/30 [00:29<01:46,  4.62s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0241, 'hit_ratio@10': 0.9246, 'ndcg@10': 0.936, 'compress@10': 0.5966, 'time@10': 5.9513}:  23%|██▎       | 7/30 [00:35<01:46,  4.62s/it]  {'epoch': 43, 'num_users': 6.125, 'loss': 0.0241, 'hit_ratio@10': 0.9246, 'ndcg@10': 0.936, 'compress@10': 0.5966, 'time@10': 5.9513}:  27%|██▋       | 8/30 [00:35<01:48,  4.92s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0252, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9555, 'compress@10': 0.5979, 'time@10': 6.2868}:  27%|██▋       | 8/30 [00:39<01:48,  4.92s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0252, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9555, 'compress@10': 0.5979, 'time@10': 6.2868}:  30%|███       | 9/30 [00:39<01:40,  4.80s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9579, 'compress@10': 0.5987, 'time@10': 6.3687}:  30%|███       | 9/30 [00:46<01:40,  4.80s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9579, 'compress@10': 0.5987, 'time@10': 6.3687}:  33%|███▎      | 10/30 [00:46<01:50,  5.52s/it]{'epoch': 43, 'num_users': 6.6364, 'loss': 0.023, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9551, 'compress@10': 0.603, 'time@10': 6.4687}:  33%|███▎      | 10/30 [00:50<01:50,  5.52s/it]{'epoch': 43, 'num_users': 6.6364, 'loss': 0.023, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9551, 'compress@10': 0.603, 'time@10': 6.4687}:  37%|███▋      | 11/30 [00:50<01:34,  4.99s/it]{'epoch': 43, 'num_users': 6.4167, 'loss': 0.0212, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9519, 'compress@10': 0.6057, 'time@10': 6.213}:  37%|███▋      | 11/30 [00:53<01:34,  4.99s/it]{'epoch': 43, 'num_users': 6.4167, 'loss': 0.0212, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9519, 'compress@10': 0.6057, 'time@10': 6.213}:  40%|████      | 12/30 [00:53<01:21,  4.52s/it]{'epoch': 43, 'num_users': 6.6154, 'loss': 0.0215, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9492, 'compress@10': 0.6106, 'time@10': 6.2731}:  40%|████      | 12/30 [00:57<01:21,  4.52s/it]{'epoch': 43, 'num_users': 6.6154, 'loss': 0.0215, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9492, 'compress@10': 0.6106, 'time@10': 6.2731}:  43%|████▎     | 13/30 [00:57<01:11,  4.22s/it]{'epoch': 43, 'num_users': 6.3571, 'loss': 0.02, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9409, 'compress@10': 0.6158, 'time@10': 6.0604}:  43%|████▎     | 13/30 [01:00<01:11,  4.22s/it]  {'epoch': 43, 'num_users': 6.3571, 'loss': 0.02, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9409, 'compress@10': 0.6158, 'time@10': 6.0604}:  47%|████▋     | 14/30 [01:00<01:03,  3.95s/it]{'epoch': 43, 'num_users': 6.2667, 'loss': 0.0199, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9412, 'compress@10': 0.616, 'time@10': 6.182}:  47%|████▋     | 14/30 [01:04<01:03,  3.95s/it] {'epoch': 43, 'num_users': 6.2667, 'loss': 0.0199, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9412, 'compress@10': 0.616, 'time@10': 6.182}:  50%|█████     | 15/30 [01:04<00:59,  3.96s/it]{'epoch': 43, 'num_users': 6.0625, 'loss': 0.0187, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9396, 'compress@10': 0.6155, 'time@10': 6.0213}:  50%|█████     | 15/30 [01:08<00:59,  3.96s/it]{'epoch': 43, 'num_users': 6.0625, 'loss': 0.0187, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9396, 'compress@10': 0.6155, 'time@10': 6.0213}:  53%|█████▎    | 16/30 [01:08<00:54,  3.87s/it]{'epoch': 43, 'num_users': 5.8235, 'loss': 0.0176, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9314, 'compress@10': 0.6176, 'time@10': 5.847}:  53%|█████▎    | 16/30 [01:10<00:54,  3.87s/it] {'epoch': 43, 'num_users': 5.8235, 'loss': 0.0176, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9314, 'compress@10': 0.6176, 'time@10': 5.847}:  57%|█████▋    | 17/30 [01:10<00:41,  3.18s/it]{'epoch': 43, 'num_users': 6.0556, 'loss': 0.0178, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9314, 'compress@10': 0.6226, 'time@10': 5.7571}:  57%|█████▋    | 17/30 [01:14<00:41,  3.18s/it]{'epoch': 43, 'num_users': 6.0556, 'loss': 0.0178, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9314, 'compress@10': 0.6226, 'time@10': 5.7571}:  60%|██████    | 18/30 [01:14<00:42,  3.51s/it]{'epoch': 43, 'num_users': 6.0, 'loss': 0.0173, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9311, 'compress@10': 0.6256, 'time@10': 5.68}:  60%|██████    | 18/30 [01:16<00:42,  3.51s/it]     {'epoch': 43, 'num_users': 6.0, 'loss': 0.0173, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9311, 'compress@10': 0.6256, 'time@10': 5.68}:  63%|██████▎   | 19/30 [01:16<00:34,  3.11s/it]{'epoch': 43, 'num_users': 6.15, 'loss': 0.0185, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9291, 'compress@10': 0.6223, 'time@10': 5.8241}:  63%|██████▎   | 19/30 [01:25<00:34,  3.11s/it]{'epoch': 43, 'num_users': 6.15, 'loss': 0.0185, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9291, 'compress@10': 0.6223, 'time@10': 5.8241}:  67%|██████▋   | 20/30 [01:25<00:47,  4.76s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9285, 'compress@10': 0.6242, 'time@10': 5.942}:  67%|██████▋   | 20/30 [01:29<00:47,  4.76s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9285, 'compress@10': 0.6242, 'time@10': 5.942}:  70%|███████   | 21/30 [01:29<00:41,  4.59s/it]{'epoch': 43, 'num_users': 6.1818, 'loss': 0.0195, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9293, 'compress@10': 0.6166, 'time@10': 5.8409}:  70%|███████   | 21/30 [01:33<00:41,  4.59s/it]{'epoch': 43, 'num_users': 6.1818, 'loss': 0.0195, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9293, 'compress@10': 0.6166, 'time@10': 5.8409}:  73%|███████▎  | 22/30 [01:33<00:34,  4.34s/it]{'epoch': 43, 'num_users': 6.1304, 'loss': 0.0191, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9296, 'compress@10': 0.6165, 'time@10': 5.8478}:  73%|███████▎  | 22/30 [01:36<00:34,  4.34s/it]{'epoch': 43, 'num_users': 6.1304, 'loss': 0.0191, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9296, 'compress@10': 0.6165, 'time@10': 5.8478}:  77%|███████▋  | 23/30 [01:36<00:27,  3.95s/it]{'epoch': 43, 'num_users': 5.9583, 'loss': 0.0183, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9242, 'compress@10': 0.6165, 'time@10': 5.7508}:  77%|███████▋  | 23/30 [01:39<00:27,  3.95s/it]{'epoch': 43, 'num_users': 5.9583, 'loss': 0.0183, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9242, 'compress@10': 0.6165, 'time@10': 5.7508}:  80%|████████  | 24/30 [01:39<00:22,  3.83s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9139, 'compress@10': 0.6226, 'time@10': 5.6606}:  80%|████████  | 24/30 [01:41<00:22,  3.83s/it]   {'epoch': 43, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9139, 'compress@10': 0.6226, 'time@10': 5.6606}:  83%|████████▎ | 25/30 [01:41<00:16,  3.22s/it]{'epoch': 43, 'num_users': 5.8077, 'loss': 0.0174, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9161, 'compress@10': 0.6224, 'time@10': 5.7651}:  83%|████████▎ | 25/30 [01:49<00:16,  3.22s/it]{'epoch': 43, 'num_users': 5.8077, 'loss': 0.0174, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9161, 'compress@10': 0.6224, 'time@10': 5.7651}:  87%|████████▋ | 26/30 [01:49<00:19,  4.78s/it]{'epoch': 43, 'num_users': 5.8889, 'loss': 0.0179, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9198, 'compress@10': 0.624, 'time@10': 5.8304}:  87%|████████▋ | 26/30 [01:53<00:19,  4.78s/it]{'epoch': 43, 'num_users': 5.8889, 'loss': 0.0179, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9198, 'compress@10': 0.624, 'time@10': 5.8304}:  90%|█████████ | 27/30 [01:53<00:13,  4.49s/it]{'epoch': 43, 'num_users': 6.0, 'loss': 0.0182, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9238, 'compress@10': 0.6251, 'time@10': 5.9235}:  90%|█████████ | 27/30 [02:02<00:13,  4.49s/it]  {'epoch': 43, 'num_users': 6.0, 'loss': 0.0182, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9238, 'compress@10': 0.6251, 'time@10': 5.9235}:  93%|█████████▎| 28/30 [02:02<00:11,  5.68s/it]{'epoch': 43, 'num_users': 5.8621, 'loss': 0.0181, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9249, 'compress@10': 0.625, 'time@10': 5.9401}:  93%|█████████▎| 28/30 [02:05<00:11,  5.68s/it]{'epoch': 43, 'num_users': 5.8621, 'loss': 0.0181, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9249, 'compress@10': 0.625, 'time@10': 5.9401}:  97%|█████████▋| 29/30 [02:05<00:04,  4.95s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0185, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9268, 'compress@10': 0.6249, 'time@10': 5.9061}:  97%|█████████▋| 29/30 [02:10<00:04,  4.95s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0185, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9268, 'compress@10': 0.6249, 'time@10': 5.9061}: 100%|██████████| 30/30 [02:10<00:00,  4.95s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0185, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9268, 'compress@10': 0.6249, 'time@10': 5.9061}: 100%|██████████| 30/30 [02:10<00:00,  4.34s/it]
Epoch: 43
Avg # of users: 5.866666666666666
Avg Loss: 0.018544023526468986
Avg hit ratio: 0.8953800917702067
Avg ndcg: 0.9267514349511572
Avg compression ratio: 0.6249133865385004
Avg train time: 5.906112249692281
Std train time: 1.9305191361026246
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 27, 10, 10, 9, 6, 11, 10, 52, 51, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9272, 'compress@10': 0.661, 'time@10': 5.9715}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9272, 'compress@10': 0.661, 'time@10': 5.9715}:   3%|▎         | 1/30 [00:03<01:27,  3.03s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9395, 'compress@10': 0.5589, 'time@10': 5.5895}:   3%|▎         | 1/30 [00:08<01:27,  3.03s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9395, 'compress@10': 0.5589, 'time@10': 5.5895}:   7%|▋         | 2/30 [00:08<02:02,  4.37s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.912, 'compress@10': 0.5727, 'time@10': 5.0163}:   7%|▋         | 2/30 [00:10<02:02,  4.37s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.912, 'compress@10': 0.5727, 'time@10': 5.0163}:  10%|█         | 3/30 [00:10<01:28,  3.28s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9479, 'compress@10': 0.5241, 'time@10': 4.9137}:  10%|█         | 3/30 [00:14<01:28,  3.28s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9479, 'compress@10': 0.5241, 'time@10': 4.9137}:  13%|█▎        | 4/30 [00:14<01:39,  3.82s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0208, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.936, 'compress@10': 0.5469, 'time@10': 5.6874}:  13%|█▎        | 4/30 [00:19<01:39,  3.82s/it] {'epoch': 44, 'num_users': 5.8, 'loss': 0.0208, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.936, 'compress@10': 0.5469, 'time@10': 5.6874}:  17%|█▋        | 5/30 [00:19<01:40,  4.04s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9412, 'compress@10': 0.5316, 'time@10': 5.9292}:  17%|█▋        | 5/30 [00:26<01:40,  4.04s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9412, 'compress@10': 0.5316, 'time@10': 5.9292}:  20%|██        | 6/30 [00:26<02:02,  5.11s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0188, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9427, 'compress@10': 0.5485, 'time@10': 6.2653}:  20%|██        | 6/30 [00:30<02:02,  5.11s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0188, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9427, 'compress@10': 0.5485, 'time@10': 6.2653}:  23%|██▎       | 7/30 [00:30<01:50,  4.81s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.019, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9429, 'compress@10': 0.5677, 'time@10': 6.2658}:  23%|██▎       | 7/30 [00:37<01:50,  4.81s/it]  {'epoch': 44, 'num_users': 6.125, 'loss': 0.019, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9429, 'compress@10': 0.5677, 'time@10': 6.2658}:  27%|██▋       | 8/30 [00:37<01:56,  5.29s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9409, 'compress@10': 0.5665, 'time@10': 6.5672}:  27%|██▋       | 8/30 [00:41<01:56,  5.29s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9409, 'compress@10': 0.5665, 'time@10': 6.5672}:  30%|███       | 9/30 [00:41<01:46,  5.05s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9436, 'compress@10': 0.5695, 'time@10': 6.6214}:  30%|███       | 9/30 [00:48<01:46,  5.05s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9436, 'compress@10': 0.5695, 'time@10': 6.6214}:  33%|███▎      | 10/30 [00:48<01:53,  5.70s/it]{'epoch': 44, 'num_users': 6.6364, 'loss': 0.0205, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9434, 'compress@10': 0.5756, 'time@10': 6.7011}:  33%|███▎      | 10/30 [00:52<01:53,  5.70s/it]{'epoch': 44, 'num_users': 6.6364, 'loss': 0.0205, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9434, 'compress@10': 0.5756, 'time@10': 6.7011}:  37%|███▋      | 11/30 [00:52<01:37,  5.12s/it]{'epoch': 44, 'num_users': 6.4167, 'loss': 0.0188, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9411, 'compress@10': 0.5801, 'time@10': 6.4389}:  37%|███▋      | 11/30 [00:56<01:37,  5.12s/it] {'epoch': 44, 'num_users': 6.4167, 'loss': 0.0188, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9411, 'compress@10': 0.5801, 'time@10': 6.4389}:  40%|████      | 12/30 [00:56<01:23,  4.65s/it]{'epoch': 44, 'num_users': 6.6154, 'loss': 0.0193, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9386, 'compress@10': 0.5865, 'time@10': 6.5114}:  40%|████      | 12/30 [00:59<01:23,  4.65s/it]{'epoch': 44, 'num_users': 6.6154, 'loss': 0.0193, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9386, 'compress@10': 0.5865, 'time@10': 6.5114}:  43%|████▎     | 13/30 [00:59<01:14,  4.37s/it]{'epoch': 44, 'num_users': 6.3571, 'loss': 0.0179, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9311, 'compress@10': 0.5938, 'time@10': 6.2898}:  43%|████▎     | 13/30 [01:03<01:14,  4.37s/it]{'epoch': 44, 'num_users': 6.3571, 'loss': 0.0179, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9311, 'compress@10': 0.5938, 'time@10': 6.2898}:  47%|████▋     | 14/30 [01:03<01:05,  4.10s/it]{'epoch': 44, 'num_users': 6.2667, 'loss': 0.0191, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9342, 'compress@10': 0.595, 'time@10': 6.3832}:  47%|████▋     | 14/30 [01:07<01:05,  4.10s/it] {'epoch': 44, 'num_users': 6.2667, 'loss': 0.0191, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9342, 'compress@10': 0.595, 'time@10': 6.3832}:  50%|█████     | 15/30 [01:07<01:00,  4.03s/it]{'epoch': 44, 'num_users': 6.0625, 'loss': 0.0179, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9331, 'compress@10': 0.5957, 'time@10': 6.1816}:  50%|█████     | 15/30 [01:10<01:00,  4.03s/it]{'epoch': 44, 'num_users': 6.0625, 'loss': 0.0179, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9331, 'compress@10': 0.5957, 'time@10': 6.1816}:  53%|█████▎    | 16/30 [01:10<00:52,  3.78s/it]{'epoch': 44, 'num_users': 5.8235, 'loss': 0.0169, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9253, 'compress@10': 0.5987, 'time@10': 6.0225}:  53%|█████▎    | 16/30 [01:12<00:52,  3.78s/it]{'epoch': 44, 'num_users': 5.8235, 'loss': 0.0169, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9253, 'compress@10': 0.5987, 'time@10': 6.0225}:  57%|█████▋    | 17/30 [01:12<00:41,  3.18s/it]{'epoch': 44, 'num_users': 6.0556, 'loss': 0.0174, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9266, 'compress@10': 0.6041, 'time@10': 5.9326}:  57%|█████▋    | 17/30 [01:16<00:41,  3.18s/it]{'epoch': 44, 'num_users': 6.0556, 'loss': 0.0174, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9266, 'compress@10': 0.6041, 'time@10': 5.9326}:  60%|██████    | 18/30 [01:16<00:42,  3.56s/it]{'epoch': 44, 'num_users': 6.0, 'loss': 0.0168, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9265, 'compress@10': 0.6079, 'time@10': 5.8287}:  60%|██████    | 18/30 [01:18<00:42,  3.56s/it]   {'epoch': 44, 'num_users': 6.0, 'loss': 0.0168, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9265, 'compress@10': 0.6079, 'time@10': 5.8287}:  63%|██████▎   | 19/30 [01:18<00:34,  3.10s/it]{'epoch': 44, 'num_users': 6.15, 'loss': 0.0161, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9286, 'compress@10': 0.6048, 'time@10': 5.9671}:  63%|██████▎   | 19/30 [01:27<00:34,  3.10s/it]{'epoch': 44, 'num_users': 6.15, 'loss': 0.0161, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9286, 'compress@10': 0.6048, 'time@10': 5.9671}:  67%|██████▋   | 20/30 [01:27<00:47,  4.76s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9273, 'compress@10': 0.6077, 'time@10': 6.053}:  67%|██████▋   | 20/30 [01:31<00:47,  4.76s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9273, 'compress@10': 0.6077, 'time@10': 6.053}:  70%|███████   | 21/30 [01:31<00:40,  4.51s/it]{'epoch': 44, 'num_users': 6.1818, 'loss': 0.0174, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9282, 'compress@10': 0.5999, 'time@10': 5.9394}:  70%|███████   | 21/30 [01:34<00:40,  4.51s/it]{'epoch': 44, 'num_users': 6.1818, 'loss': 0.0174, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9282, 'compress@10': 0.5999, 'time@10': 5.9394}:  73%|███████▎  | 22/30 [01:34<00:33,  4.24s/it]{'epoch': 44, 'num_users': 6.1304, 'loss': 0.0171, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9288, 'compress@10': 0.5991, 'time@10': 5.9467}:  73%|███████▎  | 22/30 [01:37<00:33,  4.24s/it]{'epoch': 44, 'num_users': 6.1304, 'loss': 0.0171, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9288, 'compress@10': 0.5991, 'time@10': 5.9467}:  77%|███████▋  | 23/30 [01:37<00:27,  3.89s/it]{'epoch': 44, 'num_users': 5.9583, 'loss': 0.0164, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9234, 'compress@10': 0.5993, 'time@10': 5.8407}:  77%|███████▋  | 23/30 [01:41<00:27,  3.89s/it]{'epoch': 44, 'num_users': 5.9583, 'loss': 0.0164, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9234, 'compress@10': 0.5993, 'time@10': 5.8407}:  80%|████████  | 24/30 [01:41<00:22,  3.76s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9132, 'compress@10': 0.6062, 'time@10': 5.741}:  80%|████████  | 24/30 [01:43<00:22,  3.76s/it]    {'epoch': 44, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9132, 'compress@10': 0.6062, 'time@10': 5.741}:  83%|████████▎ | 25/30 [01:43<00:15,  3.15s/it]{'epoch': 44, 'num_users': 5.8077, 'loss': 0.0156, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9155, 'compress@10': 0.6064, 'time@10': 5.8292}:  83%|████████▎ | 25/30 [01:51<00:15,  3.15s/it]{'epoch': 44, 'num_users': 5.8077, 'loss': 0.0156, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9155, 'compress@10': 0.6064, 'time@10': 5.8292}:  87%|████████▋ | 26/30 [01:51<00:18,  4.62s/it]{'epoch': 44, 'num_users': 5.8889, 'loss': 0.016, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9141, 'compress@10': 0.6088, 'time@10': 5.8682}:  87%|████████▋ | 26/30 [01:54<00:18,  4.62s/it] {'epoch': 44, 'num_users': 5.8889, 'loss': 0.016, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9141, 'compress@10': 0.6088, 'time@10': 5.8682}:  90%|█████████ | 27/30 [01:54<00:12,  4.28s/it]{'epoch': 44, 'num_users': 6.0, 'loss': 0.0163, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9165, 'compress@10': 0.6099, 'time@10': 5.9372}:  90%|█████████ | 27/30 [02:02<00:12,  4.28s/it]  {'epoch': 44, 'num_users': 6.0, 'loss': 0.0163, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9165, 'compress@10': 0.6099, 'time@10': 5.9372}:  93%|█████████▎| 28/30 [02:02<00:10,  5.35s/it]{'epoch': 44, 'num_users': 5.8621, 'loss': 0.0162, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9178, 'compress@10': 0.61, 'time@10': 5.9232}:  93%|█████████▎| 28/30 [02:05<00:10,  5.35s/it]{'epoch': 44, 'num_users': 5.8621, 'loss': 0.0162, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9178, 'compress@10': 0.61, 'time@10': 5.9232}:  97%|█████████▋| 29/30 [02:05<00:04,  4.59s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0164, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9199, 'compress@10': 0.6093, 'time@10': 5.9038}:  97%|█████████▋| 29/30 [02:10<00:04,  4.59s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0164, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9199, 'compress@10': 0.6093, 'time@10': 5.9038}: 100%|██████████| 30/30 [02:10<00:00,  4.82s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0164, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9199, 'compress@10': 0.6093, 'time@10': 5.9038}: 100%|██████████| 30/30 [02:10<00:00,  4.36s/it]
Epoch: 44
Avg # of users: 5.866666666666666
Avg Loss: 0.016384311052066308
Avg hit ratio: 0.8905993613490588
Avg ndcg: 0.9199476054379433
Avg compression ratio: 0.6092977787514147
Avg train time: 5.903770240147908
Std train time: 1.9196860549649466
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 27, 10, 10, 9, 6, 11, 10, 52, 51, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9272, 'compress@10': 0.6505, 'time@10': 5.9922}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9272, 'compress@10': 0.6505, 'time@10': 5.9922}:   3%|▎         | 1/30 [00:03<01:28,  3.04s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9141, 'compress@10': 0.5697, 'time@10': 5.457}:   3%|▎         | 1/30 [00:08<01:28,  3.04s/it]  {'epoch': 45, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9141, 'compress@10': 0.5697, 'time@10': 5.457}:   7%|▋         | 2/30 [00:08<01:57,  4.19s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8951, 'compress@10': 0.5758, 'time@10': 4.9301}:   7%|▋         | 2/30 [00:10<01:57,  4.19s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8951, 'compress@10': 0.5758, 'time@10': 4.9301}:  10%|█         | 3/30 [00:10<01:25,  3.18s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9106, 'compress@10': 0.5253, 'time@10': 4.7732}:  10%|█         | 3/30 [00:14<01:25,  3.18s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9106, 'compress@10': 0.5253, 'time@10': 4.7732}:  13%|█▎        | 4/30 [00:14<01:34,  3.64s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9068, 'compress@10': 0.5459, 'time@10': 5.4597}:  13%|█▎        | 4/30 [00:18<01:34,  3.64s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9068, 'compress@10': 0.5459, 'time@10': 5.4597}:  17%|█▋        | 5/30 [00:18<01:35,  3.83s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0206, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9135, 'compress@10': 0.5253, 'time@10': 5.7614}:  17%|█▋        | 5/30 [00:25<01:35,  3.83s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0206, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9135, 'compress@10': 0.5253, 'time@10': 5.7614}:  20%|██        | 6/30 [00:25<02:00,  5.01s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9149, 'compress@10': 0.5498, 'time@10': 6.0781}:  20%|██        | 6/30 [00:29<02:00,  5.01s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9149, 'compress@10': 0.5498, 'time@10': 6.0781}:  23%|██▎       | 7/30 [00:29<01:47,  4.69s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0196, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9205, 'compress@10': 0.5664, 'time@10': 6.014}:  23%|██▎       | 7/30 [00:35<01:47,  4.69s/it]  {'epoch': 45, 'num_users': 6.125, 'loss': 0.0196, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9205, 'compress@10': 0.5664, 'time@10': 6.014}:  27%|██▋       | 8/30 [00:35<01:49,  4.98s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.9247, 'compress@10': 0.5602, 'time@10': 6.3417}:  27%|██▋       | 8/30 [00:39<01:49,  4.98s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.9247, 'compress@10': 0.5602, 'time@10': 6.3417}:  30%|███       | 9/30 [00:39<01:41,  4.84s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9299, 'compress@10': 0.5624, 'time@10': 6.4207}:  30%|███       | 9/30 [00:47<01:41,  4.84s/it]    {'epoch': 45, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9299, 'compress@10': 0.5624, 'time@10': 6.4207}:  33%|███▎      | 10/30 [00:47<01:51,  5.56s/it]{'epoch': 45, 'num_users': 6.6364, 'loss': 0.0199, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9428, 'compress@10': 0.5667, 'time@10': 6.619}:  33%|███▎      | 10/30 [00:51<01:51,  5.56s/it]{'epoch': 45, 'num_users': 6.6364, 'loss': 0.0199, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9428, 'compress@10': 0.5667, 'time@10': 6.619}:  37%|███▋      | 11/30 [00:51<01:38,  5.19s/it]{'epoch': 45, 'num_users': 6.4167, 'loss': 0.0184, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9407, 'compress@10': 0.5707, 'time@10': 6.3557}:  37%|███▋      | 11/30 [00:55<01:38,  5.19s/it]{'epoch': 45, 'num_users': 6.4167, 'loss': 0.0184, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9407, 'compress@10': 0.5707, 'time@10': 6.3557}:  40%|████      | 12/30 [00:55<01:24,  4.68s/it]{'epoch': 45, 'num_users': 6.6154, 'loss': 0.0188, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9401, 'compress@10': 0.5765, 'time@10': 6.406}:  40%|████      | 12/30 [00:58<01:24,  4.68s/it]  {'epoch': 45, 'num_users': 6.6154, 'loss': 0.0188, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9401, 'compress@10': 0.5765, 'time@10': 6.406}:  43%|████▎     | 13/30 [00:58<01:13,  4.33s/it]{'epoch': 45, 'num_users': 6.3571, 'loss': 0.0175, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9325, 'compress@10': 0.5837, 'time@10': 6.1828}:  43%|████▎     | 13/30 [01:01<01:13,  4.33s/it]{'epoch': 45, 'num_users': 6.3571, 'loss': 0.0175, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9325, 'compress@10': 0.5837, 'time@10': 6.1828}:  47%|████▋     | 14/30 [01:01<01:04,  4.03s/it]{'epoch': 45, 'num_users': 6.2667, 'loss': 0.0185, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9421, 'compress@10': 0.585, 'time@10': 6.297}:  47%|████▋     | 14/30 [01:05<01:04,  4.03s/it] {'epoch': 45, 'num_users': 6.2667, 'loss': 0.0185, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9421, 'compress@10': 0.585, 'time@10': 6.297}:  50%|█████     | 15/30 [01:05<01:00,  4.02s/it]{'epoch': 45, 'num_users': 6.0625, 'loss': 0.0174, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9405, 'compress@10': 0.5857, 'time@10': 6.107}:  50%|█████     | 15/30 [01:09<01:00,  4.02s/it]{'epoch': 45, 'num_users': 6.0625, 'loss': 0.0174, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9405, 'compress@10': 0.5857, 'time@10': 6.107}:  53%|█████▎    | 16/30 [01:09<00:53,  3.80s/it]{'epoch': 45, 'num_users': 5.8235, 'loss': 0.0164, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9322, 'compress@10': 0.5886, 'time@10': 5.9369}:  53%|█████▎    | 16/30 [01:10<00:53,  3.80s/it]{'epoch': 45, 'num_users': 5.8235, 'loss': 0.0164, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9322, 'compress@10': 0.5886, 'time@10': 5.9369}:  57%|█████▋    | 17/30 [01:10<00:40,  3.15s/it]{'epoch': 45, 'num_users': 6.0556, 'loss': 0.0169, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9328, 'compress@10': 0.5939, 'time@10': 5.8617}:  57%|█████▋    | 17/30 [01:15<00:40,  3.15s/it]{'epoch': 45, 'num_users': 6.0556, 'loss': 0.0169, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9328, 'compress@10': 0.5939, 'time@10': 5.8617}:  60%|██████    | 18/30 [01:15<00:43,  3.59s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 0.0162, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9326, 'compress@10': 0.598, 'time@10': 5.7884}:  60%|██████    | 18/30 [01:17<00:43,  3.59s/it]    {'epoch': 45, 'num_users': 6.0, 'loss': 0.0162, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9326, 'compress@10': 0.598, 'time@10': 5.7884}:  63%|██████▎   | 19/30 [01:17<00:35,  3.20s/it]{'epoch': 45, 'num_users': 6.15, 'loss': 0.0173, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9314, 'compress@10': 0.5936, 'time@10': 5.9528}:  63%|██████▎   | 19/30 [01:26<00:35,  3.20s/it]{'epoch': 45, 'num_users': 6.15, 'loss': 0.0173, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9314, 'compress@10': 0.5936, 'time@10': 5.9528}:  67%|██████▋   | 20/30 [01:26<00:49,  4.98s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9309, 'compress@10': 0.5958, 'time@10': 6.0174}:  67%|██████▋   | 20/30 [01:30<00:49,  4.98s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9309, 'compress@10': 0.5958, 'time@10': 6.0174}:  70%|███████   | 21/30 [01:30<00:41,  4.59s/it]{'epoch': 45, 'num_users': 6.1818, 'loss': 0.018, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9301, 'compress@10': 0.588, 'time@10': 5.9066}:  70%|███████   | 21/30 [01:34<00:41,  4.59s/it]  {'epoch': 45, 'num_users': 6.1818, 'loss': 0.018, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9301, 'compress@10': 0.588, 'time@10': 5.9066}:  73%|███████▎  | 22/30 [01:34<00:34,  4.30s/it]{'epoch': 45, 'num_users': 6.1304, 'loss': 0.0176, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9303, 'compress@10': 0.5863, 'time@10': 5.9254}:  73%|███████▎  | 22/30 [01:37<00:34,  4.30s/it]{'epoch': 45, 'num_users': 6.1304, 'loss': 0.0176, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9303, 'compress@10': 0.5863, 'time@10': 5.9254}:  77%|███████▋  | 23/30 [01:37<00:27,  3.97s/it]{'epoch': 45, 'num_users': 5.9583, 'loss': 0.0169, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9248, 'compress@10': 0.5865, 'time@10': 5.833}:  77%|███████▋  | 23/30 [01:41<00:27,  3.97s/it] {'epoch': 45, 'num_users': 5.9583, 'loss': 0.0169, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9248, 'compress@10': 0.5865, 'time@10': 5.833}:  80%|████████  | 24/30 [01:41<00:23,  3.91s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9145, 'compress@10': 0.594, 'time@10': 5.7304}:  80%|████████  | 24/30 [01:42<00:23,  3.91s/it]   {'epoch': 45, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9145, 'compress@10': 0.594, 'time@10': 5.7304}:  83%|████████▎ | 25/30 [01:42<00:16,  3.24s/it]{'epoch': 45, 'num_users': 5.8077, 'loss': 0.016, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9167, 'compress@10': 0.594, 'time@10': 5.8264}:  83%|████████▎ | 25/30 [01:51<00:16,  3.24s/it]{'epoch': 45, 'num_users': 5.8077, 'loss': 0.016, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9167, 'compress@10': 0.594, 'time@10': 5.8264}:  87%|████████▋ | 26/30 [01:51<00:18,  4.75s/it]{'epoch': 45, 'num_users': 5.8889, 'loss': 0.0158, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9183, 'compress@10': 0.5954, 'time@10': 5.8675}:  87%|████████▋ | 26/30 [01:54<00:18,  4.75s/it]{'epoch': 45, 'num_users': 5.8889, 'loss': 0.0158, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9183, 'compress@10': 0.5954, 'time@10': 5.8675}:  90%|█████████ | 27/30 [01:54<00:13,  4.37s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 0.0162, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9229, 'compress@10': 0.5966, 'time@10': 5.939}:  90%|█████████ | 27/30 [02:02<00:13,  4.37s/it]     {'epoch': 45, 'num_users': 6.0, 'loss': 0.0162, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9229, 'compress@10': 0.5966, 'time@10': 5.939}:  93%|█████████▎| 28/30 [02:02<00:10,  5.43s/it]{'epoch': 45, 'num_users': 5.8621, 'loss': 0.0162, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.924, 'compress@10': 0.5973, 'time@10': 5.9369}:  93%|█████████▎| 28/30 [02:05<00:10,  5.43s/it]{'epoch': 45, 'num_users': 5.8621, 'loss': 0.0162, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.924, 'compress@10': 0.5973, 'time@10': 5.9369}:  97%|█████████▋| 29/30 [02:05<00:04,  4.70s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.016, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9256, 'compress@10': 0.5979, 'time@10': 5.9331}:  97%|█████████▋| 29/30 [02:11<00:04,  4.70s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.016, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9256, 'compress@10': 0.5979, 'time@10': 5.9331}: 100%|██████████| 30/30 [02:11<00:00,  5.05s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.016, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9256, 'compress@10': 0.5979, 'time@10': 5.9331}: 100%|██████████| 30/30 [02:11<00:00,  4.38s/it]
Epoch: 45
Avg # of users: 5.866666666666666
Avg Loss: 0.0160385391935616
Avg hit ratio: 0.8818786203096247
Avg ndcg: 0.9256314234876778
Avg compression ratio: 0.5978729645970329
Avg train time: 5.933094779650371
Std train time: 1.9421000635569647
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 27, 10, 10, 9, 6, 11, 10, 52, 51, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9272, 'compress@10': 0.6376, 'time@10': 6.0067}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9272, 'compress@10': 0.6376, 'time@10': 6.0067}:   3%|▎         | 1/30 [00:03<01:28,  3.04s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9657, 'compress@10': 0.5966, 'time@10': 5.3839}:   3%|▎         | 1/30 [00:07<01:28,  3.04s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9657, 'compress@10': 0.5966, 'time@10': 5.3839}:   7%|▋         | 2/30 [00:07<01:54,  4.09s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9295, 'compress@10': 0.5909, 'time@10': 5.0742}:   7%|▋         | 2/30 [00:10<01:54,  4.09s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9295, 'compress@10': 0.5909, 'time@10': 5.0742}:  10%|█         | 3/30 [00:10<01:27,  3.26s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9441, 'compress@10': 0.5278, 'time@10': 4.879}:  10%|█         | 3/30 [00:14<01:27,  3.26s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9441, 'compress@10': 0.5278, 'time@10': 4.879}:  13%|█▎        | 4/30 [00:14<01:35,  3.68s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.9337, 'compress@10': 0.5376, 'time@10': 5.5645}:  13%|█▎        | 4/30 [00:18<01:35,  3.68s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.9337, 'compress@10': 0.5376, 'time@10': 5.5645}:  17%|█▋        | 5/30 [00:18<01:36,  3.87s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0181, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9393, 'compress@10': 0.5176, 'time@10': 5.8754}:  17%|█▋        | 5/30 [00:26<01:36,  3.87s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0181, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9393, 'compress@10': 0.5176, 'time@10': 5.8754}:  20%|██        | 6/30 [00:26<02:02,  5.09s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0184, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9398, 'compress@10': 0.535, 'time@10': 6.1105}:  20%|██        | 6/30 [00:29<02:02,  5.09s/it]  {'epoch': 46, 'num_users': 6.2857, 'loss': 0.0184, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9398, 'compress@10': 0.535, 'time@10': 6.1105}:  23%|██▎       | 7/30 [00:29<01:47,  4.67s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0176, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9427, 'compress@10': 0.5514, 'time@10': 6.0467}:  23%|██▎       | 7/30 [00:35<01:47,  4.67s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0176, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9427, 'compress@10': 0.5514, 'time@10': 6.0467}:  27%|██▋       | 8/30 [00:35<01:49,  4.98s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9581, 'compress@10': 0.5493, 'time@10': 6.3718}:  27%|██▋       | 8/30 [00:40<01:49,  4.98s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9581, 'compress@10': 0.5493, 'time@10': 6.3718}:  30%|███       | 9/30 [00:40<01:41,  4.84s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.876, 'ndcg@10': 0.959, 'compress@10': 0.5529, 'time@10': 6.4487}:  30%|███       | 9/30 [00:47<01:41,  4.84s/it]     {'epoch': 46, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.876, 'ndcg@10': 0.959, 'compress@10': 0.5529, 'time@10': 6.4487}:  33%|███▎      | 10/30 [00:47<01:51,  5.56s/it]{'epoch': 46, 'num_users': 6.6364, 'loss': 0.0202, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9581, 'compress@10': 0.5601, 'time@10': 6.5436}:  33%|███▎      | 10/30 [00:51<01:51,  5.56s/it]{'epoch': 46, 'num_users': 6.6364, 'loss': 0.0202, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9581, 'compress@10': 0.5601, 'time@10': 6.5436}:  37%|███▋      | 11/30 [00:51<01:35,  5.02s/it]{'epoch': 46, 'num_users': 6.4167, 'loss': 0.0186, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9546, 'compress@10': 0.5641, 'time@10': 6.2862}:  37%|███▋      | 11/30 [00:54<01:35,  5.02s/it]{'epoch': 46, 'num_users': 6.4167, 'loss': 0.0186, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9546, 'compress@10': 0.5641, 'time@10': 6.2862}:  40%|████      | 12/30 [00:54<01:21,  4.56s/it]{'epoch': 46, 'num_users': 6.6154, 'loss': 0.0183, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.9524, 'compress@10': 0.5694, 'time@10': 6.3355}:  40%|████      | 12/30 [00:58<01:21,  4.56s/it]{'epoch': 46, 'num_users': 6.6154, 'loss': 0.0183, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.9524, 'compress@10': 0.5694, 'time@10': 6.3355}:  43%|████▎     | 13/30 [00:58<01:12,  4.24s/it]{'epoch': 46, 'num_users': 6.3571, 'loss': 0.017, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9439, 'compress@10': 0.5765, 'time@10': 6.1136}:  43%|████▎     | 13/30 [01:01<01:12,  4.24s/it] {'epoch': 46, 'num_users': 6.3571, 'loss': 0.017, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9439, 'compress@10': 0.5765, 'time@10': 6.1136}:  47%|████▋     | 14/30 [01:01<01:03,  3.94s/it]{'epoch': 46, 'num_users': 6.2667, 'loss': 0.0174, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.9429, 'compress@10': 0.5772, 'time@10': 6.2283}:  47%|████▋     | 14/30 [01:05<01:03,  3.94s/it]{'epoch': 46, 'num_users': 6.2667, 'loss': 0.0174, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.9429, 'compress@10': 0.5772, 'time@10': 6.2283}:  50%|█████     | 15/30 [01:05<00:59,  3.95s/it]{'epoch': 46, 'num_users': 6.0625, 'loss': 0.0163, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9412, 'compress@10': 0.5779, 'time@10': 6.0382}:  50%|█████     | 15/30 [01:08<00:59,  3.95s/it]{'epoch': 46, 'num_users': 6.0625, 'loss': 0.0163, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9412, 'compress@10': 0.5779, 'time@10': 6.0382}:  53%|█████▎    | 16/30 [01:08<00:52,  3.73s/it]{'epoch': 46, 'num_users': 5.8235, 'loss': 0.0154, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.9329, 'compress@10': 0.5806, 'time@10': 5.8774}:  53%|█████▎    | 16/30 [01:10<00:52,  3.73s/it]{'epoch': 46, 'num_users': 5.8235, 'loss': 0.0154, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.9329, 'compress@10': 0.5806, 'time@10': 5.8774}:  57%|█████▋    | 17/30 [01:10<00:40,  3.12s/it]{'epoch': 46, 'num_users': 6.0556, 'loss': 0.0157, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.9331, 'compress@10': 0.5866, 'time@10': 5.8001}:  57%|█████▋    | 17/30 [01:14<00:40,  3.12s/it]{'epoch': 46, 'num_users': 6.0556, 'loss': 0.0157, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.9331, 'compress@10': 0.5866, 'time@10': 5.8001}:  60%|██████    | 18/30 [01:14<00:42,  3.54s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 0.0152, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.9329, 'compress@10': 0.5911, 'time@10': 5.7196}:  60%|██████    | 18/30 [01:16<00:42,  3.54s/it]   {'epoch': 46, 'num_users': 6.0, 'loss': 0.0152, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.9329, 'compress@10': 0.5911, 'time@10': 5.7196}:  63%|██████▎   | 19/30 [01:16<00:34,  3.13s/it]{'epoch': 46, 'num_users': 6.15, 'loss': 0.0146, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9347, 'compress@10': 0.5867, 'time@10': 5.8539}:  63%|██████▎   | 19/30 [01:25<00:34,  3.13s/it]{'epoch': 46, 'num_users': 6.15, 'loss': 0.0146, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9347, 'compress@10': 0.5867, 'time@10': 5.8539}:  67%|██████▋   | 20/30 [01:25<00:47,  4.73s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9337, 'compress@10': 0.5892, 'time@10': 5.9191}:  67%|██████▋   | 20/30 [01:29<00:47,  4.73s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9337, 'compress@10': 0.5892, 'time@10': 5.9191}:  70%|███████   | 21/30 [01:29<00:39,  4.40s/it]{'epoch': 46, 'num_users': 6.1818, 'loss': 0.0157, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9331, 'compress@10': 0.581, 'time@10': 5.8127}:  70%|███████   | 21/30 [01:32<00:39,  4.40s/it] {'epoch': 46, 'num_users': 6.1818, 'loss': 0.0157, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9331, 'compress@10': 0.581, 'time@10': 5.8127}:  73%|███████▎  | 22/30 [01:32<00:33,  4.17s/it]{'epoch': 46, 'num_users': 6.1304, 'loss': 0.0155, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9335, 'compress@10': 0.5778, 'time@10': 5.8338}:  73%|███████▎  | 22/30 [01:35<00:33,  4.17s/it]{'epoch': 46, 'num_users': 6.1304, 'loss': 0.0155, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9335, 'compress@10': 0.5778, 'time@10': 5.8338}:  77%|███████▋  | 23/30 [01:35<00:27,  3.87s/it]{'epoch': 46, 'num_users': 5.9583, 'loss': 0.0148, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9279, 'compress@10': 0.578, 'time@10': 5.7329}:  77%|███████▋  | 23/30 [01:39<00:27,  3.87s/it] {'epoch': 46, 'num_users': 5.9583, 'loss': 0.0148, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9279, 'compress@10': 0.578, 'time@10': 5.7329}:  80%|████████  | 24/30 [01:39<00:22,  3.75s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9175, 'compress@10': 0.5859, 'time@10': 5.6383}:  80%|████████  | 24/30 [01:41<00:22,  3.75s/it]  {'epoch': 46, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9175, 'compress@10': 0.5859, 'time@10': 5.6383}:  83%|████████▎ | 25/30 [01:41<00:15,  3.14s/it]{'epoch': 46, 'num_users': 5.8077, 'loss': 0.0141, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9195, 'compress@10': 0.5853, 'time@10': 5.7325}:  83%|████████▎ | 25/30 [01:49<00:15,  3.14s/it]{'epoch': 46, 'num_users': 5.8077, 'loss': 0.0141, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9195, 'compress@10': 0.5853, 'time@10': 5.7325}:  87%|████████▋ | 26/30 [01:49<00:18,  4.64s/it]{'epoch': 46, 'num_users': 5.8889, 'loss': 0.0146, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9239, 'compress@10': 0.5868, 'time@10': 5.7976}:  87%|████████▋ | 26/30 [01:52<00:18,  4.64s/it]{'epoch': 46, 'num_users': 5.8889, 'loss': 0.0146, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9239, 'compress@10': 0.5868, 'time@10': 5.7976}:  90%|█████████ | 27/30 [01:52<00:13,  4.39s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 0.0149, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9268, 'compress@10': 0.5875, 'time@10': 5.8751}:  90%|█████████ | 27/30 [02:00<00:13,  4.39s/it]   {'epoch': 46, 'num_users': 6.0, 'loss': 0.0149, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9268, 'compress@10': 0.5875, 'time@10': 5.8751}:  93%|█████████▎| 28/30 [02:00<00:10,  5.47s/it]{'epoch': 46, 'num_users': 5.8621, 'loss': 0.0148, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9278, 'compress@10': 0.5892, 'time@10': 5.8663}:  93%|█████████▎| 28/30 [02:03<00:10,  5.47s/it]{'epoch': 46, 'num_users': 5.8621, 'loss': 0.0148, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9278, 'compress@10': 0.5892, 'time@10': 5.8663}:  97%|█████████▋| 29/30 [02:03<00:04,  4.69s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.0153, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9271, 'compress@10': 0.5847, 'time@10': 5.8681}:  97%|█████████▋| 29/30 [02:09<00:04,  4.69s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.0153, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9271, 'compress@10': 0.5847, 'time@10': 5.8681}: 100%|██████████| 30/30 [02:09<00:00,  5.07s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.0153, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9271, 'compress@10': 0.5847, 'time@10': 5.8681}: 100%|██████████| 30/30 [02:09<00:00,  4.33s/it]
Epoch: 46
Avg # of users: 5.866666666666666
Avg Loss: 0.015251307639442465
Avg hit ratio: 0.8753426837489277
Avg ndcg: 0.9271328414040568
Avg compression ratio: 0.5846600165636515
Avg train time: 5.868139362335205
Std train time: 1.8691872067158706
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 27, 10, 10, 9, 6, 11, 10, 52, 51, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9272, 'compress@10': 0.6314, 'time@10': 5.9697}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9272, 'compress@10': 0.6314, 'time@10': 5.9697}:   3%|▎         | 1/30 [00:03<01:27,  3.03s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.8769, 'ndcg@10': 1.01, 'compress@10': 0.5821, 'time@10': 5.4979}:   3%|▎         | 1/30 [00:08<01:27,  3.03s/it]  {'epoch': 47, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.8769, 'ndcg@10': 1.01, 'compress@10': 0.5821, 'time@10': 5.4979}:   7%|▋         | 2/30 [00:08<01:58,  4.23s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.959, 'compress@10': 0.5754, 'time@10': 5.0463}:   7%|▋         | 2/30 [00:10<01:58,  4.23s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.959, 'compress@10': 0.5754, 'time@10': 5.0463}:  10%|█         | 3/30 [00:10<01:27,  3.26s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9895, 'compress@10': 0.5129, 'time@10': 4.9034}:  10%|█         | 3/30 [00:14<01:27,  3.26s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9895, 'compress@10': 0.5129, 'time@10': 4.9034}:  13%|█▎        | 4/30 [00:14<01:37,  3.75s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0218, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9705, 'compress@10': 0.5277, 'time@10': 5.5077}:  13%|█▎        | 4/30 [00:18<01:37,  3.75s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0218, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9705, 'compress@10': 0.5277, 'time@10': 5.5077}:  17%|█▋        | 5/30 [00:18<01:36,  3.84s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0229, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9674, 'compress@10': 0.5038, 'time@10': 5.8074}:  17%|█▋        | 5/30 [00:26<01:36,  3.84s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0229, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9674, 'compress@10': 0.5038, 'time@10': 5.8074}:  20%|██        | 6/30 [00:26<02:00,  5.03s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.022, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9633, 'compress@10': 0.5283, 'time@10': 6.1193}:  20%|██        | 6/30 [00:30<02:00,  5.03s/it]  {'epoch': 47, 'num_users': 6.2857, 'loss': 0.022, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9633, 'compress@10': 0.5283, 'time@10': 6.1193}:  23%|██▎       | 7/30 [00:30<01:48,  4.71s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0207, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9625, 'compress@10': 0.5424, 'time@10': 6.0762}:  23%|██▎       | 7/30 [00:35<01:48,  4.71s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0207, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9625, 'compress@10': 0.5424, 'time@10': 6.0762}:  27%|██▋       | 8/30 [00:35<01:51,  5.06s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9601, 'compress@10': 0.5367, 'time@10': 6.3983}:  27%|██▋       | 8/30 [00:40<01:51,  5.06s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9601, 'compress@10': 0.5367, 'time@10': 6.3983}:  30%|███       | 9/30 [00:40<01:42,  4.90s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9618, 'compress@10': 0.5426, 'time@10': 6.5026}:  30%|███       | 9/30 [00:47<01:42,  4.90s/it]  {'epoch': 47, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9618, 'compress@10': 0.5426, 'time@10': 6.5026}:  33%|███▎      | 10/30 [00:47<01:53,  5.69s/it]{'epoch': 47, 'num_users': 6.6364, 'loss': 0.0201, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9649, 'compress@10': 0.5471, 'time@10': 6.6016}:  33%|███▎      | 10/30 [00:51<01:53,  5.69s/it]{'epoch': 47, 'num_users': 6.6364, 'loss': 0.0201, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9649, 'compress@10': 0.5471, 'time@10': 6.6016}:  37%|███▋      | 11/30 [00:51<01:37,  5.13s/it]{'epoch': 47, 'num_users': 6.4167, 'loss': 0.0185, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9609, 'compress@10': 0.5506, 'time@10': 6.3368}:  37%|███▋      | 11/30 [00:55<01:37,  5.13s/it]{'epoch': 47, 'num_users': 6.4167, 'loss': 0.0185, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9609, 'compress@10': 0.5506, 'time@10': 6.3368}:  40%|████      | 12/30 [00:55<01:23,  4.62s/it]{'epoch': 47, 'num_users': 6.6154, 'loss': 0.0183, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9579, 'compress@10': 0.5556, 'time@10': 6.3843}:  40%|████      | 12/30 [00:58<01:23,  4.62s/it]{'epoch': 47, 'num_users': 6.6154, 'loss': 0.0183, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9579, 'compress@10': 0.5556, 'time@10': 6.3843}:  43%|████▎     | 13/30 [00:58<01:12,  4.29s/it]{'epoch': 47, 'num_users': 6.3571, 'loss': 0.017, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.949, 'compress@10': 0.5625, 'time@10': 6.1628}:  43%|████▎     | 13/30 [01:02<01:12,  4.29s/it]  {'epoch': 47, 'num_users': 6.3571, 'loss': 0.017, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.949, 'compress@10': 0.5625, 'time@10': 6.1628}:  47%|████▋     | 14/30 [01:02<01:03,  4.00s/it]{'epoch': 47, 'num_users': 6.2667, 'loss': 0.0179, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9415, 'compress@10': 0.5633, 'time@10': 6.2341}:  47%|████▋     | 14/30 [01:05<01:03,  4.00s/it]{'epoch': 47, 'num_users': 6.2667, 'loss': 0.0179, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9415, 'compress@10': 0.5633, 'time@10': 6.2341}:  50%|█████     | 15/30 [01:05<00:58,  3.89s/it]{'epoch': 47, 'num_users': 6.0625, 'loss': 0.0168, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9399, 'compress@10': 0.5642, 'time@10': 6.056}:  50%|█████     | 15/30 [01:09<00:58,  3.89s/it] {'epoch': 47, 'num_users': 6.0625, 'loss': 0.0168, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9399, 'compress@10': 0.5642, 'time@10': 6.056}:  53%|█████▎    | 16/30 [01:09<00:54,  3.92s/it]{'epoch': 47, 'num_users': 5.8235, 'loss': 0.0158, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9317, 'compress@10': 0.5666, 'time@10': 5.9077}:  53%|█████▎    | 16/30 [01:11<00:54,  3.92s/it]{'epoch': 47, 'num_users': 5.8235, 'loss': 0.0158, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9317, 'compress@10': 0.5666, 'time@10': 5.9077}:  57%|█████▋    | 17/30 [01:11<00:42,  3.29s/it]{'epoch': 47, 'num_users': 6.0556, 'loss': 0.0162, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.932, 'compress@10': 0.5732, 'time@10': 5.8269}:  57%|█████▋    | 17/30 [01:16<00:42,  3.29s/it] {'epoch': 47, 'num_users': 6.0556, 'loss': 0.0162, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.932, 'compress@10': 0.5732, 'time@10': 5.8269}:  60%|██████    | 18/30 [01:16<00:43,  3.65s/it]{'epoch': 47, 'num_users': 6.0, 'loss': 0.0155, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9318, 'compress@10': 0.5778, 'time@10': 5.7354}:  60%|██████    | 18/30 [01:18<00:43,  3.65s/it]  {'epoch': 47, 'num_users': 6.0, 'loss': 0.0155, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9318, 'compress@10': 0.5778, 'time@10': 5.7354}:  63%|██████▎   | 19/30 [01:18<00:34,  3.18s/it]{'epoch': 47, 'num_users': 6.15, 'loss': 0.0167, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9315, 'compress@10': 0.5723, 'time@10': 5.8593}:  63%|██████▎   | 19/30 [01:26<00:34,  3.18s/it]{'epoch': 47, 'num_users': 6.15, 'loss': 0.0167, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9315, 'compress@10': 0.5723, 'time@10': 5.8593}:  67%|██████▋   | 20/30 [01:26<00:47,  4.70s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9307, 'compress@10': 0.5746, 'time@10': 5.9289}:  67%|██████▋   | 20/30 [01:30<00:47,  4.70s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9307, 'compress@10': 0.5746, 'time@10': 5.9289}:  70%|███████   | 21/30 [01:30<00:39,  4.40s/it]{'epoch': 47, 'num_users': 6.1818, 'loss': 0.0177, 'hit_ratio@10': 0.88, 'ndcg@10': 0.9312, 'compress@10': 0.5675, 'time@10': 5.8323}:  70%|███████   | 21/30 [01:33<00:39,  4.40s/it]  {'epoch': 47, 'num_users': 6.1818, 'loss': 0.0177, 'hit_ratio@10': 0.88, 'ndcg@10': 0.9312, 'compress@10': 0.5675, 'time@10': 5.8323}:  73%|███████▎  | 22/30 [01:33<00:33,  4.24s/it]{'epoch': 47, 'num_users': 6.1304, 'loss': 0.0173, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9317, 'compress@10': 0.5637, 'time@10': 5.8457}:  73%|███████▎  | 22/30 [01:37<00:33,  4.24s/it]{'epoch': 47, 'num_users': 6.1304, 'loss': 0.0173, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9317, 'compress@10': 0.5637, 'time@10': 5.8457}:  77%|███████▋  | 23/30 [01:37<00:27,  3.90s/it]{'epoch': 47, 'num_users': 5.9583, 'loss': 0.0166, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9262, 'compress@10': 0.5638, 'time@10': 5.7398}:  77%|███████▋  | 23/30 [01:40<00:27,  3.90s/it]{'epoch': 47, 'num_users': 5.9583, 'loss': 0.0166, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9262, 'compress@10': 0.5638, 'time@10': 5.7398}:  80%|████████  | 24/30 [01:40<00:22,  3.74s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9158, 'compress@10': 0.5722, 'time@10': 5.6405}:  80%|████████  | 24/30 [01:42<00:22,  3.74s/it]    {'epoch': 47, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9158, 'compress@10': 0.5722, 'time@10': 5.6405}:  83%|████████▎ | 25/30 [01:42<00:15,  3.12s/it]{'epoch': 47, 'num_users': 5.8077, 'loss': 0.0158, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9181, 'compress@10': 0.5711, 'time@10': 5.7218}:  83%|████████▎ | 25/30 [01:49<00:15,  3.12s/it]{'epoch': 47, 'num_users': 5.8077, 'loss': 0.0158, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9181, 'compress@10': 0.5711, 'time@10': 5.7218}:  87%|████████▋ | 26/30 [01:49<00:18,  4.52s/it]{'epoch': 47, 'num_users': 5.8889, 'loss': 0.0158, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9189, 'compress@10': 0.5731, 'time@10': 5.7841}:  87%|████████▋ | 26/30 [01:53<00:18,  4.52s/it] {'epoch': 47, 'num_users': 5.8889, 'loss': 0.0158, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9189, 'compress@10': 0.5731, 'time@10': 5.7841}:  90%|█████████ | 27/30 [01:53<00:12,  4.29s/it]{'epoch': 47, 'num_users': 6.0, 'loss': 0.0162, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9235, 'compress@10': 0.5736, 'time@10': 5.8323}:  90%|█████████ | 27/30 [02:00<00:12,  4.29s/it]  {'epoch': 47, 'num_users': 6.0, 'loss': 0.0162, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9235, 'compress@10': 0.5736, 'time@10': 5.8323}:  93%|█████████▎| 28/30 [02:00<00:10,  5.15s/it]{'epoch': 47, 'num_users': 5.8621, 'loss': 0.0162, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9246, 'compress@10': 0.5752, 'time@10': 5.8656}:  93%|█████████▎| 28/30 [02:04<00:10,  5.15s/it]{'epoch': 47, 'num_users': 5.8621, 'loss': 0.0162, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9246, 'compress@10': 0.5752, 'time@10': 5.8656}:  97%|█████████▋| 29/30 [02:04<00:04,  4.64s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0163, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9277, 'compress@10': 0.5734, 'time@10': 5.8699}:  97%|█████████▋| 29/30 [02:10<00:04,  4.64s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0163, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9277, 'compress@10': 0.5734, 'time@10': 5.8699}: 100%|██████████| 30/30 [02:10<00:00,  5.06s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0163, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9277, 'compress@10': 0.5734, 'time@10': 5.8699}: 100%|██████████| 30/30 [02:10<00:00,  4.34s/it]
Epoch: 47
Avg # of users: 5.866666666666666
Avg Loss: 0.01630846488132435
Avg hit ratio: 0.8828537390019183
Avg ndcg: 0.9276952601163008
Avg compression ratio: 0.5734479096514378
Avg train time: 5.869850166638693
Std train time: 1.805103284264066
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 27, 10, 10, 9, 6, 11, 10, 52, 51, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9272, 'compress@10': 0.6133, 'time@10': 5.7322}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9272, 'compress@10': 0.6133, 'time@10': 5.7322}:   3%|▎         | 1/30 [00:02<01:24,  2.91s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9439, 'compress@10': 0.5582, 'time@10': 5.3428}:   3%|▎         | 1/30 [00:07<01:24,  2.91s/it] {'epoch': 48, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9439, 'compress@10': 0.5582, 'time@10': 5.3428}:   7%|▋         | 2/30 [00:07<01:55,  4.14s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.915, 'compress@10': 0.5565, 'time@10': 4.9076}:   7%|▋         | 2/30 [00:09<01:55,  4.14s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.915, 'compress@10': 0.5565, 'time@10': 4.9076}:  10%|█         | 3/30 [00:09<01:26,  3.19s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9263, 'compress@10': 0.4967, 'time@10': 4.7912}:  10%|█         | 3/30 [00:14<01:26,  3.19s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9263, 'compress@10': 0.4967, 'time@10': 4.7912}:  13%|█▎        | 4/30 [00:14<01:36,  3.70s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9196, 'compress@10': 0.508, 'time@10': 5.4287}:  13%|█▎        | 4/30 [00:18<01:36,  3.70s/it] {'epoch': 48, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9196, 'compress@10': 0.508, 'time@10': 5.4287}:  17%|█▋        | 5/30 [00:18<01:35,  3.82s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.928, 'compress@10': 0.4874, 'time@10': 5.7756}:  17%|█▋        | 5/30 [00:26<01:35,  3.82s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.928, 'compress@10': 0.4874, 'time@10': 5.7756}:  20%|██        | 6/30 [00:26<02:02,  5.09s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9306, 'compress@10': 0.5076, 'time@10': 6.0904}:  20%|██        | 6/30 [00:30<02:02,  5.09s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9306, 'compress@10': 0.5076, 'time@10': 6.0904}:  23%|██▎       | 7/30 [00:30<01:49,  4.74s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.933, 'compress@10': 0.5202, 'time@10': 6.0267}:  23%|██▎       | 7/30 [00:35<01:49,  4.74s/it]  {'epoch': 48, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.933, 'compress@10': 0.5202, 'time@10': 6.0267}:  27%|██▋       | 8/30 [00:35<01:50,  5.03s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9361, 'compress@10': 0.5148, 'time@10': 6.3516}:  27%|██▋       | 8/30 [00:40<01:50,  5.03s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9361, 'compress@10': 0.5148, 'time@10': 6.3516}:  30%|███       | 9/30 [00:40<01:42,  4.87s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9404, 'compress@10': 0.5191, 'time@10': 6.4784}:  30%|███       | 9/30 [00:47<01:42,  4.87s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9404, 'compress@10': 0.5191, 'time@10': 6.4784}:  33%|███▎      | 10/30 [00:47<01:54,  5.73s/it]{'epoch': 48, 'num_users': 6.6364, 'loss': 0.0171, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9426, 'compress@10': 0.5238, 'time@10': 6.6726}:  33%|███▎      | 10/30 [00:52<01:54,  5.73s/it]{'epoch': 48, 'num_users': 6.6364, 'loss': 0.0171, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9426, 'compress@10': 0.5238, 'time@10': 6.6726}:  37%|███▋      | 11/30 [00:52<01:40,  5.31s/it]{'epoch': 48, 'num_users': 6.4167, 'loss': 0.0157, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9404, 'compress@10': 0.5284, 'time@10': 6.4137}:  37%|███▋      | 11/30 [00:55<01:40,  5.31s/it]{'epoch': 48, 'num_users': 6.4167, 'loss': 0.0157, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9404, 'compress@10': 0.5284, 'time@10': 6.4137}:  40%|████      | 12/30 [00:55<01:26,  4.79s/it]{'epoch': 48, 'num_users': 6.6154, 'loss': 0.0162, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9388, 'compress@10': 0.5341, 'time@10': 6.4872}:  40%|████      | 12/30 [00:59<01:26,  4.79s/it]{'epoch': 48, 'num_users': 6.6154, 'loss': 0.0162, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9388, 'compress@10': 0.5341, 'time@10': 6.4872}:  43%|████▎     | 13/30 [00:59<01:15,  4.47s/it]{'epoch': 48, 'num_users': 6.3571, 'loss': 0.015, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9313, 'compress@10': 0.5421, 'time@10': 6.2656}:  43%|████▎     | 13/30 [01:02<01:15,  4.47s/it] {'epoch': 48, 'num_users': 6.3571, 'loss': 0.015, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9313, 'compress@10': 0.5421, 'time@10': 6.2656}:  47%|████▋     | 14/30 [01:02<01:06,  4.15s/it]{'epoch': 48, 'num_users': 6.2667, 'loss': 0.0153, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9304, 'compress@10': 0.5433, 'time@10': 6.3716}:  47%|████▋     | 14/30 [01:06<01:06,  4.15s/it]{'epoch': 48, 'num_users': 6.2667, 'loss': 0.0153, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9304, 'compress@10': 0.5433, 'time@10': 6.3716}:  50%|█████     | 15/30 [01:06<01:01,  4.10s/it]{'epoch': 48, 'num_users': 6.0625, 'loss': 0.0144, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9295, 'compress@10': 0.544, 'time@10': 6.2073}:  50%|█████     | 15/30 [01:10<01:01,  4.10s/it]  {'epoch': 48, 'num_users': 6.0625, 'loss': 0.0144, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9295, 'compress@10': 0.544, 'time@10': 6.2073}:  53%|█████▎    | 16/30 [01:10<00:56,  4.00s/it]{'epoch': 48, 'num_users': 5.8235, 'loss': 0.0135, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9219, 'compress@10': 0.5463, 'time@10': 6.0549}:  53%|█████▎    | 16/30 [01:12<00:56,  4.00s/it]{'epoch': 48, 'num_users': 5.8235, 'loss': 0.0135, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9219, 'compress@10': 0.5463, 'time@10': 6.0549}:  57%|█████▋    | 17/30 [01:12<00:43,  3.36s/it]{'epoch': 48, 'num_users': 6.0556, 'loss': 0.0141, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9227, 'compress@10': 0.5534, 'time@10': 5.9693}:  57%|█████▋    | 17/30 [01:17<00:43,  3.36s/it]{'epoch': 48, 'num_users': 6.0556, 'loss': 0.0141, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9227, 'compress@10': 0.5534, 'time@10': 5.9693}:  60%|██████    | 18/30 [01:17<00:44,  3.72s/it]{'epoch': 48, 'num_users': 6.0, 'loss': 0.0136, 'hit_ratio@10': 0.877, 'ndcg@10': 0.923, 'compress@10': 0.5587, 'time@10': 5.9226}:  60%|██████    | 18/30 [01:19<00:44,  3.72s/it]     {'epoch': 48, 'num_users': 6.0, 'loss': 0.0136, 'hit_ratio@10': 0.877, 'ndcg@10': 0.923, 'compress@10': 0.5587, 'time@10': 5.9226}:  63%|██████▎   | 19/30 [01:19<00:37,  3.38s/it]{'epoch': 48, 'num_users': 6.15, 'loss': 0.0131, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9253, 'compress@10': 0.5544, 'time@10': 6.018}:  63%|██████▎   | 19/30 [01:27<00:37,  3.38s/it]{'epoch': 48, 'num_users': 6.15, 'loss': 0.0131, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9253, 'compress@10': 0.5544, 'time@10': 6.018}:  67%|██████▋   | 20/30 [01:27<00:47,  4.73s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9248, 'compress@10': 0.5567, 'time@10': 6.0953}:  67%|██████▋   | 20/30 [01:31<00:47,  4.73s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9248, 'compress@10': 0.5567, 'time@10': 6.0953}:  70%|███████   | 21/30 [01:31<00:40,  4.47s/it]{'epoch': 48, 'num_users': 6.1818, 'loss': 0.0144, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9254, 'compress@10': 0.5512, 'time@10': 5.9839}:  70%|███████   | 21/30 [01:35<00:40,  4.47s/it]{'epoch': 48, 'num_users': 6.1818, 'loss': 0.0144, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9254, 'compress@10': 0.5512, 'time@10': 5.9839}:  73%|███████▎  | 22/30 [01:35<00:33,  4.23s/it]{'epoch': 48, 'num_users': 6.1304, 'loss': 0.0142, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9262, 'compress@10': 0.5468, 'time@10': 5.9959}:  73%|███████▎  | 22/30 [01:38<00:33,  4.23s/it] {'epoch': 48, 'num_users': 6.1304, 'loss': 0.0142, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9262, 'compress@10': 0.5468, 'time@10': 5.9959}:  77%|███████▋  | 23/30 [01:38<00:27,  3.91s/it]{'epoch': 48, 'num_users': 5.9583, 'loss': 0.0136, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9209, 'compress@10': 0.5473, 'time@10': 5.892}:  77%|███████▋  | 23/30 [01:41<00:27,  3.91s/it]{'epoch': 48, 'num_users': 5.9583, 'loss': 0.0136, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9209, 'compress@10': 0.5473, 'time@10': 5.892}:  80%|████████  | 24/30 [01:41<00:22,  3.80s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0131, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9108, 'compress@10': 0.5565, 'time@10': 5.8109}:  80%|████████  | 24/30 [01:43<00:22,  3.80s/it]  {'epoch': 48, 'num_users': 5.8, 'loss': 0.0131, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9108, 'compress@10': 0.5565, 'time@10': 5.8109}:  83%|████████▎ | 25/30 [01:43<00:16,  3.25s/it]{'epoch': 48, 'num_users': 5.8077, 'loss': 0.0131, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9132, 'compress@10': 0.5554, 'time@10': 5.9147}:  83%|████████▎ | 25/30 [01:52<00:16,  3.25s/it]{'epoch': 48, 'num_users': 5.8077, 'loss': 0.0131, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9132, 'compress@10': 0.5554, 'time@10': 5.9147}:  87%|████████▋ | 26/30 [01:52<00:19,  4.84s/it]{'epoch': 48, 'num_users': 5.8889, 'loss': 0.013, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.915, 'compress@10': 0.5573, 'time@10': 5.9236}:  87%|████████▋ | 26/30 [01:55<00:19,  4.84s/it] {'epoch': 48, 'num_users': 5.8889, 'loss': 0.013, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.915, 'compress@10': 0.5573, 'time@10': 5.9236}:  90%|█████████ | 27/30 [01:55<00:12,  4.32s/it]{'epoch': 48, 'num_users': 6.0, 'loss': 0.0132, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9181, 'compress@10': 0.5577, 'time@10': 5.9714}:  90%|█████████ | 27/30 [02:02<00:12,  4.32s/it] {'epoch': 48, 'num_users': 6.0, 'loss': 0.0132, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9181, 'compress@10': 0.5577, 'time@10': 5.9714}:  93%|█████████▎| 28/30 [02:02<00:10,  5.22s/it]{'epoch': 48, 'num_users': 5.8621, 'loss': 0.0133, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9194, 'compress@10': 0.5602, 'time@10': 6.0022}:  93%|█████████▎| 28/30 [02:06<00:10,  5.22s/it]{'epoch': 48, 'num_users': 5.8621, 'loss': 0.0133, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9194, 'compress@10': 0.5602, 'time@10': 6.0022}:  97%|█████████▋| 29/30 [02:06<00:04,  4.69s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0135, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9227, 'compress@10': 0.5564, 'time@10': 6.0016}:  97%|█████████▋| 29/30 [02:12<00:04,  4.69s/it] {'epoch': 48, 'num_users': 5.8667, 'loss': 0.0135, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9227, 'compress@10': 0.5564, 'time@10': 6.0016}: 100%|██████████| 30/30 [02:12<00:00,  5.09s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0135, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9227, 'compress@10': 0.5564, 'time@10': 6.0016}: 100%|██████████| 30/30 [02:12<00:00,  4.41s/it]
Epoch: 48
Avg # of users: 5.866666666666666
Avg Loss: 0.01349579783320483
Avg hit ratio: 0.8859836784980819
Avg ndcg: 0.922748254703411
Avg compression ratio: 0.5563521512647812
Avg train time: 6.00161694685618
Std train time: 1.8158660163548364
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 27, 10, 10, 9, 6, 11, 10, 52, 51, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9272, 'compress@10': 0.6039, 'time@10': 5.9336}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9272, 'compress@10': 0.6039, 'time@10': 5.9336}:   3%|▎         | 1/30 [00:03<01:27,  3.01s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9434, 'compress@10': 0.5394, 'time@10': 5.3658}:   3%|▎         | 1/30 [00:07<01:27,  3.01s/it] {'epoch': 49, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9434, 'compress@10': 0.5394, 'time@10': 5.3658}:   7%|▋         | 2/30 [00:07<01:54,  4.09s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9147, 'compress@10': 0.5399, 'time@10': 4.9509}:   7%|▋         | 2/30 [00:09<01:54,  4.09s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9147, 'compress@10': 0.5399, 'time@10': 4.9509}:  10%|█         | 3/30 [00:09<01:25,  3.18s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9193, 'compress@10': 0.4804, 'time@10': 4.8293}:  10%|█         | 3/30 [00:14<01:25,  3.18s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9193, 'compress@10': 0.4804, 'time@10': 4.8293}:  13%|█▎        | 4/30 [00:14<01:36,  3.70s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9144, 'compress@10': 0.4968, 'time@10': 5.6577}:  13%|█▎        | 4/30 [00:18<01:36,  3.70s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9144, 'compress@10': 0.4968, 'time@10': 5.6577}:  17%|█▋        | 5/30 [00:18<01:40,  4.00s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9183, 'compress@10': 0.4702, 'time@10': 5.9024}:  17%|█▋        | 5/30 [00:26<01:40,  4.00s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9183, 'compress@10': 0.4702, 'time@10': 5.9024}:  20%|██        | 6/30 [00:26<02:01,  5.08s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9201, 'compress@10': 0.4964, 'time@10': 6.164}:  20%|██        | 6/30 [00:30<02:01,  5.08s/it] {'epoch': 49, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9201, 'compress@10': 0.4964, 'time@10': 6.164}:  23%|██▎       | 7/30 [00:30<01:47,  4.69s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9254, 'compress@10': 0.5067, 'time@10': 6.0909}:  23%|██▎       | 7/30 [00:35<01:47,  4.69s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9254, 'compress@10': 0.5067, 'time@10': 6.0909}:  27%|██▋       | 8/30 [00:35<01:49,  4.99s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.948, 'compress@10': 0.5025, 'time@10': 6.4134}:  27%|██▋       | 8/30 [00:40<01:49,  4.99s/it]  {'epoch': 49, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.948, 'compress@10': 0.5025, 'time@10': 6.4134}:  30%|███       | 9/30 [00:40<01:41,  4.85s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9518, 'compress@10': 0.5068, 'time@10': 6.4797}:  30%|███       | 9/30 [00:47<01:41,  4.85s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9518, 'compress@10': 0.5068, 'time@10': 6.4797}:  33%|███▎      | 10/30 [00:47<01:50,  5.55s/it]{'epoch': 49, 'num_users': 6.6364, 'loss': 0.02, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9506, 'compress@10': 0.5091, 'time@10': 6.5687}:  33%|███▎      | 10/30 [00:51<01:50,  5.55s/it]{'epoch': 49, 'num_users': 6.6364, 'loss': 0.02, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9506, 'compress@10': 0.5091, 'time@10': 6.5687}:  37%|███▋      | 11/30 [00:51<01:35,  5.00s/it]{'epoch': 49, 'num_users': 6.4167, 'loss': 0.0184, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9478, 'compress@10': 0.5138, 'time@10': 6.3129}:  37%|███▋      | 11/30 [00:54<01:35,  5.00s/it]{'epoch': 49, 'num_users': 6.4167, 'loss': 0.0184, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9478, 'compress@10': 0.5138, 'time@10': 6.3129}:  40%|████      | 12/30 [00:54<01:22,  4.56s/it]{'epoch': 49, 'num_users': 6.6154, 'loss': 0.0184, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9454, 'compress@10': 0.5189, 'time@10': 6.3662}:  40%|████      | 12/30 [00:58<01:22,  4.56s/it]{'epoch': 49, 'num_users': 6.6154, 'loss': 0.0184, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9454, 'compress@10': 0.5189, 'time@10': 6.3662}:  43%|████▎     | 13/30 [00:58<01:12,  4.25s/it]{'epoch': 49, 'num_users': 6.3571, 'loss': 0.0171, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9374, 'compress@10': 0.5272, 'time@10': 6.1472}:  43%|████▎     | 13/30 [01:01<01:12,  4.25s/it]{'epoch': 49, 'num_users': 6.3571, 'loss': 0.0171, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9374, 'compress@10': 0.5272, 'time@10': 6.1472}:  47%|████▋     | 14/30 [01:01<01:03,  3.98s/it]{'epoch': 49, 'num_users': 6.2667, 'loss': 0.0168, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9387, 'compress@10': 0.5288, 'time@10': 6.2176}:  47%|████▋     | 14/30 [01:05<01:03,  3.98s/it]{'epoch': 49, 'num_users': 6.2667, 'loss': 0.0168, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9387, 'compress@10': 0.5288, 'time@10': 6.2176}:  50%|█████     | 15/30 [01:05<00:58,  3.88s/it]{'epoch': 49, 'num_users': 6.0625, 'loss': 0.0158, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9373, 'compress@10': 0.5294, 'time@10': 6.0292}:  50%|█████     | 15/30 [01:08<00:58,  3.88s/it]{'epoch': 49, 'num_users': 6.0625, 'loss': 0.0158, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9373, 'compress@10': 0.5294, 'time@10': 6.0292}:  53%|█████▎    | 16/30 [01:08<00:51,  3.69s/it]{'epoch': 49, 'num_users': 5.8235, 'loss': 0.0149, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9292, 'compress@10': 0.5316, 'time@10': 5.8593}:  53%|█████▎    | 16/30 [01:10<00:51,  3.69s/it]{'epoch': 49, 'num_users': 5.8235, 'loss': 0.0149, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9292, 'compress@10': 0.5316, 'time@10': 5.8593}:  57%|█████▋    | 17/30 [01:10<00:39,  3.06s/it]{'epoch': 49, 'num_users': 6.0556, 'loss': 0.0153, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.9294, 'compress@10': 0.5389, 'time@10': 5.7685}:  57%|█████▋    | 17/30 [01:14<00:39,  3.06s/it]{'epoch': 49, 'num_users': 6.0556, 'loss': 0.0153, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.9294, 'compress@10': 0.5389, 'time@10': 5.7685}:  60%|██████    | 18/30 [01:14<00:41,  3.43s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 0.0147, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9294, 'compress@10': 0.5442, 'time@10': 5.6734}:  60%|██████    | 18/30 [01:16<00:41,  3.43s/it]   {'epoch': 49, 'num_users': 6.0, 'loss': 0.0147, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9294, 'compress@10': 0.5442, 'time@10': 5.6734}:  63%|██████▎   | 19/30 [01:16<00:33,  3.00s/it]{'epoch': 49, 'num_users': 6.15, 'loss': 0.0159, 'hit_ratio@10': 0.891, 'ndcg@10': 0.929, 'compress@10': 0.5391, 'time@10': 5.7629}:  63%|██████▎   | 19/30 [01:23<00:33,  3.00s/it] {'epoch': 49, 'num_users': 6.15, 'loss': 0.0159, 'hit_ratio@10': 0.891, 'ndcg@10': 0.929, 'compress@10': 0.5391, 'time@10': 5.7629}:  67%|██████▋   | 20/30 [01:23<00:43,  4.35s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9283, 'compress@10': 0.5413, 'time@10': 5.8012}:  67%|██████▋   | 20/30 [01:27<00:43,  4.35s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9283, 'compress@10': 0.5413, 'time@10': 5.8012}:  70%|███████   | 21/30 [01:27<00:36,  4.04s/it]{'epoch': 49, 'num_users': 6.1818, 'loss': 0.0169, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9277, 'compress@10': 0.5361, 'time@10': 5.6845}:  70%|███████   | 21/30 [01:30<00:36,  4.04s/it]{'epoch': 49, 'num_users': 6.1818, 'loss': 0.0169, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9277, 'compress@10': 0.5361, 'time@10': 5.6845}:  73%|███████▎  | 22/30 [01:30<00:30,  3.81s/it]{'epoch': 49, 'num_users': 6.1304, 'loss': 0.0166, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9283, 'compress@10': 0.5312, 'time@10': 5.6681}:  73%|███████▎  | 22/30 [01:33<00:30,  3.81s/it]{'epoch': 49, 'num_users': 6.1304, 'loss': 0.0166, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9283, 'compress@10': 0.5312, 'time@10': 5.6681}:  77%|███████▋  | 23/30 [01:33<00:24,  3.48s/it]{'epoch': 49, 'num_users': 5.9583, 'loss': 0.0159, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.923, 'compress@10': 0.5319, 'time@10': 5.5524}:  77%|███████▋  | 23/30 [01:36<00:24,  3.48s/it] {'epoch': 49, 'num_users': 5.9583, 'loss': 0.0159, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.923, 'compress@10': 0.5319, 'time@10': 5.5524}:  80%|████████  | 24/30 [01:36<00:19,  3.31s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0153, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9127, 'compress@10': 0.5415, 'time@10': 5.4441}:  80%|████████  | 24/30 [01:37<00:19,  3.31s/it]  {'epoch': 49, 'num_users': 5.8, 'loss': 0.0153, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9127, 'compress@10': 0.5415, 'time@10': 5.4441}:  83%|████████▎ | 25/30 [01:37<00:13,  2.76s/it]{'epoch': 49, 'num_users': 5.8077, 'loss': 0.015, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9152, 'compress@10': 0.54, 'time@10': 5.475}:  83%|████████▎ | 25/30 [01:43<00:13,  2.76s/it] {'epoch': 49, 'num_users': 5.8077, 'loss': 0.015, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9152, 'compress@10': 0.54, 'time@10': 5.475}:  87%|████████▋ | 26/30 [01:43<00:15,  3.82s/it]{'epoch': 49, 'num_users': 5.8889, 'loss': 0.0155, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9204, 'compress@10': 0.5418, 'time@10': 5.4591}:  87%|████████▋ | 26/30 [01:46<00:15,  3.82s/it]{'epoch': 49, 'num_users': 5.8889, 'loss': 0.0155, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9204, 'compress@10': 0.5418, 'time@10': 5.4591}:  90%|█████████ | 27/30 [01:46<00:10,  3.44s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 0.0158, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9237, 'compress@10': 0.5422, 'time@10': 5.4602}:  90%|█████████ | 27/30 [01:51<00:10,  3.44s/it]   {'epoch': 49, 'num_users': 6.0, 'loss': 0.0158, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9237, 'compress@10': 0.5422, 'time@10': 5.4602}:  93%|█████████▎| 28/30 [01:51<00:08,  4.07s/it]{'epoch': 49, 'num_users': 5.8621, 'loss': 0.0158, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9247, 'compress@10': 0.5443, 'time@10': 5.4211}:  93%|█████████▎| 28/30 [01:54<00:08,  4.07s/it]{'epoch': 49, 'num_users': 5.8621, 'loss': 0.0158, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9247, 'compress@10': 0.5443, 'time@10': 5.4211}:  97%|█████████▋| 29/30 [01:54<00:03,  3.51s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0182, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9289, 'compress@10': 0.5378, 'time@10': 5.3625}:  97%|█████████▋| 29/30 [01:57<00:03,  3.51s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0182, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9289, 'compress@10': 0.5378, 'time@10': 5.3625}: 100%|██████████| 30/30 [01:57<00:00,  3.57s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0182, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9289, 'compress@10': 0.5378, 'time@10': 5.3625}: 100%|██████████| 30/30 [01:57<00:00,  3.93s/it]
Epoch: 49
Avg # of users: 5.866666666666666
Avg Loss: 0.018169397995678804
Avg hit ratio: 0.890237048210562
Avg ndcg: 0.9289089493670741
Avg compression ratio: 0.5378000417097643
Avg train time: 5.362547651926676
Std train time: 1.8227779736444603
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 40, 8, 20, 28, 10, 10, 9, 6, 11, 10, 53, 52, 6, 8, 10, 10, 10]
