  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1816, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5191, 'compress@10': 0.0745, 'time@10': 7.2421}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1816, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5191, 'compress@10': 0.0745, 'time@10': 7.2421}:   3%|▎         | 1/30 [00:03<01:46,  3.67s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1306, 'hit_ratio@10': 0.6503, 'ndcg@10': 0.6374, 'compress@10': 0.0679, 'time@10': 6.1325}:   3%|▎         | 1/30 [00:08<01:46,  3.67s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1306, 'hit_ratio@10': 0.6503, 'ndcg@10': 0.6374, 'compress@10': 0.0679, 'time@10': 6.1325}:   7%|▋         | 2/30 [00:08<02:05,  4.49s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8092, 'hit_ratio@10': 0.5287, 'ndcg@10': 0.4249, 'compress@10': 0.1012, 'time@10': 4.7548}:   7%|▋         | 2/30 [00:09<02:05,  4.49s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8092, 'hit_ratio@10': 0.5287, 'ndcg@10': 0.4249, 'compress@10': 0.1012, 'time@10': 4.7548}:  10%|█         | 3/30 [00:09<01:18,  2.92s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6336, 'hit_ratio@10': 0.593, 'ndcg@10': 0.4748, 'compress@10': 0.0899, 'time@10': 4.6874}:  10%|█         | 3/30 [00:14<01:18,  2.92s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.6336, 'hit_ratio@10': 0.593, 'ndcg@10': 0.4748, 'compress@10': 0.0899, 'time@10': 4.6874}:  13%|█▎        | 4/30 [00:14<01:32,  3.55s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5257, 'hit_ratio@10': 0.6384, 'ndcg@10': 0.5279, 'compress@10': 0.0821, 'time@10': 6.9809}:  13%|█▎        | 4/30 [00:22<01:32,  3.55s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5257, 'hit_ratio@10': 0.6384, 'ndcg@10': 0.5279, 'compress@10': 0.0821, 'time@10': 6.9809}:  17%|█▋        | 5/30 [00:22<02:10,  5.20s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4527, 'hit_ratio@10': 0.6431, 'ndcg@10': 0.5678, 'compress@10': 0.0755, 'time@10': 7.0384}:  17%|█▋        | 5/30 [00:29<02:10,  5.20s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4527, 'hit_ratio@10': 0.6431, 'ndcg@10': 0.5678, 'compress@10': 0.0755, 'time@10': 7.0384}:  20%|██        | 6/30 [00:29<02:22,  5.94s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4044, 'hit_ratio@10': 0.6484, 'ndcg@10': 0.5707, 'compress@10': 0.0729, 'time@10': 7.177}:  20%|██        | 6/30 [00:33<02:22,  5.94s/it] {'epoch': 0, 'num_users': 6.2857, 'loss': 0.4044, 'hit_ratio@10': 0.6484, 'ndcg@10': 0.5707, 'compress@10': 0.0729, 'time@10': 7.177}:  23%|██▎       | 7/30 [00:33<02:02,  5.32s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3604, 'hit_ratio@10': 0.6816, 'ndcg@10': 0.5962, 'compress@10': 0.0701, 'time@10': 6.9846}:  23%|██▎       | 7/30 [00:39<02:02,  5.32s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3604, 'hit_ratio@10': 0.6816, 'ndcg@10': 0.5962, 'compress@10': 0.0701, 'time@10': 6.9846}:  27%|██▋       | 8/30 [00:39<01:59,  5.43s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3263, 'hit_ratio@10': 0.6884, 'ndcg@10': 0.6308, 'compress@10': 0.0678, 'time@10': 7.4681}:  27%|██▋       | 8/30 [00:45<01:59,  5.43s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3263, 'hit_ratio@10': 0.6884, 'ndcg@10': 0.6308, 'compress@10': 0.0678, 'time@10': 7.4681}:  30%|███       | 9/30 [00:45<01:55,  5.52s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2991, 'hit_ratio@10': 0.7128, 'ndcg@10': 0.6513, 'compress@10': 0.066, 'time@10': 7.429}:  30%|███       | 9/30 [00:52<01:55,  5.52s/it]     {'epoch': 0, 'num_users': 6.3, 'loss': 0.2991, 'hit_ratio@10': 0.7128, 'ndcg@10': 0.6513, 'compress@10': 0.066, 'time@10': 7.429}:  33%|███▎      | 10/30 [00:52<02:00,  6.01s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.2844, 'hit_ratio@10': 0.7144, 'ndcg@10': 0.6473, 'compress@10': 0.0657, 'time@10': 7.5097}:  33%|███▎      | 10/30 [00:56<02:00,  6.01s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.2844, 'hit_ratio@10': 0.7144, 'ndcg@10': 0.6473, 'compress@10': 0.0657, 'time@10': 7.5097}:  37%|███▋      | 11/30 [00:56<01:43,  5.46s/it]{'epoch': 0, 'num_users': 6.4167, 'loss': 0.448, 'hit_ratio@10': 0.6965, 'ndcg@10': 0.5959, 'compress@10': 0.0697, 'time@10': 7.0349}:  37%|███▋      | 11/30 [00:58<01:43,  5.46s/it] {'epoch': 0, 'num_users': 6.4167, 'loss': 0.448, 'hit_ratio@10': 0.6965, 'ndcg@10': 0.5959, 'compress@10': 0.0697, 'time@10': 7.0349}:  40%|████      | 12/30 [00:58<01:18,  4.36s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.426, 'hit_ratio@10': 0.6989, 'ndcg@10': 0.591, 'compress@10': 0.0694, 'time@10': 7.0347}:  40%|████      | 12/30 [01:01<01:18,  4.36s/it] {'epoch': 0, 'num_users': 6.6154, 'loss': 0.426, 'hit_ratio@10': 0.6989, 'ndcg@10': 0.591, 'compress@10': 0.0694, 'time@10': 7.0347}:  43%|████▎     | 13/30 [01:01<01:10,  4.12s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.5898, 'hit_ratio@10': 0.6728, 'ndcg@10': 0.5487, 'compress@10': 0.0783, 'time@10': 6.5902}:  43%|████▎     | 13/30 [01:02<01:10,  4.12s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.5898, 'hit_ratio@10': 0.6728, 'ndcg@10': 0.5487, 'compress@10': 0.0783, 'time@10': 6.5902}:  47%|████▋     | 14/30 [01:02<00:50,  3.13s/it]{'epoch': 0, 'num_users': 6.2667, 'loss': 0.5561, 'hit_ratio@10': 0.686, 'ndcg@10': 0.5595, 'compress@10': 0.0769, 'time@10': 6.8119}:  47%|████▋     | 14/30 [01:07<00:50,  3.13s/it] {'epoch': 0, 'num_users': 6.2667, 'loss': 0.5561, 'hit_ratio@10': 0.686, 'ndcg@10': 0.5595, 'compress@10': 0.0769, 'time@10': 6.8119}:  50%|█████     | 15/30 [01:07<00:55,  3.70s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.6587, 'hit_ratio@10': 0.664, 'ndcg@10': 0.5264, 'compress@10': 0.0789, 'time@10': 6.4986}:  50%|█████     | 15/30 [01:09<00:55,  3.70s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.6587, 'hit_ratio@10': 0.664, 'ndcg@10': 0.5264, 'compress@10': 0.0789, 'time@10': 6.4986}:  53%|█████▎    | 16/30 [01:09<00:43,  3.14s/it]{'epoch': 0, 'num_users': 5.8235, 'loss': 0.7548, 'hit_ratio@10': 0.6367, 'ndcg@10': 0.4955, 'compress@10': 0.0887, 'time@10': 6.1927}:  53%|█████▎    | 16/30 [01:10<00:43,  3.14s/it]{'epoch': 0, 'num_users': 5.8235, 'loss': 0.7548, 'hit_ratio@10': 0.6367, 'ndcg@10': 0.4955, 'compress@10': 0.0887, 'time@10': 6.1927}:  57%|█████▋    | 17/30 [01:10<00:31,  2.40s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 0.7193, 'hit_ratio@10': 0.6449, 'ndcg@10': 0.506, 'compress@10': 0.0867, 'time@10': 6.0979}:  57%|█████▋    | 17/30 [01:14<00:31,  2.40s/it] {'epoch': 0, 'num_users': 6.0556, 'loss': 0.7193, 'hit_ratio@10': 0.6449, 'ndcg@10': 0.506, 'compress@10': 0.0867, 'time@10': 6.0979}:  60%|██████    | 18/30 [01:14<00:36,  3.04s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.735, 'hit_ratio@10': 0.6336, 'ndcg@10': 0.4844, 'compress@10': 0.0873, 'time@10': 6.0024}:  60%|██████    | 18/30 [01:17<00:36,  3.04s/it]   {'epoch': 0, 'num_users': 6.0, 'loss': 0.735, 'hit_ratio@10': 0.6336, 'ndcg@10': 0.4844, 'compress@10': 0.0873, 'time@10': 6.0024}:  63%|██████▎   | 19/30 [01:17<00:30,  2.78s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.7018, 'hit_ratio@10': 0.644, 'ndcg@10': 0.4998, 'compress@10': 0.0849, 'time@10': 6.175}:  63%|██████▎   | 19/30 [01:26<00:30,  2.78s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.7018, 'hit_ratio@10': 0.644, 'ndcg@10': 0.4998, 'compress@10': 0.0849, 'time@10': 6.175}:  67%|██████▋   | 20/30 [01:26<00:47,  4.80s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.6725, 'hit_ratio@10': 0.649, 'ndcg@10': 0.5137, 'compress@10': 0.0835, 'time@10': 6.4992}:  67%|██████▋   | 20/30 [01:33<00:47,  4.80s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.6725, 'hit_ratio@10': 0.649, 'ndcg@10': 0.5137, 'compress@10': 0.0835, 'time@10': 6.4992}:  70%|███████   | 21/30 [01:33<00:47,  5.32s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 0.653, 'hit_ratio@10': 0.6547, 'ndcg@10': 0.5112, 'compress@10': 0.0829, 'time@10': 6.3609}:  70%|███████   | 21/30 [01:36<00:47,  5.32s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 0.653, 'hit_ratio@10': 0.6547, 'ndcg@10': 0.5112, 'compress@10': 0.0829, 'time@10': 6.3609}:  73%|███████▎  | 22/30 [01:36<00:38,  4.77s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 0.6306, 'hit_ratio@10': 0.6566, 'ndcg@10': 0.5108, 'compress@10': 0.0826, 'time@10': 6.3554}:  73%|███████▎  | 22/30 [01:39<00:38,  4.77s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 0.6306, 'hit_ratio@10': 0.6566, 'ndcg@10': 0.5108, 'compress@10': 0.0826, 'time@10': 6.3554}:  77%|███████▋  | 23/30 [01:39<00:30,  4.29s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.7051, 'hit_ratio@10': 0.6376, 'ndcg@10': 0.4895, 'compress@10': 0.0889, 'time@10': 6.1174}:  77%|███████▋  | 23/30 [01:40<00:30,  4.29s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.7051, 'hit_ratio@10': 0.6376, 'ndcg@10': 0.4895, 'compress@10': 0.0889, 'time@10': 6.1174}:  80%|████████  | 24/30 [01:40<00:19,  3.21s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.7578, 'hit_ratio@10': 0.6254, 'ndcg@10': 0.4699, 'compress@10': 0.1, 'time@10': 5.8986}:  80%|████████  | 24/30 [01:40<00:19,  3.21s/it]      {'epoch': 0, 'num_users': 5.8, 'loss': 0.7578, 'hit_ratio@10': 0.6254, 'ndcg@10': 0.4699, 'compress@10': 0.1, 'time@10': 5.8986}:  83%|████████▎ | 25/30 [01:40<00:11,  2.35s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.7322, 'hit_ratio@10': 0.6333, 'ndcg@10': 0.4811, 'compress@10': 0.0976, 'time@10': 6.183}:  83%|████████▎ | 25/30 [01:54<00:11,  2.35s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.7322, 'hit_ratio@10': 0.6333, 'ndcg@10': 0.4811, 'compress@10': 0.0976, 'time@10': 6.183}:  87%|████████▋ | 26/30 [01:54<00:22,  5.65s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 0.7079, 'hit_ratio@10': 0.6416, 'ndcg@10': 0.4886, 'compress@10': 0.0962, 'time@10': 6.2877}:  87%|████████▋ | 26/30 [01:58<00:22,  5.65s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 0.7079, 'hit_ratio@10': 0.6416, 'ndcg@10': 0.4886, 'compress@10': 0.0962, 'time@10': 6.2877}:  90%|█████████ | 27/30 [01:58<00:15,  5.32s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.6847, 'hit_ratio@10': 0.6481, 'ndcg@10': 0.5025, 'compress@10': 0.0944, 'time@10': 6.357}:  90%|█████████ | 27/30 [02:06<00:15,  5.32s/it]    {'epoch': 0, 'num_users': 6.0, 'loss': 0.6847, 'hit_ratio@10': 0.6481, 'ndcg@10': 0.5025, 'compress@10': 0.0944, 'time@10': 6.357}:  93%|█████████▎| 28/30 [02:06<00:12,  6.20s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.6657, 'hit_ratio@10': 0.6555, 'ndcg@10': 0.5039, 'compress@10': 0.0935, 'time@10': 6.3761}:  93%|█████████▎| 28/30 [02:10<00:12,  6.20s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.6657, 'hit_ratio@10': 0.6555, 'ndcg@10': 0.5039, 'compress@10': 0.0935, 'time@10': 6.3761}:  97%|█████████▋| 29/30 [02:10<00:05,  5.39s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.6455, 'hit_ratio@10': 0.6598, 'ndcg@10': 0.5169, 'compress@10': 0.0922, 'time@10': 6.3508}:  97%|█████████▋| 29/30 [02:16<00:05,  5.39s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.6455, 'hit_ratio@10': 0.6598, 'ndcg@10': 0.5169, 'compress@10': 0.0922, 'time@10': 6.3508}: 100%|██████████| 30/30 [02:16<00:00,  5.47s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.6455, 'hit_ratio@10': 0.6598, 'ndcg@10': 0.5169, 'compress@10': 0.0922, 'time@10': 6.3508}: 100%|██████████| 30/30 [02:16<00:00,  4.54s/it]
Epoch: 0
Avg # of users: 5.866666666666666
Avg Loss: 0.6455147284245121
Avg hit ratio: 0.6597684758025341
Avg ndcg: 0.5169418275425198
Avg compression ratio: 0.09220104255050994
Avg train time: 6.350846393903097
Std train time: 3.9148289911719343
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 11, 10, 8, 10, 10, 10, 9, 10, 10, 11, 10, 11, 9, 11, 11, 10, 10, 10, 9, 10, 10, 11, 11, 9, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0562, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8309, 'compress@10': 0.0646, 'time@10': 6.0853}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0562, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8309, 'compress@10': 0.0646, 'time@10': 6.0853}:   3%|▎         | 1/30 [00:03<01:29,  3.08s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0551, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8419, 'compress@10': 0.0563, 'time@10': 5.5277}:   3%|▎         | 1/30 [00:08<01:29,  3.08s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0551, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8419, 'compress@10': 0.0563, 'time@10': 5.5277}:   7%|▋         | 2/30 [00:08<01:58,  4.22s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0458, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.8133, 'compress@10': 0.0922, 'time@10': 4.4041}:   7%|▋         | 2/30 [00:09<01:58,  4.22s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0458, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.8133, 'compress@10': 0.0922, 'time@10': 4.4041}:  10%|█         | 3/30 [00:09<01:15,  2.80s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.047, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.821, 'compress@10': 0.0838, 'time@10': 4.4026}:  10%|█         | 3/30 [00:13<01:15,  2.80s/it]  {'epoch': 1, 'num_users': 5.0, 'loss': 0.047, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.821, 'compress@10': 0.0838, 'time@10': 4.4026}:  13%|█▎        | 4/30 [00:13<01:29,  3.45s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0556, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8105, 'compress@10': 0.0772, 'time@10': 6.1221}:  13%|█▎        | 4/30 [00:20<01:29,  3.45s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0556, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8105, 'compress@10': 0.0772, 'time@10': 6.1221}:  17%|█▋        | 5/30 [00:20<01:54,  4.56s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0595, 'hit_ratio@10': 0.7803, 'ndcg@10': 0.8107, 'compress@10': 0.0709, 'time@10': 6.314}:  17%|█▋        | 5/30 [00:27<01:54,  4.56s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0595, 'hit_ratio@10': 0.7803, 'ndcg@10': 0.8107, 'compress@10': 0.0709, 'time@10': 6.314}:  20%|██        | 6/30 [00:27<02:11,  5.50s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0574, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.8195, 'compress@10': 0.0693, 'time@10': 6.5472}:  20%|██        | 6/30 [00:31<02:11,  5.50s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0574, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.8195, 'compress@10': 0.0693, 'time@10': 6.5472}:  23%|██▎       | 7/30 [00:31<01:55,  5.01s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0549, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8262, 'compress@10': 0.0667, 'time@10': 6.4273}:  23%|██▎       | 7/30 [00:37<01:55,  5.01s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0549, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8262, 'compress@10': 0.0667, 'time@10': 6.4273}:  27%|██▋       | 8/30 [00:37<01:54,  5.21s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0528, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.836, 'compress@10': 0.0635, 'time@10': 6.8249}:  27%|██▋       | 8/30 [00:42<01:54,  5.21s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0528, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.836, 'compress@10': 0.0635, 'time@10': 6.8249}:  30%|███       | 9/30 [00:42<01:48,  5.16s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0522, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8368, 'compress@10': 0.0615, 'time@10': 6.8557}:  30%|███       | 9/30 [00:49<01:48,  5.16s/it]  {'epoch': 1, 'num_users': 6.3, 'loss': 0.0522, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8368, 'compress@10': 0.0615, 'time@10': 6.8557}:  33%|███▎      | 10/30 [00:49<01:55,  5.78s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.0538, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.839, 'compress@10': 0.0608, 'time@10': 6.9883}:  33%|███▎      | 10/30 [00:53<01:55,  5.78s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.0538, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.839, 'compress@10': 0.0608, 'time@10': 6.9883}:  37%|███▋      | 11/30 [00:53<01:40,  5.30s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.0519, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8432, 'compress@10': 0.0641, 'time@10': 6.5718}:  37%|███▋      | 11/30 [00:55<01:40,  5.30s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.0519, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8432, 'compress@10': 0.0641, 'time@10': 6.5718}:  40%|████      | 12/30 [00:55<01:17,  4.30s/it]{'epoch': 1, 'num_users': 6.6154, 'loss': 0.0522, 'hit_ratio@10': 0.8107, 'ndcg@10': 0.8452, 'compress@10': 0.0643, 'time@10': 6.6016}:  40%|████      | 12/30 [00:59<01:17,  4.30s/it]{'epoch': 1, 'num_users': 6.6154, 'loss': 0.0522, 'hit_ratio@10': 0.8107, 'ndcg@10': 0.8452, 'compress@10': 0.0643, 'time@10': 6.6016}:  43%|████▎     | 13/30 [00:59<01:09,  4.07s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.0583, 'hit_ratio@10': 0.8004, 'ndcg@10': 0.8303, 'compress@10': 0.0722, 'time@10': 6.1912}:  43%|████▎     | 13/30 [01:00<01:09,  4.07s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.0583, 'hit_ratio@10': 0.8004, 'ndcg@10': 0.8303, 'compress@10': 0.0722, 'time@10': 6.1912}:  47%|████▋     | 14/30 [01:00<00:49,  3.11s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.0583, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8334, 'compress@10': 0.0704, 'time@10': 6.4129}:  47%|████▋     | 14/30 [01:04<00:49,  3.11s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.0583, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8334, 'compress@10': 0.0704, 'time@10': 6.4129}:  50%|█████     | 15/30 [01:04<00:54,  3.62s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.0562, 'hit_ratio@10': 0.8057, 'ndcg@10': 0.8357, 'compress@10': 0.0728, 'time@10': 6.1643}:  50%|█████     | 15/30 [01:07<00:54,  3.62s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.0562, 'hit_ratio@10': 0.8057, 'ndcg@10': 0.8357, 'compress@10': 0.0728, 'time@10': 6.1643}:  53%|█████▎    | 16/30 [01:07<00:45,  3.27s/it]{'epoch': 1, 'num_users': 5.8235, 'loss': 0.0628, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8079, 'compress@10': 0.082, 'time@10': 5.89}:  53%|█████▎    | 16/30 [01:08<00:45,  3.27s/it]   {'epoch': 1, 'num_users': 5.8235, 'loss': 0.0628, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8079, 'compress@10': 0.082, 'time@10': 5.89}:  57%|█████▋    | 17/30 [01:08<00:32,  2.53s/it]{'epoch': 1, 'num_users': 6.0556, 'loss': 0.063, 'hit_ratio@10': 0.769, 'ndcg@10': 0.8101, 'compress@10': 0.0803, 'time@10': 5.8221}:  57%|█████▋    | 17/30 [01:12<00:32,  2.53s/it]{'epoch': 1, 'num_users': 6.0556, 'loss': 0.063, 'hit_ratio@10': 0.769, 'ndcg@10': 0.8101, 'compress@10': 0.0803, 'time@10': 5.8221}:  60%|██████    | 18/30 [01:12<00:38,  3.18s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.0612, 'hit_ratio@10': 0.7774, 'ndcg@10': 0.8129, 'compress@10': 0.0811, 'time@10': 5.7632}:  60%|██████    | 18/30 [01:15<00:38,  3.18s/it] {'epoch': 1, 'num_users': 6.0, 'loss': 0.0612, 'hit_ratio@10': 0.7774, 'ndcg@10': 0.8129, 'compress@10': 0.0811, 'time@10': 5.7632}:  63%|██████▎   | 19/30 [01:15<00:32,  2.95s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.0614, 'hit_ratio@10': 0.7815, 'ndcg@10': 0.8121, 'compress@10': 0.0789, 'time@10': 5.9451}:  63%|██████▎   | 19/30 [01:24<00:32,  2.95s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.0614, 'hit_ratio@10': 0.7815, 'ndcg@10': 0.8121, 'compress@10': 0.0789, 'time@10': 5.9451}:  67%|██████▋   | 20/30 [01:24<00:48,  4.90s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0621, 'hit_ratio@10': 0.7824, 'ndcg@10': 0.812, 'compress@10': 0.0774, 'time@10': 6.2151}:  67%|██████▋   | 20/30 [01:30<00:48,  4.90s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0621, 'hit_ratio@10': 0.7824, 'ndcg@10': 0.812, 'compress@10': 0.0774, 'time@10': 6.2151}:  70%|███████   | 21/30 [01:30<00:46,  5.18s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.0611, 'hit_ratio@10': 0.7881, 'ndcg@10': 0.8158, 'compress@10': 0.0767, 'time@10': 6.0883}:  70%|███████   | 21/30 [01:33<00:46,  5.18s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.0611, 'hit_ratio@10': 0.7881, 'ndcg@10': 0.8158, 'compress@10': 0.0767, 'time@10': 6.0883}:  73%|███████▎  | 22/30 [01:33<00:37,  4.67s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.0597, 'hit_ratio@10': 0.7908, 'ndcg@10': 0.8192, 'compress@10': 0.0764, 'time@10': 6.0986}:  73%|███████▎  | 22/30 [01:37<00:37,  4.67s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.0597, 'hit_ratio@10': 0.7908, 'ndcg@10': 0.8192, 'compress@10': 0.0764, 'time@10': 6.0986}:  77%|███████▋  | 23/30 [01:37<00:29,  4.23s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.0637, 'hit_ratio@10': 0.7662, 'ndcg@10': 0.8012, 'compress@10': 0.0821, 'time@10': 5.8744}:  77%|███████▋  | 23/30 [01:37<00:29,  4.23s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.0637, 'hit_ratio@10': 0.7662, 'ndcg@10': 0.8012, 'compress@10': 0.0821, 'time@10': 5.8744}:  80%|████████  | 24/30 [01:37<00:19,  3.19s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.087, 'hit_ratio@10': 0.7489, 'ndcg@10': 0.7719, 'compress@10': 0.0931, 'time@10': 5.6686}:  80%|████████  | 24/30 [01:38<00:19,  3.19s/it]    {'epoch': 1, 'num_users': 5.8, 'loss': 0.087, 'hit_ratio@10': 0.7489, 'ndcg@10': 0.7719, 'compress@10': 0.0931, 'time@10': 5.6686}:  83%|████████▎ | 25/30 [01:38<00:11,  2.35s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.0869, 'hit_ratio@10': 0.7529, 'ndcg@10': 0.772, 'compress@10': 0.0912, 'time@10': 5.9248}:  83%|████████▎ | 25/30 [01:50<00:11,  2.35s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.0869, 'hit_ratio@10': 0.7529, 'ndcg@10': 0.772, 'compress@10': 0.0912, 'time@10': 5.9248}:  87%|████████▋ | 26/30 [01:50<00:21,  5.36s/it]{'epoch': 1, 'num_users': 5.8889, 'loss': 0.0849, 'hit_ratio@10': 0.7607, 'ndcg@10': 0.7764, 'compress@10': 0.0898, 'time@10': 6.0423}:  87%|████████▋ | 26/30 [01:55<00:21,  5.36s/it]{'epoch': 1, 'num_users': 5.8889, 'loss': 0.0849, 'hit_ratio@10': 0.7607, 'ndcg@10': 0.7764, 'compress@10': 0.0898, 'time@10': 6.0423}:  90%|█████████ | 27/30 [01:55<00:15,  5.13s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.0838, 'hit_ratio@10': 0.7637, 'ndcg@10': 0.7799, 'compress@10': 0.0887, 'time@10': 6.1235}:  90%|█████████ | 27/30 [02:03<00:15,  5.13s/it]   {'epoch': 1, 'num_users': 6.0, 'loss': 0.0838, 'hit_ratio@10': 0.7637, 'ndcg@10': 0.7799, 'compress@10': 0.0887, 'time@10': 6.1235}:  93%|█████████▎| 28/30 [02:03<00:12,  6.10s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.0816, 'hit_ratio@10': 0.7687, 'ndcg@10': 0.7842, 'compress@10': 0.0879, 'time@10': 6.1492}:  93%|█████████▎| 28/30 [02:07<00:12,  6.10s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.0816, 'hit_ratio@10': 0.7687, 'ndcg@10': 0.7842, 'compress@10': 0.0879, 'time@10': 6.1492}:  97%|█████████▋| 29/30 [02:07<00:05,  5.31s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.0802, 'hit_ratio@10': 0.7692, 'ndcg@10': 0.7879, 'compress@10': 0.0868, 'time@10': 6.1224}:  97%|█████████▋| 29/30 [02:12<00:05,  5.31s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.0802, 'hit_ratio@10': 0.7692, 'ndcg@10': 0.7879, 'compress@10': 0.0868, 'time@10': 6.1224}: 100%|██████████| 30/30 [02:12<00:00,  5.33s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.0802, 'hit_ratio@10': 0.7692, 'ndcg@10': 0.7879, 'compress@10': 0.0868, 'time@10': 6.1224}: 100%|██████████| 30/30 [02:12<00:00,  4.42s/it]
Epoch: 1
Avg # of users: 5.866666666666666
Avg Loss: 0.08018196663961924
Avg hit ratio: 0.7692033804769128
Avg ndcg: 0.7879481119610958
Avg compression ratio: 0.08677283123922357
Avg train time: 6.122431755065918
Std train time: 3.4116563609383164
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 12, 10, 7, 10, 10, 10, 8, 10, 10, 12, 10, 12, 9, 12, 12, 10, 10, 10, 8, 10, 10, 12, 12, 8, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.0641, 'time@10': 5.9272}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.0641, 'time@10': 5.9272}:   3%|▎         | 1/30 [00:03<01:27,  3.00s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8516, 'compress@10': 0.0554, 'time@10': 5.4653}:   3%|▎         | 1/30 [00:08<01:27,  3.00s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8516, 'compress@10': 0.0554, 'time@10': 5.4653}:   7%|▋         | 2/30 [00:08<01:57,  4.20s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0349, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8534, 'compress@10': 0.0936, 'time@10': 4.437}:   7%|▋         | 2/30 [00:09<01:57,  4.20s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.0349, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8534, 'compress@10': 0.0936, 'time@10': 4.437}:  10%|█         | 3/30 [00:09<01:16,  2.85s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0384, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8498, 'compress@10': 0.0839, 'time@10': 4.4384}:  10%|█         | 3/30 [00:13<01:16,  2.85s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0384, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8498, 'compress@10': 0.0839, 'time@10': 4.4384}:  13%|█▎        | 4/30 [00:13<01:30,  3.49s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0489, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8351, 'compress@10': 0.0766, 'time@10': 5.8359}:  13%|█▎        | 4/30 [00:19<01:30,  3.49s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0489, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8351, 'compress@10': 0.0766, 'time@10': 5.8359}:  17%|█▋        | 5/30 [00:19<01:47,  4.31s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0536, 'hit_ratio@10': 0.7874, 'ndcg@10': 0.8332, 'compress@10': 0.071, 'time@10': 6.0812}:  17%|█▋        | 5/30 [00:26<01:47,  4.31s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0536, 'hit_ratio@10': 0.7874, 'ndcg@10': 0.8332, 'compress@10': 0.071, 'time@10': 6.0812}:  20%|██        | 6/30 [00:26<02:08,  5.34s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0519, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8364, 'compress@10': 0.0691, 'time@10': 6.3412}:  20%|██        | 6/30 [00:30<02:08,  5.34s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0519, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8364, 'compress@10': 0.0691, 'time@10': 6.3412}:  23%|██▎       | 7/30 [00:30<01:52,  4.90s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0512, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8423, 'compress@10': 0.0667, 'time@10': 6.2454}:  23%|██▎       | 7/30 [00:36<01:52,  4.90s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0512, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8423, 'compress@10': 0.0667, 'time@10': 6.2454}:  27%|██▋       | 8/30 [00:36<01:52,  5.13s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8125, 'ndcg@10': 0.8499, 'compress@10': 0.0637, 'time@10': 6.5483}:  27%|██▋       | 8/30 [00:40<01:52,  5.13s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8125, 'ndcg@10': 0.8499, 'compress@10': 0.0637, 'time@10': 6.5483}:  30%|███       | 9/30 [00:40<01:43,  4.94s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.85, 'compress@10': 0.0619, 'time@10': 6.6061}:  30%|███       | 9/30 [00:48<01:43,  4.94s/it]     {'epoch': 2, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.85, 'compress@10': 0.0619, 'time@10': 6.6061}:  33%|███▎      | 10/30 [00:48<01:52,  5.63s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.0504, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8514, 'compress@10': 0.0613, 'time@10': 6.7636}:  33%|███▎      | 10/30 [00:52<01:52,  5.63s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.0504, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8514, 'compress@10': 0.0613, 'time@10': 6.7636}:  37%|███▋      | 11/30 [00:52<01:38,  5.19s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0479, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8576, 'compress@10': 0.0649, 'time@10': 6.3807}:  37%|███▋      | 11/30 [00:54<01:38,  5.19s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0479, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8576, 'compress@10': 0.0649, 'time@10': 6.3807}:  40%|████      | 12/30 [00:54<01:17,  4.29s/it]{'epoch': 2, 'num_users': 6.6154, 'loss': 0.0481, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8588, 'compress@10': 0.0649, 'time@10': 6.4238}:  40%|████      | 12/30 [00:58<01:17,  4.29s/it] {'epoch': 2, 'num_users': 6.6154, 'loss': 0.0481, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8588, 'compress@10': 0.0649, 'time@10': 6.4238}:  43%|████▎     | 13/30 [00:58<01:08,  4.05s/it]{'epoch': 2, 'num_users': 6.3571, 'loss': 0.0475, 'hit_ratio@10': 0.8035, 'ndcg@10': 0.8515, 'compress@10': 0.073, 'time@10': 6.0355}:  43%|████▎     | 13/30 [00:59<01:08,  4.05s/it]{'epoch': 2, 'num_users': 6.3571, 'loss': 0.0475, 'hit_ratio@10': 0.8035, 'ndcg@10': 0.8515, 'compress@10': 0.073, 'time@10': 6.0355}:  47%|████▋     | 14/30 [00:59<00:50,  3.14s/it]{'epoch': 2, 'num_users': 6.2667, 'loss': 0.0482, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.8534, 'compress@10': 0.0711, 'time@10': 6.2245}:  47%|████▋     | 14/30 [01:03<00:50,  3.14s/it]{'epoch': 2, 'num_users': 6.2667, 'loss': 0.0482, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.8534, 'compress@10': 0.0711, 'time@10': 6.2245}:  50%|█████     | 15/30 [01:03<00:53,  3.54s/it]{'epoch': 2, 'num_users': 6.0625, 'loss': 0.0463, 'hit_ratio@10': 0.8188, 'ndcg@10': 0.8556, 'compress@10': 0.0728, 'time@10': 5.9694}:  50%|█████     | 15/30 [01:05<00:53,  3.54s/it]{'epoch': 2, 'num_users': 6.0625, 'loss': 0.0463, 'hit_ratio@10': 0.8188, 'ndcg@10': 0.8556, 'compress@10': 0.0728, 'time@10': 5.9694}:  53%|█████▎    | 16/30 [01:05<00:43,  3.13s/it]{'epoch': 2, 'num_users': 5.8235, 'loss': 0.0462, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8421, 'compress@10': 0.0816, 'time@10': 5.7118}:  53%|█████▎    | 16/30 [01:06<00:43,  3.13s/it]{'epoch': 2, 'num_users': 5.8235, 'loss': 0.0462, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8421, 'compress@10': 0.0816, 'time@10': 5.7118}:  57%|█████▋    | 17/30 [01:06<00:31,  2.44s/it]{'epoch': 2, 'num_users': 6.0556, 'loss': 0.0472, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8427, 'compress@10': 0.0801, 'time@10': 5.6436}:  57%|█████▋    | 17/30 [01:11<00:31,  2.44s/it] {'epoch': 2, 'num_users': 6.0556, 'loss': 0.0472, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8427, 'compress@10': 0.0801, 'time@10': 5.6436}:  60%|██████    | 18/30 [01:11<00:36,  3.07s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.0458, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8457, 'compress@10': 0.0808, 'time@10': 5.5698}:  60%|██████    | 18/30 [01:13<00:36,  3.07s/it]  {'epoch': 2, 'num_users': 6.0, 'loss': 0.0458, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8457, 'compress@10': 0.0808, 'time@10': 5.5698}:  63%|██████▎   | 19/30 [01:13<00:30,  2.80s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.0465, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8441, 'compress@10': 0.0787, 'time@10': 5.7546}:  63%|██████▎   | 19/30 [01:22<00:30,  2.80s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.0465, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8441, 'compress@10': 0.0787, 'time@10': 5.7546}:  67%|██████▋   | 20/30 [01:22<00:47,  4.75s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0479, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.8423, 'compress@10': 0.0773, 'time@10': 5.9809}:  67%|██████▋   | 20/30 [01:27<00:47,  4.75s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0479, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.8423, 'compress@10': 0.0773, 'time@10': 5.9809}:  70%|███████   | 21/30 [01:27<00:44,  4.91s/it]{'epoch': 2, 'num_users': 6.1818, 'loss': 0.0474, 'hit_ratio@10': 0.8197, 'ndcg@10': 0.845, 'compress@10': 0.0767, 'time@10': 5.8632}:  70%|███████   | 21/30 [01:31<00:44,  4.91s/it] {'epoch': 2, 'num_users': 6.1818, 'loss': 0.0474, 'hit_ratio@10': 0.8197, 'ndcg@10': 0.845, 'compress@10': 0.0767, 'time@10': 5.8632}:  73%|███████▎  | 22/30 [01:31<00:35,  4.47s/it]{'epoch': 2, 'num_users': 6.1304, 'loss': 0.0464, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8473, 'compress@10': 0.0764, 'time@10': 5.879}:  73%|███████▎  | 22/30 [01:34<00:35,  4.47s/it] {'epoch': 2, 'num_users': 6.1304, 'loss': 0.0464, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8473, 'compress@10': 0.0764, 'time@10': 5.879}:  77%|███████▋  | 23/30 [01:34<00:28,  4.07s/it]{'epoch': 2, 'num_users': 5.9583, 'loss': 0.0474, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8347, 'compress@10': 0.0823, 'time@10': 5.6666}:  77%|███████▋  | 23/30 [01:35<00:28,  4.07s/it]{'epoch': 2, 'num_users': 5.9583, 'loss': 0.0474, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8347, 'compress@10': 0.0823, 'time@10': 5.6666}:  80%|████████  | 24/30 [01:35<00:18,  3.10s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0496, 'hit_ratio@10': 0.8007, 'ndcg@10': 0.8172, 'compress@10': 0.0931, 'time@10': 5.4714}:  80%|████████  | 24/30 [01:35<00:18,  3.10s/it]   {'epoch': 2, 'num_users': 5.8, 'loss': 0.0496, 'hit_ratio@10': 0.8007, 'ndcg@10': 0.8172, 'compress@10': 0.0931, 'time@10': 5.4714}:  83%|████████▎ | 25/30 [01:35<00:11,  2.30s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.0508, 'hit_ratio@10': 0.8027, 'ndcg@10': 0.8158, 'compress@10': 0.0911, 'time@10': 5.6726}:  83%|████████▎ | 25/30 [01:46<00:11,  2.30s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.0508, 'hit_ratio@10': 0.8027, 'ndcg@10': 0.8158, 'compress@10': 0.0911, 'time@10': 5.6726}:  87%|████████▋ | 26/30 [01:46<00:19,  4.83s/it]{'epoch': 2, 'num_users': 5.8889, 'loss': 0.05, 'hit_ratio@10': 0.8087, 'ndcg@10': 0.8185, 'compress@10': 0.0897, 'time@10': 5.7935}:  87%|████████▋ | 26/30 [01:51<00:19,  4.83s/it]  {'epoch': 2, 'num_users': 5.8889, 'loss': 0.05, 'hit_ratio@10': 0.8087, 'ndcg@10': 0.8185, 'compress@10': 0.0897, 'time@10': 5.7935}:  90%|█████████ | 27/30 [01:51<00:14,  4.74s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.0502, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8202, 'compress@10': 0.0886, 'time@10': 5.8819}:  90%|█████████ | 27/30 [01:59<00:14,  4.74s/it] {'epoch': 2, 'num_users': 6.0, 'loss': 0.0502, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8202, 'compress@10': 0.0886, 'time@10': 5.8819}:  93%|█████████▎| 28/30 [01:59<00:11,  5.81s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.049, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.823, 'compress@10': 0.0876, 'time@10': 5.9126}:  93%|█████████▎| 28/30 [02:02<00:11,  5.81s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.049, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.823, 'compress@10': 0.0876, 'time@10': 5.9126}:  97%|█████████▋| 29/30 [02:02<00:05,  5.09s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0487, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.8254, 'compress@10': 0.0864, 'time@10': 5.899}:  97%|█████████▋| 29/30 [02:08<00:05,  5.09s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0487, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.8254, 'compress@10': 0.0864, 'time@10': 5.899}: 100%|██████████| 30/30 [02:08<00:00,  5.23s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0487, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.8254, 'compress@10': 0.0864, 'time@10': 5.899}: 100%|██████████| 30/30 [02:08<00:00,  4.28s/it]
Epoch: 2
Avg # of users: 5.866666666666666
Avg Loss: 0.048701131763572006
Avg hit ratio: 0.8118836400978995
Avg ndcg: 0.8253995026322126
Avg compression ratio: 0.08642952608531425
Avg train time: 5.899029223124186
Std train time: 3.0787955589058016
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 13, 10, 6, 10, 10, 10, 8, 10, 10, 13, 10, 13, 9, 13, 13, 10, 10, 10, 7, 10, 10, 13, 13, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8501, 'compress@10': 0.0651, 'time@10': 5.982}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8501, 'compress@10': 0.0651, 'time@10': 5.982}:   3%|▎         | 1/30 [00:03<01:27,  3.03s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8509, 'compress@10': 0.0562, 'time@10': 5.4428}:   3%|▎         | 1/30 [00:07<01:27,  3.03s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8509, 'compress@10': 0.0562, 'time@10': 5.4428}:   7%|▋         | 2/30 [00:07<01:56,  4.16s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0334, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.853, 'compress@10': 0.0916, 'time@10': 4.4536}:   7%|▋         | 2/30 [00:09<01:56,  4.16s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0334, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.853, 'compress@10': 0.0916, 'time@10': 4.4536}:  10%|█         | 3/30 [00:09<01:16,  2.84s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8511, 'compress@10': 0.0823, 'time@10': 4.424}:  10%|█         | 3/30 [00:13<01:16,  2.84s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8511, 'compress@10': 0.0823, 'time@10': 4.424}:  13%|█▎        | 4/30 [00:13<01:29,  3.45s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0482, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8353, 'compress@10': 0.0753, 'time@10': 5.5457}:  13%|█▎        | 4/30 [00:18<01:29,  3.45s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0482, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8353, 'compress@10': 0.0753, 'time@10': 5.5457}:  17%|█▋        | 5/30 [00:18<01:40,  4.03s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0526, 'hit_ratio@10': 0.7763, 'ndcg@10': 0.8326, 'compress@10': 0.07, 'time@10': 5.7881}:  17%|█▋        | 5/30 [00:25<01:40,  4.03s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0526, 'hit_ratio@10': 0.7763, 'ndcg@10': 0.8326, 'compress@10': 0.07, 'time@10': 5.7881}:  20%|██        | 6/30 [00:25<02:01,  5.05s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0516, 'hit_ratio@10': 0.8026, 'ndcg@10': 0.8317, 'compress@10': 0.0687, 'time@10': 6.1097}:  20%|██        | 6/30 [00:29<02:01,  5.05s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0516, 'hit_ratio@10': 0.8026, 'ndcg@10': 0.8317, 'compress@10': 0.0687, 'time@10': 6.1097}:  23%|██▎       | 7/30 [00:29<01:48,  4.73s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0528, 'hit_ratio@10': 0.8165, 'ndcg@10': 0.8449, 'compress@10': 0.0666, 'time@10': 6.0482}:  23%|██▎       | 7/30 [00:35<01:48,  4.73s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0528, 'hit_ratio@10': 0.8165, 'ndcg@10': 0.8449, 'compress@10': 0.0666, 'time@10': 6.0482}:  27%|██▋       | 8/30 [00:35<01:50,  5.03s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0524, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8533, 'compress@10': 0.0637, 'time@10': 6.3806}:  27%|██▋       | 8/30 [00:40<01:50,  5.03s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0524, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8533, 'compress@10': 0.0637, 'time@10': 6.3806}:  30%|███       | 9/30 [00:40<01:42,  4.88s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.052, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8527, 'compress@10': 0.0619, 'time@10': 6.4532}:  30%|███       | 9/30 [00:47<01:42,  4.88s/it]    {'epoch': 3, 'num_users': 6.3, 'loss': 0.052, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8527, 'compress@10': 0.0619, 'time@10': 6.4532}:  33%|███▎      | 10/30 [00:47<01:51,  5.58s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.0528, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8542, 'compress@10': 0.0616, 'time@10': 6.6118}:  33%|███▎      | 10/30 [00:51<01:51,  5.58s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.0528, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8542, 'compress@10': 0.0616, 'time@10': 6.6118}:  37%|███▋      | 11/30 [00:51<01:37,  5.14s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.0499, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8594, 'compress@10': 0.0645, 'time@10': 6.2549}:  37%|███▋      | 11/30 [00:53<01:37,  5.14s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.0499, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8594, 'compress@10': 0.0645, 'time@10': 6.2549}:  40%|████      | 12/30 [00:53<01:17,  4.30s/it]{'epoch': 3, 'num_users': 6.6154, 'loss': 0.0499, 'hit_ratio@10': 0.822, 'ndcg@10': 0.861, 'compress@10': 0.0645, 'time@10': 6.3076}:  40%|████      | 12/30 [00:57<01:17,  4.30s/it]  {'epoch': 3, 'num_users': 6.6154, 'loss': 0.0499, 'hit_ratio@10': 0.822, 'ndcg@10': 0.861, 'compress@10': 0.0645, 'time@10': 6.3076}:  43%|████▎     | 13/30 [00:57<01:09,  4.06s/it]{'epoch': 3, 'num_users': 6.3571, 'loss': 0.0481, 'hit_ratio@10': 0.8109, 'ndcg@10': 0.8567, 'compress@10': 0.0728, 'time@10': 5.9322}:  43%|████▎     | 13/30 [00:58<01:09,  4.06s/it]{'epoch': 3, 'num_users': 6.3571, 'loss': 0.0481, 'hit_ratio@10': 0.8109, 'ndcg@10': 0.8567, 'compress@10': 0.0728, 'time@10': 5.9322}:  47%|████▋     | 14/30 [00:58<00:50,  3.16s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.0488, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8585, 'compress@10': 0.0708, 'time@10': 6.1262}:  47%|████▋     | 14/30 [01:02<00:50,  3.16s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.0488, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8585, 'compress@10': 0.0708, 'time@10': 6.1262}:  50%|█████     | 15/30 [01:02<00:53,  3.56s/it]{'epoch': 3, 'num_users': 6.0625, 'loss': 0.0468, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8604, 'compress@10': 0.0724, 'time@10': 5.8889}:  50%|█████     | 15/30 [01:05<00:53,  3.56s/it]{'epoch': 3, 'num_users': 6.0625, 'loss': 0.0468, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8604, 'compress@10': 0.0724, 'time@10': 5.8889}:  53%|█████▎    | 16/30 [01:05<00:44,  3.20s/it]{'epoch': 3, 'num_users': 5.8235, 'loss': 0.0456, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8511, 'compress@10': 0.0809, 'time@10': 5.6411}:  53%|█████▎    | 16/30 [01:05<00:44,  3.20s/it]{'epoch': 3, 'num_users': 5.8235, 'loss': 0.0456, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8511, 'compress@10': 0.0809, 'time@10': 5.6411}:  57%|█████▋    | 17/30 [01:05<00:32,  2.50s/it]{'epoch': 3, 'num_users': 6.0556, 'loss': 0.0465, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.8516, 'compress@10': 0.0795, 'time@10': 5.5776}:  57%|█████▋    | 17/30 [01:10<00:32,  2.50s/it]{'epoch': 3, 'num_users': 6.0556, 'loss': 0.0465, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.8516, 'compress@10': 0.0795, 'time@10': 5.5776}:  60%|██████    | 18/30 [01:10<00:37,  3.11s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.045, 'hit_ratio@10': 0.8109, 'ndcg@10': 0.8541, 'compress@10': 0.0803, 'time@10': 5.5096}:  60%|██████    | 18/30 [01:12<00:37,  3.11s/it]    {'epoch': 3, 'num_users': 6.0, 'loss': 0.045, 'hit_ratio@10': 0.8109, 'ndcg@10': 0.8541, 'compress@10': 0.0803, 'time@10': 5.5096}:  63%|██████▎   | 19/30 [01:12<00:31,  2.83s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.0458, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.8519, 'compress@10': 0.0784, 'time@10': 5.6958}:  63%|██████▎   | 19/30 [01:21<00:31,  2.83s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.0458, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.8519, 'compress@10': 0.0784, 'time@10': 5.6958}:  67%|██████▋   | 20/30 [01:21<00:47,  4.77s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0472, 'hit_ratio@10': 0.8124, 'ndcg@10': 0.8499, 'compress@10': 0.077, 'time@10': 5.8531}:  67%|██████▋   | 20/30 [01:26<00:47,  4.77s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0472, 'hit_ratio@10': 0.8124, 'ndcg@10': 0.8499, 'compress@10': 0.077, 'time@10': 5.8531}:  70%|███████   | 21/30 [01:26<00:42,  4.70s/it]{'epoch': 3, 'num_users': 6.1818, 'loss': 0.0468, 'hit_ratio@10': 0.8168, 'ndcg@10': 0.8527, 'compress@10': 0.0765, 'time@10': 5.7433}:  70%|███████   | 21/30 [01:30<00:42,  4.70s/it]{'epoch': 3, 'num_users': 6.1818, 'loss': 0.0468, 'hit_ratio@10': 0.8168, 'ndcg@10': 0.8527, 'compress@10': 0.0765, 'time@10': 5.7433}:  73%|███████▎  | 22/30 [01:30<00:34,  4.33s/it]{'epoch': 3, 'num_users': 6.1304, 'loss': 0.0458, 'hit_ratio@10': 0.8161, 'ndcg@10': 0.8547, 'compress@10': 0.0763, 'time@10': 5.7648}:  73%|███████▎  | 22/30 [01:33<00:34,  4.33s/it]{'epoch': 3, 'num_users': 6.1304, 'loss': 0.0458, 'hit_ratio@10': 0.8161, 'ndcg@10': 0.8547, 'compress@10': 0.0763, 'time@10': 5.7648}:  77%|███████▋  | 23/30 [01:33<00:27,  3.98s/it]{'epoch': 3, 'num_users': 5.9583, 'loss': 0.0461, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8444, 'compress@10': 0.082, 'time@10': 5.5602}:  77%|███████▋  | 23/30 [01:34<00:27,  3.98s/it] {'epoch': 3, 'num_users': 5.9583, 'loss': 0.0461, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8444, 'compress@10': 0.082, 'time@10': 5.5602}:  80%|████████  | 24/30 [01:34<00:18,  3.06s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0463, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8291, 'compress@10': 0.0928, 'time@10': 5.3718}:  80%|████████  | 24/30 [01:34<00:18,  3.06s/it]  {'epoch': 3, 'num_users': 5.8, 'loss': 0.0463, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8291, 'compress@10': 0.0928, 'time@10': 5.3718}:  83%|████████▎ | 25/30 [01:34<00:11,  2.28s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.0476, 'hit_ratio@10': 0.7983, 'ndcg@10': 0.8273, 'compress@10': 0.0907, 'time@10': 5.5246}:  83%|████████▎ | 25/30 [01:43<00:11,  2.28s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.0476, 'hit_ratio@10': 0.7983, 'ndcg@10': 0.8273, 'compress@10': 0.0907, 'time@10': 5.5246}:  87%|████████▋ | 26/30 [01:43<00:17,  4.41s/it]{'epoch': 3, 'num_users': 5.8889, 'loss': 0.0472, 'hit_ratio@10': 0.8031, 'ndcg@10': 0.83, 'compress@10': 0.0895, 'time@10': 5.6486}:  87%|████████▋ | 26/30 [01:48<00:17,  4.41s/it]  {'epoch': 3, 'num_users': 5.8889, 'loss': 0.0472, 'hit_ratio@10': 0.8031, 'ndcg@10': 0.83, 'compress@10': 0.0895, 'time@10': 5.6486}:  90%|█████████ | 27/30 [01:48<00:13,  4.43s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.0474, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8318, 'compress@10': 0.0886, 'time@10': 5.7444}:  90%|█████████ | 27/30 [01:56<00:13,  4.43s/it] {'epoch': 3, 'num_users': 6.0, 'loss': 0.0474, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8318, 'compress@10': 0.0886, 'time@10': 5.7444}:  93%|█████████▎| 28/30 [01:56<00:11,  5.61s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.0466, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8332, 'compress@10': 0.0875, 'time@10': 5.7815}:  93%|█████████▎| 28/30 [02:00<00:11,  5.61s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.0466, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8332, 'compress@10': 0.0875, 'time@10': 5.7815}:  97%|█████████▋| 29/30 [02:00<00:04,  4.96s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0466, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8349, 'compress@10': 0.0865, 'time@10': 5.7451}:  97%|█████████▋| 29/30 [02:04<00:04,  4.96s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0466, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8349, 'compress@10': 0.0865, 'time@10': 5.7451}: 100%|██████████| 30/30 [02:04<00:00,  4.90s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0466, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8349, 'compress@10': 0.0865, 'time@10': 5.7451}: 100%|██████████| 30/30 [02:04<00:00,  4.17s/it]
Epoch: 3
Avg # of users: 5.866666666666666
Avg Loss: 0.046601376983012595
Avg hit ratio: 0.805310369890853
Avg ndcg: 0.8349164576016773
Avg compression ratio: 0.0864514242760332
Avg train time: 5.745053672790528
Std train time: 2.8397533775374817
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 14, 10, 5, 10, 10, 10, 8, 10, 10, 14, 10, 14, 9, 14, 14, 10, 10, 10, 7, 10, 10, 14, 14, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8494, 'compress@10': 0.066, 'time@10': 6.3549}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8494, 'compress@10': 0.066, 'time@10': 6.3549}:   3%|▎         | 1/30 [00:03<01:33,  3.22s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.798, 'ndcg@10': 0.854, 'compress@10': 0.0572, 'time@10': 5.7951}:   3%|▎         | 1/30 [00:08<01:33,  3.22s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.798, 'ndcg@10': 0.854, 'compress@10': 0.0572, 'time@10': 5.7951}:   7%|▋         | 2/30 [00:08<02:04,  4.43s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0337, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.855, 'compress@10': 0.0912, 'time@10': 4.8169}:   7%|▋         | 2/30 [00:09<02:04,  4.43s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0337, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.855, 'compress@10': 0.0912, 'time@10': 4.8169}:  10%|█         | 3/30 [00:09<01:23,  3.08s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8499, 'compress@10': 0.0822, 'time@10': 4.7404}:  10%|█         | 3/30 [00:14<01:23,  3.08s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8499, 'compress@10': 0.0822, 'time@10': 4.7404}:  13%|█▎        | 4/30 [00:14<01:35,  3.66s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0488, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8322, 'compress@10': 0.0752, 'time@10': 5.4248}:  13%|█▎        | 4/30 [00:18<01:35,  3.66s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0488, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8322, 'compress@10': 0.0752, 'time@10': 5.4248}:  17%|█▋        | 5/30 [00:18<01:35,  3.83s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0526, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.8304, 'compress@10': 0.07, 'time@10': 5.75}:  17%|█▋        | 5/30 [00:26<01:35,  3.83s/it] {'epoch': 4, 'num_users': 6.1667, 'loss': 0.0526, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.8304, 'compress@10': 0.07, 'time@10': 5.75}:  20%|██        | 6/30 [00:26<02:01,  5.05s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0524, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8307, 'compress@10': 0.0687, 'time@10': 6.0696}:  20%|██        | 6/30 [00:30<02:01,  5.05s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0524, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8307, 'compress@10': 0.0687, 'time@10': 6.0696}:  23%|██▎       | 7/30 [00:30<01:48,  4.72s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0547, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8493, 'compress@10': 0.0668, 'time@10': 6.0173}:  23%|██▎       | 7/30 [00:35<01:48,  4.72s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0547, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8493, 'compress@10': 0.0668, 'time@10': 6.0173}:  27%|██▋       | 8/30 [00:35<01:50,  5.03s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0532, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8556, 'compress@10': 0.0638, 'time@10': 6.3522}:  27%|██▋       | 8/30 [00:40<01:50,  5.03s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0532, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8556, 'compress@10': 0.0638, 'time@10': 6.3522}:  30%|███       | 9/30 [00:40<01:42,  4.88s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0531, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8536, 'compress@10': 0.062, 'time@10': 6.4273}:  30%|███       | 9/30 [00:47<01:42,  4.88s/it]    {'epoch': 4, 'num_users': 6.3, 'loss': 0.0531, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8536, 'compress@10': 0.062, 'time@10': 6.4273}:  33%|███▎      | 10/30 [00:47<01:51,  5.58s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.0539, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.8551, 'compress@10': 0.0617, 'time@10': 6.6054}:  33%|███▎      | 10/30 [00:51<01:51,  5.58s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.0539, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.8551, 'compress@10': 0.0617, 'time@10': 6.6054}:  37%|███▋      | 11/30 [00:51<01:38,  5.17s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0508, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8602, 'compress@10': 0.0647, 'time@10': 6.2665}:  37%|███▋      | 11/30 [00:54<01:38,  5.17s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0508, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8602, 'compress@10': 0.0647, 'time@10': 6.2665}:  40%|████      | 12/30 [00:54<01:18,  4.38s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.0513, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8629, 'compress@10': 0.0647, 'time@10': 6.3169}:  40%|████      | 12/30 [00:57<01:18,  4.38s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.0513, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8629, 'compress@10': 0.0647, 'time@10': 6.3169}:  43%|████▎     | 13/30 [00:57<01:09,  4.11s/it]{'epoch': 4, 'num_users': 6.3571, 'loss': 0.0489, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8597, 'compress@10': 0.0729, 'time@10': 5.9467}:  43%|████▎     | 13/30 [00:58<01:09,  4.11s/it]{'epoch': 4, 'num_users': 6.3571, 'loss': 0.0489, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8597, 'compress@10': 0.0729, 'time@10': 5.9467}:  47%|████▋     | 14/30 [00:58<00:51,  3.23s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.0499, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8609, 'compress@10': 0.0708, 'time@10': 6.1309}:  47%|████▋     | 14/30 [01:03<00:51,  3.23s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.0499, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8609, 'compress@10': 0.0708, 'time@10': 6.1309}:  50%|█████     | 15/30 [01:03<00:53,  3.58s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.0477, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8615, 'compress@10': 0.0725, 'time@10': 5.9068}:  50%|█████     | 15/30 [01:05<00:53,  3.58s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.0477, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8615, 'compress@10': 0.0725, 'time@10': 5.9068}:  53%|█████▎    | 16/30 [01:05<00:45,  3.28s/it]{'epoch': 4, 'num_users': 5.8235, 'loss': 0.0461, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8538, 'compress@10': 0.081, 'time@10': 5.6756}:  53%|█████▎    | 16/30 [01:06<00:45,  3.28s/it] {'epoch': 4, 'num_users': 5.8235, 'loss': 0.0461, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8538, 'compress@10': 0.081, 'time@10': 5.6756}:  57%|█████▋    | 17/30 [01:06<00:33,  2.61s/it]{'epoch': 4, 'num_users': 6.0556, 'loss': 0.0469, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8537, 'compress@10': 0.0797, 'time@10': 5.6286}:  57%|█████▋    | 17/30 [01:11<00:33,  2.61s/it]{'epoch': 4, 'num_users': 6.0556, 'loss': 0.0469, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8537, 'compress@10': 0.0797, 'time@10': 5.6286}:  60%|██████    | 18/30 [01:11<00:39,  3.29s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.0454, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8561, 'compress@10': 0.0805, 'time@10': 5.5705}:  60%|██████    | 18/30 [01:14<00:39,  3.29s/it]   {'epoch': 4, 'num_users': 6.0, 'loss': 0.0454, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8561, 'compress@10': 0.0805, 'time@10': 5.5705}:  63%|██████▎   | 19/30 [01:14<00:32,  2.99s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.046, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8546, 'compress@10': 0.0786, 'time@10': 5.7564}:  63%|██████▎   | 19/30 [01:23<00:32,  2.99s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.046, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8546, 'compress@10': 0.0786, 'time@10': 5.7564}:  67%|██████▋   | 20/30 [01:23<00:49,  4.90s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0475, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.8524, 'compress@10': 0.0772, 'time@10': 5.9793}:  67%|██████▋   | 20/30 [01:28<00:49,  4.90s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0475, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.8524, 'compress@10': 0.0772, 'time@10': 5.9793}:  70%|███████   | 21/30 [01:28<00:45,  5.01s/it]{'epoch': 4, 'num_users': 6.1818, 'loss': 0.0475, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8548, 'compress@10': 0.0767, 'time@10': 5.8772}:  70%|███████   | 21/30 [01:32<00:45,  5.01s/it]{'epoch': 4, 'num_users': 6.1818, 'loss': 0.0475, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8548, 'compress@10': 0.0767, 'time@10': 5.8772}:  73%|███████▎  | 22/30 [01:32<00:37,  4.64s/it]{'epoch': 4, 'num_users': 6.1304, 'loss': 0.0465, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8564, 'compress@10': 0.0765, 'time@10': 5.9045}:  73%|███████▎  | 22/30 [01:35<00:37,  4.64s/it] {'epoch': 4, 'num_users': 6.1304, 'loss': 0.0465, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8564, 'compress@10': 0.0765, 'time@10': 5.9045}:  77%|███████▋  | 23/30 [01:35<00:29,  4.24s/it]{'epoch': 4, 'num_users': 5.9583, 'loss': 0.0465, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8496, 'compress@10': 0.0821, 'time@10': 5.6935}:  77%|███████▋  | 23/30 [01:36<00:29,  4.24s/it]{'epoch': 4, 'num_users': 5.9583, 'loss': 0.0465, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8496, 'compress@10': 0.0821, 'time@10': 5.6935}:  80%|████████  | 24/30 [01:36<00:19,  3.23s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.834, 'compress@10': 0.0928, 'time@10': 5.4951}:  80%|████████  | 24/30 [01:37<00:19,  3.23s/it]     {'epoch': 4, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.834, 'compress@10': 0.0928, 'time@10': 5.4951}:  83%|████████▎ | 25/30 [01:37<00:11,  2.38s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.0472, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8321, 'compress@10': 0.0907, 'time@10': 5.6393}:  83%|████████▎ | 25/30 [01:46<00:11,  2.38s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.0472, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8321, 'compress@10': 0.0907, 'time@10': 5.6393}:  87%|████████▋ | 26/30 [01:46<00:17,  4.45s/it]{'epoch': 4, 'num_users': 5.8889, 'loss': 0.0469, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.835, 'compress@10': 0.0894, 'time@10': 5.7622}:  87%|████████▋ | 26/30 [01:50<00:17,  4.45s/it] {'epoch': 4, 'num_users': 5.8889, 'loss': 0.0469, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.835, 'compress@10': 0.0894, 'time@10': 5.7622}:  90%|█████████ | 27/30 [01:50<00:13,  4.47s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.0471, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8361, 'compress@10': 0.0884, 'time@10': 5.8466}:  90%|█████████ | 27/30 [01:59<00:13,  4.47s/it]  {'epoch': 4, 'num_users': 6.0, 'loss': 0.0471, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8361, 'compress@10': 0.0884, 'time@10': 5.8466}:  93%|█████████▎| 28/30 [01:59<00:11,  5.58s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.0468, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8361, 'compress@10': 0.0873, 'time@10': 5.8269}:  93%|█████████▎| 28/30 [02:01<00:11,  5.58s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.0468, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8361, 'compress@10': 0.0873, 'time@10': 5.8269}:  97%|█████████▋| 29/30 [02:01<00:04,  4.71s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0468, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8376, 'compress@10': 0.0863, 'time@10': 5.7764}:  97%|█████████▋| 29/30 [02:06<00:04,  4.71s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0468, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8376, 'compress@10': 0.0863, 'time@10': 5.7764}: 100%|██████████| 30/30 [02:06<00:00,  4.60s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0468, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8376, 'compress@10': 0.0863, 'time@10': 5.7764}: 100%|██████████| 30/30 [02:06<00:00,  4.21s/it]
Epoch: 4
Avg # of users: 5.866666666666666
Avg Loss: 0.046802904859688695
Avg hit ratio: 0.828183680618653
Avg ndcg: 0.8375787498618374
Avg compression ratio: 0.0862665278451551
Avg train time: 5.776412717501322
Std train time: 2.7745300199080596
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 15, 10, 5, 10, 10, 10, 8, 10, 10, 15, 10, 15, 9, 15, 15, 10, 10, 10, 6, 10, 10, 15, 15, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8568, 'compress@10': 0.0667, 'time@10': 5.9133}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8568, 'compress@10': 0.0667, 'time@10': 5.9133}:   3%|▎         | 1/30 [00:02<01:26,  3.00s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0507, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8516, 'compress@10': 0.0581, 'time@10': 5.4365}:   3%|▎         | 1/30 [00:07<01:26,  3.00s/it] {'epoch': 5, 'num_users': 7.0, 'loss': 0.0507, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8516, 'compress@10': 0.0581, 'time@10': 5.4365}:   7%|▋         | 2/30 [00:07<01:56,  4.17s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8535, 'compress@10': 0.0912, 'time@10': 4.6084}:   7%|▋         | 2/30 [00:09<01:56,  4.17s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8535, 'compress@10': 0.0912, 'time@10': 4.6084}:  10%|█         | 3/30 [00:09<01:19,  2.96s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8504, 'compress@10': 0.0821, 'time@10': 4.5586}:  10%|█         | 3/30 [00:13<01:19,  2.96s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8504, 'compress@10': 0.0821, 'time@10': 4.5586}:  13%|█▎        | 4/30 [00:13<01:32,  3.55s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0488, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.8324, 'compress@10': 0.0746, 'time@10': 5.2813}:  13%|█▎        | 4/30 [00:18<01:32,  3.55s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0488, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.8324, 'compress@10': 0.0746, 'time@10': 5.2813}:  17%|█▋        | 5/30 [00:18<01:34,  3.76s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0521, 'hit_ratio@10': 0.8061, 'ndcg@10': 0.8303, 'compress@10': 0.0695, 'time@10': 5.6763}:  17%|█▋        | 5/30 [00:25<01:34,  3.76s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0521, 'hit_ratio@10': 0.8061, 'ndcg@10': 0.8303, 'compress@10': 0.0695, 'time@10': 5.6763}:  20%|██        | 6/30 [00:25<02:02,  5.10s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0513, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8356, 'compress@10': 0.0683, 'time@10': 6.0412}:  20%|██        | 6/30 [00:29<02:02,  5.10s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0513, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8356, 'compress@10': 0.0683, 'time@10': 6.0412}:  23%|██▎       | 7/30 [00:29<01:50,  4.79s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0531, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.852, 'compress@10': 0.0663, 'time@10': 5.9871}:  23%|██▎       | 7/30 [00:35<01:50,  4.79s/it]  {'epoch': 5, 'num_users': 6.125, 'loss': 0.0531, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.852, 'compress@10': 0.0663, 'time@10': 5.9871}:  27%|██▋       | 8/30 [00:35<01:51,  5.06s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0521, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8616, 'compress@10': 0.0633, 'time@10': 6.3268}:  27%|██▋       | 8/30 [00:40<01:51,  5.06s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0521, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8616, 'compress@10': 0.0633, 'time@10': 6.3268}:  30%|███       | 9/30 [00:40<01:43,  4.91s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0508, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8612, 'compress@10': 0.0615, 'time@10': 6.4004}:  30%|███       | 9/30 [00:47<01:43,  4.91s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0508, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8612, 'compress@10': 0.0615, 'time@10': 6.4004}:  33%|███▎      | 10/30 [00:47<01:51,  5.59s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0517, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8618, 'compress@10': 0.0613, 'time@10': 6.5787}:  33%|███▎      | 10/30 [00:51<01:51,  5.59s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0517, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8618, 'compress@10': 0.0613, 'time@10': 6.5787}:  37%|███▋      | 11/30 [00:51<01:38,  5.17s/it]{'epoch': 5, 'num_users': 6.4167, 'loss': 0.0488, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8664, 'compress@10': 0.0644, 'time@10': 6.2534}:  37%|███▋      | 11/30 [00:54<01:38,  5.17s/it]{'epoch': 5, 'num_users': 6.4167, 'loss': 0.0488, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8664, 'compress@10': 0.0644, 'time@10': 6.2534}:  40%|████      | 12/30 [00:54<01:19,  4.42s/it]{'epoch': 5, 'num_users': 6.6154, 'loss': 0.0497, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.8676, 'compress@10': 0.0646, 'time@10': 6.3103}:  40%|████      | 12/30 [00:57<01:19,  4.42s/it]{'epoch': 5, 'num_users': 6.6154, 'loss': 0.0497, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.8676, 'compress@10': 0.0646, 'time@10': 6.3103}:  43%|████▎     | 13/30 [00:57<01:10,  4.15s/it]{'epoch': 5, 'num_users': 6.3571, 'loss': 0.0472, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8631, 'compress@10': 0.0728, 'time@10': 5.9472}:  43%|████▎     | 13/30 [00:59<01:10,  4.15s/it]{'epoch': 5, 'num_users': 6.3571, 'loss': 0.0472, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8631, 'compress@10': 0.0728, 'time@10': 5.9472}:  47%|████▋     | 14/30 [00:59<00:52,  3.28s/it]{'epoch': 5, 'num_users': 6.2667, 'loss': 0.0489, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8635, 'compress@10': 0.0707, 'time@10': 6.1421}:  47%|████▋     | 14/30 [01:03<00:52,  3.28s/it]{'epoch': 5, 'num_users': 6.2667, 'loss': 0.0489, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8635, 'compress@10': 0.0707, 'time@10': 6.1421}:  50%|█████     | 15/30 [01:03<00:54,  3.64s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.0468, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8642, 'compress@10': 0.0725, 'time@10': 5.9278}:  50%|█████     | 15/30 [01:06<00:54,  3.64s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.0468, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8642, 'compress@10': 0.0725, 'time@10': 5.9278}:  53%|█████▎    | 16/30 [01:06<00:47,  3.37s/it]{'epoch': 5, 'num_users': 5.8235, 'loss': 0.045, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8572, 'compress@10': 0.0809, 'time@10': 5.696}:  53%|█████▎    | 16/30 [01:07<00:47,  3.37s/it]  {'epoch': 5, 'num_users': 5.8235, 'loss': 0.045, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8572, 'compress@10': 0.0809, 'time@10': 5.696}:  57%|█████▋    | 17/30 [01:07<00:34,  2.67s/it]{'epoch': 5, 'num_users': 6.0556, 'loss': 0.0459, 'hit_ratio@10': 0.8219, 'ndcg@10': 0.8569, 'compress@10': 0.0798, 'time@10': 5.6271}:  57%|█████▋    | 17/30 [01:11<00:34,  2.67s/it]{'epoch': 5, 'num_users': 6.0556, 'loss': 0.0459, 'hit_ratio@10': 0.8219, 'ndcg@10': 0.8569, 'compress@10': 0.0798, 'time@10': 5.6271}:  60%|██████    | 18/30 [01:11<00:38,  3.22s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.0443, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8591, 'compress@10': 0.0804, 'time@10': 5.5562}:  60%|██████    | 18/30 [01:13<00:38,  3.22s/it]   {'epoch': 5, 'num_users': 6.0, 'loss': 0.0443, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8591, 'compress@10': 0.0804, 'time@10': 5.5562}:  63%|██████▎   | 19/30 [01:13<00:31,  2.91s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.0449, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8577, 'compress@10': 0.0786, 'time@10': 5.7435}:  63%|██████▎   | 19/30 [01:23<00:31,  2.91s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.0449, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8577, 'compress@10': 0.0786, 'time@10': 5.7435}:  67%|██████▋   | 20/30 [01:23<00:48,  4.84s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0464, 'hit_ratio@10': 0.8228, 'ndcg@10': 0.8551, 'compress@10': 0.0771, 'time@10': 5.8418}:  67%|██████▋   | 20/30 [01:27<00:48,  4.84s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0464, 'hit_ratio@10': 0.8228, 'ndcg@10': 0.8551, 'compress@10': 0.0771, 'time@10': 5.8418}:  70%|███████   | 21/30 [01:27<00:41,  4.57s/it]{'epoch': 5, 'num_users': 6.1818, 'loss': 0.0471, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8567, 'compress@10': 0.0766, 'time@10': 5.7321}:  70%|███████   | 21/30 [01:30<00:41,  4.57s/it]{'epoch': 5, 'num_users': 6.1818, 'loss': 0.0471, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8567, 'compress@10': 0.0766, 'time@10': 5.7321}:  73%|███████▎  | 22/30 [01:30<00:33,  4.24s/it]{'epoch': 5, 'num_users': 6.1304, 'loss': 0.0462, 'hit_ratio@10': 0.8255, 'ndcg@10': 0.8586, 'compress@10': 0.0763, 'time@10': 5.7548}:  73%|███████▎  | 22/30 [01:33<00:33,  4.24s/it]{'epoch': 5, 'num_users': 6.1304, 'loss': 0.0462, 'hit_ratio@10': 0.8255, 'ndcg@10': 0.8586, 'compress@10': 0.0763, 'time@10': 5.7548}:  77%|███████▋  | 23/30 [01:33<00:27,  3.92s/it]{'epoch': 5, 'num_users': 5.9583, 'loss': 0.046, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8516, 'compress@10': 0.0819, 'time@10': 5.5562}:  77%|███████▋  | 23/30 [01:34<00:27,  3.92s/it] {'epoch': 5, 'num_users': 5.9583, 'loss': 0.046, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8516, 'compress@10': 0.0819, 'time@10': 5.5562}:  80%|████████  | 24/30 [01:34<00:18,  3.05s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0451, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8409, 'compress@10': 0.0925, 'time@10': 5.3729}:  80%|████████  | 24/30 [01:35<00:18,  3.05s/it]  {'epoch': 5, 'num_users': 5.8, 'loss': 0.0451, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8409, 'compress@10': 0.0925, 'time@10': 5.3729}:  83%|████████▎ | 25/30 [01:35<00:11,  2.29s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.0462, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8392, 'compress@10': 0.0903, 'time@10': 5.5255}:  83%|████████▎ | 25/30 [01:44<00:11,  2.29s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.0462, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8392, 'compress@10': 0.0903, 'time@10': 5.5255}:  87%|████████▋ | 26/30 [01:44<00:17,  4.42s/it]{'epoch': 5, 'num_users': 5.8889, 'loss': 0.0461, 'hit_ratio@10': 0.8253, 'ndcg@10': 0.8417, 'compress@10': 0.089, 'time@10': 5.6495}:  87%|████████▋ | 26/30 [01:49<00:17,  4.42s/it]{'epoch': 5, 'num_users': 5.8889, 'loss': 0.0461, 'hit_ratio@10': 0.8253, 'ndcg@10': 0.8417, 'compress@10': 0.089, 'time@10': 5.6495}:  90%|█████████ | 27/30 [01:49<00:13,  4.44s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.0465, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8421, 'compress@10': 0.088, 'time@10': 5.72}:  90%|█████████ | 27/30 [01:56<00:13,  4.44s/it]     {'epoch': 5, 'num_users': 6.0, 'loss': 0.0465, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8421, 'compress@10': 0.088, 'time@10': 5.72}:  93%|█████████▎| 28/30 [01:56<00:10,  5.40s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.0461, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8435, 'compress@10': 0.0869, 'time@10': 5.7446}:  93%|█████████▎| 28/30 [02:00<00:10,  5.40s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.0461, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8435, 'compress@10': 0.0869, 'time@10': 5.7446}:  97%|█████████▋| 29/30 [02:00<00:04,  4.76s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.046, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.845, 'compress@10': 0.0859, 'time@10': 5.6889}:  97%|█████████▋| 29/30 [02:04<00:04,  4.76s/it]  {'epoch': 5, 'num_users': 5.8667, 'loss': 0.046, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.845, 'compress@10': 0.0859, 'time@10': 5.6889}: 100%|██████████| 30/30 [02:04<00:00,  4.57s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.046, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.845, 'compress@10': 0.0859, 'time@10': 5.6889}: 100%|██████████| 30/30 [02:04<00:00,  4.14s/it]
Epoch: 5
Avg # of users: 5.866666666666666
Avg Loss: 0.045958385463726804
Avg hit ratio: 0.8265875555618696
Avg ndcg: 0.8449552656503841
Avg compression ratio: 0.08592565577382909
Avg train time: 5.6888755559921265
Std train time: 2.652441420853915
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 16, 10, 5, 10, 10, 10, 8, 10, 10, 16, 10, 16, 9, 16, 16, 10, 10, 10, 6, 10, 10, 16, 16, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8531, 'compress@10': 0.0667, 'time@10': 6.0076}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8531, 'compress@10': 0.0667, 'time@10': 6.0076}:   3%|▎         | 1/30 [00:03<01:28,  3.06s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8522, 'compress@10': 0.0585, 'time@10': 5.5549}:   3%|▎         | 1/30 [00:08<01:28,  3.06s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8522, 'compress@10': 0.0585, 'time@10': 5.5549}:   7%|▋         | 2/30 [00:08<01:59,  4.28s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8539, 'compress@10': 0.0912, 'time@10': 4.8478}:   7%|▋         | 2/30 [00:09<01:59,  4.28s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8539, 'compress@10': 0.0912, 'time@10': 4.8478}:  10%|█         | 3/30 [00:09<01:24,  3.13s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8587, 'compress@10': 0.0818, 'time@10': 4.8202}:  10%|█         | 3/30 [00:14<01:24,  3.13s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8587, 'compress@10': 0.0818, 'time@10': 4.8202}:  13%|█▎        | 4/30 [00:14<01:38,  3.78s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0491, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8397, 'compress@10': 0.0739, 'time@10': 5.5236}:  13%|█▎        | 4/30 [00:18<01:38,  3.78s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0491, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8397, 'compress@10': 0.0739, 'time@10': 5.5236}:  17%|█▋        | 5/30 [00:18<01:38,  3.93s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0517, 'hit_ratio@10': 0.7914, 'ndcg@10': 0.8376, 'compress@10': 0.069, 'time@10': 5.9033}:  17%|█▋        | 5/30 [00:26<01:38,  3.93s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0517, 'hit_ratio@10': 0.7914, 'ndcg@10': 0.8376, 'compress@10': 0.069, 'time@10': 5.9033}:  20%|██        | 6/30 [00:26<02:06,  5.26s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.8391, 'compress@10': 0.0681, 'time@10': 6.241}:  20%|██        | 6/30 [00:30<02:06,  5.26s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.8391, 'compress@10': 0.0681, 'time@10': 6.241}:  23%|██▎       | 7/30 [00:30<01:52,  4.91s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8596, 'compress@10': 0.0661, 'time@10': 6.1937}:  23%|██▎       | 7/30 [00:36<01:52,  4.91s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8596, 'compress@10': 0.0661, 'time@10': 6.1937}:  27%|██▋       | 8/30 [00:36<01:55,  5.24s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0517, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8765, 'compress@10': 0.063, 'time@10': 6.4594}:  27%|██▋       | 8/30 [00:41<01:55,  5.24s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0517, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8765, 'compress@10': 0.063, 'time@10': 6.4594}:  30%|███       | 9/30 [00:41<01:44,  4.95s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0513, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8723, 'compress@10': 0.0612, 'time@10': 6.5015}:  30%|███       | 9/30 [00:48<01:44,  4.95s/it]  {'epoch': 6, 'num_users': 6.3, 'loss': 0.0513, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8723, 'compress@10': 0.0612, 'time@10': 6.5015}:  33%|███▎      | 10/30 [00:48<01:51,  5.56s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.0521, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.8721, 'compress@10': 0.061, 'time@10': 6.6162}:  33%|███▎      | 10/30 [00:52<01:51,  5.56s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.0521, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.8721, 'compress@10': 0.061, 'time@10': 6.6162}:  37%|███▋      | 11/30 [00:52<01:36,  5.06s/it]{'epoch': 6, 'num_users': 6.4167, 'loss': 0.0491, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8758, 'compress@10': 0.0642, 'time@10': 6.3015}:  37%|███▋      | 11/30 [00:54<01:36,  5.06s/it]{'epoch': 6, 'num_users': 6.4167, 'loss': 0.0491, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8758, 'compress@10': 0.0642, 'time@10': 6.3015}:  40%|████      | 12/30 [00:54<01:19,  4.40s/it]{'epoch': 6, 'num_users': 6.6154, 'loss': 0.0496, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8774, 'compress@10': 0.0644, 'time@10': 6.3519}:  40%|████      | 12/30 [00:58<01:19,  4.40s/it]{'epoch': 6, 'num_users': 6.6154, 'loss': 0.0496, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8774, 'compress@10': 0.0644, 'time@10': 6.3519}:  43%|████▎     | 13/30 [00:58<01:10,  4.13s/it]{'epoch': 6, 'num_users': 6.3571, 'loss': 0.047, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8726, 'compress@10': 0.0726, 'time@10': 5.9909}:  43%|████▎     | 13/30 [00:59<01:10,  4.13s/it] {'epoch': 6, 'num_users': 6.3571, 'loss': 0.047, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8726, 'compress@10': 0.0726, 'time@10': 5.9909}:  47%|████▋     | 14/30 [00:59<00:52,  3.29s/it]{'epoch': 6, 'num_users': 6.2667, 'loss': 0.0488, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8725, 'compress@10': 0.0706, 'time@10': 6.1817}:  47%|████▋     | 14/30 [01:04<00:52,  3.29s/it]{'epoch': 6, 'num_users': 6.2667, 'loss': 0.0488, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8725, 'compress@10': 0.0706, 'time@10': 6.1817}:  50%|█████     | 15/30 [01:04<00:54,  3.64s/it]{'epoch': 6, 'num_users': 6.0625, 'loss': 0.0466, 'hit_ratio@10': 0.8277, 'ndcg@10': 0.8726, 'compress@10': 0.0724, 'time@10': 5.9756}:  50%|█████     | 15/30 [01:07<00:54,  3.64s/it]{'epoch': 6, 'num_users': 6.0625, 'loss': 0.0466, 'hit_ratio@10': 0.8277, 'ndcg@10': 0.8726, 'compress@10': 0.0724, 'time@10': 5.9756}:  53%|█████▎    | 16/30 [01:07<00:47,  3.43s/it]{'epoch': 6, 'num_users': 5.8235, 'loss': 0.0447, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.8651, 'compress@10': 0.0808, 'time@10': 5.7448}:  53%|█████▎    | 16/30 [01:08<00:47,  3.43s/it]{'epoch': 6, 'num_users': 5.8235, 'loss': 0.0447, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.8651, 'compress@10': 0.0808, 'time@10': 5.7448}:  57%|█████▋    | 17/30 [01:08<00:35,  2.72s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.0455, 'hit_ratio@10': 0.8107, 'ndcg@10': 0.8645, 'compress@10': 0.0797, 'time@10': 5.6733}:  57%|█████▋    | 17/30 [01:12<00:35,  2.72s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.0455, 'hit_ratio@10': 0.8107, 'ndcg@10': 0.8645, 'compress@10': 0.0797, 'time@10': 5.6733}:  60%|██████    | 18/30 [01:12<00:39,  3.26s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.044, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8663, 'compress@10': 0.0803, 'time@10': 5.601}:  60%|██████    | 18/30 [01:14<00:39,  3.26s/it]     {'epoch': 6, 'num_users': 6.0, 'loss': 0.044, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8663, 'compress@10': 0.0803, 'time@10': 5.601}:  63%|██████▎   | 19/30 [01:14<00:32,  2.94s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.0445, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8646, 'compress@10': 0.0784, 'time@10': 5.7867}:  63%|██████▎   | 19/30 [01:24<00:32,  2.94s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.0445, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8646, 'compress@10': 0.0784, 'time@10': 5.7867}:  67%|██████▋   | 20/30 [01:24<00:48,  4.86s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.046, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8623, 'compress@10': 0.077, 'time@10': 5.8876}:  67%|██████▋   | 20/30 [01:28<00:48,  4.86s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.046, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8623, 'compress@10': 0.077, 'time@10': 5.8876}:  70%|███████   | 21/30 [01:28<00:41,  4.61s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.0461, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.864, 'compress@10': 0.0765, 'time@10': 5.7755}:  70%|███████   | 21/30 [01:31<00:41,  4.61s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.0461, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.864, 'compress@10': 0.0765, 'time@10': 5.7755}:  73%|███████▎  | 22/30 [01:31<00:34,  4.26s/it]{'epoch': 6, 'num_users': 6.1304, 'loss': 0.0453, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8655, 'compress@10': 0.0761, 'time@10': 5.7961}:  73%|███████▎  | 22/30 [01:34<00:34,  4.26s/it]{'epoch': 6, 'num_users': 6.1304, 'loss': 0.0453, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8655, 'compress@10': 0.0761, 'time@10': 5.7961}:  77%|███████▋  | 23/30 [01:34<00:27,  3.93s/it]{'epoch': 6, 'num_users': 5.9583, 'loss': 0.0449, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8583, 'compress@10': 0.0817, 'time@10': 5.5977}:  77%|███████▋  | 23/30 [01:36<00:27,  3.93s/it]{'epoch': 6, 'num_users': 5.9583, 'loss': 0.0449, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8583, 'compress@10': 0.0817, 'time@10': 5.5977}:  80%|████████  | 24/30 [01:36<00:18,  3.08s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0439, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8478, 'compress@10': 0.0923, 'time@10': 5.4165}:  80%|████████  | 24/30 [01:36<00:18,  3.08s/it]   {'epoch': 6, 'num_users': 5.8, 'loss': 0.0439, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8478, 'compress@10': 0.0923, 'time@10': 5.4165}:  83%|████████▎ | 25/30 [01:36<00:11,  2.33s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.0449, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8463, 'compress@10': 0.0901, 'time@10': 5.5674}:  83%|████████▎ | 25/30 [01:45<00:11,  2.33s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.0449, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8463, 'compress@10': 0.0901, 'time@10': 5.5674}:  87%|████████▋ | 26/30 [01:45<00:17,  4.44s/it]{'epoch': 6, 'num_users': 5.8889, 'loss': 0.0452, 'hit_ratio@10': 0.8197, 'ndcg@10': 0.8524, 'compress@10': 0.0887, 'time@10': 5.6947}:  87%|████████▋ | 26/30 [01:50<00:17,  4.44s/it]{'epoch': 6, 'num_users': 5.8889, 'loss': 0.0452, 'hit_ratio@10': 0.8197, 'ndcg@10': 0.8524, 'compress@10': 0.0887, 'time@10': 5.6947}:  90%|█████████ | 27/30 [01:50<00:13,  4.47s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.0457, 'hit_ratio@10': 0.8234, 'ndcg@10': 0.8524, 'compress@10': 0.0876, 'time@10': 5.7461}:  90%|█████████ | 27/30 [01:57<00:13,  4.47s/it]   {'epoch': 6, 'num_users': 6.0, 'loss': 0.0457, 'hit_ratio@10': 0.8234, 'ndcg@10': 0.8524, 'compress@10': 0.0876, 'time@10': 5.7461}:  93%|█████████▎| 28/30 [01:57<00:10,  5.28s/it]{'epoch': 6, 'num_users': 5.8621, 'loss': 0.0453, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8536, 'compress@10': 0.0866, 'time@10': 5.7661}:  93%|█████████▎| 28/30 [02:00<00:10,  5.28s/it]{'epoch': 6, 'num_users': 5.8621, 'loss': 0.0453, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8536, 'compress@10': 0.0866, 'time@10': 5.7661}:  97%|█████████▋| 29/30 [02:00<00:04,  4.66s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0453, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8551, 'compress@10': 0.0856, 'time@10': 5.7471}:  97%|█████████▋| 29/30 [02:06<00:04,  4.66s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0453, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8551, 'compress@10': 0.0856, 'time@10': 5.7471}: 100%|██████████| 30/30 [02:06<00:00,  4.83s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0453, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8551, 'compress@10': 0.0856, 'time@10': 5.7471}: 100%|██████████| 30/30 [02:06<00:00,  4.20s/it]
Epoch: 6
Avg # of users: 5.866666666666666
Avg Loss: 0.045310766645849564
Avg hit ratio: 0.8231123387633085
Avg ndcg: 0.8550605845774832
Avg compression ratio: 0.08558136274451991
Avg train time: 5.74709005355835
Std train time: 2.554293480247448
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 16, 10, 5, 10, 10, 10, 8, 10, 10, 17, 10, 17, 9, 17, 17, 10, 10, 10, 6, 10, 10, 17, 17, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8579, 'compress@10': 0.0671, 'time@10': 5.5878}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8579, 'compress@10': 0.0671, 'time@10': 5.5878}:   3%|▎         | 1/30 [00:02<01:22,  2.83s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8531, 'compress@10': 0.0591, 'time@10': 5.3959}:   3%|▎         | 1/30 [00:08<01:22,  2.83s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8531, 'compress@10': 0.0591, 'time@10': 5.3959}:   7%|▋         | 2/30 [00:08<01:59,  4.25s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8545, 'compress@10': 0.0916, 'time@10': 4.6503}:   7%|▋         | 2/30 [00:09<01:59,  4.25s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8545, 'compress@10': 0.0916, 'time@10': 4.6503}:  10%|█         | 3/30 [00:09<01:22,  3.05s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0405, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8664, 'compress@10': 0.0818, 'time@10': 4.5957}:  10%|█         | 3/30 [00:14<01:22,  3.05s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0405, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8664, 'compress@10': 0.0818, 'time@10': 4.5957}:  13%|█▎        | 4/30 [00:14<01:33,  3.61s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0507, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8463, 'compress@10': 0.0738, 'time@10': 5.3092}:  13%|█▎        | 4/30 [00:18<01:33,  3.61s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0507, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8463, 'compress@10': 0.0738, 'time@10': 5.3092}:  17%|█▋        | 5/30 [00:18<01:34,  3.80s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0526, 'hit_ratio@10': 0.7928, 'ndcg@10': 0.8438, 'compress@10': 0.069, 'time@10': 5.6354}:  17%|█▋        | 5/30 [00:25<01:34,  3.80s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0526, 'hit_ratio@10': 0.7928, 'ndcg@10': 0.8438, 'compress@10': 0.069, 'time@10': 5.6354}:  20%|██        | 6/30 [00:25<01:59,  4.99s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0534, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8466, 'compress@10': 0.068, 'time@10': 5.9744}:  20%|██        | 6/30 [00:29<01:59,  4.99s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0534, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8466, 'compress@10': 0.068, 'time@10': 5.9744}:  23%|██▎       | 7/30 [00:29<01:47,  4.68s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0535, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8614, 'compress@10': 0.066, 'time@10': 5.9267}:  23%|██▎       | 7/30 [00:35<01:47,  4.68s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0535, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8614, 'compress@10': 0.066, 'time@10': 5.9267}:  27%|██▋       | 8/30 [00:35<01:49,  4.99s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0527, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8728, 'compress@10': 0.063, 'time@10': 6.2664}:  27%|██▋       | 8/30 [00:39<01:49,  4.99s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0527, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8728, 'compress@10': 0.063, 'time@10': 6.2664}:  30%|███       | 9/30 [00:39<01:41,  4.85s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0524, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8741, 'compress@10': 0.0611, 'time@10': 6.344}:  30%|███       | 9/30 [00:46<01:41,  4.85s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0524, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8741, 'compress@10': 0.0611, 'time@10': 6.344}:  33%|███▎      | 10/30 [00:46<01:50,  5.54s/it]{'epoch': 7, 'num_users': 6.6364, 'loss': 0.053, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8741, 'compress@10': 0.061, 'time@10': 6.528}:  33%|███▎      | 10/30 [00:51<01:50,  5.54s/it]{'epoch': 7, 'num_users': 6.6364, 'loss': 0.053, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8741, 'compress@10': 0.061, 'time@10': 6.528}:  37%|███▋      | 11/30 [00:51<01:37,  5.14s/it]{'epoch': 7, 'num_users': 6.4167, 'loss': 0.0499, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8758, 'compress@10': 0.0643, 'time@10': 6.2409}:  37%|███▋      | 11/30 [00:54<01:37,  5.14s/it]{'epoch': 7, 'num_users': 6.4167, 'loss': 0.0499, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8758, 'compress@10': 0.0643, 'time@10': 6.2409}:  40%|████      | 12/30 [00:54<01:21,  4.52s/it]{'epoch': 7, 'num_users': 6.6154, 'loss': 0.0504, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8774, 'compress@10': 0.0644, 'time@10': 6.2968}:  40%|████      | 12/30 [00:57<01:21,  4.52s/it]{'epoch': 7, 'num_users': 6.6154, 'loss': 0.0504, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8774, 'compress@10': 0.0644, 'time@10': 6.2968}:  43%|████▎     | 13/30 [00:57<01:11,  4.22s/it]{'epoch': 7, 'num_users': 6.3571, 'loss': 0.0477, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8726, 'compress@10': 0.0727, 'time@10': 5.9463}:  43%|████▎     | 13/30 [00:59<01:11,  4.22s/it]{'epoch': 7, 'num_users': 6.3571, 'loss': 0.0477, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8726, 'compress@10': 0.0727, 'time@10': 5.9463}:  47%|████▋     | 14/30 [00:59<00:54,  3.38s/it]{'epoch': 7, 'num_users': 6.2667, 'loss': 0.0492, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8734, 'compress@10': 0.0706, 'time@10': 6.1382}:  47%|████▋     | 14/30 [01:03<00:54,  3.38s/it]{'epoch': 7, 'num_users': 6.2667, 'loss': 0.0492, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8734, 'compress@10': 0.0706, 'time@10': 6.1382}:  50%|█████     | 15/30 [01:03<00:55,  3.70s/it]{'epoch': 7, 'num_users': 6.0625, 'loss': 0.047, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8735, 'compress@10': 0.0725, 'time@10': 5.9495}:  50%|█████     | 15/30 [01:06<00:55,  3.70s/it] {'epoch': 7, 'num_users': 6.0625, 'loss': 0.047, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8735, 'compress@10': 0.0725, 'time@10': 5.9495}:  53%|█████▎    | 16/30 [01:06<00:49,  3.54s/it]{'epoch': 7, 'num_users': 5.8235, 'loss': 0.045, 'hit_ratio@10': 0.8115, 'ndcg@10': 0.866, 'compress@10': 0.0809, 'time@10': 5.7305}:  53%|█████▎    | 16/30 [01:07<00:49,  3.54s/it] {'epoch': 7, 'num_users': 5.8235, 'loss': 0.045, 'hit_ratio@10': 0.8115, 'ndcg@10': 0.866, 'compress@10': 0.0809, 'time@10': 5.7305}:  57%|█████▋    | 17/30 [01:07<00:36,  2.82s/it]{'epoch': 7, 'num_users': 6.0556, 'loss': 0.0457, 'hit_ratio@10': 0.81, 'ndcg@10': 0.8655, 'compress@10': 0.0798, 'time@10': 5.6601}:  57%|█████▋    | 17/30 [01:12<00:36,  2.82s/it]{'epoch': 7, 'num_users': 6.0556, 'loss': 0.0457, 'hit_ratio@10': 0.81, 'ndcg@10': 0.8655, 'compress@10': 0.0798, 'time@10': 5.6601}:  60%|██████    | 18/30 [01:12<00:39,  3.33s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.0442, 'hit_ratio@10': 0.8125, 'ndcg@10': 0.8672, 'compress@10': 0.0804, 'time@10': 5.6138}:  60%|██████    | 18/30 [01:14<00:39,  3.33s/it] {'epoch': 7, 'num_users': 6.0, 'loss': 0.0442, 'hit_ratio@10': 0.8125, 'ndcg@10': 0.8672, 'compress@10': 0.0804, 'time@10': 5.6138}:  63%|██████▎   | 19/30 [01:14<00:33,  3.06s/it]{'epoch': 7, 'num_users': 6.15, 'loss': 0.0445, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.8653, 'compress@10': 0.0785, 'time@10': 5.7999}:  63%|██████▎   | 19/30 [01:24<00:33,  3.06s/it]{'epoch': 7, 'num_users': 6.15, 'loss': 0.0445, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.8653, 'compress@10': 0.0785, 'time@10': 5.7999}:  67%|██████▋   | 20/30 [01:24<00:49,  4.96s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0462, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.8624, 'compress@10': 0.077, 'time@10': 5.9133}:  67%|██████▋   | 20/30 [01:28<00:49,  4.96s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0462, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.8624, 'compress@10': 0.077, 'time@10': 5.9133}:  70%|███████   | 21/30 [01:28<00:42,  4.71s/it]{'epoch': 7, 'num_users': 6.1818, 'loss': 0.0459, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8643, 'compress@10': 0.0765, 'time@10': 5.8058}:  70%|███████   | 21/30 [01:32<00:42,  4.71s/it]{'epoch': 7, 'num_users': 6.1818, 'loss': 0.0459, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8643, 'compress@10': 0.0765, 'time@10': 5.8058}:  73%|███████▎  | 22/30 [01:32<00:34,  4.37s/it]{'epoch': 7, 'num_users': 6.1304, 'loss': 0.0452, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8661, 'compress@10': 0.0761, 'time@10': 5.8694}:  73%|███████▎  | 22/30 [01:35<00:34,  4.37s/it]{'epoch': 7, 'num_users': 6.1304, 'loss': 0.0452, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8661, 'compress@10': 0.0761, 'time@10': 5.8694}:  77%|███████▋  | 23/30 [01:35<00:29,  4.16s/it]{'epoch': 7, 'num_users': 5.9583, 'loss': 0.0447, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8589, 'compress@10': 0.0818, 'time@10': 5.6721}:  77%|███████▋  | 23/30 [01:36<00:29,  4.16s/it]{'epoch': 7, 'num_users': 5.9583, 'loss': 0.0447, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8589, 'compress@10': 0.0818, 'time@10': 5.6721}:  80%|████████  | 24/30 [01:36<00:19,  3.27s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0436, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8483, 'compress@10': 0.0923, 'time@10': 5.4883}:  80%|████████  | 24/30 [01:37<00:19,  3.27s/it]   {'epoch': 7, 'num_users': 5.8, 'loss': 0.0436, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8483, 'compress@10': 0.0923, 'time@10': 5.4883}:  83%|████████▎ | 25/30 [01:37<00:12,  2.46s/it]{'epoch': 7, 'num_users': 5.8077, 'loss': 0.0445, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.8469, 'compress@10': 0.09, 'time@10': 5.6317}:  83%|████████▎ | 25/30 [01:46<00:12,  2.46s/it]{'epoch': 7, 'num_users': 5.8077, 'loss': 0.0445, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.8469, 'compress@10': 0.09, 'time@10': 5.6317}:  87%|████████▋ | 26/30 [01:46<00:17,  4.50s/it]{'epoch': 7, 'num_users': 5.8889, 'loss': 0.0446, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8502, 'compress@10': 0.0888, 'time@10': 5.714}:  87%|████████▋ | 26/30 [01:50<00:17,  4.50s/it]{'epoch': 7, 'num_users': 5.8889, 'loss': 0.0446, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8502, 'compress@10': 0.0888, 'time@10': 5.714}:  90%|█████████ | 27/30 [01:50<00:13,  4.34s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.0449, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8503, 'compress@10': 0.0877, 'time@10': 5.7645}:  90%|█████████ | 27/30 [01:57<00:13,  4.34s/it]  {'epoch': 7, 'num_users': 6.0, 'loss': 0.0449, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8503, 'compress@10': 0.0877, 'time@10': 5.7645}:  93%|█████████▎| 28/30 [01:57<00:10,  5.19s/it]{'epoch': 7, 'num_users': 5.8621, 'loss': 0.0442, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8519, 'compress@10': 0.0867, 'time@10': 5.7863}:  93%|█████████▎| 28/30 [02:01<00:10,  5.19s/it]{'epoch': 7, 'num_users': 5.8621, 'loss': 0.0442, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8519, 'compress@10': 0.0867, 'time@10': 5.7863}:  97%|█████████▋| 29/30 [02:01<00:04,  4.61s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0442, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8534, 'compress@10': 0.0857, 'time@10': 5.7763}:  97%|█████████▋| 29/30 [02:06<00:04,  4.61s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0442, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8534, 'compress@10': 0.0857, 'time@10': 5.7763}: 100%|██████████| 30/30 [02:06<00:00,  4.88s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0442, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8534, 'compress@10': 0.0857, 'time@10': 5.7763}: 100%|██████████| 30/30 [02:06<00:00,  4.22s/it]
Epoch: 7
Avg # of users: 5.866666666666666
Avg Loss: 0.044247704331598095
Avg hit ratio: 0.8241084188770357
Avg ndcg: 0.8533505464284604
Avg compression ratio: 0.085669586642874
Avg train time: 5.776284750302633
Std train time: 2.502357887420636
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 18, 10, 18, 9, 18, 18, 10, 10, 10, 6, 10, 10, 18, 18, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0546, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8392, 'compress@10': 0.0662, 'time@10': 5.9774}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0546, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8392, 'compress@10': 0.0662, 'time@10': 5.9774}:   3%|▎         | 1/30 [00:03<01:27,  3.03s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.844, 'compress@10': 0.0588, 'time@10': 5.4771}:   3%|▎         | 1/30 [00:08<01:27,  3.03s/it] {'epoch': 8, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.844, 'compress@10': 0.0588, 'time@10': 5.4771}:   7%|▋         | 2/30 [00:08<01:57,  4.20s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8484, 'compress@10': 0.0914, 'time@10': 4.7754}:   7%|▋         | 2/30 [00:09<01:57,  4.20s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8484, 'compress@10': 0.0914, 'time@10': 4.7754}:  10%|█         | 3/30 [00:09<01:23,  3.07s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0418, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8471, 'compress@10': 0.0818, 'time@10': 4.733}:  10%|█         | 3/30 [00:14<01:23,  3.07s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0418, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8471, 'compress@10': 0.0818, 'time@10': 4.733}:  13%|█▎        | 4/30 [00:14<01:36,  3.70s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0515, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.831, 'compress@10': 0.0737, 'time@10': 5.4152}:  13%|█▎        | 4/30 [00:18<01:36,  3.70s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0515, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.831, 'compress@10': 0.0737, 'time@10': 5.4152}:  17%|█▋        | 5/30 [00:18<01:36,  3.85s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0527, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.8311, 'compress@10': 0.069, 'time@10': 5.7197}:  17%|█▋        | 5/30 [00:26<01:36,  3.85s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0527, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.8311, 'compress@10': 0.069, 'time@10': 5.7197}:  20%|██        | 6/30 [00:26<02:03,  5.16s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.052, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8327, 'compress@10': 0.0682, 'time@10': 6.0358}:  20%|██        | 6/30 [00:30<02:03,  5.16s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.052, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8327, 'compress@10': 0.0682, 'time@10': 6.0358}:  23%|██▎       | 7/30 [00:30<01:50,  4.79s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8502, 'compress@10': 0.0661, 'time@10': 5.9959}:  23%|██▎       | 7/30 [00:36<01:50,  4.79s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8502, 'compress@10': 0.0661, 'time@10': 5.9959}:  27%|██▋       | 8/30 [00:36<01:52,  5.10s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0506, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8588, 'compress@10': 0.063, 'time@10': 6.3291}:  27%|██▋       | 8/30 [00:40<01:52,  5.10s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0506, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8588, 'compress@10': 0.063, 'time@10': 6.3291}:  30%|███       | 9/30 [00:40<01:43,  4.93s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0502, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8574, 'compress@10': 0.0612, 'time@10': 6.4064}:  30%|███       | 9/30 [00:47<01:43,  4.93s/it]  {'epoch': 8, 'num_users': 6.3, 'loss': 0.0502, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8574, 'compress@10': 0.0612, 'time@10': 6.4064}:  33%|███▎      | 10/30 [00:47<01:52,  5.61s/it]{'epoch': 8, 'num_users': 6.6364, 'loss': 0.051, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8578, 'compress@10': 0.0612, 'time@10': 6.5839}:  33%|███▎      | 10/30 [00:51<01:52,  5.61s/it]{'epoch': 8, 'num_users': 6.6364, 'loss': 0.051, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8578, 'compress@10': 0.0612, 'time@10': 6.5839}:  37%|███▋      | 11/30 [00:51<01:38,  5.19s/it]{'epoch': 8, 'num_users': 6.4167, 'loss': 0.0481, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8609, 'compress@10': 0.0645, 'time@10': 6.3054}:  37%|███▋      | 11/30 [00:55<01:38,  5.19s/it]{'epoch': 8, 'num_users': 6.4167, 'loss': 0.0481, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8609, 'compress@10': 0.0645, 'time@10': 6.3054}:  40%|████      | 12/30 [00:55<01:22,  4.61s/it]{'epoch': 8, 'num_users': 6.6154, 'loss': 0.0486, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8635, 'compress@10': 0.0646, 'time@10': 6.3602}:  40%|████      | 12/30 [00:58<01:22,  4.61s/it] {'epoch': 8, 'num_users': 6.6154, 'loss': 0.0486, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8635, 'compress@10': 0.0646, 'time@10': 6.3602}:  43%|████▎     | 13/30 [00:58<01:12,  4.29s/it]{'epoch': 8, 'num_users': 6.3571, 'loss': 0.0459, 'hit_ratio@10': 0.8165, 'ndcg@10': 0.8597, 'compress@10': 0.073, 'time@10': 6.0109}:  43%|████▎     | 13/30 [01:00<01:12,  4.29s/it]{'epoch': 8, 'num_users': 6.3571, 'loss': 0.0459, 'hit_ratio@10': 0.8165, 'ndcg@10': 0.8597, 'compress@10': 0.073, 'time@10': 6.0109}:  47%|████▋     | 14/30 [01:00<00:55,  3.45s/it]{'epoch': 8, 'num_users': 6.2667, 'loss': 0.0473, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.863, 'compress@10': 0.0708, 'time@10': 6.2021}:  47%|████▋     | 14/30 [01:04<00:55,  3.45s/it]{'epoch': 8, 'num_users': 6.2667, 'loss': 0.0473, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.863, 'compress@10': 0.0708, 'time@10': 6.2021}:  50%|█████     | 15/30 [01:04<00:56,  3.76s/it]{'epoch': 8, 'num_users': 6.0625, 'loss': 0.0452, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8637, 'compress@10': 0.0727, 'time@10': 6.0175}:  50%|█████     | 15/30 [01:08<00:56,  3.76s/it]{'epoch': 8, 'num_users': 6.0625, 'loss': 0.0452, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8637, 'compress@10': 0.0727, 'time@10': 6.0175}:  53%|█████▎    | 16/30 [01:08<00:50,  3.62s/it]{'epoch': 8, 'num_users': 5.8235, 'loss': 0.0432, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8568, 'compress@10': 0.0811, 'time@10': 5.8017}:  53%|█████▎    | 16/30 [01:09<00:50,  3.62s/it]{'epoch': 8, 'num_users': 5.8235, 'loss': 0.0432, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8568, 'compress@10': 0.0811, 'time@10': 5.8017}:  57%|█████▋    | 17/30 [01:09<00:37,  2.90s/it]{'epoch': 8, 'num_users': 6.0556, 'loss': 0.0439, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.8569, 'compress@10': 0.08, 'time@10': 5.729}:  57%|█████▋    | 17/30 [01:13<00:37,  2.90s/it]   {'epoch': 8, 'num_users': 6.0556, 'loss': 0.0439, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.8569, 'compress@10': 0.08, 'time@10': 5.729}:  60%|██████    | 18/30 [01:13<00:40,  3.39s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.0425, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8587, 'compress@10': 0.0807, 'time@10': 5.6517}:  60%|██████    | 18/30 [01:15<00:40,  3.39s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.0425, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8587, 'compress@10': 0.0807, 'time@10': 5.6517}:  63%|██████▎   | 19/30 [01:15<00:33,  3.02s/it]{'epoch': 8, 'num_users': 6.15, 'loss': 0.0428, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.8582, 'compress@10': 0.0787, 'time@10': 5.8369}:  63%|██████▎   | 19/30 [01:25<00:33,  3.02s/it]{'epoch': 8, 'num_users': 6.15, 'loss': 0.0428, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.8582, 'compress@10': 0.0787, 'time@10': 5.8369}:  67%|██████▋   | 20/30 [01:25<00:49,  4.94s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0442, 'hit_ratio@10': 0.8125, 'ndcg@10': 0.856, 'compress@10': 0.0773, 'time@10': 5.9275}:  67%|██████▋   | 20/30 [01:29<00:49,  4.94s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0442, 'hit_ratio@10': 0.8125, 'ndcg@10': 0.856, 'compress@10': 0.0773, 'time@10': 5.9275}:  70%|███████   | 21/30 [01:29<00:41,  4.63s/it]{'epoch': 8, 'num_users': 6.1818, 'loss': 0.0442, 'hit_ratio@10': 0.8168, 'ndcg@10': 0.8578, 'compress@10': 0.0767, 'time@10': 5.8154}:  70%|███████   | 21/30 [01:32<00:41,  4.63s/it]{'epoch': 8, 'num_users': 6.1818, 'loss': 0.0442, 'hit_ratio@10': 0.8168, 'ndcg@10': 0.8578, 'compress@10': 0.0767, 'time@10': 5.8154}:  73%|███████▎  | 22/30 [01:32<00:34,  4.29s/it]{'epoch': 8, 'num_users': 6.1304, 'loss': 0.0435, 'hit_ratio@10': 0.8161, 'ndcg@10': 0.8597, 'compress@10': 0.0763, 'time@10': 5.8343}:  73%|███████▎  | 22/30 [01:35<00:34,  4.29s/it]{'epoch': 8, 'num_users': 6.1304, 'loss': 0.0435, 'hit_ratio@10': 0.8161, 'ndcg@10': 0.8597, 'compress@10': 0.0763, 'time@10': 5.8343}:  77%|███████▋  | 23/30 [01:35<00:27,  3.95s/it]{'epoch': 8, 'num_users': 5.9583, 'loss': 0.0431, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8527, 'compress@10': 0.0819, 'time@10': 5.6401}:  77%|███████▋  | 23/30 [01:37<00:27,  3.95s/it]{'epoch': 8, 'num_users': 5.9583, 'loss': 0.0431, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8527, 'compress@10': 0.0819, 'time@10': 5.6401}:  80%|████████  | 24/30 [01:37<00:18,  3.13s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0419, 'hit_ratio@10': 0.8095, 'ndcg@10': 0.8424, 'compress@10': 0.0924, 'time@10': 5.4606}:  80%|████████  | 24/30 [01:37<00:18,  3.13s/it]   {'epoch': 8, 'num_users': 5.8, 'loss': 0.0419, 'hit_ratio@10': 0.8095, 'ndcg@10': 0.8424, 'compress@10': 0.0924, 'time@10': 5.4606}:  83%|████████▎ | 25/30 [01:37<00:11,  2.38s/it]{'epoch': 8, 'num_users': 5.8077, 'loss': 0.0427, 'hit_ratio@10': 0.8131, 'ndcg@10': 0.8415, 'compress@10': 0.0901, 'time@10': 5.6118}:  83%|████████▎ | 25/30 [01:47<00:11,  2.38s/it]{'epoch': 8, 'num_users': 5.8077, 'loss': 0.0427, 'hit_ratio@10': 0.8131, 'ndcg@10': 0.8415, 'compress@10': 0.0901, 'time@10': 5.6118}:  87%|████████▋ | 26/30 [01:47<00:17,  4.49s/it]{'epoch': 8, 'num_users': 5.8889, 'loss': 0.0435, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8428, 'compress@10': 0.0891, 'time@10': 5.697}:  87%|████████▋ | 26/30 [01:51<00:17,  4.49s/it] {'epoch': 8, 'num_users': 5.8889, 'loss': 0.0435, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8428, 'compress@10': 0.0891, 'time@10': 5.697}:  90%|█████████ | 27/30 [01:51<00:13,  4.34s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.0436, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8432, 'compress@10': 0.088, 'time@10': 5.7693}:  90%|█████████ | 27/30 [01:58<00:13,  4.34s/it]   {'epoch': 8, 'num_users': 6.0, 'loss': 0.0436, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8432, 'compress@10': 0.088, 'time@10': 5.7693}:  93%|█████████▎| 28/30 [01:58<00:10,  5.37s/it]{'epoch': 8, 'num_users': 5.8621, 'loss': 0.043, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8449, 'compress@10': 0.087, 'time@10': 5.7589}:  93%|█████████▎| 28/30 [02:01<00:10,  5.37s/it]{'epoch': 8, 'num_users': 5.8621, 'loss': 0.043, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8449, 'compress@10': 0.087, 'time@10': 5.7589}:  97%|█████████▋| 29/30 [02:01<00:04,  4.59s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0432, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.8465, 'compress@10': 0.086, 'time@10': 5.7164}:  97%|█████████▋| 29/30 [02:06<00:04,  4.59s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0432, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.8465, 'compress@10': 0.086, 'time@10': 5.7164}: 100%|██████████| 30/30 [02:06<00:00,  4.58s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0432, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.8465, 'compress@10': 0.086, 'time@10': 5.7164}: 100%|██████████| 30/30 [02:06<00:00,  4.21s/it]
Epoch: 8
Avg # of users: 5.866666666666666
Avg Loss: 0.043150867568684026
Avg hit ratio: 0.8225099856739811
Avg ndcg: 0.8465175035760331
Avg compression ratio: 0.08598539173785198
Avg train time: 5.716423869132996
Std train time: 2.4840717616193833
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 18, 10, 19, 9, 18, 19, 10, 10, 10, 6, 10, 10, 19, 19, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8579, 'compress@10': 0.0667, 'time@10': 6.149}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8579, 'compress@10': 0.0667, 'time@10': 6.149}:   3%|▎         | 1/30 [00:03<01:30,  3.13s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8545, 'compress@10': 0.0592, 'time@10': 5.8569}:   3%|▎         | 1/30 [00:08<01:30,  3.13s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8545, 'compress@10': 0.0592, 'time@10': 5.8569}:   7%|▋         | 2/30 [00:08<02:08,  4.58s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8554, 'compress@10': 0.0917, 'time@10': 5.028}:   7%|▋         | 2/30 [00:10<02:08,  4.58s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8554, 'compress@10': 0.0917, 'time@10': 5.028}:  10%|█         | 3/30 [00:10<01:28,  3.28s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0367, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8489, 'compress@10': 0.082, 'time@10': 4.8916}:  10%|█         | 3/30 [00:14<01:28,  3.28s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0367, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8489, 'compress@10': 0.082, 'time@10': 4.8916}:  13%|█▎        | 4/30 [00:14<01:38,  3.77s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8334, 'compress@10': 0.0738, 'time@10': 5.5497}:  13%|█▎        | 4/30 [00:19<01:38,  3.77s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8334, 'compress@10': 0.0738, 'time@10': 5.5497}:  17%|█▋        | 5/30 [00:19<01:37,  3.90s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0487, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8333, 'compress@10': 0.069, 'time@10': 5.8529}:  17%|█▋        | 5/30 [00:26<01:37,  3.90s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0487, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8333, 'compress@10': 0.069, 'time@10': 5.8529}:  20%|██        | 6/30 [00:26<02:02,  5.10s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.049, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8386, 'compress@10': 0.0681, 'time@10': 6.1699}:  20%|██        | 6/30 [00:30<02:02,  5.10s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.049, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8386, 'compress@10': 0.0681, 'time@10': 6.1699}:  23%|██▎       | 7/30 [00:30<01:49,  4.76s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0488, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8554, 'compress@10': 0.0661, 'time@10': 6.1789}:  23%|██▎       | 7/30 [00:36<01:49,  4.76s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0488, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8554, 'compress@10': 0.0661, 'time@10': 6.1789}:  27%|██▋       | 8/30 [00:36<01:55,  5.25s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0476, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8637, 'compress@10': 0.063, 'time@10': 6.5027}:  27%|██▋       | 8/30 [00:41<01:55,  5.25s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0476, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8637, 'compress@10': 0.063, 'time@10': 6.5027}:  30%|███       | 9/30 [00:41<01:45,  5.04s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0465, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8648, 'compress@10': 0.0611, 'time@10': 6.5239}:  30%|███       | 9/30 [00:48<01:45,  5.04s/it]  {'epoch': 9, 'num_users': 6.3, 'loss': 0.0465, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8648, 'compress@10': 0.0611, 'time@10': 6.5239}:  33%|███▎      | 10/30 [00:48<01:51,  5.57s/it]{'epoch': 9, 'num_users': 6.6364, 'loss': 0.0481, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8658, 'compress@10': 0.0612, 'time@10': 6.68}:  33%|███▎      | 10/30 [00:52<01:51,  5.57s/it]{'epoch': 9, 'num_users': 6.6364, 'loss': 0.0481, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8658, 'compress@10': 0.0612, 'time@10': 6.68}:  37%|███▋      | 11/30 [00:52<01:37,  5.14s/it]{'epoch': 9, 'num_users': 6.4167, 'loss': 0.0453, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8682, 'compress@10': 0.0645, 'time@10': 6.3958}:  37%|███▋      | 11/30 [00:55<01:37,  5.14s/it]{'epoch': 9, 'num_users': 6.4167, 'loss': 0.0453, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8682, 'compress@10': 0.0645, 'time@10': 6.3958}:  40%|████      | 12/30 [00:55<01:22,  4.58s/it]{'epoch': 9, 'num_users': 6.6154, 'loss': 0.046, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8698, 'compress@10': 0.0646, 'time@10': 6.4452}:  40%|████      | 12/30 [00:59<01:22,  4.58s/it] {'epoch': 9, 'num_users': 6.6154, 'loss': 0.046, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8698, 'compress@10': 0.0646, 'time@10': 6.4452}:  43%|████▎     | 13/30 [00:59<01:12,  4.27s/it]{'epoch': 9, 'num_users': 6.3571, 'loss': 0.0434, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8655, 'compress@10': 0.073, 'time@10': 6.0917}:  43%|████▎     | 13/30 [01:00<01:12,  4.27s/it]{'epoch': 9, 'num_users': 6.3571, 'loss': 0.0434, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8655, 'compress@10': 0.073, 'time@10': 6.0917}:  47%|████▋     | 14/30 [01:00<00:55,  3.44s/it]{'epoch': 9, 'num_users': 6.2667, 'loss': 0.0448, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8677, 'compress@10': 0.0709, 'time@10': 6.277}:  47%|████▋     | 14/30 [01:05<00:55,  3.44s/it]{'epoch': 9, 'num_users': 6.2667, 'loss': 0.0448, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8677, 'compress@10': 0.0709, 'time@10': 6.277}:  50%|█████     | 15/30 [01:05<00:56,  3.76s/it]{'epoch': 9, 'num_users': 6.0625, 'loss': 0.0428, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8683, 'compress@10': 0.0727, 'time@10': 6.0858}:  50%|█████     | 15/30 [01:08<00:56,  3.76s/it]{'epoch': 9, 'num_users': 6.0625, 'loss': 0.0428, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8683, 'compress@10': 0.0727, 'time@10': 6.0858}:  53%|█████▎    | 16/30 [01:08<00:50,  3.61s/it]{'epoch': 9, 'num_users': 5.8235, 'loss': 0.041, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8611, 'compress@10': 0.0811, 'time@10': 5.8713}:  53%|█████▎    | 16/30 [01:09<00:50,  3.61s/it] {'epoch': 9, 'num_users': 5.8235, 'loss': 0.041, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8611, 'compress@10': 0.0811, 'time@10': 5.8713}:  57%|█████▋    | 17/30 [01:09<00:37,  2.90s/it]{'epoch': 9, 'num_users': 6.0556, 'loss': 0.0417, 'hit_ratio@10': 0.8158, 'ndcg@10': 0.8611, 'compress@10': 0.0801, 'time@10': 5.7948}:  57%|█████▋    | 17/30 [01:14<00:37,  2.90s/it]{'epoch': 9, 'num_users': 6.0556, 'loss': 0.0417, 'hit_ratio@10': 0.8158, 'ndcg@10': 0.8611, 'compress@10': 0.0801, 'time@10': 5.7948}:  60%|██████    | 18/30 [01:14<00:40,  3.39s/it]{'epoch': 9, 'num_users': 6.0, 'loss': 0.0404, 'hit_ratio@10': 0.818, 'ndcg@10': 0.8625, 'compress@10': 0.0807, 'time@10': 5.7144}:  60%|██████    | 18/30 [01:16<00:40,  3.39s/it]    {'epoch': 9, 'num_users': 6.0, 'loss': 0.0404, 'hit_ratio@10': 0.818, 'ndcg@10': 0.8625, 'compress@10': 0.0807, 'time@10': 5.7144}:  63%|██████▎   | 19/30 [01:16<00:33,  3.03s/it]{'epoch': 9, 'num_users': 6.15, 'loss': 0.0408, 'hit_ratio@10': 0.8219, 'ndcg@10': 0.8613, 'compress@10': 0.0788, 'time@10': 5.8941}:  63%|██████▎   | 19/30 [01:25<00:33,  3.03s/it]{'epoch': 9, 'num_users': 6.15, 'loss': 0.0408, 'hit_ratio@10': 0.8219, 'ndcg@10': 0.8613, 'compress@10': 0.0788, 'time@10': 5.8941}:  67%|██████▋   | 20/30 [01:25<00:49,  4.93s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0425, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.859, 'compress@10': 0.0773, 'time@10': 6.0057}:  67%|██████▋   | 20/30 [01:30<00:49,  4.93s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0425, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.859, 'compress@10': 0.0773, 'time@10': 6.0057}:  70%|███████   | 21/30 [01:30<00:42,  4.70s/it]{'epoch': 9, 'num_users': 6.1818, 'loss': 0.0433, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8545, 'compress@10': 0.0767, 'time@10': 5.8919}:  70%|███████   | 21/30 [01:33<00:42,  4.70s/it]{'epoch': 9, 'num_users': 6.1818, 'loss': 0.0433, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8545, 'compress@10': 0.0767, 'time@10': 5.8919}:  73%|███████▎  | 22/30 [01:33<00:34,  4.35s/it]{'epoch': 9, 'num_users': 6.1304, 'loss': 0.0427, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8566, 'compress@10': 0.0763, 'time@10': 5.9091}:  73%|███████▎  | 22/30 [01:36<00:34,  4.35s/it]{'epoch': 9, 'num_users': 6.1304, 'loss': 0.0427, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8566, 'compress@10': 0.0763, 'time@10': 5.9091}:  77%|███████▋  | 23/30 [01:36<00:28,  4.00s/it]{'epoch': 9, 'num_users': 5.9583, 'loss': 0.0422, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8498, 'compress@10': 0.0819, 'time@10': 5.7143}:  77%|███████▋  | 23/30 [01:38<00:28,  4.00s/it]{'epoch': 9, 'num_users': 5.9583, 'loss': 0.0422, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8498, 'compress@10': 0.0819, 'time@10': 5.7143}:  80%|████████  | 24/30 [01:38<00:19,  3.18s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0409, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8406, 'compress@10': 0.0924, 'time@10': 5.5353}:  80%|████████  | 24/30 [01:38<00:19,  3.18s/it]   {'epoch': 9, 'num_users': 5.8, 'loss': 0.0409, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8406, 'compress@10': 0.0924, 'time@10': 5.5353}:  83%|████████▎ | 25/30 [01:38<00:12,  2.43s/it]{'epoch': 9, 'num_users': 5.8077, 'loss': 0.0416, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8403, 'compress@10': 0.09, 'time@10': 5.6697}:  83%|████████▎ | 25/30 [01:47<00:12,  2.43s/it]{'epoch': 9, 'num_users': 5.8077, 'loss': 0.0416, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8403, 'compress@10': 0.09, 'time@10': 5.6697}:  87%|████████▋ | 26/30 [01:47<00:17,  4.42s/it]{'epoch': 9, 'num_users': 5.8889, 'loss': 0.0419, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8385, 'compress@10': 0.089, 'time@10': 5.7684}:  87%|████████▋ | 26/30 [01:51<00:17,  4.42s/it]{'epoch': 9, 'num_users': 5.8889, 'loss': 0.0419, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8385, 'compress@10': 0.089, 'time@10': 5.7684}:  90%|█████████ | 27/30 [01:51<00:13,  4.36s/it]{'epoch': 9, 'num_users': 6.0, 'loss': 0.0423, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.8397, 'compress@10': 0.0878, 'time@10': 5.8449}:  90%|█████████ | 27/30 [01:59<00:13,  4.36s/it]  {'epoch': 9, 'num_users': 6.0, 'loss': 0.0423, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.8397, 'compress@10': 0.0878, 'time@10': 5.8449}:  93%|█████████▎| 28/30 [01:59<00:10,  5.43s/it]{'epoch': 9, 'num_users': 5.8621, 'loss': 0.0418, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8418, 'compress@10': 0.0868, 'time@10': 5.8624}:  93%|█████████▎| 28/30 [02:03<00:10,  5.43s/it]{'epoch': 9, 'num_users': 5.8621, 'loss': 0.0418, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8418, 'compress@10': 0.0868, 'time@10': 5.8624}:  97%|█████████▋| 29/30 [02:03<00:04,  4.77s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0419, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8436, 'compress@10': 0.0857, 'time@10': 5.8477}:  97%|█████████▋| 29/30 [02:08<00:04,  4.77s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0419, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8436, 'compress@10': 0.0857, 'time@10': 5.8477}: 100%|██████████| 30/30 [02:08<00:00,  4.98s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0419, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8436, 'compress@10': 0.0857, 'time@10': 5.8477}: 100%|██████████| 30/30 [02:08<00:00,  4.29s/it]
Epoch: 9
Avg # of users: 5.866666666666666
Avg Loss: 0.04188547221081531
Avg hit ratio: 0.829779514561157
Avg ndcg: 0.8436111069073153
Avg compression ratio: 0.08573036838395669
Avg train time: 5.847664507230123
Std train time: 2.4764109249084494
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 18, 10, 20, 9, 18, 20, 10, 10, 10, 6, 10, 10, 20, 20, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8455, 'compress@10': 0.0652, 'time@10': 5.9624}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8455, 'compress@10': 0.0652, 'time@10': 5.9624}:   3%|▎         | 1/30 [00:03<01:27,  3.03s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8478, 'compress@10': 0.0586, 'time@10': 5.4587}:   3%|▎         | 1/30 [00:08<01:27,  3.03s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8478, 'compress@10': 0.0586, 'time@10': 5.4587}:   7%|▋         | 2/30 [00:08<01:57,  4.19s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8509, 'compress@10': 0.0914, 'time@10': 4.7671}:   7%|▋         | 2/30 [00:09<01:57,  4.19s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8509, 'compress@10': 0.0914, 'time@10': 4.7671}:  10%|█         | 3/30 [00:09<01:22,  3.07s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8479, 'compress@10': 0.0817, 'time@10': 4.6949}:  10%|█         | 3/30 [00:14<01:22,  3.07s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8479, 'compress@10': 0.0817, 'time@10': 4.6949}:  13%|█▎        | 4/30 [00:14<01:34,  3.64s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.045, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8325, 'compress@10': 0.0735, 'time@10': 5.3971}:  13%|█▎        | 4/30 [00:18<01:34,  3.64s/it] {'epoch': 10, 'num_users': 5.8, 'loss': 0.045, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8325, 'compress@10': 0.0735, 'time@10': 5.3971}:  17%|█▋        | 5/30 [00:18<01:35,  3.82s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0465, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8337, 'compress@10': 0.0688, 'time@10': 5.7189}:  17%|█▋        | 5/30 [00:25<01:35,  3.82s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0465, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8337, 'compress@10': 0.0688, 'time@10': 5.7189}:  20%|██        | 6/30 [00:25<02:00,  5.03s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0458, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8353, 'compress@10': 0.0679, 'time@10': 6.0401}:  20%|██        | 6/30 [00:29<02:00,  5.03s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0458, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8353, 'compress@10': 0.0679, 'time@10': 6.0401}:  23%|██▎       | 7/30 [00:29<01:48,  4.70s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0459, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8529, 'compress@10': 0.0658, 'time@10': 5.9912}:  23%|██▎       | 7/30 [00:35<01:48,  4.70s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.0459, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8529, 'compress@10': 0.0658, 'time@10': 5.9912}:  27%|██▋       | 8/30 [00:35<01:50,  5.02s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0453, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8618, 'compress@10': 0.0628, 'time@10': 6.3319}:  27%|██▋       | 8/30 [00:40<01:50,  5.02s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0453, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8618, 'compress@10': 0.0628, 'time@10': 6.3319}:  30%|███       | 9/30 [00:40<01:42,  4.88s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0438, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8634, 'compress@10': 0.061, 'time@10': 6.4132}:  30%|███       | 9/30 [00:47<01:42,  4.88s/it]    {'epoch': 10, 'num_users': 6.3, 'loss': 0.0438, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8634, 'compress@10': 0.061, 'time@10': 6.4132}:  33%|███▎      | 10/30 [00:47<01:51,  5.59s/it]{'epoch': 10, 'num_users': 6.6364, 'loss': 0.0471, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.8642, 'compress@10': 0.0611, 'time@10': 6.5956}:  33%|███▎      | 10/30 [00:51<01:51,  5.59s/it]{'epoch': 10, 'num_users': 6.6364, 'loss': 0.0471, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.8642, 'compress@10': 0.0611, 'time@10': 6.5956}:  37%|███▋      | 11/30 [00:51<01:38,  5.18s/it]{'epoch': 10, 'num_users': 6.4167, 'loss': 0.0444, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8668, 'compress@10': 0.0644, 'time@10': 6.3172}:  37%|███▋      | 11/30 [00:54<01:38,  5.18s/it]{'epoch': 10, 'num_users': 6.4167, 'loss': 0.0444, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8668, 'compress@10': 0.0644, 'time@10': 6.3172}:  40%|████      | 12/30 [00:54<01:22,  4.61s/it]{'epoch': 10, 'num_users': 6.6154, 'loss': 0.045, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8687, 'compress@10': 0.0646, 'time@10': 6.3723}:  40%|████      | 12/30 [00:58<01:22,  4.61s/it] {'epoch': 10, 'num_users': 6.6154, 'loss': 0.045, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8687, 'compress@10': 0.0646, 'time@10': 6.3723}:  43%|████▎     | 13/30 [00:58<01:12,  4.29s/it]{'epoch': 10, 'num_users': 6.3571, 'loss': 0.0424, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.8645, 'compress@10': 0.073, 'time@10': 6.0342}:  43%|████▎     | 13/30 [01:00<01:12,  4.29s/it]{'epoch': 10, 'num_users': 6.3571, 'loss': 0.0424, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.8645, 'compress@10': 0.073, 'time@10': 6.0342}:  47%|████▋     | 14/30 [01:00<00:56,  3.51s/it]{'epoch': 10, 'num_users': 6.2667, 'loss': 0.0436, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8656, 'compress@10': 0.0709, 'time@10': 6.3089}:  47%|████▋     | 14/30 [01:05<00:56,  3.51s/it]{'epoch': 10, 'num_users': 6.2667, 'loss': 0.0436, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8656, 'compress@10': 0.0709, 'time@10': 6.3089}:  50%|█████     | 15/30 [01:05<00:59,  3.99s/it]{'epoch': 10, 'num_users': 6.0625, 'loss': 0.0417, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8672, 'compress@10': 0.0727, 'time@10': 6.1189}:  50%|█████     | 15/30 [01:08<00:59,  3.99s/it]{'epoch': 10, 'num_users': 6.0625, 'loss': 0.0417, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8672, 'compress@10': 0.0727, 'time@10': 6.1189}:  53%|█████▎    | 16/30 [01:08<00:53,  3.79s/it]{'epoch': 10, 'num_users': 5.8235, 'loss': 0.0398, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.86, 'compress@10': 0.0811, 'time@10': 5.9032}:  53%|█████▎    | 16/30 [01:09<00:53,  3.79s/it]  {'epoch': 10, 'num_users': 5.8235, 'loss': 0.0398, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.86, 'compress@10': 0.0811, 'time@10': 5.9032}:  57%|█████▋    | 17/30 [01:09<00:39,  3.03s/it]{'epoch': 10, 'num_users': 6.0556, 'loss': 0.0405, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8605, 'compress@10': 0.0801, 'time@10': 5.823}:  57%|█████▋    | 17/30 [01:14<00:39,  3.03s/it]{'epoch': 10, 'num_users': 6.0556, 'loss': 0.0405, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8605, 'compress@10': 0.0801, 'time@10': 5.823}:  60%|██████    | 18/30 [01:14<00:41,  3.47s/it]{'epoch': 10, 'num_users': 6.0, 'loss': 0.0392, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8624, 'compress@10': 0.0807, 'time@10': 5.7412}:  60%|██████    | 18/30 [01:16<00:41,  3.47s/it]  {'epoch': 10, 'num_users': 6.0, 'loss': 0.0392, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8624, 'compress@10': 0.0807, 'time@10': 5.7412}:  63%|██████▎   | 19/30 [01:16<00:33,  3.08s/it]{'epoch': 10, 'num_users': 6.15, 'loss': 0.0395, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.862, 'compress@10': 0.0787, 'time@10': 5.9238}:  63%|██████▎   | 19/30 [01:25<00:33,  3.08s/it]{'epoch': 10, 'num_users': 6.15, 'loss': 0.0395, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.862, 'compress@10': 0.0787, 'time@10': 5.9238}:  67%|██████▋   | 20/30 [01:25<00:49,  4.99s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0409, 'hit_ratio@10': 0.8219, 'ndcg@10': 0.8598, 'compress@10': 0.0773, 'time@10': 6.0201}:  67%|██████▋   | 20/30 [01:29<00:49,  4.99s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0409, 'hit_ratio@10': 0.8219, 'ndcg@10': 0.8598, 'compress@10': 0.0773, 'time@10': 6.0201}:  70%|███████   | 21/30 [01:29<00:42,  4.70s/it]{'epoch': 10, 'num_users': 6.1818, 'loss': 0.0412, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8603, 'compress@10': 0.0767, 'time@10': 5.9033}:  70%|███████   | 21/30 [01:33<00:42,  4.70s/it]{'epoch': 10, 'num_users': 6.1818, 'loss': 0.0412, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8603, 'compress@10': 0.0767, 'time@10': 5.9033}:  73%|███████▎  | 22/30 [01:33<00:34,  4.34s/it]{'epoch': 10, 'num_users': 6.1304, 'loss': 0.0406, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8619, 'compress@10': 0.0763, 'time@10': 5.9184}:  73%|███████▎  | 22/30 [01:36<00:34,  4.34s/it]{'epoch': 10, 'num_users': 6.1304, 'loss': 0.0406, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8619, 'compress@10': 0.0763, 'time@10': 5.9184}:  77%|███████▋  | 23/30 [01:36<00:27,  3.98s/it]{'epoch': 10, 'num_users': 5.9583, 'loss': 0.0401, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8548, 'compress@10': 0.0819, 'time@10': 5.7288}:  77%|███████▋  | 23/30 [01:37<00:27,  3.98s/it]{'epoch': 10, 'num_users': 5.9583, 'loss': 0.0401, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8548, 'compress@10': 0.0819, 'time@10': 5.7288}:  80%|████████  | 24/30 [01:37<00:19,  3.21s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0389, 'hit_ratio@10': 0.8194, 'ndcg@10': 0.8455, 'compress@10': 0.0924, 'time@10': 5.5539}:  80%|████████  | 24/30 [01:38<00:19,  3.21s/it]   {'epoch': 10, 'num_users': 5.8, 'loss': 0.0389, 'hit_ratio@10': 0.8194, 'ndcg@10': 0.8455, 'compress@10': 0.0924, 'time@10': 5.5539}:  83%|████████▎ | 25/30 [01:38<00:12,  2.46s/it]{'epoch': 10, 'num_users': 5.8077, 'loss': 0.0395, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8452, 'compress@10': 0.0899, 'time@10': 5.7141}:  83%|████████▎ | 25/30 [01:48<00:12,  2.46s/it]{'epoch': 10, 'num_users': 5.8077, 'loss': 0.0395, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8452, 'compress@10': 0.0899, 'time@10': 5.7141}:  87%|████████▋ | 26/30 [01:48<00:18,  4.65s/it]{'epoch': 10, 'num_users': 5.8889, 'loss': 0.0391, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8468, 'compress@10': 0.0888, 'time@10': 5.7776}:  87%|████████▋ | 26/30 [01:52<00:18,  4.65s/it]{'epoch': 10, 'num_users': 5.8889, 'loss': 0.0391, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8468, 'compress@10': 0.0888, 'time@10': 5.7776}:  90%|█████████ | 27/30 [01:52<00:13,  4.38s/it]{'epoch': 10, 'num_users': 6.0, 'loss': 0.0393, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8477, 'compress@10': 0.0877, 'time@10': 5.8433}:  90%|█████████ | 27/30 [01:59<00:13,  4.38s/it]   {'epoch': 10, 'num_users': 6.0, 'loss': 0.0393, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8477, 'compress@10': 0.0877, 'time@10': 5.8433}:  93%|█████████▎| 28/30 [01:59<00:10,  5.37s/it]{'epoch': 10, 'num_users': 5.8621, 'loss': 0.0388, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8497, 'compress@10': 0.0867, 'time@10': 5.8689}:  93%|█████████▎| 28/30 [02:03<00:10,  5.37s/it]{'epoch': 10, 'num_users': 5.8621, 'loss': 0.0388, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8497, 'compress@10': 0.0867, 'time@10': 5.8689}:  97%|█████████▋| 29/30 [02:03<00:04,  4.76s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.0389, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.8514, 'compress@10': 0.0856, 'time@10': 5.8712}:  97%|█████████▋| 29/30 [02:09<00:04,  4.76s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.0389, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.8514, 'compress@10': 0.0856, 'time@10': 5.8712}: 100%|██████████| 30/30 [02:09<00:00,  5.13s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.0389, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.8514, 'compress@10': 0.0856, 'time@10': 5.8712}: 100%|██████████| 30/30 [02:09<00:00,  4.31s/it]
Epoch: 10
Avg # of users: 5.866666666666666
Avg Loss: 0.03890917883775505
Avg hit ratio: 0.8323655591880913
Avg ndcg: 0.8513687790264727
Avg compression ratio: 0.08562797142375707
Avg train time: 5.871232962608337
Std train time: 2.522613330532619
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 18, 10, 21, 8, 18, 21, 10, 10, 10, 6, 10, 10, 21, 21, 6, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8595, 'compress@10': 0.0656, 'time@10': 6.0052}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8595, 'compress@10': 0.0656, 'time@10': 6.0052}:   3%|▎         | 1/30 [00:03<01:28,  3.04s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8645, 'compress@10': 0.059, 'time@10': 5.4803}:   3%|▎         | 1/30 [00:08<01:28,  3.04s/it] {'epoch': 11, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8645, 'compress@10': 0.059, 'time@10': 5.4803}:   7%|▋         | 2/30 [00:08<01:57,  4.19s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8621, 'compress@10': 0.0917, 'time@10': 4.735}:   7%|▋         | 2/30 [00:09<01:57,  4.19s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8621, 'compress@10': 0.0917, 'time@10': 4.735}:  10%|█         | 3/30 [00:09<01:21,  3.04s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8575, 'compress@10': 0.0819, 'time@10': 4.6783}:  10%|█         | 3/30 [00:14<01:21,  3.04s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8575, 'compress@10': 0.0819, 'time@10': 4.6783}:  13%|█▎        | 4/30 [00:14<01:34,  3.63s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0436, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8401, 'compress@10': 0.0736, 'time@10': 5.4547}:  13%|█▎        | 4/30 [00:18<01:34,  3.63s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0436, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8401, 'compress@10': 0.0736, 'time@10': 5.4547}:  17%|█▋        | 5/30 [00:18<01:37,  3.88s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0451, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8413, 'compress@10': 0.0687, 'time@10': 5.7906}:  17%|█▋        | 5/30 [00:26<01:37,  3.88s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0451, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8413, 'compress@10': 0.0687, 'time@10': 5.7906}:  20%|██        | 6/30 [00:26<02:02,  5.12s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0451, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.847, 'compress@10': 0.0677, 'time@10': 6.1088}:  20%|██        | 6/30 [00:30<02:02,  5.12s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0451, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.847, 'compress@10': 0.0677, 'time@10': 6.1088}:  23%|██▎       | 7/30 [00:30<01:49,  4.77s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.045, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.862, 'compress@10': 0.0656, 'time@10': 6.0447}:  23%|██▎       | 7/30 [00:35<01:49,  4.77s/it]  {'epoch': 11, 'num_users': 6.125, 'loss': 0.045, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.862, 'compress@10': 0.0656, 'time@10': 6.0447}:  27%|██▋       | 8/30 [00:35<01:50,  5.04s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0444, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8695, 'compress@10': 0.0626, 'time@10': 6.3709}:  27%|██▋       | 8/30 [00:40<01:50,  5.04s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0444, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8695, 'compress@10': 0.0626, 'time@10': 6.3709}:  30%|███       | 9/30 [00:40<01:42,  4.88s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0449, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8713, 'compress@10': 0.0608, 'time@10': 6.4421}:  30%|███       | 9/30 [00:47<01:42,  4.88s/it]  {'epoch': 11, 'num_users': 6.3, 'loss': 0.0449, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8713, 'compress@10': 0.0608, 'time@10': 6.4421}:  33%|███▎      | 10/30 [00:47<01:51,  5.57s/it]{'epoch': 11, 'num_users': 6.6364, 'loss': 0.048, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.879, 'compress@10': 0.0608, 'time@10': 6.6217}:  33%|███▎      | 10/30 [00:51<01:51,  5.57s/it]{'epoch': 11, 'num_users': 6.6364, 'loss': 0.048, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.879, 'compress@10': 0.0608, 'time@10': 6.6217}:  37%|███▋      | 11/30 [00:51<01:38,  5.17s/it]{'epoch': 11, 'num_users': 6.4167, 'loss': 0.0451, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8811, 'compress@10': 0.0642, 'time@10': 6.3443}:  37%|███▋      | 11/30 [00:55<01:38,  5.17s/it]{'epoch': 11, 'num_users': 6.4167, 'loss': 0.0451, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8811, 'compress@10': 0.0642, 'time@10': 6.3443}:  40%|████      | 12/30 [00:55<01:22,  4.61s/it]{'epoch': 11, 'num_users': 6.6154, 'loss': 0.0455, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8819, 'compress@10': 0.0644, 'time@10': 6.3968}:  40%|████      | 12/30 [00:58<01:22,  4.61s/it] {'epoch': 11, 'num_users': 6.6154, 'loss': 0.0455, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8819, 'compress@10': 0.0644, 'time@10': 6.3968}:  43%|████▎     | 13/30 [00:58<01:12,  4.29s/it]{'epoch': 11, 'num_users': 6.3571, 'loss': 0.0428, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8768, 'compress@10': 0.0728, 'time@10': 6.062}:  43%|████▎     | 13/30 [01:00<01:12,  4.29s/it]{'epoch': 11, 'num_users': 6.3571, 'loss': 0.0428, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8768, 'compress@10': 0.0728, 'time@10': 6.062}:  47%|████▋     | 14/30 [01:00<00:56,  3.52s/it]{'epoch': 11, 'num_users': 6.2667, 'loss': 0.0434, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.876, 'compress@10': 0.0707, 'time@10': 6.1876}:  47%|████▋     | 14/30 [01:04<00:56,  3.52s/it]{'epoch': 11, 'num_users': 6.2667, 'loss': 0.0434, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.876, 'compress@10': 0.0707, 'time@10': 6.1876}:  50%|█████     | 15/30 [01:04<00:55,  3.67s/it]{'epoch': 11, 'num_users': 6.0625, 'loss': 0.0414, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8762, 'compress@10': 0.0726, 'time@10': 6.0042}:  50%|█████     | 15/30 [01:07<00:55,  3.67s/it]{'epoch': 11, 'num_users': 6.0625, 'loss': 0.0414, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8762, 'compress@10': 0.0726, 'time@10': 6.0042}:  53%|█████▎    | 16/30 [01:07<00:49,  3.56s/it]{'epoch': 11, 'num_users': 5.8235, 'loss': 0.0396, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8685, 'compress@10': 0.081, 'time@10': 5.8153}:  53%|█████▎    | 16/30 [01:09<00:49,  3.56s/it] {'epoch': 11, 'num_users': 5.8235, 'loss': 0.0396, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8685, 'compress@10': 0.081, 'time@10': 5.8153}:  57%|█████▋    | 17/30 [01:09<00:37,  2.92s/it]{'epoch': 11, 'num_users': 6.0556, 'loss': 0.0401, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.8687, 'compress@10': 0.0801, 'time@10': 5.7395}:  57%|█████▋    | 17/30 [01:13<00:37,  2.92s/it]{'epoch': 11, 'num_users': 6.0556, 'loss': 0.0401, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.8687, 'compress@10': 0.0801, 'time@10': 5.7395}:  60%|██████    | 18/30 [01:13<00:40,  3.39s/it]{'epoch': 11, 'num_users': 6.0, 'loss': 0.039, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8696, 'compress@10': 0.0807, 'time@10': 5.6627}:  60%|██████    | 18/30 [01:15<00:40,  3.39s/it]    {'epoch': 11, 'num_users': 6.0, 'loss': 0.039, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8696, 'compress@10': 0.0807, 'time@10': 5.6627}:  63%|██████▎   | 19/30 [01:15<00:33,  3.03s/it]{'epoch': 11, 'num_users': 6.15, 'loss': 0.0392, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8686, 'compress@10': 0.0786, 'time@10': 5.8486}:  63%|██████▎   | 19/30 [01:25<00:33,  3.03s/it]{'epoch': 11, 'num_users': 6.15, 'loss': 0.0392, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8686, 'compress@10': 0.0786, 'time@10': 5.8486}:  67%|██████▋   | 20/30 [01:25<00:49,  4.95s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0409, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8661, 'compress@10': 0.0772, 'time@10': 5.9458}:  67%|██████▋   | 20/30 [01:29<00:49,  4.95s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0409, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8661, 'compress@10': 0.0772, 'time@10': 5.9458}:  70%|███████   | 21/30 [01:29<00:41,  4.66s/it]{'epoch': 11, 'num_users': 6.1818, 'loss': 0.0413, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8669, 'compress@10': 0.0766, 'time@10': 5.8332}:  70%|███████   | 21/30 [01:32<00:41,  4.66s/it]{'epoch': 11, 'num_users': 6.1818, 'loss': 0.0413, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8669, 'compress@10': 0.0766, 'time@10': 5.8332}:  73%|███████▎  | 22/30 [01:32<00:34,  4.31s/it]{'epoch': 11, 'num_users': 6.1304, 'loss': 0.0406, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8682, 'compress@10': 0.0761, 'time@10': 5.8516}:  73%|███████▎  | 22/30 [01:35<00:34,  4.31s/it]{'epoch': 11, 'num_users': 6.1304, 'loss': 0.0406, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8682, 'compress@10': 0.0761, 'time@10': 5.8516}:  77%|███████▋  | 23/30 [01:35<00:27,  3.97s/it]{'epoch': 11, 'num_users': 5.9583, 'loss': 0.04, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8615, 'compress@10': 0.0817, 'time@10': 5.6653}:  77%|███████▋  | 23/30 [01:37<00:27,  3.97s/it]   {'epoch': 11, 'num_users': 5.9583, 'loss': 0.04, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8615, 'compress@10': 0.0817, 'time@10': 5.6653}:  80%|████████  | 24/30 [01:37<00:19,  3.21s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0388, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8519, 'compress@10': 0.0922, 'time@10': 5.4932}:  80%|████████  | 24/30 [01:37<00:19,  3.21s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0388, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8519, 'compress@10': 0.0922, 'time@10': 5.4932}:  83%|████████▎ | 25/30 [01:37<00:12,  2.46s/it]{'epoch': 11, 'num_users': 5.8077, 'loss': 0.0394, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8511, 'compress@10': 0.0898, 'time@10': 5.5592}:  83%|████████▎ | 25/30 [01:45<00:12,  2.46s/it]{'epoch': 11, 'num_users': 5.8077, 'loss': 0.0394, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8511, 'compress@10': 0.0898, 'time@10': 5.5592}:  87%|████████▋ | 26/30 [01:45<00:15,  3.90s/it]{'epoch': 11, 'num_users': 5.8889, 'loss': 0.0392, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8533, 'compress@10': 0.0885, 'time@10': 5.6302}:  87%|████████▋ | 26/30 [01:48<00:15,  3.90s/it] {'epoch': 11, 'num_users': 5.8889, 'loss': 0.0392, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8533, 'compress@10': 0.0885, 'time@10': 5.6302}:  90%|█████████ | 27/30 [01:48<00:11,  3.86s/it]{'epoch': 11, 'num_users': 6.0, 'loss': 0.039, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8543, 'compress@10': 0.0875, 'time@10': 5.698}:  90%|█████████ | 27/30 [01:56<00:11,  3.86s/it]    {'epoch': 11, 'num_users': 6.0, 'loss': 0.039, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8543, 'compress@10': 0.0875, 'time@10': 5.698}:  93%|█████████▎| 28/30 [01:56<00:09,  4.97s/it]{'epoch': 11, 'num_users': 5.8621, 'loss': 0.0385, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.856, 'compress@10': 0.0865, 'time@10': 5.6841}:  93%|█████████▎| 28/30 [01:59<00:09,  4.97s/it]{'epoch': 11, 'num_users': 5.8621, 'loss': 0.0385, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.856, 'compress@10': 0.0865, 'time@10': 5.6841}:  97%|█████████▋| 29/30 [01:59<00:04,  4.29s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0385, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8574, 'compress@10': 0.0854, 'time@10': 5.7005}:  97%|█████████▋| 29/30 [02:05<00:04,  4.29s/it] {'epoch': 11, 'num_users': 5.8667, 'loss': 0.0385, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8574, 'compress@10': 0.0854, 'time@10': 5.7005}: 100%|██████████| 30/30 [02:05<00:00,  4.88s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0385, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8574, 'compress@10': 0.0854, 'time@10': 5.7005}: 100%|██████████| 30/30 [02:05<00:00,  4.18s/it]
Epoch: 11
Avg # of users: 5.866666666666666
Avg Loss: 0.03854658055761725
Avg hit ratio: 0.8399812135799293
Avg ndcg: 0.8573754631930165
Avg compression ratio: 0.08542849303022924
Avg train time: 5.700529543558757
Std train time: 2.3211641180401807
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 18, 10, 22, 8, 18, 22, 10, 10, 10, 6, 10, 10, 22, 22, 6, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0504, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.832, 'compress@10': 0.0644, 'time@10': 6.272}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0504, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.832, 'compress@10': 0.0644, 'time@10': 6.272}:   3%|▎         | 1/30 [00:03<01:32,  3.18s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8532, 'compress@10': 0.0586, 'time@10': 5.5375}:   3%|▎         | 1/30 [00:08<01:32,  3.18s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8532, 'compress@10': 0.0586, 'time@10': 5.5375}:   7%|▋         | 2/30 [00:08<01:56,  4.16s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8545, 'compress@10': 0.0915, 'time@10': 4.8142}:   7%|▋         | 2/30 [00:09<01:56,  4.16s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8545, 'compress@10': 0.0915, 'time@10': 4.8142}:  10%|█         | 3/30 [00:09<01:22,  3.05s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8552, 'compress@10': 0.0817, 'time@10': 4.7271}:  10%|█         | 3/30 [00:14<01:22,  3.05s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8552, 'compress@10': 0.0817, 'time@10': 4.7271}:  13%|█▎        | 4/30 [00:14<01:34,  3.62s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0452, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8385, 'compress@10': 0.0736, 'time@10': 5.3986}:  13%|█▎        | 4/30 [00:18<01:34,  3.62s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0452, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8385, 'compress@10': 0.0736, 'time@10': 5.3986}:  17%|█▋        | 5/30 [00:18<01:34,  3.79s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0461, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8404, 'compress@10': 0.0684, 'time@10': 5.7186}:  17%|█▋        | 5/30 [00:25<01:34,  3.79s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0461, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8404, 'compress@10': 0.0684, 'time@10': 5.7186}:  20%|██        | 6/30 [00:25<02:00,  5.00s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.045, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8418, 'compress@10': 0.0675, 'time@10': 6.0428}:  20%|██        | 6/30 [00:29<02:00,  5.00s/it] {'epoch': 12, 'num_users': 6.2857, 'loss': 0.045, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8418, 'compress@10': 0.0675, 'time@10': 6.0428}:  23%|██▎       | 7/30 [00:29<01:47,  4.69s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0451, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.859, 'compress@10': 0.0654, 'time@10': 6.0184}:  23%|██▎       | 7/30 [00:35<01:47,  4.69s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0451, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.859, 'compress@10': 0.0654, 'time@10': 6.0184}:  27%|██▋       | 8/30 [00:35<01:51,  5.07s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0444, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8673, 'compress@10': 0.0624, 'time@10': 6.3416}:  27%|██▋       | 8/30 [00:40<01:51,  5.07s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0444, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8673, 'compress@10': 0.0624, 'time@10': 6.3416}:  30%|███       | 9/30 [00:40<01:42,  4.89s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0435, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8687, 'compress@10': 0.0605, 'time@10': 6.4209}:  30%|███       | 9/30 [00:47<01:42,  4.89s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0435, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8687, 'compress@10': 0.0605, 'time@10': 6.4209}:  33%|███▎      | 10/30 [00:47<01:51,  5.60s/it]{'epoch': 12, 'num_users': 6.6364, 'loss': 0.0444, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8689, 'compress@10': 0.0603, 'time@10': 6.5867}:  33%|███▎      | 10/30 [00:51<01:51,  5.60s/it]{'epoch': 12, 'num_users': 6.6364, 'loss': 0.0444, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8689, 'compress@10': 0.0603, 'time@10': 6.5867}:  37%|███▋      | 11/30 [00:51<01:38,  5.16s/it]{'epoch': 12, 'num_users': 6.4167, 'loss': 0.0418, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8718, 'compress@10': 0.0637, 'time@10': 6.3012}:  37%|███▋      | 11/30 [00:54<01:38,  5.16s/it]{'epoch': 12, 'num_users': 6.4167, 'loss': 0.0418, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8718, 'compress@10': 0.0637, 'time@10': 6.3012}:  40%|████      | 12/30 [00:54<01:22,  4.56s/it]{'epoch': 12, 'num_users': 6.6154, 'loss': 0.0422, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8735, 'compress@10': 0.0639, 'time@10': 6.322}:  40%|████      | 12/30 [00:57<01:22,  4.56s/it] {'epoch': 12, 'num_users': 6.6154, 'loss': 0.0422, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8735, 'compress@10': 0.0639, 'time@10': 6.322}:  43%|████▎     | 13/30 [00:57<01:11,  4.19s/it]{'epoch': 12, 'num_users': 6.3571, 'loss': 0.0398, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.869, 'compress@10': 0.0724, 'time@10': 5.9865}:  43%|████▎     | 13/30 [00:59<01:11,  4.19s/it]{'epoch': 12, 'num_users': 6.3571, 'loss': 0.0398, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.869, 'compress@10': 0.0724, 'time@10': 5.9865}:  47%|████▋     | 14/30 [00:59<00:54,  3.43s/it]{'epoch': 12, 'num_users': 6.2667, 'loss': 0.0399, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8688, 'compress@10': 0.0703, 'time@10': 6.1027}:  47%|████▋     | 14/30 [01:03<00:54,  3.43s/it]{'epoch': 12, 'num_users': 6.2667, 'loss': 0.0399, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8688, 'compress@10': 0.0703, 'time@10': 6.1027}:  50%|█████     | 15/30 [01:03<00:53,  3.57s/it]{'epoch': 12, 'num_users': 6.0625, 'loss': 0.0382, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8694, 'compress@10': 0.0723, 'time@10': 5.923}:  50%|█████     | 15/30 [01:06<00:53,  3.57s/it] {'epoch': 12, 'num_users': 6.0625, 'loss': 0.0382, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8694, 'compress@10': 0.0723, 'time@10': 5.923}:  53%|█████▎    | 16/30 [01:06<00:48,  3.48s/it]{'epoch': 12, 'num_users': 5.8235, 'loss': 0.0364, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8629, 'compress@10': 0.0808, 'time@10': 5.7468}:  53%|█████▎    | 16/30 [01:08<00:48,  3.48s/it]{'epoch': 12, 'num_users': 5.8235, 'loss': 0.0364, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8629, 'compress@10': 0.0808, 'time@10': 5.7468}:  57%|█████▋    | 17/30 [01:08<00:37,  2.89s/it]{'epoch': 12, 'num_users': 6.0556, 'loss': 0.037, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8636, 'compress@10': 0.0798, 'time@10': 5.6758}:  57%|█████▋    | 17/30 [01:12<00:37,  2.89s/it] {'epoch': 12, 'num_users': 6.0556, 'loss': 0.037, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8636, 'compress@10': 0.0798, 'time@10': 5.6758}:  60%|██████    | 18/30 [01:12<00:40,  3.38s/it]{'epoch': 12, 'num_users': 6.0, 'loss': 0.0358, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8654, 'compress@10': 0.0804, 'time@10': 5.6031}:  60%|██████    | 18/30 [01:15<00:40,  3.38s/it]  {'epoch': 12, 'num_users': 6.0, 'loss': 0.0358, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8654, 'compress@10': 0.0804, 'time@10': 5.6031}:  63%|██████▎   | 19/30 [01:15<00:33,  3.02s/it]{'epoch': 12, 'num_users': 6.15, 'loss': 0.0361, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8657, 'compress@10': 0.0783, 'time@10': 5.7887}:  63%|██████▎   | 19/30 [01:24<00:33,  3.02s/it]{'epoch': 12, 'num_users': 6.15, 'loss': 0.0361, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8657, 'compress@10': 0.0783, 'time@10': 5.7887}:  67%|██████▋   | 20/30 [01:24<00:49,  4.93s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0375, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8634, 'compress@10': 0.0769, 'time@10': 5.8784}:  67%|██████▋   | 20/30 [01:28<00:49,  4.93s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0375, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8634, 'compress@10': 0.0769, 'time@10': 5.8784}:  70%|███████   | 21/30 [01:28<00:41,  4.61s/it]{'epoch': 12, 'num_users': 6.1818, 'loss': 0.0382, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8647, 'compress@10': 0.0763, 'time@10': 5.7686}:  70%|███████   | 21/30 [01:31<00:41,  4.61s/it]{'epoch': 12, 'num_users': 6.1818, 'loss': 0.0382, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8647, 'compress@10': 0.0763, 'time@10': 5.7686}:  73%|███████▎  | 22/30 [01:31<00:34,  4.28s/it]{'epoch': 12, 'num_users': 6.1304, 'loss': 0.0376, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8661, 'compress@10': 0.0759, 'time@10': 5.7908}:  73%|███████▎  | 22/30 [01:34<00:34,  4.28s/it]{'epoch': 12, 'num_users': 6.1304, 'loss': 0.0376, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8661, 'compress@10': 0.0759, 'time@10': 5.7908}:  77%|███████▋  | 23/30 [01:34<00:27,  3.95s/it]{'epoch': 12, 'num_users': 5.9583, 'loss': 0.0371, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8594, 'compress@10': 0.0815, 'time@10': 5.61}:  77%|███████▋  | 23/30 [01:36<00:27,  3.95s/it]   {'epoch': 12, 'num_users': 5.9583, 'loss': 0.0371, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8594, 'compress@10': 0.0815, 'time@10': 5.61}:  80%|████████  | 24/30 [01:36<00:19,  3.21s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0359, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8499, 'compress@10': 0.092, 'time@10': 5.4434}:  80%|████████  | 24/30 [01:37<00:19,  3.21s/it] {'epoch': 12, 'num_users': 5.8, 'loss': 0.0359, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8499, 'compress@10': 0.092, 'time@10': 5.4434}:  83%|████████▎ | 25/30 [01:37<00:12,  2.48s/it]{'epoch': 12, 'num_users': 5.8077, 'loss': 0.0366, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8495, 'compress@10': 0.0895, 'time@10': 5.5173}:  83%|████████▎ | 25/30 [01:44<00:12,  2.48s/it]{'epoch': 12, 'num_users': 5.8077, 'loss': 0.0366, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8495, 'compress@10': 0.0895, 'time@10': 5.5173}:  87%|████████▋ | 26/30 [01:44<00:15,  3.96s/it]{'epoch': 12, 'num_users': 5.8889, 'loss': 0.0365, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8517, 'compress@10': 0.0882, 'time@10': 5.5752}:  87%|████████▋ | 26/30 [01:48<00:15,  3.96s/it]{'epoch': 12, 'num_users': 5.8889, 'loss': 0.0365, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8517, 'compress@10': 0.0882, 'time@10': 5.5752}:  90%|█████████ | 27/30 [01:48<00:11,  3.84s/it]{'epoch': 12, 'num_users': 6.0, 'loss': 0.0369, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8528, 'compress@10': 0.087, 'time@10': 5.6539}:  90%|█████████ | 27/30 [01:56<00:11,  3.84s/it]    {'epoch': 12, 'num_users': 6.0, 'loss': 0.0369, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8528, 'compress@10': 0.087, 'time@10': 5.6539}:  93%|█████████▎| 28/30 [01:56<00:10,  5.03s/it]{'epoch': 12, 'num_users': 5.8621, 'loss': 0.0364, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8548, 'compress@10': 0.086, 'time@10': 5.6776}:  93%|█████████▎| 28/30 [01:59<00:10,  5.03s/it]{'epoch': 12, 'num_users': 5.8621, 'loss': 0.0364, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8548, 'compress@10': 0.086, 'time@10': 5.6776}:  97%|█████████▋| 29/30 [01:59<00:04,  4.49s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0365, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8566, 'compress@10': 0.085, 'time@10': 5.6474}:  97%|█████████▋| 29/30 [02:04<00:04,  4.49s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0365, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8566, 'compress@10': 0.085, 'time@10': 5.6474}: 100%|██████████| 30/30 [02:04<00:00,  4.58s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0365, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8566, 'compress@10': 0.085, 'time@10': 5.6474}: 100%|██████████| 30/30 [02:04<00:00,  4.14s/it]
Epoch: 12
Avg # of users: 5.866666666666666
Avg Loss: 0.036503362798253634
Avg hit ratio: 0.8439942843298421
Avg ndcg: 0.8566420974105254
Avg compression ratio: 0.08497242128077827
Avg train time: 5.647409343719483
Std train time: 2.2694181925607224
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 19, 10, 23, 8, 18, 23, 10, 10, 10, 6, 10, 10, 23, 23, 6, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8566, 'compress@10': 0.065, 'time@10': 6.4519}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8566, 'compress@10': 0.065, 'time@10': 6.4519}:   3%|▎         | 1/30 [00:03<01:34,  3.27s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8696, 'compress@10': 0.0587, 'time@10': 5.7223}:   3%|▎         | 1/30 [00:08<01:34,  3.27s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8696, 'compress@10': 0.0587, 'time@10': 5.7223}:   7%|▋         | 2/30 [00:08<02:00,  4.31s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8655, 'compress@10': 0.0917, 'time@10': 4.9478}:   7%|▋         | 2/30 [00:10<02:00,  4.31s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8655, 'compress@10': 0.0917, 'time@10': 4.9478}:  10%|█         | 3/30 [00:10<01:24,  3.13s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8554, 'compress@10': 0.0819, 'time@10': 4.8272}:  10%|█         | 3/30 [00:14<01:24,  3.13s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8554, 'compress@10': 0.0819, 'time@10': 4.8272}:  13%|█▎        | 4/30 [00:14<01:35,  3.68s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0435, 'hit_ratio@10': 0.8071, 'ndcg@10': 0.8398, 'compress@10': 0.0738, 'time@10': 5.499}:  13%|█▎        | 4/30 [00:18<01:35,  3.68s/it] {'epoch': 13, 'num_users': 5.8, 'loss': 0.0435, 'hit_ratio@10': 0.8071, 'ndcg@10': 0.8398, 'compress@10': 0.0738, 'time@10': 5.499}:  17%|█▋        | 5/30 [00:18<01:36,  3.84s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0442, 'hit_ratio@10': 0.8244, 'ndcg@10': 0.8423, 'compress@10': 0.0684, 'time@10': 5.8049}:  17%|█▋        | 5/30 [00:26<01:36,  3.84s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0442, 'hit_ratio@10': 0.8244, 'ndcg@10': 0.8423, 'compress@10': 0.0684, 'time@10': 5.8049}:  20%|██        | 6/30 [00:26<02:01,  5.04s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0442, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8491, 'compress@10': 0.0675, 'time@10': 6.1184}:  20%|██        | 6/30 [00:30<02:01,  5.04s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0442, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8491, 'compress@10': 0.0675, 'time@10': 6.1184}:  23%|██▎       | 7/30 [00:30<01:48,  4.71s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0439, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8631, 'compress@10': 0.0654, 'time@10': 6.0541}:  23%|██▎       | 7/30 [00:35<01:48,  4.71s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0439, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8631, 'compress@10': 0.0654, 'time@10': 6.0541}:  27%|██▋       | 8/30 [00:35<01:50,  5.01s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0435, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8704, 'compress@10': 0.0624, 'time@10': 6.3786}:  27%|██▋       | 8/30 [00:40<01:50,  5.01s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0435, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8704, 'compress@10': 0.0624, 'time@10': 6.3786}:  30%|███       | 9/30 [00:40<01:42,  4.86s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0427, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8731, 'compress@10': 0.0603, 'time@10': 6.4532}:  30%|███       | 9/30 [00:47<01:42,  4.86s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0427, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8731, 'compress@10': 0.0603, 'time@10': 6.4532}:  33%|███▎      | 10/30 [00:47<01:51,  5.57s/it]{'epoch': 13, 'num_users': 6.6364, 'loss': 0.0434, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8733, 'compress@10': 0.0602, 'time@10': 6.6219}:  33%|███▎      | 10/30 [00:51<01:51,  5.57s/it]{'epoch': 13, 'num_users': 6.6364, 'loss': 0.0434, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8733, 'compress@10': 0.0602, 'time@10': 6.6219}:  37%|███▋      | 11/30 [00:51<01:37,  5.15s/it]{'epoch': 13, 'num_users': 6.4167, 'loss': 0.0408, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8759, 'compress@10': 0.0637, 'time@10': 6.3561}:  37%|███▋      | 11/30 [00:55<01:37,  5.15s/it]{'epoch': 13, 'num_users': 6.4167, 'loss': 0.0408, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8759, 'compress@10': 0.0637, 'time@10': 6.3561}:  40%|████      | 12/30 [00:55<01:23,  4.64s/it]{'epoch': 13, 'num_users': 6.6154, 'loss': 0.0412, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.8771, 'compress@10': 0.0639, 'time@10': 6.4088}:  40%|████      | 12/30 [00:58<01:23,  4.64s/it]{'epoch': 13, 'num_users': 6.6154, 'loss': 0.0412, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.8771, 'compress@10': 0.0639, 'time@10': 6.4088}:  43%|████▎     | 13/30 [00:58<01:13,  4.31s/it]{'epoch': 13, 'num_users': 6.3571, 'loss': 0.0388, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.8723, 'compress@10': 0.0725, 'time@10': 6.0985}:  43%|████▎     | 13/30 [01:00<01:13,  4.31s/it]{'epoch': 13, 'num_users': 6.3571, 'loss': 0.0388, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.8723, 'compress@10': 0.0725, 'time@10': 6.0985}:  47%|████▋     | 14/30 [01:00<00:58,  3.65s/it]{'epoch': 13, 'num_users': 6.2667, 'loss': 0.039, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8723, 'compress@10': 0.0704, 'time@10': 6.2526}:  47%|████▋     | 14/30 [01:05<00:58,  3.65s/it] {'epoch': 13, 'num_users': 6.2667, 'loss': 0.039, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8723, 'compress@10': 0.0704, 'time@10': 6.2526}:  50%|█████     | 15/30 [01:05<00:57,  3.83s/it]{'epoch': 13, 'num_users': 6.0625, 'loss': 0.0373, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8726, 'compress@10': 0.0724, 'time@10': 6.0675}:  50%|█████     | 15/30 [01:08<00:57,  3.83s/it]{'epoch': 13, 'num_users': 6.0625, 'loss': 0.0373, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8726, 'compress@10': 0.0724, 'time@10': 6.0675}:  53%|█████▎    | 16/30 [01:08<00:51,  3.68s/it]{'epoch': 13, 'num_users': 5.8235, 'loss': 0.0355, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.866, 'compress@10': 0.0808, 'time@10': 5.8822}:  53%|█████▎    | 16/30 [01:09<00:51,  3.68s/it] {'epoch': 13, 'num_users': 5.8235, 'loss': 0.0355, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.866, 'compress@10': 0.0808, 'time@10': 5.8822}:  57%|█████▋    | 17/30 [01:09<00:39,  3.02s/it]{'epoch': 13, 'num_users': 6.0556, 'loss': 0.036, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.867, 'compress@10': 0.0798, 'time@10': 5.8017}:  57%|█████▋    | 17/30 [01:14<00:39,  3.02s/it] {'epoch': 13, 'num_users': 6.0556, 'loss': 0.036, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.867, 'compress@10': 0.0798, 'time@10': 5.8017}:  60%|██████    | 18/30 [01:14<00:41,  3.46s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 0.0351, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8684, 'compress@10': 0.0804, 'time@10': 5.7216}:  60%|██████    | 18/30 [01:16<00:41,  3.46s/it] {'epoch': 13, 'num_users': 6.0, 'loss': 0.0351, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8684, 'compress@10': 0.0804, 'time@10': 5.7216}:  63%|██████▎   | 19/30 [01:16<00:33,  3.08s/it]{'epoch': 13, 'num_users': 6.15, 'loss': 0.0353, 'hit_ratio@10': 0.83, 'ndcg@10': 0.8687, 'compress@10': 0.0783, 'time@10': 5.9079}:  63%|██████▎   | 19/30 [01:25<00:33,  3.08s/it] {'epoch': 13, 'num_users': 6.15, 'loss': 0.0353, 'hit_ratio@10': 0.83, 'ndcg@10': 0.8687, 'compress@10': 0.0783, 'time@10': 5.9079}:  67%|██████▋   | 20/30 [01:25<00:50,  5.00s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0368, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8666, 'compress@10': 0.0769, 'time@10': 5.9967}:  67%|██████▋   | 20/30 [01:29<00:50,  5.00s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0368, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8666, 'compress@10': 0.0769, 'time@10': 5.9967}:  70%|███████   | 21/30 [01:29<00:42,  4.68s/it]{'epoch': 13, 'num_users': 6.1818, 'loss': 0.0373, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.868, 'compress@10': 0.0764, 'time@10': 5.8819}:  70%|███████   | 21/30 [01:33<00:42,  4.68s/it] {'epoch': 13, 'num_users': 6.1818, 'loss': 0.0373, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.868, 'compress@10': 0.0764, 'time@10': 5.8819}:  73%|███████▎  | 22/30 [01:33<00:34,  4.33s/it]{'epoch': 13, 'num_users': 6.1304, 'loss': 0.0368, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8694, 'compress@10': 0.076, 'time@10': 5.899}:  73%|███████▎  | 22/30 [01:36<00:34,  4.33s/it] {'epoch': 13, 'num_users': 6.1304, 'loss': 0.0368, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8694, 'compress@10': 0.076, 'time@10': 5.899}:  77%|███████▋  | 23/30 [01:36<00:27,  3.98s/it]{'epoch': 13, 'num_users': 5.9583, 'loss': 0.0362, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8632, 'compress@10': 0.0816, 'time@10': 5.7169}:  77%|███████▋  | 23/30 [01:38<00:27,  3.98s/it]{'epoch': 13, 'num_users': 5.9583, 'loss': 0.0362, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8632, 'compress@10': 0.0816, 'time@10': 5.7169}:  80%|████████  | 24/30 [01:38<00:19,  3.26s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.035, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8536, 'compress@10': 0.092, 'time@10': 5.5483}:  80%|████████  | 24/30 [01:38<00:19,  3.26s/it]      {'epoch': 13, 'num_users': 5.8, 'loss': 0.035, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8536, 'compress@10': 0.092, 'time@10': 5.5483}:  83%|████████▎ | 25/30 [01:38<00:12,  2.52s/it]{'epoch': 13, 'num_users': 5.8077, 'loss': 0.0356, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.853, 'compress@10': 0.0896, 'time@10': 5.6201}:  83%|████████▎ | 25/30 [01:46<00:12,  2.52s/it]{'epoch': 13, 'num_users': 5.8077, 'loss': 0.0356, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.853, 'compress@10': 0.0896, 'time@10': 5.6201}:  87%|████████▋ | 26/30 [01:46<00:15,  4.00s/it]{'epoch': 13, 'num_users': 5.8889, 'loss': 0.0358, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8551, 'compress@10': 0.0883, 'time@10': 5.712}:  87%|████████▋ | 26/30 [01:50<00:15,  4.00s/it]{'epoch': 13, 'num_users': 5.8889, 'loss': 0.0358, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8551, 'compress@10': 0.0883, 'time@10': 5.712}:  90%|█████████ | 27/30 [01:50<00:12,  4.03s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 0.0361, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.856, 'compress@10': 0.0871, 'time@10': 5.8141}:  90%|█████████ | 27/30 [01:59<00:12,  4.03s/it]   {'epoch': 13, 'num_users': 6.0, 'loss': 0.0361, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.856, 'compress@10': 0.0871, 'time@10': 5.8141}:  93%|█████████▎| 28/30 [01:59<00:10,  5.41s/it]{'epoch': 13, 'num_users': 5.8621, 'loss': 0.0357, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8579, 'compress@10': 0.0861, 'time@10': 5.8222}:  93%|█████████▎| 28/30 [02:02<00:10,  5.41s/it]{'epoch': 13, 'num_users': 5.8621, 'loss': 0.0357, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8579, 'compress@10': 0.0861, 'time@10': 5.8222}:  97%|█████████▋| 29/30 [02:02<00:04,  4.71s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0358, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8596, 'compress@10': 0.085, 'time@10': 5.8135}:  97%|█████████▋| 29/30 [02:07<00:04,  4.71s/it] {'epoch': 13, 'num_users': 5.8667, 'loss': 0.0358, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8596, 'compress@10': 0.085, 'time@10': 5.8135}: 100%|██████████| 30/30 [02:07<00:00,  4.98s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0358, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8596, 'compress@10': 0.085, 'time@10': 5.8135}: 100%|██████████| 30/30 [02:07<00:00,  4.26s/it]
Epoch: 13
Avg # of users: 5.866666666666666
Avg Loss: 0.035754466870057816
Avg hit ratio: 0.8398238958962957
Avg ndcg: 0.8595992589093143
Avg compression ratio: 0.08502603401877082
Avg train time: 5.813486607869466
Std train time: 2.321071915222264
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 19, 10, 24, 8, 18, 24, 10, 10, 10, 6, 10, 10, 24, 24, 6, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8675, 'compress@10': 0.065, 'time@10': 6.0216}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8675, 'compress@10': 0.065, 'time@10': 6.0216}:   3%|▎         | 1/30 [00:03<01:28,  3.07s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8753, 'compress@10': 0.0586, 'time@10': 5.4442}:   3%|▎         | 1/30 [00:07<01:28,  3.07s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8753, 'compress@10': 0.0586, 'time@10': 5.4442}:   7%|▋         | 2/30 [00:07<01:56,  4.15s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8692, 'compress@10': 0.0918, 'time@10': 4.7658}:   7%|▋         | 2/30 [00:09<01:56,  4.15s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8692, 'compress@10': 0.0918, 'time@10': 4.7658}:  10%|█         | 3/30 [00:09<01:22,  3.05s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8611, 'compress@10': 0.0821, 'time@10': 4.6882}:  10%|█         | 3/30 [00:14<01:22,  3.05s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8611, 'compress@10': 0.0821, 'time@10': 4.6882}:  13%|█▎        | 4/30 [00:14<01:34,  3.62s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0413, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8438, 'compress@10': 0.0738, 'time@10': 5.3937}:  13%|█▎        | 4/30 [00:18<01:34,  3.62s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0413, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8438, 'compress@10': 0.0738, 'time@10': 5.3937}:  17%|█▋        | 5/30 [00:18<01:35,  3.81s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0423, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8458, 'compress@10': 0.0684, 'time@10': 5.7207}:  17%|█▋        | 5/30 [00:25<01:35,  3.81s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0423, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8458, 'compress@10': 0.0684, 'time@10': 5.7207}:  20%|██        | 6/30 [00:25<02:00,  5.03s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0415, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.845, 'compress@10': 0.0675, 'time@10': 6.0421}:  20%|██        | 6/30 [00:29<02:00,  5.03s/it] {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0415, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.845, 'compress@10': 0.0675, 'time@10': 6.0421}:  23%|██▎       | 7/30 [00:29<01:48,  4.70s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0413, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8584, 'compress@10': 0.0654, 'time@10': 5.9825}:  23%|██▎       | 7/30 [00:35<01:48,  4.70s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0413, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8584, 'compress@10': 0.0654, 'time@10': 5.9825}:  27%|██▋       | 8/30 [00:35<01:49,  4.99s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.041, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8662, 'compress@10': 0.0625, 'time@10': 6.3049}:  27%|██▋       | 8/30 [00:39<01:49,  4.99s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.041, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8662, 'compress@10': 0.0625, 'time@10': 6.3049}:  30%|███       | 9/30 [00:39<01:41,  4.83s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0397, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.8686, 'compress@10': 0.0604, 'time@10': 6.3861}:  30%|███       | 9/30 [00:47<01:41,  4.83s/it]  {'epoch': 14, 'num_users': 6.3, 'loss': 0.0397, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.8686, 'compress@10': 0.0604, 'time@10': 6.3861}:  33%|███▎      | 10/30 [00:47<01:50,  5.55s/it]{'epoch': 14, 'num_users': 6.6364, 'loss': 0.0406, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8693, 'compress@10': 0.0604, 'time@10': 6.5608}:  33%|███▎      | 10/30 [00:51<01:50,  5.55s/it]{'epoch': 14, 'num_users': 6.6364, 'loss': 0.0406, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8693, 'compress@10': 0.0604, 'time@10': 6.5608}:  37%|███▋      | 11/30 [00:51<01:37,  5.13s/it]{'epoch': 14, 'num_users': 6.4167, 'loss': 0.0382, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8722, 'compress@10': 0.0638, 'time@10': 6.3017}:  37%|███▋      | 11/30 [00:54<01:37,  5.13s/it]{'epoch': 14, 'num_users': 6.4167, 'loss': 0.0382, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8722, 'compress@10': 0.0638, 'time@10': 6.3017}:  40%|████      | 12/30 [00:54<01:23,  4.64s/it]{'epoch': 14, 'num_users': 6.6154, 'loss': 0.0386, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8737, 'compress@10': 0.064, 'time@10': 6.359}:  40%|████      | 12/30 [00:58<01:23,  4.64s/it]  {'epoch': 14, 'num_users': 6.6154, 'loss': 0.0386, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8737, 'compress@10': 0.064, 'time@10': 6.359}:  43%|████▎     | 13/30 [00:58<01:13,  4.31s/it]{'epoch': 14, 'num_users': 6.3571, 'loss': 0.0363, 'hit_ratio@10': 0.851, 'ndcg@10': 0.87, 'compress@10': 0.0726, 'time@10': 6.0457}:  43%|████▎     | 13/30 [01:00<01:13,  4.31s/it] {'epoch': 14, 'num_users': 6.3571, 'loss': 0.0363, 'hit_ratio@10': 0.851, 'ndcg@10': 0.87, 'compress@10': 0.0726, 'time@10': 6.0457}:  47%|████▋     | 14/30 [01:00<00:57,  3.62s/it]{'epoch': 14, 'num_users': 6.2667, 'loss': 0.0366, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8702, 'compress@10': 0.0705, 'time@10': 6.1677}:  47%|████▋     | 14/30 [01:04<00:57,  3.62s/it]{'epoch': 14, 'num_users': 6.2667, 'loss': 0.0366, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8702, 'compress@10': 0.0705, 'time@10': 6.1677}:  50%|█████     | 15/30 [01:04<00:55,  3.73s/it]{'epoch': 14, 'num_users': 6.0625, 'loss': 0.035, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8707, 'compress@10': 0.0725, 'time@10': 5.9855}:  50%|█████     | 15/30 [01:07<00:55,  3.73s/it] {'epoch': 14, 'num_users': 6.0625, 'loss': 0.035, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8707, 'compress@10': 0.0725, 'time@10': 5.9855}:  53%|█████▎    | 16/30 [01:07<00:50,  3.60s/it]{'epoch': 14, 'num_users': 5.8235, 'loss': 0.0333, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8642, 'compress@10': 0.081, 'time@10': 5.8197}:  53%|█████▎    | 16/30 [01:09<00:50,  3.60s/it] {'epoch': 14, 'num_users': 5.8235, 'loss': 0.0333, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8642, 'compress@10': 0.081, 'time@10': 5.8197}:  57%|█████▋    | 17/30 [01:09<00:39,  3.00s/it]{'epoch': 14, 'num_users': 6.0556, 'loss': 0.0338, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8653, 'compress@10': 0.0799, 'time@10': 5.7497}:  57%|█████▋    | 17/30 [01:13<00:39,  3.00s/it]{'epoch': 14, 'num_users': 6.0556, 'loss': 0.0338, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8653, 'compress@10': 0.0799, 'time@10': 5.7497}:  60%|██████    | 18/30 [01:13<00:41,  3.48s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 0.0328, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8671, 'compress@10': 0.0805, 'time@10': 5.6722}:  60%|██████    | 18/30 [01:15<00:41,  3.48s/it]   {'epoch': 14, 'num_users': 6.0, 'loss': 0.0328, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8671, 'compress@10': 0.0805, 'time@10': 5.6722}:  63%|██████▎   | 19/30 [01:15<00:34,  3.09s/it]{'epoch': 14, 'num_users': 6.15, 'loss': 0.033, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8676, 'compress@10': 0.0783, 'time@10': 5.8595}:  63%|██████▎   | 19/30 [01:25<00:34,  3.09s/it]{'epoch': 14, 'num_users': 6.15, 'loss': 0.033, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8676, 'compress@10': 0.0783, 'time@10': 5.8595}:  67%|██████▋   | 20/30 [01:25<00:50,  5.00s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0349, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8653, 'compress@10': 0.0769, 'time@10': 5.9509}:  67%|██████▋   | 20/30 [01:29<00:50,  5.00s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0349, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8653, 'compress@10': 0.0769, 'time@10': 5.9509}:  70%|███████   | 21/30 [01:29<00:42,  4.68s/it]{'epoch': 14, 'num_users': 6.1818, 'loss': 0.0354, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8668, 'compress@10': 0.0764, 'time@10': 5.8368}:  70%|███████   | 21/30 [01:32<00:42,  4.68s/it]{'epoch': 14, 'num_users': 6.1818, 'loss': 0.0354, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8668, 'compress@10': 0.0764, 'time@10': 5.8368}:  73%|███████▎  | 22/30 [01:32<00:34,  4.32s/it]{'epoch': 14, 'num_users': 6.1304, 'loss': 0.0348, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8683, 'compress@10': 0.0759, 'time@10': 5.8552}:  73%|███████▎  | 22/30 [01:36<00:34,  4.32s/it]{'epoch': 14, 'num_users': 6.1304, 'loss': 0.0348, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8683, 'compress@10': 0.0759, 'time@10': 5.8552}:  77%|███████▋  | 23/30 [01:36<00:27,  3.98s/it]{'epoch': 14, 'num_users': 5.9583, 'loss': 0.0342, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8621, 'compress@10': 0.0816, 'time@10': 5.6759}:  77%|███████▋  | 23/30 [01:37<00:27,  3.98s/it]{'epoch': 14, 'num_users': 5.9583, 'loss': 0.0342, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8621, 'compress@10': 0.0816, 'time@10': 5.6759}:  80%|████████  | 24/30 [01:37<00:19,  3.26s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0331, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8525, 'compress@10': 0.092, 'time@10': 5.5049}:  80%|████████  | 24/30 [01:38<00:19,  3.26s/it]     {'epoch': 14, 'num_users': 5.8, 'loss': 0.0331, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8525, 'compress@10': 0.092, 'time@10': 5.5049}:  83%|████████▎ | 25/30 [01:38<00:12,  2.50s/it]{'epoch': 14, 'num_users': 5.8077, 'loss': 0.0337, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8522, 'compress@10': 0.0896, 'time@10': 5.5852}:  83%|████████▎ | 25/30 [01:45<00:12,  2.50s/it]{'epoch': 14, 'num_users': 5.8077, 'loss': 0.0337, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8522, 'compress@10': 0.0896, 'time@10': 5.5852}:  87%|████████▋ | 26/30 [01:45<00:16,  4.04s/it]{'epoch': 14, 'num_users': 5.8889, 'loss': 0.0342, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.8566, 'compress@10': 0.0882, 'time@10': 5.6556}:  87%|████████▋ | 26/30 [01:49<00:16,  4.04s/it]{'epoch': 14, 'num_users': 5.8889, 'loss': 0.0342, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.8566, 'compress@10': 0.0882, 'time@10': 5.6556}:  90%|█████████ | 27/30 [01:49<00:11,  3.96s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 0.0342, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8576, 'compress@10': 0.0871, 'time@10': 5.7361}:  90%|█████████ | 27/30 [01:57<00:11,  3.96s/it]   {'epoch': 14, 'num_users': 6.0, 'loss': 0.0342, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8576, 'compress@10': 0.0871, 'time@10': 5.7361}:  93%|█████████▎| 28/30 [01:57<00:10,  5.16s/it]{'epoch': 14, 'num_users': 5.8621, 'loss': 0.0338, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8594, 'compress@10': 0.0861, 'time@10': 5.7531}:  93%|█████████▎| 28/30 [02:00<00:10,  5.16s/it]{'epoch': 14, 'num_users': 5.8621, 'loss': 0.0338, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8594, 'compress@10': 0.0861, 'time@10': 5.7531}:  97%|█████████▋| 29/30 [02:00<00:04,  4.56s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.0339, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8609, 'compress@10': 0.085, 'time@10': 5.7522}:  97%|█████████▋| 29/30 [02:06<00:04,  4.56s/it] {'epoch': 14, 'num_users': 5.8667, 'loss': 0.0339, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8609, 'compress@10': 0.085, 'time@10': 5.7522}: 100%|██████████| 30/30 [02:06<00:00,  4.92s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.0339, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8609, 'compress@10': 0.085, 'time@10': 5.7522}: 100%|██████████| 30/30 [02:06<00:00,  4.22s/it]
Epoch: 14
Avg # of users: 5.866666666666666
Avg Loss: 0.03394033552460142
Avg hit ratio: 0.8439561710285709
Avg ndcg: 0.8609187032979181
Avg compression ratio: 0.08503194406833225
Avg train time: 5.752220678329468
Std train time: 2.2591509225430917
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 19, 10, 25, 8, 18, 25, 10, 10, 10, 6, 10, 10, 25, 25, 6, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.055, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8397, 'compress@10': 0.0649, 'time@10': 5.5342}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.055, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8397, 'compress@10': 0.0649, 'time@10': 5.5342}:   3%|▎         | 1/30 [00:02<01:21,  2.81s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0448, 'hit_ratio@10': 0.7878, 'ndcg@10': 0.8623, 'compress@10': 0.0589, 'time@10': 5.2688}:   3%|▎         | 1/30 [00:07<01:21,  2.81s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0448, 'hit_ratio@10': 0.7878, 'ndcg@10': 0.8623, 'compress@10': 0.0589, 'time@10': 5.2688}:   7%|▋         | 2/30 [00:07<01:55,  4.12s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.7633, 'ndcg@10': 0.8606, 'compress@10': 0.092, 'time@10': 4.6368}:   7%|▋         | 2/30 [00:09<01:55,  4.12s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.7633, 'ndcg@10': 0.8606, 'compress@10': 0.092, 'time@10': 4.6368}:  10%|█         | 3/30 [00:09<01:21,  3.03s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8605, 'compress@10': 0.0822, 'time@10': 4.5893}:  10%|█         | 3/30 [00:14<01:21,  3.03s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8605, 'compress@10': 0.0822, 'time@10': 4.5893}:  13%|█▎        | 4/30 [00:14<01:33,  3.60s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0417, 'hit_ratio@10': 0.8228, 'ndcg@10': 0.8445, 'compress@10': 0.0738, 'time@10': 5.2942}:  13%|█▎        | 4/30 [00:18<01:33,  3.60s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0417, 'hit_ratio@10': 0.8228, 'ndcg@10': 0.8445, 'compress@10': 0.0738, 'time@10': 5.2942}:  17%|█▋        | 5/30 [00:18<01:34,  3.78s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0426, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8466, 'compress@10': 0.0681, 'time@10': 5.6261}:  17%|█▋        | 5/30 [00:25<01:34,  3.78s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0426, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8466, 'compress@10': 0.0681, 'time@10': 5.6261}:  20%|██        | 6/30 [00:25<01:59,  4.99s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0415, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8549, 'compress@10': 0.0673, 'time@10': 5.9563}:  20%|██        | 6/30 [00:29<01:59,  4.99s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0415, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8549, 'compress@10': 0.0673, 'time@10': 5.9563}:  23%|██▎       | 7/30 [00:29<01:47,  4.67s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.041, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8659, 'compress@10': 0.0652, 'time@10': 5.914}:  23%|██▎       | 7/30 [00:35<01:47,  4.67s/it]  {'epoch': 15, 'num_users': 6.125, 'loss': 0.041, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8659, 'compress@10': 0.0652, 'time@10': 5.914}:  27%|██▋       | 8/30 [00:35<01:49,  4.98s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0409, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.873, 'compress@10': 0.0623, 'time@10': 6.2596}:  27%|██▋       | 8/30 [00:39<01:49,  4.98s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0409, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.873, 'compress@10': 0.0623, 'time@10': 6.2596}:  30%|███       | 9/30 [00:39<01:41,  4.85s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0409, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8764, 'compress@10': 0.0603, 'time@10': 6.3799}:  30%|███       | 9/30 [00:47<01:41,  4.85s/it]  {'epoch': 15, 'num_users': 6.3, 'loss': 0.0409, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8764, 'compress@10': 0.0603, 'time@10': 6.3799}:  33%|███▎      | 10/30 [00:47<01:53,  5.67s/it]{'epoch': 15, 'num_users': 6.6364, 'loss': 0.0427, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8774, 'compress@10': 0.0604, 'time@10': 6.5602}:  33%|███▎      | 10/30 [00:51<01:53,  5.67s/it]{'epoch': 15, 'num_users': 6.6364, 'loss': 0.0427, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8774, 'compress@10': 0.0604, 'time@10': 6.5602}:  37%|███▋      | 11/30 [00:51<01:39,  5.22s/it]{'epoch': 15, 'num_users': 6.4167, 'loss': 0.0401, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8796, 'compress@10': 0.0639, 'time@10': 6.3008}:  37%|███▋      | 11/30 [00:54<01:39,  5.22s/it]{'epoch': 15, 'num_users': 6.4167, 'loss': 0.0401, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8796, 'compress@10': 0.0639, 'time@10': 6.3008}:  40%|████      | 12/30 [00:54<01:24,  4.70s/it]{'epoch': 15, 'num_users': 6.6154, 'loss': 0.0402, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8805, 'compress@10': 0.0641, 'time@10': 6.3546}:  40%|████      | 12/30 [00:58<01:24,  4.70s/it]{'epoch': 15, 'num_users': 6.6154, 'loss': 0.0402, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8805, 'compress@10': 0.0641, 'time@10': 6.3546}:  43%|████▎     | 13/30 [00:58<01:13,  4.35s/it]{'epoch': 15, 'num_users': 6.3571, 'loss': 0.0378, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8757, 'compress@10': 0.0726, 'time@10': 6.0464}:  43%|████▎     | 13/30 [01:00<01:13,  4.35s/it]{'epoch': 15, 'num_users': 6.3571, 'loss': 0.0378, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8757, 'compress@10': 0.0726, 'time@10': 6.0464}:  47%|████▋     | 14/30 [01:00<00:58,  3.66s/it]{'epoch': 15, 'num_users': 6.2667, 'loss': 0.038, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8756, 'compress@10': 0.0705, 'time@10': 6.1717}:  47%|████▋     | 14/30 [01:04<00:58,  3.66s/it] {'epoch': 15, 'num_users': 6.2667, 'loss': 0.038, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8756, 'compress@10': 0.0705, 'time@10': 6.1717}:  50%|█████     | 15/30 [01:04<00:56,  3.76s/it]{'epoch': 15, 'num_users': 6.0625, 'loss': 0.0364, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8767, 'compress@10': 0.0726, 'time@10': 5.9886}:  50%|█████     | 15/30 [01:07<00:56,  3.76s/it]{'epoch': 15, 'num_users': 6.0625, 'loss': 0.0364, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8767, 'compress@10': 0.0726, 'time@10': 5.9886}:  53%|█████▎    | 16/30 [01:07<00:50,  3.62s/it]{'epoch': 15, 'num_users': 5.8235, 'loss': 0.0346, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8698, 'compress@10': 0.081, 'time@10': 5.8249}:  53%|█████▎    | 16/30 [01:09<00:50,  3.62s/it] {'epoch': 15, 'num_users': 5.8235, 'loss': 0.0346, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8698, 'compress@10': 0.081, 'time@10': 5.8249}:  57%|█████▋    | 17/30 [01:09<00:39,  3.03s/it]{'epoch': 15, 'num_users': 6.0556, 'loss': 0.0349, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8708, 'compress@10': 0.0799, 'time@10': 5.7388}:  57%|█████▋    | 17/30 [01:13<00:39,  3.03s/it]{'epoch': 15, 'num_users': 6.0556, 'loss': 0.0349, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8708, 'compress@10': 0.0799, 'time@10': 5.7388}:  60%|██████    | 18/30 [01:13<00:40,  3.41s/it]{'epoch': 15, 'num_users': 6.0, 'loss': 0.0339, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8723, 'compress@10': 0.0805, 'time@10': 5.6385}:  60%|██████    | 18/30 [01:15<00:40,  3.41s/it]  {'epoch': 15, 'num_users': 6.0, 'loss': 0.0339, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8723, 'compress@10': 0.0805, 'time@10': 5.6385}:  63%|██████▎   | 19/30 [01:15<00:32,  2.98s/it]{'epoch': 15, 'num_users': 6.15, 'loss': 0.0339, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8728, 'compress@10': 0.0783, 'time@10': 5.8202}:  63%|██████▎   | 19/30 [01:25<00:32,  2.98s/it]{'epoch': 15, 'num_users': 6.15, 'loss': 0.0339, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8728, 'compress@10': 0.0783, 'time@10': 5.8202}:  67%|██████▋   | 20/30 [01:25<00:48,  4.88s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0352, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8707, 'compress@10': 0.077, 'time@10': 5.9176}:  67%|██████▋   | 20/30 [01:29<00:48,  4.88s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0352, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8707, 'compress@10': 0.077, 'time@10': 5.9176}:  70%|███████   | 21/30 [01:29<00:41,  4.61s/it]{'epoch': 15, 'num_users': 6.1818, 'loss': 0.0357, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8719, 'compress@10': 0.0764, 'time@10': 5.8045}:  70%|███████   | 21/30 [01:32<00:41,  4.61s/it]{'epoch': 15, 'num_users': 6.1818, 'loss': 0.0357, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8719, 'compress@10': 0.0764, 'time@10': 5.8045}:  73%|███████▎  | 22/30 [01:32<00:34,  4.27s/it]{'epoch': 15, 'num_users': 6.1304, 'loss': 0.0351, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8731, 'compress@10': 0.076, 'time@10': 5.8239}:  73%|███████▎  | 22/30 [01:35<00:34,  4.27s/it] {'epoch': 15, 'num_users': 6.1304, 'loss': 0.0351, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8731, 'compress@10': 0.076, 'time@10': 5.8239}:  77%|███████▋  | 23/30 [01:35<00:27,  3.94s/it]{'epoch': 15, 'num_users': 5.9583, 'loss': 0.0343, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8677, 'compress@10': 0.0816, 'time@10': 5.641}:  77%|███████▋  | 23/30 [01:37<00:27,  3.94s/it]{'epoch': 15, 'num_users': 5.9583, 'loss': 0.0343, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8677, 'compress@10': 0.0816, 'time@10': 5.641}:  80%|████████  | 24/30 [01:37<00:19,  3.20s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0332, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8579, 'compress@10': 0.0921, 'time@10': 5.4731}:  80%|████████  | 24/30 [01:37<00:19,  3.20s/it]  {'epoch': 15, 'num_users': 5.8, 'loss': 0.0332, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8579, 'compress@10': 0.0921, 'time@10': 5.4731}:  83%|████████▎ | 25/30 [01:37<00:12,  2.47s/it]{'epoch': 15, 'num_users': 5.8077, 'loss': 0.0337, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8577, 'compress@10': 0.0896, 'time@10': 5.5481}:  83%|████████▎ | 25/30 [01:45<00:12,  2.47s/it]{'epoch': 15, 'num_users': 5.8077, 'loss': 0.0337, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8577, 'compress@10': 0.0896, 'time@10': 5.5481}:  87%|████████▋ | 26/30 [01:45<00:15,  3.96s/it]{'epoch': 15, 'num_users': 5.8889, 'loss': 0.034, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8621, 'compress@10': 0.0882, 'time@10': 5.6488}:  87%|████████▋ | 26/30 [01:49<00:15,  3.96s/it] {'epoch': 15, 'num_users': 5.8889, 'loss': 0.034, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8621, 'compress@10': 0.0882, 'time@10': 5.6488}:  90%|█████████ | 27/30 [01:49<00:12,  4.03s/it]{'epoch': 15, 'num_users': 6.0, 'loss': 0.0341, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.863, 'compress@10': 0.0871, 'time@10': 5.7155}:  90%|█████████ | 27/30 [01:57<00:12,  4.03s/it]   {'epoch': 15, 'num_users': 6.0, 'loss': 0.0341, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.863, 'compress@10': 0.0871, 'time@10': 5.7155}:  93%|█████████▎| 28/30 [01:57<00:10,  5.09s/it]{'epoch': 15, 'num_users': 5.8621, 'loss': 0.0336, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8646, 'compress@10': 0.0861, 'time@10': 5.6857}:  93%|█████████▎| 28/30 [01:59<00:10,  5.09s/it]{'epoch': 15, 'num_users': 5.8621, 'loss': 0.0336, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8646, 'compress@10': 0.0861, 'time@10': 5.6857}:  97%|█████████▋| 29/30 [01:59<00:04,  4.30s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0338, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.866, 'compress@10': 0.085, 'time@10': 5.6617}:  97%|█████████▋| 29/30 [02:04<00:04,  4.30s/it]  {'epoch': 15, 'num_users': 5.8667, 'loss': 0.0338, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.866, 'compress@10': 0.085, 'time@10': 5.6617}: 100%|██████████| 30/30 [02:04<00:00,  4.51s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0338, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.866, 'compress@10': 0.085, 'time@10': 5.6617}: 100%|██████████| 30/30 [02:04<00:00,  4.15s/it]
Epoch: 15
Avg # of users: 5.866666666666666
Avg Loss: 0.033788299601128745
Avg hit ratio: 0.8434472900460057
Avg ndcg: 0.8660416489011635
Avg compression ratio: 0.08498280674590583
Avg train time: 5.661722691853841
Std train time: 2.2969283701701646
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 19, 10, 26, 8, 18, 25, 10, 10, 10, 6, 10, 10, 26, 26, 6, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8628, 'compress@10': 0.065, 'time@10': 6.1838}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8628, 'compress@10': 0.065, 'time@10': 6.1838}:   3%|▎         | 1/30 [00:03<01:30,  3.13s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.037, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8766, 'compress@10': 0.059, 'time@10': 5.6134}:   3%|▎         | 1/30 [00:08<01:30,  3.13s/it] {'epoch': 16, 'num_users': 7.0, 'loss': 0.037, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8766, 'compress@10': 0.059, 'time@10': 5.6134}:   7%|▋         | 2/30 [00:08<01:59,  4.28s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8701, 'compress@10': 0.0921, 'time@10': 4.8702}:   7%|▋         | 2/30 [00:09<01:59,  4.28s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8701, 'compress@10': 0.0921, 'time@10': 4.8702}:  10%|█         | 3/30 [00:09<01:24,  3.12s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8677, 'compress@10': 0.0822, 'time@10': 4.7634}:  10%|█         | 3/30 [00:14<01:24,  3.12s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8677, 'compress@10': 0.0822, 'time@10': 4.7634}:  13%|█▎        | 4/30 [00:14<01:35,  3.67s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0386, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8503, 'compress@10': 0.0739, 'time@10': 5.4467}:  13%|█▎        | 4/30 [00:18<01:35,  3.67s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0386, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8503, 'compress@10': 0.0739, 'time@10': 5.4467}:  17%|█▋        | 5/30 [00:18<01:35,  3.83s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0386, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8527, 'compress@10': 0.0681, 'time@10': 5.7586}:  17%|█▋        | 5/30 [00:25<01:35,  3.83s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0386, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8527, 'compress@10': 0.0681, 'time@10': 5.7586}:  20%|██        | 6/30 [00:25<02:00,  5.03s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0377, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8552, 'compress@10': 0.0673, 'time@10': 6.0796}:  20%|██        | 6/30 [00:29<02:00,  5.03s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0377, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8552, 'compress@10': 0.0673, 'time@10': 6.0796}:  23%|██▎       | 7/30 [00:29<01:48,  4.71s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0377, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8692, 'compress@10': 0.0652, 'time@10': 6.02}:  23%|██▎       | 7/30 [00:35<01:48,  4.71s/it]   {'epoch': 16, 'num_users': 6.125, 'loss': 0.0377, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8692, 'compress@10': 0.0652, 'time@10': 6.02}:  27%|██▋       | 8/30 [00:35<01:50,  5.01s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0386, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8788, 'compress@10': 0.0623, 'time@10': 6.3503}:  27%|██▋       | 8/30 [00:40<01:50,  5.01s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0386, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8788, 'compress@10': 0.0623, 'time@10': 6.3503}:  30%|███       | 9/30 [00:40<01:42,  4.86s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0377, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.8804, 'compress@10': 0.0601, 'time@10': 6.4261}:  30%|███       | 9/30 [00:47<01:42,  4.86s/it]  {'epoch': 16, 'num_users': 6.3, 'loss': 0.0377, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.8804, 'compress@10': 0.0601, 'time@10': 6.4261}:  33%|███▎      | 10/30 [00:47<01:51,  5.57s/it]{'epoch': 16, 'num_users': 6.6364, 'loss': 0.0407, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8865, 'compress@10': 0.0602, 'time@10': 6.5995}:  33%|███▎      | 10/30 [00:51<01:51,  5.57s/it]{'epoch': 16, 'num_users': 6.6364, 'loss': 0.0407, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8865, 'compress@10': 0.0602, 'time@10': 6.5995}:  37%|███▋      | 11/30 [00:51<01:37,  5.15s/it]{'epoch': 16, 'num_users': 6.4167, 'loss': 0.0382, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.888, 'compress@10': 0.0637, 'time@10': 6.3358}:  37%|███▋      | 11/30 [00:55<01:37,  5.15s/it]{'epoch': 16, 'num_users': 6.4167, 'loss': 0.0382, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.888, 'compress@10': 0.0637, 'time@10': 6.3358}:  40%|████      | 12/30 [00:55<01:23,  4.64s/it]{'epoch': 16, 'num_users': 6.6154, 'loss': 0.0384, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8884, 'compress@10': 0.064, 'time@10': 6.3886}:  40%|████      | 12/30 [00:58<01:23,  4.64s/it]  {'epoch': 16, 'num_users': 6.6154, 'loss': 0.0384, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8884, 'compress@10': 0.064, 'time@10': 6.3886}:  43%|████▎     | 13/30 [00:58<01:13,  4.31s/it]{'epoch': 16, 'num_users': 6.3571, 'loss': 0.0361, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8836, 'compress@10': 0.0725, 'time@10': 6.0855}:  43%|████▎     | 13/30 [01:00<01:13,  4.31s/it]{'epoch': 16, 'num_users': 6.3571, 'loss': 0.0361, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8836, 'compress@10': 0.0725, 'time@10': 6.0855}:  47%|████▋     | 14/30 [01:00<00:58,  3.67s/it]{'epoch': 16, 'num_users': 6.2667, 'loss': 0.0364, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8831, 'compress@10': 0.0705, 'time@10': 6.2102}:  47%|████▋     | 14/30 [01:04<00:58,  3.67s/it]{'epoch': 16, 'num_users': 6.2667, 'loss': 0.0364, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8831, 'compress@10': 0.0705, 'time@10': 6.2102}:  50%|█████     | 15/30 [01:04<00:56,  3.78s/it]{'epoch': 16, 'num_users': 6.0625, 'loss': 0.0347, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8837, 'compress@10': 0.0725, 'time@10': 6.0225}:  50%|█████     | 15/30 [01:08<00:56,  3.78s/it]{'epoch': 16, 'num_users': 6.0625, 'loss': 0.0347, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8837, 'compress@10': 0.0725, 'time@10': 6.0225}:  53%|█████▎    | 16/30 [01:08<00:51,  3.65s/it]{'epoch': 16, 'num_users': 5.8235, 'loss': 0.033, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8764, 'compress@10': 0.081, 'time@10': 5.8545}:  53%|█████▎    | 16/30 [01:09<00:51,  3.65s/it]  {'epoch': 16, 'num_users': 5.8235, 'loss': 0.033, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8764, 'compress@10': 0.081, 'time@10': 5.8545}:  57%|█████▋    | 17/30 [01:09<00:39,  3.04s/it]{'epoch': 16, 'num_users': 6.0556, 'loss': 0.0333, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.877, 'compress@10': 0.0798, 'time@10': 5.7847}:  57%|█████▋    | 17/30 [01:14<00:39,  3.04s/it]{'epoch': 16, 'num_users': 6.0556, 'loss': 0.0333, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.877, 'compress@10': 0.0798, 'time@10': 5.7847}:  60%|██████    | 18/30 [01:14<00:42,  3.52s/it]{'epoch': 16, 'num_users': 6.0, 'loss': 0.0324, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8781, 'compress@10': 0.0804, 'time@10': 5.6913}:  60%|██████    | 18/30 [01:16<00:42,  3.52s/it]  {'epoch': 16, 'num_users': 6.0, 'loss': 0.0324, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8781, 'compress@10': 0.0804, 'time@10': 5.6913}:  63%|██████▎   | 19/30 [01:16<00:33,  3.08s/it]{'epoch': 16, 'num_users': 6.15, 'loss': 0.0325, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.879, 'compress@10': 0.0782, 'time@10': 5.8723}:  63%|██████▎   | 19/30 [01:25<00:33,  3.08s/it]{'epoch': 16, 'num_users': 6.15, 'loss': 0.0325, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.879, 'compress@10': 0.0782, 'time@10': 5.8723}:  67%|██████▋   | 20/30 [01:25<00:49,  4.96s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0341, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8765, 'compress@10': 0.0768, 'time@10': 5.9629}:  67%|██████▋   | 20/30 [01:29<00:49,  4.96s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0341, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8765, 'compress@10': 0.0768, 'time@10': 5.9629}:  70%|███████   | 21/30 [01:29<00:41,  4.65s/it]{'epoch': 16, 'num_users': 6.1818, 'loss': 0.0346, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8769, 'compress@10': 0.0763, 'time@10': 5.8477}:  70%|███████   | 21/30 [01:33<00:41,  4.65s/it]{'epoch': 16, 'num_users': 6.1818, 'loss': 0.0346, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8769, 'compress@10': 0.0763, 'time@10': 5.8477}:  73%|███████▎  | 22/30 [01:33<00:34,  4.30s/it]{'epoch': 16, 'num_users': 6.1304, 'loss': 0.0341, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8777, 'compress@10': 0.0758, 'time@10': 5.8533}:  73%|███████▎  | 22/30 [01:36<00:34,  4.30s/it] {'epoch': 16, 'num_users': 6.1304, 'loss': 0.0341, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8777, 'compress@10': 0.0758, 'time@10': 5.8533}:  77%|███████▋  | 23/30 [01:36<00:27,  3.92s/it]{'epoch': 16, 'num_users': 5.9583, 'loss': 0.0332, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8721, 'compress@10': 0.0815, 'time@10': 5.6723}:  77%|███████▋  | 23/30 [01:37<00:27,  3.92s/it]{'epoch': 16, 'num_users': 5.9583, 'loss': 0.0332, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8721, 'compress@10': 0.0815, 'time@10': 5.6723}:  80%|████████  | 24/30 [01:37<00:19,  3.21s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0321, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.8621, 'compress@10': 0.092, 'time@10': 5.5061}:  80%|████████  | 24/30 [01:38<00:19,  3.21s/it]    {'epoch': 16, 'num_users': 5.8, 'loss': 0.0321, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.8621, 'compress@10': 0.092, 'time@10': 5.5061}:  83%|████████▎ | 25/30 [01:38<00:12,  2.48s/it]{'epoch': 16, 'num_users': 5.8077, 'loss': 0.0325, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.862, 'compress@10': 0.0895, 'time@10': 5.5911}:  83%|████████▎ | 25/30 [01:46<00:12,  2.48s/it]{'epoch': 16, 'num_users': 5.8077, 'loss': 0.0325, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.862, 'compress@10': 0.0895, 'time@10': 5.5911}:  87%|████████▋ | 26/30 [01:46<00:16,  4.07s/it]{'epoch': 16, 'num_users': 5.8889, 'loss': 0.0323, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8641, 'compress@10': 0.0881, 'time@10': 5.7498}:  87%|████████▋ | 26/30 [01:51<00:16,  4.07s/it]{'epoch': 16, 'num_users': 5.8889, 'loss': 0.0323, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8641, 'compress@10': 0.0881, 'time@10': 5.7498}:  90%|█████████ | 27/30 [01:51<00:13,  4.34s/it]{'epoch': 16, 'num_users': 6.0, 'loss': 0.0326, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8655, 'compress@10': 0.0869, 'time@10': 5.8393}:  90%|█████████ | 27/30 [01:59<00:13,  4.34s/it]   {'epoch': 16, 'num_users': 6.0, 'loss': 0.0326, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8655, 'compress@10': 0.0869, 'time@10': 5.8393}:  93%|█████████▎| 28/30 [01:59<00:11,  5.53s/it]{'epoch': 16, 'num_users': 5.8621, 'loss': 0.0322, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8676, 'compress@10': 0.0859, 'time@10': 5.8528}:  93%|█████████▎| 28/30 [02:02<00:11,  5.53s/it]{'epoch': 16, 'num_users': 5.8621, 'loss': 0.0322, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8676, 'compress@10': 0.0859, 'time@10': 5.8528}:  97%|█████████▋| 29/30 [02:02<00:04,  4.82s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0323, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.869, 'compress@10': 0.0848, 'time@10': 5.84}:  97%|█████████▋| 29/30 [02:08<00:04,  4.82s/it]   {'epoch': 16, 'num_users': 5.8667, 'loss': 0.0323, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.869, 'compress@10': 0.0848, 'time@10': 5.84}: 100%|██████████| 30/30 [02:08<00:00,  5.03s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0323, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.869, 'compress@10': 0.0848, 'time@10': 5.84}: 100%|██████████| 30/30 [02:08<00:00,  4.28s/it]
Epoch: 16
Avg # of users: 5.866666666666666
Avg Loss: 0.03231288102355312
Avg hit ratio: 0.8407521733033506
Avg ndcg: 0.8689688339096762
Avg compression ratio: 0.08476205977154676
Avg train time: 5.839961489041646
Std train time: 2.367957180598094
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 19, 10, 27, 8, 18, 26, 10, 10, 10, 6, 10, 10, 27, 27, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8575, 'compress@10': 0.0653, 'time@10': 5.7644}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8575, 'compress@10': 0.0653, 'time@10': 5.7644}:   3%|▎         | 1/30 [00:02<01:24,  2.92s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.82, 'ndcg@10': 0.874, 'compress@10': 0.0594, 'time@10': 5.4197}:   3%|▎         | 1/30 [00:08<01:24,  2.92s/it]   {'epoch': 17, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.82, 'ndcg@10': 0.874, 'compress@10': 0.0594, 'time@10': 5.4197}:   7%|▋         | 2/30 [00:08<01:57,  4.21s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.7848, 'ndcg@10': 0.8684, 'compress@10': 0.0925, 'time@10': 4.7672}:   7%|▋         | 2/30 [00:09<01:57,  4.21s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.7848, 'ndcg@10': 0.8684, 'compress@10': 0.0925, 'time@10': 4.7672}:  10%|█         | 3/30 [00:09<01:23,  3.10s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8673, 'compress@10': 0.0825, 'time@10': 4.7507}:  10%|█         | 3/30 [00:14<01:23,  3.10s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8673, 'compress@10': 0.0825, 'time@10': 4.7507}:  13%|█▎        | 4/30 [00:14<01:37,  3.76s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0402, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8504, 'compress@10': 0.0741, 'time@10': 5.4455}:  13%|█▎        | 4/30 [00:18<01:37,  3.76s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0402, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8504, 'compress@10': 0.0741, 'time@10': 5.4455}:  17%|█▋        | 5/30 [00:18<01:37,  3.90s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0402, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8533, 'compress@10': 0.0683, 'time@10': 5.7525}:  17%|█▋        | 5/30 [00:26<01:37,  3.90s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0402, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8533, 'compress@10': 0.0683, 'time@10': 5.7525}:  20%|██        | 6/30 [00:26<02:01,  5.07s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.039, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.861, 'compress@10': 0.0676, 'time@10': 6.068}:  20%|██        | 6/30 [00:30<02:01,  5.07s/it]   {'epoch': 17, 'num_users': 6.2857, 'loss': 0.039, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.861, 'compress@10': 0.0676, 'time@10': 6.068}:  23%|██▎       | 7/30 [00:30<01:48,  4.73s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0386, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8727, 'compress@10': 0.0654, 'time@10': 6.0074}:  23%|██▎       | 7/30 [00:35<01:48,  4.73s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0386, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8727, 'compress@10': 0.0654, 'time@10': 6.0074}:  27%|██▋       | 8/30 [00:35<01:50,  5.01s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0404, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8892, 'compress@10': 0.0625, 'time@10': 6.337}:  27%|██▋       | 8/30 [00:40<01:50,  5.01s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0404, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8892, 'compress@10': 0.0625, 'time@10': 6.337}:  30%|███       | 9/30 [00:40<01:42,  4.86s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0396, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.8921, 'compress@10': 0.0603, 'time@10': 6.4138}:  30%|███       | 9/30 [00:47<01:42,  4.86s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0396, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.8921, 'compress@10': 0.0603, 'time@10': 6.4138}:  33%|███▎      | 10/30 [00:47<01:51,  5.57s/it]{'epoch': 17, 'num_users': 6.6364, 'loss': 0.0407, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8909, 'compress@10': 0.0602, 'time@10': 6.5836}:  33%|███▎      | 10/30 [00:51<01:51,  5.57s/it]{'epoch': 17, 'num_users': 6.6364, 'loss': 0.0407, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8909, 'compress@10': 0.0602, 'time@10': 6.5836}:  37%|███▋      | 11/30 [00:51<01:37,  5.14s/it]{'epoch': 17, 'num_users': 6.4167, 'loss': 0.0382, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.892, 'compress@10': 0.0638, 'time@10': 6.3146}:  37%|███▋      | 11/30 [00:54<01:37,  5.14s/it] {'epoch': 17, 'num_users': 6.4167, 'loss': 0.0382, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.892, 'compress@10': 0.0638, 'time@10': 6.3146}:  40%|████      | 12/30 [00:54<01:22,  4.61s/it]{'epoch': 17, 'num_users': 6.6154, 'loss': 0.0383, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8918, 'compress@10': 0.0641, 'time@10': 6.3526}:  40%|████      | 12/30 [00:58<01:22,  4.61s/it]{'epoch': 17, 'num_users': 6.6154, 'loss': 0.0383, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8918, 'compress@10': 0.0641, 'time@10': 6.3526}:  43%|████▎     | 13/30 [00:58<01:12,  4.26s/it]{'epoch': 17, 'num_users': 6.3571, 'loss': 0.036, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8868, 'compress@10': 0.0726, 'time@10': 6.0568}:  43%|████▎     | 13/30 [01:00<01:12,  4.26s/it] {'epoch': 17, 'num_users': 6.3571, 'loss': 0.036, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8868, 'compress@10': 0.0726, 'time@10': 6.0568}:  47%|████▋     | 14/30 [01:00<00:58,  3.65s/it]{'epoch': 17, 'num_users': 6.2667, 'loss': 0.0363, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8864, 'compress@10': 0.0706, 'time@10': 6.1772}:  47%|████▋     | 14/30 [01:04<00:58,  3.65s/it]{'epoch': 17, 'num_users': 6.2667, 'loss': 0.0363, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8864, 'compress@10': 0.0706, 'time@10': 6.1772}:  50%|█████     | 15/30 [01:04<00:56,  3.75s/it]{'epoch': 17, 'num_users': 6.0625, 'loss': 0.0346, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8868, 'compress@10': 0.0726, 'time@10': 5.996}:  50%|█████     | 15/30 [01:07<00:56,  3.75s/it] {'epoch': 17, 'num_users': 6.0625, 'loss': 0.0346, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8868, 'compress@10': 0.0726, 'time@10': 5.996}:  53%|█████▎    | 16/30 [01:07<00:50,  3.62s/it]{'epoch': 17, 'num_users': 5.8235, 'loss': 0.0328, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8793, 'compress@10': 0.0811, 'time@10': 5.8419}:  53%|█████▎    | 16/30 [01:09<00:50,  3.62s/it]{'epoch': 17, 'num_users': 5.8235, 'loss': 0.0328, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8793, 'compress@10': 0.0811, 'time@10': 5.8419}:  57%|█████▋    | 17/30 [01:09<00:39,  3.05s/it]{'epoch': 17, 'num_users': 6.0556, 'loss': 0.0331, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8794, 'compress@10': 0.0798, 'time@10': 5.7656}:  57%|█████▋    | 17/30 [01:14<00:39,  3.05s/it]{'epoch': 17, 'num_users': 6.0556, 'loss': 0.0331, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8794, 'compress@10': 0.0798, 'time@10': 5.7656}:  60%|██████    | 18/30 [01:14<00:41,  3.49s/it]{'epoch': 17, 'num_users': 6.0, 'loss': 0.0321, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8804, 'compress@10': 0.0804, 'time@10': 5.687}:  60%|██████    | 18/30 [01:16<00:41,  3.49s/it]    {'epoch': 17, 'num_users': 6.0, 'loss': 0.0321, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8804, 'compress@10': 0.0804, 'time@10': 5.687}:  63%|██████▎   | 19/30 [01:16<00:34,  3.09s/it]{'epoch': 17, 'num_users': 6.15, 'loss': 0.0322, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.8816, 'compress@10': 0.0782, 'time@10': 5.8698}:  63%|██████▎   | 19/30 [01:25<00:34,  3.09s/it]{'epoch': 17, 'num_users': 6.15, 'loss': 0.0322, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.8816, 'compress@10': 0.0782, 'time@10': 5.8698}:  67%|██████▋   | 20/30 [01:25<00:49,  4.98s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0336, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.879, 'compress@10': 0.0768, 'time@10': 5.953}:  67%|██████▋   | 20/30 [01:29<00:49,  4.98s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0336, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.879, 'compress@10': 0.0768, 'time@10': 5.953}:  70%|███████   | 21/30 [01:29<00:41,  4.64s/it]{'epoch': 17, 'num_users': 6.1818, 'loss': 0.0341, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8792, 'compress@10': 0.0763, 'time@10': 5.8257}:  70%|███████   | 21/30 [01:32<00:41,  4.64s/it]{'epoch': 17, 'num_users': 6.1818, 'loss': 0.0341, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8792, 'compress@10': 0.0763, 'time@10': 5.8257}:  73%|███████▎  | 22/30 [01:32<00:33,  4.21s/it]{'epoch': 17, 'num_users': 6.1304, 'loss': 0.0336, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8799, 'compress@10': 0.0759, 'time@10': 5.8449}:  73%|███████▎  | 22/30 [01:35<00:33,  4.21s/it]{'epoch': 17, 'num_users': 6.1304, 'loss': 0.0336, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8799, 'compress@10': 0.0759, 'time@10': 5.8449}:  77%|███████▋  | 23/30 [01:35<00:27,  3.90s/it]{'epoch': 17, 'num_users': 5.9583, 'loss': 0.0326, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8743, 'compress@10': 0.0815, 'time@10': 5.6758}:  77%|███████▋  | 23/30 [01:37<00:27,  3.90s/it]{'epoch': 17, 'num_users': 5.9583, 'loss': 0.0326, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8743, 'compress@10': 0.0815, 'time@10': 5.6758}:  80%|████████  | 24/30 [01:37<00:19,  3.28s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0315, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8642, 'compress@10': 0.092, 'time@10': 5.5198}:  80%|████████  | 24/30 [01:38<00:19,  3.28s/it]    {'epoch': 17, 'num_users': 5.8, 'loss': 0.0315, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8642, 'compress@10': 0.092, 'time@10': 5.5198}:  83%|████████▎ | 25/30 [01:38<00:12,  2.57s/it]{'epoch': 17, 'num_users': 5.8077, 'loss': 0.0319, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8641, 'compress@10': 0.0895, 'time@10': 5.5943}:  83%|████████▎ | 25/30 [01:46<00:12,  2.57s/it]{'epoch': 17, 'num_users': 5.8077, 'loss': 0.0319, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8641, 'compress@10': 0.0895, 'time@10': 5.5943}:  87%|████████▋ | 26/30 [01:46<00:16,  4.05s/it]{'epoch': 17, 'num_users': 5.8889, 'loss': 0.0314, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8654, 'compress@10': 0.0882, 'time@10': 5.6846}:  87%|████████▋ | 26/30 [01:50<00:16,  4.05s/it]{'epoch': 17, 'num_users': 5.8889, 'loss': 0.0314, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8654, 'compress@10': 0.0882, 'time@10': 5.6846}:  90%|█████████ | 27/30 [01:50<00:12,  4.05s/it]{'epoch': 17, 'num_users': 6.0, 'loss': 0.0318, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8661, 'compress@10': 0.0871, 'time@10': 5.7475}:  90%|█████████ | 27/30 [01:57<00:12,  4.05s/it]   {'epoch': 17, 'num_users': 6.0, 'loss': 0.0318, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8661, 'compress@10': 0.0871, 'time@10': 5.7475}:  93%|█████████▎| 28/30 [01:57<00:10,  5.08s/it]{'epoch': 17, 'num_users': 5.8621, 'loss': 0.0315, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8682, 'compress@10': 0.0861, 'time@10': 5.7518}:  93%|█████████▎| 28/30 [02:00<00:10,  5.08s/it]{'epoch': 17, 'num_users': 5.8621, 'loss': 0.0315, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8682, 'compress@10': 0.0861, 'time@10': 5.7518}:  97%|█████████▋| 29/30 [02:00<00:04,  4.45s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.0316, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8695, 'compress@10': 0.085, 'time@10': 5.753}:  97%|█████████▋| 29/30 [02:06<00:04,  4.45s/it]  {'epoch': 17, 'num_users': 5.8667, 'loss': 0.0316, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8695, 'compress@10': 0.085, 'time@10': 5.753}: 100%|██████████| 30/30 [02:06<00:00,  4.86s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.0316, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8695, 'compress@10': 0.085, 'time@10': 5.753}: 100%|██████████| 30/30 [02:06<00:00,  4.22s/it]
Epoch: 17
Avg # of users: 5.866666666666666
Avg Loss: 0.03162921706131114
Avg hit ratio: 0.8392294400751845
Avg ndcg: 0.8694871133130844
Avg compression ratio: 0.08498350371072654
Avg train time: 5.753028790156047
Std train time: 2.1922323394585588
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 19, 10, 28, 8, 18, 26, 10, 10, 10, 6, 11, 10, 28, 28, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8664, 'compress@10': 0.0653, 'time@10': 6.3357}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8664, 'compress@10': 0.0653, 'time@10': 6.3357}:   3%|▎         | 1/30 [00:03<01:32,  3.21s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8794, 'compress@10': 0.0595, 'time@10': 5.7427}:   3%|▎         | 1/30 [00:08<01:32,  3.21s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8794, 'compress@10': 0.0595, 'time@10': 5.7427}:   7%|▋         | 2/30 [00:08<02:02,  4.37s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.872, 'compress@10': 0.0927, 'time@10': 4.9553}:   7%|▋         | 2/30 [00:10<02:02,  4.37s/it]  {'epoch': 18, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.872, 'compress@10': 0.0927, 'time@10': 4.9553}:  10%|█         | 3/30 [00:10<01:25,  3.17s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8697, 'compress@10': 0.0827, 'time@10': 4.9162}:  10%|█         | 3/30 [00:14<01:25,  3.17s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8697, 'compress@10': 0.0827, 'time@10': 4.9162}:  13%|█▎        | 4/30 [00:14<01:39,  3.84s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.853, 'compress@10': 0.0742, 'time@10': 5.6663}:  13%|█▎        | 4/30 [00:19<01:39,  3.84s/it] {'epoch': 18, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.853, 'compress@10': 0.0742, 'time@10': 5.6663}:  17%|█▋        | 5/30 [00:19<01:40,  4.03s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.038, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8556, 'compress@10': 0.0684, 'time@10': 5.9528}:  17%|█▋        | 5/30 [00:26<01:40,  4.03s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.038, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8556, 'compress@10': 0.0684, 'time@10': 5.9528}:  20%|██        | 6/30 [00:26<02:04,  5.18s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0374, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8591, 'compress@10': 0.0677, 'time@10': 6.2437}:  20%|██        | 6/30 [00:30<02:04,  5.18s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0374, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8591, 'compress@10': 0.0677, 'time@10': 6.2437}:  23%|██▎       | 7/30 [00:30<01:50,  4.81s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.037, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8713, 'compress@10': 0.0655, 'time@10': 6.163}:  23%|██▎       | 7/30 [00:36<01:50,  4.81s/it]   {'epoch': 18, 'num_users': 6.125, 'loss': 0.037, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8713, 'compress@10': 0.0655, 'time@10': 6.163}:  27%|██▋       | 8/30 [00:36<01:51,  5.07s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0395, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8948, 'compress@10': 0.0625, 'time@10': 6.4788}:  27%|██▋       | 8/30 [00:41<01:51,  5.07s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0395, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8948, 'compress@10': 0.0625, 'time@10': 6.4788}:  30%|███       | 9/30 [00:41<01:43,  4.91s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0382, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8961, 'compress@10': 0.0603, 'time@10': 6.5444}:  30%|███       | 9/30 [00:48<01:43,  4.91s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0382, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8961, 'compress@10': 0.0603, 'time@10': 6.5444}:  33%|███▎      | 10/30 [00:48<01:52,  5.61s/it]{'epoch': 18, 'num_users': 6.6364, 'loss': 0.0386, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8943, 'compress@10': 0.0603, 'time@10': 6.7832}:  33%|███▎      | 10/30 [00:52<01:52,  5.61s/it]{'epoch': 18, 'num_users': 6.6364, 'loss': 0.0386, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8943, 'compress@10': 0.0603, 'time@10': 6.7832}:  37%|███▋      | 11/30 [00:52<01:40,  5.31s/it]{'epoch': 18, 'num_users': 6.4167, 'loss': 0.0361, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8951, 'compress@10': 0.0638, 'time@10': 6.5248}:  37%|███▋      | 11/30 [00:56<01:40,  5.31s/it]{'epoch': 18, 'num_users': 6.4167, 'loss': 0.0361, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8951, 'compress@10': 0.0638, 'time@10': 6.5248}:  40%|████      | 12/30 [00:56<01:26,  4.83s/it]{'epoch': 18, 'num_users': 6.6154, 'loss': 0.0365, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8947, 'compress@10': 0.0641, 'time@10': 6.5524}:  40%|████      | 12/30 [01:00<01:26,  4.83s/it]{'epoch': 18, 'num_users': 6.6154, 'loss': 0.0365, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8947, 'compress@10': 0.0641, 'time@10': 6.5524}:  43%|████▎     | 13/30 [01:00<01:15,  4.42s/it]{'epoch': 18, 'num_users': 6.3571, 'loss': 0.0342, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8895, 'compress@10': 0.0726, 'time@10': 6.2491}:  43%|████▎     | 13/30 [01:02<01:15,  4.42s/it]{'epoch': 18, 'num_users': 6.3571, 'loss': 0.0342, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8895, 'compress@10': 0.0726, 'time@10': 6.2491}:  47%|████▋     | 14/30 [01:02<01:00,  3.80s/it]{'epoch': 18, 'num_users': 6.2667, 'loss': 0.0346, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8886, 'compress@10': 0.0706, 'time@10': 6.358}:  47%|████▋     | 14/30 [01:06<01:00,  3.80s/it] {'epoch': 18, 'num_users': 6.2667, 'loss': 0.0346, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8886, 'compress@10': 0.0706, 'time@10': 6.358}:  50%|█████     | 15/30 [01:06<00:57,  3.85s/it]{'epoch': 18, 'num_users': 6.0625, 'loss': 0.0329, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8888, 'compress@10': 0.0727, 'time@10': 6.1633}:  50%|█████     | 15/30 [01:09<00:57,  3.85s/it]{'epoch': 18, 'num_users': 6.0625, 'loss': 0.0329, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8888, 'compress@10': 0.0727, 'time@10': 6.1633}:  53%|█████▎    | 16/30 [01:09<00:51,  3.68s/it]{'epoch': 18, 'num_users': 5.8235, 'loss': 0.0313, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8812, 'compress@10': 0.0812, 'time@10': 6.0013}:  53%|█████▎    | 16/30 [01:11<00:51,  3.68s/it] {'epoch': 18, 'num_users': 5.8235, 'loss': 0.0313, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8812, 'compress@10': 0.0812, 'time@10': 6.0013}:  57%|█████▋    | 17/30 [01:11<00:40,  3.10s/it]{'epoch': 18, 'num_users': 6.0556, 'loss': 0.0316, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8811, 'compress@10': 0.0798, 'time@10': 5.9171}:  57%|█████▋    | 17/30 [01:15<00:40,  3.10s/it]{'epoch': 18, 'num_users': 6.0556, 'loss': 0.0316, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8811, 'compress@10': 0.0798, 'time@10': 5.9171}:  60%|██████    | 18/30 [01:15<00:42,  3.53s/it]{'epoch': 18, 'num_users': 6.0, 'loss': 0.0307, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.882, 'compress@10': 0.0804, 'time@10': 5.8319}:  60%|██████    | 18/30 [01:18<00:42,  3.53s/it]    {'epoch': 18, 'num_users': 6.0, 'loss': 0.0307, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.882, 'compress@10': 0.0804, 'time@10': 5.8319}:  63%|██████▎   | 19/30 [01:18<00:34,  3.13s/it]{'epoch': 18, 'num_users': 6.15, 'loss': 0.0307, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.883, 'compress@10': 0.0782, 'time@10': 5.9859}:  63%|██████▎   | 19/30 [01:27<00:34,  3.13s/it]{'epoch': 18, 'num_users': 6.15, 'loss': 0.0307, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.883, 'compress@10': 0.0782, 'time@10': 5.9859}:  67%|██████▋   | 20/30 [01:27<00:48,  4.87s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8812, 'compress@10': 0.0769, 'time@10': 6.0349}:  67%|██████▋   | 20/30 [01:30<00:48,  4.87s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8812, 'compress@10': 0.0769, 'time@10': 6.0349}:  70%|███████   | 21/30 [01:30<00:40,  4.48s/it]{'epoch': 18, 'num_users': 6.1818, 'loss': 0.0325, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8816, 'compress@10': 0.0763, 'time@10': 5.9249}:  70%|███████   | 21/30 [01:34<00:40,  4.48s/it]{'epoch': 18, 'num_users': 6.1818, 'loss': 0.0325, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8816, 'compress@10': 0.0763, 'time@10': 5.9249}:  73%|███████▎  | 22/30 [01:34<00:33,  4.23s/it]{'epoch': 18, 'num_users': 6.1304, 'loss': 0.032, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8826, 'compress@10': 0.0759, 'time@10': 5.9372}:  73%|███████▎  | 22/30 [01:37<00:33,  4.23s/it] {'epoch': 18, 'num_users': 6.1304, 'loss': 0.032, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8826, 'compress@10': 0.0759, 'time@10': 5.9372}:  77%|███████▋  | 23/30 [01:37<00:27,  3.90s/it]{'epoch': 18, 'num_users': 5.9583, 'loss': 0.0311, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8769, 'compress@10': 0.0815, 'time@10': 5.7666}:  77%|███████▋  | 23/30 [01:39<00:27,  3.90s/it]{'epoch': 18, 'num_users': 5.9583, 'loss': 0.0311, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8769, 'compress@10': 0.0815, 'time@10': 5.7666}:  80%|████████  | 24/30 [01:39<00:19,  3.30s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.03, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8667, 'compress@10': 0.092, 'time@10': 5.6089}:  80%|████████  | 24/30 [01:40<00:19,  3.30s/it]      {'epoch': 18, 'num_users': 5.8, 'loss': 0.03, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8667, 'compress@10': 0.092, 'time@10': 5.6089}:  83%|████████▎ | 25/30 [01:40<00:12,  2.59s/it]{'epoch': 18, 'num_users': 5.8077, 'loss': 0.0303, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8667, 'compress@10': 0.0895, 'time@10': 5.6777}:  83%|████████▎ | 25/30 [01:47<00:12,  2.59s/it]{'epoch': 18, 'num_users': 5.8077, 'loss': 0.0303, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8667, 'compress@10': 0.0895, 'time@10': 5.6777}:  87%|████████▋ | 26/30 [01:47<00:16,  4.05s/it]{'epoch': 18, 'num_users': 5.8889, 'loss': 0.03, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8682, 'compress@10': 0.0884, 'time@10': 5.7644}:  87%|████████▋ | 26/30 [01:51<00:16,  4.05s/it]  {'epoch': 18, 'num_users': 5.8889, 'loss': 0.03, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8682, 'compress@10': 0.0884, 'time@10': 5.7644}:  90%|█████████ | 27/30 [01:51<00:12,  4.05s/it]{'epoch': 18, 'num_users': 6.0, 'loss': 0.03, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8693, 'compress@10': 0.0872, 'time@10': 5.8304}:  90%|█████████ | 27/30 [01:59<00:12,  4.05s/it]   {'epoch': 18, 'num_users': 6.0, 'loss': 0.03, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8693, 'compress@10': 0.0872, 'time@10': 5.8304}:  93%|█████████▎| 28/30 [01:59<00:10,  5.13s/it]{'epoch': 18, 'num_users': 5.8621, 'loss': 0.0299, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.8715, 'compress@10': 0.0862, 'time@10': 5.8277}:  93%|█████████▎| 28/30 [02:02<00:10,  5.13s/it]{'epoch': 18, 'num_users': 5.8621, 'loss': 0.0299, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.8715, 'compress@10': 0.0862, 'time@10': 5.8277}:  97%|█████████▋| 29/30 [02:02<00:04,  4.47s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.03, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8727, 'compress@10': 0.0851, 'time@10': 5.808}:  97%|█████████▋| 29/30 [02:07<00:04,  4.47s/it]   {'epoch': 18, 'num_users': 5.8667, 'loss': 0.03, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8727, 'compress@10': 0.0851, 'time@10': 5.808}: 100%|██████████| 30/30 [02:07<00:00,  4.71s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.03, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8727, 'compress@10': 0.0851, 'time@10': 5.808}: 100%|██████████| 30/30 [02:07<00:00,  4.25s/it]
Epoch: 18
Avg # of users: 5.866666666666666
Avg Loss: 0.030000231653983096
Avg hit ratio: 0.8445457521429123
Avg ndcg: 0.8727039231545409
Avg compression ratio: 0.08509245253678642
Avg train time: 5.808031328519186
Std train time: 2.1879349383368685
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 19, 10, 29, 8, 18, 26, 10, 10, 10, 6, 11, 10, 29, 29, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0412, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8715, 'compress@10': 0.0654, 'time@10': 5.2277}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0412, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8715, 'compress@10': 0.0654, 'time@10': 5.2277}:   3%|▎         | 1/30 [00:02<01:16,  2.65s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8825, 'compress@10': 0.0598, 'time@10': 5.0538}:   3%|▎         | 1/30 [00:07<01:16,  2.65s/it]  {'epoch': 19, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8825, 'compress@10': 0.0598, 'time@10': 5.0538}:   7%|▋         | 2/30 [00:07<01:51,  3.98s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.7848, 'ndcg@10': 0.874, 'compress@10': 0.0929, 'time@10': 4.4959}:   7%|▋         | 2/30 [00:09<01:51,  3.98s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.7848, 'ndcg@10': 0.874, 'compress@10': 0.0929, 'time@10': 4.4959}:  10%|█         | 3/30 [00:09<01:19,  2.96s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8729, 'compress@10': 0.0829, 'time@10': 4.4809}:  10%|█         | 3/30 [00:13<01:19,  2.96s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8729, 'compress@10': 0.0829, 'time@10': 4.4809}:  13%|█▎        | 4/30 [00:13<01:32,  3.56s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0365, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8559, 'compress@10': 0.0744, 'time@10': 5.216}:  13%|█▎        | 4/30 [00:17<01:32,  3.56s/it] {'epoch': 19, 'num_users': 5.8, 'loss': 0.0365, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8559, 'compress@10': 0.0744, 'time@10': 5.216}:  17%|█▋        | 5/30 [00:17<01:33,  3.76s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0366, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8591, 'compress@10': 0.0685, 'time@10': 5.5639}:  17%|█▋        | 5/30 [00:25<01:33,  3.76s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0366, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8591, 'compress@10': 0.0685, 'time@10': 5.5639}:  20%|██        | 6/30 [00:25<02:00,  5.02s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0353, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.865, 'compress@10': 0.0679, 'time@10': 5.9027}:  20%|██        | 6/30 [00:29<02:00,  5.02s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.0353, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.865, 'compress@10': 0.0679, 'time@10': 5.9027}:  23%|██▎       | 7/30 [00:29<01:47,  4.69s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.035, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.8767, 'compress@10': 0.0657, 'time@10': 5.8748}:  23%|██▎       | 7/30 [00:35<01:47,  4.69s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.035, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.8767, 'compress@10': 0.0657, 'time@10': 5.8748}:  27%|██▋       | 8/30 [00:35<01:50,  5.03s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0352, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8821, 'compress@10': 0.0629, 'time@10': 6.2583}:  27%|██▋       | 8/30 [00:39<01:50,  5.03s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0352, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8821, 'compress@10': 0.0629, 'time@10': 6.2583}:  30%|███       | 9/30 [00:39<01:43,  4.93s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0349, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.8869, 'compress@10': 0.0608, 'time@10': 6.3674}:  30%|███       | 9/30 [00:47<01:43,  4.93s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0349, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.8869, 'compress@10': 0.0608, 'time@10': 6.3674}:  33%|███▎      | 10/30 [00:47<01:53,  5.69s/it]{'epoch': 19, 'num_users': 6.6364, 'loss': 0.0359, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.8871, 'compress@10': 0.0608, 'time@10': 6.5885}:  33%|███▎      | 10/30 [00:51<01:53,  5.69s/it]{'epoch': 19, 'num_users': 6.6364, 'loss': 0.0359, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.8871, 'compress@10': 0.0608, 'time@10': 6.5885}:  37%|███▋      | 11/30 [00:51<01:40,  5.31s/it]{'epoch': 19, 'num_users': 6.4167, 'loss': 0.0336, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8888, 'compress@10': 0.0643, 'time@10': 6.3401}:  37%|███▋      | 11/30 [00:55<01:40,  5.31s/it]{'epoch': 19, 'num_users': 6.4167, 'loss': 0.0336, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8888, 'compress@10': 0.0643, 'time@10': 6.3401}:  40%|████      | 12/30 [00:55<01:26,  4.80s/it]{'epoch': 19, 'num_users': 6.6154, 'loss': 0.0341, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8887, 'compress@10': 0.0646, 'time@10': 6.4214}:  40%|████      | 12/30 [00:59<01:26,  4.80s/it]{'epoch': 19, 'num_users': 6.6154, 'loss': 0.0341, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8887, 'compress@10': 0.0646, 'time@10': 6.4214}:  43%|████▎     | 13/30 [00:59<01:16,  4.48s/it]{'epoch': 19, 'num_users': 6.3571, 'loss': 0.0319, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.884, 'compress@10': 0.0731, 'time@10': 6.1329}:  43%|████▎     | 13/30 [01:01<01:16,  4.48s/it] {'epoch': 19, 'num_users': 6.3571, 'loss': 0.0319, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.884, 'compress@10': 0.0731, 'time@10': 6.1329}:  47%|████▋     | 14/30 [01:01<01:01,  3.86s/it]{'epoch': 19, 'num_users': 6.2667, 'loss': 0.0321, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8844, 'compress@10': 0.071, 'time@10': 6.2295}:  47%|████▋     | 14/30 [01:05<01:01,  3.86s/it]{'epoch': 19, 'num_users': 6.2667, 'loss': 0.0321, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8844, 'compress@10': 0.071, 'time@10': 6.2295}:  50%|█████     | 15/30 [01:05<00:57,  3.85s/it]{'epoch': 19, 'num_users': 6.0625, 'loss': 0.0306, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.885, 'compress@10': 0.0731, 'time@10': 6.0421}:  50%|█████     | 15/30 [01:08<00:57,  3.85s/it]{'epoch': 19, 'num_users': 6.0625, 'loss': 0.0306, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.885, 'compress@10': 0.0731, 'time@10': 6.0421}:  53%|█████▎    | 16/30 [01:08<00:51,  3.68s/it]{'epoch': 19, 'num_users': 5.8235, 'loss': 0.0291, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8777, 'compress@10': 0.0815, 'time@10': 5.8886}:  53%|█████▎    | 16/30 [01:10<00:51,  3.68s/it]{'epoch': 19, 'num_users': 5.8235, 'loss': 0.0291, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8777, 'compress@10': 0.0815, 'time@10': 5.8886}:  57%|█████▋    | 17/30 [01:10<00:40,  3.10s/it]{'epoch': 19, 'num_users': 6.0556, 'loss': 0.0294, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8777, 'compress@10': 0.0802, 'time@10': 5.8419}:  57%|█████▋    | 17/30 [01:15<00:40,  3.10s/it]{'epoch': 19, 'num_users': 6.0556, 'loss': 0.0294, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8777, 'compress@10': 0.0802, 'time@10': 5.8419}:  60%|██████    | 18/30 [01:15<00:44,  3.70s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 0.0286, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.8785, 'compress@10': 0.0808, 'time@10': 5.7702}:  60%|██████    | 18/30 [01:17<00:44,  3.70s/it]   {'epoch': 19, 'num_users': 6.0, 'loss': 0.0286, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.8785, 'compress@10': 0.0808, 'time@10': 5.7702}:  63%|██████▎   | 19/30 [01:17<00:35,  3.27s/it]{'epoch': 19, 'num_users': 6.15, 'loss': 0.0287, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8796, 'compress@10': 0.0786, 'time@10': 5.9557}:  63%|██████▎   | 19/30 [01:27<00:35,  3.27s/it]{'epoch': 19, 'num_users': 6.15, 'loss': 0.0287, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8796, 'compress@10': 0.0786, 'time@10': 5.9557}:  67%|██████▋   | 20/30 [01:27<00:51,  5.16s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0303, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8776, 'compress@10': 0.0772, 'time@10': 6.0403}:  67%|██████▋   | 20/30 [01:31<00:51,  5.16s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0303, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8776, 'compress@10': 0.0772, 'time@10': 6.0403}:  70%|███████   | 21/30 [01:31<00:43,  4.79s/it]{'epoch': 19, 'num_users': 6.1818, 'loss': 0.0309, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8798, 'compress@10': 0.0766, 'time@10': 5.9388}:  70%|███████   | 21/30 [01:35<00:43,  4.79s/it]{'epoch': 19, 'num_users': 6.1818, 'loss': 0.0309, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8798, 'compress@10': 0.0766, 'time@10': 5.9388}:  73%|███████▎  | 22/30 [01:35<00:36,  4.51s/it]{'epoch': 19, 'num_users': 6.1304, 'loss': 0.0306, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8811, 'compress@10': 0.0762, 'time@10': 5.9523}:  73%|███████▎  | 22/30 [01:38<00:36,  4.51s/it]{'epoch': 19, 'num_users': 6.1304, 'loss': 0.0306, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8811, 'compress@10': 0.0762, 'time@10': 5.9523}:  77%|███████▋  | 23/30 [01:38<00:28,  4.10s/it]{'epoch': 19, 'num_users': 5.9583, 'loss': 0.0297, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8754, 'compress@10': 0.0819, 'time@10': 5.7807}:  77%|███████▋  | 23/30 [01:40<00:28,  4.10s/it]{'epoch': 19, 'num_users': 5.9583, 'loss': 0.0297, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8754, 'compress@10': 0.0819, 'time@10': 5.7807}:  80%|████████  | 24/30 [01:40<00:20,  3.43s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0287, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8652, 'compress@10': 0.0924, 'time@10': 5.6197}:  80%|████████  | 24/30 [01:40<00:20,  3.43s/it]   {'epoch': 19, 'num_users': 5.8, 'loss': 0.0287, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8652, 'compress@10': 0.0924, 'time@10': 5.6197}:  83%|████████▎ | 25/30 [01:40<00:13,  2.68s/it]{'epoch': 19, 'num_users': 5.8077, 'loss': 0.0289, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8657, 'compress@10': 0.0898, 'time@10': 5.6988}:  83%|████████▎ | 25/30 [01:48<00:13,  2.68s/it]{'epoch': 19, 'num_users': 5.8077, 'loss': 0.0289, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8657, 'compress@10': 0.0898, 'time@10': 5.6988}:  87%|████████▋ | 26/30 [01:48<00:16,  4.19s/it]{'epoch': 19, 'num_users': 5.8889, 'loss': 0.0287, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.868, 'compress@10': 0.0886, 'time@10': 5.7634}:  87%|████████▋ | 26/30 [01:52<00:16,  4.19s/it] {'epoch': 19, 'num_users': 5.8889, 'loss': 0.0287, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.868, 'compress@10': 0.0886, 'time@10': 5.7634}:  90%|█████████ | 27/30 [01:52<00:12,  4.06s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 0.0287, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8695, 'compress@10': 0.0874, 'time@10': 5.8638}:  90%|█████████ | 27/30 [02:01<00:12,  4.06s/it]  {'epoch': 19, 'num_users': 6.0, 'loss': 0.0287, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8695, 'compress@10': 0.0874, 'time@10': 5.8638}:  93%|█████████▎| 28/30 [02:01<00:10,  5.43s/it]{'epoch': 19, 'num_users': 5.8621, 'loss': 0.0283, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.8717, 'compress@10': 0.0863, 'time@10': 5.8601}:  93%|█████████▎| 28/30 [02:04<00:10,  5.43s/it]{'epoch': 19, 'num_users': 5.8621, 'loss': 0.0283, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.8717, 'compress@10': 0.0863, 'time@10': 5.8601}:  97%|█████████▋| 29/30 [02:04<00:04,  4.68s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0285, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8729, 'compress@10': 0.0852, 'time@10': 5.8551}:  97%|█████████▋| 29/30 [02:09<00:04,  4.68s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0285, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8729, 'compress@10': 0.0852, 'time@10': 5.8551}: 100%|██████████| 30/30 [02:09<00:00,  5.00s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0285, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8729, 'compress@10': 0.0852, 'time@10': 5.8551}: 100%|██████████| 30/30 [02:09<00:00,  4.33s/it]
Epoch: 19
Avg # of users: 5.866666666666666
Avg Loss: 0.028545340599969684
Avg hit ratio: 0.8517065282516988
Avg ndcg: 0.8729127938530348
Avg compression ratio: 0.08520984626254458
Avg train time: 5.855103302001953
Std train time: 2.2301176338214646
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 19, 10, 30, 8, 18, 26, 10, 10, 10, 6, 11, 10, 30, 30, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0409, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8779, 'compress@10': 0.0656, 'time@10': 5.1998}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0409, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8779, 'compress@10': 0.0656, 'time@10': 5.1998}:   3%|▎         | 1/30 [00:02<01:16,  2.64s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0341, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8872, 'compress@10': 0.0602, 'time@10': 5.0915}:   3%|▎         | 1/30 [00:07<01:16,  2.64s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0341, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8872, 'compress@10': 0.0602, 'time@10': 5.0915}:   7%|▋         | 2/30 [00:07<01:53,  4.06s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8772, 'compress@10': 0.0933, 'time@10': 4.5234}:   7%|▋         | 2/30 [00:09<01:53,  4.06s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8772, 'compress@10': 0.0933, 'time@10': 4.5234}:  10%|█         | 3/30 [00:09<01:20,  3.00s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0256, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8745, 'compress@10': 0.0833, 'time@10': 4.5001}:  10%|█         | 3/30 [00:13<01:20,  3.00s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0256, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8745, 'compress@10': 0.0833, 'time@10': 4.5001}:  13%|█▎        | 4/30 [00:13<01:33,  3.58s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0351, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8575, 'compress@10': 0.0748, 'time@10': 5.1793}:  13%|█▎        | 4/30 [00:17<01:33,  3.58s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0351, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8575, 'compress@10': 0.0748, 'time@10': 5.1793}:  17%|█▋        | 5/30 [00:17<01:33,  3.73s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0347, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8618, 'compress@10': 0.0688, 'time@10': 5.5261}:  17%|█▋        | 5/30 [00:25<01:33,  3.73s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0347, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8618, 'compress@10': 0.0688, 'time@10': 5.5261}:  20%|██        | 6/30 [00:25<01:58,  4.94s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0342, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8666, 'compress@10': 0.0682, 'time@10': 5.8428}:  20%|██        | 6/30 [00:29<01:58,  4.94s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0342, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8666, 'compress@10': 0.0682, 'time@10': 5.8428}:  23%|██▎       | 7/30 [00:29<01:46,  4.61s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0339, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.8789, 'compress@10': 0.066, 'time@10': 5.8039}:  23%|██▎       | 7/30 [00:34<01:46,  4.61s/it]  {'epoch': 20, 'num_users': 6.125, 'loss': 0.0339, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.8789, 'compress@10': 0.066, 'time@10': 5.8039}:  27%|██▋       | 8/30 [00:34<01:48,  4.92s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.033, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.8867, 'compress@10': 0.063, 'time@10': 6.1338}:  27%|██▋       | 8/30 [00:39<01:48,  4.92s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.033, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.8867, 'compress@10': 0.063, 'time@10': 6.1338}:  30%|███       | 9/30 [00:39<01:40,  4.76s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.8891, 'compress@10': 0.0607, 'time@10': 6.227}:  30%|███       | 9/30 [00:46<01:40,  4.76s/it]  {'epoch': 20, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.8891, 'compress@10': 0.0607, 'time@10': 6.227}:  33%|███▎      | 10/30 [00:46<01:49,  5.49s/it]{'epoch': 20, 'num_users': 6.6364, 'loss': 0.0342, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8892, 'compress@10': 0.0607, 'time@10': 6.4192}:  33%|███▎      | 10/30 [00:50<01:49,  5.49s/it]{'epoch': 20, 'num_users': 6.6364, 'loss': 0.0342, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8892, 'compress@10': 0.0607, 'time@10': 6.4192}:  37%|███▋      | 11/30 [00:50<01:36,  5.10s/it]{'epoch': 20, 'num_users': 6.4167, 'loss': 0.032, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8907, 'compress@10': 0.0642, 'time@10': 6.1765}:  37%|███▋      | 11/30 [00:53<01:36,  5.10s/it] {'epoch': 20, 'num_users': 6.4167, 'loss': 0.032, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8907, 'compress@10': 0.0642, 'time@10': 6.1765}:  40%|████      | 12/30 [00:53<01:23,  4.63s/it]{'epoch': 20, 'num_users': 6.6154, 'loss': 0.0326, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8907, 'compress@10': 0.0645, 'time@10': 6.2635}:  40%|████      | 12/30 [00:57<01:23,  4.63s/it]{'epoch': 20, 'num_users': 6.6154, 'loss': 0.0326, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8907, 'compress@10': 0.0645, 'time@10': 6.2635}:  43%|████▎     | 13/30 [00:57<01:13,  4.34s/it]{'epoch': 20, 'num_users': 6.3571, 'loss': 0.0305, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8858, 'compress@10': 0.073, 'time@10': 6.0003}:  43%|████▎     | 13/30 [01:00<01:13,  4.34s/it] {'epoch': 20, 'num_users': 6.3571, 'loss': 0.0305, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8858, 'compress@10': 0.073, 'time@10': 6.0003}:  47%|████▋     | 14/30 [01:00<01:01,  3.82s/it]{'epoch': 20, 'num_users': 6.2667, 'loss': 0.0309, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8863, 'compress@10': 0.071, 'time@10': 6.1383}:  47%|████▋     | 14/30 [01:04<01:01,  3.82s/it]{'epoch': 20, 'num_users': 6.2667, 'loss': 0.0309, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8863, 'compress@10': 0.071, 'time@10': 6.1383}:  50%|█████     | 15/30 [01:04<00:58,  3.90s/it]{'epoch': 20, 'num_users': 6.0625, 'loss': 0.0294, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.887, 'compress@10': 0.0731, 'time@10': 5.9663}:  50%|█████     | 15/30 [01:07<00:58,  3.90s/it]{'epoch': 20, 'num_users': 6.0625, 'loss': 0.0294, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.887, 'compress@10': 0.0731, 'time@10': 5.9663}:  53%|█████▎    | 16/30 [01:07<00:52,  3.76s/it]{'epoch': 20, 'num_users': 5.8235, 'loss': 0.0279, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8802, 'compress@10': 0.0816, 'time@10': 5.8228}:  53%|█████▎    | 16/30 [01:09<00:52,  3.76s/it]{'epoch': 20, 'num_users': 5.8235, 'loss': 0.0279, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8802, 'compress@10': 0.0816, 'time@10': 5.8228}:  57%|█████▋    | 17/30 [01:09<00:41,  3.17s/it]{'epoch': 20, 'num_users': 6.0556, 'loss': 0.0283, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.88, 'compress@10': 0.0803, 'time@10': 5.7645}:  57%|█████▋    | 17/30 [01:14<00:41,  3.17s/it]  {'epoch': 20, 'num_users': 6.0556, 'loss': 0.0283, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.88, 'compress@10': 0.0803, 'time@10': 5.7645}:  60%|██████    | 18/30 [01:14<00:43,  3.66s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 0.0275, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.881, 'compress@10': 0.0809, 'time@10': 5.7046}:  60%|██████    | 18/30 [01:16<00:43,  3.66s/it]  {'epoch': 20, 'num_users': 6.0, 'loss': 0.0275, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.881, 'compress@10': 0.0809, 'time@10': 5.7046}:  63%|██████▎   | 19/30 [01:16<00:35,  3.27s/it]{'epoch': 20, 'num_users': 6.15, 'loss': 0.0276, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8824, 'compress@10': 0.0787, 'time@10': 5.8881}:  63%|██████▎   | 19/30 [01:26<00:35,  3.27s/it]{'epoch': 20, 'num_users': 6.15, 'loss': 0.0276, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8824, 'compress@10': 0.0787, 'time@10': 5.8881}:  67%|██████▋   | 20/30 [01:26<00:51,  5.12s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.029, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8801, 'compress@10': 0.0774, 'time@10': 6.0018}:  67%|██████▋   | 20/30 [01:30<00:51,  5.12s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.029, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8801, 'compress@10': 0.0774, 'time@10': 6.0018}:  70%|███████   | 21/30 [01:30<00:43,  4.83s/it]{'epoch': 20, 'num_users': 6.1818, 'loss': 0.0297, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8833, 'compress@10': 0.0768, 'time@10': 5.907}:  70%|███████   | 21/30 [01:34<00:43,  4.83s/it] {'epoch': 20, 'num_users': 6.1818, 'loss': 0.0297, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8833, 'compress@10': 0.0768, 'time@10': 5.907}:  73%|███████▎  | 22/30 [01:34<00:36,  4.57s/it]{'epoch': 20, 'num_users': 6.1304, 'loss': 0.0293, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8843, 'compress@10': 0.0764, 'time@10': 5.924}:  73%|███████▎  | 22/30 [01:37<00:36,  4.57s/it]{'epoch': 20, 'num_users': 6.1304, 'loss': 0.0293, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8843, 'compress@10': 0.0764, 'time@10': 5.924}:  77%|███████▋  | 23/30 [01:37<00:29,  4.16s/it]{'epoch': 20, 'num_users': 5.9583, 'loss': 0.0284, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8784, 'compress@10': 0.082, 'time@10': 5.7495}:  77%|███████▋  | 23/30 [01:39<00:29,  4.16s/it]{'epoch': 20, 'num_users': 5.9583, 'loss': 0.0284, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8784, 'compress@10': 0.082, 'time@10': 5.7495}:  80%|████████  | 24/30 [01:39<00:20,  3.45s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0274, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8682, 'compress@10': 0.0925, 'time@10': 5.5892}:  80%|████████  | 24/30 [01:40<00:20,  3.45s/it]  {'epoch': 20, 'num_users': 5.8, 'loss': 0.0274, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8682, 'compress@10': 0.0925, 'time@10': 5.5892}:  83%|████████▎ | 25/30 [01:40<00:13,  2.68s/it]{'epoch': 20, 'num_users': 5.8077, 'loss': 0.0277, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8689, 'compress@10': 0.0899, 'time@10': 5.6649}:  83%|████████▎ | 25/30 [01:47<00:13,  2.68s/it]{'epoch': 20, 'num_users': 5.8077, 'loss': 0.0277, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8689, 'compress@10': 0.0899, 'time@10': 5.6649}:  87%|████████▋ | 26/30 [01:47<00:16,  4.16s/it]{'epoch': 20, 'num_users': 5.8889, 'loss': 0.0275, 'hit_ratio@10': 0.851, 'ndcg@10': 0.8703, 'compress@10': 0.0886, 'time@10': 5.7338}:  87%|████████▋ | 26/30 [01:51<00:16,  4.16s/it] {'epoch': 20, 'num_users': 5.8889, 'loss': 0.0275, 'hit_ratio@10': 0.851, 'ndcg@10': 0.8703, 'compress@10': 0.0886, 'time@10': 5.7338}:  90%|█████████ | 27/30 [01:51<00:12,  4.05s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 0.0277, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.871, 'compress@10': 0.0874, 'time@10': 5.7854}:  90%|█████████ | 27/30 [01:58<00:12,  4.05s/it]   {'epoch': 20, 'num_users': 6.0, 'loss': 0.0277, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.871, 'compress@10': 0.0874, 'time@10': 5.7854}:  93%|█████████▎| 28/30 [01:58<00:10,  5.00s/it]{'epoch': 20, 'num_users': 5.8621, 'loss': 0.0274, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8731, 'compress@10': 0.0864, 'time@10': 5.7801}:  93%|█████████▎| 28/30 [02:01<00:10,  5.00s/it]{'epoch': 20, 'num_users': 5.8621, 'loss': 0.0274, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8731, 'compress@10': 0.0864, 'time@10': 5.7801}:  97%|█████████▋| 29/30 [02:01<00:04,  4.36s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.0277, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8744, 'compress@10': 0.0853, 'time@10': 5.7833}:  97%|█████████▋| 29/30 [02:07<00:04,  4.36s/it] {'epoch': 20, 'num_users': 5.8667, 'loss': 0.0277, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8744, 'compress@10': 0.0853, 'time@10': 5.7833}: 100%|██████████| 30/30 [02:07<00:00,  4.83s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.0277, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8744, 'compress@10': 0.0853, 'time@10': 5.7833}: 100%|██████████| 30/30 [02:07<00:00,  4.25s/it]
Epoch: 20
Avg # of users: 5.866666666666666
Avg Loss: 0.027737772930885574
Avg hit ratio: 0.8570268264879563
Avg ndcg: 0.8743762817893309
Avg compression ratio: 0.08526277779990546
Avg train time: 5.783348639806111
Std train time: 2.130380834775786
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 19, 10, 31, 8, 18, 26, 10, 10, 10, 6, 11, 10, 31, 31, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0404, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8779, 'compress@10': 0.0658, 'time@10': 6.2437}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0404, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8779, 'compress@10': 0.0658, 'time@10': 6.2437}:   3%|▎         | 1/30 [00:03<01:31,  3.16s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0329, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8894, 'compress@10': 0.0606, 'time@10': 5.5536}:   3%|▎         | 1/30 [00:08<01:31,  3.16s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0329, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8894, 'compress@10': 0.0606, 'time@10': 5.5536}:   7%|▋         | 2/30 [00:08<01:57,  4.19s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8786, 'compress@10': 0.0938, 'time@10': 4.9396}:   7%|▋         | 2/30 [00:09<01:57,  4.19s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8786, 'compress@10': 0.0938, 'time@10': 4.9396}:  10%|█         | 3/30 [00:09<01:24,  3.14s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8786, 'compress@10': 0.0836, 'time@10': 4.8154}:  10%|█         | 3/30 [00:14<01:24,  3.14s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8786, 'compress@10': 0.0836, 'time@10': 4.8154}:  13%|█▎        | 4/30 [00:14<01:35,  3.67s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0343, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8605, 'compress@10': 0.075, 'time@10': 5.5505}:  13%|█▎        | 4/30 [00:18<01:35,  3.67s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0343, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8605, 'compress@10': 0.075, 'time@10': 5.5505}:  17%|█▋        | 5/30 [00:18<01:37,  3.90s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0346, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8636, 'compress@10': 0.069, 'time@10': 5.8849}:  17%|█▋        | 5/30 [00:26<01:37,  3.90s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0346, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8636, 'compress@10': 0.069, 'time@10': 5.8849}:  20%|██        | 6/30 [00:26<02:03,  5.15s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0347, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.8671, 'compress@10': 0.0685, 'time@10': 6.1903}:  20%|██        | 6/30 [00:30<02:03,  5.15s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0347, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.8671, 'compress@10': 0.0685, 'time@10': 6.1903}:  23%|██▎       | 7/30 [00:30<01:50,  4.81s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0341, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.8773, 'compress@10': 0.0663, 'time@10': 6.1162}:  23%|██▎       | 7/30 [00:36<01:50,  4.81s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0341, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.8773, 'compress@10': 0.0663, 'time@10': 6.1162}:  27%|██▋       | 8/30 [00:36<01:51,  5.07s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0342, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.8857, 'compress@10': 0.0633, 'time@10': 6.4375}:  27%|██▋       | 8/30 [00:40<01:51,  5.07s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0342, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.8857, 'compress@10': 0.0633, 'time@10': 6.4375}:  30%|███       | 9/30 [00:40<01:43,  4.91s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0333, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.8906, 'compress@10': 0.0611, 'time@10': 6.5079}:  30%|███       | 9/30 [00:47<01:43,  4.91s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0333, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.8906, 'compress@10': 0.0611, 'time@10': 6.5079}:  33%|███▎      | 10/30 [00:47<01:52,  5.61s/it]{'epoch': 21, 'num_users': 6.6364, 'loss': 0.0348, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8903, 'compress@10': 0.0609, 'time@10': 6.8053}:  33%|███▎      | 10/30 [00:52<01:52,  5.61s/it]{'epoch': 21, 'num_users': 6.6364, 'loss': 0.0348, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8903, 'compress@10': 0.0609, 'time@10': 6.8053}:  37%|███▋      | 11/30 [00:52<01:42,  5.40s/it]{'epoch': 21, 'num_users': 6.4167, 'loss': 0.0326, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8918, 'compress@10': 0.0645, 'time@10': 6.5405}:  37%|███▋      | 11/30 [00:56<01:42,  5.40s/it]{'epoch': 21, 'num_users': 6.4167, 'loss': 0.0326, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8918, 'compress@10': 0.0645, 'time@10': 6.5405}:  40%|████      | 12/30 [00:56<01:27,  4.87s/it]{'epoch': 21, 'num_users': 6.6154, 'loss': 0.033, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.8917, 'compress@10': 0.0648, 'time@10': 6.5777}:  40%|████      | 12/30 [00:59<01:27,  4.87s/it] {'epoch': 21, 'num_users': 6.6154, 'loss': 0.033, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.8917, 'compress@10': 0.0648, 'time@10': 6.5777}:  43%|████▎     | 13/30 [00:59<01:16,  4.47s/it]{'epoch': 21, 'num_users': 6.3571, 'loss': 0.0309, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8867, 'compress@10': 0.0733, 'time@10': 6.2902}:  43%|████▎     | 13/30 [01:02<01:16,  4.47s/it]{'epoch': 21, 'num_users': 6.3571, 'loss': 0.0309, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8867, 'compress@10': 0.0733, 'time@10': 6.2902}:  47%|████▋     | 14/30 [01:02<01:02,  3.91s/it]{'epoch': 21, 'num_users': 6.2667, 'loss': 0.0312, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.8872, 'compress@10': 0.0713, 'time@10': 6.4317}:  47%|████▋     | 14/30 [01:06<01:02,  3.91s/it]{'epoch': 21, 'num_users': 6.2667, 'loss': 0.0312, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.8872, 'compress@10': 0.0713, 'time@10': 6.4317}:  50%|█████     | 15/30 [01:06<01:00,  4.01s/it]{'epoch': 21, 'num_users': 6.0625, 'loss': 0.0297, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8881, 'compress@10': 0.0733, 'time@10': 6.233}:  50%|█████     | 15/30 [01:10<01:00,  4.01s/it] {'epoch': 21, 'num_users': 6.0625, 'loss': 0.0297, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8881, 'compress@10': 0.0733, 'time@10': 6.233}:  53%|█████▎    | 16/30 [01:10<00:53,  3.79s/it]{'epoch': 21, 'num_users': 5.8235, 'loss': 0.0281, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8812, 'compress@10': 0.0818, 'time@10': 6.0662}:  53%|█████▎    | 16/30 [01:11<00:53,  3.79s/it]{'epoch': 21, 'num_users': 5.8235, 'loss': 0.0281, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8812, 'compress@10': 0.0818, 'time@10': 6.0662}:  57%|█████▋    | 17/30 [01:11<00:41,  3.18s/it]{'epoch': 21, 'num_users': 6.0556, 'loss': 0.0284, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8816, 'compress@10': 0.0805, 'time@10': 5.9647}:  57%|█████▋    | 17/30 [01:16<00:41,  3.18s/it] {'epoch': 21, 'num_users': 6.0556, 'loss': 0.0284, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8816, 'compress@10': 0.0805, 'time@10': 5.9647}:  60%|██████    | 18/30 [01:16<00:42,  3.51s/it]{'epoch': 21, 'num_users': 6.0, 'loss': 0.0276, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8825, 'compress@10': 0.0811, 'time@10': 5.8462}:  60%|██████    | 18/30 [01:17<00:42,  3.51s/it]  {'epoch': 21, 'num_users': 6.0, 'loss': 0.0276, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8825, 'compress@10': 0.0811, 'time@10': 5.8462}:  63%|██████▎   | 19/30 [01:17<00:33,  3.02s/it]{'epoch': 21, 'num_users': 6.15, 'loss': 0.0277, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8841, 'compress@10': 0.0789, 'time@10': 6.0166}:  63%|██████▎   | 19/30 [01:27<00:33,  3.02s/it]{'epoch': 21, 'num_users': 6.15, 'loss': 0.0277, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8841, 'compress@10': 0.0789, 'time@10': 6.0166}:  67%|██████▋   | 20/30 [01:27<00:49,  4.91s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.029, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8824, 'compress@10': 0.0776, 'time@10': 6.1026}:  67%|██████▋   | 20/30 [01:31<00:49,  4.91s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.029, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8824, 'compress@10': 0.0776, 'time@10': 6.1026}:  70%|███████   | 21/30 [01:31<00:41,  4.62s/it]{'epoch': 21, 'num_users': 6.1818, 'loss': 0.0297, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8833, 'compress@10': 0.0769, 'time@10': 5.9995}:  70%|███████   | 21/30 [01:35<00:41,  4.62s/it]{'epoch': 21, 'num_users': 6.1818, 'loss': 0.0297, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8833, 'compress@10': 0.0769, 'time@10': 5.9995}:  73%|███████▎  | 22/30 [01:35<00:35,  4.40s/it]{'epoch': 21, 'num_users': 6.1304, 'loss': 0.0293, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8845, 'compress@10': 0.0765, 'time@10': 5.9876}:  73%|███████▎  | 22/30 [01:38<00:35,  4.40s/it]{'epoch': 21, 'num_users': 6.1304, 'loss': 0.0293, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8845, 'compress@10': 0.0765, 'time@10': 5.9876}:  77%|███████▋  | 23/30 [01:38<00:27,  3.95s/it]{'epoch': 21, 'num_users': 5.9583, 'loss': 0.0283, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8787, 'compress@10': 0.0821, 'time@10': 5.8114}:  77%|███████▋  | 23/30 [01:39<00:27,  3.95s/it]{'epoch': 21, 'num_users': 5.9583, 'loss': 0.0283, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8787, 'compress@10': 0.0821, 'time@10': 5.8114}:  80%|████████  | 24/30 [01:39<00:19,  3.30s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0273, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8684, 'compress@10': 0.0926, 'time@10': 5.6523}:  80%|████████  | 24/30 [01:40<00:19,  3.30s/it]   {'epoch': 21, 'num_users': 5.8, 'loss': 0.0273, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8684, 'compress@10': 0.0926, 'time@10': 5.6523}:  83%|████████▎ | 25/30 [01:40<00:13,  2.60s/it]{'epoch': 21, 'num_users': 5.8077, 'loss': 0.0275, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8693, 'compress@10': 0.0901, 'time@10': 5.7238}:  83%|████████▎ | 25/30 [01:48<00:13,  2.60s/it]{'epoch': 21, 'num_users': 5.8077, 'loss': 0.0275, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8693, 'compress@10': 0.0901, 'time@10': 5.7238}:  87%|████████▋ | 26/30 [01:48<00:16,  4.09s/it]{'epoch': 21, 'num_users': 5.8889, 'loss': 0.0273, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8702, 'compress@10': 0.0891, 'time@10': 5.7803}:  87%|████████▋ | 26/30 [01:52<00:16,  4.09s/it]{'epoch': 21, 'num_users': 5.8889, 'loss': 0.0273, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8702, 'compress@10': 0.0891, 'time@10': 5.7803}:  90%|█████████ | 27/30 [01:52<00:11,  3.96s/it]{'epoch': 21, 'num_users': 6.0, 'loss': 0.0278, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8707, 'compress@10': 0.0878, 'time@10': 5.8626}:  90%|█████████ | 27/30 [02:00<00:11,  3.96s/it]   {'epoch': 21, 'num_users': 6.0, 'loss': 0.0278, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8707, 'compress@10': 0.0878, 'time@10': 5.8626}:  93%|█████████▎| 28/30 [02:00<00:10,  5.21s/it]{'epoch': 21, 'num_users': 5.8621, 'loss': 0.0275, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8728, 'compress@10': 0.0868, 'time@10': 5.856}:  93%|█████████▎| 28/30 [02:03<00:10,  5.21s/it]{'epoch': 21, 'num_users': 5.8621, 'loss': 0.0275, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8728, 'compress@10': 0.0868, 'time@10': 5.856}:  97%|█████████▋| 29/30 [02:03<00:04,  4.51s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0278, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8735, 'compress@10': 0.0857, 'time@10': 5.8514}:  97%|█████████▋| 29/30 [02:08<00:04,  4.51s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0278, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8735, 'compress@10': 0.0857, 'time@10': 5.8514}: 100%|██████████| 30/30 [02:08<00:00,  4.88s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0278, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8735, 'compress@10': 0.0857, 'time@10': 5.8514}: 100%|██████████| 30/30 [02:08<00:00,  4.29s/it]
Epoch: 21
Avg # of users: 5.866666666666666
Avg Loss: 0.027768270937349782
Avg hit ratio: 0.8608886944674713
Avg ndcg: 0.8735002234029128
Avg compression ratio: 0.08570877879745244
Avg train time: 5.8513800462087
Std train time: 2.2751432075491453
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 32, 8, 18, 26, 10, 10, 10, 6, 11, 10, 32, 32, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8802, 'compress@10': 0.0659, 'time@10': 6.3756}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8802, 'compress@10': 0.0659, 'time@10': 6.3756}:   3%|▎         | 1/30 [00:03<01:33,  3.23s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8907, 'compress@10': 0.061, 'time@10': 5.684}:   3%|▎         | 1/30 [00:08<01:33,  3.23s/it]   {'epoch': 22, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8907, 'compress@10': 0.061, 'time@10': 5.684}:   7%|▋         | 2/30 [00:08<02:00,  4.29s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8795, 'compress@10': 0.0943, 'time@10': 4.9114}:   7%|▋         | 2/30 [00:10<02:00,  4.29s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8795, 'compress@10': 0.0943, 'time@10': 4.9114}:  10%|█         | 3/30 [00:10<01:24,  3.14s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8772, 'compress@10': 0.0839, 'time@10': 4.8039}:  10%|█         | 3/30 [00:14<01:24,  3.14s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8772, 'compress@10': 0.0839, 'time@10': 4.8039}:  13%|█▎        | 4/30 [00:14<01:35,  3.68s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0347, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8595, 'compress@10': 0.0752, 'time@10': 5.4741}:  13%|█▎        | 4/30 [00:18<01:35,  3.68s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0347, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8595, 'compress@10': 0.0752, 'time@10': 5.4741}:  17%|█▋        | 5/30 [00:18<01:36,  3.84s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0345, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.865, 'compress@10': 0.0691, 'time@10': 5.7547}:  17%|█▋        | 5/30 [00:25<01:36,  3.84s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0345, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.865, 'compress@10': 0.0691, 'time@10': 5.7547}:  20%|██        | 6/30 [00:25<01:59,  4.98s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.8695, 'compress@10': 0.0688, 'time@10': 6.0672}:  20%|██        | 6/30 [00:29<01:59,  4.98s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.8695, 'compress@10': 0.0688, 'time@10': 6.0672}:  23%|██▎       | 7/30 [00:29<01:47,  4.66s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0328, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.8773, 'compress@10': 0.0666, 'time@10': 6.0126}:  23%|██▎       | 7/30 [00:35<01:47,  4.66s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0328, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.8773, 'compress@10': 0.0666, 'time@10': 6.0126}:  27%|██▋       | 8/30 [00:35<01:49,  4.99s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.033, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.8849, 'compress@10': 0.0636, 'time@10': 6.3408}:  27%|██▋       | 8/30 [00:40<01:49,  4.99s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.033, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.8849, 'compress@10': 0.0636, 'time@10': 6.3408}:  30%|███       | 9/30 [00:40<01:41,  4.84s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.8878, 'compress@10': 0.0613, 'time@10': 6.4135}:  30%|███       | 9/30 [00:47<01:41,  4.84s/it]  {'epoch': 22, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.8878, 'compress@10': 0.0613, 'time@10': 6.4135}:  33%|███▎      | 10/30 [00:47<01:50,  5.54s/it]{'epoch': 22, 'num_users': 6.6364, 'loss': 0.0335, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.887, 'compress@10': 0.0608, 'time@10': 6.5153}:  33%|███▎      | 10/30 [00:50<01:50,  5.54s/it]{'epoch': 22, 'num_users': 6.6364, 'loss': 0.0335, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.887, 'compress@10': 0.0608, 'time@10': 6.5153}:  37%|███▋      | 11/30 [00:50<01:35,  5.01s/it]{'epoch': 22, 'num_users': 6.4167, 'loss': 0.0313, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8887, 'compress@10': 0.0644, 'time@10': 6.2533}:  37%|███▋      | 11/30 [00:54<01:35,  5.01s/it]{'epoch': 22, 'num_users': 6.4167, 'loss': 0.0313, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8887, 'compress@10': 0.0644, 'time@10': 6.2533}:  40%|████      | 12/30 [00:54<01:21,  4.52s/it]{'epoch': 22, 'num_users': 6.6154, 'loss': 0.0319, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8889, 'compress@10': 0.0648, 'time@10': 6.2912}:  40%|████      | 12/30 [00:57<01:21,  4.52s/it]{'epoch': 22, 'num_users': 6.6154, 'loss': 0.0319, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8889, 'compress@10': 0.0648, 'time@10': 6.2912}:  43%|████▎     | 13/30 [00:57<01:11,  4.19s/it]{'epoch': 22, 'num_users': 6.3571, 'loss': 0.0299, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8841, 'compress@10': 0.0732, 'time@10': 6.028}:  43%|████▎     | 13/30 [01:00<01:11,  4.19s/it] {'epoch': 22, 'num_users': 6.3571, 'loss': 0.0299, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8841, 'compress@10': 0.0732, 'time@10': 6.028}:  47%|████▋     | 14/30 [01:00<00:59,  3.72s/it]{'epoch': 22, 'num_users': 6.2667, 'loss': 0.0303, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8843, 'compress@10': 0.0712, 'time@10': 6.1531}:  47%|████▋     | 14/30 [01:04<00:59,  3.72s/it]{'epoch': 22, 'num_users': 6.2667, 'loss': 0.0303, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8843, 'compress@10': 0.0712, 'time@10': 6.1531}:  50%|█████     | 15/30 [01:04<00:57,  3.80s/it]{'epoch': 22, 'num_users': 6.0625, 'loss': 0.0288, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8856, 'compress@10': 0.0733, 'time@10': 5.9716}:  50%|█████     | 15/30 [01:07<00:57,  3.80s/it]{'epoch': 22, 'num_users': 6.0625, 'loss': 0.0288, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8856, 'compress@10': 0.0733, 'time@10': 5.9716}:  53%|█████▎    | 16/30 [01:07<00:51,  3.65s/it]{'epoch': 22, 'num_users': 5.8235, 'loss': 0.0272, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8788, 'compress@10': 0.0818, 'time@10': 5.8212}:  53%|█████▎    | 16/30 [01:09<00:51,  3.65s/it]{'epoch': 22, 'num_users': 5.8235, 'loss': 0.0272, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8788, 'compress@10': 0.0818, 'time@10': 5.8212}:  57%|█████▋    | 17/30 [01:09<00:40,  3.08s/it]{'epoch': 22, 'num_users': 6.0556, 'loss': 0.0275, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8794, 'compress@10': 0.0805, 'time@10': 5.7303}:  57%|█████▋    | 17/30 [01:13<00:40,  3.08s/it]{'epoch': 22, 'num_users': 6.0556, 'loss': 0.0275, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8794, 'compress@10': 0.0805, 'time@10': 5.7303}:  60%|██████    | 18/30 [01:13<00:41,  3.42s/it]{'epoch': 22, 'num_users': 6.0, 'loss': 0.0267, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8802, 'compress@10': 0.0811, 'time@10': 5.6314}:  60%|██████    | 18/30 [01:15<00:41,  3.42s/it]   {'epoch': 22, 'num_users': 6.0, 'loss': 0.0267, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8802, 'compress@10': 0.0811, 'time@10': 5.6314}:  63%|██████▎   | 19/30 [01:15<00:32,  2.99s/it]{'epoch': 22, 'num_users': 6.15, 'loss': 0.0267, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8818, 'compress@10': 0.0789, 'time@10': 5.8291}:  63%|██████▎   | 19/30 [01:25<00:32,  2.99s/it]{'epoch': 22, 'num_users': 6.15, 'loss': 0.0267, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8818, 'compress@10': 0.0789, 'time@10': 5.8291}:  67%|██████▋   | 20/30 [01:25<00:49,  4.99s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0282, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8795, 'compress@10': 0.0776, 'time@10': 5.9653}:  67%|██████▋   | 20/30 [01:29<00:49,  4.99s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0282, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8795, 'compress@10': 0.0776, 'time@10': 5.9653}:  70%|███████   | 21/30 [01:29<00:43,  4.81s/it]{'epoch': 22, 'num_users': 6.1818, 'loss': 0.0286, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8806, 'compress@10': 0.0768, 'time@10': 5.8685}:  70%|███████   | 21/30 [01:33<00:43,  4.81s/it]{'epoch': 22, 'num_users': 6.1818, 'loss': 0.0286, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8806, 'compress@10': 0.0768, 'time@10': 5.8685}:  73%|███████▎  | 22/30 [01:33<00:36,  4.53s/it]{'epoch': 22, 'num_users': 6.1304, 'loss': 0.0282, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8819, 'compress@10': 0.0764, 'time@10': 5.8601}:  73%|███████▎  | 22/30 [01:36<00:36,  4.53s/it]{'epoch': 22, 'num_users': 6.1304, 'loss': 0.0282, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8819, 'compress@10': 0.0764, 'time@10': 5.8601}:  77%|███████▋  | 23/30 [01:36<00:28,  4.03s/it]{'epoch': 22, 'num_users': 5.9583, 'loss': 0.0273, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8762, 'compress@10': 0.082, 'time@10': 5.6939}:  77%|███████▋  | 23/30 [01:38<00:28,  4.03s/it] {'epoch': 22, 'num_users': 5.9583, 'loss': 0.0273, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8762, 'compress@10': 0.082, 'time@10': 5.6939}:  80%|████████  | 24/30 [01:38<00:20,  3.40s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0263, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.866, 'compress@10': 0.0926, 'time@10': 5.5512}:  80%|████████  | 24/30 [01:39<00:20,  3.40s/it]   {'epoch': 22, 'num_users': 5.8, 'loss': 0.0263, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.866, 'compress@10': 0.0926, 'time@10': 5.5512}:  83%|████████▎ | 25/30 [01:39<00:13,  2.71s/it]{'epoch': 22, 'num_users': 5.8077, 'loss': 0.0265, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.8673, 'compress@10': 0.09, 'time@10': 5.6246}:  83%|████████▎ | 25/30 [01:46<00:13,  2.71s/it]{'epoch': 22, 'num_users': 5.8077, 'loss': 0.0265, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.8673, 'compress@10': 0.09, 'time@10': 5.6246}:  87%|████████▋ | 26/30 [01:46<00:16,  4.15s/it]{'epoch': 22, 'num_users': 5.8889, 'loss': 0.0265, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.8694, 'compress@10': 0.0887, 'time@10': 5.7095}:  87%|████████▋ | 26/30 [01:51<00:16,  4.15s/it]{'epoch': 22, 'num_users': 5.8889, 'loss': 0.0265, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.8694, 'compress@10': 0.0887, 'time@10': 5.7095}:  90%|█████████ | 27/30 [01:51<00:12,  4.11s/it]{'epoch': 22, 'num_users': 6.0, 'loss': 0.0267, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8708, 'compress@10': 0.0874, 'time@10': 5.7911}:  90%|█████████ | 27/30 [01:59<00:12,  4.11s/it]   {'epoch': 22, 'num_users': 6.0, 'loss': 0.0267, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8708, 'compress@10': 0.0874, 'time@10': 5.7911}:  93%|█████████▎| 28/30 [01:59<00:10,  5.28s/it]{'epoch': 22, 'num_users': 5.8621, 'loss': 0.0263, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8727, 'compress@10': 0.0864, 'time@10': 5.7849}:  93%|█████████▎| 28/30 [02:01<00:10,  5.28s/it]{'epoch': 22, 'num_users': 5.8621, 'loss': 0.0263, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8727, 'compress@10': 0.0864, 'time@10': 5.7849}:  97%|█████████▋| 29/30 [02:01<00:04,  4.55s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0266, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8734, 'compress@10': 0.0853, 'time@10': 5.8037}:  97%|█████████▋| 29/30 [02:08<00:04,  4.55s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0266, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8734, 'compress@10': 0.0853, 'time@10': 5.8037}: 100%|██████████| 30/30 [02:08<00:00,  5.10s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0266, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8734, 'compress@10': 0.0853, 'time@10': 5.8037}: 100%|██████████| 30/30 [02:08<00:00,  4.28s/it]
Epoch: 22
Avg # of users: 5.866666666666666
Avg Loss: 0.026578144962075254
Avg hit ratio: 0.8582994536429366
Avg ndcg: 0.8733909259191831
Avg compression ratio: 0.08530128028296774
Avg train time: 5.8037140528361
Std train time: 2.1845829551765763
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 33, 8, 18, 26, 10, 10, 9, 6, 11, 10, 33, 33, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8802, 'compress@10': 0.0662, 'time@10': 5.9976}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8802, 'compress@10': 0.0662, 'time@10': 5.9976}:   3%|▎         | 1/30 [00:03<01:28,  3.06s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8933, 'compress@10': 0.0616, 'time@10': 5.6561}:   3%|▎         | 1/30 [00:08<01:28,  3.06s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8933, 'compress@10': 0.0616, 'time@10': 5.6561}:   7%|▋         | 2/30 [00:08<02:03,  4.41s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8812, 'compress@10': 0.0948, 'time@10': 4.9213}:   7%|▋         | 2/30 [00:10<02:03,  4.41s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8812, 'compress@10': 0.0948, 'time@10': 4.9213}:  10%|█         | 3/30 [00:10<01:26,  3.20s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8694, 'compress@10': 0.0845, 'time@10': 4.8105}:  10%|█         | 3/30 [00:14<01:26,  3.20s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8694, 'compress@10': 0.0845, 'time@10': 4.8105}:  13%|█▎        | 4/30 [00:14<01:36,  3.72s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.034, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.853, 'compress@10': 0.0758, 'time@10': 5.4791}:  13%|█▎        | 4/30 [00:18<01:36,  3.72s/it]  {'epoch': 23, 'num_users': 5.8, 'loss': 0.034, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.853, 'compress@10': 0.0758, 'time@10': 5.4791}:  17%|█▋        | 5/30 [00:18<01:36,  3.86s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0329, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8608, 'compress@10': 0.0697, 'time@10': 5.7668}:  17%|█▋        | 5/30 [00:26<01:36,  3.86s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0329, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8608, 'compress@10': 0.0697, 'time@10': 5.7668}:  20%|██        | 6/30 [00:26<02:00,  5.01s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0321, 'hit_ratio@10': 0.881, 'ndcg@10': 0.8685, 'compress@10': 0.0695, 'time@10': 6.0706}:  20%|██        | 6/30 [00:30<02:00,  5.01s/it] {'epoch': 23, 'num_users': 6.2857, 'loss': 0.0321, 'hit_ratio@10': 0.881, 'ndcg@10': 0.8685, 'compress@10': 0.0695, 'time@10': 6.0706}:  23%|██▎       | 7/30 [00:30<01:47,  4.68s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0317, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.8762, 'compress@10': 0.0672, 'time@10': 6.0058}:  23%|██▎       | 7/30 [00:35<01:47,  4.68s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0317, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.8762, 'compress@10': 0.0672, 'time@10': 6.0058}:  27%|██▋       | 8/30 [00:35<01:49,  4.97s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0318, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8839, 'compress@10': 0.0643, 'time@10': 6.3219}:  27%|██▋       | 8/30 [00:40<01:49,  4.97s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0318, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8839, 'compress@10': 0.0643, 'time@10': 6.3219}:  30%|███       | 9/30 [00:40<01:41,  4.81s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.8904, 'compress@10': 0.062, 'time@10': 6.3996}:  30%|███       | 9/30 [00:47<01:41,  4.81s/it]     {'epoch': 23, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.8904, 'compress@10': 0.062, 'time@10': 6.3996}:  33%|███▎      | 10/30 [00:47<01:50,  5.53s/it]{'epoch': 23, 'num_users': 6.6364, 'loss': 0.0329, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.8886, 'compress@10': 0.0614, 'time@10': 6.4798}:  33%|███▎      | 10/30 [00:50<01:50,  5.53s/it]{'epoch': 23, 'num_users': 6.6364, 'loss': 0.0329, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.8886, 'compress@10': 0.0614, 'time@10': 6.4798}:  37%|███▋      | 11/30 [00:50<01:34,  4.96s/it]{'epoch': 23, 'num_users': 6.4167, 'loss': 0.0307, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8904, 'compress@10': 0.065, 'time@10': 6.2206}:  37%|███▋      | 11/30 [00:54<01:34,  4.96s/it] {'epoch': 23, 'num_users': 6.4167, 'loss': 0.0307, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8904, 'compress@10': 0.065, 'time@10': 6.2206}:  40%|████      | 12/30 [00:54<01:20,  4.49s/it]{'epoch': 23, 'num_users': 6.6154, 'loss': 0.0312, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8904, 'compress@10': 0.0654, 'time@10': 6.281}:  40%|████      | 12/30 [00:57<01:20,  4.49s/it]{'epoch': 23, 'num_users': 6.6154, 'loss': 0.0312, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8904, 'compress@10': 0.0654, 'time@10': 6.281}:  43%|████▎     | 13/30 [00:57<01:11,  4.21s/it]{'epoch': 23, 'num_users': 6.3571, 'loss': 0.0292, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8855, 'compress@10': 0.0738, 'time@10': 6.0268}:  43%|████▎     | 13/30 [01:00<01:11,  4.21s/it]{'epoch': 23, 'num_users': 6.3571, 'loss': 0.0292, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8855, 'compress@10': 0.0738, 'time@10': 6.0268}:  47%|████▋     | 14/30 [01:00<01:00,  3.77s/it]{'epoch': 23, 'num_users': 6.2667, 'loss': 0.0293, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.887, 'compress@10': 0.0718, 'time@10': 6.1539}:  47%|████▋     | 14/30 [01:04<01:00,  3.77s/it] {'epoch': 23, 'num_users': 6.2667, 'loss': 0.0293, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.887, 'compress@10': 0.0718, 'time@10': 6.1539}:  50%|█████     | 15/30 [01:04<00:57,  3.84s/it]{'epoch': 23, 'num_users': 6.0625, 'loss': 0.0278, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8881, 'compress@10': 0.0739, 'time@10': 5.9732}:  50%|█████     | 15/30 [01:07<00:57,  3.84s/it]{'epoch': 23, 'num_users': 6.0625, 'loss': 0.0278, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8881, 'compress@10': 0.0739, 'time@10': 5.9732}:  53%|█████▎    | 16/30 [01:07<00:51,  3.68s/it]{'epoch': 23, 'num_users': 5.8235, 'loss': 0.0264, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8812, 'compress@10': 0.0824, 'time@10': 5.8191}:  53%|█████▎    | 16/30 [01:09<00:51,  3.68s/it] {'epoch': 23, 'num_users': 5.8235, 'loss': 0.0264, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8812, 'compress@10': 0.0824, 'time@10': 5.8191}:  57%|█████▋    | 17/30 [01:09<00:40,  3.09s/it]{'epoch': 23, 'num_users': 6.0556, 'loss': 0.0265, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8819, 'compress@10': 0.081, 'time@10': 5.7205}:  57%|█████▋    | 17/30 [01:13<00:40,  3.09s/it]{'epoch': 23, 'num_users': 6.0556, 'loss': 0.0265, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8819, 'compress@10': 0.081, 'time@10': 5.7205}:  60%|██████    | 18/30 [01:13<00:40,  3.39s/it]{'epoch': 23, 'num_users': 6.0, 'loss': 0.0258, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8832, 'compress@10': 0.0816, 'time@10': 5.6412}:  60%|██████    | 18/30 [01:15<00:40,  3.39s/it]  {'epoch': 23, 'num_users': 6.0, 'loss': 0.0258, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8832, 'compress@10': 0.0816, 'time@10': 5.6412}:  63%|██████▎   | 19/30 [01:15<00:33,  3.02s/it]{'epoch': 23, 'num_users': 6.15, 'loss': 0.0259, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.884, 'compress@10': 0.0794, 'time@10': 5.7786}:  63%|██████▎   | 19/30 [01:24<00:33,  3.02s/it]{'epoch': 23, 'num_users': 6.15, 'loss': 0.0259, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.884, 'compress@10': 0.0794, 'time@10': 5.7786}:  67%|██████▋   | 20/30 [01:24<00:46,  4.64s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0271, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8821, 'compress@10': 0.0781, 'time@10': 5.8778}:  67%|██████▋   | 20/30 [01:28<00:46,  4.64s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0271, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8821, 'compress@10': 0.0781, 'time@10': 5.8778}:  70%|███████   | 21/30 [01:28<00:39,  4.44s/it]{'epoch': 23, 'num_users': 6.1818, 'loss': 0.0276, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8838, 'compress@10': 0.0774, 'time@10': 5.7838}:  70%|███████   | 21/30 [01:32<00:39,  4.44s/it]{'epoch': 23, 'num_users': 6.1818, 'loss': 0.0276, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8838, 'compress@10': 0.0774, 'time@10': 5.7838}:  73%|███████▎  | 22/30 [01:32<00:34,  4.26s/it]{'epoch': 23, 'num_users': 6.1304, 'loss': 0.0273, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.885, 'compress@10': 0.077, 'time@10': 5.7792}:  73%|███████▎  | 22/30 [01:35<00:34,  4.26s/it]  {'epoch': 23, 'num_users': 6.1304, 'loss': 0.0273, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.885, 'compress@10': 0.077, 'time@10': 5.7792}:  77%|███████▋  | 23/30 [01:35<00:26,  3.85s/it]{'epoch': 23, 'num_users': 5.9583, 'loss': 0.0263, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8791, 'compress@10': 0.0826, 'time@10': 5.6183}:  77%|███████▋  | 23/30 [01:36<00:26,  3.85s/it]{'epoch': 23, 'num_users': 5.9583, 'loss': 0.0263, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8791, 'compress@10': 0.0826, 'time@10': 5.6183}:  80%|████████  | 24/30 [01:36<00:19,  3.28s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0254, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8699, 'compress@10': 0.0931, 'time@10': 5.4767}:  80%|████████  | 24/30 [01:38<00:19,  3.28s/it]   {'epoch': 23, 'num_users': 5.8, 'loss': 0.0254, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8699, 'compress@10': 0.0931, 'time@10': 5.4767}:  83%|████████▎ | 25/30 [01:38<00:13,  2.62s/it]{'epoch': 23, 'num_users': 5.8077, 'loss': 0.0255, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8714, 'compress@10': 0.0905, 'time@10': 5.5588}:  83%|████████▎ | 25/30 [01:45<00:13,  2.62s/it]{'epoch': 23, 'num_users': 5.8077, 'loss': 0.0255, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8714, 'compress@10': 0.0905, 'time@10': 5.5588}:  87%|████████▋ | 26/30 [01:45<00:16,  4.13s/it]{'epoch': 23, 'num_users': 5.8889, 'loss': 0.0253, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8724, 'compress@10': 0.0893, 'time@10': 5.6409}:  87%|████████▋ | 26/30 [01:49<00:16,  4.13s/it]{'epoch': 23, 'num_users': 5.8889, 'loss': 0.0253, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8724, 'compress@10': 0.0893, 'time@10': 5.6409}:  90%|█████████ | 27/30 [01:49<00:12,  4.07s/it]{'epoch': 23, 'num_users': 6.0, 'loss': 0.0254, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8742, 'compress@10': 0.0879, 'time@10': 5.7441}:  90%|█████████ | 27/30 [01:58<00:12,  4.07s/it]   {'epoch': 23, 'num_users': 6.0, 'loss': 0.0254, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8742, 'compress@10': 0.0879, 'time@10': 5.7441}:  93%|█████████▎| 28/30 [01:58<00:10,  5.42s/it]{'epoch': 23, 'num_users': 5.8621, 'loss': 0.0251, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8759, 'compress@10': 0.0869, 'time@10': 5.758}:  93%|█████████▎| 28/30 [02:01<00:10,  5.42s/it]{'epoch': 23, 'num_users': 5.8621, 'loss': 0.0251, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8759, 'compress@10': 0.0869, 'time@10': 5.758}:  97%|█████████▋| 29/30 [02:01<00:04,  4.73s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0254, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8766, 'compress@10': 0.0858, 'time@10': 5.7481}:  97%|█████████▋| 29/30 [02:06<00:04,  4.73s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0254, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8766, 'compress@10': 0.0858, 'time@10': 5.7481}: 100%|██████████| 30/30 [02:06<00:00,  4.96s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0254, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8766, 'compress@10': 0.0858, 'time@10': 5.7481}: 100%|██████████| 30/30 [02:06<00:00,  4.23s/it]
Epoch: 23
Avg # of users: 5.866666666666666
Avg Loss: 0.02538116243065473
Avg hit ratio: 0.8589395507960593
Avg ndcg: 0.8765656833945311
Avg compression ratio: 0.08580884890775113
Avg train time: 5.7481256802876795
Std train time: 2.087693167846568
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 34, 8, 18, 26, 10, 10, 9, 6, 11, 10, 34, 34, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8815, 'compress@10': 0.0665, 'time@10': 6.1491}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8815, 'compress@10': 0.0665, 'time@10': 6.1491}:   3%|▎         | 1/30 [00:03<01:32,  3.18s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8948, 'compress@10': 0.0622, 'time@10': 5.5813}:   3%|▎         | 1/30 [00:08<01:32,  3.18s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8948, 'compress@10': 0.0622, 'time@10': 5.5813}:   7%|▋         | 2/30 [00:08<01:59,  4.29s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8823, 'compress@10': 0.0953, 'time@10': 4.8476}:   7%|▋         | 2/30 [00:09<01:59,  4.29s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8823, 'compress@10': 0.0953, 'time@10': 4.8476}:  10%|█         | 3/30 [00:09<01:24,  3.12s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8796, 'compress@10': 0.085, 'time@10': 4.7986}:  10%|█         | 3/30 [00:14<01:24,  3.12s/it]  {'epoch': 24, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8796, 'compress@10': 0.085, 'time@10': 4.7986}:  13%|█▎        | 4/30 [00:14<01:37,  3.74s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0316, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8613, 'compress@10': 0.0762, 'time@10': 5.5546}:  13%|█▎        | 4/30 [00:19<01:37,  3.74s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0316, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8613, 'compress@10': 0.0762, 'time@10': 5.5546}:  17%|█▋        | 5/30 [00:19<01:38,  3.96s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0312, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8677, 'compress@10': 0.0701, 'time@10': 5.843}:  17%|█▋        | 5/30 [00:26<01:38,  3.96s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0312, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8677, 'compress@10': 0.0701, 'time@10': 5.843}:  20%|██        | 6/30 [00:26<02:02,  5.10s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0314, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8725, 'compress@10': 0.0699, 'time@10': 6.1854}:  20%|██        | 6/30 [00:30<02:02,  5.10s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0314, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8725, 'compress@10': 0.0699, 'time@10': 6.1854}:  23%|██▎       | 7/30 [00:30<01:50,  4.79s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0312, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.8827, 'compress@10': 0.0676, 'time@10': 6.1113}:  23%|██▎       | 7/30 [00:36<01:50,  4.79s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0312, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.8827, 'compress@10': 0.0676, 'time@10': 6.1113}:  27%|██▋       | 8/30 [00:36<01:51,  5.06s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0312, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.8902, 'compress@10': 0.0646, 'time@10': 6.4499}:  27%|██▋       | 8/30 [00:40<01:51,  5.06s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0312, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.8902, 'compress@10': 0.0646, 'time@10': 6.4499}:  30%|███       | 9/30 [00:40<01:43,  4.92s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0308, 'hit_ratio@10': 0.892, 'ndcg@10': 0.8943, 'compress@10': 0.0622, 'time@10': 6.5149}:  30%|███       | 9/30 [00:47<01:43,  4.92s/it]    {'epoch': 24, 'num_users': 6.3, 'loss': 0.0308, 'hit_ratio@10': 0.892, 'ndcg@10': 0.8943, 'compress@10': 0.0622, 'time@10': 6.5149}:  33%|███▎      | 10/30 [00:47<01:52,  5.61s/it]{'epoch': 24, 'num_users': 6.6364, 'loss': 0.0328, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.8923, 'compress@10': 0.0615, 'time@10': 6.5886}:  33%|███▎      | 10/30 [00:51<01:52,  5.61s/it]{'epoch': 24, 'num_users': 6.6364, 'loss': 0.0328, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.8923, 'compress@10': 0.0615, 'time@10': 6.5886}:  37%|███▋      | 11/30 [00:51<01:35,  5.03s/it]{'epoch': 24, 'num_users': 6.4167, 'loss': 0.0306, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8943, 'compress@10': 0.0651, 'time@10': 6.3488}:  37%|███▋      | 11/30 [00:55<01:35,  5.03s/it]{'epoch': 24, 'num_users': 6.4167, 'loss': 0.0306, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8943, 'compress@10': 0.0651, 'time@10': 6.3488}:  40%|████      | 12/30 [00:55<01:23,  4.65s/it]{'epoch': 24, 'num_users': 6.6154, 'loss': 0.0311, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.894, 'compress@10': 0.0656, 'time@10': 6.4044}:  40%|████      | 12/30 [00:58<01:23,  4.65s/it] {'epoch': 24, 'num_users': 6.6154, 'loss': 0.0311, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.894, 'compress@10': 0.0656, 'time@10': 6.4044}:  43%|████▎     | 13/30 [00:58<01:13,  4.32s/it]{'epoch': 24, 'num_users': 6.3571, 'loss': 0.0291, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8889, 'compress@10': 0.0739, 'time@10': 6.1492}:  43%|████▎     | 13/30 [01:01<01:13,  4.32s/it]{'epoch': 24, 'num_users': 6.3571, 'loss': 0.0291, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8889, 'compress@10': 0.0739, 'time@10': 6.1492}:  47%|████▋     | 14/30 [01:01<01:02,  3.88s/it]{'epoch': 24, 'num_users': 6.2667, 'loss': 0.0293, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8892, 'compress@10': 0.0719, 'time@10': 6.2683}:  47%|████▋     | 14/30 [01:05<01:02,  3.88s/it]{'epoch': 24, 'num_users': 6.2667, 'loss': 0.0293, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8892, 'compress@10': 0.0719, 'time@10': 6.2683}:  50%|█████     | 15/30 [01:05<00:58,  3.92s/it]{'epoch': 24, 'num_users': 6.0625, 'loss': 0.0278, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8902, 'compress@10': 0.0739, 'time@10': 6.0679}:  50%|█████     | 15/30 [01:08<00:58,  3.92s/it]{'epoch': 24, 'num_users': 6.0625, 'loss': 0.0278, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8902, 'compress@10': 0.0739, 'time@10': 6.0679}:  53%|█████▎    | 16/30 [01:08<00:51,  3.67s/it]{'epoch': 24, 'num_users': 5.8235, 'loss': 0.0263, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8831, 'compress@10': 0.0823, 'time@10': 5.8951}:  53%|█████▎    | 16/30 [01:10<00:51,  3.67s/it]{'epoch': 24, 'num_users': 5.8235, 'loss': 0.0263, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8831, 'compress@10': 0.0823, 'time@10': 5.8951}:  57%|█████▋    | 17/30 [01:10<00:39,  3.05s/it]{'epoch': 24, 'num_users': 6.0556, 'loss': 0.0264, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8839, 'compress@10': 0.0809, 'time@10': 5.8228}:  57%|█████▋    | 17/30 [01:15<00:39,  3.05s/it]{'epoch': 24, 'num_users': 6.0556, 'loss': 0.0264, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8839, 'compress@10': 0.0809, 'time@10': 5.8228}:  60%|██████    | 18/30 [01:15<00:42,  3.53s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 0.0257, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8852, 'compress@10': 0.0816, 'time@10': 5.7286}:  60%|██████    | 18/30 [01:17<00:42,  3.53s/it]   {'epoch': 24, 'num_users': 6.0, 'loss': 0.0257, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8852, 'compress@10': 0.0816, 'time@10': 5.7286}:  63%|██████▎   | 19/30 [01:17<00:33,  3.08s/it]{'epoch': 24, 'num_users': 6.15, 'loss': 0.0256, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8869, 'compress@10': 0.0795, 'time@10': 5.8623}:  63%|██████▎   | 19/30 [01:25<00:33,  3.08s/it]{'epoch': 24, 'num_users': 6.15, 'loss': 0.0256, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8869, 'compress@10': 0.0795, 'time@10': 5.8623}:  67%|██████▋   | 20/30 [01:25<00:46,  4.69s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8854, 'compress@10': 0.0781, 'time@10': 5.9547}:  67%|██████▋   | 20/30 [01:29<00:46,  4.69s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8854, 'compress@10': 0.0781, 'time@10': 5.9547}:  70%|███████   | 21/30 [01:29<00:40,  4.47s/it]{'epoch': 24, 'num_users': 6.1818, 'loss': 0.0268, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8868, 'compress@10': 0.0774, 'time@10': 5.8346}:  70%|███████   | 21/30 [01:32<00:40,  4.47s/it]{'epoch': 24, 'num_users': 6.1818, 'loss': 0.0268, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8868, 'compress@10': 0.0774, 'time@10': 5.8346}:  73%|███████▎  | 22/30 [01:32<00:33,  4.13s/it]{'epoch': 24, 'num_users': 6.1304, 'loss': 0.0264, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8879, 'compress@10': 0.077, 'time@10': 5.824}:  73%|███████▎  | 22/30 [01:35<00:33,  4.13s/it]  {'epoch': 24, 'num_users': 6.1304, 'loss': 0.0264, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8879, 'compress@10': 0.077, 'time@10': 5.824}:  77%|███████▋  | 23/30 [01:35<00:26,  3.74s/it]{'epoch': 24, 'num_users': 5.9583, 'loss': 0.0255, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8819, 'compress@10': 0.0826, 'time@10': 5.6748}:  77%|███████▋  | 23/30 [01:38<00:26,  3.74s/it]{'epoch': 24, 'num_users': 5.9583, 'loss': 0.0255, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8819, 'compress@10': 0.0826, 'time@10': 5.6748}:  80%|████████  | 24/30 [01:38<00:19,  3.31s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0246, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8726, 'compress@10': 0.0931, 'time@10': 5.5383}:  80%|████████  | 24/30 [01:39<00:19,  3.31s/it]   {'epoch': 24, 'num_users': 5.8, 'loss': 0.0246, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8726, 'compress@10': 0.0931, 'time@10': 5.5383}:  83%|████████▎ | 25/30 [01:39<00:13,  2.67s/it]{'epoch': 24, 'num_users': 5.8077, 'loss': 0.0247, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8743, 'compress@10': 0.0905, 'time@10': 5.6115}:  83%|████████▎ | 25/30 [01:46<00:13,  2.67s/it]{'epoch': 24, 'num_users': 5.8077, 'loss': 0.0247, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8743, 'compress@10': 0.0905, 'time@10': 5.6115}:  87%|████████▋ | 26/30 [01:46<00:16,  4.11s/it]{'epoch': 24, 'num_users': 5.8889, 'loss': 0.0247, 'hit_ratio@10': 0.858, 'ndcg@10': 0.876, 'compress@10': 0.0894, 'time@10': 5.6767}:  87%|████████▋ | 26/30 [01:50<00:16,  4.11s/it]  {'epoch': 24, 'num_users': 5.8889, 'loss': 0.0247, 'hit_ratio@10': 0.858, 'ndcg@10': 0.876, 'compress@10': 0.0894, 'time@10': 5.6767}:  90%|█████████ | 27/30 [01:50<00:11,  3.99s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 0.0252, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8774, 'compress@10': 0.088, 'time@10': 5.7407}:  90%|█████████ | 27/30 [01:57<00:11,  3.99s/it]   {'epoch': 24, 'num_users': 6.0, 'loss': 0.0252, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8774, 'compress@10': 0.088, 'time@10': 5.7407}:  93%|█████████▎| 28/30 [01:57<00:10,  5.05s/it]{'epoch': 24, 'num_users': 5.8621, 'loss': 0.0249, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8791, 'compress@10': 0.087, 'time@10': 5.7378}:  93%|█████████▎| 28/30 [02:00<00:10,  5.05s/it]{'epoch': 24, 'num_users': 5.8621, 'loss': 0.0249, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8791, 'compress@10': 0.087, 'time@10': 5.7378}:  97%|█████████▋| 29/30 [02:00<00:04,  4.39s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0251, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8796, 'compress@10': 0.0859, 'time@10': 5.7404}:  97%|█████████▋| 29/30 [02:06<00:04,  4.39s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0251, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8796, 'compress@10': 0.0859, 'time@10': 5.7404}: 100%|██████████| 30/30 [02:06<00:00,  4.83s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0251, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8796, 'compress@10': 0.0859, 'time@10': 5.7404}: 100%|██████████| 30/30 [02:06<00:00,  4.22s/it]
Epoch: 24
Avg # of users: 5.866666666666666
Avg Loss: 0.025078640116442806
Avg hit ratio: 0.863301667900112
Avg ndcg: 0.8796446020055073
Avg compression ratio: 0.08592314331553777
Avg train time: 5.740448355674744
Std train time: 2.0634548241684563
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 35, 8, 19, 27, 10, 10, 9, 6, 11, 10, 35, 35, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8815, 'compress@10': 0.0666, 'time@10': 5.9757}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8815, 'compress@10': 0.0666, 'time@10': 5.9757}:   3%|▎         | 1/30 [00:03<01:27,  3.03s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.896, 'compress@10': 0.0626, 'time@10': 5.4781}:   3%|▎         | 1/30 [00:08<01:27,  3.03s/it] {'epoch': 25, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.896, 'compress@10': 0.0626, 'time@10': 5.4781}:   7%|▋         | 2/30 [00:08<01:57,  4.20s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.883, 'compress@10': 0.0959, 'time@10': 4.7774}:   7%|▋         | 2/30 [00:09<01:57,  4.20s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.883, 'compress@10': 0.0959, 'time@10': 4.7774}:  10%|█         | 3/30 [00:09<01:22,  3.07s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8881, 'compress@10': 0.0854, 'time@10': 4.6993}:  10%|█         | 3/30 [00:14<01:22,  3.07s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8881, 'compress@10': 0.0854, 'time@10': 4.6993}:  13%|█▎        | 4/30 [00:14<01:34,  3.64s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0292, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8685, 'compress@10': 0.0765, 'time@10': 5.3961}:  13%|█▎        | 4/30 [00:18<01:34,  3.64s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0292, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8685, 'compress@10': 0.0765, 'time@10': 5.3961}:  17%|█▋        | 5/30 [00:18<01:35,  3.82s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0292, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8755, 'compress@10': 0.0703, 'time@10': 5.714}:  17%|█▋        | 5/30 [00:25<01:35,  3.82s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0292, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8755, 'compress@10': 0.0703, 'time@10': 5.714}:  20%|██        | 6/30 [00:25<02:00,  5.02s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8784, 'compress@10': 0.0702, 'time@10': 6.0289}:  20%|██        | 6/30 [00:29<02:00,  5.02s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8784, 'compress@10': 0.0702, 'time@10': 6.0289}:  23%|██▎       | 7/30 [00:29<01:47,  4.68s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0287, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.8896, 'compress@10': 0.0679, 'time@10': 5.9741}:  23%|██▎       | 7/30 [00:35<01:47,  4.68s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0287, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.8896, 'compress@10': 0.0679, 'time@10': 5.9741}:  27%|██▋       | 8/30 [00:35<01:49,  4.98s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0289, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.8963, 'compress@10': 0.0649, 'time@10': 6.3065}:  27%|██▋       | 8/30 [00:39<01:49,  4.98s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0289, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.8963, 'compress@10': 0.0649, 'time@10': 6.3065}:  30%|███       | 9/30 [00:39<01:41,  4.84s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.902, 'compress@10': 0.0625, 'time@10': 6.3872}:  30%|███       | 9/30 [00:47<01:41,  4.84s/it]    {'epoch': 25, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.902, 'compress@10': 0.0625, 'time@10': 6.3872}:  33%|███▎      | 10/30 [00:47<01:51,  5.56s/it]{'epoch': 25, 'num_users': 6.6364, 'loss': 0.0294, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.8998, 'compress@10': 0.0619, 'time@10': 6.4821}:  33%|███▎      | 10/30 [00:50<01:51,  5.56s/it]{'epoch': 25, 'num_users': 6.6364, 'loss': 0.0294, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.8998, 'compress@10': 0.0619, 'time@10': 6.4821}:  37%|███▋      | 11/30 [00:50<01:35,  5.01s/it]{'epoch': 25, 'num_users': 6.4167, 'loss': 0.0275, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9012, 'compress@10': 0.0654, 'time@10': 6.2172}:  37%|███▋      | 11/30 [00:54<01:35,  5.01s/it]{'epoch': 25, 'num_users': 6.4167, 'loss': 0.0275, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9012, 'compress@10': 0.0654, 'time@10': 6.2172}:  40%|████      | 12/30 [00:54<01:21,  4.50s/it]{'epoch': 25, 'num_users': 6.6154, 'loss': 0.028, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9002, 'compress@10': 0.0659, 'time@10': 6.2788}:  40%|████      | 12/30 [00:57<01:21,  4.50s/it] {'epoch': 25, 'num_users': 6.6154, 'loss': 0.028, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9002, 'compress@10': 0.0659, 'time@10': 6.2788}:  43%|████▎     | 13/30 [00:57<01:11,  4.21s/it]{'epoch': 25, 'num_users': 6.3571, 'loss': 0.0262, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8946, 'compress@10': 0.0743, 'time@10': 6.0355}:  43%|████▎     | 13/30 [01:00<01:11,  4.21s/it]{'epoch': 25, 'num_users': 6.3571, 'loss': 0.0262, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8946, 'compress@10': 0.0743, 'time@10': 6.0355}:  47%|████▋     | 14/30 [01:00<01:01,  3.82s/it]{'epoch': 25, 'num_users': 6.2667, 'loss': 0.0265, 'hit_ratio@10': 0.875, 'ndcg@10': 0.8955, 'compress@10': 0.0723, 'time@10': 6.1575}:  47%|████▋     | 14/30 [01:04<01:01,  3.82s/it] {'epoch': 25, 'num_users': 6.2667, 'loss': 0.0265, 'hit_ratio@10': 0.875, 'ndcg@10': 0.8955, 'compress@10': 0.0723, 'time@10': 6.1575}:  50%|█████     | 15/30 [01:04<00:58,  3.87s/it]{'epoch': 25, 'num_users': 6.0625, 'loss': 0.0252, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8962, 'compress@10': 0.0743, 'time@10': 5.9804}:  50%|█████     | 15/30 [01:07<00:58,  3.87s/it]{'epoch': 25, 'num_users': 6.0625, 'loss': 0.0252, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8962, 'compress@10': 0.0743, 'time@10': 5.9804}:  53%|█████▎    | 16/30 [01:07<00:52,  3.72s/it]{'epoch': 25, 'num_users': 5.8235, 'loss': 0.0238, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8888, 'compress@10': 0.0827, 'time@10': 5.8131}:  53%|█████▎    | 16/30 [01:09<00:52,  3.72s/it]{'epoch': 25, 'num_users': 5.8235, 'loss': 0.0238, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8888, 'compress@10': 0.0827, 'time@10': 5.8131}:  57%|█████▋    | 17/30 [01:09<00:40,  3.08s/it]{'epoch': 25, 'num_users': 6.0556, 'loss': 0.0241, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8892, 'compress@10': 0.0813, 'time@10': 5.7282}:  57%|█████▋    | 17/30 [01:13<00:40,  3.08s/it]{'epoch': 25, 'num_users': 6.0556, 'loss': 0.0241, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8892, 'compress@10': 0.0813, 'time@10': 5.7282}:  60%|██████    | 18/30 [01:13<00:41,  3.46s/it]{'epoch': 25, 'num_users': 6.0, 'loss': 0.0234, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8898, 'compress@10': 0.0819, 'time@10': 5.6517}:  60%|██████    | 18/30 [01:16<00:41,  3.46s/it]    {'epoch': 25, 'num_users': 6.0, 'loss': 0.0234, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8898, 'compress@10': 0.0819, 'time@10': 5.6517}:  63%|██████▎   | 19/30 [01:16<00:33,  3.07s/it]{'epoch': 25, 'num_users': 6.15, 'loss': 0.0235, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8914, 'compress@10': 0.0797, 'time@10': 5.7942}:  63%|██████▎   | 19/30 [01:24<00:33,  3.07s/it]{'epoch': 25, 'num_users': 6.15, 'loss': 0.0235, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8914, 'compress@10': 0.0797, 'time@10': 5.7942}:  67%|██████▋   | 20/30 [01:24<00:47,  4.72s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.025, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8888, 'compress@10': 0.0783, 'time@10': 5.9119}:  67%|██████▋   | 20/30 [01:28<00:47,  4.72s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.025, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8888, 'compress@10': 0.0783, 'time@10': 5.9119}:  70%|███████   | 21/30 [01:28<00:40,  4.55s/it]{'epoch': 25, 'num_users': 6.1818, 'loss': 0.0254, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8888, 'compress@10': 0.0775, 'time@10': 5.8107}:  70%|███████   | 21/30 [01:32<00:40,  4.55s/it]{'epoch': 25, 'num_users': 6.1818, 'loss': 0.0254, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8888, 'compress@10': 0.0775, 'time@10': 5.8107}:  73%|███████▎  | 22/30 [01:32<00:34,  4.30s/it]{'epoch': 25, 'num_users': 6.1304, 'loss': 0.0251, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8899, 'compress@10': 0.0771, 'time@10': 5.7985}:  73%|███████▎  | 22/30 [01:35<00:34,  4.30s/it]{'epoch': 25, 'num_users': 6.1304, 'loss': 0.0251, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8899, 'compress@10': 0.0771, 'time@10': 5.7985}:  77%|███████▋  | 23/30 [01:35<00:26,  3.85s/it]{'epoch': 25, 'num_users': 5.9583, 'loss': 0.0242, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8838, 'compress@10': 0.0826, 'time@10': 5.6507}:  77%|███████▋  | 23/30 [01:37<00:26,  3.85s/it]{'epoch': 25, 'num_users': 5.9583, 'loss': 0.0242, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8838, 'compress@10': 0.0826, 'time@10': 5.6507}:  80%|████████  | 24/30 [01:37<00:20,  3.38s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0234, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8751, 'compress@10': 0.0931, 'time@10': 5.5307}:  80%|████████  | 24/30 [01:39<00:20,  3.38s/it]   {'epoch': 25, 'num_users': 5.8, 'loss': 0.0234, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8751, 'compress@10': 0.0931, 'time@10': 5.5307}:  83%|████████▎ | 25/30 [01:39<00:13,  2.78s/it]{'epoch': 25, 'num_users': 5.8077, 'loss': 0.0235, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8768, 'compress@10': 0.0906, 'time@10': 5.6188}:  83%|████████▎ | 25/30 [01:46<00:13,  2.78s/it]{'epoch': 25, 'num_users': 5.8077, 'loss': 0.0235, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8768, 'compress@10': 0.0906, 'time@10': 5.6188}:  87%|████████▋ | 26/30 [01:46<00:17,  4.31s/it]{'epoch': 25, 'num_users': 5.8889, 'loss': 0.024, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8792, 'compress@10': 0.0893, 'time@10': 5.6908}:  87%|████████▋ | 26/30 [01:50<00:17,  4.31s/it] {'epoch': 25, 'num_users': 5.8889, 'loss': 0.024, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8792, 'compress@10': 0.0893, 'time@10': 5.6908}:  90%|█████████ | 27/30 [01:50<00:12,  4.16s/it]{'epoch': 25, 'num_users': 6.0, 'loss': 0.0244, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8803, 'compress@10': 0.0878, 'time@10': 5.7761}:  90%|█████████ | 27/30 [01:58<00:12,  4.16s/it]  {'epoch': 25, 'num_users': 6.0, 'loss': 0.0244, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8803, 'compress@10': 0.0878, 'time@10': 5.7761}:  93%|█████████▎| 28/30 [01:58<00:10,  5.35s/it]{'epoch': 25, 'num_users': 5.8621, 'loss': 0.0241, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8819, 'compress@10': 0.0868, 'time@10': 5.8059}:  93%|█████████▎| 28/30 [02:02<00:10,  5.35s/it]{'epoch': 25, 'num_users': 5.8621, 'loss': 0.0241, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8819, 'compress@10': 0.0868, 'time@10': 5.8059}:  97%|█████████▋| 29/30 [02:02<00:04,  4.75s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.0243, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8824, 'compress@10': 0.0857, 'time@10': 5.8136}:  97%|█████████▋| 29/30 [02:08<00:04,  4.75s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.0243, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8824, 'compress@10': 0.0857, 'time@10': 5.8136}: 100%|██████████| 30/30 [02:08<00:00,  5.15s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.0243, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8824, 'compress@10': 0.0857, 'time@10': 5.8136}: 100%|██████████| 30/30 [02:08<00:00,  4.28s/it]
Epoch: 25
Avg # of users: 5.866666666666666
Avg Loss: 0.024321603583728067
Avg hit ratio: 0.8659489389297359
Avg ndcg: 0.8824031449636186
Avg compression ratio: 0.08569959832280946
Avg train time: 5.813623762130737
Std train time: 2.0594937735035357
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 36, 8, 19, 28, 10, 10, 9, 6, 11, 10, 36, 36, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0339, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8815, 'compress@10': 0.0669, 'time@10': 6.8036}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0339, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8815, 'compress@10': 0.0669, 'time@10': 6.8036}:   3%|▎         | 1/30 [00:03<01:39,  3.44s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8973, 'compress@10': 0.0621, 'time@10': 5.9214}:   3%|▎         | 1/30 [00:08<01:39,  3.44s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8973, 'compress@10': 0.0621, 'time@10': 5.9214}:   7%|▋         | 2/30 [00:08<02:03,  4.41s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8839, 'compress@10': 0.0959, 'time@10': 5.0747}:   7%|▋         | 2/30 [00:10<02:03,  4.41s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8839, 'compress@10': 0.0959, 'time@10': 5.0747}:  10%|█         | 3/30 [00:10<01:25,  3.18s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8859, 'compress@10': 0.0855, 'time@10': 4.8897}:  10%|█         | 3/30 [00:14<01:25,  3.18s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8859, 'compress@10': 0.0855, 'time@10': 4.8897}:  13%|█▎        | 4/30 [00:14<01:34,  3.65s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8679, 'compress@10': 0.0766, 'time@10': 5.5598}:  13%|█▎        | 4/30 [00:18<01:34,  3.65s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8679, 'compress@10': 0.0766, 'time@10': 5.5598}:  17%|█▋        | 5/30 [00:18<01:35,  3.84s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0297, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8757, 'compress@10': 0.0705, 'time@10': 5.8649}:  17%|█▋        | 5/30 [00:26<01:35,  3.84s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0297, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8757, 'compress@10': 0.0705, 'time@10': 5.8649}:  20%|██        | 6/30 [00:26<02:01,  5.06s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0285, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.8819, 'compress@10': 0.0708, 'time@10': 6.1666}:  20%|██        | 6/30 [00:30<02:01,  5.06s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0285, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.8819, 'compress@10': 0.0708, 'time@10': 6.1666}:  23%|██▎       | 7/30 [00:30<01:48,  4.72s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0285, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.8935, 'compress@10': 0.0685, 'time@10': 6.077}:  23%|██▎       | 7/30 [00:35<01:48,  4.72s/it]  {'epoch': 26, 'num_users': 6.125, 'loss': 0.0285, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.8935, 'compress@10': 0.0685, 'time@10': 6.077}:  27%|██▋       | 8/30 [00:35<01:49,  4.97s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0288, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9, 'compress@10': 0.0655, 'time@10': 6.4014}:  27%|██▋       | 8/30 [00:40<01:49,  4.97s/it] {'epoch': 26, 'num_users': 6.3333, 'loss': 0.0288, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9, 'compress@10': 0.0655, 'time@10': 6.4014}:  30%|███       | 9/30 [00:40<01:41,  4.83s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0287, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9015, 'compress@10': 0.063, 'time@10': 6.4611}:  30%|███       | 9/30 [00:47<01:41,  4.83s/it] {'epoch': 26, 'num_users': 6.3, 'loss': 0.0287, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9015, 'compress@10': 0.063, 'time@10': 6.4611}:  33%|███▎      | 10/30 [00:47<01:50,  5.52s/it]{'epoch': 26, 'num_users': 6.6364, 'loss': 0.03, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.9005, 'compress@10': 0.0622, 'time@10': 6.5638}:  33%|███▎      | 10/30 [00:51<01:50,  5.52s/it]{'epoch': 26, 'num_users': 6.6364, 'loss': 0.03, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.9005, 'compress@10': 0.0622, 'time@10': 6.5638}:  37%|███▋      | 11/30 [00:51<01:35,  5.00s/it]{'epoch': 26, 'num_users': 6.4167, 'loss': 0.028, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9019, 'compress@10': 0.0657, 'time@10': 6.3057}:  37%|███▋      | 11/30 [00:54<01:35,  5.00s/it]{'epoch': 26, 'num_users': 6.4167, 'loss': 0.028, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9019, 'compress@10': 0.0657, 'time@10': 6.3057}:  40%|████      | 12/30 [00:54<01:21,  4.55s/it]{'epoch': 26, 'num_users': 6.6154, 'loss': 0.0286, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9008, 'compress@10': 0.0663, 'time@10': 6.3582}:  40%|████      | 12/30 [00:58<01:21,  4.55s/it]{'epoch': 26, 'num_users': 6.6154, 'loss': 0.0286, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9008, 'compress@10': 0.0663, 'time@10': 6.3582}:  43%|████▎     | 13/30 [00:58<01:12,  4.24s/it]{'epoch': 26, 'num_users': 6.3571, 'loss': 0.0267, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8952, 'compress@10': 0.0746, 'time@10': 6.1146}:  43%|████▎     | 13/30 [01:01<01:12,  4.24s/it]{'epoch': 26, 'num_users': 6.3571, 'loss': 0.0267, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8952, 'compress@10': 0.0746, 'time@10': 6.1146}:  47%|████▋     | 14/30 [01:01<01:01,  3.86s/it]{'epoch': 26, 'num_users': 6.2667, 'loss': 0.0269, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8961, 'compress@10': 0.0726, 'time@10': 6.2091}:  47%|████▋     | 14/30 [01:04<01:01,  3.86s/it]{'epoch': 26, 'num_users': 6.2667, 'loss': 0.0269, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8961, 'compress@10': 0.0726, 'time@10': 6.2091}:  50%|█████     | 15/30 [01:04<00:57,  3.85s/it]{'epoch': 26, 'num_users': 6.0625, 'loss': 0.0256, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8968, 'compress@10': 0.0747, 'time@10': 6.0107}:  50%|█████     | 15/30 [01:08<00:57,  3.85s/it]{'epoch': 26, 'num_users': 6.0625, 'loss': 0.0256, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8968, 'compress@10': 0.0747, 'time@10': 6.0107}:  53%|█████▎    | 16/30 [01:08<00:50,  3.62s/it]{'epoch': 26, 'num_users': 5.8235, 'loss': 0.0242, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8893, 'compress@10': 0.083, 'time@10': 5.8724}:  53%|█████▎    | 16/30 [01:09<00:50,  3.62s/it] {'epoch': 26, 'num_users': 5.8235, 'loss': 0.0242, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8893, 'compress@10': 0.083, 'time@10': 5.8724}:  57%|█████▋    | 17/30 [01:09<00:40,  3.10s/it]{'epoch': 26, 'num_users': 6.0556, 'loss': 0.0242, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8899, 'compress@10': 0.0815, 'time@10': 5.7834}:  57%|█████▋    | 17/30 [01:14<00:40,  3.10s/it]{'epoch': 26, 'num_users': 6.0556, 'loss': 0.0242, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8899, 'compress@10': 0.0815, 'time@10': 5.7834}:  60%|██████    | 18/30 [01:14<00:41,  3.46s/it]{'epoch': 26, 'num_users': 6.0, 'loss': 0.0235, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8909, 'compress@10': 0.0822, 'time@10': 5.7043}:  60%|██████    | 18/30 [01:16<00:41,  3.46s/it]   {'epoch': 26, 'num_users': 6.0, 'loss': 0.0235, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8909, 'compress@10': 0.0822, 'time@10': 5.7043}:  63%|██████▎   | 19/30 [01:16<00:33,  3.08s/it]{'epoch': 26, 'num_users': 6.15, 'loss': 0.0235, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8922, 'compress@10': 0.0799, 'time@10': 5.8432}:  63%|██████▎   | 19/30 [01:24<00:33,  3.08s/it]{'epoch': 26, 'num_users': 6.15, 'loss': 0.0235, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8922, 'compress@10': 0.0799, 'time@10': 5.8432}:  67%|██████▋   | 20/30 [01:24<00:47,  4.71s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.89, 'compress@10': 0.0786, 'time@10': 5.9413}:  67%|██████▋   | 20/30 [01:28<00:47,  4.71s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.89, 'compress@10': 0.0786, 'time@10': 5.9413}:  70%|███████   | 21/30 [01:28<00:40,  4.50s/it]{'epoch': 26, 'num_users': 6.1818, 'loss': 0.0256, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.891, 'compress@10': 0.0778, 'time@10': 5.8328}:  70%|███████   | 21/30 [01:32<00:40,  4.50s/it]{'epoch': 26, 'num_users': 6.1818, 'loss': 0.0256, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.891, 'compress@10': 0.0778, 'time@10': 5.8328}:  73%|███████▎  | 22/30 [01:32<00:33,  4.22s/it]{'epoch': 26, 'num_users': 6.1304, 'loss': 0.0253, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8919, 'compress@10': 0.0774, 'time@10': 5.8256}:  73%|███████▎  | 22/30 [01:35<00:33,  4.22s/it]{'epoch': 26, 'num_users': 6.1304, 'loss': 0.0253, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8919, 'compress@10': 0.0774, 'time@10': 5.8256}:  77%|███████▋  | 23/30 [01:35<00:26,  3.82s/it]{'epoch': 26, 'num_users': 5.9583, 'loss': 0.0244, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8881, 'compress@10': 0.0829, 'time@10': 5.6816}:  77%|███████▋  | 23/30 [01:37<00:26,  3.82s/it]{'epoch': 26, 'num_users': 5.9583, 'loss': 0.0244, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8881, 'compress@10': 0.0829, 'time@10': 5.6816}:  80%|████████  | 24/30 [01:37<00:20,  3.40s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0235, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8793, 'compress@10': 0.0934, 'time@10': 5.5493}:  80%|████████  | 24/30 [01:39<00:20,  3.40s/it]   {'epoch': 26, 'num_users': 5.8, 'loss': 0.0235, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8793, 'compress@10': 0.0934, 'time@10': 5.5493}:  83%|████████▎ | 25/30 [01:39<00:13,  2.75s/it]{'epoch': 26, 'num_users': 5.8077, 'loss': 0.0235, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8811, 'compress@10': 0.0909, 'time@10': 5.6342}:  83%|████████▎ | 25/30 [01:46<00:13,  2.75s/it]{'epoch': 26, 'num_users': 5.8077, 'loss': 0.0235, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8811, 'compress@10': 0.0909, 'time@10': 5.6342}:  87%|████████▋ | 26/30 [01:46<00:17,  4.26s/it]{'epoch': 26, 'num_users': 5.8889, 'loss': 0.024, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8786, 'compress@10': 0.0899, 'time@10': 5.7063}:  87%|████████▋ | 26/30 [01:50<00:17,  4.26s/it] {'epoch': 26, 'num_users': 5.8889, 'loss': 0.024, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8786, 'compress@10': 0.0899, 'time@10': 5.7063}:  90%|█████████ | 27/30 [01:50<00:12,  4.13s/it]{'epoch': 26, 'num_users': 6.0, 'loss': 0.0242, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.88, 'compress@10': 0.0884, 'time@10': 5.7688}:  90%|█████████ | 27/30 [01:58<00:12,  4.13s/it]    {'epoch': 26, 'num_users': 6.0, 'loss': 0.0242, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.88, 'compress@10': 0.0884, 'time@10': 5.7688}:  93%|█████████▎| 28/30 [01:58<00:10,  5.14s/it]{'epoch': 26, 'num_users': 5.8621, 'loss': 0.0239, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8817, 'compress@10': 0.0874, 'time@10': 5.7851}:  93%|█████████▎| 28/30 [02:01<00:10,  5.14s/it]{'epoch': 26, 'num_users': 5.8621, 'loss': 0.0239, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8817, 'compress@10': 0.0874, 'time@10': 5.7851}:  97%|█████████▋| 29/30 [02:01<00:04,  4.55s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0242, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8818, 'compress@10': 0.0863, 'time@10': 5.7745}:  97%|█████████▋| 29/30 [02:06<00:04,  4.55s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0242, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8818, 'compress@10': 0.0863, 'time@10': 5.7745}: 100%|██████████| 30/30 [02:06<00:00,  4.84s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0242, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8818, 'compress@10': 0.0863, 'time@10': 5.7745}: 100%|██████████| 30/30 [02:06<00:00,  4.23s/it]
Epoch: 26
Avg # of users: 5.866666666666666
Avg Loss: 0.024223343849920163
Avg hit ratio: 0.8727231505584369
Avg ndcg: 0.881767234160364
Avg compression ratio: 0.08629958575579794
Avg train time: 5.774541584650676
Std train time: 2.0238821512020095
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 9, 19, 10, 37, 8, 20, 28, 10, 10, 9, 6, 11, 10, 37, 37, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8815, 'compress@10': 0.0673, 'time@10': 5.5996}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8815, 'compress@10': 0.0673, 'time@10': 5.5996}:   3%|▎         | 1/30 [00:02<01:22,  2.84s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8993, 'compress@10': 0.0617, 'time@10': 5.3114}:   3%|▎         | 1/30 [00:07<01:22,  2.84s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8993, 'compress@10': 0.0617, 'time@10': 5.3114}:   7%|▋         | 2/30 [00:07<01:56,  4.15s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8852, 'compress@10': 0.0958, 'time@10': 4.6638}:   7%|▋         | 2/30 [00:09<01:56,  4.15s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8852, 'compress@10': 0.0958, 'time@10': 4.6638}:  10%|█         | 3/30 [00:09<01:22,  3.04s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8651, 'compress@10': 0.0856, 'time@10': 4.6114}:  10%|█         | 3/30 [00:14<01:22,  3.04s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8651, 'compress@10': 0.0856, 'time@10': 4.6114}:  13%|█▎        | 4/30 [00:14<01:33,  3.62s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0319, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8503, 'compress@10': 0.0766, 'time@10': 5.3277}:  13%|█▎        | 4/30 [00:18<01:33,  3.62s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0319, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8503, 'compress@10': 0.0766, 'time@10': 5.3277}:  17%|█▋        | 5/30 [00:18<01:35,  3.80s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0308, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8606, 'compress@10': 0.0706, 'time@10': 5.7073}:  17%|█▋        | 5/30 [00:25<01:35,  3.80s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0308, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8606, 'compress@10': 0.0706, 'time@10': 5.7073}:  20%|██        | 6/30 [00:25<02:02,  5.11s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0307, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8671, 'compress@10': 0.0708, 'time@10': 6.0378}:  20%|██        | 6/30 [00:29<02:02,  5.11s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0307, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8671, 'compress@10': 0.0708, 'time@10': 6.0378}:  23%|██▎       | 7/30 [00:29<01:49,  4.77s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0302, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.8818, 'compress@10': 0.0686, 'time@10': 5.9857}:  23%|██▎       | 7/30 [00:35<01:49,  4.77s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0302, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.8818, 'compress@10': 0.0686, 'time@10': 5.9857}:  27%|██▋       | 8/30 [00:35<01:51,  5.05s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0304, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8892, 'compress@10': 0.0656, 'time@10': 6.4114}:  27%|██▋       | 8/30 [00:40<01:51,  5.05s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0304, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8892, 'compress@10': 0.0656, 'time@10': 6.4114}:  30%|███       | 9/30 [00:40<01:45,  5.02s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.029, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.8958, 'compress@10': 0.0632, 'time@10': 6.4811}:  30%|███       | 9/30 [00:47<01:45,  5.02s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.029, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.8958, 'compress@10': 0.0632, 'time@10': 6.4811}:  33%|███▎      | 10/30 [00:47<01:53,  5.68s/it]{'epoch': 27, 'num_users': 6.6364, 'loss': 0.0301, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.8955, 'compress@10': 0.0624, 'time@10': 6.5817}:  33%|███▎      | 10/30 [00:51<01:53,  5.68s/it]{'epoch': 27, 'num_users': 6.6364, 'loss': 0.0301, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.8955, 'compress@10': 0.0624, 'time@10': 6.5817}:  37%|███▋      | 11/30 [00:51<01:37,  5.11s/it]{'epoch': 27, 'num_users': 6.4167, 'loss': 0.028, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8972, 'compress@10': 0.0658, 'time@10': 6.319}:  37%|███▋      | 11/30 [00:55<01:37,  5.11s/it]  {'epoch': 27, 'num_users': 6.4167, 'loss': 0.028, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8972, 'compress@10': 0.0658, 'time@10': 6.319}:  40%|████      | 12/30 [00:55<01:23,  4.61s/it]{'epoch': 27, 'num_users': 6.6154, 'loss': 0.0284, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8965, 'compress@10': 0.0664, 'time@10': 6.4471}:  40%|████      | 12/30 [00:59<01:23,  4.61s/it]{'epoch': 27, 'num_users': 6.6154, 'loss': 0.0284, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8965, 'compress@10': 0.0664, 'time@10': 6.4471}:  43%|████▎     | 13/30 [00:59<01:15,  4.44s/it]{'epoch': 27, 'num_users': 6.3571, 'loss': 0.0265, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8912, 'compress@10': 0.0747, 'time@10': 6.2094}:  43%|████▎     | 13/30 [01:02<01:15,  4.44s/it]{'epoch': 27, 'num_users': 6.3571, 'loss': 0.0265, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8912, 'compress@10': 0.0747, 'time@10': 6.2094}:  47%|████▋     | 14/30 [01:02<01:04,  4.05s/it]{'epoch': 27, 'num_users': 6.2667, 'loss': 0.0265, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8926, 'compress@10': 0.0726, 'time@10': 6.264}:  47%|████▋     | 14/30 [01:05<01:04,  4.05s/it]  {'epoch': 27, 'num_users': 6.2667, 'loss': 0.0265, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8926, 'compress@10': 0.0726, 'time@10': 6.264}:  50%|█████     | 15/30 [01:05<00:58,  3.90s/it]{'epoch': 27, 'num_users': 6.0625, 'loss': 0.0253, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8938, 'compress@10': 0.0747, 'time@10': 6.0894}:  50%|█████     | 15/30 [01:09<00:58,  3.90s/it]{'epoch': 27, 'num_users': 6.0625, 'loss': 0.0253, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8938, 'compress@10': 0.0747, 'time@10': 6.0894}:  53%|█████▎    | 16/30 [01:09<00:52,  3.78s/it]{'epoch': 27, 'num_users': 5.8235, 'loss': 0.0239, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8866, 'compress@10': 0.083, 'time@10': 5.9456}:  53%|█████▎    | 16/30 [01:11<00:52,  3.78s/it] {'epoch': 27, 'num_users': 5.8235, 'loss': 0.0239, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8866, 'compress@10': 0.083, 'time@10': 5.9456}:  57%|█████▋    | 17/30 [01:11<00:41,  3.21s/it]{'epoch': 27, 'num_users': 6.0556, 'loss': 0.0239, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8878, 'compress@10': 0.0816, 'time@10': 5.8643}:  57%|█████▋    | 17/30 [01:15<00:41,  3.21s/it]{'epoch': 27, 'num_users': 6.0556, 'loss': 0.0239, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8878, 'compress@10': 0.0816, 'time@10': 5.8643}:  60%|██████    | 18/30 [01:15<00:43,  3.60s/it]{'epoch': 27, 'num_users': 6.0, 'loss': 0.0232, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8888, 'compress@10': 0.0823, 'time@10': 5.784}:  60%|██████    | 18/30 [01:17<00:43,  3.60s/it]    {'epoch': 27, 'num_users': 6.0, 'loss': 0.0232, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8888, 'compress@10': 0.0823, 'time@10': 5.784}:  63%|██████▎   | 19/30 [01:17<00:35,  3.18s/it]{'epoch': 27, 'num_users': 6.15, 'loss': 0.0232, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8904, 'compress@10': 0.0798, 'time@10': 5.9115}:  63%|██████▎   | 19/30 [01:26<00:35,  3.18s/it]{'epoch': 27, 'num_users': 6.15, 'loss': 0.0232, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8904, 'compress@10': 0.0798, 'time@10': 5.9115}:  67%|██████▋   | 20/30 [01:26<00:47,  4.74s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0243, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8893, 'compress@10': 0.0786, 'time@10': 6.0041}:  67%|██████▋   | 20/30 [01:30<00:47,  4.74s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0243, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8893, 'compress@10': 0.0786, 'time@10': 6.0041}:  70%|███████   | 21/30 [01:30<00:40,  4.51s/it]{'epoch': 27, 'num_users': 6.1818, 'loss': 0.0245, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8905, 'compress@10': 0.0779, 'time@10': 5.8847}:  70%|███████   | 21/30 [01:33<00:40,  4.51s/it] {'epoch': 27, 'num_users': 6.1818, 'loss': 0.0245, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8905, 'compress@10': 0.0779, 'time@10': 5.8847}:  73%|███████▎  | 22/30 [01:33<00:33,  4.18s/it]{'epoch': 27, 'num_users': 6.1304, 'loss': 0.0242, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8915, 'compress@10': 0.0775, 'time@10': 5.8806}:  73%|███████▎  | 22/30 [01:36<00:33,  4.18s/it]{'epoch': 27, 'num_users': 6.1304, 'loss': 0.0242, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8915, 'compress@10': 0.0775, 'time@10': 5.8806}:  77%|███████▋  | 23/30 [01:36<00:26,  3.81s/it]{'epoch': 27, 'num_users': 5.9583, 'loss': 0.0233, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.8877, 'compress@10': 0.083, 'time@10': 5.7366}:  77%|███████▋  | 23/30 [01:39<00:26,  3.81s/it] {'epoch': 27, 'num_users': 5.9583, 'loss': 0.0233, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.8877, 'compress@10': 0.083, 'time@10': 5.7366}:  80%|████████  | 24/30 [01:39<00:20,  3.41s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8788, 'compress@10': 0.0935, 'time@10': 5.6038}:  80%|████████  | 24/30 [01:40<00:20,  3.41s/it]  {'epoch': 27, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8788, 'compress@10': 0.0935, 'time@10': 5.6038}:  83%|████████▎ | 25/30 [01:40<00:13,  2.76s/it]{'epoch': 27, 'num_users': 5.8077, 'loss': 0.0225, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8808, 'compress@10': 0.091, 'time@10': 5.6733}:  83%|████████▎ | 25/30 [01:47<00:13,  2.76s/it]{'epoch': 27, 'num_users': 5.8077, 'loss': 0.0225, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8808, 'compress@10': 0.091, 'time@10': 5.6733}:  87%|████████▋ | 26/30 [01:47<00:16,  4.17s/it]{'epoch': 27, 'num_users': 5.8889, 'loss': 0.0227, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.8817, 'compress@10': 0.0901, 'time@10': 5.7553}:  87%|████████▋ | 26/30 [01:51<00:16,  4.17s/it]{'epoch': 27, 'num_users': 5.8889, 'loss': 0.0227, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.8817, 'compress@10': 0.0901, 'time@10': 5.7553}:  90%|█████████ | 27/30 [01:51<00:12,  4.11s/it]{'epoch': 27, 'num_users': 6.0, 'loss': 0.0231, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8827, 'compress@10': 0.0885, 'time@10': 5.8188}:  90%|█████████ | 27/30 [01:59<00:12,  4.11s/it]    {'epoch': 27, 'num_users': 6.0, 'loss': 0.0231, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8827, 'compress@10': 0.0885, 'time@10': 5.8188}:  93%|█████████▎| 28/30 [01:59<00:10,  5.16s/it]{'epoch': 27, 'num_users': 5.8621, 'loss': 0.0228, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8844, 'compress@10': 0.0876, 'time@10': 5.8206}:  93%|█████████▎| 28/30 [02:02<00:10,  5.16s/it]{'epoch': 27, 'num_users': 5.8621, 'loss': 0.0228, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8844, 'compress@10': 0.0876, 'time@10': 5.8206}:  97%|█████████▋| 29/30 [02:02<00:04,  4.50s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.0231, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8845, 'compress@10': 0.0864, 'time@10': 5.8344}:  97%|█████████▋| 29/30 [02:08<00:04,  4.50s/it] {'epoch': 27, 'num_users': 5.8667, 'loss': 0.0231, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8845, 'compress@10': 0.0864, 'time@10': 5.8344}: 100%|██████████| 30/30 [02:08<00:00,  5.03s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.0231, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8845, 'compress@10': 0.0864, 'time@10': 5.8344}: 100%|██████████| 30/30 [02:08<00:00,  4.29s/it]
Epoch: 27
Avg # of users: 5.866666666666666
Avg Loss: 0.023106560194152012
Avg hit ratio: 0.8680249783288555
Avg ndcg: 0.8845074252013237
Avg compression ratio: 0.08643233778291837
Avg train time: 5.834418384234111
Std train time: 2.0482765411316612
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 38, 8, 20, 28, 10, 10, 9, 6, 11, 10, 38, 38, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0314, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.886, 'compress@10': 0.0677, 'time@10': 6.2204}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0314, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.886, 'compress@10': 0.0677, 'time@10': 6.2204}:   3%|▎         | 1/30 [00:03<01:32,  3.18s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9003, 'compress@10': 0.0616, 'time@10': 5.5766}:   3%|▎         | 1/30 [00:08<01:32,  3.18s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9003, 'compress@10': 0.0616, 'time@10': 5.5766}:   7%|▋         | 2/30 [00:08<01:58,  4.24s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8859, 'compress@10': 0.0959, 'time@10': 4.8298}:   7%|▋         | 2/30 [00:09<01:58,  4.24s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8859, 'compress@10': 0.0959, 'time@10': 4.8298}:  10%|█         | 3/30 [00:09<01:23,  3.08s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8763, 'compress@10': 0.0857, 'time@10': 4.7398}:  10%|█         | 3/30 [00:14<01:23,  3.08s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8763, 'compress@10': 0.0857, 'time@10': 4.7398}:  13%|█▎        | 4/30 [00:14<01:34,  3.65s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0289, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.8594, 'compress@10': 0.0766, 'time@10': 5.3972}:  13%|█▎        | 4/30 [00:18<01:34,  3.65s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0289, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.8594, 'compress@10': 0.0766, 'time@10': 5.3972}:  17%|█▋        | 5/30 [00:18<01:34,  3.80s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0282, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.8696, 'compress@10': 0.0706, 'time@10': 5.7129}:  17%|█▋        | 5/30 [00:25<01:34,  3.80s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0282, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.8696, 'compress@10': 0.0706, 'time@10': 5.7129}:  20%|██        | 6/30 [00:25<01:59,  5.00s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0279, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.872, 'compress@10': 0.0705, 'time@10': 6.043}:  20%|██        | 6/30 [00:29<01:59,  5.00s/it]  {'epoch': 28, 'num_users': 6.2857, 'loss': 0.0279, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.872, 'compress@10': 0.0705, 'time@10': 6.043}:  23%|██▎       | 7/30 [00:29<01:47,  4.69s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0277, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.8848, 'compress@10': 0.0683, 'time@10': 5.9878}:  23%|██▎       | 7/30 [00:35<01:47,  4.69s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0277, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.8848, 'compress@10': 0.0683, 'time@10': 5.9878}:  27%|██▋       | 8/30 [00:35<01:49,  4.99s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0272, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.8924, 'compress@10': 0.0654, 'time@10': 6.2006}:  27%|██▋       | 8/30 [00:39<01:49,  4.99s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0272, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.8924, 'compress@10': 0.0654, 'time@10': 6.2006}:  30%|███       | 9/30 [00:39<01:38,  4.68s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.9076, 'ndcg@10': 0.8955, 'compress@10': 0.0629, 'time@10': 6.2936}:  30%|███       | 9/30 [00:46<01:38,  4.68s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.9076, 'ndcg@10': 0.8955, 'compress@10': 0.0629, 'time@10': 6.2936}:  33%|███▎      | 10/30 [00:46<01:48,  5.45s/it]{'epoch': 28, 'num_users': 6.6364, 'loss': 0.0287, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.8946, 'compress@10': 0.0621, 'time@10': 6.4356}:  33%|███▎      | 10/30 [00:50<01:48,  5.45s/it]{'epoch': 28, 'num_users': 6.6364, 'loss': 0.0287, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.8946, 'compress@10': 0.0621, 'time@10': 6.4356}:  37%|███▋      | 11/30 [00:50<01:34,  5.00s/it]{'epoch': 28, 'num_users': 6.4167, 'loss': 0.0267, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8964, 'compress@10': 0.0654, 'time@10': 6.1882}:  37%|███▋      | 11/30 [00:54<01:34,  5.00s/it]{'epoch': 28, 'num_users': 6.4167, 'loss': 0.0267, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8964, 'compress@10': 0.0654, 'time@10': 6.1882}:  40%|████      | 12/30 [00:54<01:21,  4.54s/it]{'epoch': 28, 'num_users': 6.6154, 'loss': 0.0271, 'hit_ratio@10': 0.878, 'ndcg@10': 0.8958, 'compress@10': 0.0661, 'time@10': 6.2722}:  40%|████      | 12/30 [00:57<01:21,  4.54s/it] {'epoch': 28, 'num_users': 6.6154, 'loss': 0.0271, 'hit_ratio@10': 0.878, 'ndcg@10': 0.8958, 'compress@10': 0.0661, 'time@10': 6.2722}:  43%|████▎     | 13/30 [00:57<01:12,  4.28s/it]{'epoch': 28, 'num_users': 6.3571, 'loss': 0.0253, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.8905, 'compress@10': 0.0745, 'time@10': 6.0534}:  43%|████▎     | 13/30 [01:01<01:12,  4.28s/it]{'epoch': 28, 'num_users': 6.3571, 'loss': 0.0253, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.8905, 'compress@10': 0.0745, 'time@10': 6.0534}:  47%|████▋     | 14/30 [01:01<01:03,  3.97s/it]{'epoch': 28, 'num_users': 6.2667, 'loss': 0.0255, 'hit_ratio@10': 0.881, 'ndcg@10': 0.8921, 'compress@10': 0.0723, 'time@10': 6.1418}:  47%|████▋     | 14/30 [01:04<01:03,  3.97s/it] {'epoch': 28, 'num_users': 6.2667, 'loss': 0.0255, 'hit_ratio@10': 0.881, 'ndcg@10': 0.8921, 'compress@10': 0.0723, 'time@10': 6.1418}:  50%|█████     | 15/30 [01:04<00:58,  3.90s/it]{'epoch': 28, 'num_users': 6.0625, 'loss': 0.0241, 'hit_ratio@10': 0.878, 'ndcg@10': 0.8934, 'compress@10': 0.0743, 'time@10': 5.9657}:  50%|█████     | 15/30 [01:08<00:58,  3.90s/it]{'epoch': 28, 'num_users': 6.0625, 'loss': 0.0241, 'hit_ratio@10': 0.878, 'ndcg@10': 0.8934, 'compress@10': 0.0743, 'time@10': 5.9657}:  53%|█████▎    | 16/30 [01:08<00:52,  3.74s/it]{'epoch': 28, 'num_users': 5.8235, 'loss': 0.0228, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8862, 'compress@10': 0.0825, 'time@10': 5.8291}:  53%|█████▎    | 16/30 [01:10<00:52,  3.74s/it]{'epoch': 28, 'num_users': 5.8235, 'loss': 0.0228, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8862, 'compress@10': 0.0825, 'time@10': 5.8291}:  57%|█████▋    | 17/30 [01:10<00:41,  3.17s/it]{'epoch': 28, 'num_users': 6.0556, 'loss': 0.0229, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8874, 'compress@10': 0.0811, 'time@10': 5.7458}:  57%|█████▋    | 17/30 [01:14<00:41,  3.17s/it]{'epoch': 28, 'num_users': 6.0556, 'loss': 0.0229, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8874, 'compress@10': 0.0811, 'time@10': 5.7458}:  60%|██████    | 18/30 [01:14<00:42,  3.53s/it]{'epoch': 28, 'num_users': 6.0, 'loss': 0.0223, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8884, 'compress@10': 0.0818, 'time@10': 5.6676}:  60%|██████    | 18/30 [01:16<00:42,  3.53s/it]   {'epoch': 28, 'num_users': 6.0, 'loss': 0.0223, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8884, 'compress@10': 0.0818, 'time@10': 5.6676}:  63%|██████▎   | 19/30 [01:16<00:34,  3.12s/it]{'epoch': 28, 'num_users': 6.15, 'loss': 0.0222, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.8904, 'compress@10': 0.0793, 'time@10': 5.8044}:  63%|██████▎   | 19/30 [01:24<00:34,  3.12s/it]{'epoch': 28, 'num_users': 6.15, 'loss': 0.0222, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.8904, 'compress@10': 0.0793, 'time@10': 5.8044}:  67%|██████▋   | 20/30 [01:24<00:47,  4.72s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0236, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8882, 'compress@10': 0.0781, 'time@10': 5.9025}:  67%|██████▋   | 20/30 [01:28<00:47,  4.72s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0236, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8882, 'compress@10': 0.0781, 'time@10': 5.9025}:  70%|███████   | 21/30 [01:28<00:40,  4.50s/it]{'epoch': 28, 'num_users': 6.1818, 'loss': 0.0242, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8881, 'compress@10': 0.0773, 'time@10': 5.8051}:  70%|███████   | 21/30 [01:32<00:40,  4.50s/it]{'epoch': 28, 'num_users': 6.1818, 'loss': 0.0242, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8881, 'compress@10': 0.0773, 'time@10': 5.8051}:  73%|███████▎  | 22/30 [01:32<00:34,  4.29s/it]{'epoch': 28, 'num_users': 6.1304, 'loss': 0.0239, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8892, 'compress@10': 0.0769, 'time@10': 5.8093}:  73%|███████▎  | 22/30 [01:35<00:34,  4.29s/it]{'epoch': 28, 'num_users': 6.1304, 'loss': 0.0239, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8892, 'compress@10': 0.0769, 'time@10': 5.8093}:  77%|███████▋  | 23/30 [01:35<00:27,  3.90s/it]{'epoch': 28, 'num_users': 5.9583, 'loss': 0.023, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8854, 'compress@10': 0.0824, 'time@10': 5.6681}:  77%|███████▋  | 23/30 [01:38<00:27,  3.90s/it] {'epoch': 28, 'num_users': 5.9583, 'loss': 0.023, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8854, 'compress@10': 0.0824, 'time@10': 5.6681}:  80%|████████  | 24/30 [01:38<00:20,  3.47s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0221, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8767, 'compress@10': 0.093, 'time@10': 5.5409}:  80%|████████  | 24/30 [01:39<00:20,  3.47s/it]   {'epoch': 28, 'num_users': 5.8, 'loss': 0.0221, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8767, 'compress@10': 0.093, 'time@10': 5.5409}:  83%|████████▎ | 25/30 [01:39<00:14,  2.81s/it]{'epoch': 28, 'num_users': 5.8077, 'loss': 0.0221, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8789, 'compress@10': 0.0905, 'time@10': 5.637}:  83%|████████▎ | 25/30 [01:47<00:14,  2.81s/it]{'epoch': 28, 'num_users': 5.8077, 'loss': 0.0221, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8789, 'compress@10': 0.0905, 'time@10': 5.637}:  87%|████████▋ | 26/30 [01:47<00:17,  4.39s/it]{'epoch': 28, 'num_users': 5.8889, 'loss': 0.0227, 'hit_ratio@10': 0.87, 'ndcg@10': 0.882, 'compress@10': 0.0894, 'time@10': 5.7155}:  87%|████████▋ | 26/30 [01:51<00:17,  4.39s/it]  {'epoch': 28, 'num_users': 5.8889, 'loss': 0.0227, 'hit_ratio@10': 0.87, 'ndcg@10': 0.882, 'compress@10': 0.0894, 'time@10': 5.7155}:  90%|█████████ | 27/30 [01:51<00:12,  4.25s/it]{'epoch': 28, 'num_users': 6.0, 'loss': 0.023, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8836, 'compress@10': 0.0877, 'time@10': 5.8069}:  90%|█████████ | 27/30 [01:59<00:12,  4.25s/it] {'epoch': 28, 'num_users': 6.0, 'loss': 0.023, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8836, 'compress@10': 0.0877, 'time@10': 5.8069}:  93%|█████████▎| 28/30 [01:59<00:10,  5.47s/it]{'epoch': 28, 'num_users': 5.8621, 'loss': 0.0227, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8853, 'compress@10': 0.0868, 'time@10': 5.8243}:  93%|█████████▎| 28/30 [02:02<00:10,  5.47s/it]{'epoch': 28, 'num_users': 5.8621, 'loss': 0.0227, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8853, 'compress@10': 0.0868, 'time@10': 5.8243}:  97%|█████████▋| 29/30 [02:02<00:04,  4.79s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.0229, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8857, 'compress@10': 0.0857, 'time@10': 5.8365}:  97%|█████████▋| 29/30 [02:09<00:04,  4.79s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.0229, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8857, 'compress@10': 0.0857, 'time@10': 5.8365}: 100%|██████████| 30/30 [02:09<00:00,  5.22s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.0229, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8857, 'compress@10': 0.0857, 'time@10': 5.8365}: 100%|██████████| 30/30 [02:09<00:00,  4.31s/it]
Epoch: 28
Avg # of users: 5.866666666666666
Avg Loss: 0.022915352588767993
Avg hit ratio: 0.8732231765270535
Avg ndcg: 0.8856856413726754
Avg compression ratio: 0.08569550902183748
Avg train time: 5.836505190531413
Std train time: 1.9701199873725765
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 38, 8, 20, 28, 10, 10, 9, 6, 11, 10, 39, 39, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.886, 'compress@10': 0.0683, 'time@10': 6.7709}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.886, 'compress@10': 0.0683, 'time@10': 6.7709}:   3%|▎         | 1/30 [00:03<01:39,  3.42s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9042, 'compress@10': 0.0614, 'time@10': 5.8955}:   3%|▎         | 1/30 [00:08<01:39,  3.42s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9042, 'compress@10': 0.0614, 'time@10': 5.8955}:   7%|▋         | 2/30 [00:08<02:02,  4.39s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8885, 'compress@10': 0.096, 'time@10': 5.0565}:   7%|▋         | 2/30 [00:10<02:02,  4.39s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8885, 'compress@10': 0.096, 'time@10': 5.0565}:  10%|█         | 3/30 [00:10<01:25,  3.17s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8988, 'compress@10': 0.0856, 'time@10': 4.9044}:  10%|█         | 3/30 [00:14<01:25,  3.17s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8988, 'compress@10': 0.0856, 'time@10': 4.9044}:  13%|█▎        | 4/30 [00:14<01:36,  3.69s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.8787, 'compress@10': 0.0763, 'time@10': 5.5593}:  13%|█▎        | 4/30 [00:18<01:36,  3.69s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.8787, 'compress@10': 0.0763, 'time@10': 5.5593}:  17%|█▋        | 5/30 [00:18<01:36,  3.85s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0245, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.8864, 'compress@10': 0.0702, 'time@10': 5.9121}:  17%|█▋        | 5/30 [00:26<01:36,  3.85s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0245, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.8864, 'compress@10': 0.0702, 'time@10': 5.9121}:  20%|██        | 6/30 [00:26<02:03,  5.17s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0237, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.8926, 'compress@10': 0.0702, 'time@10': 6.1994}:  20%|██        | 6/30 [00:30<02:03,  5.17s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0237, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.8926, 'compress@10': 0.0702, 'time@10': 6.1994}:  23%|██▎       | 7/30 [00:30<01:50,  4.79s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.024, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9047, 'compress@10': 0.068, 'time@10': 6.1311}:  23%|██▎       | 7/30 [00:36<01:50,  4.79s/it]    {'epoch': 29, 'num_users': 6.125, 'loss': 0.024, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9047, 'compress@10': 0.068, 'time@10': 6.1311}:  27%|██▋       | 8/30 [00:36<01:51,  5.07s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.024, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9098, 'compress@10': 0.0652, 'time@10': 6.3265}:  27%|██▋       | 8/30 [00:40<01:51,  5.07s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.024, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9098, 'compress@10': 0.0652, 'time@10': 6.3265}:  30%|███       | 9/30 [00:40<01:39,  4.73s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9149, 'compress@10': 0.0627, 'time@10': 6.3883}:  30%|███       | 9/30 [00:47<01:39,  4.73s/it]  {'epoch': 29, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9149, 'compress@10': 0.0627, 'time@10': 6.3883}:  33%|███▎      | 10/30 [00:47<01:48,  5.43s/it]{'epoch': 29, 'num_users': 6.6364, 'loss': 0.024, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9129, 'compress@10': 0.062, 'time@10': 6.4875}:  33%|███▎      | 10/30 [00:51<01:48,  5.43s/it]{'epoch': 29, 'num_users': 6.6364, 'loss': 0.024, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9129, 'compress@10': 0.062, 'time@10': 6.4875}:  37%|███▋      | 11/30 [00:51<01:33,  4.92s/it]{'epoch': 29, 'num_users': 6.4167, 'loss': 0.0223, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9132, 'compress@10': 0.0653, 'time@10': 6.2318}:  37%|███▋      | 11/30 [00:54<01:33,  4.92s/it]{'epoch': 29, 'num_users': 6.4167, 'loss': 0.0223, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9132, 'compress@10': 0.0653, 'time@10': 6.2318}:  40%|████      | 12/30 [00:54<01:20,  4.48s/it]{'epoch': 29, 'num_users': 6.6154, 'loss': 0.023, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9113, 'compress@10': 0.066, 'time@10': 6.2703}:  40%|████      | 12/30 [00:57<01:20,  4.48s/it]   {'epoch': 29, 'num_users': 6.6154, 'loss': 0.023, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9113, 'compress@10': 0.066, 'time@10': 6.2703}:  43%|████▎     | 13/30 [00:57<01:10,  4.15s/it]{'epoch': 29, 'num_users': 6.3571, 'loss': 0.0215, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9057, 'compress@10': 0.0744, 'time@10': 6.0371}:  43%|████▎     | 13/30 [01:00<01:10,  4.15s/it]{'epoch': 29, 'num_users': 6.3571, 'loss': 0.0215, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9057, 'compress@10': 0.0744, 'time@10': 6.0371}:  47%|████▋     | 14/30 [01:00<01:01,  3.82s/it]{'epoch': 29, 'num_users': 6.2667, 'loss': 0.022, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9055, 'compress@10': 0.0722, 'time@10': 6.1117}:  47%|████▋     | 14/30 [01:04<01:01,  3.82s/it] {'epoch': 29, 'num_users': 6.2667, 'loss': 0.022, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9055, 'compress@10': 0.0722, 'time@10': 6.1117}:  50%|█████     | 15/30 [01:04<00:56,  3.76s/it]{'epoch': 29, 'num_users': 6.0625, 'loss': 0.0209, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9059, 'compress@10': 0.0744, 'time@10': 5.9542}:  50%|█████     | 15/30 [01:08<00:56,  3.76s/it]{'epoch': 29, 'num_users': 6.0625, 'loss': 0.0209, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9059, 'compress@10': 0.0744, 'time@10': 5.9542}:  53%|█████▎    | 16/30 [01:08<00:52,  3.72s/it]{'epoch': 29, 'num_users': 5.8235, 'loss': 0.0197, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8979, 'compress@10': 0.0826, 'time@10': 5.8192}:  53%|█████▎    | 16/30 [01:10<00:52,  3.72s/it]{'epoch': 29, 'num_users': 5.8235, 'loss': 0.0197, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8979, 'compress@10': 0.0826, 'time@10': 5.8192}:  57%|█████▋    | 17/30 [01:10<00:41,  3.16s/it]{'epoch': 29, 'num_users': 6.0556, 'loss': 0.0198, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.8985, 'compress@10': 0.0812, 'time@10': 5.7471}:  57%|█████▋    | 17/30 [01:14<00:41,  3.16s/it]{'epoch': 29, 'num_users': 6.0556, 'loss': 0.0198, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.8985, 'compress@10': 0.0812, 'time@10': 5.7471}:  60%|██████    | 18/30 [01:14<00:43,  3.58s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 0.0193, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8989, 'compress@10': 0.0819, 'time@10': 5.6709}:  60%|██████    | 18/30 [01:16<00:43,  3.58s/it]   {'epoch': 29, 'num_users': 6.0, 'loss': 0.0193, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8989, 'compress@10': 0.0819, 'time@10': 5.6709}:  63%|██████▎   | 19/30 [01:16<00:34,  3.17s/it]{'epoch': 29, 'num_users': 6.15, 'loss': 0.0195, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9007, 'compress@10': 0.0793, 'time@10': 5.8085}:  63%|██████▎   | 19/30 [01:25<00:34,  3.17s/it]{'epoch': 29, 'num_users': 6.15, 'loss': 0.0195, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9007, 'compress@10': 0.0793, 'time@10': 5.8085}:  67%|██████▋   | 20/30 [01:25<00:47,  4.76s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0208, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.8985, 'compress@10': 0.0782, 'time@10': 5.8927}:  67%|██████▋   | 20/30 [01:29<00:47,  4.76s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0208, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.8985, 'compress@10': 0.0782, 'time@10': 5.8927}:  70%|███████   | 21/30 [01:29<00:40,  4.48s/it]{'epoch': 29, 'num_users': 6.1818, 'loss': 0.0215, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8992, 'compress@10': 0.0774, 'time@10': 5.7778}:  70%|███████   | 21/30 [01:32<00:40,  4.48s/it]{'epoch': 29, 'num_users': 6.1818, 'loss': 0.0215, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8992, 'compress@10': 0.0774, 'time@10': 5.7778}:  73%|███████▎  | 22/30 [01:32<00:33,  4.16s/it]{'epoch': 29, 'num_users': 6.1304, 'loss': 0.0212, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8999, 'compress@10': 0.077, 'time@10': 5.7836}:  73%|███████▎  | 22/30 [01:35<00:33,  4.16s/it] {'epoch': 29, 'num_users': 6.1304, 'loss': 0.0212, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8999, 'compress@10': 0.077, 'time@10': 5.7836}:  77%|███████▋  | 23/30 [01:35<00:26,  3.81s/it]{'epoch': 29, 'num_users': 5.9583, 'loss': 0.0204, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8958, 'compress@10': 0.0826, 'time@10': 5.6496}:  77%|███████▋  | 23/30 [01:38<00:26,  3.81s/it]{'epoch': 29, 'num_users': 5.9583, 'loss': 0.0204, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8958, 'compress@10': 0.0826, 'time@10': 5.6496}:  80%|████████  | 24/30 [01:38<00:20,  3.45s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0197, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8866, 'compress@10': 0.0932, 'time@10': 5.5261}:  80%|████████  | 24/30 [01:39<00:20,  3.45s/it]    {'epoch': 29, 'num_users': 5.8, 'loss': 0.0197, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8866, 'compress@10': 0.0932, 'time@10': 5.5261}:  83%|████████▎ | 25/30 [01:39<00:14,  2.81s/it]{'epoch': 29, 'num_users': 5.8077, 'loss': 0.0197, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8884, 'compress@10': 0.0907, 'time@10': 5.6085}:  83%|████████▎ | 25/30 [01:47<00:14,  2.81s/it]{'epoch': 29, 'num_users': 5.8077, 'loss': 0.0197, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8884, 'compress@10': 0.0907, 'time@10': 5.6085}:  87%|████████▋ | 26/30 [01:47<00:17,  4.28s/it]{'epoch': 29, 'num_users': 5.8889, 'loss': 0.0203, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8914, 'compress@10': 0.0895, 'time@10': 5.6472}:  87%|████████▋ | 26/30 [01:50<00:17,  4.28s/it]{'epoch': 29, 'num_users': 5.8889, 'loss': 0.0203, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8914, 'compress@10': 0.0895, 'time@10': 5.6472}:  90%|█████████ | 27/30 [01:50<00:12,  4.00s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 0.0205, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8929, 'compress@10': 0.0879, 'time@10': 5.7142}:  90%|█████████ | 27/30 [01:58<00:12,  4.00s/it]    {'epoch': 29, 'num_users': 6.0, 'loss': 0.0205, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8929, 'compress@10': 0.0879, 'time@10': 5.7142}:  93%|█████████▎| 28/30 [01:58<00:10,  5.07s/it]{'epoch': 29, 'num_users': 5.8621, 'loss': 0.0203, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8945, 'compress@10': 0.0869, 'time@10': 5.7348}:  93%|█████████▎| 28/30 [02:01<00:10,  5.07s/it]{'epoch': 29, 'num_users': 5.8621, 'loss': 0.0203, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8945, 'compress@10': 0.0869, 'time@10': 5.7348}:  97%|█████████▋| 29/30 [02:01<00:04,  4.51s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.0208, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.8938, 'compress@10': 0.0858, 'time@10': 5.7404}:  97%|█████████▋| 29/30 [02:07<00:04,  4.51s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.0208, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.8938, 'compress@10': 0.0858, 'time@10': 5.7404}: 100%|██████████| 30/30 [02:07<00:00,  4.94s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.0208, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.8938, 'compress@10': 0.0858, 'time@10': 5.7404}: 100%|██████████| 30/30 [02:07<00:00,  4.24s/it]
Epoch: 29
Avg # of users: 5.866666666666666
Avg Loss: 0.02075218082572916
Avg hit ratio: 0.8754800047838818
Avg ndcg: 0.8938277554404089
Avg compression ratio: 0.08580614328931042
Avg train time: 5.740354410807291
Std train time: 1.8731131754050792
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 39, 8, 20, 28, 10, 10, 9, 6, 11, 10, 40, 40, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.886, 'compress@10': 0.0685, 'time@10': 6.1293}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.886, 'compress@10': 0.0685, 'time@10': 6.1293}:   3%|▎         | 1/30 [00:03<01:30,  3.13s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0246, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9053, 'compress@10': 0.0616, 'time@10': 5.5763}:   3%|▎         | 1/30 [00:08<01:30,  3.13s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0246, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9053, 'compress@10': 0.0616, 'time@10': 5.5763}:   7%|▋         | 2/30 [00:08<01:59,  4.27s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8893, 'compress@10': 0.0963, 'time@10': 4.8452}:   7%|▋         | 2/30 [00:09<01:59,  4.27s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8893, 'compress@10': 0.0963, 'time@10': 4.8452}:  10%|█         | 3/30 [00:09<01:23,  3.11s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8995, 'compress@10': 0.0859, 'time@10': 4.7468}:  10%|█         | 3/30 [00:14<01:23,  3.11s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8995, 'compress@10': 0.0859, 'time@10': 4.7468}:  13%|█▎        | 4/30 [00:14<01:35,  3.66s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0256, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.8804, 'compress@10': 0.0762, 'time@10': 5.3663}:  13%|█▎        | 4/30 [00:18<01:35,  3.66s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0256, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.8804, 'compress@10': 0.0762, 'time@10': 5.3663}:  17%|█▋        | 5/30 [00:18<01:34,  3.77s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0247, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.8897, 'compress@10': 0.0705, 'time@10': 5.6902}:  17%|█▋        | 5/30 [00:25<01:34,  3.77s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0247, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.8897, 'compress@10': 0.0705, 'time@10': 5.6902}:  20%|██        | 6/30 [00:25<02:00,  5.02s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.025, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.8919, 'compress@10': 0.0704, 'time@10': 6.1075}:  20%|██        | 6/30 [00:30<02:00,  5.02s/it] {'epoch': 30, 'num_users': 6.2857, 'loss': 0.025, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.8919, 'compress@10': 0.0704, 'time@10': 6.1075}:  23%|██▎       | 7/30 [00:30<01:50,  4.81s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.914, 'ndcg@10': 0.903, 'compress@10': 0.0682, 'time@10': 6.1008}:  23%|██▎       | 7/30 [00:36<01:50,  4.81s/it]  {'epoch': 30, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.914, 'ndcg@10': 0.903, 'compress@10': 0.0682, 'time@10': 6.1008}:  27%|██▋       | 8/30 [00:36<01:54,  5.22s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0252, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9085, 'compress@10': 0.0655, 'time@10': 6.2982}:  27%|██▋       | 8/30 [00:40<01:54,  5.22s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0252, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9085, 'compress@10': 0.0655, 'time@10': 6.2982}:  30%|███       | 9/30 [00:40<01:41,  4.83s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.024, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9133, 'compress@10': 0.0629, 'time@10': 6.4058}:  30%|███       | 9/30 [00:47<01:41,  4.83s/it]    {'epoch': 30, 'num_users': 6.3, 'loss': 0.024, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9133, 'compress@10': 0.0629, 'time@10': 6.4058}:  33%|███▎      | 10/30 [00:47<01:52,  5.63s/it]{'epoch': 30, 'num_users': 6.6364, 'loss': 0.0253, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9109, 'compress@10': 0.0622, 'time@10': 6.51}:  33%|███▎      | 10/30 [00:51<01:52,  5.63s/it]{'epoch': 30, 'num_users': 6.6364, 'loss': 0.0253, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9109, 'compress@10': 0.0622, 'time@10': 6.51}:  37%|███▋      | 11/30 [00:51<01:36,  5.07s/it]{'epoch': 30, 'num_users': 6.4167, 'loss': 0.0235, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9114, 'compress@10': 0.0654, 'time@10': 6.2546}:  37%|███▋      | 11/30 [00:54<01:36,  5.07s/it]{'epoch': 30, 'num_users': 6.4167, 'loss': 0.0235, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9114, 'compress@10': 0.0654, 'time@10': 6.2546}:  40%|████      | 12/30 [00:54<01:22,  4.59s/it]{'epoch': 30, 'num_users': 6.6154, 'loss': 0.0242, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9097, 'compress@10': 0.0663, 'time@10': 6.3094}:  40%|████      | 12/30 [00:58<01:22,  4.59s/it]{'epoch': 30, 'num_users': 6.6154, 'loss': 0.0242, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9097, 'compress@10': 0.0663, 'time@10': 6.3094}:  43%|████▎     | 13/30 [00:58<01:12,  4.27s/it]{'epoch': 30, 'num_users': 6.3571, 'loss': 0.0225, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9042, 'compress@10': 0.0746, 'time@10': 6.0756}:  43%|████▎     | 13/30 [01:01<01:12,  4.27s/it]{'epoch': 30, 'num_users': 6.3571, 'loss': 0.0225, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9042, 'compress@10': 0.0746, 'time@10': 6.0756}:  47%|████▋     | 14/30 [01:01<01:02,  3.91s/it]{'epoch': 30, 'num_users': 6.2667, 'loss': 0.0226, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9049, 'compress@10': 0.0723, 'time@10': 6.1808}:  47%|████▋     | 14/30 [01:05<01:02,  3.91s/it]{'epoch': 30, 'num_users': 6.2667, 'loss': 0.0226, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9049, 'compress@10': 0.0723, 'time@10': 6.1808}:  50%|█████     | 15/30 [01:05<00:58,  3.90s/it]{'epoch': 30, 'num_users': 6.0625, 'loss': 0.0213, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9054, 'compress@10': 0.0745, 'time@10': 6.0433}:  50%|█████     | 15/30 [01:09<00:58,  3.90s/it]{'epoch': 30, 'num_users': 6.0625, 'loss': 0.0213, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9054, 'compress@10': 0.0745, 'time@10': 6.0433}:  53%|█████▎    | 16/30 [01:09<00:55,  3.94s/it]{'epoch': 30, 'num_users': 5.8235, 'loss': 0.0201, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8974, 'compress@10': 0.0827, 'time@10': 5.9035}:  53%|█████▎    | 16/30 [01:11<00:55,  3.94s/it]{'epoch': 30, 'num_users': 5.8235, 'loss': 0.0201, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8974, 'compress@10': 0.0827, 'time@10': 5.9035}:  57%|█████▋    | 17/30 [01:11<00:43,  3.32s/it]{'epoch': 30, 'num_users': 6.0556, 'loss': 0.0202, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8983, 'compress@10': 0.0811, 'time@10': 5.8253}:  57%|█████▋    | 17/30 [01:15<00:43,  3.32s/it]{'epoch': 30, 'num_users': 6.0556, 'loss': 0.0202, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8983, 'compress@10': 0.0811, 'time@10': 5.8253}:  60%|██████    | 18/30 [01:15<00:44,  3.68s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 0.0197, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.899, 'compress@10': 0.0818, 'time@10': 5.7414}:  60%|██████    | 18/30 [01:18<00:44,  3.68s/it]    {'epoch': 30, 'num_users': 6.0, 'loss': 0.0197, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.899, 'compress@10': 0.0818, 'time@10': 5.7414}:  63%|██████▎   | 19/30 [01:18<00:35,  3.23s/it]{'epoch': 30, 'num_users': 6.15, 'loss': 0.0198, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.9008, 'compress@10': 0.0792, 'time@10': 5.877}:  63%|██████▎   | 19/30 [01:26<00:35,  3.23s/it]{'epoch': 30, 'num_users': 6.15, 'loss': 0.0198, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.9008, 'compress@10': 0.0792, 'time@10': 5.877}:  67%|██████▋   | 20/30 [01:26<00:48,  4.81s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.8992, 'compress@10': 0.0781, 'time@10': 5.9823}:  67%|██████▋   | 20/30 [01:30<00:48,  4.81s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.8992, 'compress@10': 0.0781, 'time@10': 5.9823}:  70%|███████   | 21/30 [01:30<00:41,  4.59s/it]{'epoch': 30, 'num_users': 6.1818, 'loss': 0.0213, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9001, 'compress@10': 0.0774, 'time@10': 5.8555}:  70%|███████   | 21/30 [01:33<00:41,  4.59s/it]{'epoch': 30, 'num_users': 6.1818, 'loss': 0.0213, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9001, 'compress@10': 0.0774, 'time@10': 5.8555}:  73%|███████▎  | 22/30 [01:33<00:33,  4.19s/it]{'epoch': 30, 'num_users': 6.1304, 'loss': 0.0211, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.9009, 'compress@10': 0.077, 'time@10': 5.8669}:  73%|███████▎  | 22/30 [01:37<00:33,  4.19s/it] {'epoch': 30, 'num_users': 6.1304, 'loss': 0.0211, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.9009, 'compress@10': 0.077, 'time@10': 5.8669}:  77%|███████▋  | 23/30 [01:37<00:27,  3.87s/it]{'epoch': 30, 'num_users': 5.9583, 'loss': 0.0203, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8967, 'compress@10': 0.0825, 'time@10': 5.7325}:  77%|███████▋  | 23/30 [01:39<00:27,  3.87s/it]{'epoch': 30, 'num_users': 5.9583, 'loss': 0.0203, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8967, 'compress@10': 0.0825, 'time@10': 5.7325}:  80%|████████  | 24/30 [01:39<00:21,  3.51s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0195, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8875, 'compress@10': 0.0931, 'time@10': 5.608}:  80%|████████  | 24/30 [01:41<00:21,  3.51s/it]    {'epoch': 30, 'num_users': 5.8, 'loss': 0.0195, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8875, 'compress@10': 0.0931, 'time@10': 5.608}:  83%|████████▎ | 25/30 [01:41<00:14,  2.86s/it]{'epoch': 30, 'num_users': 5.8077, 'loss': 0.0195, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8896, 'compress@10': 0.0906, 'time@10': 5.6805}:  83%|████████▎ | 25/30 [01:48<00:14,  2.86s/it]{'epoch': 30, 'num_users': 5.8077, 'loss': 0.0195, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8896, 'compress@10': 0.0906, 'time@10': 5.6805}:  87%|████████▋ | 26/30 [01:48<00:17,  4.26s/it]{'epoch': 30, 'num_users': 5.8889, 'loss': 0.0198, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8904, 'compress@10': 0.0896, 'time@10': 5.7555}:  87%|████████▋ | 26/30 [01:52<00:17,  4.26s/it]{'epoch': 30, 'num_users': 5.8889, 'loss': 0.0198, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8904, 'compress@10': 0.0896, 'time@10': 5.7555}:  90%|█████████ | 27/30 [01:52<00:12,  4.15s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 0.0206, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8916, 'compress@10': 0.0879, 'time@10': 5.8141}:  90%|█████████ | 27/30 [01:59<00:12,  4.15s/it]   {'epoch': 30, 'num_users': 6.0, 'loss': 0.0206, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8916, 'compress@10': 0.0879, 'time@10': 5.8141}:  93%|█████████▎| 28/30 [01:59<00:10,  5.14s/it]{'epoch': 30, 'num_users': 5.8621, 'loss': 0.0203, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8932, 'compress@10': 0.0869, 'time@10': 5.8533}:  93%|█████████▎| 28/30 [02:03<00:10,  5.14s/it]{'epoch': 30, 'num_users': 5.8621, 'loss': 0.0203, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8932, 'compress@10': 0.0869, 'time@10': 5.8533}:  97%|█████████▋| 29/30 [02:03<00:04,  4.65s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.0207, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.894, 'compress@10': 0.0859, 'time@10': 5.8604}:  97%|█████████▋| 29/30 [02:09<00:04,  4.65s/it] {'epoch': 30, 'num_users': 5.8667, 'loss': 0.0207, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.894, 'compress@10': 0.0859, 'time@10': 5.8604}: 100%|██████████| 30/30 [02:09<00:00,  5.09s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.0207, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.894, 'compress@10': 0.0859, 'time@10': 5.8604}: 100%|██████████| 30/30 [02:09<00:00,  4.32s/it]
Epoch: 30
Avg # of users: 5.866666666666666
Avg Loss: 0.020733592552247552
Avg hit ratio: 0.8719182548806683
Avg ndcg: 0.8940476807557662
Avg compression ratio: 0.08585121464036782
Avg train time: 5.860445801417033
Std train time: 1.9345398301437458
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 40, 8, 20, 28, 10, 10, 9, 6, 11, 10, 41, 41, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8912, 'compress@10': 0.0679, 'time@10': 6.3373}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8912, 'compress@10': 0.0679, 'time@10': 6.3373}:   3%|▎         | 1/30 [00:03<01:35,  3.29s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9111, 'compress@10': 0.0611, 'time@10': 5.7114}:   3%|▎         | 1/30 [00:08<01:35,  3.29s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9111, 'compress@10': 0.0611, 'time@10': 5.7114}:   7%|▋         | 2/30 [00:08<02:02,  4.37s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8931, 'compress@10': 0.0961, 'time@10': 4.9311}:   7%|▋         | 2/30 [00:10<02:02,  4.37s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8931, 'compress@10': 0.0961, 'time@10': 4.9311}:  10%|█         | 3/30 [00:10<01:25,  3.16s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8959, 'compress@10': 0.0859, 'time@10': 4.8121}:  10%|█         | 3/30 [00:14<01:25,  3.16s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8959, 'compress@10': 0.0859, 'time@10': 4.8121}:  13%|█▎        | 4/30 [00:14<01:35,  3.69s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0263, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8782, 'compress@10': 0.0759, 'time@10': 5.488}:  13%|█▎        | 4/30 [00:18<01:35,  3.69s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.0263, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8782, 'compress@10': 0.0759, 'time@10': 5.488}:  17%|█▋        | 5/30 [00:18<01:36,  3.85s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.026, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.8864, 'compress@10': 0.0701, 'time@10': 5.7897}:  17%|█▋        | 5/30 [00:26<01:36,  3.85s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.026, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.8864, 'compress@10': 0.0701, 'time@10': 5.7897}:  20%|██        | 6/30 [00:26<02:00,  5.04s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0257, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.8872, 'compress@10': 0.0699, 'time@10': 6.1096}:  20%|██        | 6/30 [00:30<02:00,  5.04s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0257, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.8872, 'compress@10': 0.0699, 'time@10': 6.1096}:  23%|██▎       | 7/30 [00:30<01:48,  4.72s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0255, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.8999, 'compress@10': 0.0677, 'time@10': 6.0307}:  23%|██▎       | 7/30 [00:35<01:48,  4.72s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0255, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.8999, 'compress@10': 0.0677, 'time@10': 6.0307}:  27%|██▋       | 8/30 [00:35<01:49,  4.97s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0261, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9089, 'compress@10': 0.0652, 'time@10': 6.195}:  27%|██▋       | 8/30 [00:39<01:49,  4.97s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0261, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9089, 'compress@10': 0.0652, 'time@10': 6.195}:  30%|███       | 9/30 [00:39<01:36,  4.60s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9204, 'compress@10': 0.0626, 'time@10': 6.283}:  30%|███       | 9/30 [00:46<01:36,  4.60s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9204, 'compress@10': 0.0626, 'time@10': 6.283}:  33%|███▎      | 10/30 [00:46<01:47,  5.38s/it]{'epoch': 31, 'num_users': 6.6364, 'loss': 0.0278, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9177, 'compress@10': 0.062, 'time@10': 6.4093}:  33%|███▎      | 10/30 [00:50<01:47,  5.38s/it]{'epoch': 31, 'num_users': 6.6364, 'loss': 0.0278, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9177, 'compress@10': 0.062, 'time@10': 6.4093}:  37%|███▋      | 11/30 [00:50<01:33,  4.92s/it]{'epoch': 31, 'num_users': 6.4167, 'loss': 0.0258, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9176, 'compress@10': 0.0652, 'time@10': 6.1621}:  37%|███▋      | 11/30 [00:53<01:33,  4.92s/it]{'epoch': 31, 'num_users': 6.4167, 'loss': 0.0258, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9176, 'compress@10': 0.0652, 'time@10': 6.1621}:  40%|████      | 12/30 [00:53<01:20,  4.48s/it]{'epoch': 31, 'num_users': 6.6154, 'loss': 0.0261, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9153, 'compress@10': 0.0661, 'time@10': 6.2306}:  40%|████      | 12/30 [00:57<01:20,  4.48s/it]{'epoch': 31, 'num_users': 6.6154, 'loss': 0.0261, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9153, 'compress@10': 0.0661, 'time@10': 6.2306}:  43%|████▎     | 13/30 [00:57<01:11,  4.21s/it]{'epoch': 31, 'num_users': 6.3571, 'loss': 0.0243, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9095, 'compress@10': 0.0745, 'time@10': 6.0032}:  43%|████▎     | 13/30 [01:00<01:11,  4.21s/it]{'epoch': 31, 'num_users': 6.3571, 'loss': 0.0243, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9095, 'compress@10': 0.0745, 'time@10': 6.0032}:  47%|████▋     | 14/30 [01:00<01:01,  3.87s/it]{'epoch': 31, 'num_users': 6.2667, 'loss': 0.0247, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.9091, 'compress@10': 0.0722, 'time@10': 6.0909}:  47%|████▋     | 14/30 [01:04<01:01,  3.87s/it]{'epoch': 31, 'num_users': 6.2667, 'loss': 0.0247, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.9091, 'compress@10': 0.0722, 'time@10': 6.0909}:  50%|█████     | 15/30 [01:04<00:57,  3.82s/it]{'epoch': 31, 'num_users': 6.0625, 'loss': 0.0234, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9093, 'compress@10': 0.0745, 'time@10': 5.9372}:  50%|█████     | 15/30 [01:07<00:57,  3.82s/it]{'epoch': 31, 'num_users': 6.0625, 'loss': 0.0234, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9093, 'compress@10': 0.0745, 'time@10': 5.9372}:  53%|█████▎    | 16/30 [01:07<00:52,  3.77s/it]{'epoch': 31, 'num_users': 5.8235, 'loss': 0.022, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.9011, 'compress@10': 0.0827, 'time@10': 5.8036}:  53%|█████▎    | 16/30 [01:09<00:52,  3.77s/it] {'epoch': 31, 'num_users': 5.8235, 'loss': 0.022, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.9011, 'compress@10': 0.0827, 'time@10': 5.8036}:  57%|█████▋    | 17/30 [01:09<00:41,  3.20s/it]{'epoch': 31, 'num_users': 6.0556, 'loss': 0.0219, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9014, 'compress@10': 0.0809, 'time@10': 5.731}:  57%|█████▋    | 17/30 [01:14<00:41,  3.20s/it]{'epoch': 31, 'num_users': 6.0556, 'loss': 0.0219, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9014, 'compress@10': 0.0809, 'time@10': 5.731}:  60%|██████    | 18/30 [01:14<00:43,  3.60s/it]{'epoch': 31, 'num_users': 6.0, 'loss': 0.0213, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9021, 'compress@10': 0.0817, 'time@10': 5.6557}:  60%|██████    | 18/30 [01:16<00:43,  3.60s/it]  {'epoch': 31, 'num_users': 6.0, 'loss': 0.0213, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9021, 'compress@10': 0.0817, 'time@10': 5.6557}:  63%|██████▎   | 19/30 [01:16<00:34,  3.18s/it]{'epoch': 31, 'num_users': 6.15, 'loss': 0.0213, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9039, 'compress@10': 0.0791, 'time@10': 5.7932}:  63%|██████▎   | 19/30 [01:25<00:34,  3.18s/it]{'epoch': 31, 'num_users': 6.15, 'loss': 0.0213, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9039, 'compress@10': 0.0791, 'time@10': 5.7932}:  67%|██████▋   | 20/30 [01:25<00:47,  4.76s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9015, 'compress@10': 0.078, 'time@10': 5.8927}:  67%|██████▋   | 20/30 [01:29<00:47,  4.76s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9015, 'compress@10': 0.078, 'time@10': 5.8927}:  70%|███████   | 21/30 [01:29<00:40,  4.53s/it]{'epoch': 31, 'num_users': 6.1818, 'loss': 0.0228, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.902, 'compress@10': 0.0772, 'time@10': 5.7821}:  70%|███████   | 21/30 [01:32<00:40,  4.53s/it]{'epoch': 31, 'num_users': 6.1818, 'loss': 0.0228, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.902, 'compress@10': 0.0772, 'time@10': 5.7821}:  73%|███████▎  | 22/30 [01:32<00:33,  4.22s/it]{'epoch': 31, 'num_users': 6.1304, 'loss': 0.0225, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9027, 'compress@10': 0.0769, 'time@10': 5.7709}:  73%|███████▎  | 22/30 [01:35<00:33,  4.22s/it]{'epoch': 31, 'num_users': 6.1304, 'loss': 0.0225, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9027, 'compress@10': 0.0769, 'time@10': 5.7709}:  77%|███████▋  | 23/30 [01:35<00:26,  3.79s/it]{'epoch': 31, 'num_users': 5.9583, 'loss': 0.0216, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.8985, 'compress@10': 0.0824, 'time@10': 5.6475}:  77%|███████▋  | 23/30 [01:38<00:26,  3.79s/it]{'epoch': 31, 'num_users': 5.9583, 'loss': 0.0216, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.8985, 'compress@10': 0.0824, 'time@10': 5.6475}:  80%|████████  | 24/30 [01:38<00:21,  3.51s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0208, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8892, 'compress@10': 0.093, 'time@10': 5.5319}:  80%|████████  | 24/30 [01:39<00:21,  3.51s/it]    {'epoch': 31, 'num_users': 5.8, 'loss': 0.0208, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8892, 'compress@10': 0.093, 'time@10': 5.5319}:  83%|████████▎ | 25/30 [01:39<00:14,  2.89s/it]{'epoch': 31, 'num_users': 5.8077, 'loss': 0.0207, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8912, 'compress@10': 0.0905, 'time@10': 5.6199}:  83%|████████▎ | 25/30 [01:47<00:14,  2.89s/it]{'epoch': 31, 'num_users': 5.8077, 'loss': 0.0207, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8912, 'compress@10': 0.0905, 'time@10': 5.6199}:  87%|████████▋ | 26/30 [01:47<00:17,  4.38s/it]{'epoch': 31, 'num_users': 5.8889, 'loss': 0.0208, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.892, 'compress@10': 0.0895, 'time@10': 5.7229}:  87%|████████▋ | 26/30 [01:51<00:17,  4.38s/it] {'epoch': 31, 'num_users': 5.8889, 'loss': 0.0208, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.892, 'compress@10': 0.0895, 'time@10': 5.7229}:  90%|█████████ | 27/30 [01:51<00:13,  4.35s/it]{'epoch': 31, 'num_users': 6.0, 'loss': 0.021, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.894, 'compress@10': 0.0878, 'time@10': 5.7959}:  90%|█████████ | 27/30 [01:59<00:13,  4.35s/it]    {'epoch': 31, 'num_users': 6.0, 'loss': 0.021, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.894, 'compress@10': 0.0878, 'time@10': 5.7959}:  93%|█████████▎| 28/30 [01:59<00:10,  5.38s/it]{'epoch': 31, 'num_users': 5.8621, 'loss': 0.0208, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8955, 'compress@10': 0.0868, 'time@10': 5.8253}:  93%|█████████▎| 28/30 [02:02<00:10,  5.38s/it]{'epoch': 31, 'num_users': 5.8621, 'loss': 0.0208, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8955, 'compress@10': 0.0868, 'time@10': 5.8253}:  97%|█████████▋| 29/30 [02:02<00:04,  4.78s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0209, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8964, 'compress@10': 0.0858, 'time@10': 5.8358}:  97%|█████████▋| 29/30 [02:09<00:04,  4.78s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0209, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8964, 'compress@10': 0.0858, 'time@10': 5.8358}: 100%|██████████| 30/30 [02:09<00:00,  5.20s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0209, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8964, 'compress@10': 0.0858, 'time@10': 5.8358}: 100%|██████████| 30/30 [02:09<00:00,  4.30s/it]
Epoch: 31
Avg # of users: 5.866666666666666
Avg Loss: 0.020938965847517935
Avg hit ratio: 0.8753626993251129
Avg ndcg: 0.8963786032667913
Avg compression ratio: 0.08578721970040587
Avg train time: 5.835764090220134
Std train time: 1.9167306938153041
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 41, 8, 20, 28, 10, 10, 9, 6, 11, 10, 42, 42, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8921, 'compress@10': 0.0666, 'time@10': 5.5992}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8921, 'compress@10': 0.0666, 'time@10': 5.5992}:   3%|▎         | 1/30 [00:02<01:22,  2.84s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9152, 'compress@10': 0.0609, 'time@10': 5.2117}:   3%|▎         | 1/30 [00:07<01:22,  2.84s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9152, 'compress@10': 0.0609, 'time@10': 5.2117}:   7%|▋         | 2/30 [00:07<01:52,  4.03s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8959, 'compress@10': 0.0962, 'time@10': 4.6033}:   7%|▋         | 2/30 [00:09<01:52,  4.03s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8959, 'compress@10': 0.0962, 'time@10': 4.6033}:  10%|█         | 3/30 [00:09<01:20,  2.98s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8881, 'compress@10': 0.0861, 'time@10': 4.5689}:  10%|█         | 3/30 [00:13<01:20,  2.98s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8881, 'compress@10': 0.0861, 'time@10': 4.5689}:  13%|█▎        | 4/30 [00:13<01:33,  3.58s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.8713, 'compress@10': 0.0758, 'time@10': 5.3021}:  13%|█▎        | 4/30 [00:18<01:33,  3.58s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.8713, 'compress@10': 0.0758, 'time@10': 5.3021}:  17%|█▋        | 5/30 [00:18<01:34,  3.79s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0283, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.8824, 'compress@10': 0.0697, 'time@10': 5.6687}:  17%|█▋        | 5/30 [00:25<01:34,  3.79s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0283, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.8824, 'compress@10': 0.0697, 'time@10': 5.6687}:  20%|██        | 6/30 [00:25<02:01,  5.07s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0266, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.8895, 'compress@10': 0.07, 'time@10': 6.0748}:  20%|██        | 6/30 [00:29<02:01,  5.07s/it]  {'epoch': 32, 'num_users': 6.2857, 'loss': 0.0266, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.8895, 'compress@10': 0.07, 'time@10': 6.0748}:  23%|██▎       | 7/30 [00:29<01:50,  4.82s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0263, 'hit_ratio@10': 0.921, 'ndcg@10': 0.9013, 'compress@10': 0.0677, 'time@10': 6.0159}:  23%|██▎       | 7/30 [00:35<01:50,  4.82s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0263, 'hit_ratio@10': 0.921, 'ndcg@10': 0.9013, 'compress@10': 0.0677, 'time@10': 6.0159}:  27%|██▋       | 8/30 [00:35<01:51,  5.08s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.027, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9151, 'compress@10': 0.0652, 'time@10': 6.2311}:  27%|██▋       | 8/30 [00:39<01:51,  5.08s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.027, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9151, 'compress@10': 0.0652, 'time@10': 6.2311}:  30%|███       | 9/30 [00:39<01:39,  4.75s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.9145, 'ndcg@10': 0.9199, 'compress@10': 0.0626, 'time@10': 6.3167}:  30%|███       | 9/30 [00:46<01:39,  4.75s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.9145, 'ndcg@10': 0.9199, 'compress@10': 0.0626, 'time@10': 6.3167}:  33%|███▎      | 10/30 [00:46<01:49,  5.49s/it]{'epoch': 32, 'num_users': 6.6364, 'loss': 0.0269, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.917, 'compress@10': 0.0618, 'time@10': 6.4191}:  33%|███▎      | 10/30 [00:50<01:49,  5.49s/it]{'epoch': 32, 'num_users': 6.6364, 'loss': 0.0269, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.917, 'compress@10': 0.0618, 'time@10': 6.4191}:  37%|███▋      | 11/30 [00:50<01:34,  4.96s/it]{'epoch': 32, 'num_users': 6.4167, 'loss': 0.0249, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.917, 'compress@10': 0.0651, 'time@10': 6.1573}:  37%|███▋      | 11/30 [00:53<01:34,  4.96s/it]{'epoch': 32, 'num_users': 6.4167, 'loss': 0.0249, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.917, 'compress@10': 0.0651, 'time@10': 6.1573}:  40%|████      | 12/30 [00:53<01:20,  4.46s/it]{'epoch': 32, 'num_users': 6.6154, 'loss': 0.0252, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9148, 'compress@10': 0.0661, 'time@10': 6.1943}:  40%|████      | 12/30 [00:57<01:20,  4.46s/it]{'epoch': 32, 'num_users': 6.6154, 'loss': 0.0252, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9148, 'compress@10': 0.0661, 'time@10': 6.1943}:  43%|████▎     | 13/30 [00:57<01:10,  4.13s/it]{'epoch': 32, 'num_users': 6.3571, 'loss': 0.0234, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9089, 'compress@10': 0.0745, 'time@10': 5.9646}:  43%|████▎     | 13/30 [01:00<01:10,  4.13s/it]{'epoch': 32, 'num_users': 6.3571, 'loss': 0.0234, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9089, 'compress@10': 0.0745, 'time@10': 5.9646}:  47%|████▋     | 14/30 [01:00<01:00,  3.79s/it]{'epoch': 32, 'num_users': 6.2667, 'loss': 0.0234, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9089, 'compress@10': 0.0722, 'time@10': 6.0891}:  47%|████▋     | 14/30 [01:04<01:00,  3.79s/it]{'epoch': 32, 'num_users': 6.2667, 'loss': 0.0234, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9089, 'compress@10': 0.0722, 'time@10': 6.0891}:  50%|█████     | 15/30 [01:04<00:57,  3.84s/it]{'epoch': 32, 'num_users': 6.0625, 'loss': 0.0221, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9091, 'compress@10': 0.0745, 'time@10': 5.9257}:  50%|█████     | 15/30 [01:07<00:57,  3.84s/it]{'epoch': 32, 'num_users': 6.0625, 'loss': 0.0221, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9091, 'compress@10': 0.0745, 'time@10': 5.9257}:  53%|█████▎    | 16/30 [01:07<00:52,  3.74s/it]{'epoch': 32, 'num_users': 5.8235, 'loss': 0.0209, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9009, 'compress@10': 0.0827, 'time@10': 5.7914}:  53%|█████▎    | 16/30 [01:09<00:52,  3.74s/it]{'epoch': 32, 'num_users': 5.8235, 'loss': 0.0209, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9009, 'compress@10': 0.0827, 'time@10': 5.7914}:  57%|█████▋    | 17/30 [01:09<00:41,  3.18s/it]{'epoch': 32, 'num_users': 6.0556, 'loss': 0.0208, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9019, 'compress@10': 0.0809, 'time@10': 5.7199}:  57%|█████▋    | 17/30 [01:14<00:41,  3.18s/it]{'epoch': 32, 'num_users': 6.0556, 'loss': 0.0208, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9019, 'compress@10': 0.0809, 'time@10': 5.7199}:  60%|██████    | 18/30 [01:14<00:43,  3.59s/it]{'epoch': 32, 'num_users': 6.0, 'loss': 0.0202, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9023, 'compress@10': 0.0816, 'time@10': 5.6443}:  60%|██████    | 18/30 [01:16<00:43,  3.59s/it]   {'epoch': 32, 'num_users': 6.0, 'loss': 0.0202, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9023, 'compress@10': 0.0816, 'time@10': 5.6443}:  63%|██████▎   | 19/30 [01:16<00:34,  3.17s/it]{'epoch': 32, 'num_users': 6.15, 'loss': 0.0203, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9042, 'compress@10': 0.0788, 'time@10': 5.7848}:  63%|██████▎   | 19/30 [01:24<00:34,  3.17s/it]{'epoch': 32, 'num_users': 6.15, 'loss': 0.0203, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9042, 'compress@10': 0.0788, 'time@10': 5.7848}:  67%|██████▋   | 20/30 [01:24<00:47,  4.77s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9024, 'compress@10': 0.0778, 'time@10': 5.8664}:  67%|██████▋   | 20/30 [01:28<00:47,  4.77s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9024, 'compress@10': 0.0778, 'time@10': 5.8664}:  70%|███████   | 21/30 [01:28<00:40,  4.47s/it]{'epoch': 32, 'num_users': 6.1818, 'loss': 0.0216, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9029, 'compress@10': 0.077, 'time@10': 5.7558}:  70%|███████   | 21/30 [01:32<00:40,  4.47s/it] {'epoch': 32, 'num_users': 6.1818, 'loss': 0.0216, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9029, 'compress@10': 0.077, 'time@10': 5.7558}:  73%|███████▎  | 22/30 [01:32<00:33,  4.17s/it]{'epoch': 32, 'num_users': 6.1304, 'loss': 0.0213, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9036, 'compress@10': 0.0766, 'time@10': 5.778}:  73%|███████▎  | 22/30 [01:35<00:33,  4.17s/it]{'epoch': 32, 'num_users': 6.1304, 'loss': 0.0213, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9036, 'compress@10': 0.0766, 'time@10': 5.778}:  77%|███████▋  | 23/30 [01:35<00:27,  3.87s/it]{'epoch': 32, 'num_users': 5.9583, 'loss': 0.0204, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8993, 'compress@10': 0.0822, 'time@10': 5.6524}:  77%|███████▋  | 23/30 [01:38<00:27,  3.87s/it]{'epoch': 32, 'num_users': 5.9583, 'loss': 0.0204, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8993, 'compress@10': 0.0822, 'time@10': 5.6524}:  80%|████████  | 24/30 [01:38<00:21,  3.55s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0197, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.89, 'compress@10': 0.0928, 'time@10': 5.5363}:  80%|████████  | 24/30 [01:39<00:21,  3.55s/it]     {'epoch': 32, 'num_users': 5.8, 'loss': 0.0197, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.89, 'compress@10': 0.0928, 'time@10': 5.5363}:  83%|████████▎ | 25/30 [01:39<00:14,  2.91s/it]{'epoch': 32, 'num_users': 5.8077, 'loss': 0.0196, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8921, 'compress@10': 0.0903, 'time@10': 5.6092}:  83%|████████▎ | 25/30 [01:46<00:14,  2.91s/it]{'epoch': 32, 'num_users': 5.8077, 'loss': 0.0196, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8921, 'compress@10': 0.0903, 'time@10': 5.6092}:  87%|████████▋ | 26/30 [01:46<00:17,  4.28s/it]{'epoch': 32, 'num_users': 5.8889, 'loss': 0.0197, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8934, 'compress@10': 0.0893, 'time@10': 5.685}:  87%|████████▋ | 26/30 [01:50<00:17,  4.28s/it]  {'epoch': 32, 'num_users': 5.8889, 'loss': 0.0197, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8934, 'compress@10': 0.0893, 'time@10': 5.685}:  90%|█████████ | 27/30 [01:50<00:12,  4.16s/it]{'epoch': 32, 'num_users': 6.0, 'loss': 0.0198, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.8955, 'compress@10': 0.0877, 'time@10': 5.7574}:  90%|█████████ | 27/30 [01:58<00:12,  4.16s/it] {'epoch': 32, 'num_users': 6.0, 'loss': 0.0198, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.8955, 'compress@10': 0.0877, 'time@10': 5.7574}:  93%|█████████▎| 28/30 [01:58<00:10,  5.24s/it]{'epoch': 32, 'num_users': 5.8621, 'loss': 0.0195, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8975, 'compress@10': 0.0868, 'time@10': 5.7964}:  93%|█████████▎| 28/30 [02:02<00:10,  5.24s/it]{'epoch': 32, 'num_users': 5.8621, 'loss': 0.0195, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8975, 'compress@10': 0.0868, 'time@10': 5.7964}:  97%|█████████▋| 29/30 [02:02<00:04,  4.71s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0198, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8977, 'compress@10': 0.0857, 'time@10': 5.7878}:  97%|█████████▋| 29/30 [02:07<00:04,  4.71s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0198, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8977, 'compress@10': 0.0857, 'time@10': 5.7878}: 100%|██████████| 30/30 [02:07<00:00,  4.97s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0198, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8977, 'compress@10': 0.0857, 'time@10': 5.7878}: 100%|██████████| 30/30 [02:07<00:00,  4.25s/it]
Epoch: 32
Avg # of users: 5.866666666666666
Avg Loss: 0.019814967350072075
Avg hit ratio: 0.8786445526069662
Avg ndcg: 0.8977444822783066
Avg compression ratio: 0.08570467769154336
Avg train time: 5.787762443224589
Std train time: 1.9346554380657184
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 42, 8, 20, 28, 10, 10, 9, 6, 11, 10, 43, 43, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.895, 'compress@10': 0.0662, 'time@10': 5.6467}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.895, 'compress@10': 0.0662, 'time@10': 5.6467}:   3%|▎         | 1/30 [00:02<01:23,  2.87s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.913, 'compress@10': 0.0611, 'time@10': 5.314}:   3%|▎         | 1/30 [00:07<01:23,  2.87s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.913, 'compress@10': 0.0611, 'time@10': 5.314}:   7%|▋         | 2/30 [00:07<01:55,  4.14s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8944, 'compress@10': 0.0961, 'time@10': 4.6733}:   7%|▋         | 2/30 [00:09<01:55,  4.14s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8944, 'compress@10': 0.0961, 'time@10': 4.6733}:  10%|█         | 3/30 [00:09<01:22,  3.04s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8955, 'compress@10': 0.0864, 'time@10': 4.6236}:  10%|█         | 3/30 [00:14<01:22,  3.04s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8955, 'compress@10': 0.0864, 'time@10': 4.6236}:  13%|█▎        | 4/30 [00:14<01:34,  3.62s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0251, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8788, 'compress@10': 0.0757, 'time@10': 5.3547}:  13%|█▎        | 4/30 [00:18<01:34,  3.62s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0251, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8788, 'compress@10': 0.0757, 'time@10': 5.3547}:  17%|█▋        | 5/30 [00:18<01:35,  3.82s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.8905, 'compress@10': 0.0695, 'time@10': 5.6813}:  17%|█▋        | 5/30 [00:25<01:35,  3.82s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.8905, 'compress@10': 0.0695, 'time@10': 5.6813}:  20%|██        | 6/30 [00:25<02:00,  5.02s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.024, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.8934, 'compress@10': 0.0695, 'time@10': 6.0032}:  20%|██        | 6/30 [00:29<02:00,  5.02s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.024, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.8934, 'compress@10': 0.0695, 'time@10': 6.0032}:  23%|██▎       | 7/30 [00:29<01:47,  4.69s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.024, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9065, 'compress@10': 0.0673, 'time@10': 5.9804}:  23%|██▎       | 7/30 [00:35<01:47,  4.69s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.024, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9065, 'compress@10': 0.0673, 'time@10': 5.9804}:  27%|██▋       | 8/30 [00:35<01:51,  5.07s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0249, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9218, 'compress@10': 0.0648, 'time@10': 6.1991}:  27%|██▋       | 8/30 [00:39<01:51,  5.07s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0249, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9218, 'compress@10': 0.0648, 'time@10': 6.1991}:  30%|███       | 9/30 [00:39<01:39,  4.74s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9269, 'compress@10': 0.0625, 'time@10': 6.2909}:  30%|███       | 9/30 [00:46<01:39,  4.74s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9269, 'compress@10': 0.0625, 'time@10': 6.2909}:  33%|███▎      | 10/30 [00:46<01:49,  5.49s/it]{'epoch': 33, 'num_users': 6.6364, 'loss': 0.0252, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9239, 'compress@10': 0.0618, 'time@10': 6.4081}:  33%|███▎      | 10/30 [00:50<01:49,  5.49s/it]{'epoch': 33, 'num_users': 6.6364, 'loss': 0.0252, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9239, 'compress@10': 0.0618, 'time@10': 6.4081}:  37%|███▋      | 11/30 [00:50<01:34,  4.98s/it]{'epoch': 33, 'num_users': 6.4167, 'loss': 0.0233, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9233, 'compress@10': 0.065, 'time@10': 6.1616}:  37%|███▋      | 11/30 [00:54<01:34,  4.98s/it]  {'epoch': 33, 'num_users': 6.4167, 'loss': 0.0233, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9233, 'compress@10': 0.065, 'time@10': 6.1616}:  40%|████      | 12/30 [00:54<01:21,  4.53s/it]{'epoch': 33, 'num_users': 6.6154, 'loss': 0.0238, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9209, 'compress@10': 0.0658, 'time@10': 6.2548}:  40%|████      | 12/30 [00:57<01:21,  4.53s/it]{'epoch': 33, 'num_users': 6.6154, 'loss': 0.0238, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9209, 'compress@10': 0.0658, 'time@10': 6.2548}:  43%|████▎     | 13/30 [00:57<01:12,  4.28s/it]{'epoch': 33, 'num_users': 6.3571, 'loss': 0.0222, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9146, 'compress@10': 0.0742, 'time@10': 6.0262}:  43%|████▎     | 13/30 [01:00<01:12,  4.28s/it]{'epoch': 33, 'num_users': 6.3571, 'loss': 0.0222, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9146, 'compress@10': 0.0742, 'time@10': 6.0262}:  47%|████▋     | 14/30 [01:00<01:02,  3.92s/it]{'epoch': 33, 'num_users': 6.2667, 'loss': 0.0221, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9148, 'compress@10': 0.0719, 'time@10': 6.2016}:  47%|████▋     | 14/30 [01:05<01:02,  3.92s/it]{'epoch': 33, 'num_users': 6.2667, 'loss': 0.0221, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9148, 'compress@10': 0.0719, 'time@10': 6.2016}:  50%|█████     | 15/30 [01:05<01:01,  4.07s/it]{'epoch': 33, 'num_users': 6.0625, 'loss': 0.0209, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9149, 'compress@10': 0.0742, 'time@10': 6.0407}:  50%|█████     | 15/30 [01:08<01:01,  4.07s/it]{'epoch': 33, 'num_users': 6.0625, 'loss': 0.0209, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9149, 'compress@10': 0.0742, 'time@10': 6.0407}:  53%|█████▎    | 16/30 [01:08<00:55,  3.95s/it]{'epoch': 33, 'num_users': 5.8235, 'loss': 0.0197, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.9064, 'compress@10': 0.0825, 'time@10': 5.9239}:  53%|█████▎    | 16/30 [01:11<00:55,  3.95s/it]{'epoch': 33, 'num_users': 5.8235, 'loss': 0.0197, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.9064, 'compress@10': 0.0825, 'time@10': 5.9239}:  57%|█████▋    | 17/30 [01:11<00:44,  3.39s/it]{'epoch': 33, 'num_users': 6.0556, 'loss': 0.0196, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9072, 'compress@10': 0.0806, 'time@10': 5.8455}:  57%|█████▋    | 17/30 [01:15<00:44,  3.39s/it]{'epoch': 33, 'num_users': 6.0556, 'loss': 0.0196, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9072, 'compress@10': 0.0806, 'time@10': 5.8455}:  60%|██████    | 18/30 [01:15<00:44,  3.74s/it]{'epoch': 33, 'num_users': 6.0, 'loss': 0.0191, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.9076, 'compress@10': 0.0813, 'time@10': 5.7645}:  60%|██████    | 18/30 [01:17<00:44,  3.74s/it]   {'epoch': 33, 'num_users': 6.0, 'loss': 0.0191, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.9076, 'compress@10': 0.0813, 'time@10': 5.7645}:  63%|██████▎   | 19/30 [01:17<00:36,  3.27s/it]{'epoch': 33, 'num_users': 6.15, 'loss': 0.0192, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9094, 'compress@10': 0.0786, 'time@10': 5.8957}:  63%|██████▎   | 19/30 [01:26<00:36,  3.27s/it]{'epoch': 33, 'num_users': 6.15, 'loss': 0.0192, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9094, 'compress@10': 0.0786, 'time@10': 5.8957}:  67%|██████▋   | 20/30 [01:26<00:48,  4.82s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9078, 'compress@10': 0.0776, 'time@10': 5.9555}:  67%|██████▋   | 20/30 [01:29<00:48,  4.82s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9078, 'compress@10': 0.0776, 'time@10': 5.9555}:  70%|███████   | 21/30 [01:29<00:40,  4.46s/it]{'epoch': 33, 'num_users': 6.1818, 'loss': 0.0206, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9084, 'compress@10': 0.0768, 'time@10': 5.8521}:  70%|███████   | 21/30 [01:33<00:40,  4.46s/it]{'epoch': 33, 'num_users': 6.1818, 'loss': 0.0206, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9084, 'compress@10': 0.0768, 'time@10': 5.8521}:  73%|███████▎  | 22/30 [01:33<00:33,  4.24s/it]{'epoch': 33, 'num_users': 6.1304, 'loss': 0.0202, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9089, 'compress@10': 0.0765, 'time@10': 5.8706}:  73%|███████▎  | 22/30 [01:36<00:33,  4.24s/it]{'epoch': 33, 'num_users': 6.1304, 'loss': 0.0202, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9089, 'compress@10': 0.0765, 'time@10': 5.8706}:  77%|███████▋  | 23/30 [01:36<00:27,  3.92s/it]{'epoch': 33, 'num_users': 5.9583, 'loss': 0.0194, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9044, 'compress@10': 0.0821, 'time@10': 5.7469}:  77%|███████▋  | 23/30 [01:39<00:27,  3.92s/it]{'epoch': 33, 'num_users': 5.9583, 'loss': 0.0194, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9044, 'compress@10': 0.0821, 'time@10': 5.7469}:  80%|████████  | 24/30 [01:39<00:21,  3.63s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8948, 'compress@10': 0.0927, 'time@10': 5.6337}:  80%|████████  | 24/30 [01:41<00:21,  3.63s/it]   {'epoch': 33, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8948, 'compress@10': 0.0927, 'time@10': 5.6337}:  83%|████████▎ | 25/30 [01:41<00:14,  2.99s/it]{'epoch': 33, 'num_users': 5.8077, 'loss': 0.0186, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8969, 'compress@10': 0.0902, 'time@10': 5.7042}:  83%|████████▎ | 25/30 [01:48<00:14,  2.99s/it]{'epoch': 33, 'num_users': 5.8077, 'loss': 0.0186, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8969, 'compress@10': 0.0902, 'time@10': 5.7042}:  87%|████████▋ | 26/30 [01:48<00:17,  4.34s/it]{'epoch': 33, 'num_users': 5.8889, 'loss': 0.0188, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.898, 'compress@10': 0.0892, 'time@10': 5.7652}:  87%|████████▋ | 26/30 [01:52<00:17,  4.34s/it] {'epoch': 33, 'num_users': 5.8889, 'loss': 0.0188, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.898, 'compress@10': 0.0892, 'time@10': 5.7652}:  90%|█████████ | 27/30 [01:52<00:12,  4.16s/it]{'epoch': 33, 'num_users': 6.0, 'loss': 0.0195, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8995, 'compress@10': 0.0876, 'time@10': 5.8129}:  90%|█████████ | 27/30 [01:59<00:12,  4.16s/it]  {'epoch': 33, 'num_users': 6.0, 'loss': 0.0195, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8995, 'compress@10': 0.0876, 'time@10': 5.8129}:  93%|█████████▎| 28/30 [01:59<00:10,  5.05s/it]{'epoch': 33, 'num_users': 5.8621, 'loss': 0.0193, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9011, 'compress@10': 0.0867, 'time@10': 5.8517}:  93%|█████████▎| 28/30 [02:03<00:10,  5.05s/it]{'epoch': 33, 'num_users': 5.8621, 'loss': 0.0193, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9011, 'compress@10': 0.0867, 'time@10': 5.8517}:  97%|█████████▋| 29/30 [02:03<00:04,  4.59s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0196, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9022, 'compress@10': 0.0856, 'time@10': 5.8423}:  97%|█████████▋| 29/30 [02:08<00:04,  4.59s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0196, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9022, 'compress@10': 0.0856, 'time@10': 5.8423}: 100%|██████████| 30/30 [02:08<00:00,  4.90s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0196, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9022, 'compress@10': 0.0856, 'time@10': 5.8423}: 100%|██████████| 30/30 [02:08<00:00,  4.29s/it]
Epoch: 33
Avg # of users: 5.866666666666666
Avg Loss: 0.019594474429826668
Avg hit ratio: 0.875329893409954
Avg ndcg: 0.9022172757406921
Avg compression ratio: 0.08560331933626623
Avg train time: 5.842290663719178
Std train time: 1.8642653109230236
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 43, 8, 20, 28, 10, 10, 9, 6, 11, 10, 44, 44, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8921, 'compress@10': 0.0668, 'time@10': 5.9018}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8921, 'compress@10': 0.0668, 'time@10': 5.9018}:   3%|▎         | 1/30 [00:02<01:26,  2.99s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9116, 'compress@10': 0.062, 'time@10': 5.2926}:   3%|▎         | 1/30 [00:07<01:26,  2.99s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9116, 'compress@10': 0.062, 'time@10': 5.2926}:   7%|▋         | 2/30 [00:07<01:52,  4.01s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8934, 'compress@10': 0.0964, 'time@10': 4.6546}:   7%|▋         | 2/30 [00:09<01:52,  4.01s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8934, 'compress@10': 0.0964, 'time@10': 4.6546}:  10%|█         | 3/30 [00:09<01:20,  2.97s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.908, 'compress@10': 0.0867, 'time@10': 4.6033}:  10%|█         | 3/30 [00:13<01:20,  2.97s/it]  {'epoch': 34, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.908, 'compress@10': 0.0867, 'time@10': 4.6033}:  13%|█▎        | 4/30 [00:13<01:32,  3.57s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0219, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.8889, 'compress@10': 0.0757, 'time@10': 5.3196}:  13%|█▎        | 4/30 [00:18<01:32,  3.57s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0219, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.8889, 'compress@10': 0.0757, 'time@10': 5.3196}:  17%|█▋        | 5/30 [00:18<01:34,  3.77s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0222, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.897, 'compress@10': 0.0693, 'time@10': 5.6446}:  17%|█▋        | 5/30 [00:25<01:34,  3.77s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0222, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.897, 'compress@10': 0.0693, 'time@10': 5.6446}:  20%|██        | 6/30 [00:25<01:59,  4.97s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0222, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.8967, 'compress@10': 0.0692, 'time@10': 5.9776}:  20%|██        | 6/30 [00:29<01:59,  4.97s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0222, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.8967, 'compress@10': 0.0692, 'time@10': 5.9776}:  23%|██▎       | 7/30 [00:29<01:47,  4.67s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0224, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9095, 'compress@10': 0.0669, 'time@10': 5.9071}:  23%|██▎       | 7/30 [00:34<01:47,  4.67s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0224, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9095, 'compress@10': 0.0669, 'time@10': 5.9071}:  27%|██▋       | 8/30 [00:34<01:48,  4.92s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.915, 'compress@10': 0.0645, 'time@10': 6.128}:  27%|██▋       | 8/30 [00:38<01:48,  4.92s/it] {'epoch': 34, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.915, 'compress@10': 0.0645, 'time@10': 6.128}:  30%|███       | 9/30 [00:38<01:37,  4.64s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9174, 'compress@10': 0.0616, 'time@10': 6.2246}:  30%|███       | 9/30 [00:46<01:37,  4.64s/it] {'epoch': 34, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9174, 'compress@10': 0.0616, 'time@10': 6.2246}:  33%|███▎      | 10/30 [00:46<01:48,  5.41s/it]{'epoch': 34, 'num_users': 6.6364, 'loss': 0.0247, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9144, 'compress@10': 0.061, 'time@10': 6.3439}:  33%|███▎      | 10/30 [00:49<01:48,  5.41s/it]{'epoch': 34, 'num_users': 6.6364, 'loss': 0.0247, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9144, 'compress@10': 0.061, 'time@10': 6.3439}:  37%|███▋      | 11/30 [00:49<01:33,  4.92s/it]{'epoch': 34, 'num_users': 6.4167, 'loss': 0.0228, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9146, 'compress@10': 0.0644, 'time@10': 6.1043}:  37%|███▋      | 11/30 [00:53<01:33,  4.92s/it]{'epoch': 34, 'num_users': 6.4167, 'loss': 0.0228, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9146, 'compress@10': 0.0644, 'time@10': 6.1043}:  40%|████      | 12/30 [00:53<01:20,  4.49s/it]{'epoch': 34, 'num_users': 6.6154, 'loss': 0.0232, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9131, 'compress@10': 0.0653, 'time@10': 6.157}:  40%|████      | 12/30 [00:56<01:20,  4.49s/it] {'epoch': 34, 'num_users': 6.6154, 'loss': 0.0232, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9131, 'compress@10': 0.0653, 'time@10': 6.157}:  43%|████▎     | 13/30 [00:56<01:10,  4.17s/it]{'epoch': 34, 'num_users': 6.3571, 'loss': 0.0216, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9074, 'compress@10': 0.0738, 'time@10': 5.9466}:  43%|████▎     | 13/30 [01:00<01:10,  4.17s/it]{'epoch': 34, 'num_users': 6.3571, 'loss': 0.0216, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9074, 'compress@10': 0.0738, 'time@10': 5.9466}:  47%|████▋     | 14/30 [01:00<01:02,  3.89s/it]{'epoch': 34, 'num_users': 6.2667, 'loss': 0.0223, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9039, 'compress@10': 0.0716, 'time@10': 6.0394}:  47%|████▋     | 14/30 [01:03<01:02,  3.89s/it]{'epoch': 34, 'num_users': 6.2667, 'loss': 0.0223, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9039, 'compress@10': 0.0716, 'time@10': 6.0394}:  50%|█████     | 15/30 [01:03<00:57,  3.84s/it]{'epoch': 34, 'num_users': 6.0625, 'loss': 0.0211, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9047, 'compress@10': 0.0739, 'time@10': 5.8879}:  50%|█████     | 15/30 [01:07<00:57,  3.84s/it]{'epoch': 34, 'num_users': 6.0625, 'loss': 0.0211, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9047, 'compress@10': 0.0739, 'time@10': 5.8879}:  53%|█████▎    | 16/30 [01:07<00:52,  3.78s/it]{'epoch': 34, 'num_users': 5.8235, 'loss': 0.0199, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8968, 'compress@10': 0.0821, 'time@10': 5.7557}:  53%|█████▎    | 16/30 [01:09<00:52,  3.78s/it]{'epoch': 34, 'num_users': 5.8235, 'loss': 0.0199, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8968, 'compress@10': 0.0821, 'time@10': 5.7557}:  57%|█████▋    | 17/30 [01:09<00:41,  3.20s/it]{'epoch': 34, 'num_users': 6.0556, 'loss': 0.0198, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8982, 'compress@10': 0.0801, 'time@10': 5.6858}:  57%|█████▋    | 17/30 [01:13<00:41,  3.20s/it]{'epoch': 34, 'num_users': 6.0556, 'loss': 0.0198, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8982, 'compress@10': 0.0801, 'time@10': 5.6858}:  60%|██████    | 18/30 [01:13<00:43,  3.61s/it]{'epoch': 34, 'num_users': 6.0, 'loss': 0.0191, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8996, 'compress@10': 0.0809, 'time@10': 5.6113}:  60%|██████    | 18/30 [01:15<00:43,  3.61s/it]   {'epoch': 34, 'num_users': 6.0, 'loss': 0.0191, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8996, 'compress@10': 0.0809, 'time@10': 5.6113}:  63%|██████▎   | 19/30 [01:15<00:34,  3.18s/it]{'epoch': 34, 'num_users': 6.15, 'loss': 0.0192, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9018, 'compress@10': 0.0781, 'time@10': 5.7494}:  63%|██████▎   | 19/30 [01:24<00:34,  3.18s/it]{'epoch': 34, 'num_users': 6.15, 'loss': 0.0192, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9018, 'compress@10': 0.0781, 'time@10': 5.7494}:  67%|██████▋   | 20/30 [01:24<00:47,  4.75s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9, 'compress@10': 0.077, 'time@10': 5.832}:  67%|██████▋   | 20/30 [01:28<00:47,  4.75s/it]   {'epoch': 34, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9, 'compress@10': 0.077, 'time@10': 5.832}:  70%|███████   | 21/30 [01:28<00:40,  4.46s/it]{'epoch': 34, 'num_users': 6.1818, 'loss': 0.0202, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9009, 'compress@10': 0.0762, 'time@10': 5.7243}:  70%|███████   | 21/30 [01:31<00:40,  4.46s/it]{'epoch': 34, 'num_users': 6.1818, 'loss': 0.0202, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9009, 'compress@10': 0.0762, 'time@10': 5.7243}:  73%|███████▎  | 22/30 [01:31<00:33,  4.18s/it]{'epoch': 34, 'num_users': 6.1304, 'loss': 0.0198, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.902, 'compress@10': 0.0759, 'time@10': 5.7474}:  73%|███████▎  | 22/30 [01:34<00:33,  4.18s/it] {'epoch': 34, 'num_users': 6.1304, 'loss': 0.0198, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.902, 'compress@10': 0.0759, 'time@10': 5.7474}:  77%|███████▋  | 23/30 [01:34<00:27,  3.87s/it]{'epoch': 34, 'num_users': 5.9583, 'loss': 0.019, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8978, 'compress@10': 0.0816, 'time@10': 5.6287}:  77%|███████▋  | 23/30 [01:37<00:27,  3.87s/it]{'epoch': 34, 'num_users': 5.9583, 'loss': 0.019, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8978, 'compress@10': 0.0816, 'time@10': 5.6287}:  80%|████████  | 24/30 [01:37<00:21,  3.59s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0183, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8885, 'compress@10': 0.0923, 'time@10': 5.5271}:  80%|████████  | 24/30 [01:39<00:21,  3.59s/it]  {'epoch': 34, 'num_users': 5.8, 'loss': 0.0183, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8885, 'compress@10': 0.0923, 'time@10': 5.5271}:  83%|████████▎ | 25/30 [01:39<00:14,  2.99s/it]{'epoch': 34, 'num_users': 5.8077, 'loss': 0.0182, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8909, 'compress@10': 0.0898, 'time@10': 5.6171}:  83%|████████▎ | 25/30 [01:47<00:14,  2.99s/it]{'epoch': 34, 'num_users': 5.8077, 'loss': 0.0182, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8909, 'compress@10': 0.0898, 'time@10': 5.6171}:  87%|████████▋ | 26/30 [01:47<00:17,  4.46s/it]{'epoch': 34, 'num_users': 5.8889, 'loss': 0.0184, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.8922, 'compress@10': 0.0886, 'time@10': 5.7118}:  87%|████████▋ | 26/30 [01:51<00:17,  4.46s/it]{'epoch': 34, 'num_users': 5.8889, 'loss': 0.0184, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.8922, 'compress@10': 0.0886, 'time@10': 5.7118}:  90%|█████████ | 27/30 [01:51<00:13,  4.37s/it]{'epoch': 34, 'num_users': 6.0, 'loss': 0.0189, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.8923, 'compress@10': 0.087, 'time@10': 5.7554}:  90%|█████████ | 27/30 [01:58<00:13,  4.37s/it]    {'epoch': 34, 'num_users': 6.0, 'loss': 0.0189, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.8923, 'compress@10': 0.087, 'time@10': 5.7554}:  93%|█████████▎| 28/30 [01:58<00:10,  5.15s/it]{'epoch': 34, 'num_users': 5.8621, 'loss': 0.0187, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.8943, 'compress@10': 0.0861, 'time@10': 5.7952}:  93%|█████████▎| 28/30 [02:01<00:10,  5.15s/it]{'epoch': 34, 'num_users': 5.8621, 'loss': 0.0187, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.8943, 'compress@10': 0.0861, 'time@10': 5.7952}:  97%|█████████▋| 29/30 [02:01<00:04,  4.66s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.019, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8946, 'compress@10': 0.0851, 'time@10': 5.816}:  97%|█████████▋| 29/30 [02:08<00:04,  4.66s/it]  {'epoch': 34, 'num_users': 5.8667, 'loss': 0.019, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8946, 'compress@10': 0.0851, 'time@10': 5.816}: 100%|██████████| 30/30 [02:08<00:00,  5.20s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.019, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8946, 'compress@10': 0.0851, 'time@10': 5.816}: 100%|██████████| 30/30 [02:08<00:00,  4.28s/it]
Epoch: 34
Avg # of users: 5.866666666666666
Avg Loss: 0.018987052320806497
Avg hit ratio: 0.8761539237158652
Avg ndcg: 0.8945785865894945
Avg compression ratio: 0.08510018768692626
Avg train time: 5.815955646832784
Std train time: 1.856482820293254
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 43, 8, 20, 28, 10, 10, 9, 6, 11, 10, 45, 45, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8921, 'compress@10': 0.0675, 'time@10': 5.4296}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8921, 'compress@10': 0.0675, 'time@10': 5.4296}:   3%|▎         | 1/30 [00:02<01:19,  2.75s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9116, 'compress@10': 0.0604, 'time@10': 4.9923}:   3%|▎         | 1/30 [00:07<01:19,  2.75s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9116, 'compress@10': 0.0604, 'time@10': 4.9923}:   7%|▋         | 2/30 [00:07<01:47,  3.83s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8934, 'compress@10': 0.095, 'time@10': 4.5438}:   7%|▋         | 2/30 [00:09<01:47,  3.83s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8934, 'compress@10': 0.095, 'time@10': 4.5438}:  10%|█         | 3/30 [00:09<01:19,  2.94s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9058, 'compress@10': 0.086, 'time@10': 4.5802}:  10%|█         | 3/30 [00:13<01:19,  2.94s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9058, 'compress@10': 0.086, 'time@10': 4.5802}:  13%|█▎        | 4/30 [00:13<01:34,  3.64s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0217, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.8888, 'compress@10': 0.075, 'time@10': 5.2829}:  13%|█▎        | 4/30 [00:18<01:34,  3.64s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0217, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.8888, 'compress@10': 0.075, 'time@10': 5.2829}:  17%|█▋        | 5/30 [00:18<01:35,  3.80s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0202, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.8997, 'compress@10': 0.0682, 'time@10': 5.6122}:  17%|█▋        | 5/30 [00:25<01:35,  3.80s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0202, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.8997, 'compress@10': 0.0682, 'time@10': 5.6122}:  20%|██        | 6/30 [00:25<01:59,  4.99s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0192, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9045, 'compress@10': 0.0685, 'time@10': 5.946}:  20%|██        | 6/30 [00:29<01:59,  4.99s/it] {'epoch': 35, 'num_users': 6.2857, 'loss': 0.0192, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9045, 'compress@10': 0.0685, 'time@10': 5.946}:  23%|██▎       | 7/30 [00:29<01:47,  4.67s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0197, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9164, 'compress@10': 0.0663, 'time@10': 5.9017}:  23%|██▎       | 7/30 [00:34<01:47,  4.67s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0197, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9164, 'compress@10': 0.0663, 'time@10': 5.9017}:  27%|██▋       | 8/30 [00:34<01:49,  4.98s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9211, 'compress@10': 0.0641, 'time@10': 6.122}:  27%|██▋       | 8/30 [00:38<01:49,  4.98s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9211, 'compress@10': 0.0641, 'time@10': 6.122}:  30%|███       | 9/30 [00:38<01:38,  4.67s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9259, 'compress@10': 0.0609, 'time@10': 6.2704}:  30%|███       | 9/30 [00:46<01:38,  4.67s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9259, 'compress@10': 0.0609, 'time@10': 6.2704}:  33%|███▎      | 10/30 [00:46<01:51,  5.59s/it]{'epoch': 35, 'num_users': 6.6364, 'loss': 0.0204, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9225, 'compress@10': 0.0603, 'time@10': 6.3839}:  33%|███▎      | 10/30 [00:50<01:51,  5.59s/it]{'epoch': 35, 'num_users': 6.6364, 'loss': 0.0204, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9225, 'compress@10': 0.0603, 'time@10': 6.3839}:  37%|███▋      | 11/30 [00:50<01:35,  5.04s/it]{'epoch': 35, 'num_users': 6.4167, 'loss': 0.0189, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.922, 'compress@10': 0.0639, 'time@10': 6.1382}:  37%|███▋      | 11/30 [00:53<01:35,  5.04s/it] {'epoch': 35, 'num_users': 6.4167, 'loss': 0.0189, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.922, 'compress@10': 0.0639, 'time@10': 6.1382}:  40%|████      | 12/30 [00:53<01:22,  4.56s/it]{'epoch': 35, 'num_users': 6.6154, 'loss': 0.0195, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9199, 'compress@10': 0.0648, 'time@10': 6.1869}:  40%|████      | 12/30 [00:57<01:22,  4.56s/it]{'epoch': 35, 'num_users': 6.6154, 'loss': 0.0195, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9199, 'compress@10': 0.0648, 'time@10': 6.1869}:  43%|████▎     | 13/30 [00:57<01:11,  4.22s/it]{'epoch': 35, 'num_users': 6.3571, 'loss': 0.0182, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9137, 'compress@10': 0.0733, 'time@10': 5.9716}:  43%|████▎     | 13/30 [01:00<01:11,  4.22s/it]{'epoch': 35, 'num_users': 6.3571, 'loss': 0.0182, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9137, 'compress@10': 0.0733, 'time@10': 5.9716}:  47%|████▋     | 14/30 [01:00<01:02,  3.92s/it]{'epoch': 35, 'num_users': 6.2667, 'loss': 0.0179, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9145, 'compress@10': 0.0711, 'time@10': 6.082}:  47%|████▋     | 14/30 [01:04<01:02,  3.92s/it] {'epoch': 35, 'num_users': 6.2667, 'loss': 0.0179, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9145, 'compress@10': 0.0711, 'time@10': 6.082}:  50%|█████     | 15/30 [01:04<00:58,  3.90s/it]{'epoch': 35, 'num_users': 6.0625, 'loss': 0.017, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9146, 'compress@10': 0.0734, 'time@10': 5.9216}:  50%|█████     | 15/30 [01:07<00:58,  3.90s/it]{'epoch': 35, 'num_users': 6.0625, 'loss': 0.017, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9146, 'compress@10': 0.0734, 'time@10': 5.9216}:  53%|█████▎    | 16/30 [01:07<00:53,  3.79s/it]{'epoch': 35, 'num_users': 5.8235, 'loss': 0.016, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9079, 'compress@10': 0.0816, 'time@10': 5.7889}:  53%|█████▎    | 16/30 [01:09<00:53,  3.79s/it]{'epoch': 35, 'num_users': 5.8235, 'loss': 0.016, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9079, 'compress@10': 0.0816, 'time@10': 5.7889}:  57%|█████▋    | 17/30 [01:09<00:41,  3.22s/it]{'epoch': 35, 'num_users': 6.0556, 'loss': 0.016, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.9086, 'compress@10': 0.0794, 'time@10': 5.7197}:  57%|█████▋    | 17/30 [01:14<00:41,  3.22s/it]{'epoch': 35, 'num_users': 6.0556, 'loss': 0.016, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.9086, 'compress@10': 0.0794, 'time@10': 5.7197}:  60%|██████    | 18/30 [01:14<00:43,  3.63s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 0.0156, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9094, 'compress@10': 0.0801, 'time@10': 5.6391}:  60%|██████    | 18/30 [01:16<00:43,  3.63s/it]  {'epoch': 35, 'num_users': 6.0, 'loss': 0.0156, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9094, 'compress@10': 0.0801, 'time@10': 5.6391}:  63%|██████▎   | 19/30 [01:16<00:34,  3.18s/it]{'epoch': 35, 'num_users': 6.15, 'loss': 0.0158, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.912, 'compress@10': 0.0774, 'time@10': 5.7757}:  63%|██████▎   | 19/30 [01:24<00:34,  3.18s/it]{'epoch': 35, 'num_users': 6.15, 'loss': 0.0158, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.912, 'compress@10': 0.0774, 'time@10': 5.7757}:  67%|██████▋   | 20/30 [01:24<00:47,  4.75s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9101, 'compress@10': 0.0765, 'time@10': 5.8359}:  67%|██████▋   | 20/30 [01:28<00:47,  4.75s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9101, 'compress@10': 0.0765, 'time@10': 5.8359}:  70%|███████   | 21/30 [01:28<00:39,  4.39s/it]{'epoch': 35, 'num_users': 6.1818, 'loss': 0.0172, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9099, 'compress@10': 0.0756, 'time@10': 5.7362}:  70%|███████   | 21/30 [01:32<00:39,  4.39s/it]{'epoch': 35, 'num_users': 6.1818, 'loss': 0.0172, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9099, 'compress@10': 0.0756, 'time@10': 5.7362}:  73%|███████▎  | 22/30 [01:32<00:33,  4.18s/it]{'epoch': 35, 'num_users': 6.1304, 'loss': 0.017, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9106, 'compress@10': 0.0753, 'time@10': 5.7543}:  73%|███████▎  | 22/30 [01:35<00:33,  4.18s/it] {'epoch': 35, 'num_users': 6.1304, 'loss': 0.017, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9106, 'compress@10': 0.0753, 'time@10': 5.7543}:  77%|███████▋  | 23/30 [01:35<00:27,  3.86s/it]{'epoch': 35, 'num_users': 5.9583, 'loss': 0.0163, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.906, 'compress@10': 0.081, 'time@10': 5.6343}:  77%|███████▋  | 23/30 [01:38<00:27,  3.86s/it] {'epoch': 35, 'num_users': 5.9583, 'loss': 0.0163, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.906, 'compress@10': 0.081, 'time@10': 5.6343}:  80%|████████  | 24/30 [01:38<00:21,  3.58s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0157, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8964, 'compress@10': 0.0917, 'time@10': 5.5293}:  80%|████████  | 24/30 [01:39<00:21,  3.58s/it] {'epoch': 35, 'num_users': 5.8, 'loss': 0.0157, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8964, 'compress@10': 0.0917, 'time@10': 5.5293}:  83%|████████▎ | 25/30 [01:39<00:14,  2.97s/it]{'epoch': 35, 'num_users': 5.8077, 'loss': 0.0157, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8987, 'compress@10': 0.0893, 'time@10': 5.6062}:  83%|████████▎ | 25/30 [01:47<00:14,  2.97s/it]{'epoch': 35, 'num_users': 5.8077, 'loss': 0.0157, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8987, 'compress@10': 0.0893, 'time@10': 5.6062}:  87%|████████▋ | 26/30 [01:47<00:17,  4.35s/it]{'epoch': 35, 'num_users': 5.8889, 'loss': 0.0159, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.8998, 'compress@10': 0.0879, 'time@10': 5.6767}:  87%|████████▋ | 26/30 [01:51<00:17,  4.35s/it]{'epoch': 35, 'num_users': 5.8889, 'loss': 0.0159, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.8998, 'compress@10': 0.0879, 'time@10': 5.6767}:  90%|█████████ | 27/30 [01:51<00:12,  4.18s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 0.016, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9019, 'compress@10': 0.0859, 'time@10': 5.7481}:  90%|█████████ | 27/30 [01:58<00:12,  4.18s/it]    {'epoch': 35, 'num_users': 6.0, 'loss': 0.016, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9019, 'compress@10': 0.0859, 'time@10': 5.7481}:  93%|█████████▎| 28/30 [01:58<00:10,  5.24s/it]{'epoch': 35, 'num_users': 5.8621, 'loss': 0.0158, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9036, 'compress@10': 0.0851, 'time@10': 5.7874}:  93%|█████████▎| 28/30 [02:02<00:10,  5.24s/it]{'epoch': 35, 'num_users': 5.8621, 'loss': 0.0158, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9036, 'compress@10': 0.0851, 'time@10': 5.7874}:  97%|█████████▋| 29/30 [02:02<00:04,  4.71s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0162, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9039, 'compress@10': 0.0841, 'time@10': 5.7945}:  97%|█████████▋| 29/30 [02:08<00:04,  4.71s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0162, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9039, 'compress@10': 0.0841, 'time@10': 5.7945}: 100%|██████████| 30/30 [02:08<00:00,  5.11s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0162, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9039, 'compress@10': 0.0841, 'time@10': 5.7945}: 100%|██████████| 30/30 [02:08<00:00,  4.28s/it]
Epoch: 35
Avg # of users: 5.866666666666666
Avg Loss: 0.016203540872384185
Avg hit ratio: 0.8773443999063414
Avg ndcg: 0.9038793565732006
Avg compression ratio: 0.08405190024373975
Avg train time: 5.794501733779907
Std train time: 1.8332229726159477
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 44, 8, 20, 28, 10, 10, 9, 6, 11, 10, 46, 46, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8921, 'compress@10': 0.0695, 'time@10': 5.4587}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8921, 'compress@10': 0.0695, 'time@10': 5.4587}:   3%|▎         | 1/30 [00:02<01:20,  2.77s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9112, 'compress@10': 0.058, 'time@10': 5.0069}:   3%|▎         | 1/30 [00:07<01:20,  2.77s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9112, 'compress@10': 0.058, 'time@10': 5.0069}:   7%|▋         | 2/30 [00:07<01:47,  3.84s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8932, 'compress@10': 0.0927, 'time@10': 4.4648}:   7%|▋         | 2/30 [00:09<01:47,  3.84s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8932, 'compress@10': 0.0927, 'time@10': 4.4648}:  10%|█         | 3/30 [00:09<01:17,  2.88s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9028, 'compress@10': 0.0838, 'time@10': 4.4732}:  10%|█         | 3/30 [00:13<01:17,  2.88s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9028, 'compress@10': 0.0838, 'time@10': 4.4732}:  13%|█▎        | 4/30 [00:13<01:31,  3.53s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8856, 'compress@10': 0.0731, 'time@10': 5.2037}:  13%|█▎        | 4/30 [00:17<01:31,  3.53s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8856, 'compress@10': 0.0731, 'time@10': 5.2037}:  17%|█▋        | 5/30 [00:17<01:33,  3.76s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0221, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.896, 'compress@10': 0.0666, 'time@10': 5.5423}:  17%|█▋        | 5/30 [00:25<01:33,  3.76s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0221, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.896, 'compress@10': 0.0666, 'time@10': 5.5423}:  20%|██        | 6/30 [00:25<01:58,  4.95s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0223, 'hit_ratio@10': 0.878, 'ndcg@10': 0.8992, 'compress@10': 0.0669, 'time@10': 5.8825}:  20%|██        | 6/30 [00:29<01:58,  4.95s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0223, 'hit_ratio@10': 0.878, 'ndcg@10': 0.8992, 'compress@10': 0.0669, 'time@10': 5.8825}:  23%|██▎       | 7/30 [00:29<01:46,  4.64s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0224, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9122, 'compress@10': 0.0649, 'time@10': 5.8501}:  23%|██▎       | 7/30 [00:34<01:46,  4.64s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0224, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9122, 'compress@10': 0.0649, 'time@10': 5.8501}:  27%|██▋       | 8/30 [00:34<01:49,  4.97s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0224, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9175, 'compress@10': 0.0628, 'time@10': 6.1263}:  27%|██▋       | 8/30 [00:38<01:49,  4.97s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0224, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9175, 'compress@10': 0.0628, 'time@10': 6.1263}:  30%|███       | 9/30 [00:38<01:39,  4.74s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9213, 'compress@10': 0.0596, 'time@10': 6.2381}:  30%|███       | 9/30 [00:46<01:39,  4.74s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9213, 'compress@10': 0.0596, 'time@10': 6.2381}:  33%|███▎      | 10/30 [00:46<01:50,  5.52s/it]{'epoch': 36, 'num_users': 6.6364, 'loss': 0.023, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9179, 'compress@10': 0.0589, 'time@10': 6.3614}:  33%|███▎      | 10/30 [00:50<01:50,  5.52s/it]{'epoch': 36, 'num_users': 6.6364, 'loss': 0.023, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9179, 'compress@10': 0.0589, 'time@10': 6.3614}:  37%|███▋      | 11/30 [00:50<01:35,  5.01s/it]{'epoch': 36, 'num_users': 6.4167, 'loss': 0.0212, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9178, 'compress@10': 0.0627, 'time@10': 6.1241}:  37%|███▋      | 11/30 [00:53<01:35,  5.01s/it]{'epoch': 36, 'num_users': 6.4167, 'loss': 0.0212, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9178, 'compress@10': 0.0627, 'time@10': 6.1241}:  40%|████      | 12/30 [00:53<01:22,  4.57s/it]{'epoch': 36, 'num_users': 6.6154, 'loss': 0.0217, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.916, 'compress@10': 0.0636, 'time@10': 6.1959}:  40%|████      | 12/30 [00:57<01:22,  4.57s/it] {'epoch': 36, 'num_users': 6.6154, 'loss': 0.0217, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.916, 'compress@10': 0.0636, 'time@10': 6.1959}:  43%|████▎     | 13/30 [00:57<01:12,  4.26s/it]{'epoch': 36, 'num_users': 6.3571, 'loss': 0.0202, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9101, 'compress@10': 0.0721, 'time@10': 5.9988}:  43%|████▎     | 13/30 [01:00<01:12,  4.26s/it]{'epoch': 36, 'num_users': 6.3571, 'loss': 0.0202, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9101, 'compress@10': 0.0721, 'time@10': 5.9988}:  47%|████▋     | 14/30 [01:00<01:04,  4.03s/it]{'epoch': 36, 'num_users': 6.2667, 'loss': 0.021, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9105, 'compress@10': 0.0702, 'time@10': 6.1098}:  47%|████▋     | 14/30 [01:04<01:04,  4.03s/it] {'epoch': 36, 'num_users': 6.2667, 'loss': 0.021, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9105, 'compress@10': 0.0702, 'time@10': 6.1098}:  50%|█████     | 15/30 [01:04<00:59,  3.98s/it]{'epoch': 36, 'num_users': 6.0625, 'loss': 0.0199, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.9109, 'compress@10': 0.0723, 'time@10': 5.9436}:  50%|█████     | 15/30 [01:08<00:59,  3.98s/it]{'epoch': 36, 'num_users': 6.0625, 'loss': 0.0199, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.9109, 'compress@10': 0.0723, 'time@10': 5.9436}:  53%|█████▎    | 16/30 [01:08<00:53,  3.83s/it]{'epoch': 36, 'num_users': 5.8235, 'loss': 0.0187, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.9043, 'compress@10': 0.0806, 'time@10': 5.8295}:  53%|█████▎    | 16/30 [01:10<00:53,  3.83s/it]{'epoch': 36, 'num_users': 5.8235, 'loss': 0.0187, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.9043, 'compress@10': 0.0806, 'time@10': 5.8295}:  57%|█████▋    | 17/30 [01:10<00:42,  3.30s/it]{'epoch': 36, 'num_users': 6.0556, 'loss': 0.0187, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9055, 'compress@10': 0.0784, 'time@10': 5.7958}:  57%|█████▋    | 17/30 [01:15<00:42,  3.30s/it]{'epoch': 36, 'num_users': 6.0556, 'loss': 0.0187, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9055, 'compress@10': 0.0784, 'time@10': 5.7958}:  60%|██████    | 18/30 [01:15<00:46,  3.89s/it]{'epoch': 36, 'num_users': 6.0, 'loss': 0.018, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9065, 'compress@10': 0.0791, 'time@10': 5.743}:  60%|██████    | 18/30 [01:17<00:46,  3.89s/it]     {'epoch': 36, 'num_users': 6.0, 'loss': 0.018, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9065, 'compress@10': 0.0791, 'time@10': 5.743}:  63%|██████▎   | 19/30 [01:17<00:38,  3.46s/it]{'epoch': 36, 'num_users': 6.15, 'loss': 0.0184, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.9076, 'compress@10': 0.0765, 'time@10': 5.8697}:  63%|██████▎   | 19/30 [01:26<00:38,  3.46s/it]{'epoch': 36, 'num_users': 6.15, 'loss': 0.0184, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.9076, 'compress@10': 0.0765, 'time@10': 5.8697}:  67%|██████▋   | 20/30 [01:26<00:49,  4.91s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9062, 'compress@10': 0.0753, 'time@10': 5.9388}:  67%|██████▋   | 20/30 [01:29<00:49,  4.91s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9062, 'compress@10': 0.0753, 'time@10': 5.9388}:  70%|███████   | 21/30 [01:29<00:41,  4.56s/it]{'epoch': 36, 'num_users': 6.1818, 'loss': 0.0195, 'hit_ratio@10': 0.865, 'ndcg@10': 0.907, 'compress@10': 0.0746, 'time@10': 5.8425}:  70%|███████   | 21/30 [01:33<00:41,  4.56s/it]  {'epoch': 36, 'num_users': 6.1818, 'loss': 0.0195, 'hit_ratio@10': 0.865, 'ndcg@10': 0.907, 'compress@10': 0.0746, 'time@10': 5.8425}:  73%|███████▎  | 22/30 [01:33<00:34,  4.35s/it]{'epoch': 36, 'num_users': 6.1304, 'loss': 0.0192, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9078, 'compress@10': 0.0743, 'time@10': 5.861}:  73%|███████▎  | 22/30 [01:36<00:34,  4.35s/it]{'epoch': 36, 'num_users': 6.1304, 'loss': 0.0192, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9078, 'compress@10': 0.0743, 'time@10': 5.861}:  77%|███████▋  | 23/30 [01:36<00:27,  4.00s/it]{'epoch': 36, 'num_users': 5.9583, 'loss': 0.0184, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9033, 'compress@10': 0.08, 'time@10': 5.7432}:  77%|███████▋  | 23/30 [01:39<00:27,  4.00s/it] {'epoch': 36, 'num_users': 5.9583, 'loss': 0.0184, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9033, 'compress@10': 0.08, 'time@10': 5.7432}:  80%|████████  | 24/30 [01:39<00:22,  3.72s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8939, 'compress@10': 0.0908, 'time@10': 5.6338}:  80%|████████  | 24/30 [01:41<00:22,  3.72s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8939, 'compress@10': 0.0908, 'time@10': 5.6338}:  83%|████████▎ | 25/30 [01:41<00:15,  3.07s/it]{'epoch': 36, 'num_users': 5.8077, 'loss': 0.0176, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8965, 'compress@10': 0.0883, 'time@10': 5.7069}:  83%|████████▎ | 25/30 [01:49<00:15,  3.07s/it]{'epoch': 36, 'num_users': 5.8077, 'loss': 0.0176, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8965, 'compress@10': 0.0883, 'time@10': 5.7069}:  87%|████████▋ | 26/30 [01:49<00:17,  4.42s/it]{'epoch': 36, 'num_users': 5.8889, 'loss': 0.0178, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8976, 'compress@10': 0.0868, 'time@10': 5.8128}:  87%|████████▋ | 26/30 [01:53<00:17,  4.42s/it]{'epoch': 36, 'num_users': 5.8889, 'loss': 0.0178, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8976, 'compress@10': 0.0868, 'time@10': 5.8128}:  90%|█████████ | 27/30 [01:53<00:13,  4.39s/it]{'epoch': 36, 'num_users': 6.0, 'loss': 0.018, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8991, 'compress@10': 0.0849, 'time@10': 5.8662}:  90%|█████████ | 27/30 [02:00<00:13,  4.39s/it]    {'epoch': 36, 'num_users': 6.0, 'loss': 0.018, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8991, 'compress@10': 0.0849, 'time@10': 5.8662}:  93%|█████████▎| 28/30 [02:00<00:10,  5.28s/it]{'epoch': 36, 'num_users': 5.8621, 'loss': 0.0178, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9011, 'compress@10': 0.084, 'time@10': 5.9023}:  93%|█████████▎| 28/30 [02:04<00:10,  5.28s/it]{'epoch': 36, 'num_users': 5.8621, 'loss': 0.0178, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9011, 'compress@10': 0.084, 'time@10': 5.9023}:  97%|█████████▋| 29/30 [02:04<00:04,  4.75s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.018, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9014, 'compress@10': 0.0829, 'time@10': 5.895}:  97%|█████████▋| 29/30 [02:10<00:04,  4.75s/it] {'epoch': 36, 'num_users': 5.8667, 'loss': 0.018, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9014, 'compress@10': 0.0829, 'time@10': 5.895}: 100%|██████████| 30/30 [02:10<00:00,  5.04s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.018, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9014, 'compress@10': 0.0829, 'time@10': 5.895}: 100%|██████████| 30/30 [02:10<00:00,  4.33s/it]
Epoch: 36
Avg # of users: 5.866666666666666
Avg Loss: 0.017984572295352892
Avg hit ratio: 0.8712691310891372
Avg ndcg: 0.9014253297755633
Avg compression ratio: 0.08285778055717846
Avg train time: 5.895001538594564
Std train time: 1.8335848372664765
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 44, 8, 20, 28, 10, 10, 9, 6, 11, 10, 47, 47, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8946, 'compress@10': 0.0669, 'time@10': 5.9276}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8946, 'compress@10': 0.0669, 'time@10': 5.9276}:   3%|▎         | 1/30 [00:03<01:27,  3.01s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9179, 'compress@10': 0.0553, 'time@10': 5.4825}:   3%|▎         | 1/30 [00:08<01:27,  3.01s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9179, 'compress@10': 0.0553, 'time@10': 5.4825}:   7%|▋         | 2/30 [00:08<01:58,  4.23s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8977, 'compress@10': 0.0896, 'time@10': 4.7767}:   7%|▋         | 2/30 [00:09<01:58,  4.23s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8977, 'compress@10': 0.0896, 'time@10': 4.7767}:  10%|█         | 3/30 [00:09<01:23,  3.08s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8969, 'compress@10': 0.0809, 'time@10': 4.6985}:  10%|█         | 3/30 [00:14<01:23,  3.08s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8969, 'compress@10': 0.0809, 'time@10': 4.6985}:  13%|█▎        | 4/30 [00:14<01:34,  3.64s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0237, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.8818, 'compress@10': 0.0707, 'time@10': 5.3327}:  13%|█▎        | 4/30 [00:18<01:34,  3.64s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0237, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.8818, 'compress@10': 0.0707, 'time@10': 5.3327}:  17%|█▋        | 5/30 [00:18<01:34,  3.76s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0231, 'hit_ratio@10': 0.891, 'ndcg@10': 0.8929, 'compress@10': 0.0644, 'time@10': 5.6438}:  17%|█▋        | 5/30 [00:25<01:34,  3.76s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0231, 'hit_ratio@10': 0.891, 'ndcg@10': 0.8929, 'compress@10': 0.0644, 'time@10': 5.6438}:  20%|██        | 6/30 [00:25<01:58,  4.95s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0231, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.8935, 'compress@10': 0.0647, 'time@10': 5.9482}:  20%|██        | 6/30 [00:29<01:58,  4.95s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0231, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.8935, 'compress@10': 0.0647, 'time@10': 5.9482}:  23%|██▎       | 7/30 [00:29<01:46,  4.61s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9094, 'compress@10': 0.063, 'time@10': 5.9019}:  23%|██▎       | 7/30 [00:35<01:46,  4.61s/it]  {'epoch': 37, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9094, 'compress@10': 0.063, 'time@10': 5.9019}:  27%|██▋       | 8/30 [00:35<01:48,  4.93s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.023, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9151, 'compress@10': 0.0612, 'time@10': 6.1198}:  27%|██▋       | 8/30 [00:39<01:48,  4.93s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.023, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9151, 'compress@10': 0.0612, 'time@10': 6.1198}:  30%|███       | 9/30 [00:39<01:37,  4.63s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0238, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.919, 'compress@10': 0.0579, 'time@10': 6.2202}:  30%|███       | 9/30 [00:46<01:37,  4.63s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0238, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.919, 'compress@10': 0.0579, 'time@10': 6.2202}:  33%|███▎      | 10/30 [00:46<01:48,  5.41s/it]{'epoch': 37, 'num_users': 6.6364, 'loss': 0.0246, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9168, 'compress@10': 0.0573, 'time@10': 6.3414}:  33%|███▎      | 10/30 [00:50<01:48,  5.41s/it]{'epoch': 37, 'num_users': 6.6364, 'loss': 0.0246, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9168, 'compress@10': 0.0573, 'time@10': 6.3414}:  37%|███▋      | 11/30 [00:50<01:33,  4.93s/it]{'epoch': 37, 'num_users': 6.4167, 'loss': 0.0227, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9168, 'compress@10': 0.0609, 'time@10': 6.0995}:  37%|███▋      | 11/30 [00:53<01:33,  4.93s/it]{'epoch': 37, 'num_users': 6.4167, 'loss': 0.0227, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9168, 'compress@10': 0.0609, 'time@10': 6.0995}:  40%|████      | 12/30 [00:53<01:20,  4.49s/it]{'epoch': 37, 'num_users': 6.6154, 'loss': 0.023, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9151, 'compress@10': 0.0618, 'time@10': 6.1713}:  40%|████      | 12/30 [00:57<01:20,  4.49s/it]{'epoch': 37, 'num_users': 6.6154, 'loss': 0.023, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9151, 'compress@10': 0.0618, 'time@10': 6.1713}:  43%|████▎     | 13/30 [00:57<01:11,  4.20s/it]{'epoch': 37, 'num_users': 6.3571, 'loss': 0.0213, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9093, 'compress@10': 0.0704, 'time@10': 5.963}:  43%|████▎     | 13/30 [01:00<01:11,  4.20s/it]{'epoch': 37, 'num_users': 6.3571, 'loss': 0.0213, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9093, 'compress@10': 0.0704, 'time@10': 5.963}:  47%|████▋     | 14/30 [01:00<01:02,  3.93s/it]{'epoch': 37, 'num_users': 6.2667, 'loss': 0.0216, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9095, 'compress@10': 0.0685, 'time@10': 6.0583}:  47%|████▋     | 14/30 [01:04<01:02,  3.93s/it]{'epoch': 37, 'num_users': 6.2667, 'loss': 0.0216, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9095, 'compress@10': 0.0685, 'time@10': 6.0583}:  50%|█████     | 15/30 [01:04<00:58,  3.87s/it]{'epoch': 37, 'num_users': 6.0625, 'loss': 0.0204, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9099, 'compress@10': 0.0705, 'time@10': 5.9061}:  50%|█████     | 15/30 [01:07<00:58,  3.87s/it]{'epoch': 37, 'num_users': 6.0625, 'loss': 0.0204, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9099, 'compress@10': 0.0705, 'time@10': 5.9061}:  53%|█████▎    | 16/30 [01:07<00:53,  3.81s/it]{'epoch': 37, 'num_users': 5.8235, 'loss': 0.0192, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9034, 'compress@10': 0.0789, 'time@10': 5.7745}:  53%|█████▎    | 16/30 [01:09<00:53,  3.81s/it]{'epoch': 37, 'num_users': 5.8235, 'loss': 0.0192, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9034, 'compress@10': 0.0789, 'time@10': 5.7745}:  57%|█████▋    | 17/30 [01:09<00:41,  3.23s/it]{'epoch': 37, 'num_users': 6.0556, 'loss': 0.0189, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9049, 'compress@10': 0.0767, 'time@10': 5.7015}:  57%|█████▋    | 17/30 [01:14<00:41,  3.23s/it]{'epoch': 37, 'num_users': 6.0556, 'loss': 0.0189, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9049, 'compress@10': 0.0767, 'time@10': 5.7015}:  60%|██████    | 18/30 [01:14<00:43,  3.61s/it]{'epoch': 37, 'num_users': 6.0, 'loss': 0.0183, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9059, 'compress@10': 0.0774, 'time@10': 5.6236}:  60%|██████    | 18/30 [01:16<00:43,  3.61s/it]   {'epoch': 37, 'num_users': 6.0, 'loss': 0.0183, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9059, 'compress@10': 0.0774, 'time@10': 5.6236}:  63%|██████▎   | 19/30 [01:16<00:34,  3.17s/it]{'epoch': 37, 'num_users': 6.15, 'loss': 0.0183, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9086, 'compress@10': 0.0749, 'time@10': 5.7565}:  63%|██████▎   | 19/30 [01:24<00:34,  3.17s/it]{'epoch': 37, 'num_users': 6.15, 'loss': 0.0183, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9086, 'compress@10': 0.0749, 'time@10': 5.7565}:  67%|██████▋   | 20/30 [01:24<00:47,  4.72s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9069, 'compress@10': 0.0736, 'time@10': 5.8045}:  67%|██████▋   | 20/30 [01:28<00:47,  4.72s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9069, 'compress@10': 0.0736, 'time@10': 5.8045}:  70%|███████   | 21/30 [01:28<00:38,  4.33s/it]{'epoch': 37, 'num_users': 6.1818, 'loss': 0.0196, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9073, 'compress@10': 0.073, 'time@10': 5.7131}:  70%|███████   | 21/30 [01:31<00:38,  4.33s/it]  {'epoch': 37, 'num_users': 6.1818, 'loss': 0.0196, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9073, 'compress@10': 0.073, 'time@10': 5.7131}:  73%|███████▎  | 22/30 [01:31<00:33,  4.18s/it]{'epoch': 37, 'num_users': 6.1304, 'loss': 0.0192, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9081, 'compress@10': 0.0727, 'time@10': 5.738}:  73%|███████▎  | 22/30 [01:35<00:33,  4.18s/it]{'epoch': 37, 'num_users': 6.1304, 'loss': 0.0192, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9081, 'compress@10': 0.0727, 'time@10': 5.738}:  77%|███████▋  | 23/30 [01:35<00:27,  3.88s/it]{'epoch': 37, 'num_users': 5.9583, 'loss': 0.0184, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9036, 'compress@10': 0.0785, 'time@10': 5.6265}:  77%|███████▋  | 23/30 [01:38<00:27,  3.88s/it]{'epoch': 37, 'num_users': 5.9583, 'loss': 0.0184, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9036, 'compress@10': 0.0785, 'time@10': 5.6265}:  80%|████████  | 24/30 [01:38<00:21,  3.65s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8941, 'compress@10': 0.0892, 'time@10': 5.5198}:  80%|████████  | 24/30 [01:39<00:21,  3.65s/it]  {'epoch': 37, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8941, 'compress@10': 0.0892, 'time@10': 5.5198}:  83%|████████▎ | 25/30 [01:39<00:15,  3.01s/it]{'epoch': 37, 'num_users': 5.8077, 'loss': 0.0176, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8968, 'compress@10': 0.0866, 'time@10': 5.5934}:  83%|████████▎ | 25/30 [01:47<00:15,  3.01s/it]{'epoch': 37, 'num_users': 5.8077, 'loss': 0.0176, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8968, 'compress@10': 0.0866, 'time@10': 5.5934}:  87%|████████▋ | 26/30 [01:47<00:17,  4.35s/it]{'epoch': 37, 'num_users': 5.8889, 'loss': 0.0177, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8979, 'compress@10': 0.085, 'time@10': 5.6474}:  87%|████████▋ | 26/30 [01:50<00:17,  4.35s/it] {'epoch': 37, 'num_users': 5.8889, 'loss': 0.0177, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8979, 'compress@10': 0.085, 'time@10': 5.6474}:  90%|█████████ | 27/30 [01:50<00:12,  4.11s/it]{'epoch': 37, 'num_users': 6.0, 'loss': 0.0185, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8985, 'compress@10': 0.0833, 'time@10': 5.7034}:  90%|█████████ | 27/30 [01:57<00:12,  4.11s/it]  {'epoch': 37, 'num_users': 6.0, 'loss': 0.0185, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8985, 'compress@10': 0.0833, 'time@10': 5.7034}:  93%|█████████▎| 28/30 [01:57<00:10,  5.06s/it]{'epoch': 37, 'num_users': 5.8621, 'loss': 0.0182, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9005, 'compress@10': 0.0824, 'time@10': 5.7044}:  93%|█████████▎| 28/30 [02:00<00:10,  5.06s/it]{'epoch': 37, 'num_users': 5.8621, 'loss': 0.0182, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9005, 'compress@10': 0.0824, 'time@10': 5.7044}:  97%|█████████▋| 29/30 [02:00<00:04,  4.41s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0184, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9007, 'compress@10': 0.0813, 'time@10': 5.7137}:  97%|█████████▋| 29/30 [02:06<00:04,  4.41s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0184, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9007, 'compress@10': 0.0813, 'time@10': 5.7137}: 100%|██████████| 30/30 [02:06<00:00,  4.89s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0184, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9007, 'compress@10': 0.0813, 'time@10': 5.7137}: 100%|██████████| 30/30 [02:06<00:00,  4.23s/it]
Epoch: 37
Avg # of users: 5.866666666666666
Avg Loss: 0.018432417168066907
Avg hit ratio: 0.8774704928424886
Avg ndcg: 0.9006728892204812
Avg compression ratio: 0.08128286221150559
Avg train time: 5.713655614852906
Std train time: 1.7343556610785162
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 44, 8, 20, 28, 10, 10, 9, 6, 11, 10, 48, 48, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8946, 'compress@10': 0.065, 'time@10': 5.9565}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8946, 'compress@10': 0.065, 'time@10': 5.9565}:   3%|▎         | 1/30 [00:03<01:27,  3.02s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.925, 'compress@10': 0.0526, 'time@10': 5.6101}:   3%|▎         | 1/30 [00:08<01:27,  3.02s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.925, 'compress@10': 0.0526, 'time@10': 5.6101}:   7%|▋         | 2/30 [00:08<02:02,  4.36s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9024, 'compress@10': 0.0871, 'time@10': 4.9527}:   7%|▋         | 2/30 [00:10<02:02,  4.36s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9024, 'compress@10': 0.0871, 'time@10': 4.9527}:  10%|█         | 3/30 [00:10<01:26,  3.22s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8869, 'compress@10': 0.0789, 'time@10': 4.8367}:  10%|█         | 3/30 [00:14<01:26,  3.22s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8869, 'compress@10': 0.0789, 'time@10': 4.8367}:  13%|█▎        | 4/30 [00:14<01:37,  3.73s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0242, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.8747, 'compress@10': 0.069, 'time@10': 5.5455}:  13%|█▎        | 4/30 [00:18<01:37,  3.73s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0242, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.8747, 'compress@10': 0.069, 'time@10': 5.5455}:  17%|█▋        | 5/30 [00:18<01:37,  3.91s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.022, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.8884, 'compress@10': 0.0628, 'time@10': 5.8373}:  17%|█▋        | 5/30 [00:26<01:37,  3.91s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.022, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.8884, 'compress@10': 0.0628, 'time@10': 5.8373}:  20%|██        | 6/30 [00:26<02:01,  5.08s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0205, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.8951, 'compress@10': 0.0633, 'time@10': 6.1255}:  20%|██        | 6/30 [00:30<02:01,  5.08s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0205, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.8951, 'compress@10': 0.0633, 'time@10': 6.1255}:  23%|██▎       | 7/30 [00:30<01:48,  4.71s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.9122, 'ndcg@10': 0.9092, 'compress@10': 0.0613, 'time@10': 6.0565}:  23%|██▎       | 7/30 [00:35<01:48,  4.71s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.9122, 'ndcg@10': 0.9092, 'compress@10': 0.0613, 'time@10': 6.0565}:  27%|██▋       | 8/30 [00:35<01:50,  5.00s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.916, 'compress@10': 0.0598, 'time@10': 6.2496}:  27%|██▋       | 8/30 [00:39<01:50,  5.00s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.916, 'compress@10': 0.0598, 'time@10': 6.2496}:  30%|███       | 9/30 [00:39<01:38,  4.67s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9216, 'compress@10': 0.0565, 'time@10': 6.3328}:  30%|███       | 9/30 [00:46<01:38,  4.67s/it]  {'epoch': 38, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9216, 'compress@10': 0.0565, 'time@10': 6.3328}:  33%|███▎      | 10/30 [00:46<01:48,  5.43s/it]{'epoch': 38, 'num_users': 6.6364, 'loss': 0.0208, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9187, 'compress@10': 0.0559, 'time@10': 6.4542}:  33%|███▎      | 10/30 [00:50<01:48,  5.43s/it]{'epoch': 38, 'num_users': 6.6364, 'loss': 0.0208, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9187, 'compress@10': 0.0559, 'time@10': 6.4542}:  37%|███▋      | 11/30 [00:50<01:34,  4.96s/it]{'epoch': 38, 'num_users': 6.4167, 'loss': 0.0191, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9186, 'compress@10': 0.0594, 'time@10': 6.2134}:  37%|███▋      | 11/30 [00:54<01:34,  4.96s/it]{'epoch': 38, 'num_users': 6.4167, 'loss': 0.0191, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9186, 'compress@10': 0.0594, 'time@10': 6.2134}:  40%|████      | 12/30 [00:54<01:21,  4.54s/it]{'epoch': 38, 'num_users': 6.6154, 'loss': 0.0196, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9168, 'compress@10': 0.0602, 'time@10': 6.2725}:  40%|████      | 12/30 [00:57<01:21,  4.54s/it]{'epoch': 38, 'num_users': 6.6154, 'loss': 0.0196, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9168, 'compress@10': 0.0602, 'time@10': 6.2725}:  43%|████▎     | 13/30 [00:57<01:12,  4.24s/it]{'epoch': 38, 'num_users': 6.3571, 'loss': 0.0182, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.9108, 'compress@10': 0.0688, 'time@10': 6.0566}:  43%|████▎     | 13/30 [01:01<01:12,  4.24s/it]{'epoch': 38, 'num_users': 6.3571, 'loss': 0.0182, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.9108, 'compress@10': 0.0688, 'time@10': 6.0566}:  47%|████▋     | 14/30 [01:01<01:03,  3.95s/it]{'epoch': 38, 'num_users': 6.2667, 'loss': 0.0184, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.912, 'compress@10': 0.0669, 'time@10': 6.1435}:  47%|████▋     | 14/30 [01:04<01:03,  3.95s/it] {'epoch': 38, 'num_users': 6.2667, 'loss': 0.0184, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.912, 'compress@10': 0.0669, 'time@10': 6.1435}:  50%|█████     | 15/30 [01:04<00:58,  3.89s/it]{'epoch': 38, 'num_users': 6.0625, 'loss': 0.0174, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9123, 'compress@10': 0.0689, 'time@10': 5.9857}:  50%|█████     | 15/30 [01:08<00:58,  3.89s/it]{'epoch': 38, 'num_users': 6.0625, 'loss': 0.0174, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9123, 'compress@10': 0.0689, 'time@10': 5.9857}:  53%|█████▎    | 16/30 [01:08<00:53,  3.82s/it]{'epoch': 38, 'num_users': 5.8235, 'loss': 0.0164, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9057, 'compress@10': 0.0774, 'time@10': 5.8485}:  53%|█████▎    | 16/30 [01:10<00:53,  3.82s/it] {'epoch': 38, 'num_users': 5.8235, 'loss': 0.0164, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9057, 'compress@10': 0.0774, 'time@10': 5.8485}:  57%|█████▋    | 17/30 [01:10<00:42,  3.24s/it]{'epoch': 38, 'num_users': 6.0556, 'loss': 0.0164, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9073, 'compress@10': 0.0753, 'time@10': 5.7716}:  57%|█████▋    | 17/30 [01:15<00:42,  3.24s/it]{'epoch': 38, 'num_users': 6.0556, 'loss': 0.0164, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9073, 'compress@10': 0.0753, 'time@10': 5.7716}:  60%|██████    | 18/30 [01:15<00:43,  3.62s/it]{'epoch': 38, 'num_users': 6.0, 'loss': 0.0158, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9082, 'compress@10': 0.0759, 'time@10': 5.6916}:  60%|██████    | 18/30 [01:17<00:43,  3.62s/it]   {'epoch': 38, 'num_users': 6.0, 'loss': 0.0158, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9082, 'compress@10': 0.0759, 'time@10': 5.6916}:  63%|██████▎   | 19/30 [01:17<00:34,  3.18s/it]{'epoch': 38, 'num_users': 6.15, 'loss': 0.0164, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.909, 'compress@10': 0.0734, 'time@10': 5.8185}:  63%|██████▎   | 19/30 [01:25<00:34,  3.18s/it]{'epoch': 38, 'num_users': 6.15, 'loss': 0.0164, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.909, 'compress@10': 0.0734, 'time@10': 5.8185}:  67%|██████▋   | 20/30 [01:25<00:47,  4.71s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9075, 'compress@10': 0.072, 'time@10': 5.8733}:  67%|██████▋   | 20/30 [01:28<00:47,  4.71s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9075, 'compress@10': 0.072, 'time@10': 5.8733}:  70%|███████   | 21/30 [01:28<00:39,  4.35s/it]{'epoch': 38, 'num_users': 6.1818, 'loss': 0.0175, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9075, 'compress@10': 0.0714, 'time@10': 5.7721}:  70%|███████   | 21/30 [01:32<00:39,  4.35s/it]{'epoch': 38, 'num_users': 6.1818, 'loss': 0.0175, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9075, 'compress@10': 0.0714, 'time@10': 5.7721}:  73%|███████▎  | 22/30 [01:32<00:33,  4.15s/it]{'epoch': 38, 'num_users': 6.1304, 'loss': 0.0172, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9086, 'compress@10': 0.0711, 'time@10': 5.7881}:  73%|███████▎  | 22/30 [01:35<00:33,  4.15s/it]{'epoch': 38, 'num_users': 6.1304, 'loss': 0.0172, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9086, 'compress@10': 0.0711, 'time@10': 5.7881}:  77%|███████▋  | 23/30 [01:35<00:26,  3.84s/it]{'epoch': 38, 'num_users': 5.9583, 'loss': 0.0165, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9041, 'compress@10': 0.077, 'time@10': 5.6789}:  77%|███████▋  | 23/30 [01:38<00:26,  3.84s/it] {'epoch': 38, 'num_users': 5.9583, 'loss': 0.0165, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9041, 'compress@10': 0.077, 'time@10': 5.6789}:  80%|████████  | 24/30 [01:38<00:21,  3.65s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0159, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8946, 'compress@10': 0.0877, 'time@10': 5.5775}:  80%|████████  | 24/30 [01:40<00:21,  3.65s/it]  {'epoch': 38, 'num_users': 5.8, 'loss': 0.0159, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8946, 'compress@10': 0.0877, 'time@10': 5.5775}:  83%|████████▎ | 25/30 [01:40<00:15,  3.04s/it]{'epoch': 38, 'num_users': 5.8077, 'loss': 0.0158, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8973, 'compress@10': 0.0852, 'time@10': 5.6481}:  83%|████████▎ | 25/30 [01:48<00:15,  3.04s/it]{'epoch': 38, 'num_users': 5.8077, 'loss': 0.0158, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8973, 'compress@10': 0.0852, 'time@10': 5.6481}:  87%|████████▋ | 26/30 [01:48<00:17,  4.36s/it]{'epoch': 38, 'num_users': 5.8889, 'loss': 0.016, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8985, 'compress@10': 0.0836, 'time@10': 5.7511}:  87%|████████▋ | 26/30 [01:52<00:17,  4.36s/it] {'epoch': 38, 'num_users': 5.8889, 'loss': 0.016, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8985, 'compress@10': 0.0836, 'time@10': 5.7511}:  90%|█████████ | 27/30 [01:52<00:12,  4.33s/it]{'epoch': 38, 'num_users': 6.0, 'loss': 0.0156, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.901, 'compress@10': 0.0818, 'time@10': 5.8094}:  90%|█████████ | 27/30 [01:59<00:12,  4.33s/it]   {'epoch': 38, 'num_users': 6.0, 'loss': 0.0156, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.901, 'compress@10': 0.0818, 'time@10': 5.8094}:  93%|█████████▎| 28/30 [01:59<00:10,  5.26s/it]{'epoch': 38, 'num_users': 5.8621, 'loss': 0.0154, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9027, 'compress@10': 0.0809, 'time@10': 5.8426}:  93%|█████████▎| 28/30 [02:03<00:10,  5.26s/it]{'epoch': 38, 'num_users': 5.8621, 'loss': 0.0154, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9027, 'compress@10': 0.0809, 'time@10': 5.8426}:  97%|█████████▋| 29/30 [02:03<00:04,  4.71s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0161, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9041, 'compress@10': 0.0796, 'time@10': 5.8478}:  97%|█████████▋| 29/30 [02:09<00:04,  4.71s/it] {'epoch': 38, 'num_users': 5.8667, 'loss': 0.0161, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9041, 'compress@10': 0.0796, 'time@10': 5.8478}: 100%|██████████| 30/30 [02:09<00:00,  5.11s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0161, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9041, 'compress@10': 0.0796, 'time@10': 5.8478}: 100%|██████████| 30/30 [02:09<00:00,  4.31s/it]
Epoch: 38
Avg # of users: 5.866666666666666
Avg Loss: 0.016051447515312834
Avg hit ratio: 0.8769741558461515
Avg ndcg: 0.904091131190749
Avg compression ratio: 0.07962833796336846
Avg train time: 5.8478196144104
Std train time: 1.7964502026947908
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 44, 8, 20, 28, 10, 10, 9, 6, 11, 10, 49, 49, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8986, 'compress@10': 0.0637, 'time@10': 6.0697}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8986, 'compress@10': 0.0637, 'time@10': 6.0697}:   3%|▎         | 1/30 [00:03<01:30,  3.11s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9264, 'compress@10': 0.051, 'time@10': 5.6356}:   3%|▎         | 1/30 [00:08<01:30,  3.11s/it] {'epoch': 39, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9264, 'compress@10': 0.051, 'time@10': 5.6356}:   7%|▋         | 2/30 [00:08<02:02,  4.36s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9033, 'compress@10': 0.0853, 'time@10': 5.029}:   7%|▋         | 2/30 [00:10<02:02,  4.36s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9033, 'compress@10': 0.0853, 'time@10': 5.029}:  10%|█         | 3/30 [00:10<01:28,  3.26s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8996, 'compress@10': 0.0769, 'time@10': 4.889}:  10%|█         | 3/30 [00:14<01:28,  3.26s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8996, 'compress@10': 0.0769, 'time@10': 4.889}:  13%|█▎        | 4/30 [00:14<01:37,  3.75s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8858, 'compress@10': 0.0674, 'time@10': 5.5606}:  13%|█▎        | 4/30 [00:18<01:37,  3.75s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8858, 'compress@10': 0.0674, 'time@10': 5.5606}:  17%|█▋        | 5/30 [00:18<01:37,  3.90s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9001, 'compress@10': 0.0619, 'time@10': 5.8513}:  17%|█▋        | 5/30 [00:26<01:37,  3.90s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9001, 'compress@10': 0.0619, 'time@10': 5.8513}:  20%|██        | 6/30 [00:26<02:01,  5.07s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.024, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9043, 'compress@10': 0.0622, 'time@10': 6.207}:  20%|██        | 6/30 [00:30<02:01,  5.07s/it]  {'epoch': 39, 'num_users': 6.2857, 'loss': 0.024, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9043, 'compress@10': 0.0622, 'time@10': 6.207}:  23%|██▎       | 7/30 [00:30<01:50,  4.79s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.91, 'ndcg@10': 0.9178, 'compress@10': 0.0595, 'time@10': 6.1609}:  23%|██▎       | 7/30 [00:36<01:50,  4.79s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.91, 'ndcg@10': 0.9178, 'compress@10': 0.0595, 'time@10': 6.1609}:  27%|██▋       | 8/30 [00:36<01:53,  5.14s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9234, 'compress@10': 0.0579, 'time@10': 6.3636}:  27%|██▋       | 8/30 [00:40<01:53,  5.14s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9234, 'compress@10': 0.0579, 'time@10': 6.3636}:  30%|███       | 9/30 [00:40<01:40,  4.79s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9285, 'compress@10': 0.0549, 'time@10': 6.4319}:  30%|███       | 9/30 [00:47<01:40,  4.79s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9285, 'compress@10': 0.0549, 'time@10': 6.4319}:  33%|███▎      | 10/30 [00:47<01:50,  5.50s/it]{'epoch': 39, 'num_users': 6.6364, 'loss': 0.023, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9258, 'compress@10': 0.0544, 'time@10': 6.5234}:  33%|███▎      | 10/30 [00:51<01:50,  5.50s/it]{'epoch': 39, 'num_users': 6.6364, 'loss': 0.023, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9258, 'compress@10': 0.0544, 'time@10': 6.5234}:  37%|███▋      | 11/30 [00:51<01:34,  4.97s/it]{'epoch': 39, 'num_users': 6.4167, 'loss': 0.0212, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.925, 'compress@10': 0.0578, 'time@10': 6.2671}:  37%|███▋      | 11/30 [00:54<01:34,  4.97s/it]{'epoch': 39, 'num_users': 6.4167, 'loss': 0.0212, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.925, 'compress@10': 0.0578, 'time@10': 6.2671}:  40%|████      | 12/30 [00:54<01:21,  4.52s/it]{'epoch': 39, 'num_users': 6.6154, 'loss': 0.0215, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9229, 'compress@10': 0.0586, 'time@10': 6.3216}:  40%|████      | 12/30 [00:58<01:21,  4.52s/it]{'epoch': 39, 'num_users': 6.6154, 'loss': 0.0215, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9229, 'compress@10': 0.0586, 'time@10': 6.3216}:  43%|████▎     | 13/30 [00:58<01:11,  4.22s/it]{'epoch': 39, 'num_users': 6.3571, 'loss': 0.02, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9165, 'compress@10': 0.0671, 'time@10': 6.1029}:  43%|████▎     | 13/30 [01:01<01:11,  4.22s/it]  {'epoch': 39, 'num_users': 6.3571, 'loss': 0.02, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9165, 'compress@10': 0.0671, 'time@10': 6.1029}:  47%|████▋     | 14/30 [01:01<01:03,  3.94s/it]{'epoch': 39, 'num_users': 6.2667, 'loss': 0.0219, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.9121, 'compress@10': 0.0655, 'time@10': 6.188}:  47%|████▋     | 14/30 [01:05<01:03,  3.94s/it]{'epoch': 39, 'num_users': 6.2667, 'loss': 0.0219, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.9121, 'compress@10': 0.0655, 'time@10': 6.188}:  50%|█████     | 15/30 [01:05<00:58,  3.88s/it]{'epoch': 39, 'num_users': 6.0625, 'loss': 0.0207, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.9124, 'compress@10': 0.0674, 'time@10': 6.0266}:  50%|█████     | 15/30 [01:08<00:58,  3.88s/it]{'epoch': 39, 'num_users': 6.0625, 'loss': 0.0207, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.9124, 'compress@10': 0.0674, 'time@10': 6.0266}:  53%|█████▎    | 16/30 [01:08<00:53,  3.81s/it]{'epoch': 39, 'num_users': 5.8235, 'loss': 0.0195, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.9057, 'compress@10': 0.0758, 'time@10': 5.8919}:  53%|█████▎    | 16/30 [01:10<00:53,  3.81s/it]{'epoch': 39, 'num_users': 5.8235, 'loss': 0.0195, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.9057, 'compress@10': 0.0758, 'time@10': 5.8919}:  57%|█████▋    | 17/30 [01:10<00:42,  3.24s/it]{'epoch': 39, 'num_users': 6.0556, 'loss': 0.0191, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.9071, 'compress@10': 0.0738, 'time@10': 5.8393}:  57%|█████▋    | 17/30 [01:15<00:42,  3.24s/it]{'epoch': 39, 'num_users': 6.0556, 'loss': 0.0191, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.9071, 'compress@10': 0.0738, 'time@10': 5.8393}:  60%|██████    | 18/30 [01:15<00:45,  3.77s/it]{'epoch': 39, 'num_users': 6.0, 'loss': 0.0186, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.908, 'compress@10': 0.0744, 'time@10': 5.7931}:  60%|██████    | 18/30 [01:18<00:45,  3.77s/it]    {'epoch': 39, 'num_users': 6.0, 'loss': 0.0186, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.908, 'compress@10': 0.0744, 'time@10': 5.7931}:  63%|██████▎   | 19/30 [01:18<00:37,  3.39s/it]{'epoch': 39, 'num_users': 6.15, 'loss': 0.0184, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.9106, 'compress@10': 0.0721, 'time@10': 5.9268}:  63%|██████▎   | 19/30 [01:26<00:37,  3.39s/it]{'epoch': 39, 'num_users': 6.15, 'loss': 0.0184, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.9106, 'compress@10': 0.0721, 'time@10': 5.9268}:  67%|██████▋   | 20/30 [01:26<00:49,  4.93s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.9096, 'compress@10': 0.0705, 'time@10': 6.0035}:  67%|██████▋   | 20/30 [01:30<00:49,  4.93s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.9096, 'compress@10': 0.0705, 'time@10': 6.0035}:  70%|███████   | 21/30 [01:30<00:41,  4.59s/it]{'epoch': 39, 'num_users': 6.1818, 'loss': 0.0195, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9103, 'compress@10': 0.07, 'time@10': 5.8959}:  70%|███████   | 21/30 [01:34<00:41,  4.59s/it]  {'epoch': 39, 'num_users': 6.1818, 'loss': 0.0195, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9103, 'compress@10': 0.07, 'time@10': 5.8959}:  73%|███████▎  | 22/30 [01:34<00:34,  4.32s/it]{'epoch': 39, 'num_users': 6.1304, 'loss': 0.0191, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.911, 'compress@10': 0.0698, 'time@10': 5.9104}:  73%|███████▎  | 22/30 [01:37<00:34,  4.32s/it]{'epoch': 39, 'num_users': 6.1304, 'loss': 0.0191, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.911, 'compress@10': 0.0698, 'time@10': 5.9104}:  77%|███████▋  | 23/30 [01:37<00:27,  3.97s/it]{'epoch': 39, 'num_users': 5.9583, 'loss': 0.0183, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9064, 'compress@10': 0.0759, 'time@10': 5.7982}:  77%|███████▋  | 23/30 [01:40<00:27,  3.97s/it]{'epoch': 39, 'num_users': 5.9583, 'loss': 0.0183, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9064, 'compress@10': 0.0759, 'time@10': 5.7982}:  80%|████████  | 24/30 [01:40<00:22,  3.76s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8968, 'compress@10': 0.0865, 'time@10': 5.6961}:  80%|████████  | 24/30 [01:42<00:22,  3.76s/it]   {'epoch': 39, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8968, 'compress@10': 0.0865, 'time@10': 5.6961}:  83%|████████▎ | 25/30 [01:42<00:15,  3.13s/it]{'epoch': 39, 'num_users': 5.8077, 'loss': 0.0174, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8995, 'compress@10': 0.0841, 'time@10': 5.7572}:  83%|████████▎ | 25/30 [01:49<00:15,  3.13s/it]{'epoch': 39, 'num_users': 5.8077, 'loss': 0.0174, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8995, 'compress@10': 0.0841, 'time@10': 5.7572}:  87%|████████▋ | 26/30 [01:49<00:17,  4.39s/it]{'epoch': 39, 'num_users': 5.8889, 'loss': 0.0176, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9006, 'compress@10': 0.0825, 'time@10': 5.8273}:  87%|████████▋ | 26/30 [01:53<00:17,  4.39s/it]{'epoch': 39, 'num_users': 5.8889, 'loss': 0.0176, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9006, 'compress@10': 0.0825, 'time@10': 5.8273}:  90%|█████████ | 27/30 [01:53<00:12,  4.23s/it]{'epoch': 39, 'num_users': 6.0, 'loss': 0.0185, 'hit_ratio@10': 0.864, 'ndcg@10': 0.902, 'compress@10': 0.0807, 'time@10': 5.8716}:  90%|█████████ | 27/30 [02:00<00:12,  4.23s/it]     {'epoch': 39, 'num_users': 6.0, 'loss': 0.0185, 'hit_ratio@10': 0.864, 'ndcg@10': 0.902, 'compress@10': 0.0807, 'time@10': 5.8716}:  93%|█████████▎| 28/30 [02:00<00:10,  5.10s/it]{'epoch': 39, 'num_users': 5.8621, 'loss': 0.0182, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9038, 'compress@10': 0.0798, 'time@10': 5.9057}:  93%|█████████▎| 28/30 [02:04<00:10,  5.10s/it]{'epoch': 39, 'num_users': 5.8621, 'loss': 0.0182, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9038, 'compress@10': 0.0798, 'time@10': 5.9057}:  97%|█████████▋| 29/30 [02:04<00:04,  4.61s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0182, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9054, 'compress@10': 0.0783, 'time@10': 5.9141}:  97%|█████████▋| 29/30 [02:10<00:04,  4.61s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0182, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9054, 'compress@10': 0.0783, 'time@10': 5.9141}: 100%|██████████| 30/30 [02:10<00:00,  5.09s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0182, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9054, 'compress@10': 0.0783, 'time@10': 5.9141}: 100%|██████████| 30/30 [02:10<00:00,  4.35s/it]
Epoch: 39
Avg # of users: 5.866666666666666
Avg Loss: 0.01821338173372523
Avg hit ratio: 0.8688899208684634
Avg ndcg: 0.9053542622492184
Avg compression ratio: 0.0783480741002904
Avg train time: 5.91405676205953
Std train time: 1.7561911330976014
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 44, 8, 20, 28, 10, 10, 9, 6, 11, 10, 49, 49, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8937, 'compress@10': 0.0629, 'time@10': 5.3276}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8937, 'compress@10': 0.0629, 'time@10': 5.3276}:   3%|▎         | 1/30 [00:02<01:18,  2.70s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9237, 'compress@10': 0.0504, 'time@10': 5.169}:   3%|▎         | 1/30 [00:07<01:18,  2.70s/it] {'epoch': 40, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9237, 'compress@10': 0.0504, 'time@10': 5.169}:   7%|▋         | 2/30 [00:07<01:54,  4.08s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9015, 'compress@10': 0.0845, 'time@10': 4.4179}:   7%|▋         | 2/30 [00:09<01:54,  4.08s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9015, 'compress@10': 0.0845, 'time@10': 4.4179}:  10%|█         | 3/30 [00:09<01:18,  2.90s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9156, 'compress@10': 0.0761, 'time@10': 4.3274}:  10%|█         | 3/30 [00:13<01:18,  2.90s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9156, 'compress@10': 0.0761, 'time@10': 4.3274}:  13%|█▎        | 4/30 [00:13<01:27,  3.37s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0209, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8996, 'compress@10': 0.0667, 'time@10': 5.0731}:  13%|█▎        | 4/30 [00:17<01:27,  3.37s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0209, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8996, 'compress@10': 0.0667, 'time@10': 5.0731}:  17%|█▋        | 5/30 [00:17<01:30,  3.62s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.02, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9097, 'compress@10': 0.0613, 'time@10': 5.4484}:  17%|█▋        | 5/30 [00:24<01:30,  3.62s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.02, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9097, 'compress@10': 0.0613, 'time@10': 5.4484}:  20%|██        | 6/30 [00:24<01:57,  4.90s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0202, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9092, 'compress@10': 0.0611, 'time@10': 5.7847}:  20%|██        | 6/30 [00:28<01:57,  4.90s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0202, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9092, 'compress@10': 0.0611, 'time@10': 5.7847}:  23%|██▎       | 7/30 [00:28<01:45,  4.58s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0204, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9197, 'compress@10': 0.0582, 'time@10': 5.748}:  23%|██▎       | 7/30 [00:34<01:45,  4.58s/it]  {'epoch': 40, 'num_users': 6.125, 'loss': 0.0204, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9197, 'compress@10': 0.0582, 'time@10': 5.748}:  27%|██▋       | 8/30 [00:34<01:47,  4.89s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9256, 'compress@10': 0.0565, 'time@10': 5.9923}:  27%|██▋       | 8/30 [00:38<01:47,  4.89s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9256, 'compress@10': 0.0565, 'time@10': 5.9923}:  30%|███       | 9/30 [00:38<01:36,  4.61s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9324, 'compress@10': 0.0534, 'time@10': 6.101}:  30%|███       | 9/30 [00:45<01:36,  4.61s/it]    {'epoch': 40, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9324, 'compress@10': 0.0534, 'time@10': 6.101}:  33%|███▎      | 10/30 [00:45<01:47,  5.39s/it]{'epoch': 40, 'num_users': 6.6364, 'loss': 0.0229, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9297, 'compress@10': 0.053, 'time@10': 6.2283}:  33%|███▎      | 10/30 [00:49<01:47,  5.39s/it]{'epoch': 40, 'num_users': 6.6364, 'loss': 0.0229, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9297, 'compress@10': 0.053, 'time@10': 6.2283}:  37%|███▋      | 11/30 [00:49<01:33,  4.90s/it]{'epoch': 40, 'num_users': 6.4167, 'loss': 0.0211, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9287, 'compress@10': 0.0565, 'time@10': 5.9964}:  37%|███▋      | 11/30 [00:52<01:33,  4.90s/it]{'epoch': 40, 'num_users': 6.4167, 'loss': 0.0211, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9287, 'compress@10': 0.0565, 'time@10': 5.9964}:  40%|████      | 12/30 [00:52<01:20,  4.47s/it]{'epoch': 40, 'num_users': 6.6154, 'loss': 0.0213, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9263, 'compress@10': 0.0572, 'time@10': 6.0737}:  40%|████      | 12/30 [00:56<01:20,  4.47s/it]{'epoch': 40, 'num_users': 6.6154, 'loss': 0.0213, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9263, 'compress@10': 0.0572, 'time@10': 6.0737}:  43%|████▎     | 13/30 [00:56<01:11,  4.19s/it]{'epoch': 40, 'num_users': 6.3571, 'loss': 0.0198, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9197, 'compress@10': 0.0658, 'time@10': 5.8937}:  43%|████▎     | 13/30 [00:59<01:11,  4.19s/it]{'epoch': 40, 'num_users': 6.3571, 'loss': 0.0198, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9197, 'compress@10': 0.0658, 'time@10': 5.8937}:  47%|████▋     | 14/30 [00:59<01:04,  4.01s/it]{'epoch': 40, 'num_users': 6.2667, 'loss': 0.0208, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9197, 'compress@10': 0.0643, 'time@10': 5.9583}:  47%|████▋     | 14/30 [01:03<01:04,  4.01s/it]{'epoch': 40, 'num_users': 6.2667, 'loss': 0.0208, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9197, 'compress@10': 0.0643, 'time@10': 5.9583}:  50%|█████     | 15/30 [01:03<00:57,  3.85s/it]{'epoch': 40, 'num_users': 6.0625, 'loss': 0.0196, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9195, 'compress@10': 0.0663, 'time@10': 5.8095}:  50%|█████     | 15/30 [01:06<00:57,  3.85s/it]{'epoch': 40, 'num_users': 6.0625, 'loss': 0.0196, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9195, 'compress@10': 0.0663, 'time@10': 5.8095}:  53%|█████▎    | 16/30 [01:06<00:52,  3.78s/it]{'epoch': 40, 'num_users': 5.8235, 'loss': 0.0184, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.9125, 'compress@10': 0.0747, 'time@10': 5.6844}:  53%|█████▎    | 16/30 [01:08<00:52,  3.78s/it]{'epoch': 40, 'num_users': 5.8235, 'loss': 0.0184, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.9125, 'compress@10': 0.0747, 'time@10': 5.6844}:  57%|█████▋    | 17/30 [01:08<00:41,  3.21s/it]{'epoch': 40, 'num_users': 6.0556, 'loss': 0.0183, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9138, 'compress@10': 0.0728, 'time@10': 5.6183}:  57%|█████▋    | 17/30 [01:13<00:41,  3.21s/it]{'epoch': 40, 'num_users': 6.0556, 'loss': 0.0183, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9138, 'compress@10': 0.0728, 'time@10': 5.6183}:  60%|██████    | 18/30 [01:13<00:43,  3.61s/it]{'epoch': 40, 'num_users': 6.0, 'loss': 0.0176, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.9143, 'compress@10': 0.0733, 'time@10': 5.5474}:  60%|██████    | 18/30 [01:15<00:43,  3.61s/it]   {'epoch': 40, 'num_users': 6.0, 'loss': 0.0176, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.9143, 'compress@10': 0.0733, 'time@10': 5.5474}:  63%|██████▎   | 19/30 [01:15<00:35,  3.20s/it]{'epoch': 40, 'num_users': 6.15, 'loss': 0.018, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9159, 'compress@10': 0.071, 'time@10': 5.6888}:  63%|██████▎   | 19/30 [01:23<00:35,  3.20s/it]  {'epoch': 40, 'num_users': 6.15, 'loss': 0.018, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9159, 'compress@10': 0.071, 'time@10': 5.6888}:  67%|██████▋   | 20/30 [01:23<00:47,  4.77s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.9141, 'compress@10': 0.0695, 'time@10': 5.7518}:  67%|██████▋   | 20/30 [01:27<00:47,  4.77s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.9141, 'compress@10': 0.0695, 'time@10': 5.7518}:  70%|███████   | 21/30 [01:27<00:39,  4.40s/it]{'epoch': 40, 'num_users': 6.1818, 'loss': 0.019, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9148, 'compress@10': 0.0689, 'time@10': 5.6593}:  70%|███████   | 21/30 [01:31<00:39,  4.40s/it] {'epoch': 40, 'num_users': 6.1818, 'loss': 0.019, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9148, 'compress@10': 0.0689, 'time@10': 5.6593}:  73%|███████▎  | 22/30 [01:31<00:33,  4.21s/it]{'epoch': 40, 'num_users': 6.1304, 'loss': 0.0186, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9156, 'compress@10': 0.0687, 'time@10': 5.6884}:  73%|███████▎  | 22/30 [01:34<00:33,  4.21s/it]{'epoch': 40, 'num_users': 6.1304, 'loss': 0.0186, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9156, 'compress@10': 0.0687, 'time@10': 5.6884}:  77%|███████▋  | 23/30 [01:34<00:27,  3.91s/it]{'epoch': 40, 'num_users': 5.9583, 'loss': 0.0179, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9107, 'compress@10': 0.0749, 'time@10': 5.5807}:  77%|███████▋  | 23/30 [01:37<00:27,  3.91s/it] {'epoch': 40, 'num_users': 5.9583, 'loss': 0.0179, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9107, 'compress@10': 0.0749, 'time@10': 5.5807}:  80%|████████  | 24/30 [01:37<00:22,  3.68s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.901, 'compress@10': 0.0855, 'time@10': 5.4858}:  80%|████████  | 24/30 [01:39<00:22,  3.68s/it]   {'epoch': 40, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.901, 'compress@10': 0.0855, 'time@10': 5.4858}:  83%|████████▎ | 25/30 [01:39<00:15,  3.07s/it]{'epoch': 40, 'num_users': 5.8077, 'loss': 0.017, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9036, 'compress@10': 0.0832, 'time@10': 5.5734}:  83%|████████▎ | 25/30 [01:47<00:15,  3.07s/it]{'epoch': 40, 'num_users': 5.8077, 'loss': 0.017, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9036, 'compress@10': 0.0832, 'time@10': 5.5734}:  87%|████████▋ | 26/30 [01:47<00:17,  4.49s/it]{'epoch': 40, 'num_users': 5.8889, 'loss': 0.0172, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9046, 'compress@10': 0.0816, 'time@10': 5.6546}:  87%|████████▋ | 26/30 [01:51<00:17,  4.49s/it]{'epoch': 40, 'num_users': 5.8889, 'loss': 0.0172, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9046, 'compress@10': 0.0816, 'time@10': 5.6546}:  90%|█████████ | 27/30 [01:51<00:12,  4.32s/it]{'epoch': 40, 'num_users': 6.0, 'loss': 0.0172, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9066, 'compress@10': 0.0797, 'time@10': 5.7137}:  90%|█████████ | 27/30 [01:58<00:12,  4.32s/it]  {'epoch': 40, 'num_users': 6.0, 'loss': 0.0172, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9066, 'compress@10': 0.0797, 'time@10': 5.7137}:  93%|█████████▎| 28/30 [01:58<00:10,  5.23s/it]{'epoch': 40, 'num_users': 5.8621, 'loss': 0.017, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9083, 'compress@10': 0.0788, 'time@10': 5.726}:  93%|█████████▎| 28/30 [02:01<00:10,  5.23s/it]{'epoch': 40, 'num_users': 5.8621, 'loss': 0.017, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9083, 'compress@10': 0.0788, 'time@10': 5.726}:  97%|█████████▋| 29/30 [02:01<00:04,  4.58s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0171, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9083, 'compress@10': 0.0774, 'time@10': 5.733}:  97%|█████████▋| 29/30 [02:07<00:04,  4.58s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0171, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9083, 'compress@10': 0.0774, 'time@10': 5.733}: 100%|██████████| 30/30 [02:07<00:00,  5.00s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0171, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9083, 'compress@10': 0.0774, 'time@10': 5.733}: 100%|██████████| 30/30 [02:07<00:00,  4.25s/it]
Epoch: 40
Avg # of users: 5.866666666666666
Avg Loss: 0.01706753049407469
Avg hit ratio: 0.870512720543253
Avg ndcg: 0.9082581301228156
Avg compression ratio: 0.07742940956489969
Avg train time: 5.733033386866252
Std train time: 1.790360322506578
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 18, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 44, 8, 20, 28, 10, 10, 9, 6, 11, 10, 50, 49, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9047, 'compress@10': 0.0618, 'time@10': 5.9428}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9047, 'compress@10': 0.0618, 'time@10': 5.9428}:   3%|▎         | 1/30 [00:03<01:27,  3.02s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9278, 'compress@10': 0.0499, 'time@10': 5.5595}:   3%|▎         | 1/30 [00:08<01:27,  3.02s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9278, 'compress@10': 0.0499, 'time@10': 5.5595}:   7%|▋         | 2/30 [00:08<02:00,  4.32s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9042, 'compress@10': 0.0837, 'time@10': 4.8586}:   7%|▋         | 2/30 [00:10<02:00,  4.32s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9042, 'compress@10': 0.0837, 'time@10': 4.8586}:  10%|█         | 3/30 [00:10<01:25,  3.15s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9172, 'compress@10': 0.0751, 'time@10': 4.8587}:  10%|█         | 3/30 [00:14<01:25,  3.15s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9172, 'compress@10': 0.0751, 'time@10': 4.8587}:  13%|█▎        | 4/30 [00:14<01:40,  3.85s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0192, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9009, 'compress@10': 0.0657, 'time@10': 5.7653}:  13%|█▎        | 4/30 [00:19<01:40,  3.85s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0192, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9009, 'compress@10': 0.0657, 'time@10': 5.7653}:  17%|█▋        | 5/30 [00:19<01:44,  4.17s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.018, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9115, 'compress@10': 0.0612, 'time@10': 6.0428}:  17%|█▋        | 5/30 [00:27<01:44,  4.17s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.018, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9115, 'compress@10': 0.0612, 'time@10': 6.0428}:  20%|██        | 6/30 [00:27<02:07,  5.29s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9163, 'compress@10': 0.0604, 'time@10': 6.3226}:  20%|██        | 6/30 [00:31<02:07,  5.29s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9163, 'compress@10': 0.0604, 'time@10': 6.3226}:  23%|██▎       | 7/30 [00:31<01:52,  4.88s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9265, 'compress@10': 0.0573, 'time@10': 6.2319}:  23%|██▎       | 7/30 [00:36<01:52,  4.88s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9265, 'compress@10': 0.0573, 'time@10': 6.2319}:  27%|██▋       | 8/30 [00:36<01:52,  5.12s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9314, 'compress@10': 0.0555, 'time@10': 6.3945}:  27%|██▋       | 8/30 [00:40<01:52,  5.12s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9314, 'compress@10': 0.0555, 'time@10': 6.3945}:  30%|███       | 9/30 [00:40<01:39,  4.74s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9359, 'compress@10': 0.0526, 'time@10': 6.4708}:  30%|███       | 9/30 [00:47<01:39,  4.74s/it]  {'epoch': 41, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9359, 'compress@10': 0.0526, 'time@10': 6.4708}:  33%|███▎      | 10/30 [00:47<01:49,  5.50s/it]{'epoch': 41, 'num_users': 6.6364, 'loss': 0.019, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.933, 'compress@10': 0.0522, 'time@10': 6.5741}:  33%|███▎      | 10/30 [00:51<01:49,  5.50s/it]{'epoch': 41, 'num_users': 6.6364, 'loss': 0.019, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.933, 'compress@10': 0.0522, 'time@10': 6.5741}:  37%|███▋      | 11/30 [00:51<01:34,  4.99s/it]{'epoch': 41, 'num_users': 6.4167, 'loss': 0.0175, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9317, 'compress@10': 0.0555, 'time@10': 6.3136}:  37%|███▋      | 11/30 [00:55<01:34,  4.99s/it]{'epoch': 41, 'num_users': 6.4167, 'loss': 0.0175, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9317, 'compress@10': 0.0555, 'time@10': 6.3136}:  40%|████      | 12/30 [00:55<01:21,  4.53s/it]{'epoch': 41, 'num_users': 6.6154, 'loss': 0.0178, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9295, 'compress@10': 0.0562, 'time@10': 6.3637}:  40%|████      | 12/30 [00:58<01:21,  4.53s/it]{'epoch': 41, 'num_users': 6.6154, 'loss': 0.0178, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9295, 'compress@10': 0.0562, 'time@10': 6.3637}:  43%|████▎     | 13/30 [00:58<01:11,  4.23s/it]{'epoch': 41, 'num_users': 6.3571, 'loss': 0.0166, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9226, 'compress@10': 0.0647, 'time@10': 6.1542}:  43%|████▎     | 13/30 [01:02<01:11,  4.23s/it] {'epoch': 41, 'num_users': 6.3571, 'loss': 0.0166, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9226, 'compress@10': 0.0647, 'time@10': 6.1542}:  47%|████▋     | 14/30 [01:02<01:03,  4.00s/it]{'epoch': 41, 'num_users': 6.2667, 'loss': 0.0169, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.923, 'compress@10': 0.0632, 'time@10': 6.226}:  47%|████▋     | 14/30 [01:05<01:03,  4.00s/it] {'epoch': 41, 'num_users': 6.2667, 'loss': 0.0169, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.923, 'compress@10': 0.0632, 'time@10': 6.226}:  50%|█████     | 15/30 [01:05<00:58,  3.90s/it]{'epoch': 41, 'num_users': 6.0625, 'loss': 0.016, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9226, 'compress@10': 0.0651, 'time@10': 6.0515}:  50%|█████     | 15/30 [01:09<00:58,  3.90s/it]{'epoch': 41, 'num_users': 6.0625, 'loss': 0.016, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9226, 'compress@10': 0.0651, 'time@10': 6.0515}:  53%|█████▎    | 16/30 [01:09<00:52,  3.77s/it]{'epoch': 41, 'num_users': 5.8235, 'loss': 0.0151, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.9154, 'compress@10': 0.0736, 'time@10': 5.914}:  53%|█████▎    | 16/30 [01:11<00:52,  3.77s/it]{'epoch': 41, 'num_users': 5.8235, 'loss': 0.0151, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.9154, 'compress@10': 0.0736, 'time@10': 5.914}:  57%|█████▋    | 17/30 [01:11<00:41,  3.21s/it]{'epoch': 41, 'num_users': 6.0556, 'loss': 0.0149, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.9162, 'compress@10': 0.0717, 'time@10': 5.8337}:  57%|█████▋    | 17/30 [01:15<00:41,  3.21s/it]{'epoch': 41, 'num_users': 6.0556, 'loss': 0.0149, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.9162, 'compress@10': 0.0717, 'time@10': 5.8337}:  60%|██████    | 18/30 [01:15<00:43,  3.60s/it]{'epoch': 41, 'num_users': 6.0, 'loss': 0.0144, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9166, 'compress@10': 0.0722, 'time@10': 5.7515}:  60%|██████    | 18/30 [01:17<00:43,  3.60s/it]    {'epoch': 41, 'num_users': 6.0, 'loss': 0.0144, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9166, 'compress@10': 0.0722, 'time@10': 5.7515}:  63%|██████▎   | 19/30 [01:17<00:34,  3.17s/it]{'epoch': 41, 'num_users': 6.15, 'loss': 0.0146, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9188, 'compress@10': 0.07, 'time@10': 5.8623}:  63%|██████▎   | 19/30 [01:25<00:34,  3.17s/it] {'epoch': 41, 'num_users': 6.15, 'loss': 0.0146, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9188, 'compress@10': 0.07, 'time@10': 5.8623}:  67%|██████▋   | 20/30 [01:25<00:46,  4.62s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9176, 'compress@10': 0.0685, 'time@10': 5.9247}:  67%|██████▋   | 20/30 [01:29<00:46,  4.62s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9176, 'compress@10': 0.0685, 'time@10': 5.9247}:  70%|███████   | 21/30 [01:29<00:38,  4.32s/it]{'epoch': 41, 'num_users': 6.1818, 'loss': 0.0156, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9173, 'compress@10': 0.0679, 'time@10': 5.8272}:  70%|███████   | 21/30 [01:33<00:38,  4.32s/it]{'epoch': 41, 'num_users': 6.1818, 'loss': 0.0156, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9173, 'compress@10': 0.0679, 'time@10': 5.8272}:  73%|███████▎  | 22/30 [01:33<00:33,  4.17s/it]{'epoch': 41, 'num_users': 6.1304, 'loss': 0.0154, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.918, 'compress@10': 0.0678, 'time@10': 5.8457}:  73%|███████▎  | 22/30 [01:36<00:33,  4.17s/it] {'epoch': 41, 'num_users': 6.1304, 'loss': 0.0154, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.918, 'compress@10': 0.0678, 'time@10': 5.8457}:  77%|███████▋  | 23/30 [01:36<00:27,  3.89s/it]{'epoch': 41, 'num_users': 5.9583, 'loss': 0.0147, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.913, 'compress@10': 0.074, 'time@10': 5.7387}:  77%|███████▋  | 23/30 [01:39<00:27,  3.89s/it] {'epoch': 41, 'num_users': 5.9583, 'loss': 0.0147, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.913, 'compress@10': 0.074, 'time@10': 5.7387}:  80%|████████  | 24/30 [01:39<00:22,  3.72s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0142, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9032, 'compress@10': 0.0846, 'time@10': 5.6309}:  80%|████████  | 24/30 [01:41<00:22,  3.72s/it]   {'epoch': 41, 'num_users': 5.8, 'loss': 0.0142, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9032, 'compress@10': 0.0846, 'time@10': 5.6309}:  83%|████████▎ | 25/30 [01:41<00:15,  3.07s/it]{'epoch': 41, 'num_users': 5.8077, 'loss': 0.0141, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9057, 'compress@10': 0.0823, 'time@10': 5.7007}:  83%|████████▎ | 25/30 [01:49<00:15,  3.07s/it]{'epoch': 41, 'num_users': 5.8077, 'loss': 0.0141, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9057, 'compress@10': 0.0823, 'time@10': 5.7007}:  87%|████████▋ | 26/30 [01:49<00:17,  4.40s/it]{'epoch': 41, 'num_users': 5.8889, 'loss': 0.0143, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9068, 'compress@10': 0.0807, 'time@10': 5.7916}:  87%|████████▋ | 26/30 [01:53<00:17,  4.40s/it]{'epoch': 41, 'num_users': 5.8889, 'loss': 0.0143, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9068, 'compress@10': 0.0807, 'time@10': 5.7916}:  90%|█████████ | 27/30 [01:53<00:12,  4.31s/it]{'epoch': 41, 'num_users': 6.0, 'loss': 0.015, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9079, 'compress@10': 0.079, 'time@10': 5.8497}:  90%|█████████ | 27/30 [02:00<00:12,  4.31s/it]     {'epoch': 41, 'num_users': 6.0, 'loss': 0.015, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9079, 'compress@10': 0.079, 'time@10': 5.8497}:  93%|█████████▎| 28/30 [02:00<00:10,  5.25s/it]{'epoch': 41, 'num_users': 5.8621, 'loss': 0.0149, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9093, 'compress@10': 0.0781, 'time@10': 5.8451}:  93%|█████████▎| 28/30 [02:03<00:10,  5.25s/it]{'epoch': 41, 'num_users': 5.8621, 'loss': 0.0149, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9093, 'compress@10': 0.0781, 'time@10': 5.8451}:  97%|█████████▋| 29/30 [02:03<00:04,  4.55s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0153, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.909, 'compress@10': 0.0766, 'time@10': 5.8512}:  97%|█████████▋| 29/30 [02:09<00:04,  4.55s/it] {'epoch': 41, 'num_users': 5.8667, 'loss': 0.0153, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.909, 'compress@10': 0.0766, 'time@10': 5.8512}: 100%|██████████| 30/30 [02:09<00:00,  5.00s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0153, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.909, 'compress@10': 0.0766, 'time@10': 5.8512}: 100%|██████████| 30/30 [02:09<00:00,  4.32s/it]
Epoch: 41
Avg # of users: 5.866666666666666
Avg Loss: 0.015264150784240973
Avg hit ratio: 0.8747733890458568
Avg ndcg: 0.908955987678248
Avg compression ratio: 0.07664106760486443
Avg train time: 5.851239490509033
Std train time: 1.8276566421442362
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 18, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 44, 8, 20, 28, 10, 10, 9, 6, 11, 10, 50, 50, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9047, 'compress@10': 0.0618, 'time@10': 5.9523}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9047, 'compress@10': 0.0618, 'time@10': 5.9523}:   3%|▎         | 1/30 [00:03<01:27,  3.02s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9308, 'compress@10': 0.05, 'time@10': 5.4604}:   3%|▎         | 1/30 [00:08<01:27,  3.02s/it]   {'epoch': 42, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9308, 'compress@10': 0.05, 'time@10': 5.4604}:   7%|▋         | 2/30 [00:08<01:57,  4.19s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9063, 'compress@10': 0.0835, 'time@10': 4.7885}:   7%|▋         | 2/30 [00:09<01:57,  4.19s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9063, 'compress@10': 0.0835, 'time@10': 4.7885}:  10%|█         | 3/30 [00:09<01:23,  3.08s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.913, 'compress@10': 0.0747, 'time@10': 4.6774}:  10%|█         | 3/30 [00:14<01:23,  3.08s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.913, 'compress@10': 0.0747, 'time@10': 4.6774}:  13%|█▎        | 4/30 [00:14<01:33,  3.60s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8995, 'compress@10': 0.0655, 'time@10': 5.369}:  13%|█▎        | 4/30 [00:18<01:33,  3.60s/it]  {'epoch': 42, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8995, 'compress@10': 0.0655, 'time@10': 5.369}:  17%|█▋        | 5/30 [00:18<01:34,  3.78s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9104, 'compress@10': 0.0616, 'time@10': 5.69}:  17%|█▋        | 5/30 [00:25<01:34,  3.78s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9104, 'compress@10': 0.0616, 'time@10': 5.69}:  20%|██        | 6/30 [00:25<01:59,  4.99s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0196, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9125, 'compress@10': 0.0611, 'time@10': 6.0107}:  20%|██        | 6/30 [00:29<01:59,  4.99s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0196, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9125, 'compress@10': 0.0611, 'time@10': 6.0107}:  23%|██▎       | 7/30 [00:29<01:47,  4.67s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.02, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9252, 'compress@10': 0.0578, 'time@10': 5.9668}:  23%|██▎       | 7/30 [00:35<01:47,  4.67s/it]    {'epoch': 42, 'num_users': 6.125, 'loss': 0.02, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9252, 'compress@10': 0.0578, 'time@10': 5.9668}:  27%|██▋       | 8/30 [00:35<01:49,  5.00s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9302, 'compress@10': 0.0557, 'time@10': 6.2177}:  27%|██▋       | 8/30 [00:39<01:49,  5.00s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9302, 'compress@10': 0.0557, 'time@10': 6.2177}:  30%|███       | 9/30 [00:39<01:39,  4.73s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9337, 'compress@10': 0.0528, 'time@10': 6.3394}:  30%|███       | 9/30 [00:46<01:39,  4.73s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9337, 'compress@10': 0.0528, 'time@10': 6.3394}:  33%|███▎      | 10/30 [00:46<01:51,  5.58s/it]{'epoch': 42, 'num_users': 6.6364, 'loss': 0.0203, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9317, 'compress@10': 0.0522, 'time@10': 6.4517}:  33%|███▎      | 10/30 [00:50<01:51,  5.58s/it]{'epoch': 42, 'num_users': 6.6364, 'loss': 0.0203, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9317, 'compress@10': 0.0522, 'time@10': 6.4517}:  37%|███▋      | 11/30 [00:50<01:35,  5.04s/it]{'epoch': 42, 'num_users': 6.4167, 'loss': 0.0187, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9305, 'compress@10': 0.0555, 'time@10': 6.2027}:  37%|███▋      | 11/30 [00:54<01:35,  5.04s/it]{'epoch': 42, 'num_users': 6.4167, 'loss': 0.0187, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9305, 'compress@10': 0.0555, 'time@10': 6.2027}:  40%|████      | 12/30 [00:54<01:22,  4.58s/it]{'epoch': 42, 'num_users': 6.6154, 'loss': 0.019, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9286, 'compress@10': 0.0557, 'time@10': 6.2659}:  40%|████      | 12/30 [00:57<01:22,  4.58s/it] {'epoch': 42, 'num_users': 6.6154, 'loss': 0.019, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9286, 'compress@10': 0.0557, 'time@10': 6.2659}:  43%|████▎     | 13/30 [00:57<01:12,  4.27s/it]{'epoch': 42, 'num_users': 6.3571, 'loss': 0.0177, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9218, 'compress@10': 0.0642, 'time@10': 6.0749}:  43%|████▎     | 13/30 [01:01<01:12,  4.27s/it]{'epoch': 42, 'num_users': 6.3571, 'loss': 0.0177, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9218, 'compress@10': 0.0642, 'time@10': 6.0749}:  47%|████▋     | 14/30 [01:01<01:05,  4.07s/it]{'epoch': 42, 'num_users': 6.2667, 'loss': 0.0189, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9153, 'compress@10': 0.063, 'time@10': 6.1302}:  47%|████▋     | 14/30 [01:04<01:05,  4.07s/it] {'epoch': 42, 'num_users': 6.2667, 'loss': 0.0189, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9153, 'compress@10': 0.063, 'time@10': 6.1302}:  50%|█████     | 15/30 [01:04<00:58,  3.90s/it]{'epoch': 42, 'num_users': 6.0625, 'loss': 0.0178, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9154, 'compress@10': 0.0648, 'time@10': 5.9683}:  50%|█████     | 15/30 [01:08<00:58,  3.90s/it]{'epoch': 42, 'num_users': 6.0625, 'loss': 0.0178, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9154, 'compress@10': 0.0648, 'time@10': 5.9683}:  53%|█████▎    | 16/30 [01:08<00:53,  3.80s/it]{'epoch': 42, 'num_users': 5.8235, 'loss': 0.0168, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9086, 'compress@10': 0.0733, 'time@10': 5.8337}:  53%|█████▎    | 16/30 [01:10<00:53,  3.80s/it]{'epoch': 42, 'num_users': 5.8235, 'loss': 0.0168, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9086, 'compress@10': 0.0733, 'time@10': 5.8337}:  57%|█████▋    | 17/30 [01:10<00:41,  3.22s/it]{'epoch': 42, 'num_users': 6.0556, 'loss': 0.0167, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9105, 'compress@10': 0.0714, 'time@10': 5.7909}:  57%|█████▋    | 17/30 [01:15<00:41,  3.22s/it]{'epoch': 42, 'num_users': 6.0556, 'loss': 0.0167, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9105, 'compress@10': 0.0714, 'time@10': 5.7909}:  60%|██████    | 18/30 [01:15<00:45,  3.79s/it]{'epoch': 42, 'num_users': 6.0, 'loss': 0.0161, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9112, 'compress@10': 0.0719, 'time@10': 5.7114}:  60%|██████    | 18/30 [01:17<00:45,  3.79s/it]   {'epoch': 42, 'num_users': 6.0, 'loss': 0.0161, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9112, 'compress@10': 0.0719, 'time@10': 5.7114}:  63%|██████▎   | 19/30 [01:17<00:36,  3.31s/it]{'epoch': 42, 'num_users': 6.15, 'loss': 0.0168, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9136, 'compress@10': 0.0697, 'time@10': 5.8338}:  63%|██████▎   | 19/30 [01:25<00:36,  3.31s/it]{'epoch': 42, 'num_users': 6.15, 'loss': 0.0168, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9136, 'compress@10': 0.0697, 'time@10': 5.8338}:  67%|██████▋   | 20/30 [01:25<00:47,  4.78s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9129, 'compress@10': 0.0682, 'time@10': 5.9865}:  67%|██████▋   | 20/30 [01:30<00:47,  4.78s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9129, 'compress@10': 0.0682, 'time@10': 5.9865}:  70%|███████   | 21/30 [01:30<00:42,  4.74s/it]{'epoch': 42, 'num_users': 6.1818, 'loss': 0.0177, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9135, 'compress@10': 0.0676, 'time@10': 5.8932}:  70%|███████   | 21/30 [01:34<00:42,  4.74s/it]{'epoch': 42, 'num_users': 6.1818, 'loss': 0.0177, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9135, 'compress@10': 0.0676, 'time@10': 5.8932}:  73%|███████▎  | 22/30 [01:34<00:36,  4.51s/it]{'epoch': 42, 'num_users': 6.1304, 'loss': 0.0174, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9143, 'compress@10': 0.0675, 'time@10': 5.9091}:  73%|███████▎  | 22/30 [01:37<00:36,  4.51s/it]{'epoch': 42, 'num_users': 6.1304, 'loss': 0.0174, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9143, 'compress@10': 0.0675, 'time@10': 5.9091}:  77%|███████▋  | 23/30 [01:37<00:28,  4.12s/it]{'epoch': 42, 'num_users': 5.9583, 'loss': 0.0167, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9096, 'compress@10': 0.0737, 'time@10': 5.7994}:  77%|███████▋  | 23/30 [01:41<00:28,  4.12s/it]{'epoch': 42, 'num_users': 5.9583, 'loss': 0.0167, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9096, 'compress@10': 0.0737, 'time@10': 5.7994}:  80%|████████  | 24/30 [01:41<00:23,  3.87s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0161, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8999, 'compress@10': 0.0843, 'time@10': 5.6993}:  80%|████████  | 24/30 [01:42<00:23,  3.87s/it]   {'epoch': 42, 'num_users': 5.8, 'loss': 0.0161, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8999, 'compress@10': 0.0843, 'time@10': 5.6993}:  83%|████████▎ | 25/30 [01:42<00:16,  3.23s/it]{'epoch': 42, 'num_users': 5.8077, 'loss': 0.0158, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9026, 'compress@10': 0.0821, 'time@10': 5.768}:  83%|████████▎ | 25/30 [01:50<00:16,  3.23s/it]{'epoch': 42, 'num_users': 5.8077, 'loss': 0.0158, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9026, 'compress@10': 0.0821, 'time@10': 5.768}:  87%|████████▋ | 26/30 [01:50<00:18,  4.52s/it]{'epoch': 42, 'num_users': 5.8889, 'loss': 0.016, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9039, 'compress@10': 0.0805, 'time@10': 5.8559}:  87%|████████▋ | 26/30 [01:54<00:18,  4.52s/it]{'epoch': 42, 'num_users': 5.8889, 'loss': 0.016, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9039, 'compress@10': 0.0805, 'time@10': 5.8559}:  90%|█████████ | 27/30 [01:54<00:13,  4.40s/it]{'epoch': 42, 'num_users': 6.0, 'loss': 0.0165, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9046, 'compress@10': 0.0787, 'time@10': 5.896}:  90%|█████████ | 27/30 [02:01<00:13,  4.40s/it]   {'epoch': 42, 'num_users': 6.0, 'loss': 0.0165, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9046, 'compress@10': 0.0787, 'time@10': 5.896}:  93%|█████████▎| 28/30 [02:01<00:10,  5.18s/it]{'epoch': 42, 'num_users': 5.8621, 'loss': 0.0163, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9062, 'compress@10': 0.0778, 'time@10': 5.9269}:  93%|█████████▎| 28/30 [02:04<00:10,  5.18s/it]{'epoch': 42, 'num_users': 5.8621, 'loss': 0.0163, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9062, 'compress@10': 0.0778, 'time@10': 5.9269}:  97%|█████████▋| 29/30 [02:04<00:04,  4.66s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0164, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9067, 'compress@10': 0.0763, 'time@10': 5.9277}:  97%|█████████▋| 29/30 [02:10<00:04,  4.66s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0164, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9067, 'compress@10': 0.0763, 'time@10': 5.9277}: 100%|██████████| 30/30 [02:10<00:00,  5.06s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0164, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9067, 'compress@10': 0.0763, 'time@10': 5.9277}: 100%|██████████| 30/30 [02:10<00:00,  4.36s/it]
Epoch: 42
Avg # of users: 5.866666666666666
Avg Loss: 0.01637222110062951
Avg hit ratio: 0.8750766043490722
Avg ndcg: 0.9066649320352881
Avg compression ratio: 0.07631849902484776
Avg train time: 5.927669167518616
Std train time: 1.8302282787725168
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 18, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 44, 8, 20, 28, 10, 10, 9, 6, 11, 10, 50, 50, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9047, 'compress@10': 0.0615, 'time@10': 5.9698}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9047, 'compress@10': 0.0615, 'time@10': 5.9698}:   3%|▎         | 1/30 [00:03<01:27,  3.03s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9316, 'compress@10': 0.05, 'time@10': 5.504}:   3%|▎         | 1/30 [00:08<01:27,  3.03s/it]   {'epoch': 43, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9316, 'compress@10': 0.05, 'time@10': 5.504}:   7%|▋         | 2/30 [00:08<01:58,  4.24s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9068, 'compress@10': 0.0832, 'time@10': 4.8268}:   7%|▋         | 2/30 [00:09<01:58,  4.24s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9068, 'compress@10': 0.0832, 'time@10': 4.8268}:  10%|█         | 3/30 [00:09<01:24,  3.11s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9195, 'compress@10': 0.0743, 'time@10': 4.7024}:  10%|█         | 3/30 [00:14<01:24,  3.11s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9195, 'compress@10': 0.0743, 'time@10': 4.7024}:  13%|█▎        | 4/30 [00:14<01:33,  3.61s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9045, 'compress@10': 0.065, 'time@10': 5.4075}:  13%|█▎        | 4/30 [00:18<01:33,  3.61s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9045, 'compress@10': 0.065, 'time@10': 5.4075}:  17%|█▋        | 5/30 [00:18<01:35,  3.80s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.019, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9158, 'compress@10': 0.0609, 'time@10': 5.7157}:  17%|█▋        | 5/30 [00:25<01:35,  3.80s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.019, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9158, 'compress@10': 0.0609, 'time@10': 5.7157}:  20%|██        | 6/30 [00:25<01:59,  4.99s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9189, 'compress@10': 0.0596, 'time@10': 6.038}:  20%|██        | 6/30 [00:29<01:59,  4.99s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9189, 'compress@10': 0.0596, 'time@10': 6.038}:  23%|██▎       | 7/30 [00:29<01:47,  4.68s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9291, 'compress@10': 0.0563, 'time@10': 5.9913}:  23%|██▎       | 7/30 [00:35<01:47,  4.68s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9291, 'compress@10': 0.0563, 'time@10': 5.9913}:  27%|██▋       | 8/30 [00:35<01:50,  5.00s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.933, 'compress@10': 0.0543, 'time@10': 6.1855}:  27%|██▋       | 8/30 [00:39<01:50,  5.00s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.933, 'compress@10': 0.0543, 'time@10': 6.1855}:  30%|███       | 9/30 [00:39<01:37,  4.66s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9411, 'compress@10': 0.0515, 'time@10': 6.2716}:  30%|███       | 9/30 [00:46<01:37,  4.66s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9411, 'compress@10': 0.0515, 'time@10': 6.2716}:  33%|███▎      | 10/30 [00:46<01:48,  5.41s/it]{'epoch': 43, 'num_users': 6.6364, 'loss': 0.0204, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9386, 'compress@10': 0.051, 'time@10': 6.3883}:  33%|███▎      | 10/30 [00:50<01:48,  5.41s/it]{'epoch': 43, 'num_users': 6.6364, 'loss': 0.0204, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9386, 'compress@10': 0.051, 'time@10': 6.3883}:  37%|███▋      | 11/30 [00:50<01:33,  4.92s/it]{'epoch': 43, 'num_users': 6.4167, 'loss': 0.0188, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9368, 'compress@10': 0.0543, 'time@10': 6.1418}:  37%|███▋      | 11/30 [00:53<01:33,  4.92s/it]{'epoch': 43, 'num_users': 6.4167, 'loss': 0.0188, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9368, 'compress@10': 0.0543, 'time@10': 6.1418}:  40%|████      | 12/30 [00:53<01:20,  4.48s/it]{'epoch': 43, 'num_users': 6.6154, 'loss': 0.0189, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.935, 'compress@10': 0.0544, 'time@10': 6.2157}:  40%|████      | 12/30 [00:57<01:20,  4.48s/it] {'epoch': 43, 'num_users': 6.6154, 'loss': 0.0189, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.935, 'compress@10': 0.0544, 'time@10': 6.2157}:  43%|████▎     | 13/30 [00:57<01:11,  4.21s/it]{'epoch': 43, 'num_users': 6.3571, 'loss': 0.0176, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9277, 'compress@10': 0.063, 'time@10': 6.0077}:  43%|████▎     | 13/30 [01:00<01:11,  4.21s/it]{'epoch': 43, 'num_users': 6.3571, 'loss': 0.0176, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9277, 'compress@10': 0.063, 'time@10': 6.0077}:  47%|████▋     | 14/30 [01:00<01:03,  3.95s/it]{'epoch': 43, 'num_users': 6.2667, 'loss': 0.0174, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9286, 'compress@10': 0.0617, 'time@10': 6.1043}:  47%|████▋     | 14/30 [01:04<01:03,  3.95s/it]{'epoch': 43, 'num_users': 6.2667, 'loss': 0.0174, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9286, 'compress@10': 0.0617, 'time@10': 6.1043}:  50%|█████     | 15/30 [01:04<00:58,  3.89s/it]{'epoch': 43, 'num_users': 6.0625, 'loss': 0.0165, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9278, 'compress@10': 0.0635, 'time@10': 5.9482}:  50%|█████     | 15/30 [01:08<00:58,  3.89s/it]{'epoch': 43, 'num_users': 6.0625, 'loss': 0.0165, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9278, 'compress@10': 0.0635, 'time@10': 5.9482}:  53%|█████▎    | 16/30 [01:08<00:53,  3.82s/it]{'epoch': 43, 'num_users': 5.8235, 'loss': 0.0155, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.9203, 'compress@10': 0.0721, 'time@10': 5.8119}:  53%|█████▎    | 16/30 [01:09<00:53,  3.82s/it]{'epoch': 43, 'num_users': 5.8235, 'loss': 0.0155, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.9203, 'compress@10': 0.0721, 'time@10': 5.8119}:  57%|█████▋    | 17/30 [01:09<00:41,  3.23s/it]{'epoch': 43, 'num_users': 6.0556, 'loss': 0.0153, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.9214, 'compress@10': 0.0703, 'time@10': 5.74}:  57%|█████▋    | 17/30 [01:14<00:41,  3.23s/it]  {'epoch': 43, 'num_users': 6.0556, 'loss': 0.0153, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.9214, 'compress@10': 0.0703, 'time@10': 5.74}:  60%|██████    | 18/30 [01:14<00:43,  3.65s/it]{'epoch': 43, 'num_users': 6.0, 'loss': 0.0147, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9216, 'compress@10': 0.0708, 'time@10': 5.6645}:  60%|██████    | 18/30 [01:16<00:43,  3.65s/it]  {'epoch': 43, 'num_users': 6.0, 'loss': 0.0147, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9216, 'compress@10': 0.0708, 'time@10': 5.6645}:  63%|██████▎   | 19/30 [01:16<00:35,  3.21s/it]{'epoch': 43, 'num_users': 6.15, 'loss': 0.0148, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9239, 'compress@10': 0.0687, 'time@10': 5.7798}:  63%|██████▎   | 19/30 [01:24<00:35,  3.21s/it]{'epoch': 43, 'num_users': 6.15, 'loss': 0.0148, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9239, 'compress@10': 0.0687, 'time@10': 5.7798}:  67%|██████▋   | 20/30 [01:24<00:46,  4.65s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9221, 'compress@10': 0.0672, 'time@10': 5.8778}:  67%|██████▋   | 20/30 [01:28<00:46,  4.65s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9221, 'compress@10': 0.0672, 'time@10': 5.8778}:  70%|███████   | 21/30 [01:28<00:40,  4.44s/it]{'epoch': 43, 'num_users': 6.1818, 'loss': 0.0158, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9228, 'compress@10': 0.0666, 'time@10': 5.7829}:  70%|███████   | 21/30 [01:32<00:40,  4.44s/it] {'epoch': 43, 'num_users': 6.1818, 'loss': 0.0158, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9228, 'compress@10': 0.0666, 'time@10': 5.7829}:  73%|███████▎  | 22/30 [01:32<00:34,  4.26s/it]{'epoch': 43, 'num_users': 6.1304, 'loss': 0.0155, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9233, 'compress@10': 0.0665, 'time@10': 5.8045}:  73%|███████▎  | 22/30 [01:35<00:34,  4.26s/it]{'epoch': 43, 'num_users': 6.1304, 'loss': 0.0155, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9233, 'compress@10': 0.0665, 'time@10': 5.8045}:  77%|███████▋  | 23/30 [01:35<00:27,  3.94s/it]{'epoch': 43, 'num_users': 5.9583, 'loss': 0.0148, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9181, 'compress@10': 0.0728, 'time@10': 5.6989}:  77%|███████▋  | 23/30 [01:39<00:27,  3.94s/it]{'epoch': 43, 'num_users': 5.9583, 'loss': 0.0148, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9181, 'compress@10': 0.0728, 'time@10': 5.6989}:  80%|████████  | 24/30 [01:39<00:22,  3.75s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9081, 'compress@10': 0.0834, 'time@10': 5.6023}:  80%|████████  | 24/30 [01:40<00:22,  3.75s/it]   {'epoch': 43, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9081, 'compress@10': 0.0834, 'time@10': 5.6023}:  83%|████████▎ | 25/30 [01:40<00:15,  3.13s/it]{'epoch': 43, 'num_users': 5.8077, 'loss': 0.0142, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.9104, 'compress@10': 0.0811, 'time@10': 5.7}:  83%|████████▎ | 25/30 [01:48<00:15,  3.13s/it]{'epoch': 43, 'num_users': 5.8077, 'loss': 0.0142, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.9104, 'compress@10': 0.0811, 'time@10': 5.7}:  87%|████████▋ | 26/30 [01:48<00:18,  4.64s/it]{'epoch': 43, 'num_users': 5.8889, 'loss': 0.0144, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9114, 'compress@10': 0.0795, 'time@10': 5.7979}:  87%|████████▋ | 26/30 [01:53<00:18,  4.64s/it]{'epoch': 43, 'num_users': 5.8889, 'loss': 0.0144, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9114, 'compress@10': 0.0795, 'time@10': 5.7979}:  90%|█████████ | 27/30 [01:53<00:13,  4.52s/it]{'epoch': 43, 'num_users': 6.0, 'loss': 0.0143, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9135, 'compress@10': 0.0778, 'time@10': 5.8418}:  90%|█████████ | 27/30 [02:00<00:13,  4.52s/it]   {'epoch': 43, 'num_users': 6.0, 'loss': 0.0143, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9135, 'compress@10': 0.0778, 'time@10': 5.8418}:  93%|█████████▎| 28/30 [02:00<00:10,  5.28s/it]{'epoch': 43, 'num_users': 5.8621, 'loss': 0.0141, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9148, 'compress@10': 0.0768, 'time@10': 5.8577}:  93%|█████████▎| 28/30 [02:03<00:10,  5.28s/it]{'epoch': 43, 'num_users': 5.8621, 'loss': 0.0141, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9148, 'compress@10': 0.0768, 'time@10': 5.8577}:  97%|█████████▋| 29/30 [02:03<00:04,  4.65s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0143, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9142, 'compress@10': 0.0754, 'time@10': 5.8532}:  97%|█████████▋| 29/30 [02:09<00:04,  4.65s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0143, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9142, 'compress@10': 0.0754, 'time@10': 5.8532}: 100%|██████████| 30/30 [02:09<00:00,  4.99s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0143, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9142, 'compress@10': 0.0754, 'time@10': 5.8532}: 100%|██████████| 30/30 [02:09<00:00,  4.30s/it]
Epoch: 43
Avg # of users: 5.866666666666666
Avg Loss: 0.014337247285972429
Avg hit ratio: 0.8718508182228141
Avg ndcg: 0.9141884931595533
Avg compression ratio: 0.0753939218379698
Avg train time: 5.853212666511536
Std train time: 1.8121705746666257
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 18, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 44, 8, 20, 28, 10, 10, 9, 6, 11, 10, 50, 50, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9107, 'compress@10': 0.0605, 'time@10': 6.1998}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9107, 'compress@10': 0.0605, 'time@10': 6.1998}:   3%|▎         | 1/30 [00:03<01:31,  3.14s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.932, 'compress@10': 0.0495, 'time@10': 5.7733}:   3%|▎         | 1/30 [00:08<01:31,  3.14s/it] {'epoch': 44, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.932, 'compress@10': 0.0495, 'time@10': 5.7733}:   7%|▋         | 2/30 [00:08<02:04,  4.46s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9071, 'compress@10': 0.0826, 'time@10': 4.9566}:   7%|▋         | 2/30 [00:10<02:04,  4.46s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9071, 'compress@10': 0.0826, 'time@10': 4.9566}:  10%|█         | 3/30 [00:10<01:26,  3.20s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9209, 'compress@10': 0.0735, 'time@10': 4.7686}:  10%|█         | 3/30 [00:14<01:26,  3.20s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9209, 'compress@10': 0.0735, 'time@10': 4.7686}:  13%|█▎        | 4/30 [00:14<01:33,  3.61s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.9063, 'compress@10': 0.0643, 'time@10': 5.4365}:  13%|█▎        | 4/30 [00:18<01:33,  3.61s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.9063, 'compress@10': 0.0643, 'time@10': 5.4365}:  17%|█▋        | 5/30 [00:18<01:34,  3.79s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9172, 'compress@10': 0.0597, 'time@10': 5.8646}:  17%|█▋        | 5/30 [00:26<01:34,  3.79s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9172, 'compress@10': 0.0597, 'time@10': 5.8646}:  20%|██        | 6/30 [00:26<02:05,  5.23s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.019, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.919, 'compress@10': 0.0588, 'time@10': 6.214}:  20%|██        | 6/30 [00:30<02:05,  5.23s/it]   {'epoch': 44, 'num_users': 6.2857, 'loss': 0.019, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.919, 'compress@10': 0.0588, 'time@10': 6.214}:  23%|██▎       | 7/30 [00:30<01:52,  4.90s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0195, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.928, 'compress@10': 0.0557, 'time@10': 6.1713}:  23%|██▎       | 7/30 [00:36<01:52,  4.90s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0195, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.928, 'compress@10': 0.0557, 'time@10': 6.1713}:  27%|██▋       | 8/30 [00:36<01:54,  5.22s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9322, 'compress@10': 0.0537, 'time@10': 6.3769}:  27%|██▋       | 8/30 [00:40<01:54,  5.22s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9322, 'compress@10': 0.0537, 'time@10': 6.3769}:  30%|███       | 9/30 [00:40<01:41,  4.85s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9367, 'compress@10': 0.0509, 'time@10': 6.4528}:  30%|███       | 9/30 [00:47<01:41,  4.85s/it]    {'epoch': 44, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9367, 'compress@10': 0.0509, 'time@10': 6.4528}:  33%|███▎      | 10/30 [00:47<01:51,  5.57s/it]{'epoch': 44, 'num_users': 6.6364, 'loss': 0.0197, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9351, 'compress@10': 0.0504, 'time@10': 6.5578}:  33%|███▎      | 10/30 [00:51<01:51,  5.57s/it]{'epoch': 44, 'num_users': 6.6364, 'loss': 0.0197, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9351, 'compress@10': 0.0504, 'time@10': 6.5578}:  37%|███▋      | 11/30 [00:51<01:35,  5.04s/it]{'epoch': 44, 'num_users': 6.4167, 'loss': 0.0181, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9335, 'compress@10': 0.0536, 'time@10': 6.2986}:  37%|███▋      | 11/30 [00:55<01:35,  5.04s/it]{'epoch': 44, 'num_users': 6.4167, 'loss': 0.0181, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9335, 'compress@10': 0.0536, 'time@10': 6.2986}:  40%|████      | 12/30 [00:55<01:22,  4.57s/it]{'epoch': 44, 'num_users': 6.6154, 'loss': 0.0183, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.932, 'compress@10': 0.0536, 'time@10': 6.3268}:  40%|████      | 12/30 [00:58<01:22,  4.57s/it] {'epoch': 44, 'num_users': 6.6154, 'loss': 0.0183, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.932, 'compress@10': 0.0536, 'time@10': 6.3268}:  43%|████▎     | 13/30 [00:58<01:11,  4.21s/it]{'epoch': 44, 'num_users': 6.3571, 'loss': 0.017, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.925, 'compress@10': 0.0622, 'time@10': 6.1049}:  43%|████▎     | 13/30 [01:01<01:11,  4.21s/it] {'epoch': 44, 'num_users': 6.3571, 'loss': 0.017, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.925, 'compress@10': 0.0622, 'time@10': 6.1049}:  47%|████▋     | 14/30 [01:01<01:02,  3.92s/it]{'epoch': 44, 'num_users': 6.2667, 'loss': 0.0174, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9241, 'compress@10': 0.0608, 'time@10': 6.2237}:  47%|████▋     | 14/30 [01:05<01:02,  3.92s/it]{'epoch': 44, 'num_users': 6.2667, 'loss': 0.0174, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9241, 'compress@10': 0.0608, 'time@10': 6.2237}:  50%|█████     | 15/30 [01:05<00:59,  3.94s/it]{'epoch': 44, 'num_users': 6.0625, 'loss': 0.0164, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9236, 'compress@10': 0.0627, 'time@10': 6.0438}:  50%|█████     | 15/30 [01:09<00:59,  3.94s/it]{'epoch': 44, 'num_users': 6.0625, 'loss': 0.0164, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9236, 'compress@10': 0.0627, 'time@10': 6.0438}:  53%|█████▎    | 16/30 [01:09<00:52,  3.77s/it]{'epoch': 44, 'num_users': 5.8235, 'loss': 0.0154, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9164, 'compress@10': 0.0713, 'time@10': 5.9033}:  53%|█████▎    | 16/30 [01:11<00:52,  3.77s/it]{'epoch': 44, 'num_users': 5.8235, 'loss': 0.0154, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9164, 'compress@10': 0.0713, 'time@10': 5.9033}:  57%|█████▋    | 17/30 [01:11<00:41,  3.20s/it]{'epoch': 44, 'num_users': 6.0556, 'loss': 0.0153, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9176, 'compress@10': 0.0695, 'time@10': 5.8243}:  57%|█████▋    | 17/30 [01:15<00:41,  3.20s/it]{'epoch': 44, 'num_users': 6.0556, 'loss': 0.0153, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9176, 'compress@10': 0.0695, 'time@10': 5.8243}:  60%|██████    | 18/30 [01:15<00:43,  3.61s/it]{'epoch': 44, 'num_users': 6.0, 'loss': 0.0148, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.9179, 'compress@10': 0.07, 'time@10': 5.7705}:  60%|██████    | 18/30 [01:18<00:43,  3.61s/it]     {'epoch': 44, 'num_users': 6.0, 'loss': 0.0148, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.9179, 'compress@10': 0.07, 'time@10': 5.7705}:  63%|██████▎   | 19/30 [01:18<00:35,  3.26s/it]{'epoch': 44, 'num_users': 6.15, 'loss': 0.0154, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9194, 'compress@10': 0.0678, 'time@10': 5.8835}:  63%|██████▎   | 19/30 [01:26<00:35,  3.26s/it]{'epoch': 44, 'num_users': 6.15, 'loss': 0.0154, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9194, 'compress@10': 0.0678, 'time@10': 5.8835}:  67%|██████▋   | 20/30 [01:26<00:47,  4.70s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9184, 'compress@10': 0.0664, 'time@10': 5.9709}:  67%|██████▋   | 20/30 [01:30<00:47,  4.70s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9184, 'compress@10': 0.0664, 'time@10': 5.9709}:  70%|███████   | 21/30 [01:30<00:40,  4.46s/it]{'epoch': 44, 'num_users': 6.1818, 'loss': 0.0158, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9186, 'compress@10': 0.0658, 'time@10': 5.8742}:  70%|███████   | 21/30 [01:34<00:40,  4.46s/it]{'epoch': 44, 'num_users': 6.1818, 'loss': 0.0158, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9186, 'compress@10': 0.0658, 'time@10': 5.8742}:  73%|███████▎  | 22/30 [01:34<00:34,  4.29s/it]{'epoch': 44, 'num_users': 6.1304, 'loss': 0.0156, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9193, 'compress@10': 0.0657, 'time@10': 5.8937}:  73%|███████▎  | 22/30 [01:37<00:34,  4.29s/it]{'epoch': 44, 'num_users': 6.1304, 'loss': 0.0156, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9193, 'compress@10': 0.0657, 'time@10': 5.8937}:  77%|███████▋  | 23/30 [01:37<00:27,  3.96s/it]{'epoch': 44, 'num_users': 5.9583, 'loss': 0.0149, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9143, 'compress@10': 0.0719, 'time@10': 5.7858}:  77%|███████▋  | 23/30 [01:40<00:27,  3.96s/it]{'epoch': 44, 'num_users': 5.9583, 'loss': 0.0149, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9143, 'compress@10': 0.0719, 'time@10': 5.7858}:  80%|████████  | 24/30 [01:40<00:22,  3.78s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9044, 'compress@10': 0.0825, 'time@10': 5.6867}:  80%|████████  | 24/30 [01:42<00:22,  3.78s/it]   {'epoch': 44, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9044, 'compress@10': 0.0825, 'time@10': 5.6867}:  83%|████████▎ | 25/30 [01:42<00:15,  3.15s/it]{'epoch': 44, 'num_users': 5.8077, 'loss': 0.0142, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.907, 'compress@10': 0.0802, 'time@10': 5.7535}:  83%|████████▎ | 25/30 [01:49<00:15,  3.15s/it]{'epoch': 44, 'num_users': 5.8077, 'loss': 0.0142, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.907, 'compress@10': 0.0802, 'time@10': 5.7535}:  87%|████████▋ | 26/30 [01:49<00:17,  4.45s/it]{'epoch': 44, 'num_users': 5.8889, 'loss': 0.0145, 'hit_ratio@10': 0.867, 'ndcg@10': 0.908, 'compress@10': 0.0787, 'time@10': 5.8311}:  87%|████████▋ | 26/30 [01:53<00:17,  4.45s/it] {'epoch': 44, 'num_users': 5.8889, 'loss': 0.0145, 'hit_ratio@10': 0.867, 'ndcg@10': 0.908, 'compress@10': 0.0787, 'time@10': 5.8311}:  90%|█████████ | 27/30 [01:53<00:12,  4.30s/it]{'epoch': 44, 'num_users': 6.0, 'loss': 0.0154, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9103, 'compress@10': 0.077, 'time@10': 5.8853}:  90%|█████████ | 27/30 [02:01<00:12,  4.30s/it]   {'epoch': 44, 'num_users': 6.0, 'loss': 0.0154, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9103, 'compress@10': 0.077, 'time@10': 5.8853}:  93%|█████████▎| 28/30 [02:01<00:10,  5.23s/it]{'epoch': 44, 'num_users': 5.8621, 'loss': 0.0152, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9116, 'compress@10': 0.0761, 'time@10': 5.9295}:  93%|█████████▎| 28/30 [02:04<00:10,  5.23s/it]{'epoch': 44, 'num_users': 5.8621, 'loss': 0.0152, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9116, 'compress@10': 0.0761, 'time@10': 5.9295}:  97%|█████████▋| 29/30 [02:04<00:04,  4.75s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0155, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9111, 'compress@10': 0.0747, 'time@10': 5.9292}:  97%|█████████▋| 29/30 [02:10<00:04,  4.75s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0155, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9111, 'compress@10': 0.0747, 'time@10': 5.9292}: 100%|██████████| 30/30 [02:10<00:00,  5.11s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0155, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9111, 'compress@10': 0.0747, 'time@10': 5.9292}: 100%|██████████| 30/30 [02:10<00:00,  4.36s/it]
Epoch: 44
Avg # of users: 5.866666666666666
Avg Loss: 0.015466284249633859
Avg hit ratio: 0.8736051400377642
Avg ndcg: 0.9111230577524522
Avg compression ratio: 0.07471378296811292
Avg train time: 5.9292163530985516
Std train time: 1.8438575545746958
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 18, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 44, 8, 20, 28, 10, 10, 9, 6, 11, 10, 50, 50, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9128, 'compress@10': 0.0601, 'time@10': 6.7184}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9128, 'compress@10': 0.0601, 'time@10': 6.7184}:   3%|▎         | 1/30 [00:03<01:38,  3.40s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9324, 'compress@10': 0.0494, 'time@10': 5.9011}:   3%|▎         | 1/30 [00:08<01:38,  3.40s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9324, 'compress@10': 0.0494, 'time@10': 5.9011}:   7%|▋         | 2/30 [00:08<02:03,  4.41s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9073, 'compress@10': 0.0823, 'time@10': 5.1372}:   7%|▋         | 2/30 [00:10<02:03,  4.41s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9073, 'compress@10': 0.0823, 'time@10': 5.1372}:  10%|█         | 3/30 [00:10<01:27,  3.24s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9203, 'compress@10': 0.073, 'time@10': 5.0343}:  10%|█         | 3/30 [00:15<01:27,  3.24s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9203, 'compress@10': 0.073, 'time@10': 5.0343}:  13%|█▎        | 4/30 [00:15<01:39,  3.84s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.9061, 'compress@10': 0.0638, 'time@10': 5.7678}:  13%|█▎        | 4/30 [00:19<01:39,  3.84s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.9061, 'compress@10': 0.0638, 'time@10': 5.7678}:  17%|█▋        | 5/30 [00:19<01:40,  4.04s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9184, 'compress@10': 0.0592, 'time@10': 6.0553}:  17%|█▋        | 5/30 [00:27<01:40,  4.04s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9184, 'compress@10': 0.0592, 'time@10': 6.0553}:  20%|██        | 6/30 [00:27<02:05,  5.24s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0161, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9198, 'compress@10': 0.058, 'time@10': 6.3827}:  20%|██        | 6/30 [00:31<02:05,  5.24s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0161, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9198, 'compress@10': 0.058, 'time@10': 6.3827}:  23%|██▎       | 7/30 [00:31<01:52,  4.91s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.017, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9271, 'compress@10': 0.055, 'time@10': 6.2825}:  23%|██▎       | 7/30 [00:36<01:52,  4.91s/it]  {'epoch': 45, 'num_users': 6.125, 'loss': 0.017, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9271, 'compress@10': 0.055, 'time@10': 6.2825}:  27%|██▋       | 8/30 [00:36<01:52,  5.14s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9315, 'compress@10': 0.053, 'time@10': 6.5584}:  27%|██▋       | 8/30 [00:41<01:52,  5.14s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9315, 'compress@10': 0.053, 'time@10': 6.5584}:  30%|███       | 9/30 [00:41<01:43,  4.91s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9359, 'compress@10': 0.0502, 'time@10': 6.6348}:  30%|███       | 9/30 [00:48<01:43,  4.91s/it]  {'epoch': 45, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9359, 'compress@10': 0.0502, 'time@10': 6.6348}:  33%|███▎      | 10/30 [00:48<01:53,  5.67s/it]{'epoch': 45, 'num_users': 6.6364, 'loss': 0.0174, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9345, 'compress@10': 0.0497, 'time@10': 6.7185}:  33%|███▎      | 10/30 [00:52<01:53,  5.67s/it]{'epoch': 45, 'num_users': 6.6364, 'loss': 0.0174, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9345, 'compress@10': 0.0497, 'time@10': 6.7185}:  37%|███▋      | 11/30 [00:52<01:37,  5.11s/it]{'epoch': 45, 'num_users': 6.4167, 'loss': 0.016, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.933, 'compress@10': 0.053, 'time@10': 6.4441}:  37%|███▋      | 11/30 [00:56<01:37,  5.11s/it]   {'epoch': 45, 'num_users': 6.4167, 'loss': 0.016, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.933, 'compress@10': 0.053, 'time@10': 6.4441}:  40%|████      | 12/30 [00:56<01:22,  4.61s/it]{'epoch': 45, 'num_users': 6.6154, 'loss': 0.0164, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9313, 'compress@10': 0.053, 'time@10': 6.4548}:  40%|████      | 12/30 [00:59<01:22,  4.61s/it]{'epoch': 45, 'num_users': 6.6154, 'loss': 0.0164, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9313, 'compress@10': 0.053, 'time@10': 6.4548}:  43%|████▎     | 13/30 [00:59<01:11,  4.22s/it]{'epoch': 45, 'num_users': 6.3571, 'loss': 0.0152, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.9243, 'compress@10': 0.0615, 'time@10': 6.2213}:  43%|████▎     | 13/30 [01:02<01:11,  4.22s/it]{'epoch': 45, 'num_users': 6.3571, 'loss': 0.0152, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.9243, 'compress@10': 0.0615, 'time@10': 6.2213}:  47%|████▋     | 14/30 [01:02<01:02,  3.93s/it]{'epoch': 45, 'num_users': 6.2667, 'loss': 0.0167, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9219, 'compress@10': 0.0603, 'time@10': 6.323}:  47%|████▋     | 14/30 [01:06<01:02,  3.93s/it] {'epoch': 45, 'num_users': 6.2667, 'loss': 0.0167, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9219, 'compress@10': 0.0603, 'time@10': 6.323}:  50%|█████     | 15/30 [01:06<00:58,  3.93s/it]{'epoch': 45, 'num_users': 6.0625, 'loss': 0.0158, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9216, 'compress@10': 0.0622, 'time@10': 6.1619}:  50%|█████     | 15/30 [01:10<00:58,  3.93s/it]{'epoch': 45, 'num_users': 6.0625, 'loss': 0.0158, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9216, 'compress@10': 0.0622, 'time@10': 6.1619}:  53%|█████▎    | 16/30 [01:10<00:54,  3.88s/it]{'epoch': 45, 'num_users': 5.8235, 'loss': 0.0149, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.9144, 'compress@10': 0.0708, 'time@10': 6.031}:  53%|█████▎    | 16/30 [01:12<00:54,  3.88s/it] {'epoch': 45, 'num_users': 5.8235, 'loss': 0.0149, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.9144, 'compress@10': 0.0708, 'time@10': 6.031}:  57%|█████▋    | 17/30 [01:12<00:43,  3.32s/it]{'epoch': 45, 'num_users': 6.0556, 'loss': 0.0147, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.9162, 'compress@10': 0.069, 'time@10': 5.955}:  57%|█████▋    | 17/30 [01:17<00:43,  3.32s/it] {'epoch': 45, 'num_users': 6.0556, 'loss': 0.0147, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.9162, 'compress@10': 0.069, 'time@10': 5.955}:  60%|██████    | 18/30 [01:17<00:44,  3.74s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 0.0142, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.9166, 'compress@10': 0.0695, 'time@10': 5.8608}:  60%|██████    | 18/30 [01:19<00:44,  3.74s/it] {'epoch': 45, 'num_users': 6.0, 'loss': 0.0142, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.9166, 'compress@10': 0.0695, 'time@10': 5.8608}:  63%|██████▎   | 19/30 [01:19<00:35,  3.25s/it]{'epoch': 45, 'num_users': 6.15, 'loss': 0.0143, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9194, 'compress@10': 0.0675, 'time@10': 5.973}:  63%|██████▎   | 19/30 [01:27<00:35,  3.25s/it]{'epoch': 45, 'num_users': 6.15, 'loss': 0.0143, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9194, 'compress@10': 0.0675, 'time@10': 5.973}:  67%|██████▋   | 20/30 [01:27<00:47,  4.72s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0149, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.919, 'compress@10': 0.0661, 'time@10': 6.0659}:  67%|██████▋   | 20/30 [01:31<00:47,  4.72s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0149, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.919, 'compress@10': 0.0661, 'time@10': 6.0659}:  70%|███████   | 21/30 [01:31<00:40,  4.51s/it]{'epoch': 45, 'num_users': 6.1818, 'loss': 0.0154, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.9185, 'compress@10': 0.0655, 'time@10': 5.9667}:  70%|███████   | 21/30 [01:35<00:40,  4.51s/it]{'epoch': 45, 'num_users': 6.1818, 'loss': 0.0154, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.9185, 'compress@10': 0.0655, 'time@10': 5.9667}:  73%|███████▎  | 22/30 [01:35<00:34,  4.33s/it]{'epoch': 45, 'num_users': 6.1304, 'loss': 0.0151, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.9191, 'compress@10': 0.0654, 'time@10': 5.99}:  73%|███████▎  | 22/30 [01:38<00:34,  4.33s/it]  {'epoch': 45, 'num_users': 6.1304, 'loss': 0.0151, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.9191, 'compress@10': 0.0654, 'time@10': 5.99}:  77%|███████▋  | 23/30 [01:38<00:28,  4.02s/it]{'epoch': 45, 'num_users': 5.9583, 'loss': 0.0145, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.9142, 'compress@10': 0.0716, 'time@10': 5.878}:  77%|███████▋  | 23/30 [01:41<00:28,  4.02s/it]{'epoch': 45, 'num_users': 5.9583, 'loss': 0.0145, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.9142, 'compress@10': 0.0716, 'time@10': 5.878}:  80%|████████  | 24/30 [01:41<00:22,  3.82s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.9043, 'compress@10': 0.0822, 'time@10': 5.7675}:  80%|████████  | 24/30 [01:43<00:22,  3.82s/it]  {'epoch': 45, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.9043, 'compress@10': 0.0822, 'time@10': 5.7675}:  83%|████████▎ | 25/30 [01:43<00:15,  3.15s/it]{'epoch': 45, 'num_users': 5.8077, 'loss': 0.0138, 'hit_ratio@10': 0.847, 'ndcg@10': 0.9068, 'compress@10': 0.0799, 'time@10': 5.842}:  83%|████████▎ | 25/30 [01:51<00:15,  3.15s/it]{'epoch': 45, 'num_users': 5.8077, 'loss': 0.0138, 'hit_ratio@10': 0.847, 'ndcg@10': 0.9068, 'compress@10': 0.0799, 'time@10': 5.842}:  87%|████████▋ | 26/30 [01:51<00:18,  4.53s/it]{'epoch': 45, 'num_users': 5.8889, 'loss': 0.014, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.9081, 'compress@10': 0.0784, 'time@10': 5.8816}:  87%|████████▋ | 26/30 [01:54<00:18,  4.53s/it]{'epoch': 45, 'num_users': 5.8889, 'loss': 0.014, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.9081, 'compress@10': 0.0784, 'time@10': 5.8816}:  90%|█████████ | 27/30 [01:54<00:12,  4.22s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 0.0139, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.9105, 'compress@10': 0.0768, 'time@10': 5.9613}:  90%|█████████ | 27/30 [02:02<00:12,  4.22s/it]  {'epoch': 45, 'num_users': 6.0, 'loss': 0.0139, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.9105, 'compress@10': 0.0768, 'time@10': 5.9613}:  93%|█████████▎| 28/30 [02:02<00:10,  5.40s/it]{'epoch': 45, 'num_users': 5.8621, 'loss': 0.0137, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9119, 'compress@10': 0.0758, 'time@10': 5.9934}:  93%|█████████▎| 28/30 [02:06<00:10,  5.40s/it]{'epoch': 45, 'num_users': 5.8621, 'loss': 0.0137, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9119, 'compress@10': 0.0758, 'time@10': 5.9934}:  97%|█████████▋| 29/30 [02:06<00:04,  4.83s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.0139, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9119, 'compress@10': 0.0745, 'time@10': 5.9906}:  97%|█████████▋| 29/30 [02:12<00:04,  4.83s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.0139, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9119, 'compress@10': 0.0745, 'time@10': 5.9906}: 100%|██████████| 30/30 [02:12<00:00,  5.17s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.0139, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9119, 'compress@10': 0.0745, 'time@10': 5.9906}: 100%|██████████| 30/30 [02:12<00:00,  4.41s/it]
Epoch: 45
Avg # of users: 5.866666666666666
Avg Loss: 0.013942025660386399
Avg hit ratio: 0.8582068086622032
Avg ndcg: 0.9118577898880924
Avg compression ratio: 0.07446374035239436
Avg train time: 5.990560777982076
Std train time: 1.876510365439492
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 18, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 44, 8, 20, 28, 10, 10, 9, 6, 11, 10, 50, 51, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9128, 'compress@10': 0.0601, 'time@10': 5.8611}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9128, 'compress@10': 0.0601, 'time@10': 5.8611}:   3%|▎         | 1/30 [00:02<01:26,  2.97s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9454, 'compress@10': 0.05, 'time@10': 5.3676}:   3%|▎         | 1/30 [00:07<01:26,  2.97s/it] {'epoch': 46, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9454, 'compress@10': 0.05, 'time@10': 5.3676}:   7%|▋         | 2/30 [00:07<01:55,  4.12s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.916, 'compress@10': 0.0826, 'time@10': 4.6927}:   7%|▋         | 2/30 [00:09<01:55,  4.12s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.916, 'compress@10': 0.0826, 'time@10': 4.6927}:  10%|█         | 3/30 [00:09<01:21,  3.02s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9222, 'compress@10': 0.073, 'time@10': 4.6376}:  10%|█         | 3/30 [00:14<01:21,  3.02s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9222, 'compress@10': 0.073, 'time@10': 4.6376}:  13%|█▎        | 4/30 [00:14<01:33,  3.61s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0191, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9092, 'compress@10': 0.0638, 'time@10': 5.3073}:  13%|█▎        | 4/30 [00:18<01:33,  3.61s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0191, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9092, 'compress@10': 0.0638, 'time@10': 5.3073}:  17%|█▋        | 5/30 [00:18<01:34,  3.76s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9192, 'compress@10': 0.059, 'time@10': 5.6226}:  17%|█▋        | 5/30 [00:25<01:34,  3.76s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9192, 'compress@10': 0.059, 'time@10': 5.6226}:  20%|██        | 6/30 [00:25<01:58,  4.94s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9251, 'compress@10': 0.0573, 'time@10': 5.9488}:  20%|██        | 6/30 [00:29<01:58,  4.94s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9251, 'compress@10': 0.0573, 'time@10': 5.9488}:  23%|██▎       | 7/30 [00:29<01:46,  4.63s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9348, 'compress@10': 0.0544, 'time@10': 5.9059}:  23%|██▎       | 7/30 [00:35<01:46,  4.63s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9348, 'compress@10': 0.0544, 'time@10': 5.9059}:  27%|██▋       | 8/30 [00:35<01:49,  4.96s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9383, 'compress@10': 0.0524, 'time@10': 6.1243}:  27%|██▋       | 8/30 [00:39<01:49,  4.96s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9383, 'compress@10': 0.0524, 'time@10': 6.1243}:  30%|███       | 9/30 [00:39<01:37,  4.65s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9428, 'compress@10': 0.0497, 'time@10': 6.226}:  30%|███       | 9/30 [00:46<01:37,  4.65s/it]    {'epoch': 46, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9428, 'compress@10': 0.0497, 'time@10': 6.226}:  33%|███▎      | 10/30 [00:46<01:48,  5.43s/it]{'epoch': 46, 'num_users': 6.6364, 'loss': 0.0212, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9407, 'compress@10': 0.0492, 'time@10': 6.3386}:  33%|███▎      | 10/30 [00:49<01:48,  5.43s/it]{'epoch': 46, 'num_users': 6.6364, 'loss': 0.0212, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9407, 'compress@10': 0.0492, 'time@10': 6.3386}:  37%|███▋      | 11/30 [00:49<01:33,  4.92s/it]{'epoch': 46, 'num_users': 6.4167, 'loss': 0.0194, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9387, 'compress@10': 0.0525, 'time@10': 6.0993}:  37%|███▋      | 11/30 [00:53<01:33,  4.92s/it]{'epoch': 46, 'num_users': 6.4167, 'loss': 0.0194, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9387, 'compress@10': 0.0525, 'time@10': 6.0993}:  40%|████      | 12/30 [00:53<01:20,  4.50s/it]{'epoch': 46, 'num_users': 6.6154, 'loss': 0.0194, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9368, 'compress@10': 0.0525, 'time@10': 6.1292}:  40%|████      | 12/30 [00:56<01:20,  4.50s/it]{'epoch': 46, 'num_users': 6.6154, 'loss': 0.0194, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9368, 'compress@10': 0.0525, 'time@10': 6.1292}:  43%|████▎     | 13/30 [00:56<01:10,  4.13s/it]{'epoch': 46, 'num_users': 6.3571, 'loss': 0.018, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9294, 'compress@10': 0.061, 'time@10': 5.9303}:  43%|████▎     | 13/30 [01:00<01:10,  4.13s/it]  {'epoch': 46, 'num_users': 6.3571, 'loss': 0.018, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9294, 'compress@10': 0.061, 'time@10': 5.9303}:  47%|████▋     | 14/30 [01:00<01:02,  3.91s/it]{'epoch': 46, 'num_users': 6.2667, 'loss': 0.0182, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9307, 'compress@10': 0.0597, 'time@10': 6.0598}:  47%|████▋     | 14/30 [01:04<01:02,  3.91s/it]{'epoch': 46, 'num_users': 6.2667, 'loss': 0.0182, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9307, 'compress@10': 0.0597, 'time@10': 6.0598}:  50%|█████     | 15/30 [01:04<00:58,  3.93s/it]{'epoch': 46, 'num_users': 6.0625, 'loss': 0.0171, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9298, 'compress@10': 0.0618, 'time@10': 5.9081}:  50%|█████     | 15/30 [01:07<00:58,  3.93s/it]{'epoch': 46, 'num_users': 6.0625, 'loss': 0.0171, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9298, 'compress@10': 0.0618, 'time@10': 5.9081}:  53%|█████▎    | 16/30 [01:07<00:53,  3.85s/it]{'epoch': 46, 'num_users': 5.8235, 'loss': 0.0161, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9222, 'compress@10': 0.0703, 'time@10': 5.778}:  53%|█████▎    | 16/30 [01:09<00:53,  3.85s/it] {'epoch': 46, 'num_users': 5.8235, 'loss': 0.0161, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9222, 'compress@10': 0.0703, 'time@10': 5.778}:  57%|█████▋    | 17/30 [01:09<00:42,  3.26s/it]{'epoch': 46, 'num_users': 6.0556, 'loss': 0.0158, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.9228, 'compress@10': 0.0686, 'time@10': 5.7107}:  57%|█████▋    | 17/30 [01:14<00:42,  3.26s/it]{'epoch': 46, 'num_users': 6.0556, 'loss': 0.0158, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.9228, 'compress@10': 0.0686, 'time@10': 5.7107}:  60%|██████    | 18/30 [01:14<00:43,  3.67s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 0.0153, 'hit_ratio@10': 0.841, 'ndcg@10': 0.9229, 'compress@10': 0.0691, 'time@10': 5.6257}:  60%|██████    | 18/30 [01:16<00:43,  3.67s/it]    {'epoch': 46, 'num_users': 6.0, 'loss': 0.0153, 'hit_ratio@10': 0.841, 'ndcg@10': 0.9229, 'compress@10': 0.0691, 'time@10': 5.6257}:  63%|██████▎   | 19/30 [01:16<00:35,  3.19s/it]{'epoch': 46, 'num_users': 6.15, 'loss': 0.0158, 'hit_ratio@10': 0.848, 'ndcg@10': 0.9256, 'compress@10': 0.067, 'time@10': 5.7439}:  63%|██████▎   | 19/30 [01:24<00:35,  3.19s/it]{'epoch': 46, 'num_users': 6.15, 'loss': 0.0158, 'hit_ratio@10': 0.848, 'ndcg@10': 0.9256, 'compress@10': 0.067, 'time@10': 5.7439}:  67%|██████▋   | 20/30 [01:24<00:46,  4.64s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.9243, 'compress@10': 0.0656, 'time@10': 5.8432}:  67%|██████▋   | 20/30 [01:28<00:46,  4.64s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.9243, 'compress@10': 0.0656, 'time@10': 5.8432}:  70%|███████   | 21/30 [01:28<00:39,  4.44s/it]{'epoch': 46, 'num_users': 6.1818, 'loss': 0.0165, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9249, 'compress@10': 0.065, 'time@10': 5.7508}:  70%|███████   | 21/30 [01:32<00:39,  4.44s/it] {'epoch': 46, 'num_users': 6.1818, 'loss': 0.0165, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9249, 'compress@10': 0.065, 'time@10': 5.7508}:  73%|███████▎  | 22/30 [01:32<00:34,  4.26s/it]{'epoch': 46, 'num_users': 6.1304, 'loss': 0.0162, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.9253, 'compress@10': 0.0649, 'time@10': 5.7716}:  73%|███████▎  | 22/30 [01:35<00:34,  4.26s/it]{'epoch': 46, 'num_users': 6.1304, 'loss': 0.0162, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.9253, 'compress@10': 0.0649, 'time@10': 5.7716}:  77%|███████▋  | 23/30 [01:35<00:27,  3.93s/it]{'epoch': 46, 'num_users': 5.9583, 'loss': 0.0156, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9201, 'compress@10': 0.071, 'time@10': 5.6657}:  77%|███████▋  | 23/30 [01:38<00:27,  3.93s/it] {'epoch': 46, 'num_users': 5.9583, 'loss': 0.0156, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9201, 'compress@10': 0.071, 'time@10': 5.6657}:  80%|████████  | 24/30 [01:38<00:22,  3.73s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.015, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.9099, 'compress@10': 0.0817, 'time@10': 5.5662}:  80%|████████  | 24/30 [01:40<00:22,  3.73s/it]   {'epoch': 46, 'num_users': 5.8, 'loss': 0.015, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.9099, 'compress@10': 0.0817, 'time@10': 5.5662}:  83%|████████▎ | 25/30 [01:40<00:15,  3.10s/it]{'epoch': 46, 'num_users': 5.8077, 'loss': 0.0147, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9123, 'compress@10': 0.0794, 'time@10': 5.6611}:  83%|████████▎ | 25/30 [01:48<00:15,  3.10s/it]{'epoch': 46, 'num_users': 5.8077, 'loss': 0.0147, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9123, 'compress@10': 0.0794, 'time@10': 5.6611}:  87%|████████▋ | 26/30 [01:48<00:18,  4.59s/it]{'epoch': 46, 'num_users': 5.8889, 'loss': 0.0149, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.9135, 'compress@10': 0.0779, 'time@10': 5.6896}:  87%|████████▋ | 26/30 [01:51<00:18,  4.59s/it]{'epoch': 46, 'num_users': 5.8889, 'loss': 0.0149, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.9135, 'compress@10': 0.0779, 'time@10': 5.6896}:  90%|█████████ | 27/30 [01:51<00:12,  4.19s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 0.0154, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9172, 'compress@10': 0.0763, 'time@10': 5.7728}:  90%|█████████ | 27/30 [01:59<00:12,  4.19s/it]   {'epoch': 46, 'num_users': 6.0, 'loss': 0.0154, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9172, 'compress@10': 0.0763, 'time@10': 5.7728}:  93%|█████████▎| 28/30 [01:59<00:10,  5.36s/it]{'epoch': 46, 'num_users': 5.8621, 'loss': 0.0152, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.9184, 'compress@10': 0.0754, 'time@10': 5.816}:  93%|█████████▎| 28/30 [02:03<00:10,  5.36s/it]{'epoch': 46, 'num_users': 5.8621, 'loss': 0.0152, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.9184, 'compress@10': 0.0754, 'time@10': 5.816}:  97%|█████████▋| 29/30 [02:03<00:04,  4.82s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.0153, 'hit_ratio@10': 0.862, 'ndcg@10': 0.918, 'compress@10': 0.0741, 'time@10': 5.8181}:  97%|█████████▋| 29/30 [02:09<00:04,  4.82s/it] {'epoch': 46, 'num_users': 5.8667, 'loss': 0.0153, 'hit_ratio@10': 0.862, 'ndcg@10': 0.918, 'compress@10': 0.0741, 'time@10': 5.8181}: 100%|██████████| 30/30 [02:09<00:00,  5.15s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.0153, 'hit_ratio@10': 0.862, 'ndcg@10': 0.918, 'compress@10': 0.0741, 'time@10': 5.8181}: 100%|██████████| 30/30 [02:09<00:00,  4.31s/it]
Epoch: 46
Avg # of users: 5.866666666666666
Avg Loss: 0.015331389831073006
Avg hit ratio: 0.861995912944666
Avg ndcg: 0.9180476583330787
Avg compression ratio: 0.07406400506576681
Avg train time: 5.818096661567688
Std train time: 1.7971504574013333
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 18, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 44, 8, 20, 28, 10, 10, 9, 6, 11, 10, 50, 51, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.915, 'compress@10': 0.0597, 'time@10': 6.4263}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.915, 'compress@10': 0.0597, 'time@10': 6.4263}:   3%|▎         | 1/30 [00:03<01:34,  3.27s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9379, 'compress@10': 0.0498, 'time@10': 5.6009}:   3%|▎         | 1/30 [00:08<01:34,  3.27s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9379, 'compress@10': 0.0498, 'time@10': 5.6009}:   7%|▋         | 2/30 [00:08<01:57,  4.18s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.911, 'compress@10': 0.0823, 'time@10': 4.7703}:   7%|▋         | 2/30 [00:09<01:57,  4.18s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.911, 'compress@10': 0.0823, 'time@10': 4.7703}:  10%|█         | 3/30 [00:09<01:20,  3.00s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9428, 'compress@10': 0.0728, 'time@10': 4.6616}:  10%|█         | 3/30 [00:14<01:20,  3.00s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9428, 'compress@10': 0.0728, 'time@10': 4.6616}:  13%|█▎        | 4/30 [00:14<01:32,  3.54s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.9258, 'compress@10': 0.0634, 'time@10': 5.3678}:  13%|█▎        | 4/30 [00:18<01:32,  3.54s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.9258, 'compress@10': 0.0634, 'time@10': 5.3678}:  17%|█▋        | 5/30 [00:18<01:33,  3.76s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9338, 'compress@10': 0.0585, 'time@10': 5.7549}:  17%|█▋        | 5/30 [00:25<01:33,  3.76s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9338, 'compress@10': 0.0585, 'time@10': 5.7549}:  20%|██        | 6/30 [00:25<02:02,  5.11s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.926, 'compress@10': 0.0573, 'time@10': 6.1491}:  20%|██        | 6/30 [00:30<02:02,  5.11s/it] {'epoch': 47, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.926, 'compress@10': 0.0573, 'time@10': 6.1491}:  23%|██▎       | 7/30 [00:30<01:51,  4.85s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9331, 'compress@10': 0.0545, 'time@10': 6.0877}:  23%|██▎       | 7/30 [00:35<01:51,  4.85s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9331, 'compress@10': 0.0545, 'time@10': 6.0877}:  27%|██▋       | 8/30 [00:35<01:52,  5.12s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9368, 'compress@10': 0.0524, 'time@10': 6.2926}:  27%|██▋       | 8/30 [00:39<01:52,  5.12s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9368, 'compress@10': 0.0524, 'time@10': 6.2926}:  30%|███       | 9/30 [00:39<01:40,  4.77s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9408, 'compress@10': 0.0497, 'time@10': 6.3702}:  30%|███       | 9/30 [00:47<01:40,  4.77s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9408, 'compress@10': 0.0497, 'time@10': 6.3702}:  33%|███▎      | 10/30 [00:47<01:49,  5.49s/it]{'epoch': 47, 'num_users': 6.6364, 'loss': 0.0184, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9394, 'compress@10': 0.0492, 'time@10': 6.4756}:  33%|███▎      | 10/30 [00:50<01:49,  5.49s/it]{'epoch': 47, 'num_users': 6.6364, 'loss': 0.0184, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9394, 'compress@10': 0.0492, 'time@10': 6.4756}:  37%|███▋      | 11/30 [00:50<01:34,  4.98s/it]{'epoch': 47, 'num_users': 6.4167, 'loss': 0.0169, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9375, 'compress@10': 0.0525, 'time@10': 6.2046}:  37%|███▋      | 11/30 [00:54<01:34,  4.98s/it]{'epoch': 47, 'num_users': 6.4167, 'loss': 0.0169, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9375, 'compress@10': 0.0525, 'time@10': 6.2046}:  40%|████      | 12/30 [00:54<01:20,  4.45s/it]{'epoch': 47, 'num_users': 6.6154, 'loss': 0.0171, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9359, 'compress@10': 0.0524, 'time@10': 6.2187}:  40%|████      | 12/30 [00:57<01:20,  4.45s/it]{'epoch': 47, 'num_users': 6.6154, 'loss': 0.0171, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9359, 'compress@10': 0.0524, 'time@10': 6.2187}:  43%|████▎     | 13/30 [00:57<01:09,  4.09s/it]{'epoch': 47, 'num_users': 6.3571, 'loss': 0.0159, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9286, 'compress@10': 0.061, 'time@10': 6.0291}:  43%|████▎     | 13/30 [01:00<01:09,  4.09s/it] {'epoch': 47, 'num_users': 6.3571, 'loss': 0.0159, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9286, 'compress@10': 0.061, 'time@10': 6.0291}:  47%|████▋     | 14/30 [01:00<01:03,  3.94s/it]{'epoch': 47, 'num_users': 6.2667, 'loss': 0.0176, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9207, 'compress@10': 0.0596, 'time@10': 6.1533}:  47%|████▋     | 14/30 [01:04<01:03,  3.94s/it]{'epoch': 47, 'num_users': 6.2667, 'loss': 0.0176, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9207, 'compress@10': 0.0596, 'time@10': 6.1533}:  50%|█████     | 15/30 [01:04<00:59,  3.96s/it]{'epoch': 47, 'num_users': 6.0625, 'loss': 0.0167, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.9205, 'compress@10': 0.0616, 'time@10': 5.9833}:  50%|█████     | 15/30 [01:08<00:59,  3.96s/it]{'epoch': 47, 'num_users': 6.0625, 'loss': 0.0167, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.9205, 'compress@10': 0.0616, 'time@10': 5.9833}:  53%|█████▎    | 16/30 [01:08<00:53,  3.81s/it]{'epoch': 47, 'num_users': 5.8235, 'loss': 0.0157, 'hit_ratio@10': 0.829, 'ndcg@10': 0.9134, 'compress@10': 0.0702, 'time@10': 5.8503}:  53%|█████▎    | 16/30 [01:10<00:53,  3.81s/it] {'epoch': 47, 'num_users': 5.8235, 'loss': 0.0157, 'hit_ratio@10': 0.829, 'ndcg@10': 0.9134, 'compress@10': 0.0702, 'time@10': 5.8503}:  57%|█████▋    | 17/30 [01:10<00:42,  3.24s/it]{'epoch': 47, 'num_users': 6.0556, 'loss': 0.0156, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.9147, 'compress@10': 0.0685, 'time@10': 5.7752}:  57%|█████▋    | 17/30 [01:14<00:42,  3.24s/it]{'epoch': 47, 'num_users': 6.0556, 'loss': 0.0156, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.9147, 'compress@10': 0.0685, 'time@10': 5.7752}:  60%|██████    | 18/30 [01:14<00:43,  3.63s/it]{'epoch': 47, 'num_users': 6.0, 'loss': 0.015, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.9152, 'compress@10': 0.0689, 'time@10': 5.705}:  60%|██████    | 18/30 [01:17<00:43,  3.63s/it]     {'epoch': 47, 'num_users': 6.0, 'loss': 0.015, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.9152, 'compress@10': 0.0689, 'time@10': 5.705}:  63%|██████▎   | 19/30 [01:17<00:35,  3.22s/it]{'epoch': 47, 'num_users': 6.15, 'loss': 0.0153, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.9177, 'compress@10': 0.0669, 'time@10': 5.8456}:  63%|██████▎   | 19/30 [01:25<00:35,  3.22s/it]{'epoch': 47, 'num_users': 6.15, 'loss': 0.0153, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.9177, 'compress@10': 0.0669, 'time@10': 5.8456}:  67%|██████▋   | 20/30 [01:25<00:48,  4.82s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.917, 'compress@10': 0.0655, 'time@10': 5.9272}:  67%|██████▋   | 20/30 [01:29<00:48,  4.82s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.917, 'compress@10': 0.0655, 'time@10': 5.9272}:  70%|███████   | 21/30 [01:29<00:40,  4.52s/it]{'epoch': 47, 'num_users': 6.1818, 'loss': 0.0161, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9177, 'compress@10': 0.0649, 'time@10': 5.8239}:  70%|███████   | 21/30 [01:33<00:40,  4.52s/it]{'epoch': 47, 'num_users': 6.1818, 'loss': 0.0161, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9177, 'compress@10': 0.0649, 'time@10': 5.8239}:  73%|███████▎  | 22/30 [01:33<00:34,  4.27s/it]{'epoch': 47, 'num_users': 6.1304, 'loss': 0.0158, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.9187, 'compress@10': 0.0648, 'time@10': 5.8434}:  73%|███████▎  | 22/30 [01:36<00:34,  4.27s/it]{'epoch': 47, 'num_users': 6.1304, 'loss': 0.0158, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.9187, 'compress@10': 0.0648, 'time@10': 5.8434}:  77%|███████▋  | 23/30 [01:36<00:27,  3.95s/it]{'epoch': 47, 'num_users': 5.9583, 'loss': 0.0151, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.9137, 'compress@10': 0.0709, 'time@10': 5.7264}:  77%|███████▋  | 23/30 [01:39<00:27,  3.95s/it]{'epoch': 47, 'num_users': 5.9583, 'loss': 0.0151, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.9137, 'compress@10': 0.0709, 'time@10': 5.7264}:  80%|████████  | 24/30 [01:39<00:22,  3.68s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.9038, 'compress@10': 0.0815, 'time@10': 5.6186}:  80%|████████  | 24/30 [01:41<00:22,  3.68s/it]   {'epoch': 47, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.9038, 'compress@10': 0.0815, 'time@10': 5.6186}:  83%|████████▎ | 25/30 [01:41<00:15,  3.04s/it]{'epoch': 47, 'num_users': 5.8077, 'loss': 0.0144, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.9066, 'compress@10': 0.0791, 'time@10': 5.6743}:  83%|████████▎ | 25/30 [01:48<00:15,  3.04s/it]{'epoch': 47, 'num_users': 5.8077, 'loss': 0.0144, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.9066, 'compress@10': 0.0791, 'time@10': 5.6743}:  87%|████████▋ | 26/30 [01:48<00:17,  4.26s/it]{'epoch': 47, 'num_users': 5.8889, 'loss': 0.0146, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9079, 'compress@10': 0.0776, 'time@10': 5.7226}:  87%|████████▋ | 26/30 [01:51<00:17,  4.26s/it]{'epoch': 47, 'num_users': 5.8889, 'loss': 0.0146, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9079, 'compress@10': 0.0776, 'time@10': 5.7226}:  90%|█████████ | 27/30 [01:51<00:12,  4.04s/it]{'epoch': 47, 'num_users': 6.0, 'loss': 0.0149, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9107, 'compress@10': 0.076, 'time@10': 5.8105}:  90%|█████████ | 27/30 [01:59<00:12,  4.04s/it]    {'epoch': 47, 'num_users': 6.0, 'loss': 0.0149, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9107, 'compress@10': 0.076, 'time@10': 5.8105}:  93%|█████████▎| 28/30 [01:59<00:10,  5.30s/it]{'epoch': 47, 'num_users': 5.8621, 'loss': 0.0147, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.9121, 'compress@10': 0.0751, 'time@10': 5.837}:  93%|█████████▎| 28/30 [02:03<00:10,  5.30s/it]{'epoch': 47, 'num_users': 5.8621, 'loss': 0.0147, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.9121, 'compress@10': 0.0751, 'time@10': 5.837}:  97%|█████████▋| 29/30 [02:03<00:04,  4.71s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0148, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9121, 'compress@10': 0.0738, 'time@10': 5.8451}:  97%|█████████▋| 29/30 [02:09<00:04,  4.71s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0148, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9121, 'compress@10': 0.0738, 'time@10': 5.8451}: 100%|██████████| 30/30 [02:09<00:00,  5.18s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0148, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9121, 'compress@10': 0.0738, 'time@10': 5.8451}: 100%|██████████| 30/30 [02:09<00:00,  4.32s/it]
Epoch: 47
Avg # of users: 5.866666666666666
Avg Loss: 0.014790804784456
Avg hit ratio: 0.860173820905399
Avg ndcg: 0.9120787817260859
Avg compression ratio: 0.07379285159198525
Avg train time: 5.845068144798279
Std train time: 1.8834283662808382
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 44, 8, 20, 28, 10, 10, 9, 6, 11, 10, 51, 52, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.915, 'compress@10': 0.0584, 'time@10': 5.9306}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.915, 'compress@10': 0.0584, 'time@10': 5.9306}:   3%|▎         | 1/30 [00:03<01:27,  3.01s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.936, 'compress@10': 0.0489, 'time@10': 5.4726}:   3%|▎         | 1/30 [00:08<01:27,  3.01s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.936, 'compress@10': 0.0489, 'time@10': 5.4726}:   7%|▋         | 2/30 [00:08<01:57,  4.21s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9097, 'compress@10': 0.0816, 'time@10': 4.7593}:   7%|▋         | 2/30 [00:09<01:57,  4.21s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9097, 'compress@10': 0.0816, 'time@10': 4.7593}:  10%|█         | 3/30 [00:09<01:22,  3.07s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9253, 'compress@10': 0.072, 'time@10': 4.7514}:  10%|█         | 3/30 [00:14<01:22,  3.07s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9253, 'compress@10': 0.072, 'time@10': 4.7514}:  13%|█▎        | 4/30 [00:14<01:37,  3.74s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9136, 'compress@10': 0.0627, 'time@10': 5.446}:  13%|█▎        | 4/30 [00:18<01:37,  3.74s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9136, 'compress@10': 0.0627, 'time@10': 5.446}:  17%|█▋        | 5/30 [00:18<01:37,  3.89s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0161, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.9277, 'compress@10': 0.0577, 'time@10': 5.7658}:  17%|█▋        | 5/30 [00:26<01:37,  3.89s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0161, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.9277, 'compress@10': 0.0577, 'time@10': 5.7658}:  20%|██        | 6/30 [00:26<02:02,  5.08s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9306, 'compress@10': 0.0561, 'time@10': 6.0807}:  20%|██        | 6/30 [00:30<02:02,  5.08s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9306, 'compress@10': 0.0561, 'time@10': 6.0807}:  23%|██▎       | 7/30 [00:30<01:48,  4.74s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9158, 'ndcg@10': 0.9396, 'compress@10': 0.0535, 'time@10': 6.0213}:  23%|██▎       | 7/30 [00:35<01:48,  4.74s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9158, 'ndcg@10': 0.9396, 'compress@10': 0.0535, 'time@10': 6.0213}:  27%|██▋       | 8/30 [00:35<01:50,  5.03s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9426, 'compress@10': 0.0515, 'time@10': 6.3306}:  27%|██▋       | 8/30 [00:40<01:50,  5.03s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9426, 'compress@10': 0.0515, 'time@10': 6.3306}:  30%|███       | 9/30 [00:40<01:41,  4.84s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9452, 'compress@10': 0.0489, 'time@10': 6.4155}:  30%|███       | 9/30 [00:47<01:41,  4.84s/it]    {'epoch': 48, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9452, 'compress@10': 0.0489, 'time@10': 6.4155}:  33%|███▎      | 10/30 [00:47<01:51,  5.58s/it]{'epoch': 48, 'num_users': 6.6364, 'loss': 0.0167, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9431, 'compress@10': 0.0484, 'time@10': 6.5211}:  33%|███▎      | 10/30 [00:51<01:51,  5.58s/it]{'epoch': 48, 'num_users': 6.6364, 'loss': 0.0167, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9431, 'compress@10': 0.0484, 'time@10': 6.5211}:  37%|███▋      | 11/30 [00:51<01:35,  5.04s/it]{'epoch': 48, 'num_users': 6.4167, 'loss': 0.0154, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9409, 'compress@10': 0.0517, 'time@10': 6.2459}:  37%|███▋      | 11/30 [00:54<01:35,  5.04s/it]{'epoch': 48, 'num_users': 6.4167, 'loss': 0.0154, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9409, 'compress@10': 0.0517, 'time@10': 6.2459}:  40%|████      | 12/30 [00:54<01:20,  4.50s/it]{'epoch': 48, 'num_users': 6.6154, 'loss': 0.0156, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9396, 'compress@10': 0.0517, 'time@10': 6.2563}:  40%|████      | 12/30 [00:57<01:20,  4.50s/it]{'epoch': 48, 'num_users': 6.6154, 'loss': 0.0156, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9396, 'compress@10': 0.0517, 'time@10': 6.2563}:  43%|████▎     | 13/30 [00:57<01:09,  4.12s/it]{'epoch': 48, 'num_users': 6.3571, 'loss': 0.0144, 'hit_ratio@10': 0.861, 'ndcg@10': 0.932, 'compress@10': 0.0603, 'time@10': 6.0699}:  43%|████▎     | 13/30 [01:01<01:09,  4.12s/it]  {'epoch': 48, 'num_users': 6.3571, 'loss': 0.0144, 'hit_ratio@10': 0.861, 'ndcg@10': 0.932, 'compress@10': 0.0603, 'time@10': 6.0699}:  47%|████▋     | 14/30 [01:01<01:03,  3.99s/it]{'epoch': 48, 'num_users': 6.2667, 'loss': 0.015, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9314, 'compress@10': 0.0589, 'time@10': 6.1897}:  47%|████▋     | 14/30 [01:05<01:03,  3.99s/it]{'epoch': 48, 'num_users': 6.2667, 'loss': 0.015, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9314, 'compress@10': 0.0589, 'time@10': 6.1897}:  50%|█████     | 15/30 [01:05<00:59,  3.98s/it]{'epoch': 48, 'num_users': 6.0625, 'loss': 0.0141, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9305, 'compress@10': 0.0609, 'time@10': 6.0312}:  50%|█████     | 15/30 [01:09<00:59,  3.98s/it]{'epoch': 48, 'num_users': 6.0625, 'loss': 0.0141, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9305, 'compress@10': 0.0609, 'time@10': 6.0312}:  53%|█████▎    | 16/30 [01:09<00:54,  3.90s/it]{'epoch': 48, 'num_users': 5.8235, 'loss': 0.0133, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.9228, 'compress@10': 0.0695, 'time@10': 5.8994}:  53%|█████▎    | 16/30 [01:11<00:54,  3.90s/it]{'epoch': 48, 'num_users': 5.8235, 'loss': 0.0133, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.9228, 'compress@10': 0.0695, 'time@10': 5.8994}:  57%|█████▋    | 17/30 [01:11<00:42,  3.31s/it]{'epoch': 48, 'num_users': 6.0556, 'loss': 0.0131, 'hit_ratio@10': 0.846, 'ndcg@10': 0.9241, 'compress@10': 0.0678, 'time@10': 5.8095}:  57%|█████▋    | 17/30 [01:15<00:42,  3.31s/it] {'epoch': 48, 'num_users': 6.0556, 'loss': 0.0131, 'hit_ratio@10': 0.846, 'ndcg@10': 0.9241, 'compress@10': 0.0678, 'time@10': 5.8095}:  60%|██████    | 18/30 [01:15<00:43,  3.61s/it]{'epoch': 48, 'num_users': 6.0, 'loss': 0.0126, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.9244, 'compress@10': 0.0683, 'time@10': 5.6991}:  60%|██████    | 18/30 [01:17<00:43,  3.61s/it]  {'epoch': 48, 'num_users': 6.0, 'loss': 0.0126, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.9244, 'compress@10': 0.0683, 'time@10': 5.6991}:  63%|██████▎   | 19/30 [01:17<00:34,  3.10s/it]{'epoch': 48, 'num_users': 6.15, 'loss': 0.013, 'hit_ratio@10': 0.857, 'ndcg@10': 0.9271, 'compress@10': 0.0663, 'time@10': 5.8207}:  63%|██████▎   | 19/30 [01:25<00:34,  3.10s/it] {'epoch': 48, 'num_users': 6.15, 'loss': 0.013, 'hit_ratio@10': 0.857, 'ndcg@10': 0.9271, 'compress@10': 0.0663, 'time@10': 5.8207}:  67%|██████▋   | 20/30 [01:25<00:46,  4.62s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.9266, 'compress@10': 0.0651, 'time@10': 5.9167}:  67%|██████▋   | 20/30 [01:29<00:46,  4.62s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.9266, 'compress@10': 0.0651, 'time@10': 5.9167}:  70%|███████   | 21/30 [01:29<00:39,  4.42s/it]{'epoch': 48, 'num_users': 6.1818, 'loss': 0.0136, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.9271, 'compress@10': 0.0645, 'time@10': 5.8319}:  70%|███████   | 21/30 [01:33<00:39,  4.42s/it]{'epoch': 48, 'num_users': 6.1818, 'loss': 0.0136, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.9271, 'compress@10': 0.0645, 'time@10': 5.8319}:  73%|███████▎  | 22/30 [01:33<00:34,  4.33s/it]{'epoch': 48, 'num_users': 6.1304, 'loss': 0.0134, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9275, 'compress@10': 0.0643, 'time@10': 5.8697}:  73%|███████▎  | 22/30 [01:36<00:34,  4.33s/it]{'epoch': 48, 'num_users': 6.1304, 'loss': 0.0134, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9275, 'compress@10': 0.0643, 'time@10': 5.8697}:  77%|███████▋  | 23/30 [01:36<00:28,  4.05s/it]{'epoch': 48, 'num_users': 5.9583, 'loss': 0.0128, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9222, 'compress@10': 0.0703, 'time@10': 5.7668}:  77%|███████▋  | 23/30 [01:40<00:28,  4.05s/it]{'epoch': 48, 'num_users': 5.9583, 'loss': 0.0128, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9222, 'compress@10': 0.0703, 'time@10': 5.7668}:  80%|████████  | 24/30 [01:40<00:23,  3.87s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.912, 'compress@10': 0.0809, 'time@10': 5.6706}:  80%|████████  | 24/30 [01:42<00:23,  3.87s/it]    {'epoch': 48, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.912, 'compress@10': 0.0809, 'time@10': 5.6706}:  83%|████████▎ | 25/30 [01:42<00:16,  3.22s/it]{'epoch': 48, 'num_users': 5.8077, 'loss': 0.0122, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9145, 'compress@10': 0.0786, 'time@10': 5.7356}:  83%|████████▎ | 25/30 [01:49<00:16,  3.22s/it]{'epoch': 48, 'num_users': 5.8077, 'loss': 0.0122, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9145, 'compress@10': 0.0786, 'time@10': 5.7356}:  87%|████████▋ | 26/30 [01:49<00:17,  4.48s/it]{'epoch': 48, 'num_users': 5.8889, 'loss': 0.0124, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9156, 'compress@10': 0.0771, 'time@10': 5.7903}:  87%|████████▋ | 26/30 [01:53<00:17,  4.48s/it]{'epoch': 48, 'num_users': 5.8889, 'loss': 0.0124, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9156, 'compress@10': 0.0771, 'time@10': 5.7903}:  90%|█████████ | 27/30 [01:53<00:12,  4.23s/it]{'epoch': 48, 'num_users': 6.0, 'loss': 0.0124, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9176, 'compress@10': 0.0753, 'time@10': 5.8819}:  90%|█████████ | 27/30 [02:01<00:12,  4.23s/it]   {'epoch': 48, 'num_users': 6.0, 'loss': 0.0124, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9176, 'compress@10': 0.0753, 'time@10': 5.8819}:  93%|█████████▎| 28/30 [02:01<00:10,  5.48s/it]{'epoch': 48, 'num_users': 5.8621, 'loss': 0.0123, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9188, 'compress@10': 0.0744, 'time@10': 5.9279}:  93%|█████████▎| 28/30 [02:05<00:10,  5.48s/it]{'epoch': 48, 'num_users': 5.8621, 'loss': 0.0123, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9188, 'compress@10': 0.0744, 'time@10': 5.9279}:  97%|█████████▋| 29/30 [02:05<00:04,  4.93s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0126, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.918, 'compress@10': 0.0731, 'time@10': 5.9279}:  97%|█████████▋| 29/30 [02:11<00:04,  4.93s/it] {'epoch': 48, 'num_users': 5.8667, 'loss': 0.0126, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.918, 'compress@10': 0.0731, 'time@10': 5.9279}: 100%|██████████| 30/30 [02:11<00:00,  5.24s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0126, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.918, 'compress@10': 0.0731, 'time@10': 5.9279}: 100%|██████████| 30/30 [02:11<00:00,  4.37s/it]
Epoch: 48
Avg # of users: 5.866666666666666
Avg Loss: 0.012640824901423282
Avg hit ratio: 0.8684442910354517
Avg ndcg: 0.9179835519167665
Avg compression ratio: 0.07313105272904367
Avg train time: 5.927898589769999
Std train time: 1.8611422799536392
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 9, 19, 10, 44, 8, 20, 28, 10, 10, 9, 6, 11, 10, 51, 52, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9192, 'compress@10': 0.0589, 'time@10': 5.9868}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9192, 'compress@10': 0.0589, 'time@10': 5.9868}:   3%|▎         | 1/30 [00:03<01:27,  3.03s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9757, 'compress@10': 0.0495, 'time@10': 5.6547}:   3%|▎         | 1/30 [00:08<01:27,  3.03s/it] {'epoch': 49, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9757, 'compress@10': 0.0495, 'time@10': 5.6547}:   7%|▋         | 2/30 [00:08<02:03,  4.41s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9362, 'compress@10': 0.082, 'time@10': 5.2158}:   7%|▋         | 2/30 [00:10<02:03,  4.41s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9362, 'compress@10': 0.082, 'time@10': 5.2158}:  10%|█         | 3/30 [00:10<01:32,  3.41s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9417, 'compress@10': 0.0721, 'time@10': 5.0788}:  10%|█         | 3/30 [00:15<01:32,  3.41s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9417, 'compress@10': 0.0721, 'time@10': 5.0788}:  13%|█▎        | 4/30 [00:15<01:41,  3.92s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.927, 'compress@10': 0.0627, 'time@10': 5.6822}:  13%|█▎        | 4/30 [00:19<01:41,  3.92s/it] {'epoch': 49, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.927, 'compress@10': 0.0627, 'time@10': 5.6822}:  17%|█▋        | 5/30 [00:19<01:39,  3.98s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.935, 'compress@10': 0.0574, 'time@10': 5.9791}:  17%|█▋        | 5/30 [00:26<01:39,  3.98s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.935, 'compress@10': 0.0574, 'time@10': 5.9791}:  20%|██        | 6/30 [00:26<02:04,  5.18s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9365, 'compress@10': 0.0559, 'time@10': 6.2675}:  20%|██        | 6/30 [00:30<02:04,  5.18s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9365, 'compress@10': 0.0559, 'time@10': 6.2675}:  23%|██▎       | 7/30 [00:30<01:50,  4.81s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9436, 'compress@10': 0.0534, 'time@10': 6.1864}:  23%|██▎       | 7/30 [00:36<01:50,  4.81s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9436, 'compress@10': 0.0534, 'time@10': 6.1864}:  27%|██▋       | 8/30 [00:36<01:51,  5.08s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9466, 'compress@10': 0.0513, 'time@10': 6.361}:  27%|██▋       | 8/30 [00:40<01:51,  5.08s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9466, 'compress@10': 0.0513, 'time@10': 6.361}:  30%|███       | 9/30 [00:40<01:39,  4.72s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9552, 'compress@10': 0.0488, 'time@10': 6.4362}:  30%|███       | 9/30 [00:47<01:39,  4.72s/it]  {'epoch': 49, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9552, 'compress@10': 0.0488, 'time@10': 6.4362}:  33%|███▎      | 10/30 [00:47<01:49,  5.47s/it]{'epoch': 49, 'num_users': 6.6364, 'loss': 0.018, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9522, 'compress@10': 0.0483, 'time@10': 6.5322}:  33%|███▎      | 10/30 [00:51<01:49,  5.47s/it]{'epoch': 49, 'num_users': 6.6364, 'loss': 0.018, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9522, 'compress@10': 0.0483, 'time@10': 6.5322}:  37%|███▋      | 11/30 [00:51<01:34,  4.95s/it]{'epoch': 49, 'num_users': 6.4167, 'loss': 0.0166, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9492, 'compress@10': 0.0516, 'time@10': 6.2517}:  37%|███▋      | 11/30 [00:54<01:34,  4.95s/it]{'epoch': 49, 'num_users': 6.4167, 'loss': 0.0166, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9492, 'compress@10': 0.0516, 'time@10': 6.2517}:  40%|████      | 12/30 [00:54<01:19,  4.42s/it]{'epoch': 49, 'num_users': 6.6154, 'loss': 0.0166, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9472, 'compress@10': 0.0515, 'time@10': 6.2633}:  40%|████      | 12/30 [00:57<01:19,  4.42s/it]{'epoch': 49, 'num_users': 6.6154, 'loss': 0.0166, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9472, 'compress@10': 0.0515, 'time@10': 6.2633}:  43%|████▎     | 13/30 [00:57<01:09,  4.06s/it]{'epoch': 49, 'num_users': 6.3571, 'loss': 0.0155, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9391, 'compress@10': 0.0602, 'time@10': 6.0596}:  43%|████▎     | 13/30 [01:01<01:09,  4.06s/it]{'epoch': 49, 'num_users': 6.3571, 'loss': 0.0155, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9391, 'compress@10': 0.0602, 'time@10': 6.0596}:  47%|████▋     | 14/30 [01:01<01:02,  3.88s/it]{'epoch': 49, 'num_users': 6.2667, 'loss': 0.0148, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.9398, 'compress@10': 0.0587, 'time@10': 6.1439}:  47%|████▋     | 14/30 [01:05<01:02,  3.88s/it]{'epoch': 49, 'num_users': 6.2667, 'loss': 0.0148, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.9398, 'compress@10': 0.0587, 'time@10': 6.1439}:  50%|█████     | 15/30 [01:05<00:57,  3.83s/it]{'epoch': 49, 'num_users': 6.0625, 'loss': 0.014, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.9384, 'compress@10': 0.0607, 'time@10': 5.9702}:  50%|█████     | 15/30 [01:08<00:57,  3.83s/it] {'epoch': 49, 'num_users': 6.0625, 'loss': 0.014, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.9384, 'compress@10': 0.0607, 'time@10': 5.9702}:  53%|█████▎    | 16/30 [01:08<00:51,  3.70s/it]{'epoch': 49, 'num_users': 5.8235, 'loss': 0.0132, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.9302, 'compress@10': 0.0693, 'time@10': 5.8201}:  53%|█████▎    | 16/30 [01:10<00:51,  3.70s/it]{'epoch': 49, 'num_users': 5.8235, 'loss': 0.0132, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.9302, 'compress@10': 0.0693, 'time@10': 5.8201}:  57%|█████▋    | 17/30 [01:10<00:40,  3.11s/it]{'epoch': 49, 'num_users': 6.0556, 'loss': 0.0131, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.931, 'compress@10': 0.0676, 'time@10': 5.7127}:  57%|█████▋    | 17/30 [01:14<00:40,  3.11s/it] {'epoch': 49, 'num_users': 6.0556, 'loss': 0.0131, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.931, 'compress@10': 0.0676, 'time@10': 5.7127}:  60%|██████    | 18/30 [01:14<00:40,  3.36s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 0.0127, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.9306, 'compress@10': 0.0681, 'time@10': 5.6007}:  60%|██████    | 18/30 [01:15<00:40,  3.36s/it]  {'epoch': 49, 'num_users': 6.0, 'loss': 0.0127, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.9306, 'compress@10': 0.0681, 'time@10': 5.6007}:  63%|██████▎   | 19/30 [01:15<00:31,  2.90s/it]{'epoch': 49, 'num_users': 6.15, 'loss': 0.0131, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.9332, 'compress@10': 0.0661, 'time@10': 5.6793}:  63%|██████▎   | 19/30 [01:23<00:31,  2.90s/it]{'epoch': 49, 'num_users': 6.15, 'loss': 0.0131, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.9332, 'compress@10': 0.0661, 'time@10': 5.6793}:  67%|██████▋   | 20/30 [01:23<00:41,  4.19s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9317, 'compress@10': 0.065, 'time@10': 5.7247}:  67%|██████▋   | 20/30 [01:26<00:41,  4.19s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9317, 'compress@10': 0.065, 'time@10': 5.7247}:  70%|███████   | 21/30 [01:26<00:35,  3.94s/it]{'epoch': 49, 'num_users': 6.1818, 'loss': 0.0144, 'hit_ratio@10': 0.851, 'ndcg@10': 0.9306, 'compress@10': 0.0644, 'time@10': 5.6034}:  70%|███████   | 21/30 [01:29<00:35,  3.94s/it]{'epoch': 49, 'num_users': 6.1818, 'loss': 0.0144, 'hit_ratio@10': 0.851, 'ndcg@10': 0.9306, 'compress@10': 0.0644, 'time@10': 5.6034}:  73%|███████▎  | 22/30 [01:29<00:29,  3.69s/it]{'epoch': 49, 'num_users': 6.1304, 'loss': 0.0141, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.931, 'compress@10': 0.0642, 'time@10': 5.5803}:  73%|███████▎  | 22/30 [01:32<00:29,  3.69s/it]{'epoch': 49, 'num_users': 6.1304, 'loss': 0.0141, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.931, 'compress@10': 0.0642, 'time@10': 5.5803}:  77%|███████▋  | 23/30 [01:32<00:23,  3.35s/it]{'epoch': 49, 'num_users': 5.9583, 'loss': 0.0136, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9256, 'compress@10': 0.0702, 'time@10': 5.452}:  77%|███████▋  | 23/30 [01:34<00:23,  3.35s/it] {'epoch': 49, 'num_users': 5.9583, 'loss': 0.0136, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9256, 'compress@10': 0.0702, 'time@10': 5.452}:  80%|████████  | 24/30 [01:34<00:18,  3.11s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.9152, 'compress@10': 0.0808, 'time@10': 5.3261}:  80%|████████  | 24/30 [01:35<00:18,  3.11s/it]  {'epoch': 49, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.9152, 'compress@10': 0.0808, 'time@10': 5.3261}:  83%|████████▎ | 25/30 [01:35<00:12,  2.53s/it]{'epoch': 49, 'num_users': 5.8077, 'loss': 0.0128, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9176, 'compress@10': 0.0785, 'time@10': 5.3244}:  83%|████████▎ | 25/30 [01:41<00:12,  2.53s/it]{'epoch': 49, 'num_users': 5.8077, 'loss': 0.0128, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9176, 'compress@10': 0.0785, 'time@10': 5.3244}:  87%|████████▋ | 26/30 [01:41<00:13,  3.37s/it]{'epoch': 49, 'num_users': 5.8889, 'loss': 0.013, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.9187, 'compress@10': 0.0771, 'time@10': 5.324}:  87%|████████▋ | 26/30 [01:43<00:13,  3.37s/it]  {'epoch': 49, 'num_users': 5.8889, 'loss': 0.013, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.9187, 'compress@10': 0.0771, 'time@10': 5.324}:  90%|█████████ | 27/30 [01:43<00:09,  3.17s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 0.0139, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9204, 'compress@10': 0.0752, 'time@10': 5.3244}:  90%|█████████ | 27/30 [01:49<00:09,  3.17s/it] {'epoch': 49, 'num_users': 6.0, 'loss': 0.0139, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9204, 'compress@10': 0.0752, 'time@10': 5.3244}:  93%|█████████▎| 28/30 [01:49<00:07,  3.83s/it]{'epoch': 49, 'num_users': 5.8621, 'loss': 0.0137, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.9214, 'compress@10': 0.0743, 'time@10': 5.2808}:  93%|█████████▎| 28/30 [01:51<00:07,  3.83s/it]{'epoch': 49, 'num_users': 5.8621, 'loss': 0.0137, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.9214, 'compress@10': 0.0743, 'time@10': 5.2808}:  97%|█████████▋| 29/30 [01:51<00:03,  3.30s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0138, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9223, 'compress@10': 0.0731, 'time@10': 5.2232}:  97%|█████████▋| 29/30 [01:54<00:03,  3.30s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0138, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9223, 'compress@10': 0.0731, 'time@10': 5.2232}: 100%|██████████| 30/30 [01:54<00:00,  3.39s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0138, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9223, 'compress@10': 0.0731, 'time@10': 5.2232}: 100%|██████████| 30/30 [01:54<00:00,  3.83s/it]
Epoch: 49
Avg # of users: 5.866666666666666
Avg Loss: 0.013759647444447855
Avg hit ratio: 0.8635451857114841
Avg ndcg: 0.9222560056447865
Avg compression ratio: 0.07313097754290333
Avg train time: 5.223192962010701
Std train time: 1.7609739302715197
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 9, 20, 10, 44, 8, 20, 28, 10, 10, 9, 6, 12, 10, 52, 53, 6, 9, 10, 10, 10]
