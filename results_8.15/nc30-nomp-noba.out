  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 2.2871, 'hit_ratio@10': 0.2632, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 4.18}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 2.2871, 'hit_ratio@10': 0.2632, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 4.18}:   3%|▎         | 1/30 [00:02<01:01,  2.13s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 1.2133, 'hit_ratio@10': 0.4058, 'ndcg@10': 0.2881, 'compress@10': 1.0, 'time@10': 3.3469}:   3%|▎         | 1/30 [00:04<01:01,  2.13s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 1.2133, 'hit_ratio@10': 0.4058, 'ndcg@10': 0.2881, 'compress@10': 1.0, 'time@10': 3.3469}:   7%|▋         | 2/30 [00:04<01:06,  2.38s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 1.605, 'hit_ratio@10': 0.3658, 'ndcg@10': 0.1921, 'compress@10': 1.0, 'time@10': 2.5589}:   7%|▋         | 2/30 [00:05<01:06,  2.38s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 1.605, 'hit_ratio@10': 0.3658, 'ndcg@10': 0.1921, 'compress@10': 1.0, 'time@10': 2.5589}:  10%|█         | 3/30 [00:05<00:41,  1.54s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 1.2532, 'hit_ratio@10': 0.4082, 'ndcg@10': 0.2682, 'compress@10': 1.0, 'time@10': 2.4864}:  10%|█         | 3/30 [00:07<00:41,  1.54s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 1.2532, 'hit_ratio@10': 0.4082, 'ndcg@10': 0.2682, 'compress@10': 1.0, 'time@10': 2.4864}:  13%|█▎        | 4/30 [00:07<00:47,  1.84s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 1.0234, 'hit_ratio@10': 0.4986, 'ndcg@10': 0.3557, 'compress@10': 1.0, 'time@10': 3.6845}:  13%|█▎        | 4/30 [00:11<00:47,  1.84s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 1.0234, 'hit_ratio@10': 0.4986, 'ndcg@10': 0.3557, 'compress@10': 1.0, 'time@10': 3.6845}:  17%|█▋        | 5/30 [00:11<01:08,  2.72s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.8708, 'hit_ratio@10': 0.5303, 'ndcg@10': 0.4108, 'compress@10': 1.0, 'time@10': 3.6884}:  17%|█▋        | 5/30 [00:15<01:08,  2.72s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.8708, 'hit_ratio@10': 0.5303, 'ndcg@10': 0.4108, 'compress@10': 1.0, 'time@10': 3.6884}:  20%|██        | 6/30 [00:15<01:13,  3.07s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.7787, 'hit_ratio@10': 0.5174, 'ndcg@10': 0.4231, 'compress@10': 1.0, 'time@10': 3.7534}:  20%|██        | 6/30 [00:17<01:13,  3.07s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.7787, 'hit_ratio@10': 0.5174, 'ndcg@10': 0.4231, 'compress@10': 1.0, 'time@10': 3.7534}:  23%|██▎       | 7/30 [00:17<01:03,  2.76s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.6975, 'hit_ratio@10': 0.5599, 'ndcg@10': 0.4309, 'compress@10': 1.0, 'time@10': 3.657}:  23%|██▎       | 7/30 [00:20<01:03,  2.76s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 0.6975, 'hit_ratio@10': 0.5599, 'ndcg@10': 0.4309, 'compress@10': 1.0, 'time@10': 3.657}:  27%|██▋       | 8/30 [00:20<01:02,  2.84s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.6341, 'hit_ratio@10': 0.5866, 'ndcg@10': 0.4561, 'compress@10': 1.0, 'time@10': 3.8987}:  27%|██▋       | 8/30 [00:23<01:02,  2.84s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.6341, 'hit_ratio@10': 0.5866, 'ndcg@10': 0.4561, 'compress@10': 1.0, 'time@10': 3.8987}:  30%|███       | 9/30 [00:23<01:00,  2.88s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.5787, 'hit_ratio@10': 0.612, 'ndcg@10': 0.479, 'compress@10': 1.0, 'time@10': 3.8709}:  30%|███       | 9/30 [00:27<01:00,  2.88s/it]     {'epoch': 0, 'num_users': 6.3, 'loss': 0.5787, 'hit_ratio@10': 0.612, 'ndcg@10': 0.479, 'compress@10': 1.0, 'time@10': 3.8709}:  33%|███▎      | 10/30 [00:27<01:02,  3.12s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.5495, 'hit_ratio@10': 0.5913, 'ndcg@10': 0.4835, 'compress@10': 1.0, 'time@10': 3.9179}:  33%|███▎      | 10/30 [00:29<01:02,  3.12s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.5495, 'hit_ratio@10': 0.5913, 'ndcg@10': 0.4835, 'compress@10': 1.0, 'time@10': 3.9179}:  37%|███▋      | 11/30 [00:29<00:54,  2.85s/it]{'epoch': 0, 'num_users': 6.4167, 'loss': 0.793, 'hit_ratio@10': 0.5629, 'ndcg@10': 0.4432, 'compress@10': 1.0, 'time@10': 3.6692}:  37%|███▋      | 11/30 [00:30<00:54,  2.85s/it] {'epoch': 0, 'num_users': 6.4167, 'loss': 0.793, 'hit_ratio@10': 0.5629, 'ndcg@10': 0.4432, 'compress@10': 1.0, 'time@10': 3.6692}:  40%|████      | 12/30 [00:30<00:40,  2.28s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.7562, 'hit_ratio@10': 0.551, 'ndcg@10': 0.4362, 'compress@10': 1.0, 'time@10': 3.6713}:  40%|████      | 12/30 [00:32<00:40,  2.28s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.7562, 'hit_ratio@10': 0.551, 'ndcg@10': 0.4362, 'compress@10': 1.0, 'time@10': 3.6713}:  43%|████▎     | 13/30 [00:32<00:36,  2.16s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.9078, 'hit_ratio@10': 0.5355, 'ndcg@10': 0.405, 'compress@10': 1.0, 'time@10': 3.4396}:  43%|████▎     | 13/30 [00:32<00:36,  2.16s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.9078, 'hit_ratio@10': 0.5355, 'ndcg@10': 0.405, 'compress@10': 1.0, 'time@10': 3.4396}:  47%|████▋     | 14/30 [00:32<00:26,  1.65s/it]{'epoch': 0, 'num_users': 6.2667, 'loss': 0.8632, 'hit_ratio@10': 0.545, 'ndcg@10': 0.4054, 'compress@10': 1.0, 'time@10': 3.5397}:  47%|████▋     | 14/30 [00:35<00:26,  1.65s/it]{'epoch': 0, 'num_users': 6.2667, 'loss': 0.8632, 'hit_ratio@10': 0.545, 'ndcg@10': 0.4054, 'compress@10': 1.0, 'time@10': 3.5397}:  50%|█████     | 15/30 [00:35<00:28,  1.91s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 1.0259, 'hit_ratio@10': 0.5317, 'ndcg@10': 0.38, 'compress@10': 1.0, 'time@10': 3.3757}:  50%|█████     | 15/30 [00:36<00:28,  1.91s/it] {'epoch': 0, 'num_users': 6.0625, 'loss': 1.0259, 'hit_ratio@10': 0.5317, 'ndcg@10': 0.38, 'compress@10': 1.0, 'time@10': 3.3757}:  53%|█████▎    | 16/30 [00:36<00:22,  1.62s/it]{'epoch': 0, 'num_users': 5.8235, 'loss': 1.1085, 'hit_ratio@10': 0.5122, 'ndcg@10': 0.3577, 'compress@10': 1.0, 'time@10': 3.2161}:  53%|█████▎    | 16/30 [00:36<00:22,  1.62s/it]{'epoch': 0, 'num_users': 5.8235, 'loss': 1.1085, 'hit_ratio@10': 0.5122, 'ndcg@10': 0.3577, 'compress@10': 1.0, 'time@10': 3.2161}:  57%|█████▋    | 17/30 [00:36<00:16,  1.25s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 1.056, 'hit_ratio@10': 0.5234, 'ndcg@10': 0.3692, 'compress@10': 1.0, 'time@10': 3.1685}:  57%|█████▋    | 17/30 [00:39<00:16,  1.25s/it] {'epoch': 0, 'num_users': 6.0556, 'loss': 1.056, 'hit_ratio@10': 0.5234, 'ndcg@10': 0.3692, 'compress@10': 1.0, 'time@10': 3.1685}:  60%|██████    | 18/30 [00:39<00:19,  1.59s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 1.1538, 'hit_ratio@10': 0.5185, 'ndcg@10': 0.3498, 'compress@10': 1.0, 'time@10': 3.1158}:  60%|██████    | 18/30 [00:40<00:19,  1.59s/it]  {'epoch': 0, 'num_users': 6.0, 'loss': 1.1538, 'hit_ratio@10': 0.5185, 'ndcg@10': 0.3498, 'compress@10': 1.0, 'time@10': 3.1158}:  63%|██████▎   | 19/30 [00:40<00:15,  1.45s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 1.0999, 'hit_ratio@10': 0.5346, 'ndcg@10': 0.3698, 'compress@10': 1.0, 'time@10': 3.1988}:  63%|██████▎   | 19/30 [00:45<00:15,  1.45s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 1.0999, 'hit_ratio@10': 0.5346, 'ndcg@10': 0.3698, 'compress@10': 1.0, 'time@10': 3.1988}:  67%|██████▋   | 20/30 [00:45<00:24,  2.46s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 1.0531, 'hit_ratio@10': 0.5425, 'ndcg@10': 0.384, 'compress@10': 1.0, 'time@10': 3.3659}:  67%|██████▋   | 20/30 [00:48<00:24,  2.46s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 1.0531, 'hit_ratio@10': 0.5425, 'ndcg@10': 0.384, 'compress@10': 1.0, 'time@10': 3.3659}:  70%|███████   | 21/30 [00:48<00:24,  2.74s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 1.0371, 'hit_ratio@10': 0.5406, 'ndcg@10': 0.3725, 'compress@10': 1.0, 'time@10': 3.2897}:  70%|███████   | 21/30 [00:50<00:24,  2.74s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 1.0371, 'hit_ratio@10': 0.5406, 'ndcg@10': 0.3725, 'compress@10': 1.0, 'time@10': 3.2897}:  73%|███████▎  | 22/30 [00:50<00:19,  2.44s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 1.0656, 'hit_ratio@10': 0.5345, 'ndcg@10': 0.3587, 'compress@10': 1.0, 'time@10': 3.2845}:  73%|███████▎  | 22/30 [00:51<00:19,  2.44s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 1.0656, 'hit_ratio@10': 0.5345, 'ndcg@10': 0.3587, 'compress@10': 1.0, 'time@10': 3.2845}:  77%|███████▋  | 23/30 [00:51<00:15,  2.19s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 1.1281, 'hit_ratio@10': 0.5122, 'ndcg@10': 0.3437, 'compress@10': 1.0, 'time@10': 3.1612}:  77%|███████▋  | 23/30 [00:52<00:15,  2.19s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 1.1281, 'hit_ratio@10': 0.5122, 'ndcg@10': 0.3437, 'compress@10': 1.0, 'time@10': 3.1612}:  80%|████████  | 24/30 [00:52<00:09,  1.64s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 1.1674, 'hit_ratio@10': 0.4917, 'ndcg@10': 0.33, 'compress@10': 1.0, 'time@10': 3.0491}:  80%|████████  | 24/30 [00:52<00:09,  1.64s/it]     {'epoch': 0, 'num_users': 5.8, 'loss': 1.1674, 'hit_ratio@10': 0.4917, 'ndcg@10': 0.33, 'compress@10': 1.0, 'time@10': 3.0491}:  83%|████████▎ | 25/30 [00:52<00:06,  1.21s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 1.1261, 'hit_ratio@10': 0.5047, 'ndcg@10': 0.3468, 'compress@10': 1.0, 'time@10': 3.1946}:  83%|████████▎ | 25/30 [00:59<00:06,  1.21s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 1.1261, 'hit_ratio@10': 0.5047, 'ndcg@10': 0.3468, 'compress@10': 1.0, 'time@10': 3.1946}:  87%|████████▋ | 26/30 [00:59<00:11,  2.91s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 1.0902, 'hit_ratio@10': 0.5058, 'ndcg@10': 0.3527, 'compress@10': 1.0, 'time@10': 3.2577}:  87%|████████▋ | 26/30 [01:01<00:11,  2.91s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 1.0902, 'hit_ratio@10': 0.5058, 'ndcg@10': 0.3527, 'compress@10': 1.0, 'time@10': 3.2577}:  90%|█████████ | 27/30 [01:01<00:08,  2.79s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 1.0537, 'hit_ratio@10': 0.5172, 'ndcg@10': 0.3709, 'compress@10': 1.0, 'time@10': 3.2962}:  90%|█████████ | 27/30 [01:06<00:08,  2.79s/it]   {'epoch': 0, 'num_users': 6.0, 'loss': 1.0537, 'hit_ratio@10': 0.5172, 'ndcg@10': 0.3709, 'compress@10': 1.0, 'time@10': 3.2962}:  93%|█████████▎| 28/30 [01:06<00:06,  3.26s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 1.0565, 'hit_ratio@10': 0.5119, 'ndcg@10': 0.361, 'compress@10': 1.0, 'time@10': 3.2978}:  93%|█████████▎| 28/30 [01:07<00:06,  3.26s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 1.0565, 'hit_ratio@10': 0.5119, 'ndcg@10': 0.361, 'compress@10': 1.0, 'time@10': 3.2978}:  97%|█████████▋| 29/30 [01:07<00:02,  2.80s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 1.0256, 'hit_ratio@10': 0.5219, 'ndcg@10': 0.3664, 'compress@10': 1.0, 'time@10': 3.2882}:  97%|█████████▋| 29/30 [01:10<00:02,  2.80s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 1.0256, 'hit_ratio@10': 0.5219, 'ndcg@10': 0.3664, 'compress@10': 1.0, 'time@10': 3.2882}: 100%|██████████| 30/30 [01:10<00:00,  2.87s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 1.0256, 'hit_ratio@10': 0.5219, 'ndcg@10': 0.3664, 'compress@10': 1.0, 'time@10': 3.2882}: 100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch: 0
Avg # of users: 5.866666666666666
Avg Loss: 1.0256068371759925
Avg hit ratio: 0.5218542761905416
Avg ndcg: 0.36639071139440116
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2882203181584675
Std train time: 2.0403760551523624
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0618, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.7819, 'compress@10': 1.0, 'time@10': 2.9224}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0618, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.7819, 'compress@10': 1.0, 'time@10': 2.9224}:   3%|▎         | 1/30 [00:01<00:43,  1.50s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0595, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8155, 'compress@10': 1.0, 'time@10': 2.7178}:   3%|▎         | 1/30 [00:04<00:43,  1.50s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0595, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8155, 'compress@10': 1.0, 'time@10': 2.7178}:   7%|▋         | 2/30 [00:04<00:59,  2.12s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0801, 'hit_ratio@10': 0.6942, 'ndcg@10': 0.6845, 'compress@10': 1.0, 'time@10': 2.151}:   7%|▋         | 2/30 [00:04<00:59,  2.12s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.0801, 'hit_ratio@10': 0.6942, 'ndcg@10': 0.6845, 'compress@10': 1.0, 'time@10': 2.151}:  10%|█         | 3/30 [00:04<00:37,  1.40s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0739, 'hit_ratio@10': 0.7438, 'ndcg@10': 0.728, 'compress@10': 1.0, 'time@10': 2.1779}:  10%|█         | 3/30 [00:06<00:37,  1.40s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0739, 'hit_ratio@10': 0.7438, 'ndcg@10': 0.728, 'compress@10': 1.0, 'time@10': 2.1779}:  13%|█▎        | 4/30 [00:06<00:45,  1.76s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0767, 'hit_ratio@10': 0.7591, 'ndcg@10': 0.7382, 'compress@10': 1.0, 'time@10': 3.4617}:  13%|█▎        | 4/30 [00:11<00:45,  1.76s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0767, 'hit_ratio@10': 0.7591, 'ndcg@10': 0.7382, 'compress@10': 1.0, 'time@10': 3.4617}:  17%|█▋        | 5/30 [00:11<01:07,  2.69s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0774, 'hit_ratio@10': 0.7474, 'ndcg@10': 0.7503, 'compress@10': 1.0, 'time@10': 3.5124}:  17%|█▋        | 5/30 [00:15<01:07,  2.69s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0774, 'hit_ratio@10': 0.7474, 'ndcg@10': 0.7503, 'compress@10': 1.0, 'time@10': 3.5124}:  20%|██        | 6/30 [00:15<01:13,  3.07s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0737, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.7623, 'compress@10': 1.0, 'time@10': 3.5966}:  20%|██        | 6/30 [00:17<01:13,  3.07s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0737, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.7623, 'compress@10': 1.0, 'time@10': 3.5966}:  23%|██▎       | 7/30 [00:17<01:03,  2.75s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0694, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.7749, 'compress@10': 1.0, 'time@10': 3.4992}:  23%|██▎       | 7/30 [00:19<01:03,  2.75s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0694, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.7749, 'compress@10': 1.0, 'time@10': 3.4992}:  27%|██▋       | 8/30 [00:19<01:01,  2.78s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0658, 'hit_ratio@10': 0.789, 'ndcg@10': 0.7906, 'compress@10': 1.0, 'time@10': 3.7575}:  27%|██▋       | 8/30 [00:22<01:01,  2.78s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0658, 'hit_ratio@10': 0.789, 'ndcg@10': 0.7906, 'compress@10': 1.0, 'time@10': 3.7575}:  30%|███       | 9/30 [00:22<00:59,  2.83s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0642, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.7962, 'compress@10': 1.0, 'time@10': 3.7369}:  30%|███       | 9/30 [00:26<00:59,  2.83s/it]  {'epoch': 1, 'num_users': 6.3, 'loss': 0.0642, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.7962, 'compress@10': 1.0, 'time@10': 3.7369}:  33%|███▎      | 10/30 [00:26<01:01,  3.07s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.0656, 'hit_ratio@10': 0.8002, 'ndcg@10': 0.7968, 'compress@10': 1.0, 'time@10': 3.7537}:  33%|███▎      | 10/30 [00:28<01:01,  3.07s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.0656, 'hit_ratio@10': 0.8002, 'ndcg@10': 0.7968, 'compress@10': 1.0, 'time@10': 3.7537}:  37%|███▋      | 11/30 [00:28<00:52,  2.74s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.0662, 'hit_ratio@10': 0.7891, 'ndcg@10': 0.7805, 'compress@10': 1.0, 'time@10': 3.5328}:  37%|███▋      | 11/30 [00:29<00:52,  2.74s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.0662, 'hit_ratio@10': 0.7891, 'ndcg@10': 0.7805, 'compress@10': 1.0, 'time@10': 3.5328}:  40%|████      | 12/30 [00:29<00:40,  2.25s/it]{'epoch': 1, 'num_users': 6.6154, 'loss': 0.0665, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.7829, 'compress@10': 1.0, 'time@10': 3.512}:  40%|████      | 12/30 [00:31<00:40,  2.25s/it] {'epoch': 1, 'num_users': 6.6154, 'loss': 0.0665, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.7829, 'compress@10': 1.0, 'time@10': 3.512}:  43%|████▎     | 13/30 [00:31<00:35,  2.08s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.12, 'hit_ratio@10': 0.7738, 'ndcg@10': 0.7346, 'compress@10': 1.0, 'time@10': 3.2894}:  43%|████▎     | 13/30 [00:31<00:35,  2.08s/it] {'epoch': 1, 'num_users': 6.3571, 'loss': 0.12, 'hit_ratio@10': 0.7738, 'ndcg@10': 0.7346, 'compress@10': 1.0, 'time@10': 3.2894}:  47%|████▋     | 14/30 [00:31<00:25,  1.58s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.1159, 'hit_ratio@10': 0.7845, 'ndcg@10': 0.7442, 'compress@10': 1.0, 'time@10': 3.4023}:  47%|████▋     | 14/30 [00:34<00:25,  1.58s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.1159, 'hit_ratio@10': 0.7845, 'ndcg@10': 0.7442, 'compress@10': 1.0, 'time@10': 3.4023}:  50%|█████     | 15/30 [00:34<00:28,  1.87s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.112, 'hit_ratio@10': 0.772, 'ndcg@10': 0.744, 'compress@10': 1.0, 'time@10': 3.2465}:  50%|█████     | 15/30 [00:35<00:28,  1.87s/it]   {'epoch': 1, 'num_users': 6.0625, 'loss': 0.112, 'hit_ratio@10': 0.772, 'ndcg@10': 0.744, 'compress@10': 1.0, 'time@10': 3.2465}:  53%|█████▎    | 16/30 [00:35<00:22,  1.59s/it]{'epoch': 1, 'num_users': 5.8235, 'loss': 0.1588, 'hit_ratio@10': 0.7383, 'ndcg@10': 0.7051, 'compress@10': 1.0, 'time@10': 3.0947}:  53%|█████▎    | 16/30 [00:35<00:22,  1.59s/it]{'epoch': 1, 'num_users': 5.8235, 'loss': 0.1588, 'hit_ratio@10': 0.7383, 'ndcg@10': 0.7051, 'compress@10': 1.0, 'time@10': 3.0947}:  57%|█████▋    | 17/30 [00:35<00:15,  1.22s/it]{'epoch': 1, 'num_users': 6.0556, 'loss': 0.154, 'hit_ratio@10': 0.739, 'ndcg@10': 0.7116, 'compress@10': 1.0, 'time@10': 3.0555}:  57%|█████▋    | 17/30 [00:38<00:15,  1.22s/it]  {'epoch': 1, 'num_users': 6.0556, 'loss': 0.154, 'hit_ratio@10': 0.739, 'ndcg@10': 0.7116, 'compress@10': 1.0, 'time@10': 3.0555}:  60%|██████    | 18/30 [00:38<00:19,  1.59s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.1485, 'hit_ratio@10': 0.749, 'ndcg@10': 0.7116, 'compress@10': 1.0, 'time@10': 3.0088}:  60%|██████    | 18/30 [00:39<00:19,  1.59s/it]  {'epoch': 1, 'num_users': 6.0, 'loss': 0.1485, 'hit_ratio@10': 0.749, 'ndcg@10': 0.7116, 'compress@10': 1.0, 'time@10': 3.0088}:  63%|██████▎   | 19/30 [00:39<00:15,  1.45s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.1444, 'hit_ratio@10': 0.7554, 'ndcg@10': 0.7163, 'compress@10': 1.0, 'time@10': 3.0998}:  63%|██████▎   | 19/30 [00:44<00:15,  1.45s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.1444, 'hit_ratio@10': 0.7554, 'ndcg@10': 0.7163, 'compress@10': 1.0, 'time@10': 3.0998}:  67%|██████▋   | 20/30 [00:44<00:24,  2.47s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.1412, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.7212, 'compress@10': 1.0, 'time@10': 3.2935}:  67%|██████▋   | 20/30 [00:47<00:24,  2.47s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.1412, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.7212, 'compress@10': 1.0, 'time@10': 3.2935}:  70%|███████   | 21/30 [00:47<00:25,  2.82s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.137, 'hit_ratio@10': 0.7644, 'ndcg@10': 0.7284, 'compress@10': 1.0, 'time@10': 3.2215}:  70%|███████   | 21/30 [00:49<00:25,  2.82s/it] {'epoch': 1, 'num_users': 6.1818, 'loss': 0.137, 'hit_ratio@10': 0.7644, 'ndcg@10': 0.7284, 'compress@10': 1.0, 'time@10': 3.2215}:  73%|███████▎  | 22/30 [00:49<00:19,  2.50s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.1326, 'hit_ratio@10': 0.7681, 'ndcg@10': 0.7338, 'compress@10': 1.0, 'time@10': 3.2207}:  73%|███████▎  | 22/30 [00:51<00:19,  2.50s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.1326, 'hit_ratio@10': 0.7681, 'ndcg@10': 0.7338, 'compress@10': 1.0, 'time@10': 3.2207}:  77%|███████▋  | 23/30 [00:51<00:15,  2.24s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.1673, 'hit_ratio@10': 0.7444, 'ndcg@10': 0.7068, 'compress@10': 1.0, 'time@10': 3.0999}:  77%|███████▋  | 23/30 [00:51<00:15,  2.24s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.1673, 'hit_ratio@10': 0.7444, 'ndcg@10': 0.7068, 'compress@10': 1.0, 'time@10': 3.0999}:  80%|████████  | 24/30 [00:51<00:10,  1.68s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.2159, 'hit_ratio@10': 0.728, 'ndcg@10': 0.6794, 'compress@10': 1.0, 'time@10': 2.9896}:  80%|████████  | 24/30 [00:51<00:10,  1.68s/it]    {'epoch': 1, 'num_users': 5.8, 'loss': 0.2159, 'hit_ratio@10': 0.728, 'ndcg@10': 0.6794, 'compress@10': 1.0, 'time@10': 2.9896}:  83%|████████▎ | 25/30 [00:51<00:06,  1.24s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.2109, 'hit_ratio@10': 0.7324, 'ndcg@10': 0.6828, 'compress@10': 1.0, 'time@10': 3.1354}:  83%|████████▎ | 25/30 [00:58<00:06,  1.24s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.2109, 'hit_ratio@10': 0.7324, 'ndcg@10': 0.6828, 'compress@10': 1.0, 'time@10': 3.1354}:  87%|████████▋ | 26/30 [00:58<00:11,  2.92s/it]{'epoch': 1, 'num_users': 5.8889, 'loss': 0.2045, 'hit_ratio@10': 0.7396, 'ndcg@10': 0.69, 'compress@10': 1.0, 'time@10': 3.1825}:  87%|████████▋ | 26/30 [01:00<00:11,  2.92s/it]  {'epoch': 1, 'num_users': 5.8889, 'loss': 0.2045, 'hit_ratio@10': 0.7396, 'ndcg@10': 0.69, 'compress@10': 1.0, 'time@10': 3.1825}:  90%|█████████ | 27/30 [01:00<00:08,  2.71s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.1992, 'hit_ratio@10': 0.7433, 'ndcg@10': 0.6966, 'compress@10': 1.0, 'time@10': 3.2218}:  90%|█████████ | 27/30 [01:05<00:08,  2.71s/it] {'epoch': 1, 'num_users': 6.0, 'loss': 0.1992, 'hit_ratio@10': 0.7433, 'ndcg@10': 0.6966, 'compress@10': 1.0, 'time@10': 3.2218}:  93%|█████████▎| 28/30 [01:05<00:06,  3.20s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.1931, 'hit_ratio@10': 0.749, 'ndcg@10': 0.7033, 'compress@10': 1.0, 'time@10': 3.2302}:  93%|█████████▎| 28/30 [01:06<00:06,  3.20s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.1931, 'hit_ratio@10': 0.749, 'ndcg@10': 0.7033, 'compress@10': 1.0, 'time@10': 3.2302}:  97%|█████████▋| 29/30 [01:06<00:02,  2.77s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.188, 'hit_ratio@10': 0.7493, 'ndcg@10': 0.7099, 'compress@10': 1.0, 'time@10': 3.2239}:  97%|█████████▋| 29/30 [01:09<00:02,  2.77s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.188, 'hit_ratio@10': 0.7493, 'ndcg@10': 0.7099, 'compress@10': 1.0, 'time@10': 3.2239}: 100%|██████████| 30/30 [01:09<00:00,  2.86s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.188, 'hit_ratio@10': 0.7493, 'ndcg@10': 0.7099, 'compress@10': 1.0, 'time@10': 3.2239}: 100%|██████████| 30/30 [01:09<00:00,  2.33s/it]
Epoch: 1
Avg # of users: 5.866666666666666
Avg Loss: 0.1880152064875357
Avg hit ratio: 0.749291023900926
Avg ndcg: 0.7098732014848446
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2238909880320232
Std train time: 2.045878899591764
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 3.0722}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 3.0722}:   3%|▎         | 1/30 [00:01<00:45,  1.57s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0512, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8525, 'compress@10': 1.0, 'time@10': 2.8489}:   3%|▎         | 1/30 [00:04<00:45,  1.57s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0512, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8525, 'compress@10': 1.0, 'time@10': 2.8489}:   7%|▋         | 2/30 [00:04<01:01,  2.21s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0392, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8384, 'compress@10': 1.0, 'time@10': 2.2249}:   7%|▋         | 2/30 [00:04<01:01,  2.21s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0392, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8384, 'compress@10': 1.0, 'time@10': 2.2249}:  10%|█         | 3/30 [00:04<00:38,  1.44s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0418, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8395, 'compress@10': 1.0, 'time@10': 2.2343}:  10%|█         | 3/30 [00:07<00:38,  1.44s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0418, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8395, 'compress@10': 1.0, 'time@10': 2.2343}:  13%|█▎        | 4/30 [00:07<00:46,  1.78s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0504, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8289, 'compress@10': 1.0, 'time@10': 3.5032}:  13%|█▎        | 4/30 [00:11<00:46,  1.78s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0504, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8289, 'compress@10': 1.0, 'time@10': 3.5032}:  17%|█▋        | 5/30 [00:11<01:07,  2.70s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0549, 'hit_ratio@10': 0.7911, 'ndcg@10': 0.8265, 'compress@10': 1.0, 'time@10': 3.554}:  17%|█▋        | 5/30 [00:15<01:07,  2.70s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0549, 'hit_ratio@10': 0.7911, 'ndcg@10': 0.8265, 'compress@10': 1.0, 'time@10': 3.554}:  20%|██        | 6/30 [00:15<01:14,  3.09s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0531, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8315, 'compress@10': 1.0, 'time@10': 3.6262}:  20%|██        | 6/30 [00:17<01:14,  3.09s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0531, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8315, 'compress@10': 1.0, 'time@10': 3.6262}:  23%|██▎       | 7/30 [00:17<01:03,  2.76s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0515, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8377, 'compress@10': 1.0, 'time@10': 3.5282}:  23%|██▎       | 7/30 [00:20<01:03,  2.76s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0515, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8377, 'compress@10': 1.0, 'time@10': 3.5282}:  27%|██▋       | 8/30 [00:20<01:01,  2.79s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0496, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 3.8}:  27%|██▋       | 8/30 [00:23<01:01,  2.79s/it]   {'epoch': 2, 'num_users': 6.3333, 'loss': 0.0496, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 3.8}:  30%|███       | 9/30 [00:23<01:00,  2.87s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 3.7785}:  30%|███       | 9/30 [00:27<01:00,  2.87s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 3.7785}:  33%|███▎      | 10/30 [00:27<01:04,  3.25s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.0507, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8474, 'compress@10': 1.0, 'time@10': 3.8384}:  33%|███▎      | 10/30 [00:29<01:04,  3.25s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.0507, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8474, 'compress@10': 1.0, 'time@10': 3.8384}:  37%|███▋      | 11/30 [00:29<00:55,  2.94s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0492, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8523, 'compress@10': 1.0, 'time@10': 3.5971}:  37%|███▋      | 11/30 [00:30<00:55,  2.94s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0492, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8523, 'compress@10': 1.0, 'time@10': 3.5971}:  40%|████      | 12/30 [00:30<00:42,  2.35s/it]{'epoch': 2, 'num_users': 6.6154, 'loss': 0.0493, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8541, 'compress@10': 1.0, 'time@10': 3.6138}:  40%|████      | 12/30 [00:32<00:42,  2.35s/it]{'epoch': 2, 'num_users': 6.6154, 'loss': 0.0493, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8541, 'compress@10': 1.0, 'time@10': 3.6138}:  43%|████▎     | 13/30 [00:32<00:37,  2.22s/it]{'epoch': 2, 'num_users': 6.3571, 'loss': 0.0519, 'hit_ratio@10': 0.7998, 'ndcg@10': 0.8415, 'compress@10': 1.0, 'time@10': 3.3848}:  43%|████▎     | 13/30 [00:32<00:37,  2.22s/it]{'epoch': 2, 'num_users': 6.3571, 'loss': 0.0519, 'hit_ratio@10': 0.7998, 'ndcg@10': 0.8415, 'compress@10': 1.0, 'time@10': 3.3848}:  47%|████▋     | 14/30 [00:32<00:26,  1.69s/it]{'epoch': 2, 'num_users': 6.2667, 'loss': 0.0522, 'hit_ratio@10': 0.8089, 'ndcg@10': 0.844, 'compress@10': 1.0, 'time@10': 3.4969}:  47%|████▋     | 14/30 [00:35<00:26,  1.69s/it] {'epoch': 2, 'num_users': 6.2667, 'loss': 0.0522, 'hit_ratio@10': 0.8089, 'ndcg@10': 0.844, 'compress@10': 1.0, 'time@10': 3.4969}:  50%|█████     | 15/30 [00:35<00:29,  1.95s/it]{'epoch': 2, 'num_users': 6.0625, 'loss': 0.0504, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8456, 'compress@10': 1.0, 'time@10': 3.3363}:  50%|█████     | 15/30 [00:36<00:29,  1.95s/it]{'epoch': 2, 'num_users': 6.0625, 'loss': 0.0504, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8456, 'compress@10': 1.0, 'time@10': 3.3363}:  53%|█████▎    | 16/30 [00:36<00:23,  1.66s/it]{'epoch': 2, 'num_users': 5.8235, 'loss': 0.0536, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8263, 'compress@10': 1.0, 'time@10': 3.1783}:  53%|█████▎    | 16/30 [00:36<00:23,  1.66s/it]{'epoch': 2, 'num_users': 5.8235, 'loss': 0.0536, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8263, 'compress@10': 1.0, 'time@10': 3.1783}:  57%|█████▋    | 17/30 [00:36<00:16,  1.27s/it]{'epoch': 2, 'num_users': 6.0556, 'loss': 0.0542, 'hit_ratio@10': 0.7907, 'ndcg@10': 0.8278, 'compress@10': 1.0, 'time@10': 3.1327}:  57%|█████▋    | 17/30 [00:39<00:16,  1.27s/it]{'epoch': 2, 'num_users': 6.0556, 'loss': 0.0542, 'hit_ratio@10': 0.7907, 'ndcg@10': 0.8278, 'compress@10': 1.0, 'time@10': 3.1327}:  60%|██████    | 18/30 [00:39<00:19,  1.61s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.0526, 'hit_ratio@10': 0.7942, 'ndcg@10': 0.8312, 'compress@10': 1.0, 'time@10': 3.0819}:  60%|██████    | 18/30 [00:40<00:19,  1.61s/it]   {'epoch': 2, 'num_users': 6.0, 'loss': 0.0526, 'hit_ratio@10': 0.7942, 'ndcg@10': 0.8312, 'compress@10': 1.0, 'time@10': 3.0819}:  63%|██████▎   | 19/30 [00:40<00:16,  1.46s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.0531, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8297, 'compress@10': 1.0, 'time@10': 3.1688}:  63%|██████▎   | 19/30 [00:45<00:16,  1.46s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.0531, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8297, 'compress@10': 1.0, 'time@10': 3.1688}:  67%|██████▋   | 20/30 [00:45<00:24,  2.48s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0541, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8285, 'compress@10': 1.0, 'time@10': 3.3423}:  67%|██████▋   | 20/30 [00:48<00:24,  2.48s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0541, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8285, 'compress@10': 1.0, 'time@10': 3.3423}:  70%|███████   | 21/30 [00:48<00:24,  2.77s/it]{'epoch': 2, 'num_users': 6.1818, 'loss': 0.0533, 'hit_ratio@10': 0.8035, 'ndcg@10': 0.8318, 'compress@10': 1.0, 'time@10': 3.2687}:  70%|███████   | 21/30 [00:50<00:24,  2.77s/it]{'epoch': 2, 'num_users': 6.1818, 'loss': 0.0533, 'hit_ratio@10': 0.8035, 'ndcg@10': 0.8318, 'compress@10': 1.0, 'time@10': 3.2687}:  73%|███████▎  | 22/30 [00:50<00:19,  2.47s/it]{'epoch': 2, 'num_users': 6.1304, 'loss': 0.052, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8346, 'compress@10': 1.0, 'time@10': 3.2637}:  73%|███████▎  | 22/30 [00:52<00:19,  2.47s/it] {'epoch': 2, 'num_users': 6.1304, 'loss': 0.052, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8346, 'compress@10': 1.0, 'time@10': 3.2637}:  77%|███████▋  | 23/30 [00:52<00:15,  2.21s/it]{'epoch': 2, 'num_users': 5.9583, 'loss': 0.0547, 'hit_ratio@10': 0.7969, 'ndcg@10': 0.8233, 'compress@10': 1.0, 'time@10': 3.1401}:  77%|███████▋  | 23/30 [00:52<00:15,  2.21s/it]{'epoch': 2, 'num_users': 5.9583, 'loss': 0.0547, 'hit_ratio@10': 0.7969, 'ndcg@10': 0.8233, 'compress@10': 1.0, 'time@10': 3.1401}:  80%|████████  | 24/30 [00:52<00:09,  1.65s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0646, 'hit_ratio@10': 0.7784, 'ndcg@10': 0.7972, 'compress@10': 1.0, 'time@10': 3.0261}:  80%|████████  | 24/30 [00:52<00:09,  1.65s/it]   {'epoch': 2, 'num_users': 5.8, 'loss': 0.0646, 'hit_ratio@10': 0.7784, 'ndcg@10': 0.7972, 'compress@10': 1.0, 'time@10': 3.0261}:  83%|████████▎ | 25/30 [00:52<00:06,  1.21s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.065, 'hit_ratio@10': 0.7817, 'ndcg@10': 0.797, 'compress@10': 1.0, 'time@10': 3.1679}:  83%|████████▎ | 25/30 [00:59<00:06,  1.21s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.065, 'hit_ratio@10': 0.7817, 'ndcg@10': 0.797, 'compress@10': 1.0, 'time@10': 3.1679}:  87%|████████▋ | 26/30 [00:59<00:11,  2.87s/it]{'epoch': 2, 'num_users': 5.8889, 'loss': 0.0638, 'hit_ratio@10': 0.7885, 'ndcg@10': 0.8004, 'compress@10': 1.0, 'time@10': 3.2152}:  87%|████████▋ | 26/30 [01:01<00:11,  2.87s/it]{'epoch': 2, 'num_users': 5.8889, 'loss': 0.0638, 'hit_ratio@10': 0.7885, 'ndcg@10': 0.8004, 'compress@10': 1.0, 'time@10': 3.2152}:  90%|█████████ | 27/30 [01:01<00:08,  2.69s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.0634, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.803, 'compress@10': 1.0, 'time@10': 3.2625}:  90%|█████████ | 27/30 [01:06<00:08,  2.69s/it]    {'epoch': 2, 'num_users': 6.0, 'loss': 0.0634, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.803, 'compress@10': 1.0, 'time@10': 3.2625}:  93%|█████████▎| 28/30 [01:06<00:06,  3.25s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.0619, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.8064, 'compress@10': 1.0, 'time@10': 3.268}:  93%|█████████▎| 28/30 [01:07<00:06,  3.25s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.0619, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.8064, 'compress@10': 1.0, 'time@10': 3.268}:  97%|█████████▋| 29/30 [01:07<00:02,  2.80s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0611, 'hit_ratio@10': 0.7908, 'ndcg@10': 0.8094, 'compress@10': 1.0, 'time@10': 3.2546}:  97%|█████████▋| 29/30 [01:10<00:02,  2.80s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0611, 'hit_ratio@10': 0.7908, 'ndcg@10': 0.8094, 'compress@10': 1.0, 'time@10': 3.2546}: 100%|██████████| 30/30 [01:10<00:00,  2.83s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0611, 'hit_ratio@10': 0.7908, 'ndcg@10': 0.8094, 'compress@10': 1.0, 'time@10': 3.2546}: 100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch: 2
Avg # of users: 5.866666666666666
Avg Loss: 0.061072669115866854
Avg hit ratio: 0.7908365878564426
Avg ndcg: 0.80944111352649
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2545658349990845
Std train time: 2.0528420951369184
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8463, 'compress@10': 1.0, 'time@10': 3.2262}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8463, 'compress@10': 1.0, 'time@10': 3.2262}:   3%|▎         | 1/30 [00:01<00:47,  1.65s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 2.9397}:   3%|▎         | 1/30 [00:04<00:47,  1.65s/it] {'epoch': 3, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 2.9397}:   7%|▋         | 2/30 [00:04<01:03,  2.26s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0353, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8405, 'compress@10': 1.0, 'time@10': 2.292}:   7%|▋         | 2/30 [00:04<01:03,  2.26s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0353, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8405, 'compress@10': 1.0, 'time@10': 2.292}:  10%|█         | 3/30 [00:04<00:39,  1.47s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0389, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.841, 'compress@10': 1.0, 'time@10': 2.288}:  10%|█         | 3/30 [00:07<00:39,  1.47s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0389, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.841, 'compress@10': 1.0, 'time@10': 2.288}:  13%|█▎        | 4/30 [00:07<00:46,  1.81s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0476, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.831, 'compress@10': 1.0, 'time@10': 3.5356}:  13%|█▎        | 4/30 [00:11<00:46,  1.81s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0476, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.831, 'compress@10': 1.0, 'time@10': 3.5356}:  17%|█▋        | 5/30 [00:11<01:07,  2.71s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0523, 'hit_ratio@10': 0.7907, 'ndcg@10': 0.8288, 'compress@10': 1.0, 'time@10': 3.5771}:  17%|█▋        | 5/30 [00:15<01:07,  2.71s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0523, 'hit_ratio@10': 0.7907, 'ndcg@10': 0.8288, 'compress@10': 1.0, 'time@10': 3.5771}:  20%|██        | 6/30 [00:15<01:14,  3.09s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0509, 'hit_ratio@10': 0.8149, 'ndcg@10': 0.831, 'compress@10': 1.0, 'time@10': 3.6611}:  20%|██        | 6/30 [00:17<01:14,  3.09s/it] {'epoch': 3, 'num_users': 6.2857, 'loss': 0.0509, 'hit_ratio@10': 0.8149, 'ndcg@10': 0.831, 'compress@10': 1.0, 'time@10': 3.6611}:  23%|██▎       | 7/30 [00:17<01:03,  2.77s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0496, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8379, 'compress@10': 1.0, 'time@10': 3.5671}:  23%|██▎       | 7/30 [00:20<01:03,  2.77s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0496, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8379, 'compress@10': 1.0, 'time@10': 3.5671}:  27%|██▋       | 8/30 [00:20<01:02,  2.83s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0499, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.84, 'compress@10': 1.0, 'time@10': 3.8197}:  27%|██▋       | 8/30 [00:23<01:02,  2.83s/it] {'epoch': 3, 'num_users': 6.3333, 'loss': 0.0499, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.84, 'compress@10': 1.0, 'time@10': 3.8197}:  30%|███       | 9/30 [00:23<01:00,  2.87s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0496, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8408, 'compress@10': 1.0, 'time@10': 3.7975}:  30%|███       | 9/30 [00:26<01:00,  2.87s/it] {'epoch': 3, 'num_users': 6.3, 'loss': 0.0496, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8408, 'compress@10': 1.0, 'time@10': 3.7975}:  33%|███▎      | 10/30 [00:26<01:02,  3.10s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.0507, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8429, 'compress@10': 1.0, 'time@10': 3.8477}:  33%|███▎      | 10/30 [00:29<01:02,  3.10s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.0507, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8429, 'compress@10': 1.0, 'time@10': 3.8477}:  37%|███▋      | 11/30 [00:29<00:53,  2.83s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.0486, 'hit_ratio@10': 0.814, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 3.6031}:  37%|███▋      | 11/30 [00:30<00:53,  2.83s/it]  {'epoch': 3, 'num_users': 6.4167, 'loss': 0.0486, 'hit_ratio@10': 0.814, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 3.6031}:  40%|████      | 12/30 [00:30<00:40,  2.26s/it]{'epoch': 3, 'num_users': 6.6154, 'loss': 0.0487, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8511, 'compress@10': 1.0, 'time@10': 3.6063}:  40%|████      | 12/30 [00:31<00:40,  2.26s/it]{'epoch': 3, 'num_users': 6.6154, 'loss': 0.0487, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8511, 'compress@10': 1.0, 'time@10': 3.6063}:  43%|████▎     | 13/30 [00:31<00:36,  2.14s/it]{'epoch': 3, 'num_users': 6.3571, 'loss': 0.0496, 'hit_ratio@10': 0.807, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 3.3782}:  43%|████▎     | 13/30 [00:32<00:36,  2.14s/it] {'epoch': 3, 'num_users': 6.3571, 'loss': 0.0496, 'hit_ratio@10': 0.807, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 3.3782}:  47%|████▋     | 14/30 [00:32<00:26,  1.63s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.0501, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.843, 'compress@10': 1.0, 'time@10': 3.4852}:  47%|████▋     | 14/30 [00:34<00:26,  1.63s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.0501, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.843, 'compress@10': 1.0, 'time@10': 3.4852}:  50%|█████     | 15/30 [00:34<00:28,  1.90s/it]{'epoch': 3, 'num_users': 6.0625, 'loss': 0.0481, 'hit_ratio@10': 0.8219, 'ndcg@10': 0.845, 'compress@10': 1.0, 'time@10': 3.323}:  50%|█████     | 15/30 [00:35<00:28,  1.90s/it] {'epoch': 3, 'num_users': 6.0625, 'loss': 0.0481, 'hit_ratio@10': 0.8219, 'ndcg@10': 0.845, 'compress@10': 1.0, 'time@10': 3.323}:  53%|█████▎    | 16/30 [00:35<00:22,  1.61s/it]{'epoch': 3, 'num_users': 5.8235, 'loss': 0.0488, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.8289, 'compress@10': 1.0, 'time@10': 3.1662}:  53%|█████▎    | 16/30 [00:36<00:22,  1.61s/it]{'epoch': 3, 'num_users': 5.8235, 'loss': 0.0488, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.8289, 'compress@10': 1.0, 'time@10': 3.1662}:  57%|█████▋    | 17/30 [00:36<00:16,  1.23s/it]{'epoch': 3, 'num_users': 6.0556, 'loss': 0.0496, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8303, 'compress@10': 1.0, 'time@10': 3.1208}:  57%|█████▋    | 17/30 [00:38<00:16,  1.23s/it]{'epoch': 3, 'num_users': 6.0556, 'loss': 0.0496, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8303, 'compress@10': 1.0, 'time@10': 3.1208}:  60%|██████    | 18/30 [00:38<00:18,  1.58s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.048, 'hit_ratio@10': 0.8188, 'ndcg@10': 0.8339, 'compress@10': 1.0, 'time@10': 3.0691}:  60%|██████    | 18/30 [00:39<00:18,  1.58s/it]    {'epoch': 3, 'num_users': 6.0, 'loss': 0.048, 'hit_ratio@10': 0.8188, 'ndcg@10': 0.8339, 'compress@10': 1.0, 'time@10': 3.0691}:  63%|██████▎   | 19/30 [00:39<00:15,  1.44s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.0486, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.833, 'compress@10': 1.0, 'time@10': 3.1557}:  63%|██████▎   | 19/30 [00:44<00:15,  1.44s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.0486, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.833, 'compress@10': 1.0, 'time@10': 3.1557}:  67%|██████▋   | 20/30 [00:44<00:24,  2.46s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0497, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8317, 'compress@10': 1.0, 'time@10': 3.3298}:  67%|██████▋   | 20/30 [00:48<00:24,  2.46s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0497, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8317, 'compress@10': 1.0, 'time@10': 3.3298}:  70%|███████   | 21/30 [00:48<00:24,  2.75s/it]{'epoch': 3, 'num_users': 6.1818, 'loss': 0.0491, 'hit_ratio@10': 0.8228, 'ndcg@10': 0.8352, 'compress@10': 1.0, 'time@10': 3.2565}:  70%|███████   | 21/30 [00:49<00:24,  2.75s/it]{'epoch': 3, 'num_users': 6.1818, 'loss': 0.0491, 'hit_ratio@10': 0.8228, 'ndcg@10': 0.8352, 'compress@10': 1.0, 'time@10': 3.2565}:  73%|███████▎  | 22/30 [00:49<00:19,  2.46s/it]{'epoch': 3, 'num_users': 6.1304, 'loss': 0.048, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.2531}:  73%|███████▎  | 22/30 [00:51<00:19,  2.46s/it]  {'epoch': 3, 'num_users': 6.1304, 'loss': 0.048, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.2531}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it]{'epoch': 3, 'num_users': 5.9583, 'loss': 0.0494, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8262, 'compress@10': 1.0, 'time@10': 3.131}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it]{'epoch': 3, 'num_users': 5.9583, 'loss': 0.0494, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8262, 'compress@10': 1.0, 'time@10': 3.131}:  80%|████████  | 24/30 [00:51<00:09,  1.65s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.052, 'hit_ratio@10': 0.8034, 'ndcg@10': 0.806, 'compress@10': 1.0, 'time@10': 3.0192}:  80%|████████  | 24/30 [00:51<00:09,  1.65s/it]    {'epoch': 3, 'num_users': 5.8, 'loss': 0.052, 'hit_ratio@10': 0.8034, 'ndcg@10': 0.806, 'compress@10': 1.0, 'time@10': 3.0192}:  83%|████████▎ | 25/30 [00:51<00:06,  1.22s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.0526, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8062, 'compress@10': 1.0, 'time@10': 3.1636}:  83%|████████▎ | 25/30 [00:58<00:06,  1.22s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.0526, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8062, 'compress@10': 1.0, 'time@10': 3.1636}:  87%|████████▋ | 26/30 [00:58<00:11,  2.90s/it]{'epoch': 3, 'num_users': 5.8889, 'loss': 0.0519, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8094, 'compress@10': 1.0, 'time@10': 3.2141}:  87%|████████▋ | 26/30 [01:01<00:11,  2.90s/it]{'epoch': 3, 'num_users': 5.8889, 'loss': 0.0519, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8094, 'compress@10': 1.0, 'time@10': 3.2141}:  90%|█████████ | 27/30 [01:01<00:08,  2.72s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.0519, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8121, 'compress@10': 1.0, 'time@10': 3.2478}:  90%|█████████ | 27/30 [01:05<00:08,  2.72s/it]    {'epoch': 3, 'num_users': 6.0, 'loss': 0.0519, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8121, 'compress@10': 1.0, 'time@10': 3.2478}:  93%|█████████▎| 28/30 [01:05<00:06,  3.16s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.0507, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8148, 'compress@10': 1.0, 'time@10': 3.253}:  93%|█████████▎| 28/30 [01:07<00:06,  3.16s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.0507, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8148, 'compress@10': 1.0, 'time@10': 3.253}:  97%|█████████▋| 29/30 [01:07<00:02,  2.73s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0505, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8172, 'compress@10': 1.0, 'time@10': 3.2457}:  97%|█████████▋| 29/30 [01:10<00:02,  2.73s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0505, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8172, 'compress@10': 1.0, 'time@10': 3.2457}: 100%|██████████| 30/30 [01:10<00:00,  2.84s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0505, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8172, 'compress@10': 1.0, 'time@10': 3.2457}: 100%|██████████| 30/30 [01:10<00:00,  2.34s/it]
Epoch: 3
Avg # of users: 5.866666666666666
Avg Loss: 0.050454226492990445
Avg hit ratio: 0.8125538729136431
Avg ndcg: 0.8171671913538157
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2456746975580852
Std train time: 2.032833062946533
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 3.0867}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 3.0867}:   3%|▎         | 1/30 [00:01<00:45,  1.58s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8557, 'compress@10': 1.0, 'time@10': 2.8087}:   3%|▎         | 1/30 [00:04<00:45,  1.58s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8557, 'compress@10': 1.0, 'time@10': 2.8087}:   7%|▋         | 2/30 [00:04<01:00,  2.17s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 2.2018}:   7%|▋         | 2/30 [00:04<01:00,  2.17s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 2.2018}:  10%|█         | 3/30 [00:04<00:38,  1.43s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0382, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8528, 'compress@10': 1.0, 'time@10': 2.2097}:  10%|█         | 3/30 [00:06<00:38,  1.43s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0382, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8528, 'compress@10': 1.0, 'time@10': 2.2097}:  13%|█▎        | 4/30 [00:06<00:45,  1.77s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0464, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8418, 'compress@10': 1.0, 'time@10': 3.4549}:  13%|█▎        | 4/30 [00:11<00:45,  1.77s/it]  {'epoch': 4, 'num_users': 5.8, 'loss': 0.0464, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8418, 'compress@10': 1.0, 'time@10': 3.4549}:  17%|█▋        | 5/30 [00:11<01:06,  2.67s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.051, 'hit_ratio@10': 0.7797, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.4511}:  17%|█▋        | 5/30 [00:14<01:06,  2.67s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.051, 'hit_ratio@10': 0.7797, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.4511}:  20%|██        | 6/30 [00:14<01:10,  2.94s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0502, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.8383, 'compress@10': 1.0, 'time@10': 3.4851}:  20%|██        | 6/30 [00:16<01:10,  2.94s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0502, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.8383, 'compress@10': 1.0, 'time@10': 3.4851}:  23%|██▎       | 7/30 [00:16<00:59,  2.59s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0502, 'hit_ratio@10': 0.819, 'ndcg@10': 0.8425, 'compress@10': 1.0, 'time@10': 3.4003}:  23%|██▎       | 7/30 [00:19<00:59,  2.59s/it]  {'epoch': 4, 'num_users': 6.125, 'loss': 0.0502, 'hit_ratio@10': 0.819, 'ndcg@10': 0.8425, 'compress@10': 1.0, 'time@10': 3.4003}:  27%|██▋       | 8/30 [00:19<00:58,  2.67s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0507, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8643, 'compress@10': 1.0, 'time@10': 3.6685}:  27%|██▋       | 8/30 [00:22<00:58,  2.67s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0507, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8643, 'compress@10': 1.0, 'time@10': 3.6685}:  30%|███       | 9/30 [00:22<00:57,  2.76s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0508, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 3.6633}:  30%|███       | 9/30 [00:26<00:57,  2.76s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0508, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 3.6633}:  33%|███▎      | 10/30 [00:26<01:00,  3.03s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.0518, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 3.7242}:  33%|███▎      | 10/30 [00:28<01:00,  3.03s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.0518, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 3.7242}:  37%|███▋      | 11/30 [00:28<00:52,  2.78s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0493, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.867, 'compress@10': 1.0, 'time@10': 3.49}:  37%|███▋      | 11/30 [00:29<00:52,  2.78s/it]   {'epoch': 4, 'num_users': 6.4167, 'loss': 0.0493, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.867, 'compress@10': 1.0, 'time@10': 3.49}:  40%|████      | 12/30 [00:29<00:40,  2.22s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.0495, 'hit_ratio@10': 0.8089, 'ndcg@10': 0.8686, 'compress@10': 1.0, 'time@10': 3.5009}:  40%|████      | 12/30 [00:31<00:40,  2.22s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.0495, 'hit_ratio@10': 0.8089, 'ndcg@10': 0.8686, 'compress@10': 1.0, 'time@10': 3.5009}:  43%|████▎     | 13/30 [00:31<00:35,  2.11s/it]{'epoch': 4, 'num_users': 6.3571, 'loss': 0.0496, 'hit_ratio@10': 0.7988, 'ndcg@10': 0.857, 'compress@10': 1.0, 'time@10': 3.2802}:  43%|████▎     | 13/30 [00:31<00:35,  2.11s/it] {'epoch': 4, 'num_users': 6.3571, 'loss': 0.0496, 'hit_ratio@10': 0.7988, 'ndcg@10': 0.857, 'compress@10': 1.0, 'time@10': 3.2802}:  47%|████▋     | 14/30 [00:31<00:25,  1.61s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.0502, 'hit_ratio@10': 0.81, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 3.3964}:  47%|████▋     | 14/30 [00:34<00:25,  1.61s/it]  {'epoch': 4, 'num_users': 6.2667, 'loss': 0.0502, 'hit_ratio@10': 0.81, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 3.3964}:  50%|█████     | 15/30 [00:34<00:28,  1.89s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.0482, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 3.241}:  50%|█████     | 15/30 [00:35<00:28,  1.89s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.0482, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 3.241}:  53%|█████▎    | 16/30 [00:35<00:22,  1.61s/it]{'epoch': 4, 'num_users': 5.8235, 'loss': 0.048, 'hit_ratio@10': 0.8039, 'ndcg@10': 0.8472, 'compress@10': 1.0, 'time@10': 3.0892}:  53%|█████▎    | 16/30 [00:35<00:22,  1.61s/it]{'epoch': 4, 'num_users': 5.8235, 'loss': 0.048, 'hit_ratio@10': 0.8039, 'ndcg@10': 0.8472, 'compress@10': 1.0, 'time@10': 3.0892}:  57%|█████▋    | 17/30 [00:35<00:16,  1.23s/it]{'epoch': 4, 'num_users': 6.0556, 'loss': 0.0488, 'hit_ratio@10': 0.801, 'ndcg@10': 0.8475, 'compress@10': 1.0, 'time@10': 3.048}:  57%|█████▋    | 17/30 [00:37<00:16,  1.23s/it] {'epoch': 4, 'num_users': 6.0556, 'loss': 0.0488, 'hit_ratio@10': 0.801, 'ndcg@10': 0.8475, 'compress@10': 1.0, 'time@10': 3.048}:  60%|██████    | 18/30 [00:37<00:18,  1.58s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.0472, 'hit_ratio@10': 0.8039, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 3.0014}:  60%|██████    | 18/30 [00:38<00:18,  1.58s/it] {'epoch': 4, 'num_users': 6.0, 'loss': 0.0472, 'hit_ratio@10': 0.8039, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 3.0014}:  63%|██████▎   | 19/30 [00:38<00:15,  1.44s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.0477, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8486, 'compress@10': 1.0, 'time@10': 3.0938}:  63%|██████▎   | 19/30 [00:43<00:15,  1.44s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.0477, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8486, 'compress@10': 1.0, 'time@10': 3.0938}:  67%|██████▋   | 20/30 [00:43<00:24,  2.48s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0489, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8469, 'compress@10': 1.0, 'time@10': 3.2695}:  67%|██████▋   | 20/30 [00:47<00:24,  2.48s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0489, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8469, 'compress@10': 1.0, 'time@10': 3.2695}:  70%|███████   | 21/30 [00:47<00:24,  2.76s/it]{'epoch': 4, 'num_users': 6.1818, 'loss': 0.0486, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8495, 'compress@10': 1.0, 'time@10': 3.1991}:  70%|███████   | 21/30 [00:48<00:24,  2.76s/it]{'epoch': 4, 'num_users': 6.1818, 'loss': 0.0486, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8495, 'compress@10': 1.0, 'time@10': 3.1991}:  73%|███████▎  | 22/30 [00:48<00:19,  2.46s/it]{'epoch': 4, 'num_users': 6.1304, 'loss': 0.0475, 'hit_ratio@10': 0.8095, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 3.2008}:  73%|███████▎  | 22/30 [00:50<00:19,  2.46s/it]{'epoch': 4, 'num_users': 6.1304, 'loss': 0.0475, 'hit_ratio@10': 0.8095, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 3.2008}:  77%|███████▋  | 23/30 [00:50<00:15,  2.22s/it]{'epoch': 4, 'num_users': 5.9583, 'loss': 0.0484, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8385, 'compress@10': 1.0, 'time@10': 3.0809}:  77%|███████▋  | 23/30 [00:50<00:15,  2.22s/it]{'epoch': 4, 'num_users': 5.9583, 'loss': 0.0484, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8385, 'compress@10': 1.0, 'time@10': 3.0809}:  80%|████████  | 24/30 [00:50<00:09,  1.66s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0498, 'hit_ratio@10': 0.7901, 'ndcg@10': 0.8206, 'compress@10': 1.0, 'time@10': 2.9715}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]   {'epoch': 4, 'num_users': 5.8, 'loss': 0.0498, 'hit_ratio@10': 0.7901, 'ndcg@10': 0.8206, 'compress@10': 1.0, 'time@10': 2.9715}:  83%|████████▎ | 25/30 [00:51<00:06,  1.23s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.0503, 'hit_ratio@10': 0.7934, 'ndcg@10': 0.8206, 'compress@10': 1.0, 'time@10': 3.1201}:  83%|████████▎ | 25/30 [00:58<00:06,  1.23s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.0503, 'hit_ratio@10': 0.7934, 'ndcg@10': 0.8206, 'compress@10': 1.0, 'time@10': 3.1201}:  87%|████████▋ | 26/30 [00:58<00:11,  2.92s/it]{'epoch': 4, 'num_users': 5.8889, 'loss': 0.0501, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.823, 'compress@10': 1.0, 'time@10': 3.1789}:  87%|████████▋ | 26/30 [01:00<00:11,  2.92s/it] {'epoch': 4, 'num_users': 5.8889, 'loss': 0.0501, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.823, 'compress@10': 1.0, 'time@10': 3.1789}:  90%|█████████ | 27/30 [01:00<00:08,  2.76s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.0503, 'hit_ratio@10': 0.8007, 'ndcg@10': 0.825, 'compress@10': 1.0, 'time@10': 3.2221}:  90%|█████████ | 27/30 [01:04<00:08,  2.76s/it]   {'epoch': 4, 'num_users': 6.0, 'loss': 0.0503, 'hit_ratio@10': 0.8007, 'ndcg@10': 0.825, 'compress@10': 1.0, 'time@10': 3.2221}:  93%|█████████▎| 28/30 [01:04<00:06,  3.26s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.0495, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.8272, 'compress@10': 1.0, 'time@10': 3.2341}:  93%|█████████▎| 28/30 [01:06<00:06,  3.26s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.0495, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.8272, 'compress@10': 1.0, 'time@10': 3.2341}:  97%|█████████▋| 29/30 [01:06<00:02,  2.83s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0493, 'hit_ratio@10': 0.8002, 'ndcg@10': 0.8291, 'compress@10': 1.0, 'time@10': 3.2242}:  97%|█████████▋| 29/30 [01:09<00:02,  2.83s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0493, 'hit_ratio@10': 0.8002, 'ndcg@10': 0.8291, 'compress@10': 1.0, 'time@10': 3.2242}: 100%|██████████| 30/30 [01:09<00:00,  2.87s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0493, 'hit_ratio@10': 0.8002, 'ndcg@10': 0.8291, 'compress@10': 1.0, 'time@10': 3.2242}: 100%|██████████| 30/30 [01:09<00:00,  2.32s/it]
Epoch: 4
Avg # of users: 5.866666666666666
Avg Loss: 0.04925649998704454
Avg hit ratio: 0.8001816933424076
Avg ndcg: 0.8291024236426198
Avg compression ratio: 0.9999999860153537
Avg train time: 3.224232045809428
Std train time: 2.0306724261674467
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8521, 'compress@10': 1.0, 'time@10': 3.1087}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8521, 'compress@10': 1.0, 'time@10': 3.1087}:   3%|▎         | 1/30 [00:01<00:46,  1.59s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 2.8371}:   3%|▎         | 1/30 [00:04<00:46,  1.59s/it] {'epoch': 5, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 2.8371}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0346, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8544, 'compress@10': 1.0, 'time@10': 2.2183}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0346, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8544, 'compress@10': 1.0, 'time@10': 2.2183}:  10%|█         | 3/30 [00:04<00:38,  1.43s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0385, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.853, 'compress@10': 1.0, 'time@10': 2.2244}:  10%|█         | 3/30 [00:07<00:38,  1.43s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0385, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.853, 'compress@10': 1.0, 'time@10': 2.2244}:  13%|█▎        | 4/30 [00:07<00:45,  1.77s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0461, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8435, 'compress@10': 1.0, 'time@10': 3.4815}:  13%|█▎        | 4/30 [00:11<00:45,  1.77s/it] {'epoch': 5, 'num_users': 5.8, 'loss': 0.0461, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8435, 'compress@10': 1.0, 'time@10': 3.4815}:  17%|█▋        | 5/30 [00:11<01:06,  2.68s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0502, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 3.5275}:  17%|█▋        | 5/30 [00:15<01:06,  2.68s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0502, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 3.5275}:  20%|██        | 6/30 [00:15<01:13,  3.06s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0494, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.842, 'compress@10': 1.0, 'time@10': 3.6035}:  20%|██        | 6/30 [00:17<01:13,  3.06s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0494, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.842, 'compress@10': 1.0, 'time@10': 3.6035}:  23%|██▎       | 7/30 [00:17<01:02,  2.73s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.844, 'compress@10': 1.0, 'time@10': 3.5075}:  23%|██▎       | 7/30 [00:20<01:02,  2.73s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.844, 'compress@10': 1.0, 'time@10': 3.5075}:  27%|██▋       | 8/30 [00:20<01:01,  2.78s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0536, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 3.7768}:  27%|██▋       | 8/30 [00:23<01:01,  2.78s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0536, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 3.7768}:  30%|███       | 9/30 [00:23<00:59,  2.85s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0538, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 3.7493}:  30%|███       | 9/30 [00:26<00:59,  2.85s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0538, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 3.7493}:  33%|███▎      | 10/30 [00:26<01:01,  3.06s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0546, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 3.8013}:  33%|███▎      | 10/30 [00:28<01:01,  3.06s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0546, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 3.8013}:  37%|███▋      | 11/30 [00:28<00:53,  2.80s/it]{'epoch': 5, 'num_users': 6.4167, 'loss': 0.0519, 'hit_ratio@10': 0.7996, 'ndcg@10': 0.8672, 'compress@10': 1.0, 'time@10': 3.5581}:  37%|███▋      | 11/30 [00:29<00:53,  2.80s/it]{'epoch': 5, 'num_users': 6.4167, 'loss': 0.0519, 'hit_ratio@10': 0.7996, 'ndcg@10': 0.8672, 'compress@10': 1.0, 'time@10': 3.5581}:  40%|████      | 12/30 [00:29<00:40,  2.23s/it]{'epoch': 5, 'num_users': 6.6154, 'loss': 0.0523, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8692, 'compress@10': 1.0, 'time@10': 3.5586}:  40%|████      | 12/30 [00:31<00:40,  2.23s/it]{'epoch': 5, 'num_users': 6.6154, 'loss': 0.0523, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8692, 'compress@10': 1.0, 'time@10': 3.5586}:  43%|████▎     | 13/30 [00:31<00:35,  2.10s/it]{'epoch': 5, 'num_users': 6.3571, 'loss': 0.0519, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 3.3346}:  43%|████▎     | 13/30 [00:31<00:35,  2.10s/it] {'epoch': 5, 'num_users': 6.3571, 'loss': 0.0519, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 3.3346}:  47%|████▋     | 14/30 [00:31<00:25,  1.61s/it]{'epoch': 5, 'num_users': 6.2667, 'loss': 0.0525, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.8598, 'compress@10': 1.0, 'time@10': 3.4469}:  47%|████▋     | 14/30 [00:34<00:25,  1.61s/it]{'epoch': 5, 'num_users': 6.2667, 'loss': 0.0525, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.8598, 'compress@10': 1.0, 'time@10': 3.4469}:  50%|█████     | 15/30 [00:34<00:28,  1.89s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.0502, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8605, 'compress@10': 1.0, 'time@10': 3.2891}:  50%|█████     | 15/30 [00:35<00:28,  1.89s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.0502, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8605, 'compress@10': 1.0, 'time@10': 3.2891}:  53%|█████▎    | 16/30 [00:35<00:22,  1.61s/it]{'epoch': 5, 'num_users': 5.8235, 'loss': 0.0496, 'hit_ratio@10': 0.8006, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 3.1377}:  53%|█████▎    | 16/30 [00:35<00:22,  1.61s/it] {'epoch': 5, 'num_users': 5.8235, 'loss': 0.0496, 'hit_ratio@10': 0.8006, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 3.1377}:  57%|█████▋    | 17/30 [00:35<00:16,  1.24s/it]{'epoch': 5, 'num_users': 6.0556, 'loss': 0.0503, 'hit_ratio@10': 0.7978, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 3.103}:  57%|█████▋    | 17/30 [00:38<00:16,  1.24s/it] {'epoch': 5, 'num_users': 6.0556, 'loss': 0.0503, 'hit_ratio@10': 0.7978, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 3.103}:  60%|██████    | 18/30 [00:38<00:19,  1.65s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.0485, 'hit_ratio@10': 0.8009, 'ndcg@10': 0.8507, 'compress@10': 1.0, 'time@10': 3.0474}:  60%|██████    | 18/30 [00:39<00:19,  1.65s/it] {'epoch': 5, 'num_users': 6.0, 'loss': 0.0485, 'hit_ratio@10': 0.8009, 'ndcg@10': 0.8507, 'compress@10': 1.0, 'time@10': 3.0474}:  63%|██████▎   | 19/30 [00:39<00:16,  1.47s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.0489, 'hit_ratio@10': 0.8047, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 3.1369}:  63%|██████▎   | 19/30 [00:44<00:16,  1.47s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.0489, 'hit_ratio@10': 0.8047, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 3.1369}:  67%|██████▋   | 20/30 [00:44<00:24,  2.49s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 3.3389}:  67%|██████▋   | 20/30 [00:48<00:24,  2.49s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 3.3389}:  70%|███████   | 21/30 [00:48<00:25,  2.87s/it]{'epoch': 5, 'num_users': 6.1818, 'loss': 0.0498, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 3.2699}:  70%|███████   | 21/30 [00:50<00:25,  2.87s/it]{'epoch': 5, 'num_users': 6.1818, 'loss': 0.0498, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 3.2699}:  73%|███████▎  | 22/30 [00:50<00:20,  2.59s/it]{'epoch': 5, 'num_users': 6.1304, 'loss': 0.0488, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.8523, 'compress@10': 1.0, 'time@10': 3.2679}:  73%|███████▎  | 22/30 [00:51<00:20,  2.59s/it]{'epoch': 5, 'num_users': 6.1304, 'loss': 0.0488, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.8523, 'compress@10': 1.0, 'time@10': 3.2679}:  77%|███████▋  | 23/30 [00:51<00:16,  2.30s/it]{'epoch': 5, 'num_users': 5.9583, 'loss': 0.0494, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 3.1454}:  77%|███████▋  | 23/30 [00:52<00:16,  2.30s/it]{'epoch': 5, 'num_users': 5.9583, 'loss': 0.0494, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 3.1454}:  80%|████████  | 24/30 [00:52<00:10,  1.72s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0504, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8228, 'compress@10': 1.0, 'time@10': 3.0326}:  80%|████████  | 24/30 [00:52<00:10,  1.72s/it]   {'epoch': 5, 'num_users': 5.8, 'loss': 0.0504, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8228, 'compress@10': 1.0, 'time@10': 3.0326}:  83%|████████▎ | 25/30 [00:52<00:06,  1.27s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.0506, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8232, 'compress@10': 1.0, 'time@10': 3.177}:  83%|████████▎ | 25/30 [00:59<00:06,  1.27s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.0506, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8232, 'compress@10': 1.0, 'time@10': 3.177}:  87%|████████▋ | 26/30 [00:59<00:11,  2.93s/it]{'epoch': 5, 'num_users': 5.8889, 'loss': 0.0505, 'hit_ratio@10': 0.8098, 'ndcg@10': 0.8275, 'compress@10': 1.0, 'time@10': 3.231}:  87%|████████▋ | 26/30 [01:01<00:11,  2.93s/it]{'epoch': 5, 'num_users': 5.8889, 'loss': 0.0505, 'hit_ratio@10': 0.8098, 'ndcg@10': 0.8275, 'compress@10': 1.0, 'time@10': 3.231}:  90%|█████████ | 27/30 [01:01<00:08,  2.76s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.0507, 'hit_ratio@10': 0.8124, 'ndcg@10': 0.8286, 'compress@10': 1.0, 'time@10': 3.2666}:  90%|█████████ | 27/30 [01:05<00:08,  2.76s/it]  {'epoch': 5, 'num_users': 6.0, 'loss': 0.0507, 'hit_ratio@10': 0.8124, 'ndcg@10': 0.8286, 'compress@10': 1.0, 'time@10': 3.2666}:  93%|█████████▎| 28/30 [01:05<00:06,  3.21s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.0499, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.8301, 'compress@10': 1.0, 'time@10': 3.2648}:  93%|█████████▎| 28/30 [01:07<00:06,  3.21s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.0499, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.8301, 'compress@10': 1.0, 'time@10': 3.2648}:  97%|█████████▋| 29/30 [01:07<00:02,  2.74s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0497, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8318, 'compress@10': 1.0, 'time@10': 3.2552}:  97%|█████████▋| 29/30 [01:10<00:02,  2.74s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0497, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8318, 'compress@10': 1.0, 'time@10': 3.2552}: 100%|██████████| 30/30 [01:10<00:00,  2.82s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0497, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8318, 'compress@10': 1.0, 'time@10': 3.2552}: 100%|██████████| 30/30 [01:10<00:00,  2.35s/it]
Epoch: 5
Avg # of users: 5.866666666666666
Avg Loss: 0.04967938987828101
Avg hit ratio: 0.8101488708226108
Avg ndcg: 0.831796098164645
Avg compression ratio: 0.9999999860153537
Avg train time: 3.255228312810262
Std train time: 2.070766652625747
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8497, 'compress@10': 1.0, 'time@10': 3.1502}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8497, 'compress@10': 1.0, 'time@10': 3.1502}:   3%|▎         | 1/30 [00:01<00:46,  1.61s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8466, 'compress@10': 1.0, 'time@10': 2.8469}:   3%|▎         | 1/30 [00:04<00:46,  1.61s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8466, 'compress@10': 1.0, 'time@10': 2.8469}:   7%|▋         | 2/30 [00:04<01:01,  2.18s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0346, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 2.2181}:   7%|▋         | 2/30 [00:04<01:01,  2.18s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0346, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 2.2181}:  10%|█         | 3/30 [00:04<00:38,  1.42s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.04, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8498, 'compress@10': 1.0, 'time@10': 2.2249}:  10%|█         | 3/30 [00:06<00:38,  1.42s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.04, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8498, 'compress@10': 1.0, 'time@10': 2.2249}:  13%|█▎        | 4/30 [00:06<00:45,  1.76s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0465, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8415, 'compress@10': 1.0, 'time@10': 3.4667}:  13%|█▎        | 4/30 [00:11<00:45,  1.76s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0465, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8415, 'compress@10': 1.0, 'time@10': 3.4667}:  17%|█▋        | 5/30 [00:11<01:06,  2.66s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.05, 'hit_ratio@10': 0.7834, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 3.5217}:  17%|█▋        | 5/30 [00:15<01:06,  2.66s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.05, 'hit_ratio@10': 0.7834, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 3.5217}:  20%|██        | 6/30 [00:15<01:13,  3.06s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0487, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8439, 'compress@10': 1.0, 'time@10': 3.5947}:  20%|██        | 6/30 [00:17<01:13,  3.06s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0487, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8439, 'compress@10': 1.0, 'time@10': 3.5947}:  23%|██▎       | 7/30 [00:17<01:02,  2.73s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0501, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 3.499}:  23%|██▎       | 7/30 [00:20<01:02,  2.73s/it]  {'epoch': 6, 'num_users': 6.125, 'loss': 0.0501, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 3.499}:  27%|██▋       | 8/30 [00:20<01:01,  2.77s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0562, 'hit_ratio@10': 0.8194, 'ndcg@10': 0.8523, 'compress@10': 1.0, 'time@10': 3.7586}:  27%|██▋       | 8/30 [00:22<01:01,  2.77s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0562, 'hit_ratio@10': 0.8194, 'ndcg@10': 0.8523, 'compress@10': 1.0, 'time@10': 3.7586}:  30%|███       | 9/30 [00:22<00:59,  2.83s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0553, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8525, 'compress@10': 1.0, 'time@10': 3.7585}:  30%|███       | 9/30 [00:26<00:59,  2.83s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0553, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8525, 'compress@10': 1.0, 'time@10': 3.7585}:  33%|███▎      | 10/30 [00:26<01:02,  3.13s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.0558, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8537, 'compress@10': 1.0, 'time@10': 3.8294}:  33%|███▎      | 10/30 [00:29<01:02,  3.13s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.0558, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8537, 'compress@10': 1.0, 'time@10': 3.8294}:  37%|███▋      | 11/30 [00:29<00:54,  2.88s/it]{'epoch': 6, 'num_users': 6.4167, 'loss': 0.053, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8589, 'compress@10': 1.0, 'time@10': 3.5866}:  37%|███▋      | 11/30 [00:30<00:54,  2.88s/it] {'epoch': 6, 'num_users': 6.4167, 'loss': 0.053, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8589, 'compress@10': 1.0, 'time@10': 3.5866}:  40%|████      | 12/30 [00:30<00:41,  2.29s/it]{'epoch': 6, 'num_users': 6.6154, 'loss': 0.0534, 'hit_ratio@10': 0.8124, 'ndcg@10': 0.8614, 'compress@10': 1.0, 'time@10': 3.5922}:  40%|████      | 12/30 [00:31<00:41,  2.29s/it]{'epoch': 6, 'num_users': 6.6154, 'loss': 0.0534, 'hit_ratio@10': 0.8124, 'ndcg@10': 0.8614, 'compress@10': 1.0, 'time@10': 3.5922}:  43%|████▎     | 13/30 [00:31<00:36,  2.16s/it]{'epoch': 6, 'num_users': 6.3571, 'loss': 0.0529, 'hit_ratio@10': 0.802, 'ndcg@10': 0.8519, 'compress@10': 1.0, 'time@10': 3.3647}:  43%|████▎     | 13/30 [00:32<00:36,  2.16s/it] {'epoch': 6, 'num_users': 6.3571, 'loss': 0.0529, 'hit_ratio@10': 0.802, 'ndcg@10': 0.8519, 'compress@10': 1.0, 'time@10': 3.3647}:  47%|████▋     | 14/30 [00:32<00:26,  1.65s/it]{'epoch': 6, 'num_users': 6.2667, 'loss': 0.0539, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 3.4739}:  47%|████▋     | 14/30 [00:34<00:26,  1.65s/it]{'epoch': 6, 'num_users': 6.2667, 'loss': 0.0539, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 3.4739}:  50%|█████     | 15/30 [00:34<00:28,  1.92s/it]{'epoch': 6, 'num_users': 6.0625, 'loss': 0.0516, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 3.3137}:  50%|█████     | 15/30 [00:35<00:28,  1.92s/it]{'epoch': 6, 'num_users': 6.0625, 'loss': 0.0516, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 3.3137}:  53%|█████▎    | 16/30 [00:35<00:22,  1.63s/it]{'epoch': 6, 'num_users': 5.8235, 'loss': 0.0508, 'hit_ratio@10': 0.8066, 'ndcg@10': 0.8442, 'compress@10': 1.0, 'time@10': 3.1576}:  53%|█████▎    | 16/30 [00:36<00:22,  1.63s/it]{'epoch': 6, 'num_users': 5.8235, 'loss': 0.0508, 'hit_ratio@10': 0.8066, 'ndcg@10': 0.8442, 'compress@10': 1.0, 'time@10': 3.1576}:  57%|█████▋    | 17/30 [00:36<00:16,  1.25s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.0513, 'hit_ratio@10': 0.8034, 'ndcg@10': 0.8447, 'compress@10': 1.0, 'time@10': 3.1136}:  57%|█████▋    | 17/30 [00:38<00:16,  1.25s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.0513, 'hit_ratio@10': 0.8034, 'ndcg@10': 0.8447, 'compress@10': 1.0, 'time@10': 3.1136}:  60%|██████    | 18/30 [00:38<00:19,  1.60s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.0495, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.8476, 'compress@10': 1.0, 'time@10': 3.0642}:  60%|██████    | 18/30 [00:39<00:19,  1.60s/it]   {'epoch': 6, 'num_users': 6.0, 'loss': 0.0495, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.8476, 'compress@10': 1.0, 'time@10': 3.0642}:  63%|██████▎   | 19/30 [00:39<00:15,  1.45s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.0497, 'hit_ratio@10': 0.8107, 'ndcg@10': 0.8472, 'compress@10': 1.0, 'time@10': 3.151}:  63%|██████▎   | 19/30 [00:44<00:15,  1.45s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.0497, 'hit_ratio@10': 0.8107, 'ndcg@10': 0.8472, 'compress@10': 1.0, 'time@10': 3.151}:  67%|██████▋   | 20/30 [00:44<00:24,  2.47s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0506, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 3.3194}:  67%|██████▋   | 20/30 [00:47<00:24,  2.47s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0506, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 3.3194}:  70%|███████   | 21/30 [00:47<00:24,  2.74s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.0505, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8485, 'compress@10': 1.0, 'time@10': 3.2488}:  70%|███████   | 21/30 [00:49<00:24,  2.74s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.0505, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8485, 'compress@10': 1.0, 'time@10': 3.2488}:  73%|███████▎  | 22/30 [00:49<00:19,  2.46s/it]{'epoch': 6, 'num_users': 6.1304, 'loss': 0.0494, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 3.2386}:  73%|███████▎  | 22/30 [00:51<00:19,  2.46s/it] {'epoch': 6, 'num_users': 6.1304, 'loss': 0.0494, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 3.2386}:  77%|███████▋  | 23/30 [00:51<00:15,  2.19s/it]{'epoch': 6, 'num_users': 5.9583, 'loss': 0.05, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 3.12}:  77%|███████▋  | 23/30 [00:51<00:15,  2.19s/it]   {'epoch': 6, 'num_users': 5.9583, 'loss': 0.05, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 3.12}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0508, 'hit_ratio@10': 0.8076, 'ndcg@10': 0.8232, 'compress@10': 1.0, 'time@10': 3.0079}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0508, 'hit_ratio@10': 0.8076, 'ndcg@10': 0.8232, 'compress@10': 1.0, 'time@10': 3.0079}:  83%|████████▎ | 25/30 [00:51<00:06,  1.22s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.0508, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8241, 'compress@10': 1.0, 'time@10': 3.1512}:  83%|████████▎ | 25/30 [00:58<00:06,  1.22s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.0508, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8241, 'compress@10': 1.0, 'time@10': 3.1512}:  87%|████████▋ | 26/30 [00:58<00:11,  2.89s/it]{'epoch': 6, 'num_users': 5.8889, 'loss': 0.0501, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8264, 'compress@10': 1.0, 'time@10': 3.2077}:  87%|████████▋ | 26/30 [01:01<00:11,  2.89s/it]{'epoch': 6, 'num_users': 5.8889, 'loss': 0.0501, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8264, 'compress@10': 1.0, 'time@10': 3.2077}:  90%|█████████ | 27/30 [01:01<00:08,  2.73s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.0502, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8278, 'compress@10': 1.0, 'time@10': 3.2426}:  90%|█████████ | 27/30 [01:05<00:08,  2.73s/it]   {'epoch': 6, 'num_users': 6.0, 'loss': 0.0502, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8278, 'compress@10': 1.0, 'time@10': 3.2426}:  93%|█████████▎| 28/30 [01:05<00:06,  3.18s/it]{'epoch': 6, 'num_users': 5.8621, 'loss': 0.0494, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8294, 'compress@10': 1.0, 'time@10': 3.2374}:  93%|█████████▎| 28/30 [01:06<00:06,  3.18s/it]{'epoch': 6, 'num_users': 5.8621, 'loss': 0.0494, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8294, 'compress@10': 1.0, 'time@10': 3.2374}:  97%|█████████▋| 29/30 [01:06<00:02,  2.70s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0492, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8314, 'compress@10': 1.0, 'time@10': 3.2249}:  97%|█████████▋| 29/30 [01:09<00:02,  2.70s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0492, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8314, 'compress@10': 1.0, 'time@10': 3.2249}: 100%|██████████| 30/30 [01:09<00:00,  2.76s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0492, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8314, 'compress@10': 1.0, 'time@10': 3.2249}: 100%|██████████| 30/30 [01:09<00:00,  2.33s/it]
Epoch: 6
Avg # of users: 5.866666666666666
Avg Loss: 0.049186876293633976
Avg hit ratio: 0.8174511240202429
Avg ndcg: 0.8314420864375577
Avg compression ratio: 0.9999999860153537
Avg train time: 3.224858458836873
Std train time: 2.021957581366908
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 3.1128}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 3.1128}:   3%|▎         | 1/30 [00:01<00:46,  1.59s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8482, 'compress@10': 1.0, 'time@10': 2.7668}:   3%|▎         | 1/30 [00:04<00:46,  1.59s/it] {'epoch': 7, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8482, 'compress@10': 1.0, 'time@10': 2.7668}:   7%|▋         | 2/30 [00:04<00:58,  2.10s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 2.1557}:   7%|▋         | 2/30 [00:04<00:58,  2.10s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 2.1557}:  10%|█         | 3/30 [00:04<00:37,  1.38s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0415, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.1669}:  10%|█         | 3/30 [00:06<00:37,  1.38s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0415, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.1669}:  13%|█▎        | 4/30 [00:06<00:44,  1.72s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8483, 'compress@10': 1.0, 'time@10': 3.4902}:  13%|█▎        | 4/30 [00:11<00:44,  1.72s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8483, 'compress@10': 1.0, 'time@10': 3.4902}:  17%|█▋        | 5/30 [00:11<01:07,  2.70s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0499, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8444, 'compress@10': 1.0, 'time@10': 3.5451}:  17%|█▋        | 5/30 [00:15<01:07,  2.70s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0499, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8444, 'compress@10': 1.0, 'time@10': 3.5451}:  20%|██        | 6/30 [00:15<01:14,  3.09s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0492, 'hit_ratio@10': 0.8057, 'ndcg@10': 0.8494, 'compress@10': 1.0, 'time@10': 3.6251}:  20%|██        | 6/30 [00:17<01:14,  3.09s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0492, 'hit_ratio@10': 0.8057, 'ndcg@10': 0.8494, 'compress@10': 1.0, 'time@10': 3.6251}:  23%|██▎       | 7/30 [00:17<01:03,  2.76s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0502, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8588, 'compress@10': 1.0, 'time@10': 3.5291}:  23%|██▎       | 7/30 [00:20<01:03,  2.76s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0502, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8588, 'compress@10': 1.0, 'time@10': 3.5291}:  27%|██▋       | 8/30 [00:20<01:01,  2.80s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.053, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8594, 'compress@10': 1.0, 'time@10': 3.7913}:  27%|██▋       | 8/30 [00:23<01:01,  2.80s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.053, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8594, 'compress@10': 1.0, 'time@10': 3.7913}:  30%|███       | 9/30 [00:23<01:00,  2.86s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0528, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 3.7767}:  30%|███       | 9/30 [00:26<01:00,  2.86s/it]  {'epoch': 7, 'num_users': 6.3, 'loss': 0.0528, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 3.7767}:  33%|███▎      | 10/30 [00:26<01:02,  3.11s/it]{'epoch': 7, 'num_users': 6.6364, 'loss': 0.0535, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8576, 'compress@10': 1.0, 'time@10': 3.8338}:  33%|███▎      | 10/30 [00:28<01:02,  3.11s/it]{'epoch': 7, 'num_users': 6.6364, 'loss': 0.0535, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8576, 'compress@10': 1.0, 'time@10': 3.8338}:  37%|███▋      | 11/30 [00:28<00:54,  2.85s/it]{'epoch': 7, 'num_users': 6.4167, 'loss': 0.0508, 'hit_ratio@10': 0.8064, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 3.5898}:  37%|███▋      | 11/30 [00:29<00:54,  2.85s/it]{'epoch': 7, 'num_users': 6.4167, 'loss': 0.0508, 'hit_ratio@10': 0.8064, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 3.5898}:  40%|████      | 12/30 [00:29<00:40,  2.27s/it]{'epoch': 7, 'num_users': 6.6154, 'loss': 0.0513, 'hit_ratio@10': 0.8108, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 3.5936}:  40%|████      | 12/30 [00:31<00:40,  2.27s/it]{'epoch': 7, 'num_users': 6.6154, 'loss': 0.0513, 'hit_ratio@10': 0.8108, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 3.5936}:  43%|████▎     | 13/30 [00:31<00:36,  2.14s/it]{'epoch': 7, 'num_users': 6.3571, 'loss': 0.0508, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 3.3671}:  43%|████▎     | 13/30 [00:32<00:36,  2.14s/it]{'epoch': 7, 'num_users': 6.3571, 'loss': 0.0508, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 3.3671}:  47%|████▋     | 14/30 [00:32<00:26,  1.63s/it]{'epoch': 7, 'num_users': 6.2667, 'loss': 0.0524, 'hit_ratio@10': 0.8095, 'ndcg@10': 0.8618, 'compress@10': 1.0, 'time@10': 3.4744}:  47%|████▋     | 14/30 [00:34<00:26,  1.63s/it]{'epoch': 7, 'num_users': 6.2667, 'loss': 0.0524, 'hit_ratio@10': 0.8095, 'ndcg@10': 0.8618, 'compress@10': 1.0, 'time@10': 3.4744}:  50%|█████     | 15/30 [00:34<00:28,  1.90s/it]{'epoch': 7, 'num_users': 6.0625, 'loss': 0.0502, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 3.3146}:  50%|█████     | 15/30 [00:35<00:28,  1.90s/it]{'epoch': 7, 'num_users': 6.0625, 'loss': 0.0502, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 3.3146}:  53%|█████▎    | 16/30 [00:35<00:22,  1.62s/it]{'epoch': 7, 'num_users': 5.8235, 'loss': 0.0494, 'hit_ratio@10': 0.8035, 'ndcg@10': 0.853, 'compress@10': 1.0, 'time@10': 3.1575}:  53%|█████▎    | 16/30 [00:36<00:22,  1.62s/it] {'epoch': 7, 'num_users': 5.8235, 'loss': 0.0494, 'hit_ratio@10': 0.8035, 'ndcg@10': 0.853, 'compress@10': 1.0, 'time@10': 3.1575}:  57%|█████▋    | 17/30 [00:36<00:16,  1.24s/it]{'epoch': 7, 'num_users': 6.0556, 'loss': 0.0499, 'hit_ratio@10': 0.8025, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 3.1112}:  57%|█████▋    | 17/30 [00:38<00:16,  1.24s/it]{'epoch': 7, 'num_users': 6.0556, 'loss': 0.0499, 'hit_ratio@10': 0.8025, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 3.1112}:  60%|██████    | 18/30 [00:38<00:18,  1.58s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.0482, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.8553, 'compress@10': 1.0, 'time@10': 3.0617}:  60%|██████    | 18/30 [00:39<00:18,  1.58s/it]   {'epoch': 7, 'num_users': 6.0, 'loss': 0.0482, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.8553, 'compress@10': 1.0, 'time@10': 3.0617}:  63%|██████▎   | 19/30 [00:39<00:15,  1.44s/it]{'epoch': 7, 'num_users': 6.15, 'loss': 0.0483, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 3.1532}:  63%|██████▎   | 19/30 [00:44<00:15,  1.44s/it]{'epoch': 7, 'num_users': 6.15, 'loss': 0.0483, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 3.1532}:  67%|██████▋   | 20/30 [00:44<00:24,  2.49s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0492, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8533, 'compress@10': 1.0, 'time@10': 3.3274}:  67%|██████▋   | 20/30 [00:47<00:24,  2.49s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0492, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8533, 'compress@10': 1.0, 'time@10': 3.3274}:  70%|███████   | 21/30 [00:47<00:24,  2.78s/it]{'epoch': 7, 'num_users': 6.1818, 'loss': 0.049, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8557, 'compress@10': 1.0, 'time@10': 3.2545}:  70%|███████   | 21/30 [00:49<00:24,  2.78s/it] {'epoch': 7, 'num_users': 6.1818, 'loss': 0.049, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8557, 'compress@10': 1.0, 'time@10': 3.2545}:  73%|███████▎  | 22/30 [00:49<00:19,  2.47s/it]{'epoch': 7, 'num_users': 6.1304, 'loss': 0.048, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 3.2505}:  73%|███████▎  | 22/30 [00:51<00:19,  2.47s/it]{'epoch': 7, 'num_users': 6.1304, 'loss': 0.048, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 3.2505}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it]{'epoch': 7, 'num_users': 5.9583, 'loss': 0.0486, 'hit_ratio@10': 0.8128, 'ndcg@10': 0.8455, 'compress@10': 1.0, 'time@10': 3.1285}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it]{'epoch': 7, 'num_users': 5.9583, 'loss': 0.0486, 'hit_ratio@10': 0.8128, 'ndcg@10': 0.8455, 'compress@10': 1.0, 'time@10': 3.1285}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0493, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8292, 'compress@10': 1.0, 'time@10': 3.0163}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]   {'epoch': 7, 'num_users': 5.8, 'loss': 0.0493, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8292, 'compress@10': 1.0, 'time@10': 3.0163}:  83%|████████▎ | 25/30 [00:51<00:06,  1.22s/it]{'epoch': 7, 'num_users': 5.8077, 'loss': 0.0492, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8302, 'compress@10': 1.0, 'time@10': 3.1597}:  83%|████████▎ | 25/30 [00:58<00:06,  1.22s/it]{'epoch': 7, 'num_users': 5.8077, 'loss': 0.0492, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8302, 'compress@10': 1.0, 'time@10': 3.1597}:  87%|████████▋ | 26/30 [00:58<00:11,  2.89s/it]{'epoch': 7, 'num_users': 5.8889, 'loss': 0.0489, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.832, 'compress@10': 1.0, 'time@10': 3.23}:  87%|████████▋ | 26/30 [01:01<00:11,  2.89s/it]   {'epoch': 7, 'num_users': 5.8889, 'loss': 0.0489, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.832, 'compress@10': 1.0, 'time@10': 3.23}:  90%|█████████ | 27/30 [01:01<00:08,  2.79s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.049, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8329, 'compress@10': 1.0, 'time@10': 3.2691}:  90%|█████████ | 27/30 [01:05<00:08,  2.79s/it] {'epoch': 7, 'num_users': 6.0, 'loss': 0.049, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8329, 'compress@10': 1.0, 'time@10': 3.2691}:  93%|█████████▎| 28/30 [01:05<00:06,  3.30s/it]{'epoch': 7, 'num_users': 5.8621, 'loss': 0.0487, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8348, 'compress@10': 1.0, 'time@10': 3.2764}:  93%|█████████▎| 28/30 [01:07<00:06,  3.30s/it]{'epoch': 7, 'num_users': 5.8621, 'loss': 0.0487, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8348, 'compress@10': 1.0, 'time@10': 3.2764}:  97%|█████████▋| 29/30 [01:07<00:02,  2.85s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0485, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8367, 'compress@10': 1.0, 'time@10': 3.2703}:  97%|█████████▋| 29/30 [01:10<00:02,  2.85s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0485, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8367, 'compress@10': 1.0, 'time@10': 3.2703}: 100%|██████████| 30/30 [01:10<00:00,  2.93s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0485, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8367, 'compress@10': 1.0, 'time@10': 3.2703}: 100%|██████████| 30/30 [01:10<00:00,  2.35s/it]
Epoch: 7
Avg # of users: 5.866666666666666
Avg Loss: 0.04853643037844621
Avg hit ratio: 0.818076476915138
Avg ndcg: 0.8367089428917396
Avg compression ratio: 0.9999999860153537
Avg train time: 3.270292218526204
Std train time: 2.080861431786134
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0526, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8303, 'compress@10': 1.0, 'time@10': 3.0245}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0526, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8303, 'compress@10': 1.0, 'time@10': 3.0245}:   3%|▎         | 1/30 [00:01<00:44,  1.55s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8396, 'compress@10': 1.0, 'time@10': 2.767}:   3%|▎         | 1/30 [00:04<00:44,  1.55s/it] {'epoch': 8, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8396, 'compress@10': 1.0, 'time@10': 2.767}:   7%|▋         | 2/30 [00:04<00:59,  2.14s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8433, 'compress@10': 1.0, 'time@10': 2.1735}:   7%|▋         | 2/30 [00:04<00:59,  2.14s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8433, 'compress@10': 1.0, 'time@10': 2.1735}:  10%|█         | 3/30 [00:04<00:37,  1.40s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.042, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8309, 'compress@10': 1.0, 'time@10': 2.1934}:  10%|█         | 3/30 [00:06<00:37,  1.40s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.042, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8309, 'compress@10': 1.0, 'time@10': 2.1934}:  13%|█▎        | 4/30 [00:06<00:45,  1.75s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0469, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.827, 'compress@10': 1.0, 'time@10': 3.4889}:  13%|█▎        | 4/30 [00:11<00:45,  1.75s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0469, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.827, 'compress@10': 1.0, 'time@10': 3.4889}:  17%|█▋        | 5/30 [00:11<01:07,  2.70s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0492, 'hit_ratio@10': 0.7854, 'ndcg@10': 0.8277, 'compress@10': 1.0, 'time@10': 3.5365}:  17%|█▋        | 5/30 [00:15<01:07,  2.70s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0492, 'hit_ratio@10': 0.7854, 'ndcg@10': 0.8277, 'compress@10': 1.0, 'time@10': 3.5365}:  20%|██        | 6/30 [00:15<01:13,  3.08s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0493, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.8281, 'compress@10': 1.0, 'time@10': 3.5739}:  20%|██        | 6/30 [00:17<01:13,  3.08s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0493, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.8281, 'compress@10': 1.0, 'time@10': 3.5739}:  23%|██▎       | 7/30 [00:17<01:02,  2.70s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0498, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8439, 'compress@10': 1.0, 'time@10': 3.4559}:  23%|██▎       | 7/30 [00:19<01:02,  2.70s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0498, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8439, 'compress@10': 1.0, 'time@10': 3.4559}:  27%|██▋       | 8/30 [00:19<00:59,  2.69s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0506, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8446, 'compress@10': 1.0, 'time@10': 3.7067}:  27%|██▋       | 8/30 [00:22<00:59,  2.69s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0506, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8446, 'compress@10': 1.0, 'time@10': 3.7067}:  30%|███       | 9/30 [00:22<00:57,  2.76s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0496, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8458, 'compress@10': 1.0, 'time@10': 3.7137}:  30%|███       | 9/30 [00:26<00:57,  2.76s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0496, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8458, 'compress@10': 1.0, 'time@10': 3.7137}:  33%|███▎      | 10/30 [00:26<01:01,  3.08s/it]{'epoch': 8, 'num_users': 6.6364, 'loss': 0.0506, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8474, 'compress@10': 1.0, 'time@10': 3.7779}:  33%|███▎      | 10/30 [00:28<01:01,  3.08s/it]{'epoch': 8, 'num_users': 6.6364, 'loss': 0.0506, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8474, 'compress@10': 1.0, 'time@10': 3.7779}:  37%|███▋      | 11/30 [00:28<00:53,  2.83s/it]{'epoch': 8, 'num_users': 6.4167, 'loss': 0.0482, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 3.5387}:  37%|███▋      | 11/30 [00:29<00:53,  2.83s/it]{'epoch': 8, 'num_users': 6.4167, 'loss': 0.0482, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 3.5387}:  40%|████      | 12/30 [00:29<00:40,  2.25s/it]{'epoch': 8, 'num_users': 6.6154, 'loss': 0.0488, 'hit_ratio@10': 0.8089, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 3.5478}:  40%|████      | 12/30 [00:31<00:40,  2.25s/it]{'epoch': 8, 'num_users': 6.6154, 'loss': 0.0488, 'hit_ratio@10': 0.8089, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 3.5478}:  43%|████▎     | 13/30 [00:31<00:36,  2.14s/it]{'epoch': 8, 'num_users': 6.3571, 'loss': 0.0484, 'hit_ratio@10': 0.7988, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 3.3237}:  43%|████▎     | 13/30 [00:31<00:36,  2.14s/it]{'epoch': 8, 'num_users': 6.3571, 'loss': 0.0484, 'hit_ratio@10': 0.7988, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 3.3237}:  47%|████▋     | 14/30 [00:31<00:26,  1.63s/it]{'epoch': 8, 'num_users': 6.2667, 'loss': 0.0495, 'hit_ratio@10': 0.8079, 'ndcg@10': 0.8537, 'compress@10': 1.0, 'time@10': 3.4378}:  47%|████▋     | 14/30 [00:34<00:26,  1.63s/it]{'epoch': 8, 'num_users': 6.2667, 'loss': 0.0495, 'hit_ratio@10': 0.8079, 'ndcg@10': 0.8537, 'compress@10': 1.0, 'time@10': 3.4378}:  50%|█████     | 15/30 [00:34<00:28,  1.91s/it]{'epoch': 8, 'num_users': 6.0625, 'loss': 0.0474, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 3.279}:  50%|█████     | 15/30 [00:35<00:28,  1.91s/it]  {'epoch': 8, 'num_users': 6.0625, 'loss': 0.0474, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 3.279}:  53%|█████▎    | 16/30 [00:35<00:22,  1.61s/it]{'epoch': 8, 'num_users': 5.8235, 'loss': 0.0467, 'hit_ratio@10': 0.8021, 'ndcg@10': 0.8469, 'compress@10': 1.0, 'time@10': 3.1242}:  53%|█████▎    | 16/30 [00:35<00:22,  1.61s/it]{'epoch': 8, 'num_users': 5.8235, 'loss': 0.0467, 'hit_ratio@10': 0.8021, 'ndcg@10': 0.8469, 'compress@10': 1.0, 'time@10': 3.1242}:  57%|█████▋    | 17/30 [00:35<00:16,  1.24s/it]{'epoch': 8, 'num_users': 6.0556, 'loss': 0.0473, 'hit_ratio@10': 0.8011, 'ndcg@10': 0.8475, 'compress@10': 1.0, 'time@10': 3.0839}:  57%|█████▋    | 17/30 [00:38<00:16,  1.24s/it]{'epoch': 8, 'num_users': 6.0556, 'loss': 0.0473, 'hit_ratio@10': 0.8011, 'ndcg@10': 0.8475, 'compress@10': 1.0, 'time@10': 3.0839}:  60%|██████    | 18/30 [00:38<00:19,  1.60s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.0457, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.85, 'compress@10': 1.0, 'time@10': 3.0374}:  60%|██████    | 18/30 [00:39<00:19,  1.60s/it]     {'epoch': 8, 'num_users': 6.0, 'loss': 0.0457, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.85, 'compress@10': 1.0, 'time@10': 3.0374}:  63%|██████▎   | 19/30 [00:39<00:16,  1.46s/it]{'epoch': 8, 'num_users': 6.15, 'loss': 0.0458, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 3.1264}:  63%|██████▎   | 19/30 [00:44<00:16,  1.46s/it]{'epoch': 8, 'num_users': 6.15, 'loss': 0.0458, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 3.1264}:  67%|██████▋   | 20/30 [00:44<00:24,  2.48s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0468, 'hit_ratio@10': 0.8082, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 3.3045}:  67%|██████▋   | 20/30 [00:47<00:24,  2.48s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0468, 'hit_ratio@10': 0.8082, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 3.3045}:  70%|███████   | 21/30 [00:47<00:24,  2.78s/it]{'epoch': 8, 'num_users': 6.1818, 'loss': 0.0466, 'hit_ratio@10': 0.8128, 'ndcg@10': 0.8513, 'compress@10': 1.0, 'time@10': 3.2316}:  70%|███████   | 21/30 [00:49<00:24,  2.78s/it]{'epoch': 8, 'num_users': 6.1818, 'loss': 0.0466, 'hit_ratio@10': 0.8128, 'ndcg@10': 0.8513, 'compress@10': 1.0, 'time@10': 3.2316}:  73%|███████▎  | 22/30 [00:49<00:19,  2.46s/it]{'epoch': 8, 'num_users': 6.1304, 'loss': 0.0458, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 3.2304}:  73%|███████▎  | 22/30 [00:51<00:19,  2.46s/it]{'epoch': 8, 'num_users': 6.1304, 'loss': 0.0458, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 3.2304}:  77%|███████▋  | 23/30 [00:51<00:15,  2.22s/it]{'epoch': 8, 'num_users': 5.9583, 'loss': 0.0464, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.8418, 'compress@10': 1.0, 'time@10': 3.1093}:  77%|███████▋  | 23/30 [00:51<00:15,  2.22s/it]{'epoch': 8, 'num_users': 5.9583, 'loss': 0.0464, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.8418, 'compress@10': 1.0, 'time@10': 3.1093}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.8257, 'compress@10': 1.0, 'time@10': 2.9994}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]   {'epoch': 8, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.8257, 'compress@10': 1.0, 'time@10': 2.9994}:  83%|████████▎ | 25/30 [00:51<00:06,  1.23s/it]{'epoch': 8, 'num_users': 5.8077, 'loss': 0.047, 'hit_ratio@10': 0.8106, 'ndcg@10': 0.8272, 'compress@10': 1.0, 'time@10': 3.1489}:  83%|████████▎ | 25/30 [00:58<00:06,  1.23s/it]{'epoch': 8, 'num_users': 5.8077, 'loss': 0.047, 'hit_ratio@10': 0.8106, 'ndcg@10': 0.8272, 'compress@10': 1.0, 'time@10': 3.1489}:  87%|████████▋ | 26/30 [00:58<00:11,  2.94s/it]{'epoch': 8, 'num_users': 5.8889, 'loss': 0.0474, 'hit_ratio@10': 0.8136, 'ndcg@10': 0.8319, 'compress@10': 1.0, 'time@10': 3.2052}:  87%|████████▋ | 26/30 [01:00<00:11,  2.94s/it]{'epoch': 8, 'num_users': 5.8889, 'loss': 0.0474, 'hit_ratio@10': 0.8136, 'ndcg@10': 0.8319, 'compress@10': 1.0, 'time@10': 3.2052}:  90%|█████████ | 27/30 [01:00<00:08,  2.77s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.0475, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8328, 'compress@10': 1.0, 'time@10': 3.2465}:  90%|█████████ | 27/30 [01:05<00:08,  2.77s/it]   {'epoch': 8, 'num_users': 6.0, 'loss': 0.0475, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8328, 'compress@10': 1.0, 'time@10': 3.2465}:  93%|█████████▎| 28/30 [01:05<00:06,  3.26s/it]{'epoch': 8, 'num_users': 5.8621, 'loss': 0.0468, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8349, 'compress@10': 1.0, 'time@10': 3.2534}:  93%|█████████▎| 28/30 [01:07<00:06,  3.26s/it]{'epoch': 8, 'num_users': 5.8621, 'loss': 0.0468, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8349, 'compress@10': 1.0, 'time@10': 3.2534}:  97%|█████████▋| 29/30 [01:07<00:02,  2.81s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0467, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.8369, 'compress@10': 1.0, 'time@10': 3.2458}:  97%|█████████▋| 29/30 [01:10<00:02,  2.81s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0467, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.8369, 'compress@10': 1.0, 'time@10': 3.2458}: 100%|██████████| 30/30 [01:10<00:00,  2.89s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0467, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.8369, 'compress@10': 1.0, 'time@10': 3.2458}: 100%|██████████| 30/30 [01:10<00:00,  2.34s/it]
Epoch: 8
Avg # of users: 5.866666666666666
Avg Loss: 0.0466808178541863
Avg hit ratio: 0.8155621108012439
Avg ndcg: 0.8369102814749431
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2458358923594157
Std train time: 2.0592386913422596
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 3.0579}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 3.0579}:   3%|▎         | 1/30 [00:01<00:45,  1.57s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 2.8092}:   3%|▎         | 1/30 [00:04<00:45,  1.57s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 2.8092}:   7%|▋         | 2/30 [00:04<01:00,  2.17s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0322, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 2.2017}:   7%|▋         | 2/30 [00:04<01:00,  2.17s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0322, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 2.2017}:  10%|█         | 3/30 [00:04<00:38,  1.42s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8448, 'compress@10': 1.0, 'time@10': 2.2208}:  10%|█         | 3/30 [00:07<00:38,  1.42s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8448, 'compress@10': 1.0, 'time@10': 2.2208}:  13%|█▎        | 4/30 [00:07<00:46,  1.77s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0427, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8383, 'compress@10': 1.0, 'time@10': 3.4743}:  13%|█▎        | 4/30 [00:11<00:46,  1.77s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0427, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8383, 'compress@10': 1.0, 'time@10': 3.4743}:  17%|█▋        | 5/30 [00:11<01:06,  2.68s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0453, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8384, 'compress@10': 1.0, 'time@10': 3.4963}:  17%|█▋        | 5/30 [00:14<01:06,  2.68s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0453, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8384, 'compress@10': 1.0, 'time@10': 3.4963}:  20%|██        | 6/30 [00:14<01:12,  3.01s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0471, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8437, 'compress@10': 1.0, 'time@10': 3.5483}:  20%|██        | 6/30 [00:16<01:12,  3.01s/it] {'epoch': 9, 'num_users': 6.2857, 'loss': 0.0471, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8437, 'compress@10': 1.0, 'time@10': 3.5483}:  23%|██▎       | 7/30 [00:16<01:01,  2.67s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0472, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8576, 'compress@10': 1.0, 'time@10': 3.4498}:  23%|██▎       | 7/30 [00:19<01:01,  2.67s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0472, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8576, 'compress@10': 1.0, 'time@10': 3.4498}:  27%|██▋       | 8/30 [00:19<00:59,  2.71s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0487, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 3.6966}:  27%|██▋       | 8/30 [00:22<00:59,  2.71s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0487, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 3.6966}:  30%|███       | 9/30 [00:22<00:57,  2.76s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0485, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8568, 'compress@10': 1.0, 'time@10': 3.6875}:  30%|███       | 9/30 [00:26<00:57,  2.76s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0485, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8568, 'compress@10': 1.0, 'time@10': 3.6875}:  33%|███▎      | 10/30 [00:26<01:00,  3.03s/it]{'epoch': 9, 'num_users': 6.6364, 'loss': 0.0497, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 3.7523}:  33%|███▎      | 10/30 [00:28<01:00,  3.03s/it]{'epoch': 9, 'num_users': 6.6364, 'loss': 0.0497, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 3.7523}:  37%|███▋      | 11/30 [00:28<00:52,  2.79s/it]{'epoch': 9, 'num_users': 6.4167, 'loss': 0.0473, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8623, 'compress@10': 1.0, 'time@10': 3.516}:  37%|███▋      | 11/30 [00:29<00:52,  2.79s/it] {'epoch': 9, 'num_users': 6.4167, 'loss': 0.0473, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8623, 'compress@10': 1.0, 'time@10': 3.516}:  40%|████      | 12/30 [00:29<00:40,  2.23s/it]{'epoch': 9, 'num_users': 6.6154, 'loss': 0.048, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8644, 'compress@10': 1.0, 'time@10': 3.5231}:  40%|████      | 12/30 [00:31<00:40,  2.23s/it]{'epoch': 9, 'num_users': 6.6154, 'loss': 0.048, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8644, 'compress@10': 1.0, 'time@10': 3.5231}:  43%|████▎     | 13/30 [00:31<00:35,  2.11s/it]{'epoch': 9, 'num_users': 6.3571, 'loss': 0.0476, 'hit_ratio@10': 0.8168, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 3.3003}:  43%|████▎     | 13/30 [00:31<00:35,  2.11s/it]{'epoch': 9, 'num_users': 6.3571, 'loss': 0.0476, 'hit_ratio@10': 0.8168, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 3.3003}:  47%|████▋     | 14/30 [00:31<00:25,  1.61s/it]{'epoch': 9, 'num_users': 6.2667, 'loss': 0.0479, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8591, 'compress@10': 1.0, 'time@10': 3.4155}:  47%|████▋     | 14/30 [00:34<00:25,  1.61s/it]{'epoch': 9, 'num_users': 6.2667, 'loss': 0.0479, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8591, 'compress@10': 1.0, 'time@10': 3.4155}:  50%|█████     | 15/30 [00:34<00:28,  1.90s/it]{'epoch': 9, 'num_users': 6.0625, 'loss': 0.0459, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8601, 'compress@10': 1.0, 'time@10': 3.2581}:  50%|█████     | 15/30 [00:35<00:28,  1.90s/it]{'epoch': 9, 'num_users': 6.0625, 'loss': 0.0459, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8601, 'compress@10': 1.0, 'time@10': 3.2581}:  53%|█████▎    | 16/30 [00:35<00:22,  1.61s/it]{'epoch': 9, 'num_users': 5.8235, 'loss': 0.0453, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8517, 'compress@10': 1.0, 'time@10': 3.1049}:  53%|█████▎    | 16/30 [00:35<00:22,  1.61s/it] {'epoch': 9, 'num_users': 5.8235, 'loss': 0.0453, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8517, 'compress@10': 1.0, 'time@10': 3.1049}:  57%|█████▋    | 17/30 [00:35<00:16,  1.23s/it]{'epoch': 9, 'num_users': 6.0556, 'loss': 0.0459, 'hit_ratio@10': 0.8105, 'ndcg@10': 0.8519, 'compress@10': 1.0, 'time@10': 3.0709}:  57%|█████▋    | 17/30 [00:38<00:16,  1.23s/it]{'epoch': 9, 'num_users': 6.0556, 'loss': 0.0459, 'hit_ratio@10': 0.8105, 'ndcg@10': 0.8519, 'compress@10': 1.0, 'time@10': 3.0709}:  60%|██████    | 18/30 [00:38<00:19,  1.62s/it]{'epoch': 9, 'num_users': 6.0, 'loss': 0.0444, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8542, 'compress@10': 1.0, 'time@10': 3.0234}:  60%|██████    | 18/30 [00:39<00:19,  1.62s/it]    {'epoch': 9, 'num_users': 6.0, 'loss': 0.0444, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8542, 'compress@10': 1.0, 'time@10': 3.0234}:  63%|██████▎   | 19/30 [00:39<00:16,  1.47s/it]{'epoch': 9, 'num_users': 6.15, 'loss': 0.0444, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.8544, 'compress@10': 1.0, 'time@10': 3.1004}:  63%|██████▎   | 19/30 [00:43<00:16,  1.47s/it]{'epoch': 9, 'num_users': 6.15, 'loss': 0.0444, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.8544, 'compress@10': 1.0, 'time@10': 3.1004}:  67%|██████▋   | 20/30 [00:43<00:24,  2.41s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0454, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8532, 'compress@10': 1.0, 'time@10': 3.2592}:  67%|██████▋   | 20/30 [00:47<00:24,  2.41s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0454, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8532, 'compress@10': 1.0, 'time@10': 3.2592}:  70%|███████   | 21/30 [00:47<00:23,  2.66s/it]{'epoch': 9, 'num_users': 6.1818, 'loss': 0.0451, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8549, 'compress@10': 1.0, 'time@10': 3.1892}:  70%|███████   | 21/30 [00:48<00:23,  2.66s/it]{'epoch': 9, 'num_users': 6.1818, 'loss': 0.0451, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8549, 'compress@10': 1.0, 'time@10': 3.1892}:  73%|███████▎  | 22/30 [00:48<00:19,  2.39s/it]{'epoch': 9, 'num_users': 6.1304, 'loss': 0.0444, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8569, 'compress@10': 1.0, 'time@10': 3.1906}:  73%|███████▎  | 22/30 [00:50<00:19,  2.39s/it]{'epoch': 9, 'num_users': 6.1304, 'loss': 0.0444, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8569, 'compress@10': 1.0, 'time@10': 3.1906}:  77%|███████▋  | 23/30 [00:50<00:15,  2.17s/it]{'epoch': 9, 'num_users': 5.9583, 'loss': 0.0451, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.8452, 'compress@10': 1.0, 'time@10': 3.0714}:  77%|███████▋  | 23/30 [00:50<00:15,  2.17s/it]{'epoch': 9, 'num_users': 5.9583, 'loss': 0.0451, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.8452, 'compress@10': 1.0, 'time@10': 3.0714}:  80%|████████  | 24/30 [00:50<00:09,  1.63s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8289, 'compress@10': 1.0, 'time@10': 2.962}:  80%|████████  | 24/30 [00:51<00:09,  1.63s/it]    {'epoch': 9, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8289, 'compress@10': 1.0, 'time@10': 2.962}:  83%|████████▎ | 25/30 [00:51<00:06,  1.20s/it]{'epoch': 9, 'num_users': 5.8077, 'loss': 0.0456, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8309, 'compress@10': 1.0, 'time@10': 3.1072}:  83%|████████▎ | 25/30 [00:57<00:06,  1.20s/it]{'epoch': 9, 'num_users': 5.8077, 'loss': 0.0456, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8309, 'compress@10': 1.0, 'time@10': 3.1072}:  87%|████████▋ | 26/30 [00:57<00:11,  2.87s/it]{'epoch': 9, 'num_users': 5.8889, 'loss': 0.0458, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8371, 'compress@10': 1.0, 'time@10': 3.1641}:  87%|████████▋ | 26/30 [01:00<00:11,  2.87s/it]{'epoch': 9, 'num_users': 5.8889, 'loss': 0.0458, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8371, 'compress@10': 1.0, 'time@10': 3.1641}:  90%|█████████ | 27/30 [01:00<00:08,  2.72s/it]{'epoch': 9, 'num_users': 6.0, 'loss': 0.046, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8379, 'compress@10': 1.0, 'time@10': 3.2071}:  90%|█████████ | 27/30 [01:04<00:08,  2.72s/it]     {'epoch': 9, 'num_users': 6.0, 'loss': 0.046, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8379, 'compress@10': 1.0, 'time@10': 3.2071}:  93%|█████████▎| 28/30 [01:04<00:06,  3.22s/it]{'epoch': 9, 'num_users': 5.8621, 'loss': 0.0454, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8398, 'compress@10': 1.0, 'time@10': 3.2157}:  93%|█████████▎| 28/30 [01:06<00:06,  3.22s/it]{'epoch': 9, 'num_users': 5.8621, 'loss': 0.0454, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8398, 'compress@10': 1.0, 'time@10': 3.2157}:  97%|█████████▋| 29/30 [01:06<00:02,  2.79s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0453, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8417, 'compress@10': 1.0, 'time@10': 3.211}:  97%|█████████▋| 29/30 [01:09<00:02,  2.79s/it] {'epoch': 9, 'num_users': 5.8667, 'loss': 0.0453, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8417, 'compress@10': 1.0, 'time@10': 3.211}: 100%|██████████| 30/30 [01:09<00:00,  2.88s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0453, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8417, 'compress@10': 1.0, 'time@10': 3.211}: 100%|██████████| 30/30 [01:09<00:00,  2.32s/it]
Epoch: 9
Avg # of users: 5.866666666666666
Avg Loss: 0.04534452295512817
Avg hit ratio: 0.828344237241907
Avg ndcg: 0.841728264908482
Avg compression ratio: 0.9999999860153537
Avg train time: 3.210971641540527
Std train time: 1.9961344578689102
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0525, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8294, 'compress@10': 1.0, 'time@10': 3.1014}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0525, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8294, 'compress@10': 1.0, 'time@10': 3.1014}:   3%|▎         | 1/30 [00:01<00:46,  1.59s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.841, 'compress@10': 1.0, 'time@10': 2.8223}:   3%|▎         | 1/30 [00:04<00:46,  1.59s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.841, 'compress@10': 1.0, 'time@10': 2.8223}:   7%|▋         | 2/30 [00:04<01:00,  2.17s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0334, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8442, 'compress@10': 1.0, 'time@10': 2.2077}:   7%|▋         | 2/30 [00:04<01:00,  2.17s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0334, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8442, 'compress@10': 1.0, 'time@10': 2.2077}:  10%|█         | 3/30 [00:04<00:38,  1.42s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0373, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 2.2178}:  10%|█         | 3/30 [00:06<00:38,  1.42s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0373, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 2.2178}:  13%|█▎        | 4/30 [00:06<00:45,  1.76s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.042, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8352, 'compress@10': 1.0, 'time@10': 3.4932}:  13%|█▎        | 4/30 [00:11<00:45,  1.76s/it] {'epoch': 10, 'num_users': 5.8, 'loss': 0.042, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8352, 'compress@10': 1.0, 'time@10': 3.4932}:  17%|█▋        | 5/30 [00:11<01:07,  2.69s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0442, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8362, 'compress@10': 1.0, 'time@10': 3.4929}:  17%|█▋        | 5/30 [00:14<01:07,  2.69s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0442, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8362, 'compress@10': 1.0, 'time@10': 3.4929}:  20%|██        | 6/30 [00:14<01:11,  2.97s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0453, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8325, 'compress@10': 1.0, 'time@10': 3.6023}:  20%|██        | 6/30 [00:17<01:11,  2.97s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0453, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8325, 'compress@10': 1.0, 'time@10': 3.6023}:  23%|██▎       | 7/30 [00:17<01:02,  2.71s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0453, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8475, 'compress@10': 1.0, 'time@10': 3.5205}:  23%|██▎       | 7/30 [00:19<01:02,  2.71s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0453, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8475, 'compress@10': 1.0, 'time@10': 3.5205}:  27%|██▋       | 8/30 [00:19<01:01,  2.80s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0467, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.844, 'compress@10': 1.0, 'time@10': 3.8111}:  27%|██▋       | 8/30 [00:23<01:01,  2.80s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0467, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.844, 'compress@10': 1.0, 'time@10': 3.8111}:  30%|███       | 9/30 [00:23<01:00,  2.90s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0458, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8472, 'compress@10': 1.0, 'time@10': 3.7909}:  30%|███       | 9/30 [00:26<01:00,  2.90s/it]  {'epoch': 10, 'num_users': 6.3, 'loss': 0.0458, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8472, 'compress@10': 1.0, 'time@10': 3.7909}:  33%|███▎      | 10/30 [00:26<01:02,  3.13s/it]{'epoch': 10, 'num_users': 6.6364, 'loss': 0.0475, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8495, 'compress@10': 1.0, 'time@10': 3.841}:  33%|███▎      | 10/30 [00:28<01:02,  3.13s/it]{'epoch': 10, 'num_users': 6.6364, 'loss': 0.0475, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8495, 'compress@10': 1.0, 'time@10': 3.841}:  37%|███▋      | 11/30 [00:28<00:54,  2.85s/it]{'epoch': 10, 'num_users': 6.4167, 'loss': 0.0453, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8551, 'compress@10': 1.0, 'time@10': 3.5976}:  37%|███▋      | 11/30 [00:29<00:54,  2.85s/it]{'epoch': 10, 'num_users': 6.4167, 'loss': 0.0453, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8551, 'compress@10': 1.0, 'time@10': 3.5976}:  40%|████      | 12/30 [00:29<00:40,  2.27s/it]{'epoch': 10, 'num_users': 6.6154, 'loss': 0.0459, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 3.5995}:  40%|████      | 12/30 [00:31<00:40,  2.27s/it]{'epoch': 10, 'num_users': 6.6154, 'loss': 0.0459, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 3.5995}:  43%|████▎     | 13/30 [00:31<00:36,  2.14s/it]{'epoch': 10, 'num_users': 6.3571, 'loss': 0.0456, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 3.3713}:  43%|████▎     | 13/30 [00:32<00:36,  2.14s/it]{'epoch': 10, 'num_users': 6.3571, 'loss': 0.0456, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 3.3713}:  47%|████▋     | 14/30 [00:32<00:26,  1.63s/it]{'epoch': 10, 'num_users': 6.2667, 'loss': 0.0458, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8528, 'compress@10': 1.0, 'time@10': 3.4776}:  47%|████▋     | 14/30 [00:34<00:26,  1.63s/it] {'epoch': 10, 'num_users': 6.2667, 'loss': 0.0458, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8528, 'compress@10': 1.0, 'time@10': 3.4776}:  50%|█████     | 15/30 [00:34<00:28,  1.90s/it]{'epoch': 10, 'num_users': 6.0625, 'loss': 0.044, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8544, 'compress@10': 1.0, 'time@10': 3.3172}:  50%|█████     | 15/30 [00:35<00:28,  1.90s/it]{'epoch': 10, 'num_users': 6.0625, 'loss': 0.044, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8544, 'compress@10': 1.0, 'time@10': 3.3172}:  53%|█████▎    | 16/30 [00:35<00:22,  1.61s/it]{'epoch': 10, 'num_users': 5.8235, 'loss': 0.0434, 'hit_ratio@10': 0.8158, 'ndcg@10': 0.8463, 'compress@10': 1.0, 'time@10': 3.1601}:  53%|█████▎    | 16/30 [00:36<00:22,  1.61s/it]{'epoch': 10, 'num_users': 5.8235, 'loss': 0.0434, 'hit_ratio@10': 0.8158, 'ndcg@10': 0.8463, 'compress@10': 1.0, 'time@10': 3.1601}:  57%|█████▋    | 17/30 [00:36<00:16,  1.24s/it]{'epoch': 10, 'num_users': 6.0556, 'loss': 0.044, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 3.1168}:  57%|█████▋    | 17/30 [00:38<00:16,  1.24s/it] {'epoch': 10, 'num_users': 6.0556, 'loss': 0.044, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 3.1168}:  60%|██████    | 18/30 [00:38<00:19,  1.59s/it]{'epoch': 10, 'num_users': 6.0, 'loss': 0.0426, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8495, 'compress@10': 1.0, 'time@10': 3.0652}:  60%|██████    | 18/30 [00:39<00:19,  1.59s/it]  {'epoch': 10, 'num_users': 6.0, 'loss': 0.0426, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8495, 'compress@10': 1.0, 'time@10': 3.0652}:  63%|██████▎   | 19/30 [00:39<00:15,  1.45s/it]{'epoch': 10, 'num_users': 6.15, 'loss': 0.0426, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8504, 'compress@10': 1.0, 'time@10': 3.1495}:  63%|██████▎   | 19/30 [00:44<00:15,  1.45s/it]{'epoch': 10, 'num_users': 6.15, 'loss': 0.0426, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8504, 'compress@10': 1.0, 'time@10': 3.1495}:  67%|██████▋   | 20/30 [00:44<00:24,  2.45s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0435, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8497, 'compress@10': 1.0, 'time@10': 3.3269}:  67%|██████▋   | 20/30 [00:47<00:24,  2.45s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0435, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8497, 'compress@10': 1.0, 'time@10': 3.3269}:  70%|███████   | 21/30 [00:47<00:24,  2.76s/it]{'epoch': 10, 'num_users': 6.1818, 'loss': 0.0433, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 3.2567}:  70%|███████   | 21/30 [00:49<00:24,  2.76s/it] {'epoch': 10, 'num_users': 6.1818, 'loss': 0.0433, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 3.2567}:  73%|███████▎  | 22/30 [00:49<00:19,  2.48s/it]{'epoch': 10, 'num_users': 6.1304, 'loss': 0.0425, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8541, 'compress@10': 1.0, 'time@10': 3.252}:  73%|███████▎  | 22/30 [00:51<00:19,  2.48s/it]{'epoch': 10, 'num_users': 6.1304, 'loss': 0.0425, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8541, 'compress@10': 1.0, 'time@10': 3.252}:  77%|███████▋  | 23/30 [00:51<00:15,  2.22s/it]{'epoch': 10, 'num_users': 5.9583, 'loss': 0.0433, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8424, 'compress@10': 1.0, 'time@10': 3.1298}:  77%|███████▋  | 23/30 [00:51<00:15,  2.22s/it]{'epoch': 10, 'num_users': 5.9583, 'loss': 0.0433, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8424, 'compress@10': 1.0, 'time@10': 3.1298}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0441, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8263, 'compress@10': 1.0, 'time@10': 3.0175}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]   {'epoch': 10, 'num_users': 5.8, 'loss': 0.0441, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8263, 'compress@10': 1.0, 'time@10': 3.0175}:  83%|████████▎ | 25/30 [00:51<00:06,  1.22s/it]{'epoch': 10, 'num_users': 5.8077, 'loss': 0.0437, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8287, 'compress@10': 1.0, 'time@10': 3.1716}:  83%|████████▎ | 25/30 [00:58<00:06,  1.22s/it]{'epoch': 10, 'num_users': 5.8077, 'loss': 0.0437, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8287, 'compress@10': 1.0, 'time@10': 3.1716}:  87%|████████▋ | 26/30 [00:58<00:11,  2.97s/it]{'epoch': 10, 'num_users': 5.8889, 'loss': 0.0432, 'hit_ratio@10': 0.8277, 'ndcg@10': 0.8314, 'compress@10': 1.0, 'time@10': 3.2302}:  87%|████████▋ | 26/30 [01:01<00:11,  2.97s/it]{'epoch': 10, 'num_users': 5.8889, 'loss': 0.0432, 'hit_ratio@10': 0.8277, 'ndcg@10': 0.8314, 'compress@10': 1.0, 'time@10': 3.2302}:  90%|█████████ | 27/30 [01:01<00:08,  2.81s/it]{'epoch': 10, 'num_users': 6.0, 'loss': 0.0431, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8329, 'compress@10': 1.0, 'time@10': 3.2714}:  90%|█████████ | 27/30 [01:05<00:08,  2.81s/it]    {'epoch': 10, 'num_users': 6.0, 'loss': 0.0431, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8329, 'compress@10': 1.0, 'time@10': 3.2714}:  93%|█████████▎| 28/30 [01:05<00:06,  3.29s/it]{'epoch': 10, 'num_users': 5.8621, 'loss': 0.0425, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8352, 'compress@10': 1.0, 'time@10': 3.2751}:  93%|█████████▎| 28/30 [01:07<00:06,  3.29s/it]{'epoch': 10, 'num_users': 5.8621, 'loss': 0.0425, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8352, 'compress@10': 1.0, 'time@10': 3.2751}:  97%|█████████▋| 29/30 [01:07<00:02,  2.82s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.0425, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8374, 'compress@10': 1.0, 'time@10': 3.2725}:  97%|█████████▋| 29/30 [01:10<00:02,  2.82s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.0425, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8374, 'compress@10': 1.0, 'time@10': 3.2725}: 100%|██████████| 30/30 [01:10<00:00,  2.95s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.0425, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8374, 'compress@10': 1.0, 'time@10': 3.2725}: 100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch: 10
Avg # of users: 5.866666666666666
Avg Loss: 0.04253629797647217
Avg hit ratio: 0.8293492515297463
Avg ndcg: 0.8374187298484145
Avg compression ratio: 0.9999999860153537
Avg train time: 3.272531994183858
Std train time: 2.0771229098562225
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0448, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 3.0856}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0448, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 3.0856}:   3%|▎         | 1/30 [00:01<00:45,  1.58s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8552, 'compress@10': 1.0, 'time@10': 2.8412}:   3%|▎         | 1/30 [00:04<00:45,  1.58s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8552, 'compress@10': 1.0, 'time@10': 2.8412}:   7%|▋         | 2/30 [00:04<01:01,  2.20s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8537, 'compress@10': 1.0, 'time@10': 2.2376}:   7%|▋         | 2/30 [00:04<01:01,  2.20s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8537, 'compress@10': 1.0, 'time@10': 2.2376}:  10%|█         | 3/30 [00:04<00:39,  1.45s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8532, 'compress@10': 1.0, 'time@10': 2.273}:  10%|█         | 3/30 [00:07<00:39,  1.45s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8532, 'compress@10': 1.0, 'time@10': 2.273}:  13%|█▎        | 4/30 [00:07<00:47,  1.83s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0406, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 3.5477}:  13%|█▎        | 4/30 [00:11<00:47,  1.83s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0406, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 3.5477}:  17%|█▋        | 5/30 [00:11<01:08,  2.74s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0426, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8461, 'compress@10': 1.0, 'time@10': 3.5847}:  17%|█▋        | 5/30 [00:15<01:08,  2.74s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0426, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8461, 'compress@10': 1.0, 'time@10': 3.5847}:  20%|██        | 6/30 [00:15<01:14,  3.10s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0439, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8509, 'compress@10': 1.0, 'time@10': 3.6559}:  20%|██        | 6/30 [00:17<01:14,  3.10s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0439, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8509, 'compress@10': 1.0, 'time@10': 3.6559}:  23%|██▎       | 7/30 [00:17<01:03,  2.77s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0439, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8611, 'compress@10': 1.0, 'time@10': 3.5511}:  23%|██▎       | 7/30 [00:20<01:03,  2.77s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0439, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8611, 'compress@10': 1.0, 'time@10': 3.5511}:  27%|██▋       | 8/30 [00:20<01:01,  2.80s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0436, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 3.7796}:  27%|██▋       | 8/30 [00:23<01:01,  2.80s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0436, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 3.7796}:  30%|███       | 9/30 [00:23<00:59,  2.81s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0434, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8658, 'compress@10': 1.0, 'time@10': 3.756}:  30%|███       | 9/30 [00:26<00:59,  2.81s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0434, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8658, 'compress@10': 1.0, 'time@10': 3.756}:  33%|███▎      | 10/30 [00:26<01:00,  3.05s/it]{'epoch': 11, 'num_users': 6.6364, 'loss': 0.0458, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 3.8089}:  33%|███▎      | 10/30 [00:28<01:00,  3.05s/it]{'epoch': 11, 'num_users': 6.6364, 'loss': 0.0458, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 3.8089}:  37%|███▋      | 11/30 [00:28<00:53,  2.79s/it]{'epoch': 11, 'num_users': 6.4167, 'loss': 0.0437, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 3.5679}:  37%|███▋      | 11/30 [00:29<00:53,  2.79s/it]{'epoch': 11, 'num_users': 6.4167, 'loss': 0.0437, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 3.5679}:  40%|████      | 12/30 [00:29<00:40,  2.23s/it]{'epoch': 11, 'num_users': 6.6154, 'loss': 0.0445, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 3.5672}:  40%|████      | 12/30 [00:31<00:40,  2.23s/it]{'epoch': 11, 'num_users': 6.6154, 'loss': 0.0445, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 3.5672}:  43%|████▎     | 13/30 [00:31<00:35,  2.11s/it]{'epoch': 11, 'num_users': 6.3571, 'loss': 0.044, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 3.3432}:  43%|████▎     | 13/30 [00:32<00:35,  2.11s/it] {'epoch': 11, 'num_users': 6.3571, 'loss': 0.044, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 3.3432}:  47%|████▋     | 14/30 [00:32<00:25,  1.61s/it]{'epoch': 11, 'num_users': 6.2667, 'loss': 0.0444, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8661, 'compress@10': 1.0, 'time@10': 3.461}:  47%|████▋     | 14/30 [00:34<00:25,  1.61s/it]{'epoch': 11, 'num_users': 6.2667, 'loss': 0.0444, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8661, 'compress@10': 1.0, 'time@10': 3.461}:  50%|█████     | 15/30 [00:34<00:28,  1.91s/it]{'epoch': 11, 'num_users': 6.0625, 'loss': 0.0426, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8669, 'compress@10': 1.0, 'time@10': 3.3005}:  50%|█████     | 15/30 [00:35<00:28,  1.91s/it]{'epoch': 11, 'num_users': 6.0625, 'loss': 0.0426, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8669, 'compress@10': 1.0, 'time@10': 3.3005}:  53%|█████▎    | 16/30 [00:35<00:22,  1.61s/it]{'epoch': 11, 'num_users': 5.8235, 'loss': 0.0421, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 3.1445}:  53%|█████▎    | 16/30 [00:36<00:22,  1.61s/it]{'epoch': 11, 'num_users': 5.8235, 'loss': 0.0421, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 3.1445}:  57%|█████▋    | 17/30 [00:36<00:16,  1.24s/it]{'epoch': 11, 'num_users': 6.0556, 'loss': 0.0427, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 3.0999}:  57%|█████▋    | 17/30 [00:38<00:16,  1.24s/it]{'epoch': 11, 'num_users': 6.0556, 'loss': 0.0427, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 3.0999}:  60%|██████    | 18/30 [00:38<00:18,  1.58s/it]{'epoch': 11, 'num_users': 6.0, 'loss': 0.0413, 'hit_ratio@10': 0.816, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 3.0514}:  60%|██████    | 18/30 [00:39<00:18,  1.58s/it]    {'epoch': 11, 'num_users': 6.0, 'loss': 0.0413, 'hit_ratio@10': 0.816, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 3.0514}:  63%|██████▎   | 19/30 [00:39<00:15,  1.44s/it]{'epoch': 11, 'num_users': 6.15, 'loss': 0.0413, 'hit_ratio@10': 0.82, 'ndcg@10': 0.861, 'compress@10': 1.0, 'time@10': 3.1418}:  63%|██████▎   | 19/30 [00:44<00:15,  1.44s/it] {'epoch': 11, 'num_users': 6.15, 'loss': 0.0413, 'hit_ratio@10': 0.82, 'ndcg@10': 0.861, 'compress@10': 1.0, 'time@10': 3.1418}:  67%|██████▋   | 20/30 [00:44<00:24,  2.48s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0422, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 3.3163}:  67%|██████▋   | 20/30 [00:47<00:24,  2.48s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0422, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 3.3163}:  70%|███████   | 21/30 [00:47<00:24,  2.77s/it]{'epoch': 11, 'num_users': 6.1818, 'loss': 0.0435, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 3.2429}:  70%|███████   | 21/30 [00:49<00:24,  2.77s/it]{'epoch': 11, 'num_users': 6.1818, 'loss': 0.0435, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 3.2429}:  73%|███████▎  | 22/30 [00:49<00:19,  2.46s/it]{'epoch': 11, 'num_users': 6.1304, 'loss': 0.0427, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 3.2401}:  73%|███████▎  | 22/30 [00:51<00:19,  2.46s/it] {'epoch': 11, 'num_users': 6.1304, 'loss': 0.0427, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 3.2401}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it]{'epoch': 11, 'num_users': 5.9583, 'loss': 0.0434, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8539, 'compress@10': 1.0, 'time@10': 3.119}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it]{'epoch': 11, 'num_users': 5.9583, 'loss': 0.0434, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8539, 'compress@10': 1.0, 'time@10': 3.119}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0443, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8373, 'compress@10': 1.0, 'time@10': 3.007}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]    {'epoch': 11, 'num_users': 5.8, 'loss': 0.0443, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8373, 'compress@10': 1.0, 'time@10': 3.007}:  83%|████████▎ | 25/30 [00:51<00:06,  1.22s/it]{'epoch': 11, 'num_users': 5.8077, 'loss': 0.0437, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8397, 'compress@10': 1.0, 'time@10': 3.151}:  83%|████████▎ | 25/30 [00:58<00:06,  1.22s/it]{'epoch': 11, 'num_users': 5.8077, 'loss': 0.0437, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8397, 'compress@10': 1.0, 'time@10': 3.151}:  87%|████████▋ | 26/30 [00:58<00:11,  2.89s/it]{'epoch': 11, 'num_users': 5.8889, 'loss': 0.0432, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8415, 'compress@10': 1.0, 'time@10': 3.2031}:  87%|████████▋ | 26/30 [01:00<00:11,  2.89s/it]{'epoch': 11, 'num_users': 5.8889, 'loss': 0.0432, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8415, 'compress@10': 1.0, 'time@10': 3.2031}:  90%|█████████ | 27/30 [01:00<00:08,  2.72s/it]{'epoch': 11, 'num_users': 6.0, 'loss': 0.0432, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8424, 'compress@10': 1.0, 'time@10': 3.2452}:  90%|█████████ | 27/30 [01:05<00:08,  2.72s/it]   {'epoch': 11, 'num_users': 6.0, 'loss': 0.0432, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8424, 'compress@10': 1.0, 'time@10': 3.2452}:  93%|█████████▎| 28/30 [01:05<00:06,  3.23s/it]{'epoch': 11, 'num_users': 5.8621, 'loss': 0.0427, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8444, 'compress@10': 1.0, 'time@10': 3.2581}:  93%|█████████▎| 28/30 [01:07<00:06,  3.23s/it]{'epoch': 11, 'num_users': 5.8621, 'loss': 0.0427, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8444, 'compress@10': 1.0, 'time@10': 3.2581}:  97%|█████████▋| 29/30 [01:07<00:02,  2.82s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0427, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8463, 'compress@10': 1.0, 'time@10': 3.2479}:  97%|█████████▋| 29/30 [01:10<00:02,  2.82s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0427, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8463, 'compress@10': 1.0, 'time@10': 3.2479}: 100%|██████████| 30/30 [01:10<00:00,  2.87s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0427, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8463, 'compress@10': 1.0, 'time@10': 3.2479}: 100%|██████████| 30/30 [01:10<00:00,  2.34s/it]
Epoch: 11
Avg # of users: 5.866666666666666
Avg Loss: 0.04270729944352721
Avg hit ratio: 0.8306921069902488
Avg ndcg: 0.8462612763685419
Avg compression ratio: 0.9999999860153537
Avg train time: 3.247947629292806
Std train time: 2.0386526067070494
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8413, 'compress@10': 1.0, 'time@10': 3.0851}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8413, 'compress@10': 1.0, 'time@10': 3.0851}:   3%|▎         | 1/30 [00:01<00:45,  1.58s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8479, 'compress@10': 1.0, 'time@10': 2.8375}:   3%|▎         | 1/30 [00:04<00:45,  1.58s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8479, 'compress@10': 1.0, 'time@10': 2.8375}:   7%|▋         | 2/30 [00:04<01:01,  2.20s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8488, 'compress@10': 1.0, 'time@10': 2.226}:   7%|▋         | 2/30 [00:04<01:01,  2.20s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8488, 'compress@10': 1.0, 'time@10': 2.226}:  10%|█         | 3/30 [00:04<00:38,  1.44s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 2.2361}:  10%|█         | 3/30 [00:07<00:38,  1.44s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 2.2361}:  13%|█▎        | 4/30 [00:07<00:46,  1.78s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0405, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8426, 'compress@10': 1.0, 'time@10': 3.4809}:  13%|█▎        | 4/30 [00:11<00:46,  1.78s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0405, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8426, 'compress@10': 1.0, 'time@10': 3.4809}:  17%|█▋        | 5/30 [00:11<01:06,  2.68s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0421, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8436, 'compress@10': 1.0, 'time@10': 3.5258}:  17%|█▋        | 5/30 [00:15<01:06,  2.68s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0421, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8436, 'compress@10': 1.0, 'time@10': 3.5258}:  20%|██        | 6/30 [00:15<01:13,  3.06s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0422, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8417, 'compress@10': 1.0, 'time@10': 3.6059}:  20%|██        | 6/30 [00:17<01:13,  3.06s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0422, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8417, 'compress@10': 1.0, 'time@10': 3.6059}:  23%|██▎       | 7/30 [00:17<01:02,  2.74s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0422, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8536, 'compress@10': 1.0, 'time@10': 3.5043}:  23%|██▎       | 7/30 [00:20<01:02,  2.74s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0422, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8536, 'compress@10': 1.0, 'time@10': 3.5043}:  27%|██▋       | 8/30 [00:20<01:00,  2.77s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0411, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8607, 'compress@10': 1.0, 'time@10': 3.7156}:  27%|██▋       | 8/30 [00:22<01:00,  2.77s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0411, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8607, 'compress@10': 1.0, 'time@10': 3.7156}:  30%|███       | 9/30 [00:22<00:57,  2.76s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 3.6855}:  30%|███       | 9/30 [00:26<00:57,  2.76s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 3.6855}:  33%|███▎      | 10/30 [00:26<00:59,  2.97s/it]{'epoch': 12, 'num_users': 6.6364, 'loss': 0.0432, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 3.7433}:  33%|███▎      | 10/30 [00:28<00:59,  2.97s/it]{'epoch': 12, 'num_users': 6.6364, 'loss': 0.0432, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 3.7433}:  37%|███▋      | 11/30 [00:28<00:51,  2.74s/it]{'epoch': 12, 'num_users': 6.4167, 'loss': 0.0413, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8689, 'compress@10': 1.0, 'time@10': 3.5073}:  37%|███▋      | 11/30 [00:29<00:51,  2.74s/it]{'epoch': 12, 'num_users': 6.4167, 'loss': 0.0413, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8689, 'compress@10': 1.0, 'time@10': 3.5073}:  40%|████      | 12/30 [00:29<00:39,  2.20s/it]{'epoch': 12, 'num_users': 6.6154, 'loss': 0.0422, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8705, 'compress@10': 1.0, 'time@10': 3.5183}:  40%|████      | 12/30 [00:31<00:39,  2.20s/it]{'epoch': 12, 'num_users': 6.6154, 'loss': 0.0422, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8705, 'compress@10': 1.0, 'time@10': 3.5183}:  43%|████▎     | 13/30 [00:31<00:35,  2.10s/it]{'epoch': 12, 'num_users': 6.3571, 'loss': 0.0418, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 3.2961}:  43%|████▎     | 13/30 [00:31<00:35,  2.10s/it]{'epoch': 12, 'num_users': 6.3571, 'loss': 0.0418, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 3.2961}:  47%|████▋     | 14/30 [00:31<00:25,  1.60s/it]{'epoch': 12, 'num_users': 6.2667, 'loss': 0.0424, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 3.4075}:  47%|████▋     | 14/30 [00:34<00:25,  1.60s/it]{'epoch': 12, 'num_users': 6.2667, 'loss': 0.0424, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 3.4075}:  50%|█████     | 15/30 [00:34<00:28,  1.89s/it]{'epoch': 12, 'num_users': 6.0625, 'loss': 0.0407, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8662, 'compress@10': 1.0, 'time@10': 3.2512}:  50%|█████     | 15/30 [00:35<00:28,  1.89s/it]{'epoch': 12, 'num_users': 6.0625, 'loss': 0.0407, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8662, 'compress@10': 1.0, 'time@10': 3.2512}:  53%|█████▎    | 16/30 [00:35<00:22,  1.60s/it]{'epoch': 12, 'num_users': 5.8235, 'loss': 0.0403, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8575, 'compress@10': 1.0, 'time@10': 3.0988}:  53%|█████▎    | 16/30 [00:35<00:22,  1.60s/it]{'epoch': 12, 'num_users': 5.8235, 'loss': 0.0403, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8575, 'compress@10': 1.0, 'time@10': 3.0988}:  57%|█████▋    | 17/30 [00:35<00:16,  1.23s/it]{'epoch': 12, 'num_users': 6.0556, 'loss': 0.0408, 'hit_ratio@10': 0.818, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 3.0578}:  57%|█████▋    | 17/30 [00:37<00:16,  1.23s/it]  {'epoch': 12, 'num_users': 6.0556, 'loss': 0.0408, 'hit_ratio@10': 0.818, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 3.0578}:  60%|██████    | 18/30 [00:37<00:19,  1.58s/it]{'epoch': 12, 'num_users': 6.0, 'loss': 0.0395, 'hit_ratio@10': 0.8201, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 3.0132}:  60%|██████    | 18/30 [00:39<00:19,  1.58s/it] {'epoch': 12, 'num_users': 6.0, 'loss': 0.0395, 'hit_ratio@10': 0.8201, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 3.0132}:  63%|██████▎   | 19/30 [00:39<00:15,  1.45s/it]{'epoch': 12, 'num_users': 6.15, 'loss': 0.0395, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 3.1054}:  63%|██████▎   | 19/30 [00:43<00:15,  1.45s/it]{'epoch': 12, 'num_users': 6.15, 'loss': 0.0395, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 3.1054}:  67%|██████▋   | 20/30 [00:43<00:24,  2.48s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 3.2844}:  67%|██████▋   | 20/30 [00:47<00:24,  2.48s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 3.2844}:  70%|███████   | 21/30 [00:47<00:25,  2.78s/it]{'epoch': 12, 'num_users': 6.1818, 'loss': 0.0402, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 3.2199}:  70%|███████   | 21/30 [00:49<00:25,  2.78s/it]{'epoch': 12, 'num_users': 6.1818, 'loss': 0.0402, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 3.2199}:  73%|███████▎  | 22/30 [00:49<00:20,  2.52s/it]{'epoch': 12, 'num_users': 6.1304, 'loss': 0.0396, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 3.2264}:  73%|███████▎  | 22/30 [00:51<00:20,  2.52s/it]{'epoch': 12, 'num_users': 6.1304, 'loss': 0.0396, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 3.2264}:  77%|███████▋  | 23/30 [00:51<00:15,  2.28s/it]{'epoch': 12, 'num_users': 5.9583, 'loss': 0.0404, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8517, 'compress@10': 1.0, 'time@10': 3.1056}:  77%|███████▋  | 23/30 [00:51<00:15,  2.28s/it]{'epoch': 12, 'num_users': 5.9583, 'loss': 0.0404, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8517, 'compress@10': 1.0, 'time@10': 3.1056}:  80%|████████  | 24/30 [00:51<00:10,  1.71s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0413, 'hit_ratio@10': 0.8201, 'ndcg@10': 0.8352, 'compress@10': 1.0, 'time@10': 2.9949}:  80%|████████  | 24/30 [00:51<00:10,  1.71s/it]   {'epoch': 12, 'num_users': 5.8, 'loss': 0.0413, 'hit_ratio@10': 0.8201, 'ndcg@10': 0.8352, 'compress@10': 1.0, 'time@10': 2.9949}:  83%|████████▎ | 25/30 [00:51<00:06,  1.26s/it]{'epoch': 12, 'num_users': 5.8077, 'loss': 0.0407, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.1405}:  83%|████████▎ | 25/30 [00:58<00:06,  1.26s/it]{'epoch': 12, 'num_users': 5.8077, 'loss': 0.0407, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.1405}:  87%|████████▋ | 26/30 [00:58<00:11,  2.92s/it]{'epoch': 12, 'num_users': 5.8889, 'loss': 0.0405, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8393, 'compress@10': 1.0, 'time@10': 3.194}:  87%|████████▋ | 26/30 [01:00<00:11,  2.92s/it]{'epoch': 12, 'num_users': 5.8889, 'loss': 0.0405, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8393, 'compress@10': 1.0, 'time@10': 3.194}:  90%|█████████ | 27/30 [01:00<00:08,  2.75s/it]{'epoch': 12, 'num_users': 6.0, 'loss': 0.0405, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 3.2334}:  90%|█████████ | 27/30 [01:05<00:08,  2.75s/it]  {'epoch': 12, 'num_users': 6.0, 'loss': 0.0405, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 3.2334}:  93%|█████████▎| 28/30 [01:05<00:06,  3.23s/it]{'epoch': 12, 'num_users': 5.8621, 'loss': 0.04, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8429, 'compress@10': 1.0, 'time@10': 3.2394}:  93%|█████████▎| 28/30 [01:06<00:06,  3.23s/it]{'epoch': 12, 'num_users': 5.8621, 'loss': 0.04, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8429, 'compress@10': 1.0, 'time@10': 3.2394}:  97%|█████████▋| 29/30 [01:06<00:02,  2.78s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0401, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8449, 'compress@10': 1.0, 'time@10': 3.2316}:  97%|█████████▋| 29/30 [01:09<00:02,  2.78s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0401, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8449, 'compress@10': 1.0, 'time@10': 3.2316}: 100%|██████████| 30/30 [01:09<00:00,  2.86s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0401, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8449, 'compress@10': 1.0, 'time@10': 3.2316}: 100%|██████████| 30/30 [01:09<00:00,  2.33s/it]
Epoch: 12
Avg # of users: 5.866666666666666
Avg Loss: 0.04005051051806733
Avg hit ratio: 0.8336553613539752
Avg ndcg: 0.8448825220169307
Avg compression ratio: 0.9999999860153537
Avg train time: 3.23157578309377
Std train time: 2.0114555729229644
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8439, 'compress@10': 1.0, 'time@10': 3.1284}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8439, 'compress@10': 1.0, 'time@10': 3.1284}:   3%|▎         | 1/30 [00:01<00:46,  1.62s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 2.8569}:   3%|▎         | 1/30 [00:04<00:46,  1.62s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 2.8569}:   7%|▋         | 2/30 [00:04<01:02,  2.22s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8498, 'compress@10': 1.0, 'time@10': 2.2358}:   7%|▋         | 2/30 [00:04<01:02,  2.22s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8498, 'compress@10': 1.0, 'time@10': 2.2358}:  10%|█         | 3/30 [00:04<00:39,  1.45s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8465, 'compress@10': 1.0, 'time@10': 2.2392}:  10%|█         | 3/30 [00:07<00:39,  1.45s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8465, 'compress@10': 1.0, 'time@10': 2.2392}:  13%|█▎        | 4/30 [00:07<00:46,  1.78s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.038, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8438, 'compress@10': 1.0, 'time@10': 3.4585}:  13%|█▎        | 4/30 [00:11<00:46,  1.78s/it] {'epoch': 13, 'num_users': 5.8, 'loss': 0.038, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8438, 'compress@10': 1.0, 'time@10': 3.4585}:  17%|█▋        | 5/30 [00:11<01:06,  2.65s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0396, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.845, 'compress@10': 1.0, 'time@10': 3.523}:  17%|█▋        | 5/30 [00:15<01:06,  2.65s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0396, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.845, 'compress@10': 1.0, 'time@10': 3.523}:  20%|██        | 6/30 [00:15<01:14,  3.09s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0401, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 3.6128}:  20%|██        | 6/30 [00:17<01:14,  3.09s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0401, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 3.6128}:  23%|██▎       | 7/30 [00:17<01:04,  2.80s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0402, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.8603, 'compress@10': 1.0, 'time@10': 3.5163}:  23%|██▎       | 7/30 [00:20<01:04,  2.80s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0402, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.8603, 'compress@10': 1.0, 'time@10': 3.5163}:  27%|██▋       | 8/30 [00:20<01:02,  2.82s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0422, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8614, 'compress@10': 1.0, 'time@10': 3.7624}:  27%|██▋       | 8/30 [00:23<01:02,  2.82s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0422, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8614, 'compress@10': 1.0, 'time@10': 3.7624}:  30%|███       | 9/30 [00:23<00:59,  2.85s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0418, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 3.7469}:  30%|███       | 9/30 [00:26<00:59,  2.85s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0418, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 3.7469}:  33%|███▎      | 10/30 [00:26<01:01,  3.09s/it]{'epoch': 13, 'num_users': 6.6364, 'loss': 0.0437, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 3.8175}:  33%|███▎      | 10/30 [00:29<01:01,  3.09s/it]{'epoch': 13, 'num_users': 6.6364, 'loss': 0.0437, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 3.8175}:  37%|███▋      | 11/30 [00:29<00:54,  2.85s/it]{'epoch': 13, 'num_users': 6.4167, 'loss': 0.0418, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 3.5788}:  37%|███▋      | 11/30 [00:30<00:54,  2.85s/it]{'epoch': 13, 'num_users': 6.4167, 'loss': 0.0418, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 3.5788}:  40%|████      | 12/30 [00:30<00:41,  2.29s/it]{'epoch': 13, 'num_users': 6.6154, 'loss': 0.0426, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 3.5874}:  40%|████      | 12/30 [00:32<00:41,  2.29s/it]{'epoch': 13, 'num_users': 6.6154, 'loss': 0.0426, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 3.5874}:  43%|████▎     | 13/30 [00:32<00:36,  2.16s/it]{'epoch': 13, 'num_users': 6.3571, 'loss': 0.042, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8634, 'compress@10': 1.0, 'time@10': 3.3612}:  43%|████▎     | 13/30 [00:32<00:36,  2.16s/it] {'epoch': 13, 'num_users': 6.3571, 'loss': 0.042, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8634, 'compress@10': 1.0, 'time@10': 3.3612}:  47%|████▋     | 14/30 [00:32<00:26,  1.65s/it]{'epoch': 13, 'num_users': 6.2667, 'loss': 0.0425, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 3.4868}:  47%|████▋     | 14/30 [00:35<00:26,  1.65s/it]{'epoch': 13, 'num_users': 6.2667, 'loss': 0.0425, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 3.4868}:  50%|█████     | 15/30 [00:35<00:29,  1.95s/it]{'epoch': 13, 'num_users': 6.0625, 'loss': 0.0408, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8662, 'compress@10': 1.0, 'time@10': 3.334}:  50%|█████     | 15/30 [00:36<00:29,  1.95s/it] {'epoch': 13, 'num_users': 6.0625, 'loss': 0.0408, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8662, 'compress@10': 1.0, 'time@10': 3.334}:  53%|█████▎    | 16/30 [00:36<00:23,  1.69s/it]{'epoch': 13, 'num_users': 5.8235, 'loss': 0.0403, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 3.1764}:  53%|█████▎    | 16/30 [00:36<00:23,  1.69s/it]{'epoch': 13, 'num_users': 5.8235, 'loss': 0.0403, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 3.1764}:  57%|█████▋    | 17/30 [00:36<00:16,  1.29s/it]{'epoch': 13, 'num_users': 6.0556, 'loss': 0.0408, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8584, 'compress@10': 1.0, 'time@10': 3.1275}:  57%|█████▋    | 17/30 [00:38<00:16,  1.29s/it] {'epoch': 13, 'num_users': 6.0556, 'loss': 0.0408, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8584, 'compress@10': 1.0, 'time@10': 3.1275}:  60%|██████    | 18/30 [00:38<00:19,  1.60s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 0.0395, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 3.0803}:  60%|██████    | 18/30 [00:40<00:19,  1.60s/it]  {'epoch': 13, 'num_users': 6.0, 'loss': 0.0395, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 3.0803}:  63%|██████▎   | 19/30 [00:40<00:16,  1.47s/it]{'epoch': 13, 'num_users': 6.15, 'loss': 0.0394, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 3.1727}:  63%|██████▎   | 19/30 [00:45<00:16,  1.47s/it]{'epoch': 13, 'num_users': 6.15, 'loss': 0.0394, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 3.1727}:  67%|██████▋   | 20/30 [00:45<00:25,  2.52s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0401, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8608, 'compress@10': 1.0, 'time@10': 3.3389}:  67%|██████▋   | 20/30 [00:48<00:25,  2.52s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0401, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8608, 'compress@10': 1.0, 'time@10': 3.3389}:  70%|███████   | 21/30 [00:48<00:24,  2.77s/it]{'epoch': 13, 'num_users': 6.1818, 'loss': 0.0405, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.8627, 'compress@10': 1.0, 'time@10': 3.2578}:  70%|███████   | 21/30 [00:49<00:24,  2.77s/it]{'epoch': 13, 'num_users': 6.1818, 'loss': 0.0405, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.8627, 'compress@10': 1.0, 'time@10': 3.2578}:  73%|███████▎  | 22/30 [00:49<00:19,  2.42s/it]{'epoch': 13, 'num_users': 6.1304, 'loss': 0.0398, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 3.2476}:  73%|███████▎  | 22/30 [00:51<00:19,  2.42s/it]{'epoch': 13, 'num_users': 6.1304, 'loss': 0.0398, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 3.2476}:  77%|███████▋  | 23/30 [00:51<00:15,  2.16s/it]{'epoch': 13, 'num_users': 5.9583, 'loss': 0.0405, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 3.1249}:  77%|███████▋  | 23/30 [00:51<00:15,  2.16s/it]{'epoch': 13, 'num_users': 5.9583, 'loss': 0.0405, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 3.1249}:  80%|████████  | 24/30 [00:51<00:09,  1.61s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0414, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8359, 'compress@10': 1.0, 'time@10': 3.012}:  80%|████████  | 24/30 [00:52<00:09,  1.61s/it]    {'epoch': 13, 'num_users': 5.8, 'loss': 0.0414, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8359, 'compress@10': 1.0, 'time@10': 3.012}:  83%|████████▎ | 25/30 [00:52<00:05,  1.19s/it]{'epoch': 13, 'num_users': 5.8077, 'loss': 0.0407, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.839, 'compress@10': 1.0, 'time@10': 3.1525}:  83%|████████▎ | 25/30 [00:58<00:05,  1.19s/it]{'epoch': 13, 'num_users': 5.8077, 'loss': 0.0407, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.839, 'compress@10': 1.0, 'time@10': 3.1525}:  87%|████████▋ | 26/30 [00:58<00:11,  2.84s/it]{'epoch': 13, 'num_users': 5.8889, 'loss': 0.0413, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 3.2073}:  87%|████████▋ | 26/30 [01:01<00:11,  2.84s/it]{'epoch': 13, 'num_users': 5.8889, 'loss': 0.0413, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 3.2073}:  90%|█████████ | 27/30 [01:01<00:08,  2.69s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 0.041, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8409, 'compress@10': 1.0, 'time@10': 3.2467}:  90%|█████████ | 27/30 [01:05<00:08,  2.69s/it]    {'epoch': 13, 'num_users': 6.0, 'loss': 0.041, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8409, 'compress@10': 1.0, 'time@10': 3.2467}:  93%|█████████▎| 28/30 [01:05<00:06,  3.19s/it]{'epoch': 13, 'num_users': 5.8621, 'loss': 0.0406, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 3.2512}:  93%|█████████▎| 28/30 [01:07<00:06,  3.19s/it]{'epoch': 13, 'num_users': 5.8621, 'loss': 0.0406, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 3.2512}:  97%|█████████▋| 29/30 [01:07<00:02,  2.75s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0405, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8452, 'compress@10': 1.0, 'time@10': 3.2445}:  97%|█████████▋| 29/30 [01:10<00:02,  2.75s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0405, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8452, 'compress@10': 1.0, 'time@10': 3.2445}: 100%|██████████| 30/30 [01:10<00:00,  2.85s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0405, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8452, 'compress@10': 1.0, 'time@10': 3.2445}: 100%|██████████| 30/30 [01:10<00:00,  2.34s/it]
Epoch: 13
Avg # of users: 5.866666666666666
Avg Loss: 0.04049189101752971
Avg hit ratio: 0.8352495655673745
Avg ndcg: 0.845158638754037
Avg compression ratio: 0.9999999860153537
Avg train time: 3.244521220525106
Std train time: 2.0182541705184662
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8416, 'compress@10': 1.0, 'time@10': 3.0708}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8416, 'compress@10': 1.0, 'time@10': 3.0708}:   3%|▎         | 1/30 [00:01<00:45,  1.57s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0416, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 2.831}:   3%|▎         | 1/30 [00:04<00:45,  1.57s/it]  {'epoch': 14, 'num_users': 7.0, 'loss': 0.0416, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 2.831}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8569, 'compress@10': 1.0, 'time@10': 2.2136}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8569, 'compress@10': 1.0, 'time@10': 2.2136}:  10%|█         | 3/30 [00:04<00:38,  1.43s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8579, 'compress@10': 1.0, 'time@10': 2.2286}:  10%|█         | 3/30 [00:07<00:38,  1.43s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8579, 'compress@10': 1.0, 'time@10': 2.2286}:  13%|█▎        | 4/30 [00:07<00:46,  1.78s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0353, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8533, 'compress@10': 1.0, 'time@10': 3.4794}:  13%|█▎        | 4/30 [00:11<00:46,  1.78s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0353, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8533, 'compress@10': 1.0, 'time@10': 3.4794}:  17%|█▋        | 5/30 [00:11<01:07,  2.68s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.037, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8539, 'compress@10': 1.0, 'time@10': 3.5349}:  17%|█▋        | 5/30 [00:15<01:07,  2.68s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.037, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8539, 'compress@10': 1.0, 'time@10': 3.5349}:  20%|██        | 6/30 [00:15<01:13,  3.08s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0372, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 3.618}:  20%|██        | 6/30 [00:17<01:13,  3.08s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0372, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 3.618}:  23%|██▎       | 7/30 [00:17<01:03,  2.76s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0375, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 3.5383}:  23%|██▎       | 7/30 [00:20<01:03,  2.76s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0375, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 3.5383}:  27%|██▋       | 8/30 [00:20<01:02,  2.84s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0375, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8691, 'compress@10': 1.0, 'time@10': 3.7915}:  27%|██▋       | 8/30 [00:23<01:02,  2.84s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0375, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8691, 'compress@10': 1.0, 'time@10': 3.7915}:  30%|███       | 9/30 [00:23<01:00,  2.87s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0371, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 3.7762}:  30%|███       | 9/30 [00:26<01:00,  2.87s/it]     {'epoch': 14, 'num_users': 6.3, 'loss': 0.0371, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 3.7762}:  33%|███▎      | 10/30 [00:26<01:02,  3.12s/it]{'epoch': 14, 'num_users': 6.6364, 'loss': 0.0387, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8707, 'compress@10': 1.0, 'time@10': 3.8327}:  33%|███▎      | 10/30 [00:29<01:02,  3.12s/it]{'epoch': 14, 'num_users': 6.6364, 'loss': 0.0387, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8707, 'compress@10': 1.0, 'time@10': 3.8327}:  37%|███▋      | 11/30 [00:29<00:54,  2.85s/it]{'epoch': 14, 'num_users': 6.4167, 'loss': 0.0372, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 3.5897}:  37%|███▋      | 11/30 [00:30<00:54,  2.85s/it]{'epoch': 14, 'num_users': 6.4167, 'loss': 0.0372, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 3.5897}:  40%|████      | 12/30 [00:30<00:40,  2.27s/it]{'epoch': 14, 'num_users': 6.6154, 'loss': 0.0381, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8753, 'compress@10': 1.0, 'time@10': 3.5972}:  40%|████      | 12/30 [00:31<00:40,  2.27s/it]{'epoch': 14, 'num_users': 6.6154, 'loss': 0.0381, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8753, 'compress@10': 1.0, 'time@10': 3.5972}:  43%|████▎     | 13/30 [00:31<00:36,  2.15s/it]{'epoch': 14, 'num_users': 6.3571, 'loss': 0.0377, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8693, 'compress@10': 1.0, 'time@10': 3.3697}:  43%|████▎     | 13/30 [00:32<00:36,  2.15s/it] {'epoch': 14, 'num_users': 6.3571, 'loss': 0.0377, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8693, 'compress@10': 1.0, 'time@10': 3.3697}:  47%|████▋     | 14/30 [00:32<00:26,  1.64s/it]{'epoch': 14, 'num_users': 6.2667, 'loss': 0.0384, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 3.4783}:  47%|████▋     | 14/30 [00:34<00:26,  1.64s/it]{'epoch': 14, 'num_users': 6.2667, 'loss': 0.0384, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 3.4783}:  50%|█████     | 15/30 [00:34<00:28,  1.91s/it]{'epoch': 14, 'num_users': 6.0625, 'loss': 0.037, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.871, 'compress@10': 1.0, 'time@10': 3.3144}:  50%|█████     | 15/30 [00:35<00:28,  1.91s/it]  {'epoch': 14, 'num_users': 6.0625, 'loss': 0.037, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.871, 'compress@10': 1.0, 'time@10': 3.3144}:  53%|█████▎    | 16/30 [00:35<00:22,  1.61s/it]{'epoch': 14, 'num_users': 5.8235, 'loss': 0.0366, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 3.1553}:  53%|█████▎    | 16/30 [00:36<00:22,  1.61s/it]{'epoch': 14, 'num_users': 5.8235, 'loss': 0.0366, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 3.1553}:  57%|█████▋    | 17/30 [00:36<00:16,  1.23s/it]{'epoch': 14, 'num_users': 6.0556, 'loss': 0.0371, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 3.1021}:  57%|█████▋    | 17/30 [00:38<00:16,  1.23s/it]{'epoch': 14, 'num_users': 6.0556, 'loss': 0.0371, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 3.1021}:  60%|██████    | 18/30 [00:38<00:18,  1.53s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 0.036, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8642, 'compress@10': 1.0, 'time@10': 3.0469}:  60%|██████    | 18/30 [00:39<00:18,  1.53s/it]    {'epoch': 14, 'num_users': 6.0, 'loss': 0.036, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8642, 'compress@10': 1.0, 'time@10': 3.0469}:  63%|██████▎   | 19/30 [00:39<00:15,  1.39s/it]{'epoch': 14, 'num_users': 6.15, 'loss': 0.036, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 3.1371}:  63%|██████▎   | 19/30 [00:44<00:15,  1.39s/it]{'epoch': 14, 'num_users': 6.15, 'loss': 0.036, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 3.1371}:  67%|██████▋   | 20/30 [00:44<00:24,  2.44s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0368, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8644, 'compress@10': 1.0, 'time@10': 3.3095}:  67%|██████▋   | 20/30 [00:47<00:24,  2.44s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0368, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8644, 'compress@10': 1.0, 'time@10': 3.3095}:  70%|███████   | 21/30 [00:47<00:24,  2.73s/it]{'epoch': 14, 'num_users': 6.1818, 'loss': 0.0371, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 3.2373}:  70%|███████   | 21/30 [00:49<00:24,  2.73s/it] {'epoch': 14, 'num_users': 6.1818, 'loss': 0.0371, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 3.2373}:  73%|███████▎  | 22/30 [00:49<00:19,  2.44s/it]{'epoch': 14, 'num_users': 6.1304, 'loss': 0.0365, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 3.2332}:  73%|███████▎  | 22/30 [00:51<00:19,  2.44s/it]{'epoch': 14, 'num_users': 6.1304, 'loss': 0.0365, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 3.2332}:  77%|███████▋  | 23/30 [00:51<00:15,  2.19s/it]{'epoch': 14, 'num_users': 5.9583, 'loss': 0.0373, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8555, 'compress@10': 1.0, 'time@10': 3.112}:  77%|███████▋  | 23/30 [00:51<00:15,  2.19s/it]{'epoch': 14, 'num_users': 5.9583, 'loss': 0.0373, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8555, 'compress@10': 1.0, 'time@10': 3.112}:  80%|████████  | 24/30 [00:51<00:09,  1.64s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0382, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8389, 'compress@10': 1.0, 'time@10': 3.0016}:  80%|████████  | 24/30 [00:51<00:09,  1.64s/it]  {'epoch': 14, 'num_users': 5.8, 'loss': 0.0382, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8389, 'compress@10': 1.0, 'time@10': 3.0016}:  83%|████████▎ | 25/30 [00:51<00:06,  1.21s/it]{'epoch': 14, 'num_users': 5.8077, 'loss': 0.0376, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8421, 'compress@10': 1.0, 'time@10': 3.1474}:  83%|████████▎ | 25/30 [00:58<00:06,  1.21s/it]{'epoch': 14, 'num_users': 5.8077, 'loss': 0.0376, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8421, 'compress@10': 1.0, 'time@10': 3.1474}:  87%|████████▋ | 26/30 [00:58<00:11,  2.90s/it]{'epoch': 14, 'num_users': 5.8889, 'loss': 0.038, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8467, 'compress@10': 1.0, 'time@10': 3.2027}:  87%|████████▋ | 26/30 [01:00<00:11,  2.90s/it] {'epoch': 14, 'num_users': 5.8889, 'loss': 0.038, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8467, 'compress@10': 1.0, 'time@10': 3.2027}:  90%|█████████ | 27/30 [01:00<00:08,  2.74s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 0.038, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.8479, 'compress@10': 1.0, 'time@10': 3.2431}:  90%|█████████ | 27/30 [01:05<00:08,  2.74s/it]   {'epoch': 14, 'num_users': 6.0, 'loss': 0.038, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.8479, 'compress@10': 1.0, 'time@10': 3.2431}:  93%|█████████▎| 28/30 [01:05<00:06,  3.23s/it]{'epoch': 14, 'num_users': 5.8621, 'loss': 0.0376, 'hit_ratio@10': 0.841, 'ndcg@10': 0.85, 'compress@10': 1.0, 'time@10': 3.2486}:  93%|█████████▎| 28/30 [01:07<00:06,  3.23s/it]{'epoch': 14, 'num_users': 5.8621, 'loss': 0.0376, 'hit_ratio@10': 0.841, 'ndcg@10': 0.85, 'compress@10': 1.0, 'time@10': 3.2486}:  97%|█████████▋| 29/30 [01:07<00:02,  2.78s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.0375, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 3.2409}:  97%|█████████▋| 29/30 [01:10<00:02,  2.78s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.0375, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 3.2409}: 100%|██████████| 30/30 [01:10<00:00,  2.86s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.0375, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 3.2409}: 100%|██████████| 30/30 [01:10<00:00,  2.34s/it]
Epoch: 14
Avg # of users: 5.866666666666666
Avg Loss: 0.03747661663992012
Avg hit ratio: 0.8382392196483598
Avg ndcg: 0.8518269172124507
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2409137010574343
Std train time: 2.041706189342357
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 2.938}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 2.938}:   3%|▎         | 1/30 [00:01<00:43,  1.51s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 2.7094}:   3%|▎         | 1/30 [00:04<00:43,  1.51s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 2.7094}:   7%|▋         | 2/30 [00:04<00:58,  2.10s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 2.1338}:   7%|▋         | 2/30 [00:04<00:58,  2.10s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 2.1338}:  10%|█         | 3/30 [00:04<00:37,  1.38s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 2.1373}:  10%|█         | 3/30 [00:06<00:37,  1.38s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 2.1373}:  13%|█▎        | 4/30 [00:06<00:44,  1.70s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0348, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8596, 'compress@10': 1.0, 'time@10': 3.4089}:  13%|█▎        | 4/30 [00:11<00:44,  1.70s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0348, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8596, 'compress@10': 1.0, 'time@10': 3.4089}:  17%|█▋        | 5/30 [00:11<01:05,  2.63s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0359, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8605, 'compress@10': 1.0, 'time@10': 3.4707}:  17%|█▋        | 5/30 [00:14<01:05,  2.63s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0359, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8605, 'compress@10': 1.0, 'time@10': 3.4707}:  20%|██        | 6/30 [00:14<01:12,  3.03s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0365, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 3.56}:  20%|██        | 6/30 [00:16<01:12,  3.03s/it]  {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0365, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 3.56}:  23%|██▎       | 7/30 [00:16<01:02,  2.72s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0364, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.8717, 'compress@10': 1.0, 'time@10': 3.47}:  23%|██▎       | 7/30 [00:19<01:02,  2.72s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0364, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.8717, 'compress@10': 1.0, 'time@10': 3.47}:  27%|██▋       | 8/30 [00:19<01:01,  2.77s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0393, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 3.7351}:  27%|██▋       | 8/30 [00:22<01:01,  2.77s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0393, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 3.7351}:  30%|███       | 9/30 [00:22<00:59,  2.83s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0381, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8711, 'compress@10': 1.0, 'time@10': 3.7203}:  30%|███       | 9/30 [00:26<00:59,  2.83s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0381, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8711, 'compress@10': 1.0, 'time@10': 3.7203}:  33%|███▎      | 10/30 [00:26<01:01,  3.08s/it]{'epoch': 15, 'num_users': 6.6364, 'loss': 0.0395, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8714, 'compress@10': 1.0, 'time@10': 3.7765}:  33%|███▎      | 10/30 [00:28<01:01,  3.08s/it]{'epoch': 15, 'num_users': 6.6364, 'loss': 0.0395, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8714, 'compress@10': 1.0, 'time@10': 3.7765}:  37%|███▋      | 11/30 [00:28<00:53,  2.83s/it]{'epoch': 15, 'num_users': 6.4167, 'loss': 0.0378, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8757, 'compress@10': 1.0, 'time@10': 3.5395}:  37%|███▋      | 11/30 [00:29<00:53,  2.83s/it]{'epoch': 15, 'num_users': 6.4167, 'loss': 0.0378, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8757, 'compress@10': 1.0, 'time@10': 3.5395}:  40%|████      | 12/30 [00:29<00:40,  2.26s/it]{'epoch': 15, 'num_users': 6.6154, 'loss': 0.0385, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8764, 'compress@10': 1.0, 'time@10': 3.5504}:  40%|████      | 12/30 [00:31<00:40,  2.26s/it]{'epoch': 15, 'num_users': 6.6154, 'loss': 0.0385, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8764, 'compress@10': 1.0, 'time@10': 3.5504}:  43%|████▎     | 13/30 [00:31<00:36,  2.15s/it]{'epoch': 15, 'num_users': 6.3571, 'loss': 0.0379, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8703, 'compress@10': 1.0, 'time@10': 3.3264}:  43%|████▎     | 13/30 [00:31<00:36,  2.15s/it]{'epoch': 15, 'num_users': 6.3571, 'loss': 0.0379, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8703, 'compress@10': 1.0, 'time@10': 3.3264}:  47%|████▋     | 14/30 [00:31<00:26,  1.63s/it]{'epoch': 15, 'num_users': 6.2667, 'loss': 0.0384, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 3.4397}:  47%|████▋     | 14/30 [00:34<00:26,  1.63s/it]{'epoch': 15, 'num_users': 6.2667, 'loss': 0.0384, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 3.4397}:  50%|█████     | 15/30 [00:34<00:28,  1.91s/it]{'epoch': 15, 'num_users': 6.0625, 'loss': 0.0369, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8709, 'compress@10': 1.0, 'time@10': 3.2818}:  50%|█████     | 15/30 [00:35<00:28,  1.91s/it]{'epoch': 15, 'num_users': 6.0625, 'loss': 0.0369, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8709, 'compress@10': 1.0, 'time@10': 3.2818}:  53%|█████▎    | 16/30 [00:35<00:22,  1.62s/it]{'epoch': 15, 'num_users': 5.8235, 'loss': 0.0364, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8618, 'compress@10': 1.0, 'time@10': 3.1269}:  53%|█████▎    | 16/30 [00:35<00:22,  1.62s/it]{'epoch': 15, 'num_users': 5.8235, 'loss': 0.0364, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8618, 'compress@10': 1.0, 'time@10': 3.1269}:  57%|█████▋    | 17/30 [00:35<00:16,  1.24s/it]{'epoch': 15, 'num_users': 6.0556, 'loss': 0.0369, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 3.0848}:  57%|█████▋    | 17/30 [00:38<00:16,  1.24s/it]{'epoch': 15, 'num_users': 6.0556, 'loss': 0.0369, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 3.0848}:  60%|██████    | 18/30 [00:38<00:19,  1.59s/it]{'epoch': 15, 'num_users': 6.0, 'loss': 0.0358, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 3.0365}:  60%|██████    | 18/30 [00:39<00:19,  1.59s/it]   {'epoch': 15, 'num_users': 6.0, 'loss': 0.0358, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 3.0365}:  63%|██████▎   | 19/30 [00:39<00:15,  1.45s/it]{'epoch': 15, 'num_users': 6.15, 'loss': 0.0357, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 3.1284}:  63%|██████▎   | 19/30 [00:44<00:15,  1.45s/it]{'epoch': 15, 'num_users': 6.15, 'loss': 0.0357, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 3.1284}:  67%|██████▋   | 20/30 [00:44<00:25,  2.50s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0364, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 3.3061}:  67%|██████▋   | 20/30 [00:47<00:25,  2.50s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0364, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 3.3061}:  70%|███████   | 21/30 [00:47<00:25,  2.79s/it]{'epoch': 15, 'num_users': 6.1818, 'loss': 0.0367, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.867, 'compress@10': 1.0, 'time@10': 3.2334}:  70%|███████   | 21/30 [00:49<00:25,  2.79s/it] {'epoch': 15, 'num_users': 6.1818, 'loss': 0.0367, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.867, 'compress@10': 1.0, 'time@10': 3.2334}:  73%|███████▎  | 22/30 [00:49<00:19,  2.48s/it]{'epoch': 15, 'num_users': 6.1304, 'loss': 0.0361, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8687, 'compress@10': 1.0, 'time@10': 3.2273}:  73%|███████▎  | 22/30 [00:51<00:19,  2.48s/it]{'epoch': 15, 'num_users': 6.1304, 'loss': 0.0361, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8687, 'compress@10': 1.0, 'time@10': 3.2273}:  77%|███████▋  | 23/30 [00:51<00:15,  2.26s/it]{'epoch': 15, 'num_users': 5.9583, 'loss': 0.0368, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 3.1057}:  77%|███████▋  | 23/30 [00:51<00:15,  2.26s/it]{'epoch': 15, 'num_users': 5.9583, 'loss': 0.0368, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 3.1057}:  80%|████████  | 24/30 [00:51<00:10,  1.69s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8414, 'compress@10': 1.0, 'time@10': 2.994}:  80%|████████  | 24/30 [00:51<00:10,  1.69s/it]     {'epoch': 15, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8414, 'compress@10': 1.0, 'time@10': 2.994}:  83%|████████▎ | 25/30 [00:51<00:06,  1.24s/it]{'epoch': 15, 'num_users': 5.8077, 'loss': 0.037, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8449, 'compress@10': 1.0, 'time@10': 3.1393}:  83%|████████▎ | 25/30 [00:58<00:06,  1.24s/it]{'epoch': 15, 'num_users': 5.8077, 'loss': 0.037, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8449, 'compress@10': 1.0, 'time@10': 3.1393}:  87%|████████▋ | 26/30 [00:58<00:11,  2.91s/it]{'epoch': 15, 'num_users': 5.8889, 'loss': 0.0368, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8475, 'compress@10': 1.0, 'time@10': 3.2011}:  87%|████████▋ | 26/30 [01:01<00:11,  2.91s/it]{'epoch': 15, 'num_users': 5.8889, 'loss': 0.0368, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8475, 'compress@10': 1.0, 'time@10': 3.2011}:  90%|█████████ | 27/30 [01:01<00:08,  2.77s/it]{'epoch': 15, 'num_users': 6.0, 'loss': 0.0367, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 3.2424}:  90%|█████████ | 27/30 [01:05<00:08,  2.77s/it]   {'epoch': 15, 'num_users': 6.0, 'loss': 0.0367, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 3.2424}:  93%|█████████▎| 28/30 [01:05<00:06,  3.26s/it]{'epoch': 15, 'num_users': 5.8621, 'loss': 0.0363, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8511, 'compress@10': 1.0, 'time@10': 3.2481}:  93%|█████████▎| 28/30 [01:07<00:06,  3.26s/it]{'epoch': 15, 'num_users': 5.8621, 'loss': 0.0363, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8511, 'compress@10': 1.0, 'time@10': 3.2481}:  97%|█████████▋| 29/30 [01:07<00:02,  2.80s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0363, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 3.2397}:  97%|█████████▋| 29/30 [01:10<00:02,  2.80s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0363, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 3.2397}: 100%|██████████| 30/30 [01:10<00:00,  2.87s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0363, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 3.2397}: 100%|██████████| 30/30 [01:10<00:00,  2.34s/it]
Epoch: 15
Avg # of users: 5.866666666666666
Avg Loss: 0.036253197707451994
Avg hit ratio: 0.842219176373091
Avg ndcg: 0.8529119788535812
Avg compression ratio: 0.9999999860153537
Avg train time: 3.239718770980835
Std train time: 2.0512441520594873
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8536, 'compress@10': 1.0, 'time@10': 3.3214}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8536, 'compress@10': 1.0, 'time@10': 3.3214}:   3%|▎         | 1/30 [00:01<00:49,  1.70s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8726, 'compress@10': 1.0, 'time@10': 2.957}:   3%|▎         | 1/30 [00:04<00:49,  1.70s/it] {'epoch': 16, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8726, 'compress@10': 1.0, 'time@10': 2.957}:   7%|▋         | 2/30 [00:04<01:02,  2.25s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 2.3075}:   7%|▋         | 2/30 [00:04<01:02,  2.25s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 2.3075}:  10%|█         | 3/30 [00:04<00:39,  1.47s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 2.2981}:  10%|█         | 3/30 [00:07<00:39,  1.47s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 2.2981}:  13%|█▎        | 4/30 [00:07<00:46,  1.80s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.035, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8605, 'compress@10': 1.0, 'time@10': 3.5483}:  13%|█▎        | 4/30 [00:11<00:46,  1.80s/it] {'epoch': 16, 'num_users': 5.8, 'loss': 0.035, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8605, 'compress@10': 1.0, 'time@10': 3.5483}:  17%|█▋        | 5/30 [00:11<01:07,  2.71s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0358, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 3.5842}:  17%|█▋        | 5/30 [00:15<01:07,  2.71s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0358, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 3.5842}:  20%|██        | 6/30 [00:15<01:13,  3.08s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0359, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.859, 'compress@10': 1.0, 'time@10': 3.6518}:  20%|██        | 6/30 [00:17<01:13,  3.08s/it] {'epoch': 16, 'num_users': 6.2857, 'loss': 0.0359, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.859, 'compress@10': 1.0, 'time@10': 3.6518}:  23%|██▎       | 7/30 [00:17<01:03,  2.75s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0358, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.8675, 'compress@10': 1.0, 'time@10': 3.5547}:  23%|██▎       | 7/30 [00:20<01:03,  2.75s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0358, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.8675, 'compress@10': 1.0, 'time@10': 3.5547}:  27%|██▋       | 8/30 [00:20<01:01,  2.80s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0346, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 3.8029}:  27%|██▋       | 8/30 [00:23<01:01,  2.80s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0346, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 3.8029}:  30%|███       | 9/30 [00:23<00:59,  2.84s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0338, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8764, 'compress@10': 1.0, 'time@10': 3.7827}:  30%|███       | 9/30 [00:26<00:59,  2.84s/it]  {'epoch': 16, 'num_users': 6.3, 'loss': 0.0338, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8764, 'compress@10': 1.0, 'time@10': 3.7827}:  33%|███▎      | 10/30 [00:26<01:01,  3.09s/it]{'epoch': 16, 'num_users': 6.6364, 'loss': 0.0361, 'hit_ratio@10': 0.866, 'ndcg@10': 0.8766, 'compress@10': 1.0, 'time@10': 3.8137}:  33%|███▎      | 10/30 [00:28<01:01,  3.09s/it]{'epoch': 16, 'num_users': 6.6364, 'loss': 0.0361, 'hit_ratio@10': 0.866, 'ndcg@10': 0.8766, 'compress@10': 1.0, 'time@10': 3.8137}:  37%|███▋      | 11/30 [00:28<00:52,  2.78s/it]{'epoch': 16, 'num_users': 6.4167, 'loss': 0.0347, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8804, 'compress@10': 1.0, 'time@10': 3.5667}:  37%|███▋      | 11/30 [00:29<00:52,  2.78s/it]{'epoch': 16, 'num_users': 6.4167, 'loss': 0.0347, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8804, 'compress@10': 1.0, 'time@10': 3.5667}:  40%|████      | 12/30 [00:29<00:39,  2.21s/it]{'epoch': 16, 'num_users': 6.6154, 'loss': 0.0355, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8812, 'compress@10': 1.0, 'time@10': 3.5535}:  40%|████      | 12/30 [00:31<00:39,  2.21s/it]{'epoch': 16, 'num_users': 6.6154, 'loss': 0.0355, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8812, 'compress@10': 1.0, 'time@10': 3.5535}:  43%|████▎     | 13/30 [00:31<00:35,  2.06s/it]{'epoch': 16, 'num_users': 6.3571, 'loss': 0.035, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8748, 'compress@10': 1.0, 'time@10': 3.3265}:  43%|████▎     | 13/30 [00:31<00:35,  2.06s/it] {'epoch': 16, 'num_users': 6.3571, 'loss': 0.035, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8748, 'compress@10': 1.0, 'time@10': 3.3265}:  47%|████▋     | 14/30 [00:31<00:25,  1.56s/it]{'epoch': 16, 'num_users': 6.2667, 'loss': 0.0354, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8746, 'compress@10': 1.0, 'time@10': 3.4189}:  47%|████▋     | 14/30 [00:34<00:25,  1.56s/it]{'epoch': 16, 'num_users': 6.2667, 'loss': 0.0354, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8746, 'compress@10': 1.0, 'time@10': 3.4189}:  50%|█████     | 15/30 [00:34<00:27,  1.81s/it]{'epoch': 16, 'num_users': 6.0625, 'loss': 0.0341, 'hit_ratio@10': 0.8401, 'ndcg@10': 0.8748, 'compress@10': 1.0, 'time@10': 3.2615}:  50%|█████     | 15/30 [00:35<00:27,  1.81s/it]{'epoch': 16, 'num_users': 6.0625, 'loss': 0.0341, 'hit_ratio@10': 0.8401, 'ndcg@10': 0.8748, 'compress@10': 1.0, 'time@10': 3.2615}:  53%|█████▎    | 16/30 [00:35<00:21,  1.55s/it]{'epoch': 16, 'num_users': 5.8235, 'loss': 0.0337, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 3.1073}:  53%|█████▎    | 16/30 [00:35<00:21,  1.55s/it] {'epoch': 16, 'num_users': 5.8235, 'loss': 0.0337, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 3.1073}:  57%|█████▋    | 17/30 [00:35<00:15,  1.19s/it]{'epoch': 16, 'num_users': 6.0556, 'loss': 0.0341, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8667, 'compress@10': 1.0, 'time@10': 3.0641}:  57%|█████▋    | 17/30 [00:38<00:15,  1.19s/it]{'epoch': 16, 'num_users': 6.0556, 'loss': 0.0341, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8667, 'compress@10': 1.0, 'time@10': 3.0641}:  60%|██████    | 18/30 [00:38<00:18,  1.54s/it]{'epoch': 16, 'num_users': 6.0, 'loss': 0.0331, 'hit_ratio@10': 0.8255, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 3.0189}:  60%|██████    | 18/30 [00:39<00:18,  1.54s/it]   {'epoch': 16, 'num_users': 6.0, 'loss': 0.0331, 'hit_ratio@10': 0.8255, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 3.0189}:  63%|██████▎   | 19/30 [00:39<00:15,  1.42s/it]{'epoch': 16, 'num_users': 6.15, 'loss': 0.0331, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8698, 'compress@10': 1.0, 'time@10': 3.1093}:  63%|██████▎   | 19/30 [00:44<00:15,  1.42s/it]{'epoch': 16, 'num_users': 6.15, 'loss': 0.0331, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8698, 'compress@10': 1.0, 'time@10': 3.1093}:  67%|██████▋   | 20/30 [00:44<00:24,  2.46s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0339, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.8692, 'compress@10': 1.0, 'time@10': 3.3017}:  67%|██████▋   | 20/30 [00:47<00:24,  2.46s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0339, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.8692, 'compress@10': 1.0, 'time@10': 3.3017}:  70%|███████   | 21/30 [00:47<00:25,  2.81s/it]{'epoch': 16, 'num_users': 6.1818, 'loss': 0.0343, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8703, 'compress@10': 1.0, 'time@10': 3.23}:  70%|███████   | 21/30 [00:49<00:25,  2.81s/it]  {'epoch': 16, 'num_users': 6.1818, 'loss': 0.0343, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8703, 'compress@10': 1.0, 'time@10': 3.23}:  73%|███████▎  | 22/30 [00:49<00:19,  2.50s/it]{'epoch': 16, 'num_users': 6.1304, 'loss': 0.0337, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 3.2255}:  73%|███████▎  | 22/30 [00:51<00:19,  2.50s/it]{'epoch': 16, 'num_users': 6.1304, 'loss': 0.0337, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 3.2255}:  77%|███████▋  | 23/30 [00:51<00:15,  2.23s/it]{'epoch': 16, 'num_users': 5.9583, 'loss': 0.0346, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8612, 'compress@10': 1.0, 'time@10': 3.1045}:  77%|███████▋  | 23/30 [00:51<00:15,  2.23s/it] {'epoch': 16, 'num_users': 5.9583, 'loss': 0.0346, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8612, 'compress@10': 1.0, 'time@10': 3.1045}:  80%|████████  | 24/30 [00:51<00:10,  1.67s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0354, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8448, 'compress@10': 1.0, 'time@10': 2.9923}:  80%|████████  | 24/30 [00:51<00:10,  1.67s/it]  {'epoch': 16, 'num_users': 5.8, 'loss': 0.0354, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8448, 'compress@10': 1.0, 'time@10': 2.9923}:  83%|████████▎ | 25/30 [00:51<00:06,  1.22s/it]{'epoch': 16, 'num_users': 5.8077, 'loss': 0.0347, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8486, 'compress@10': 1.0, 'time@10': 3.1284}:  83%|████████▎ | 25/30 [00:58<00:06,  1.22s/it]{'epoch': 16, 'num_users': 5.8077, 'loss': 0.0347, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8486, 'compress@10': 1.0, 'time@10': 3.1284}:  87%|████████▋ | 26/30 [00:58<00:11,  2.83s/it]{'epoch': 16, 'num_users': 5.8889, 'loss': 0.0342, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8506, 'compress@10': 1.0, 'time@10': 3.1877}:  87%|████████▋ | 26/30 [01:00<00:11,  2.83s/it]{'epoch': 16, 'num_users': 5.8889, 'loss': 0.0342, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8506, 'compress@10': 1.0, 'time@10': 3.1877}:  90%|█████████ | 27/30 [01:00<00:08,  2.70s/it]{'epoch': 16, 'num_users': 6.0, 'loss': 0.0341, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8521, 'compress@10': 1.0, 'time@10': 3.2275}:  90%|█████████ | 27/30 [01:04<00:08,  2.70s/it]   {'epoch': 16, 'num_users': 6.0, 'loss': 0.0341, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8521, 'compress@10': 1.0, 'time@10': 3.2275}:  93%|█████████▎| 28/30 [01:04<00:06,  3.19s/it]{'epoch': 16, 'num_users': 5.8621, 'loss': 0.0338, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8541, 'compress@10': 1.0, 'time@10': 3.233}:  93%|█████████▎| 28/30 [01:06<00:06,  3.19s/it]{'epoch': 16, 'num_users': 5.8621, 'loss': 0.0338, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8541, 'compress@10': 1.0, 'time@10': 3.233}:  97%|█████████▋| 29/30 [01:06<00:02,  2.75s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0338, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 3.2258}:  97%|█████████▋| 29/30 [01:09<00:02,  2.75s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0338, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 3.2258}: 100%|██████████| 30/30 [01:09<00:00,  2.84s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0338, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 3.2258}: 100%|██████████| 30/30 [01:09<00:00,  2.32s/it]
Epoch: 16
Avg # of users: 5.866666666666666
Avg Loss: 0.03376061172626384
Avg hit ratio: 0.842863775676227
Avg ndcg: 0.8560064545092155
Avg compression ratio: 0.9999999860153537
Avg train time: 3.225833455721537
Std train time: 2.039502722615721
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 3.0838}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 3.0838}:   3%|▎         | 1/30 [00:01<00:45,  1.58s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0381, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8797, 'compress@10': 1.0, 'time@10': 2.8219}:   3%|▎         | 1/30 [00:04<00:45,  1.58s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0381, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8797, 'compress@10': 1.0, 'time@10': 2.8219}:   7%|▋         | 2/30 [00:04<01:00,  2.18s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 2.2077}:   7%|▋         | 2/30 [00:04<01:00,  2.18s/it]  {'epoch': 17, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 2.2077}:  10%|█         | 3/30 [00:04<00:38,  1.42s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 2.2228}:  10%|█         | 3/30 [00:07<00:38,  1.42s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 2.2228}:  13%|█▎        | 4/30 [00:07<00:46,  1.77s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0333, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 3.4516}:  13%|█▎        | 4/30 [00:11<00:46,  1.77s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0333, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 3.4516}:  17%|█▋        | 5/30 [00:11<01:06,  2.65s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0343, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8634, 'compress@10': 1.0, 'time@10': 3.4911}:  17%|█▋        | 5/30 [00:14<01:06,  2.65s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0343, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8634, 'compress@10': 1.0, 'time@10': 3.4911}:  20%|██        | 6/30 [00:14<01:12,  3.02s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 3.5701}:  20%|██        | 6/30 [00:17<01:12,  3.02s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 3.5701}:  23%|██▎       | 7/30 [00:17<01:02,  2.71s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0344, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.8765, 'compress@10': 1.0, 'time@10': 3.4808}:  23%|██▎       | 7/30 [00:19<01:02,  2.71s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0344, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.8765, 'compress@10': 1.0, 'time@10': 3.4808}:  27%|██▋       | 8/30 [00:19<01:00,  2.76s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0351, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8834, 'compress@10': 1.0, 'time@10': 3.731}:  27%|██▋       | 8/30 [00:22<01:00,  2.76s/it] {'epoch': 17, 'num_users': 6.3333, 'loss': 0.0351, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8834, 'compress@10': 1.0, 'time@10': 3.731}:  30%|███       | 9/30 [00:22<00:58,  2.81s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0341, 'hit_ratio@10': 0.878, 'ndcg@10': 0.8875, 'compress@10': 1.0, 'time@10': 3.7253}:  30%|███       | 9/30 [00:26<00:58,  2.81s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0341, 'hit_ratio@10': 0.878, 'ndcg@10': 0.8875, 'compress@10': 1.0, 'time@10': 3.7253}:  33%|███▎      | 10/30 [00:26<01:01,  3.09s/it]{'epoch': 17, 'num_users': 6.6364, 'loss': 0.037, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 3.7906}:  33%|███▎      | 10/30 [00:28<01:01,  3.09s/it]{'epoch': 17, 'num_users': 6.6364, 'loss': 0.037, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 3.7906}:  37%|███▋      | 11/30 [00:28<00:53,  2.83s/it]{'epoch': 17, 'num_users': 6.4167, 'loss': 0.0356, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 3.5518}:  37%|███▋      | 11/30 [00:29<00:53,  2.83s/it]{'epoch': 17, 'num_users': 6.4167, 'loss': 0.0356, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 3.5518}:  40%|████      | 12/30 [00:29<00:40,  2.27s/it]{'epoch': 17, 'num_users': 6.6154, 'loss': 0.0362, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8907, 'compress@10': 1.0, 'time@10': 3.5599}:  40%|████      | 12/30 [00:31<00:40,  2.27s/it]{'epoch': 17, 'num_users': 6.6154, 'loss': 0.0362, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8907, 'compress@10': 1.0, 'time@10': 3.5599}:  43%|████▎     | 13/30 [00:31<00:36,  2.15s/it]{'epoch': 17, 'num_users': 6.3571, 'loss': 0.0354, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8836, 'compress@10': 1.0, 'time@10': 3.3354}:  43%|████▎     | 13/30 [00:32<00:36,  2.15s/it]{'epoch': 17, 'num_users': 6.3571, 'loss': 0.0354, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8836, 'compress@10': 1.0, 'time@10': 3.3354}:  47%|████▋     | 14/30 [00:32<00:26,  1.64s/it]{'epoch': 17, 'num_users': 6.2667, 'loss': 0.0358, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 3.4571}:  47%|████▋     | 14/30 [00:34<00:26,  1.64s/it] {'epoch': 17, 'num_users': 6.2667, 'loss': 0.0358, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 3.4571}:  50%|█████     | 15/30 [00:34<00:28,  1.93s/it]{'epoch': 17, 'num_users': 6.0625, 'loss': 0.0345, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8828, 'compress@10': 1.0, 'time@10': 3.297}:  50%|█████     | 15/30 [00:35<00:28,  1.93s/it]{'epoch': 17, 'num_users': 6.0625, 'loss': 0.0345, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8828, 'compress@10': 1.0, 'time@10': 3.297}:  53%|█████▎    | 16/30 [00:35<00:22,  1.63s/it]{'epoch': 17, 'num_users': 5.8235, 'loss': 0.034, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.874, 'compress@10': 1.0, 'time@10': 3.1419}:  53%|█████▎    | 16/30 [00:35<00:22,  1.63s/it] {'epoch': 17, 'num_users': 5.8235, 'loss': 0.034, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.874, 'compress@10': 1.0, 'time@10': 3.1419}:  57%|█████▋    | 17/30 [00:35<00:16,  1.25s/it]{'epoch': 17, 'num_users': 6.0556, 'loss': 0.0343, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8751, 'compress@10': 1.0, 'time@10': 3.0995}:  57%|█████▋    | 17/30 [00:38<00:16,  1.25s/it]{'epoch': 17, 'num_users': 6.0556, 'loss': 0.0343, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8751, 'compress@10': 1.0, 'time@10': 3.0995}:  60%|██████    | 18/30 [00:38<00:19,  1.60s/it]{'epoch': 17, 'num_users': 6.0, 'loss': 0.0333, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8764, 'compress@10': 1.0, 'time@10': 3.0512}:  60%|██████    | 18/30 [00:39<00:19,  1.60s/it]  {'epoch': 17, 'num_users': 6.0, 'loss': 0.0333, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8764, 'compress@10': 1.0, 'time@10': 3.0512}:  63%|██████▎   | 19/30 [00:39<00:16,  1.46s/it]{'epoch': 17, 'num_users': 6.15, 'loss': 0.0332, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8776, 'compress@10': 1.0, 'time@10': 3.1405}:  63%|██████▎   | 19/30 [00:44<00:16,  1.46s/it]{'epoch': 17, 'num_users': 6.15, 'loss': 0.0332, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8776, 'compress@10': 1.0, 'time@10': 3.1405}:  67%|██████▋   | 20/30 [00:44<00:24,  2.48s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0338, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 3.3149}:  67%|██████▋   | 20/30 [00:47<00:24,  2.48s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0338, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 3.3149}:  70%|███████   | 21/30 [00:47<00:24,  2.77s/it]{'epoch': 17, 'num_users': 6.1818, 'loss': 0.0342, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8778, 'compress@10': 1.0, 'time@10': 3.2434}:  70%|███████   | 21/30 [00:49<00:24,  2.77s/it]{'epoch': 17, 'num_users': 6.1818, 'loss': 0.0342, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8778, 'compress@10': 1.0, 'time@10': 3.2434}:  73%|███████▎  | 22/30 [00:49<00:19,  2.47s/it]{'epoch': 17, 'num_users': 6.1304, 'loss': 0.0337, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.8791, 'compress@10': 1.0, 'time@10': 3.2428}:  73%|███████▎  | 22/30 [00:51<00:19,  2.47s/it]{'epoch': 17, 'num_users': 6.1304, 'loss': 0.0337, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.8791, 'compress@10': 1.0, 'time@10': 3.2428}:  77%|███████▋  | 23/30 [00:51<00:15,  2.23s/it]{'epoch': 17, 'num_users': 5.9583, 'loss': 0.0344, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8681, 'compress@10': 1.0, 'time@10': 3.1215}:  77%|███████▋  | 23/30 [00:51<00:15,  2.23s/it] {'epoch': 17, 'num_users': 5.9583, 'loss': 0.0344, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8681, 'compress@10': 1.0, 'time@10': 3.1215}:  80%|████████  | 24/30 [00:51<00:10,  1.67s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0352, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 3.0102}:  80%|████████  | 24/30 [00:51<00:10,  1.67s/it]  {'epoch': 17, 'num_users': 5.8, 'loss': 0.0352, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 3.0102}:  83%|████████▎ | 25/30 [00:51<00:06,  1.23s/it]{'epoch': 17, 'num_users': 5.8077, 'loss': 0.0344, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8551, 'compress@10': 1.0, 'time@10': 3.1445}:  83%|████████▎ | 25/30 [00:58<00:06,  1.23s/it]{'epoch': 17, 'num_users': 5.8077, 'loss': 0.0344, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8551, 'compress@10': 1.0, 'time@10': 3.1445}:  87%|████████▋ | 26/30 [00:58<00:11,  2.82s/it]{'epoch': 17, 'num_users': 5.8889, 'loss': 0.0341, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8563, 'compress@10': 1.0, 'time@10': 3.1891}:  87%|████████▋ | 26/30 [01:00<00:11,  2.82s/it]{'epoch': 17, 'num_users': 5.8889, 'loss': 0.0341, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8563, 'compress@10': 1.0, 'time@10': 3.1891}:  90%|█████████ | 27/30 [01:00<00:07,  2.64s/it]{'epoch': 17, 'num_users': 6.0, 'loss': 0.0339, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8575, 'compress@10': 1.0, 'time@10': 3.2292}:  90%|█████████ | 27/30 [01:04<00:07,  2.64s/it]   {'epoch': 17, 'num_users': 6.0, 'loss': 0.0339, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8575, 'compress@10': 1.0, 'time@10': 3.2292}:  93%|█████████▎| 28/30 [01:04<00:06,  3.15s/it]{'epoch': 17, 'num_users': 5.8621, 'loss': 0.0336, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8594, 'compress@10': 1.0, 'time@10': 3.2303}:  93%|█████████▎| 28/30 [01:06<00:06,  3.15s/it]{'epoch': 17, 'num_users': 5.8621, 'loss': 0.0336, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8594, 'compress@10': 1.0, 'time@10': 3.2303}:  97%|█████████▋| 29/30 [01:06<00:02,  2.71s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.0336, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 3.2183}:  97%|█████████▋| 29/30 [01:09<00:02,  2.71s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.0336, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 3.2183}: 100%|██████████| 30/30 [01:09<00:00,  2.77s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.0336, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 3.2183}: 100%|██████████| 30/30 [01:09<00:00,  2.32s/it]
Epoch: 17
Avg # of users: 5.866666666666666
Avg Loss: 0.03362415457083126
Avg hit ratio: 0.8449490816029962
Avg ndcg: 0.8608950113556199
Avg compression ratio: 0.9999999860153537
Avg train time: 3.218282779057821
Std train time: 2.003176877962695
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 3.0895}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 3.0895}:   3%|▎         | 1/30 [00:01<00:45,  1.58s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0381, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8738, 'compress@10': 1.0, 'time@10': 2.834}:   3%|▎         | 1/30 [00:04<00:45,  1.58s/it] {'epoch': 18, 'num_users': 7.0, 'loss': 0.0381, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8738, 'compress@10': 1.0, 'time@10': 2.834}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8661, 'compress@10': 1.0, 'time@10': 2.2129}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8661, 'compress@10': 1.0, 'time@10': 2.2129}:  10%|█         | 3/30 [00:04<00:38,  1.43s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 2.224}:  10%|█         | 3/30 [00:07<00:38,  1.43s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 2.224}:  13%|█▎        | 4/30 [00:07<00:46,  1.77s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 3.4648}:  13%|█▎        | 4/30 [00:11<00:46,  1.77s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 3.4648}:  17%|█▋        | 5/30 [00:11<01:06,  2.67s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0317, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 3.5187}:  17%|█▋        | 5/30 [00:15<01:06,  2.67s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0317, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 3.5187}:  20%|██        | 6/30 [00:15<01:13,  3.06s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.032, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8672, 'compress@10': 1.0, 'time@10': 3.5973}:  20%|██        | 6/30 [00:17<01:13,  3.06s/it] {'epoch': 18, 'num_users': 6.2857, 'loss': 0.032, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8672, 'compress@10': 1.0, 'time@10': 3.5973}:  23%|██▎       | 7/30 [00:17<01:03,  2.74s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0323, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.8756, 'compress@10': 1.0, 'time@10': 3.5162}:  23%|██▎       | 7/30 [00:20<01:03,  2.74s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0323, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.8756, 'compress@10': 1.0, 'time@10': 3.5162}:  27%|██▋       | 8/30 [00:20<01:02,  2.82s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0314, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8813, 'compress@10': 1.0, 'time@10': 3.7814}:  27%|██▋       | 8/30 [00:23<01:02,  2.82s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0314, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8813, 'compress@10': 1.0, 'time@10': 3.7814}:  30%|███       | 9/30 [00:23<01:00,  2.87s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.87, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 3.764}:  30%|███       | 9/30 [00:26<01:00,  2.87s/it]      {'epoch': 18, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.87, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 3.764}:  33%|███▎      | 10/30 [00:26<01:02,  3.11s/it]{'epoch': 18, 'num_users': 6.6364, 'loss': 0.0341, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 3.8173}:  33%|███▎      | 10/30 [00:29<01:02,  3.11s/it]{'epoch': 18, 'num_users': 6.6364, 'loss': 0.0341, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 3.8173}:  37%|███▋      | 11/30 [00:29<00:53,  2.84s/it]{'epoch': 18, 'num_users': 6.4167, 'loss': 0.0329, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8838, 'compress@10': 1.0, 'time@10': 3.5757}:  37%|███▋      | 11/30 [00:29<00:53,  2.84s/it]{'epoch': 18, 'num_users': 6.4167, 'loss': 0.0329, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8838, 'compress@10': 1.0, 'time@10': 3.5757}:  40%|████      | 12/30 [00:29<00:40,  2.26s/it]{'epoch': 18, 'num_users': 6.6154, 'loss': 0.0336, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8844, 'compress@10': 1.0, 'time@10': 3.5788}:  40%|████      | 12/30 [00:31<00:40,  2.26s/it]{'epoch': 18, 'num_users': 6.6154, 'loss': 0.0336, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8844, 'compress@10': 1.0, 'time@10': 3.5788}:  43%|████▎     | 13/30 [00:31<00:36,  2.14s/it]{'epoch': 18, 'num_users': 6.3571, 'loss': 0.0329, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8778, 'compress@10': 1.0, 'time@10': 3.3532}:  43%|████▎     | 13/30 [00:32<00:36,  2.14s/it]{'epoch': 18, 'num_users': 6.3571, 'loss': 0.0329, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8778, 'compress@10': 1.0, 'time@10': 3.3532}:  47%|████▋     | 14/30 [00:32<00:26,  1.63s/it]{'epoch': 18, 'num_users': 6.2667, 'loss': 0.0334, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 3.4714}:  47%|████▋     | 14/30 [00:34<00:26,  1.63s/it]{'epoch': 18, 'num_users': 6.2667, 'loss': 0.0334, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 3.4714}:  50%|█████     | 15/30 [00:34<00:28,  1.92s/it]{'epoch': 18, 'num_users': 6.0625, 'loss': 0.0322, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 3.3139}:  50%|█████     | 15/30 [00:35<00:28,  1.92s/it]{'epoch': 18, 'num_users': 6.0625, 'loss': 0.0322, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 3.3139}:  53%|█████▎    | 16/30 [00:35<00:22,  1.64s/it]{'epoch': 18, 'num_users': 5.8235, 'loss': 0.0318, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8692, 'compress@10': 1.0, 'time@10': 3.1541}:  53%|█████▎    | 16/30 [00:36<00:22,  1.64s/it]{'epoch': 18, 'num_users': 5.8235, 'loss': 0.0318, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8692, 'compress@10': 1.0, 'time@10': 3.1541}:  57%|█████▋    | 17/30 [00:36<00:16,  1.25s/it]{'epoch': 18, 'num_users': 6.0556, 'loss': 0.0321, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 3.1122}:  57%|█████▋    | 17/30 [00:38<00:16,  1.25s/it]  {'epoch': 18, 'num_users': 6.0556, 'loss': 0.0321, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 3.1122}:  60%|██████    | 18/30 [00:38<00:19,  1.61s/it]{'epoch': 18, 'num_users': 6.0, 'loss': 0.0312, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 3.0697}:  60%|██████    | 18/30 [00:39<00:19,  1.61s/it] {'epoch': 18, 'num_users': 6.0, 'loss': 0.0312, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 3.0697}:  63%|██████▎   | 19/30 [00:39<00:16,  1.48s/it]{'epoch': 18, 'num_users': 6.15, 'loss': 0.0312, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8734, 'compress@10': 1.0, 'time@10': 3.1592}:  63%|██████▎   | 19/30 [00:44<00:16,  1.48s/it]{'epoch': 18, 'num_users': 6.15, 'loss': 0.0312, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8734, 'compress@10': 1.0, 'time@10': 3.1592}:  67%|██████▋   | 20/30 [00:44<00:25,  2.51s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0318, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8732, 'compress@10': 1.0, 'time@10': 3.343}:  67%|██████▋   | 20/30 [00:48<00:25,  2.51s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0318, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8732, 'compress@10': 1.0, 'time@10': 3.343}:  70%|███████   | 21/30 [00:48<00:25,  2.82s/it]{'epoch': 18, 'num_users': 6.1818, 'loss': 0.0323, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 3.2727}:  70%|███████   | 21/30 [00:50<00:25,  2.82s/it]{'epoch': 18, 'num_users': 6.1818, 'loss': 0.0323, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 3.2727}:  73%|███████▎  | 22/30 [00:50<00:20,  2.52s/it]{'epoch': 18, 'num_users': 6.1304, 'loss': 0.0318, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8759, 'compress@10': 1.0, 'time@10': 3.2691}:  73%|███████▎  | 22/30 [00:51<00:20,  2.52s/it]{'epoch': 18, 'num_users': 6.1304, 'loss': 0.0318, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8759, 'compress@10': 1.0, 'time@10': 3.2691}:  77%|███████▋  | 23/30 [00:51<00:15,  2.26s/it]{'epoch': 18, 'num_users': 5.9583, 'loss': 0.0326, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 3.1468}:  77%|███████▋  | 23/30 [00:52<00:15,  2.26s/it]{'epoch': 18, 'num_users': 5.9583, 'loss': 0.0326, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 3.1468}:  80%|████████  | 24/30 [00:52<00:10,  1.69s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0333, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8485, 'compress@10': 1.0, 'time@10': 3.0341}:  80%|████████  | 24/30 [00:52<00:10,  1.69s/it]    {'epoch': 18, 'num_users': 5.8, 'loss': 0.0333, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8485, 'compress@10': 1.0, 'time@10': 3.0341}:  83%|████████▎ | 25/30 [00:52<00:06,  1.24s/it]{'epoch': 18, 'num_users': 5.8077, 'loss': 0.0325, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8526, 'compress@10': 1.0, 'time@10': 3.1826}:  83%|████████▎ | 25/30 [00:59<00:06,  1.24s/it]{'epoch': 18, 'num_users': 5.8077, 'loss': 0.0325, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8526, 'compress@10': 1.0, 'time@10': 3.1826}:  87%|████████▋ | 26/30 [00:59<00:11,  2.95s/it]{'epoch': 18, 'num_users': 5.8889, 'loss': 0.0326, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8533, 'compress@10': 1.0, 'time@10': 3.2461}:  87%|████████▋ | 26/30 [01:01<00:11,  2.95s/it] {'epoch': 18, 'num_users': 5.8889, 'loss': 0.0326, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8533, 'compress@10': 1.0, 'time@10': 3.2461}:  90%|█████████ | 27/30 [01:01<00:08,  2.81s/it]{'epoch': 18, 'num_users': 6.0, 'loss': 0.0326, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8546, 'compress@10': 1.0, 'time@10': 3.2841}:  90%|█████████ | 27/30 [01:06<00:08,  2.81s/it]  {'epoch': 18, 'num_users': 6.0, 'loss': 0.0326, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8546, 'compress@10': 1.0, 'time@10': 3.2841}:  93%|█████████▎| 28/30 [01:06<00:06,  3.27s/it]{'epoch': 18, 'num_users': 5.8621, 'loss': 0.0324, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 3.2899}:  93%|█████████▎| 28/30 [01:07<00:06,  3.27s/it]{'epoch': 18, 'num_users': 5.8621, 'loss': 0.0324, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 3.2899}:  97%|█████████▋| 29/30 [01:07<00:02,  2.82s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0324, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8587, 'compress@10': 1.0, 'time@10': 3.2776}:  97%|█████████▋| 29/30 [01:10<00:02,  2.82s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0324, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8587, 'compress@10': 1.0, 'time@10': 3.2776}: 100%|██████████| 30/30 [01:10<00:00,  2.86s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0324, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8587, 'compress@10': 1.0, 'time@10': 3.2776}: 100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch: 18
Avg # of users: 5.866666666666666
Avg Loss: 0.032375615744191004
Avg hit ratio: 0.8426932480056991
Avg ndcg: 0.8587281631478407
Avg compression ratio: 0.9999999860153537
Avg train time: 3.277636996905009
Std train time: 2.0584467396458104
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 3.125}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 3.125}:   3%|▎         | 1/30 [00:01<00:46,  1.62s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8794, 'compress@10': 1.0, 'time@10': 2.9069}:   3%|▎         | 1/30 [00:04<00:46,  1.62s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8794, 'compress@10': 1.0, 'time@10': 2.9069}:   7%|▋         | 2/30 [00:04<01:13,  2.62s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8698, 'compress@10': 1.0, 'time@10': 2.2706}:   7%|▋         | 2/30 [00:05<01:13,  2.62s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8698, 'compress@10': 1.0, 'time@10': 2.2706}:  10%|█         | 3/30 [00:05<00:44,  1.67s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 2.2967}:  10%|█         | 3/30 [00:07<00:44,  1.67s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 2.2967}:  13%|█▎        | 4/30 [00:07<00:50,  1.96s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0283, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8695, 'compress@10': 1.0, 'time@10': 3.471}:  13%|█▎        | 4/30 [00:12<00:50,  1.96s/it] {'epoch': 19, 'num_users': 5.8, 'loss': 0.0283, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8695, 'compress@10': 1.0, 'time@10': 3.471}:  17%|█▋        | 5/30 [00:12<01:08,  2.74s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0294, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.871, 'compress@10': 1.0, 'time@10': 3.4808}:  17%|█▋        | 5/30 [00:15<01:08,  2.74s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0294, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.871, 'compress@10': 1.0, 'time@10': 3.4808}:  20%|██        | 6/30 [00:15<01:12,  3.02s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0296, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 3.5536}:  20%|██        | 6/30 [00:17<01:12,  3.02s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0296, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 3.5536}:  23%|██▎       | 7/30 [00:17<01:02,  2.70s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0299, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 3.4644}:  23%|██▎       | 7/30 [00:20<01:02,  2.70s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0299, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 3.4644}:  27%|██▋       | 8/30 [00:20<01:00,  2.76s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0307, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 3.7217}:  27%|██▋       | 8/30 [00:23<01:00,  2.76s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0307, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 3.7217}:  30%|███       | 9/30 [00:23<00:58,  2.81s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 3.7119}:  30%|███       | 9/30 [00:27<00:58,  2.81s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 3.7119}:  33%|███▎      | 10/30 [00:27<01:01,  3.07s/it]{'epoch': 19, 'num_users': 6.6364, 'loss': 0.0306, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8959, 'compress@10': 1.0, 'time@10': 3.7757}:  33%|███▎      | 10/30 [00:29<01:01,  3.07s/it]{'epoch': 19, 'num_users': 6.6364, 'loss': 0.0306, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8959, 'compress@10': 1.0, 'time@10': 3.7757}:  37%|███▋      | 11/30 [00:29<00:53,  2.82s/it]{'epoch': 19, 'num_users': 6.4167, 'loss': 0.0296, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.5375}:  37%|███▋      | 11/30 [00:30<00:53,  2.82s/it] {'epoch': 19, 'num_users': 6.4167, 'loss': 0.0296, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.5375}:  40%|████      | 12/30 [00:30<00:40,  2.25s/it]{'epoch': 19, 'num_users': 6.6154, 'loss': 0.0304, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.896, 'compress@10': 1.0, 'time@10': 3.5448}:  40%|████      | 12/30 [00:32<00:40,  2.25s/it]{'epoch': 19, 'num_users': 6.6154, 'loss': 0.0304, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.896, 'compress@10': 1.0, 'time@10': 3.5448}:  43%|████▎     | 13/30 [00:32<00:36,  2.13s/it]{'epoch': 19, 'num_users': 6.3571, 'loss': 0.0299, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.3207}:  43%|████▎     | 13/30 [00:32<00:36,  2.13s/it]{'epoch': 19, 'num_users': 6.3571, 'loss': 0.0299, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.3207}:  47%|████▋     | 14/30 [00:32<00:25,  1.62s/it]{'epoch': 19, 'num_users': 6.2667, 'loss': 0.0306, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8882, 'compress@10': 1.0, 'time@10': 3.435}:  47%|████▋     | 14/30 [00:35<00:25,  1.62s/it]  {'epoch': 19, 'num_users': 6.2667, 'loss': 0.0306, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8882, 'compress@10': 1.0, 'time@10': 3.435}:  50%|█████     | 15/30 [00:35<00:28,  1.90s/it]{'epoch': 19, 'num_users': 6.0625, 'loss': 0.0296, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8875, 'compress@10': 1.0, 'time@10': 3.2763}:  50%|█████     | 15/30 [00:36<00:28,  1.90s/it]{'epoch': 19, 'num_users': 6.0625, 'loss': 0.0296, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8875, 'compress@10': 1.0, 'time@10': 3.2763}:  53%|█████▎    | 16/30 [00:36<00:22,  1.61s/it]{'epoch': 19, 'num_users': 5.8235, 'loss': 0.0292, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 3.1231}:  53%|█████▎    | 16/30 [00:36<00:22,  1.61s/it]{'epoch': 19, 'num_users': 5.8235, 'loss': 0.0292, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 3.1231}:  57%|█████▋    | 17/30 [00:36<00:16,  1.24s/it]{'epoch': 19, 'num_users': 6.0556, 'loss': 0.0296, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8791, 'compress@10': 1.0, 'time@10': 3.081}:  57%|█████▋    | 17/30 [00:38<00:16,  1.24s/it]  {'epoch': 19, 'num_users': 6.0556, 'loss': 0.0296, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8791, 'compress@10': 1.0, 'time@10': 3.081}:  60%|██████    | 18/30 [00:38<00:19,  1.59s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 0.0288, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 3.0346}:  60%|██████    | 18/30 [00:39<00:19,  1.59s/it] {'epoch': 19, 'num_users': 6.0, 'loss': 0.0288, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 3.0346}:  63%|██████▎   | 19/30 [00:39<00:15,  1.45s/it]{'epoch': 19, 'num_users': 6.15, 'loss': 0.0289, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 3.1267}:  63%|██████▎   | 19/30 [00:44<00:15,  1.45s/it]{'epoch': 19, 'num_users': 6.15, 'loss': 0.0289, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 3.1267}:  67%|██████▋   | 20/30 [00:44<00:24,  2.49s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0296, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 3.299}:  67%|██████▋   | 20/30 [00:48<00:24,  2.49s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0296, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 3.299}:  70%|███████   | 21/30 [00:48<00:24,  2.77s/it]{'epoch': 19, 'num_users': 6.1818, 'loss': 0.0301, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 3.2265}:  70%|███████   | 21/30 [00:50<00:24,  2.77s/it]{'epoch': 19, 'num_users': 6.1818, 'loss': 0.0301, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 3.2265}:  73%|███████▎  | 22/30 [00:50<00:19,  2.46s/it]{'epoch': 19, 'num_users': 6.1304, 'loss': 0.0297, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8834, 'compress@10': 1.0, 'time@10': 3.2241}:  73%|███████▎  | 22/30 [00:51<00:19,  2.46s/it]{'epoch': 19, 'num_users': 6.1304, 'loss': 0.0297, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8834, 'compress@10': 1.0, 'time@10': 3.2241}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it]{'epoch': 19, 'num_users': 5.9583, 'loss': 0.0305, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8722, 'compress@10': 1.0, 'time@10': 3.1036}:  77%|███████▋  | 23/30 [00:52<00:15,  2.21s/it]{'epoch': 19, 'num_users': 5.9583, 'loss': 0.0305, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8722, 'compress@10': 1.0, 'time@10': 3.1036}:  80%|████████  | 24/30 [00:52<00:09,  1.66s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0312, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 2.9928}:  80%|████████  | 24/30 [00:52<00:09,  1.66s/it]   {'epoch': 19, 'num_users': 5.8, 'loss': 0.0312, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 2.9928}:  83%|████████▎ | 25/30 [00:52<00:06,  1.22s/it]{'epoch': 19, 'num_users': 5.8077, 'loss': 0.0305, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.8595, 'compress@10': 1.0, 'time@10': 3.1354}:  83%|████████▎ | 25/30 [00:58<00:06,  1.22s/it]{'epoch': 19, 'num_users': 5.8077, 'loss': 0.0305, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.8595, 'compress@10': 1.0, 'time@10': 3.1354}:  87%|████████▋ | 26/30 [00:58<00:11,  2.87s/it]{'epoch': 19, 'num_users': 5.8889, 'loss': 0.031, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.8591, 'compress@10': 1.0, 'time@10': 3.1851}:  87%|████████▋ | 26/30 [01:01<00:11,  2.87s/it] {'epoch': 19, 'num_users': 5.8889, 'loss': 0.031, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.8591, 'compress@10': 1.0, 'time@10': 3.1851}:  90%|█████████ | 27/30 [01:01<00:08,  2.70s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 0.0309, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 3.2264}:  90%|█████████ | 27/30 [01:05<00:08,  2.70s/it]  {'epoch': 19, 'num_users': 6.0, 'loss': 0.0309, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 3.2264}:  93%|█████████▎| 28/30 [01:05<00:06,  3.20s/it]{'epoch': 19, 'num_users': 5.8621, 'loss': 0.0306, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 3.2322}:  93%|█████████▎| 28/30 [01:07<00:06,  3.20s/it]{'epoch': 19, 'num_users': 5.8621, 'loss': 0.0306, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 3.2322}:  97%|█████████▋| 29/30 [01:07<00:02,  2.76s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0306, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8634, 'compress@10': 1.0, 'time@10': 3.2224}:  97%|█████████▋| 29/30 [01:10<00:02,  2.76s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0306, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8634, 'compress@10': 1.0, 'time@10': 3.2224}: 100%|██████████| 30/30 [01:10<00:00,  2.83s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0306, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8634, 'compress@10': 1.0, 'time@10': 3.2224}: 100%|██████████| 30/30 [01:10<00:00,  2.34s/it]
Epoch: 19
Avg # of users: 5.866666666666666
Avg Loss: 0.030610330940600096
Avg hit ratio: 0.8511306755607738
Avg ndcg: 0.8634219933454974
Avg compression ratio: 0.9999999860153537
Avg train time: 3.222411362330119
Std train time: 1.9911929044667511
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.867, 'compress@10': 1.0, 'time@10': 3.0878}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.867, 'compress@10': 1.0, 'time@10': 3.0878}:   3%|▎         | 1/30 [00:01<00:45,  1.58s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.035, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8799, 'compress@10': 1.0, 'time@10': 2.8327}:   3%|▎         | 1/30 [00:04<00:45,  1.58s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.035, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8799, 'compress@10': 1.0, 'time@10': 2.8327}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 2.2101}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 2.2101}:  10%|█         | 3/30 [00:04<00:38,  1.43s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 2.2092}:  10%|█         | 3/30 [00:06<00:38,  1.43s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 2.2092}:  13%|█▎        | 4/30 [00:06<00:45,  1.75s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0289, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8725, 'compress@10': 1.0, 'time@10': 3.446}:  13%|█▎        | 4/30 [00:11<00:45,  1.75s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.0289, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8725, 'compress@10': 1.0, 'time@10': 3.446}:  17%|█▋        | 5/30 [00:11<01:06,  2.65s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0299, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8739, 'compress@10': 1.0, 'time@10': 3.5092}:  17%|█▋        | 5/30 [00:15<01:06,  2.65s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0299, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8739, 'compress@10': 1.0, 'time@10': 3.5092}:  20%|██        | 6/30 [00:15<01:13,  3.06s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0305, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8764, 'compress@10': 1.0, 'time@10': 3.5923}:  20%|██        | 6/30 [00:17<01:13,  3.06s/it] {'epoch': 20, 'num_users': 6.2857, 'loss': 0.0305, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8764, 'compress@10': 1.0, 'time@10': 3.5923}:  23%|██▎       | 7/30 [00:17<01:03,  2.74s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0305, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8826, 'compress@10': 1.0, 'time@10': 3.4984}:  23%|██▎       | 7/30 [00:20<01:03,  2.74s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0305, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8826, 'compress@10': 1.0, 'time@10': 3.4984}:  27%|██▋       | 8/30 [00:20<01:01,  2.78s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0315, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8812, 'compress@10': 1.0, 'time@10': 3.755}:  27%|██▋       | 8/30 [00:22<01:01,  2.78s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0315, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8812, 'compress@10': 1.0, 'time@10': 3.755}:  30%|███       | 9/30 [00:22<00:59,  2.83s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8855, 'compress@10': 1.0, 'time@10': 3.7403}:  30%|███       | 9/30 [00:26<00:59,  2.83s/it]  {'epoch': 20, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8855, 'compress@10': 1.0, 'time@10': 3.7403}:  33%|███▎      | 10/30 [00:26<01:01,  3.08s/it]{'epoch': 20, 'num_users': 6.6364, 'loss': 0.0322, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 3.7994}:  33%|███▎      | 10/30 [00:28<01:01,  3.08s/it]{'epoch': 20, 'num_users': 6.6364, 'loss': 0.0322, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 3.7994}:  37%|███▋      | 11/30 [00:28<00:53,  2.82s/it]{'epoch': 20, 'num_users': 6.4167, 'loss': 0.0311, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8869, 'compress@10': 1.0, 'time@10': 3.5582}:  37%|███▋      | 11/30 [00:29<00:53,  2.82s/it] {'epoch': 20, 'num_users': 6.4167, 'loss': 0.0311, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8869, 'compress@10': 1.0, 'time@10': 3.5582}:  40%|████      | 12/30 [00:29<00:40,  2.25s/it]{'epoch': 20, 'num_users': 6.6154, 'loss': 0.0318, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8874, 'compress@10': 1.0, 'time@10': 3.5708}:  40%|████      | 12/30 [00:31<00:40,  2.25s/it]{'epoch': 20, 'num_users': 6.6154, 'loss': 0.0318, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8874, 'compress@10': 1.0, 'time@10': 3.5708}:  43%|████▎     | 13/30 [00:31<00:36,  2.15s/it]{'epoch': 20, 'num_users': 6.3571, 'loss': 0.031, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8805, 'compress@10': 1.0, 'time@10': 3.3446}:  43%|████▎     | 13/30 [00:32<00:36,  2.15s/it] {'epoch': 20, 'num_users': 6.3571, 'loss': 0.031, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8805, 'compress@10': 1.0, 'time@10': 3.3446}:  47%|████▋     | 14/30 [00:32<00:26,  1.63s/it]{'epoch': 20, 'num_users': 6.2667, 'loss': 0.0315, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 3.467}:  47%|████▋     | 14/30 [00:34<00:26,  1.63s/it] {'epoch': 20, 'num_users': 6.2667, 'loss': 0.0315, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 3.467}:  50%|█████     | 15/30 [00:34<00:28,  1.93s/it]{'epoch': 20, 'num_users': 6.0625, 'loss': 0.0304, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8807, 'compress@10': 1.0, 'time@10': 3.3067}:  50%|█████     | 15/30 [00:35<00:28,  1.93s/it]{'epoch': 20, 'num_users': 6.0625, 'loss': 0.0304, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8807, 'compress@10': 1.0, 'time@10': 3.3067}:  53%|█████▎    | 16/30 [00:35<00:22,  1.63s/it]{'epoch': 20, 'num_users': 5.8235, 'loss': 0.0299, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.872, 'compress@10': 1.0, 'time@10': 3.1496}:  53%|█████▎    | 16/30 [00:36<00:22,  1.63s/it] {'epoch': 20, 'num_users': 5.8235, 'loss': 0.0299, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.872, 'compress@10': 1.0, 'time@10': 3.1496}:  57%|█████▋    | 17/30 [00:36<00:16,  1.25s/it]{'epoch': 20, 'num_users': 6.0556, 'loss': 0.0302, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8728, 'compress@10': 1.0, 'time@10': 3.0985}:  57%|█████▋    | 17/30 [00:38<00:16,  1.25s/it]{'epoch': 20, 'num_users': 6.0556, 'loss': 0.0302, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8728, 'compress@10': 1.0, 'time@10': 3.0985}:  60%|██████    | 18/30 [00:38<00:18,  1.55s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 0.0294, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8741, 'compress@10': 1.0, 'time@10': 3.0407}:  60%|██████    | 18/30 [00:39<00:18,  1.55s/it]  {'epoch': 20, 'num_users': 6.0, 'loss': 0.0294, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8741, 'compress@10': 1.0, 'time@10': 3.0407}:  63%|██████▎   | 19/30 [00:39<00:15,  1.40s/it]{'epoch': 20, 'num_users': 6.15, 'loss': 0.0294, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8756, 'compress@10': 1.0, 'time@10': 3.113}:  63%|██████▎   | 19/30 [00:43<00:15,  1.40s/it] {'epoch': 20, 'num_users': 6.15, 'loss': 0.0294, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8756, 'compress@10': 1.0, 'time@10': 3.113}:  67%|██████▋   | 20/30 [00:43<00:23,  2.34s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0299, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8759, 'compress@10': 1.0, 'time@10': 3.2856}:  67%|██████▋   | 20/30 [00:47<00:23,  2.34s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0299, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8759, 'compress@10': 1.0, 'time@10': 3.2856}:  70%|███████   | 21/30 [00:47<00:23,  2.66s/it]{'epoch': 20, 'num_users': 6.1818, 'loss': 0.0304, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8774, 'compress@10': 1.0, 'time@10': 3.2196}:  70%|███████   | 21/30 [00:49<00:23,  2.66s/it]{'epoch': 20, 'num_users': 6.1818, 'loss': 0.0304, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8774, 'compress@10': 1.0, 'time@10': 3.2196}:  73%|███████▎  | 22/30 [00:49<00:19,  2.43s/it]{'epoch': 20, 'num_users': 6.1304, 'loss': 0.0299, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8787, 'compress@10': 1.0, 'time@10': 3.23}:  73%|███████▎  | 22/30 [00:50<00:19,  2.43s/it]  {'epoch': 20, 'num_users': 6.1304, 'loss': 0.0299, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8787, 'compress@10': 1.0, 'time@10': 3.23}:  77%|███████▋  | 23/30 [00:50<00:15,  2.23s/it]{'epoch': 20, 'num_users': 5.9583, 'loss': 0.0306, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 3.1088}:  77%|███████▋  | 23/30 [00:51<00:15,  2.23s/it]{'epoch': 20, 'num_users': 5.9583, 'loss': 0.0306, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 3.1088}:  80%|████████  | 24/30 [00:51<00:10,  1.67s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0313, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 2.9975}:  80%|████████  | 24/30 [00:51<00:10,  1.67s/it]   {'epoch': 20, 'num_users': 5.8, 'loss': 0.0313, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 2.9975}:  83%|████████▎ | 25/30 [00:51<00:06,  1.23s/it]{'epoch': 20, 'num_users': 5.8077, 'loss': 0.0305, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 3.1417}:  83%|████████▎ | 25/30 [00:58<00:06,  1.23s/it]{'epoch': 20, 'num_users': 5.8077, 'loss': 0.0305, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 3.1417}:  87%|████████▋ | 26/30 [00:58<00:11,  2.89s/it]{'epoch': 20, 'num_users': 5.8889, 'loss': 0.0307, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 3.1959}:  87%|████████▋ | 26/30 [01:00<00:11,  2.89s/it]{'epoch': 20, 'num_users': 5.8889, 'loss': 0.0307, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 3.1959}:  90%|█████████ | 27/30 [01:00<00:08,  2.73s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 0.0305, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.8594, 'compress@10': 1.0, 'time@10': 3.2356}:  90%|█████████ | 27/30 [01:04<00:08,  2.73s/it]   {'epoch': 20, 'num_users': 6.0, 'loss': 0.0305, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.8594, 'compress@10': 1.0, 'time@10': 3.2356}:  93%|█████████▎| 28/30 [01:04<00:06,  3.21s/it]{'epoch': 20, 'num_users': 5.8621, 'loss': 0.0303, 'hit_ratio@10': 0.851, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 3.2413}:  93%|█████████▎| 28/30 [01:06<00:06,  3.21s/it]{'epoch': 20, 'num_users': 5.8621, 'loss': 0.0303, 'hit_ratio@10': 0.851, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 3.2413}:  97%|█████████▋| 29/30 [01:06<00:02,  2.77s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.0303, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 3.2342}:  97%|█████████▋| 29/30 [01:09<00:02,  2.77s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.0303, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 3.2342}: 100%|██████████| 30/30 [01:09<00:00,  2.86s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.0303, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 3.2342}: 100%|██████████| 30/30 [01:09<00:00,  2.33s/it]
Epoch: 20
Avg # of users: 5.866666666666666
Avg Loss: 0.030255281172914143
Avg hit ratio: 0.8496640726594508
Avg ndcg: 0.8635334409676215
Avg compression ratio: 0.9999999860153537
Avg train time: 3.234158198038737
Std train time: 2.0251499423981603
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 3.0616}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 3.0616}:   3%|▎         | 1/30 [00:01<00:45,  1.57s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0342, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8862, 'compress@10': 1.0, 'time@10': 2.8218}:   3%|▎         | 1/30 [00:04<00:45,  1.57s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0342, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8862, 'compress@10': 1.0, 'time@10': 2.8218}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 2.2212}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 2.2212}:  10%|█         | 3/30 [00:04<00:38,  1.44s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8739, 'compress@10': 1.0, 'time@10': 2.2413}:  10%|█         | 3/30 [00:07<00:38,  1.44s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8739, 'compress@10': 1.0, 'time@10': 2.2413}:  13%|█▎        | 4/30 [00:07<00:46,  1.79s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.876, 'compress@10': 1.0, 'time@10': 3.4928}:  13%|█▎        | 4/30 [00:11<00:46,  1.79s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.876, 'compress@10': 1.0, 'time@10': 3.4928}:  17%|█▋        | 5/30 [00:11<01:07,  2.70s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0303, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 3.5715}:  17%|█▋        | 5/30 [00:15<01:07,  2.70s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0303, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 3.5715}:  20%|██        | 6/30 [00:15<01:15,  3.15s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0306, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8787, 'compress@10': 1.0, 'time@10': 3.6463}:  20%|██        | 6/30 [00:17<01:15,  3.15s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0306, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8787, 'compress@10': 1.0, 'time@10': 3.6463}:  23%|██▎       | 7/30 [00:17<01:04,  2.80s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0304, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8854, 'compress@10': 1.0, 'time@10': 3.5558}:  23%|██▎       | 7/30 [00:20<01:04,  2.80s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0304, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8854, 'compress@10': 1.0, 'time@10': 3.5558}:  27%|██▋       | 8/30 [00:20<01:02,  2.85s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0295, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 3.8137}:  27%|██▋       | 8/30 [00:23<01:02,  2.85s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0295, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 3.8137}:  30%|███       | 9/30 [00:23<01:00,  2.89s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.8966, 'compress@10': 1.0, 'time@10': 3.7942}:  30%|███       | 9/30 [00:27<01:00,  2.89s/it]    {'epoch': 21, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.8966, 'compress@10': 1.0, 'time@10': 3.7942}:  33%|███▎      | 10/30 [00:27<01:02,  3.13s/it]{'epoch': 21, 'num_users': 6.6364, 'loss': 0.0305, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 3.8719}:  33%|███▎      | 10/30 [00:29<01:02,  3.13s/it]{'epoch': 21, 'num_users': 6.6364, 'loss': 0.0305, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 3.8719}:  37%|███▋      | 11/30 [00:29<00:54,  2.89s/it]{'epoch': 21, 'num_users': 6.4167, 'loss': 0.0294, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8959, 'compress@10': 1.0, 'time@10': 3.6268}:  37%|███▋      | 11/30 [00:30<00:54,  2.89s/it] {'epoch': 21, 'num_users': 6.4167, 'loss': 0.0294, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8959, 'compress@10': 1.0, 'time@10': 3.6268}:  40%|████      | 12/30 [00:30<00:41,  2.31s/it]{'epoch': 21, 'num_users': 6.6154, 'loss': 0.0301, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 3.6445}:  40%|████      | 12/30 [00:32<00:41,  2.31s/it]{'epoch': 21, 'num_users': 6.6154, 'loss': 0.0301, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 3.6445}:  43%|████▎     | 13/30 [00:32<00:37,  2.20s/it]{'epoch': 21, 'num_users': 6.3571, 'loss': 0.0294, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8882, 'compress@10': 1.0, 'time@10': 3.4142}:  43%|████▎     | 13/30 [00:32<00:37,  2.20s/it]{'epoch': 21, 'num_users': 6.3571, 'loss': 0.0294, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8882, 'compress@10': 1.0, 'time@10': 3.4142}:  47%|████▋     | 14/30 [00:32<00:26,  1.68s/it]{'epoch': 21, 'num_users': 6.2667, 'loss': 0.03, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.5354}:  47%|████▋     | 14/30 [00:35<00:26,  1.68s/it]  {'epoch': 21, 'num_users': 6.2667, 'loss': 0.03, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.5354}:  50%|█████     | 15/30 [00:35<00:29,  1.97s/it]{'epoch': 21, 'num_users': 6.0625, 'loss': 0.0289, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 3.3811}:  50%|█████     | 15/30 [00:36<00:29,  1.97s/it]{'epoch': 21, 'num_users': 6.0625, 'loss': 0.0289, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 3.3811}:  53%|█████▎    | 16/30 [00:36<00:23,  1.71s/it]{'epoch': 21, 'num_users': 5.8235, 'loss': 0.0285, 'hit_ratio@10': 0.8277, 'ndcg@10': 0.8786, 'compress@10': 1.0, 'time@10': 3.2212}:  53%|█████▎    | 16/30 [00:36<00:23,  1.71s/it]{'epoch': 21, 'num_users': 5.8235, 'loss': 0.0285, 'hit_ratio@10': 0.8277, 'ndcg@10': 0.8786, 'compress@10': 1.0, 'time@10': 3.2212}:  57%|█████▋    | 17/30 [00:36<00:17,  1.31s/it]{'epoch': 21, 'num_users': 6.0556, 'loss': 0.0288, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8793, 'compress@10': 1.0, 'time@10': 3.1727}:  57%|█████▋    | 17/30 [00:39<00:17,  1.31s/it]{'epoch': 21, 'num_users': 6.0556, 'loss': 0.0288, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8793, 'compress@10': 1.0, 'time@10': 3.1727}:  60%|██████    | 18/30 [00:39<00:19,  1.63s/it]{'epoch': 21, 'num_users': 6.0, 'loss': 0.028, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8803, 'compress@10': 1.0, 'time@10': 3.1244}:  60%|██████    | 18/30 [00:40<00:19,  1.63s/it]    {'epoch': 21, 'num_users': 6.0, 'loss': 0.028, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8803, 'compress@10': 1.0, 'time@10': 3.1244}:  63%|██████▎   | 19/30 [00:40<00:16,  1.49s/it]{'epoch': 21, 'num_users': 6.15, 'loss': 0.028, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 3.2124}:  63%|██████▎   | 19/30 [00:45<00:16,  1.49s/it]{'epoch': 21, 'num_users': 6.15, 'loss': 0.028, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 3.2124}:  67%|██████▋   | 20/30 [00:45<00:25,  2.52s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0286, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 3.3834}:  67%|██████▋   | 20/30 [00:48<00:25,  2.52s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0286, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 3.3834}:  70%|███████   | 21/30 [00:48<00:25,  2.80s/it]{'epoch': 21, 'num_users': 6.1818, 'loss': 0.029, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 3.3079}:  70%|███████   | 21/30 [00:50<00:25,  2.80s/it] {'epoch': 21, 'num_users': 6.1818, 'loss': 0.029, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 3.3079}:  73%|███████▎  | 22/30 [00:50<00:19,  2.49s/it]{'epoch': 21, 'num_users': 6.1304, 'loss': 0.0286, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8845, 'compress@10': 1.0, 'time@10': 3.3015}:  73%|███████▎  | 22/30 [00:52<00:19,  2.49s/it]{'epoch': 21, 'num_users': 6.1304, 'loss': 0.0286, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8845, 'compress@10': 1.0, 'time@10': 3.3015}:  77%|███████▋  | 23/30 [00:52<00:15,  2.23s/it]{'epoch': 21, 'num_users': 5.9583, 'loss': 0.0293, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.8741, 'compress@10': 1.0, 'time@10': 3.1779}:  77%|███████▋  | 23/30 [00:52<00:15,  2.23s/it]{'epoch': 21, 'num_users': 5.9583, 'loss': 0.0293, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.8741, 'compress@10': 1.0, 'time@10': 3.1779}:  80%|████████  | 24/30 [00:52<00:10,  1.67s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 3.064}:  80%|████████  | 24/30 [00:52<00:10,  1.67s/it]    {'epoch': 21, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 3.064}:  83%|████████▎ | 25/30 [00:52<00:06,  1.23s/it]{'epoch': 21, 'num_users': 5.8077, 'loss': 0.0291, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8614, 'compress@10': 1.0, 'time@10': 3.208}:  83%|████████▎ | 25/30 [00:59<00:06,  1.23s/it]{'epoch': 21, 'num_users': 5.8077, 'loss': 0.0291, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8614, 'compress@10': 1.0, 'time@10': 3.208}:  87%|████████▋ | 26/30 [00:59<00:11,  2.91s/it]{'epoch': 21, 'num_users': 5.8889, 'loss': 0.029, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 3.2604}:  87%|████████▋ | 26/30 [01:02<00:11,  2.91s/it] {'epoch': 21, 'num_users': 5.8889, 'loss': 0.029, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 3.2604}:  90%|█████████ | 27/30 [01:02<00:08,  2.74s/it]{'epoch': 21, 'num_users': 6.0, 'loss': 0.0289, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 3.2951}:  90%|█████████ | 27/30 [01:06<00:08,  2.74s/it] {'epoch': 21, 'num_users': 6.0, 'loss': 0.0289, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 3.2951}:  93%|█████████▎| 28/30 [01:06<00:06,  3.20s/it]{'epoch': 21, 'num_users': 5.8621, 'loss': 0.0287, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.867, 'compress@10': 1.0, 'time@10': 3.29}:  93%|█████████▎| 28/30 [01:07<00:06,  3.20s/it]{'epoch': 21, 'num_users': 5.8621, 'loss': 0.0287, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.867, 'compress@10': 1.0, 'time@10': 3.29}:  97%|█████████▋| 29/30 [01:07<00:02,  2.72s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0286, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8686, 'compress@10': 1.0, 'time@10': 3.276}:  97%|█████████▋| 29/30 [01:10<00:02,  2.72s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0286, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8686, 'compress@10': 1.0, 'time@10': 3.276}: 100%|██████████| 30/30 [01:10<00:00,  2.78s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0286, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8686, 'compress@10': 1.0, 'time@10': 3.276}: 100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch: 21
Avg # of users: 5.866666666666666
Avg Loss: 0.028612093680718
Avg hit ratio: 0.8532761836720337
Avg ndcg: 0.868594910098817
Avg compression ratio: 0.9999999860153537
Avg train time: 3.27604390780131
Std train time: 2.045064990540732
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 3.0394}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 3.0394}:   3%|▎         | 1/30 [00:01<00:45,  1.56s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0332, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8851, 'compress@10': 1.0, 'time@10': 2.8002}:   3%|▎         | 1/30 [00:04<00:45,  1.56s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0332, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8851, 'compress@10': 1.0, 'time@10': 2.8002}:   7%|▋         | 2/30 [00:04<01:00,  2.17s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8736, 'compress@10': 1.0, 'time@10': 2.1937}:   7%|▋         | 2/30 [00:04<01:00,  2.17s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8736, 'compress@10': 1.0, 'time@10': 2.1937}:  10%|█         | 3/30 [00:04<00:38,  1.42s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8717, 'compress@10': 1.0, 'time@10': 2.2122}:  10%|█         | 3/30 [00:06<00:38,  1.42s/it]  {'epoch': 22, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8717, 'compress@10': 1.0, 'time@10': 2.2122}:  13%|█▎        | 4/30 [00:06<00:45,  1.77s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.027, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8762, 'compress@10': 1.0, 'time@10': 3.4679}:  13%|█▎        | 4/30 [00:11<00:45,  1.77s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.027, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8762, 'compress@10': 1.0, 'time@10': 3.4679}:  17%|█▋        | 5/30 [00:11<01:06,  2.68s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0277, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 3.5182}:  17%|█▋        | 5/30 [00:15<01:06,  2.68s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0277, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 3.5182}:  20%|██        | 6/30 [00:15<01:13,  3.06s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0282, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 3.5989}:  20%|██        | 6/30 [00:17<01:13,  3.06s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0282, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 3.5989}:  23%|██▎       | 7/30 [00:17<01:03,  2.74s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0282, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.8875, 'compress@10': 1.0, 'time@10': 3.5142}:  23%|██▎       | 7/30 [00:20<01:03,  2.74s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0282, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.8875, 'compress@10': 1.0, 'time@10': 3.5142}:  27%|██▋       | 8/30 [00:20<01:01,  2.81s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0299, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.899, 'compress@10': 1.0, 'time@10': 3.7711}:  27%|██▋       | 8/30 [00:23<01:01,  2.81s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0299, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.899, 'compress@10': 1.0, 'time@10': 3.7711}:  30%|███       | 9/30 [00:23<00:59,  2.85s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0296, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9039, 'compress@10': 1.0, 'time@10': 3.7356}:  30%|███       | 9/30 [00:26<00:59,  2.85s/it]  {'epoch': 22, 'num_users': 6.3, 'loss': 0.0296, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9039, 'compress@10': 1.0, 'time@10': 3.7356}:  33%|███▎      | 10/30 [00:26<01:00,  3.04s/it]{'epoch': 22, 'num_users': 6.6364, 'loss': 0.0321, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9028, 'compress@10': 1.0, 'time@10': 3.7934}:  33%|███▎      | 10/30 [00:28<01:00,  3.04s/it]{'epoch': 22, 'num_users': 6.6364, 'loss': 0.0321, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9028, 'compress@10': 1.0, 'time@10': 3.7934}:  37%|███▋      | 11/30 [00:28<00:52,  2.79s/it]{'epoch': 22, 'num_users': 6.4167, 'loss': 0.0309, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.9026, 'compress@10': 1.0, 'time@10': 3.5533}:  37%|███▋      | 11/30 [00:29<00:52,  2.79s/it]{'epoch': 22, 'num_users': 6.4167, 'loss': 0.0309, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.9026, 'compress@10': 1.0, 'time@10': 3.5533}:  40%|████      | 12/30 [00:29<00:40,  2.24s/it]{'epoch': 22, 'num_users': 6.6154, 'loss': 0.0314, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.9021, 'compress@10': 1.0, 'time@10': 3.558}:  40%|████      | 12/30 [00:31<00:40,  2.24s/it] {'epoch': 22, 'num_users': 6.6154, 'loss': 0.0314, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.9021, 'compress@10': 1.0, 'time@10': 3.558}:  43%|████▎     | 13/30 [00:31<00:36,  2.12s/it]{'epoch': 22, 'num_users': 6.3571, 'loss': 0.0306, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8942, 'compress@10': 1.0, 'time@10': 3.3332}:  43%|████▎     | 13/30 [00:32<00:36,  2.12s/it]{'epoch': 22, 'num_users': 6.3571, 'loss': 0.0306, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8942, 'compress@10': 1.0, 'time@10': 3.3332}:  47%|████▋     | 14/30 [00:32<00:25,  1.62s/it]{'epoch': 22, 'num_users': 6.2667, 'loss': 0.0311, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 3.4429}:  47%|████▋     | 14/30 [00:34<00:25,  1.62s/it]{'epoch': 22, 'num_users': 6.2667, 'loss': 0.0311, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 3.4429}:  50%|█████     | 15/30 [00:34<00:28,  1.89s/it]{'epoch': 22, 'num_users': 6.0625, 'loss': 0.0299, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8929, 'compress@10': 1.0, 'time@10': 3.2815}:  50%|█████     | 15/30 [00:35<00:28,  1.89s/it] {'epoch': 22, 'num_users': 6.0625, 'loss': 0.0299, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8929, 'compress@10': 1.0, 'time@10': 3.2815}:  53%|█████▎    | 16/30 [00:35<00:22,  1.59s/it]{'epoch': 22, 'num_users': 5.8235, 'loss': 0.0294, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8834, 'compress@10': 1.0, 'time@10': 3.1254}:  53%|█████▎    | 16/30 [00:35<00:22,  1.59s/it]{'epoch': 22, 'num_users': 5.8235, 'loss': 0.0294, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8834, 'compress@10': 1.0, 'time@10': 3.1254}:  57%|█████▋    | 17/30 [00:35<00:15,  1.22s/it]{'epoch': 22, 'num_users': 6.0556, 'loss': 0.0295, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8839, 'compress@10': 1.0, 'time@10': 3.0828}:  57%|█████▋    | 17/30 [00:38<00:15,  1.22s/it]{'epoch': 22, 'num_users': 6.0556, 'loss': 0.0295, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8839, 'compress@10': 1.0, 'time@10': 3.0828}:  60%|██████    | 18/30 [00:38<00:18,  1.57s/it]{'epoch': 22, 'num_users': 6.0, 'loss': 0.0287, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 3.0352}:  60%|██████    | 18/30 [00:39<00:18,  1.57s/it]   {'epoch': 22, 'num_users': 6.0, 'loss': 0.0287, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 3.0352}:  63%|██████▎   | 19/30 [00:39<00:15,  1.44s/it]{'epoch': 22, 'num_users': 6.15, 'loss': 0.0287, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8862, 'compress@10': 1.0, 'time@10': 3.1256}:  63%|██████▎   | 19/30 [00:44<00:15,  1.44s/it]{'epoch': 22, 'num_users': 6.15, 'loss': 0.0287, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8862, 'compress@10': 1.0, 'time@10': 3.1256}:  67%|██████▋   | 20/30 [00:44<00:24,  2.47s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0291, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 3.2958}:  67%|██████▋   | 20/30 [00:47<00:24,  2.47s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0291, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 3.2958}:  70%|███████   | 21/30 [00:47<00:24,  2.75s/it]{'epoch': 22, 'num_users': 6.1818, 'loss': 0.0296, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 3.2213}:  70%|███████   | 21/30 [00:49<00:24,  2.75s/it]{'epoch': 22, 'num_users': 6.1818, 'loss': 0.0296, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 3.2213}:  73%|███████▎  | 22/30 [00:49<00:19,  2.43s/it]{'epoch': 22, 'num_users': 6.1304, 'loss': 0.0291, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.2183}:  73%|███████▎  | 22/30 [00:50<00:19,  2.43s/it]{'epoch': 22, 'num_users': 6.1304, 'loss': 0.0291, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.2183}:  77%|███████▋  | 23/30 [00:50<00:15,  2.19s/it]{'epoch': 22, 'num_users': 5.9583, 'loss': 0.0297, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8779, 'compress@10': 1.0, 'time@10': 3.0978}:  77%|███████▋  | 23/30 [00:51<00:15,  2.19s/it]{'epoch': 22, 'num_users': 5.9583, 'loss': 0.0297, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8779, 'compress@10': 1.0, 'time@10': 3.0978}:  80%|████████  | 24/30 [00:51<00:09,  1.64s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0302, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8608, 'compress@10': 1.0, 'time@10': 2.9877}:  80%|████████  | 24/30 [00:51<00:09,  1.64s/it]   {'epoch': 22, 'num_users': 5.8, 'loss': 0.0302, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8608, 'compress@10': 1.0, 'time@10': 2.9877}:  83%|████████▎ | 25/30 [00:51<00:06,  1.21s/it]{'epoch': 22, 'num_users': 5.8077, 'loss': 0.0296, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 3.1369}:  83%|████████▎ | 25/30 [00:58<00:06,  1.21s/it]{'epoch': 22, 'num_users': 5.8077, 'loss': 0.0296, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 3.1369}:  87%|████████▋ | 26/30 [00:58<00:11,  2.92s/it]{'epoch': 22, 'num_users': 5.8889, 'loss': 0.0293, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 3.1904}:  87%|████████▋ | 26/30 [01:00<00:11,  2.92s/it] {'epoch': 22, 'num_users': 5.8889, 'loss': 0.0293, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 3.1904}:  90%|█████████ | 27/30 [01:00<00:08,  2.74s/it]{'epoch': 22, 'num_users': 6.0, 'loss': 0.0293, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.2304}:  90%|█████████ | 27/30 [01:05<00:08,  2.74s/it]  {'epoch': 22, 'num_users': 6.0, 'loss': 0.0293, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.2304}:  93%|█████████▎| 28/30 [01:05<00:06,  3.22s/it]{'epoch': 22, 'num_users': 5.8621, 'loss': 0.029, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8698, 'compress@10': 1.0, 'time@10': 3.2399}:  93%|█████████▎| 28/30 [01:06<00:06,  3.22s/it]{'epoch': 22, 'num_users': 5.8621, 'loss': 0.029, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8698, 'compress@10': 1.0, 'time@10': 3.2399}:  97%|█████████▋| 29/30 [01:06<00:02,  2.79s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0289, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 3.2339}:  97%|█████████▋| 29/30 [01:09<00:02,  2.79s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0289, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 3.2339}: 100%|██████████| 30/30 [01:09<00:00,  2.90s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0289, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 3.2339}: 100%|██████████| 30/30 [01:09<00:00,  2.33s/it]
Epoch: 22
Avg # of users: 5.866666666666666
Avg Loss: 0.02888356498423136
Avg hit ratio: 0.8574095601468736
Avg ndcg: 0.8715788893179499
Avg compression ratio: 0.9999999860153537
Avg train time: 3.233859928448995
Std train time: 2.035674162259601
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0398, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 1.0, 'time@10': 3.1282}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0398, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 1.0, 'time@10': 3.1282}:   3%|▎         | 1/30 [00:01<00:46,  1.60s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 2.9022}:   3%|▎         | 1/30 [00:04<00:46,  1.60s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 2.9022}:   7%|▋         | 2/30 [00:04<01:03,  2.26s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8668, 'compress@10': 1.0, 'time@10': 2.3146}:   7%|▋         | 2/30 [00:04<01:03,  2.26s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8668, 'compress@10': 1.0, 'time@10': 2.3146}:  10%|█         | 3/30 [00:04<00:40,  1.50s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.874, 'compress@10': 1.0, 'time@10': 2.3205}:  10%|█         | 3/30 [00:07<00:40,  1.50s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.874, 'compress@10': 1.0, 'time@10': 2.3205}:  13%|█▎        | 4/30 [00:07<00:48,  1.85s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 3.5843}:  13%|█▎        | 4/30 [00:11<00:48,  1.85s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 3.5843}:  17%|█▋        | 5/30 [00:11<01:08,  2.76s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0248, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8833, 'compress@10': 1.0, 'time@10': 3.6185}:  17%|█▋        | 5/30 [00:15<01:08,  2.76s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0248, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8833, 'compress@10': 1.0, 'time@10': 3.6185}:  20%|██        | 6/30 [00:15<01:14,  3.12s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0258, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.8846, 'compress@10': 1.0, 'time@10': 3.6883}:  20%|██        | 6/30 [00:17<01:14,  3.12s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0258, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.8846, 'compress@10': 1.0, 'time@10': 3.6883}:  23%|██▎       | 7/30 [00:17<01:04,  2.79s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0261, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 3.5712}:  23%|██▎       | 7/30 [00:20<01:04,  2.79s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0261, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 3.5712}:  27%|██▋       | 8/30 [00:20<01:01,  2.79s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.888, 'compress@10': 1.0, 'time@10': 3.7783}:  27%|██▋       | 8/30 [00:23<01:01,  2.79s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.888, 'compress@10': 1.0, 'time@10': 3.7783}:  30%|███       | 9/30 [00:23<00:58,  2.78s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 3.7352}:  30%|███       | 9/30 [00:26<00:58,  2.78s/it]  {'epoch': 23, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 3.7352}:  33%|███▎      | 10/30 [00:26<00:59,  2.96s/it]{'epoch': 23, 'num_users': 6.6364, 'loss': 0.0297, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 3.7686}:  33%|███▎      | 10/30 [00:28<00:59,  2.96s/it]{'epoch': 23, 'num_users': 6.6364, 'loss': 0.0297, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 3.7686}:  37%|███▋      | 11/30 [00:28<00:51,  2.70s/it]{'epoch': 23, 'num_users': 6.4167, 'loss': 0.0287, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.5264}:  37%|███▋      | 11/30 [00:29<00:51,  2.70s/it]{'epoch': 23, 'num_users': 6.4167, 'loss': 0.0287, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.5264}:  40%|████      | 12/30 [00:29<00:38,  2.15s/it]{'epoch': 23, 'num_users': 6.6154, 'loss': 0.0293, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 3.5263}:  40%|████      | 12/30 [00:31<00:38,  2.15s/it]{'epoch': 23, 'num_users': 6.6154, 'loss': 0.0293, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 3.5263}:  43%|████▎     | 13/30 [00:31<00:34,  2.04s/it]{'epoch': 23, 'num_users': 6.3571, 'loss': 0.0286, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8852, 'compress@10': 1.0, 'time@10': 3.3036}:  43%|████▎     | 13/30 [00:31<00:34,  2.04s/it]{'epoch': 23, 'num_users': 6.3571, 'loss': 0.0286, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8852, 'compress@10': 1.0, 'time@10': 3.3036}:  47%|████▋     | 14/30 [00:31<00:24,  1.56s/it]{'epoch': 23, 'num_users': 6.2667, 'loss': 0.0292, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8858, 'compress@10': 1.0, 'time@10': 3.4197}:  47%|████▋     | 14/30 [00:34<00:24,  1.56s/it]{'epoch': 23, 'num_users': 6.2667, 'loss': 0.0292, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8858, 'compress@10': 1.0, 'time@10': 3.4197}:  50%|█████     | 15/30 [00:34<00:27,  1.86s/it]{'epoch': 23, 'num_users': 6.0625, 'loss': 0.0281, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 3.2642}:  50%|█████     | 15/30 [00:35<00:27,  1.86s/it]{'epoch': 23, 'num_users': 6.0625, 'loss': 0.0281, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 3.2642}:  53%|█████▎    | 16/30 [00:35<00:22,  1.59s/it]{'epoch': 23, 'num_users': 5.8235, 'loss': 0.0277, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8779, 'compress@10': 1.0, 'time@10': 3.1102}:  53%|█████▎    | 16/30 [00:35<00:22,  1.59s/it]{'epoch': 23, 'num_users': 5.8235, 'loss': 0.0277, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8779, 'compress@10': 1.0, 'time@10': 3.1102}:  57%|█████▋    | 17/30 [00:35<00:15,  1.22s/it]{'epoch': 23, 'num_users': 6.0556, 'loss': 0.0279, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 3.067}:  57%|█████▋    | 17/30 [00:38<00:15,  1.22s/it] {'epoch': 23, 'num_users': 6.0556, 'loss': 0.0279, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 3.067}:  60%|██████    | 18/30 [00:38<00:18,  1.57s/it]{'epoch': 23, 'num_users': 6.0, 'loss': 0.0272, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8799, 'compress@10': 1.0, 'time@10': 3.0201}:  60%|██████    | 18/30 [00:39<00:18,  1.57s/it]  {'epoch': 23, 'num_users': 6.0, 'loss': 0.0272, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8799, 'compress@10': 1.0, 'time@10': 3.0201}:  63%|██████▎   | 19/30 [00:39<00:15,  1.43s/it]{'epoch': 23, 'num_users': 6.15, 'loss': 0.0272, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8819, 'compress@10': 1.0, 'time@10': 3.1106}:  63%|██████▎   | 19/30 [00:44<00:15,  1.43s/it]{'epoch': 23, 'num_users': 6.15, 'loss': 0.0272, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8819, 'compress@10': 1.0, 'time@10': 3.1106}:  67%|██████▋   | 20/30 [00:44<00:24,  2.46s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 3.2834}:  67%|██████▋   | 20/30 [00:47<00:24,  2.46s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 3.2834}:  70%|███████   | 21/30 [00:47<00:24,  2.75s/it]{'epoch': 23, 'num_users': 6.1818, 'loss': 0.028, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8834, 'compress@10': 1.0, 'time@10': 3.2116}:  70%|███████   | 21/30 [00:49<00:24,  2.75s/it] {'epoch': 23, 'num_users': 6.1818, 'loss': 0.028, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8834, 'compress@10': 1.0, 'time@10': 3.2116}:  73%|███████▎  | 22/30 [00:49<00:19,  2.45s/it]{'epoch': 23, 'num_users': 6.1304, 'loss': 0.0276, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.885, 'compress@10': 1.0, 'time@10': 3.2097}:  73%|███████▎  | 22/30 [00:50<00:19,  2.45s/it]{'epoch': 23, 'num_users': 6.1304, 'loss': 0.0276, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.885, 'compress@10': 1.0, 'time@10': 3.2097}:  77%|███████▋  | 23/30 [00:50<00:15,  2.20s/it]{'epoch': 23, 'num_users': 5.9583, 'loss': 0.0282, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8763, 'compress@10': 1.0, 'time@10': 3.0895}:  77%|███████▋  | 23/30 [00:51<00:15,  2.20s/it]{'epoch': 23, 'num_users': 5.9583, 'loss': 0.0282, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8763, 'compress@10': 1.0, 'time@10': 3.0895}:  80%|████████  | 24/30 [00:51<00:09,  1.65s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0287, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 2.9791}:  80%|████████  | 24/30 [00:51<00:09,  1.65s/it]   {'epoch': 23, 'num_users': 5.8, 'loss': 0.0287, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 2.9791}:  83%|████████▎ | 25/30 [00:51<00:06,  1.21s/it]{'epoch': 23, 'num_users': 5.8077, 'loss': 0.0279, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 3.1251}:  83%|████████▎ | 25/30 [00:58<00:06,  1.21s/it]{'epoch': 23, 'num_users': 5.8077, 'loss': 0.0279, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 3.1251}:  87%|████████▋ | 26/30 [00:58<00:11,  2.89s/it]{'epoch': 23, 'num_users': 5.8889, 'loss': 0.0278, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8658, 'compress@10': 1.0, 'time@10': 3.1795}:  87%|████████▋ | 26/30 [01:00<00:11,  2.89s/it]{'epoch': 23, 'num_users': 5.8889, 'loss': 0.0278, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8658, 'compress@10': 1.0, 'time@10': 3.1795}:  90%|█████████ | 27/30 [01:00<00:08,  2.73s/it]{'epoch': 23, 'num_users': 6.0, 'loss': 0.0276, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8675, 'compress@10': 1.0, 'time@10': 3.2247}:  90%|█████████ | 27/30 [01:04<00:08,  2.73s/it]   {'epoch': 23, 'num_users': 6.0, 'loss': 0.0276, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8675, 'compress@10': 1.0, 'time@10': 3.2247}:  93%|█████████▎| 28/30 [01:04<00:06,  3.25s/it]{'epoch': 23, 'num_users': 5.8621, 'loss': 0.0274, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8697, 'compress@10': 1.0, 'time@10': 3.2543}:  93%|█████████▎| 28/30 [01:07<00:06,  3.25s/it]{'epoch': 23, 'num_users': 5.8621, 'loss': 0.0274, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8697, 'compress@10': 1.0, 'time@10': 3.2543}:  97%|█████████▋| 29/30 [01:07<00:02,  2.90s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0274, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 3.247}:  97%|█████████▋| 29/30 [01:10<00:02,  2.90s/it] {'epoch': 23, 'num_users': 5.8667, 'loss': 0.0274, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 3.247}: 100%|██████████| 30/30 [01:10<00:00,  2.95s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0274, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 3.247}: 100%|██████████| 30/30 [01:10<00:00,  2.34s/it]
Epoch: 23
Avg # of users: 5.866666666666666
Avg Loss: 0.027422098569155683
Avg hit ratio: 0.8566197868571005
Avg ndcg: 0.8713137585668497
Avg compression ratio: 0.9999999860153537
Avg train time: 3.246985665957133
Std train time: 2.0268235778176855
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0392, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 2.9751}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0392, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 2.9751}:   3%|▎         | 1/30 [00:01<00:44,  1.52s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0309, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 2.7851}:   3%|▎         | 1/30 [00:04<00:44,  1.52s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0309, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 2.7851}:   7%|▋         | 2/30 [00:04<01:01,  2.18s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8668, 'compress@10': 1.0, 'time@10': 2.1867}:   7%|▋         | 2/30 [00:04<01:01,  2.18s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8668, 'compress@10': 1.0, 'time@10': 2.1867}:  10%|█         | 3/30 [00:04<00:38,  1.43s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8743, 'compress@10': 1.0, 'time@10': 2.2172}:  10%|█         | 3/30 [00:07<00:38,  1.43s/it]  {'epoch': 24, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8743, 'compress@10': 1.0, 'time@10': 2.2172}:  13%|█▎        | 4/30 [00:07<00:46,  1.79s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 3.482}:  13%|█▎        | 4/30 [00:11<00:46,  1.79s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 3.482}:  17%|█▋        | 5/30 [00:11<01:07,  2.70s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.025, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8835, 'compress@10': 1.0, 'time@10': 3.5318}:  17%|█▋        | 5/30 [00:15<01:07,  2.70s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.025, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8835, 'compress@10': 1.0, 'time@10': 3.5318}:  20%|██        | 6/30 [00:15<01:13,  3.08s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0257, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8835, 'compress@10': 1.0, 'time@10': 3.6228}:  20%|██        | 6/30 [00:17<01:13,  3.08s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0257, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8835, 'compress@10': 1.0, 'time@10': 3.6228}:  23%|██▎       | 7/30 [00:17<01:03,  2.77s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0259, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 3.5241}:  23%|██▎       | 7/30 [00:20<01:03,  2.77s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0259, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 3.5241}:  27%|██▋       | 8/30 [00:20<01:01,  2.80s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.027, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9023, 'compress@10': 1.0, 'time@10': 3.7827}:  27%|██▋       | 8/30 [00:23<01:01,  2.80s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.027, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9023, 'compress@10': 1.0, 'time@10': 3.7827}:  30%|███       | 9/30 [00:23<00:59,  2.85s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9065, 'compress@10': 1.0, 'time@10': 3.761}:  30%|███       | 9/30 [00:26<00:59,  2.85s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9065, 'compress@10': 1.0, 'time@10': 3.761}:  33%|███▎      | 10/30 [00:26<01:01,  3.08s/it]{'epoch': 24, 'num_users': 6.6364, 'loss': 0.0267, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.9049, 'compress@10': 1.0, 'time@10': 3.8172}:  33%|███▎      | 10/30 [00:28<01:01,  3.08s/it]{'epoch': 24, 'num_users': 6.6364, 'loss': 0.0267, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.9049, 'compress@10': 1.0, 'time@10': 3.8172}:  37%|███▋      | 11/30 [00:28<00:53,  2.82s/it]{'epoch': 24, 'num_users': 6.4167, 'loss': 0.026, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.9049, 'compress@10': 1.0, 'time@10': 3.5765}:  37%|███▋      | 11/30 [00:29<00:53,  2.82s/it] {'epoch': 24, 'num_users': 6.4167, 'loss': 0.026, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.9049, 'compress@10': 1.0, 'time@10': 3.5765}:  40%|████      | 12/30 [00:29<00:40,  2.26s/it]{'epoch': 24, 'num_users': 6.6154, 'loss': 0.0268, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 3.6025}:  40%|████      | 12/30 [00:31<00:40,  2.26s/it]{'epoch': 24, 'num_users': 6.6154, 'loss': 0.0268, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 3.6025}:  43%|████▎     | 13/30 [00:31<00:37,  2.18s/it]{'epoch': 24, 'num_users': 6.3571, 'loss': 0.0262, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 3.3796}:  43%|████▎     | 13/30 [00:32<00:37,  2.18s/it]{'epoch': 24, 'num_users': 6.3571, 'loss': 0.0262, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 3.3796}:  47%|████▋     | 14/30 [00:32<00:26,  1.68s/it]{'epoch': 24, 'num_users': 6.2667, 'loss': 0.0268, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.4913}:  47%|████▋     | 14/30 [00:34<00:26,  1.68s/it]{'epoch': 24, 'num_users': 6.2667, 'loss': 0.0268, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.4913}:  50%|█████     | 15/30 [00:34<00:29,  1.94s/it]{'epoch': 24, 'num_users': 6.0625, 'loss': 0.0259, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8952, 'compress@10': 1.0, 'time@10': 3.3306}:  50%|█████     | 15/30 [00:35<00:29,  1.94s/it]{'epoch': 24, 'num_users': 6.0625, 'loss': 0.0259, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8952, 'compress@10': 1.0, 'time@10': 3.3306}:  53%|█████▎    | 16/30 [00:35<00:23,  1.65s/it]{'epoch': 24, 'num_users': 5.8235, 'loss': 0.0256, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8872, 'compress@10': 1.0, 'time@10': 3.1731}:  53%|█████▎    | 16/30 [00:36<00:23,  1.65s/it]{'epoch': 24, 'num_users': 5.8235, 'loss': 0.0256, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8872, 'compress@10': 1.0, 'time@10': 3.1731}:  57%|█████▋    | 17/30 [00:36<00:16,  1.26s/it]{'epoch': 24, 'num_users': 6.0556, 'loss': 0.0258, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 3.128}:  57%|█████▋    | 17/30 [00:38<00:16,  1.26s/it]  {'epoch': 24, 'num_users': 6.0556, 'loss': 0.0258, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 3.128}:  60%|██████    | 18/30 [00:38<00:19,  1.60s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 0.0252, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 3.0769}:  60%|██████    | 18/30 [00:39<00:19,  1.60s/it] {'epoch': 24, 'num_users': 6.0, 'loss': 0.0252, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 3.0769}:  63%|██████▎   | 19/30 [00:39<00:16,  1.46s/it]{'epoch': 24, 'num_users': 6.15, 'loss': 0.0253, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 3.163}:  63%|██████▎   | 19/30 [00:44<00:16,  1.46s/it]{'epoch': 24, 'num_users': 6.15, 'loss': 0.0253, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 3.163}:  67%|██████▋   | 20/30 [00:44<00:24,  2.47s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0257, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 3.3225}:  67%|██████▋   | 20/30 [00:47<00:24,  2.47s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0257, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 3.3225}:  70%|███████   | 21/30 [00:47<00:24,  2.72s/it]{'epoch': 24, 'num_users': 6.1818, 'loss': 0.0263, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 3.2459}:  70%|███████   | 21/30 [00:49<00:24,  2.72s/it]{'epoch': 24, 'num_users': 6.1818, 'loss': 0.0263, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 3.2459}:  73%|███████▎  | 22/30 [00:49<00:19,  2.41s/it]{'epoch': 24, 'num_users': 6.1304, 'loss': 0.0259, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 3.244}:  73%|███████▎  | 22/30 [00:51<00:19,  2.41s/it] {'epoch': 24, 'num_users': 6.1304, 'loss': 0.0259, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 3.244}:  77%|███████▋  | 23/30 [00:51<00:15,  2.18s/it]{'epoch': 24, 'num_users': 5.9583, 'loss': 0.0266, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8834, 'compress@10': 1.0, 'time@10': 3.122}:  77%|███████▋  | 23/30 [00:51<00:15,  2.18s/it]{'epoch': 24, 'num_users': 5.9583, 'loss': 0.0266, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8834, 'compress@10': 1.0, 'time@10': 3.122}:  80%|████████  | 24/30 [00:51<00:09,  1.63s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.027, 'hit_ratio@10': 0.842, 'ndcg@10': 0.867, 'compress@10': 1.0, 'time@10': 3.0089}:  80%|████████  | 24/30 [00:51<00:09,  1.63s/it]     {'epoch': 24, 'num_users': 5.8, 'loss': 0.027, 'hit_ratio@10': 0.842, 'ndcg@10': 0.867, 'compress@10': 1.0, 'time@10': 3.0089}:  83%|████████▎ | 25/30 [00:51<00:05,  1.20s/it]{'epoch': 24, 'num_users': 5.8077, 'loss': 0.0267, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8707, 'compress@10': 1.0, 'time@10': 3.1467}:  83%|████████▎ | 25/30 [00:58<00:05,  1.20s/it]{'epoch': 24, 'num_users': 5.8077, 'loss': 0.0267, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8707, 'compress@10': 1.0, 'time@10': 3.1467}:  87%|████████▋ | 26/30 [00:58<00:11,  2.83s/it]{'epoch': 24, 'num_users': 5.8889, 'loss': 0.0271, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8695, 'compress@10': 1.0, 'time@10': 3.2073}:  87%|████████▋ | 26/30 [01:00<00:11,  2.83s/it]{'epoch': 24, 'num_users': 5.8889, 'loss': 0.0271, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8695, 'compress@10': 1.0, 'time@10': 3.2073}:  90%|█████████ | 27/30 [01:00<00:08,  2.71s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 0.0269, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8715, 'compress@10': 1.0, 'time@10': 3.2482}:  90%|█████████ | 27/30 [01:05<00:08,  2.71s/it]   {'epoch': 24, 'num_users': 6.0, 'loss': 0.0269, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8715, 'compress@10': 1.0, 'time@10': 3.2482}:  93%|█████████▎| 28/30 [01:05<00:06,  3.21s/it]{'epoch': 24, 'num_users': 5.8621, 'loss': 0.0267, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 3.2573}:  93%|█████████▎| 28/30 [01:07<00:06,  3.21s/it]{'epoch': 24, 'num_users': 5.8621, 'loss': 0.0267, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 3.2573}:  97%|█████████▋| 29/30 [01:07<00:02,  2.79s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0267, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.2502}:  97%|█████████▋| 29/30 [01:10<00:02,  2.79s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0267, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.2502}: 100%|██████████| 30/30 [01:10<00:00,  2.88s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0267, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.2502}: 100%|██████████| 30/30 [01:10<00:00,  2.34s/it]
Epoch: 24
Avg # of users: 5.866666666666666
Avg Loss: 0.02671364402052221
Avg hit ratio: 0.8581656637444406
Avg ndcg: 0.8749128770575572
Avg compression ratio: 0.9999999860153537
Avg train time: 3.250171009699504
Std train time: 2.02212425974205
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 1.0, 'time@10': 3.0901}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 1.0, 'time@10': 3.0901}:   3%|▎         | 1/30 [00:01<00:46,  1.61s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 2.8233}:   3%|▎         | 1/30 [00:04<00:46,  1.61s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 2.8233}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 2.2061}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 2.2061}:  10%|█         | 3/30 [00:04<00:38,  1.43s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8794, 'compress@10': 1.0, 'time@10': 2.2244}:  10%|█         | 3/30 [00:07<00:38,  1.43s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8794, 'compress@10': 1.0, 'time@10': 2.2244}:  13%|█▎        | 4/30 [00:07<00:46,  1.78s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0254, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8862, 'compress@10': 1.0, 'time@10': 3.4822}:  13%|█▎        | 4/30 [00:11<00:46,  1.78s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0254, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8862, 'compress@10': 1.0, 'time@10': 3.4822}:  17%|█▋        | 5/30 [00:11<01:07,  2.69s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0262, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8895, 'compress@10': 1.0, 'time@10': 3.519}:  17%|█▋        | 5/30 [00:15<01:07,  2.69s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0262, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8895, 'compress@10': 1.0, 'time@10': 3.519}:  20%|██        | 6/30 [00:15<01:13,  3.04s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0265, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 3.621}:  20%|██        | 6/30 [00:17<01:13,  3.04s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0265, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 3.621}:  23%|██▎       | 7/30 [00:17<01:03,  2.75s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0265, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.5258}:  23%|██▎       | 7/30 [00:20<01:03,  2.75s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0265, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.5258}:  27%|██▋       | 8/30 [00:20<01:01,  2.80s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0298, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 3.7855}:  27%|██▋       | 8/30 [00:23<01:01,  2.80s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0298, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 3.7855}:  30%|███       | 9/30 [00:23<00:59,  2.85s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.029, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8974, 'compress@10': 1.0, 'time@10': 3.7662}:  30%|███       | 9/30 [00:26<00:59,  2.85s/it]    {'epoch': 25, 'num_users': 6.3, 'loss': 0.029, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8974, 'compress@10': 1.0, 'time@10': 3.7662}:  33%|███▎      | 10/30 [00:26<01:01,  3.09s/it]{'epoch': 25, 'num_users': 6.6364, 'loss': 0.0306, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.8183}:  33%|███▎      | 10/30 [00:28<01:01,  3.09s/it]{'epoch': 25, 'num_users': 6.6364, 'loss': 0.0306, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.8183}:  37%|███▋      | 11/30 [00:28<00:53,  2.82s/it]{'epoch': 25, 'num_users': 6.4167, 'loss': 0.0295, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 3.5761}:  37%|███▋      | 11/30 [00:29<00:53,  2.82s/it] {'epoch': 25, 'num_users': 6.4167, 'loss': 0.0295, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 3.5761}:  40%|████      | 12/30 [00:29<00:40,  2.25s/it]{'epoch': 25, 'num_users': 6.6154, 'loss': 0.03, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 3.5812}:  40%|████      | 12/30 [00:31<00:40,  2.25s/it] {'epoch': 25, 'num_users': 6.6154, 'loss': 0.03, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 3.5812}:  43%|████▎     | 13/30 [00:31<00:36,  2.13s/it]{'epoch': 25, 'num_users': 6.3571, 'loss': 0.0291, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8894, 'compress@10': 1.0, 'time@10': 3.3553}:  43%|████▎     | 13/30 [00:32<00:36,  2.13s/it]{'epoch': 25, 'num_users': 6.3571, 'loss': 0.0291, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8894, 'compress@10': 1.0, 'time@10': 3.3553}:  47%|████▋     | 14/30 [00:32<00:26,  1.63s/it]{'epoch': 25, 'num_users': 6.2667, 'loss': 0.0296, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 3.4659}:  47%|████▋     | 14/30 [00:34<00:26,  1.63s/it]{'epoch': 25, 'num_users': 6.2667, 'loss': 0.0296, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 3.4659}:  50%|█████     | 15/30 [00:34<00:28,  1.90s/it]{'epoch': 25, 'num_users': 6.0625, 'loss': 0.0284, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8894, 'compress@10': 1.0, 'time@10': 3.3067}:  50%|█████     | 15/30 [00:35<00:28,  1.90s/it] {'epoch': 25, 'num_users': 6.0625, 'loss': 0.0284, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8894, 'compress@10': 1.0, 'time@10': 3.3067}:  53%|█████▎    | 16/30 [00:35<00:22,  1.62s/it]{'epoch': 25, 'num_users': 5.8235, 'loss': 0.0279, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 3.1552}:  53%|█████▎    | 16/30 [00:36<00:22,  1.62s/it]{'epoch': 25, 'num_users': 5.8235, 'loss': 0.0279, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 3.1552}:  57%|█████▋    | 17/30 [00:36<00:16,  1.25s/it]{'epoch': 25, 'num_users': 6.0556, 'loss': 0.028, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8829, 'compress@10': 1.0, 'time@10': 3.1217}:  57%|█████▋    | 17/30 [00:38<00:16,  1.25s/it] {'epoch': 25, 'num_users': 6.0556, 'loss': 0.028, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8829, 'compress@10': 1.0, 'time@10': 3.1217}:  60%|██████    | 18/30 [00:38<00:19,  1.66s/it]{'epoch': 25, 'num_users': 6.0, 'loss': 0.0273, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8837, 'compress@10': 1.0, 'time@10': 3.0739}:  60%|██████    | 18/30 [00:39<00:19,  1.66s/it]  {'epoch': 25, 'num_users': 6.0, 'loss': 0.0273, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8837, 'compress@10': 1.0, 'time@10': 3.0739}:  63%|██████▎   | 19/30 [00:39<00:16,  1.50s/it]{'epoch': 25, 'num_users': 6.15, 'loss': 0.0272, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 3.1613}:  63%|██████▎   | 19/30 [00:44<00:16,  1.50s/it]{'epoch': 25, 'num_users': 6.15, 'loss': 0.0272, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 3.1613}:  67%|██████▋   | 20/30 [00:44<00:25,  2.51s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0275, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8866, 'compress@10': 1.0, 'time@10': 3.3177}:  67%|██████▋   | 20/30 [00:47<00:25,  2.51s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0275, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8866, 'compress@10': 1.0, 'time@10': 3.3177}:  70%|███████   | 21/30 [00:47<00:24,  2.74s/it]{'epoch': 25, 'num_users': 6.1818, 'loss': 0.0278, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8876, 'compress@10': 1.0, 'time@10': 3.2456}:  70%|███████   | 21/30 [00:49<00:24,  2.74s/it]  {'epoch': 25, 'num_users': 6.1818, 'loss': 0.0278, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8876, 'compress@10': 1.0, 'time@10': 3.2456}:  73%|███████▎  | 22/30 [00:49<00:19,  2.45s/it]{'epoch': 25, 'num_users': 6.1304, 'loss': 0.0274, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.244}:  73%|███████▎  | 22/30 [00:51<00:19,  2.45s/it]{'epoch': 25, 'num_users': 6.1304, 'loss': 0.0274, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.244}:  77%|███████▋  | 23/30 [00:51<00:15,  2.20s/it]{'epoch': 25, 'num_users': 5.9583, 'loss': 0.0279, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8802, 'compress@10': 1.0, 'time@10': 3.1218}:  77%|███████▋  | 23/30 [00:51<00:15,  2.20s/it]{'epoch': 25, 'num_users': 5.9583, 'loss': 0.0279, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8802, 'compress@10': 1.0, 'time@10': 3.1218}:  80%|████████  | 24/30 [00:51<00:09,  1.65s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0283, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 3.01}:  80%|████████  | 24/30 [00:51<00:09,  1.65s/it]   {'epoch': 25, 'num_users': 5.8, 'loss': 0.0283, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 3.01}:  83%|████████▎ | 25/30 [00:51<00:06,  1.21s/it]{'epoch': 25, 'num_users': 5.8077, 'loss': 0.0278, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8681, 'compress@10': 1.0, 'time@10': 3.1547}:  83%|████████▎ | 25/30 [00:58<00:06,  1.21s/it]{'epoch': 25, 'num_users': 5.8077, 'loss': 0.0278, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8681, 'compress@10': 1.0, 'time@10': 3.1547}:  87%|████████▋ | 26/30 [00:58<00:11,  2.89s/it]{'epoch': 25, 'num_users': 5.8889, 'loss': 0.0281, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8705, 'compress@10': 1.0, 'time@10': 3.2109}:  87%|████████▋ | 26/30 [01:01<00:11,  2.89s/it]{'epoch': 25, 'num_users': 5.8889, 'loss': 0.0281, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8705, 'compress@10': 1.0, 'time@10': 3.2109}:  90%|█████████ | 27/30 [01:01<00:08,  2.74s/it]{'epoch': 25, 'num_users': 6.0, 'loss': 0.028, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.2519}:  90%|█████████ | 27/30 [01:05<00:08,  2.74s/it]    {'epoch': 25, 'num_users': 6.0, 'loss': 0.028, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8723, 'compress@10': 1.0, 'time@10': 3.2519}:  93%|█████████▎| 28/30 [01:05<00:06,  3.23s/it]{'epoch': 25, 'num_users': 5.8621, 'loss': 0.0278, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 3.2571}:  93%|█████████▎| 28/30 [01:07<00:06,  3.23s/it]{'epoch': 25, 'num_users': 5.8621, 'loss': 0.0278, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 3.2571}:  97%|█████████▋| 29/30 [01:07<00:02,  2.79s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.0278, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8759, 'compress@10': 1.0, 'time@10': 3.2498}:  97%|█████████▋| 29/30 [01:10<00:02,  2.79s/it]  {'epoch': 25, 'num_users': 5.8667, 'loss': 0.0278, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8759, 'compress@10': 1.0, 'time@10': 3.2498}: 100%|██████████| 30/30 [01:10<00:00,  2.87s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.0278, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8759, 'compress@10': 1.0, 'time@10': 3.2498}: 100%|██████████| 30/30 [01:10<00:00,  2.34s/it]
Epoch: 25
Avg # of users: 5.866666666666666
Avg Loss: 0.027765215468063098
Avg hit ratio: 0.8599529415073283
Avg ndcg: 0.8758799190494864
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2497681538263956
Std train time: 2.0151909376988457
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0363, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8754, 'compress@10': 1.0, 'time@10': 3.0846}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0363, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8754, 'compress@10': 1.0, 'time@10': 3.0846}:   3%|▎         | 1/30 [00:01<00:45,  1.58s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 2.7714}:   3%|▎         | 1/30 [00:04<00:45,  1.58s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 2.7714}:   7%|▋         | 2/30 [00:04<00:59,  2.12s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.872, 'compress@10': 1.0, 'time@10': 2.14}:   7%|▋         | 2/30 [00:04<00:59,  2.12s/it]   {'epoch': 26, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.872, 'compress@10': 1.0, 'time@10': 2.14}:  10%|█         | 3/30 [00:04<00:36,  1.37s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.865, 'compress@10': 1.0, 'time@10': 2.1143}:  10%|█         | 3/30 [00:06<00:36,  1.37s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.865, 'compress@10': 1.0, 'time@10': 2.1143}:  13%|█▎        | 4/30 [00:06<00:42,  1.65s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8748, 'compress@10': 1.0, 'time@10': 3.3497}:  13%|█▎        | 4/30 [00:10<00:42,  1.65s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8748, 'compress@10': 1.0, 'time@10': 3.3497}:  17%|█▋        | 5/30 [00:10<01:04,  2.56s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 3.428}:  17%|█▋        | 5/30 [00:14<01:04,  2.56s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 3.428}:  20%|██        | 6/30 [00:14<01:12,  3.00s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0246, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.8829, 'compress@10': 1.0, 'time@10': 3.5187}:  20%|██        | 6/30 [00:16<01:12,  3.00s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0246, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.8829, 'compress@10': 1.0, 'time@10': 3.5187}:  23%|██▎       | 7/30 [00:16<01:02,  2.70s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0247, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 3.4332}:  23%|██▎       | 7/30 [00:19<01:02,  2.70s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0247, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 3.4332}:  27%|██▋       | 8/30 [00:19<01:00,  2.75s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0296, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 3.7279}:  27%|██▋       | 8/30 [00:22<01:00,  2.75s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0296, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 3.7279}:  30%|███       | 9/30 [00:22<00:59,  2.86s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8992, 'compress@10': 1.0, 'time@10': 3.7192}:  30%|███       | 9/30 [00:26<00:59,  2.86s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8992, 'compress@10': 1.0, 'time@10': 3.7192}:  33%|███▎      | 10/30 [00:26<01:02,  3.11s/it]{'epoch': 26, 'num_users': 6.6364, 'loss': 0.0294, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.7831}:  33%|███▎      | 10/30 [00:28<01:02,  3.11s/it]{'epoch': 26, 'num_users': 6.6364, 'loss': 0.0294, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.7831}:  37%|███▋      | 11/30 [00:28<00:54,  2.85s/it]{'epoch': 26, 'num_users': 6.4167, 'loss': 0.0284, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8987, 'compress@10': 1.0, 'time@10': 3.5431}:  37%|███▋      | 11/30 [00:29<00:54,  2.85s/it]{'epoch': 26, 'num_users': 6.4167, 'loss': 0.0284, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8987, 'compress@10': 1.0, 'time@10': 3.5431}:  40%|████      | 12/30 [00:29<00:40,  2.27s/it]{'epoch': 26, 'num_users': 6.6154, 'loss': 0.0289, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8985, 'compress@10': 1.0, 'time@10': 3.55}:  40%|████      | 12/30 [00:31<00:40,  2.27s/it]  {'epoch': 26, 'num_users': 6.6154, 'loss': 0.0289, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8985, 'compress@10': 1.0, 'time@10': 3.55}:  43%|████▎     | 13/30 [00:31<00:36,  2.14s/it]{'epoch': 26, 'num_users': 6.3571, 'loss': 0.0281, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 3.3262}:  43%|████▎     | 13/30 [00:31<00:36,  2.14s/it]{'epoch': 26, 'num_users': 6.3571, 'loss': 0.0281, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 3.3262}:  47%|████▋     | 14/30 [00:31<00:26,  1.63s/it]{'epoch': 26, 'num_users': 6.2667, 'loss': 0.0285, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 3.4434}:  47%|████▋     | 14/30 [00:34<00:26,  1.63s/it]{'epoch': 26, 'num_users': 6.2667, 'loss': 0.0285, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 3.4434}:  50%|█████     | 15/30 [00:34<00:28,  1.92s/it]{'epoch': 26, 'num_users': 6.0625, 'loss': 0.0274, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8907, 'compress@10': 1.0, 'time@10': 3.2861}:  50%|█████     | 15/30 [00:35<00:28,  1.92s/it]{'epoch': 26, 'num_users': 6.0625, 'loss': 0.0274, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8907, 'compress@10': 1.0, 'time@10': 3.2861}:  53%|█████▎    | 16/30 [00:35<00:22,  1.63s/it]{'epoch': 26, 'num_users': 5.8235, 'loss': 0.027, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.883, 'compress@10': 1.0, 'time@10': 3.1316}:  53%|█████▎    | 16/30 [00:35<00:22,  1.63s/it]  {'epoch': 26, 'num_users': 5.8235, 'loss': 0.027, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.883, 'compress@10': 1.0, 'time@10': 3.1316}:  57%|█████▋    | 17/30 [00:35<00:16,  1.25s/it]{'epoch': 26, 'num_users': 6.0556, 'loss': 0.027, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.884, 'compress@10': 1.0, 'time@10': 3.0889}:  57%|█████▋    | 17/30 [00:38<00:16,  1.25s/it]{'epoch': 26, 'num_users': 6.0556, 'loss': 0.027, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.884, 'compress@10': 1.0, 'time@10': 3.0889}:  60%|██████    | 18/30 [00:38<00:19,  1.60s/it]{'epoch': 26, 'num_users': 6.0, 'loss': 0.0263, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 3.0416}:  60%|██████    | 18/30 [00:39<00:19,  1.60s/it] {'epoch': 26, 'num_users': 6.0, 'loss': 0.0263, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 3.0416}:  63%|██████▎   | 19/30 [00:39<00:16,  1.46s/it]{'epoch': 26, 'num_users': 6.15, 'loss': 0.0263, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8872, 'compress@10': 1.0, 'time@10': 3.1256}:  63%|██████▎   | 19/30 [00:44<00:16,  1.46s/it]{'epoch': 26, 'num_users': 6.15, 'loss': 0.0263, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8872, 'compress@10': 1.0, 'time@10': 3.1256}:  67%|██████▋   | 20/30 [00:44<00:24,  2.45s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0265, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 3.3034}:  67%|██████▋   | 20/30 [00:47<00:24,  2.45s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0265, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 3.3034}:  70%|███████   | 21/30 [00:47<00:24,  2.76s/it]{'epoch': 26, 'num_users': 6.1818, 'loss': 0.027, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.2331}:  70%|███████   | 21/30 [00:49<00:24,  2.76s/it]  {'epoch': 26, 'num_users': 6.1818, 'loss': 0.027, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.2331}:  73%|███████▎  | 22/30 [00:49<00:19,  2.47s/it]{'epoch': 26, 'num_users': 6.1304, 'loss': 0.0265, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 3.2327}:  73%|███████▎  | 22/30 [00:50<00:19,  2.47s/it]{'epoch': 26, 'num_users': 6.1304, 'loss': 0.0265, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 3.2327}:  77%|███████▋  | 23/30 [00:50<00:15,  2.22s/it]{'epoch': 26, 'num_users': 5.9583, 'loss': 0.0271, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8815, 'compress@10': 1.0, 'time@10': 3.1125}:  77%|███████▋  | 23/30 [00:51<00:15,  2.22s/it]{'epoch': 26, 'num_users': 5.9583, 'loss': 0.0271, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8815, 'compress@10': 1.0, 'time@10': 3.1125}:  80%|████████  | 24/30 [00:51<00:10,  1.67s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0275, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 3.0016}:  80%|████████  | 24/30 [00:51<00:10,  1.67s/it]   {'epoch': 26, 'num_users': 5.8, 'loss': 0.0275, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 3.0016}:  83%|████████▎ | 25/30 [00:51<00:06,  1.23s/it]{'epoch': 26, 'num_users': 5.8077, 'loss': 0.027, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8696, 'compress@10': 1.0, 'time@10': 3.1419}:  83%|████████▎ | 25/30 [00:58<00:06,  1.23s/it]{'epoch': 26, 'num_users': 5.8077, 'loss': 0.027, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8696, 'compress@10': 1.0, 'time@10': 3.1419}:  87%|████████▋ | 26/30 [00:58<00:11,  2.87s/it]{'epoch': 26, 'num_users': 5.8889, 'loss': 0.0269, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 3.1991}:  87%|████████▋ | 26/30 [01:00<00:11,  2.87s/it]{'epoch': 26, 'num_users': 5.8889, 'loss': 0.0269, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 3.1991}:  90%|█████████ | 27/30 [01:00<00:08,  2.72s/it]{'epoch': 26, 'num_users': 6.0, 'loss': 0.0267, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 3.2318}:  90%|█████████ | 27/30 [01:04<00:08,  2.72s/it]  {'epoch': 26, 'num_users': 6.0, 'loss': 0.0267, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 3.2318}:  93%|█████████▎| 28/30 [01:04<00:06,  3.15s/it]{'epoch': 26, 'num_users': 5.8621, 'loss': 0.0264, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8756, 'compress@10': 1.0, 'time@10': 3.2382}:  93%|█████████▎| 28/30 [01:06<00:06,  3.15s/it]{'epoch': 26, 'num_users': 5.8621, 'loss': 0.0264, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8756, 'compress@10': 1.0, 'time@10': 3.2382}:  97%|█████████▋| 29/30 [01:06<00:02,  2.73s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0265, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 3.2315}:  97%|█████████▋| 29/30 [01:09<00:02,  2.73s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0265, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 3.2315}: 100%|██████████| 30/30 [01:09<00:00,  2.83s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0265, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 3.2315}: 100%|██████████| 30/30 [01:09<00:00,  2.32s/it]
Epoch: 26
Avg # of users: 5.866666666666666
Avg Loss: 0.026451227281820443
Avg hit ratio: 0.8630921356465222
Avg ndcg: 0.876943338586394
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2314637660980225
Std train time: 2.030512699428778
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8732, 'compress@10': 1.0, 'time@10': 3.1567}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8732, 'compress@10': 1.0, 'time@10': 3.1567}:   3%|▎         | 1/30 [00:01<00:46,  1.61s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 2.8661}:   3%|▎         | 1/30 [00:04<00:46,  1.61s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 2.8661}:   7%|▋         | 2/30 [00:04<01:01,  2.20s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 2.2372}:   7%|▋         | 2/30 [00:04<01:01,  2.20s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 2.2372}:  10%|█         | 3/30 [00:04<00:38,  1.44s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 2.2921}:  10%|█         | 3/30 [00:07<00:38,  1.44s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 2.2921}:  13%|█▎        | 4/30 [00:07<00:48,  1.86s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 3.6129}:  13%|█▎        | 4/30 [00:11<00:48,  1.86s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 3.6129}:  17%|█▋        | 5/30 [00:11<01:10,  2.81s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0225, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8894, 'compress@10': 1.0, 'time@10': 3.6601}:  17%|█▋        | 5/30 [00:15<01:10,  2.81s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0225, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8894, 'compress@10': 1.0, 'time@10': 3.6601}:  20%|██        | 6/30 [00:15<01:16,  3.19s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0231, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.8905, 'compress@10': 1.0, 'time@10': 3.7226}:  20%|██        | 6/30 [00:17<01:16,  3.19s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0231, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.8905, 'compress@10': 1.0, 'time@10': 3.7226}:  23%|██▎       | 7/30 [00:17<01:05,  2.83s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0233, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.8981, 'compress@10': 1.0, 'time@10': 3.6123}:  23%|██▎       | 7/30 [00:20<01:05,  2.83s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0233, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.8981, 'compress@10': 1.0, 'time@10': 3.6123}:  27%|██▋       | 8/30 [00:20<01:02,  2.85s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0247, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9171, 'compress@10': 1.0, 'time@10': 3.8812}:  27%|██▋       | 8/30 [00:23<01:02,  2.85s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0247, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9171, 'compress@10': 1.0, 'time@10': 3.8812}:  30%|███       | 9/30 [00:23<01:01,  2.91s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0262, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9114, 'compress@10': 1.0, 'time@10': 3.8548}:  30%|███       | 9/30 [00:27<01:01,  2.91s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0262, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9114, 'compress@10': 1.0, 'time@10': 3.8548}:  33%|███▎      | 10/30 [00:27<01:02,  3.14s/it]{'epoch': 27, 'num_users': 6.6364, 'loss': 0.0276, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9095, 'compress@10': 1.0, 'time@10': 3.9053}:  33%|███▎      | 10/30 [00:29<01:02,  3.14s/it]{'epoch': 27, 'num_users': 6.6364, 'loss': 0.0276, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9095, 'compress@10': 1.0, 'time@10': 3.9053}:  37%|███▋      | 11/30 [00:29<00:54,  2.87s/it]{'epoch': 27, 'num_users': 6.4167, 'loss': 0.0267, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 3.6571}:  37%|███▋      | 11/30 [00:30<00:54,  2.87s/it]{'epoch': 27, 'num_users': 6.4167, 'loss': 0.0267, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 3.6571}:  40%|████      | 12/30 [00:30<00:41,  2.29s/it]{'epoch': 27, 'num_users': 6.6154, 'loss': 0.0272, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9081, 'compress@10': 1.0, 'time@10': 3.6429}:  40%|████      | 12/30 [00:32<00:41,  2.29s/it]{'epoch': 27, 'num_users': 6.6154, 'loss': 0.0272, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9081, 'compress@10': 1.0, 'time@10': 3.6429}:  43%|████▎     | 13/30 [00:32<00:36,  2.13s/it]{'epoch': 27, 'num_users': 6.3571, 'loss': 0.0266, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 3.4095}:  43%|████▎     | 13/30 [00:32<00:36,  2.13s/it]{'epoch': 27, 'num_users': 6.3571, 'loss': 0.0266, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 3.4095}:  47%|████▋     | 14/30 [00:32<00:25,  1.61s/it]{'epoch': 27, 'num_users': 6.2667, 'loss': 0.027, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 3.4716}:  47%|████▋     | 14/30 [00:34<00:25,  1.61s/it]    {'epoch': 27, 'num_users': 6.2667, 'loss': 0.027, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 3.4716}:  50%|█████     | 15/30 [00:34<00:26,  1.79s/it]{'epoch': 27, 'num_users': 6.0625, 'loss': 0.026, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 3.3081}:  50%|█████     | 15/30 [00:35<00:26,  1.79s/it]{'epoch': 27, 'num_users': 6.0625, 'loss': 0.026, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 3.3081}:  53%|█████▎    | 16/30 [00:35<00:21,  1.52s/it]{'epoch': 27, 'num_users': 5.8235, 'loss': 0.0256, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8907, 'compress@10': 1.0, 'time@10': 3.1491}:  53%|█████▎    | 16/30 [00:36<00:21,  1.52s/it]{'epoch': 27, 'num_users': 5.8235, 'loss': 0.0256, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8907, 'compress@10': 1.0, 'time@10': 3.1491}:  57%|█████▋    | 17/30 [00:36<00:15,  1.17s/it]{'epoch': 27, 'num_users': 6.0556, 'loss': 0.0256, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 3.0998}:  57%|█████▋    | 17/30 [00:38<00:15,  1.17s/it]{'epoch': 27, 'num_users': 6.0556, 'loss': 0.0256, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 3.0998}:  60%|██████    | 18/30 [00:38<00:18,  1.51s/it]{'epoch': 27, 'num_users': 6.0, 'loss': 0.025, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8916, 'compress@10': 1.0, 'time@10': 3.0509}:  60%|██████    | 18/30 [00:39<00:18,  1.51s/it]    {'epoch': 27, 'num_users': 6.0, 'loss': 0.025, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8916, 'compress@10': 1.0, 'time@10': 3.0509}:  63%|██████▎   | 19/30 [00:39<00:15,  1.39s/it]{'epoch': 27, 'num_users': 6.15, 'loss': 0.025, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 3.1421}:  63%|██████▎   | 19/30 [00:44<00:15,  1.39s/it]{'epoch': 27, 'num_users': 6.15, 'loss': 0.025, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 3.1421}:  67%|██████▋   | 20/30 [00:44<00:24,  2.45s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0252, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 3.3224}:  67%|██████▋   | 20/30 [00:48<00:24,  2.45s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0252, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 3.3224}:  70%|███████   | 21/30 [00:48<00:24,  2.76s/it]{'epoch': 27, 'num_users': 6.1818, 'loss': 0.0256, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8952, 'compress@10': 1.0, 'time@10': 3.2506}:  70%|███████   | 21/30 [00:49<00:24,  2.76s/it]{'epoch': 27, 'num_users': 6.1818, 'loss': 0.0256, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8952, 'compress@10': 1.0, 'time@10': 3.2506}:  73%|███████▎  | 22/30 [00:49<00:19,  2.47s/it]{'epoch': 27, 'num_users': 6.1304, 'loss': 0.0252, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8962, 'compress@10': 1.0, 'time@10': 3.2462}:  73%|███████▎  | 22/30 [00:51<00:19,  2.47s/it]{'epoch': 27, 'num_users': 6.1304, 'loss': 0.0252, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8962, 'compress@10': 1.0, 'time@10': 3.2462}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it]{'epoch': 27, 'num_users': 5.9583, 'loss': 0.0258, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8871, 'compress@10': 1.0, 'time@10': 3.1243}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it]{'epoch': 27, 'num_users': 5.9583, 'loss': 0.0258, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8871, 'compress@10': 1.0, 'time@10': 3.1243}:  80%|████████  | 24/30 [00:51<00:10,  1.69s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0262, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8711, 'compress@10': 1.0, 'time@10': 3.0132}:  80%|████████  | 24/30 [00:52<00:10,  1.69s/it]   {'epoch': 27, 'num_users': 5.8, 'loss': 0.0262, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8711, 'compress@10': 1.0, 'time@10': 3.0132}:  83%|████████▎ | 25/30 [00:52<00:06,  1.24s/it]{'epoch': 27, 'num_users': 5.8077, 'loss': 0.0258, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8752, 'compress@10': 1.0, 'time@10': 3.1575}:  83%|████████▎ | 25/30 [00:58<00:06,  1.24s/it]{'epoch': 27, 'num_users': 5.8077, 'loss': 0.0258, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8752, 'compress@10': 1.0, 'time@10': 3.1575}:  87%|████████▋ | 26/30 [00:58<00:11,  2.91s/it]{'epoch': 27, 'num_users': 5.8889, 'loss': 0.0255, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8765, 'compress@10': 1.0, 'time@10': 3.2132}:  87%|████████▋ | 26/30 [01:01<00:11,  2.91s/it]{'epoch': 27, 'num_users': 5.8889, 'loss': 0.0255, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8765, 'compress@10': 1.0, 'time@10': 3.2132}:  90%|█████████ | 27/30 [01:01<00:08,  2.75s/it]{'epoch': 27, 'num_users': 6.0, 'loss': 0.0252, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 3.2494}:  90%|█████████ | 27/30 [01:05<00:08,  2.75s/it]   {'epoch': 27, 'num_users': 6.0, 'loss': 0.0252, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 3.2494}:  93%|█████████▎| 28/30 [01:05<00:06,  3.20s/it]{'epoch': 27, 'num_users': 5.8621, 'loss': 0.0249, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8806, 'compress@10': 1.0, 'time@10': 3.2498}:  93%|█████████▎| 28/30 [01:07<00:06,  3.20s/it]{'epoch': 27, 'num_users': 5.8621, 'loss': 0.0249, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8806, 'compress@10': 1.0, 'time@10': 3.2498}:  97%|█████████▋| 29/30 [01:07<00:02,  2.74s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.025, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 3.2447}:  97%|█████████▋| 29/30 [01:10<00:02,  2.74s/it] {'epoch': 27, 'num_users': 5.8667, 'loss': 0.025, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 3.2447}: 100%|██████████| 30/30 [01:10<00:00,  2.86s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.025, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 3.2447}: 100%|██████████| 30/30 [01:10<00:00,  2.35s/it]
Epoch: 27
Avg # of users: 5.866666666666666
Avg Loss: 0.024969748709089298
Avg hit ratio: 0.8666120841664708
Avg ndcg: 0.8817117471412845
Avg compression ratio: 0.9999999860153537
Avg train time: 3.244709094365438
Std train time: 2.0754796086919
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0357, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8759, 'compress@10': 1.0, 'time@10': 3.0869}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0357, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8759, 'compress@10': 1.0, 'time@10': 3.0869}:   3%|▎         | 1/30 [00:01<00:45,  1.58s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 2.7768}:   3%|▎         | 1/30 [00:04<00:45,  1.58s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 2.7768}:   7%|▋         | 2/30 [00:04<00:59,  2.12s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8729, 'compress@10': 1.0, 'time@10': 2.1623}:   7%|▋         | 2/30 [00:04<00:59,  2.12s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8729, 'compress@10': 1.0, 'time@10': 2.1623}:  10%|█         | 3/30 [00:04<00:37,  1.38s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 2.1789}:  10%|█         | 3/30 [00:06<00:37,  1.38s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 2.1789}:  13%|█▎        | 4/30 [00:06<00:45,  1.73s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0195, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 3.4921}:  13%|█▎        | 4/30 [00:11<00:45,  1.73s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0195, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 3.4921}:  17%|█▋        | 5/30 [00:11<01:07,  2.70s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0206, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.5389}:  17%|█▋        | 5/30 [00:15<01:07,  2.70s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0206, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.5389}:  20%|██        | 6/30 [00:15<01:13,  3.08s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0215, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.6159}:  20%|██        | 6/30 [00:17<01:13,  3.08s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0215, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.6159}:  23%|██▎       | 7/30 [00:17<01:03,  2.75s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0217, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9046, 'compress@10': 1.0, 'time@10': 3.5172}:  23%|██▎       | 7/30 [00:20<01:03,  2.75s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0217, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9046, 'compress@10': 1.0, 'time@10': 3.5172}:  27%|██▋       | 8/30 [00:20<01:01,  2.79s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 3.7738}:  27%|██▋       | 8/30 [00:22<01:01,  2.79s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 3.7738}:  30%|███       | 9/30 [00:22<00:59,  2.84s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9059, 'compress@10': 1.0, 'time@10': 3.7593}:  30%|███       | 9/30 [00:26<00:59,  2.84s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9059, 'compress@10': 1.0, 'time@10': 3.7593}:  33%|███▎      | 10/30 [00:26<01:01,  3.10s/it]{'epoch': 28, 'num_users': 6.6364, 'loss': 0.0235, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9049, 'compress@10': 1.0, 'time@10': 3.8108}:  33%|███▎      | 10/30 [00:28<01:01,  3.10s/it]{'epoch': 28, 'num_users': 6.6364, 'loss': 0.0235, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9049, 'compress@10': 1.0, 'time@10': 3.8108}:  37%|███▋      | 11/30 [00:28<00:53,  2.82s/it]{'epoch': 28, 'num_users': 6.4167, 'loss': 0.0229, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.9049, 'compress@10': 1.0, 'time@10': 3.5685}:  37%|███▋      | 11/30 [00:29<00:53,  2.82s/it]{'epoch': 28, 'num_users': 6.4167, 'loss': 0.0229, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.9049, 'compress@10': 1.0, 'time@10': 3.5685}:  40%|████      | 12/30 [00:29<00:40,  2.25s/it]{'epoch': 28, 'num_users': 6.6154, 'loss': 0.0237, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 3.5798}:  40%|████      | 12/30 [00:31<00:40,  2.25s/it]{'epoch': 28, 'num_users': 6.6154, 'loss': 0.0237, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 3.5798}:  43%|████▎     | 13/30 [00:31<00:36,  2.15s/it]{'epoch': 28, 'num_users': 6.3571, 'loss': 0.0233, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 3.3544}:  43%|████▎     | 13/30 [00:32<00:36,  2.15s/it]{'epoch': 28, 'num_users': 6.3571, 'loss': 0.0233, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 3.3544}:  47%|████▋     | 14/30 [00:32<00:26,  1.64s/it]{'epoch': 28, 'num_users': 6.2667, 'loss': 0.0241, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 3.4675}:  47%|████▋     | 14/30 [00:34<00:26,  1.64s/it] {'epoch': 28, 'num_users': 6.2667, 'loss': 0.0241, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 3.4675}:  50%|█████     | 15/30 [00:34<00:28,  1.92s/it]{'epoch': 28, 'num_users': 6.0625, 'loss': 0.0232, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.3075}:  50%|█████     | 15/30 [00:35<00:28,  1.92s/it]{'epoch': 28, 'num_users': 6.0625, 'loss': 0.0232, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.3075}:  53%|█████▎    | 16/30 [00:35<00:22,  1.62s/it]{'epoch': 28, 'num_users': 5.8235, 'loss': 0.023, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 3.1518}:  53%|█████▎    | 16/30 [00:36<00:22,  1.62s/it]{'epoch': 28, 'num_users': 5.8235, 'loss': 0.023, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 3.1518}:  57%|█████▋    | 17/30 [00:36<00:16,  1.25s/it]{'epoch': 28, 'num_users': 6.0556, 'loss': 0.0231, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8892, 'compress@10': 1.0, 'time@10': 3.1081}:  57%|█████▋    | 17/30 [00:38<00:16,  1.25s/it]{'epoch': 28, 'num_users': 6.0556, 'loss': 0.0231, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8892, 'compress@10': 1.0, 'time@10': 3.1081}:  60%|██████    | 18/30 [00:38<00:19,  1.59s/it]{'epoch': 28, 'num_users': 6.0, 'loss': 0.0227, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8897, 'compress@10': 1.0, 'time@10': 3.059}:  60%|██████    | 18/30 [00:39<00:19,  1.59s/it]    {'epoch': 28, 'num_users': 6.0, 'loss': 0.0227, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8897, 'compress@10': 1.0, 'time@10': 3.059}:  63%|██████▎   | 19/30 [00:39<00:15,  1.45s/it]{'epoch': 28, 'num_users': 6.15, 'loss': 0.0228, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8923, 'compress@10': 1.0, 'time@10': 3.148}:  63%|██████▎   | 19/30 [00:44<00:15,  1.45s/it]{'epoch': 28, 'num_users': 6.15, 'loss': 0.0228, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8923, 'compress@10': 1.0, 'time@10': 3.148}:  67%|██████▋   | 20/30 [00:44<00:24,  2.48s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.023, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8932, 'compress@10': 1.0, 'time@10': 3.3228}:  67%|██████▋   | 20/30 [00:47<00:24,  2.48s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.023, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8932, 'compress@10': 1.0, 'time@10': 3.3228}:  70%|███████   | 21/30 [00:47<00:24,  2.77s/it]{'epoch': 28, 'num_users': 6.1818, 'loss': 0.0235, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8942, 'compress@10': 1.0, 'time@10': 3.2489}:  70%|███████   | 21/30 [00:49<00:24,  2.77s/it]{'epoch': 28, 'num_users': 6.1818, 'loss': 0.0235, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8942, 'compress@10': 1.0, 'time@10': 3.2489}:  73%|███████▎  | 22/30 [00:49<00:19,  2.46s/it]{'epoch': 28, 'num_users': 6.1304, 'loss': 0.0232, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.2458}:  73%|███████▎  | 22/30 [00:51<00:19,  2.46s/it]{'epoch': 28, 'num_users': 6.1304, 'loss': 0.0232, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.2458}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it]{'epoch': 28, 'num_users': 5.9583, 'loss': 0.0238, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8863, 'compress@10': 1.0, 'time@10': 3.1242}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it]{'epoch': 28, 'num_users': 5.9583, 'loss': 0.0238, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8863, 'compress@10': 1.0, 'time@10': 3.1242}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 3.0123}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]   {'epoch': 28, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 3.0123}:  83%|████████▎ | 25/30 [00:51<00:06,  1.22s/it]{'epoch': 28, 'num_users': 5.8077, 'loss': 0.0241, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8747, 'compress@10': 1.0, 'time@10': 3.1699}:  83%|████████▎ | 25/30 [00:58<00:06,  1.22s/it]{'epoch': 28, 'num_users': 5.8077, 'loss': 0.0241, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8747, 'compress@10': 1.0, 'time@10': 3.1699}:  87%|████████▋ | 26/30 [00:58<00:11,  3.00s/it]{'epoch': 28, 'num_users': 5.8889, 'loss': 0.024, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8758, 'compress@10': 1.0, 'time@10': 3.2192}:  87%|████████▋ | 26/30 [01:01<00:11,  3.00s/it] {'epoch': 28, 'num_users': 5.8889, 'loss': 0.024, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8758, 'compress@10': 1.0, 'time@10': 3.2192}:  90%|█████████ | 27/30 [01:01<00:08,  2.79s/it]{'epoch': 28, 'num_users': 6.0, 'loss': 0.0241, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8781, 'compress@10': 1.0, 'time@10': 3.2456}:  90%|█████████ | 27/30 [01:05<00:08,  2.79s/it]  {'epoch': 28, 'num_users': 6.0, 'loss': 0.0241, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8781, 'compress@10': 1.0, 'time@10': 3.2456}:  93%|█████████▎| 28/30 [01:05<00:06,  3.15s/it]{'epoch': 28, 'num_users': 5.8621, 'loss': 0.0238, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8799, 'compress@10': 1.0, 'time@10': 3.2495}:  93%|█████████▎| 28/30 [01:06<00:06,  3.15s/it]{'epoch': 28, 'num_users': 5.8621, 'loss': 0.0238, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8799, 'compress@10': 1.0, 'time@10': 3.2495}:  97%|█████████▋| 29/30 [01:06<00:02,  2.72s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.0239, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8813, 'compress@10': 1.0, 'time@10': 3.2425}:  97%|█████████▋| 29/30 [01:10<00:02,  2.72s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.0239, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8813, 'compress@10': 1.0, 'time@10': 3.2425}: 100%|██████████| 30/30 [01:10<00:00,  2.83s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.0239, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8813, 'compress@10': 1.0, 'time@10': 3.2425}: 100%|██████████| 30/30 [01:10<00:00,  2.33s/it]
Epoch: 28
Avg # of users: 5.866666666666666
Avg Loss: 0.023892065757194776
Avg hit ratio: 0.8638910186822475
Avg ndcg: 0.8813482027050282
Avg compression ratio: 0.9999999860153537
Avg train time: 3.242483687400818
Std train time: 2.0752820709249544
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0344, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8759, 'compress@10': 1.0, 'time@10': 3.0906}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0344, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8759, 'compress@10': 1.0, 'time@10': 3.0906}:   3%|▎         | 1/30 [00:01<00:46,  1.59s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 2.8123}:   3%|▎         | 1/30 [00:04<00:46,  1.59s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 2.8123}:   7%|▋         | 2/30 [00:04<01:00,  2.17s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 2.2012}:   7%|▋         | 2/30 [00:04<01:00,  2.17s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 2.2012}:  10%|█         | 3/30 [00:04<00:38,  1.42s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8816, 'compress@10': 1.0, 'time@10': 2.1887}:  10%|█         | 3/30 [00:06<00:38,  1.42s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8816, 'compress@10': 1.0, 'time@10': 2.1887}:  13%|█▎        | 4/30 [00:06<00:44,  1.72s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8895, 'compress@10': 1.0, 'time@10': 3.4536}:  13%|█▎        | 4/30 [00:11<00:44,  1.72s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8895, 'compress@10': 1.0, 'time@10': 3.4536}:  17%|█▋        | 5/30 [00:11<01:06,  2.65s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0209, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.5167}:  17%|█▋        | 5/30 [00:15<01:06,  2.65s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0209, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.5167}:  20%|██        | 6/30 [00:15<01:13,  3.07s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 3.6093}:  20%|██        | 6/30 [00:17<01:13,  3.07s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 3.6093}:  23%|██▎       | 7/30 [00:17<01:03,  2.76s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0218, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9024, 'compress@10': 1.0, 'time@10': 3.5121}:  23%|██▎       | 7/30 [00:20<01:03,  2.76s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0218, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9024, 'compress@10': 1.0, 'time@10': 3.5121}:  27%|██▋       | 8/30 [00:20<01:01,  2.79s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0259, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.7582}:  27%|██▋       | 8/30 [00:22<01:01,  2.79s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0259, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.7582}:  30%|███       | 9/30 [00:22<00:59,  2.83s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0254, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 3.7426}:  30%|███       | 9/30 [00:26<00:59,  2.83s/it]    {'epoch': 29, 'num_users': 6.3, 'loss': 0.0254, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 3.7426}:  33%|███▎      | 10/30 [00:26<01:01,  3.08s/it]{'epoch': 29, 'num_users': 6.6364, 'loss': 0.0267, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9024, 'compress@10': 1.0, 'time@10': 3.8173}:  33%|███▎      | 10/30 [00:28<01:01,  3.08s/it]{'epoch': 29, 'num_users': 6.6364, 'loss': 0.0267, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9024, 'compress@10': 1.0, 'time@10': 3.8173}:  37%|███▋      | 11/30 [00:28<00:54,  2.84s/it]{'epoch': 29, 'num_users': 6.4167, 'loss': 0.0259, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9023, 'compress@10': 1.0, 'time@10': 3.5708}:  37%|███▋      | 11/30 [00:29<00:54,  2.84s/it]{'epoch': 29, 'num_users': 6.4167, 'loss': 0.0259, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9023, 'compress@10': 1.0, 'time@10': 3.5708}:  40%|████      | 12/30 [00:29<00:40,  2.25s/it]{'epoch': 29, 'num_users': 6.6154, 'loss': 0.0263, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9018, 'compress@10': 1.0, 'time@10': 3.5744}:  40%|████      | 12/30 [00:31<00:40,  2.25s/it]{'epoch': 29, 'num_users': 6.6154, 'loss': 0.0263, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9018, 'compress@10': 1.0, 'time@10': 3.5744}:  43%|████▎     | 13/30 [00:31<00:36,  2.13s/it]{'epoch': 29, 'num_users': 6.3571, 'loss': 0.0257, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 3.3456}:  43%|████▎     | 13/30 [00:32<00:36,  2.13s/it]  {'epoch': 29, 'num_users': 6.3571, 'loss': 0.0257, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 3.3456}:  47%|████▋     | 14/30 [00:32<00:25,  1.61s/it]{'epoch': 29, 'num_users': 6.2667, 'loss': 0.0262, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.896, 'compress@10': 1.0, 'time@10': 3.4529}:  47%|████▋     | 14/30 [00:34<00:25,  1.61s/it]{'epoch': 29, 'num_users': 6.2667, 'loss': 0.0262, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.896, 'compress@10': 1.0, 'time@10': 3.4529}:  50%|█████     | 15/30 [00:34<00:28,  1.88s/it]{'epoch': 29, 'num_users': 6.0625, 'loss': 0.0253, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.2934}:  50%|█████     | 15/30 [00:35<00:28,  1.88s/it]{'epoch': 29, 'num_users': 6.0625, 'loss': 0.0253, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.2934}:  53%|█████▎    | 16/30 [00:35<00:22,  1.60s/it]{'epoch': 29, 'num_users': 5.8235, 'loss': 0.0249, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8874, 'compress@10': 1.0, 'time@10': 3.1386}:  53%|█████▎    | 16/30 [00:35<00:22,  1.60s/it]{'epoch': 29, 'num_users': 5.8235, 'loss': 0.0249, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8874, 'compress@10': 1.0, 'time@10': 3.1386}:  57%|█████▋    | 17/30 [00:35<00:15,  1.23s/it]{'epoch': 29, 'num_users': 6.0556, 'loss': 0.0248, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 3.0997}:  57%|█████▋    | 17/30 [00:38<00:15,  1.23s/it]{'epoch': 29, 'num_users': 6.0556, 'loss': 0.0248, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 3.0997}:  60%|██████    | 18/30 [00:38<00:19,  1.60s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 0.0243, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8894, 'compress@10': 1.0, 'time@10': 3.0537}:  60%|██████    | 18/30 [00:39<00:19,  1.60s/it]   {'epoch': 29, 'num_users': 6.0, 'loss': 0.0243, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8894, 'compress@10': 1.0, 'time@10': 3.0537}:  63%|██████▎   | 19/30 [00:39<00:16,  1.47s/it]{'epoch': 29, 'num_users': 6.15, 'loss': 0.0243, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.1574}:  63%|██████▎   | 19/30 [00:44<00:16,  1.47s/it]{'epoch': 29, 'num_users': 6.15, 'loss': 0.0243, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.1574}:  67%|██████▋   | 20/30 [00:44<00:25,  2.58s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0244, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 3.3414}:  67%|██████▋   | 20/30 [00:48<00:25,  2.58s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0244, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 3.3414}:  70%|███████   | 21/30 [00:48<00:25,  2.87s/it]{'epoch': 29, 'num_users': 6.1818, 'loss': 0.0248, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 3.2709}:  70%|███████   | 21/30 [00:50<00:25,  2.87s/it]{'epoch': 29, 'num_users': 6.1818, 'loss': 0.0248, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 3.2709}:  73%|███████▎  | 22/30 [00:50<00:20,  2.56s/it]{'epoch': 29, 'num_users': 6.1304, 'loss': 0.0244, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 3.2698}:  73%|███████▎  | 22/30 [00:51<00:20,  2.56s/it]{'epoch': 29, 'num_users': 6.1304, 'loss': 0.0244, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 3.2698}:  77%|███████▋  | 23/30 [00:51<00:16,  2.29s/it]{'epoch': 29, 'num_users': 5.9583, 'loss': 0.0249, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8865, 'compress@10': 1.0, 'time@10': 3.1477}:  77%|███████▋  | 23/30 [00:52<00:16,  2.29s/it]{'epoch': 29, 'num_users': 5.9583, 'loss': 0.0249, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8865, 'compress@10': 1.0, 'time@10': 3.1477}:  80%|████████  | 24/30 [00:52<00:10,  1.72s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 3.0349}:  80%|████████  | 24/30 [00:52<00:10,  1.72s/it]   {'epoch': 29, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 3.0349}:  83%|████████▎ | 25/30 [00:52<00:06,  1.26s/it]{'epoch': 29, 'num_users': 5.8077, 'loss': 0.0251, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.875, 'compress@10': 1.0, 'time@10': 3.1788}:  83%|████████▎ | 25/30 [00:59<00:06,  1.26s/it]{'epoch': 29, 'num_users': 5.8077, 'loss': 0.0251, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.875, 'compress@10': 1.0, 'time@10': 3.1788}:  87%|████████▋ | 26/30 [00:59<00:11,  2.93s/it]{'epoch': 29, 'num_users': 5.8889, 'loss': 0.0256, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.874, 'compress@10': 1.0, 'time@10': 3.2331}:  87%|████████▋ | 26/30 [01:01<00:11,  2.93s/it]{'epoch': 29, 'num_users': 5.8889, 'loss': 0.0256, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.874, 'compress@10': 1.0, 'time@10': 3.2331}:  90%|█████████ | 27/30 [01:01<00:08,  2.76s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 0.0253, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8764, 'compress@10': 1.0, 'time@10': 3.2715}:  90%|█████████ | 27/30 [01:05<00:08,  2.76s/it]  {'epoch': 29, 'num_users': 6.0, 'loss': 0.0253, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8764, 'compress@10': 1.0, 'time@10': 3.2715}:  93%|█████████▎| 28/30 [01:05<00:06,  3.23s/it]{'epoch': 29, 'num_users': 5.8621, 'loss': 0.025, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8782, 'compress@10': 1.0, 'time@10': 3.2785}:  93%|█████████▎| 28/30 [01:07<00:06,  3.23s/it]{'epoch': 29, 'num_users': 5.8621, 'loss': 0.025, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8782, 'compress@10': 1.0, 'time@10': 3.2785}:  97%|█████████▋| 29/30 [01:07<00:02,  2.80s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.025, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 3.2703}:  97%|█████████▋| 29/30 [01:10<00:02,  2.80s/it]  {'epoch': 29, 'num_users': 5.8667, 'loss': 0.025, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 3.2703}: 100%|██████████| 30/30 [01:10<00:00,  2.88s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.025, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 3.2703}: 100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch: 29
Avg # of users: 5.866666666666666
Avg Loss: 0.025024487020314568
Avg hit ratio: 0.8703920841519038
Avg ndcg: 0.8799929882401476
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2703280448913574
Std train time: 2.060513724977679
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0323, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 3.089}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0323, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 3.089}:   3%|▎         | 1/30 [00:01<00:45,  1.58s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9036, 'compress@10': 1.0, 'time@10': 2.8295}:   3%|▎         | 1/30 [00:04<00:45,  1.58s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9036, 'compress@10': 1.0, 'time@10': 2.8295}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.2109}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.2109}:  10%|█         | 3/30 [00:04<00:38,  1.43s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0245, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 2.2161}:  10%|█         | 3/30 [00:06<00:38,  1.43s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0245, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 2.2161}:  13%|█▎        | 4/30 [00:06<00:45,  1.76s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.885, 'compress@10': 1.0, 'time@10': 3.4521}:  13%|█▎        | 4/30 [00:11<00:45,  1.76s/it] {'epoch': 30, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.885, 'compress@10': 1.0, 'time@10': 3.4521}:  17%|█▋        | 5/30 [00:11<01:06,  2.65s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0238, 'hit_ratio@10': 0.884, 'ndcg@10': 0.891, 'compress@10': 1.0, 'time@10': 3.5048}:  17%|█▋        | 5/30 [00:15<01:06,  2.65s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0238, 'hit_ratio@10': 0.884, 'ndcg@10': 0.891, 'compress@10': 1.0, 'time@10': 3.5048}:  20%|██        | 6/30 [00:15<01:13,  3.04s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0239, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.5278}:  20%|██        | 6/30 [00:16<01:13,  3.04s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0239, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.5278}:  23%|██▎       | 7/30 [00:16<01:01,  2.66s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0238, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9002, 'compress@10': 1.0, 'time@10': 3.4313}:  23%|██▎       | 7/30 [00:19<01:01,  2.66s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0238, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9002, 'compress@10': 1.0, 'time@10': 3.4313}:  27%|██▋       | 8/30 [00:19<00:59,  2.70s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0254, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 3.6964}:  27%|██▋       | 8/30 [00:22<00:59,  2.70s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0254, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 3.6964}:  30%|███       | 9/30 [00:22<00:58,  2.78s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.6874}:  30%|███       | 9/30 [00:26<00:58,  2.78s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.6874}:  33%|███▎      | 10/30 [00:26<01:00,  3.05s/it]{'epoch': 30, 'num_users': 6.6364, 'loss': 0.0265, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8991, 'compress@10': 1.0, 'time@10': 3.7706}:  33%|███▎      | 10/30 [00:28<01:00,  3.05s/it]{'epoch': 30, 'num_users': 6.6364, 'loss': 0.0265, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8991, 'compress@10': 1.0, 'time@10': 3.7706}:  37%|███▋      | 11/30 [00:28<00:53,  2.83s/it]{'epoch': 30, 'num_users': 6.4167, 'loss': 0.0257, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 3.5349}:  37%|███▋      | 11/30 [00:29<00:53,  2.83s/it]{'epoch': 30, 'num_users': 6.4167, 'loss': 0.0257, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 3.5349}:  40%|████      | 12/30 [00:29<00:40,  2.27s/it]{'epoch': 30, 'num_users': 6.6154, 'loss': 0.0261, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 3.551}:  40%|████      | 12/30 [00:31<00:40,  2.27s/it] {'epoch': 30, 'num_users': 6.6154, 'loss': 0.0261, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 3.551}:  43%|████▎     | 13/30 [00:31<00:36,  2.16s/it]{'epoch': 30, 'num_users': 6.3571, 'loss': 0.0255, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8918, 'compress@10': 1.0, 'time@10': 3.3264}:  43%|████▎     | 13/30 [00:31<00:36,  2.16s/it]{'epoch': 30, 'num_users': 6.3571, 'loss': 0.0255, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8918, 'compress@10': 1.0, 'time@10': 3.3264}:  47%|████▋     | 14/30 [00:31<00:26,  1.64s/it]{'epoch': 30, 'num_users': 6.2667, 'loss': 0.0256, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8929, 'compress@10': 1.0, 'time@10': 3.4386}:  47%|████▋     | 14/30 [00:34<00:26,  1.64s/it]  {'epoch': 30, 'num_users': 6.2667, 'loss': 0.0256, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8929, 'compress@10': 1.0, 'time@10': 3.4386}:  50%|█████     | 15/30 [00:34<00:28,  1.91s/it]{'epoch': 30, 'num_users': 6.0625, 'loss': 0.0247, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8926, 'compress@10': 1.0, 'time@10': 3.2812}:  50%|█████     | 15/30 [00:35<00:28,  1.91s/it]{'epoch': 30, 'num_users': 6.0625, 'loss': 0.0247, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8926, 'compress@10': 1.0, 'time@10': 3.2812}:  53%|█████▎    | 16/30 [00:35<00:22,  1.62s/it]{'epoch': 30, 'num_users': 5.8235, 'loss': 0.0243, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 3.1272}:  53%|█████▎    | 16/30 [00:35<00:22,  1.62s/it]{'epoch': 30, 'num_users': 5.8235, 'loss': 0.0243, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 3.1272}:  57%|█████▋    | 17/30 [00:35<00:16,  1.25s/it]{'epoch': 30, 'num_users': 6.0556, 'loss': 0.0243, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8862, 'compress@10': 1.0, 'time@10': 3.0868}:  57%|█████▋    | 17/30 [00:38<00:16,  1.25s/it]{'epoch': 30, 'num_users': 6.0556, 'loss': 0.0243, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8862, 'compress@10': 1.0, 'time@10': 3.0868}:  60%|██████    | 18/30 [00:38<00:19,  1.60s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 0.0237, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 3.0403}:  60%|██████    | 18/30 [00:39<00:19,  1.60s/it]   {'epoch': 30, 'num_users': 6.0, 'loss': 0.0237, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 3.0403}:  63%|██████▎   | 19/30 [00:39<00:16,  1.46s/it]{'epoch': 30, 'num_users': 6.15, 'loss': 0.0237, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8907, 'compress@10': 1.0, 'time@10': 3.1263}:  63%|██████▎   | 19/30 [00:44<00:16,  1.46s/it]{'epoch': 30, 'num_users': 6.15, 'loss': 0.0237, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8907, 'compress@10': 1.0, 'time@10': 3.1263}:  67%|██████▋   | 20/30 [00:44<00:24,  2.47s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8918, 'compress@10': 1.0, 'time@10': 3.2941}:  67%|██████▋   | 20/30 [00:47<00:24,  2.47s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8918, 'compress@10': 1.0, 'time@10': 3.2941}:  70%|███████   | 21/30 [00:47<00:24,  2.73s/it]{'epoch': 30, 'num_users': 6.1818, 'loss': 0.0242, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8929, 'compress@10': 1.0, 'time@10': 3.221}:  70%|███████   | 21/30 [00:49<00:24,  2.73s/it]  {'epoch': 30, 'num_users': 6.1818, 'loss': 0.0242, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8929, 'compress@10': 1.0, 'time@10': 3.221}:  73%|███████▎  | 22/30 [00:49<00:19,  2.43s/it]{'epoch': 30, 'num_users': 6.1304, 'loss': 0.0238, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 3.218}:  73%|███████▎  | 22/30 [00:50<00:19,  2.43s/it]{'epoch': 30, 'num_users': 6.1304, 'loss': 0.0238, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 3.218}:  77%|███████▋  | 23/30 [00:50<00:15,  2.19s/it]{'epoch': 30, 'num_users': 5.9583, 'loss': 0.0244, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 3.0973}:  77%|███████▋  | 23/30 [00:51<00:15,  2.19s/it]{'epoch': 30, 'num_users': 5.9583, 'loss': 0.0244, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 3.0973}:  80%|████████  | 24/30 [00:51<00:09,  1.64s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8707, 'compress@10': 1.0, 'time@10': 2.9864}:  80%|████████  | 24/30 [00:51<00:09,  1.64s/it]  {'epoch': 30, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8707, 'compress@10': 1.0, 'time@10': 2.9864}:  83%|████████▎ | 25/30 [00:51<00:06,  1.21s/it]{'epoch': 30, 'num_users': 5.8077, 'loss': 0.0245, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.1291}:  83%|████████▎ | 25/30 [00:58<00:06,  1.21s/it]{'epoch': 30, 'num_users': 5.8077, 'loss': 0.0245, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 3.1291}:  87%|████████▋ | 26/30 [00:58<00:11,  2.86s/it]{'epoch': 30, 'num_users': 5.8889, 'loss': 0.025, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 3.1838}:  87%|████████▋ | 26/30 [01:00<00:11,  2.86s/it] {'epoch': 30, 'num_users': 5.8889, 'loss': 0.025, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 3.1838}:  90%|█████████ | 27/30 [01:00<00:08,  2.71s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 0.0245, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 3.2242}:  90%|█████████ | 27/30 [01:04<00:08,  2.71s/it]  {'epoch': 30, 'num_users': 6.0, 'loss': 0.0245, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 3.2242}:  93%|█████████▎| 28/30 [01:04<00:06,  3.20s/it]{'epoch': 30, 'num_users': 5.8621, 'loss': 0.0243, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.8838, 'compress@10': 1.0, 'time@10': 3.2301}:  93%|█████████▎| 28/30 [01:06<00:06,  3.20s/it]{'epoch': 30, 'num_users': 5.8621, 'loss': 0.0243, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.8838, 'compress@10': 1.0, 'time@10': 3.2301}:  97%|█████████▋| 29/30 [01:06<00:02,  2.76s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.0243, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8851, 'compress@10': 1.0, 'time@10': 3.2246}:  97%|█████████▋| 29/30 [01:09<00:02,  2.76s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.0243, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8851, 'compress@10': 1.0, 'time@10': 3.2246}: 100%|██████████| 30/30 [01:09<00:00,  2.86s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.0243, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8851, 'compress@10': 1.0, 'time@10': 3.2246}: 100%|██████████| 30/30 [01:09<00:00,  2.32s/it]
Epoch: 30
Avg # of users: 5.866666666666666
Avg Loss: 0.024292325911369338
Avg hit ratio: 0.8710608489040675
Avg ndcg: 0.8851268444683089
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2245856602986653
Std train time: 2.0117243905325806
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 3.1238}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 3.1238}:   3%|▎         | 1/30 [00:01<00:46,  1.60s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9053, 'compress@10': 1.0, 'time@10': 2.8411}:   3%|▎         | 1/30 [00:04<00:46,  1.60s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9053, 'compress@10': 1.0, 'time@10': 2.8411}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8781, 'compress@10': 1.0, 'time@10': 2.2292}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8781, 'compress@10': 1.0, 'time@10': 2.2292}:  10%|█         | 3/30 [00:04<00:38,  1.43s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8815, 'compress@10': 1.0, 'time@10': 2.2357}:  10%|█         | 3/30 [00:07<00:38,  1.43s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8815, 'compress@10': 1.0, 'time@10': 2.2357}:  13%|█▎        | 4/30 [00:07<00:46,  1.77s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 3.4803}:  13%|█▎        | 4/30 [00:11<00:46,  1.77s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 3.4803}:  17%|█▋        | 5/30 [00:11<01:07,  2.68s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.884, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.5613}:  17%|█▋        | 5/30 [00:15<01:07,  2.68s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.884, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.5613}:  20%|██        | 6/30 [00:15<01:15,  3.13s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0213, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.8987, 'compress@10': 1.0, 'time@10': 3.6422}:  20%|██        | 6/30 [00:17<01:15,  3.13s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0213, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.8987, 'compress@10': 1.0, 'time@10': 3.6422}:  23%|██▎       | 7/30 [00:17<01:04,  2.80s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9059, 'compress@10': 1.0, 'time@10': 3.5585}:  23%|██▎       | 7/30 [00:20<01:04,  2.80s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9059, 'compress@10': 1.0, 'time@10': 3.5585}:  27%|██▋       | 8/30 [00:20<01:03,  2.86s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.023, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.8997, 'compress@10': 1.0, 'time@10': 3.7862}:  27%|██▋       | 8/30 [00:23<01:03,  2.86s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.023, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.8997, 'compress@10': 1.0, 'time@10': 3.7862}:  30%|███       | 9/30 [00:23<00:59,  2.86s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9061, 'compress@10': 1.0, 'time@10': 3.7566}:  30%|███       | 9/30 [00:26<00:59,  2.86s/it]  {'epoch': 31, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9061, 'compress@10': 1.0, 'time@10': 3.7566}:  33%|███▎      | 10/30 [00:26<01:01,  3.07s/it]{'epoch': 31, 'num_users': 6.6364, 'loss': 0.0238, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 3.8089}:  33%|███▎      | 10/30 [00:29<01:01,  3.07s/it]{'epoch': 31, 'num_users': 6.6364, 'loss': 0.0238, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 3.8089}:  37%|███▋      | 11/30 [00:29<00:53,  2.80s/it]{'epoch': 31, 'num_users': 6.4167, 'loss': 0.0232, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 3.5653}:  37%|███▋      | 11/30 [00:29<00:53,  2.80s/it]{'epoch': 31, 'num_users': 6.4167, 'loss': 0.0232, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 3.5653}:  40%|████      | 12/30 [00:29<00:40,  2.23s/it]{'epoch': 31, 'num_users': 6.6154, 'loss': 0.0237, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 3.5741}:  40%|████      | 12/30 [00:31<00:40,  2.23s/it] {'epoch': 31, 'num_users': 6.6154, 'loss': 0.0237, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 3.5741}:  43%|████▎     | 13/30 [00:31<00:36,  2.13s/it]{'epoch': 31, 'num_users': 6.3571, 'loss': 0.0233, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 3.3481}:  43%|████▎     | 13/30 [00:32<00:36,  2.13s/it]{'epoch': 31, 'num_users': 6.3571, 'loss': 0.0233, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 3.3481}:  47%|████▋     | 14/30 [00:32<00:25,  1.62s/it]{'epoch': 31, 'num_users': 6.2667, 'loss': 0.0236, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.8978, 'compress@10': 1.0, 'time@10': 3.4627}:  47%|████▋     | 14/30 [00:34<00:25,  1.62s/it]{'epoch': 31, 'num_users': 6.2667, 'loss': 0.0236, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.8978, 'compress@10': 1.0, 'time@10': 3.4627}:  50%|█████     | 15/30 [00:34<00:28,  1.91s/it]{'epoch': 31, 'num_users': 6.0625, 'loss': 0.0228, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.3028}:  50%|█████     | 15/30 [00:35<00:28,  1.91s/it]{'epoch': 31, 'num_users': 6.0625, 'loss': 0.0228, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.3028}:  53%|█████▎    | 16/30 [00:35<00:22,  1.62s/it]{'epoch': 31, 'num_users': 5.8235, 'loss': 0.0225, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.1477}:  53%|█████▎    | 16/30 [00:36<00:22,  1.62s/it] {'epoch': 31, 'num_users': 5.8235, 'loss': 0.0225, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.1477}:  57%|█████▋    | 17/30 [00:36<00:16,  1.24s/it]{'epoch': 31, 'num_users': 6.0556, 'loss': 0.0225, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 3.103}:  57%|█████▋    | 17/30 [00:38<00:16,  1.24s/it]{'epoch': 31, 'num_users': 6.0556, 'loss': 0.0225, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 3.103}:  60%|██████    | 18/30 [00:38<00:19,  1.58s/it]{'epoch': 31, 'num_users': 6.0, 'loss': 0.022, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8914, 'compress@10': 1.0, 'time@10': 3.0542}:  60%|██████    | 18/30 [00:39<00:19,  1.58s/it]   {'epoch': 31, 'num_users': 6.0, 'loss': 0.022, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8914, 'compress@10': 1.0, 'time@10': 3.0542}:  63%|██████▎   | 19/30 [00:39<00:15,  1.45s/it]{'epoch': 31, 'num_users': 6.15, 'loss': 0.0221, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 3.1361}:  63%|██████▎   | 19/30 [00:44<00:15,  1.45s/it]{'epoch': 31, 'num_users': 6.15, 'loss': 0.0221, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 3.1361}:  67%|██████▋   | 20/30 [00:44<00:24,  2.43s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0222, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 3.2901}:  67%|██████▋   | 20/30 [00:47<00:24,  2.43s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0222, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 3.2901}:  70%|███████   | 21/30 [00:47<00:24,  2.67s/it]{'epoch': 31, 'num_users': 6.1818, 'loss': 0.0226, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.2186}:  70%|███████   | 21/30 [00:49<00:24,  2.67s/it]{'epoch': 31, 'num_users': 6.1818, 'loss': 0.0226, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.2186}:  73%|███████▎  | 22/30 [00:49<00:19,  2.39s/it]{'epoch': 31, 'num_users': 6.1304, 'loss': 0.0223, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 3.2188}:  73%|███████▎  | 22/30 [00:51<00:19,  2.39s/it]{'epoch': 31, 'num_users': 6.1304, 'loss': 0.0223, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 3.2188}:  77%|███████▋  | 23/30 [00:51<00:15,  2.17s/it]{'epoch': 31, 'num_users': 5.9583, 'loss': 0.0229, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.0987}:  77%|███████▋  | 23/30 [00:51<00:15,  2.17s/it]{'epoch': 31, 'num_users': 5.9583, 'loss': 0.0229, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.0987}:  80%|████████  | 24/30 [00:51<00:09,  1.63s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0234, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8738, 'compress@10': 1.0, 'time@10': 2.9876}:  80%|████████  | 24/30 [00:51<00:09,  1.63s/it]   {'epoch': 31, 'num_users': 5.8, 'loss': 0.0234, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8738, 'compress@10': 1.0, 'time@10': 2.9876}:  83%|████████▎ | 25/30 [00:51<00:06,  1.20s/it]{'epoch': 31, 'num_users': 5.8077, 'loss': 0.0232, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8778, 'compress@10': 1.0, 'time@10': 3.1386}:  83%|████████▎ | 25/30 [00:58<00:06,  1.20s/it]{'epoch': 31, 'num_users': 5.8077, 'loss': 0.0232, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8778, 'compress@10': 1.0, 'time@10': 3.1386}:  87%|████████▋ | 26/30 [00:58<00:11,  2.93s/it]{'epoch': 31, 'num_users': 5.8889, 'loss': 0.0228, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8798, 'compress@10': 1.0, 'time@10': 3.1999}:  87%|████████▋ | 26/30 [01:01<00:11,  2.93s/it] {'epoch': 31, 'num_users': 5.8889, 'loss': 0.0228, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8798, 'compress@10': 1.0, 'time@10': 3.1999}:  90%|█████████ | 27/30 [01:01<00:08,  2.78s/it]{'epoch': 31, 'num_users': 6.0, 'loss': 0.0228, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8829, 'compress@10': 1.0, 'time@10': 3.241}:  90%|█████████ | 27/30 [01:05<00:08,  2.78s/it]   {'epoch': 31, 'num_users': 6.0, 'loss': 0.0228, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8829, 'compress@10': 1.0, 'time@10': 3.241}:  93%|█████████▎| 28/30 [01:05<00:06,  3.26s/it]{'epoch': 31, 'num_users': 5.8621, 'loss': 0.0226, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8845, 'compress@10': 1.0, 'time@10': 3.2514}:  93%|█████████▎| 28/30 [01:07<00:06,  3.26s/it]{'epoch': 31, 'num_users': 5.8621, 'loss': 0.0226, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8845, 'compress@10': 1.0, 'time@10': 3.2514}:  97%|█████████▋| 29/30 [01:07<00:02,  2.83s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0227, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 3.2431}:  97%|█████████▋| 29/30 [01:10<00:02,  2.83s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0227, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 3.2431}: 100%|██████████| 30/30 [01:10<00:00,  2.89s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0227, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 3.2431}: 100%|██████████| 30/30 [01:10<00:00,  2.34s/it]
Epoch: 31
Avg # of users: 5.866666666666666
Avg Loss: 0.02266487736215367
Avg hit ratio: 0.871200221726367
Avg ndcg: 0.8861415321840131
Avg compression ratio: 0.9999999860153537
Avg train time: 3.243144734700521
Std train time: 2.012452580713481
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.886, 'compress@10': 1.0, 'time@10': 3.4301}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.886, 'compress@10': 1.0, 'time@10': 3.4301}:   3%|▎         | 1/30 [00:01<00:50,  1.76s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9103, 'compress@10': 1.0, 'time@10': 3.0426}:   3%|▎         | 1/30 [00:04<00:50,  1.76s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9103, 'compress@10': 1.0, 'time@10': 3.0426}:   7%|▋         | 2/30 [00:04<01:04,  2.31s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8813, 'compress@10': 1.0, 'time@10': 2.3522}:   7%|▋         | 2/30 [00:04<01:04,  2.31s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8813, 'compress@10': 1.0, 'time@10': 2.3522}:  10%|█         | 3/30 [00:04<00:40,  1.49s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8966, 'compress@10': 1.0, 'time@10': 2.3277}:  10%|█         | 3/30 [00:07<00:40,  1.49s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8966, 'compress@10': 1.0, 'time@10': 2.3277}:  13%|█▎        | 4/30 [00:07<00:47,  1.82s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 3.5566}:  13%|█▎        | 4/30 [00:11<00:47,  1.82s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 3.5566}:  17%|█▋        | 5/30 [00:11<01:07,  2.70s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0171, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9092, 'compress@10': 1.0, 'time@10': 3.613}:  17%|█▋        | 5/30 [00:15<01:07,  2.70s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0171, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9092, 'compress@10': 1.0, 'time@10': 3.613}:  20%|██        | 6/30 [00:15<01:14,  3.12s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9081, 'compress@10': 1.0, 'time@10': 3.6792}:  20%|██        | 6/30 [00:17<01:14,  3.12s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9081, 'compress@10': 1.0, 'time@10': 3.6792}:  23%|██▎       | 7/30 [00:17<01:03,  2.78s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9141, 'compress@10': 1.0, 'time@10': 3.5735}:  23%|██▎       | 7/30 [00:20<01:03,  2.78s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9141, 'compress@10': 1.0, 'time@10': 3.5735}:  27%|██▋       | 8/30 [00:20<01:01,  2.81s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9081, 'compress@10': 1.0, 'time@10': 3.8289}:  27%|██▋       | 8/30 [00:23<01:01,  2.81s/it] {'epoch': 32, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9081, 'compress@10': 1.0, 'time@10': 3.8289}:  30%|███       | 9/30 [00:23<01:00,  2.86s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9118, 'compress@10': 1.0, 'time@10': 3.7991}:  30%|███       | 9/30 [00:26<01:00,  2.86s/it] {'epoch': 32, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9118, 'compress@10': 1.0, 'time@10': 3.7991}:  33%|███▎      | 10/30 [00:26<01:01,  3.08s/it]{'epoch': 32, 'num_users': 6.6364, 'loss': 0.0223, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.911, 'compress@10': 1.0, 'time@10': 3.8253}:  33%|███▎      | 10/30 [00:29<01:01,  3.08s/it]{'epoch': 32, 'num_users': 6.6364, 'loss': 0.0223, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.911, 'compress@10': 1.0, 'time@10': 3.8253}:  37%|███▋      | 11/30 [00:29<00:52,  2.78s/it]{'epoch': 32, 'num_users': 6.4167, 'loss': 0.0218, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9104, 'compress@10': 1.0, 'time@10': 3.5798}:  37%|███▋      | 11/30 [00:30<00:52,  2.78s/it]{'epoch': 32, 'num_users': 6.4167, 'loss': 0.0218, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9104, 'compress@10': 1.0, 'time@10': 3.5798}:  40%|████      | 12/30 [00:30<00:39,  2.22s/it]{'epoch': 32, 'num_users': 6.6154, 'loss': 0.0224, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 3.5906}:  40%|████      | 12/30 [00:31<00:39,  2.22s/it]{'epoch': 32, 'num_users': 6.6154, 'loss': 0.0224, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 3.5906}:  43%|████▎     | 13/30 [00:31<00:36,  2.12s/it]{'epoch': 32, 'num_users': 6.3571, 'loss': 0.022, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.9012, 'compress@10': 1.0, 'time@10': 3.3637}:  43%|████▎     | 13/30 [00:32<00:36,  2.12s/it] {'epoch': 32, 'num_users': 6.3571, 'loss': 0.022, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.9012, 'compress@10': 1.0, 'time@10': 3.3637}:  47%|████▋     | 14/30 [00:32<00:25,  1.62s/it]{'epoch': 32, 'num_users': 6.2667, 'loss': 0.0229, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9026, 'compress@10': 1.0, 'time@10': 3.4739}:  47%|████▋     | 14/30 [00:34<00:25,  1.62s/it]{'epoch': 32, 'num_users': 6.2667, 'loss': 0.0229, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9026, 'compress@10': 1.0, 'time@10': 3.4739}:  50%|█████     | 15/30 [00:34<00:28,  1.90s/it]{'epoch': 32, 'num_users': 6.0625, 'loss': 0.0221, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.3132}:  50%|█████     | 15/30 [00:35<00:28,  1.90s/it]{'epoch': 32, 'num_users': 6.0625, 'loss': 0.0221, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.3132}:  53%|█████▎    | 16/30 [00:35<00:22,  1.61s/it]{'epoch': 32, 'num_users': 5.8235, 'loss': 0.0219, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 3.1561}:  53%|█████▎    | 16/30 [00:36<00:22,  1.61s/it]{'epoch': 32, 'num_users': 5.8235, 'loss': 0.0219, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 3.1561}:  57%|█████▋    | 17/30 [00:36<00:16,  1.23s/it]{'epoch': 32, 'num_users': 6.0556, 'loss': 0.0218, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 3.1113}:  57%|█████▋    | 17/30 [00:38<00:16,  1.23s/it]{'epoch': 32, 'num_users': 6.0556, 'loss': 0.0218, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 3.1113}:  60%|██████    | 18/30 [00:38<00:18,  1.58s/it]{'epoch': 32, 'num_users': 6.0, 'loss': 0.0214, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 3.0609}:  60%|██████    | 18/30 [00:39<00:18,  1.58s/it]   {'epoch': 32, 'num_users': 6.0, 'loss': 0.0214, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 3.0609}:  63%|██████▎   | 19/30 [00:39<00:15,  1.44s/it]{'epoch': 32, 'num_users': 6.15, 'loss': 0.0215, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8985, 'compress@10': 1.0, 'time@10': 3.1505}:  63%|██████▎   | 19/30 [00:44<00:15,  1.44s/it]{'epoch': 32, 'num_users': 6.15, 'loss': 0.0215, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8985, 'compress@10': 1.0, 'time@10': 3.1505}:  67%|██████▋   | 20/30 [00:44<00:24,  2.50s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 3.3245}:  67%|██████▋   | 20/30 [00:48<00:24,  2.50s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 3.3245}:  70%|███████   | 21/30 [00:48<00:25,  2.78s/it]{'epoch': 32, 'num_users': 6.1818, 'loss': 0.022, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9002, 'compress@10': 1.0, 'time@10': 3.2508}:  70%|███████   | 21/30 [00:49<00:25,  2.78s/it] {'epoch': 32, 'num_users': 6.1818, 'loss': 0.022, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9002, 'compress@10': 1.0, 'time@10': 3.2508}:  73%|███████▎  | 22/30 [00:49<00:19,  2.47s/it]{'epoch': 32, 'num_users': 6.1304, 'loss': 0.0217, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9011, 'compress@10': 1.0, 'time@10': 3.2471}:  73%|███████▎  | 22/30 [00:51<00:19,  2.47s/it]{'epoch': 32, 'num_users': 6.1304, 'loss': 0.0217, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9011, 'compress@10': 1.0, 'time@10': 3.2471}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it]{'epoch': 32, 'num_users': 5.9583, 'loss': 0.0223, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8918, 'compress@10': 1.0, 'time@10': 3.1255}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it]{'epoch': 32, 'num_users': 5.9583, 'loss': 0.0223, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8918, 'compress@10': 1.0, 'time@10': 3.1255}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0227, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.877, 'compress@10': 1.0, 'time@10': 3.0139}:  80%|████████  | 24/30 [00:52<00:09,  1.66s/it]    {'epoch': 32, 'num_users': 5.8, 'loss': 0.0227, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.877, 'compress@10': 1.0, 'time@10': 3.0139}:  83%|████████▎ | 25/30 [00:52<00:06,  1.22s/it]{'epoch': 32, 'num_users': 5.8077, 'loss': 0.0225, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 3.1563}:  83%|████████▎ | 25/30 [00:58<00:06,  1.22s/it]{'epoch': 32, 'num_users': 5.8077, 'loss': 0.0225, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 3.1563}:  87%|████████▋ | 26/30 [00:58<00:11,  2.88s/it]{'epoch': 32, 'num_users': 5.8889, 'loss': 0.0221, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8825, 'compress@10': 1.0, 'time@10': 3.2162}:  87%|████████▋ | 26/30 [01:01<00:11,  2.88s/it]{'epoch': 32, 'num_users': 5.8889, 'loss': 0.0221, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8825, 'compress@10': 1.0, 'time@10': 3.2162}:  90%|█████████ | 27/30 [01:01<00:08,  2.75s/it]{'epoch': 32, 'num_users': 6.0, 'loss': 0.0217, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 3.2636}:  90%|█████████ | 27/30 [01:05<00:08,  2.75s/it]   {'epoch': 32, 'num_users': 6.0, 'loss': 0.0217, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 3.2636}:  93%|█████████▎| 28/30 [01:05<00:06,  3.30s/it]{'epoch': 32, 'num_users': 5.8621, 'loss': 0.0215, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8869, 'compress@10': 1.0, 'time@10': 3.2758}:  93%|█████████▎| 28/30 [01:07<00:06,  3.30s/it]{'epoch': 32, 'num_users': 5.8621, 'loss': 0.0215, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8869, 'compress@10': 1.0, 'time@10': 3.2758}:  97%|█████████▋| 29/30 [01:07<00:02,  2.86s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0216, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.2681}:  97%|█████████▋| 29/30 [01:10<00:02,  2.86s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0216, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.2681}: 100%|██████████| 30/30 [01:10<00:00,  2.94s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0216, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.2681}: 100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch: 32
Avg # of users: 5.866666666666666
Avg Loss: 0.0215621321751537
Avg hit ratio: 0.8722617975460074
Avg ndcg: 0.8884527449473522
Avg compression ratio: 0.9999999860153537
Avg train time: 3.268086886405945
Std train time: 2.0404597807832494
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8883, 'compress@10': 1.0, 'time@10': 2.7642}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8883, 'compress@10': 1.0, 'time@10': 2.7642}:   3%|▎         | 1/30 [00:01<00:41,  1.42s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9102, 'compress@10': 1.0, 'time@10': 2.678}:   3%|▎         | 1/30 [00:04<00:41,  1.42s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9102, 'compress@10': 1.0, 'time@10': 2.678}:   7%|▋         | 2/30 [00:04<00:59,  2.13s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8813, 'compress@10': 1.0, 'time@10': 2.1191}:   7%|▋         | 2/30 [00:04<00:59,  2.13s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8813, 'compress@10': 1.0, 'time@10': 2.1191}:  10%|█         | 3/30 [00:04<00:37,  1.40s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 2.1589}:  10%|█         | 3/30 [00:06<00:37,  1.40s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 2.1589}:  13%|█▎        | 4/30 [00:06<00:45,  1.76s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 3.4643}:  13%|█▎        | 4/30 [00:11<00:45,  1.76s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 3.4643}:  17%|█▋        | 5/30 [00:11<01:07,  2.71s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0172, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9098, 'compress@10': 1.0, 'time@10': 3.5152}:  17%|█▋        | 5/30 [00:15<01:07,  2.71s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0172, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9098, 'compress@10': 1.0, 'time@10': 3.5152}:  20%|██        | 6/30 [00:15<01:13,  3.08s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9086, 'compress@10': 1.0, 'time@10': 3.5974}:  20%|██        | 6/30 [00:17<01:13,  3.08s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9086, 'compress@10': 1.0, 'time@10': 3.5974}:  23%|██▎       | 7/30 [00:17<01:03,  2.76s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.915, 'compress@10': 1.0, 'time@10': 3.4921}:  23%|██▎       | 7/30 [00:19<01:03,  2.76s/it]  {'epoch': 33, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.915, 'compress@10': 1.0, 'time@10': 3.4921}:  27%|██▋       | 8/30 [00:19<01:00,  2.77s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.917, 'compress@10': 1.0, 'time@10': 3.7371}:  27%|██▋       | 8/30 [00:22<01:00,  2.77s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.917, 'compress@10': 1.0, 'time@10': 3.7371}:  30%|███       | 9/30 [00:22<00:58,  2.80s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9217, 'compress@10': 1.0, 'time@10': 3.7225}:  30%|███       | 9/30 [00:26<00:58,  2.80s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9217, 'compress@10': 1.0, 'time@10': 3.7225}:  33%|███▎      | 10/30 [00:26<01:01,  3.06s/it]{'epoch': 33, 'num_users': 6.6364, 'loss': 0.0195, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9201, 'compress@10': 1.0, 'time@10': 3.7942}:  33%|███▎      | 10/30 [00:28<01:01,  3.06s/it]{'epoch': 33, 'num_users': 6.6364, 'loss': 0.0195, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9201, 'compress@10': 1.0, 'time@10': 3.7942}:  37%|███▋      | 11/30 [00:28<00:53,  2.82s/it]{'epoch': 33, 'num_users': 6.4167, 'loss': 0.0193, 'hit_ratio@10': 0.863, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 3.5555}:  37%|███▋      | 11/30 [00:29<00:53,  2.82s/it]  {'epoch': 33, 'num_users': 6.4167, 'loss': 0.0193, 'hit_ratio@10': 0.863, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 3.5555}:  40%|████      | 12/30 [00:29<00:40,  2.26s/it]{'epoch': 33, 'num_users': 6.6154, 'loss': 0.02, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9167, 'compress@10': 1.0, 'time@10': 3.5671}:  40%|████      | 12/30 [00:31<00:40,  2.26s/it] {'epoch': 33, 'num_users': 6.6154, 'loss': 0.02, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9167, 'compress@10': 1.0, 'time@10': 3.5671}:  43%|████▎     | 13/30 [00:31<00:36,  2.15s/it]{'epoch': 33, 'num_users': 6.3571, 'loss': 0.0198, 'hit_ratio@10': 0.849, 'ndcg@10': 0.9077, 'compress@10': 1.0, 'time@10': 3.3418}:  43%|████▎     | 13/30 [00:32<00:36,  2.15s/it]{'epoch': 33, 'num_users': 6.3571, 'loss': 0.0198, 'hit_ratio@10': 0.849, 'ndcg@10': 0.9077, 'compress@10': 1.0, 'time@10': 3.3418}:  47%|████▋     | 14/30 [00:32<00:26,  1.64s/it]{'epoch': 33, 'num_users': 6.2667, 'loss': 0.0206, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.9085, 'compress@10': 1.0, 'time@10': 3.457}:  47%|████▋     | 14/30 [00:34<00:26,  1.64s/it]{'epoch': 33, 'num_users': 6.2667, 'loss': 0.0206, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.9085, 'compress@10': 1.0, 'time@10': 3.457}:  50%|█████     | 15/30 [00:34<00:28,  1.92s/it]{'epoch': 33, 'num_users': 6.0625, 'loss': 0.02, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.9072, 'compress@10': 1.0, 'time@10': 3.2973}:  50%|█████     | 15/30 [00:35<00:28,  1.92s/it] {'epoch': 33, 'num_users': 6.0625, 'loss': 0.02, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.9072, 'compress@10': 1.0, 'time@10': 3.2973}:  53%|█████▎    | 16/30 [00:35<00:22,  1.62s/it]{'epoch': 33, 'num_users': 5.8235, 'loss': 0.0199, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8985, 'compress@10': 1.0, 'time@10': 3.1398}:  53%|█████▎    | 16/30 [00:35<00:22,  1.62s/it]{'epoch': 33, 'num_users': 5.8235, 'loss': 0.0199, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8985, 'compress@10': 1.0, 'time@10': 3.1398}:  57%|█████▋    | 17/30 [00:35<00:16,  1.24s/it]{'epoch': 33, 'num_users': 6.0556, 'loss': 0.0199, 'hit_ratio@10': 0.8453, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 3.092}:  57%|█████▋    | 17/30 [00:38<00:16,  1.24s/it] {'epoch': 33, 'num_users': 6.0556, 'loss': 0.0199, 'hit_ratio@10': 0.8453, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 3.092}:  60%|██████    | 18/30 [00:38<00:18,  1.56s/it]{'epoch': 33, 'num_users': 6.0, 'loss': 0.0196, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 3.045}:  60%|██████    | 18/30 [00:39<00:18,  1.56s/it]   {'epoch': 33, 'num_users': 6.0, 'loss': 0.0196, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 3.045}:  63%|██████▎   | 19/30 [00:39<00:15,  1.44s/it]{'epoch': 33, 'num_users': 6.15, 'loss': 0.0197, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 3.1215}:  63%|██████▎   | 19/30 [00:44<00:15,  1.44s/it]{'epoch': 33, 'num_users': 6.15, 'loss': 0.0197, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 3.1215}:  67%|██████▋   | 20/30 [00:44<00:23,  2.39s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0198, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.904, 'compress@10': 1.0, 'time@10': 3.3008}:  67%|██████▋   | 20/30 [00:47<00:23,  2.39s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0198, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.904, 'compress@10': 1.0, 'time@10': 3.3008}:  70%|███████   | 21/30 [00:47<00:24,  2.72s/it]{'epoch': 33, 'num_users': 6.1818, 'loss': 0.0204, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9046, 'compress@10': 1.0, 'time@10': 3.2369}:  70%|███████   | 21/30 [00:49<00:24,  2.72s/it]{'epoch': 33, 'num_users': 6.1818, 'loss': 0.0204, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9046, 'compress@10': 1.0, 'time@10': 3.2369}:  73%|███████▎  | 22/30 [00:49<00:19,  2.49s/it]{'epoch': 33, 'num_users': 6.1304, 'loss': 0.0201, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9053, 'compress@10': 1.0, 'time@10': 3.2432}:  73%|███████▎  | 22/30 [00:51<00:19,  2.49s/it]{'epoch': 33, 'num_users': 6.1304, 'loss': 0.0201, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9053, 'compress@10': 1.0, 'time@10': 3.2432}:  77%|███████▋  | 23/30 [00:51<00:15,  2.26s/it]{'epoch': 33, 'num_users': 5.9583, 'loss': 0.0208, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 3.1226}:  77%|███████▋  | 23/30 [00:51<00:15,  2.26s/it] {'epoch': 33, 'num_users': 5.9583, 'loss': 0.0208, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 3.1226}:  80%|████████  | 24/30 [00:51<00:10,  1.70s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 3.0107}:  80%|████████  | 24/30 [00:51<00:10,  1.70s/it]  {'epoch': 33, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 3.0107}:  83%|████████▎ | 25/30 [00:51<00:06,  1.25s/it]{'epoch': 33, 'num_users': 5.8077, 'loss': 0.0212, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8846, 'compress@10': 1.0, 'time@10': 3.1572}:  83%|████████▎ | 25/30 [00:58<00:06,  1.25s/it]{'epoch': 33, 'num_users': 5.8077, 'loss': 0.0212, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8846, 'compress@10': 1.0, 'time@10': 3.1572}:  87%|████████▋ | 26/30 [00:58<00:11,  2.93s/it]{'epoch': 33, 'num_users': 5.8889, 'loss': 0.021, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.8851, 'compress@10': 1.0, 'time@10': 3.2133}:  87%|████████▋ | 26/30 [01:00<00:11,  2.93s/it] {'epoch': 33, 'num_users': 5.8889, 'loss': 0.021, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.8851, 'compress@10': 1.0, 'time@10': 3.2133}:  90%|█████████ | 27/30 [01:00<00:08,  2.76s/it]{'epoch': 33, 'num_users': 6.0, 'loss': 0.0208, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.888, 'compress@10': 1.0, 'time@10': 3.2517}:  90%|█████████ | 27/30 [01:05<00:08,  2.76s/it]   {'epoch': 33, 'num_users': 6.0, 'loss': 0.0208, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.888, 'compress@10': 1.0, 'time@10': 3.2517}:  93%|█████████▎| 28/30 [01:05<00:06,  3.23s/it]{'epoch': 33, 'num_users': 5.8621, 'loss': 0.0206, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.8897, 'compress@10': 1.0, 'time@10': 3.2584}:  93%|█████████▎| 28/30 [01:07<00:06,  3.23s/it]{'epoch': 33, 'num_users': 5.8621, 'loss': 0.0206, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.8897, 'compress@10': 1.0, 'time@10': 3.2584}:  97%|█████████▋| 29/30 [01:07<00:02,  2.79s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0206, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 3.2527}:  97%|█████████▋| 29/30 [01:10<00:02,  2.79s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0206, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 3.2527}: 100%|██████████| 30/30 [01:10<00:00,  2.89s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0206, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 3.2527}: 100%|██████████| 30/30 [01:10<00:00,  2.34s/it]
Epoch: 33
Avg # of users: 5.866666666666666
Avg Loss: 0.020642730898745333
Avg hit ratio: 0.8710713213555312
Avg ndcg: 0.8912984591698211
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2526915073394775
Std train time: 2.051603242068589
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 3.1257}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 3.1257}:   3%|▎         | 1/30 [00:01<00:46,  1.60s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9153, 'compress@10': 1.0, 'time@10': 2.8487}:   3%|▎         | 1/30 [00:04<00:46,  1.60s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9153, 'compress@10': 1.0, 'time@10': 2.8487}:   7%|▋         | 2/30 [00:04<01:01,  2.20s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 2.2195}:   7%|▋         | 2/30 [00:04<01:01,  2.20s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 2.2195}:  10%|█         | 3/30 [00:04<00:38,  1.43s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9012, 'compress@10': 1.0, 'time@10': 2.233}:  10%|█         | 3/30 [00:07<00:38,  1.43s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9012, 'compress@10': 1.0, 'time@10': 2.233}:  13%|█▎        | 4/30 [00:07<00:46,  1.78s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0211, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9094, 'compress@10': 1.0, 'time@10': 3.5014}:  13%|█▎        | 4/30 [00:11<00:46,  1.78s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0211, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9094, 'compress@10': 1.0, 'time@10': 3.5014}:  17%|█▋        | 5/30 [00:11<01:07,  2.70s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0218, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9134, 'compress@10': 1.0, 'time@10': 3.5618}:  17%|█▋        | 5/30 [00:15<01:07,  2.70s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0218, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9134, 'compress@10': 1.0, 'time@10': 3.5618}:  20%|██        | 6/30 [00:15<01:14,  3.11s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0221, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 3.6412}:  20%|██        | 6/30 [00:17<01:14,  3.11s/it] {'epoch': 34, 'num_users': 6.2857, 'loss': 0.0221, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 3.6412}:  23%|██▎       | 7/30 [00:17<01:03,  2.78s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9172, 'compress@10': 1.0, 'time@10': 3.5365}:  23%|██▎       | 7/30 [00:20<01:03,  2.78s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9172, 'compress@10': 1.0, 'time@10': 3.5365}:  27%|██▋       | 8/30 [00:20<01:01,  2.80s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0215, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9214, 'compress@10': 1.0, 'time@10': 3.813}:  27%|██▋       | 8/30 [00:23<01:01,  2.80s/it] {'epoch': 34, 'num_users': 6.3333, 'loss': 0.0215, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9214, 'compress@10': 1.0, 'time@10': 3.813}:  30%|███       | 9/30 [00:23<01:00,  2.88s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9226, 'compress@10': 1.0, 'time@10': 3.8015}:  30%|███       | 9/30 [00:26<01:00,  2.88s/it] {'epoch': 34, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9226, 'compress@10': 1.0, 'time@10': 3.8015}:  33%|███▎      | 10/30 [00:26<01:02,  3.14s/it]{'epoch': 34, 'num_users': 6.6364, 'loss': 0.0232, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9206, 'compress@10': 1.0, 'time@10': 3.828}:  33%|███▎      | 10/30 [00:29<01:02,  3.14s/it]{'epoch': 34, 'num_users': 6.6364, 'loss': 0.0232, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9206, 'compress@10': 1.0, 'time@10': 3.828}:  37%|███▋      | 11/30 [00:29<00:53,  2.82s/it]{'epoch': 34, 'num_users': 6.4167, 'loss': 0.0227, 'hit_ratio@10': 0.871, 'ndcg@10': 0.919, 'compress@10': 1.0, 'time@10': 3.5765}:  37%|███▋      | 11/30 [00:29<00:53,  2.82s/it] {'epoch': 34, 'num_users': 6.4167, 'loss': 0.0227, 'hit_ratio@10': 0.871, 'ndcg@10': 0.919, 'compress@10': 1.0, 'time@10': 3.5765}:  40%|████      | 12/30 [00:29<00:39,  2.22s/it]{'epoch': 34, 'num_users': 6.6154, 'loss': 0.0231, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9178, 'compress@10': 1.0, 'time@10': 3.5606}:  40%|████      | 12/30 [00:31<00:39,  2.22s/it]{'epoch': 34, 'num_users': 6.6154, 'loss': 0.0231, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9178, 'compress@10': 1.0, 'time@10': 3.5606}:  43%|████▎     | 13/30 [00:31<00:35,  2.07s/it]{'epoch': 34, 'num_users': 6.3571, 'loss': 0.0226, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.9087, 'compress@10': 1.0, 'time@10': 3.3332}:  43%|████▎     | 13/30 [00:32<00:35,  2.07s/it]{'epoch': 34, 'num_users': 6.3571, 'loss': 0.0226, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.9087, 'compress@10': 1.0, 'time@10': 3.3332}:  47%|████▋     | 14/30 [00:32<00:25,  1.57s/it]{'epoch': 34, 'num_users': 6.2667, 'loss': 0.0227, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 3.4495}:  47%|████▋     | 14/30 [00:34<00:25,  1.57s/it]  {'epoch': 34, 'num_users': 6.2667, 'loss': 0.0227, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 3.4495}:  50%|█████     | 15/30 [00:34<00:28,  1.87s/it]{'epoch': 34, 'num_users': 6.0625, 'loss': 0.0219, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.9086, 'compress@10': 1.0, 'time@10': 3.2919}:  50%|█████     | 15/30 [00:35<00:28,  1.87s/it]{'epoch': 34, 'num_users': 6.0625, 'loss': 0.0219, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.9086, 'compress@10': 1.0, 'time@10': 3.2919}:  53%|█████▎    | 16/30 [00:35<00:22,  1.60s/it]{'epoch': 34, 'num_users': 5.8235, 'loss': 0.0216, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.1347}:  53%|█████▎    | 16/30 [00:35<00:22,  1.60s/it]{'epoch': 34, 'num_users': 5.8235, 'loss': 0.0216, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.1347}:  57%|█████▋    | 17/30 [00:35<00:15,  1.22s/it]{'epoch': 34, 'num_users': 6.0556, 'loss': 0.0215, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.9011, 'compress@10': 1.0, 'time@10': 3.0938}:  57%|█████▋    | 17/30 [00:38<00:15,  1.22s/it]{'epoch': 34, 'num_users': 6.0556, 'loss': 0.0215, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.9011, 'compress@10': 1.0, 'time@10': 3.0938}:  60%|██████    | 18/30 [00:38<00:19,  1.59s/it]{'epoch': 34, 'num_users': 6.0, 'loss': 0.0211, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 3.0447}:  60%|██████    | 18/30 [00:39<00:19,  1.59s/it]    {'epoch': 34, 'num_users': 6.0, 'loss': 0.0211, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 3.0447}:  63%|██████▎   | 19/30 [00:39<00:15,  1.45s/it]{'epoch': 34, 'num_users': 6.15, 'loss': 0.0212, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9045, 'compress@10': 1.0, 'time@10': 3.1307}:  63%|██████▎   | 19/30 [00:44<00:15,  1.45s/it]{'epoch': 34, 'num_users': 6.15, 'loss': 0.0212, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9045, 'compress@10': 1.0, 'time@10': 3.1307}:  67%|██████▋   | 20/30 [00:44<00:24,  2.45s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.9058, 'compress@10': 1.0, 'time@10': 3.2964}:  67%|██████▋   | 20/30 [00:47<00:24,  2.45s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.9058, 'compress@10': 1.0, 'time@10': 3.2964}:  70%|███████   | 21/30 [00:47<00:24,  2.72s/it]{'epoch': 34, 'num_users': 6.1818, 'loss': 0.0216, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9063, 'compress@10': 1.0, 'time@10': 3.2253}:  70%|███████   | 21/30 [00:49<00:24,  2.72s/it]{'epoch': 34, 'num_users': 6.1818, 'loss': 0.0216, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9063, 'compress@10': 1.0, 'time@10': 3.2253}:  73%|███████▎  | 22/30 [00:49<00:19,  2.44s/it]{'epoch': 34, 'num_users': 6.1304, 'loss': 0.0213, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9072, 'compress@10': 1.0, 'time@10': 3.227}:  73%|███████▎  | 22/30 [00:51<00:19,  2.44s/it] {'epoch': 34, 'num_users': 6.1304, 'loss': 0.0213, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9072, 'compress@10': 1.0, 'time@10': 3.227}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it]{'epoch': 34, 'num_users': 5.9583, 'loss': 0.0219, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 3.106}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it] {'epoch': 34, 'num_users': 5.9583, 'loss': 0.0219, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 3.106}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0223, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8826, 'compress@10': 1.0, 'time@10': 2.9946}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 0.0223, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8826, 'compress@10': 1.0, 'time@10': 2.9946}:  83%|████████▎ | 25/30 [00:51<00:06,  1.22s/it]{'epoch': 34, 'num_users': 5.8077, 'loss': 0.0221, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 3.1393}:  83%|████████▎ | 25/30 [00:58<00:06,  1.22s/it]{'epoch': 34, 'num_users': 5.8077, 'loss': 0.0221, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 3.1393}:  87%|████████▋ | 26/30 [00:58<00:11,  2.89s/it]{'epoch': 34, 'num_users': 5.8889, 'loss': 0.0229, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 3.1906}:  87%|████████▋ | 26/30 [01:00<00:11,  2.89s/it]{'epoch': 34, 'num_users': 5.8889, 'loss': 0.0229, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 3.1906}:  90%|█████████ | 27/30 [01:00<00:08,  2.71s/it]{'epoch': 34, 'num_users': 6.0, 'loss': 0.0223, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.2289}:  90%|█████████ | 27/30 [01:05<00:08,  2.71s/it]   {'epoch': 34, 'num_users': 6.0, 'loss': 0.0223, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.2289}:  93%|█████████▎| 28/30 [01:05<00:06,  3.19s/it]{'epoch': 34, 'num_users': 5.8621, 'loss': 0.0221, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8904, 'compress@10': 1.0, 'time@10': 3.2344}:  93%|█████████▎| 28/30 [01:06<00:06,  3.19s/it]{'epoch': 34, 'num_users': 5.8621, 'loss': 0.0221, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8904, 'compress@10': 1.0, 'time@10': 3.2344}:  97%|█████████▋| 29/30 [01:06<00:02,  2.75s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.0221, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.2283}:  97%|█████████▋| 29/30 [01:09<00:02,  2.75s/it] {'epoch': 34, 'num_users': 5.8667, 'loss': 0.0221, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.2283}: 100%|██████████| 30/30 [01:09<00:00,  2.85s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.0221, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 3.2283}: 100%|██████████| 30/30 [01:09<00:00,  2.33s/it]
Epoch: 34
Avg # of users: 5.866666666666666
Avg Loss: 0.022086027900465384
Avg hit ratio: 0.8730496099172187
Avg ndcg: 0.8921886167403495
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2283111413319907
Std train time: 2.039272159400456
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 1.0, 'time@10': 3.0415}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 1.0, 'time@10': 3.0415}:   3%|▎         | 1/30 [00:01<00:45,  1.56s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.923, 'compress@10': 1.0, 'time@10': 2.7938}:   3%|▎         | 1/30 [00:04<00:45,  1.56s/it] {'epoch': 35, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.923, 'compress@10': 1.0, 'time@10': 2.7938}:   7%|▋         | 2/30 [00:04<01:00,  2.16s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8898, 'compress@10': 1.0, 'time@10': 2.1907}:   7%|▋         | 2/30 [00:04<01:00,  2.16s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8898, 'compress@10': 1.0, 'time@10': 2.1907}:  10%|█         | 3/30 [00:04<00:38,  1.42s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8862, 'compress@10': 1.0, 'time@10': 2.2154}:  10%|█         | 3/30 [00:07<00:38,  1.42s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8862, 'compress@10': 1.0, 'time@10': 2.2154}:  13%|█▎        | 4/30 [00:07<00:46,  1.78s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0179, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8974, 'compress@10': 1.0, 'time@10': 3.4735}:  13%|█▎        | 4/30 [00:11<00:46,  1.78s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0179, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8974, 'compress@10': 1.0, 'time@10': 3.4735}:  17%|█▋        | 5/30 [00:11<01:07,  2.69s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.017, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9048, 'compress@10': 1.0, 'time@10': 3.5255}:  17%|█▋        | 5/30 [00:15<01:07,  2.69s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.017, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9048, 'compress@10': 1.0, 'time@10': 3.5255}:  20%|██        | 6/30 [00:15<01:13,  3.07s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 3.6056}:  20%|██        | 6/30 [00:17<01:13,  3.07s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 3.6056}:  23%|██▎       | 7/30 [00:17<01:03,  2.75s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0181, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9108, 'compress@10': 1.0, 'time@10': 3.505}:  23%|██▎       | 7/30 [00:20<01:03,  2.75s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0181, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9108, 'compress@10': 1.0, 'time@10': 3.505}:  27%|██▋       | 8/30 [00:20<01:01,  2.78s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9139, 'compress@10': 1.0, 'time@10': 3.7869}:  27%|██▋       | 8/30 [00:23<01:01,  2.78s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9139, 'compress@10': 1.0, 'time@10': 3.7869}:  30%|███       | 9/30 [00:23<01:00,  2.87s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9192, 'compress@10': 1.0, 'time@10': 3.7676}:  30%|███       | 9/30 [00:26<01:00,  2.87s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9192, 'compress@10': 1.0, 'time@10': 3.7676}:  33%|███▎      | 10/30 [00:26<01:02,  3.10s/it]{'epoch': 35, 'num_users': 6.6364, 'loss': 0.0191, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 3.8272}:  33%|███▎      | 10/30 [00:28<01:02,  3.10s/it]{'epoch': 35, 'num_users': 6.6364, 'loss': 0.0191, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 3.8272}:  37%|███▋      | 11/30 [00:28<00:53,  2.84s/it]{'epoch': 35, 'num_users': 6.4167, 'loss': 0.0189, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9166, 'compress@10': 1.0, 'time@10': 3.5839}:  37%|███▋      | 11/30 [00:29<00:53,  2.84s/it]{'epoch': 35, 'num_users': 6.4167, 'loss': 0.0189, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9166, 'compress@10': 1.0, 'time@10': 3.5839}:  40%|████      | 12/30 [00:29<00:40,  2.27s/it]{'epoch': 35, 'num_users': 6.6154, 'loss': 0.0196, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 3.5893}:  40%|████      | 12/30 [00:31<00:40,  2.27s/it]{'epoch': 35, 'num_users': 6.6154, 'loss': 0.0196, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 3.5893}:  43%|████▎     | 13/30 [00:31<00:36,  2.14s/it]{'epoch': 35, 'num_users': 6.3571, 'loss': 0.0193, 'hit_ratio@10': 0.847, 'ndcg@10': 0.907, 'compress@10': 1.0, 'time@10': 3.3629}:  43%|████▎     | 13/30 [00:32<00:36,  2.14s/it]  {'epoch': 35, 'num_users': 6.3571, 'loss': 0.0193, 'hit_ratio@10': 0.847, 'ndcg@10': 0.907, 'compress@10': 1.0, 'time@10': 3.3629}:  47%|████▋     | 14/30 [00:32<00:26,  1.63s/it]{'epoch': 35, 'num_users': 6.2667, 'loss': 0.0198, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.9084, 'compress@10': 1.0, 'time@10': 3.4742}:  47%|████▋     | 14/30 [00:34<00:26,  1.63s/it]{'epoch': 35, 'num_users': 6.2667, 'loss': 0.0198, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.9084, 'compress@10': 1.0, 'time@10': 3.4742}:  50%|█████     | 15/30 [00:34<00:28,  1.91s/it]{'epoch': 35, 'num_users': 6.0625, 'loss': 0.0192, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.907, 'compress@10': 1.0, 'time@10': 3.3139}:  50%|█████     | 15/30 [00:35<00:28,  1.91s/it] {'epoch': 35, 'num_users': 6.0625, 'loss': 0.0192, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.907, 'compress@10': 1.0, 'time@10': 3.3139}:  53%|█████▎    | 16/30 [00:35<00:22,  1.62s/it]{'epoch': 35, 'num_users': 5.8235, 'loss': 0.0191, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8984, 'compress@10': 1.0, 'time@10': 3.1578}:  53%|█████▎    | 16/30 [00:36<00:22,  1.62s/it]{'epoch': 35, 'num_users': 5.8235, 'loss': 0.0191, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8984, 'compress@10': 1.0, 'time@10': 3.1578}:  57%|█████▋    | 17/30 [00:36<00:16,  1.24s/it]{'epoch': 35, 'num_users': 6.0556, 'loss': 0.0191, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8996, 'compress@10': 1.0, 'time@10': 3.115}:  57%|█████▋    | 17/30 [00:38<00:16,  1.24s/it] {'epoch': 35, 'num_users': 6.0556, 'loss': 0.0191, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8996, 'compress@10': 1.0, 'time@10': 3.115}:  60%|██████    | 18/30 [00:38<00:19,  1.60s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 0.0187, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 3.0672}:  60%|██████    | 18/30 [00:39<00:19,  1.60s/it]  {'epoch': 35, 'num_users': 6.0, 'loss': 0.0187, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 3.0672}:  63%|██████▎   | 19/30 [00:39<00:16,  1.46s/it]{'epoch': 35, 'num_users': 6.15, 'loss': 0.0189, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 3.1598}:  63%|██████▎   | 19/30 [00:44<00:16,  1.46s/it]{'epoch': 35, 'num_users': 6.15, 'loss': 0.0189, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 3.1598}:  67%|██████▋   | 20/30 [00:44<00:25,  2.51s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.9046, 'compress@10': 1.0, 'time@10': 3.3329}:  67%|██████▋   | 20/30 [00:48<00:25,  2.51s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.9046, 'compress@10': 1.0, 'time@10': 3.3329}:  70%|███████   | 21/30 [00:48<00:25,  2.79s/it]{'epoch': 35, 'num_users': 6.1818, 'loss': 0.0194, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9052, 'compress@10': 1.0, 'time@10': 3.2598}:  70%|███████   | 21/30 [00:49<00:25,  2.79s/it]{'epoch': 35, 'num_users': 6.1818, 'loss': 0.0194, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9052, 'compress@10': 1.0, 'time@10': 3.2598}:  73%|███████▎  | 22/30 [00:49<00:19,  2.48s/it]{'epoch': 35, 'num_users': 6.1304, 'loss': 0.0191, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9061, 'compress@10': 1.0, 'time@10': 3.2546}:  73%|███████▎  | 22/30 [00:51<00:19,  2.48s/it]{'epoch': 35, 'num_users': 6.1304, 'loss': 0.0191, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9061, 'compress@10': 1.0, 'time@10': 3.2546}:  77%|███████▋  | 23/30 [00:51<00:15,  2.22s/it]{'epoch': 35, 'num_users': 5.9583, 'loss': 0.0198, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8966, 'compress@10': 1.0, 'time@10': 3.1332}:  77%|███████▋  | 23/30 [00:51<00:15,  2.22s/it]{'epoch': 35, 'num_users': 5.9583, 'loss': 0.0198, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8966, 'compress@10': 1.0, 'time@10': 3.1332}:  80%|████████  | 24/30 [00:51<00:09,  1.67s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0203, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8816, 'compress@10': 1.0, 'time@10': 3.0207}:  80%|████████  | 24/30 [00:52<00:09,  1.67s/it]   {'epoch': 35, 'num_users': 5.8, 'loss': 0.0203, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8816, 'compress@10': 1.0, 'time@10': 3.0207}:  83%|████████▎ | 25/30 [00:52<00:06,  1.23s/it]{'epoch': 35, 'num_users': 5.8077, 'loss': 0.0202, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8852, 'compress@10': 1.0, 'time@10': 3.161}:  83%|████████▎ | 25/30 [00:58<00:06,  1.23s/it]{'epoch': 35, 'num_users': 5.8077, 'loss': 0.0202, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8852, 'compress@10': 1.0, 'time@10': 3.161}:  87%|████████▋ | 26/30 [00:58<00:11,  2.87s/it]{'epoch': 35, 'num_users': 5.8889, 'loss': 0.0207, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8893, 'compress@10': 1.0, 'time@10': 3.1945}:  87%|████████▋ | 26/30 [01:00<00:11,  2.87s/it]{'epoch': 35, 'num_users': 5.8889, 'loss': 0.0207, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8893, 'compress@10': 1.0, 'time@10': 3.1945}:  90%|█████████ | 27/30 [01:00<00:07,  2.63s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 0.0209, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8932, 'compress@10': 1.0, 'time@10': 3.2309}:  90%|█████████ | 27/30 [01:05<00:07,  2.63s/it]   {'epoch': 35, 'num_users': 6.0, 'loss': 0.0209, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8932, 'compress@10': 1.0, 'time@10': 3.2309}:  93%|█████████▎| 28/30 [01:05<00:06,  3.12s/it]{'epoch': 35, 'num_users': 5.8621, 'loss': 0.0206, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.2357}:  93%|█████████▎| 28/30 [01:06<00:06,  3.12s/it]{'epoch': 35, 'num_users': 5.8621, 'loss': 0.0206, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.2357}:  97%|█████████▋| 29/30 [01:06<00:02,  2.70s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0206, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.234}:  97%|█████████▋| 29/30 [01:09<00:02,  2.70s/it] {'epoch': 35, 'num_users': 5.8667, 'loss': 0.0206, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.234}: 100%|██████████| 30/30 [01:09<00:00,  2.86s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0206, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.234}: 100%|██████████| 30/30 [01:09<00:00,  2.33s/it]
Epoch: 35
Avg # of users: 5.866666666666666
Avg Loss: 0.020643740061205427
Avg hit ratio: 0.8678503169417421
Avg ndcg: 0.8966712357846055
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2339908361434935
Std train time: 2.0296313383667615
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 1.0, 'time@10': 3.0771}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 1.0, 'time@10': 3.0771}:   3%|▎         | 1/30 [00:01<00:45,  1.58s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9216, 'compress@10': 1.0, 'time@10': 2.8242}:   3%|▎         | 1/30 [00:04<00:45,  1.58s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9216, 'compress@10': 1.0, 'time@10': 2.8242}:   7%|▋         | 2/30 [00:04<01:01,  2.18s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8889, 'compress@10': 1.0, 'time@10': 2.2102}:   7%|▋         | 2/30 [00:04<01:01,  2.18s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8889, 'compress@10': 1.0, 'time@10': 2.2102}:  10%|█         | 3/30 [00:04<00:38,  1.43s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 2.2144}:  10%|█         | 3/30 [00:06<00:38,  1.43s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 2.2144}:  13%|█▎        | 4/30 [00:06<00:45,  1.76s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.9102, 'compress@10': 1.0, 'time@10': 3.4973}:  13%|█▎        | 4/30 [00:11<00:45,  1.76s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.9102, 'compress@10': 1.0, 'time@10': 3.4973}:  17%|█▋        | 5/30 [00:11<01:07,  2.69s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 3.5438}:  17%|█▋        | 5/30 [00:15<01:07,  2.69s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 3.5438}:  20%|██        | 6/30 [00:15<01:13,  3.08s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0156, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 3.6212}:  20%|██        | 6/30 [00:17<01:13,  3.08s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0156, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 3.6212}:  23%|██▎       | 7/30 [00:17<01:03,  2.75s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9199, 'compress@10': 1.0, 'time@10': 3.5211}:  23%|██▎       | 7/30 [00:20<01:03,  2.75s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9199, 'compress@10': 1.0, 'time@10': 3.5211}:  27%|██▋       | 8/30 [00:20<01:01,  2.79s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0197, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.941, 'compress@10': 1.0, 'time@10': 3.7793}:  27%|██▋       | 8/30 [00:23<01:01,  2.79s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0197, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.941, 'compress@10': 1.0, 'time@10': 3.7793}:  30%|███       | 9/30 [00:23<00:59,  2.84s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9415, 'compress@10': 1.0, 'time@10': 3.7629}:  30%|███       | 9/30 [00:26<00:59,  2.84s/it]  {'epoch': 36, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9415, 'compress@10': 1.0, 'time@10': 3.7629}:  33%|███▎      | 10/30 [00:26<01:01,  3.09s/it]{'epoch': 36, 'num_users': 6.6364, 'loss': 0.0207, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9394, 'compress@10': 1.0, 'time@10': 3.821}:  33%|███▎      | 10/30 [00:28<01:01,  3.09s/it]{'epoch': 36, 'num_users': 6.6364, 'loss': 0.0207, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9394, 'compress@10': 1.0, 'time@10': 3.821}:  37%|███▋      | 11/30 [00:28<00:53,  2.83s/it]{'epoch': 36, 'num_users': 6.4167, 'loss': 0.0204, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9362, 'compress@10': 1.0, 'time@10': 3.5788}:  37%|███▋      | 11/30 [00:29<00:53,  2.83s/it]{'epoch': 36, 'num_users': 6.4167, 'loss': 0.0204, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9362, 'compress@10': 1.0, 'time@10': 3.5788}:  40%|████      | 12/30 [00:29<00:40,  2.26s/it]{'epoch': 36, 'num_users': 6.6154, 'loss': 0.0208, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.934, 'compress@10': 1.0, 'time@10': 3.5845}:  40%|████      | 12/30 [00:31<00:40,  2.26s/it] {'epoch': 36, 'num_users': 6.6154, 'loss': 0.0208, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.934, 'compress@10': 1.0, 'time@10': 3.5845}:  43%|████▎     | 13/30 [00:31<00:36,  2.14s/it]{'epoch': 36, 'num_users': 6.3571, 'loss': 0.0205, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.9238, 'compress@10': 1.0, 'time@10': 3.3583}:  43%|████▎     | 13/30 [00:32<00:36,  2.14s/it]{'epoch': 36, 'num_users': 6.3571, 'loss': 0.0205, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.9238, 'compress@10': 1.0, 'time@10': 3.3583}:  47%|████▋     | 14/30 [00:32<00:26,  1.63s/it]{'epoch': 36, 'num_users': 6.2667, 'loss': 0.0216, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.924, 'compress@10': 1.0, 'time@10': 3.4715}:  47%|████▋     | 14/30 [00:34<00:26,  1.63s/it] {'epoch': 36, 'num_users': 6.2667, 'loss': 0.0216, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.924, 'compress@10': 1.0, 'time@10': 3.4715}:  50%|█████     | 15/30 [00:34<00:28,  1.91s/it]{'epoch': 36, 'num_users': 6.0625, 'loss': 0.0208, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9217, 'compress@10': 1.0, 'time@10': 3.3114}:  50%|█████     | 15/30 [00:35<00:28,  1.91s/it]{'epoch': 36, 'num_users': 6.0625, 'loss': 0.0208, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9217, 'compress@10': 1.0, 'time@10': 3.3114}:  53%|█████▎    | 16/30 [00:35<00:22,  1.62s/it]{'epoch': 36, 'num_users': 5.8235, 'loss': 0.0206, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.9122, 'compress@10': 1.0, 'time@10': 3.1549}:  53%|█████▎    | 16/30 [00:36<00:22,  1.62s/it]{'epoch': 36, 'num_users': 5.8235, 'loss': 0.0206, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.9122, 'compress@10': 1.0, 'time@10': 3.1549}:  57%|█████▋    | 17/30 [00:36<00:16,  1.24s/it]{'epoch': 36, 'num_users': 6.0556, 'loss': 0.0205, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 3.111}:  57%|█████▋    | 17/30 [00:38<00:16,  1.24s/it] {'epoch': 36, 'num_users': 6.0556, 'loss': 0.0205, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 3.111}:  60%|██████    | 18/30 [00:38<00:19,  1.59s/it]{'epoch': 36, 'num_users': 6.0, 'loss': 0.02, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9131, 'compress@10': 1.0, 'time@10': 3.0611}:  60%|██████    | 18/30 [00:39<00:19,  1.59s/it]    {'epoch': 36, 'num_users': 6.0, 'loss': 0.02, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9131, 'compress@10': 1.0, 'time@10': 3.0611}:  63%|██████▎   | 19/30 [00:39<00:15,  1.45s/it]{'epoch': 36, 'num_users': 6.15, 'loss': 0.0201, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9156, 'compress@10': 1.0, 'time@10': 3.1499}:  63%|██████▎   | 19/30 [00:44<00:15,  1.45s/it]{'epoch': 36, 'num_users': 6.15, 'loss': 0.0201, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9156, 'compress@10': 1.0, 'time@10': 3.1499}:  67%|██████▋   | 20/30 [00:44<00:24,  2.48s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.9166, 'compress@10': 1.0, 'time@10': 3.3223}:  67%|██████▋   | 20/30 [00:47<00:24,  2.48s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.9166, 'compress@10': 1.0, 'time@10': 3.3223}:  70%|███████   | 21/30 [00:47<00:24,  2.76s/it]{'epoch': 36, 'num_users': 6.1818, 'loss': 0.0204, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9167, 'compress@10': 1.0, 'time@10': 3.2493}:  70%|███████   | 21/30 [00:49<00:24,  2.76s/it]{'epoch': 36, 'num_users': 6.1818, 'loss': 0.0204, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9167, 'compress@10': 1.0, 'time@10': 3.2493}:  73%|███████▎  | 22/30 [00:49<00:19,  2.46s/it]{'epoch': 36, 'num_users': 6.1304, 'loss': 0.0201, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.2472}:  73%|███████▎  | 22/30 [00:51<00:19,  2.46s/it]{'epoch': 36, 'num_users': 6.1304, 'loss': 0.0201, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.2472}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it]{'epoch': 36, 'num_users': 5.9583, 'loss': 0.0207, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 3.1256}:  77%|███████▋  | 23/30 [00:51<00:15,  2.21s/it] {'epoch': 36, 'num_users': 5.9583, 'loss': 0.0207, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 3.1256}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0211, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 3.0133}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]  {'epoch': 36, 'num_users': 5.8, 'loss': 0.0211, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 3.0133}:  83%|████████▎ | 25/30 [00:51<00:06,  1.22s/it]{'epoch': 36, 'num_users': 5.8077, 'loss': 0.0211, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 3.1566}:  83%|████████▎ | 25/30 [00:58<00:06,  1.22s/it]{'epoch': 36, 'num_users': 5.8077, 'loss': 0.0211, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 3.1566}:  87%|████████▋ | 26/30 [00:58<00:11,  2.89s/it]{'epoch': 36, 'num_users': 5.8889, 'loss': 0.0206, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 3.2147}:  87%|████████▋ | 26/30 [01:01<00:11,  2.89s/it]{'epoch': 36, 'num_users': 5.8889, 'loss': 0.0206, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 3.2147}:  90%|█████████ | 27/30 [01:01<00:08,  2.74s/it]{'epoch': 36, 'num_users': 6.0, 'loss': 0.0209, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8994, 'compress@10': 1.0, 'time@10': 3.2461}:  90%|█████████ | 27/30 [01:05<00:08,  2.74s/it]   {'epoch': 36, 'num_users': 6.0, 'loss': 0.0209, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8994, 'compress@10': 1.0, 'time@10': 3.2461}:  93%|█████████▎| 28/30 [01:05<00:06,  3.16s/it]{'epoch': 36, 'num_users': 5.8621, 'loss': 0.0207, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.901, 'compress@10': 1.0, 'time@10': 3.2537}:  93%|█████████▎| 28/30 [01:06<00:06,  3.16s/it]{'epoch': 36, 'num_users': 5.8621, 'loss': 0.0207, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.901, 'compress@10': 1.0, 'time@10': 3.2537}:  97%|█████████▋| 29/30 [01:06<00:02,  2.74s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0208, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9026, 'compress@10': 1.0, 'time@10': 3.2544}:  97%|█████████▋| 29/30 [01:10<00:02,  2.74s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0208, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9026, 'compress@10': 1.0, 'time@10': 3.2544}: 100%|██████████| 30/30 [01:10<00:00,  2.91s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0208, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9026, 'compress@10': 1.0, 'time@10': 3.2544}: 100%|██████████| 30/30 [01:10<00:00,  2.34s/it]
Epoch: 36
Avg # of users: 5.866666666666666
Avg Loss: 0.020764520560228893
Avg hit ratio: 0.8737202344423324
Avg ndcg: 0.9025640261253016
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2543744405110675
Std train time: 2.0457373759090105
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0259, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 1.0, 'time@10': 3.09}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0259, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 1.0, 'time@10': 3.09}:   3%|▎         | 1/30 [00:01<00:45,  1.58s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9236, 'compress@10': 1.0, 'time@10': 2.8214}:   3%|▎         | 1/30 [00:04<00:45,  1.58s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9236, 'compress@10': 1.0, 'time@10': 2.8214}:   7%|▋         | 2/30 [00:04<01:00,  2.17s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 2.2061}:   7%|▋         | 2/30 [00:04<01:00,  2.17s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 2.2061}:  10%|█         | 3/30 [00:04<00:38,  1.42s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 2.2152}:  10%|█         | 3/30 [00:06<00:38,  1.42s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 2.2152}:  13%|█▎        | 4/30 [00:06<00:45,  1.76s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0161, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9071, 'compress@10': 1.0, 'time@10': 3.4624}:  13%|█▎        | 4/30 [00:11<00:45,  1.76s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0161, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9071, 'compress@10': 1.0, 'time@10': 3.4624}:  17%|█▋        | 5/30 [00:11<01:06,  2.66s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0177, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9139, 'compress@10': 1.0, 'time@10': 3.4799}:  17%|█▋        | 5/30 [00:14<01:06,  2.66s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0177, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9139, 'compress@10': 1.0, 'time@10': 3.4799}:  20%|██        | 6/30 [00:14<01:11,  2.98s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.913, 'compress@10': 1.0, 'time@10': 3.5304}:  20%|██        | 6/30 [00:16<01:11,  2.98s/it]  {'epoch': 37, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.913, 'compress@10': 1.0, 'time@10': 3.5304}:  23%|██▎       | 7/30 [00:16<01:00,  2.65s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0182, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.9189, 'compress@10': 1.0, 'time@10': 3.4219}:  23%|██▎       | 7/30 [00:19<01:00,  2.65s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0182, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.9189, 'compress@10': 1.0, 'time@10': 3.4219}:  27%|██▋       | 8/30 [00:19<00:58,  2.66s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0224, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9368, 'compress@10': 1.0, 'time@10': 3.6902}:  27%|██▋       | 8/30 [00:22<00:58,  2.66s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0224, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9368, 'compress@10': 1.0, 'time@10': 3.6902}:  30%|███       | 9/30 [00:22<00:57,  2.75s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9402, 'compress@10': 1.0, 'time@10': 3.6829}:  30%|███       | 9/30 [00:26<00:57,  2.75s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9402, 'compress@10': 1.0, 'time@10': 3.6829}:  33%|███▎      | 10/30 [00:26<01:00,  3.03s/it]{'epoch': 37, 'num_users': 6.6364, 'loss': 0.0217, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9372, 'compress@10': 1.0, 'time@10': 3.7538}:  33%|███▎      | 10/30 [00:28<01:00,  3.03s/it]{'epoch': 37, 'num_users': 6.6364, 'loss': 0.0217, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9372, 'compress@10': 1.0, 'time@10': 3.7538}:  37%|███▋      | 11/30 [00:28<00:53,  2.80s/it]{'epoch': 37, 'num_users': 6.4167, 'loss': 0.0212, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9342, 'compress@10': 1.0, 'time@10': 3.5174}:  37%|███▋      | 11/30 [00:29<00:53,  2.80s/it]{'epoch': 37, 'num_users': 6.4167, 'loss': 0.0212, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9342, 'compress@10': 1.0, 'time@10': 3.5174}:  40%|████      | 12/30 [00:29<00:40,  2.24s/it]{'epoch': 37, 'num_users': 6.6154, 'loss': 0.0216, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9321, 'compress@10': 1.0, 'time@10': 3.5255}:  40%|████      | 12/30 [00:31<00:40,  2.24s/it] {'epoch': 37, 'num_users': 6.6154, 'loss': 0.0216, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9321, 'compress@10': 1.0, 'time@10': 3.5255}:  43%|████▎     | 13/30 [00:31<00:36,  2.12s/it]{'epoch': 37, 'num_users': 6.3571, 'loss': 0.0212, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 3.3023}:  43%|████▎     | 13/30 [00:31<00:36,  2.12s/it]{'epoch': 37, 'num_users': 6.3571, 'loss': 0.0212, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 3.3023}:  47%|████▋     | 14/30 [00:31<00:25,  1.61s/it]{'epoch': 37, 'num_users': 6.2667, 'loss': 0.0214, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9224, 'compress@10': 1.0, 'time@10': 3.4133}:  47%|████▋     | 14/30 [00:34<00:25,  1.61s/it]{'epoch': 37, 'num_users': 6.2667, 'loss': 0.0214, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9224, 'compress@10': 1.0, 'time@10': 3.4133}:  50%|█████     | 15/30 [00:34<00:28,  1.89s/it]{'epoch': 37, 'num_users': 6.0625, 'loss': 0.0207, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9203, 'compress@10': 1.0, 'time@10': 3.2571}:  50%|█████     | 15/30 [00:35<00:28,  1.89s/it]{'epoch': 37, 'num_users': 6.0625, 'loss': 0.0207, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9203, 'compress@10': 1.0, 'time@10': 3.2571}:  53%|█████▎    | 16/30 [00:35<00:22,  1.61s/it]{'epoch': 37, 'num_users': 5.8235, 'loss': 0.0205, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.9109, 'compress@10': 1.0, 'time@10': 3.102}:  53%|█████▎    | 16/30 [00:35<00:22,  1.61s/it] {'epoch': 37, 'num_users': 5.8235, 'loss': 0.0205, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.9109, 'compress@10': 1.0, 'time@10': 3.102}:  57%|█████▋    | 17/30 [00:35<00:15,  1.23s/it]{'epoch': 37, 'num_users': 6.0556, 'loss': 0.0203, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9116, 'compress@10': 1.0, 'time@10': 3.0645}:  57%|█████▋    | 17/30 [00:37<00:15,  1.23s/it]{'epoch': 37, 'num_users': 6.0556, 'loss': 0.0203, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9116, 'compress@10': 1.0, 'time@10': 3.0645}:  60%|██████    | 18/30 [00:37<00:19,  1.60s/it]{'epoch': 37, 'num_users': 6.0, 'loss': 0.0198, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.9117, 'compress@10': 1.0, 'time@10': 3.0169}:  60%|██████    | 18/30 [00:39<00:19,  1.60s/it]   {'epoch': 37, 'num_users': 6.0, 'loss': 0.0198, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.9117, 'compress@10': 1.0, 'time@10': 3.0169}:  63%|██████▎   | 19/30 [00:39<00:16,  1.46s/it]{'epoch': 37, 'num_users': 6.15, 'loss': 0.02, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9145, 'compress@10': 1.0, 'time@10': 3.1093}:  63%|██████▎   | 19/30 [00:43<00:16,  1.46s/it] {'epoch': 37, 'num_users': 6.15, 'loss': 0.02, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9145, 'compress@10': 1.0, 'time@10': 3.1093}:  67%|██████▋   | 20/30 [00:43<00:24,  2.49s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0199, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9156, 'compress@10': 1.0, 'time@10': 3.288}:  67%|██████▋   | 20/30 [00:47<00:24,  2.49s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0199, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9156, 'compress@10': 1.0, 'time@10': 3.288}:  70%|███████   | 21/30 [00:47<00:25,  2.78s/it]{'epoch': 37, 'num_users': 6.1818, 'loss': 0.0203, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9157, 'compress@10': 1.0, 'time@10': 3.2178}:  70%|███████   | 21/30 [00:49<00:25,  2.78s/it]{'epoch': 37, 'num_users': 6.1818, 'loss': 0.0203, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9157, 'compress@10': 1.0, 'time@10': 3.2178}:  73%|███████▎  | 22/30 [00:49<00:19,  2.48s/it]{'epoch': 37, 'num_users': 6.1304, 'loss': 0.02, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.9161, 'compress@10': 1.0, 'time@10': 3.2183}:  73%|███████▎  | 22/30 [00:50<00:19,  2.48s/it]  {'epoch': 37, 'num_users': 6.1304, 'loss': 0.02, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.9161, 'compress@10': 1.0, 'time@10': 3.2183}:  77%|███████▋  | 23/30 [00:50<00:15,  2.23s/it]{'epoch': 37, 'num_users': 5.9583, 'loss': 0.0206, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9062, 'compress@10': 1.0, 'time@10': 3.0981}:  77%|███████▋  | 23/30 [00:51<00:15,  2.23s/it]{'epoch': 37, 'num_users': 5.9583, 'loss': 0.0206, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9062, 'compress@10': 1.0, 'time@10': 3.0981}:  80%|████████  | 24/30 [00:51<00:10,  1.68s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.021, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8908, 'compress@10': 1.0, 'time@10': 2.9871}:  80%|████████  | 24/30 [00:51<00:10,  1.68s/it]    {'epoch': 37, 'num_users': 5.8, 'loss': 0.021, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8908, 'compress@10': 1.0, 'time@10': 2.9871}:  83%|████████▎ | 25/30 [00:51<00:06,  1.23s/it]{'epoch': 37, 'num_users': 5.8077, 'loss': 0.021, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8941, 'compress@10': 1.0, 'time@10': 3.1474}:  83%|████████▎ | 25/30 [00:58<00:06,  1.23s/it]{'epoch': 37, 'num_users': 5.8077, 'loss': 0.021, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8941, 'compress@10': 1.0, 'time@10': 3.1474}:  87%|████████▋ | 26/30 [00:58<00:12,  3.02s/it]{'epoch': 37, 'num_users': 5.8889, 'loss': 0.0206, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 3.203}:  87%|████████▋ | 26/30 [01:00<00:12,  3.02s/it]{'epoch': 37, 'num_users': 5.8889, 'loss': 0.0206, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 3.203}:  90%|█████████ | 27/30 [01:00<00:08,  2.82s/it]{'epoch': 37, 'num_users': 6.0, 'loss': 0.0202, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.2435}:  90%|█████████ | 27/30 [01:05<00:08,  2.82s/it]  {'epoch': 37, 'num_users': 6.0, 'loss': 0.0202, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.2435}:  93%|█████████▎| 28/30 [01:05<00:06,  3.29s/it]{'epoch': 37, 'num_users': 5.8621, 'loss': 0.02, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.2495}:  93%|█████████▎| 28/30 [01:07<00:06,  3.29s/it]{'epoch': 37, 'num_users': 5.8621, 'loss': 0.02, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.2495}:  97%|█████████▋| 29/30 [01:07<00:02,  2.83s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0201, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9015, 'compress@10': 1.0, 'time@10': 3.2424}:  97%|█████████▋| 29/30 [01:10<00:02,  2.83s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0201, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9015, 'compress@10': 1.0, 'time@10': 3.2424}: 100%|██████████| 30/30 [01:10<00:00,  2.90s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0201, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9015, 'compress@10': 1.0, 'time@10': 3.2424}: 100%|██████████| 30/30 [01:10<00:00,  2.34s/it]
Epoch: 37
Avg # of users: 5.866666666666666
Avg Loss: 0.02005192622333286
Avg hit ratio: 0.874122780648926
Avg ndcg: 0.9015138743660068
Avg compression ratio: 0.9999999860153537
Avg train time: 3.242444133758545
Std train time: 2.0589078817024866
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 3.1072}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 3.1072}:   3%|▎         | 1/30 [00:01<00:46,  1.59s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9242, 'compress@10': 1.0, 'time@10': 2.7864}:   3%|▎         | 1/30 [00:04<00:46,  1.59s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9242, 'compress@10': 1.0, 'time@10': 2.7864}:   7%|▋         | 2/30 [00:04<00:59,  2.13s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 2.1641}:   7%|▋         | 2/30 [00:04<00:59,  2.13s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 2.1641}:  10%|█         | 3/30 [00:04<00:37,  1.38s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8881, 'compress@10': 1.0, 'time@10': 2.1764}:  10%|█         | 3/30 [00:06<00:37,  1.38s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8881, 'compress@10': 1.0, 'time@10': 2.1764}:  13%|█▎        | 4/30 [00:06<00:44,  1.73s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0188, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 3.4225}:  13%|█▎        | 4/30 [00:11<00:44,  1.73s/it]   {'epoch': 38, 'num_users': 5.8, 'loss': 0.0188, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 3.4225}:  17%|█▋        | 5/30 [00:11<01:05,  2.63s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0173, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9083, 'compress@10': 1.0, 'time@10': 3.4811}:  17%|█▋        | 5/30 [00:14<01:05,  2.63s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0173, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9083, 'compress@10': 1.0, 'time@10': 3.4811}:  20%|██        | 6/30 [00:14<01:12,  3.03s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9085, 'compress@10': 1.0, 'time@10': 3.5659}:  20%|██        | 6/30 [00:16<01:12,  3.03s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9085, 'compress@10': 1.0, 'time@10': 3.5659}:  23%|██▎       | 7/30 [00:16<01:02,  2.72s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.018, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 3.4721}:  23%|██▎       | 7/30 [00:19<01:02,  2.72s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.018, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 3.4721}:  27%|██▋       | 8/30 [00:19<01:00,  2.76s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9205, 'compress@10': 1.0, 'time@10': 3.7499}:  27%|██▋       | 8/30 [00:22<01:00,  2.76s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9205, 'compress@10': 1.0, 'time@10': 3.7499}:  30%|███       | 9/30 [00:22<00:59,  2.84s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0229, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9199, 'compress@10': 1.0, 'time@10': 3.7368}:  30%|███       | 9/30 [00:26<00:59,  2.84s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0229, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9199, 'compress@10': 1.0, 'time@10': 3.7368}:  33%|███▎      | 10/30 [00:26<01:01,  3.10s/it]{'epoch': 38, 'num_users': 6.6364, 'loss': 0.0239, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9198, 'compress@10': 1.0, 'time@10': 3.7926}:  33%|███▎      | 10/30 [00:28<01:01,  3.10s/it]{'epoch': 38, 'num_users': 6.6364, 'loss': 0.0239, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9198, 'compress@10': 1.0, 'time@10': 3.7926}:  37%|███▋      | 11/30 [00:28<00:53,  2.83s/it]{'epoch': 38, 'num_users': 6.4167, 'loss': 0.0233, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.9182, 'compress@10': 1.0, 'time@10': 3.5528}:  37%|███▋      | 11/30 [00:29<00:53,  2.83s/it]{'epoch': 38, 'num_users': 6.4167, 'loss': 0.0233, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.9182, 'compress@10': 1.0, 'time@10': 3.5528}:  40%|████      | 12/30 [00:29<00:40,  2.25s/it]{'epoch': 38, 'num_users': 6.6154, 'loss': 0.0234, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9172, 'compress@10': 1.0, 'time@10': 3.5627}:  40%|████      | 12/30 [00:31<00:40,  2.25s/it]{'epoch': 38, 'num_users': 6.6154, 'loss': 0.0234, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9172, 'compress@10': 1.0, 'time@10': 3.5627}:  43%|████▎     | 13/30 [00:31<00:36,  2.14s/it]{'epoch': 38, 'num_users': 6.3571, 'loss': 0.0229, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9082, 'compress@10': 1.0, 'time@10': 3.3367}:  43%|████▎     | 13/30 [00:31<00:36,  2.14s/it]{'epoch': 38, 'num_users': 6.3571, 'loss': 0.0229, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9082, 'compress@10': 1.0, 'time@10': 3.3367}:  47%|████▋     | 14/30 [00:31<00:26,  1.63s/it]{'epoch': 38, 'num_users': 6.2667, 'loss': 0.0221, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9103, 'compress@10': 1.0, 'time@10': 3.4533}:  47%|████▋     | 14/30 [00:34<00:26,  1.63s/it]{'epoch': 38, 'num_users': 6.2667, 'loss': 0.0221, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9103, 'compress@10': 1.0, 'time@10': 3.4533}:  50%|█████     | 15/30 [00:34<00:28,  1.91s/it]{'epoch': 38, 'num_users': 6.0625, 'loss': 0.0212, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 3.295}:  50%|█████     | 15/30 [00:35<00:28,  1.91s/it] {'epoch': 38, 'num_users': 6.0625, 'loss': 0.0212, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 3.295}:  53%|█████▎    | 16/30 [00:35<00:22,  1.63s/it]{'epoch': 38, 'num_users': 5.8235, 'loss': 0.021, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 3.1402}:  53%|█████▎    | 16/30 [00:35<00:22,  1.63s/it]{'epoch': 38, 'num_users': 5.8235, 'loss': 0.021, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 3.1402}:  57%|█████▋    | 17/30 [00:35<00:16,  1.25s/it]{'epoch': 38, 'num_users': 6.0556, 'loss': 0.0208, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 3.0972}:  57%|█████▋    | 17/30 [00:38<00:16,  1.25s/it]{'epoch': 38, 'num_users': 6.0556, 'loss': 0.0208, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 3.0972}:  60%|██████    | 18/30 [00:38<00:19,  1.60s/it]{'epoch': 38, 'num_users': 6.0, 'loss': 0.0203, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.9022, 'compress@10': 1.0, 'time@10': 3.0496}:  60%|██████    | 18/30 [00:39<00:19,  1.60s/it]   {'epoch': 38, 'num_users': 6.0, 'loss': 0.0203, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.9022, 'compress@10': 1.0, 'time@10': 3.0496}:  63%|██████▎   | 19/30 [00:39<00:16,  1.46s/it]{'epoch': 38, 'num_users': 6.15, 'loss': 0.0204, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.906, 'compress@10': 1.0, 'time@10': 3.1347}:  63%|██████▎   | 19/30 [00:44<00:16,  1.46s/it]{'epoch': 38, 'num_users': 6.15, 'loss': 0.0204, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.906, 'compress@10': 1.0, 'time@10': 3.1347}:  67%|██████▋   | 20/30 [00:44<00:24,  2.46s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9079, 'compress@10': 1.0, 'time@10': 3.283}:  67%|██████▋   | 20/30 [00:47<00:24,  2.46s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9079, 'compress@10': 1.0, 'time@10': 3.283}:  70%|███████   | 21/30 [00:47<00:24,  2.67s/it]{'epoch': 38, 'num_users': 6.1818, 'loss': 0.0206, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9084, 'compress@10': 1.0, 'time@10': 3.205}:  70%|███████   | 21/30 [00:48<00:24,  2.67s/it]{'epoch': 38, 'num_users': 6.1818, 'loss': 0.0206, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9084, 'compress@10': 1.0, 'time@10': 3.205}:  73%|███████▎  | 22/30 [00:48<00:18,  2.35s/it]{'epoch': 38, 'num_users': 6.1304, 'loss': 0.0203, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9095, 'compress@10': 1.0, 'time@10': 3.2002}:  73%|███████▎  | 22/30 [00:50<00:18,  2.35s/it]{'epoch': 38, 'num_users': 6.1304, 'loss': 0.0203, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9095, 'compress@10': 1.0, 'time@10': 3.2002}:  77%|███████▋  | 23/30 [00:50<00:14,  2.12s/it]{'epoch': 38, 'num_users': 5.9583, 'loss': 0.0209, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 3.0796}:  77%|███████▋  | 23/30 [00:50<00:14,  2.12s/it]{'epoch': 38, 'num_users': 5.9583, 'loss': 0.0209, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 3.0796}:  80%|████████  | 24/30 [00:50<00:09,  1.59s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0213, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 2.9689}:  80%|████████  | 24/30 [00:51<00:09,  1.59s/it]   {'epoch': 38, 'num_users': 5.8, 'loss': 0.0213, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 2.9689}:  83%|████████▎ | 25/30 [00:51<00:05,  1.17s/it]{'epoch': 38, 'num_users': 5.8077, 'loss': 0.0211, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.1219}:  83%|████████▎ | 25/30 [00:58<00:05,  1.17s/it]{'epoch': 38, 'num_users': 5.8077, 'loss': 0.0211, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 3.1219}:  87%|████████▋ | 26/30 [00:58<00:11,  2.91s/it]{'epoch': 38, 'num_users': 5.8889, 'loss': 0.0209, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8893, 'compress@10': 1.0, 'time@10': 3.1763}:  87%|████████▋ | 26/30 [01:00<00:11,  2.91s/it]{'epoch': 38, 'num_users': 5.8889, 'loss': 0.0209, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8893, 'compress@10': 1.0, 'time@10': 3.1763}:  90%|█████████ | 27/30 [01:00<00:08,  2.74s/it]{'epoch': 38, 'num_users': 6.0, 'loss': 0.0208, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8917, 'compress@10': 1.0, 'time@10': 3.2128}:  90%|█████████ | 27/30 [01:04<00:08,  2.74s/it]   {'epoch': 38, 'num_users': 6.0, 'loss': 0.0208, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8917, 'compress@10': 1.0, 'time@10': 3.2128}:  93%|█████████▎| 28/30 [01:04<00:06,  3.19s/it]{'epoch': 38, 'num_users': 5.8621, 'loss': 0.0206, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8935, 'compress@10': 1.0, 'time@10': 3.2214}:  93%|█████████▎| 28/30 [01:06<00:06,  3.19s/it]{'epoch': 38, 'num_users': 5.8621, 'loss': 0.0206, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8935, 'compress@10': 1.0, 'time@10': 3.2214}:  97%|█████████▋| 29/30 [01:06<00:02,  2.76s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0207, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 3.2154}:  97%|█████████▋| 29/30 [01:09<00:02,  2.76s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0207, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 3.2154}: 100%|██████████| 30/30 [01:09<00:00,  2.86s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0207, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 3.2154}: 100%|██████████| 30/30 [01:09<00:00,  2.32s/it]
Epoch: 38
Avg # of users: 5.866666666666666
Avg Loss: 0.02066827545405118
Avg hit ratio: 0.870948430869955
Avg ndcg: 0.895675844648921
Avg compression ratio: 0.9999999860153537
Avg train time: 3.215406401952108
Std train time: 2.0217014518563623
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 3.0813}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 3.0813}:   3%|▎         | 1/30 [00:01<00:45,  1.58s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9307, 'compress@10': 1.0, 'time@10': 2.8323}:   3%|▎         | 1/30 [00:04<00:45,  1.58s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9307, 'compress@10': 1.0, 'time@10': 2.8323}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 2.2216}:   7%|▋         | 2/30 [00:04<01:01,  2.19s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 2.2216}:  10%|█         | 3/30 [00:04<00:38,  1.44s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9009, 'compress@10': 1.0, 'time@10': 2.2308}:  10%|█         | 3/30 [00:07<00:38,  1.44s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9009, 'compress@10': 1.0, 'time@10': 2.2308}:  13%|█▎        | 4/30 [00:07<00:46,  1.77s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9101, 'compress@10': 1.0, 'time@10': 3.413}:  13%|█▎        | 4/30 [00:11<00:46,  1.77s/it] {'epoch': 39, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9101, 'compress@10': 1.0, 'time@10': 3.413}:  17%|█▋        | 5/30 [00:11<01:05,  2.62s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 3.4747}:  17%|█▋        | 5/30 [00:14<01:05,  2.62s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 3.4747}:  20%|██        | 6/30 [00:14<01:12,  3.03s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0155, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9156, 'compress@10': 1.0, 'time@10': 3.561}:  20%|██        | 6/30 [00:17<01:12,  3.03s/it] {'epoch': 39, 'num_users': 6.2857, 'loss': 0.0155, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9156, 'compress@10': 1.0, 'time@10': 3.561}:  23%|██▎       | 7/30 [00:17<01:02,  2.72s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 3.4757}:  23%|██▎       | 7/30 [00:19<01:02,  2.72s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 3.4757}:  27%|██▋       | 8/30 [00:19<01:01,  2.78s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9266, 'compress@10': 1.0, 'time@10': 3.7386}:  27%|██▋       | 8/30 [00:22<01:01,  2.78s/it] {'epoch': 39, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9266, 'compress@10': 1.0, 'time@10': 3.7386}:  30%|███       | 9/30 [00:22<00:59,  2.84s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9314, 'compress@10': 1.0, 'time@10': 3.7252}:  30%|███       | 9/30 [00:26<00:59,  2.84s/it] {'epoch': 39, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9314, 'compress@10': 1.0, 'time@10': 3.7252}:  33%|███▎      | 10/30 [00:26<01:01,  3.08s/it]{'epoch': 39, 'num_users': 6.6364, 'loss': 0.0174, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9304, 'compress@10': 1.0, 'time@10': 3.8019}:  33%|███▎      | 10/30 [00:28<01:01,  3.08s/it]{'epoch': 39, 'num_users': 6.6364, 'loss': 0.0174, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9304, 'compress@10': 1.0, 'time@10': 3.8019}:  37%|███▋      | 11/30 [00:28<00:54,  2.85s/it]{'epoch': 39, 'num_users': 6.4167, 'loss': 0.0173, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9279, 'compress@10': 1.0, 'time@10': 3.5639}:  37%|███▋      | 11/30 [00:29<00:54,  2.85s/it]{'epoch': 39, 'num_users': 6.4167, 'loss': 0.0173, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9279, 'compress@10': 1.0, 'time@10': 3.5639}:  40%|████      | 12/30 [00:29<00:41,  2.28s/it]{'epoch': 39, 'num_users': 6.6154, 'loss': 0.0178, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9263, 'compress@10': 1.0, 'time@10': 3.5835}:  40%|████      | 12/30 [00:31<00:41,  2.28s/it]{'epoch': 39, 'num_users': 6.6154, 'loss': 0.0178, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9263, 'compress@10': 1.0, 'time@10': 3.5835}:  43%|████▎     | 13/30 [00:31<00:37,  2.18s/it]{'epoch': 39, 'num_users': 6.3571, 'loss': 0.0178, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9167, 'compress@10': 1.0, 'time@10': 3.3585}:  43%|████▎     | 13/30 [00:32<00:37,  2.18s/it]{'epoch': 39, 'num_users': 6.3571, 'loss': 0.0178, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9167, 'compress@10': 1.0, 'time@10': 3.3585}:  47%|████▋     | 14/30 [00:32<00:26,  1.66s/it]{'epoch': 39, 'num_users': 6.2667, 'loss': 0.018, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 3.4693}:  47%|████▋     | 14/30 [00:34<00:26,  1.66s/it] {'epoch': 39, 'num_users': 6.2667, 'loss': 0.018, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 3.4693}:  50%|█████     | 15/30 [00:34<00:28,  1.93s/it]{'epoch': 39, 'num_users': 6.0625, 'loss': 0.0175, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9176, 'compress@10': 1.0, 'time@10': 3.3081}:  50%|█████     | 15/30 [00:35<00:28,  1.93s/it]{'epoch': 39, 'num_users': 6.0625, 'loss': 0.0175, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9176, 'compress@10': 1.0, 'time@10': 3.3081}:  53%|█████▎    | 16/30 [00:35<00:22,  1.63s/it]{'epoch': 39, 'num_users': 5.8235, 'loss': 0.0175, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.9083, 'compress@10': 1.0, 'time@10': 3.1521}:  53%|█████▎    | 16/30 [00:36<00:22,  1.63s/it]{'epoch': 39, 'num_users': 5.8235, 'loss': 0.0175, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.9083, 'compress@10': 1.0, 'time@10': 3.1521}:  57%|█████▋    | 17/30 [00:36<00:16,  1.25s/it]{'epoch': 39, 'num_users': 6.0556, 'loss': 0.0173, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 3.1095}:  57%|█████▋    | 17/30 [00:38<00:16,  1.25s/it]{'epoch': 39, 'num_users': 6.0556, 'loss': 0.0173, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 3.1095}:  60%|██████    | 18/30 [00:38<00:19,  1.60s/it]{'epoch': 39, 'num_users': 6.0, 'loss': 0.017, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.9099, 'compress@10': 1.0, 'time@10': 3.0629}:  60%|██████    | 18/30 [00:39<00:19,  1.60s/it]    {'epoch': 39, 'num_users': 6.0, 'loss': 0.017, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.9099, 'compress@10': 1.0, 'time@10': 3.0629}:  63%|██████▎   | 19/30 [00:39<00:16,  1.47s/it]{'epoch': 39, 'num_users': 6.15, 'loss': 0.0172, 'hit_ratio@10': 0.857, 'ndcg@10': 0.9123, 'compress@10': 1.0, 'time@10': 3.1594}:  63%|██████▎   | 19/30 [00:44<00:16,  1.47s/it]{'epoch': 39, 'num_users': 6.15, 'loss': 0.0172, 'hit_ratio@10': 0.857, 'ndcg@10': 0.9123, 'compress@10': 1.0, 'time@10': 3.1594}:  67%|██████▋   | 20/30 [00:44<00:25,  2.54s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.914, 'compress@10': 1.0, 'time@10': 3.3371}:  67%|██████▋   | 20/30 [00:48<00:25,  2.54s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.914, 'compress@10': 1.0, 'time@10': 3.3371}:  70%|███████   | 21/30 [00:48<00:25,  2.82s/it]{'epoch': 39, 'num_users': 6.1818, 'loss': 0.0176, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 3.2636}:  70%|███████   | 21/30 [00:49<00:25,  2.82s/it]{'epoch': 39, 'num_users': 6.1818, 'loss': 0.0176, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 3.2636}:  73%|███████▎  | 22/30 [00:49<00:20,  2.50s/it]{'epoch': 39, 'num_users': 6.1304, 'loss': 0.0174, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9152, 'compress@10': 1.0, 'time@10': 3.2613}:  73%|███████▎  | 22/30 [00:51<00:20,  2.50s/it]{'epoch': 39, 'num_users': 6.1304, 'loss': 0.0174, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9152, 'compress@10': 1.0, 'time@10': 3.2613}:  77%|███████▋  | 23/30 [00:51<00:15,  2.24s/it]{'epoch': 39, 'num_users': 5.9583, 'loss': 0.0181, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9053, 'compress@10': 1.0, 'time@10': 3.1391}:  77%|███████▋  | 23/30 [00:51<00:15,  2.24s/it]{'epoch': 39, 'num_users': 5.9583, 'loss': 0.0181, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9053, 'compress@10': 1.0, 'time@10': 3.1391}:  80%|████████  | 24/30 [00:51<00:10,  1.68s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0186, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 3.0259}:  80%|████████  | 24/30 [00:52<00:10,  1.68s/it]     {'epoch': 39, 'num_users': 5.8, 'loss': 0.0186, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 3.0259}:  83%|████████▎ | 25/30 [00:52<00:06,  1.23s/it]{'epoch': 39, 'num_users': 5.8077, 'loss': 0.0185, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 3.1706}:  83%|████████▎ | 25/30 [00:58<00:06,  1.23s/it]{'epoch': 39, 'num_users': 5.8077, 'loss': 0.0185, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 3.1706}:  87%|████████▋ | 26/30 [00:58<00:11,  2.91s/it]{'epoch': 39, 'num_users': 5.8889, 'loss': 0.0194, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 3.2222}:  87%|████████▋ | 26/30 [01:01<00:11,  2.91s/it]{'epoch': 39, 'num_users': 5.8889, 'loss': 0.0194, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 3.2222}:  90%|█████████ | 27/30 [01:01<00:08,  2.73s/it]{'epoch': 39, 'num_users': 6.0, 'loss': 0.0193, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.896, 'compress@10': 1.0, 'time@10': 3.2609}:  90%|█████████ | 27/30 [01:05<00:08,  2.73s/it]    {'epoch': 39, 'num_users': 6.0, 'loss': 0.0193, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.896, 'compress@10': 1.0, 'time@10': 3.2609}:  93%|█████████▎| 28/30 [01:05<00:06,  3.22s/it]{'epoch': 39, 'num_users': 5.8621, 'loss': 0.0191, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 3.2671}:  93%|█████████▎| 28/30 [01:07<00:06,  3.22s/it]{'epoch': 39, 'num_users': 5.8621, 'loss': 0.0191, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 3.2671}:  97%|█████████▋| 29/30 [01:07<00:02,  2.78s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0191, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8994, 'compress@10': 1.0, 'time@10': 3.2589}:  97%|█████████▋| 29/30 [01:10<00:02,  2.78s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0191, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8994, 'compress@10': 1.0, 'time@10': 3.2589}: 100%|██████████| 30/30 [01:10<00:00,  2.86s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0191, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8994, 'compress@10': 1.0, 'time@10': 3.2589}: 100%|██████████| 30/30 [01:10<00:00,  2.35s/it]
Epoch: 39
Avg # of users: 5.866666666666666
Avg Loss: 0.019126807487198774
Avg hit ratio: 0.8733558382773624
Avg ndcg: 0.8993670150578642
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2588515122731527
Std train time: 2.0181924203881745
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.8104}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.8104}:   3%|▎         | 1/30 [00:01<00:41,  1.44s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9288, 'compress@10': 1.0, 'time@10': 2.6528}:   3%|▎         | 1/30 [00:03<00:41,  1.44s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9288, 'compress@10': 1.0, 'time@10': 2.6528}:   7%|▋         | 2/30 [00:03<00:58,  2.08s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 2.1203}:   7%|▋         | 2/30 [00:04<00:58,  2.08s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 2.1203}:  10%|█         | 3/30 [00:04<00:37,  1.39s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9105, 'compress@10': 1.0, 'time@10': 2.1547}:  10%|█         | 3/30 [00:06<00:37,  1.39s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9105, 'compress@10': 1.0, 'time@10': 2.1547}:  13%|█▎        | 4/30 [00:06<00:45,  1.75s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0142, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9182, 'compress@10': 1.0, 'time@10': 3.4216}:  13%|█▎        | 4/30 [00:11<00:45,  1.75s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0142, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9182, 'compress@10': 1.0, 'time@10': 3.4216}:  17%|█▋        | 5/30 [00:11<01:06,  2.66s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9254, 'compress@10': 1.0, 'time@10': 3.4839}:  17%|█▋        | 5/30 [00:14<01:06,  2.66s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9254, 'compress@10': 1.0, 'time@10': 3.4839}:  20%|██        | 6/30 [00:14<01:13,  3.06s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9255, 'compress@10': 1.0, 'time@10': 3.5891}:  20%|██        | 6/30 [00:17<01:13,  3.06s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9255, 'compress@10': 1.0, 'time@10': 3.5891}:  23%|██▎       | 7/30 [00:17<01:03,  2.77s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0166, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.9308, 'compress@10': 1.0, 'time@10': 3.503}:  23%|██▎       | 7/30 [00:20<01:03,  2.77s/it]  {'epoch': 40, 'num_users': 6.125, 'loss': 0.0166, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.9308, 'compress@10': 1.0, 'time@10': 3.503}:  27%|██▋       | 8/30 [00:20<01:02,  2.82s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0184, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9323, 'compress@10': 1.0, 'time@10': 3.7426}:  27%|██▋       | 8/30 [00:22<01:02,  2.82s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0184, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9323, 'compress@10': 1.0, 'time@10': 3.7426}:  30%|███       | 9/30 [00:22<00:59,  2.84s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9343, 'compress@10': 1.0, 'time@10': 3.7191}:  30%|███       | 9/30 [00:26<00:59,  2.84s/it]  {'epoch': 40, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9343, 'compress@10': 1.0, 'time@10': 3.7191}:  33%|███▎      | 10/30 [00:26<01:01,  3.06s/it]{'epoch': 40, 'num_users': 6.6364, 'loss': 0.0193, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9327, 'compress@10': 1.0, 'time@10': 3.789}:  33%|███▎      | 10/30 [00:28<01:01,  3.06s/it]{'epoch': 40, 'num_users': 6.6364, 'loss': 0.0193, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9327, 'compress@10': 1.0, 'time@10': 3.789}:  37%|███▋      | 11/30 [00:28<00:53,  2.82s/it]{'epoch': 40, 'num_users': 6.4167, 'loss': 0.0191, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.93, 'compress@10': 1.0, 'time@10': 3.5494}:  37%|███▋      | 11/30 [00:29<00:53,  2.82s/it] {'epoch': 40, 'num_users': 6.4167, 'loss': 0.0191, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.93, 'compress@10': 1.0, 'time@10': 3.5494}:  40%|████      | 12/30 [00:29<00:40,  2.25s/it]{'epoch': 40, 'num_users': 6.6154, 'loss': 0.0194, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 3.5586}:  40%|████      | 12/30 [00:31<00:40,  2.25s/it]{'epoch': 40, 'num_users': 6.6154, 'loss': 0.0194, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 3.5586}:  43%|████▎     | 13/30 [00:31<00:36,  2.14s/it]{'epoch': 40, 'num_users': 6.3571, 'loss': 0.0193, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9185, 'compress@10': 1.0, 'time@10': 3.334}:  43%|████▎     | 13/30 [00:32<00:36,  2.14s/it] {'epoch': 40, 'num_users': 6.3571, 'loss': 0.0193, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9185, 'compress@10': 1.0, 'time@10': 3.334}:  47%|████▋     | 14/30 [00:32<00:26,  1.63s/it]{'epoch': 40, 'num_users': 6.2667, 'loss': 0.0203, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9253, 'compress@10': 1.0, 'time@10': 3.4506}:  47%|████▋     | 14/30 [00:34<00:26,  1.63s/it]{'epoch': 40, 'num_users': 6.2667, 'loss': 0.0203, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9253, 'compress@10': 1.0, 'time@10': 3.4506}:  50%|█████     | 15/30 [00:34<00:28,  1.91s/it]{'epoch': 40, 'num_users': 6.0625, 'loss': 0.0196, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9231, 'compress@10': 1.0, 'time@10': 3.2925}:  50%|█████     | 15/30 [00:35<00:28,  1.91s/it]{'epoch': 40, 'num_users': 6.0625, 'loss': 0.0196, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9231, 'compress@10': 1.0, 'time@10': 3.2925}:  53%|█████▎    | 16/30 [00:35<00:22,  1.63s/it]{'epoch': 40, 'num_users': 5.8235, 'loss': 0.0194, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.9135, 'compress@10': 1.0, 'time@10': 3.1364}:  53%|█████▎    | 16/30 [00:36<00:22,  1.63s/it]{'epoch': 40, 'num_users': 5.8235, 'loss': 0.0194, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.9135, 'compress@10': 1.0, 'time@10': 3.1364}:  57%|█████▋    | 17/30 [00:36<00:17,  1.34s/it]{'epoch': 40, 'num_users': 6.0556, 'loss': 0.0192, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9145, 'compress@10': 1.0, 'time@10': 3.0955}:  57%|█████▋    | 17/30 [00:38<00:17,  1.34s/it]{'epoch': 40, 'num_users': 6.0556, 'loss': 0.0192, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9145, 'compress@10': 1.0, 'time@10': 3.0955}:  60%|██████    | 18/30 [00:38<00:20,  1.67s/it]{'epoch': 40, 'num_users': 6.0, 'loss': 0.0188, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.9146, 'compress@10': 1.0, 'time@10': 3.0503}:  60%|██████    | 18/30 [00:39<00:20,  1.67s/it]   {'epoch': 40, 'num_users': 6.0, 'loss': 0.0188, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.9146, 'compress@10': 1.0, 'time@10': 3.0503}:  63%|██████▎   | 19/30 [00:39<00:16,  1.54s/it]{'epoch': 40, 'num_users': 6.15, 'loss': 0.0188, 'hit_ratio@10': 0.857, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.1452}:  63%|██████▎   | 19/30 [00:44<00:16,  1.54s/it]{'epoch': 40, 'num_users': 6.15, 'loss': 0.0188, 'hit_ratio@10': 0.857, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.1452}:  67%|██████▋   | 20/30 [00:44<00:25,  2.58s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 3.3247}:  67%|██████▋   | 20/30 [00:48<00:25,  2.58s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 3.3247}:  70%|███████   | 21/30 [00:48<00:25,  2.85s/it]{'epoch': 40, 'num_users': 6.1818, 'loss': 0.0191, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.919, 'compress@10': 1.0, 'time@10': 3.2533}:  70%|███████   | 21/30 [00:50<00:25,  2.85s/it] {'epoch': 40, 'num_users': 6.1818, 'loss': 0.0191, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.919, 'compress@10': 1.0, 'time@10': 3.2533}:  73%|███████▎  | 22/30 [00:50<00:20,  2.53s/it]{'epoch': 40, 'num_users': 6.1304, 'loss': 0.0188, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9197, 'compress@10': 1.0, 'time@10': 3.2537}:  73%|███████▎  | 22/30 [00:51<00:20,  2.53s/it]{'epoch': 40, 'num_users': 6.1304, 'loss': 0.0188, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9197, 'compress@10': 1.0, 'time@10': 3.2537}:  77%|███████▋  | 23/30 [00:51<00:15,  2.27s/it]{'epoch': 40, 'num_users': 5.9583, 'loss': 0.0194, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 3.1311}:  77%|███████▋  | 23/30 [00:52<00:15,  2.27s/it]{'epoch': 40, 'num_users': 5.9583, 'loss': 0.0194, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 3.1311}:  80%|████████  | 24/30 [00:52<00:10,  1.70s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8941, 'compress@10': 1.0, 'time@10': 3.0191}:  80%|████████  | 24/30 [00:52<00:10,  1.70s/it]   {'epoch': 40, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8941, 'compress@10': 1.0, 'time@10': 3.0191}:  83%|████████▎ | 25/30 [00:52<00:06,  1.25s/it]{'epoch': 40, 'num_users': 5.8077, 'loss': 0.02, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.898, 'compress@10': 1.0, 'time@10': 3.1696}:  83%|████████▎ | 25/30 [00:59<00:06,  1.25s/it]{'epoch': 40, 'num_users': 5.8077, 'loss': 0.02, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.898, 'compress@10': 1.0, 'time@10': 3.1696}:  87%|████████▋ | 26/30 [00:59<00:11,  2.96s/it]{'epoch': 40, 'num_users': 5.8889, 'loss': 0.0203, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9027, 'compress@10': 1.0, 'time@10': 3.2281}:  87%|████████▋ | 26/30 [01:01<00:11,  2.96s/it]{'epoch': 40, 'num_users': 5.8889, 'loss': 0.0203, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9027, 'compress@10': 1.0, 'time@10': 3.2281}:  90%|█████████ | 27/30 [01:01<00:08,  2.80s/it]{'epoch': 40, 'num_users': 6.0, 'loss': 0.0201, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.9048, 'compress@10': 1.0, 'time@10': 3.2699}:  90%|█████████ | 27/30 [01:06<00:08,  2.80s/it]  {'epoch': 40, 'num_users': 6.0, 'loss': 0.0201, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.9048, 'compress@10': 1.0, 'time@10': 3.2699}:  93%|█████████▎| 28/30 [01:06<00:06,  3.29s/it]{'epoch': 40, 'num_users': 5.8621, 'loss': 0.0198, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9061, 'compress@10': 1.0, 'time@10': 3.2732}:  93%|█████████▎| 28/30 [01:07<00:06,  3.29s/it]{'epoch': 40, 'num_users': 5.8621, 'loss': 0.0198, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9061, 'compress@10': 1.0, 'time@10': 3.2732}:  97%|█████████▋| 29/30 [01:07<00:02,  2.82s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0198, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9075, 'compress@10': 1.0, 'time@10': 3.2652}:  97%|█████████▋| 29/30 [01:11<00:02,  2.82s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0198, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9075, 'compress@10': 1.0, 'time@10': 3.2652}: 100%|██████████| 30/30 [01:11<00:00,  2.89s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0198, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9075, 'compress@10': 1.0, 'time@10': 3.2652}: 100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch: 40
Avg # of users: 5.866666666666666
Avg Loss: 0.01980195038837575
Avg hit ratio: 0.8729493342123217
Avg ndcg: 0.9074609279624664
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2651721159617106
Std train time: 2.0550566884273826
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 3.2151}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 3.2151}:   3%|▎         | 1/30 [00:01<00:48,  1.69s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9312, 'compress@10': 1.0, 'time@10': 2.9246}:   3%|▎         | 1/30 [00:04<00:48,  1.69s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9312, 'compress@10': 1.0, 'time@10': 2.9246}:   7%|▋         | 2/30 [00:04<01:03,  2.27s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8953, 'compress@10': 1.0, 'time@10': 2.2813}:   7%|▋         | 2/30 [00:04<01:03,  2.27s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8953, 'compress@10': 1.0, 'time@10': 2.2813}:  10%|█         | 3/30 [00:04<00:39,  1.48s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9015, 'compress@10': 1.0, 'time@10': 2.3042}:  10%|█         | 3/30 [00:07<00:39,  1.48s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9015, 'compress@10': 1.0, 'time@10': 2.3042}:  13%|█▎        | 4/30 [00:07<00:47,  1.85s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0153, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9117, 'compress@10': 1.0, 'time@10': 3.6064}:  13%|█▎        | 4/30 [00:11<00:47,  1.85s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0153, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9117, 'compress@10': 1.0, 'time@10': 3.6064}:  17%|█▋        | 5/30 [00:11<01:09,  2.79s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9197, 'compress@10': 1.0, 'time@10': 3.6519}:  17%|█▋        | 5/30 [00:15<01:09,  2.79s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9197, 'compress@10': 1.0, 'time@10': 3.6519}:  20%|██        | 6/30 [00:15<01:16,  3.17s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9176, 'compress@10': 1.0, 'time@10': 3.7182}:  20%|██        | 6/30 [00:17<01:16,  3.17s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9176, 'compress@10': 1.0, 'time@10': 3.7182}:  23%|██▎       | 7/30 [00:17<01:04,  2.82s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0157, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9242, 'compress@10': 1.0, 'time@10': 3.616}:  23%|██▎       | 7/30 [00:20<01:04,  2.82s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.0157, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9242, 'compress@10': 1.0, 'time@10': 3.616}:  27%|██▋       | 8/30 [00:20<01:02,  2.86s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9262, 'compress@10': 1.0, 'time@10': 3.8837}:  27%|██▋       | 8/30 [00:23<01:02,  2.86s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9262, 'compress@10': 1.0, 'time@10': 3.8837}:  30%|███       | 9/30 [00:23<01:01,  2.92s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9302, 'compress@10': 1.0, 'time@10': 3.8423}:  30%|███       | 9/30 [00:27<01:01,  2.92s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9302, 'compress@10': 1.0, 'time@10': 3.8423}:  33%|███▎      | 10/30 [00:27<01:02,  3.10s/it]{'epoch': 41, 'num_users': 6.6364, 'loss': 0.0178, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 3.8576}:  33%|███▎      | 10/30 [00:29<01:02,  3.10s/it]{'epoch': 41, 'num_users': 6.6364, 'loss': 0.0178, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 3.8576}:  37%|███▋      | 11/30 [00:29<00:52,  2.78s/it]{'epoch': 41, 'num_users': 6.4167, 'loss': 0.0178, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9261, 'compress@10': 1.0, 'time@10': 3.597}:  37%|███▋      | 11/30 [00:30<00:52,  2.78s/it] {'epoch': 41, 'num_users': 6.4167, 'loss': 0.0178, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9261, 'compress@10': 1.0, 'time@10': 3.597}:  40%|████      | 12/30 [00:30<00:38,  2.16s/it]{'epoch': 41, 'num_users': 6.6154, 'loss': 0.0181, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9251, 'compress@10': 1.0, 'time@10': 3.5823}:  40%|████      | 12/30 [00:31<00:38,  2.16s/it]{'epoch': 41, 'num_users': 6.6154, 'loss': 0.0181, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9251, 'compress@10': 1.0, 'time@10': 3.5823}:  43%|████▎     | 13/30 [00:31<00:34,  2.04s/it]{'epoch': 41, 'num_users': 6.3571, 'loss': 0.0181, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9155, 'compress@10': 1.0, 'time@10': 3.3544}:  43%|████▎     | 13/30 [00:32<00:34,  2.04s/it] {'epoch': 41, 'num_users': 6.3571, 'loss': 0.0181, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9155, 'compress@10': 1.0, 'time@10': 3.3544}:  47%|████▋     | 14/30 [00:32<00:24,  1.55s/it]{'epoch': 41, 'num_users': 6.2667, 'loss': 0.019, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 3.4618}:  47%|████▋     | 14/30 [00:34<00:24,  1.55s/it]{'epoch': 41, 'num_users': 6.2667, 'loss': 0.019, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 3.4618}:  50%|█████     | 15/30 [00:34<00:27,  1.84s/it]{'epoch': 41, 'num_users': 6.0625, 'loss': 0.0183, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 3.3041}:  50%|█████     | 15/30 [00:35<00:27,  1.84s/it]{'epoch': 41, 'num_users': 6.0625, 'loss': 0.0183, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 3.3041}:  53%|█████▎    | 16/30 [00:35<00:22,  1.58s/it]{'epoch': 41, 'num_users': 5.8235, 'loss': 0.0182, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.9094, 'compress@10': 1.0, 'time@10': 3.1473}:  53%|█████▎    | 16/30 [00:36<00:22,  1.58s/it]{'epoch': 41, 'num_users': 5.8235, 'loss': 0.0182, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.9094, 'compress@10': 1.0, 'time@10': 3.1473}:  57%|█████▋    | 17/30 [00:36<00:15,  1.21s/it]{'epoch': 41, 'num_users': 6.0556, 'loss': 0.018, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.9109, 'compress@10': 1.0, 'time@10': 3.1057}:  57%|█████▋    | 17/30 [00:38<00:15,  1.21s/it] {'epoch': 41, 'num_users': 6.0556, 'loss': 0.018, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.9109, 'compress@10': 1.0, 'time@10': 3.1057}:  60%|██████    | 18/30 [00:38<00:18,  1.58s/it]{'epoch': 41, 'num_users': 6.0, 'loss': 0.0176, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.9111, 'compress@10': 1.0, 'time@10': 3.0611}:  60%|██████    | 18/30 [00:39<00:18,  1.58s/it]  {'epoch': 41, 'num_users': 6.0, 'loss': 0.0176, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.9111, 'compress@10': 1.0, 'time@10': 3.0611}:  63%|██████▎   | 19/30 [00:39<00:16,  1.46s/it]{'epoch': 41, 'num_users': 6.15, 'loss': 0.0178, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 3.1485}:  63%|██████▎   | 19/30 [00:44<00:16,  1.46s/it]{'epoch': 41, 'num_users': 6.15, 'loss': 0.0178, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 3.1485}:  67%|██████▋   | 20/30 [00:44<00:24,  2.47s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.916, 'compress@10': 1.0, 'time@10': 3.3283}:  67%|██████▋   | 20/30 [00:48<00:24,  2.47s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.916, 'compress@10': 1.0, 'time@10': 3.3283}:  70%|███████   | 21/30 [00:48<00:25,  2.79s/it]{'epoch': 41, 'num_users': 6.1818, 'loss': 0.0181, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9165, 'compress@10': 1.0, 'time@10': 3.2549}:  70%|███████   | 21/30 [00:49<00:25,  2.79s/it]{'epoch': 41, 'num_users': 6.1818, 'loss': 0.0181, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9165, 'compress@10': 1.0, 'time@10': 3.2549}:  73%|███████▎  | 22/30 [00:49<00:19,  2.48s/it]{'epoch': 41, 'num_users': 6.1304, 'loss': 0.0178, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.2533}:  73%|███████▎  | 22/30 [00:51<00:19,  2.48s/it]{'epoch': 41, 'num_users': 6.1304, 'loss': 0.0178, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.2533}:  77%|███████▋  | 23/30 [00:51<00:15,  2.23s/it]{'epoch': 41, 'num_users': 5.9583, 'loss': 0.0185, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9068, 'compress@10': 1.0, 'time@10': 3.1306}:  77%|███████▋  | 23/30 [00:51<00:15,  2.23s/it]{'epoch': 41, 'num_users': 5.9583, 'loss': 0.0185, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9068, 'compress@10': 1.0, 'time@10': 3.1306}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8914, 'compress@10': 1.0, 'time@10': 3.0163}:  80%|████████  | 24/30 [00:51<00:09,  1.66s/it]    {'epoch': 41, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8914, 'compress@10': 1.0, 'time@10': 3.0163}:  83%|████████▎ | 25/30 [00:51<00:06,  1.22s/it]{'epoch': 41, 'num_users': 5.8077, 'loss': 0.0188, 'hit_ratio@10': 0.864, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 3.1656}:  83%|████████▎ | 25/30 [00:58<00:06,  1.22s/it]{'epoch': 41, 'num_users': 5.8077, 'loss': 0.0188, 'hit_ratio@10': 0.864, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 3.1656}:  87%|████████▋ | 26/30 [00:58<00:11,  2.93s/it]{'epoch': 41, 'num_users': 5.8889, 'loss': 0.0183, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.2279}:  87%|████████▋ | 26/30 [01:01<00:11,  2.93s/it]{'epoch': 41, 'num_users': 5.8889, 'loss': 0.0183, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.2279}:  90%|█████████ | 27/30 [01:01<00:08,  2.79s/it]{'epoch': 41, 'num_users': 6.0, 'loss': 0.0183, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 3.2698}:  90%|█████████ | 27/30 [01:05<00:08,  2.79s/it]      {'epoch': 41, 'num_users': 6.0, 'loss': 0.0183, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 3.2698}:  93%|█████████▎| 28/30 [01:05<00:06,  3.29s/it]{'epoch': 41, 'num_users': 5.8621, 'loss': 0.0181, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.2781}:  93%|█████████▎| 28/30 [01:07<00:06,  3.29s/it]{'epoch': 41, 'num_users': 5.8621, 'loss': 0.0181, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.2781}:  97%|█████████▋| 29/30 [01:07<00:02,  2.84s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0181, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9034, 'compress@10': 1.0, 'time@10': 3.2702}:  97%|█████████▋| 29/30 [01:10<00:02,  2.84s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0181, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9034, 'compress@10': 1.0, 'time@10': 3.2702}: 100%|██████████| 30/30 [01:10<00:00,  2.91s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0181, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9034, 'compress@10': 1.0, 'time@10': 3.2702}: 100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch: 41
Avg # of users: 5.866666666666666
Avg Loss: 0.018135442503276065
Avg hit ratio: 0.8763549349349956
Avg ndcg: 0.9034346838739545
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2702351093292235
Std train time: 2.091515799402259
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 3.2303}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 3.2303}:   3%|▎         | 1/30 [00:01<00:47,  1.65s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9361, 'compress@10': 1.0, 'time@10': 2.9494}:   3%|▎         | 1/30 [00:04<00:47,  1.65s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9361, 'compress@10': 1.0, 'time@10': 2.9494}:   7%|▋         | 2/30 [00:04<01:03,  2.27s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.2996}:   7%|▋         | 2/30 [00:04<01:03,  2.27s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.2996}:  10%|█         | 3/30 [00:04<00:40,  1.49s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8962, 'compress@10': 1.0, 'time@10': 2.3047}:  10%|█         | 3/30 [00:07<00:40,  1.49s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8962, 'compress@10': 1.0, 'time@10': 2.3047}:  13%|█▎        | 4/30 [00:07<00:47,  1.83s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9072, 'compress@10': 1.0, 'time@10': 3.6439}:  13%|█▎        | 4/30 [00:11<00:47,  1.83s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9072, 'compress@10': 1.0, 'time@10': 3.6439}:  17%|█▋        | 5/30 [00:11<01:10,  2.81s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9157, 'compress@10': 1.0, 'time@10': 3.6807}:  17%|█▋        | 5/30 [00:15<01:10,  2.81s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9157, 'compress@10': 1.0, 'time@10': 3.6807}:  20%|██        | 6/30 [00:15<01:16,  3.18s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 3.7464}:  20%|██        | 6/30 [00:17<01:16,  3.18s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 3.7464}:  23%|██▎       | 7/30 [00:17<01:05,  2.83s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.9246, 'compress@10': 1.0, 'time@10': 3.6366}:  23%|██▎       | 7/30 [00:20<01:05,  2.83s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.9246, 'compress@10': 1.0, 'time@10': 3.6366}:  27%|██▋       | 8/30 [00:20<01:02,  2.85s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9225, 'compress@10': 1.0, 'time@10': 3.8897}:  27%|██▋       | 8/30 [00:23<01:02,  2.85s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9225, 'compress@10': 1.0, 'time@10': 3.8897}:  30%|███       | 9/30 [00:23<01:00,  2.90s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.928, 'compress@10': 1.0, 'time@10': 3.8653}:  30%|███       | 9/30 [00:27<01:00,  2.90s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.928, 'compress@10': 1.0, 'time@10': 3.8653}:  33%|███▎      | 10/30 [00:27<01:02,  3.14s/it]{'epoch': 42, 'num_users': 6.6364, 'loss': 0.0173, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9278, 'compress@10': 1.0, 'time@10': 3.9253}:  33%|███▎      | 10/30 [00:29<01:02,  3.14s/it]{'epoch': 42, 'num_users': 6.6364, 'loss': 0.0173, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9278, 'compress@10': 1.0, 'time@10': 3.9253}:  37%|███▋      | 11/30 [00:29<00:54,  2.89s/it]{'epoch': 42, 'num_users': 6.4167, 'loss': 0.0173, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 3.6759}:  37%|███▋      | 11/30 [00:30<00:54,  2.89s/it] {'epoch': 42, 'num_users': 6.4167, 'loss': 0.0173, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 3.6759}:  40%|████      | 12/30 [00:30<00:41,  2.30s/it]{'epoch': 42, 'num_users': 6.6154, 'loss': 0.0176, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9241, 'compress@10': 1.0, 'time@10': 3.6798}:  40%|████      | 12/30 [00:32<00:41,  2.30s/it]{'epoch': 42, 'num_users': 6.6154, 'loss': 0.0176, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9241, 'compress@10': 1.0, 'time@10': 3.6798}:  43%|████▎     | 13/30 [00:32<00:37,  2.19s/it]{'epoch': 42, 'num_users': 6.3571, 'loss': 0.0177, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.9146, 'compress@10': 1.0, 'time@10': 3.4486}:  43%|████▎     | 13/30 [00:33<00:37,  2.19s/it]{'epoch': 42, 'num_users': 6.3571, 'loss': 0.0177, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.9146, 'compress@10': 1.0, 'time@10': 3.4486}:  47%|████▋     | 14/30 [00:33<00:26,  1.67s/it]{'epoch': 42, 'num_users': 6.2667, 'loss': 0.0178, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9169, 'compress@10': 1.0, 'time@10': 3.5632}:  47%|████▋     | 14/30 [00:35<00:26,  1.67s/it]{'epoch': 42, 'num_users': 6.2667, 'loss': 0.0178, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9169, 'compress@10': 1.0, 'time@10': 3.5632}:  50%|█████     | 15/30 [00:35<00:29,  1.96s/it]{'epoch': 42, 'num_users': 6.0625, 'loss': 0.0172, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9152, 'compress@10': 1.0, 'time@10': 3.3989}:  50%|█████     | 15/30 [00:36<00:29,  1.96s/it]{'epoch': 42, 'num_users': 6.0625, 'loss': 0.0172, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9152, 'compress@10': 1.0, 'time@10': 3.3989}:  53%|█████▎    | 16/30 [00:36<00:23,  1.66s/it]{'epoch': 42, 'num_users': 5.8235, 'loss': 0.0172, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.9061, 'compress@10': 1.0, 'time@10': 3.2408}:  53%|█████▎    | 16/30 [00:37<00:23,  1.66s/it]{'epoch': 42, 'num_users': 5.8235, 'loss': 0.0172, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.9061, 'compress@10': 1.0, 'time@10': 3.2408}:  57%|█████▋    | 17/30 [00:37<00:16,  1.29s/it]{'epoch': 42, 'num_users': 6.0556, 'loss': 0.017, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.908, 'compress@10': 1.0, 'time@10': 3.1896}:  57%|█████▋    | 17/30 [00:39<00:16,  1.29s/it]  {'epoch': 42, 'num_users': 6.0556, 'loss': 0.017, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.908, 'compress@10': 1.0, 'time@10': 3.1896}:  60%|██████    | 18/30 [00:39<00:19,  1.61s/it]{'epoch': 42, 'num_users': 6.0, 'loss': 0.0166, 'hit_ratio@10': 0.854, 'ndcg@10': 0.9084, 'compress@10': 1.0, 'time@10': 3.1327}:  60%|██████    | 18/30 [00:40<00:19,  1.61s/it]  {'epoch': 42, 'num_users': 6.0, 'loss': 0.0166, 'hit_ratio@10': 0.854, 'ndcg@10': 0.9084, 'compress@10': 1.0, 'time@10': 3.1327}:  63%|██████▎   | 19/30 [00:40<00:15,  1.45s/it]{'epoch': 42, 'num_users': 6.15, 'loss': 0.0169, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 3.2174}:  63%|██████▎   | 19/30 [00:45<00:15,  1.45s/it]{'epoch': 42, 'num_users': 6.15, 'loss': 0.0169, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 3.2174}:  67%|██████▋   | 20/30 [00:45<00:24,  2.48s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9136, 'compress@10': 1.0, 'time@10': 3.391}:  67%|██████▋   | 20/30 [00:48<00:24,  2.48s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9136, 'compress@10': 1.0, 'time@10': 3.391}:  70%|███████   | 21/30 [00:48<00:24,  2.77s/it]{'epoch': 42, 'num_users': 6.1818, 'loss': 0.0173, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9141, 'compress@10': 1.0, 'time@10': 3.3162}:  70%|███████   | 21/30 [00:50<00:24,  2.77s/it]{'epoch': 42, 'num_users': 6.1818, 'loss': 0.0173, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9141, 'compress@10': 1.0, 'time@10': 3.3162}:  73%|███████▎  | 22/30 [00:50<00:19,  2.48s/it]{'epoch': 42, 'num_users': 6.1304, 'loss': 0.017, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9152, 'compress@10': 1.0, 'time@10': 3.3104}:  73%|███████▎  | 22/30 [00:52<00:19,  2.48s/it] {'epoch': 42, 'num_users': 6.1304, 'loss': 0.017, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9152, 'compress@10': 1.0, 'time@10': 3.3104}:  77%|███████▋  | 23/30 [00:52<00:15,  2.22s/it]{'epoch': 42, 'num_users': 5.9583, 'loss': 0.0178, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9048, 'compress@10': 1.0, 'time@10': 3.1869}:  77%|███████▋  | 23/30 [00:52<00:15,  2.22s/it]{'epoch': 42, 'num_users': 5.9583, 'loss': 0.0178, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9048, 'compress@10': 1.0, 'time@10': 3.1869}:  80%|████████  | 24/30 [00:52<00:10,  1.67s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0183, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8894, 'compress@10': 1.0, 'time@10': 3.0727}:  80%|████████  | 24/30 [00:52<00:10,  1.67s/it]   {'epoch': 42, 'num_users': 5.8, 'loss': 0.0183, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8894, 'compress@10': 1.0, 'time@10': 3.0727}:  83%|████████▎ | 25/30 [00:52<00:06,  1.23s/it]{'epoch': 42, 'num_users': 5.8077, 'loss': 0.0182, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 3.2007}:  83%|████████▎ | 25/30 [00:59<00:06,  1.23s/it]{'epoch': 42, 'num_users': 5.8077, 'loss': 0.0182, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 3.2007}:  87%|████████▋ | 26/30 [00:59<00:11,  2.79s/it]{'epoch': 42, 'num_users': 5.8889, 'loss': 0.0178, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 3.2454}:  87%|████████▋ | 26/30 [01:01<00:11,  2.79s/it]{'epoch': 42, 'num_users': 5.8889, 'loss': 0.0178, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 3.2454}:  90%|█████████ | 27/30 [01:01<00:07,  2.63s/it]{'epoch': 42, 'num_users': 6.0, 'loss': 0.0177, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.2885}:  90%|█████████ | 27/30 [01:06<00:07,  2.63s/it]   {'epoch': 42, 'num_users': 6.0, 'loss': 0.0177, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.2885}:  93%|█████████▎| 28/30 [01:06<00:06,  3.19s/it]{'epoch': 42, 'num_users': 5.8621, 'loss': 0.0174, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.2933}:  93%|█████████▎| 28/30 [01:07<00:06,  3.19s/it]{'epoch': 42, 'num_users': 5.8621, 'loss': 0.0174, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.2933}:  97%|█████████▋| 29/30 [01:07<00:02,  2.76s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0175, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.2858}:  97%|█████████▋| 29/30 [01:10<00:02,  2.76s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0175, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.2858}: 100%|██████████| 30/30 [01:10<00:00,  2.86s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0175, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.2858}: 100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch: 42
Avg # of users: 5.866666666666666
Avg Loss: 0.017476715920288193
Avg hit ratio: 0.8764236038451279
Avg ndcg: 0.9016589146958888
Avg compression ratio: 0.9999999860153537
Avg train time: 3.285825165112813
Std train time: 2.0669354343224344
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 3.1692}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 3.1692}:   3%|▎         | 1/30 [00:01<00:47,  1.63s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9373, 'compress@10': 1.0, 'time@10': 2.9115}:   3%|▎         | 1/30 [00:04<00:47,  1.63s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9373, 'compress@10': 1.0, 'time@10': 2.9115}:   7%|▋         | 2/30 [00:04<01:03,  2.26s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8994, 'compress@10': 1.0, 'time@10': 2.2779}:   7%|▋         | 2/30 [00:04<01:03,  2.26s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8994, 'compress@10': 1.0, 'time@10': 2.2779}:  10%|█         | 3/30 [00:04<00:40,  1.48s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9081, 'compress@10': 1.0, 'time@10': 2.2954}:  10%|█         | 3/30 [00:07<00:40,  1.48s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9081, 'compress@10': 1.0, 'time@10': 2.2954}:  13%|█▎        | 4/30 [00:07<00:47,  1.84s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0129, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.917, 'compress@10': 1.0, 'time@10': 3.5405}:  13%|█▎        | 4/30 [00:11<00:47,  1.84s/it] {'epoch': 43, 'num_users': 5.8, 'loss': 0.0129, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.917, 'compress@10': 1.0, 'time@10': 3.5405}:  17%|█▋        | 5/30 [00:11<01:08,  2.73s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9267, 'compress@10': 1.0, 'time@10': 3.5995}:  17%|█▋        | 5/30 [00:15<01:08,  2.73s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9267, 'compress@10': 1.0, 'time@10': 3.5995}:  20%|██        | 6/30 [00:15<01:15,  3.14s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0159, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9279, 'compress@10': 1.0, 'time@10': 3.6841}:  20%|██        | 6/30 [00:17<01:15,  3.14s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0159, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9279, 'compress@10': 1.0, 'time@10': 3.6841}:  23%|██▎       | 7/30 [00:17<01:04,  2.81s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.9339, 'compress@10': 1.0, 'time@10': 3.5847}:  23%|██▎       | 7/30 [00:20<01:04,  2.81s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.9339, 'compress@10': 1.0, 'time@10': 3.5847}:  27%|██▋       | 8/30 [00:20<01:02,  2.85s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9282, 'compress@10': 1.0, 'time@10': 3.8457}:  27%|██▋       | 8/30 [00:23<01:02,  2.85s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9282, 'compress@10': 1.0, 'time@10': 3.8457}:  30%|███       | 9/30 [00:23<01:00,  2.90s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.933, 'compress@10': 1.0, 'time@10': 3.8268}:  30%|███       | 9/30 [00:27<01:00,  2.90s/it]     {'epoch': 43, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.933, 'compress@10': 1.0, 'time@10': 3.8268}:  33%|███▎      | 10/30 [00:27<01:02,  3.14s/it]{'epoch': 43, 'num_users': 6.6364, 'loss': 0.017, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.932, 'compress@10': 1.0, 'time@10': 3.8838}:  33%|███▎      | 10/30 [00:29<01:02,  3.14s/it]{'epoch': 43, 'num_users': 6.6364, 'loss': 0.017, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.932, 'compress@10': 1.0, 'time@10': 3.8838}:  37%|███▋      | 11/30 [00:29<00:54,  2.87s/it]{'epoch': 43, 'num_users': 6.4167, 'loss': 0.017, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9287, 'compress@10': 1.0, 'time@10': 3.6345}:  37%|███▋      | 11/30 [00:30<00:54,  2.87s/it]{'epoch': 43, 'num_users': 6.4167, 'loss': 0.017, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9287, 'compress@10': 1.0, 'time@10': 3.6345}:  40%|████      | 12/30 [00:30<00:41,  2.28s/it]{'epoch': 43, 'num_users': 6.6154, 'loss': 0.0174, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9278, 'compress@10': 1.0, 'time@10': 3.6494}:  40%|████      | 12/30 [00:32<00:41,  2.28s/it]{'epoch': 43, 'num_users': 6.6154, 'loss': 0.0174, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9278, 'compress@10': 1.0, 'time@10': 3.6494}:  43%|████▎     | 13/30 [00:32<00:37,  2.18s/it]{'epoch': 43, 'num_users': 6.3571, 'loss': 0.0174, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 3.4197}:  43%|████▎     | 13/30 [00:32<00:37,  2.18s/it] {'epoch': 43, 'num_users': 6.3571, 'loss': 0.0174, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 3.4197}:  47%|████▋     | 14/30 [00:32<00:26,  1.66s/it]{'epoch': 43, 'num_users': 6.2667, 'loss': 0.017, 'hit_ratio@10': 0.864, 'ndcg@10': 0.92, 'compress@10': 1.0, 'time@10': 3.5359}:  47%|████▋     | 14/30 [00:35<00:26,  1.66s/it]   {'epoch': 43, 'num_users': 6.2667, 'loss': 0.017, 'hit_ratio@10': 0.864, 'ndcg@10': 0.92, 'compress@10': 1.0, 'time@10': 3.5359}:  50%|█████     | 15/30 [00:35<00:29,  1.95s/it]{'epoch': 43, 'num_users': 6.0625, 'loss': 0.0164, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 3.3726}:  50%|█████     | 15/30 [00:36<00:29,  1.95s/it]{'epoch': 43, 'num_users': 6.0625, 'loss': 0.0164, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 3.3726}:  53%|█████▎    | 16/30 [00:36<00:23,  1.65s/it]{'epoch': 43, 'num_users': 5.8235, 'loss': 0.0165, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.9088, 'compress@10': 1.0, 'time@10': 3.214}:  53%|█████▎    | 16/30 [00:36<00:23,  1.65s/it] {'epoch': 43, 'num_users': 5.8235, 'loss': 0.0165, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.9088, 'compress@10': 1.0, 'time@10': 3.214}:  57%|█████▋    | 17/30 [00:36<00:16,  1.27s/it]{'epoch': 43, 'num_users': 6.0556, 'loss': 0.0164, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9101, 'compress@10': 1.0, 'time@10': 3.171}:  57%|█████▋    | 17/30 [00:39<00:16,  1.27s/it]{'epoch': 43, 'num_users': 6.0556, 'loss': 0.0164, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9101, 'compress@10': 1.0, 'time@10': 3.171}:  60%|██████    | 18/30 [00:39<00:19,  1.64s/it]{'epoch': 43, 'num_users': 6.0, 'loss': 0.016, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9105, 'compress@10': 1.0, 'time@10': 3.1207}:  60%|██████    | 18/30 [00:40<00:19,  1.64s/it]   {'epoch': 43, 'num_users': 6.0, 'loss': 0.016, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9105, 'compress@10': 1.0, 'time@10': 3.1207}:  63%|██████▎   | 19/30 [00:40<00:16,  1.49s/it]{'epoch': 43, 'num_users': 6.15, 'loss': 0.0163, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9133, 'compress@10': 1.0, 'time@10': 3.2004}:  63%|██████▎   | 19/30 [00:45<00:16,  1.49s/it]{'epoch': 43, 'num_users': 6.15, 'loss': 0.0163, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9133, 'compress@10': 1.0, 'time@10': 3.2004}:  67%|██████▋   | 20/30 [00:45<00:24,  2.47s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9152, 'compress@10': 1.0, 'time@10': 3.3785}:  67%|██████▋   | 20/30 [00:48<00:24,  2.47s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9152, 'compress@10': 1.0, 'time@10': 3.3785}:  70%|███████   | 21/30 [00:48<00:25,  2.78s/it]{'epoch': 43, 'num_users': 6.1818, 'loss': 0.0166, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9155, 'compress@10': 1.0, 'time@10': 3.3049}:  70%|███████   | 21/30 [00:50<00:25,  2.78s/it]{'epoch': 43, 'num_users': 6.1818, 'loss': 0.0166, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9155, 'compress@10': 1.0, 'time@10': 3.3049}:  73%|███████▎  | 22/30 [00:50<00:19,  2.48s/it]{'epoch': 43, 'num_users': 6.1304, 'loss': 0.0164, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9165, 'compress@10': 1.0, 'time@10': 3.3029}:  73%|███████▎  | 22/30 [00:52<00:19,  2.48s/it]{'epoch': 43, 'num_users': 6.1304, 'loss': 0.0164, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9165, 'compress@10': 1.0, 'time@10': 3.3029}:  77%|███████▋  | 23/30 [00:52<00:15,  2.24s/it]{'epoch': 43, 'num_users': 5.9583, 'loss': 0.0171, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.906, 'compress@10': 1.0, 'time@10': 3.1788}:  77%|███████▋  | 23/30 [00:52<00:15,  2.24s/it] {'epoch': 43, 'num_users': 5.9583, 'loss': 0.0171, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.906, 'compress@10': 1.0, 'time@10': 3.1788}:  80%|████████  | 24/30 [00:52<00:10,  1.68s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 3.0649}:  80%|████████  | 24/30 [00:52<00:10,  1.68s/it]  {'epoch': 43, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 3.0649}:  83%|████████▎ | 25/30 [00:52<00:06,  1.23s/it]{'epoch': 43, 'num_users': 5.8077, 'loss': 0.018, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 3.2145}:  83%|████████▎ | 25/30 [00:59<00:06,  1.23s/it]{'epoch': 43, 'num_users': 5.8077, 'loss': 0.018, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 3.2145}:  87%|████████▋ | 26/30 [00:59<00:11,  2.96s/it]{'epoch': 43, 'num_users': 5.8889, 'loss': 0.018, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 3.2696}:  87%|████████▋ | 26/30 [01:02<00:11,  2.96s/it]{'epoch': 43, 'num_users': 5.8889, 'loss': 0.018, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 3.2696}:  90%|█████████ | 27/30 [01:02<00:08,  2.79s/it]{'epoch': 43, 'num_users': 6.0, 'loss': 0.0178, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 3.3129}:  90%|█████████ | 27/30 [01:06<00:08,  2.79s/it]  {'epoch': 43, 'num_users': 6.0, 'loss': 0.0178, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 3.3129}:  93%|█████████▎| 28/30 [01:06<00:06,  3.31s/it]{'epoch': 43, 'num_users': 5.8621, 'loss': 0.0175, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9002, 'compress@10': 1.0, 'time@10': 3.32}:  93%|█████████▎| 28/30 [01:08<00:06,  3.31s/it]{'epoch': 43, 'num_users': 5.8621, 'loss': 0.0175, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9002, 'compress@10': 1.0, 'time@10': 3.32}:  97%|█████████▋| 29/30 [01:08<00:02,  2.86s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0178, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9022, 'compress@10': 1.0, 'time@10': 3.3124}:  97%|█████████▋| 29/30 [01:11<00:02,  2.86s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0178, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9022, 'compress@10': 1.0, 'time@10': 3.3124}: 100%|██████████| 30/30 [01:11<00:00,  2.94s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0178, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9022, 'compress@10': 1.0, 'time@10': 3.3124}: 100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch: 43
Avg # of users: 5.866666666666666
Avg Loss: 0.017844954046623267
Avg hit ratio: 0.8764220403679546
Avg ndcg: 0.9022044466273296
Avg compression ratio: 0.9999999860153537
Avg train time: 3.3123891512552897
Std train time: 2.064583427376946
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9151, 'compress@10': 1.0, 'time@10': 3.2344}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9151, 'compress@10': 1.0, 'time@10': 3.2344}:   3%|▎         | 1/30 [00:01<00:47,  1.65s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9407, 'compress@10': 1.0, 'time@10': 2.932}:   3%|▎         | 1/30 [00:04<00:47,  1.65s/it]  {'epoch': 44, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9407, 'compress@10': 1.0, 'time@10': 2.932}:   7%|▋         | 2/30 [00:04<01:02,  2.25s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 2.2949}:   7%|▋         | 2/30 [00:04<01:02,  2.25s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 2.2949}:  10%|█         | 3/30 [00:04<00:39,  1.47s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9155, 'compress@10': 1.0, 'time@10': 2.2764}:  10%|█         | 3/30 [00:07<00:39,  1.47s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9155, 'compress@10': 1.0, 'time@10': 2.2764}:  13%|█▎        | 4/30 [00:07<00:46,  1.78s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 3.4009}:  13%|█▎        | 4/30 [00:11<00:46,  1.78s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 3.4009}:  17%|█▋        | 5/30 [00:11<01:04,  2.58s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9285, 'compress@10': 1.0, 'time@10': 3.4307}:  17%|█▋        | 5/30 [00:14<01:04,  2.58s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9285, 'compress@10': 1.0, 'time@10': 3.4307}:  20%|██        | 6/30 [00:14<01:10,  2.93s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 3.5329}:  20%|██        | 6/30 [00:16<01:10,  2.93s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 3.5329}:  23%|██▎       | 7/30 [00:16<01:01,  2.66s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9311, 'compress@10': 1.0, 'time@10': 3.4459}:  23%|██▎       | 7/30 [00:19<01:01,  2.66s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9311, 'compress@10': 1.0, 'time@10': 3.4459}:  27%|██▋       | 8/30 [00:19<01:00,  2.73s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9339, 'compress@10': 1.0, 'time@10': 3.7114}:  27%|██▋       | 8/30 [00:22<01:00,  2.73s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9339, 'compress@10': 1.0, 'time@10': 3.7114}:  30%|███       | 9/30 [00:22<00:58,  2.80s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9383, 'compress@10': 1.0, 'time@10': 3.6979}:  30%|███       | 9/30 [00:26<00:58,  2.80s/it]  {'epoch': 44, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9383, 'compress@10': 1.0, 'time@10': 3.6979}:  33%|███▎      | 10/30 [00:26<01:01,  3.05s/it]{'epoch': 44, 'num_users': 6.6364, 'loss': 0.0163, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9368, 'compress@10': 1.0, 'time@10': 3.781}:  33%|███▎      | 10/30 [00:28<01:01,  3.05s/it]{'epoch': 44, 'num_users': 6.6364, 'loss': 0.0163, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9368, 'compress@10': 1.0, 'time@10': 3.781}:  37%|███▋      | 11/30 [00:28<00:53,  2.84s/it]{'epoch': 44, 'num_users': 6.4167, 'loss': 0.0165, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9332, 'compress@10': 1.0, 'time@10': 3.5414}:  37%|███▋      | 11/30 [00:29<00:53,  2.84s/it]{'epoch': 44, 'num_users': 6.4167, 'loss': 0.0165, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9332, 'compress@10': 1.0, 'time@10': 3.5414}:  40%|████      | 12/30 [00:29<00:40,  2.26s/it]{'epoch': 44, 'num_users': 6.6154, 'loss': 0.0168, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9319, 'compress@10': 1.0, 'time@10': 3.5415}:  40%|████      | 12/30 [00:31<00:40,  2.26s/it]{'epoch': 44, 'num_users': 6.6154, 'loss': 0.0168, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9319, 'compress@10': 1.0, 'time@10': 3.5415}:  43%|████▎     | 13/30 [00:31<00:36,  2.12s/it]{'epoch': 44, 'num_users': 6.3571, 'loss': 0.0169, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.9219, 'compress@10': 1.0, 'time@10': 3.3168}:  43%|████▎     | 13/30 [00:31<00:36,  2.12s/it]{'epoch': 44, 'num_users': 6.3571, 'loss': 0.0169, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.9219, 'compress@10': 1.0, 'time@10': 3.3168}:  47%|████▋     | 14/30 [00:31<00:25,  1.61s/it]{'epoch': 44, 'num_users': 6.2667, 'loss': 0.0178, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9244, 'compress@10': 1.0, 'time@10': 3.4361}:  47%|████▋     | 14/30 [00:34<00:25,  1.61s/it]{'epoch': 44, 'num_users': 6.2667, 'loss': 0.0178, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9244, 'compress@10': 1.0, 'time@10': 3.4361}:  50%|█████     | 15/30 [00:34<00:28,  1.91s/it]{'epoch': 44, 'num_users': 6.0625, 'loss': 0.0172, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 3.2797}:  50%|█████     | 15/30 [00:35<00:28,  1.91s/it]{'epoch': 44, 'num_users': 6.0625, 'loss': 0.0172, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 3.2797}:  53%|█████▎    | 16/30 [00:35<00:22,  1.63s/it]{'epoch': 44, 'num_users': 5.8235, 'loss': 0.0172, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.9127, 'compress@10': 1.0, 'time@10': 3.1283}:  53%|█████▎    | 16/30 [00:35<00:22,  1.63s/it]{'epoch': 44, 'num_users': 5.8235, 'loss': 0.0172, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.9127, 'compress@10': 1.0, 'time@10': 3.1283}:  57%|█████▋    | 17/30 [00:35<00:16,  1.26s/it]{'epoch': 44, 'num_users': 6.0556, 'loss': 0.0171, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9141, 'compress@10': 1.0, 'time@10': 3.0939}:  57%|█████▋    | 17/30 [00:38<00:16,  1.26s/it]{'epoch': 44, 'num_users': 6.0556, 'loss': 0.0171, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9141, 'compress@10': 1.0, 'time@10': 3.0939}:  60%|██████    | 18/30 [00:38<00:19,  1.65s/it]{'epoch': 44, 'num_users': 6.0, 'loss': 0.0167, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.9142, 'compress@10': 1.0, 'time@10': 3.0469}:  60%|██████    | 18/30 [00:39<00:19,  1.65s/it]   {'epoch': 44, 'num_users': 6.0, 'loss': 0.0167, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.9142, 'compress@10': 1.0, 'time@10': 3.0469}:  63%|██████▎   | 19/30 [00:39<00:16,  1.50s/it]{'epoch': 44, 'num_users': 6.15, 'loss': 0.0169, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.9169, 'compress@10': 1.0, 'time@10': 3.1405}:  63%|██████▎   | 19/30 [00:44<00:16,  1.50s/it]{'epoch': 44, 'num_users': 6.15, 'loss': 0.0169, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.9169, 'compress@10': 1.0, 'time@10': 3.1405}:  67%|██████▋   | 20/30 [00:44<00:25,  2.54s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 3.3277}:  67%|██████▋   | 20/30 [00:48<00:25,  2.54s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 3.3277}:  70%|███████   | 21/30 [00:48<00:25,  2.85s/it]{'epoch': 44, 'num_users': 6.1818, 'loss': 0.0172, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9189, 'compress@10': 1.0, 'time@10': 3.2595}:  70%|███████   | 21/30 [00:49<00:25,  2.85s/it]{'epoch': 44, 'num_users': 6.1818, 'loss': 0.0172, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9189, 'compress@10': 1.0, 'time@10': 3.2595}:  73%|███████▎  | 22/30 [00:49<00:20,  2.55s/it]{'epoch': 44, 'num_users': 6.1304, 'loss': 0.0169, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9195, 'compress@10': 1.0, 'time@10': 3.2542}:  73%|███████▎  | 22/30 [00:51<00:20,  2.55s/it]{'epoch': 44, 'num_users': 6.1304, 'loss': 0.0169, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9195, 'compress@10': 1.0, 'time@10': 3.2542}:  77%|███████▋  | 23/30 [00:51<00:15,  2.27s/it]{'epoch': 44, 'num_users': 5.9583, 'loss': 0.0177, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9089, 'compress@10': 1.0, 'time@10': 3.1323}:  77%|███████▋  | 23/30 [00:51<00:15,  2.27s/it] {'epoch': 44, 'num_users': 5.9583, 'loss': 0.0177, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9089, 'compress@10': 1.0, 'time@10': 3.1323}:  80%|████████  | 24/30 [00:51<00:10,  1.70s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8934, 'compress@10': 1.0, 'time@10': 3.0195}:  80%|████████  | 24/30 [00:52<00:10,  1.70s/it]  {'epoch': 44, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8934, 'compress@10': 1.0, 'time@10': 3.0195}:  83%|████████▎ | 25/30 [00:52<00:06,  1.25s/it]{'epoch': 44, 'num_users': 5.8077, 'loss': 0.0177, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 3.161}:  83%|████████▎ | 25/30 [00:58<00:06,  1.25s/it]{'epoch': 44, 'num_users': 5.8077, 'loss': 0.0177, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 3.161}:  87%|████████▋ | 26/30 [00:58<00:11,  2.89s/it]{'epoch': 44, 'num_users': 5.8889, 'loss': 0.0187, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.2159}:  87%|████████▋ | 26/30 [01:01<00:11,  2.89s/it]{'epoch': 44, 'num_users': 5.8889, 'loss': 0.0187, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.2159}:  90%|█████████ | 27/30 [01:01<00:08,  2.73s/it]{'epoch': 44, 'num_users': 6.0, 'loss': 0.0188, 'hit_ratio@10': 0.867, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.26}:  90%|█████████ | 27/30 [01:05<00:08,  2.73s/it]      {'epoch': 44, 'num_users': 6.0, 'loss': 0.0188, 'hit_ratio@10': 0.867, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 3.26}:  93%|█████████▎| 28/30 [01:05<00:06,  3.26s/it]{'epoch': 44, 'num_users': 5.8621, 'loss': 0.0185, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9033, 'compress@10': 1.0, 'time@10': 3.2682}:  93%|█████████▎| 28/30 [01:07<00:06,  3.26s/it]{'epoch': 44, 'num_users': 5.8621, 'loss': 0.0185, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9033, 'compress@10': 1.0, 'time@10': 3.2682}:  97%|█████████▋| 29/30 [01:07<00:02,  2.82s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0185, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9054, 'compress@10': 1.0, 'time@10': 3.2623}:  97%|█████████▋| 29/30 [01:10<00:02,  2.82s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0185, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9054, 'compress@10': 1.0, 'time@10': 3.2623}: 100%|██████████| 30/30 [01:10<00:00,  2.91s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0185, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9054, 'compress@10': 1.0, 'time@10': 3.2623}: 100%|██████████| 30/30 [01:10<00:00,  2.35s/it]
Epoch: 44
Avg # of users: 5.866666666666666
Avg Loss: 0.018463516690614808
Avg hit ratio: 0.8707103909080985
Avg ndcg: 0.9054312438202619
Avg compression ratio: 0.9999999860153537
Avg train time: 3.262327210108439
Std train time: 2.002827565963755
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.1255}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.1255}:   3%|▎         | 1/30 [00:01<00:46,  1.60s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9419, 'compress@10': 1.0, 'time@10': 2.8629}:   3%|▎         | 1/30 [00:04<00:46,  1.60s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9419, 'compress@10': 1.0, 'time@10': 2.8629}:   7%|▋         | 2/30 [00:04<01:01,  2.21s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9024, 'compress@10': 1.0, 'time@10': 2.2478}:   7%|▋         | 2/30 [00:04<01:01,  2.21s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9024, 'compress@10': 1.0, 'time@10': 2.2478}:  10%|█         | 3/30 [00:04<00:39,  1.45s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9128, 'compress@10': 1.0, 'time@10': 2.2742}:  10%|█         | 3/30 [00:07<00:39,  1.45s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9128, 'compress@10': 1.0, 'time@10': 2.2742}:  13%|█▎        | 4/30 [00:07<00:47,  1.82s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9212, 'compress@10': 1.0, 'time@10': 3.5321}:  13%|█▎        | 4/30 [00:11<00:47,  1.82s/it] {'epoch': 45, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9212, 'compress@10': 1.0, 'time@10': 3.5321}:  17%|█▋        | 5/30 [00:11<01:08,  2.72s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9279, 'compress@10': 1.0, 'time@10': 3.5685}:  17%|█▋        | 5/30 [00:15<01:08,  2.72s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9279, 'compress@10': 1.0, 'time@10': 3.5685}:  20%|██        | 6/30 [00:15<01:14,  3.08s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0145, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 3.6489}:  20%|██        | 6/30 [00:17<01:14,  3.08s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0145, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 3.6489}:  23%|██▎       | 7/30 [00:17<01:03,  2.76s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.9365, 'compress@10': 1.0, 'time@10': 3.5554}:  23%|██▎       | 7/30 [00:20<01:03,  2.76s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.9365, 'compress@10': 1.0, 'time@10': 3.5554}:  27%|██▋       | 8/30 [00:20<01:02,  2.83s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9411, 'compress@10': 1.0, 'time@10': 3.8165}:  27%|██▋       | 8/30 [00:23<01:02,  2.83s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9411, 'compress@10': 1.0, 'time@10': 3.8165}:  30%|███       | 9/30 [00:23<01:00,  2.88s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9439, 'compress@10': 1.0, 'time@10': 3.8094}:  30%|███       | 9/30 [00:27<01:00,  2.88s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9439, 'compress@10': 1.0, 'time@10': 3.8094}:  33%|███▎      | 10/30 [00:27<01:03,  3.16s/it]{'epoch': 45, 'num_users': 6.6364, 'loss': 0.0164, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9427, 'compress@10': 1.0, 'time@10': 3.8706}:  33%|███▎      | 10/30 [00:29<01:03,  3.16s/it]{'epoch': 45, 'num_users': 6.6364, 'loss': 0.0164, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9427, 'compress@10': 1.0, 'time@10': 3.8706}:  37%|███▋      | 11/30 [00:29<00:54,  2.89s/it]{'epoch': 45, 'num_users': 6.4167, 'loss': 0.0165, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9383, 'compress@10': 1.0, 'time@10': 3.6264}:  37%|███▋      | 11/30 [00:30<00:54,  2.89s/it] {'epoch': 45, 'num_users': 6.4167, 'loss': 0.0165, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9383, 'compress@10': 1.0, 'time@10': 3.6264}:  40%|████      | 12/30 [00:30<00:41,  2.31s/it]{'epoch': 45, 'num_users': 6.6154, 'loss': 0.0168, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9366, 'compress@10': 1.0, 'time@10': 3.6408}:  40%|████      | 12/30 [00:32<00:41,  2.31s/it]{'epoch': 45, 'num_users': 6.6154, 'loss': 0.0168, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9366, 'compress@10': 1.0, 'time@10': 3.6408}:  43%|████▎     | 13/30 [00:32<00:37,  2.20s/it]{'epoch': 45, 'num_users': 6.3571, 'loss': 0.0169, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9262, 'compress@10': 1.0, 'time@10': 3.4112}:  43%|████▎     | 13/30 [00:32<00:37,  2.20s/it]{'epoch': 45, 'num_users': 6.3571, 'loss': 0.0169, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9262, 'compress@10': 1.0, 'time@10': 3.4112}:  47%|████▋     | 14/30 [00:32<00:26,  1.68s/it]{'epoch': 45, 'num_users': 6.2667, 'loss': 0.0173, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 3.518}:  47%|████▋     | 14/30 [00:35<00:26,  1.68s/it]  {'epoch': 45, 'num_users': 6.2667, 'loss': 0.0173, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 3.518}:  50%|█████     | 15/30 [00:35<00:29,  1.94s/it]{'epoch': 45, 'num_users': 6.0625, 'loss': 0.0166, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 3.355}:  50%|█████     | 15/30 [00:36<00:29,  1.94s/it]{'epoch': 45, 'num_users': 6.0625, 'loss': 0.0166, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 3.355}:  53%|█████▎    | 16/30 [00:36<00:22,  1.64s/it]{'epoch': 45, 'num_users': 5.8235, 'loss': 0.0166, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9141, 'compress@10': 1.0, 'time@10': 3.1944}:  53%|█████▎    | 16/30 [00:36<00:22,  1.64s/it]{'epoch': 45, 'num_users': 5.8235, 'loss': 0.0166, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9141, 'compress@10': 1.0, 'time@10': 3.1944}:  57%|█████▋    | 17/30 [00:36<00:16,  1.25s/it]{'epoch': 45, 'num_users': 6.0556, 'loss': 0.0164, 'hit_ratio@10': 0.854, 'ndcg@10': 0.9158, 'compress@10': 1.0, 'time@10': 3.1353}:  57%|█████▋    | 17/30 [00:38<00:16,  1.25s/it] {'epoch': 45, 'num_users': 6.0556, 'loss': 0.0164, 'hit_ratio@10': 0.854, 'ndcg@10': 0.9158, 'compress@10': 1.0, 'time@10': 3.1353}:  60%|██████    | 18/30 [00:38<00:18,  1.53s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 0.016, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9158, 'compress@10': 1.0, 'time@10': 3.0723}:  60%|██████    | 18/30 [00:39<00:18,  1.53s/it]   {'epoch': 45, 'num_users': 6.0, 'loss': 0.016, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9158, 'compress@10': 1.0, 'time@10': 3.0723}:  63%|██████▎   | 19/30 [00:39<00:15,  1.37s/it]{'epoch': 45, 'num_users': 6.15, 'loss': 0.0162, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9183, 'compress@10': 1.0, 'time@10': 3.1561}:  63%|██████▎   | 19/30 [00:44<00:15,  1.37s/it]{'epoch': 45, 'num_users': 6.15, 'loss': 0.0162, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9183, 'compress@10': 1.0, 'time@10': 3.1561}:  67%|██████▋   | 20/30 [00:44<00:23,  2.40s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9203, 'compress@10': 1.0, 'time@10': 3.3425}:  67%|██████▋   | 20/30 [00:48<00:23,  2.40s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9203, 'compress@10': 1.0, 'time@10': 3.3425}:  70%|███████   | 21/30 [00:48<00:24,  2.76s/it]{'epoch': 45, 'num_users': 6.1818, 'loss': 0.0165, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9203, 'compress@10': 1.0, 'time@10': 3.2708}:  70%|███████   | 21/30 [00:50<00:24,  2.76s/it]{'epoch': 45, 'num_users': 6.1818, 'loss': 0.0165, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9203, 'compress@10': 1.0, 'time@10': 3.2708}:  73%|███████▎  | 22/30 [00:50<00:19,  2.47s/it]{'epoch': 45, 'num_users': 6.1304, 'loss': 0.0162, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 3.262}:  73%|███████▎  | 22/30 [00:51<00:19,  2.47s/it]{'epoch': 45, 'num_users': 6.1304, 'loss': 0.0162, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 3.262}:  77%|███████▋  | 23/30 [00:51<00:15,  2.20s/it]{'epoch': 45, 'num_users': 5.9583, 'loss': 0.0169, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.9105, 'compress@10': 1.0, 'time@10': 3.139}:  77%|███████▋  | 23/30 [00:51<00:15,  2.20s/it]{'epoch': 45, 'num_users': 5.9583, 'loss': 0.0169, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.9105, 'compress@10': 1.0, 'time@10': 3.139}:  80%|████████  | 24/30 [00:51<00:09,  1.65s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.0257}:  80%|████████  | 24/30 [00:52<00:09,  1.65s/it]  {'epoch': 45, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.0257}:  83%|████████▎ | 25/30 [00:52<00:06,  1.21s/it]{'epoch': 45, 'num_users': 5.8077, 'loss': 0.0178, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8991, 'compress@10': 1.0, 'time@10': 3.1587}:  83%|████████▎ | 25/30 [00:58<00:06,  1.21s/it]{'epoch': 45, 'num_users': 5.8077, 'loss': 0.0178, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8991, 'compress@10': 1.0, 'time@10': 3.1587}:  87%|████████▋ | 26/30 [00:58<00:11,  2.80s/it]{'epoch': 45, 'num_users': 5.8889, 'loss': 0.0179, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9014, 'compress@10': 1.0, 'time@10': 3.2108}:  87%|████████▋ | 26/30 [01:00<00:11,  2.80s/it]{'epoch': 45, 'num_users': 5.8889, 'loss': 0.0179, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9014, 'compress@10': 1.0, 'time@10': 3.2108}:  90%|█████████ | 27/30 [01:00<00:07,  2.66s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 0.0174, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9041, 'compress@10': 1.0, 'time@10': 3.2568}:  90%|█████████ | 27/30 [01:05<00:07,  2.66s/it]   {'epoch': 45, 'num_users': 6.0, 'loss': 0.0174, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9041, 'compress@10': 1.0, 'time@10': 3.2568}:  93%|█████████▎| 28/30 [01:05<00:06,  3.22s/it]{'epoch': 45, 'num_users': 5.8621, 'loss': 0.0172, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9057, 'compress@10': 1.0, 'time@10': 3.2649}:  93%|█████████▎| 28/30 [01:07<00:06,  3.22s/it]{'epoch': 45, 'num_users': 5.8621, 'loss': 0.0172, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9057, 'compress@10': 1.0, 'time@10': 3.2649}:  97%|█████████▋| 29/30 [01:07<00:02,  2.79s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.017, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 3.2598}:  97%|█████████▋| 29/30 [01:10<00:02,  2.79s/it]  {'epoch': 45, 'num_users': 5.8667, 'loss': 0.017, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 3.2598}: 100%|██████████| 30/30 [01:10<00:00,  2.90s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.017, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 3.2598}: 100%|██████████| 30/30 [01:10<00:00,  2.35s/it]
Epoch: 45
Avg # of users: 5.866666666666666
Avg Loss: 0.017018995668963924
Avg hit ratio: 0.8759770047399923
Avg ndcg: 0.9074090667960717
Avg compression ratio: 0.9999999860153537
Avg train time: 3.259817695617676
Std train time: 2.0551528187952943
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.2228}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.2228}:   3%|▎         | 1/30 [00:01<00:47,  1.65s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.9833}:   3%|▎         | 1/30 [00:04<00:47,  1.65s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.9833}:   7%|▋         | 2/30 [00:04<01:04,  2.31s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9001, 'compress@10': 1.0, 'time@10': 2.3455}:   7%|▋         | 2/30 [00:05<01:04,  2.31s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9001, 'compress@10': 1.0, 'time@10': 2.3455}:  10%|█         | 3/30 [00:05<00:41,  1.52s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8992, 'compress@10': 1.0, 'time@10': 2.3391}:  10%|█         | 3/30 [00:07<00:41,  1.52s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8992, 'compress@10': 1.0, 'time@10': 2.3391}:  13%|█▎        | 4/30 [00:07<00:48,  1.85s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9109, 'compress@10': 1.0, 'time@10': 3.6151}:  13%|█▎        | 4/30 [00:11<00:48,  1.85s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9109, 'compress@10': 1.0, 'time@10': 3.6151}:  17%|█▋        | 5/30 [00:11<01:09,  2.77s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9203, 'compress@10': 1.0, 'time@10': 3.6463}:  17%|█▋        | 5/30 [00:15<01:09,  2.77s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9203, 'compress@10': 1.0, 'time@10': 3.6463}:  20%|██        | 6/30 [00:15<01:15,  3.13s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 3.7272}:  20%|██        | 6/30 [00:17<01:15,  3.13s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 3.7272}:  23%|██▎       | 7/30 [00:17<01:04,  2.81s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.015, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9258, 'compress@10': 1.0, 'time@10': 3.6317}:  23%|██▎       | 7/30 [00:20<01:04,  2.81s/it]  {'epoch': 46, 'num_users': 6.125, 'loss': 0.015, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9258, 'compress@10': 1.0, 'time@10': 3.6317}:  27%|██▋       | 8/30 [00:20<01:03,  2.87s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9182, 'compress@10': 1.0, 'time@10': 3.885}:  27%|██▋       | 8/30 [00:23<01:03,  2.87s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9182, 'compress@10': 1.0, 'time@10': 3.885}:  30%|███       | 9/30 [00:23<01:01,  2.91s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.924, 'compress@10': 1.0, 'time@10': 3.8769}:  30%|███       | 9/30 [00:27<01:01,  2.91s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.924, 'compress@10': 1.0, 'time@10': 3.8769}:  33%|███▎      | 10/30 [00:27<01:03,  3.20s/it]{'epoch': 46, 'num_users': 6.6364, 'loss': 0.016, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 3.9261}:  33%|███▎      | 10/30 [00:29<01:03,  3.20s/it]{'epoch': 46, 'num_users': 6.6364, 'loss': 0.016, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 3.9261}:  37%|███▋      | 11/30 [00:29<00:55,  2.91s/it]{'epoch': 46, 'num_users': 6.4167, 'loss': 0.0161, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9216, 'compress@10': 1.0, 'time@10': 3.677}:  37%|███▋      | 11/30 [00:30<00:55,  2.91s/it]{'epoch': 46, 'num_users': 6.4167, 'loss': 0.0161, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9216, 'compress@10': 1.0, 'time@10': 3.677}:  40%|████      | 12/30 [00:30<00:41,  2.32s/it]{'epoch': 46, 'num_users': 6.6154, 'loss': 0.0163, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9212, 'compress@10': 1.0, 'time@10': 3.6801}:  40%|████      | 12/30 [00:32<00:41,  2.32s/it]{'epoch': 46, 'num_users': 6.6154, 'loss': 0.0163, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9212, 'compress@10': 1.0, 'time@10': 3.6801}:  43%|████▎     | 13/30 [00:32<00:37,  2.19s/it]{'epoch': 46, 'num_users': 6.3571, 'loss': 0.0165, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9119, 'compress@10': 1.0, 'time@10': 3.4468}:  43%|████▎     | 13/30 [00:33<00:37,  2.19s/it]{'epoch': 46, 'num_users': 6.3571, 'loss': 0.0165, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9119, 'compress@10': 1.0, 'time@10': 3.4468}:  47%|████▋     | 14/30 [00:33<00:26,  1.67s/it]{'epoch': 46, 'num_users': 6.2667, 'loss': 0.0159, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9151, 'compress@10': 1.0, 'time@10': 3.5688}:  47%|████▋     | 14/30 [00:35<00:26,  1.67s/it]{'epoch': 46, 'num_users': 6.2667, 'loss': 0.0159, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9151, 'compress@10': 1.0, 'time@10': 3.5688}:  50%|█████     | 15/30 [00:35<00:29,  1.97s/it]{'epoch': 46, 'num_users': 6.0625, 'loss': 0.0153, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 3.4041}:  50%|█████     | 15/30 [00:36<00:29,  1.97s/it]{'epoch': 46, 'num_users': 6.0625, 'loss': 0.0153, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 3.4041}:  53%|█████▎    | 16/30 [00:36<00:23,  1.67s/it]{'epoch': 46, 'num_users': 5.8235, 'loss': 0.0154, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9053, 'compress@10': 1.0, 'time@10': 3.2425}:  53%|█████▎    | 16/30 [00:37<00:23,  1.67s/it]{'epoch': 46, 'num_users': 5.8235, 'loss': 0.0154, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9053, 'compress@10': 1.0, 'time@10': 3.2425}:  57%|█████▋    | 17/30 [00:37<00:16,  1.28s/it]{'epoch': 46, 'num_users': 6.0556, 'loss': 0.0151, 'hit_ratio@10': 0.845, 'ndcg@10': 0.9077, 'compress@10': 1.0, 'time@10': 3.1981}:  57%|█████▋    | 17/30 [00:39<00:16,  1.28s/it] {'epoch': 46, 'num_users': 6.0556, 'loss': 0.0151, 'hit_ratio@10': 0.845, 'ndcg@10': 0.9077, 'compress@10': 1.0, 'time@10': 3.1981}:  60%|██████    | 18/30 [00:39<00:19,  1.64s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 0.0148, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.9084, 'compress@10': 1.0, 'time@10': 3.1529}:  60%|██████    | 18/30 [00:40<00:19,  1.64s/it]  {'epoch': 46, 'num_users': 6.0, 'loss': 0.0148, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.9084, 'compress@10': 1.0, 'time@10': 3.1529}:  63%|██████▎   | 19/30 [00:40<00:16,  1.51s/it]{'epoch': 46, 'num_users': 6.15, 'loss': 0.0152, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.9118, 'compress@10': 1.0, 'time@10': 3.2433}:  63%|██████▎   | 19/30 [00:45<00:16,  1.51s/it]{'epoch': 46, 'num_users': 6.15, 'loss': 0.0152, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.9118, 'compress@10': 1.0, 'time@10': 3.2433}:  67%|██████▋   | 20/30 [00:45<00:25,  2.56s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.914, 'compress@10': 1.0, 'time@10': 3.4226}:  67%|██████▋   | 20/30 [00:49<00:25,  2.56s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.914, 'compress@10': 1.0, 'time@10': 3.4226}:  70%|███████   | 21/30 [00:49<00:25,  2.85s/it]{'epoch': 46, 'num_users': 6.1818, 'loss': 0.0155, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 3.346}:  70%|███████   | 21/30 [00:51<00:25,  2.85s/it]{'epoch': 46, 'num_users': 6.1818, 'loss': 0.0155, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 3.346}:  73%|███████▎  | 22/30 [00:51<00:20,  2.53s/it]{'epoch': 46, 'num_users': 6.1304, 'loss': 0.0152, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9154, 'compress@10': 1.0, 'time@10': 3.3406}:  73%|███████▎  | 22/30 [00:52<00:20,  2.53s/it]{'epoch': 46, 'num_users': 6.1304, 'loss': 0.0152, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9154, 'compress@10': 1.0, 'time@10': 3.3406}:  77%|███████▋  | 23/30 [00:52<00:15,  2.26s/it]{'epoch': 46, 'num_users': 5.9583, 'loss': 0.016, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 3.2154}:  77%|███████▋  | 23/30 [00:53<00:15,  2.26s/it]  {'epoch': 46, 'num_users': 5.9583, 'loss': 0.016, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 3.2154}:  80%|████████  | 24/30 [00:53<00:10,  1.70s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0166, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8897, 'compress@10': 1.0, 'time@10': 3.102}:  80%|████████  | 24/30 [00:53<00:10,  1.70s/it]  {'epoch': 46, 'num_users': 5.8, 'loss': 0.0166, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8897, 'compress@10': 1.0, 'time@10': 3.102}:  83%|████████▎ | 25/30 [00:53<00:06,  1.26s/it]{'epoch': 46, 'num_users': 5.8077, 'loss': 0.0167, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8928, 'compress@10': 1.0, 'time@10': 3.2458}:  83%|████████▎ | 25/30 [01:00<00:06,  1.26s/it]{'epoch': 46, 'num_users': 5.8077, 'loss': 0.0167, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8928, 'compress@10': 1.0, 'time@10': 3.2458}:  87%|████████▋ | 26/30 [01:00<00:11,  2.94s/it]{'epoch': 46, 'num_users': 5.8889, 'loss': 0.0162, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 3.3051}:  87%|████████▋ | 26/30 [01:02<00:11,  2.94s/it] {'epoch': 46, 'num_users': 5.8889, 'loss': 0.0162, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 3.3051}:  90%|█████████ | 27/30 [01:02<00:08,  2.80s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 0.0158, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 3.3445}:  90%|█████████ | 27/30 [01:07<00:08,  2.80s/it]  {'epoch': 46, 'num_users': 6.0, 'loss': 0.0158, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 3.3445}:  93%|█████████▎| 28/30 [01:07<00:06,  3.29s/it]{'epoch': 46, 'num_users': 5.8621, 'loss': 0.0156, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8996, 'compress@10': 1.0, 'time@10': 3.3354}:  93%|█████████▎| 28/30 [01:08<00:06,  3.29s/it]{'epoch': 46, 'num_users': 5.8621, 'loss': 0.0156, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8996, 'compress@10': 1.0, 'time@10': 3.3354}:  97%|█████████▋| 29/30 [01:08<00:02,  2.78s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.016, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9026, 'compress@10': 1.0, 'time@10': 3.3172}:  97%|█████████▋| 29/30 [01:11<00:02,  2.78s/it] {'epoch': 46, 'num_users': 5.8667, 'loss': 0.016, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9026, 'compress@10': 1.0, 'time@10': 3.3172}: 100%|██████████| 30/30 [01:11<00:00,  2.79s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.016, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9026, 'compress@10': 1.0, 'time@10': 3.3172}: 100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch: 46
Avg # of users: 5.866666666666666
Avg Loss: 0.01601845016175779
Avg hit ratio: 0.8708358396917065
Avg ndcg: 0.9026391171873057
Avg compression ratio: 0.9999999860153537
Avg train time: 3.3171919186909995
Std train time: 2.082430039353542
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.1448}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.1448}:   3%|▎         | 1/30 [00:01<00:46,  1.61s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9419, 'compress@10': 1.0, 'time@10': 2.9206}:   3%|▎         | 1/30 [00:04<00:46,  1.61s/it] {'epoch': 47, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9419, 'compress@10': 1.0, 'time@10': 2.9206}:   7%|▋         | 2/30 [00:04<01:03,  2.27s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9025, 'compress@10': 1.0, 'time@10': 2.2676}:   7%|▋         | 2/30 [00:04<01:03,  2.27s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9025, 'compress@10': 1.0, 'time@10': 2.2676}:  10%|█         | 3/30 [00:04<00:39,  1.47s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9083, 'compress@10': 1.0, 'time@10': 2.2753}:  10%|█         | 3/30 [00:07<00:39,  1.47s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9083, 'compress@10': 1.0, 'time@10': 2.2753}:  13%|█▎        | 4/30 [00:07<00:47,  1.81s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 3.5454}:  13%|█▎        | 4/30 [00:11<00:47,  1.81s/it] {'epoch': 47, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 3.5454}:  17%|█▋        | 5/30 [00:11<01:08,  2.73s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0141, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9261, 'compress@10': 1.0, 'time@10': 3.6269}:  17%|█▋        | 5/30 [00:15<01:08,  2.73s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0141, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9261, 'compress@10': 1.0, 'time@10': 3.6269}:  20%|██        | 6/30 [00:15<01:16,  3.19s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 3.7177}:  20%|██        | 6/30 [00:17<01:16,  3.19s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 3.7177}:  23%|██▎       | 7/30 [00:17<01:05,  2.85s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9358, 'compress@10': 1.0, 'time@10': 3.6145}:  23%|██▎       | 7/30 [00:20<01:05,  2.85s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9358, 'compress@10': 1.0, 'time@10': 3.6145}:  27%|██▋       | 8/30 [00:20<01:03,  2.88s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9218, 'compress@10': 1.0, 'time@10': 3.8578}:  27%|██▋       | 8/30 [00:23<01:03,  2.88s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9218, 'compress@10': 1.0, 'time@10': 3.8578}:  30%|███       | 9/30 [00:23<01:00,  2.90s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9262, 'compress@10': 1.0, 'time@10': 3.8413}:  30%|███       | 9/30 [00:27<01:00,  2.90s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9262, 'compress@10': 1.0, 'time@10': 3.8413}:  33%|███▎      | 10/30 [00:27<01:03,  3.15s/it]{'epoch': 47, 'num_users': 6.6364, 'loss': 0.0184, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9243, 'compress@10': 1.0, 'time@10': 3.9218}:  33%|███▎      | 10/30 [00:29<01:03,  3.15s/it]{'epoch': 47, 'num_users': 6.6364, 'loss': 0.0184, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9243, 'compress@10': 1.0, 'time@10': 3.9218}:  37%|███▋      | 11/30 [00:29<00:55,  2.92s/it]{'epoch': 47, 'num_users': 6.4167, 'loss': 0.0183, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9212, 'compress@10': 1.0, 'time@10': 3.6742}:  37%|███▋      | 11/30 [00:30<00:55,  2.92s/it]{'epoch': 47, 'num_users': 6.4167, 'loss': 0.0183, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9212, 'compress@10': 1.0, 'time@10': 3.6742}:  40%|████      | 12/30 [00:30<00:42,  2.33s/it]{'epoch': 47, 'num_users': 6.6154, 'loss': 0.0184, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.9208, 'compress@10': 1.0, 'time@10': 3.6774}:  40%|████      | 12/30 [00:32<00:42,  2.33s/it]{'epoch': 47, 'num_users': 6.6154, 'loss': 0.0184, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.9208, 'compress@10': 1.0, 'time@10': 3.6774}:  43%|████▎     | 13/30 [00:32<00:37,  2.20s/it]{'epoch': 47, 'num_users': 6.3571, 'loss': 0.0184, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9116, 'compress@10': 1.0, 'time@10': 3.4433}:  43%|████▎     | 13/30 [00:33<00:37,  2.20s/it] {'epoch': 47, 'num_users': 6.3571, 'loss': 0.0184, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9116, 'compress@10': 1.0, 'time@10': 3.4433}:  47%|████▋     | 14/30 [00:33<00:26,  1.67s/it]{'epoch': 47, 'num_users': 6.2667, 'loss': 0.0189, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9153, 'compress@10': 1.0, 'time@10': 3.5539}:  47%|████▋     | 14/30 [00:35<00:26,  1.67s/it]{'epoch': 47, 'num_users': 6.2667, 'loss': 0.0189, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9153, 'compress@10': 1.0, 'time@10': 3.5539}:  50%|█████     | 15/30 [00:35<00:29,  1.95s/it]{'epoch': 47, 'num_users': 6.0625, 'loss': 0.0181, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9146, 'compress@10': 1.0, 'time@10': 3.3893}:  50%|█████     | 15/30 [00:36<00:29,  1.95s/it] {'epoch': 47, 'num_users': 6.0625, 'loss': 0.0181, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9146, 'compress@10': 1.0, 'time@10': 3.3893}:  53%|█████▎    | 16/30 [00:36<00:23,  1.65s/it]{'epoch': 47, 'num_users': 5.8235, 'loss': 0.018, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 3.2311}:  53%|█████▎    | 16/30 [00:37<00:23,  1.65s/it]{'epoch': 47, 'num_users': 5.8235, 'loss': 0.018, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 3.2311}:  57%|█████▋    | 17/30 [00:37<00:16,  1.27s/it]{'epoch': 47, 'num_users': 6.0556, 'loss': 0.0179, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 3.1833}:  57%|█████▋    | 17/30 [00:39<00:16,  1.27s/it]{'epoch': 47, 'num_users': 6.0556, 'loss': 0.0179, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 3.1833}:  60%|██████    | 18/30 [00:39<00:19,  1.61s/it]{'epoch': 47, 'num_users': 6.0, 'loss': 0.0174, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.908, 'compress@10': 1.0, 'time@10': 3.1304}:  60%|██████    | 18/30 [00:40<00:19,  1.61s/it]    {'epoch': 47, 'num_users': 6.0, 'loss': 0.0174, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.908, 'compress@10': 1.0, 'time@10': 3.1304}:  63%|██████▎   | 19/30 [00:40<00:16,  1.47s/it]{'epoch': 47, 'num_users': 6.15, 'loss': 0.0175, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9112, 'compress@10': 1.0, 'time@10': 3.219}:  63%|██████▎   | 19/30 [00:45<00:16,  1.47s/it]{'epoch': 47, 'num_users': 6.15, 'loss': 0.0175, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9112, 'compress@10': 1.0, 'time@10': 3.219}:  67%|██████▋   | 20/30 [00:45<00:25,  2.51s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9133, 'compress@10': 1.0, 'time@10': 3.4006}:  67%|██████▋   | 20/30 [00:49<00:25,  2.51s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9133, 'compress@10': 1.0, 'time@10': 3.4006}:  70%|███████   | 21/30 [00:49<00:25,  2.82s/it]{'epoch': 47, 'num_users': 6.1818, 'loss': 0.0176, 'hit_ratio@10': 0.867, 'ndcg@10': 0.9137, 'compress@10': 1.0, 'time@10': 3.3258}:  70%|███████   | 21/30 [00:50<00:25,  2.82s/it] {'epoch': 47, 'num_users': 6.1818, 'loss': 0.0176, 'hit_ratio@10': 0.867, 'ndcg@10': 0.9137, 'compress@10': 1.0, 'time@10': 3.3258}:  73%|███████▎  | 22/30 [00:50<00:20,  2.51s/it]{'epoch': 47, 'num_users': 6.1304, 'loss': 0.0173, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 3.3239}:  73%|███████▎  | 22/30 [00:52<00:20,  2.51s/it]{'epoch': 47, 'num_users': 6.1304, 'loss': 0.0173, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 3.3239}:  77%|███████▋  | 23/30 [00:52<00:15,  2.26s/it]{'epoch': 47, 'num_users': 5.9583, 'loss': 0.018, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9044, 'compress@10': 1.0, 'time@10': 3.1992}:  77%|███████▋  | 23/30 [00:52<00:15,  2.26s/it] {'epoch': 47, 'num_users': 5.9583, 'loss': 0.018, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9044, 'compress@10': 1.0, 'time@10': 3.1992}:  80%|████████  | 24/30 [00:52<00:10,  1.69s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0184, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.892, 'compress@10': 1.0, 'time@10': 3.0845}:  80%|████████  | 24/30 [00:53<00:10,  1.69s/it]   {'epoch': 47, 'num_users': 5.8, 'loss': 0.0184, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.892, 'compress@10': 1.0, 'time@10': 3.0845}:  83%|████████▎ | 25/30 [00:53<00:06,  1.25s/it]{'epoch': 47, 'num_users': 5.8077, 'loss': 0.0183, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 3.2326}:  83%|████████▎ | 25/30 [01:00<00:06,  1.25s/it]{'epoch': 47, 'num_users': 5.8077, 'loss': 0.0183, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 3.2326}:  87%|████████▋ | 26/30 [01:00<00:11,  2.97s/it]{'epoch': 47, 'num_users': 5.8889, 'loss': 0.018, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 3.2872}:  87%|████████▋ | 26/30 [01:02<00:11,  2.97s/it] {'epoch': 47, 'num_users': 5.8889, 'loss': 0.018, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 3.2872}:  90%|█████████ | 27/30 [01:02<00:08,  2.80s/it]{'epoch': 47, 'num_users': 6.0, 'loss': 0.0185, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9029, 'compress@10': 1.0, 'time@10': 3.3302}:  90%|█████████ | 27/30 [01:07<00:08,  2.80s/it]  {'epoch': 47, 'num_users': 6.0, 'loss': 0.0185, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9029, 'compress@10': 1.0, 'time@10': 3.3302}:  93%|█████████▎| 28/30 [01:07<00:06,  3.32s/it]{'epoch': 47, 'num_users': 5.8621, 'loss': 0.0181, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9045, 'compress@10': 1.0, 'time@10': 3.3353}:  93%|█████████▎| 28/30 [01:08<00:06,  3.32s/it]{'epoch': 47, 'num_users': 5.8621, 'loss': 0.0181, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9045, 'compress@10': 1.0, 'time@10': 3.3353}:  97%|█████████▋| 29/30 [01:08<00:02,  2.86s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0184, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9089, 'compress@10': 1.0, 'time@10': 3.3269}:  97%|█████████▋| 29/30 [01:11<00:02,  2.86s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0184, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9089, 'compress@10': 1.0, 'time@10': 3.3269}: 100%|██████████| 30/30 [01:11<00:00,  2.94s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0184, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9089, 'compress@10': 1.0, 'time@10': 3.3269}: 100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch: 47
Avg # of users: 5.866666666666666
Avg Loss: 0.018400187468818982
Avg hit ratio: 0.8725025616346119
Avg ndcg: 0.9088723989115106
Avg compression ratio: 0.9999999860153537
Avg train time: 3.3269344329833985
Std train time: 2.0848876572081663
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.1999}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.1999}:   3%|▎         | 1/30 [00:01<00:47,  1.64s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 2.9036}:   3%|▎         | 1/30 [00:04<00:47,  1.64s/it] {'epoch': 48, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 2.9036}:   7%|▋         | 2/30 [00:04<01:02,  2.23s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9062, 'compress@10': 1.0, 'time@10': 2.2707}:   7%|▋         | 2/30 [00:04<01:02,  2.23s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9062, 'compress@10': 1.0, 'time@10': 2.2707}:  10%|█         | 3/30 [00:04<00:39,  1.46s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9203, 'compress@10': 1.0, 'time@10': 2.2816}:  10%|█         | 3/30 [00:07<00:39,  1.46s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9203, 'compress@10': 1.0, 'time@10': 2.2816}:  13%|█▎        | 4/30 [00:07<00:47,  1.81s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 3.5277}:  13%|█▎        | 4/30 [00:11<00:47,  1.81s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 3.5277}:  17%|█▋        | 5/30 [00:11<01:07,  2.71s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9349, 'compress@10': 1.0, 'time@10': 3.5845}:  17%|█▋        | 5/30 [00:15<01:07,  2.71s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9349, 'compress@10': 1.0, 'time@10': 3.5845}:  20%|██        | 6/30 [00:15<01:14,  3.11s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9319, 'compress@10': 1.0, 'time@10': 3.6762}:  20%|██        | 6/30 [00:17<01:14,  3.11s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9319, 'compress@10': 1.0, 'time@10': 3.6762}:  23%|██▎       | 7/30 [00:17<01:04,  2.80s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9398, 'compress@10': 1.0, 'time@10': 3.5521}:  23%|██▎       | 7/30 [00:20<01:04,  2.80s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9398, 'compress@10': 1.0, 'time@10': 3.5521}:  27%|██▋       | 8/30 [00:20<01:01,  2.78s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.942, 'compress@10': 1.0, 'time@10': 3.7689}:  27%|██▋       | 8/30 [00:23<01:01,  2.78s/it] {'epoch': 48, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.942, 'compress@10': 1.0, 'time@10': 3.7689}:  30%|███       | 9/30 [00:23<00:58,  2.78s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9449, 'compress@10': 1.0, 'time@10': 3.7624}:  30%|███       | 9/30 [00:26<00:58,  2.78s/it] {'epoch': 48, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9449, 'compress@10': 1.0, 'time@10': 3.7624}:  33%|███▎      | 10/30 [00:26<01:01,  3.08s/it]{'epoch': 48, 'num_users': 6.6364, 'loss': 0.0154, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9504, 'compress@10': 1.0, 'time@10': 3.8194}:  33%|███▎      | 10/30 [00:29<01:01,  3.08s/it]{'epoch': 48, 'num_users': 6.6364, 'loss': 0.0154, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9504, 'compress@10': 1.0, 'time@10': 3.8194}:  37%|███▋      | 11/30 [00:29<00:53,  2.82s/it]{'epoch': 48, 'num_users': 6.4167, 'loss': 0.0156, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9449, 'compress@10': 1.0, 'time@10': 3.5792}:  37%|███▋      | 11/30 [00:29<00:53,  2.82s/it]{'epoch': 48, 'num_users': 6.4167, 'loss': 0.0156, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9449, 'compress@10': 1.0, 'time@10': 3.5792}:  40%|████      | 12/30 [00:29<00:40,  2.26s/it]{'epoch': 48, 'num_users': 6.6154, 'loss': 0.0158, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9429, 'compress@10': 1.0, 'time@10': 3.5793}:  40%|████      | 12/30 [00:31<00:40,  2.26s/it]{'epoch': 48, 'num_users': 6.6154, 'loss': 0.0158, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9429, 'compress@10': 1.0, 'time@10': 3.5793}:  43%|████▎     | 13/30 [00:31<00:36,  2.13s/it]{'epoch': 48, 'num_users': 6.3571, 'loss': 0.016, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9321, 'compress@10': 1.0, 'time@10': 3.356}:  43%|████▎     | 13/30 [00:32<00:36,  2.13s/it]  {'epoch': 48, 'num_users': 6.3571, 'loss': 0.016, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9321, 'compress@10': 1.0, 'time@10': 3.356}:  47%|████▋     | 14/30 [00:32<00:26,  1.64s/it]{'epoch': 48, 'num_users': 6.2667, 'loss': 0.0169, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9311, 'compress@10': 1.0, 'time@10': 3.4686}:  47%|████▋     | 14/30 [00:34<00:26,  1.64s/it]{'epoch': 48, 'num_users': 6.2667, 'loss': 0.0169, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9311, 'compress@10': 1.0, 'time@10': 3.4686}:  50%|█████     | 15/30 [00:34<00:28,  1.91s/it]{'epoch': 48, 'num_users': 6.0625, 'loss': 0.0163, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9294, 'compress@10': 1.0, 'time@10': 3.3106}:  50%|█████     | 15/30 [00:35<00:28,  1.91s/it]{'epoch': 48, 'num_users': 6.0625, 'loss': 0.0163, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9294, 'compress@10': 1.0, 'time@10': 3.3106}:  53%|█████▎    | 16/30 [00:35<00:22,  1.63s/it]{'epoch': 48, 'num_users': 5.8235, 'loss': 0.0163, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 3.1559}:  53%|█████▎    | 16/30 [00:36<00:22,  1.63s/it]{'epoch': 48, 'num_users': 5.8235, 'loss': 0.0163, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 3.1559}:  57%|█████▋    | 17/30 [00:36<00:16,  1.25s/it]{'epoch': 48, 'num_users': 6.0556, 'loss': 0.0163, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 3.1093}:  57%|█████▋    | 17/30 [00:38<00:16,  1.25s/it]{'epoch': 48, 'num_users': 6.0556, 'loss': 0.0163, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 3.1093}:  60%|██████    | 18/30 [00:38<00:19,  1.59s/it]{'epoch': 48, 'num_users': 6.0, 'loss': 0.0159, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 3.056}:  60%|██████    | 18/30 [00:39<00:19,  1.59s/it]    {'epoch': 48, 'num_users': 6.0, 'loss': 0.0159, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 3.056}:  63%|██████▎   | 19/30 [00:39<00:15,  1.43s/it]{'epoch': 48, 'num_users': 6.15, 'loss': 0.016, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.9236, 'compress@10': 1.0, 'time@10': 3.1446}:  63%|██████▎   | 19/30 [00:44<00:15,  1.43s/it]{'epoch': 48, 'num_users': 6.15, 'loss': 0.016, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.9236, 'compress@10': 1.0, 'time@10': 3.1446}:  67%|██████▋   | 20/30 [00:44<00:24,  2.47s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9253, 'compress@10': 1.0, 'time@10': 3.3353}:  67%|██████▋   | 20/30 [00:48<00:24,  2.47s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9253, 'compress@10': 1.0, 'time@10': 3.3353}:  70%|███████   | 21/30 [00:48<00:25,  2.81s/it]{'epoch': 48, 'num_users': 6.1818, 'loss': 0.0162, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9252, 'compress@10': 1.0, 'time@10': 3.263}:  70%|███████   | 21/30 [00:49<00:25,  2.81s/it] {'epoch': 48, 'num_users': 6.1818, 'loss': 0.0162, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9252, 'compress@10': 1.0, 'time@10': 3.263}:  73%|███████▎  | 22/30 [00:49<00:20,  2.50s/it]{'epoch': 48, 'num_users': 6.1304, 'loss': 0.0159, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.2633}:  73%|███████▎  | 22/30 [00:51<00:20,  2.50s/it]{'epoch': 48, 'num_users': 6.1304, 'loss': 0.0159, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.2633}:  77%|███████▋  | 23/30 [00:51<00:15,  2.25s/it]{'epoch': 48, 'num_users': 5.9583, 'loss': 0.0167, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9149, 'compress@10': 1.0, 'time@10': 3.1405}:  77%|███████▋  | 23/30 [00:51<00:15,  2.25s/it]{'epoch': 48, 'num_users': 5.9583, 'loss': 0.0167, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9149, 'compress@10': 1.0, 'time@10': 3.1405}:  80%|████████  | 24/30 [00:51<00:10,  1.68s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8991, 'compress@10': 1.0, 'time@10': 3.0276}:  80%|████████  | 24/30 [00:52<00:10,  1.68s/it]   {'epoch': 48, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8991, 'compress@10': 1.0, 'time@10': 3.0276}:  83%|████████▎ | 25/30 [00:52<00:06,  1.24s/it]{'epoch': 48, 'num_users': 5.8077, 'loss': 0.017, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9025, 'compress@10': 1.0, 'time@10': 3.1765}:  83%|████████▎ | 25/30 [00:59<00:06,  1.24s/it]{'epoch': 48, 'num_users': 5.8077, 'loss': 0.017, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9025, 'compress@10': 1.0, 'time@10': 3.1765}:  87%|████████▋ | 26/30 [00:59<00:11,  2.95s/it]{'epoch': 48, 'num_users': 5.8889, 'loss': 0.0173, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9024, 'compress@10': 1.0, 'time@10': 3.2344}:  87%|████████▋ | 26/30 [01:01<00:11,  2.95s/it]{'epoch': 48, 'num_users': 5.8889, 'loss': 0.0173, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9024, 'compress@10': 1.0, 'time@10': 3.2344}:  90%|█████████ | 27/30 [01:01<00:08,  2.79s/it]{'epoch': 48, 'num_users': 6.0, 'loss': 0.0171, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9051, 'compress@10': 1.0, 'time@10': 3.2798}:  90%|█████████ | 27/30 [01:06<00:08,  2.79s/it]   {'epoch': 48, 'num_users': 6.0, 'loss': 0.0171, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9051, 'compress@10': 1.0, 'time@10': 3.2798}:  93%|█████████▎| 28/30 [01:06<00:06,  3.31s/it]{'epoch': 48, 'num_users': 5.8621, 'loss': 0.0168, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9066, 'compress@10': 1.0, 'time@10': 3.2851}:  93%|█████████▎| 28/30 [01:07<00:06,  3.31s/it]{'epoch': 48, 'num_users': 5.8621, 'loss': 0.0168, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9066, 'compress@10': 1.0, 'time@10': 3.2851}:  97%|█████████▋| 29/30 [01:07<00:02,  2.85s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0165, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9087, 'compress@10': 1.0, 'time@10': 3.2775}:  97%|█████████▋| 29/30 [01:10<00:02,  2.85s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0165, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9087, 'compress@10': 1.0, 'time@10': 3.2775}: 100%|██████████| 30/30 [01:10<00:00,  2.92s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0165, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9087, 'compress@10': 1.0, 'time@10': 3.2775}: 100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch: 48
Avg # of users: 5.866666666666666
Avg Loss: 0.01650607911569081
Avg hit ratio: 0.8749081104158724
Avg ndcg: 0.9086544921830396
Avg compression ratio: 0.9999999860153537
Avg train time: 3.2775306065877277
Std train time: 2.059354922859315
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.1951}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 3.1951}:   3%|▎         | 1/30 [00:01<00:47,  1.64s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9403, 'compress@10': 1.0, 'time@10': 2.9013}:   3%|▎         | 1/30 [00:04<00:47,  1.64s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9403, 'compress@10': 1.0, 'time@10': 2.9013}:   7%|▋         | 2/30 [00:04<01:02,  2.23s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8985, 'compress@10': 1.0, 'time@10': 2.2645}:   7%|▋         | 2/30 [00:04<01:02,  2.23s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8985, 'compress@10': 1.0, 'time@10': 2.2645}:  10%|█         | 3/30 [00:04<00:39,  1.46s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 2.2822}:  10%|█         | 3/30 [00:07<00:39,  1.46s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 2.2822}:  13%|█▎        | 4/30 [00:07<00:47,  1.82s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 3.485}:  13%|█▎        | 4/30 [00:11<00:47,  1.82s/it] {'epoch': 49, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 3.485}:  17%|█▋        | 5/30 [00:11<01:07,  2.68s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9229, 'compress@10': 1.0, 'time@10': 3.5372}:  17%|█▋        | 5/30 [00:15<01:07,  2.68s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9229, 'compress@10': 1.0, 'time@10': 3.5372}:  20%|██        | 6/30 [00:15<01:13,  3.07s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0121, 'hit_ratio@10': 0.915, 'ndcg@10': 0.9256, 'compress@10': 1.0, 'time@10': 3.6324}:  20%|██        | 6/30 [00:17<01:13,  3.07s/it] {'epoch': 49, 'num_users': 6.2857, 'loss': 0.0121, 'hit_ratio@10': 0.915, 'ndcg@10': 0.9256, 'compress@10': 1.0, 'time@10': 3.6324}:  23%|██▎       | 7/30 [00:17<01:03,  2.77s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.922, 'ndcg@10': 0.9343, 'compress@10': 1.0, 'time@10': 3.5402}:  23%|██▎       | 7/30 [00:20<01:03,  2.77s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.922, 'ndcg@10': 0.9343, 'compress@10': 1.0, 'time@10': 3.5402}:  27%|██▋       | 8/30 [00:20<01:02,  2.82s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0142, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9431, 'compress@10': 1.0, 'time@10': 3.8121}:  27%|██▋       | 8/30 [00:23<01:02,  2.82s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0142, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9431, 'compress@10': 1.0, 'time@10': 3.8121}:  30%|███       | 9/30 [00:23<01:00,  2.89s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9439, 'compress@10': 1.0, 'time@10': 3.8001}:  30%|███       | 9/30 [00:27<01:00,  2.89s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9439, 'compress@10': 1.0, 'time@10': 3.8001}:  33%|███▎      | 10/30 [00:27<01:02,  3.15s/it]{'epoch': 49, 'num_users': 6.6364, 'loss': 0.0152, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9424, 'compress@10': 1.0, 'time@10': 3.8539}:  33%|███▎      | 10/30 [00:29<01:02,  3.15s/it]{'epoch': 49, 'num_users': 6.6364, 'loss': 0.0152, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9424, 'compress@10': 1.0, 'time@10': 3.8539}:  37%|███▋      | 11/30 [00:29<00:54,  2.87s/it]{'epoch': 49, 'num_users': 6.4167, 'loss': 0.0153, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9375, 'compress@10': 1.0, 'time@10': 3.6087}:  37%|███▋      | 11/30 [00:30<00:54,  2.87s/it]{'epoch': 49, 'num_users': 6.4167, 'loss': 0.0153, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9375, 'compress@10': 1.0, 'time@10': 3.6087}:  40%|████      | 12/30 [00:30<00:41,  2.28s/it]{'epoch': 49, 'num_users': 6.6154, 'loss': 0.0155, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9361, 'compress@10': 1.0, 'time@10': 3.6095}:  40%|████      | 12/30 [00:32<00:41,  2.28s/it]{'epoch': 49, 'num_users': 6.6154, 'loss': 0.0155, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9361, 'compress@10': 1.0, 'time@10': 3.6095}:  43%|████▎     | 13/30 [00:32<00:36,  2.15s/it]{'epoch': 49, 'num_users': 6.3571, 'loss': 0.0158, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.9258, 'compress@10': 1.0, 'time@10': 3.3809}:  43%|████▎     | 13/30 [00:32<00:36,  2.15s/it]{'epoch': 49, 'num_users': 6.3571, 'loss': 0.0158, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.9258, 'compress@10': 1.0, 'time@10': 3.3809}:  47%|████▋     | 14/30 [00:32<00:26,  1.64s/it]{'epoch': 49, 'num_users': 6.2667, 'loss': 0.0158, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9271, 'compress@10': 1.0, 'time@10': 3.4922}:  47%|████▋     | 14/30 [00:35<00:26,  1.64s/it]{'epoch': 49, 'num_users': 6.2667, 'loss': 0.0158, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9271, 'compress@10': 1.0, 'time@10': 3.4922}:  50%|█████     | 15/30 [00:35<00:28,  1.92s/it]{'epoch': 49, 'num_users': 6.0625, 'loss': 0.0152, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.3312}:  50%|█████     | 15/30 [00:36<00:28,  1.92s/it]{'epoch': 49, 'num_users': 6.0625, 'loss': 0.0152, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.3312}:  53%|█████▎    | 16/30 [00:36<00:22,  1.63s/it]{'epoch': 49, 'num_users': 5.8235, 'loss': 0.0153, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9149, 'compress@10': 1.0, 'time@10': 3.173}:  53%|█████▎    | 16/30 [00:36<00:22,  1.63s/it] {'epoch': 49, 'num_users': 5.8235, 'loss': 0.0153, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9149, 'compress@10': 1.0, 'time@10': 3.173}:  57%|█████▋    | 17/30 [00:36<00:16,  1.25s/it]{'epoch': 49, 'num_users': 6.0556, 'loss': 0.0149, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.9164, 'compress@10': 1.0, 'time@10': 3.1249}:  57%|█████▋    | 17/30 [00:38<00:16,  1.25s/it]{'epoch': 49, 'num_users': 6.0556, 'loss': 0.0149, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.9164, 'compress@10': 1.0, 'time@10': 3.1249}:  60%|██████    | 18/30 [00:38<00:18,  1.58s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 0.0145, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9168, 'compress@10': 1.0, 'time@10': 3.0835}:  60%|██████    | 18/30 [00:39<00:18,  1.58s/it]   {'epoch': 49, 'num_users': 6.0, 'loss': 0.0145, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9168, 'compress@10': 1.0, 'time@10': 3.0835}:  63%|██████▎   | 19/30 [00:39<00:16,  1.47s/it]{'epoch': 49, 'num_users': 6.15, 'loss': 0.0148, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9199, 'compress@10': 1.0, 'time@10': 3.1724}:  63%|██████▎   | 19/30 [00:44<00:16,  1.47s/it]{'epoch': 49, 'num_users': 6.15, 'loss': 0.0148, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9199, 'compress@10': 1.0, 'time@10': 3.1724}:  67%|██████▋   | 20/30 [00:44<00:24,  2.50s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 3.3379}:  67%|██████▋   | 20/30 [00:48<00:24,  2.50s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 3.3379}:  70%|███████   | 21/30 [00:48<00:24,  2.76s/it]{'epoch': 49, 'num_users': 6.1818, 'loss': 0.0151, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 3.2611}:  70%|███████   | 21/30 [00:49<00:24,  2.76s/it]{'epoch': 49, 'num_users': 6.1818, 'loss': 0.0151, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 3.2611}:  73%|███████▎  | 22/30 [00:49<00:19,  2.43s/it]{'epoch': 49, 'num_users': 6.1304, 'loss': 0.0148, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9229, 'compress@10': 1.0, 'time@10': 3.2463}:  73%|███████▎  | 22/30 [00:51<00:19,  2.43s/it]{'epoch': 49, 'num_users': 6.1304, 'loss': 0.0148, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9229, 'compress@10': 1.0, 'time@10': 3.2463}:  77%|███████▋  | 23/30 [00:51<00:15,  2.15s/it]{'epoch': 49, 'num_users': 5.9583, 'loss': 0.0156, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.9121, 'compress@10': 1.0, 'time@10': 3.1251}:  77%|███████▋  | 23/30 [00:51<00:15,  2.15s/it]{'epoch': 49, 'num_users': 5.9583, 'loss': 0.0156, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.9121, 'compress@10': 1.0, 'time@10': 3.1251}:  80%|████████  | 24/30 [00:51<00:09,  1.62s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8965, 'compress@10': 1.0, 'time@10': 3.0161}:  80%|████████  | 24/30 [00:52<00:09,  1.62s/it]   {'epoch': 49, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8965, 'compress@10': 1.0, 'time@10': 3.0161}:  83%|████████▎ | 25/30 [00:52<00:06,  1.21s/it]{'epoch': 49, 'num_users': 5.8077, 'loss': 0.0166, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 3.1631}:  83%|████████▎ | 25/30 [00:58<00:06,  1.21s/it]{'epoch': 49, 'num_users': 5.8077, 'loss': 0.0166, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 3.1631}:  87%|████████▋ | 26/30 [00:58<00:11,  2.91s/it]{'epoch': 49, 'num_users': 5.8889, 'loss': 0.017, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 3.2208}:  87%|████████▋ | 26/30 [01:01<00:11,  2.91s/it] {'epoch': 49, 'num_users': 5.8889, 'loss': 0.017, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 3.2208}:  90%|█████████ | 27/30 [01:01<00:08,  2.76s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 0.017, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9083, 'compress@10': 1.0, 'time@10': 3.2597}:  90%|█████████ | 27/30 [01:05<00:08,  2.76s/it]   {'epoch': 49, 'num_users': 6.0, 'loss': 0.017, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9083, 'compress@10': 1.0, 'time@10': 3.2597}:  93%|█████████▎| 28/30 [01:05<00:06,  3.23s/it]{'epoch': 49, 'num_users': 5.8621, 'loss': 0.0167, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 3.2682}:  93%|█████████▎| 28/30 [01:07<00:06,  3.23s/it]{'epoch': 49, 'num_users': 5.8621, 'loss': 0.0167, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 3.2682}:  97%|█████████▋| 29/30 [01:07<00:02,  2.80s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0166, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9114, 'compress@10': 1.0, 'time@10': 3.2591}:  97%|█████████▋| 29/30 [01:10<00:02,  2.80s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0166, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9114, 'compress@10': 1.0, 'time@10': 3.2591}: 100%|██████████| 30/30 [01:10<00:00,  2.87s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0166, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9114, 'compress@10': 1.0, 'time@10': 3.2591}: 100%|██████████| 30/30 [01:10<00:00,  2.35s/it]
Epoch: 49
Avg # of users: 5.866666666666666
Avg Loss: 0.016622544753760522
Avg hit ratio: 0.8764668196822689
Avg ndcg: 0.9114396417649862
Avg compression ratio: 0.9999999860153537
Avg train time: 3.259125487009684
Std train time: 2.0228312843577316
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
