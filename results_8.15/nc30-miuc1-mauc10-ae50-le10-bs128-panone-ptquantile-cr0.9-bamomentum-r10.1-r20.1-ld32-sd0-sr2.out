  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1361, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5263, 'compress@10': 0.9052, 'time@10': 9.5787}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1361, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5263, 'compress@10': 0.9052, 'time@10': 9.5787}:   3%|▎         | 1/30 [00:04<02:20,  4.83s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1003, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.6774, 'compress@10': 0.9042, 'time@10': 8.5203}:   3%|▎         | 1/30 [00:12<02:20,  4.83s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1003, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.6774, 'compress@10': 0.9042, 'time@10': 8.5203}:   7%|▋         | 2/30 [00:12<02:59,  6.40s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6411, 'hit_ratio@10': 0.6415, 'ndcg@10': 0.4688, 'compress@10': 0.9076, 'time@10': 6.6976}:   7%|▋         | 2/30 [00:13<02:59,  6.40s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6411, 'hit_ratio@10': 0.6415, 'ndcg@10': 0.4688, 'compress@10': 0.9076, 'time@10': 6.6976}:  10%|█         | 3/30 [00:13<01:53,  4.19s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.4996, 'hit_ratio@10': 0.6954, 'ndcg@10': 0.5388, 'compress@10': 0.9066, 'time@10': 6.6133}:  10%|█         | 3/30 [00:20<01:53,  4.19s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.4996, 'hit_ratio@10': 0.6954, 'ndcg@10': 0.5388, 'compress@10': 0.9066, 'time@10': 6.6133}:  13%|█▎        | 4/30 [00:20<02:11,  5.06s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4181, 'hit_ratio@10': 0.7203, 'ndcg@10': 0.5845, 'compress@10': 0.9057, 'time@10': 9.9698}:  13%|█▎        | 4/30 [00:32<02:11,  5.06s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4181, 'hit_ratio@10': 0.7203, 'ndcg@10': 0.5845, 'compress@10': 0.9057, 'time@10': 9.9698}:  17%|█▋        | 5/30 [00:32<03:06,  7.47s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.3626, 'hit_ratio@10': 0.7114, 'ndcg@10': 0.623, 'compress@10': 0.9051, 'time@10': 10.1639}:  17%|█▋        | 5/30 [00:43<03:06,  7.47s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.3626, 'hit_ratio@10': 0.7114, 'ndcg@10': 0.623, 'compress@10': 0.9051, 'time@10': 10.1639}:  20%|██        | 6/30 [00:43<03:29,  8.73s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3228, 'hit_ratio@10': 0.7241, 'ndcg@10': 0.6244, 'compress@10': 0.9049, 'time@10': 10.4127}:  20%|██        | 6/30 [00:49<03:29,  8.73s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3228, 'hit_ratio@10': 0.7241, 'ndcg@10': 0.6244, 'compress@10': 0.9049, 'time@10': 10.4127}:  23%|██▎       | 7/30 [00:49<03:00,  7.83s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.2878, 'hit_ratio@10': 0.7478, 'ndcg@10': 0.6484, 'compress@10': 0.9047, 'time@10': 10.1353}:  23%|██▎       | 7/30 [00:57<03:00,  7.83s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.2878, 'hit_ratio@10': 0.7478, 'ndcg@10': 0.6484, 'compress@10': 0.9047, 'time@10': 10.1353}:  27%|██▋       | 8/30 [00:57<02:55,  7.96s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2606, 'hit_ratio@10': 0.7505, 'ndcg@10': 0.6777, 'compress@10': 0.9045, 'time@10': 10.9392}:  27%|██▋       | 8/30 [01:06<02:55,  7.96s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2606, 'hit_ratio@10': 0.7505, 'ndcg@10': 0.6777, 'compress@10': 0.9045, 'time@10': 10.9392}:  30%|███       | 9/30 [01:06<02:52,  8.20s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2396, 'hit_ratio@10': 0.7686, 'ndcg@10': 0.6951, 'compress@10': 0.9042, 'time@10': 10.8585}:  30%|███       | 9/30 [01:16<02:52,  8.20s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2396, 'hit_ratio@10': 0.7686, 'ndcg@10': 0.6951, 'compress@10': 0.9042, 'time@10': 10.8585}:  33%|███▎      | 10/30 [01:16<02:56,  8.81s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.2279, 'hit_ratio@10': 0.7652, 'ndcg@10': 0.6976, 'compress@10': 0.9042, 'time@10': 10.9803}:  33%|███▎      | 10/30 [01:22<02:56,  8.81s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.2279, 'hit_ratio@10': 0.7652, 'ndcg@10': 0.6976, 'compress@10': 0.9042, 'time@10': 10.9803}:  37%|███▋      | 11/30 [01:22<02:31,  7.99s/it]{'epoch': 0, 'num_users': 6.4167, 'loss': 0.2607, 'hit_ratio@10': 0.75, 'ndcg@10': 0.6549, 'compress@10': 0.9045, 'time@10': 10.2962}:  37%|███▋      | 11/30 [01:25<02:31,  7.99s/it]  {'epoch': 0, 'num_users': 6.4167, 'loss': 0.2607, 'hit_ratio@10': 0.75, 'ndcg@10': 0.6549, 'compress@10': 0.9045, 'time@10': 10.2962}:  40%|████      | 12/30 [01:25<01:55,  6.41s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.2501, 'hit_ratio@10': 0.7483, 'ndcg@10': 0.6555, 'compress@10': 0.9045, 'time@10': 10.313}:  40%|████      | 12/30 [01:30<01:55,  6.41s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.2501, 'hit_ratio@10': 0.7483, 'ndcg@10': 0.6555, 'compress@10': 0.9045, 'time@10': 10.313}:  43%|████▎     | 13/30 [01:30<01:43,  6.07s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.4051, 'hit_ratio@10': 0.7305, 'ndcg@10': 0.6089, 'compress@10': 0.9054, 'time@10': 9.6662}:  43%|████▎     | 13/30 [01:31<01:43,  6.07s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.4051, 'hit_ratio@10': 0.7305, 'ndcg@10': 0.6089, 'compress@10': 0.9054, 'time@10': 9.6662}:  47%|████▋     | 14/30 [01:31<01:14,  4.63s/it]{'epoch': 0, 'num_users': 6.2667, 'loss': 0.3825, 'hit_ratio@10': 0.7442, 'ndcg@10': 0.6201, 'compress@10': 0.9053, 'time@10': 9.9568}:  47%|████▋     | 14/30 [01:38<01:14,  4.63s/it]{'epoch': 0, 'num_users': 6.2667, 'loss': 0.3825, 'hit_ratio@10': 0.7442, 'ndcg@10': 0.6201, 'compress@10': 0.9053, 'time@10': 9.9568}:  50%|█████     | 15/30 [01:38<01:20,  5.36s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.3957, 'hit_ratio@10': 0.7185, 'ndcg@10': 0.5925, 'compress@10': 0.9055, 'time@10': 9.5052}:  50%|█████     | 15/30 [01:41<01:20,  5.36s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.3957, 'hit_ratio@10': 0.7185, 'ndcg@10': 0.5925, 'compress@10': 0.9055, 'time@10': 9.5052}:  53%|█████▎    | 16/30 [01:41<01:04,  4.58s/it]{'epoch': 0, 'num_users': 5.8235, 'loss': 0.4942, 'hit_ratio@10': 0.688, 'ndcg@10': 0.5576, 'compress@10': 0.9063, 'time@10': 9.0607}:  53%|█████▎    | 16/30 [01:42<01:04,  4.58s/it] {'epoch': 0, 'num_users': 5.8235, 'loss': 0.4942, 'hit_ratio@10': 0.688, 'ndcg@10': 0.5576, 'compress@10': 0.9063, 'time@10': 9.0607}:  57%|█████▋    | 17/30 [01:42<00:45,  3.51s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 0.4718, 'hit_ratio@10': 0.6915, 'ndcg@10': 0.5697, 'compress@10': 0.9062, 'time@10': 8.9431}:  57%|█████▋    | 17/30 [01:49<00:45,  3.51s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 0.4718, 'hit_ratio@10': 0.6915, 'ndcg@10': 0.5697, 'compress@10': 0.9062, 'time@10': 8.9431}:  60%|██████    | 18/30 [01:49<00:54,  4.55s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.4582, 'hit_ratio@10': 0.6889, 'ndcg@10': 0.5646, 'compress@10': 0.9062, 'time@10': 8.816}:  60%|██████    | 18/30 [01:52<00:54,  4.55s/it]    {'epoch': 0, 'num_users': 6.0, 'loss': 0.4582, 'hit_ratio@10': 0.6889, 'ndcg@10': 0.5646, 'compress@10': 0.9062, 'time@10': 8.816}:  63%|██████▎   | 19/30 [01:52<00:45,  4.18s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.4388, 'hit_ratio@10': 0.6966, 'ndcg@10': 0.576, 'compress@10': 0.906, 'time@10': 9.0722}:  63%|██████▎   | 19/30 [02:06<00:45,  4.18s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.4388, 'hit_ratio@10': 0.6966, 'ndcg@10': 0.576, 'compress@10': 0.906, 'time@10': 9.0722}:  67%|██████▋   | 20/30 [02:06<01:11,  7.12s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.4218, 'hit_ratio@10': 0.7015, 'ndcg@10': 0.5868, 'compress@10': 0.9058, 'time@10': 9.5986}:  67%|██████▋   | 20/30 [02:17<01:11,  7.12s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.4218, 'hit_ratio@10': 0.7015, 'ndcg@10': 0.5868, 'compress@10': 0.9058, 'time@10': 9.5986}:  70%|███████   | 21/30 [02:17<01:12,  8.03s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 0.4094, 'hit_ratio@10': 0.7068, 'ndcg@10': 0.5851, 'compress@10': 0.9058, 'time@10': 9.474}:  70%|███████   | 21/30 [02:23<01:12,  8.03s/it] {'epoch': 0, 'num_users': 6.1818, 'loss': 0.4094, 'hit_ratio@10': 0.7068, 'ndcg@10': 0.5851, 'compress@10': 0.9058, 'time@10': 9.474}:  73%|███████▎  | 22/30 [02:23<01:01,  7.69s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 0.3961, 'hit_ratio@10': 0.713, 'ndcg@10': 0.5831, 'compress@10': 0.9057, 'time@10': 9.4496}:  73%|███████▎  | 22/30 [02:28<01:01,  7.69s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 0.3961, 'hit_ratio@10': 0.713, 'ndcg@10': 0.5831, 'compress@10': 0.9057, 'time@10': 9.4496}:  77%|███████▋  | 23/30 [02:28<00:47,  6.73s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.471, 'hit_ratio@10': 0.6833, 'ndcg@10': 0.5588, 'compress@10': 0.9063, 'time@10': 9.0989}:  77%|███████▋  | 23/30 [02:29<00:47,  6.73s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.471, 'hit_ratio@10': 0.6833, 'ndcg@10': 0.5588, 'compress@10': 0.9063, 'time@10': 9.0989}:  80%|████████  | 24/30 [02:29<00:30,  5.03s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5276, 'hit_ratio@10': 0.656, 'ndcg@10': 0.5365, 'compress@10': 0.9074, 'time@10': 8.778}:  80%|████████  | 24/30 [02:30<00:30,  5.03s/it]    {'epoch': 0, 'num_users': 5.8, 'loss': 0.5276, 'hit_ratio@10': 0.656, 'ndcg@10': 0.5365, 'compress@10': 0.9074, 'time@10': 8.778}:  83%|████████▎ | 25/30 [02:30<00:18,  3.69s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.5109, 'hit_ratio@10': 0.6631, 'ndcg@10': 0.5451, 'compress@10': 0.9072, 'time@10': 9.2483}:  83%|████████▎ | 25/30 [02:51<00:18,  3.69s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.5109, 'hit_ratio@10': 0.6631, 'ndcg@10': 0.5451, 'compress@10': 0.9072, 'time@10': 9.2483}:  87%|████████▋ | 26/30 [02:51<00:35,  8.90s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 0.494, 'hit_ratio@10': 0.6716, 'ndcg@10': 0.553, 'compress@10': 0.907, 'time@10': 9.4144}:  87%|████████▋ | 26/30 [02:58<00:35,  8.90s/it]   {'epoch': 0, 'num_users': 5.8889, 'loss': 0.494, 'hit_ratio@10': 0.6716, 'ndcg@10': 0.553, 'compress@10': 0.907, 'time@10': 9.4144}:  90%|█████████ | 27/30 [02:58<00:24,  8.30s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.4784, 'hit_ratio@10': 0.677, 'ndcg@10': 0.5646, 'compress@10': 0.9068, 'time@10': 9.5423}:  90%|█████████ | 27/30 [03:11<00:24,  8.30s/it] {'epoch': 0, 'num_users': 6.0, 'loss': 0.4784, 'hit_ratio@10': 0.677, 'ndcg@10': 0.5646, 'compress@10': 0.9068, 'time@10': 9.5423}:  93%|█████████▎| 28/30 [03:11<00:19,  9.72s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.4652, 'hit_ratio@10': 0.6835, 'ndcg@10': 0.5645, 'compress@10': 0.9068, 'time@10': 9.5559}:  93%|█████████▎| 28/30 [03:16<00:19,  9.72s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.4652, 'hit_ratio@10': 0.6835, 'ndcg@10': 0.5645, 'compress@10': 0.9068, 'time@10': 9.5559}:  97%|█████████▋| 29/30 [03:16<00:08,  8.30s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.4512, 'hit_ratio@10': 0.6868, 'ndcg@10': 0.5761, 'compress@10': 0.9066, 'time@10': 9.5251}:  97%|█████████▋| 29/30 [03:24<00:08,  8.30s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.4512, 'hit_ratio@10': 0.6868, 'ndcg@10': 0.5761, 'compress@10': 0.9066, 'time@10': 9.5251}: 100%|██████████| 30/30 [03:24<00:00,  8.41s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.4512, 'hit_ratio@10': 0.6868, 'ndcg@10': 0.5761, 'compress@10': 0.9066, 'time@10': 9.5251}: 100%|██████████| 30/30 [03:24<00:00,  6.83s/it]
Epoch: 0
Avg # of users: 5.866666666666666
Avg Loss: 0.4512156400605509
Avg hit ratio: 0.6868172772042691
Avg ndcg: 0.5761036465601606
Avg compression ratio: 0.9066299342124471
Avg train time: 9.525105174382528
Std train time: 5.852228911402978
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10, 10, 11, 10, 11, 10, 11, 11, 10, 10, 10, 9, 10, 10, 11, 11, 9, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0536, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8382, 'compress@10': 0.9052, 'time@10': 9.6258}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0536, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8382, 'compress@10': 0.9052, 'time@10': 9.6258}:   3%|▎         | 1/30 [00:04<02:20,  4.85s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0532, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8471, 'compress@10': 0.9042, 'time@10': 8.7317}:   3%|▎         | 1/30 [00:12<02:20,  4.85s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0532, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8471, 'compress@10': 0.9042, 'time@10': 8.7317}:   7%|▋         | 2/30 [00:12<03:05,  6.64s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0407, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.8295, 'compress@10': 0.9076, 'time@10': 6.8841}:   7%|▋         | 2/30 [00:14<03:05,  6.64s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0407, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.8295, 'compress@10': 0.9076, 'time@10': 6.8841}:  10%|█         | 3/30 [00:14<01:57,  4.35s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.043, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8328, 'compress@10': 0.9066, 'time@10': 6.7907}:  10%|█         | 3/30 [00:20<01:57,  4.35s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.043, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8328, 'compress@10': 0.9066, 'time@10': 6.7907}:  13%|█▎        | 4/30 [00:20<02:15,  5.22s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.052, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8231, 'compress@10': 0.9057, 'time@10': 9.5944}:  13%|█▎        | 4/30 [00:31<02:15,  5.22s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.052, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8231, 'compress@10': 0.9057, 'time@10': 9.5944}:  17%|█▋        | 5/30 [00:31<02:57,  7.10s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0563, 'hit_ratio@10': 0.7856, 'ndcg@10': 0.8218, 'compress@10': 0.9051, 'time@10': 9.8427}:  17%|█▋        | 5/30 [00:42<02:57,  7.10s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0563, 'hit_ratio@10': 0.7856, 'ndcg@10': 0.8218, 'compress@10': 0.9051, 'time@10': 9.8427}:  20%|██        | 6/30 [00:42<03:23,  8.47s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0543, 'hit_ratio@10': 0.8105, 'ndcg@10': 0.8291, 'compress@10': 0.9049, 'time@10': 10.1449}:  20%|██        | 6/30 [00:48<03:23,  8.47s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0543, 'hit_ratio@10': 0.8105, 'ndcg@10': 0.8291, 'compress@10': 0.9049, 'time@10': 10.1449}:  23%|██▎       | 7/30 [00:48<02:56,  7.67s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0522, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.834, 'compress@10': 0.9047, 'time@10': 9.9607}:  23%|██▎       | 7/30 [00:57<02:56,  7.67s/it]   {'epoch': 1, 'num_users': 6.125, 'loss': 0.0522, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.834, 'compress@10': 0.9047, 'time@10': 9.9607}:  27%|██▋       | 8/30 [00:57<02:55,  8.00s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0503, 'hit_ratio@10': 0.8082, 'ndcg@10': 0.8425, 'compress@10': 0.9045, 'time@10': 10.7706}:  27%|██▋       | 8/30 [01:05<02:55,  8.00s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0503, 'hit_ratio@10': 0.8082, 'ndcg@10': 0.8425, 'compress@10': 0.9045, 'time@10': 10.7706}:  30%|███       | 9/30 [01:05<02:52,  8.21s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.8431, 'compress@10': 0.9042, 'time@10': 10.9698}:  30%|███       | 9/30 [01:18<02:52,  8.21s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.8431, 'compress@10': 0.9042, 'time@10': 10.9698}:  33%|███▎      | 10/30 [01:18<03:12,  9.63s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.0514, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8447, 'compress@10': 0.9042, 'time@10': 11.1261}:  33%|███▎      | 10/30 [01:25<03:12,  9.63s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.0514, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8447, 'compress@10': 0.9042, 'time@10': 11.1261}:  37%|███▋      | 11/30 [01:25<02:44,  8.63s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.0494, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.8496, 'compress@10': 0.9045, 'time@10': 10.4502}:  37%|███▋      | 11/30 [01:28<02:44,  8.63s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.0494, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.8496, 'compress@10': 0.9045, 'time@10': 10.4502}:  40%|████      | 12/30 [01:28<02:04,  6.94s/it]{'epoch': 1, 'num_users': 6.6154, 'loss': 0.0497, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8521, 'compress@10': 0.9045, 'time@10': 10.4442}:  40%|████      | 12/30 [01:33<02:04,  6.94s/it] {'epoch': 1, 'num_users': 6.6154, 'loss': 0.0497, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8521, 'compress@10': 0.9045, 'time@10': 10.4442}:  43%|████▎     | 13/30 [01:33<01:49,  6.42s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.0534, 'hit_ratio@10': 0.8007, 'ndcg@10': 0.8389, 'compress@10': 0.9054, 'time@10': 9.7944}:  43%|████▎     | 13/30 [01:34<01:49,  6.42s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.0534, 'hit_ratio@10': 0.8007, 'ndcg@10': 0.8389, 'compress@10': 0.9054, 'time@10': 9.7944}:  47%|████▋     | 14/30 [01:34<01:18,  4.90s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.0536, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8415, 'compress@10': 0.9053, 'time@10': 10.0964}:  47%|████▋     | 14/30 [01:41<01:18,  4.90s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.0536, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8415, 'compress@10': 0.9053, 'time@10': 10.0964}:  50%|█████     | 15/30 [01:41<01:23,  5.59s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.0516, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8426, 'compress@10': 0.9055, 'time@10': 9.652}:  50%|█████     | 15/30 [01:44<01:23,  5.59s/it]  {'epoch': 1, 'num_users': 6.0625, 'loss': 0.0516, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8426, 'compress@10': 0.9055, 'time@10': 9.652}:  53%|█████▎    | 16/30 [01:44<01:07,  4.82s/it]{'epoch': 1, 'num_users': 5.8235, 'loss': 0.0562, 'hit_ratio@10': 0.787, 'ndcg@10': 0.8205, 'compress@10': 0.9063, 'time@10': 9.2114}:  53%|█████▎    | 16/30 [01:46<01:07,  4.82s/it]{'epoch': 1, 'num_users': 5.8235, 'loss': 0.0562, 'hit_ratio@10': 0.787, 'ndcg@10': 0.8205, 'compress@10': 0.9063, 'time@10': 9.2114}:  57%|█████▋    | 17/30 [01:46<00:48,  3.70s/it]{'epoch': 1, 'num_users': 6.0556, 'loss': 0.0567, 'hit_ratio@10': 0.7849, 'ndcg@10': 0.8219, 'compress@10': 0.9062, 'time@10': 9.0784}:  57%|█████▋    | 17/30 [01:52<00:48,  3.70s/it]{'epoch': 1, 'num_users': 6.0556, 'loss': 0.0567, 'hit_ratio@10': 0.7849, 'ndcg@10': 0.8219, 'compress@10': 0.9062, 'time@10': 9.0784}:  60%|██████    | 18/30 [01:52<00:55,  4.65s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.0552, 'hit_ratio@10': 0.7887, 'ndcg@10': 0.8246, 'compress@10': 0.9062, 'time@10': 8.9417}:  60%|██████    | 18/30 [01:56<00:55,  4.65s/it]   {'epoch': 1, 'num_users': 6.0, 'loss': 0.0552, 'hit_ratio@10': 0.7887, 'ndcg@10': 0.8246, 'compress@10': 0.9062, 'time@10': 8.9417}:  63%|██████▎   | 19/30 [01:56<00:46,  4.24s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.0557, 'hit_ratio@10': 0.7923, 'ndcg@10': 0.8234, 'compress@10': 0.906, 'time@10': 9.187}:  63%|██████▎   | 19/30 [02:10<00:46,  4.24s/it] {'epoch': 1, 'num_users': 6.15, 'loss': 0.0557, 'hit_ratio@10': 0.7923, 'ndcg@10': 0.8234, 'compress@10': 0.906, 'time@10': 9.187}:  67%|██████▋   | 20/30 [02:10<01:11,  7.13s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0566, 'hit_ratio@10': 0.7926, 'ndcg@10': 0.8227, 'compress@10': 0.9058, 'time@10': 9.5485}:  67%|██████▋   | 20/30 [02:18<01:11,  7.13s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0566, 'hit_ratio@10': 0.7926, 'ndcg@10': 0.8227, 'compress@10': 0.9058, 'time@10': 9.5485}:  70%|███████   | 21/30 [02:18<01:07,  7.52s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.0558, 'hit_ratio@10': 0.7979, 'ndcg@10': 0.8259, 'compress@10': 0.9058, 'time@10': 9.3349}:  70%|███████   | 21/30 [02:23<01:07,  7.52s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.0558, 'hit_ratio@10': 0.7979, 'ndcg@10': 0.8259, 'compress@10': 0.9058, 'time@10': 9.3349}:  73%|███████▎  | 22/30 [02:23<00:53,  6.73s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.0545, 'hit_ratio@10': 0.8002, 'ndcg@10': 0.8293, 'compress@10': 0.9057, 'time@10': 9.3344}:  73%|███████▎  | 22/30 [02:28<00:53,  6.73s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.0545, 'hit_ratio@10': 0.8002, 'ndcg@10': 0.8293, 'compress@10': 0.9057, 'time@10': 9.3344}:  77%|███████▋  | 23/30 [02:28<00:42,  6.12s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.0578, 'hit_ratio@10': 0.7835, 'ndcg@10': 0.8158, 'compress@10': 0.9063, 'time@10': 8.9887}:  77%|███████▋  | 23/30 [02:29<00:42,  6.12s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.0578, 'hit_ratio@10': 0.7835, 'ndcg@10': 0.8158, 'compress@10': 0.9063, 'time@10': 8.9887}:  80%|████████  | 24/30 [02:29<00:27,  4.61s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0741, 'hit_ratio@10': 0.7655, 'ndcg@10': 0.7871, 'compress@10': 0.9074, 'time@10': 8.6725}:  80%|████████  | 24/30 [02:29<00:27,  4.61s/it]   {'epoch': 1, 'num_users': 5.8, 'loss': 0.0741, 'hit_ratio@10': 0.7655, 'ndcg@10': 0.7871, 'compress@10': 0.9074, 'time@10': 8.6725}:  83%|████████▎ | 25/30 [02:29<00:16,  3.40s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.0745, 'hit_ratio@10': 0.7689, 'ndcg@10': 0.7866, 'compress@10': 0.9072, 'time@10': 9.018}:  83%|████████▎ | 25/30 [02:47<00:16,  3.40s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.0745, 'hit_ratio@10': 0.7689, 'ndcg@10': 0.7866, 'compress@10': 0.9072, 'time@10': 9.018}:  87%|████████▋ | 26/30 [02:47<00:30,  7.69s/it]{'epoch': 1, 'num_users': 5.8889, 'loss': 0.0729, 'hit_ratio@10': 0.7761, 'ndcg@10': 0.7904, 'compress@10': 0.907, 'time@10': 9.1762}:  87%|████████▋ | 26/30 [02:54<00:30,  7.69s/it]{'epoch': 1, 'num_users': 5.8889, 'loss': 0.0729, 'hit_ratio@10': 0.7761, 'ndcg@10': 0.7904, 'compress@10': 0.907, 'time@10': 9.1762}:  90%|█████████ | 27/30 [02:54<00:22,  7.38s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.0723, 'hit_ratio@10': 0.7792, 'ndcg@10': 0.7934, 'compress@10': 0.9068, 'time@10': 9.2828}:  90%|█████████ | 27/30 [03:06<00:22,  7.38s/it]  {'epoch': 1, 'num_users': 6.0, 'loss': 0.0723, 'hit_ratio@10': 0.7792, 'ndcg@10': 0.7934, 'compress@10': 0.9068, 'time@10': 9.2828}:  93%|█████████▎| 28/30 [03:06<00:17,  8.83s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.0704, 'hit_ratio@10': 0.7837, 'ndcg@10': 0.7972, 'compress@10': 0.9068, 'time@10': 9.3046}:  93%|█████████▎| 28/30 [03:11<00:17,  8.83s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.0704, 'hit_ratio@10': 0.7837, 'ndcg@10': 0.7972, 'compress@10': 0.9068, 'time@10': 9.3046}:  97%|█████████▋| 29/30 [03:11<00:07,  7.68s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.0693, 'hit_ratio@10': 0.7837, 'ndcg@10': 0.8005, 'compress@10': 0.9066, 'time@10': 9.2814}:  97%|█████████▋| 29/30 [03:19<00:07,  7.68s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.0693, 'hit_ratio@10': 0.7837, 'ndcg@10': 0.8005, 'compress@10': 0.9066, 'time@10': 9.2814}: 100%|██████████| 30/30 [03:19<00:00,  7.98s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.0693, 'hit_ratio@10': 0.7837, 'ndcg@10': 0.8005, 'compress@10': 0.9066, 'time@10': 9.2814}: 100%|██████████| 30/30 [03:19<00:00,  6.67s/it]
Epoch: 1
Avg # of users: 5.866666666666666
Avg Loss: 0.0692911912175948
Avg hit ratio: 0.7837076323568761
Avg ndcg: 0.8004940857203133
Avg compression ratio: 0.9066299282939371
Avg train time: 9.281443166732789
Std train time: 5.285740892779715
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 12, 10, 8, 10, 10, 10, 8, 10, 10, 12, 10, 12, 9, 12, 12, 10, 10, 10, 8, 10, 10, 12, 12, 8, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.845, 'compress@10': 0.9052, 'time@10': 10.5035}:   0%|          | 0/30 [00:05<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.845, 'compress@10': 0.9052, 'time@10': 10.5035}:   3%|▎         | 1/30 [00:05<02:33,  5.31s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.7657, 'ndcg@10': 0.8476, 'compress@10': 0.9042, 'time@10': 9.5339}:   3%|▎         | 1/30 [00:13<02:33,  5.31s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.7657, 'ndcg@10': 0.8476, 'compress@10': 0.9042, 'time@10': 9.5339}:   7%|▋         | 2/30 [00:13<03:22,  7.25s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.7009, 'ndcg@10': 0.8508, 'compress@10': 0.9076, 'time@10': 7.6643}:   7%|▋         | 2/30 [00:15<03:22,  7.25s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.7009, 'ndcg@10': 0.8508, 'compress@10': 0.9076, 'time@10': 7.6643}:  10%|█         | 3/30 [00:15<02:11,  4.86s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.7489, 'ndcg@10': 0.8484, 'compress@10': 0.9066, 'time@10': 7.7268}:  10%|█         | 3/30 [00:23<02:11,  4.86s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.7489, 'ndcg@10': 0.8484, 'compress@10': 0.9066, 'time@10': 7.7268}:  13%|█▎        | 4/30 [00:23<02:38,  6.08s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0481, 'hit_ratio@10': 0.7631, 'ndcg@10': 0.8358, 'compress@10': 0.9057, 'time@10': 10.2854}:  13%|█▎        | 4/30 [00:34<02:38,  6.08s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0481, 'hit_ratio@10': 0.7631, 'ndcg@10': 0.8358, 'compress@10': 0.9057, 'time@10': 10.2854}:  17%|█▋        | 5/30 [00:34<03:10,  7.60s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0527, 'hit_ratio@10': 0.7582, 'ndcg@10': 0.8333, 'compress@10': 0.9051, 'time@10': 10.4204}:  17%|█▋        | 5/30 [00:45<03:10,  7.60s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0527, 'hit_ratio@10': 0.7582, 'ndcg@10': 0.8333, 'compress@10': 0.9051, 'time@10': 10.4204}:  20%|██        | 6/30 [00:45<03:31,  8.80s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0512, 'hit_ratio@10': 0.787, 'ndcg@10': 0.8362, 'compress@10': 0.9049, 'time@10': 10.6776}:  20%|██        | 6/30 [00:51<03:31,  8.80s/it] {'epoch': 2, 'num_users': 6.2857, 'loss': 0.0512, 'hit_ratio@10': 0.787, 'ndcg@10': 0.8362, 'compress@10': 0.9049, 'time@10': 10.6776}:  23%|██▎       | 7/30 [00:51<03:02,  7.93s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0519, 'hit_ratio@10': 0.8029, 'ndcg@10': 0.839, 'compress@10': 0.9047, 'time@10': 10.3725}:  23%|██▎       | 7/30 [00:59<03:02,  7.93s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0519, 'hit_ratio@10': 0.8029, 'ndcg@10': 0.839, 'compress@10': 0.9047, 'time@10': 10.3725}:  27%|██▋       | 8/30 [00:59<02:56,  8.04s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0509, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8502, 'compress@10': 0.9045, 'time@10': 10.7607}:  27%|██▋       | 8/30 [01:06<02:56,  8.04s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0509, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8502, 'compress@10': 0.9045, 'time@10': 10.7607}:  30%|███       | 9/30 [01:06<02:41,  7.71s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0503, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8507, 'compress@10': 0.9042, 'time@10': 10.7515}:  30%|███       | 9/30 [01:17<02:41,  7.71s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0503, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8507, 'compress@10': 0.9042, 'time@10': 10.7515}:  33%|███▎      | 10/30 [01:17<02:52,  8.63s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.0515, 'hit_ratio@10': 0.807, 'ndcg@10': 0.8521, 'compress@10': 0.9042, 'time@10': 10.9357}:  33%|███▎      | 10/30 [01:23<02:52,  8.63s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.0515, 'hit_ratio@10': 0.807, 'ndcg@10': 0.8521, 'compress@10': 0.9042, 'time@10': 10.9357}:  37%|███▋      | 11/30 [01:23<02:31,  7.96s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0487, 'hit_ratio@10': 0.7953, 'ndcg@10': 0.8582, 'compress@10': 0.9045, 'time@10': 10.3003}:  37%|███▋      | 11/30 [01:27<02:31,  7.96s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0487, 'hit_ratio@10': 0.7953, 'ndcg@10': 0.8582, 'compress@10': 0.9045, 'time@10': 10.3003}:  40%|████      | 12/30 [01:27<01:57,  6.55s/it]{'epoch': 2, 'num_users': 6.6154, 'loss': 0.0488, 'hit_ratio@10': 0.8006, 'ndcg@10': 0.8592, 'compress@10': 0.9045, 'time@10': 10.2964}:  40%|████      | 12/30 [01:32<01:57,  6.55s/it]{'epoch': 2, 'num_users': 6.6154, 'loss': 0.0488, 'hit_ratio@10': 0.8006, 'ndcg@10': 0.8592, 'compress@10': 0.9045, 'time@10': 10.2964}:  43%|████▎     | 13/30 [01:32<01:44,  6.13s/it]{'epoch': 2, 'num_users': 6.3571, 'loss': 0.0478, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8542, 'compress@10': 0.9054, 'time@10': 9.6696}:  43%|████▎     | 13/30 [01:33<01:44,  6.13s/it]  {'epoch': 2, 'num_users': 6.3571, 'loss': 0.0478, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8542, 'compress@10': 0.9054, 'time@10': 9.6696}:  47%|████▋     | 14/30 [01:33<01:15,  4.75s/it]{'epoch': 2, 'num_users': 6.2667, 'loss': 0.0486, 'hit_ratio@10': 0.8006, 'ndcg@10': 0.8551, 'compress@10': 0.9053, 'time@10': 9.8601}:  47%|████▋     | 14/30 [01:40<01:15,  4.75s/it]{'epoch': 2, 'num_users': 6.2667, 'loss': 0.0486, 'hit_ratio@10': 0.8006, 'ndcg@10': 0.8551, 'compress@10': 0.9053, 'time@10': 9.8601}:  50%|█████     | 15/30 [01:40<01:18,  5.22s/it]{'epoch': 2, 'num_users': 6.0625, 'loss': 0.0466, 'hit_ratio@10': 0.8079, 'ndcg@10': 0.8572, 'compress@10': 0.9055, 'time@10': 9.4521}:  50%|█████     | 15/30 [01:43<01:18,  5.22s/it]{'epoch': 2, 'num_users': 6.0625, 'loss': 0.0466, 'hit_ratio@10': 0.8079, 'ndcg@10': 0.8572, 'compress@10': 0.9055, 'time@10': 9.4521}:  53%|█████▎    | 16/30 [01:43<01:05,  4.66s/it]{'epoch': 2, 'num_users': 5.8235, 'loss': 0.046, 'hit_ratio@10': 0.7957, 'ndcg@10': 0.8436, 'compress@10': 0.9063, 'time@10': 9.032}:  53%|█████▎    | 16/30 [01:44<01:05,  4.66s/it]  {'epoch': 2, 'num_users': 5.8235, 'loss': 0.046, 'hit_ratio@10': 0.7957, 'ndcg@10': 0.8436, 'compress@10': 0.9063, 'time@10': 9.032}:  57%|█████▋    | 17/30 [01:44<00:47,  3.62s/it]{'epoch': 2, 'num_users': 6.0556, 'loss': 0.047, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8439, 'compress@10': 0.9062, 'time@10': 8.8958}:  57%|█████▋    | 17/30 [01:51<00:47,  3.62s/it]{'epoch': 2, 'num_users': 6.0556, 'loss': 0.047, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8439, 'compress@10': 0.9062, 'time@10': 8.8958}:  60%|██████    | 18/30 [01:51<00:54,  4.52s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.0455, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.8468, 'compress@10': 0.9062, 'time@10': 8.7531}:  60%|██████    | 18/30 [01:54<00:54,  4.52s/it]  {'epoch': 2, 'num_users': 6.0, 'loss': 0.0455, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.8468, 'compress@10': 0.9062, 'time@10': 8.7531}:  63%|██████▎   | 19/30 [01:54<00:45,  4.10s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.0463, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.8449, 'compress@10': 0.906, 'time@10': 9.0501}:  63%|██████▎   | 19/30 [02:09<00:45,  4.10s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.0463, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.8449, 'compress@10': 0.906, 'time@10': 9.0501}:  67%|██████▋   | 20/30 [02:09<01:13,  7.30s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0477, 'hit_ratio@10': 0.7993, 'ndcg@10': 0.8433, 'compress@10': 0.9058, 'time@10': 9.4135}:  67%|██████▋   | 20/30 [02:17<01:13,  7.30s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0477, 'hit_ratio@10': 0.7993, 'ndcg@10': 0.8433, 'compress@10': 0.9058, 'time@10': 9.4135}:  70%|███████   | 21/30 [02:17<01:08,  7.62s/it]{'epoch': 2, 'num_users': 6.1818, 'loss': 0.0472, 'hit_ratio@10': 0.8043, 'ndcg@10': 0.8458, 'compress@10': 0.9058, 'time@10': 9.2036}:  70%|███████   | 21/30 [02:22<01:08,  7.62s/it]{'epoch': 2, 'num_users': 6.1818, 'loss': 0.0472, 'hit_ratio@10': 0.8043, 'ndcg@10': 0.8458, 'compress@10': 0.9058, 'time@10': 9.2036}:  73%|███████▎  | 22/30 [02:22<00:54,  6.79s/it]{'epoch': 2, 'num_users': 6.1304, 'loss': 0.0462, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.8481, 'compress@10': 0.9057, 'time@10': 9.2093}:  73%|███████▎  | 22/30 [02:27<00:54,  6.79s/it]{'epoch': 2, 'num_users': 6.1304, 'loss': 0.0462, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.8481, 'compress@10': 0.9057, 'time@10': 9.2093}:  77%|███████▋  | 23/30 [02:27<00:43,  6.16s/it]{'epoch': 2, 'num_users': 5.9583, 'loss': 0.0469, 'hit_ratio@10': 0.806, 'ndcg@10': 0.8355, 'compress@10': 0.9063, 'time@10': 8.8755}:  77%|███████▋  | 23/30 [02:28<00:43,  6.16s/it] {'epoch': 2, 'num_users': 5.9583, 'loss': 0.0469, 'hit_ratio@10': 0.806, 'ndcg@10': 0.8355, 'compress@10': 0.9063, 'time@10': 8.8755}:  80%|████████  | 24/30 [02:28<00:28,  4.68s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0488, 'hit_ratio@10': 0.7871, 'ndcg@10': 0.818, 'compress@10': 0.9074, 'time@10': 8.5693}:  80%|████████  | 24/30 [02:29<00:28,  4.68s/it]   {'epoch': 2, 'num_users': 5.8, 'loss': 0.0488, 'hit_ratio@10': 0.7871, 'ndcg@10': 0.818, 'compress@10': 0.9074, 'time@10': 8.5693}:  83%|████████▎ | 25/30 [02:29<00:17,  3.47s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.05, 'hit_ratio@10': 0.7897, 'ndcg@10': 0.8166, 'compress@10': 0.9072, 'time@10': 8.85}:  83%|████████▎ | 25/30 [02:44<00:17,  3.47s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.05, 'hit_ratio@10': 0.7897, 'ndcg@10': 0.8166, 'compress@10': 0.9072, 'time@10': 8.85}:  87%|████████▋ | 26/30 [02:44<00:28,  7.20s/it]{'epoch': 2, 'num_users': 5.8889, 'loss': 0.0496, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.8185, 'compress@10': 0.907, 'time@10': 9.0336}:  87%|████████▋ | 26/30 [02:51<00:28,  7.20s/it]{'epoch': 2, 'num_users': 5.8889, 'loss': 0.0496, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.8185, 'compress@10': 0.907, 'time@10': 9.0336}:  90%|█████████ | 27/30 [02:51<00:21,  7.12s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.0498, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.8207, 'compress@10': 0.9068, 'time@10': 9.1458}:  90%|█████████ | 27/30 [03:04<00:21,  7.12s/it]  {'epoch': 2, 'num_users': 6.0, 'loss': 0.0498, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.8207, 'compress@10': 0.9068, 'time@10': 9.1458}:  93%|█████████▎| 28/30 [03:04<00:17,  8.65s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.0488, 'hit_ratio@10': 0.8004, 'ndcg@10': 0.823, 'compress@10': 0.9068, 'time@10': 9.1885}:  93%|█████████▎| 28/30 [03:09<00:17,  8.65s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.0488, 'hit_ratio@10': 0.8004, 'ndcg@10': 0.823, 'compress@10': 0.9068, 'time@10': 9.1885}:  97%|█████████▋| 29/30 [03:09<00:07,  7.62s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0486, 'hit_ratio@10': 0.7972, 'ndcg@10': 0.8254, 'compress@10': 0.9066, 'time@10': 9.1608}:  97%|█████████▋| 29/30 [03:17<00:07,  7.62s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0486, 'hit_ratio@10': 0.7972, 'ndcg@10': 0.8254, 'compress@10': 0.9066, 'time@10': 9.1608}: 100%|██████████| 30/30 [03:17<00:00,  7.85s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0486, 'hit_ratio@10': 0.7972, 'ndcg@10': 0.8254, 'compress@10': 0.9066, 'time@10': 9.1608}: 100%|██████████| 30/30 [03:17<00:00,  6.59s/it]
Epoch: 2
Avg # of users: 5.866666666666666
Avg Loss: 0.04860690460631293
Avg hit ratio: 0.797171709408739
Avg ndcg: 0.8253995698931035
Avg compression ratio: 0.9066299371260519
Avg train time: 9.16079831123352
Std train time: 4.911366203789887
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 13, 10, 7, 10, 10, 10, 8, 10, 10, 13, 10, 13, 9, 13, 13, 10, 10, 9, 7, 10, 10, 13, 13, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0479, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8541, 'compress@10': 0.9052, 'time@10': 10.3481}:   0%|          | 0/30 [00:05<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0479, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8541, 'compress@10': 0.9052, 'time@10': 10.3481}:   3%|▎         | 1/30 [00:05<02:31,  5.21s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0507, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8647, 'compress@10': 0.9042, 'time@10': 9.0395}:   3%|▎         | 1/30 [00:12<02:31,  5.21s/it]  {'epoch': 3, 'num_users': 7.0, 'loss': 0.0507, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8647, 'compress@10': 0.9042, 'time@10': 9.0395}:   7%|▋         | 2/30 [00:12<03:07,  6.71s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8622, 'compress@10': 0.9076, 'time@10': 7.475}:   7%|▋         | 2/30 [00:15<03:07,  6.71s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8622, 'compress@10': 0.9076, 'time@10': 7.475}:  10%|█         | 3/30 [00:15<02:05,  4.66s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0395, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8514, 'compress@10': 0.9066, 'time@10': 7.5427}:  10%|█         | 3/30 [00:23<02:05,  4.66s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0395, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8514, 'compress@10': 0.9066, 'time@10': 7.5427}:  13%|█▎        | 4/30 [00:23<02:33,  5.91s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0491, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.839, 'compress@10': 0.9057, 'time@10': 9.6867}:  13%|█▎        | 4/30 [00:32<02:33,  5.91s/it] {'epoch': 3, 'num_users': 5.8, 'loss': 0.0491, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.839, 'compress@10': 0.9057, 'time@10': 9.6867}:  17%|█▋        | 5/30 [00:32<02:57,  7.08s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0531, 'hit_ratio@10': 0.7987, 'ndcg@10': 0.8357, 'compress@10': 0.9051, 'time@10': 9.8949}:  17%|█▋        | 5/30 [00:43<02:57,  7.08s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0531, 'hit_ratio@10': 0.7987, 'ndcg@10': 0.8357, 'compress@10': 0.9051, 'time@10': 9.8949}:  20%|██        | 6/30 [00:43<03:21,  8.40s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0528, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8427, 'compress@10': 0.9049, 'time@10': 10.2439}:  20%|██        | 6/30 [00:49<03:21,  8.40s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0528, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8427, 'compress@10': 0.9049, 'time@10': 10.2439}:  23%|██▎       | 7/30 [00:49<02:56,  7.69s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0549, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8486, 'compress@10': 0.9047, 'time@10': 10.1877}:  23%|██▎       | 7/30 [00:59<02:56,  7.69s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0549, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8486, 'compress@10': 0.9047, 'time@10': 10.1877}:  27%|██▋       | 8/30 [00:59<03:04,  8.37s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0551, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8584, 'compress@10': 0.9045, 'time@10': 10.7909}:  27%|██▋       | 8/30 [01:07<03:04,  8.37s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0551, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8584, 'compress@10': 0.9045, 'time@10': 10.7909}:  30%|███       | 9/30 [01:07<02:52,  8.21s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0542, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8569, 'compress@10': 0.9042, 'time@10': 10.7776}:  30%|███       | 9/30 [01:17<02:52,  8.21s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0542, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8569, 'compress@10': 0.9042, 'time@10': 10.7776}:  33%|███▎      | 10/30 [01:17<02:59,  8.97s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.055, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8571, 'compress@10': 0.9042, 'time@10': 10.9679}:  33%|███▎      | 10/30 [01:24<02:59,  8.97s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.055, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8571, 'compress@10': 0.9042, 'time@10': 10.9679}:  37%|███▋      | 11/30 [01:24<02:35,  8.21s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.0518, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8617, 'compress@10': 0.9045, 'time@10': 10.3533}:  37%|███▋      | 11/30 [01:27<02:35,  8.21s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.0518, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8617, 'compress@10': 0.9045, 'time@10': 10.3533}:  40%|████      | 12/30 [01:27<02:02,  6.81s/it]{'epoch': 3, 'num_users': 6.6154, 'loss': 0.0525, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8638, 'compress@10': 0.9045, 'time@10': 10.3454}:  40%|████      | 12/30 [01:32<02:02,  6.81s/it]{'epoch': 3, 'num_users': 6.6154, 'loss': 0.0525, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8638, 'compress@10': 0.9045, 'time@10': 10.3454}:  43%|████▎     | 13/30 [01:32<01:47,  6.31s/it]{'epoch': 3, 'num_users': 6.3571, 'loss': 0.0501, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8593, 'compress@10': 0.9054, 'time@10': 9.7228}:  43%|████▎     | 13/30 [01:34<01:47,  6.31s/it] {'epoch': 3, 'num_users': 6.3571, 'loss': 0.0501, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8593, 'compress@10': 0.9054, 'time@10': 9.7228}:  47%|████▋     | 14/30 [01:34<01:18,  4.91s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.051, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8596, 'compress@10': 0.9053, 'time@10': 9.9053}:  47%|████▋     | 14/30 [01:40<01:18,  4.91s/it] {'epoch': 3, 'num_users': 6.2667, 'loss': 0.051, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8596, 'compress@10': 0.9053, 'time@10': 9.9053}:  50%|█████     | 15/30 [01:40<01:19,  5.32s/it]{'epoch': 3, 'num_users': 6.0625, 'loss': 0.0488, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8603, 'compress@10': 0.9055, 'time@10': 9.512}:  50%|█████     | 15/30 [01:44<01:19,  5.32s/it]{'epoch': 3, 'num_users': 6.0625, 'loss': 0.0488, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8603, 'compress@10': 0.9055, 'time@10': 9.512}:  53%|█████▎    | 16/30 [01:44<01:07,  4.82s/it]{'epoch': 3, 'num_users': 5.8235, 'loss': 0.0472, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8526, 'compress@10': 0.9063, 'time@10': 9.0988}:  53%|█████▎    | 16/30 [01:45<01:07,  4.82s/it]{'epoch': 3, 'num_users': 5.8235, 'loss': 0.0472, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8526, 'compress@10': 0.9063, 'time@10': 9.0988}:  57%|█████▋    | 17/30 [01:45<00:48,  3.75s/it]{'epoch': 3, 'num_users': 6.0556, 'loss': 0.048, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8531, 'compress@10': 0.9062, 'time@10': 8.9629}:  57%|█████▋    | 17/30 [01:52<00:48,  3.75s/it] {'epoch': 3, 'num_users': 6.0556, 'loss': 0.048, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8531, 'compress@10': 0.9062, 'time@10': 8.9629}:  60%|██████    | 18/30 [01:52<00:55,  4.63s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.0464, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8555, 'compress@10': 0.9062, 'time@10': 8.8186}:  60%|██████    | 18/30 [01:55<00:55,  4.63s/it]  {'epoch': 3, 'num_users': 6.0, 'loss': 0.0464, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8555, 'compress@10': 0.9062, 'time@10': 8.8186}:  63%|██████▎   | 19/30 [01:55<00:46,  4.19s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.0472, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8534, 'compress@10': 0.906, 'time@10': 8.9888}:  63%|██████▎   | 19/30 [02:07<00:46,  4.19s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.0472, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8534, 'compress@10': 0.906, 'time@10': 8.9888}:  67%|██████▋   | 20/30 [02:07<01:06,  6.61s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0486, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8512, 'compress@10': 0.9058, 'time@10': 9.1725}:  67%|██████▋   | 20/30 [02:14<01:06,  6.61s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0486, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8512, 'compress@10': 0.9058, 'time@10': 9.1725}:  70%|███████   | 21/30 [02:14<00:59,  6.57s/it]{'epoch': 3, 'num_users': 6.1818, 'loss': 0.0489, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8517, 'compress@10': 0.9058, 'time@10': 8.9702}:  70%|███████   | 21/30 [02:19<00:59,  6.57s/it]{'epoch': 3, 'num_users': 6.1818, 'loss': 0.0489, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8517, 'compress@10': 0.9058, 'time@10': 8.9702}:  73%|███████▎  | 22/30 [02:19<00:48,  6.02s/it]{'epoch': 3, 'num_users': 6.1304, 'loss': 0.0481, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8537, 'compress@10': 0.9057, 'time@10': 8.9843}:  73%|███████▎  | 22/30 [02:23<00:48,  6.02s/it]{'epoch': 3, 'num_users': 6.1304, 'loss': 0.0481, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8537, 'compress@10': 0.9057, 'time@10': 8.9843}:  77%|███████▋  | 23/30 [02:23<00:39,  5.62s/it]{'epoch': 3, 'num_users': 5.9583, 'loss': 0.0481, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8463, 'compress@10': 0.9063, 'time@10': 8.6637}:  77%|███████▋  | 23/30 [02:25<00:39,  5.62s/it]{'epoch': 3, 'num_users': 5.9583, 'loss': 0.0481, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8463, 'compress@10': 0.9063, 'time@10': 8.6637}:  80%|████████  | 24/30 [02:25<00:25,  4.33s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0479, 'hit_ratio@10': 0.8039, 'ndcg@10': 0.8309, 'compress@10': 0.9074, 'time@10': 8.3682}:  80%|████████  | 24/30 [02:25<00:25,  4.33s/it]   {'epoch': 3, 'num_users': 5.8, 'loss': 0.0479, 'hit_ratio@10': 0.8039, 'ndcg@10': 0.8309, 'compress@10': 0.9074, 'time@10': 8.3682}:  83%|████████▎ | 25/30 [02:25<00:16,  3.23s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.0491, 'hit_ratio@10': 0.8058, 'ndcg@10': 0.829, 'compress@10': 0.9072, 'time@10': 8.5723}:  83%|████████▎ | 25/30 [02:39<00:16,  3.23s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.0491, 'hit_ratio@10': 0.8058, 'ndcg@10': 0.829, 'compress@10': 0.9072, 'time@10': 8.5723}:  87%|████████▋ | 26/30 [02:39<00:25,  6.38s/it]{'epoch': 3, 'num_users': 5.8889, 'loss': 0.0494, 'hit_ratio@10': 0.809, 'ndcg@10': 0.8299, 'compress@10': 0.907, 'time@10': 8.7577}:  87%|████████▋ | 26/30 [02:46<00:25,  6.38s/it] {'epoch': 3, 'num_users': 5.8889, 'loss': 0.0494, 'hit_ratio@10': 0.809, 'ndcg@10': 0.8299, 'compress@10': 0.907, 'time@10': 8.7577}:  90%|█████████ | 27/30 [02:46<00:19,  6.51s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.0495, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8319, 'compress@10': 0.9068, 'time@10': 8.8794}:  90%|█████████ | 27/30 [02:58<00:19,  6.51s/it]  {'epoch': 3, 'num_users': 6.0, 'loss': 0.0495, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8319, 'compress@10': 0.9068, 'time@10': 8.8794}:  93%|█████████▎| 28/30 [02:58<00:16,  8.22s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.0489, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.8338, 'compress@10': 0.9068, 'time@10': 8.9454}:  93%|█████████▎| 28/30 [03:04<00:16,  8.22s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.0489, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.8338, 'compress@10': 0.9068, 'time@10': 8.9454}:  97%|█████████▋| 29/30 [03:04<00:07,  7.38s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.049, 'hit_ratio@10': 0.8115, 'ndcg@10': 0.8354, 'compress@10': 0.9066, 'time@10': 9.0024}:  97%|█████████▋| 29/30 [03:14<00:07,  7.38s/it] {'epoch': 3, 'num_users': 5.8667, 'loss': 0.049, 'hit_ratio@10': 0.8115, 'ndcg@10': 0.8354, 'compress@10': 0.9066, 'time@10': 9.0024}: 100%|██████████| 30/30 [03:14<00:00,  8.38s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.049, 'hit_ratio@10': 0.8115, 'ndcg@10': 0.8354, 'compress@10': 0.9066, 'time@10': 9.0024}: 100%|██████████| 30/30 [03:14<00:00,  6.49s/it]
Epoch: 3
Avg # of users: 5.866666666666666
Avg Loss: 0.04898602063718305
Avg hit ratio: 0.8115155035959868
Avg ndcg: 0.8354071412778341
Avg compression ratio: 0.9066299205376055
Avg train time: 9.002366479237875
Std train time: 4.444903159416575
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 14, 10, 6, 10, 10, 10, 7, 10, 10, 14, 10, 14, 9, 14, 14, 10, 10, 9, 7, 11, 10, 14, 14, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0494, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8589, 'compress@10': 0.9052, 'time@10': 10.3526}:   0%|          | 0/30 [00:05<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0494, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8589, 'compress@10': 0.9052, 'time@10': 10.3526}:   3%|▎         | 1/30 [00:05<02:31,  5.21s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0521, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8656, 'compress@10': 0.9042, 'time@10': 8.9996}:   3%|▎         | 1/30 [00:12<02:31,  5.21s/it]  {'epoch': 4, 'num_users': 7.0, 'loss': 0.0521, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8656, 'compress@10': 0.9042, 'time@10': 8.9996}:   7%|▋         | 2/30 [00:12<03:06,  6.67s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8628, 'compress@10': 0.9076, 'time@10': 7.571}:   7%|▋         | 2/30 [00:15<03:06,  6.67s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8628, 'compress@10': 0.9076, 'time@10': 7.571}:  10%|█         | 3/30 [00:15<02:07,  4.73s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0402, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8523, 'compress@10': 0.9066, 'time@10': 7.4244}:  10%|█         | 3/30 [00:22<02:07,  4.73s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0402, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8523, 'compress@10': 0.9066, 'time@10': 7.4244}:  13%|█▎        | 4/30 [00:22<02:26,  5.63s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0499, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.839, 'compress@10': 0.9057, 'time@10': 9.1702}:  13%|█▎        | 4/30 [00:30<02:26,  5.63s/it] {'epoch': 4, 'num_users': 5.8, 'loss': 0.0499, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.839, 'compress@10': 0.9057, 'time@10': 9.1702}:  17%|█▋        | 5/30 [00:30<02:43,  6.54s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0534, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8357, 'compress@10': 0.9051, 'time@10': 9.3696}:  17%|█▋        | 5/30 [00:40<02:43,  6.54s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0534, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8357, 'compress@10': 0.9051, 'time@10': 9.3696}:  20%|██        | 6/30 [00:40<03:08,  7.85s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0536, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8392, 'compress@10': 0.9049, 'time@10': 9.7294}:  20%|██        | 6/30 [00:46<03:08,  7.85s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0536, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8392, 'compress@10': 0.9049, 'time@10': 9.7294}:  23%|██▎       | 7/30 [00:46<02:46,  7.24s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.055, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8527, 'compress@10': 0.9047, 'time@10': 9.5532}:  23%|██▎       | 7/30 [00:55<02:46,  7.24s/it]  {'epoch': 4, 'num_users': 6.125, 'loss': 0.055, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8527, 'compress@10': 0.9047, 'time@10': 9.5532}:  27%|██▋       | 8/30 [00:55<02:47,  7.60s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0537, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8602, 'compress@10': 0.9045, 'time@10': 9.819}:  27%|██▋       | 8/30 [01:01<02:47,  7.60s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0537, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8602, 'compress@10': 0.9045, 'time@10': 9.819}:  30%|███       | 9/30 [01:01<02:29,  7.10s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0531, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8585, 'compress@10': 0.9042, 'time@10': 9.911}:  30%|███       | 9/30 [01:12<02:29,  7.10s/it]  {'epoch': 4, 'num_users': 6.3, 'loss': 0.0531, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8585, 'compress@10': 0.9042, 'time@10': 9.911}:  33%|███▎      | 10/30 [01:12<02:44,  8.23s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.0539, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8599, 'compress@10': 0.9042, 'time@10': 10.187}:  33%|███▎      | 10/30 [01:18<02:44,  8.23s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.0539, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8599, 'compress@10': 0.9042, 'time@10': 10.187}:  37%|███▋      | 11/30 [01:18<02:26,  7.71s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0508, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8646, 'compress@10': 0.9045, 'time@10': 9.6575}:  37%|███▋      | 11/30 [01:22<02:26,  7.71s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0508, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8646, 'compress@10': 0.9045, 'time@10': 9.6575}:  40%|████      | 12/30 [01:22<01:57,  6.54s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.0512, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8658, 'compress@10': 0.9045, 'time@10': 9.7101}:  40%|████      | 12/30 [01:27<01:57,  6.54s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.0512, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8658, 'compress@10': 0.9045, 'time@10': 9.7101}:  43%|████▎     | 13/30 [01:27<01:44,  6.14s/it]{'epoch': 4, 'num_users': 6.3571, 'loss': 0.0486, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8615, 'compress@10': 0.9054, 'time@10': 9.1395}:  43%|████▎     | 13/30 [01:29<01:44,  6.14s/it]{'epoch': 4, 'num_users': 6.3571, 'loss': 0.0486, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8615, 'compress@10': 0.9054, 'time@10': 9.1395}:  47%|████▋     | 14/30 [01:29<01:17,  4.81s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.0491, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8615, 'compress@10': 0.9053, 'time@10': 9.3619}:  47%|████▋     | 14/30 [01:35<01:17,  4.81s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.0491, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8615, 'compress@10': 0.9053, 'time@10': 9.3619}:  50%|█████     | 15/30 [01:35<01:18,  5.25s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.0469, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8621, 'compress@10': 0.9055, 'time@10': 9.0216}:  50%|█████     | 15/30 [01:39<01:18,  5.25s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.0469, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8621, 'compress@10': 0.9055, 'time@10': 9.0216}:  53%|█████▎    | 16/30 [01:39<01:08,  4.86s/it]{'epoch': 4, 'num_users': 5.8235, 'loss': 0.0452, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8553, 'compress@10': 0.9063, 'time@10': 8.6538}:  53%|█████▎    | 16/30 [01:40<01:08,  4.86s/it]{'epoch': 4, 'num_users': 5.8235, 'loss': 0.0452, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8553, 'compress@10': 0.9063, 'time@10': 8.6538}:  57%|█████▋    | 17/30 [01:40<00:49,  3.83s/it]{'epoch': 4, 'num_users': 6.0556, 'loss': 0.0461, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8553, 'compress@10': 0.9062, 'time@10': 8.5371}:  57%|█████▋    | 17/30 [01:47<00:49,  3.83s/it]{'epoch': 4, 'num_users': 6.0556, 'loss': 0.0461, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8553, 'compress@10': 0.9062, 'time@10': 8.5371}:  60%|██████    | 18/30 [01:47<00:55,  4.66s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.0446, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8576, 'compress@10': 0.9062, 'time@10': 8.4033}:  60%|██████    | 18/30 [01:50<00:55,  4.66s/it]   {'epoch': 4, 'num_users': 6.0, 'loss': 0.0446, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8576, 'compress@10': 0.9062, 'time@10': 8.4033}:  63%|██████▎   | 19/30 [01:50<00:45,  4.17s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.0453, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8554, 'compress@10': 0.906, 'time@10': 8.6917}:  63%|██████▎   | 19/30 [02:04<00:45,  4.17s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.0453, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8554, 'compress@10': 0.906, 'time@10': 8.6917}:  67%|██████▋   | 20/30 [02:04<01:11,  7.18s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0467, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8532, 'compress@10': 0.9058, 'time@10': 8.9003}:  67%|██████▋   | 20/30 [02:11<01:11,  7.18s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0467, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8532, 'compress@10': 0.9058, 'time@10': 8.9003}:  70%|███████   | 21/30 [02:11<01:02,  7.00s/it]{'epoch': 4, 'num_users': 6.1818, 'loss': 0.0468, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8565, 'compress@10': 0.9058, 'time@10': 8.7342}:  70%|███████   | 21/30 [02:16<01:02,  7.00s/it]{'epoch': 4, 'num_users': 6.1818, 'loss': 0.0468, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8565, 'compress@10': 0.9058, 'time@10': 8.7342}:  73%|███████▎  | 22/30 [02:16<00:51,  6.48s/it]{'epoch': 4, 'num_users': 6.1304, 'loss': 0.0459, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8586, 'compress@10': 0.9057, 'time@10': 8.7557}:  73%|███████▎  | 22/30 [02:21<00:51,  6.48s/it]{'epoch': 4, 'num_users': 6.1304, 'loss': 0.0459, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8586, 'compress@10': 0.9057, 'time@10': 8.7557}:  77%|███████▋  | 23/30 [02:21<00:41,  5.93s/it]{'epoch': 4, 'num_users': 5.9583, 'loss': 0.0458, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8516, 'compress@10': 0.9063, 'time@10': 8.4479}:  77%|███████▋  | 23/30 [02:22<00:41,  5.93s/it]{'epoch': 4, 'num_users': 5.9583, 'loss': 0.0458, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8516, 'compress@10': 0.9063, 'time@10': 8.4479}:  80%|████████  | 24/30 [02:22<00:27,  4.57s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0451, 'hit_ratio@10': 0.8219, 'ndcg@10': 0.836, 'compress@10': 0.9074, 'time@10': 8.1653}:  80%|████████  | 24/30 [02:23<00:27,  4.57s/it]    {'epoch': 4, 'num_users': 5.8, 'loss': 0.0451, 'hit_ratio@10': 0.8219, 'ndcg@10': 0.836, 'compress@10': 0.9074, 'time@10': 8.1653}:  83%|████████▎ | 25/30 [02:23<00:17,  3.43s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.0463, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8341, 'compress@10': 0.9072, 'time@10': 8.3794}:  83%|████████▎ | 25/30 [02:37<00:17,  3.43s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.0463, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8341, 'compress@10': 0.9072, 'time@10': 8.3794}:  87%|████████▋ | 26/30 [02:37<00:26,  6.53s/it]{'epoch': 4, 'num_users': 5.8889, 'loss': 0.0465, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8385, 'compress@10': 0.907, 'time@10': 8.5546}:  87%|████████▋ | 26/30 [02:43<00:26,  6.53s/it] {'epoch': 4, 'num_users': 5.8889, 'loss': 0.0465, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8385, 'compress@10': 0.907, 'time@10': 8.5546}:  90%|█████████ | 27/30 [02:43<00:19,  6.55s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.0467, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8393, 'compress@10': 0.9068, 'time@10': 8.6836}:  90%|█████████ | 27/30 [02:56<00:19,  6.55s/it]  {'epoch': 4, 'num_users': 6.0, 'loss': 0.0467, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8393, 'compress@10': 0.9068, 'time@10': 8.6836}:  93%|█████████▎| 28/30 [02:56<00:16,  8.24s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.0461, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8405, 'compress@10': 0.9068, 'time@10': 8.7323}:  93%|█████████▎| 28/30 [03:01<00:16,  8.24s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.0461, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8405, 'compress@10': 0.9068, 'time@10': 8.7323}:  97%|█████████▋| 29/30 [03:01<00:07,  7.30s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0459, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8421, 'compress@10': 0.9066, 'time@10': 8.7221}:  97%|█████████▋| 29/30 [03:09<00:07,  7.30s/it] {'epoch': 4, 'num_users': 5.8667, 'loss': 0.0459, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8421, 'compress@10': 0.9066, 'time@10': 8.7221}: 100%|██████████| 30/30 [03:09<00:00,  7.65s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0459, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8421, 'compress@10': 0.9066, 'time@10': 8.7221}: 100%|██████████| 30/30 [03:09<00:00,  6.32s/it]
Epoch: 4
Avg # of users: 5.866666666666666
Avg Loss: 0.04594868583853273
Avg hit ratio: 0.8290433046631295
Avg ndcg: 0.8420872140895508
Avg compression ratio: 0.9066299353679219
Avg train time: 8.722071385383606
Std train time: 4.1258751536450875
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 15, 10, 5, 10, 10, 10, 7, 10, 10, 15, 10, 15, 9, 15, 15, 10, 10, 9, 7, 11, 10, 15, 15, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8377, 'compress@10': 0.9052, 'time@10': 9.8533}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8377, 'compress@10': 0.9052, 'time@10': 9.8533}:   3%|▎         | 1/30 [00:04<02:23,  4.96s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8457, 'compress@10': 0.9042, 'time@10': 8.7008}:   3%|▎         | 1/30 [00:12<02:23,  4.96s/it] {'epoch': 5, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8457, 'compress@10': 0.9042, 'time@10': 8.7008}:   7%|▋         | 2/30 [00:12<03:02,  6.50s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8495, 'compress@10': 0.9076, 'time@10': 7.2797}:   7%|▋         | 2/30 [00:14<03:02,  6.50s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8495, 'compress@10': 0.9076, 'time@10': 7.2797}:  10%|█         | 3/30 [00:14<02:03,  4.56s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0385, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8437, 'compress@10': 0.9066, 'time@10': 7.1352}:  10%|█         | 3/30 [00:21<02:03,  4.56s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0385, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8437, 'compress@10': 0.9066, 'time@10': 7.1352}:  13%|█▎        | 4/30 [00:21<02:21,  5.43s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0489, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8272, 'compress@10': 0.9057, 'time@10': 8.2836}:  13%|█▎        | 4/30 [00:28<02:21,  5.43s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0489, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8272, 'compress@10': 0.9057, 'time@10': 8.2836}:  17%|█▋        | 5/30 [00:28<02:25,  5.80s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0521, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.8265, 'compress@10': 0.9051, 'time@10': 8.7233}:  17%|█▋        | 5/30 [00:38<02:25,  5.80s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0521, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.8265, 'compress@10': 0.9051, 'time@10': 8.7233}:  20%|██        | 6/30 [00:38<03:01,  7.56s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0521, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8282, 'compress@10': 0.9049, 'time@10': 9.2073}:  20%|██        | 6/30 [00:45<03:01,  7.56s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0521, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8282, 'compress@10': 0.9049, 'time@10': 9.2073}:  23%|██▎       | 7/30 [00:45<02:42,  7.08s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0525, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8449, 'compress@10': 0.9047, 'time@10': 9.0583}:  23%|██▎       | 7/30 [00:53<02:42,  7.08s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0525, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8449, 'compress@10': 0.9047, 'time@10': 9.0583}:  27%|██▋       | 8/30 [00:53<02:43,  7.43s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0518, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8548, 'compress@10': 0.9045, 'time@10': 9.5309}:  27%|██▋       | 8/30 [00:59<02:43,  7.43s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0518, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8548, 'compress@10': 0.9045, 'time@10': 9.5309}:  30%|███       | 9/30 [00:59<02:31,  7.20s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0508, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.856, 'compress@10': 0.9042, 'time@10': 9.7147}:  30%|███       | 9/30 [01:11<02:31,  7.20s/it]    {'epoch': 5, 'num_users': 6.3, 'loss': 0.0508, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.856, 'compress@10': 0.9042, 'time@10': 9.7147}:  33%|███▎      | 10/30 [01:11<02:49,  8.50s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0516, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8564, 'compress@10': 0.9042, 'time@10': 10.012}:  33%|███▎      | 10/30 [01:17<02:49,  8.50s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0516, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8564, 'compress@10': 0.9042, 'time@10': 10.012}:  37%|███▋      | 11/30 [01:17<02:30,  7.90s/it]{'epoch': 5, 'num_users': 6.4167, 'loss': 0.0487, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8596, 'compress@10': 0.9045, 'time@10': 9.5148}:  37%|███▋      | 11/30 [01:21<02:30,  7.90s/it]{'epoch': 5, 'num_users': 6.4167, 'loss': 0.0487, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8596, 'compress@10': 0.9045, 'time@10': 9.5148}:  40%|████      | 12/30 [01:21<02:01,  6.74s/it]{'epoch': 5, 'num_users': 6.6154, 'loss': 0.0491, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8611, 'compress@10': 0.9045, 'time@10': 9.5793}:  40%|████      | 12/30 [01:27<02:01,  6.74s/it] {'epoch': 5, 'num_users': 6.6154, 'loss': 0.0491, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8611, 'compress@10': 0.9045, 'time@10': 9.5793}:  43%|████▎     | 13/30 [01:27<01:46,  6.28s/it]{'epoch': 5, 'num_users': 6.3571, 'loss': 0.0465, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8575, 'compress@10': 0.9054, 'time@10': 9.0245}:  43%|████▎     | 13/30 [01:29<01:46,  6.28s/it]{'epoch': 5, 'num_users': 6.3571, 'loss': 0.0465, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8575, 'compress@10': 0.9054, 'time@10': 9.0245}:  47%|████▋     | 14/30 [01:29<01:19,  4.94s/it]{'epoch': 5, 'num_users': 6.2667, 'loss': 0.0474, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.858, 'compress@10': 0.9053, 'time@10': 9.3166}:  47%|████▋     | 14/30 [01:35<01:19,  4.94s/it] {'epoch': 5, 'num_users': 6.2667, 'loss': 0.0474, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.858, 'compress@10': 0.9053, 'time@10': 9.3166}:  50%|█████     | 15/30 [01:35<01:22,  5.48s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.0453, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8588, 'compress@10': 0.9055, 'time@10': 9.0066}:  50%|█████     | 15/30 [01:40<01:22,  5.48s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.0453, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8588, 'compress@10': 0.9055, 'time@10': 9.0066}:  53%|█████▎    | 16/30 [01:40<01:12,  5.16s/it]{'epoch': 5, 'num_users': 5.8235, 'loss': 0.0436, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8521, 'compress@10': 0.9063, 'time@10': 8.661}:  53%|█████▎    | 16/30 [01:41<01:12,  5.16s/it] {'epoch': 5, 'num_users': 5.8235, 'loss': 0.0436, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8521, 'compress@10': 0.9063, 'time@10': 8.661}:  57%|█████▋    | 17/30 [01:41<00:53,  4.09s/it]{'epoch': 5, 'num_users': 6.0556, 'loss': 0.0445, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8525, 'compress@10': 0.9062, 'time@10': 8.573}:  57%|█████▋    | 17/30 [01:48<00:53,  4.09s/it]{'epoch': 5, 'num_users': 6.0556, 'loss': 0.0445, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8525, 'compress@10': 0.9062, 'time@10': 8.573}:  60%|██████    | 18/30 [01:48<00:59,  5.00s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.043, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8549, 'compress@10': 0.9062, 'time@10': 8.4785}:  60%|██████    | 18/30 [01:52<00:59,  5.00s/it]   {'epoch': 5, 'num_users': 6.0, 'loss': 0.043, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8549, 'compress@10': 0.9062, 'time@10': 8.4785}:  63%|██████▎   | 19/30 [01:52<00:49,  4.52s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.0437, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8527, 'compress@10': 0.906, 'time@10': 8.7172}:  63%|██████▎   | 19/30 [02:05<00:49,  4.52s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.0437, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8527, 'compress@10': 0.906, 'time@10': 8.7172}:  67%|██████▋   | 20/30 [02:05<01:11,  7.16s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0451, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8509, 'compress@10': 0.9058, 'time@10': 8.9728}:  67%|██████▋   | 20/30 [02:12<01:11,  7.16s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0451, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8509, 'compress@10': 0.9058, 'time@10': 8.9728}:  70%|███████   | 21/30 [02:12<01:04,  7.13s/it]{'epoch': 5, 'num_users': 6.1818, 'loss': 0.0458, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.855, 'compress@10': 0.9058, 'time@10': 8.8237}:  70%|███████   | 21/30 [02:18<01:04,  7.13s/it] {'epoch': 5, 'num_users': 6.1818, 'loss': 0.0458, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.855, 'compress@10': 0.9058, 'time@10': 8.8237}:  73%|███████▎  | 22/30 [02:18<00:53,  6.71s/it]{'epoch': 5, 'num_users': 6.1304, 'loss': 0.045, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.857, 'compress@10': 0.9057, 'time@10': 8.8737}:  73%|███████▎  | 22/30 [02:23<00:53,  6.71s/it] {'epoch': 5, 'num_users': 6.1304, 'loss': 0.045, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.857, 'compress@10': 0.9057, 'time@10': 8.8737}:  77%|███████▋  | 23/30 [02:23<00:43,  6.21s/it]{'epoch': 5, 'num_users': 5.9583, 'loss': 0.0447, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8501, 'compress@10': 0.9063, 'time@10': 8.5686}:  77%|███████▋  | 23/30 [02:25<00:43,  6.21s/it]{'epoch': 5, 'num_users': 5.9583, 'loss': 0.0447, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8501, 'compress@10': 0.9063, 'time@10': 8.5686}:  80%|████████  | 24/30 [02:25<00:28,  4.82s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0438, 'hit_ratio@10': 0.8219, 'ndcg@10': 0.8388, 'compress@10': 0.9074, 'time@10': 8.2877}:  80%|████████  | 24/30 [02:25<00:28,  4.82s/it]   {'epoch': 5, 'num_users': 5.8, 'loss': 0.0438, 'hit_ratio@10': 0.8219, 'ndcg@10': 0.8388, 'compress@10': 0.9074, 'time@10': 8.2877}:  83%|████████▎ | 25/30 [02:25<00:18,  3.62s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.0449, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8371, 'compress@10': 0.9072, 'time@10': 8.5146}:  83%|████████▎ | 25/30 [02:40<00:18,  3.62s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.0449, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8371, 'compress@10': 0.9072, 'time@10': 8.5146}:  87%|████████▋ | 26/30 [02:40<00:27,  6.80s/it]{'epoch': 5, 'num_users': 5.8889, 'loss': 0.0448, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8382, 'compress@10': 0.907, 'time@10': 8.6861}:  87%|████████▋ | 26/30 [02:46<00:27,  6.80s/it] {'epoch': 5, 'num_users': 5.8889, 'loss': 0.0448, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8382, 'compress@10': 0.907, 'time@10': 8.6861}:  90%|█████████ | 27/30 [02:46<00:20,  6.74s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.045, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8387, 'compress@10': 0.9068, 'time@10': 8.8015}:  90%|█████████ | 27/30 [02:58<00:20,  6.74s/it]   {'epoch': 5, 'num_users': 6.0, 'loss': 0.045, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8387, 'compress@10': 0.9068, 'time@10': 8.8015}:  93%|█████████▎| 28/30 [02:58<00:16,  8.31s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.0448, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.841, 'compress@10': 0.9068, 'time@10': 8.8743}:  93%|█████████▎| 28/30 [03:04<00:16,  8.31s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.0448, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.841, 'compress@10': 0.9068, 'time@10': 8.8743}:  97%|█████████▋| 29/30 [03:04<00:07,  7.46s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0447, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8427, 'compress@10': 0.9066, 'time@10': 8.9311}:  97%|█████████▋| 29/30 [03:14<00:07,  7.46s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0447, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8427, 'compress@10': 0.9066, 'time@10': 8.9311}: 100%|██████████| 30/30 [03:14<00:00,  8.41s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0447, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8427, 'compress@10': 0.9066, 'time@10': 8.9311}: 100%|██████████| 30/30 [03:14<00:00,  6.49s/it]
Epoch: 5
Avg # of users: 5.866666666666666
Avg Loss: 0.044746289269789484
Avg hit ratio: 0.8298366202326286
Avg ndcg: 0.8426528353341762
Avg compression ratio: 0.9066299103088248
Avg train time: 8.93107578754425
Std train time: 4.024736239005061
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 16, 10, 5, 10, 10, 10, 7, 10, 10, 16, 10, 16, 9, 16, 16, 10, 10, 9, 7, 11, 10, 16, 16, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0544, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8665, 'compress@10': 0.9052, 'time@10': 9.9454}:   0%|          | 0/30 [00:05<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0544, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8665, 'compress@10': 0.9052, 'time@10': 9.9454}:   3%|▎         | 1/30 [00:05<02:25,  5.01s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8558, 'compress@10': 0.9042, 'time@10': 8.6679}:   3%|▎         | 1/30 [00:12<02:25,  5.01s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8558, 'compress@10': 0.9042, 'time@10': 8.6679}:   7%|▋         | 2/30 [00:12<03:00,  6.43s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8563, 'compress@10': 0.9076, 'time@10': 7.326}:   7%|▋         | 2/30 [00:14<03:00,  6.43s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8563, 'compress@10': 0.9076, 'time@10': 7.326}:  10%|█         | 3/30 [00:14<02:03,  4.57s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0399, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8457, 'compress@10': 0.9066, 'time@10': 7.1636}:  10%|█         | 3/30 [00:21<02:03,  4.57s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0399, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8457, 'compress@10': 0.9066, 'time@10': 7.1636}:  13%|█▎        | 4/30 [00:21<02:20,  5.42s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0499, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8302, 'compress@10': 0.9057, 'time@10': 8.3775}:  13%|█▎        | 4/30 [00:28<02:20,  5.42s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0499, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8302, 'compress@10': 0.9057, 'time@10': 8.3775}:  17%|█▋        | 5/30 [00:28<02:26,  5.87s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0524, 'hit_ratio@10': 0.7854, 'ndcg@10': 0.8287, 'compress@10': 0.9051, 'time@10': 8.9643}:  17%|█▋        | 5/30 [00:40<02:26,  5.87s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0524, 'hit_ratio@10': 0.7854, 'ndcg@10': 0.8287, 'compress@10': 0.9051, 'time@10': 8.9643}:  20%|██        | 6/30 [00:40<03:10,  7.93s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0509, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.8362, 'compress@10': 0.9049, 'time@10': 9.3065}:  20%|██        | 6/30 [00:45<03:10,  7.93s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0509, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.8362, 'compress@10': 0.9049, 'time@10': 9.3065}:  23%|██▎       | 7/30 [00:45<02:45,  7.21s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0509, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8509, 'compress@10': 0.9047, 'time@10': 9.1442}:  23%|██▎       | 7/30 [00:53<02:45,  7.21s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0509, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8509, 'compress@10': 0.9047, 'time@10': 9.1442}:  27%|██▋       | 8/30 [00:53<02:44,  7.47s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8636, 'compress@10': 0.9045, 'time@10': 9.4092}:  27%|██▋       | 8/30 [00:59<02:44,  7.47s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8636, 'compress@10': 0.9045, 'time@10': 9.4092}:  30%|███       | 9/30 [00:59<02:25,  6.95s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0506, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8623, 'compress@10': 0.9042, 'time@10': 9.4937}:  30%|███       | 9/30 [01:09<02:25,  6.95s/it]    {'epoch': 6, 'num_users': 6.3, 'loss': 0.0506, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8623, 'compress@10': 0.9042, 'time@10': 9.4937}:  33%|███▎      | 10/30 [01:09<02:39,  7.98s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.052, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8634, 'compress@10': 0.9042, 'time@10': 9.818}:  33%|███▎      | 10/30 [01:16<02:39,  7.98s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.052, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8634, 'compress@10': 0.9042, 'time@10': 9.818}:  37%|███▋      | 11/30 [01:16<02:23,  7.55s/it]{'epoch': 6, 'num_users': 6.4167, 'loss': 0.049, 'hit_ratio@10': 0.8174, 'ndcg@10': 0.866, 'compress@10': 0.9045, 'time@10': 9.3567}:  37%|███▋      | 11/30 [01:20<02:23,  7.55s/it]{'epoch': 6, 'num_users': 6.4167, 'loss': 0.049, 'hit_ratio@10': 0.8174, 'ndcg@10': 0.866, 'compress@10': 0.9045, 'time@10': 9.3567}:  40%|████      | 12/30 [01:20<01:58,  6.57s/it]{'epoch': 6, 'num_users': 6.6154, 'loss': 0.0494, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8678, 'compress@10': 0.9045, 'time@10': 9.4374}:  40%|████      | 12/30 [01:26<01:58,  6.57s/it]{'epoch': 6, 'num_users': 6.6154, 'loss': 0.0494, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8678, 'compress@10': 0.9045, 'time@10': 9.4374}:  43%|████▎     | 13/30 [01:26<01:44,  6.16s/it]{'epoch': 6, 'num_users': 6.3571, 'loss': 0.0467, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8637, 'compress@10': 0.9054, 'time@10': 8.9115}:  43%|████▎     | 13/30 [01:28<01:44,  6.16s/it]{'epoch': 6, 'num_users': 6.3571, 'loss': 0.0467, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8637, 'compress@10': 0.9054, 'time@10': 8.9115}:  47%|████▋     | 14/30 [01:28<01:19,  4.94s/it]{'epoch': 6, 'num_users': 6.2667, 'loss': 0.0471, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8633, 'compress@10': 0.9053, 'time@10': 9.2216}:  47%|████▋     | 14/30 [01:35<01:19,  4.94s/it]{'epoch': 6, 'num_users': 6.2667, 'loss': 0.0471, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8633, 'compress@10': 0.9053, 'time@10': 9.2216}:  50%|█████     | 15/30 [01:35<01:22,  5.51s/it]{'epoch': 6, 'num_users': 6.0625, 'loss': 0.045, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8641, 'compress@10': 0.9055, 'time@10': 8.931}:  50%|█████     | 15/30 [01:39<01:22,  5.51s/it]  {'epoch': 6, 'num_users': 6.0625, 'loss': 0.045, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8641, 'compress@10': 0.9055, 'time@10': 8.931}:  53%|█████▎    | 16/30 [01:39<01:13,  5.24s/it]{'epoch': 6, 'num_users': 5.8235, 'loss': 0.0432, 'hit_ratio@10': 0.8105, 'ndcg@10': 0.8571, 'compress@10': 0.9063, 'time@10': 8.5891}:  53%|█████▎    | 16/30 [01:41<01:13,  5.24s/it]{'epoch': 6, 'num_users': 5.8235, 'loss': 0.0432, 'hit_ratio@10': 0.8105, 'ndcg@10': 0.8571, 'compress@10': 0.9063, 'time@10': 8.5891}:  57%|█████▋    | 17/30 [01:41<00:53,  4.14s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.0439, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8571, 'compress@10': 0.9062, 'time@10': 8.4717}:  57%|█████▋    | 17/30 [01:47<00:53,  4.14s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.0439, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8571, 'compress@10': 0.9062, 'time@10': 8.4717}:  60%|██████    | 18/30 [01:47<00:58,  4.85s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.0425, 'hit_ratio@10': 0.8116, 'ndcg@10': 0.8593, 'compress@10': 0.9062, 'time@10': 8.3525}:  60%|██████    | 18/30 [01:50<00:58,  4.85s/it]   {'epoch': 6, 'num_users': 6.0, 'loss': 0.0425, 'hit_ratio@10': 0.8116, 'ndcg@10': 0.8593, 'compress@10': 0.9062, 'time@10': 8.3525}:  63%|██████▎   | 19/30 [01:50<00:47,  4.34s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.0431, 'hit_ratio@10': 0.8149, 'ndcg@10': 0.8576, 'compress@10': 0.906, 'time@10': 8.5908}:  63%|██████▎   | 19/30 [02:04<00:47,  4.34s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.0431, 'hit_ratio@10': 0.8149, 'ndcg@10': 0.8576, 'compress@10': 0.906, 'time@10': 8.5908}:  67%|██████▋   | 20/30 [02:04<01:09,  6.99s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0445, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8556, 'compress@10': 0.9058, 'time@10': 8.865}:  67%|██████▋   | 20/30 [02:11<01:09,  6.99s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0445, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8556, 'compress@10': 0.9058, 'time@10': 8.865}:  70%|███████   | 21/30 [02:11<01:03,  7.05s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.045, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8594, 'compress@10': 0.9058, 'time@10': 8.7069}:  70%|███████   | 21/30 [02:16<01:03,  7.05s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.045, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8594, 'compress@10': 0.9058, 'time@10': 8.7069}:  73%|███████▎  | 22/30 [02:16<00:52,  6.56s/it]{'epoch': 6, 'num_users': 6.1304, 'loss': 0.0443, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.861, 'compress@10': 0.9057, 'time@10': 8.7251}:  73%|███████▎  | 22/30 [02:21<00:52,  6.56s/it]{'epoch': 6, 'num_users': 6.1304, 'loss': 0.0443, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.861, 'compress@10': 0.9057, 'time@10': 8.7251}:  77%|███████▋  | 23/30 [02:21<00:41,  5.97s/it]{'epoch': 6, 'num_users': 5.9583, 'loss': 0.0439, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.854, 'compress@10': 0.9063, 'time@10': 8.4266}:  77%|███████▋  | 23/30 [02:22<00:41,  5.97s/it]{'epoch': 6, 'num_users': 5.9583, 'loss': 0.0439, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.854, 'compress@10': 0.9063, 'time@10': 8.4266}:  80%|████████  | 24/30 [02:22<00:27,  4.66s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0429, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8436, 'compress@10': 0.9074, 'time@10': 8.1506}:  80%|████████  | 24/30 [02:23<00:27,  4.66s/it]   {'epoch': 6, 'num_users': 5.8, 'loss': 0.0429, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8436, 'compress@10': 0.9074, 'time@10': 8.1506}:  83%|████████▎ | 25/30 [02:23<00:17,  3.50s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.0439, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.8421, 'compress@10': 0.9072, 'time@10': 8.3698}:  83%|████████▎ | 25/30 [02:37<00:17,  3.50s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.0439, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.8421, 'compress@10': 0.9072, 'time@10': 8.3698}:  87%|████████▋ | 26/30 [02:37<00:26,  6.62s/it]{'epoch': 6, 'num_users': 5.8889, 'loss': 0.044, 'hit_ratio@10': 0.8188, 'ndcg@10': 0.8462, 'compress@10': 0.907, 'time@10': 8.5432}:  87%|████████▋ | 26/30 [02:44<00:26,  6.62s/it]  {'epoch': 6, 'num_users': 5.8889, 'loss': 0.044, 'hit_ratio@10': 0.8188, 'ndcg@10': 0.8462, 'compress@10': 0.907, 'time@10': 8.5432}:  90%|█████████ | 27/30 [02:44<00:19,  6.60s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.0444, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8463, 'compress@10': 0.9068, 'time@10': 8.6761}:  90%|█████████ | 27/30 [02:56<00:19,  6.60s/it] {'epoch': 6, 'num_users': 6.0, 'loss': 0.0444, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8463, 'compress@10': 0.9068, 'time@10': 8.6761}:  93%|█████████▎| 28/30 [02:56<00:16,  8.31s/it]{'epoch': 6, 'num_users': 5.8621, 'loss': 0.044, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8481, 'compress@10': 0.9068, 'time@10': 8.7262}:  93%|█████████▎| 28/30 [03:01<00:16,  8.31s/it]{'epoch': 6, 'num_users': 5.8621, 'loss': 0.044, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8481, 'compress@10': 0.9068, 'time@10': 8.7262}:  97%|█████████▋| 29/30 [03:01<00:07,  7.35s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0439, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8498, 'compress@10': 0.9066, 'time@10': 8.7149}:  97%|█████████▋| 29/30 [03:09<00:07,  7.35s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0439, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8498, 'compress@10': 0.9066, 'time@10': 8.7149}: 100%|██████████| 30/30 [03:09<00:00,  7.67s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0439, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8498, 'compress@10': 0.9066, 'time@10': 8.7149}: 100%|██████████| 30/30 [03:09<00:00,  6.33s/it]
Epoch: 6
Avg # of users: 5.866666666666666
Avg Loss: 0.04388424350128627
Avg hit ratio: 0.8228841391771462
Avg ndcg: 0.8497738151492837
Avg compression ratio: 0.9066299239907518
Avg train time: 8.714874863624573
Std train time: 3.9421801007591486
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 10, 17, 10, 17, 9, 17, 17, 10, 10, 9, 6, 11, 10, 17, 17, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8396, 'compress@10': 0.9052, 'time@10': 8.2602}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8396, 'compress@10': 0.9052, 'time@10': 8.2602}:   3%|▎         | 1/30 [00:04<02:00,  4.17s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8443, 'compress@10': 0.9042, 'time@10': 7.7249}:   3%|▎         | 1/30 [00:11<02:00,  4.17s/it] {'epoch': 7, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8443, 'compress@10': 0.9042, 'time@10': 7.7249}:   7%|▋         | 2/30 [00:11<02:47,  5.97s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8486, 'compress@10': 0.9076, 'time@10': 6.7492}:   7%|▋         | 2/30 [00:13<02:47,  5.97s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8486, 'compress@10': 0.9076, 'time@10': 6.7492}:  10%|█         | 3/30 [00:13<01:57,  4.35s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0406, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.841, 'compress@10': 0.9066, 'time@10': 6.688}:  10%|█         | 3/30 [00:20<01:57,  4.35s/it]  {'epoch': 7, 'num_users': 5.0, 'loss': 0.0406, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.841, 'compress@10': 0.9066, 'time@10': 6.688}:  13%|█▎        | 4/30 [00:20<02:15,  5.22s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0503, 'hit_ratio@10': 0.78, 'ndcg@10': 0.827, 'compress@10': 0.9057, 'time@10': 7.8746}:  13%|█▎        | 4/30 [00:26<02:15,  5.22s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.0503, 'hit_ratio@10': 0.78, 'ndcg@10': 0.827, 'compress@10': 0.9057, 'time@10': 7.8746}:  17%|█▋        | 5/30 [00:26<02:20,  5.62s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0522, 'hit_ratio@10': 0.7871, 'ndcg@10': 0.8268, 'compress@10': 0.9051, 'time@10': 8.54}:  17%|█▋        | 5/30 [00:38<02:20,  5.62s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0522, 'hit_ratio@10': 0.7871, 'ndcg@10': 0.8268, 'compress@10': 0.9051, 'time@10': 8.54}:  20%|██        | 6/30 [00:38<03:06,  7.76s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0516, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.8266, 'compress@10': 0.9049, 'time@10': 9.183}:  20%|██        | 6/30 [00:45<03:06,  7.76s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0516, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.8266, 'compress@10': 0.9049, 'time@10': 9.183}:  23%|██▎       | 7/30 [00:45<02:49,  7.37s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0513, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8421, 'compress@10': 0.9047, 'time@10': 9.0972}:  23%|██▎       | 7/30 [00:53<02:49,  7.37s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0513, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8421, 'compress@10': 0.9047, 'time@10': 9.0972}:  27%|██▋       | 8/30 [00:53<02:50,  7.74s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0511, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8607, 'compress@10': 0.9045, 'time@10': 9.3839}:  27%|██▋       | 8/30 [00:59<02:50,  7.74s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0511, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8607, 'compress@10': 0.9045, 'time@10': 9.3839}:  30%|███       | 9/30 [00:59<02:30,  7.16s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8622, 'compress@10': 0.9042, 'time@10': 9.635}:  30%|███       | 9/30 [01:11<02:30,  7.16s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8622, 'compress@10': 0.9042, 'time@10': 9.635}:  33%|███▎      | 10/30 [01:11<02:52,  8.63s/it]{'epoch': 7, 'num_users': 6.6364, 'loss': 0.0512, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8637, 'compress@10': 0.9042, 'time@10': 9.9033}:  33%|███▎      | 10/30 [01:17<02:52,  8.63s/it]{'epoch': 7, 'num_users': 6.6364, 'loss': 0.0512, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8637, 'compress@10': 0.9042, 'time@10': 9.9033}:  37%|███▋      | 11/30 [01:17<02:30,  7.93s/it]{'epoch': 7, 'num_users': 6.4167, 'loss': 0.0483, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8663, 'compress@10': 0.9045, 'time@10': 9.4468}:  37%|███▋      | 11/30 [01:22<02:30,  7.93s/it] {'epoch': 7, 'num_users': 6.4167, 'loss': 0.0483, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8663, 'compress@10': 0.9045, 'time@10': 9.4468}:  40%|████      | 12/30 [01:22<02:03,  6.87s/it]{'epoch': 7, 'num_users': 6.6154, 'loss': 0.0486, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8679, 'compress@10': 0.9045, 'time@10': 9.5232}:  40%|████      | 12/30 [01:27<02:03,  6.87s/it]{'epoch': 7, 'num_users': 6.6154, 'loss': 0.0486, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8679, 'compress@10': 0.9045, 'time@10': 9.5232}:  43%|████▎     | 13/30 [01:27<01:48,  6.38s/it]{'epoch': 7, 'num_users': 6.3571, 'loss': 0.0459, 'hit_ratio@10': 0.8115, 'ndcg@10': 0.8638, 'compress@10': 0.9054, 'time@10': 8.9896}:  43%|████▎     | 13/30 [01:29<01:48,  6.38s/it]{'epoch': 7, 'num_users': 6.3571, 'loss': 0.0459, 'hit_ratio@10': 0.8115, 'ndcg@10': 0.8638, 'compress@10': 0.9054, 'time@10': 8.9896}:  47%|████▋     | 14/30 [01:29<01:21,  5.09s/it]{'epoch': 7, 'num_users': 6.2667, 'loss': 0.0466, 'hit_ratio@10': 0.8219, 'ndcg@10': 0.8638, 'compress@10': 0.9053, 'time@10': 9.2454}:  47%|████▋     | 14/30 [01:36<01:21,  5.09s/it]{'epoch': 7, 'num_users': 6.2667, 'loss': 0.0466, 'hit_ratio@10': 0.8219, 'ndcg@10': 0.8638, 'compress@10': 0.9053, 'time@10': 9.2454}:  50%|█████     | 15/30 [01:36<01:22,  5.50s/it]{'epoch': 7, 'num_users': 6.0625, 'loss': 0.0445, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8645, 'compress@10': 0.9055, 'time@10': 8.952}:  50%|█████     | 15/30 [01:40<01:22,  5.50s/it] {'epoch': 7, 'num_users': 6.0625, 'loss': 0.0445, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8645, 'compress@10': 0.9055, 'time@10': 8.952}:  53%|█████▎    | 16/30 [01:40<01:13,  5.22s/it]{'epoch': 7, 'num_users': 5.8235, 'loss': 0.0426, 'hit_ratio@10': 0.8095, 'ndcg@10': 0.8575, 'compress@10': 0.9063, 'time@10': 8.6128}:  53%|█████▎    | 16/30 [01:42<01:13,  5.22s/it]{'epoch': 7, 'num_users': 5.8235, 'loss': 0.0426, 'hit_ratio@10': 0.8095, 'ndcg@10': 0.8575, 'compress@10': 0.9063, 'time@10': 8.6128}:  57%|█████▋    | 17/30 [01:42<00:53,  4.14s/it]{'epoch': 7, 'num_users': 6.0556, 'loss': 0.0433, 'hit_ratio@10': 0.8062, 'ndcg@10': 0.8575, 'compress@10': 0.9062, 'time@10': 8.5012}:  57%|█████▋    | 17/30 [01:48<00:53,  4.14s/it]{'epoch': 7, 'num_users': 6.0556, 'loss': 0.0433, 'hit_ratio@10': 0.8062, 'ndcg@10': 0.8575, 'compress@10': 0.9062, 'time@10': 8.5012}:  60%|██████    | 18/30 [01:48<00:58,  4.89s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.0419, 'hit_ratio@10': 0.8089, 'ndcg@10': 0.8595, 'compress@10': 0.9062, 'time@10': 8.3801}:  60%|██████    | 18/30 [01:52<00:58,  4.89s/it]   {'epoch': 7, 'num_users': 6.0, 'loss': 0.0419, 'hit_ratio@10': 0.8089, 'ndcg@10': 0.8595, 'compress@10': 0.9062, 'time@10': 8.3801}:  63%|██████▎   | 19/30 [01:52<00:48,  4.37s/it]{'epoch': 7, 'num_users': 6.15, 'loss': 0.0424, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8582, 'compress@10': 0.906, 'time@10': 8.5844}:  63%|██████▎   | 19/30 [02:04<00:48,  4.37s/it]{'epoch': 7, 'num_users': 6.15, 'loss': 0.0424, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8582, 'compress@10': 0.906, 'time@10': 8.5844}:  67%|██████▋   | 20/30 [02:04<01:08,  6.81s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.044, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8563, 'compress@10': 0.9058, 'time@10': 8.7127}:  67%|██████▋   | 20/30 [02:10<01:08,  6.81s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.044, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8563, 'compress@10': 0.9058, 'time@10': 8.7127}:  70%|███████   | 21/30 [02:10<00:58,  6.47s/it]{'epoch': 7, 'num_users': 6.1818, 'loss': 0.0434, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8591, 'compress@10': 0.9058, 'time@10': 8.5611}:  70%|███████   | 21/30 [02:15<00:58,  6.47s/it]{'epoch': 7, 'num_users': 6.1818, 'loss': 0.0434, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8591, 'compress@10': 0.9058, 'time@10': 8.5611}:  73%|███████▎  | 22/30 [02:15<00:49,  6.15s/it]{'epoch': 7, 'num_users': 6.1304, 'loss': 0.0428, 'hit_ratio@10': 0.8184, 'ndcg@10': 0.8608, 'compress@10': 0.9057, 'time@10': 8.5805}:  73%|███████▎  | 22/30 [02:20<00:49,  6.15s/it]{'epoch': 7, 'num_users': 6.1304, 'loss': 0.0428, 'hit_ratio@10': 0.8184, 'ndcg@10': 0.8608, 'compress@10': 0.9057, 'time@10': 8.5805}:  77%|███████▋  | 23/30 [02:20<00:39,  5.67s/it]{'epoch': 7, 'num_users': 5.9583, 'loss': 0.0424, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8538, 'compress@10': 0.9063, 'time@10': 8.2921}:  77%|███████▋  | 23/30 [02:21<00:39,  5.67s/it]{'epoch': 7, 'num_users': 5.9583, 'loss': 0.0424, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8538, 'compress@10': 0.9063, 'time@10': 8.2921}:  80%|████████  | 24/30 [02:21<00:26,  4.48s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0413, 'hit_ratio@10': 0.8116, 'ndcg@10': 0.8434, 'compress@10': 0.9074, 'time@10': 8.0256}:  80%|████████  | 24/30 [02:22<00:26,  4.48s/it]   {'epoch': 7, 'num_users': 5.8, 'loss': 0.0413, 'hit_ratio@10': 0.8116, 'ndcg@10': 0.8434, 'compress@10': 0.9074, 'time@10': 8.0256}:  83%|████████▎ | 25/30 [02:22<00:16,  3.39s/it]{'epoch': 7, 'num_users': 5.8077, 'loss': 0.0423, 'hit_ratio@10': 0.8146, 'ndcg@10': 0.8424, 'compress@10': 0.9072, 'time@10': 8.2509}:  83%|████████▎ | 25/30 [02:36<00:16,  3.39s/it]{'epoch': 7, 'num_users': 5.8077, 'loss': 0.0423, 'hit_ratio@10': 0.8146, 'ndcg@10': 0.8424, 'compress@10': 0.9072, 'time@10': 8.2509}:  87%|████████▋ | 26/30 [02:36<00:26,  6.55s/it]{'epoch': 7, 'num_users': 5.8889, 'loss': 0.0418, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8448, 'compress@10': 0.907, 'time@10': 8.4355}:  87%|████████▋ | 26/30 [02:43<00:26,  6.55s/it] {'epoch': 7, 'num_users': 5.8889, 'loss': 0.0418, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8448, 'compress@10': 0.907, 'time@10': 8.4355}:  90%|█████████ | 27/30 [02:43<00:19,  6.58s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.042, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8453, 'compress@10': 0.9068, 'time@10': 8.5625}:  90%|█████████ | 27/30 [02:55<00:19,  6.58s/it]   {'epoch': 7, 'num_users': 6.0, 'loss': 0.042, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8453, 'compress@10': 0.9068, 'time@10': 8.5625}:  93%|█████████▎| 28/30 [02:55<00:16,  8.21s/it]{'epoch': 7, 'num_users': 5.8621, 'loss': 0.0416, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8474, 'compress@10': 0.9068, 'time@10': 8.5999}:  93%|█████████▎| 28/30 [03:00<00:16,  8.21s/it]{'epoch': 7, 'num_users': 5.8621, 'loss': 0.0416, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8474, 'compress@10': 0.9068, 'time@10': 8.5999}:  97%|█████████▋| 29/30 [03:00<00:07,  7.21s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0416, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8491, 'compress@10': 0.9066, 'time@10': 8.6078}:  97%|█████████▋| 29/30 [03:09<00:07,  7.21s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0416, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8491, 'compress@10': 0.9066, 'time@10': 8.6078}: 100%|██████████| 30/30 [03:09<00:00,  7.71s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0416, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8491, 'compress@10': 0.9066, 'time@10': 8.6078}: 100%|██████████| 30/30 [03:09<00:00,  6.30s/it]
Epoch: 7
Avg # of users: 5.866666666666666
Avg Loss: 0.04156467162341858
Avg hit ratio: 0.8259493712128945
Avg ndcg: 0.8491249178594715
Avg compression ratio: 0.9066299263215215
Avg train time: 8.607760977745055
Std train time: 3.7955344189583227
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 10, 18, 10, 18, 9, 18, 18, 10, 10, 9, 6, 11, 10, 18, 18, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0516, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.9052, 'time@10': 11.4377}:   0%|          | 0/30 [00:05<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0516, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.9052, 'time@10': 11.4377}:   3%|▎         | 1/30 [00:05<02:46,  5.75s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8527, 'compress@10': 0.9042, 'time@10': 9.269}:   3%|▎         | 1/30 [00:12<02:46,  5.75s/it]  {'epoch': 8, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8527, 'compress@10': 0.9042, 'time@10': 9.269}:   7%|▋         | 2/30 [00:12<03:03,  6.57s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8542, 'compress@10': 0.9076, 'time@10': 7.8269}:   7%|▋         | 2/30 [00:15<03:03,  6.57s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8542, 'compress@10': 0.9076, 'time@10': 7.8269}:  10%|█         | 3/30 [00:15<02:07,  4.71s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.039, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8251, 'compress@10': 0.9066, 'time@10': 7.5373}:  10%|█         | 3/30 [00:22<02:07,  4.71s/it]  {'epoch': 8, 'num_users': 5.0, 'loss': 0.039, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8251, 'compress@10': 0.9066, 'time@10': 7.5373}:  13%|█▎        | 4/30 [00:22<02:23,  5.51s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0488, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.815, 'compress@10': 0.9057, 'time@10': 8.4884}:  13%|█▎        | 4/30 [00:28<02:23,  5.51s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0488, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.815, 'compress@10': 0.9057, 'time@10': 8.4884}:  17%|█▋        | 5/30 [00:28<02:23,  5.75s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0506, 'hit_ratio@10': 0.7817, 'ndcg@10': 0.8178, 'compress@10': 0.9051, 'time@10': 8.899}:  17%|█▋        | 5/30 [00:39<02:23,  5.75s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0506, 'hit_ratio@10': 0.7817, 'ndcg@10': 0.8178, 'compress@10': 0.9051, 'time@10': 8.899}:  20%|██        | 6/30 [00:39<03:00,  7.54s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8264, 'compress@10': 0.9049, 'time@10': 9.6112}:  20%|██        | 6/30 [00:46<03:00,  7.54s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8264, 'compress@10': 0.9049, 'time@10': 9.6112}:  23%|██▎       | 7/30 [00:46<02:49,  7.35s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8419, 'compress@10': 0.9047, 'time@10': 9.5068}:  23%|██▎       | 7/30 [00:55<02:49,  7.35s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8419, 'compress@10': 0.9047, 'time@10': 9.5068}:  27%|██▋       | 8/30 [00:55<02:51,  7.82s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8592, 'compress@10': 0.9045, 'time@10': 9.7894}:  27%|██▋       | 8/30 [01:01<02:51,  7.82s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8592, 'compress@10': 0.9045, 'time@10': 9.7894}:  30%|███       | 9/30 [01:01<02:32,  7.27s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0498, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8587, 'compress@10': 0.9042, 'time@10': 9.8103}:  30%|███       | 9/30 [01:11<02:32,  7.27s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0498, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8587, 'compress@10': 0.9042, 'time@10': 9.8103}:  33%|███▎      | 10/30 [01:11<02:42,  8.12s/it]{'epoch': 8, 'num_users': 6.6364, 'loss': 0.051, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8601, 'compress@10': 0.9042, 'time@10': 10.0578}:  33%|███▎      | 10/30 [01:17<02:42,  8.12s/it]{'epoch': 8, 'num_users': 6.6364, 'loss': 0.051, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8601, 'compress@10': 0.9042, 'time@10': 10.0578}:  37%|███▋      | 11/30 [01:17<02:23,  7.57s/it]{'epoch': 8, 'num_users': 6.4167, 'loss': 0.048, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8637, 'compress@10': 0.9045, 'time@10': 9.6242}:  37%|███▋      | 11/30 [01:22<02:23,  7.57s/it]  {'epoch': 8, 'num_users': 6.4167, 'loss': 0.048, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8637, 'compress@10': 0.9045, 'time@10': 9.6242}:  40%|████      | 12/30 [01:22<02:01,  6.75s/it]{'epoch': 8, 'num_users': 6.6154, 'loss': 0.0482, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8656, 'compress@10': 0.9045, 'time@10': 9.6757}:  40%|████      | 12/30 [01:27<02:01,  6.75s/it]{'epoch': 8, 'num_users': 6.6154, 'loss': 0.0482, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8656, 'compress@10': 0.9045, 'time@10': 9.6757}:  43%|████▎     | 13/30 [01:27<01:46,  6.28s/it]{'epoch': 8, 'num_users': 6.3571, 'loss': 0.0455, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.8617, 'compress@10': 0.9054, 'time@10': 9.1346}:  43%|████▎     | 13/30 [01:29<01:46,  6.28s/it]{'epoch': 8, 'num_users': 6.3571, 'loss': 0.0455, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.8617, 'compress@10': 0.9054, 'time@10': 9.1346}:  47%|████▋     | 14/30 [01:29<01:20,  5.03s/it]{'epoch': 8, 'num_users': 6.2667, 'loss': 0.0458, 'hit_ratio@10': 0.8153, 'ndcg@10': 0.8625, 'compress@10': 0.9053, 'time@10': 9.413}:  47%|████▋     | 14/30 [01:36<01:20,  5.03s/it] {'epoch': 8, 'num_users': 6.2667, 'loss': 0.0458, 'hit_ratio@10': 0.8153, 'ndcg@10': 0.8625, 'compress@10': 0.9053, 'time@10': 9.413}:  50%|█████     | 15/30 [01:36<01:22,  5.53s/it]{'epoch': 8, 'num_users': 6.0625, 'loss': 0.0437, 'hit_ratio@10': 0.8165, 'ndcg@10': 0.8633, 'compress@10': 0.9055, 'time@10': 9.148}:  50%|█████     | 15/30 [01:41<01:22,  5.53s/it]{'epoch': 8, 'num_users': 6.0625, 'loss': 0.0437, 'hit_ratio@10': 0.8165, 'ndcg@10': 0.8633, 'compress@10': 0.9055, 'time@10': 9.148}:  53%|█████▎    | 16/30 [01:41<01:16,  5.43s/it]{'epoch': 8, 'num_users': 5.8235, 'loss': 0.0418, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.8564, 'compress@10': 0.9063, 'time@10': 8.8244}:  53%|█████▎    | 16/30 [01:43<01:16,  5.43s/it]{'epoch': 8, 'num_users': 5.8235, 'loss': 0.0418, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.8564, 'compress@10': 0.9063, 'time@10': 8.8244}:  57%|█████▋    | 17/30 [01:43<00:56,  4.36s/it]{'epoch': 8, 'num_users': 6.0556, 'loss': 0.0424, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8569, 'compress@10': 0.9062, 'time@10': 8.7022}:  57%|█████▋    | 17/30 [01:50<00:56,  4.36s/it]{'epoch': 8, 'num_users': 6.0556, 'loss': 0.0424, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8569, 'compress@10': 0.9062, 'time@10': 8.7022}:  60%|██████    | 18/30 [01:50<01:00,  5.05s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.0411, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.859, 'compress@10': 0.9062, 'time@10': 8.5494}:  60%|██████    | 18/30 [01:53<01:00,  5.05s/it]    {'epoch': 8, 'num_users': 6.0, 'loss': 0.0411, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.859, 'compress@10': 0.9062, 'time@10': 8.5494}:  63%|██████▎   | 19/30 [01:53<00:48,  4.42s/it]{'epoch': 8, 'num_users': 6.15, 'loss': 0.0415, 'hit_ratio@10': 0.8083, 'ndcg@10': 0.858, 'compress@10': 0.906, 'time@10': 8.7913}:  63%|██████▎   | 19/30 [02:06<00:48,  4.42s/it]{'epoch': 8, 'num_users': 6.15, 'loss': 0.0415, 'hit_ratio@10': 0.8083, 'ndcg@10': 0.858, 'compress@10': 0.906, 'time@10': 8.7913}:  67%|██████▋   | 20/30 [02:06<01:11,  7.12s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0429, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8556, 'compress@10': 0.9058, 'time@10': 9.0169}:  67%|██████▋   | 20/30 [02:13<01:11,  7.12s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0429, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8556, 'compress@10': 0.9058, 'time@10': 9.0169}:  70%|███████   | 21/30 [02:13<01:03,  7.02s/it]{'epoch': 8, 'num_users': 6.1818, 'loss': 0.0447, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8495, 'compress@10': 0.9058, 'time@10': 8.8827}:  70%|███████   | 21/30 [02:19<01:03,  7.02s/it]{'epoch': 8, 'num_users': 6.1818, 'loss': 0.0447, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8495, 'compress@10': 0.9058, 'time@10': 8.8827}:  73%|███████▎  | 22/30 [02:19<00:53,  6.75s/it]{'epoch': 8, 'num_users': 6.1304, 'loss': 0.0441, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8515, 'compress@10': 0.9057, 'time@10': 8.8902}:  73%|███████▎  | 22/30 [02:23<00:53,  6.75s/it] {'epoch': 8, 'num_users': 6.1304, 'loss': 0.0441, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8515, 'compress@10': 0.9057, 'time@10': 8.8902}:  77%|███████▋  | 23/30 [02:23<00:42,  6.09s/it]{'epoch': 8, 'num_users': 5.9583, 'loss': 0.0435, 'hit_ratio@10': 0.8125, 'ndcg@10': 0.8455, 'compress@10': 0.9063, 'time@10': 8.5933}:  77%|███████▋  | 23/30 [02:25<00:42,  6.09s/it]{'epoch': 8, 'num_users': 5.9583, 'loss': 0.0435, 'hit_ratio@10': 0.8125, 'ndcg@10': 0.8455, 'compress@10': 0.9063, 'time@10': 8.5933}:  80%|████████  | 24/30 [02:25<00:28,  4.80s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0423, 'hit_ratio@10': 0.8066, 'ndcg@10': 0.8366, 'compress@10': 0.9074, 'time@10': 8.3183}:  80%|████████  | 24/30 [02:26<00:28,  4.80s/it]   {'epoch': 8, 'num_users': 5.8, 'loss': 0.0423, 'hit_ratio@10': 0.8066, 'ndcg@10': 0.8366, 'compress@10': 0.9074, 'time@10': 8.3183}:  83%|████████▎ | 25/30 [02:26<00:18,  3.63s/it]{'epoch': 8, 'num_users': 5.8077, 'loss': 0.0431, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8361, 'compress@10': 0.9072, 'time@10': 8.5291}:  83%|████████▎ | 25/30 [02:40<00:18,  3.63s/it]{'epoch': 8, 'num_users': 5.8077, 'loss': 0.0431, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8361, 'compress@10': 0.9072, 'time@10': 8.5291}:  87%|████████▋ | 26/30 [02:40<00:26,  6.69s/it]{'epoch': 8, 'num_users': 5.8889, 'loss': 0.0429, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8374, 'compress@10': 0.907, 'time@10': 8.7117}:  87%|████████▋ | 26/30 [02:47<00:26,  6.69s/it] {'epoch': 8, 'num_users': 5.8889, 'loss': 0.0429, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8374, 'compress@10': 0.907, 'time@10': 8.7117}:  90%|█████████ | 27/30 [02:47<00:20,  6.71s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.0432, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8387, 'compress@10': 0.9068, 'time@10': 8.8466}:  90%|█████████ | 27/30 [02:59<00:20,  6.71s/it]  {'epoch': 8, 'num_users': 6.0, 'loss': 0.0432, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8387, 'compress@10': 0.9068, 'time@10': 8.8466}:  93%|█████████▎| 28/30 [02:59<00:16,  8.46s/it]{'epoch': 8, 'num_users': 5.8621, 'loss': 0.0427, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8411, 'compress@10': 0.9068, 'time@10': 8.896}:  93%|█████████▎| 28/30 [03:04<00:16,  8.46s/it]{'epoch': 8, 'num_users': 5.8621, 'loss': 0.0427, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8411, 'compress@10': 0.9068, 'time@10': 8.896}:  97%|█████████▋| 29/30 [03:04<00:07,  7.47s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0426, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8431, 'compress@10': 0.9066, 'time@10': 8.885}:  97%|█████████▋| 29/30 [03:13<00:07,  7.47s/it] {'epoch': 8, 'num_users': 5.8667, 'loss': 0.0426, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8431, 'compress@10': 0.9066, 'time@10': 8.885}: 100%|██████████| 30/30 [03:13<00:00,  7.81s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0426, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8431, 'compress@10': 0.9066, 'time@10': 8.885}: 100%|██████████| 30/30 [03:13<00:00,  6.45s/it]
Epoch: 8
Avg # of users: 5.866666666666666
Avg Loss: 0.04260106096810867
Avg hit ratio: 0.8210417897219141
Avg ndcg: 0.8430701012657636
Avg compression ratio: 0.9066299412406178
Avg train time: 8.885009972254435
Std train time: 3.861419938250491
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 10, 18, 10, 19, 9, 18, 19, 10, 10, 9, 6, 11, 10, 19, 19, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8446, 'compress@10': 0.9052, 'time@10': 9.9815}:   0%|          | 0/30 [00:05<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8446, 'compress@10': 0.9052, 'time@10': 9.9815}:   3%|▎         | 1/30 [00:05<02:26,  5.06s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8606, 'compress@10': 0.9042, 'time@10': 8.6812}:   3%|▎         | 1/30 [00:12<02:26,  5.06s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8606, 'compress@10': 0.9042, 'time@10': 8.6812}:   7%|▋         | 2/30 [00:12<03:00,  6.45s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8594, 'compress@10': 0.9076, 'time@10': 7.4247}:   7%|▋         | 2/30 [00:14<03:00,  6.45s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8594, 'compress@10': 0.9076, 'time@10': 7.4247}:  10%|█         | 3/30 [00:14<02:05,  4.64s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.853, 'compress@10': 0.9066, 'time@10': 7.2165}:  10%|█         | 3/30 [00:21<02:05,  4.64s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.853, 'compress@10': 0.9066, 'time@10': 7.2165}:  13%|█▎        | 4/30 [00:21<02:21,  5.43s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0446, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8384, 'compress@10': 0.9057, 'time@10': 8.2145}:  13%|█▎        | 4/30 [00:27<02:21,  5.43s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0446, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8384, 'compress@10': 0.9057, 'time@10': 8.2145}:  17%|█▋        | 5/30 [00:27<02:22,  5.68s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0464, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8372, 'compress@10': 0.9051, 'time@10': 8.6715}:  17%|█▋        | 5/30 [00:38<02:22,  5.68s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0464, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8372, 'compress@10': 0.9051, 'time@10': 8.6715}:  20%|██        | 6/30 [00:38<02:59,  7.49s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0458, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8371, 'compress@10': 0.9049, 'time@10': 9.2128}:  20%|██        | 6/30 [00:44<02:59,  7.49s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0458, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8371, 'compress@10': 0.9049, 'time@10': 9.2128}:  23%|██▎       | 7/30 [00:44<02:43,  7.09s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0457, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.849, 'compress@10': 0.9047, 'time@10': 9.2501}:  23%|██▎       | 7/30 [00:54<02:43,  7.09s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0457, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.849, 'compress@10': 0.9047, 'time@10': 9.2501}:  27%|██▋       | 8/30 [00:54<02:53,  7.87s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0456, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.862, 'compress@10': 0.9045, 'time@10': 9.7104}:  27%|██▋       | 8/30 [01:01<02:53,  7.87s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0456, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.862, 'compress@10': 0.9045, 'time@10': 9.7104}:  30%|███       | 9/30 [01:01<02:37,  7.52s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0449, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8647, 'compress@10': 0.9042, 'time@10': 9.8959}:  30%|███       | 9/30 [01:12<02:37,  7.52s/it]  {'epoch': 9, 'num_users': 6.3, 'loss': 0.0449, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8647, 'compress@10': 0.9042, 'time@10': 9.8959}:  33%|███▎      | 10/30 [01:12<02:55,  8.78s/it]{'epoch': 9, 'num_users': 6.6364, 'loss': 0.0472, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8664, 'compress@10': 0.9042, 'time@10': 10.0761}:  33%|███▎      | 10/30 [01:18<02:55,  8.78s/it]{'epoch': 9, 'num_users': 6.6364, 'loss': 0.0472, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8664, 'compress@10': 0.9042, 'time@10': 10.0761}:  37%|███▋      | 11/30 [01:18<02:30,  7.92s/it]{'epoch': 9, 'num_users': 6.4167, 'loss': 0.0444, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8695, 'compress@10': 0.9045, 'time@10': 9.6436}:  37%|███▋      | 11/30 [01:23<02:30,  7.92s/it] {'epoch': 9, 'num_users': 6.4167, 'loss': 0.0444, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8695, 'compress@10': 0.9045, 'time@10': 9.6436}:  40%|████      | 12/30 [01:23<02:06,  7.01s/it]{'epoch': 9, 'num_users': 6.6154, 'loss': 0.0448, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8708, 'compress@10': 0.9045, 'time@10': 9.6964}:  40%|████      | 12/30 [01:28<02:06,  7.01s/it] {'epoch': 9, 'num_users': 6.6154, 'loss': 0.0448, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8708, 'compress@10': 0.9045, 'time@10': 9.6964}:  43%|████▎     | 13/30 [01:28<01:49,  6.46s/it]{'epoch': 9, 'num_users': 6.3571, 'loss': 0.0423, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8665, 'compress@10': 0.9054, 'time@10': 9.1691}:  43%|████▎     | 13/30 [01:31<01:49,  6.46s/it]{'epoch': 9, 'num_users': 6.3571, 'loss': 0.0423, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8665, 'compress@10': 0.9054, 'time@10': 9.1691}:  47%|████▋     | 14/30 [01:31<01:23,  5.22s/it]{'epoch': 9, 'num_users': 6.2667, 'loss': 0.0426, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8662, 'compress@10': 0.9053, 'time@10': 9.4277}:  47%|████▋     | 14/30 [01:37<01:23,  5.22s/it]{'epoch': 9, 'num_users': 6.2667, 'loss': 0.0426, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8662, 'compress@10': 0.9053, 'time@10': 9.4277}:  50%|█████     | 15/30 [01:37<01:24,  5.62s/it]{'epoch': 9, 'num_users': 6.0625, 'loss': 0.0407, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8669, 'compress@10': 0.9055, 'time@10': 9.1422}:  50%|█████     | 15/30 [01:42<01:24,  5.62s/it]{'epoch': 9, 'num_users': 6.0625, 'loss': 0.0407, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8669, 'compress@10': 0.9055, 'time@10': 9.1422}:  53%|█████▎    | 16/30 [01:42<01:15,  5.40s/it]{'epoch': 9, 'num_users': 5.8235, 'loss': 0.0389, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8598, 'compress@10': 0.9063, 'time@10': 8.8007}:  53%|█████▎    | 16/30 [01:44<01:15,  5.40s/it] {'epoch': 9, 'num_users': 5.8235, 'loss': 0.0389, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8598, 'compress@10': 0.9063, 'time@10': 8.8007}:  57%|█████▋    | 17/30 [01:44<00:55,  4.29s/it]{'epoch': 9, 'num_users': 6.0556, 'loss': 0.0394, 'hit_ratio@10': 0.818, 'ndcg@10': 0.8604, 'compress@10': 0.9062, 'time@10': 8.672}:  57%|█████▋    | 17/30 [01:51<00:55,  4.29s/it] {'epoch': 9, 'num_users': 6.0556, 'loss': 0.0394, 'hit_ratio@10': 0.818, 'ndcg@10': 0.8604, 'compress@10': 0.9062, 'time@10': 8.672}:  60%|██████    | 18/30 [01:51<00:59,  4.96s/it]{'epoch': 9, 'num_users': 6.0, 'loss': 0.0382, 'hit_ratio@10': 0.8201, 'ndcg@10': 0.8625, 'compress@10': 0.9062, 'time@10': 8.5406}:  60%|██████    | 18/30 [01:54<00:59,  4.96s/it] {'epoch': 9, 'num_users': 6.0, 'loss': 0.0382, 'hit_ratio@10': 0.8201, 'ndcg@10': 0.8625, 'compress@10': 0.9062, 'time@10': 8.5406}:  63%|██████▎   | 19/30 [01:54<00:48,  4.41s/it]{'epoch': 9, 'num_users': 6.15, 'loss': 0.0387, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8615, 'compress@10': 0.906, 'time@10': 8.7387}:  63%|██████▎   | 19/30 [02:06<00:48,  4.41s/it]{'epoch': 9, 'num_users': 6.15, 'loss': 0.0387, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8615, 'compress@10': 0.906, 'time@10': 8.7387}:  67%|██████▋   | 20/30 [02:06<01:08,  6.85s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0402, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8592, 'compress@10': 0.9058, 'time@10': 8.8764}:  67%|██████▋   | 20/30 [02:12<01:08,  6.85s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0402, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8592, 'compress@10': 0.9058, 'time@10': 8.8764}:  70%|███████   | 21/30 [02:12<00:58,  6.55s/it]{'epoch': 9, 'num_users': 6.1818, 'loss': 0.0409, 'hit_ratio@10': 0.8255, 'ndcg@10': 0.8623, 'compress@10': 0.9058, 'time@10': 8.7217}:  70%|███████   | 21/30 [02:18<00:58,  6.55s/it]{'epoch': 9, 'num_users': 6.1818, 'loss': 0.0409, 'hit_ratio@10': 0.8255, 'ndcg@10': 0.8623, 'compress@10': 0.9058, 'time@10': 8.7217}:  73%|███████▎  | 22/30 [02:18<00:49,  6.24s/it]{'epoch': 9, 'num_users': 6.1304, 'loss': 0.0404, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8636, 'compress@10': 0.9057, 'time@10': 8.7389}:  73%|███████▎  | 22/30 [02:22<00:49,  6.24s/it]{'epoch': 9, 'num_users': 6.1304, 'loss': 0.0404, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8636, 'compress@10': 0.9057, 'time@10': 8.7389}:  77%|███████▋  | 23/30 [02:22<00:40,  5.74s/it]{'epoch': 9, 'num_users': 5.9583, 'loss': 0.0399, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8577, 'compress@10': 0.9063, 'time@10': 8.4547}:  77%|███████▋  | 23/30 [02:24<00:40,  5.74s/it]{'epoch': 9, 'num_users': 5.9583, 'loss': 0.0399, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8577, 'compress@10': 0.9063, 'time@10': 8.4547}:  80%|████████  | 24/30 [02:24<00:27,  4.61s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0388, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8483, 'compress@10': 0.9074, 'time@10': 8.1906}:  80%|████████  | 24/30 [02:25<00:27,  4.61s/it]   {'epoch': 9, 'num_users': 5.8, 'loss': 0.0388, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8483, 'compress@10': 0.9074, 'time@10': 8.1906}:  83%|████████▎ | 25/30 [02:25<00:17,  3.51s/it]{'epoch': 9, 'num_users': 5.8077, 'loss': 0.0395, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8477, 'compress@10': 0.9072, 'time@10': 8.4074}:  83%|████████▎ | 25/30 [02:39<00:17,  3.51s/it]{'epoch': 9, 'num_users': 5.8077, 'loss': 0.0395, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8477, 'compress@10': 0.9072, 'time@10': 8.4074}:  87%|████████▋ | 26/30 [02:39<00:26,  6.62s/it]{'epoch': 9, 'num_users': 5.8889, 'loss': 0.0396, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8483, 'compress@10': 0.907, 'time@10': 8.5963}:  87%|████████▋ | 26/30 [02:46<00:26,  6.62s/it] {'epoch': 9, 'num_users': 5.8889, 'loss': 0.0396, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8483, 'compress@10': 0.907, 'time@10': 8.5963}:  90%|█████████ | 27/30 [02:46<00:20,  6.67s/it]{'epoch': 9, 'num_users': 6.0, 'loss': 0.0398, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8485, 'compress@10': 0.9068, 'time@10': 8.7268}:  90%|█████████ | 27/30 [02:58<00:20,  6.67s/it]  {'epoch': 9, 'num_users': 6.0, 'loss': 0.0398, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8485, 'compress@10': 0.9068, 'time@10': 8.7268}:  93%|█████████▎| 28/30 [02:58<00:16,  8.36s/it]{'epoch': 9, 'num_users': 5.8621, 'loss': 0.0395, 'hit_ratio@10': 0.8343, 'ndcg@10': 0.8505, 'compress@10': 0.9068, 'time@10': 8.7613}:  93%|█████████▎| 28/30 [03:03<00:16,  8.36s/it]{'epoch': 9, 'num_users': 5.8621, 'loss': 0.0395, 'hit_ratio@10': 0.8343, 'ndcg@10': 0.8505, 'compress@10': 0.9068, 'time@10': 8.7613}:  97%|█████████▋| 29/30 [03:03<00:07,  7.32s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0394, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8523, 'compress@10': 0.9066, 'time@10': 8.7862}:  97%|█████████▋| 29/30 [03:12<00:07,  7.32s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0394, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8523, 'compress@10': 0.9066, 'time@10': 8.7862}: 100%|██████████| 30/30 [03:12<00:00,  7.99s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0394, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8523, 'compress@10': 0.9066, 'time@10': 8.7862}: 100%|██████████| 30/30 [03:12<00:00,  6.43s/it]
Epoch: 9
Avg # of users: 5.866666666666666
Avg Loss: 0.03944987474448187
Avg hit ratio: 0.8325866922192785
Avg ndcg: 0.8523398040943586
Avg compression ratio: 0.9066299336537634
Avg train time: 8.78620441754659
Std train time: 3.725435464831356
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 10, 18, 10, 20, 9, 18, 20, 10, 10, 9, 6, 11, 10, 20, 20, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.9052, 'time@10': 11.7156}:   0%|          | 0/30 [00:05<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.9052, 'time@10': 11.7156}:   3%|▎         | 1/30 [00:05<02:50,  5.89s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8676, 'compress@10': 0.9042, 'time@10': 9.6603}:   3%|▎         | 1/30 [00:13<02:50,  5.89s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8676, 'compress@10': 0.9042, 'time@10': 9.6603}:   7%|▋         | 2/30 [00:13<03:13,  6.92s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8641, 'compress@10': 0.9076, 'time@10': 8.1096}:   7%|▋         | 2/30 [00:16<03:13,  6.92s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8641, 'compress@10': 0.9076, 'time@10': 8.1096}:  10%|█         | 3/30 [00:16<02:12,  4.92s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0327, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8596, 'compress@10': 0.9066, 'time@10': 7.7652}:  10%|█         | 3/30 [00:22<02:12,  4.92s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0327, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8596, 'compress@10': 0.9066, 'time@10': 7.7652}:  13%|█▎        | 4/30 [00:22<02:26,  5.65s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0432, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.843, 'compress@10': 0.9057, 'time@10': 8.6762}:  13%|█▎        | 4/30 [00:29<02:26,  5.65s/it] {'epoch': 10, 'num_users': 5.8, 'loss': 0.0432, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.843, 'compress@10': 0.9057, 'time@10': 8.6762}:  17%|█▋        | 5/30 [00:29<02:26,  5.85s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0451, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8426, 'compress@10': 0.9051, 'time@10': 9.0729}:  17%|█▋        | 5/30 [00:40<02:26,  5.85s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0451, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8426, 'compress@10': 0.9051, 'time@10': 9.0729}:  20%|██        | 6/30 [00:40<03:03,  7.63s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0449, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8495, 'compress@10': 0.9049, 'time@10': 9.6255}:  20%|██        | 6/30 [00:46<03:03,  7.63s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0449, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8495, 'compress@10': 0.9049, 'time@10': 9.6255}:  23%|██▎       | 7/30 [00:46<02:47,  7.27s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0446, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8588, 'compress@10': 0.9047, 'time@10': 9.5289}:  23%|██▎       | 7/30 [00:55<02:47,  7.27s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0446, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8588, 'compress@10': 0.9047, 'time@10': 9.5289}:  27%|██▋       | 8/30 [00:55<02:51,  7.78s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0444, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8678, 'compress@10': 0.9045, 'time@10': 9.7989}:  27%|██▋       | 8/30 [01:01<02:51,  7.78s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0444, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8678, 'compress@10': 0.9045, 'time@10': 9.7989}:  30%|███       | 9/30 [01:01<02:31,  7.23s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0442, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8667, 'compress@10': 0.9042, 'time@10': 9.9375}:  30%|███       | 9/30 [01:12<02:31,  7.23s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0442, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8667, 'compress@10': 0.9042, 'time@10': 9.9375}:  33%|███▎      | 10/30 [01:12<02:49,  8.46s/it]{'epoch': 10, 'num_users': 6.6364, 'loss': 0.0458, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8683, 'compress@10': 0.9042, 'time@10': 10.1942}:  33%|███▎      | 10/30 [01:19<02:49,  8.46s/it]{'epoch': 10, 'num_users': 6.6364, 'loss': 0.0458, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8683, 'compress@10': 0.9042, 'time@10': 10.1942}:  37%|███▋      | 11/30 [01:19<02:28,  7.84s/it]{'epoch': 10, 'num_users': 6.4167, 'loss': 0.0432, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8712, 'compress@10': 0.9045, 'time@10': 9.7892}:  37%|███▋      | 11/30 [01:24<02:28,  7.84s/it] {'epoch': 10, 'num_users': 6.4167, 'loss': 0.0432, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8712, 'compress@10': 0.9045, 'time@10': 9.7892}:  40%|████      | 12/30 [01:24<02:07,  7.09s/it]{'epoch': 10, 'num_users': 6.6154, 'loss': 0.0435, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8724, 'compress@10': 0.9045, 'time@10': 9.8782}:  40%|████      | 12/30 [01:30<02:07,  7.09s/it]{'epoch': 10, 'num_users': 6.6154, 'loss': 0.0435, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8724, 'compress@10': 0.9045, 'time@10': 9.8782}:  43%|████▎     | 13/30 [01:30<01:52,  6.61s/it]{'epoch': 10, 'num_users': 6.3571, 'loss': 0.041, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8679, 'compress@10': 0.9054, 'time@10': 9.359}:  43%|████▎     | 13/30 [01:32<01:52,  6.61s/it]  {'epoch': 10, 'num_users': 6.3571, 'loss': 0.041, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8679, 'compress@10': 0.9054, 'time@10': 9.359}:  47%|████▋     | 14/30 [01:32<01:26,  5.41s/it]{'epoch': 10, 'num_users': 6.2667, 'loss': 0.0415, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8676, 'compress@10': 0.9053, 'time@10': 9.6645}:  47%|████▋     | 14/30 [01:39<01:26,  5.41s/it]{'epoch': 10, 'num_users': 6.2667, 'loss': 0.0415, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8676, 'compress@10': 0.9053, 'time@10': 9.6645}:  50%|█████     | 15/30 [01:39<01:28,  5.89s/it]{'epoch': 10, 'num_users': 6.0625, 'loss': 0.0397, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8691, 'compress@10': 0.9055, 'time@10': 9.3591}:  50%|█████     | 15/30 [01:44<01:28,  5.89s/it]{'epoch': 10, 'num_users': 6.0625, 'loss': 0.0397, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8691, 'compress@10': 0.9055, 'time@10': 9.3591}:  53%|█████▎    | 16/30 [01:44<01:17,  5.57s/it]{'epoch': 10, 'num_users': 5.8235, 'loss': 0.0378, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8618, 'compress@10': 0.9063, 'time@10': 9.0318}:  53%|█████▎    | 16/30 [01:46<01:17,  5.57s/it]{'epoch': 10, 'num_users': 5.8235, 'loss': 0.0378, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8618, 'compress@10': 0.9063, 'time@10': 9.0318}:  57%|█████▋    | 17/30 [01:46<00:58,  4.48s/it]{'epoch': 10, 'num_users': 6.0556, 'loss': 0.0384, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8627, 'compress@10': 0.9062, 'time@10': 8.8873}:  57%|█████▋    | 17/30 [01:52<00:58,  4.48s/it]{'epoch': 10, 'num_users': 6.0556, 'loss': 0.0384, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8627, 'compress@10': 0.9062, 'time@10': 8.8873}:  60%|██████    | 18/30 [01:52<01:00,  5.08s/it]{'epoch': 10, 'num_users': 6.0, 'loss': 0.0372, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8645, 'compress@10': 0.9062, 'time@10': 8.7471}:  60%|██████    | 18/30 [01:56<01:00,  5.08s/it]   {'epoch': 10, 'num_users': 6.0, 'loss': 0.0372, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8645, 'compress@10': 0.9062, 'time@10': 8.7471}:  63%|██████▎   | 19/30 [01:56<00:49,  4.50s/it]{'epoch': 10, 'num_users': 6.15, 'loss': 0.0376, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8637, 'compress@10': 0.906, 'time@10': 8.9722}:  63%|██████▎   | 19/30 [02:09<00:49,  4.50s/it]{'epoch': 10, 'num_users': 6.15, 'loss': 0.0376, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8637, 'compress@10': 0.906, 'time@10': 8.9722}:  67%|██████▋   | 20/30 [02:09<01:11,  7.15s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0393, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.8614, 'compress@10': 0.9058, 'time@10': 9.2527}:  67%|██████▋   | 20/30 [02:16<01:11,  7.15s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0393, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.8614, 'compress@10': 0.9058, 'time@10': 9.2527}:  70%|███████   | 21/30 [02:16<01:05,  7.25s/it]{'epoch': 10, 'num_users': 6.1818, 'loss': 0.0397, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.8639, 'compress@10': 0.9058, 'time@10': 9.1015}:  70%|███████   | 21/30 [02:22<01:05,  7.25s/it]{'epoch': 10, 'num_users': 6.1818, 'loss': 0.0397, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.8639, 'compress@10': 0.9058, 'time@10': 9.1015}:  73%|███████▎  | 22/30 [02:22<00:54,  6.86s/it]{'epoch': 10, 'num_users': 6.1304, 'loss': 0.0392, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8654, 'compress@10': 0.9057, 'time@10': 9.1295}:  73%|███████▎  | 22/30 [02:27<00:54,  6.86s/it]{'epoch': 10, 'num_users': 6.1304, 'loss': 0.0392, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8654, 'compress@10': 0.9057, 'time@10': 9.1295}:  77%|███████▋  | 23/30 [02:27<00:43,  6.28s/it]{'epoch': 10, 'num_users': 5.9583, 'loss': 0.0387, 'hit_ratio@10': 0.83, 'ndcg@10': 0.8594, 'compress@10': 0.9063, 'time@10': 8.8353}:  77%|███████▋  | 23/30 [02:29<00:43,  6.28s/it]  {'epoch': 10, 'num_users': 5.9583, 'loss': 0.0387, 'hit_ratio@10': 0.83, 'ndcg@10': 0.8594, 'compress@10': 0.9063, 'time@10': 8.8353}:  80%|████████  | 24/30 [02:29<00:30,  5.02s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0375, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8499, 'compress@10': 0.9074, 'time@10': 8.5614}:  80%|████████  | 24/30 [02:30<00:30,  5.02s/it] {'epoch': 10, 'num_users': 5.8, 'loss': 0.0375, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8499, 'compress@10': 0.9074, 'time@10': 8.5614}:  83%|████████▎ | 25/30 [02:30<00:19,  3.83s/it]{'epoch': 10, 'num_users': 5.8077, 'loss': 0.0383, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8496, 'compress@10': 0.9072, 'time@10': 8.7681}:  83%|████████▎ | 25/30 [02:44<00:19,  3.83s/it]{'epoch': 10, 'num_users': 5.8077, 'loss': 0.0383, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8496, 'compress@10': 0.9072, 'time@10': 8.7681}:  87%|████████▋ | 26/30 [02:44<00:27,  6.88s/it]{'epoch': 10, 'num_users': 5.8889, 'loss': 0.0383, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8501, 'compress@10': 0.907, 'time@10': 8.9484}:  87%|████████▋ | 26/30 [02:51<00:27,  6.88s/it]{'epoch': 10, 'num_users': 5.8889, 'loss': 0.0383, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8501, 'compress@10': 0.907, 'time@10': 8.9484}:  90%|█████████ | 27/30 [02:51<00:20,  6.87s/it]{'epoch': 10, 'num_users': 6.0, 'loss': 0.0384, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8507, 'compress@10': 0.9068, 'time@10': 9.077}:  90%|█████████ | 27/30 [03:04<00:20,  6.87s/it]   {'epoch': 10, 'num_users': 6.0, 'loss': 0.0384, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8507, 'compress@10': 0.9068, 'time@10': 9.077}:  93%|█████████▎| 28/30 [03:04<00:17,  8.59s/it]{'epoch': 10, 'num_users': 5.8621, 'loss': 0.0381, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.853, 'compress@10': 0.9068, 'time@10': 9.1239}:  93%|█████████▎| 28/30 [03:09<00:17,  8.59s/it]{'epoch': 10, 'num_users': 5.8621, 'loss': 0.0381, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.853, 'compress@10': 0.9068, 'time@10': 9.1239}:  97%|█████████▋| 29/30 [03:09<00:07,  7.59s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.038, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8547, 'compress@10': 0.9066, 'time@10': 9.1148}:  97%|█████████▋| 29/30 [03:18<00:07,  7.59s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.038, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8547, 'compress@10': 0.9066, 'time@10': 9.1148}: 100%|██████████| 30/30 [03:18<00:00,  7.98s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.038, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8547, 'compress@10': 0.9066, 'time@10': 9.1148}: 100%|██████████| 30/30 [03:18<00:00,  6.62s/it]
Epoch: 10
Avg # of users: 5.866666666666666
Avg Loss: 0.038035483104371055
Avg hit ratio: 0.8391494660896452
Avg ndcg: 0.8547485826074972
Avg compression ratio: 0.9066299388881904
Avg train time: 9.114848184585572
Std train time: 3.8744123353471793
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 5, 10, 10, 10, 7, 10, 10, 18, 10, 21, 9, 18, 21, 10, 10, 9, 5, 11, 10, 21, 21, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0534, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8518, 'compress@10': 0.9052, 'time@10': 9.9247}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0534, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8518, 'compress@10': 0.9052, 'time@10': 9.9247}:   3%|▎         | 1/30 [00:04<02:24,  5.00s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8687, 'compress@10': 0.9042, 'time@10': 8.7502}:   3%|▎         | 1/30 [00:12<02:24,  5.00s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8687, 'compress@10': 0.9042, 'time@10': 8.7502}:   7%|▋         | 2/30 [00:12<03:02,  6.54s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8648, 'compress@10': 0.9076, 'time@10': 7.5186}:   7%|▋         | 2/30 [00:15<03:02,  6.54s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8648, 'compress@10': 0.9076, 'time@10': 7.5186}:  10%|█         | 3/30 [00:15<02:07,  4.72s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.822, 'ndcg@10': 0.858, 'compress@10': 0.9066, 'time@10': 7.3258}:  10%|█         | 3/30 [00:21<02:07,  4.72s/it]  {'epoch': 11, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.822, 'ndcg@10': 0.858, 'compress@10': 0.9066, 'time@10': 7.3258}:  13%|█▎        | 4/30 [00:21<02:23,  5.54s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0442, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8425, 'compress@10': 0.9057, 'time@10': 8.3111}:  13%|█▎        | 4/30 [00:28<02:23,  5.54s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0442, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8425, 'compress@10': 0.9057, 'time@10': 8.3111}:  17%|█▋        | 5/30 [00:28<02:24,  5.76s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0452, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8419, 'compress@10': 0.9051, 'time@10': 8.7594}:  17%|█▋        | 5/30 [00:39<02:24,  5.76s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0452, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8419, 'compress@10': 0.9051, 'time@10': 8.7594}:  20%|██        | 6/30 [00:39<03:01,  7.56s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0441, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8427, 'compress@10': 0.9049, 'time@10': 9.4729}:  20%|██        | 6/30 [00:46<03:01,  7.56s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0441, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8427, 'compress@10': 0.9049, 'time@10': 9.4729}:  23%|██▎       | 7/30 [00:46<02:48,  7.35s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0436, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8518, 'compress@10': 0.9047, 'time@10': 9.5634}:  23%|██▎       | 7/30 [00:56<02:48,  7.35s/it]  {'epoch': 11, 'num_users': 6.125, 'loss': 0.0436, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8518, 'compress@10': 0.9047, 'time@10': 9.5634}:  27%|██▋       | 8/30 [00:56<03:02,  8.27s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0434, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8616, 'compress@10': 0.9045, 'time@10': 10.1066}:  27%|██▋       | 8/30 [01:03<03:02,  8.27s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0434, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8616, 'compress@10': 0.9045, 'time@10': 10.1066}:  30%|███       | 9/30 [01:03<02:47,  7.97s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0424, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8648, 'compress@10': 0.9042, 'time@10': 10.2218}:  30%|███       | 9/30 [01:14<02:47,  7.97s/it]    {'epoch': 11, 'num_users': 6.3, 'loss': 0.0424, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8648, 'compress@10': 0.9042, 'time@10': 10.2218}:  33%|███▎      | 10/30 [01:14<02:59,  9.00s/it]{'epoch': 11, 'num_users': 6.6364, 'loss': 0.0434, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8655, 'compress@10': 0.9042, 'time@10': 10.3477}:  33%|███▎      | 10/30 [01:20<02:59,  9.00s/it]{'epoch': 11, 'num_users': 6.6364, 'loss': 0.0434, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8655, 'compress@10': 0.9042, 'time@10': 10.3477}:  37%|███▋      | 11/30 [01:20<02:32,  8.03s/it]{'epoch': 11, 'num_users': 6.4167, 'loss': 0.0409, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8687, 'compress@10': 0.9045, 'time@10': 9.8738}:  37%|███▋      | 11/30 [01:25<02:32,  8.03s/it] {'epoch': 11, 'num_users': 6.4167, 'loss': 0.0409, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8687, 'compress@10': 0.9045, 'time@10': 9.8738}:  40%|████      | 12/30 [01:25<02:06,  7.02s/it]{'epoch': 11, 'num_users': 6.6154, 'loss': 0.0412, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8704, 'compress@10': 0.9045, 'time@10': 9.9071}:  40%|████      | 12/30 [01:30<02:06,  7.02s/it]{'epoch': 11, 'num_users': 6.6154, 'loss': 0.0412, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8704, 'compress@10': 0.9045, 'time@10': 9.9071}:  43%|████▎     | 13/30 [01:30<01:49,  6.46s/it]{'epoch': 11, 'num_users': 6.3571, 'loss': 0.0388, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.8661, 'compress@10': 0.9054, 'time@10': 9.3854}:  43%|████▎     | 13/30 [01:33<01:49,  6.46s/it]{'epoch': 11, 'num_users': 6.3571, 'loss': 0.0388, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.8661, 'compress@10': 0.9054, 'time@10': 9.3854}:  47%|████▋     | 14/30 [01:33<01:24,  5.31s/it]{'epoch': 11, 'num_users': 6.2667, 'loss': 0.0398, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8654, 'compress@10': 0.9053, 'time@10': 9.6495}:  47%|████▋     | 14/30 [01:40<01:24,  5.31s/it]{'epoch': 11, 'num_users': 6.2667, 'loss': 0.0398, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8654, 'compress@10': 0.9053, 'time@10': 9.6495}:  50%|█████     | 15/30 [01:40<01:25,  5.73s/it]{'epoch': 11, 'num_users': 6.0625, 'loss': 0.038, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8671, 'compress@10': 0.9055, 'time@10': 9.3544}:  50%|█████     | 15/30 [01:44<01:25,  5.73s/it] {'epoch': 11, 'num_users': 6.0625, 'loss': 0.038, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8671, 'compress@10': 0.9055, 'time@10': 9.3544}:  53%|█████▎    | 16/30 [01:44<01:16,  5.50s/it]{'epoch': 11, 'num_users': 5.8235, 'loss': 0.0362, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8608, 'compress@10': 0.9063, 'time@10': 9.0413}:  53%|█████▎    | 16/30 [01:47<01:16,  5.50s/it]{'epoch': 11, 'num_users': 5.8235, 'loss': 0.0362, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8608, 'compress@10': 0.9063, 'time@10': 9.0413}:  57%|█████▋    | 17/30 [01:47<00:58,  4.46s/it]{'epoch': 11, 'num_users': 6.0556, 'loss': 0.0368, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8617, 'compress@10': 0.9062, 'time@10': 8.911}:  57%|█████▋    | 17/30 [01:53<00:58,  4.46s/it] {'epoch': 11, 'num_users': 6.0556, 'loss': 0.0368, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8617, 'compress@10': 0.9062, 'time@10': 8.911}:  60%|██████    | 18/30 [01:53<01:01,  5.14s/it]{'epoch': 11, 'num_users': 6.0, 'loss': 0.0356, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8635, 'compress@10': 0.9062, 'time@10': 8.7751}:  60%|██████    | 18/30 [01:56<01:01,  5.14s/it]  {'epoch': 11, 'num_users': 6.0, 'loss': 0.0356, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8635, 'compress@10': 0.9062, 'time@10': 8.7751}:  63%|██████▎   | 19/30 [01:56<00:50,  4.56s/it]{'epoch': 11, 'num_users': 6.15, 'loss': 0.036, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8627, 'compress@10': 0.906, 'time@10': 8.9485}:  63%|██████▎   | 19/30 [02:09<00:50,  4.56s/it] {'epoch': 11, 'num_users': 6.15, 'loss': 0.036, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8627, 'compress@10': 0.906, 'time@10': 8.9485}:  67%|██████▋   | 20/30 [02:09<01:08,  6.88s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0375, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8606, 'compress@10': 0.9058, 'time@10': 8.9824}:  67%|██████▋   | 20/30 [02:14<01:08,  6.88s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0375, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8606, 'compress@10': 0.9058, 'time@10': 8.9824}:  70%|███████   | 21/30 [02:14<00:56,  6.27s/it]{'epoch': 11, 'num_users': 6.1818, 'loss': 0.0381, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8646, 'compress@10': 0.9058, 'time@10': 8.8244}:  70%|███████   | 21/30 [02:19<00:56,  6.27s/it]{'epoch': 11, 'num_users': 6.1818, 'loss': 0.0381, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8646, 'compress@10': 0.9058, 'time@10': 8.8244}:  73%|███████▎  | 22/30 [02:19<00:48,  6.05s/it]{'epoch': 11, 'num_users': 6.1304, 'loss': 0.0378, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8662, 'compress@10': 0.9057, 'time@10': 8.8419}:  73%|███████▎  | 22/30 [02:24<00:48,  6.05s/it] {'epoch': 11, 'num_users': 6.1304, 'loss': 0.0378, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8662, 'compress@10': 0.9057, 'time@10': 8.8419}:  77%|███████▋  | 23/30 [02:24<00:39,  5.63s/it]{'epoch': 11, 'num_users': 5.9583, 'loss': 0.0373, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8602, 'compress@10': 0.9063, 'time@10': 8.5611}:  77%|███████▋  | 23/30 [02:26<00:39,  5.63s/it]{'epoch': 11, 'num_users': 5.9583, 'loss': 0.0373, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8602, 'compress@10': 0.9063, 'time@10': 8.5611}:  80%|████████  | 24/30 [02:26<00:27,  4.58s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0361, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8506, 'compress@10': 0.9074, 'time@10': 8.3016}:  80%|████████  | 24/30 [02:27<00:27,  4.58s/it]   {'epoch': 11, 'num_users': 5.8, 'loss': 0.0361, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8506, 'compress@10': 0.9074, 'time@10': 8.3016}:  83%|████████▎ | 25/30 [02:27<00:17,  3.53s/it]{'epoch': 11, 'num_users': 5.8077, 'loss': 0.0367, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.8505, 'compress@10': 0.9072, 'time@10': 8.5113}:  83%|████████▎ | 25/30 [02:41<00:17,  3.53s/it]{'epoch': 11, 'num_users': 5.8077, 'loss': 0.0367, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.8505, 'compress@10': 0.9072, 'time@10': 8.5113}:  87%|████████▋ | 26/30 [02:41<00:26,  6.61s/it]{'epoch': 11, 'num_users': 5.8889, 'loss': 0.0368, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8509, 'compress@10': 0.907, 'time@10': 8.6957}:  87%|████████▋ | 26/30 [02:48<00:26,  6.61s/it] {'epoch': 11, 'num_users': 5.8889, 'loss': 0.0368, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8509, 'compress@10': 0.907, 'time@10': 8.6957}:  90%|█████████ | 27/30 [02:48<00:19,  6.66s/it]{'epoch': 11, 'num_users': 6.0, 'loss': 0.0369, 'hit_ratio@10': 0.8453, 'ndcg@10': 0.8518, 'compress@10': 0.9068, 'time@10': 8.8358}:  90%|█████████ | 27/30 [03:00<00:19,  6.66s/it]  {'epoch': 11, 'num_users': 6.0, 'loss': 0.0369, 'hit_ratio@10': 0.8453, 'ndcg@10': 0.8518, 'compress@10': 0.9068, 'time@10': 8.8358}:  93%|█████████▎| 28/30 [03:00<00:16,  8.46s/it]{'epoch': 11, 'num_users': 5.8621, 'loss': 0.0367, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8543, 'compress@10': 0.9068, 'time@10': 8.9473}:  93%|█████████▎| 28/30 [03:06<00:16,  8.46s/it]{'epoch': 11, 'num_users': 5.8621, 'loss': 0.0367, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8543, 'compress@10': 0.9068, 'time@10': 8.9473}:  97%|█████████▋| 29/30 [03:06<00:07,  7.75s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0367, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8561, 'compress@10': 0.9066, 'time@10': 8.986}:  97%|█████████▋| 29/30 [03:16<00:07,  7.75s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0367, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8561, 'compress@10': 0.9066, 'time@10': 8.986}: 100%|██████████| 30/30 [03:16<00:00,  8.47s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0367, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8561, 'compress@10': 0.9066, 'time@10': 8.986}: 100%|██████████| 30/30 [03:16<00:00,  6.57s/it]
Epoch: 11
Avg # of users: 5.866666666666666
Avg Loss: 0.036658367392426526
Avg hit ratio: 0.8486750514434038
Avg ndcg: 0.8560749685912422
Avg compression ratio: 0.9066299377336847
Avg train time: 8.985971109072368
Std train time: 3.75532228294069
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 5, 10, 10, 10, 6, 10, 10, 19, 10, 22, 9, 18, 22, 10, 10, 9, 5, 11, 10, 22, 22, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0535, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.845, 'compress@10': 0.9052, 'time@10': 9.1615}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0535, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.845, 'compress@10': 0.9052, 'time@10': 9.1615}:   3%|▎         | 1/30 [00:04<02:13,  4.62s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0448, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8645, 'compress@10': 0.9042, 'time@10': 8.4939}:   3%|▎         | 1/30 [00:12<02:13,  4.62s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0448, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8645, 'compress@10': 0.9042, 'time@10': 8.4939}:   7%|▋         | 2/30 [00:12<03:02,  6.53s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8621, 'compress@10': 0.9076, 'time@10': 7.4763}:   7%|▋         | 2/30 [00:15<03:02,  6.53s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8621, 'compress@10': 0.9076, 'time@10': 7.4763}:  10%|█         | 3/30 [00:15<02:09,  4.81s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8455, 'compress@10': 0.9066, 'time@10': 7.4124}:  10%|█         | 3/30 [00:22<02:09,  4.81s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8455, 'compress@10': 0.9066, 'time@10': 7.4124}:  13%|█▎        | 4/30 [00:22<02:30,  5.77s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0456, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8311, 'compress@10': 0.9057, 'time@10': 8.5841}:  13%|█▎        | 4/30 [00:29<02:30,  5.77s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0456, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8311, 'compress@10': 0.9057, 'time@10': 8.5841}:  17%|█▋        | 5/30 [00:29<02:32,  6.10s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0461, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.833, 'compress@10': 0.9051, 'time@10': 9.1815}:  17%|█▋        | 5/30 [00:41<02:32,  6.10s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0461, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.833, 'compress@10': 0.9051, 'time@10': 9.1815}:  20%|██        | 6/30 [00:41<03:16,  8.18s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0455, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8422, 'compress@10': 0.9049, 'time@10': 9.989}:  20%|██        | 6/30 [00:48<03:16,  8.18s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0455, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8422, 'compress@10': 0.9049, 'time@10': 9.989}:  23%|██▎       | 7/30 [00:48<03:02,  7.94s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0447, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8515, 'compress@10': 0.9047, 'time@10': 9.824}:  23%|██▎       | 7/30 [00:57<03:02,  7.94s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0447, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8515, 'compress@10': 0.9047, 'time@10': 9.824}:  27%|██▋       | 8/30 [00:57<03:00,  8.18s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0437, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.859, 'compress@10': 0.9045, 'time@10': 9.8805}:  27%|██▋       | 8/30 [01:02<03:00,  8.18s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0437, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.859, 'compress@10': 0.9045, 'time@10': 9.8805}:  30%|███       | 9/30 [01:02<02:32,  7.25s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0431, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8601, 'compress@10': 0.9042, 'time@10': 9.9537}:  30%|███       | 9/30 [01:13<02:32,  7.25s/it]  {'epoch': 12, 'num_users': 6.3, 'loss': 0.0431, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8601, 'compress@10': 0.9042, 'time@10': 9.9537}:  33%|███▎      | 10/30 [01:13<02:46,  8.30s/it]{'epoch': 12, 'num_users': 6.6364, 'loss': 0.0446, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8618, 'compress@10': 0.9042, 'time@10': 10.1651}:  33%|███▎      | 10/30 [01:19<02:46,  8.30s/it]{'epoch': 12, 'num_users': 6.6364, 'loss': 0.0446, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8618, 'compress@10': 0.9042, 'time@10': 10.1651}:  37%|███▋      | 11/30 [01:19<02:25,  7.65s/it]{'epoch': 12, 'num_users': 6.4167, 'loss': 0.042, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8654, 'compress@10': 0.9045, 'time@10': 9.7636}:  37%|███▋      | 11/30 [01:24<02:25,  7.65s/it]   {'epoch': 12, 'num_users': 6.4167, 'loss': 0.042, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8654, 'compress@10': 0.9045, 'time@10': 9.7636}:  40%|████      | 12/30 [01:24<02:05,  6.96s/it]{'epoch': 12, 'num_users': 6.6154, 'loss': 0.0421, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8674, 'compress@10': 0.9045, 'time@10': 9.7629}:  40%|████      | 12/30 [01:29<02:05,  6.96s/it]{'epoch': 12, 'num_users': 6.6154, 'loss': 0.0421, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8674, 'compress@10': 0.9045, 'time@10': 9.7629}:  43%|████▎     | 13/30 [01:29<01:47,  6.34s/it]{'epoch': 12, 'num_users': 6.3571, 'loss': 0.0396, 'hit_ratio@10': 0.8234, 'ndcg@10': 0.8633, 'compress@10': 0.9054, 'time@10': 9.2606}:  43%|████▎     | 13/30 [01:32<01:47,  6.34s/it]{'epoch': 12, 'num_users': 6.3571, 'loss': 0.0396, 'hit_ratio@10': 0.8234, 'ndcg@10': 0.8633, 'compress@10': 0.9054, 'time@10': 9.2606}:  47%|████▋     | 14/30 [01:32<01:24,  5.26s/it]{'epoch': 12, 'num_users': 6.2667, 'loss': 0.04, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.864, 'compress@10': 0.9053, 'time@10': 9.5134}:  47%|████▋     | 14/30 [01:39<01:24,  5.26s/it]   {'epoch': 12, 'num_users': 6.2667, 'loss': 0.04, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.864, 'compress@10': 0.9053, 'time@10': 9.5134}:  50%|█████     | 15/30 [01:39<01:24,  5.66s/it]{'epoch': 12, 'num_users': 6.0625, 'loss': 0.0381, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8658, 'compress@10': 0.9055, 'time@10': 9.23}:  50%|█████     | 15/30 [01:44<01:24,  5.66s/it]{'epoch': 12, 'num_users': 6.0625, 'loss': 0.0381, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8658, 'compress@10': 0.9055, 'time@10': 9.23}:  53%|█████▎    | 16/30 [01:44<01:16,  5.47s/it]{'epoch': 12, 'num_users': 5.8235, 'loss': 0.0363, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8596, 'compress@10': 0.9063, 'time@10': 8.9359}:  53%|█████▎    | 16/30 [01:46<01:16,  5.47s/it]{'epoch': 12, 'num_users': 5.8235, 'loss': 0.0363, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8596, 'compress@10': 0.9063, 'time@10': 8.9359}:  57%|█████▋    | 17/30 [01:46<00:58,  4.47s/it]{'epoch': 12, 'num_users': 6.0556, 'loss': 0.0366, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.8604, 'compress@10': 0.9062, 'time@10': 8.8433}:  57%|█████▋    | 17/30 [01:53<00:58,  4.47s/it]{'epoch': 12, 'num_users': 6.0556, 'loss': 0.0366, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.8604, 'compress@10': 0.9062, 'time@10': 8.8433}:  60%|██████    | 18/30 [01:53<01:03,  5.32s/it]{'epoch': 12, 'num_users': 6.0, 'loss': 0.0355, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8622, 'compress@10': 0.9062, 'time@10': 8.7282}:  60%|██████    | 18/30 [01:57<01:03,  5.32s/it]   {'epoch': 12, 'num_users': 6.0, 'loss': 0.0355, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8622, 'compress@10': 0.9062, 'time@10': 8.7282}:  63%|██████▎   | 19/30 [01:57<00:52,  4.73s/it]{'epoch': 12, 'num_users': 6.15, 'loss': 0.0359, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8619, 'compress@10': 0.906, 'time@10': 9.0036}:  63%|██████▎   | 19/30 [02:11<00:52,  4.73s/it] {'epoch': 12, 'num_users': 6.15, 'loss': 0.0359, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8619, 'compress@10': 0.906, 'time@10': 9.0036}:  67%|██████▋   | 20/30 [02:11<01:15,  7.60s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0374, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8597, 'compress@10': 0.9058, 'time@10': 9.0408}:  67%|██████▋   | 20/30 [02:16<01:15,  7.60s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0374, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8597, 'compress@10': 0.9058, 'time@10': 9.0408}:  70%|███████   | 21/30 [02:16<01:01,  6.80s/it]{'epoch': 12, 'num_users': 6.1818, 'loss': 0.0386, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8614, 'compress@10': 0.9058, 'time@10': 8.8862}:  70%|███████   | 21/30 [02:21<01:01,  6.80s/it]{'epoch': 12, 'num_users': 6.1818, 'loss': 0.0386, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8614, 'compress@10': 0.9058, 'time@10': 8.8862}:  73%|███████▎  | 22/30 [02:21<00:51,  6.46s/it]{'epoch': 12, 'num_users': 6.1304, 'loss': 0.038, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8633, 'compress@10': 0.9057, 'time@10': 8.9058}:  73%|███████▎  | 22/30 [02:26<00:51,  6.46s/it] {'epoch': 12, 'num_users': 6.1304, 'loss': 0.038, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8633, 'compress@10': 0.9057, 'time@10': 8.9058}:  77%|███████▋  | 23/30 [02:26<00:41,  5.93s/it]{'epoch': 12, 'num_users': 5.9583, 'loss': 0.0375, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8574, 'compress@10': 0.9063, 'time@10': 8.6279}:  77%|███████▋  | 23/30 [02:28<00:41,  5.93s/it]{'epoch': 12, 'num_users': 5.9583, 'loss': 0.0375, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8574, 'compress@10': 0.9063, 'time@10': 8.6279}:  80%|████████  | 24/30 [02:28<00:29,  4.84s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0363, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.848, 'compress@10': 0.9074, 'time@10': 8.3701}:  80%|████████  | 24/30 [02:30<00:29,  4.84s/it]    {'epoch': 12, 'num_users': 5.8, 'loss': 0.0363, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.848, 'compress@10': 0.9074, 'time@10': 8.3701}:  83%|████████▎ | 25/30 [02:30<00:18,  3.72s/it]{'epoch': 12, 'num_users': 5.8077, 'loss': 0.0368, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8481, 'compress@10': 0.9072, 'time@10': 8.5931}:  83%|████████▎ | 25/30 [02:44<00:18,  3.72s/it]{'epoch': 12, 'num_users': 5.8077, 'loss': 0.0368, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8481, 'compress@10': 0.9072, 'time@10': 8.5931}:  87%|████████▋ | 26/30 [02:44<00:27,  6.87s/it]{'epoch': 12, 'num_users': 5.8889, 'loss': 0.037, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8488, 'compress@10': 0.907, 'time@10': 8.7844}:  87%|████████▋ | 26/30 [02:51<00:27,  6.87s/it]  {'epoch': 12, 'num_users': 5.8889, 'loss': 0.037, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8488, 'compress@10': 0.907, 'time@10': 8.7844}:  90%|█████████ | 27/30 [02:51<00:20,  6.88s/it]{'epoch': 12, 'num_users': 6.0, 'loss': 0.0372, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8493, 'compress@10': 0.9068, 'time@10': 8.9263}:  90%|█████████ | 27/30 [03:03<00:20,  6.88s/it] {'epoch': 12, 'num_users': 6.0, 'loss': 0.0372, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8493, 'compress@10': 0.9068, 'time@10': 8.9263}:  93%|█████████▎| 28/30 [03:03<00:17,  8.66s/it]{'epoch': 12, 'num_users': 5.8621, 'loss': 0.0369, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8519, 'compress@10': 0.9068, 'time@10': 8.9802}:  93%|█████████▎| 28/30 [03:09<00:17,  8.66s/it]{'epoch': 12, 'num_users': 5.8621, 'loss': 0.0369, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8519, 'compress@10': 0.9068, 'time@10': 8.9802}:  97%|█████████▋| 29/30 [03:09<00:07,  7.64s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0368, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8538, 'compress@10': 0.9066, 'time@10': 8.9804}:  97%|█████████▋| 29/30 [03:18<00:07,  7.64s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0368, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8538, 'compress@10': 0.9066, 'time@10': 8.9804}: 100%|██████████| 30/30 [03:18<00:00,  8.06s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0368, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8538, 'compress@10': 0.9066, 'time@10': 8.9804}: 100%|██████████| 30/30 [03:18<00:00,  6.61s/it]
Epoch: 12
Avg # of users: 5.866666666666666
Avg Loss: 0.036847458718344314
Avg hit ratio: 0.8392836899423276
Avg ndcg: 0.8538414445838003
Avg compression ratio: 0.9066299476465502
Avg train time: 8.980407087008158
Std train time: 3.6929480463928352
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 5, 10, 9, 10, 6, 10, 10, 19, 10, 23, 9, 18, 23, 10, 10, 9, 5, 11, 10, 23, 23, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8594, 'compress@10': 0.9052, 'time@10': 9.1373}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8594, 'compress@10': 0.9052, 'time@10': 9.1373}:   3%|▎         | 1/30 [00:04<02:13,  4.61s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8717, 'compress@10': 0.9042, 'time@10': 8.6013}:   3%|▎         | 1/30 [00:12<02:13,  4.61s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8717, 'compress@10': 0.9042, 'time@10': 8.6013}:   7%|▋         | 2/30 [00:12<03:06,  6.66s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8669, 'compress@10': 0.9076, 'time@10': 7.416}:   7%|▋         | 2/30 [00:15<03:06,  6.66s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8669, 'compress@10': 0.9076, 'time@10': 7.416}:  10%|█         | 3/30 [00:15<02:09,  4.79s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8405, 'compress@10': 0.9066, 'time@10': 7.2545}:  10%|█         | 3/30 [00:22<02:09,  4.79s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8405, 'compress@10': 0.9066, 'time@10': 7.2545}:  13%|█▎        | 4/30 [00:22<02:25,  5.59s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0442, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8272, 'compress@10': 0.9057, 'time@10': 8.2247}:  13%|█▎        | 4/30 [00:28<02:25,  5.59s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0442, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8272, 'compress@10': 0.9057, 'time@10': 8.2247}:  17%|█▋        | 5/30 [00:28<02:24,  5.77s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0447, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8304, 'compress@10': 0.9051, 'time@10': 8.7622}:  17%|█▋        | 5/30 [00:39<02:24,  5.77s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0447, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8304, 'compress@10': 0.9051, 'time@10': 8.7622}:  20%|██        | 6/30 [00:39<03:05,  7.71s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0431, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.8383, 'compress@10': 0.9049, 'time@10': 9.41}:  20%|██        | 6/30 [00:46<03:05,  7.71s/it]  {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0431, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.8383, 'compress@10': 0.9049, 'time@10': 9.41}:  23%|██▎       | 7/30 [00:46<02:49,  7.38s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0426, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8485, 'compress@10': 0.9047, 'time@10': 9.4608}:  23%|██▎       | 7/30 [00:56<02:49,  7.38s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0426, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8485, 'compress@10': 0.9047, 'time@10': 9.4608}:  27%|██▋       | 8/30 [00:56<02:59,  8.17s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0425, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8562, 'compress@10': 0.9045, 'time@10': 9.6846}:  27%|██▋       | 8/30 [01:01<02:59,  8.17s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0425, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8562, 'compress@10': 0.9045, 'time@10': 9.6846}:  30%|███       | 9/30 [01:01<02:35,  7.42s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0416, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.861, 'compress@10': 0.9042, 'time@10': 9.7749}:  30%|███       | 9/30 [01:12<02:35,  7.42s/it]    {'epoch': 13, 'num_users': 6.3, 'loss': 0.0416, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.861, 'compress@10': 0.9042, 'time@10': 9.7749}:  33%|███▎      | 10/30 [01:12<02:48,  8.41s/it]{'epoch': 13, 'num_users': 6.6364, 'loss': 0.0442, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8659, 'compress@10': 0.9042, 'time@10': 10.0026}:  33%|███▎      | 10/30 [01:18<02:48,  8.41s/it]{'epoch': 13, 'num_users': 6.6364, 'loss': 0.0442, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8659, 'compress@10': 0.9042, 'time@10': 10.0026}:  37%|███▋      | 11/30 [01:18<02:26,  7.72s/it]{'epoch': 13, 'num_users': 6.4167, 'loss': 0.0415, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8691, 'compress@10': 0.9045, 'time@10': 9.6008}:  37%|███▋      | 11/30 [01:23<02:26,  7.72s/it]{'epoch': 13, 'num_users': 6.4167, 'loss': 0.0415, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8691, 'compress@10': 0.9045, 'time@10': 9.6008}:  40%|████      | 12/30 [01:23<02:05,  6.96s/it]{'epoch': 13, 'num_users': 6.6154, 'loss': 0.0416, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.871, 'compress@10': 0.9045, 'time@10': 9.6231}:  40%|████      | 12/30 [01:28<02:05,  6.96s/it] {'epoch': 13, 'num_users': 6.6154, 'loss': 0.0416, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.871, 'compress@10': 0.9045, 'time@10': 9.6231}:  43%|████▎     | 13/30 [01:28<01:48,  6.36s/it]{'epoch': 13, 'num_users': 6.3571, 'loss': 0.0391, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8675, 'compress@10': 0.9054, 'time@10': 9.1394}:  43%|████▎     | 13/30 [01:31<01:48,  6.36s/it]{'epoch': 13, 'num_users': 6.3571, 'loss': 0.0391, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8675, 'compress@10': 0.9054, 'time@10': 9.1394}:  47%|████▋     | 14/30 [01:31<01:25,  5.31s/it]{'epoch': 13, 'num_users': 6.2667, 'loss': 0.0392, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8685, 'compress@10': 0.9053, 'time@10': 9.3918}:  47%|████▋     | 14/30 [01:38<01:25,  5.31s/it]{'epoch': 13, 'num_users': 6.2667, 'loss': 0.0392, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8685, 'compress@10': 0.9053, 'time@10': 9.3918}:  50%|█████     | 15/30 [01:38<01:25,  5.67s/it]{'epoch': 13, 'num_users': 6.0625, 'loss': 0.0373, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8704, 'compress@10': 0.9055, 'time@10': 9.115}:  50%|█████     | 15/30 [01:43<01:25,  5.67s/it] {'epoch': 13, 'num_users': 6.0625, 'loss': 0.0373, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8704, 'compress@10': 0.9055, 'time@10': 9.115}:  53%|█████▎    | 16/30 [01:43<01:16,  5.48s/it]{'epoch': 13, 'num_users': 5.8235, 'loss': 0.0355, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8639, 'compress@10': 0.9063, 'time@10': 8.8398}:  53%|█████▎    | 16/30 [01:45<01:16,  5.48s/it]{'epoch': 13, 'num_users': 5.8235, 'loss': 0.0355, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8639, 'compress@10': 0.9063, 'time@10': 8.8398}:  57%|█████▋    | 17/30 [01:45<00:58,  4.51s/it]{'epoch': 13, 'num_users': 6.0556, 'loss': 0.0358, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8649, 'compress@10': 0.9062, 'time@10': 8.7227}:  57%|█████▋    | 17/30 [01:52<00:58,  4.51s/it]{'epoch': 13, 'num_users': 6.0556, 'loss': 0.0358, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8649, 'compress@10': 0.9062, 'time@10': 8.7227}:  60%|██████    | 18/30 [01:52<01:02,  5.19s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 0.0347, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.8664, 'compress@10': 0.9062, 'time@10': 8.5986}:  60%|██████    | 18/30 [01:55<01:02,  5.19s/it]   {'epoch': 13, 'num_users': 6.0, 'loss': 0.0347, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.8664, 'compress@10': 0.9062, 'time@10': 8.5986}:  63%|██████▎   | 19/30 [01:55<00:50,  4.60s/it]{'epoch': 13, 'num_users': 6.15, 'loss': 0.035, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.866, 'compress@10': 0.906, 'time@10': 8.8025}:  63%|██████▎   | 19/30 [02:08<00:50,  4.60s/it]  {'epoch': 13, 'num_users': 6.15, 'loss': 0.035, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.866, 'compress@10': 0.906, 'time@10': 8.8025}:  67%|██████▋   | 20/30 [02:08<01:10,  7.03s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0366, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.864, 'compress@10': 0.9058, 'time@10': 8.8418}:  67%|██████▋   | 20/30 [02:13<01:10,  7.03s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0366, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.864, 'compress@10': 0.9058, 'time@10': 8.8418}:  70%|███████   | 21/30 [02:13<00:57,  6.38s/it]{'epoch': 13, 'num_users': 6.1818, 'loss': 0.0367, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8657, 'compress@10': 0.9058, 'time@10': 8.6864}:  70%|███████   | 21/30 [02:18<00:57,  6.38s/it]{'epoch': 13, 'num_users': 6.1818, 'loss': 0.0367, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8657, 'compress@10': 0.9058, 'time@10': 8.6864}:  73%|███████▎  | 22/30 [02:18<00:48,  6.10s/it]{'epoch': 13, 'num_users': 6.1304, 'loss': 0.0362, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8677, 'compress@10': 0.9057, 'time@10': 8.7075}:  73%|███████▎  | 22/30 [02:23<00:48,  6.10s/it]{'epoch': 13, 'num_users': 6.1304, 'loss': 0.0362, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8677, 'compress@10': 0.9057, 'time@10': 8.7075}:  77%|███████▋  | 23/30 [02:23<00:39,  5.66s/it]{'epoch': 13, 'num_users': 5.9583, 'loss': 0.0356, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8626, 'compress@10': 0.9063, 'time@10': 8.4412}:  77%|███████▋  | 23/30 [02:25<00:39,  5.66s/it]{'epoch': 13, 'num_users': 5.9583, 'loss': 0.0356, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8626, 'compress@10': 0.9063, 'time@10': 8.4412}:  80%|████████  | 24/30 [02:25<00:27,  4.67s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0345, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8529, 'compress@10': 0.9074, 'time@10': 8.1965}:  80%|████████  | 24/30 [02:26<00:27,  4.67s/it]   {'epoch': 13, 'num_users': 5.8, 'loss': 0.0345, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8529, 'compress@10': 0.9074, 'time@10': 8.1965}:  83%|████████▎ | 25/30 [02:26<00:18,  3.63s/it]{'epoch': 13, 'num_users': 5.8077, 'loss': 0.0349, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8531, 'compress@10': 0.9072, 'time@10': 8.4191}:  83%|████████▎ | 25/30 [02:40<00:18,  3.63s/it]{'epoch': 13, 'num_users': 5.8077, 'loss': 0.0349, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8531, 'compress@10': 0.9072, 'time@10': 8.4191}:  87%|████████▋ | 26/30 [02:40<00:26,  6.74s/it]{'epoch': 13, 'num_users': 5.8889, 'loss': 0.0352, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8521, 'compress@10': 0.907, 'time@10': 8.6144}:  87%|████████▋ | 26/30 [02:47<00:26,  6.74s/it] {'epoch': 13, 'num_users': 5.8889, 'loss': 0.0352, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8521, 'compress@10': 0.907, 'time@10': 8.6144}:  90%|█████████ | 27/30 [02:47<00:20,  6.79s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 0.0352, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8531, 'compress@10': 0.9068, 'time@10': 8.8091}:  90%|█████████ | 27/30 [03:01<00:20,  6.79s/it]    {'epoch': 13, 'num_users': 6.0, 'loss': 0.0352, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8531, 'compress@10': 0.9068, 'time@10': 8.8091}:  93%|█████████▎| 28/30 [03:01<00:17,  8.99s/it]{'epoch': 13, 'num_users': 5.8621, 'loss': 0.0349, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8556, 'compress@10': 0.9068, 'time@10': 8.8442}:  93%|█████████▎| 28/30 [03:06<00:17,  8.99s/it]{'epoch': 13, 'num_users': 5.8621, 'loss': 0.0349, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8556, 'compress@10': 0.9068, 'time@10': 8.8442}:  97%|█████████▋| 29/30 [03:06<00:07,  7.78s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0349, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8575, 'compress@10': 0.9066, 'time@10': 8.8855}:  97%|█████████▋| 29/30 [03:16<00:07,  7.78s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0349, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8575, 'compress@10': 0.9066, 'time@10': 8.8855}: 100%|██████████| 30/30 [03:16<00:00,  8.48s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0349, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8575, 'compress@10': 0.9066, 'time@10': 8.8855}: 100%|██████████| 30/30 [03:16<00:00,  6.56s/it]
Epoch: 13
Avg # of users: 5.866666666666666
Avg Loss: 0.0349214838912267
Avg hit ratio: 0.852149005208115
Avg ndcg: 0.8574661336154621
Avg compression ratio: 0.9066299422531522
Avg train time: 8.885491752624512
Std train time: 3.5748571353027687
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 5, 10, 9, 10, 6, 10, 10, 19, 10, 24, 9, 18, 24, 10, 10, 9, 5, 11, 10, 24, 24, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8644, 'compress@10': 0.9052, 'time@10': 9.2819}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8644, 'compress@10': 0.9052, 'time@10': 9.2819}:   3%|▎         | 1/30 [00:04<02:16,  4.69s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.04, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8773, 'compress@10': 0.9042, 'time@10': 8.7075}:   3%|▎         | 1/30 [00:12<02:16,  4.69s/it]  {'epoch': 14, 'num_users': 7.0, 'loss': 0.04, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8773, 'compress@10': 0.9042, 'time@10': 8.7075}:   7%|▋         | 2/30 [00:12<03:08,  6.74s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8706, 'compress@10': 0.9076, 'time@10': 7.5124}:   7%|▋         | 2/30 [00:15<03:08,  6.74s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8706, 'compress@10': 0.9076, 'time@10': 7.5124}:  10%|█         | 3/30 [00:15<02:10,  4.85s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8476, 'compress@10': 0.9066, 'time@10': 7.3356}:  10%|█         | 3/30 [00:22<02:10,  4.85s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8476, 'compress@10': 0.9066, 'time@10': 7.3356}:  13%|█▎        | 4/30 [00:22<02:26,  5.63s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0418, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8333, 'compress@10': 0.9057, 'time@10': 8.3609}:  13%|█▎        | 4/30 [00:28<02:26,  5.63s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0418, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8333, 'compress@10': 0.9057, 'time@10': 8.3609}:  17%|█▋        | 5/30 [00:28<02:26,  5.86s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0425, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8365, 'compress@10': 0.9051, 'time@10': 8.873}:  17%|█▋        | 5/30 [00:40<02:26,  5.86s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0425, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8365, 'compress@10': 0.9051, 'time@10': 8.873}:  20%|██        | 6/30 [00:40<03:06,  7.77s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.041, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8436, 'compress@10': 0.9049, 'time@10': 9.3526}:  20%|██        | 6/30 [00:46<03:06,  7.77s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.041, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8436, 'compress@10': 0.9049, 'time@10': 9.3526}:  23%|██▎       | 7/30 [00:46<02:46,  7.25s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0405, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8528, 'compress@10': 0.9047, 'time@10': 9.2649}:  23%|██▎       | 7/30 [00:54<02:46,  7.25s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0405, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8528, 'compress@10': 0.9047, 'time@10': 9.2649}:  27%|██▋       | 8/30 [00:54<02:49,  7.70s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0406, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8593, 'compress@10': 0.9045, 'time@10': 9.4931}:  27%|██▋       | 8/30 [01:00<02:49,  7.70s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0406, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8593, 'compress@10': 0.9045, 'time@10': 9.4931}:  30%|███       | 9/30 [01:00<02:28,  7.08s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0401, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.8615, 'compress@10': 0.9042, 'time@10': 9.6039}:  30%|███       | 9/30 [01:11<02:28,  7.08s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0401, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.8615, 'compress@10': 0.9042, 'time@10': 9.6039}:  33%|███▎      | 10/30 [01:11<02:43,  8.18s/it]{'epoch': 14, 'num_users': 6.6364, 'loss': 0.0413, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8631, 'compress@10': 0.9042, 'time@10': 9.8341}:  33%|███▎      | 10/30 [01:17<02:43,  8.18s/it]{'epoch': 14, 'num_users': 6.6364, 'loss': 0.0413, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8631, 'compress@10': 0.9042, 'time@10': 9.8341}:  37%|███▋      | 11/30 [01:17<02:23,  7.54s/it]{'epoch': 14, 'num_users': 6.4167, 'loss': 0.0388, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8665, 'compress@10': 0.9045, 'time@10': 9.4525}:  37%|███▋      | 11/30 [01:22<02:23,  7.54s/it]{'epoch': 14, 'num_users': 6.4167, 'loss': 0.0388, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8665, 'compress@10': 0.9045, 'time@10': 9.4525}:  40%|████      | 12/30 [01:22<02:03,  6.86s/it]{'epoch': 14, 'num_users': 6.6154, 'loss': 0.0391, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8685, 'compress@10': 0.9045, 'time@10': 9.5152}:  40%|████      | 12/30 [01:27<02:03,  6.86s/it]{'epoch': 14, 'num_users': 6.6154, 'loss': 0.0391, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8685, 'compress@10': 0.9045, 'time@10': 9.5152}:  43%|████▎     | 13/30 [01:27<01:47,  6.35s/it]{'epoch': 14, 'num_users': 6.3571, 'loss': 0.0367, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.8652, 'compress@10': 0.9054, 'time@10': 9.0587}:  43%|████▎     | 13/30 [01:30<01:47,  6.35s/it]{'epoch': 14, 'num_users': 6.3571, 'loss': 0.0367, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.8652, 'compress@10': 0.9054, 'time@10': 9.0587}:  47%|████▋     | 14/30 [01:30<01:26,  5.38s/it]{'epoch': 14, 'num_users': 6.2667, 'loss': 0.0376, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.8652, 'compress@10': 0.9053, 'time@10': 9.3454}:  47%|████▋     | 14/30 [01:37<01:26,  5.38s/it]{'epoch': 14, 'num_users': 6.2667, 'loss': 0.0376, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.8652, 'compress@10': 0.9053, 'time@10': 9.3454}:  50%|█████     | 15/30 [01:37<01:26,  5.79s/it]{'epoch': 14, 'num_users': 6.0625, 'loss': 0.0358, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8675, 'compress@10': 0.9055, 'time@10': 9.0497}:  50%|█████     | 15/30 [01:42<01:26,  5.79s/it]{'epoch': 14, 'num_users': 6.0625, 'loss': 0.0358, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8675, 'compress@10': 0.9055, 'time@10': 9.0497}:  53%|█████▎    | 16/30 [01:42<01:16,  5.44s/it]{'epoch': 14, 'num_users': 5.8235, 'loss': 0.0341, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.8612, 'compress@10': 0.9063, 'time@10': 8.7817}:  53%|█████▎    | 16/30 [01:44<01:16,  5.44s/it]{'epoch': 14, 'num_users': 5.8235, 'loss': 0.0341, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.8612, 'compress@10': 0.9063, 'time@10': 8.7817}:  57%|█████▋    | 17/30 [01:44<00:58,  4.49s/it]{'epoch': 14, 'num_users': 6.0556, 'loss': 0.0344, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8622, 'compress@10': 0.9062, 'time@10': 8.6985}:  57%|█████▋    | 17/30 [01:51<00:58,  4.49s/it]{'epoch': 14, 'num_users': 6.0556, 'loss': 0.0344, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8622, 'compress@10': 0.9062, 'time@10': 8.6985}:  60%|██████    | 18/30 [01:51<01:04,  5.34s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 0.0334, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8639, 'compress@10': 0.9062, 'time@10': 8.6768}:  60%|██████    | 18/30 [01:56<01:04,  5.34s/it]   {'epoch': 14, 'num_users': 6.0, 'loss': 0.0334, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8639, 'compress@10': 0.9062, 'time@10': 8.6768}:  63%|██████▎   | 19/30 [01:56<00:54,  4.99s/it]{'epoch': 14, 'num_users': 6.15, 'loss': 0.0336, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8638, 'compress@10': 0.906, 'time@10': 8.9496}:  63%|██████▎   | 19/30 [02:10<00:54,  4.99s/it]{'epoch': 14, 'num_users': 6.15, 'loss': 0.0336, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8638, 'compress@10': 0.906, 'time@10': 8.9496}:  67%|██████▋   | 20/30 [02:10<01:17,  7.75s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0352, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8621, 'compress@10': 0.9058, 'time@10': 9.0021}:  67%|██████▋   | 20/30 [02:15<01:17,  7.75s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0352, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8621, 'compress@10': 0.9058, 'time@10': 9.0021}:  70%|███████   | 21/30 [02:15<01:02,  6.94s/it]{'epoch': 14, 'num_users': 6.1818, 'loss': 0.0367, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8615, 'compress@10': 0.9058, 'time@10': 8.8681}:  70%|███████   | 21/30 [02:21<01:02,  6.94s/it]{'epoch': 14, 'num_users': 6.1818, 'loss': 0.0367, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8615, 'compress@10': 0.9058, 'time@10': 8.8681}:  73%|███████▎  | 22/30 [02:21<00:53,  6.69s/it]{'epoch': 14, 'num_users': 6.1304, 'loss': 0.0361, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8636, 'compress@10': 0.9057, 'time@10': 8.9059}:  73%|███████▎  | 22/30 [02:26<00:53,  6.69s/it]{'epoch': 14, 'num_users': 6.1304, 'loss': 0.0361, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8636, 'compress@10': 0.9057, 'time@10': 8.9059}:  77%|███████▋  | 23/30 [02:26<00:43,  6.15s/it]{'epoch': 14, 'num_users': 5.9583, 'loss': 0.0355, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8586, 'compress@10': 0.9063, 'time@10': 8.6417}:  77%|███████▋  | 23/30 [02:28<00:43,  6.15s/it]{'epoch': 14, 'num_users': 5.9583, 'loss': 0.0355, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8586, 'compress@10': 0.9063, 'time@10': 8.6417}:  80%|████████  | 24/30 [02:28<00:30,  5.09s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0344, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.8492, 'compress@10': 0.9074, 'time@10': 8.3982}:  80%|████████  | 24/30 [02:30<00:30,  5.09s/it]   {'epoch': 14, 'num_users': 5.8, 'loss': 0.0344, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.8492, 'compress@10': 0.9074, 'time@10': 8.3982}:  83%|████████▎ | 25/30 [02:30<00:19,  3.96s/it]{'epoch': 14, 'num_users': 5.8077, 'loss': 0.0348, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8496, 'compress@10': 0.9072, 'time@10': 8.6361}:  83%|████████▎ | 25/30 [02:44<00:19,  3.96s/it]{'epoch': 14, 'num_users': 5.8077, 'loss': 0.0348, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8496, 'compress@10': 0.9072, 'time@10': 8.6361}:  87%|████████▋ | 26/30 [02:44<00:28,  7.15s/it]{'epoch': 14, 'num_users': 5.8889, 'loss': 0.0348, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.85, 'compress@10': 0.907, 'time@10': 8.831}:  87%|████████▋ | 26/30 [02:51<00:28,  7.15s/it]   {'epoch': 14, 'num_users': 5.8889, 'loss': 0.0348, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.85, 'compress@10': 0.907, 'time@10': 8.831}:  90%|█████████ | 27/30 [02:51<00:21,  7.10s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 0.0347, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8514, 'compress@10': 0.9068, 'time@10': 8.9641}:  90%|█████████ | 27/30 [03:04<00:21,  7.10s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 0.0347, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8514, 'compress@10': 0.9068, 'time@10': 8.9641}:  93%|█████████▎| 28/30 [03:04<00:17,  8.75s/it]{'epoch': 14, 'num_users': 5.8621, 'loss': 0.0344, 'hit_ratio@10': 0.854, 'ndcg@10': 0.854, 'compress@10': 0.9068, 'time@10': 9.0183}:  93%|█████████▎| 28/30 [03:09<00:17,  8.75s/it]{'epoch': 14, 'num_users': 5.8621, 'loss': 0.0344, 'hit_ratio@10': 0.854, 'ndcg@10': 0.854, 'compress@10': 0.9068, 'time@10': 9.0183}:  97%|█████████▋| 29/30 [03:09<00:07,  7.72s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.0344, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8559, 'compress@10': 0.9066, 'time@10': 9.0107}:  97%|█████████▋| 29/30 [03:18<00:07,  7.72s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.0344, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8559, 'compress@10': 0.9066, 'time@10': 9.0107}: 100%|██████████| 30/30 [03:18<00:00,  8.05s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.0344, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8559, 'compress@10': 0.9066, 'time@10': 9.0107}: 100%|██████████| 30/30 [03:18<00:00,  6.62s/it]
Epoch: 14
Avg # of users: 5.866666666666666
Avg Loss: 0.03441070451102256
Avg hit ratio: 0.8525411520790394
Avg ndcg: 0.8559392362984711
Avg compression ratio: 0.906629946774215
Avg train time: 9.010712051391602
Std train time: 3.5068407640038166
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 5, 10, 9, 10, 6, 10, 10, 19, 10, 25, 9, 19, 25, 10, 10, 9, 5, 11, 10, 25, 25, 6, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 0.9052, 'time@10': 9.2958}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 0.9052, 'time@10': 9.2958}:   3%|▎         | 1/30 [00:04<02:16,  4.71s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8808, 'compress@10': 0.9042, 'time@10': 8.7368}:   3%|▎         | 1/30 [00:12<02:16,  4.71s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8808, 'compress@10': 0.9042, 'time@10': 8.7368}:   7%|▋         | 2/30 [00:12<03:09,  6.77s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8729, 'compress@10': 0.9076, 'time@10': 7.5317}:   7%|▋         | 2/30 [00:15<03:09,  6.77s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8729, 'compress@10': 0.9076, 'time@10': 7.5317}:  10%|█         | 3/30 [00:15<02:11,  4.86s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8724, 'compress@10': 0.9066, 'time@10': 7.3332}:  10%|█         | 3/30 [00:22<02:11,  4.86s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8724, 'compress@10': 0.9066, 'time@10': 7.3332}:  13%|█▎        | 4/30 [00:22<02:26,  5.62s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0384, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8537, 'compress@10': 0.9057, 'time@10': 8.3356}:  13%|█▎        | 4/30 [00:28<02:26,  5.62s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0384, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8537, 'compress@10': 0.9057, 'time@10': 8.3356}:  17%|█▋        | 5/30 [00:28<02:25,  5.83s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0391, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8547, 'compress@10': 0.9051, 'time@10': 9.0137}:  17%|█▋        | 5/30 [00:40<02:25,  5.83s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0391, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8547, 'compress@10': 0.9051, 'time@10': 9.0137}:  20%|██        | 6/30 [00:40<03:13,  8.08s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0386, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8623, 'compress@10': 0.9049, 'time@10': 9.5166}:  20%|██        | 6/30 [00:47<03:13,  8.08s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0386, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8623, 'compress@10': 0.9049, 'time@10': 9.5166}:  23%|██▎       | 7/30 [00:47<02:52,  7.51s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0383, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8695, 'compress@10': 0.9047, 'time@10': 9.5285}:  23%|██▎       | 7/30 [00:56<02:52,  7.51s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0383, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8695, 'compress@10': 0.9047, 'time@10': 9.5285}:  27%|██▋       | 8/30 [00:56<03:00,  8.19s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0386, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8748, 'compress@10': 0.9045, 'time@10': 9.6754}:  27%|██▋       | 8/30 [01:02<03:00,  8.19s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0386, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8748, 'compress@10': 0.9045, 'time@10': 9.6754}:  30%|███       | 9/30 [01:02<02:34,  7.34s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0377, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8786, 'compress@10': 0.9042, 'time@10': 9.7869}:  30%|███       | 9/30 [01:13<02:34,  7.34s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0377, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8786, 'compress@10': 0.9042, 'time@10': 9.7869}:  33%|███▎      | 10/30 [01:13<02:48,  8.42s/it]{'epoch': 15, 'num_users': 6.6364, 'loss': 0.0385, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8783, 'compress@10': 0.9042, 'time@10': 10.0221}:  33%|███▎      | 10/30 [01:19<02:48,  8.42s/it]{'epoch': 15, 'num_users': 6.6364, 'loss': 0.0385, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8783, 'compress@10': 0.9042, 'time@10': 10.0221}:  37%|███▋      | 11/30 [01:19<02:27,  7.75s/it]{'epoch': 15, 'num_users': 6.4167, 'loss': 0.0362, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8805, 'compress@10': 0.9045, 'time@10': 9.6286}:  37%|███▋      | 11/30 [01:24<02:27,  7.75s/it] {'epoch': 15, 'num_users': 6.4167, 'loss': 0.0362, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8805, 'compress@10': 0.9045, 'time@10': 9.6286}:  40%|████      | 12/30 [01:24<02:06,  7.01s/it]{'epoch': 15, 'num_users': 6.6154, 'loss': 0.0366, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8815, 'compress@10': 0.9045, 'time@10': 9.6815}:  40%|████      | 12/30 [01:29<02:06,  7.01s/it]{'epoch': 15, 'num_users': 6.6154, 'loss': 0.0366, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8815, 'compress@10': 0.9045, 'time@10': 9.6815}:  43%|████▎     | 13/30 [01:29<01:49,  6.46s/it]{'epoch': 15, 'num_users': 6.3571, 'loss': 0.0344, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8773, 'compress@10': 0.9054, 'time@10': 9.205}:  43%|████▎     | 13/30 [01:33<01:49,  6.46s/it] {'epoch': 15, 'num_users': 6.3571, 'loss': 0.0344, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8773, 'compress@10': 0.9054, 'time@10': 9.205}:  47%|████▋     | 14/30 [01:33<01:26,  5.43s/it]{'epoch': 15, 'num_users': 6.2667, 'loss': 0.0356, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8758, 'compress@10': 0.9053, 'time@10': 9.4999}:  47%|████▋     | 14/30 [01:39<01:26,  5.43s/it]{'epoch': 15, 'num_users': 6.2667, 'loss': 0.0356, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8758, 'compress@10': 0.9053, 'time@10': 9.4999}:  50%|█████     | 15/30 [01:39<01:27,  5.86s/it]{'epoch': 15, 'num_users': 6.0625, 'loss': 0.0339, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.877, 'compress@10': 0.9055, 'time@10': 9.2256}:  50%|█████     | 15/30 [01:45<01:27,  5.86s/it] {'epoch': 15, 'num_users': 6.0625, 'loss': 0.0339, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.877, 'compress@10': 0.9055, 'time@10': 9.2256}:  53%|█████▎    | 16/30 [01:45<01:19,  5.64s/it]{'epoch': 15, 'num_users': 5.8235, 'loss': 0.0322, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8701, 'compress@10': 0.9063, 'time@10': 8.9645}:  53%|█████▎    | 16/30 [01:47<01:19,  5.64s/it]{'epoch': 15, 'num_users': 5.8235, 'loss': 0.0322, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8701, 'compress@10': 0.9063, 'time@10': 8.9645}:  57%|█████▋    | 17/30 [01:47<01:00,  4.68s/it]{'epoch': 15, 'num_users': 6.0556, 'loss': 0.0325, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8706, 'compress@10': 0.9062, 'time@10': 8.8468}:  57%|█████▋    | 17/30 [01:54<01:00,  4.68s/it]{'epoch': 15, 'num_users': 6.0556, 'loss': 0.0325, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8706, 'compress@10': 0.9062, 'time@10': 8.8468}:  60%|██████    | 18/30 [01:54<01:04,  5.34s/it]{'epoch': 15, 'num_users': 6.0, 'loss': 0.0316, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8718, 'compress@10': 0.9062, 'time@10': 8.721}:  60%|██████    | 18/30 [01:57<01:04,  5.34s/it]    {'epoch': 15, 'num_users': 6.0, 'loss': 0.0316, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8718, 'compress@10': 0.9062, 'time@10': 8.721}:  63%|██████▎   | 19/30 [01:57<00:51,  4.72s/it]{'epoch': 15, 'num_users': 6.15, 'loss': 0.0319, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8716, 'compress@10': 0.906, 'time@10': 8.9172}:  63%|██████▎   | 19/30 [02:10<00:51,  4.72s/it]{'epoch': 15, 'num_users': 6.15, 'loss': 0.0319, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8716, 'compress@10': 0.906, 'time@10': 8.9172}:  67%|██████▋   | 20/30 [02:10<01:11,  7.11s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0335, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8693, 'compress@10': 0.9058, 'time@10': 8.9657}:  67%|██████▋   | 20/30 [02:15<01:11,  7.11s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0335, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8693, 'compress@10': 0.9058, 'time@10': 8.9657}:  70%|███████   | 21/30 [02:15<00:58,  6.48s/it]{'epoch': 15, 'num_users': 6.1818, 'loss': 0.0339, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8719, 'compress@10': 0.9058, 'time@10': 8.8165}:  70%|███████   | 21/30 [02:21<00:58,  6.48s/it]{'epoch': 15, 'num_users': 6.1818, 'loss': 0.0339, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8719, 'compress@10': 0.9058, 'time@10': 8.8165}:  73%|███████▎  | 22/30 [02:21<00:50,  6.28s/it]{'epoch': 15, 'num_users': 6.1304, 'loss': 0.0333, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8733, 'compress@10': 0.9057, 'time@10': 8.876}:  73%|███████▎  | 22/30 [02:26<00:50,  6.28s/it] {'epoch': 15, 'num_users': 6.1304, 'loss': 0.0333, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8733, 'compress@10': 0.9057, 'time@10': 8.876}:  77%|███████▋  | 23/30 [02:26<00:41,  5.93s/it]{'epoch': 15, 'num_users': 5.9583, 'loss': 0.0328, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8679, 'compress@10': 0.9063, 'time@10': 8.6154}:  77%|███████▋  | 23/30 [02:28<00:41,  5.93s/it]{'epoch': 15, 'num_users': 5.9583, 'loss': 0.0328, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8679, 'compress@10': 0.9063, 'time@10': 8.6154}:  80%|████████  | 24/30 [02:28<00:29,  4.95s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0317, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8581, 'compress@10': 0.9074, 'time@10': 8.3767}:  80%|████████  | 24/30 [02:30<00:29,  4.95s/it]   {'epoch': 15, 'num_users': 5.8, 'loss': 0.0317, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8581, 'compress@10': 0.9074, 'time@10': 8.3767}:  83%|████████▎ | 25/30 [02:30<00:19,  3.87s/it]{'epoch': 15, 'num_users': 5.8077, 'loss': 0.0322, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8578, 'compress@10': 0.9072, 'time@10': 8.514}:  83%|████████▎ | 25/30 [02:42<00:19,  3.87s/it]{'epoch': 15, 'num_users': 5.8077, 'loss': 0.0322, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8578, 'compress@10': 0.9072, 'time@10': 8.514}:  87%|████████▋ | 26/30 [02:42<00:25,  6.31s/it]{'epoch': 15, 'num_users': 5.8889, 'loss': 0.0322, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8583, 'compress@10': 0.907, 'time@10': 8.7735}:  87%|████████▋ | 26/30 [02:50<00:25,  6.31s/it]{'epoch': 15, 'num_users': 5.8889, 'loss': 0.0322, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8583, 'compress@10': 0.907, 'time@10': 8.7735}:  90%|█████████ | 27/30 [02:50<00:20,  6.75s/it]{'epoch': 15, 'num_users': 6.0, 'loss': 0.0325, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8602, 'compress@10': 0.9068, 'time@10': 8.9637}:  90%|█████████ | 27/30 [03:04<00:20,  6.75s/it]  {'epoch': 15, 'num_users': 6.0, 'loss': 0.0325, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8602, 'compress@10': 0.9068, 'time@10': 8.9637}:  93%|█████████▎| 28/30 [03:04<00:17,  8.97s/it]{'epoch': 15, 'num_users': 5.8621, 'loss': 0.0323, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8625, 'compress@10': 0.9068, 'time@10': 9.0476}:  93%|█████████▎| 28/30 [03:09<00:17,  8.97s/it]{'epoch': 15, 'num_users': 5.8621, 'loss': 0.0323, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8625, 'compress@10': 0.9068, 'time@10': 9.0476}:  97%|█████████▋| 29/30 [03:09<00:07,  8.00s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0324, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8642, 'compress@10': 0.9066, 'time@10': 9.047}:  97%|█████████▋| 29/30 [03:18<00:07,  8.00s/it] {'epoch': 15, 'num_users': 5.8667, 'loss': 0.0324, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8642, 'compress@10': 0.9066, 'time@10': 9.047}: 100%|██████████| 30/30 [03:18<00:00,  8.32s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0324, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8642, 'compress@10': 0.9066, 'time@10': 9.047}: 100%|██████████| 30/30 [03:18<00:00,  6.63s/it]
Epoch: 15
Avg # of users: 5.866666666666666
Avg Loss: 0.032359294869654914
Avg hit ratio: 0.8514764413557921
Avg ndcg: 0.8642028521146747
Avg compression ratio: 0.9066299462185364
Avg train time: 9.046953670183818
Std train time: 3.5673288349583956
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 5, 10, 9, 10, 6, 10, 10, 19, 10, 26, 9, 19, 25, 10, 10, 9, 5, 11, 10, 26, 26, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 0.9052, 'time@10': 9.3136}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 0.9052, 'time@10': 9.3136}:   3%|▎         | 1/30 [00:04<02:16,  4.69s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8808, 'compress@10': 0.9042, 'time@10': 8.6453}:   3%|▎         | 1/30 [00:12<02:16,  4.69s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8808, 'compress@10': 0.9042, 'time@10': 8.6453}:   7%|▋         | 2/30 [00:12<03:06,  6.65s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8729, 'compress@10': 0.9076, 'time@10': 7.715}:   7%|▋         | 2/30 [00:15<03:06,  6.65s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8729, 'compress@10': 0.9076, 'time@10': 7.715}:  10%|█         | 3/30 [00:15<02:14,  4.96s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8721, 'compress@10': 0.9066, 'time@10': 7.5324}:  10%|█         | 3/30 [00:22<02:14,  4.96s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8721, 'compress@10': 0.9066, 'time@10': 7.5324}:  13%|█▎        | 4/30 [00:22<02:30,  5.78s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0375, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8533, 'compress@10': 0.9057, 'time@10': 8.5557}:  13%|█▎        | 4/30 [00:29<02:30,  5.78s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0375, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8533, 'compress@10': 0.9057, 'time@10': 8.5557}:  17%|█▋        | 5/30 [00:29<02:29,  5.99s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0378, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8553, 'compress@10': 0.9051, 'time@10': 9.1131}:  17%|█▋        | 5/30 [00:40<02:29,  5.99s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0378, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8553, 'compress@10': 0.9051, 'time@10': 9.1131}:  20%|██        | 6/30 [00:40<03:12,  8.01s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0377, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8632, 'compress@10': 0.9049, 'time@10': 9.3905}:  20%|██        | 6/30 [00:46<03:12,  8.01s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0377, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8632, 'compress@10': 0.9049, 'time@10': 9.3905}:  23%|██▎       | 7/30 [00:46<02:45,  7.21s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0373, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8702, 'compress@10': 0.9047, 'time@10': 9.3116}:  23%|██▎       | 7/30 [00:55<02:45,  7.21s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0373, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8702, 'compress@10': 0.9047, 'time@10': 9.3116}:  27%|██▋       | 8/30 [00:55<02:49,  7.71s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0377, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8749, 'compress@10': 0.9045, 'time@10': 9.601}:  27%|██▋       | 8/30 [01:01<02:49,  7.71s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0377, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8749, 'compress@10': 0.9045, 'time@10': 9.601}:  30%|███       | 9/30 [01:01<02:30,  7.18s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0371, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8769, 'compress@10': 0.9042, 'time@10': 9.7356}:  30%|███       | 9/30 [01:12<02:30,  7.18s/it]  {'epoch': 16, 'num_users': 6.3, 'loss': 0.0371, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8769, 'compress@10': 0.9042, 'time@10': 9.7356}:  33%|███▎      | 10/30 [01:12<02:47,  8.35s/it]{'epoch': 16, 'num_users': 6.6364, 'loss': 0.0385, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8773, 'compress@10': 0.9042, 'time@10': 9.9449}:  33%|███▎      | 10/30 [01:18<02:47,  8.35s/it]{'epoch': 16, 'num_users': 6.6364, 'loss': 0.0385, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8773, 'compress@10': 0.9042, 'time@10': 9.9449}:  37%|███▋      | 11/30 [01:18<02:25,  7.65s/it]{'epoch': 16, 'num_users': 6.4167, 'loss': 0.0362, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8798, 'compress@10': 0.9045, 'time@10': 9.5595}:  37%|███▋      | 11/30 [01:23<02:25,  7.65s/it]{'epoch': 16, 'num_users': 6.4167, 'loss': 0.0362, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8798, 'compress@10': 0.9045, 'time@10': 9.5595}:  40%|████      | 12/30 [01:23<02:05,  6.95s/it]{'epoch': 16, 'num_users': 6.6154, 'loss': 0.0366, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8812, 'compress@10': 0.9045, 'time@10': 9.6205}:  40%|████      | 12/30 [01:28<02:05,  6.95s/it]{'epoch': 16, 'num_users': 6.6154, 'loss': 0.0366, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8812, 'compress@10': 0.9045, 'time@10': 9.6205}:  43%|████▎     | 13/30 [01:28<01:49,  6.43s/it]{'epoch': 16, 'num_users': 6.3571, 'loss': 0.0343, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.877, 'compress@10': 0.9054, 'time@10': 9.1521}:  43%|████▎     | 13/30 [01:32<01:49,  6.43s/it] {'epoch': 16, 'num_users': 6.3571, 'loss': 0.0343, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.877, 'compress@10': 0.9054, 'time@10': 9.1521}:  47%|████▋     | 14/30 [01:32<01:26,  5.42s/it]{'epoch': 16, 'num_users': 6.2667, 'loss': 0.0348, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8772, 'compress@10': 0.9053, 'time@10': 9.5944}:  47%|████▋     | 14/30 [01:39<01:26,  5.42s/it]{'epoch': 16, 'num_users': 6.2667, 'loss': 0.0348, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8772, 'compress@10': 0.9053, 'time@10': 9.5944}:  50%|█████     | 15/30 [01:39<01:32,  6.18s/it]{'epoch': 16, 'num_users': 6.0625, 'loss': 0.0332, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8785, 'compress@10': 0.9055, 'time@10': 9.3634}:  50%|█████     | 15/30 [01:45<01:32,  6.18s/it]{'epoch': 16, 'num_users': 6.0625, 'loss': 0.0332, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8785, 'compress@10': 0.9055, 'time@10': 9.3634}:  53%|█████▎    | 16/30 [01:45<01:25,  6.11s/it]{'epoch': 16, 'num_users': 5.8235, 'loss': 0.0315, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8715, 'compress@10': 0.9063, 'time@10': 9.1837}:  53%|█████▎    | 16/30 [01:49<01:25,  6.11s/it]{'epoch': 16, 'num_users': 5.8235, 'loss': 0.0315, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8715, 'compress@10': 0.9063, 'time@10': 9.1837}:  57%|█████▋    | 17/30 [01:49<01:08,  5.24s/it]{'epoch': 16, 'num_users': 6.0556, 'loss': 0.0318, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.872, 'compress@10': 0.9062, 'time@10': 9.1074}:  57%|█████▋    | 17/30 [01:57<01:08,  5.24s/it] {'epoch': 16, 'num_users': 6.0556, 'loss': 0.0318, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.872, 'compress@10': 0.9062, 'time@10': 9.1074}:  60%|██████    | 18/30 [01:57<01:12,  6.03s/it]{'epoch': 16, 'num_users': 6.0, 'loss': 0.0309, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8732, 'compress@10': 0.9062, 'time@10': 8.9778}:  60%|██████    | 18/30 [02:00<01:12,  6.03s/it]  {'epoch': 16, 'num_users': 6.0, 'loss': 0.0309, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8732, 'compress@10': 0.9062, 'time@10': 8.9778}:  63%|██████▎   | 19/30 [02:00<00:57,  5.22s/it]{'epoch': 16, 'num_users': 6.15, 'loss': 0.0312, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.873, 'compress@10': 0.906, 'time@10': 9.1605}:  63%|██████▎   | 19/30 [02:13<00:57,  5.22s/it] {'epoch': 16, 'num_users': 6.15, 'loss': 0.0312, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.873, 'compress@10': 0.906, 'time@10': 9.1605}:  67%|██████▋   | 20/30 [02:13<01:14,  7.46s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0328, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8706, 'compress@10': 0.9058, 'time@10': 9.1912}:  67%|██████▋   | 20/30 [02:17<01:14,  7.46s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0328, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8706, 'compress@10': 0.9058, 'time@10': 9.1912}:  70%|███████   | 21/30 [02:17<01:00,  6.70s/it]{'epoch': 16, 'num_users': 6.1818, 'loss': 0.0336, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8694, 'compress@10': 0.9058, 'time@10': 9.0319}:  70%|███████   | 21/30 [02:23<01:00,  6.70s/it]{'epoch': 16, 'num_users': 6.1818, 'loss': 0.0336, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8694, 'compress@10': 0.9058, 'time@10': 9.0319}:  73%|███████▎  | 22/30 [02:23<00:51,  6.41s/it]{'epoch': 16, 'num_users': 6.1304, 'loss': 0.0331, 'hit_ratio@10': 0.84, 'ndcg@10': 0.871, 'compress@10': 0.9057, 'time@10': 9.049}:  73%|███████▎  | 22/30 [02:28<00:51,  6.41s/it]    {'epoch': 16, 'num_users': 6.1304, 'loss': 0.0331, 'hit_ratio@10': 0.84, 'ndcg@10': 0.871, 'compress@10': 0.9057, 'time@10': 9.049}:  77%|███████▋  | 23/30 [02:28<00:41,  5.91s/it]{'epoch': 16, 'num_users': 5.9583, 'loss': 0.0325, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8657, 'compress@10': 0.9063, 'time@10': 8.7798}:  77%|███████▋  | 23/30 [02:31<00:41,  5.91s/it]{'epoch': 16, 'num_users': 5.9583, 'loss': 0.0325, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8657, 'compress@10': 0.9063, 'time@10': 8.7798}:  80%|████████  | 24/30 [02:31<00:29,  4.96s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0314, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8559, 'compress@10': 0.9074, 'time@10': 8.5344}:  80%|████████  | 24/30 [02:32<00:29,  4.96s/it]   {'epoch': 16, 'num_users': 5.8, 'loss': 0.0314, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8559, 'compress@10': 0.9074, 'time@10': 8.5344}:  83%|████████▎ | 25/30 [02:32<00:19,  3.88s/it]{'epoch': 16, 'num_users': 5.8077, 'loss': 0.0319, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8559, 'compress@10': 0.9072, 'time@10': 8.6692}:  83%|████████▎ | 25/30 [02:44<00:19,  3.88s/it]{'epoch': 16, 'num_users': 5.8077, 'loss': 0.0319, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8559, 'compress@10': 0.9072, 'time@10': 8.6692}:  87%|████████▋ | 26/30 [02:44<00:25,  6.34s/it]{'epoch': 16, 'num_users': 5.8889, 'loss': 0.0317, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8569, 'compress@10': 0.907, 'time@10': 8.7937}:  87%|████████▋ | 26/30 [02:50<00:25,  6.34s/it] {'epoch': 16, 'num_users': 5.8889, 'loss': 0.0317, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8569, 'compress@10': 0.907, 'time@10': 8.7937}:  90%|█████████ | 27/30 [02:50<00:18,  6.25s/it]{'epoch': 16, 'num_users': 6.0, 'loss': 0.0317, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8583, 'compress@10': 0.9068, 'time@10': 8.9379}:  90%|█████████ | 27/30 [03:03<00:18,  6.25s/it]  {'epoch': 16, 'num_users': 6.0, 'loss': 0.0317, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8583, 'compress@10': 0.9068, 'time@10': 8.9379}:  93%|█████████▎| 28/30 [03:03<00:16,  8.24s/it]{'epoch': 16, 'num_users': 5.8621, 'loss': 0.0315, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8606, 'compress@10': 0.9068, 'time@10': 8.986}:  93%|█████████▎| 28/30 [03:08<00:16,  8.24s/it]{'epoch': 16, 'num_users': 5.8621, 'loss': 0.0315, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8606, 'compress@10': 0.9068, 'time@10': 8.986}:  97%|█████████▋| 29/30 [03:08<00:07,  7.33s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0315, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8623, 'compress@10': 0.9066, 'time@10': 8.9871}:  97%|█████████▋| 29/30 [03:17<00:07,  7.33s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0315, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8623, 'compress@10': 0.9066, 'time@10': 8.9871}: 100%|██████████| 30/30 [03:17<00:00,  7.85s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0315, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8623, 'compress@10': 0.9066, 'time@10': 8.9871}: 100%|██████████| 30/30 [03:17<00:00,  6.59s/it]
Epoch: 16
Avg # of users: 5.866666666666666
Avg Loss: 0.031525399484655804
Avg hit ratio: 0.8483519634944722
Avg ndcg: 0.8623151867605657
Avg compression ratio: 0.9066299510769934
Avg train time: 8.987079977989197
Std train time: 3.288846689227615
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 5, 10, 9, 10, 6, 10, 10, 19, 10, 27, 8, 19, 25, 10, 10, 9, 5, 11, 10, 27, 27, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 0.9052, 'time@10': 9.3135}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 0.9052, 'time@10': 9.3135}:   3%|▎         | 1/30 [00:04<02:16,  4.69s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8816, 'compress@10': 0.9042, 'time@10': 8.5381}:   3%|▎         | 1/30 [00:12<02:16,  4.69s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8816, 'compress@10': 0.9042, 'time@10': 8.5381}:   7%|▋         | 2/30 [00:12<03:02,  6.53s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8735, 'compress@10': 0.9076, 'time@10': 7.5916}:   7%|▋         | 2/30 [00:15<03:02,  6.53s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8735, 'compress@10': 0.9076, 'time@10': 7.5916}:  10%|█         | 3/30 [00:15<02:11,  4.86s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8686, 'compress@10': 0.9066, 'time@10': 7.3816}:  10%|█         | 3/30 [00:22<02:11,  4.86s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8686, 'compress@10': 0.9066, 'time@10': 7.3816}:  13%|█▎        | 4/30 [00:22<02:26,  5.62s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0369, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8512, 'compress@10': 0.9057, 'time@10': 8.8622}:  13%|█▎        | 4/30 [00:29<02:26,  5.62s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0369, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8512, 'compress@10': 0.9057, 'time@10': 8.8622}:  17%|█▋        | 5/30 [00:29<02:36,  6.27s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0378, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8537, 'compress@10': 0.9051, 'time@10': 9.4152}:  17%|█▋        | 5/30 [00:41<02:36,  6.27s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0378, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8537, 'compress@10': 0.9051, 'time@10': 9.4152}:  20%|██        | 6/30 [00:41<03:19,  8.30s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0376, 'hit_ratio@10': 0.875, 'ndcg@10': 0.8615, 'compress@10': 0.9049, 'time@10': 10.1339}:  20%|██        | 6/30 [00:49<03:19,  8.30s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0376, 'hit_ratio@10': 0.875, 'ndcg@10': 0.8615, 'compress@10': 0.9049, 'time@10': 10.1339}:  23%|██▎       | 7/30 [00:49<03:03,  7.96s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0372, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8684, 'compress@10': 0.9047, 'time@10': 9.9341}:  23%|██▎       | 7/30 [00:57<03:03,  7.96s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0372, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8684, 'compress@10': 0.9047, 'time@10': 9.9341}:  27%|██▋       | 8/30 [00:57<02:59,  8.15s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0374, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8736, 'compress@10': 0.9045, 'time@10': 10.1605}:  27%|██▋       | 8/30 [01:03<02:59,  8.15s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0374, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8736, 'compress@10': 0.9045, 'time@10': 10.1605}:  30%|███       | 9/30 [01:03<02:37,  7.49s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0364, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8786, 'compress@10': 0.9042, 'time@10': 10.3074}:  30%|███       | 9/30 [01:15<02:37,  7.49s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0364, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8786, 'compress@10': 0.9042, 'time@10': 10.3074}:  33%|███▎      | 10/30 [01:15<02:55,  8.78s/it]{'epoch': 17, 'num_users': 6.6364, 'loss': 0.0384, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8796, 'compress@10': 0.9042, 'time@10': 10.5192}:  33%|███▎      | 10/30 [01:21<02:55,  8.78s/it]{'epoch': 17, 'num_users': 6.6364, 'loss': 0.0384, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8796, 'compress@10': 0.9042, 'time@10': 10.5192}:  37%|███▋      | 11/30 [01:21<02:32,  8.04s/it]{'epoch': 17, 'num_users': 6.4167, 'loss': 0.0361, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8819, 'compress@10': 0.9045, 'time@10': 10.083}:  37%|███▋      | 11/30 [01:27<02:32,  8.04s/it] {'epoch': 17, 'num_users': 6.4167, 'loss': 0.0361, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8819, 'compress@10': 0.9045, 'time@10': 10.083}:  40%|████      | 12/30 [01:27<02:09,  7.21s/it]{'epoch': 17, 'num_users': 6.6154, 'loss': 0.0364, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8831, 'compress@10': 0.9045, 'time@10': 10.0904}:  40%|████      | 12/30 [01:32<02:09,  7.21s/it]{'epoch': 17, 'num_users': 6.6154, 'loss': 0.0364, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8831, 'compress@10': 0.9045, 'time@10': 10.0904}:  43%|████▎     | 13/30 [01:32<01:51,  6.58s/it]{'epoch': 17, 'num_users': 6.3571, 'loss': 0.0342, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8788, 'compress@10': 0.9054, 'time@10': 9.6024}:  43%|████▎     | 13/30 [01:35<01:51,  6.58s/it] {'epoch': 17, 'num_users': 6.3571, 'loss': 0.0342, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8788, 'compress@10': 0.9054, 'time@10': 9.6024}:  47%|████▋     | 14/30 [01:35<01:29,  5.59s/it]{'epoch': 17, 'num_users': 6.2667, 'loss': 0.0342, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.879, 'compress@10': 0.9053, 'time@10': 9.7806}:  47%|████▋     | 14/30 [01:41<01:29,  5.59s/it] {'epoch': 17, 'num_users': 6.2667, 'loss': 0.0342, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.879, 'compress@10': 0.9053, 'time@10': 9.7806}:  50%|█████     | 15/30 [01:41<01:26,  5.76s/it]{'epoch': 17, 'num_users': 6.0625, 'loss': 0.0326, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8804, 'compress@10': 0.9055, 'time@10': 9.4957}:  50%|█████     | 15/30 [01:46<01:26,  5.76s/it]{'epoch': 17, 'num_users': 6.0625, 'loss': 0.0326, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8804, 'compress@10': 0.9055, 'time@10': 9.4957}:  53%|█████▎    | 16/30 [01:46<01:18,  5.61s/it]{'epoch': 17, 'num_users': 5.8235, 'loss': 0.0309, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8733, 'compress@10': 0.9063, 'time@10': 9.2288}:  53%|█████▎    | 16/30 [01:49<01:18,  5.61s/it]{'epoch': 17, 'num_users': 5.8235, 'loss': 0.0309, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8733, 'compress@10': 0.9063, 'time@10': 9.2288}:  57%|█████▋    | 17/30 [01:49<01:00,  4.68s/it]{'epoch': 17, 'num_users': 6.0556, 'loss': 0.0312, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8739, 'compress@10': 0.9062, 'time@10': 9.0914}:  57%|█████▋    | 17/30 [01:56<01:00,  4.68s/it]{'epoch': 17, 'num_users': 6.0556, 'loss': 0.0312, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8739, 'compress@10': 0.9062, 'time@10': 9.0914}:  60%|██████    | 18/30 [01:56<01:03,  5.31s/it]{'epoch': 17, 'num_users': 6.0, 'loss': 0.0303, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.875, 'compress@10': 0.9062, 'time@10': 8.9411}:  60%|██████    | 18/30 [01:59<01:03,  5.31s/it]    {'epoch': 17, 'num_users': 6.0, 'loss': 0.0303, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.875, 'compress@10': 0.9062, 'time@10': 8.9411}:  63%|██████▎   | 19/30 [01:59<00:51,  4.67s/it]{'epoch': 17, 'num_users': 6.15, 'loss': 0.0305, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8748, 'compress@10': 0.906, 'time@10': 9.1242}:  63%|██████▎   | 19/30 [02:11<00:51,  4.67s/it]{'epoch': 17, 'num_users': 6.15, 'loss': 0.0305, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8748, 'compress@10': 0.906, 'time@10': 9.1242}:  67%|██████▋   | 20/30 [02:11<01:10,  7.06s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0321, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8724, 'compress@10': 0.9058, 'time@10': 9.1674}:  67%|██████▋   | 20/30 [02:17<01:10,  7.06s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0321, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8724, 'compress@10': 0.9058, 'time@10': 9.1674}:  70%|███████   | 21/30 [02:17<00:58,  6.46s/it]{'epoch': 17, 'num_users': 6.1818, 'loss': 0.0327, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8727, 'compress@10': 0.9058, 'time@10': 9.0044}:  70%|███████   | 21/30 [02:22<00:58,  6.46s/it]{'epoch': 17, 'num_users': 6.1818, 'loss': 0.0327, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8727, 'compress@10': 0.9058, 'time@10': 9.0044}:  73%|███████▎  | 22/30 [02:22<00:49,  6.21s/it]{'epoch': 17, 'num_users': 6.1304, 'loss': 0.0323, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8738, 'compress@10': 0.9057, 'time@10': 9.0303}:  73%|███████▎  | 22/30 [02:27<00:49,  6.21s/it]{'epoch': 17, 'num_users': 6.1304, 'loss': 0.0323, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8738, 'compress@10': 0.9057, 'time@10': 9.0303}:  77%|███████▋  | 23/30 [02:27<00:40,  5.79s/it]{'epoch': 17, 'num_users': 5.9583, 'loss': 0.0317, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8684, 'compress@10': 0.9063, 'time@10': 8.7686}:  77%|███████▋  | 23/30 [02:30<00:40,  5.79s/it]{'epoch': 17, 'num_users': 5.9583, 'loss': 0.0317, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8684, 'compress@10': 0.9063, 'time@10': 8.7686}:  80%|████████  | 24/30 [02:30<00:29,  4.89s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0306, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8585, 'compress@10': 0.9074, 'time@10': 8.5264}:  80%|████████  | 24/30 [02:31<00:29,  4.89s/it]   {'epoch': 17, 'num_users': 5.8, 'loss': 0.0306, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8585, 'compress@10': 0.9074, 'time@10': 8.5264}:  83%|████████▎ | 25/30 [02:31<00:19,  3.84s/it]{'epoch': 17, 'num_users': 5.8077, 'loss': 0.031, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8587, 'compress@10': 0.9072, 'time@10': 8.7237}:  83%|████████▎ | 25/30 [02:45<00:19,  3.84s/it]{'epoch': 17, 'num_users': 5.8077, 'loss': 0.031, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8587, 'compress@10': 0.9072, 'time@10': 8.7237}:  87%|████████▋ | 26/30 [02:45<00:27,  6.80s/it]{'epoch': 17, 'num_users': 5.8889, 'loss': 0.0313, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8606, 'compress@10': 0.907, 'time@10': 8.8862}:  87%|████████▋ | 26/30 [02:51<00:27,  6.80s/it]{'epoch': 17, 'num_users': 5.8889, 'loss': 0.0313, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8606, 'compress@10': 0.907, 'time@10': 8.8862}:  90%|█████████ | 27/30 [02:51<00:20,  6.74s/it]{'epoch': 17, 'num_users': 6.0, 'loss': 0.0311, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8627, 'compress@10': 0.9068, 'time@10': 9.0607}:  90%|█████████ | 27/30 [03:05<00:20,  6.74s/it]  {'epoch': 17, 'num_users': 6.0, 'loss': 0.0311, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8627, 'compress@10': 0.9068, 'time@10': 9.0607}:  93%|█████████▎| 28/30 [03:05<00:17,  8.86s/it]{'epoch': 17, 'num_users': 5.8621, 'loss': 0.0309, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8649, 'compress@10': 0.9068, 'time@10': 9.1147}:  93%|█████████▎| 28/30 [03:11<00:17,  8.86s/it]{'epoch': 17, 'num_users': 5.8621, 'loss': 0.0309, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8649, 'compress@10': 0.9068, 'time@10': 9.1147}:  97%|█████████▋| 29/30 [03:11<00:07,  7.81s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.031, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8664, 'compress@10': 0.9066, 'time@10': 9.113}:  97%|█████████▋| 29/30 [03:20<00:07,  7.81s/it]  {'epoch': 17, 'num_users': 5.8667, 'loss': 0.031, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8664, 'compress@10': 0.9066, 'time@10': 9.113}: 100%|██████████| 30/30 [03:20<00:00,  8.19s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.031, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8664, 'compress@10': 0.9066, 'time@10': 9.113}: 100%|██████████| 30/30 [03:20<00:00,  6.67s/it]
Epoch: 17
Avg # of users: 5.866666666666666
Avg Loss: 0.030961661300234585
Avg hit ratio: 0.85170481962506
Avg ndcg: 0.8663947870771179
Avg compression ratio: 0.9066299310994995
Avg train time: 9.113003945350647
Std train time: 3.6078528951714848
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 28, 8, 19, 25, 10, 10, 9, 5, 11, 10, 28, 28, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 0.9052, 'time@10': 9.1414}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 0.9052, 'time@10': 9.1414}:   3%|▎         | 1/30 [00:04<02:13,  4.61s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.035, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.884, 'compress@10': 0.9042, 'time@10': 8.5659}:   3%|▎         | 1/30 [00:12<02:13,  4.61s/it]  {'epoch': 18, 'num_users': 7.0, 'loss': 0.035, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.884, 'compress@10': 0.9042, 'time@10': 8.5659}:   7%|▋         | 2/30 [00:12<03:05,  6.62s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8751, 'compress@10': 0.9076, 'time@10': 7.6122}:   7%|▋         | 2/30 [00:15<03:05,  6.62s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8751, 'compress@10': 0.9076, 'time@10': 7.6122}:  10%|█         | 3/30 [00:15<02:12,  4.91s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8692, 'compress@10': 0.9066, 'time@10': 7.4169}:  10%|█         | 3/30 [00:22<02:12,  4.91s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8692, 'compress@10': 0.9066, 'time@10': 7.4169}:  13%|█▎        | 4/30 [00:22<02:27,  5.69s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0391, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.85, 'compress@10': 0.9057, 'time@10': 7.9614}:  13%|█▎        | 4/30 [00:27<02:27,  5.69s/it]  {'epoch': 18, 'num_users': 5.8, 'loss': 0.0391, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.85, 'compress@10': 0.9057, 'time@10': 7.9614}:  17%|█▋        | 5/30 [00:27<02:17,  5.49s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0387, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8542, 'compress@10': 0.9051, 'time@10': 8.8356}:  17%|█▋        | 5/30 [00:40<02:17,  5.49s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0387, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8542, 'compress@10': 0.9051, 'time@10': 8.8356}:  20%|██        | 6/30 [00:40<03:14,  8.12s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0381, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.862, 'compress@10': 0.9049, 'time@10': 9.0639}:  20%|██        | 6/30 [00:46<03:14,  8.12s/it] {'epoch': 18, 'num_users': 6.2857, 'loss': 0.0381, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.862, 'compress@10': 0.9049, 'time@10': 9.0639}:  23%|██▎       | 7/30 [00:46<02:45,  7.19s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0375, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.8701, 'compress@10': 0.9047, 'time@10': 9.0012}:  23%|██▎       | 7/30 [00:54<02:45,  7.19s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0375, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.8701, 'compress@10': 0.9047, 'time@10': 9.0012}:  27%|██▋       | 8/30 [00:54<02:47,  7.63s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0377, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8746, 'compress@10': 0.9045, 'time@10': 9.2657}:  27%|██▋       | 8/30 [01:00<02:47,  7.63s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0377, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8746, 'compress@10': 0.9045, 'time@10': 9.2657}:  30%|███       | 9/30 [01:00<02:27,  7.04s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0366, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8781, 'compress@10': 0.9042, 'time@10': 9.4117}:  30%|███       | 9/30 [01:11<02:27,  7.04s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0366, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8781, 'compress@10': 0.9042, 'time@10': 9.4117}:  33%|███▎      | 10/30 [01:11<02:43,  8.19s/it]{'epoch': 18, 'num_users': 6.6364, 'loss': 0.0381, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8787, 'compress@10': 0.9042, 'time@10': 9.7184}:  33%|███▎      | 10/30 [01:17<02:43,  8.19s/it]{'epoch': 18, 'num_users': 6.6364, 'loss': 0.0381, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8787, 'compress@10': 0.9042, 'time@10': 9.7184}:  37%|███▋      | 11/30 [01:17<02:25,  7.65s/it]{'epoch': 18, 'num_users': 6.4167, 'loss': 0.0358, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8811, 'compress@10': 0.9045, 'time@10': 9.3517}:  37%|███▋      | 11/30 [01:22<02:25,  7.65s/it]{'epoch': 18, 'num_users': 6.4167, 'loss': 0.0358, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8811, 'compress@10': 0.9045, 'time@10': 9.3517}:  40%|████      | 12/30 [01:22<02:05,  6.95s/it]{'epoch': 18, 'num_users': 6.6154, 'loss': 0.036, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8824, 'compress@10': 0.9045, 'time@10': 9.5146}:  40%|████      | 12/30 [01:28<02:05,  6.95s/it] {'epoch': 18, 'num_users': 6.6154, 'loss': 0.036, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8824, 'compress@10': 0.9045, 'time@10': 9.5146}:  43%|████▎     | 13/30 [01:28<01:52,  6.59s/it]{'epoch': 18, 'num_users': 6.3571, 'loss': 0.0338, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8781, 'compress@10': 0.9054, 'time@10': 9.1035}:  43%|████▎     | 13/30 [01:32<01:52,  6.59s/it]{'epoch': 18, 'num_users': 6.3571, 'loss': 0.0338, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8781, 'compress@10': 0.9054, 'time@10': 9.1035}:  47%|████▋     | 14/30 [01:32<01:32,  5.76s/it]{'epoch': 18, 'num_users': 6.2667, 'loss': 0.0345, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8786, 'compress@10': 0.9053, 'time@10': 9.2884}:  47%|████▋     | 14/30 [01:38<01:32,  5.76s/it] {'epoch': 18, 'num_users': 6.2667, 'loss': 0.0345, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8786, 'compress@10': 0.9053, 'time@10': 9.2884}:  50%|█████     | 15/30 [01:38<01:27,  5.82s/it]{'epoch': 18, 'num_users': 6.0625, 'loss': 0.0328, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8801, 'compress@10': 0.9055, 'time@10': 9.0716}:  50%|█████     | 15/30 [01:44<01:27,  5.82s/it]{'epoch': 18, 'num_users': 6.0625, 'loss': 0.0328, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8801, 'compress@10': 0.9055, 'time@10': 9.0716}:  53%|█████▎    | 16/30 [01:44<01:21,  5.84s/it]{'epoch': 18, 'num_users': 5.8235, 'loss': 0.0311, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.873, 'compress@10': 0.9063, 'time@10': 8.8874}:  53%|█████▎    | 16/30 [01:47<01:21,  5.84s/it] {'epoch': 18, 'num_users': 5.8235, 'loss': 0.0311, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.873, 'compress@10': 0.9063, 'time@10': 8.8874}:  57%|█████▋    | 17/30 [01:47<01:04,  4.98s/it]{'epoch': 18, 'num_users': 6.0556, 'loss': 0.0313, 'hit_ratio@10': 0.8244, 'ndcg@10': 0.8736, 'compress@10': 0.9062, 'time@10': 8.8213}:  57%|█████▋    | 17/30 [01:55<01:04,  4.98s/it]{'epoch': 18, 'num_users': 6.0556, 'loss': 0.0313, 'hit_ratio@10': 0.8244, 'ndcg@10': 0.8736, 'compress@10': 0.9062, 'time@10': 8.8213}:  60%|██████    | 18/30 [01:55<01:09,  5.81s/it]{'epoch': 18, 'num_users': 6.0, 'loss': 0.0304, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8747, 'compress@10': 0.9062, 'time@10': 8.701}:  60%|██████    | 18/30 [01:58<01:09,  5.81s/it]    {'epoch': 18, 'num_users': 6.0, 'loss': 0.0304, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8747, 'compress@10': 0.9062, 'time@10': 8.701}:  63%|██████▎   | 19/30 [01:58<00:55,  5.06s/it]{'epoch': 18, 'num_users': 6.15, 'loss': 0.0305, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8753, 'compress@10': 0.906, 'time@10': 8.9031}:  63%|██████▎   | 19/30 [02:11<00:55,  5.06s/it]{'epoch': 18, 'num_users': 6.15, 'loss': 0.0305, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8753, 'compress@10': 0.906, 'time@10': 8.9031}:  67%|██████▋   | 20/30 [02:11<01:13,  7.38s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0321, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.873, 'compress@10': 0.9058, 'time@10': 8.9861}:  67%|██████▋   | 20/30 [02:16<01:13,  7.38s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0321, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.873, 'compress@10': 0.9058, 'time@10': 8.9861}:  70%|███████   | 21/30 [02:16<01:00,  6.78s/it]{'epoch': 18, 'num_users': 6.1818, 'loss': 0.0331, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8745, 'compress@10': 0.9058, 'time@10': 8.8578}:  70%|███████   | 21/30 [02:22<01:00,  6.78s/it]{'epoch': 18, 'num_users': 6.1818, 'loss': 0.0331, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8745, 'compress@10': 0.9058, 'time@10': 8.8578}:  73%|███████▎  | 22/30 [02:22<00:52,  6.60s/it]{'epoch': 18, 'num_users': 6.1304, 'loss': 0.0326, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8756, 'compress@10': 0.9057, 'time@10': 8.9215}:  73%|███████▎  | 22/30 [02:27<00:52,  6.60s/it]  {'epoch': 18, 'num_users': 6.1304, 'loss': 0.0326, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8756, 'compress@10': 0.9057, 'time@10': 8.9215}:  77%|███████▋  | 23/30 [02:27<00:43,  6.18s/it]{'epoch': 18, 'num_users': 5.9583, 'loss': 0.032, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.8701, 'compress@10': 0.9063, 'time@10': 8.6785}:  77%|███████▋  | 23/30 [02:31<00:43,  6.18s/it]{'epoch': 18, 'num_users': 5.9583, 'loss': 0.032, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.8701, 'compress@10': 0.9063, 'time@10': 8.6785}:  80%|████████  | 24/30 [02:31<00:31,  5.27s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0309, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8602, 'compress@10': 0.9074, 'time@10': 8.4466}:  80%|████████  | 24/30 [02:32<00:31,  5.27s/it]  {'epoch': 18, 'num_users': 5.8, 'loss': 0.0309, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8602, 'compress@10': 0.9074, 'time@10': 8.4466}:  83%|████████▎ | 25/30 [02:32<00:20,  4.13s/it]{'epoch': 18, 'num_users': 5.8077, 'loss': 0.0312, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8606, 'compress@10': 0.9072, 'time@10': 8.5899}:  83%|████████▎ | 25/30 [02:44<00:20,  4.13s/it]{'epoch': 18, 'num_users': 5.8077, 'loss': 0.0312, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8606, 'compress@10': 0.9072, 'time@10': 8.5899}:  87%|████████▋ | 26/30 [02:44<00:26,  6.55s/it]{'epoch': 18, 'num_users': 5.8889, 'loss': 0.0316, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.864, 'compress@10': 0.907, 'time@10': 8.7335}:  87%|████████▋ | 26/30 [02:51<00:26,  6.55s/it]  {'epoch': 18, 'num_users': 5.8889, 'loss': 0.0316, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.864, 'compress@10': 0.907, 'time@10': 8.7335}:  90%|█████████ | 27/30 [02:51<00:19,  6.47s/it]{'epoch': 18, 'num_users': 6.0, 'loss': 0.0318, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8657, 'compress@10': 0.9068, 'time@10': 8.8657}:  90%|█████████ | 27/30 [03:03<00:19,  6.47s/it] {'epoch': 18, 'num_users': 6.0, 'loss': 0.0318, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8657, 'compress@10': 0.9068, 'time@10': 8.8657}:  93%|█████████▎| 28/30 [03:03<00:16,  8.27s/it]{'epoch': 18, 'num_users': 5.8621, 'loss': 0.0314, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8679, 'compress@10': 0.9068, 'time@10': 8.9259}:  93%|█████████▎| 28/30 [03:08<00:16,  8.27s/it]{'epoch': 18, 'num_users': 5.8621, 'loss': 0.0314, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8679, 'compress@10': 0.9068, 'time@10': 8.9259}:  97%|█████████▋| 29/30 [03:08<00:07,  7.39s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0314, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8694, 'compress@10': 0.9066, 'time@10': 8.9304}:  97%|█████████▋| 29/30 [03:17<00:07,  7.39s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0314, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8694, 'compress@10': 0.9066, 'time@10': 8.9304}: 100%|██████████| 30/30 [03:17<00:00,  7.90s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0314, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8694, 'compress@10': 0.9066, 'time@10': 8.9304}: 100%|██████████| 30/30 [03:17<00:00,  6.60s/it]
Epoch: 18
Avg # of users: 5.866666666666666
Avg Loss: 0.031417776323625336
Avg hit ratio: 0.8481181840384243
Avg ndcg: 0.8694413110482119
Avg compression ratio: 0.9066299447321675
Avg train time: 8.930449962615967
Std train time: 3.047742649210887
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 29, 8, 19, 25, 10, 10, 9, 5, 11, 10, 29, 29, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0411, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 0.9052, 'time@10': 9.2368}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0411, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 0.9052, 'time@10': 9.2368}:   3%|▎         | 1/30 [00:04<02:14,  4.65s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0336, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8834, 'compress@10': 0.9042, 'time@10': 8.6484}:   3%|▎         | 1/30 [00:12<02:14,  4.65s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0336, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8834, 'compress@10': 0.9042, 'time@10': 8.6484}:   7%|▋         | 2/30 [00:12<03:07,  6.68s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0224, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8746, 'compress@10': 0.9076, 'time@10': 7.6696}:   7%|▋         | 2/30 [00:15<03:07,  6.68s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0224, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8746, 'compress@10': 0.9076, 'time@10': 7.6696}:  10%|█         | 3/30 [00:15<02:13,  4.95s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8491, 'compress@10': 0.9066, 'time@10': 7.7599}:  10%|█         | 3/30 [00:23<02:13,  4.95s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8491, 'compress@10': 0.9066, 'time@10': 7.7599}:  13%|█▎        | 4/30 [00:23<02:40,  6.18s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0402, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8348, 'compress@10': 0.9057, 'time@10': 8.2616}:  13%|█▎        | 4/30 [00:28<02:40,  6.18s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0402, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8348, 'compress@10': 0.9057, 'time@10': 8.2616}:  17%|█▋        | 5/30 [00:28<02:25,  5.82s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0391, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8423, 'compress@10': 0.9051, 'time@10': 9.1197}:  17%|█▋        | 5/30 [00:42<02:25,  5.82s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0391, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8423, 'compress@10': 0.9051, 'time@10': 9.1197}:  20%|██        | 6/30 [00:42<03:21,  8.41s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0391, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.8433, 'compress@10': 0.9049, 'time@10': 9.2192}:  20%|██        | 6/30 [00:47<03:21,  8.41s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0391, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.8433, 'compress@10': 0.9049, 'time@10': 9.2192}:  23%|██▎       | 7/30 [00:47<02:47,  7.28s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0383, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8537, 'compress@10': 0.9047, 'time@10': 9.1626}:  23%|██▎       | 7/30 [00:56<02:47,  7.28s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0383, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8537, 'compress@10': 0.9047, 'time@10': 9.1626}:  27%|██▋       | 8/30 [00:56<02:50,  7.76s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0382, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8598, 'compress@10': 0.9045, 'time@10': 9.49}:  27%|██▋       | 8/30 [01:02<02:50,  7.76s/it] {'epoch': 19, 'num_users': 6.3333, 'loss': 0.0382, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8598, 'compress@10': 0.9045, 'time@10': 9.49}:  30%|███       | 9/30 [01:02<02:32,  7.24s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.8673, 'compress@10': 0.9042, 'time@10': 9.63}:  30%|███       | 9/30 [01:13<02:32,  7.24s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.8673, 'compress@10': 0.9042, 'time@10': 9.63}:  33%|███▎      | 10/30 [01:13<02:47,  8.38s/it]{'epoch': 19, 'num_users': 6.6364, 'loss': 0.0371, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.869, 'compress@10': 0.9042, 'time@10': 9.9351}:  33%|███▎      | 10/30 [01:19<02:47,  8.38s/it]{'epoch': 19, 'num_users': 6.6364, 'loss': 0.0371, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.869, 'compress@10': 0.9042, 'time@10': 9.9351}:  37%|███▋      | 11/30 [01:19<02:28,  7.81s/it]{'epoch': 19, 'num_users': 6.4167, 'loss': 0.0348, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8722, 'compress@10': 0.9045, 'time@10': 9.5228}:  37%|███▋      | 11/30 [01:24<02:28,  7.81s/it]{'epoch': 19, 'num_users': 6.4167, 'loss': 0.0348, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8722, 'compress@10': 0.9045, 'time@10': 9.5228}:  40%|████      | 12/30 [01:24<02:05,  6.96s/it]{'epoch': 19, 'num_users': 6.6154, 'loss': 0.0351, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8744, 'compress@10': 0.9045, 'time@10': 9.6059}:  40%|████      | 12/30 [01:29<02:05,  6.96s/it]{'epoch': 19, 'num_users': 6.6154, 'loss': 0.0351, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8744, 'compress@10': 0.9045, 'time@10': 9.6059}:  43%|████▎     | 13/30 [01:29<01:50,  6.47s/it]{'epoch': 19, 'num_users': 6.3571, 'loss': 0.0329, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8706, 'compress@10': 0.9054, 'time@10': 9.178}:  43%|████▎     | 13/30 [01:33<01:50,  6.47s/it] {'epoch': 19, 'num_users': 6.3571, 'loss': 0.0329, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8706, 'compress@10': 0.9054, 'time@10': 9.178}:  47%|████▋     | 14/30 [01:33<01:29,  5.62s/it]{'epoch': 19, 'num_users': 6.2667, 'loss': 0.0334, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8715, 'compress@10': 0.9053, 'time@10': 9.3479}:  47%|████▋     | 14/30 [01:39<01:29,  5.62s/it]{'epoch': 19, 'num_users': 6.2667, 'loss': 0.0334, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8715, 'compress@10': 0.9053, 'time@10': 9.3479}:  50%|█████     | 15/30 [01:39<01:25,  5.70s/it]{'epoch': 19, 'num_users': 6.0625, 'loss': 0.0317, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8736, 'compress@10': 0.9055, 'time@10': 9.0876}:  50%|█████     | 15/30 [01:44<01:25,  5.70s/it]{'epoch': 19, 'num_users': 6.0625, 'loss': 0.0317, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8736, 'compress@10': 0.9055, 'time@10': 9.0876}:  53%|█████▎    | 16/30 [01:44<01:17,  5.56s/it]{'epoch': 19, 'num_users': 5.8235, 'loss': 0.0301, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8669, 'compress@10': 0.9063, 'time@10': 8.8408}:  53%|█████▎    | 16/30 [01:47<01:17,  5.56s/it]{'epoch': 19, 'num_users': 5.8235, 'loss': 0.0301, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8669, 'compress@10': 0.9063, 'time@10': 8.8408}:  57%|█████▋    | 17/30 [01:47<01:00,  4.63s/it]{'epoch': 19, 'num_users': 6.0556, 'loss': 0.0303, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8679, 'compress@10': 0.9062, 'time@10': 8.7334}:  57%|█████▋    | 17/30 [01:54<01:00,  4.63s/it]{'epoch': 19, 'num_users': 6.0556, 'loss': 0.0303, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8679, 'compress@10': 0.9062, 'time@10': 8.7334}:  60%|██████    | 18/30 [01:54<01:03,  5.33s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 0.0295, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8693, 'compress@10': 0.9062, 'time@10': 8.6222}:  60%|██████    | 18/30 [01:57<01:03,  5.33s/it]    {'epoch': 19, 'num_users': 6.0, 'loss': 0.0295, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8693, 'compress@10': 0.9062, 'time@10': 8.6222}:  63%|██████▎   | 19/30 [01:57<00:52,  4.73s/it]{'epoch': 19, 'num_users': 6.15, 'loss': 0.0296, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8702, 'compress@10': 0.906, 'time@10': 8.8255}:  63%|██████▎   | 19/30 [02:10<00:52,  4.73s/it]{'epoch': 19, 'num_users': 6.15, 'loss': 0.0296, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8702, 'compress@10': 0.906, 'time@10': 8.8255}:  67%|██████▋   | 20/30 [02:10<01:11,  7.14s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0312, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.8684, 'compress@10': 0.9058, 'time@10': 8.8642}:  67%|██████▋   | 20/30 [02:15<01:11,  7.14s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0312, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.8684, 'compress@10': 0.9058, 'time@10': 8.8642}:  70%|███████   | 21/30 [02:15<00:58,  6.46s/it]{'epoch': 19, 'num_users': 6.1818, 'loss': 0.0314, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8705, 'compress@10': 0.9058, 'time@10': 8.7229}:  70%|███████   | 21/30 [02:21<00:58,  6.46s/it]{'epoch': 19, 'num_users': 6.1818, 'loss': 0.0314, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8705, 'compress@10': 0.9058, 'time@10': 8.7229}:  73%|███████▎  | 22/30 [02:21<00:50,  6.33s/it]{'epoch': 19, 'num_users': 6.1304, 'loss': 0.0309, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8723, 'compress@10': 0.9057, 'time@10': 8.7648}:  73%|███████▎  | 22/30 [02:26<00:50,  6.33s/it]{'epoch': 19, 'num_users': 6.1304, 'loss': 0.0309, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8723, 'compress@10': 0.9057, 'time@10': 8.7648}:  77%|███████▋  | 23/30 [02:26<00:41,  5.89s/it]{'epoch': 19, 'num_users': 5.9583, 'loss': 0.0302, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8669, 'compress@10': 0.9063, 'time@10': 8.5176}:  77%|███████▋  | 23/30 [02:28<00:41,  5.89s/it]{'epoch': 19, 'num_users': 5.9583, 'loss': 0.0302, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8669, 'compress@10': 0.9063, 'time@10': 8.5176}:  80%|████████  | 24/30 [02:28<00:29,  4.99s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0292, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8571, 'compress@10': 0.9074, 'time@10': 8.318}:  80%|████████  | 24/30 [02:30<00:29,  4.99s/it]    {'epoch': 19, 'num_users': 5.8, 'loss': 0.0292, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8571, 'compress@10': 0.9074, 'time@10': 8.318}:  83%|████████▎ | 25/30 [02:30<00:20,  4.03s/it]{'epoch': 19, 'num_users': 5.8077, 'loss': 0.0295, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8579, 'compress@10': 0.9072, 'time@10': 8.5284}:  83%|████████▎ | 25/30 [02:44<00:20,  4.03s/it]{'epoch': 19, 'num_users': 5.8077, 'loss': 0.0295, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8579, 'compress@10': 0.9072, 'time@10': 8.5284}:  87%|████████▋ | 26/30 [02:44<00:27,  6.97s/it]{'epoch': 19, 'num_users': 5.8889, 'loss': 0.0296, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.86, 'compress@10': 0.907, 'time@10': 8.7025}:  87%|████████▋ | 26/30 [02:51<00:27,  6.97s/it]  {'epoch': 19, 'num_users': 5.8889, 'loss': 0.0296, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.86, 'compress@10': 0.907, 'time@10': 8.7025}:  90%|█████████ | 27/30 [02:51<00:20,  6.87s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 0.0295, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.8616, 'compress@10': 0.9068, 'time@10': 8.8646}:  90%|█████████ | 27/30 [03:04<00:20,  6.87s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 0.0295, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.8616, 'compress@10': 0.9068, 'time@10': 8.8646}:  93%|█████████▎| 28/30 [03:04<00:17,  8.80s/it]{'epoch': 19, 'num_users': 5.8621, 'loss': 0.0291, 'hit_ratio@10': 0.845, 'ndcg@10': 0.864, 'compress@10': 0.9068, 'time@10': 8.903}:  93%|█████████▎| 28/30 [03:09<00:17,  8.80s/it]{'epoch': 19, 'num_users': 5.8621, 'loss': 0.0291, 'hit_ratio@10': 0.845, 'ndcg@10': 0.864, 'compress@10': 0.9068, 'time@10': 8.903}:  97%|█████████▋| 29/30 [03:09<00:07,  7.66s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0292, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8657, 'compress@10': 0.9066, 'time@10': 8.9076}:  97%|█████████▋| 29/30 [03:18<00:07,  7.66s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0292, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8657, 'compress@10': 0.9066, 'time@10': 8.9076}: 100%|██████████| 30/30 [03:18<00:00,  8.09s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0292, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8657, 'compress@10': 0.9066, 'time@10': 8.9076}: 100%|██████████| 30/30 [03:18<00:00,  6.62s/it]
Epoch: 19
Avg # of users: 5.866666666666666
Avg Loss: 0.029218237212394395
Avg hit ratio: 0.8447638978017852
Avg ndcg: 0.8657206801210253
Avg compression ratio: 0.9066299426371525
Avg train time: 8.907562200228373
Std train time: 3.228449847056407
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 30, 8, 19, 25, 10, 10, 9, 5, 11, 10, 30, 30, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 0.9052, 'time@10': 9.1391}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 0.9052, 'time@10': 9.1391}:   3%|▎         | 1/30 [00:04<02:13,  4.60s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8834, 'compress@10': 0.9042, 'time@10': 8.4739}:   3%|▎         | 1/30 [00:12<02:13,  4.60s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8834, 'compress@10': 0.9042, 'time@10': 8.4739}:   7%|▋         | 2/30 [00:12<03:02,  6.52s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8746, 'compress@10': 0.9076, 'time@10': 7.623}:   7%|▋         | 2/30 [00:15<03:02,  6.52s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8746, 'compress@10': 0.9076, 'time@10': 7.623}:  10%|█         | 3/30 [00:15<02:12,  4.91s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8573, 'compress@10': 0.9066, 'time@10': 7.4409}:  10%|█         | 3/30 [00:22<02:12,  4.91s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8573, 'compress@10': 0.9066, 'time@10': 7.4409}:  13%|█▎        | 4/30 [00:22<02:28,  5.71s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0371, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8419, 'compress@10': 0.9057, 'time@10': 7.974}:  13%|█▎        | 4/30 [00:27<02:28,  5.71s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.0371, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8419, 'compress@10': 0.9057, 'time@10': 7.974}:  17%|█▋        | 5/30 [00:27<02:17,  5.48s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0374, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8463, 'compress@10': 0.9051, 'time@10': 8.6802}:  17%|█▋        | 5/30 [00:39<02:17,  5.48s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0374, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8463, 'compress@10': 0.9051, 'time@10': 8.6802}:  20%|██        | 6/30 [00:39<03:06,  7.78s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0381, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8477, 'compress@10': 0.9049, 'time@10': 8.8386}:  20%|██        | 6/30 [00:44<03:06,  7.78s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0381, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8477, 'compress@10': 0.9049, 'time@10': 8.8386}:  23%|██▎       | 7/30 [00:44<02:37,  6.85s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0374, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8588, 'compress@10': 0.9047, 'time@10': 8.7967}:  23%|██▎       | 7/30 [00:53<02:37,  6.85s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0374, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8588, 'compress@10': 0.9047, 'time@10': 8.7967}:  27%|██▋       | 8/30 [00:53<02:42,  7.39s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0371, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8646, 'compress@10': 0.9045, 'time@10': 8.9695}:  27%|██▋       | 8/30 [00:58<02:42,  7.39s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0371, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8646, 'compress@10': 0.9045, 'time@10': 8.9695}:  30%|███       | 9/30 [00:58<02:20,  6.71s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.037, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.8674, 'compress@10': 0.9042, 'time@10': 9.1645}:  30%|███       | 9/30 [01:09<02:20,  6.71s/it]    {'epoch': 20, 'num_users': 6.3, 'loss': 0.037, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.8674, 'compress@10': 0.9042, 'time@10': 9.1645}:  33%|███▎      | 10/30 [01:09<02:40,  8.02s/it]{'epoch': 20, 'num_users': 6.6364, 'loss': 0.0378, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.8692, 'compress@10': 0.9042, 'time@10': 9.4773}:  33%|███▎      | 10/30 [01:15<02:40,  8.02s/it]{'epoch': 20, 'num_users': 6.6364, 'loss': 0.0378, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.8692, 'compress@10': 0.9042, 'time@10': 9.4773}:  37%|███▋      | 11/30 [01:15<02:22,  7.51s/it]{'epoch': 20, 'num_users': 6.4167, 'loss': 0.0354, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8726, 'compress@10': 0.9045, 'time@10': 9.185}:  37%|███▋      | 11/30 [01:21<02:22,  7.51s/it] {'epoch': 20, 'num_users': 6.4167, 'loss': 0.0354, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8726, 'compress@10': 0.9045, 'time@10': 9.185}:  40%|████      | 12/30 [01:21<02:06,  7.05s/it]{'epoch': 20, 'num_users': 6.6154, 'loss': 0.0356, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8747, 'compress@10': 0.9045, 'time@10': 9.3279}:  40%|████      | 12/30 [01:27<02:06,  7.05s/it]{'epoch': 20, 'num_users': 6.6154, 'loss': 0.0356, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8747, 'compress@10': 0.9045, 'time@10': 9.3279}:  43%|████▎     | 13/30 [01:27<01:52,  6.60s/it]{'epoch': 20, 'num_users': 6.3571, 'loss': 0.0333, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.871, 'compress@10': 0.9054, 'time@10': 8.9319}:  43%|████▎     | 13/30 [01:31<01:52,  6.60s/it] {'epoch': 20, 'num_users': 6.3571, 'loss': 0.0333, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.871, 'compress@10': 0.9054, 'time@10': 8.9319}:  47%|████▋     | 14/30 [01:31<01:32,  5.76s/it]{'epoch': 20, 'num_users': 6.2667, 'loss': 0.0331, 'hit_ratio@10': 0.848, 'ndcg@10': 0.872, 'compress@10': 0.9053, 'time@10': 9.2324}:  47%|████▋     | 14/30 [01:37<01:32,  5.76s/it] {'epoch': 20, 'num_users': 6.2667, 'loss': 0.0331, 'hit_ratio@10': 0.848, 'ndcg@10': 0.872, 'compress@10': 0.9053, 'time@10': 9.2324}:  50%|█████     | 15/30 [01:37<01:30,  6.06s/it]{'epoch': 20, 'num_users': 6.0625, 'loss': 0.0314, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.874, 'compress@10': 0.9055, 'time@10': 9.045}:  50%|█████     | 15/30 [01:44<01:30,  6.06s/it]{'epoch': 20, 'num_users': 6.0625, 'loss': 0.0314, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.874, 'compress@10': 0.9055, 'time@10': 9.045}:  53%|█████▎    | 16/30 [01:44<01:25,  6.12s/it]{'epoch': 20, 'num_users': 5.8235, 'loss': 0.0298, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8673, 'compress@10': 0.9063, 'time@10': 8.8645}:  53%|█████▎    | 16/30 [01:47<01:25,  6.12s/it]{'epoch': 20, 'num_users': 5.8235, 'loss': 0.0298, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8673, 'compress@10': 0.9063, 'time@10': 8.8645}:  57%|█████▋    | 17/30 [01:47<01:07,  5.19s/it]{'epoch': 20, 'num_users': 6.0556, 'loss': 0.03, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8687, 'compress@10': 0.9062, 'time@10': 8.7585}:  57%|█████▋    | 17/30 [01:54<01:07,  5.19s/it]  {'epoch': 20, 'num_users': 6.0556, 'loss': 0.03, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8687, 'compress@10': 0.9062, 'time@10': 8.7585}:  60%|██████    | 18/30 [01:54<01:08,  5.73s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 0.0291, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8702, 'compress@10': 0.9062, 'time@10': 8.6406}:  60%|██████    | 18/30 [01:57<01:08,  5.73s/it]  {'epoch': 20, 'num_users': 6.0, 'loss': 0.0291, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8702, 'compress@10': 0.9062, 'time@10': 8.6406}:  63%|██████▎   | 19/30 [01:57<00:55,  5.00s/it]{'epoch': 20, 'num_users': 6.15, 'loss': 0.0292, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8712, 'compress@10': 0.906, 'time@10': 8.8464}:  63%|██████▎   | 19/30 [02:10<00:55,  5.00s/it]{'epoch': 20, 'num_users': 6.15, 'loss': 0.0292, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8712, 'compress@10': 0.906, 'time@10': 8.8464}:  67%|██████▋   | 20/30 [02:10<01:13,  7.34s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0307, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8692, 'compress@10': 0.9058, 'time@10': 8.8957}:  67%|██████▋   | 20/30 [02:15<01:13,  7.34s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0307, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8692, 'compress@10': 0.9058, 'time@10': 8.8957}:  70%|███████   | 21/30 [02:15<00:59,  6.63s/it]{'epoch': 20, 'num_users': 6.1818, 'loss': 0.0316, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8695, 'compress@10': 0.9058, 'time@10': 8.7359}:  70%|███████   | 21/30 [02:20<00:59,  6.63s/it]{'epoch': 20, 'num_users': 6.1818, 'loss': 0.0316, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8695, 'compress@10': 0.9058, 'time@10': 8.7359}:  73%|███████▎  | 22/30 [02:20<00:50,  6.27s/it]{'epoch': 20, 'num_users': 6.1304, 'loss': 0.0311, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8712, 'compress@10': 0.9057, 'time@10': 8.7585}:  73%|███████▎  | 22/30 [02:25<00:50,  6.27s/it]{'epoch': 20, 'num_users': 6.1304, 'loss': 0.0311, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8712, 'compress@10': 0.9057, 'time@10': 8.7585}:  77%|███████▋  | 23/30 [02:25<00:40,  5.79s/it]{'epoch': 20, 'num_users': 5.9583, 'loss': 0.0304, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8659, 'compress@10': 0.9063, 'time@10': 8.5271}:  77%|███████▋  | 23/30 [02:28<00:40,  5.79s/it]{'epoch': 20, 'num_users': 5.9583, 'loss': 0.0304, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8659, 'compress@10': 0.9063, 'time@10': 8.5271}:  80%|████████  | 24/30 [02:28<00:30,  5.02s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0293, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8562, 'compress@10': 0.9074, 'time@10': 8.3138}:  80%|████████  | 24/30 [02:30<00:30,  5.02s/it]   {'epoch': 20, 'num_users': 5.8, 'loss': 0.0293, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8562, 'compress@10': 0.9074, 'time@10': 8.3138}:  83%|████████▎ | 25/30 [02:30<00:20,  4.01s/it]{'epoch': 20, 'num_users': 5.8077, 'loss': 0.0295, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8572, 'compress@10': 0.9072, 'time@10': 8.5008}:  83%|████████▎ | 25/30 [02:43<00:20,  4.01s/it]{'epoch': 20, 'num_users': 5.8077, 'loss': 0.0295, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8572, 'compress@10': 0.9072, 'time@10': 8.5008}:  87%|████████▋ | 26/30 [02:43<00:27,  6.77s/it]{'epoch': 20, 'num_users': 5.8889, 'loss': 0.0296, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8592, 'compress@10': 0.907, 'time@10': 8.6491}:  87%|████████▋ | 26/30 [02:49<00:27,  6.77s/it] {'epoch': 20, 'num_users': 5.8889, 'loss': 0.0296, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8592, 'compress@10': 0.907, 'time@10': 8.6491}:  90%|█████████ | 27/30 [02:49<00:19,  6.62s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 0.0292, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8614, 'compress@10': 0.9068, 'time@10': 8.8047}:  90%|█████████ | 27/30 [03:02<00:19,  6.62s/it]  {'epoch': 20, 'num_users': 6.0, 'loss': 0.0292, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8614, 'compress@10': 0.9068, 'time@10': 8.8047}:  93%|█████████▎| 28/30 [03:02<00:17,  8.55s/it]{'epoch': 20, 'num_users': 5.8621, 'loss': 0.0289, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8638, 'compress@10': 0.9068, 'time@10': 8.8886}:  93%|█████████▎| 28/30 [03:08<00:17,  8.55s/it]{'epoch': 20, 'num_users': 5.8621, 'loss': 0.0289, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8638, 'compress@10': 0.9068, 'time@10': 8.8886}:  97%|█████████▋| 29/30 [03:08<00:07,  7.68s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.029, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8656, 'compress@10': 0.9066, 'time@10': 8.9248}:  97%|█████████▋| 29/30 [03:18<00:07,  7.68s/it] {'epoch': 20, 'num_users': 5.8667, 'loss': 0.029, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8656, 'compress@10': 0.9066, 'time@10': 8.9248}: 100%|██████████| 30/30 [03:18<00:00,  8.38s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.029, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8656, 'compress@10': 0.9066, 'time@10': 8.9248}: 100%|██████████| 30/30 [03:18<00:00,  6.61s/it]
Epoch: 20
Avg # of users: 5.866666666666666
Avg Loss: 0.02896684241102141
Avg hit ratio: 0.8501941951144353
Avg ndcg: 0.8656241518668923
Avg compression ratio: 0.9066299257843661
Avg train time: 8.924803686141967
Std train time: 3.057966212413669
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 31, 8, 19, 25, 10, 10, 9, 5, 11, 10, 31, 31, 6, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0404, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 0.9052, 'time@10': 9.1394}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0404, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 0.9052, 'time@10': 9.1394}:   3%|▎         | 1/30 [00:04<02:13,  4.61s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8861, 'compress@10': 0.9042, 'time@10': 8.8265}:   3%|▎         | 1/30 [00:13<02:13,  4.61s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8861, 'compress@10': 0.9042, 'time@10': 8.8265}:   7%|▋         | 2/30 [00:13<03:14,  6.93s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8765, 'compress@10': 0.9076, 'time@10': 8.1842}:   7%|▋         | 2/30 [00:16<03:14,  6.93s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8765, 'compress@10': 0.9076, 'time@10': 8.1842}:  10%|█         | 3/30 [00:16<02:24,  5.36s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8837, 'compress@10': 0.9066, 'time@10': 7.9006}:  10%|█         | 3/30 [00:23<02:24,  5.36s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8837, 'compress@10': 0.9066, 'time@10': 7.9006}:  13%|█▎        | 4/30 [00:23<02:37,  6.04s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0336, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8631, 'compress@10': 0.9057, 'time@10': 8.6198}:  13%|█▎        | 4/30 [00:29<02:37,  6.04s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0336, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8631, 'compress@10': 0.9057, 'time@10': 8.6198}:  17%|█▋        | 5/30 [00:29<02:28,  5.95s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0349, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8673, 'compress@10': 0.9051, 'time@10': 9.4381}:  17%|█▋        | 5/30 [00:43<02:28,  5.95s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0349, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8673, 'compress@10': 0.9051, 'time@10': 9.4381}:  20%|██        | 6/30 [00:43<03:24,  8.54s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0352, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8655, 'compress@10': 0.9049, 'time@10': 9.4923}:  20%|██        | 6/30 [00:48<03:24,  8.54s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0352, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8655, 'compress@10': 0.9049, 'time@10': 9.4923}:  23%|██▎       | 7/30 [00:48<02:49,  7.37s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0348, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.874, 'compress@10': 0.9047, 'time@10': 9.3732}:  23%|██▎       | 7/30 [00:56<02:49,  7.37s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 0.0348, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.874, 'compress@10': 0.9047, 'time@10': 9.3732}:  27%|██▋       | 8/30 [00:56<02:50,  7.75s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0345, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8784, 'compress@10': 0.9045, 'time@10': 9.6391}:  27%|██▋       | 8/30 [01:02<02:50,  7.75s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0345, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8784, 'compress@10': 0.9045, 'time@10': 9.6391}:  30%|███       | 9/30 [01:02<02:30,  7.18s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.8847, 'compress@10': 0.9042, 'time@10': 9.7588}:  30%|███       | 9/30 [01:13<02:30,  7.18s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.8847, 'compress@10': 0.9042, 'time@10': 9.7588}:  33%|███▎      | 10/30 [01:13<02:46,  8.32s/it]{'epoch': 21, 'num_users': 6.6364, 'loss': 0.0338, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8846, 'compress@10': 0.9042, 'time@10': 10.0372}:  33%|███▎      | 10/30 [01:19<02:46,  8.32s/it]{'epoch': 21, 'num_users': 6.6364, 'loss': 0.0338, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8846, 'compress@10': 0.9042, 'time@10': 10.0372}:  37%|███▋      | 11/30 [01:19<02:27,  7.75s/it]{'epoch': 21, 'num_users': 6.4167, 'loss': 0.0317, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8868, 'compress@10': 0.9045, 'time@10': 9.635}:  37%|███▋      | 11/30 [01:25<02:27,  7.75s/it]  {'epoch': 21, 'num_users': 6.4167, 'loss': 0.0317, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8868, 'compress@10': 0.9045, 'time@10': 9.635}:  40%|████      | 12/30 [01:25<02:05,  6.99s/it]{'epoch': 21, 'num_users': 6.6154, 'loss': 0.0321, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8876, 'compress@10': 0.9045, 'time@10': 9.6745}:  40%|████      | 12/30 [01:30<02:05,  6.99s/it]{'epoch': 21, 'num_users': 6.6154, 'loss': 0.0321, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8876, 'compress@10': 0.9045, 'time@10': 9.6745}:  43%|████▎     | 13/30 [01:30<01:49,  6.42s/it]{'epoch': 21, 'num_users': 6.3571, 'loss': 0.03, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8829, 'compress@10': 0.9054, 'time@10': 9.252}:  43%|████▎     | 13/30 [01:34<01:49,  6.42s/it]   {'epoch': 21, 'num_users': 6.3571, 'loss': 0.03, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8829, 'compress@10': 0.9054, 'time@10': 9.252}:  47%|████▋     | 14/30 [01:34<01:30,  5.63s/it]{'epoch': 21, 'num_users': 6.2667, 'loss': 0.0302, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8834, 'compress@10': 0.9053, 'time@10': 9.4109}:  47%|████▋     | 14/30 [01:39<01:30,  5.63s/it]{'epoch': 21, 'num_users': 6.2667, 'loss': 0.0302, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8834, 'compress@10': 0.9053, 'time@10': 9.4109}:  50%|█████     | 15/30 [01:39<01:25,  5.69s/it]{'epoch': 21, 'num_users': 6.0625, 'loss': 0.0287, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8847, 'compress@10': 0.9055, 'time@10': 9.1378}:  50%|█████     | 15/30 [01:44<01:25,  5.69s/it]{'epoch': 21, 'num_users': 6.0625, 'loss': 0.0287, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8847, 'compress@10': 0.9055, 'time@10': 9.1378}:  53%|█████▎    | 16/30 [01:44<01:17,  5.51s/it]{'epoch': 21, 'num_users': 5.8235, 'loss': 0.0273, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8773, 'compress@10': 0.9063, 'time@10': 8.8879}:  53%|█████▎    | 16/30 [01:47<01:17,  5.51s/it]{'epoch': 21, 'num_users': 5.8235, 'loss': 0.0273, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8773, 'compress@10': 0.9063, 'time@10': 8.8879}:  57%|█████▋    | 17/30 [01:47<00:59,  4.60s/it]{'epoch': 21, 'num_users': 6.0556, 'loss': 0.0275, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8785, 'compress@10': 0.9062, 'time@10': 8.7764}:  57%|█████▋    | 17/30 [01:54<00:59,  4.60s/it]{'epoch': 21, 'num_users': 6.0556, 'loss': 0.0275, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8785, 'compress@10': 0.9062, 'time@10': 8.7764}:  60%|██████    | 18/30 [01:54<01:03,  5.29s/it]{'epoch': 21, 'num_users': 6.0, 'loss': 0.0268, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8797, 'compress@10': 0.9062, 'time@10': 8.6645}:  60%|██████    | 18/30 [01:57<01:03,  5.29s/it]   {'epoch': 21, 'num_users': 6.0, 'loss': 0.0268, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8797, 'compress@10': 0.9062, 'time@10': 8.6645}:  63%|██████▎   | 19/30 [01:57<00:51,  4.71s/it]{'epoch': 21, 'num_users': 6.15, 'loss': 0.027, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8804, 'compress@10': 0.906, 'time@10': 8.8786}:  63%|██████▎   | 19/30 [02:10<00:51,  4.71s/it] {'epoch': 21, 'num_users': 6.15, 'loss': 0.027, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8804, 'compress@10': 0.906, 'time@10': 8.8786}:  67%|██████▋   | 20/30 [02:10<01:11,  7.20s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0286, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8781, 'compress@10': 0.9058, 'time@10': 8.9171}:  67%|██████▋   | 20/30 [02:15<01:11,  7.20s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0286, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8781, 'compress@10': 0.9058, 'time@10': 8.9171}:  70%|███████   | 21/30 [02:15<00:58,  6.50s/it]{'epoch': 21, 'num_users': 6.1818, 'loss': 0.0292, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.879, 'compress@10': 0.9058, 'time@10': 8.7624}:  70%|███████   | 21/30 [02:21<00:58,  6.50s/it] {'epoch': 21, 'num_users': 6.1818, 'loss': 0.0292, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.879, 'compress@10': 0.9058, 'time@10': 8.7624}:  73%|███████▎  | 22/30 [02:21<00:49,  6.22s/it]{'epoch': 21, 'num_users': 6.1304, 'loss': 0.0287, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8805, 'compress@10': 0.9057, 'time@10': 8.8021}:  73%|███████▎  | 22/30 [02:25<00:49,  6.22s/it]{'epoch': 21, 'num_users': 6.1304, 'loss': 0.0287, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8805, 'compress@10': 0.9057, 'time@10': 8.8021}:  77%|███████▋  | 23/30 [02:25<00:40,  5.81s/it]{'epoch': 21, 'num_users': 5.9583, 'loss': 0.028, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8748, 'compress@10': 0.9063, 'time@10': 8.5995}:  77%|███████▋  | 23/30 [02:29<00:40,  5.81s/it] {'epoch': 21, 'num_users': 5.9583, 'loss': 0.028, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8748, 'compress@10': 0.9063, 'time@10': 8.5995}:  80%|████████  | 24/30 [02:29<00:31,  5.26s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0271, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8647, 'compress@10': 0.9074, 'time@10': 8.3745}:  80%|████████  | 24/30 [02:31<00:31,  5.26s/it]  {'epoch': 21, 'num_users': 5.8, 'loss': 0.0271, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8647, 'compress@10': 0.9074, 'time@10': 8.3745}:  83%|████████▎ | 25/30 [02:31<00:20,  4.14s/it]{'epoch': 21, 'num_users': 5.8077, 'loss': 0.0273, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.866, 'compress@10': 0.9072, 'time@10': 8.5762}:  83%|████████▎ | 25/30 [02:45<00:20,  4.14s/it]{'epoch': 21, 'num_users': 5.8077, 'loss': 0.0273, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.866, 'compress@10': 0.9072, 'time@10': 8.5762}:  87%|████████▋ | 26/30 [02:45<00:27,  7.00s/it]{'epoch': 21, 'num_users': 5.8889, 'loss': 0.0274, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8677, 'compress@10': 0.907, 'time@10': 8.7978}:  87%|████████▋ | 26/30 [02:52<00:27,  7.00s/it]{'epoch': 21, 'num_users': 5.8889, 'loss': 0.0274, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8677, 'compress@10': 0.907, 'time@10': 8.7978}:  90%|█████████ | 27/30 [02:52<00:21,  7.09s/it]{'epoch': 21, 'num_users': 6.0, 'loss': 0.0274, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8702, 'compress@10': 0.9068, 'time@10': 8.9394}:  90%|█████████ | 27/30 [03:05<00:21,  7.09s/it]  {'epoch': 21, 'num_users': 6.0, 'loss': 0.0274, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8702, 'compress@10': 0.9068, 'time@10': 8.9394}:  93%|█████████▎| 28/30 [03:05<00:17,  8.80s/it]{'epoch': 21, 'num_users': 5.8621, 'loss': 0.027, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8723, 'compress@10': 0.9068, 'time@10': 8.9959}:  93%|█████████▎| 28/30 [03:10<00:17,  8.80s/it]{'epoch': 21, 'num_users': 5.8621, 'loss': 0.027, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8723, 'compress@10': 0.9068, 'time@10': 8.9959}:  97%|█████████▋| 29/30 [03:10<00:07,  7.76s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0271, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.874, 'compress@10': 0.9066, 'time@10': 8.9971}:  97%|█████████▋| 29/30 [03:19<00:07,  7.76s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0271, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.874, 'compress@10': 0.9066, 'time@10': 8.9971}: 100%|██████████| 30/30 [03:19<00:00,  8.15s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0271, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.874, 'compress@10': 0.9066, 'time@10': 8.9971}: 100%|██████████| 30/30 [03:19<00:00,  6.66s/it]
Epoch: 21
Avg # of users: 5.866666666666666
Avg Loss: 0.02714627848161125
Avg hit ratio: 0.8557838757041161
Avg ndcg: 0.8740252133983798
Avg compression ratio: 0.9066299479916405
Avg train time: 8.997077798843383
Std train time: 3.234706648484521
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 32, 8, 19, 25, 10, 10, 9, 5, 11, 10, 32, 32, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 0.9052, 'time@10': 8.6585}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8708, 'compress@10': 0.9052, 'time@10': 8.6585}:   3%|▎         | 1/30 [00:04<02:06,  4.37s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0314, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8861, 'compress@10': 0.9042, 'time@10': 8.1949}:   3%|▎         | 1/30 [00:12<02:06,  4.37s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0314, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8861, 'compress@10': 0.9042, 'time@10': 8.1949}:   7%|▋         | 2/30 [00:12<02:58,  6.37s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8765, 'compress@10': 0.9076, 'time@10': 7.2035}:   7%|▋         | 2/30 [00:14<02:58,  6.37s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8765, 'compress@10': 0.9076, 'time@10': 7.2035}:  10%|█         | 3/30 [00:14<02:06,  4.67s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0222, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8834, 'compress@10': 0.9066, 'time@10': 7.2633}:  10%|█         | 3/30 [00:22<02:06,  4.67s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0222, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8834, 'compress@10': 0.9066, 'time@10': 7.2633}:  13%|█▎        | 4/30 [00:22<02:30,  5.78s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0326, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8626, 'compress@10': 0.9057, 'time@10': 7.7458}:  13%|█▎        | 4/30 [00:27<02:30,  5.78s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0326, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8626, 'compress@10': 0.9057, 'time@10': 7.7458}:  17%|█▋        | 5/30 [00:27<02:16,  5.45s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0319, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8696, 'compress@10': 0.9051, 'time@10': 8.4602}:  17%|█▋        | 5/30 [00:39<02:16,  5.45s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0319, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8696, 'compress@10': 0.9051, 'time@10': 8.4602}:  20%|██        | 6/30 [00:39<03:04,  7.70s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0322, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8672, 'compress@10': 0.9049, 'time@10': 8.6454}:  20%|██        | 6/30 [00:44<03:04,  7.70s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0322, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8672, 'compress@10': 0.9049, 'time@10': 8.6454}:  23%|██▎       | 7/30 [00:44<02:36,  6.79s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.032, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8768, 'compress@10': 0.9047, 'time@10': 8.6197}:  23%|██▎       | 7/30 [00:52<02:36,  6.79s/it]  {'epoch': 22, 'num_users': 6.125, 'loss': 0.032, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8768, 'compress@10': 0.9047, 'time@10': 8.6197}:  27%|██▋       | 8/30 [00:52<02:41,  7.33s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0319, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8809, 'compress@10': 0.9045, 'time@10': 8.8167}:  27%|██▋       | 8/30 [00:57<02:41,  7.33s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0319, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8809, 'compress@10': 0.9045, 'time@10': 8.8167}:  30%|███       | 9/30 [00:57<02:20,  6.67s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0306, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.8861, 'compress@10': 0.9042, 'time@10': 9.0866}:  30%|███       | 9/30 [01:09<02:20,  6.67s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0306, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.8861, 'compress@10': 0.9042, 'time@10': 9.0866}:  33%|███▎      | 10/30 [01:09<02:43,  8.18s/it]{'epoch': 22, 'num_users': 6.6364, 'loss': 0.032, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8863, 'compress@10': 0.9042, 'time@10': 9.4873}:  33%|███▎      | 10/30 [01:16<02:43,  8.18s/it]{'epoch': 22, 'num_users': 6.6364, 'loss': 0.032, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8863, 'compress@10': 0.9042, 'time@10': 9.4873}:  37%|███▋      | 11/30 [01:16<02:27,  7.76s/it]{'epoch': 22, 'num_users': 6.4167, 'loss': 0.03, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8888, 'compress@10': 0.9045, 'time@10': 9.185}:  37%|███▋      | 11/30 [01:22<02:27,  7.76s/it]  {'epoch': 22, 'num_users': 6.4167, 'loss': 0.03, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8888, 'compress@10': 0.9045, 'time@10': 9.185}:  40%|████      | 12/30 [01:22<02:09,  7.19s/it]{'epoch': 22, 'num_users': 6.6154, 'loss': 0.0305, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8897, 'compress@10': 0.9045, 'time@10': 9.296}:  40%|████      | 12/30 [01:27<02:09,  7.19s/it]{'epoch': 22, 'num_users': 6.6154, 'loss': 0.0305, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8897, 'compress@10': 0.9045, 'time@10': 9.296}:  43%|████▎     | 13/30 [01:27<01:52,  6.63s/it]{'epoch': 22, 'num_users': 6.3571, 'loss': 0.0285, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.8849, 'compress@10': 0.9054, 'time@10': 8.9352}:  43%|████▎     | 13/30 [01:31<01:52,  6.63s/it]{'epoch': 22, 'num_users': 6.3571, 'loss': 0.0285, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.8849, 'compress@10': 0.9054, 'time@10': 8.9352}:  47%|████▋     | 14/30 [01:31<01:34,  5.92s/it]{'epoch': 22, 'num_users': 6.2667, 'loss': 0.029, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8857, 'compress@10': 0.9053, 'time@10': 9.2217}:  47%|████▋     | 14/30 [01:38<01:34,  5.92s/it]  {'epoch': 22, 'num_users': 6.2667, 'loss': 0.029, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8857, 'compress@10': 0.9053, 'time@10': 9.2217}:  50%|█████     | 15/30 [01:38<01:32,  6.14s/it]{'epoch': 22, 'num_users': 6.0625, 'loss': 0.0276, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8871, 'compress@10': 0.9055, 'time@10': 8.9939}:  50%|█████     | 15/30 [01:43<01:32,  6.14s/it]{'epoch': 22, 'num_users': 6.0625, 'loss': 0.0276, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8871, 'compress@10': 0.9055, 'time@10': 8.9939}:  53%|█████▎    | 16/30 [01:43<01:23,  5.98s/it]{'epoch': 22, 'num_users': 5.8235, 'loss': 0.0262, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8802, 'compress@10': 0.9063, 'time@10': 8.7549}:  53%|█████▎    | 16/30 [01:46<01:23,  5.98s/it]{'epoch': 22, 'num_users': 5.8235, 'loss': 0.0262, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8802, 'compress@10': 0.9063, 'time@10': 8.7549}:  57%|█████▋    | 17/30 [01:46<01:04,  4.94s/it]{'epoch': 22, 'num_users': 6.0556, 'loss': 0.0264, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8814, 'compress@10': 0.9062, 'time@10': 8.6528}:  57%|█████▋    | 17/30 [01:53<01:04,  4.94s/it]{'epoch': 22, 'num_users': 6.0556, 'loss': 0.0264, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8814, 'compress@10': 0.9062, 'time@10': 8.6528}:  60%|██████    | 18/30 [01:53<01:06,  5.54s/it]{'epoch': 22, 'num_users': 6.0, 'loss': 0.0256, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8822, 'compress@10': 0.9062, 'time@10': 8.5482}:  60%|██████    | 18/30 [01:56<01:06,  5.54s/it]   {'epoch': 22, 'num_users': 6.0, 'loss': 0.0256, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8822, 'compress@10': 0.9062, 'time@10': 8.5482}:  63%|██████▎   | 19/30 [01:56<00:53,  4.89s/it]{'epoch': 22, 'num_users': 6.15, 'loss': 0.0258, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8831, 'compress@10': 0.906, 'time@10': 8.7537}:  63%|██████▎   | 19/30 [02:09<00:53,  4.89s/it]{'epoch': 22, 'num_users': 6.15, 'loss': 0.0258, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8831, 'compress@10': 0.906, 'time@10': 8.7537}:  67%|██████▋   | 20/30 [02:09<01:12,  7.23s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.8808, 'compress@10': 0.9058, 'time@10': 8.8048}:  67%|██████▋   | 20/30 [02:14<01:12,  7.23s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.8808, 'compress@10': 0.9058, 'time@10': 8.8048}:  70%|███████   | 21/30 [02:14<00:58,  6.55s/it]{'epoch': 22, 'num_users': 6.1818, 'loss': 0.0282, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8823, 'compress@10': 0.9058, 'time@10': 8.6676}:  70%|███████   | 21/30 [02:20<00:58,  6.55s/it]{'epoch': 22, 'num_users': 6.1818, 'loss': 0.0282, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8823, 'compress@10': 0.9058, 'time@10': 8.6676}:  73%|███████▎  | 22/30 [02:20<00:50,  6.33s/it]{'epoch': 22, 'num_users': 6.1304, 'loss': 0.0277, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8836, 'compress@10': 0.9057, 'time@10': 8.7145}:  73%|███████▎  | 22/30 [02:25<00:50,  6.33s/it]{'epoch': 22, 'num_users': 6.1304, 'loss': 0.0277, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8836, 'compress@10': 0.9057, 'time@10': 8.7145}:  77%|███████▋  | 23/30 [02:25<00:41,  5.90s/it]{'epoch': 22, 'num_users': 5.9583, 'loss': 0.0271, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8802, 'compress@10': 0.9063, 'time@10': 8.4876}:  77%|███████▋  | 23/30 [02:28<00:41,  5.90s/it] {'epoch': 22, 'num_users': 5.9583, 'loss': 0.0271, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8802, 'compress@10': 0.9063, 'time@10': 8.4876}:  80%|████████  | 24/30 [02:28<00:30,  5.12s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0261, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8698, 'compress@10': 0.9074, 'time@10': 8.277}:  80%|████████  | 24/30 [02:30<00:30,  5.12s/it]    {'epoch': 22, 'num_users': 5.8, 'loss': 0.0261, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8698, 'compress@10': 0.9074, 'time@10': 8.277}:  83%|████████▎ | 25/30 [02:30<00:20,  4.08s/it]{'epoch': 22, 'num_users': 5.8077, 'loss': 0.0263, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8708, 'compress@10': 0.9072, 'time@10': 8.4164}:  83%|████████▎ | 25/30 [02:42<00:20,  4.08s/it]{'epoch': 22, 'num_users': 5.8077, 'loss': 0.0263, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8708, 'compress@10': 0.9072, 'time@10': 8.4164}:  87%|████████▋ | 26/30 [02:42<00:25,  6.44s/it]{'epoch': 22, 'num_users': 5.8889, 'loss': 0.0262, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8724, 'compress@10': 0.907, 'time@10': 8.5106}:  87%|████████▋ | 26/30 [02:47<00:25,  6.44s/it]  {'epoch': 22, 'num_users': 5.8889, 'loss': 0.0262, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8724, 'compress@10': 0.907, 'time@10': 8.5106}:  90%|█████████ | 27/30 [02:47<00:18,  6.16s/it]{'epoch': 22, 'num_users': 6.0, 'loss': 0.0264, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.875, 'compress@10': 0.9068, 'time@10': 8.662}:  90%|█████████ | 27/30 [03:00<00:18,  6.16s/it]   {'epoch': 22, 'num_users': 6.0, 'loss': 0.0264, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.875, 'compress@10': 0.9068, 'time@10': 8.662}:  93%|█████████▎| 28/30 [03:00<00:16,  8.15s/it]{'epoch': 22, 'num_users': 5.8621, 'loss': 0.0261, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.877, 'compress@10': 0.9068, 'time@10': 8.7207}:  93%|█████████▎| 28/30 [03:05<00:16,  8.15s/it]{'epoch': 22, 'num_users': 5.8621, 'loss': 0.0261, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.877, 'compress@10': 0.9068, 'time@10': 8.7207}:  97%|█████████▋| 29/30 [03:05<00:07,  7.27s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0262, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8785, 'compress@10': 0.9066, 'time@10': 8.7283}:  97%|█████████▋| 29/30 [03:14<00:07,  7.27s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0262, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8785, 'compress@10': 0.9066, 'time@10': 8.7283}: 100%|██████████| 30/30 [03:14<00:00,  7.78s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0262, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8785, 'compress@10': 0.9066, 'time@10': 8.7283}: 100%|██████████| 30/30 [03:14<00:00,  6.49s/it]
Epoch: 22
Avg # of users: 5.866666666666666
Avg Loss: 0.026228395808500567
Avg hit ratio: 0.8513622621778811
Avg ndcg: 0.8784797223130822
Avg compression ratio: 0.906629945779285
Avg train time: 8.728327115376791
Std train time: 2.9759113152301544
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 33, 8, 19, 25, 10, 10, 9, 5, 11, 10, 33, 33, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0382, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.873, 'compress@10': 0.9052, 'time@10': 8.9911}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0382, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.873, 'compress@10': 0.9052, 'time@10': 8.9911}:   3%|▎         | 1/30 [00:04<02:11,  4.53s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0298, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8898, 'compress@10': 0.9042, 'time@10': 8.6553}:   3%|▎         | 1/30 [00:12<02:11,  4.53s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0298, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8898, 'compress@10': 0.9042, 'time@10': 8.6553}:   7%|▋         | 2/30 [00:12<03:09,  6.78s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8789, 'compress@10': 0.9076, 'time@10': 7.57}:   7%|▋         | 2/30 [00:15<03:09,  6.78s/it]  {'epoch': 23, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8789, 'compress@10': 0.9076, 'time@10': 7.57}:  10%|█         | 3/30 [00:15<02:13,  4.93s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8825, 'compress@10': 0.9066, 'time@10': 7.3435}:  10%|█         | 3/30 [00:22<02:13,  4.93s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8825, 'compress@10': 0.9066, 'time@10': 7.3435}:  13%|█▎        | 4/30 [00:22<02:26,  5.63s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0323, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8617, 'compress@10': 0.9057, 'time@10': 8.2661}:  13%|█▎        | 4/30 [00:28<02:26,  5.63s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0323, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8617, 'compress@10': 0.9057, 'time@10': 8.2661}:  17%|█▋        | 5/30 [00:28<02:24,  5.77s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0323, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8684, 'compress@10': 0.9051, 'time@10': 9.2577}:  17%|█▋        | 5/30 [00:42<02:24,  5.77s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0323, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8684, 'compress@10': 0.9051, 'time@10': 9.2577}:  20%|██        | 6/30 [00:42<03:27,  8.65s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0322, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8676, 'compress@10': 0.9049, 'time@10': 9.349}:  20%|██        | 6/30 [00:47<03:27,  8.65s/it] {'epoch': 23, 'num_users': 6.2857, 'loss': 0.0322, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8676, 'compress@10': 0.9049, 'time@10': 9.349}:  23%|██▎       | 7/30 [00:47<02:51,  7.45s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.032, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8783, 'compress@10': 0.9047, 'time@10': 9.2477}:  23%|██▎       | 7/30 [00:56<02:51,  7.45s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.032, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8783, 'compress@10': 0.9047, 'time@10': 9.2477}:  27%|██▋       | 8/30 [00:56<02:51,  7.81s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0315, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8827, 'compress@10': 0.9045, 'time@10': 9.3914}:  27%|██▋       | 8/30 [01:01<02:51,  7.81s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0315, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8827, 'compress@10': 0.9045, 'time@10': 9.3914}:  30%|███       | 9/30 [01:01<02:27,  7.03s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8899, 'compress@10': 0.9042, 'time@10': 9.5784}:  30%|███       | 9/30 [01:12<02:27,  7.03s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8899, 'compress@10': 0.9042, 'time@10': 9.5784}:  33%|███▎      | 10/30 [01:12<02:46,  8.35s/it]{'epoch': 23, 'num_users': 6.6364, 'loss': 0.0328, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8897, 'compress@10': 0.9042, 'time@10': 9.9357}:  33%|███▎      | 10/30 [01:19<02:46,  8.35s/it]{'epoch': 23, 'num_users': 6.6364, 'loss': 0.0328, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8897, 'compress@10': 0.9042, 'time@10': 9.9357}:  37%|███▋      | 11/30 [01:19<02:29,  7.87s/it]{'epoch': 23, 'num_users': 6.4167, 'loss': 0.0307, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.892, 'compress@10': 0.9045, 'time@10': 9.5456}:  37%|███▋      | 11/30 [01:24<02:29,  7.87s/it] {'epoch': 23, 'num_users': 6.4167, 'loss': 0.0307, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.892, 'compress@10': 0.9045, 'time@10': 9.5456}:  40%|████      | 12/30 [01:24<02:07,  7.09s/it]{'epoch': 23, 'num_users': 6.6154, 'loss': 0.031, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8926, 'compress@10': 0.9045, 'time@10': 9.6297}:  40%|████      | 12/30 [01:30<02:07,  7.09s/it]{'epoch': 23, 'num_users': 6.6154, 'loss': 0.031, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8926, 'compress@10': 0.9045, 'time@10': 9.6297}:  43%|████▎     | 13/30 [01:30<01:51,  6.56s/it]{'epoch': 23, 'num_users': 6.3571, 'loss': 0.029, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8876, 'compress@10': 0.9054, 'time@10': 9.2211}:  43%|████▎     | 13/30 [01:34<01:51,  6.56s/it] {'epoch': 23, 'num_users': 6.3571, 'loss': 0.029, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8876, 'compress@10': 0.9054, 'time@10': 9.2211}:  47%|████▋     | 14/30 [01:34<01:32,  5.77s/it]{'epoch': 23, 'num_users': 6.2667, 'loss': 0.0293, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8883, 'compress@10': 0.9053, 'time@10': 9.3896}:  47%|████▋     | 14/30 [01:40<01:32,  5.77s/it]{'epoch': 23, 'num_users': 6.2667, 'loss': 0.0293, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8883, 'compress@10': 0.9053, 'time@10': 9.3896}:  50%|█████     | 15/30 [01:40<01:27,  5.81s/it]{'epoch': 23, 'num_users': 6.0625, 'loss': 0.0279, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8895, 'compress@10': 0.9055, 'time@10': 9.1331}:  50%|█████     | 15/30 [01:45<01:27,  5.81s/it]{'epoch': 23, 'num_users': 6.0625, 'loss': 0.0279, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8895, 'compress@10': 0.9055, 'time@10': 9.1331}:  53%|█████▎    | 16/30 [01:45<01:19,  5.67s/it]{'epoch': 23, 'num_users': 5.8235, 'loss': 0.0265, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8825, 'compress@10': 0.9063, 'time@10': 8.8696}:  53%|█████▎    | 16/30 [01:47<01:19,  5.67s/it]{'epoch': 23, 'num_users': 5.8235, 'loss': 0.0265, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8825, 'compress@10': 0.9063, 'time@10': 8.8696}:  57%|█████▋    | 17/30 [01:47<01:00,  4.67s/it]{'epoch': 23, 'num_users': 6.0556, 'loss': 0.0266, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8833, 'compress@10': 0.9062, 'time@10': 8.7649}:  57%|█████▋    | 17/30 [01:54<01:00,  4.67s/it]{'epoch': 23, 'num_users': 6.0556, 'loss': 0.0266, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8833, 'compress@10': 0.9062, 'time@10': 8.7649}:  60%|██████    | 18/30 [01:54<01:04,  5.39s/it]{'epoch': 23, 'num_users': 6.0, 'loss': 0.0262, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8844, 'compress@10': 0.9062, 'time@10': 8.6436}:  60%|██████    | 18/30 [01:58<01:04,  5.39s/it]   {'epoch': 23, 'num_users': 6.0, 'loss': 0.0262, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8844, 'compress@10': 0.9062, 'time@10': 8.6436}:  63%|██████▎   | 19/30 [01:58<00:52,  4.75s/it]{'epoch': 23, 'num_users': 6.15, 'loss': 0.0263, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8851, 'compress@10': 0.906, 'time@10': 8.8296}:  63%|██████▎   | 19/30 [02:10<00:52,  4.75s/it]{'epoch': 23, 'num_users': 6.15, 'loss': 0.0263, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8851, 'compress@10': 0.906, 'time@10': 8.8296}:  67%|██████▋   | 20/30 [02:10<01:10,  7.05s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0278, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8828, 'compress@10': 0.9058, 'time@10': 8.8763}:  67%|██████▋   | 20/30 [02:15<01:10,  7.05s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0278, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8828, 'compress@10': 0.9058, 'time@10': 8.8763}:  70%|███████   | 21/30 [02:15<00:57,  6.42s/it]{'epoch': 23, 'num_users': 6.1818, 'loss': 0.0282, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8844, 'compress@10': 0.9058, 'time@10': 8.7518}:  70%|███████   | 21/30 [02:21<00:57,  6.42s/it]{'epoch': 23, 'num_users': 6.1818, 'loss': 0.0282, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8844, 'compress@10': 0.9058, 'time@10': 8.7518}:  73%|███████▎  | 22/30 [02:21<00:50,  6.35s/it]{'epoch': 23, 'num_users': 6.1304, 'loss': 0.0278, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8856, 'compress@10': 0.9057, 'time@10': 8.8669}:  73%|███████▎  | 22/30 [02:27<00:50,  6.35s/it]{'epoch': 23, 'num_users': 6.1304, 'loss': 0.0278, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8856, 'compress@10': 0.9057, 'time@10': 8.8669}:  77%|███████▋  | 23/30 [02:27<00:43,  6.17s/it]{'epoch': 23, 'num_users': 5.9583, 'loss': 0.027, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.882, 'compress@10': 0.9063, 'time@10': 8.6536}:  77%|███████▋  | 23/30 [02:31<00:43,  6.17s/it]  {'epoch': 23, 'num_users': 5.9583, 'loss': 0.027, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.882, 'compress@10': 0.9063, 'time@10': 8.6536}:  80%|████████  | 24/30 [02:31<00:32,  5.45s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0261, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8716, 'compress@10': 0.9074, 'time@10': 8.4407}:  80%|████████  | 24/30 [02:32<00:32,  5.45s/it] {'epoch': 23, 'num_users': 5.8, 'loss': 0.0261, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8716, 'compress@10': 0.9074, 'time@10': 8.4407}:  83%|████████▎ | 25/30 [02:32<00:21,  4.33s/it]{'epoch': 23, 'num_users': 5.8077, 'loss': 0.0262, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8726, 'compress@10': 0.9072, 'time@10': 8.6414}:  83%|████████▎ | 25/30 [02:46<00:21,  4.33s/it]{'epoch': 23, 'num_users': 5.8077, 'loss': 0.0262, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8726, 'compress@10': 0.9072, 'time@10': 8.6414}:  87%|████████▋ | 26/30 [02:46<00:28,  7.14s/it]{'epoch': 23, 'num_users': 5.8889, 'loss': 0.0258, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8741, 'compress@10': 0.907, 'time@10': 8.7965}:  87%|████████▋ | 26/30 [02:52<00:28,  7.14s/it]  {'epoch': 23, 'num_users': 5.8889, 'loss': 0.0258, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8741, 'compress@10': 0.907, 'time@10': 8.7965}:  90%|█████████ | 27/30 [02:52<00:20,  6.93s/it]{'epoch': 23, 'num_users': 6.0, 'loss': 0.0256, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8763, 'compress@10': 0.9068, 'time@10': 8.9406}:  90%|█████████ | 27/30 [03:05<00:20,  6.93s/it]  {'epoch': 23, 'num_users': 6.0, 'loss': 0.0256, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8763, 'compress@10': 0.9068, 'time@10': 8.9406}:  93%|█████████▎| 28/30 [03:05<00:17,  8.71s/it]{'epoch': 23, 'num_users': 5.8621, 'loss': 0.0253, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8783, 'compress@10': 0.9068, 'time@10': 8.9981}:  93%|█████████▎| 28/30 [03:11<00:17,  8.71s/it]{'epoch': 23, 'num_users': 5.8621, 'loss': 0.0253, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8783, 'compress@10': 0.9068, 'time@10': 8.9981}:  97%|█████████▋| 29/30 [03:11<00:07,  7.70s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0255, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8797, 'compress@10': 0.9066, 'time@10': 8.9988}:  97%|█████████▋| 29/30 [03:20<00:07,  7.70s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0255, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8797, 'compress@10': 0.9066, 'time@10': 8.9988}: 100%|██████████| 30/30 [03:20<00:00,  8.11s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0255, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8797, 'compress@10': 0.9066, 'time@10': 8.9988}: 100%|██████████| 30/30 [03:20<00:00,  6.67s/it]
Epoch: 23
Avg # of users: 5.866666666666666
Avg Loss: 0.025479471558228484
Avg hit ratio: 0.8558591019166564
Avg ndcg: 0.8796928425243031
Avg compression ratio: 0.9066299382732255
Avg train time: 8.99881595770518
Std train time: 3.247209783680595
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 34, 8, 19, 26, 10, 10, 9, 5, 11, 10, 34, 34, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.873, 'compress@10': 0.9052, 'time@10': 9.5387}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.873, 'compress@10': 0.9052, 'time@10': 9.5387}:   3%|▎         | 1/30 [00:04<02:19,  4.80s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8904, 'compress@10': 0.9042, 'time@10': 8.5598}:   3%|▎         | 1/30 [00:12<02:19,  4.80s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8904, 'compress@10': 0.9042, 'time@10': 8.5598}:   7%|▋         | 2/30 [00:12<03:00,  6.46s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8793, 'compress@10': 0.9076, 'time@10': 7.4098}:   7%|▋         | 2/30 [00:15<03:00,  6.46s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8793, 'compress@10': 0.9076, 'time@10': 7.4098}:  10%|█         | 3/30 [00:15<02:06,  4.69s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8774, 'compress@10': 0.9066, 'time@10': 7.2165}:  10%|█         | 3/30 [00:21<02:06,  4.69s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8774, 'compress@10': 0.9066, 'time@10': 7.2165}:  13%|█▎        | 4/30 [00:21<02:22,  5.47s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.033, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8577, 'compress@10': 0.9057, 'time@10': 7.6317}:  13%|█▎        | 4/30 [00:26<02:22,  5.47s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.033, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8577, 'compress@10': 0.9057, 'time@10': 7.6317}:  17%|█▋        | 5/30 [00:26<02:09,  5.19s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0328, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8659, 'compress@10': 0.9051, 'time@10': 8.4908}:  17%|█▋        | 5/30 [00:39<02:09,  5.19s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0328, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8659, 'compress@10': 0.9051, 'time@10': 8.4908}:  20%|██        | 6/30 [00:39<03:06,  7.78s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0326, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8649, 'compress@10': 0.9049, 'time@10': 8.6485}:  20%|██        | 6/30 [00:44<03:06,  7.78s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0326, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8649, 'compress@10': 0.9049, 'time@10': 8.6485}:  23%|██▎       | 7/30 [00:44<02:36,  6.82s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0323, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.8764, 'compress@10': 0.9047, 'time@10': 8.5951}:  23%|██▎       | 7/30 [00:52<02:36,  6.82s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0323, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.8764, 'compress@10': 0.9047, 'time@10': 8.5951}:  27%|██▋       | 8/30 [00:52<02:40,  7.28s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0315, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8806, 'compress@10': 0.9045, 'time@10': 8.8081}:  27%|██▋       | 8/30 [00:57<02:40,  7.28s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0315, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8806, 'compress@10': 0.9045, 'time@10': 8.8081}:  30%|███       | 9/30 [00:57<02:19,  6.66s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0303, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.8869, 'compress@10': 0.9042, 'time@10': 9.0056}:  30%|███       | 9/30 [01:08<02:19,  6.66s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0303, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.8869, 'compress@10': 0.9042, 'time@10': 9.0056}:  33%|███▎      | 10/30 [01:08<02:38,  7.94s/it]{'epoch': 24, 'num_users': 6.6364, 'loss': 0.0313, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8871, 'compress@10': 0.9042, 'time@10': 9.4721}:  33%|███▎      | 10/30 [01:15<02:38,  7.94s/it]{'epoch': 24, 'num_users': 6.6364, 'loss': 0.0313, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8871, 'compress@10': 0.9042, 'time@10': 9.4721}:  37%|███▋      | 11/30 [01:15<02:26,  7.69s/it]{'epoch': 24, 'num_users': 6.4167, 'loss': 0.0293, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8896, 'compress@10': 0.9045, 'time@10': 9.1552}:  37%|███▋      | 11/30 [01:21<02:26,  7.69s/it]{'epoch': 24, 'num_users': 6.4167, 'loss': 0.0293, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8896, 'compress@10': 0.9045, 'time@10': 9.1552}:  40%|████      | 12/30 [01:21<02:07,  7.08s/it]{'epoch': 24, 'num_users': 6.6154, 'loss': 0.0297, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8901, 'compress@10': 0.9045, 'time@10': 9.2734}:  40%|████      | 12/30 [01:26<02:07,  7.08s/it]{'epoch': 24, 'num_users': 6.6154, 'loss': 0.0297, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8901, 'compress@10': 0.9045, 'time@10': 9.2734}:  43%|████▎     | 13/30 [01:26<01:51,  6.57s/it]{'epoch': 24, 'num_users': 6.3571, 'loss': 0.0277, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8853, 'compress@10': 0.9054, 'time@10': 8.9426}:  43%|████▎     | 13/30 [01:31<01:51,  6.57s/it]{'epoch': 24, 'num_users': 6.3571, 'loss': 0.0277, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8853, 'compress@10': 0.9054, 'time@10': 8.9426}:  47%|████▋     | 14/30 [01:31<01:35,  6.00s/it]{'epoch': 24, 'num_users': 6.2667, 'loss': 0.0279, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8865, 'compress@10': 0.9053, 'time@10': 9.1989}:  47%|████▋     | 14/30 [01:37<01:35,  6.00s/it]{'epoch': 24, 'num_users': 6.2667, 'loss': 0.0279, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8865, 'compress@10': 0.9053, 'time@10': 9.1989}:  50%|█████     | 15/30 [01:37<01:31,  6.13s/it]{'epoch': 24, 'num_users': 6.0625, 'loss': 0.0266, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8878, 'compress@10': 0.9055, 'time@10': 8.9816}:  50%|█████     | 15/30 [01:43<01:31,  6.13s/it]{'epoch': 24, 'num_users': 6.0625, 'loss': 0.0266, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8878, 'compress@10': 0.9055, 'time@10': 8.9816}:  53%|█████▎    | 16/30 [01:43<01:24,  6.02s/it]{'epoch': 24, 'num_users': 5.8235, 'loss': 0.0252, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8809, 'compress@10': 0.9063, 'time@10': 8.7554}:  53%|█████▎    | 16/30 [01:46<01:24,  6.02s/it]{'epoch': 24, 'num_users': 5.8235, 'loss': 0.0252, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8809, 'compress@10': 0.9063, 'time@10': 8.7554}:  57%|█████▋    | 17/30 [01:46<01:04,  4.99s/it]{'epoch': 24, 'num_users': 6.0556, 'loss': 0.0253, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8818, 'compress@10': 0.9062, 'time@10': 8.6423}:  57%|█████▋    | 17/30 [01:52<01:04,  4.99s/it]{'epoch': 24, 'num_users': 6.0556, 'loss': 0.0253, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8818, 'compress@10': 0.9062, 'time@10': 8.6423}:  60%|██████    | 18/30 [01:52<01:06,  5.52s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 0.0245, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8829, 'compress@10': 0.9062, 'time@10': 8.5275}:  60%|██████    | 18/30 [01:56<01:06,  5.52s/it]   {'epoch': 24, 'num_users': 6.0, 'loss': 0.0245, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8829, 'compress@10': 0.9062, 'time@10': 8.5275}:  63%|██████▎   | 19/30 [01:56<00:53,  4.85s/it]{'epoch': 24, 'num_users': 6.15, 'loss': 0.0247, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8838, 'compress@10': 0.906, 'time@10': 8.7216}:  63%|██████▎   | 19/30 [02:08<00:53,  4.85s/it]{'epoch': 24, 'num_users': 6.15, 'loss': 0.0247, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8838, 'compress@10': 0.906, 'time@10': 8.7216}:  67%|██████▋   | 20/30 [02:08<01:11,  7.13s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8814, 'compress@10': 0.9058, 'time@10': 8.7782}:  67%|██████▋   | 20/30 [02:13<01:11,  7.13s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8814, 'compress@10': 0.9058, 'time@10': 8.7782}:  70%|███████   | 21/30 [02:13<00:58,  6.49s/it]{'epoch': 24, 'num_users': 6.1818, 'loss': 0.027, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8827, 'compress@10': 0.9058, 'time@10': 8.6384}:  70%|███████   | 21/30 [02:19<00:58,  6.49s/it] {'epoch': 24, 'num_users': 6.1818, 'loss': 0.027, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8827, 'compress@10': 0.9058, 'time@10': 8.6384}:  73%|███████▎  | 22/30 [02:19<00:50,  6.26s/it]{'epoch': 24, 'num_users': 6.1304, 'loss': 0.0265, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8841, 'compress@10': 0.9057, 'time@10': 8.6833}:  73%|███████▎  | 22/30 [02:24<00:50,  6.26s/it]{'epoch': 24, 'num_users': 6.1304, 'loss': 0.0265, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8841, 'compress@10': 0.9057, 'time@10': 8.6833}:  77%|███████▋  | 23/30 [02:24<00:40,  5.84s/it]{'epoch': 24, 'num_users': 5.9583, 'loss': 0.0258, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8806, 'compress@10': 0.9063, 'time@10': 8.4647}:  77%|███████▋  | 23/30 [02:27<00:40,  5.84s/it]{'epoch': 24, 'num_users': 5.9583, 'loss': 0.0258, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8806, 'compress@10': 0.9063, 'time@10': 8.4647}:  80%|████████  | 24/30 [02:27<00:30,  5.13s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0249, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8702, 'compress@10': 0.9074, 'time@10': 8.263}:  80%|████████  | 24/30 [02:29<00:30,  5.13s/it]    {'epoch': 24, 'num_users': 5.8, 'loss': 0.0249, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8702, 'compress@10': 0.9074, 'time@10': 8.263}:  83%|████████▎ | 25/30 [02:29<00:20,  4.12s/it]{'epoch': 24, 'num_users': 5.8077, 'loss': 0.025, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8716, 'compress@10': 0.9072, 'time@10': 8.4092}:  83%|████████▎ | 25/30 [02:41<00:20,  4.12s/it]{'epoch': 24, 'num_users': 5.8077, 'loss': 0.025, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8716, 'compress@10': 0.9072, 'time@10': 8.4092}:  87%|████████▋ | 26/30 [02:41<00:26,  6.51s/it]{'epoch': 24, 'num_users': 5.8889, 'loss': 0.0246, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8732, 'compress@10': 0.907, 'time@10': 8.5019}:  87%|████████▋ | 26/30 [02:46<00:26,  6.51s/it]{'epoch': 24, 'num_users': 5.8889, 'loss': 0.0246, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8732, 'compress@10': 0.907, 'time@10': 8.5019}:  90%|█████████ | 27/30 [02:46<00:18,  6.21s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 0.0243, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8756, 'compress@10': 0.9068, 'time@10': 8.6407}:  90%|█████████ | 27/30 [02:59<00:18,  6.21s/it]   {'epoch': 24, 'num_users': 6.0, 'loss': 0.0243, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8756, 'compress@10': 0.9068, 'time@10': 8.6407}:  93%|█████████▎| 28/30 [02:59<00:16,  8.07s/it]{'epoch': 24, 'num_users': 5.8621, 'loss': 0.024, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8776, 'compress@10': 0.9068, 'time@10': 8.693}:  93%|█████████▎| 28/30 [03:04<00:16,  8.07s/it]{'epoch': 24, 'num_users': 5.8621, 'loss': 0.024, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8776, 'compress@10': 0.9068, 'time@10': 8.693}:  97%|█████████▋| 29/30 [03:04<00:07,  7.18s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0242, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.879, 'compress@10': 0.9066, 'time@10': 8.7028}:  97%|█████████▋| 29/30 [03:13<00:07,  7.18s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0242, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.879, 'compress@10': 0.9066, 'time@10': 8.7028}: 100%|██████████| 30/30 [03:13<00:00,  7.74s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0242, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.879, 'compress@10': 0.9066, 'time@10': 8.7028}: 100%|██████████| 30/30 [03:13<00:00,  6.45s/it]
Epoch: 24
Avg # of users: 5.866666666666666
Avg Loss: 0.024170245094256783
Avg hit ratio: 0.8605266163210128
Avg ndcg: 0.8790166115272602
Avg compression ratio: 0.9066299380412293
Avg train time: 8.702817352612813
Std train time: 2.9662239640452657
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 35, 8, 19, 26, 10, 10, 9, 5, 11, 10, 35, 35, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0366, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8691, 'compress@10': 0.9052, 'time@10': 8.7354}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0366, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8691, 'compress@10': 0.9052, 'time@10': 8.7354}:   3%|▎         | 1/30 [00:04<02:07,  4.40s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8905, 'compress@10': 0.9042, 'time@10': 8.6791}:   3%|▎         | 1/30 [00:13<02:07,  4.40s/it] {'epoch': 25, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8905, 'compress@10': 0.9042, 'time@10': 8.6791}:   7%|▋         | 2/30 [00:13<03:13,  6.91s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8794, 'compress@10': 0.9076, 'time@10': 7.7501}:   7%|▋         | 2/30 [00:16<03:13,  6.91s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8794, 'compress@10': 0.9076, 'time@10': 7.7501}:  10%|█         | 3/30 [00:16<02:18,  5.14s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0288, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8685, 'compress@10': 0.9066, 'time@10': 7.5267}:  10%|█         | 3/30 [00:22<02:18,  5.14s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0288, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8685, 'compress@10': 0.9066, 'time@10': 7.5267}:  13%|█▎        | 4/30 [00:22<02:31,  5.83s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0374, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8503, 'compress@10': 0.9057, 'time@10': 8.3085}:  13%|█▎        | 4/30 [00:28<02:31,  5.83s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0374, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8503, 'compress@10': 0.9057, 'time@10': 8.3085}:  17%|█▋        | 5/30 [00:28<02:25,  5.80s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0359, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8603, 'compress@10': 0.9051, 'time@10': 9.0097}:  17%|█▋        | 5/30 [00:41<02:25,  5.80s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0359, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8603, 'compress@10': 0.9051, 'time@10': 9.0097}:  20%|██        | 6/30 [00:41<03:14,  8.10s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0352, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8603, 'compress@10': 0.9049, 'time@10': 9.1488}:  20%|██        | 6/30 [00:46<03:14,  8.10s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0352, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8603, 'compress@10': 0.9049, 'time@10': 9.1488}:  23%|██▎       | 7/30 [00:46<02:43,  7.10s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0346, 'hit_ratio@10': 0.887, 'ndcg@10': 0.8733, 'compress@10': 0.9047, 'time@10': 9.0645}:  23%|██▎       | 7/30 [00:54<02:43,  7.10s/it]  {'epoch': 25, 'num_users': 6.125, 'loss': 0.0346, 'hit_ratio@10': 0.887, 'ndcg@10': 0.8733, 'compress@10': 0.9047, 'time@10': 9.0645}:  27%|██▋       | 8/30 [00:54<02:46,  7.55s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0334, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8791, 'compress@10': 0.9045, 'time@10': 9.2195}:  27%|██▋       | 8/30 [01:00<02:46,  7.55s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0334, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8791, 'compress@10': 0.9045, 'time@10': 9.2195}:  30%|███       | 9/30 [01:00<02:23,  6.83s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0327, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8857, 'compress@10': 0.9042, 'time@10': 9.388}:  30%|███       | 9/30 [01:11<02:23,  6.83s/it]    {'epoch': 25, 'num_users': 6.3, 'loss': 0.0327, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8857, 'compress@10': 0.9042, 'time@10': 9.388}:  33%|███▎      | 10/30 [01:11<02:42,  8.10s/it]{'epoch': 25, 'num_users': 6.6364, 'loss': 0.0336, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.886, 'compress@10': 0.9042, 'time@10': 9.697}:  33%|███▎      | 10/30 [01:17<02:42,  8.10s/it]{'epoch': 25, 'num_users': 6.6364, 'loss': 0.0336, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.886, 'compress@10': 0.9042, 'time@10': 9.697}:  37%|███▋      | 11/30 [01:17<02:24,  7.59s/it]{'epoch': 25, 'num_users': 6.4167, 'loss': 0.0314, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8886, 'compress@10': 0.9045, 'time@10': 9.3833}:  37%|███▋      | 11/30 [01:23<02:24,  7.59s/it]{'epoch': 25, 'num_users': 6.4167, 'loss': 0.0314, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8886, 'compress@10': 0.9045, 'time@10': 9.3833}:  40%|████      | 12/30 [01:23<02:07,  7.10s/it]{'epoch': 25, 'num_users': 6.6154, 'loss': 0.0315, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8893, 'compress@10': 0.9045, 'time@10': 9.4757}:  40%|████      | 12/30 [01:28<02:07,  7.10s/it]{'epoch': 25, 'num_users': 6.6154, 'loss': 0.0315, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8893, 'compress@10': 0.9045, 'time@10': 9.4757}:  43%|████▎     | 13/30 [01:28<01:51,  6.56s/it]{'epoch': 25, 'num_users': 6.3571, 'loss': 0.0294, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8845, 'compress@10': 0.9054, 'time@10': 9.1026}:  43%|████▎     | 13/30 [01:33<01:51,  6.56s/it]{'epoch': 25, 'num_users': 6.3571, 'loss': 0.0294, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8845, 'compress@10': 0.9054, 'time@10': 9.1026}:  47%|████▋     | 14/30 [01:33<01:33,  5.87s/it]{'epoch': 25, 'num_users': 6.2667, 'loss': 0.0294, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8858, 'compress@10': 0.9053, 'time@10': 9.3025}:  47%|████▋     | 14/30 [01:39<01:33,  5.87s/it]{'epoch': 25, 'num_users': 6.2667, 'loss': 0.0294, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8858, 'compress@10': 0.9053, 'time@10': 9.3025}:  50%|█████     | 15/30 [01:39<01:29,  5.94s/it]{'epoch': 25, 'num_users': 6.0625, 'loss': 0.0281, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8871, 'compress@10': 0.9055, 'time@10': 9.0366}:  50%|█████     | 15/30 [01:44<01:29,  5.94s/it]{'epoch': 25, 'num_users': 6.0625, 'loss': 0.0281, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8871, 'compress@10': 0.9055, 'time@10': 9.0366}:  53%|█████▎    | 16/30 [01:44<01:19,  5.68s/it]{'epoch': 25, 'num_users': 5.8235, 'loss': 0.0266, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8803, 'compress@10': 0.9063, 'time@10': 8.8191}:  53%|█████▎    | 16/30 [01:46<01:19,  5.68s/it]{'epoch': 25, 'num_users': 5.8235, 'loss': 0.0266, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8803, 'compress@10': 0.9063, 'time@10': 8.8191}:  57%|█████▋    | 17/30 [01:46<01:02,  4.79s/it]{'epoch': 25, 'num_users': 6.0556, 'loss': 0.0265, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8816, 'compress@10': 0.9062, 'time@10': 8.7418}:  57%|█████▋    | 17/30 [01:54<01:02,  4.79s/it] {'epoch': 25, 'num_users': 6.0556, 'loss': 0.0265, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8816, 'compress@10': 0.9062, 'time@10': 8.7418}:  60%|██████    | 18/30 [01:54<01:07,  5.59s/it]{'epoch': 25, 'num_users': 6.0, 'loss': 0.0261, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8828, 'compress@10': 0.9062, 'time@10': 8.6839}:  60%|██████    | 18/30 [01:58<01:07,  5.59s/it]  {'epoch': 25, 'num_users': 6.0, 'loss': 0.0261, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8828, 'compress@10': 0.9062, 'time@10': 8.6839}:  63%|██████▎   | 19/30 [01:58<00:55,  5.07s/it]{'epoch': 25, 'num_users': 6.15, 'loss': 0.0261, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.8841, 'compress@10': 0.906, 'time@10': 8.8641}:  63%|██████▎   | 19/30 [02:10<00:55,  5.07s/it]{'epoch': 25, 'num_users': 6.15, 'loss': 0.0261, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.8841, 'compress@10': 0.906, 'time@10': 8.8641}:  67%|██████▋   | 20/30 [02:10<01:12,  7.25s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0275, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.8816, 'compress@10': 0.9058, 'time@10': 8.9083}:  67%|██████▋   | 20/30 [02:15<01:12,  7.25s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0275, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.8816, 'compress@10': 0.9058, 'time@10': 8.9083}:  70%|███████   | 21/30 [02:15<00:58,  6.55s/it]{'epoch': 25, 'num_users': 6.1818, 'loss': 0.028, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8821, 'compress@10': 0.9058, 'time@10': 8.8117}:  70%|███████   | 21/30 [02:22<00:58,  6.55s/it] {'epoch': 25, 'num_users': 6.1818, 'loss': 0.028, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8821, 'compress@10': 0.9058, 'time@10': 8.8117}:  73%|███████▎  | 22/30 [02:22<00:53,  6.63s/it]{'epoch': 25, 'num_users': 6.1304, 'loss': 0.0275, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8838, 'compress@10': 0.9057, 'time@10': 8.8604}:  73%|███████▎  | 22/30 [02:27<00:53,  6.63s/it]{'epoch': 25, 'num_users': 6.1304, 'loss': 0.0275, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8838, 'compress@10': 0.9057, 'time@10': 8.8604}:  77%|███████▋  | 23/30 [02:27<00:43,  6.14s/it]{'epoch': 25, 'num_users': 5.9583, 'loss': 0.0267, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8803, 'compress@10': 0.9063, 'time@10': 8.6435}:  77%|███████▋  | 23/30 [02:31<00:43,  6.14s/it]{'epoch': 25, 'num_users': 5.9583, 'loss': 0.0267, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8803, 'compress@10': 0.9063, 'time@10': 8.6435}:  80%|████████  | 24/30 [02:31<00:32,  5.41s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8699, 'compress@10': 0.9074, 'time@10': 8.4376}:  80%|████████  | 24/30 [02:32<00:32,  5.41s/it]    {'epoch': 25, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8699, 'compress@10': 0.9074, 'time@10': 8.4376}:  83%|████████▎ | 25/30 [02:32<00:21,  4.32s/it]{'epoch': 25, 'num_users': 5.8077, 'loss': 0.0257, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8717, 'compress@10': 0.9072, 'time@10': 8.6274}:  83%|████████▎ | 25/30 [02:46<00:21,  4.32s/it]{'epoch': 25, 'num_users': 5.8077, 'loss': 0.0257, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8717, 'compress@10': 0.9072, 'time@10': 8.6274}:  87%|████████▋ | 26/30 [02:46<00:28,  7.05s/it]{'epoch': 25, 'num_users': 5.8889, 'loss': 0.0253, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8733, 'compress@10': 0.907, 'time@10': 8.7492}:  87%|████████▋ | 26/30 [02:52<00:28,  7.05s/it]{'epoch': 25, 'num_users': 5.8889, 'loss': 0.0253, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8733, 'compress@10': 0.907, 'time@10': 8.7492}:  90%|█████████ | 27/30 [02:52<00:20,  6.73s/it]{'epoch': 25, 'num_users': 6.0, 'loss': 0.025, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8754, 'compress@10': 0.9068, 'time@10': 8.8975}:  90%|█████████ | 27/30 [03:05<00:20,  6.73s/it]   {'epoch': 25, 'num_users': 6.0, 'loss': 0.025, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8754, 'compress@10': 0.9068, 'time@10': 8.8975}:  93%|█████████▎| 28/30 [03:05<00:17,  8.59s/it]{'epoch': 25, 'num_users': 5.8621, 'loss': 0.0247, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8775, 'compress@10': 0.9068, 'time@10': 8.9446}:  93%|█████████▎| 28/30 [03:10<00:17,  8.59s/it]{'epoch': 25, 'num_users': 5.8621, 'loss': 0.0247, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8775, 'compress@10': 0.9068, 'time@10': 8.9446}:  97%|█████████▋| 29/30 [03:10<00:07,  7.57s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.0249, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.879, 'compress@10': 0.9066, 'time@10': 8.9463}:  97%|█████████▋| 29/30 [03:19<00:07,  7.57s/it] {'epoch': 25, 'num_users': 5.8667, 'loss': 0.0249, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.879, 'compress@10': 0.9066, 'time@10': 8.9463}: 100%|██████████| 30/30 [03:19<00:00,  8.01s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.0249, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.879, 'compress@10': 0.9066, 'time@10': 8.9463}: 100%|██████████| 30/30 [03:19<00:00,  6.65s/it]
Epoch: 25
Avg # of users: 5.866666666666666
Avg Loss: 0.024858154318978618
Avg hit ratio: 0.8615504258448224
Avg ndcg: 0.878980575459036
Avg compression ratio: 0.906629934293199
Avg train time: 8.946278397242228
Std train time: 2.8980832469406694
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 36, 8, 19, 26, 10, 10, 9, 5, 11, 10, 36, 36, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8727, 'compress@10': 0.9052, 'time@10': 9.2111}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8727, 'compress@10': 0.9052, 'time@10': 9.2111}:   3%|▎         | 1/30 [00:04<02:14,  4.64s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8931, 'compress@10': 0.9042, 'time@10': 8.3726}:   3%|▎         | 1/30 [00:12<02:14,  4.64s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8931, 'compress@10': 0.9042, 'time@10': 8.3726}:   7%|▋         | 2/30 [00:12<02:58,  6.36s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.7723, 'ndcg@10': 0.8811, 'compress@10': 0.9076, 'time@10': 7.2516}:   7%|▋         | 2/30 [00:14<02:58,  6.36s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.7723, 'ndcg@10': 0.8811, 'compress@10': 0.9076, 'time@10': 7.2516}:  10%|█         | 3/30 [00:14<02:04,  4.62s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8532, 'compress@10': 0.9066, 'time@10': 7.1063}:  10%|█         | 3/30 [00:21<02:04,  4.62s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8532, 'compress@10': 0.9066, 'time@10': 7.1063}:  13%|█▎        | 4/30 [00:21<02:21,  5.44s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0332, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.838, 'compress@10': 0.9057, 'time@10': 7.6119}:  13%|█▎        | 4/30 [00:26<02:21,  5.44s/it] {'epoch': 26, 'num_users': 5.8, 'loss': 0.0332, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.838, 'compress@10': 0.9057, 'time@10': 7.6119}:  17%|█▋        | 5/30 [00:26<02:10,  5.23s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0332, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8499, 'compress@10': 0.9051, 'time@10': 8.2771}:  17%|█▋        | 5/30 [00:37<02:10,  5.23s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0332, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8499, 'compress@10': 0.9051, 'time@10': 8.2771}:  20%|██        | 6/30 [00:37<02:57,  7.41s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0328, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8516, 'compress@10': 0.9049, 'time@10': 8.6143}:  20%|██        | 6/30 [00:43<02:57,  7.41s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0328, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8516, 'compress@10': 0.9049, 'time@10': 8.6143}:  23%|██▎       | 7/30 [00:43<02:35,  6.74s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0322, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8648, 'compress@10': 0.9047, 'time@10': 8.5963}:  23%|██▎       | 7/30 [00:51<02:35,  6.74s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0322, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8648, 'compress@10': 0.9047, 'time@10': 8.5963}:  27%|██▋       | 8/30 [00:51<02:40,  7.31s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0312, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8718, 'compress@10': 0.9045, 'time@10': 8.8019}:  27%|██▋       | 8/30 [00:57<02:40,  7.31s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0312, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8718, 'compress@10': 0.9045, 'time@10': 8.8019}:  30%|███       | 9/30 [00:57<02:19,  6.67s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0306, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8784, 'compress@10': 0.9042, 'time@10': 9.0002}:  30%|███       | 9/30 [01:07<02:19,  6.67s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0306, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8784, 'compress@10': 0.9042, 'time@10': 9.0002}:  33%|███▎      | 10/30 [01:07<02:39,  7.95s/it]{'epoch': 26, 'num_users': 6.6364, 'loss': 0.0317, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8796, 'compress@10': 0.9042, 'time@10': 9.4441}:  33%|███▎      | 10/30 [01:14<02:39,  7.95s/it]{'epoch': 26, 'num_users': 6.6364, 'loss': 0.0317, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8796, 'compress@10': 0.9042, 'time@10': 9.4441}:  37%|███▋      | 11/30 [01:14<02:25,  7.65s/it]{'epoch': 26, 'num_users': 6.4167, 'loss': 0.0296, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.8826, 'compress@10': 0.9045, 'time@10': 9.1561}:  37%|███▋      | 11/30 [01:20<02:25,  7.65s/it]{'epoch': 26, 'num_users': 6.4167, 'loss': 0.0296, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.8826, 'compress@10': 0.9045, 'time@10': 9.1561}:  40%|████      | 12/30 [01:20<02:09,  7.18s/it]{'epoch': 26, 'num_users': 6.6154, 'loss': 0.0298, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8842, 'compress@10': 0.9045, 'time@10': 9.3685}:  40%|████      | 12/30 [01:26<02:09,  7.18s/it]{'epoch': 26, 'num_users': 6.6154, 'loss': 0.0298, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8842, 'compress@10': 0.9045, 'time@10': 9.3685}:  43%|████▎     | 13/30 [01:26<01:55,  6.82s/it]{'epoch': 26, 'num_users': 6.3571, 'loss': 0.0278, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8797, 'compress@10': 0.9054, 'time@10': 9.0348}:  43%|████▎     | 13/30 [01:31<01:55,  6.82s/it]{'epoch': 26, 'num_users': 6.3571, 'loss': 0.0278, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8797, 'compress@10': 0.9054, 'time@10': 9.0348}:  47%|████▋     | 14/30 [01:31<01:39,  6.19s/it]{'epoch': 26, 'num_users': 6.2667, 'loss': 0.0281, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8816, 'compress@10': 0.9053, 'time@10': 9.3567}:  47%|████▋     | 14/30 [01:38<01:39,  6.19s/it]{'epoch': 26, 'num_users': 6.2667, 'loss': 0.0281, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8816, 'compress@10': 0.9053, 'time@10': 9.3567}:  50%|█████     | 15/30 [01:38<01:36,  6.42s/it]{'epoch': 26, 'num_users': 6.0625, 'loss': 0.0266, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8832, 'compress@10': 0.9055, 'time@10': 9.1128}:  50%|█████     | 15/30 [01:44<01:36,  6.42s/it]{'epoch': 26, 'num_users': 6.0625, 'loss': 0.0266, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8832, 'compress@10': 0.9055, 'time@10': 9.1128}:  53%|█████▎    | 16/30 [01:44<01:25,  6.14s/it]{'epoch': 26, 'num_users': 5.8235, 'loss': 0.0252, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8766, 'compress@10': 0.9063, 'time@10': 8.9176}:  53%|█████▎    | 16/30 [01:47<01:25,  6.14s/it] {'epoch': 26, 'num_users': 5.8235, 'loss': 0.0252, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8766, 'compress@10': 0.9063, 'time@10': 8.9176}:  57%|█████▋    | 17/30 [01:47<01:07,  5.18s/it]{'epoch': 26, 'num_users': 6.0556, 'loss': 0.0252, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8781, 'compress@10': 0.9062, 'time@10': 8.7969}:  57%|█████▋    | 17/30 [01:53<01:07,  5.18s/it]{'epoch': 26, 'num_users': 6.0556, 'loss': 0.0252, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8781, 'compress@10': 0.9062, 'time@10': 8.7969}:  60%|██████    | 18/30 [01:53<01:07,  5.66s/it]{'epoch': 26, 'num_users': 6.0, 'loss': 0.0244, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8796, 'compress@10': 0.9062, 'time@10': 8.7025}:  60%|██████    | 18/30 [01:57<01:07,  5.66s/it]  {'epoch': 26, 'num_users': 6.0, 'loss': 0.0244, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8796, 'compress@10': 0.9062, 'time@10': 8.7025}:  63%|██████▎   | 19/30 [01:57<00:55,  5.02s/it]{'epoch': 26, 'num_users': 6.15, 'loss': 0.0244, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8812, 'compress@10': 0.906, 'time@10': 8.8977}:  63%|██████▎   | 19/30 [02:10<00:55,  5.02s/it] {'epoch': 26, 'num_users': 6.15, 'loss': 0.0244, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8812, 'compress@10': 0.906, 'time@10': 8.8977}:  67%|██████▋   | 20/30 [02:10<01:13,  7.31s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0259, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.879, 'compress@10': 0.9058, 'time@10': 8.9444}:  67%|██████▋   | 20/30 [02:15<01:13,  7.31s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0259, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.879, 'compress@10': 0.9058, 'time@10': 8.9444}:  70%|███████   | 21/30 [02:15<00:59,  6.61s/it]{'epoch': 26, 'num_users': 6.1818, 'loss': 0.0262, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8808, 'compress@10': 0.9058, 'time@10': 8.8008}:  70%|███████   | 21/30 [02:20<00:59,  6.61s/it]{'epoch': 26, 'num_users': 6.1818, 'loss': 0.0262, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8808, 'compress@10': 0.9058, 'time@10': 8.8008}:  73%|███████▎  | 22/30 [02:20<00:50,  6.37s/it]{'epoch': 26, 'num_users': 6.1304, 'loss': 0.0258, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8825, 'compress@10': 0.9057, 'time@10': 8.8284}:  73%|███████▎  | 22/30 [02:25<00:50,  6.37s/it]{'epoch': 26, 'num_users': 6.1304, 'loss': 0.0258, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8825, 'compress@10': 0.9057, 'time@10': 8.8284}:  77%|███████▋  | 23/30 [02:25<00:41,  5.89s/it]{'epoch': 26, 'num_users': 5.9583, 'loss': 0.025, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8791, 'compress@10': 0.9063, 'time@10': 8.6111}:  77%|███████▋  | 23/30 [02:29<00:41,  5.89s/it] {'epoch': 26, 'num_users': 5.9583, 'loss': 0.025, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8791, 'compress@10': 0.9063, 'time@10': 8.6111}:  80%|████████  | 24/30 [02:29<00:31,  5.22s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0241, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8688, 'compress@10': 0.9074, 'time@10': 8.4113}:  80%|████████  | 24/30 [02:31<00:31,  5.22s/it]  {'epoch': 26, 'num_users': 5.8, 'loss': 0.0241, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8688, 'compress@10': 0.9074, 'time@10': 8.4113}:  83%|████████▎ | 25/30 [02:31<00:21,  4.20s/it]{'epoch': 26, 'num_users': 5.8077, 'loss': 0.0241, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8709, 'compress@10': 0.9072, 'time@10': 8.5494}:  83%|████████▎ | 25/30 [02:43<00:21,  4.20s/it]{'epoch': 26, 'num_users': 5.8077, 'loss': 0.0241, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8709, 'compress@10': 0.9072, 'time@10': 8.5494}:  87%|████████▋ | 26/30 [02:43<00:26,  6.55s/it]{'epoch': 26, 'num_users': 5.8889, 'loss': 0.0238, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.8726, 'compress@10': 0.907, 'time@10': 8.6357}:  87%|████████▋ | 26/30 [02:48<00:26,  6.55s/it] {'epoch': 26, 'num_users': 5.8889, 'loss': 0.0238, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.8726, 'compress@10': 0.907, 'time@10': 8.6357}:  90%|█████████ | 27/30 [02:48<00:18,  6.23s/it]{'epoch': 26, 'num_users': 6.0, 'loss': 0.0234, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8753, 'compress@10': 0.9068, 'time@10': 8.7792}:  90%|█████████ | 27/30 [03:01<00:18,  6.23s/it]  {'epoch': 26, 'num_users': 6.0, 'loss': 0.0234, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8753, 'compress@10': 0.9068, 'time@10': 8.7792}:  93%|█████████▎| 28/30 [03:01<00:16,  8.17s/it]{'epoch': 26, 'num_users': 5.8621, 'loss': 0.0231, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8773, 'compress@10': 0.9068, 'time@10': 8.8485}:  93%|█████████▎| 28/30 [03:06<00:16,  8.17s/it]{'epoch': 26, 'num_users': 5.8621, 'loss': 0.0231, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8773, 'compress@10': 0.9068, 'time@10': 8.8485}:  97%|█████████▋| 29/30 [03:06<00:07,  7.35s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0233, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8786, 'compress@10': 0.9066, 'time@10': 8.844}:  97%|█████████▋| 29/30 [03:15<00:07,  7.35s/it] {'epoch': 26, 'num_users': 5.8667, 'loss': 0.0233, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8786, 'compress@10': 0.9066, 'time@10': 8.844}: 100%|██████████| 30/30 [03:15<00:00,  7.77s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0233, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8786, 'compress@10': 0.9066, 'time@10': 8.844}: 100%|██████████| 30/30 [03:15<00:00,  6.52s/it]
Epoch: 26
Avg # of users: 5.866666666666666
Avg Loss: 0.023271492484565
Avg hit ratio: 0.8547347076876409
Avg ndcg: 0.8786326542567954
Avg compression ratio: 0.9066299209083225
Avg train time: 8.843953124682109
Std train time: 2.9734580957146832
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 37, 8, 19, 26, 10, 10, 9, 5, 11, 10, 37, 37, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8706, 'compress@10': 0.9052, 'time@10': 10.6565}:   0%|          | 0/30 [00:05<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8706, 'compress@10': 0.9052, 'time@10': 10.6565}:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8932, 'compress@10': 0.9042, 'time@10': 9.2847}:   3%|▎         | 1/30 [00:13<02:35,  5.36s/it] {'epoch': 27, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8932, 'compress@10': 0.9042, 'time@10': 9.2847}:   7%|▋         | 2/30 [00:13<03:13,  6.89s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8812, 'compress@10': 0.9076, 'time@10': 8.4108}:   7%|▋         | 2/30 [00:16<03:13,  6.89s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8812, 'compress@10': 0.9076, 'time@10': 8.4108}:  10%|█         | 3/30 [00:16<02:22,  5.28s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8882, 'compress@10': 0.9066, 'time@10': 8.0655}:  10%|█         | 3/30 [00:23<02:22,  5.28s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8882, 'compress@10': 0.9066, 'time@10': 8.0655}:  13%|█▎        | 4/30 [00:23<02:35,  5.99s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0298, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8663, 'compress@10': 0.9057, 'time@10': 8.871}:  13%|█▎        | 4/30 [00:29<02:35,  5.99s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0298, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8663, 'compress@10': 0.9057, 'time@10': 8.871}:  17%|█▋        | 5/30 [00:29<02:30,  6.03s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0292, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8748, 'compress@10': 0.9051, 'time@10': 9.5072}:  17%|█▋        | 5/30 [00:42<02:30,  6.03s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0292, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8748, 'compress@10': 0.9051, 'time@10': 9.5072}:  20%|██        | 6/30 [00:42<03:19,  8.31s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.8749, 'compress@10': 0.9049, 'time@10': 9.7216}:  20%|██        | 6/30 [00:48<03:19,  8.31s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.8749, 'compress@10': 0.9049, 'time@10': 9.7216}:  23%|██▎       | 7/30 [00:48<02:50,  7.42s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0291, 'hit_ratio@10': 0.895, 'ndcg@10': 0.8847, 'compress@10': 0.9047, 'time@10': 9.6248}:  23%|██▎       | 7/30 [00:57<02:50,  7.42s/it]  {'epoch': 27, 'num_users': 6.125, 'loss': 0.0291, 'hit_ratio@10': 0.895, 'ndcg@10': 0.8847, 'compress@10': 0.9047, 'time@10': 9.6248}:  27%|██▋       | 8/30 [00:57<02:54,  7.92s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.8894, 'compress@10': 0.9045, 'time@10': 9.7241}:  27%|██▋       | 8/30 [01:02<02:54,  7.92s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.8894, 'compress@10': 0.9045, 'time@10': 9.7241}:  30%|███       | 9/30 [01:02<02:29,  7.10s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0272, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.8959, 'compress@10': 0.9042, 'time@10': 9.8142}:  30%|███       | 9/30 [01:13<02:29,  7.10s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0272, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.8959, 'compress@10': 0.9042, 'time@10': 9.8142}:  33%|███▎      | 10/30 [01:13<02:44,  8.20s/it]{'epoch': 27, 'num_users': 6.6364, 'loss': 0.0282, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8958, 'compress@10': 0.9042, 'time@10': 10.0867}:  33%|███▎      | 10/30 [01:19<02:44,  8.20s/it]{'epoch': 27, 'num_users': 6.6364, 'loss': 0.0282, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8958, 'compress@10': 0.9042, 'time@10': 10.0867}:  37%|███▋      | 11/30 [01:19<02:25,  7.66s/it]{'epoch': 27, 'num_users': 6.4167, 'loss': 0.0263, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8975, 'compress@10': 0.9045, 'time@10': 9.6819}:  37%|███▋      | 11/30 [01:24<02:25,  7.66s/it] {'epoch': 27, 'num_users': 6.4167, 'loss': 0.0263, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8975, 'compress@10': 0.9045, 'time@10': 9.6819}:  40%|████      | 12/30 [01:24<02:04,  6.93s/it]{'epoch': 27, 'num_users': 6.6154, 'loss': 0.0267, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8981, 'compress@10': 0.9045, 'time@10': 9.7517}:  40%|████      | 12/30 [01:30<02:04,  6.93s/it] {'epoch': 27, 'num_users': 6.6154, 'loss': 0.0267, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8981, 'compress@10': 0.9045, 'time@10': 9.7517}:  43%|████▎     | 13/30 [01:30<01:49,  6.45s/it]{'epoch': 27, 'num_users': 6.3571, 'loss': 0.0249, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8927, 'compress@10': 0.9054, 'time@10': 9.398}:  43%|████▎     | 13/30 [01:35<01:49,  6.45s/it]{'epoch': 27, 'num_users': 6.3571, 'loss': 0.0249, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8927, 'compress@10': 0.9054, 'time@10': 9.398}:  47%|████▋     | 14/30 [01:35<01:35,  5.96s/it]{'epoch': 27, 'num_users': 6.2667, 'loss': 0.0253, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.8933, 'compress@10': 0.9053, 'time@10': 9.626}:  47%|████▋     | 14/30 [01:41<01:35,  5.96s/it]{'epoch': 27, 'num_users': 6.2667, 'loss': 0.0253, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.8933, 'compress@10': 0.9053, 'time@10': 9.626}:  50%|█████     | 15/30 [01:41<01:31,  6.11s/it]{'epoch': 27, 'num_users': 6.0625, 'loss': 0.0241, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8942, 'compress@10': 0.9055, 'time@10': 9.3474}:  50%|█████     | 15/30 [01:46<01:31,  6.11s/it]{'epoch': 27, 'num_users': 6.0625, 'loss': 0.0241, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8942, 'compress@10': 0.9055, 'time@10': 9.3474}:  53%|█████▎    | 16/30 [01:46<01:21,  5.84s/it]{'epoch': 27, 'num_users': 5.8235, 'loss': 0.0228, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8869, 'compress@10': 0.9063, 'time@10': 9.0779}:  53%|█████▎    | 16/30 [01:49<01:21,  5.84s/it]{'epoch': 27, 'num_users': 5.8235, 'loss': 0.0228, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8869, 'compress@10': 0.9063, 'time@10': 9.0779}:  57%|█████▋    | 17/30 [01:49<01:02,  4.81s/it]{'epoch': 27, 'num_users': 6.0556, 'loss': 0.0228, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.888, 'compress@10': 0.9062, 'time@10': 8.9367}:  57%|█████▋    | 17/30 [01:55<01:02,  4.81s/it] {'epoch': 27, 'num_users': 6.0556, 'loss': 0.0228, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.888, 'compress@10': 0.9062, 'time@10': 8.9367}:  60%|██████    | 18/30 [01:55<01:04,  5.39s/it]{'epoch': 27, 'num_users': 6.0, 'loss': 0.0224, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8889, 'compress@10': 0.9062, 'time@10': 8.8164}:  60%|██████    | 18/30 [01:59<01:04,  5.39s/it]  {'epoch': 27, 'num_users': 6.0, 'loss': 0.0224, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8889, 'compress@10': 0.9062, 'time@10': 8.8164}:  63%|██████▎   | 19/30 [01:59<00:52,  4.78s/it]{'epoch': 27, 'num_users': 6.15, 'loss': 0.0226, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.89, 'compress@10': 0.906, 'time@10': 9.0083}:  63%|██████▎   | 19/30 [02:11<00:52,  4.78s/it]  {'epoch': 27, 'num_users': 6.15, 'loss': 0.0226, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.89, 'compress@10': 0.906, 'time@10': 9.0083}:  67%|██████▋   | 20/30 [02:11<01:11,  7.16s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8877, 'compress@10': 0.9058, 'time@10': 9.0786}:  67%|██████▋   | 20/30 [02:17<01:11,  7.16s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8877, 'compress@10': 0.9058, 'time@10': 9.0786}:  70%|███████   | 21/30 [02:17<00:59,  6.60s/it]{'epoch': 27, 'num_users': 6.1818, 'loss': 0.0242, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.889, 'compress@10': 0.9058, 'time@10': 8.959}:  70%|███████   | 21/30 [02:23<00:59,  6.60s/it]  {'epoch': 27, 'num_users': 6.1818, 'loss': 0.0242, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.889, 'compress@10': 0.9058, 'time@10': 8.959}:  73%|███████▎  | 22/30 [02:23<00:52,  6.57s/it]{'epoch': 27, 'num_users': 6.1304, 'loss': 0.0238, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8904, 'compress@10': 0.9057, 'time@10': 9.0083}:  73%|███████▎  | 22/30 [02:28<00:52,  6.57s/it]{'epoch': 27, 'num_users': 6.1304, 'loss': 0.0238, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8904, 'compress@10': 0.9057, 'time@10': 9.0083}:  77%|███████▋  | 23/30 [02:28<00:42,  6.12s/it]{'epoch': 27, 'num_users': 5.9583, 'loss': 0.023, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8866, 'compress@10': 0.9063, 'time@10': 8.8157}:  77%|███████▋  | 23/30 [02:33<00:42,  6.12s/it] {'epoch': 27, 'num_users': 5.9583, 'loss': 0.023, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8866, 'compress@10': 0.9063, 'time@10': 8.8157}:  80%|████████  | 24/30 [02:33<00:33,  5.61s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0222, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8771, 'compress@10': 0.9074, 'time@10': 8.6179}:  80%|████████  | 24/30 [02:35<00:33,  5.61s/it]  {'epoch': 27, 'num_users': 5.8, 'loss': 0.0222, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8771, 'compress@10': 0.9074, 'time@10': 8.6179}:  83%|████████▎ | 25/30 [02:35<00:22,  4.52s/it]{'epoch': 27, 'num_users': 5.8077, 'loss': 0.0223, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8791, 'compress@10': 0.9072, 'time@10': 8.8089}:  83%|████████▎ | 25/30 [02:48<00:22,  4.52s/it]{'epoch': 27, 'num_users': 5.8077, 'loss': 0.0223, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8791, 'compress@10': 0.9072, 'time@10': 8.8089}:  87%|████████▋ | 26/30 [02:48<00:29,  7.25s/it]{'epoch': 27, 'num_users': 5.8889, 'loss': 0.022, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8806, 'compress@10': 0.907, 'time@10': 8.9439}:  87%|████████▋ | 26/30 [02:55<00:29,  7.25s/it]  {'epoch': 27, 'num_users': 5.8889, 'loss': 0.022, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8806, 'compress@10': 0.907, 'time@10': 8.9439}:  90%|█████████ | 27/30 [02:55<00:20,  6.95s/it]{'epoch': 27, 'num_users': 6.0, 'loss': 0.0221, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8821, 'compress@10': 0.9068, 'time@10': 9.0787}:  90%|█████████ | 27/30 [03:07<00:20,  6.95s/it] {'epoch': 27, 'num_users': 6.0, 'loss': 0.0221, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8821, 'compress@10': 0.9068, 'time@10': 9.0787}:  93%|█████████▎| 28/30 [03:07<00:17,  8.69s/it]{'epoch': 27, 'num_users': 5.8621, 'loss': 0.0218, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8839, 'compress@10': 0.9068, 'time@10': 9.1262}:  93%|█████████▎| 28/30 [03:13<00:17,  8.69s/it]{'epoch': 27, 'num_users': 5.8621, 'loss': 0.0218, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8839, 'compress@10': 0.9068, 'time@10': 9.1262}:  97%|█████████▋| 29/30 [03:13<00:07,  7.67s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.0221, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8849, 'compress@10': 0.9066, 'time@10': 9.1216}:  97%|█████████▋| 29/30 [03:22<00:07,  7.67s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.0221, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8849, 'compress@10': 0.9066, 'time@10': 9.1216}: 100%|██████████| 30/30 [03:22<00:00,  8.07s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.0221, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8849, 'compress@10': 0.9066, 'time@10': 9.1216}: 100%|██████████| 30/30 [03:22<00:00,  6.74s/it]
Epoch: 27
Avg # of users: 5.866666666666666
Avg Loss: 0.022091047801929997
Avg hit ratio: 0.8550639655168986
Avg ndcg: 0.884901955759362
Avg compression ratio: 0.9066299272056592
Avg train time: 9.121629762649537
Std train time: 3.013306490534368
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 37, 8, 19, 26, 10, 10, 9, 5, 11, 10, 38, 38, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0353, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8736, 'compress@10': 0.9052, 'time@10': 9.1458}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0353, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8736, 'compress@10': 0.9052, 'time@10': 9.1458}:   3%|▎         | 1/30 [00:04<02:13,  4.61s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.899, 'ndcg@10': 0.8957, 'compress@10': 0.9042, 'time@10': 8.4035}:   3%|▎         | 1/30 [00:12<02:13,  4.61s/it] {'epoch': 28, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.899, 'ndcg@10': 0.8957, 'compress@10': 0.9042, 'time@10': 8.4035}:   7%|▋         | 2/30 [00:12<02:59,  6.43s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.8829, 'compress@10': 0.9076, 'time@10': 7.2869}:   7%|▋         | 2/30 [00:14<02:59,  6.43s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.8829, 'compress@10': 0.9076, 'time@10': 7.2869}:  10%|█         | 3/30 [00:14<02:05,  4.66s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8903, 'compress@10': 0.9066, 'time@10': 7.1182}:  10%|█         | 3/30 [00:21<02:05,  4.66s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8903, 'compress@10': 0.9066, 'time@10': 7.1182}:  13%|█▎        | 4/30 [00:21<02:21,  5.45s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0296, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.868, 'compress@10': 0.9057, 'time@10': 7.6762}:  13%|█▎        | 4/30 [00:26<02:21,  5.45s/it] {'epoch': 28, 'num_users': 5.8, 'loss': 0.0296, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.868, 'compress@10': 0.9057, 'time@10': 7.6762}:  17%|█▋        | 5/30 [00:26<02:12,  5.28s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0285, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8764, 'compress@10': 0.9051, 'time@10': 8.3792}:  17%|█▋        | 5/30 [00:38<02:12,  5.28s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0285, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8764, 'compress@10': 0.9051, 'time@10': 8.3792}:  20%|██        | 6/30 [00:38<03:01,  7.54s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8763, 'compress@10': 0.9049, 'time@10': 8.5639}:  20%|██        | 6/30 [00:43<03:01,  7.54s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8763, 'compress@10': 0.9049, 'time@10': 8.5639}:  23%|██▎       | 7/30 [00:43<02:33,  6.67s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0286, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8882, 'compress@10': 0.9047, 'time@10': 8.5991}:  23%|██▎       | 7/30 [00:52<02:33,  6.67s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0286, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8882, 'compress@10': 0.9047, 'time@10': 8.5991}:  27%|██▋       | 8/30 [00:52<02:42,  7.38s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8927, 'compress@10': 0.9045, 'time@10': 8.8057}:  27%|██▋       | 8/30 [00:57<02:42,  7.38s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8927, 'compress@10': 0.9045, 'time@10': 8.8057}:  30%|███       | 9/30 [00:57<02:21,  6.72s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.8968, 'compress@10': 0.9042, 'time@10': 9.0407}:  30%|███       | 9/30 [01:08<02:21,  6.72s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.8968, 'compress@10': 0.9042, 'time@10': 9.0407}:  33%|███▎      | 10/30 [01:08<02:41,  8.10s/it]{'epoch': 28, 'num_users': 6.6364, 'loss': 0.0293, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8965, 'compress@10': 0.9042, 'time@10': 9.3232}:  33%|███▎      | 10/30 [01:14<02:41,  8.10s/it]{'epoch': 28, 'num_users': 6.6364, 'loss': 0.0293, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8965, 'compress@10': 0.9042, 'time@10': 9.3232}:  37%|███▋      | 11/30 [01:14<02:22,  7.49s/it]{'epoch': 28, 'num_users': 6.4167, 'loss': 0.0273, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8981, 'compress@10': 0.9045, 'time@10': 8.9833}:  37%|███▋      | 11/30 [01:20<02:22,  7.49s/it]{'epoch': 28, 'num_users': 6.4167, 'loss': 0.0273, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8981, 'compress@10': 0.9045, 'time@10': 8.9833}:  40%|████      | 12/30 [01:20<02:02,  6.82s/it]{'epoch': 28, 'num_users': 6.6154, 'loss': 0.0276, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8987, 'compress@10': 0.9045, 'time@10': 9.1223}:  40%|████      | 12/30 [01:25<02:02,  6.82s/it]{'epoch': 28, 'num_users': 6.6154, 'loss': 0.0276, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8987, 'compress@10': 0.9045, 'time@10': 9.1223}:  43%|████▎     | 13/30 [01:25<01:48,  6.40s/it]{'epoch': 28, 'num_users': 6.3571, 'loss': 0.0257, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8932, 'compress@10': 0.9054, 'time@10': 8.8532}:  43%|████▎     | 13/30 [01:30<01:48,  6.40s/it]{'epoch': 28, 'num_users': 6.3571, 'loss': 0.0257, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8932, 'compress@10': 0.9054, 'time@10': 8.8532}:  47%|████▋     | 14/30 [01:30<01:37,  6.09s/it]{'epoch': 28, 'num_users': 6.2667, 'loss': 0.0257, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8947, 'compress@10': 0.9053, 'time@10': 9.1079}:  47%|████▋     | 14/30 [01:37<01:37,  6.09s/it] {'epoch': 28, 'num_users': 6.2667, 'loss': 0.0257, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8947, 'compress@10': 0.9053, 'time@10': 9.1079}:  50%|█████     | 15/30 [01:37<01:32,  6.18s/it]{'epoch': 28, 'num_users': 6.0625, 'loss': 0.0244, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8955, 'compress@10': 0.9055, 'time@10': 8.8521}:  50%|█████     | 15/30 [01:42<01:32,  6.18s/it]{'epoch': 28, 'num_users': 6.0625, 'loss': 0.0244, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8955, 'compress@10': 0.9055, 'time@10': 8.8521}:  53%|█████▎    | 16/30 [01:42<01:21,  5.84s/it]{'epoch': 28, 'num_users': 5.8235, 'loss': 0.0231, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8882, 'compress@10': 0.9063, 'time@10': 8.6664}:  53%|█████▎    | 16/30 [01:45<01:21,  5.84s/it]{'epoch': 28, 'num_users': 5.8235, 'loss': 0.0231, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8882, 'compress@10': 0.9063, 'time@10': 8.6664}:  57%|█████▋    | 17/30 [01:45<01:04,  4.95s/it]{'epoch': 28, 'num_users': 6.0556, 'loss': 0.023, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8892, 'compress@10': 0.9062, 'time@10': 8.553}:  57%|█████▋    | 17/30 [01:51<01:04,  4.95s/it]  {'epoch': 28, 'num_users': 6.0556, 'loss': 0.023, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8892, 'compress@10': 0.9062, 'time@10': 8.553}:  60%|██████    | 18/30 [01:51<01:05,  5.46s/it]{'epoch': 28, 'num_users': 6.0, 'loss': 0.0223, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8901, 'compress@10': 0.9062, 'time@10': 8.4511}:  60%|██████    | 18/30 [01:55<01:05,  5.46s/it] {'epoch': 28, 'num_users': 6.0, 'loss': 0.0223, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8901, 'compress@10': 0.9062, 'time@10': 8.4511}:  63%|██████▎   | 19/30 [01:55<00:53,  4.83s/it]{'epoch': 28, 'num_users': 6.15, 'loss': 0.0224, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.8913, 'compress@10': 0.906, 'time@10': 8.673}:  63%|██████▎   | 19/30 [02:08<00:53,  4.83s/it] {'epoch': 28, 'num_users': 6.15, 'loss': 0.0224, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.8913, 'compress@10': 0.906, 'time@10': 8.673}:  67%|██████▋   | 20/30 [02:08<01:12,  7.26s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0239, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8889, 'compress@10': 0.9058, 'time@10': 8.7059}:  67%|██████▋   | 20/30 [02:12<01:12,  7.26s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0239, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8889, 'compress@10': 0.9058, 'time@10': 8.7059}:  70%|███████   | 21/30 [02:12<00:58,  6.50s/it]{'epoch': 28, 'num_users': 6.1818, 'loss': 0.025, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8877, 'compress@10': 0.9058, 'time@10': 8.5721}:  70%|███████   | 21/30 [02:18<00:58,  6.50s/it]  {'epoch': 28, 'num_users': 6.1818, 'loss': 0.025, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8877, 'compress@10': 0.9058, 'time@10': 8.5721}:  73%|███████▎  | 22/30 [02:18<00:50,  6.29s/it]{'epoch': 28, 'num_users': 6.1304, 'loss': 0.0245, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8891, 'compress@10': 0.9057, 'time@10': 8.6135}:  73%|███████▎  | 22/30 [02:23<00:50,  6.29s/it]{'epoch': 28, 'num_users': 6.1304, 'loss': 0.0245, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8891, 'compress@10': 0.9057, 'time@10': 8.6135}:  77%|███████▋  | 23/30 [02:23<00:40,  5.84s/it]{'epoch': 28, 'num_users': 5.9583, 'loss': 0.0237, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8854, 'compress@10': 0.9063, 'time@10': 8.415}:  77%|███████▋  | 23/30 [02:27<00:40,  5.84s/it] {'epoch': 28, 'num_users': 5.9583, 'loss': 0.0237, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8854, 'compress@10': 0.9063, 'time@10': 8.415}:  80%|████████  | 24/30 [02:27<00:31,  5.25s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.876, 'compress@10': 0.9074, 'time@10': 8.2319}:  80%|████████  | 24/30 [02:29<00:31,  5.25s/it]   {'epoch': 28, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.876, 'compress@10': 0.9074, 'time@10': 8.2319}:  83%|████████▎ | 25/30 [02:29<00:21,  4.26s/it]{'epoch': 28, 'num_users': 5.8077, 'loss': 0.0228, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8782, 'compress@10': 0.9072, 'time@10': 8.3773}:  83%|████████▎ | 25/30 [02:41<00:21,  4.26s/it]{'epoch': 28, 'num_users': 5.8077, 'loss': 0.0228, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8782, 'compress@10': 0.9072, 'time@10': 8.3773}:  87%|████████▋ | 26/30 [02:41<00:26,  6.60s/it]{'epoch': 28, 'num_users': 5.8889, 'loss': 0.0225, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8798, 'compress@10': 0.907, 'time@10': 8.4733}:  87%|████████▋ | 26/30 [02:46<00:26,  6.60s/it] {'epoch': 28, 'num_users': 5.8889, 'loss': 0.0225, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8798, 'compress@10': 0.907, 'time@10': 8.4733}:  90%|█████████ | 27/30 [02:46<00:18,  6.28s/it]{'epoch': 28, 'num_users': 6.0, 'loss': 0.0226, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8818, 'compress@10': 0.9068, 'time@10': 8.6195}:  90%|█████████ | 27/30 [02:59<00:18,  6.28s/it]   {'epoch': 28, 'num_users': 6.0, 'loss': 0.0226, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8818, 'compress@10': 0.9068, 'time@10': 8.6195}:  93%|█████████▎| 28/30 [02:59<00:16,  8.17s/it]{'epoch': 28, 'num_users': 5.8621, 'loss': 0.0223, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8837, 'compress@10': 0.9068, 'time@10': 8.6836}:  93%|█████████▎| 28/30 [03:04<00:16,  8.17s/it]{'epoch': 28, 'num_users': 5.8621, 'loss': 0.0223, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8837, 'compress@10': 0.9068, 'time@10': 8.6836}:  97%|█████████▋| 29/30 [03:04<00:07,  7.30s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.0225, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8846, 'compress@10': 0.9066, 'time@10': 8.6964}:  97%|█████████▋| 29/30 [03:13<00:07,  7.30s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.0225, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8846, 'compress@10': 0.9066, 'time@10': 8.6964}: 100%|██████████| 30/30 [03:13<00:00,  7.84s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.0225, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8846, 'compress@10': 0.9066, 'time@10': 8.6964}: 100%|██████████| 30/30 [03:13<00:00,  6.46s/it]
Epoch: 28
Avg # of users: 5.866666666666666
Avg Loss: 0.022532116936603747
Avg hit ratio: 0.852118918123841
Avg ndcg: 0.884647360518839
Avg compression ratio: 0.9066299313835192
Avg train time: 8.696376132965089
Std train time: 2.8045272234665766
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 37, 8, 19, 26, 10, 10, 9, 5, 11, 10, 39, 39, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.881, 'compress@10': 0.9052, 'time@10': 8.7863}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.881, 'compress@10': 0.9052, 'time@10': 8.7863}:   3%|▎         | 1/30 [00:04<02:08,  4.43s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0253, 'hit_ratio@10': 0.899, 'ndcg@10': 0.8987, 'compress@10': 0.9042, 'time@10': 7.998}:   3%|▎         | 1/30 [00:11<02:08,  4.43s/it] {'epoch': 29, 'num_users': 7.0, 'loss': 0.0253, 'hit_ratio@10': 0.899, 'ndcg@10': 0.8987, 'compress@10': 0.9042, 'time@10': 7.998}:   7%|▋         | 2/30 [00:11<02:50,  6.09s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.8849, 'compress@10': 0.9076, 'time@10': 7.0089}:   7%|▋         | 2/30 [00:14<02:50,  6.09s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.7898, 'ndcg@10': 0.8849, 'compress@10': 0.9076, 'time@10': 7.0089}:  10%|█         | 3/30 [00:14<02:00,  4.47s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8935, 'compress@10': 0.9066, 'time@10': 7.1356}:  10%|█         | 3/30 [00:21<02:00,  4.47s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.8935, 'compress@10': 0.9066, 'time@10': 7.1356}:  13%|█▎        | 4/30 [00:21<02:27,  5.69s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0285, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8709, 'compress@10': 0.9057, 'time@10': 7.9971}:  13%|█▎        | 4/30 [00:27<02:27,  5.69s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0285, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8709, 'compress@10': 0.9057, 'time@10': 7.9971}:  17%|█▋        | 5/30 [00:27<02:23,  5.74s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0291, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8784, 'compress@10': 0.9051, 'time@10': 8.6972}:  17%|█▋        | 5/30 [00:39<02:23,  5.74s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0291, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8784, 'compress@10': 0.9051, 'time@10': 8.6972}:  20%|██        | 6/30 [00:39<03:10,  7.95s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.029, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8781, 'compress@10': 0.9049, 'time@10': 8.8508}:  20%|██        | 6/30 [00:44<03:10,  7.95s/it] {'epoch': 29, 'num_users': 6.2857, 'loss': 0.029, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8781, 'compress@10': 0.9049, 'time@10': 8.8508}:  23%|██▎       | 7/30 [00:44<02:40,  6.96s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8908, 'compress@10': 0.9047, 'time@10': 8.9239}:  23%|██▎       | 7/30 [00:54<02:40,  6.96s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8908, 'compress@10': 0.9047, 'time@10': 8.9239}:  27%|██▋       | 8/30 [00:54<02:50,  7.76s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8947, 'compress@10': 0.9045, 'time@10': 9.1127}:  27%|██▋       | 8/30 [00:59<02:50,  7.76s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8947, 'compress@10': 0.9045, 'time@10': 9.1127}:  30%|███       | 9/30 [00:59<02:27,  7.01s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9007, 'compress@10': 0.9042, 'time@10': 9.2824}:  30%|███       | 9/30 [01:10<02:27,  7.01s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9007, 'compress@10': 0.9042, 'time@10': 9.2824}:  33%|███▎      | 10/30 [01:10<02:43,  8.19s/it]{'epoch': 29, 'num_users': 6.6364, 'loss': 0.0278, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9, 'compress@10': 0.9042, 'time@10': 9.5834}:  33%|███▎      | 10/30 [01:16<02:43,  8.19s/it]{'epoch': 29, 'num_users': 6.6364, 'loss': 0.0278, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9, 'compress@10': 0.9042, 'time@10': 9.5834}:  37%|███▋      | 11/30 [01:16<02:24,  7.62s/it]{'epoch': 29, 'num_users': 6.4167, 'loss': 0.0259, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.9014, 'compress@10': 0.9045, 'time@10': 9.2209}:  37%|███▋      | 11/30 [01:22<02:24,  7.62s/it]{'epoch': 29, 'num_users': 6.4167, 'loss': 0.0259, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.9014, 'compress@10': 0.9045, 'time@10': 9.2209}:  40%|████      | 12/30 [01:22<02:04,  6.91s/it]{'epoch': 29, 'num_users': 6.6154, 'loss': 0.0263, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.9017, 'compress@10': 0.9045, 'time@10': 9.317}:  40%|████      | 12/30 [01:27<02:04,  6.91s/it] {'epoch': 29, 'num_users': 6.6154, 'loss': 0.0263, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.9017, 'compress@10': 0.9045, 'time@10': 9.317}:  43%|████▎     | 13/30 [01:27<01:48,  6.41s/it]{'epoch': 29, 'num_users': 6.3571, 'loss': 0.0245, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8968, 'compress@10': 0.9054, 'time@10': 8.9868}:  43%|████▎     | 13/30 [01:32<01:48,  6.41s/it]{'epoch': 29, 'num_users': 6.3571, 'loss': 0.0245, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8968, 'compress@10': 0.9054, 'time@10': 8.9868}:  47%|████▋     | 14/30 [01:32<01:34,  5.90s/it]{'epoch': 29, 'num_users': 6.2667, 'loss': 0.0246, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.8976, 'compress@10': 0.9053, 'time@10': 9.1672}:  47%|████▋     | 14/30 [01:37<01:34,  5.90s/it]{'epoch': 29, 'num_users': 6.2667, 'loss': 0.0246, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.8976, 'compress@10': 0.9053, 'time@10': 9.1672}:  50%|█████     | 15/30 [01:37<01:28,  5.90s/it]{'epoch': 29, 'num_users': 6.0625, 'loss': 0.0234, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.8982, 'compress@10': 0.9055, 'time@10': 8.93}:  50%|█████     | 15/30 [01:43<01:28,  5.90s/it]  {'epoch': 29, 'num_users': 6.0625, 'loss': 0.0234, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.8982, 'compress@10': 0.9055, 'time@10': 8.93}:  53%|█████▎    | 16/30 [01:43<01:20,  5.75s/it]{'epoch': 29, 'num_users': 5.8235, 'loss': 0.0222, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8907, 'compress@10': 0.9063, 'time@10': 8.7001}:  53%|█████▎    | 16/30 [01:45<01:20,  5.75s/it]{'epoch': 29, 'num_users': 5.8235, 'loss': 0.0222, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8907, 'compress@10': 0.9063, 'time@10': 8.7001}:  57%|█████▋    | 17/30 [01:45<01:02,  4.79s/it]{'epoch': 29, 'num_users': 6.0556, 'loss': 0.0221, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8921, 'compress@10': 0.9062, 'time@10': 8.61}:  57%|█████▋    | 17/30 [01:52<01:02,  4.79s/it]  {'epoch': 29, 'num_users': 6.0556, 'loss': 0.0221, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8921, 'compress@10': 0.9062, 'time@10': 8.61}:  60%|██████    | 18/30 [01:52<01:05,  5.49s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 0.0218, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8931, 'compress@10': 0.9062, 'time@10': 8.523}:  60%|██████    | 18/30 [01:56<01:05,  5.49s/it]  {'epoch': 29, 'num_users': 6.0, 'loss': 0.0218, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8931, 'compress@10': 0.9062, 'time@10': 8.523}:  63%|██████▎   | 19/30 [01:56<00:53,  4.90s/it]{'epoch': 29, 'num_users': 6.15, 'loss': 0.0219, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8945, 'compress@10': 0.906, 'time@10': 8.7826}:  63%|██████▎   | 19/30 [02:10<00:53,  4.90s/it]{'epoch': 29, 'num_users': 6.15, 'loss': 0.0219, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8945, 'compress@10': 0.906, 'time@10': 8.7826}:  67%|██████▋   | 20/30 [02:10<01:15,  7.55s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8922, 'compress@10': 0.9058, 'time@10': 8.861}:  67%|██████▋   | 20/30 [02:15<01:15,  7.55s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8922, 'compress@10': 0.9058, 'time@10': 8.861}:  70%|███████   | 21/30 [02:15<01:01,  6.87s/it]{'epoch': 29, 'num_users': 6.1818, 'loss': 0.0237, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.893, 'compress@10': 0.9058, 'time@10': 8.729}:  70%|███████   | 21/30 [02:21<01:01,  6.87s/it]{'epoch': 29, 'num_users': 6.1818, 'loss': 0.0237, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.893, 'compress@10': 0.9058, 'time@10': 8.729}:  73%|███████▎  | 22/30 [02:21<00:52,  6.61s/it]{'epoch': 29, 'num_users': 6.1304, 'loss': 0.0233, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8942, 'compress@10': 0.9057, 'time@10': 8.7404}:  73%|███████▎  | 22/30 [02:26<00:52,  6.61s/it]{'epoch': 29, 'num_users': 6.1304, 'loss': 0.0233, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8942, 'compress@10': 0.9057, 'time@10': 8.7404}:  77%|███████▋  | 23/30 [02:26<00:41,  5.99s/it]{'epoch': 29, 'num_users': 5.9583, 'loss': 0.0224, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8903, 'compress@10': 0.9063, 'time@10': 8.55}:  77%|███████▋  | 23/30 [02:30<00:41,  5.99s/it]  {'epoch': 29, 'num_users': 5.9583, 'loss': 0.0224, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8903, 'compress@10': 0.9063, 'time@10': 8.55}:  80%|████████  | 24/30 [02:30<00:32,  5.46s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0216, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8806, 'compress@10': 0.9074, 'time@10': 8.4007}:  80%|████████  | 24/30 [02:32<00:32,  5.46s/it] {'epoch': 29, 'num_users': 5.8, 'loss': 0.0216, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8806, 'compress@10': 0.9074, 'time@10': 8.4007}:  83%|████████▎ | 25/30 [02:32<00:22,  4.56s/it]{'epoch': 29, 'num_users': 5.8077, 'loss': 0.0216, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8829, 'compress@10': 0.9072, 'time@10': 8.5842}:  83%|████████▎ | 25/30 [02:45<00:22,  4.56s/it]{'epoch': 29, 'num_users': 5.8077, 'loss': 0.0216, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8829, 'compress@10': 0.9072, 'time@10': 8.5842}:  87%|████████▋ | 26/30 [02:45<00:28,  7.16s/it]{'epoch': 29, 'num_users': 5.8889, 'loss': 0.0213, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8847, 'compress@10': 0.907, 'time@10': 8.683}:  87%|████████▋ | 26/30 [02:51<00:28,  7.16s/it]  {'epoch': 29, 'num_users': 5.8889, 'loss': 0.0213, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8847, 'compress@10': 0.907, 'time@10': 8.683}:  90%|█████████ | 27/30 [02:51<00:20,  6.71s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 0.0212, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.887, 'compress@10': 0.9068, 'time@10': 8.8402}:  90%|█████████ | 27/30 [03:04<00:20,  6.71s/it]  {'epoch': 29, 'num_users': 6.0, 'loss': 0.0212, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.887, 'compress@10': 0.9068, 'time@10': 8.8402}:  93%|█████████▎| 28/30 [03:04<00:17,  8.63s/it]{'epoch': 29, 'num_users': 5.8621, 'loss': 0.0209, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8889, 'compress@10': 0.9068, 'time@10': 8.8959}:  93%|█████████▎| 28/30 [03:10<00:17,  8.63s/it]{'epoch': 29, 'num_users': 5.8621, 'loss': 0.0209, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8889, 'compress@10': 0.9068, 'time@10': 8.8959}:  97%|█████████▋| 29/30 [03:10<00:07,  7.62s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.0212, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8896, 'compress@10': 0.9066, 'time@10': 8.899}:  97%|█████████▋| 29/30 [03:19<00:07,  7.62s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.0212, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8896, 'compress@10': 0.9066, 'time@10': 8.899}: 100%|██████████| 30/30 [03:19<00:00,  8.04s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.0212, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8896, 'compress@10': 0.9066, 'time@10': 8.899}: 100%|██████████| 30/30 [03:19<00:00,  6.64s/it]
Epoch: 29
Avg # of users: 5.866666666666666
Avg Loss: 0.021160716433096485
Avg hit ratio: 0.8533048118097347
Avg ndcg: 0.8896410954675982
Avg compression ratio: 0.906629932872802
Avg train time: 8.899029382069905
Std train time: 2.894571719032209
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 38, 8, 19, 26, 10, 10, 9, 5, 11, 10, 40, 39, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0326, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8832, 'compress@10': 0.9052, 'time@10': 9.2977}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0326, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8832, 'compress@10': 0.9052, 'time@10': 9.2977}:   3%|▎         | 1/30 [00:04<02:15,  4.69s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0249, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9015, 'compress@10': 0.9042, 'time@10': 8.5048}:   3%|▎         | 1/30 [00:12<02:15,  4.69s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0249, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9015, 'compress@10': 0.9042, 'time@10': 8.5048}:   7%|▋         | 2/30 [00:12<03:01,  6.49s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8867, 'compress@10': 0.9076, 'time@10': 7.3412}:   7%|▋         | 2/30 [00:14<03:01,  6.49s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8867, 'compress@10': 0.9076, 'time@10': 7.3412}:  10%|█         | 3/30 [00:14<02:06,  4.69s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.8896, 'compress@10': 0.9066, 'time@10': 7.1592}:  10%|█         | 3/30 [00:21<02:06,  4.69s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.8896, 'compress@10': 0.9066, 'time@10': 7.1592}:  13%|█▎        | 4/30 [00:21<02:21,  5.46s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8678, 'compress@10': 0.9057, 'time@10': 7.6769}:  13%|█▎        | 4/30 [00:26<02:21,  5.46s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8678, 'compress@10': 0.9057, 'time@10': 7.6769}:  17%|█▋        | 5/30 [00:26<02:11,  5.26s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8781, 'compress@10': 0.9051, 'time@10': 8.3782}:  17%|█▋        | 5/30 [00:38<02:11,  5.26s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8781, 'compress@10': 0.9051, 'time@10': 8.3782}:  20%|██        | 6/30 [00:38<03:00,  7.53s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.028, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.878, 'compress@10': 0.9049, 'time@10': 8.5472}:  20%|██        | 6/30 [00:43<03:00,  7.53s/it] {'epoch': 30, 'num_users': 6.2857, 'loss': 0.028, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.878, 'compress@10': 0.9049, 'time@10': 8.5472}:  23%|██▎       | 7/30 [00:43<02:32,  6.64s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.028, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8924, 'compress@10': 0.9047, 'time@10': 8.5834}:  23%|██▎       | 7/30 [00:52<02:32,  6.64s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.028, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8924, 'compress@10': 0.9047, 'time@10': 8.5834}:  27%|██▋       | 8/30 [00:52<02:41,  7.35s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0275, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8962, 'compress@10': 0.9045, 'time@10': 8.8239}:  27%|██▋       | 8/30 [00:57<02:41,  7.35s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0275, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8962, 'compress@10': 0.9045, 'time@10': 8.8239}:  30%|███       | 9/30 [00:57<02:21,  6.74s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9014, 'compress@10': 0.9042, 'time@10': 9.0556}:  30%|███       | 9/30 [01:08<02:21,  6.74s/it]  {'epoch': 30, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9014, 'compress@10': 0.9042, 'time@10': 9.0556}:  33%|███▎      | 10/30 [01:08<02:42,  8.11s/it]{'epoch': 30, 'num_users': 6.6364, 'loss': 0.0291, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.9007, 'compress@10': 0.9042, 'time@10': 9.3339}:  33%|███▎      | 10/30 [01:14<02:42,  8.11s/it]{'epoch': 30, 'num_users': 6.6364, 'loss': 0.0291, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.9007, 'compress@10': 0.9042, 'time@10': 9.3339}:  37%|███▋      | 11/30 [01:14<02:22,  7.49s/it]{'epoch': 30, 'num_users': 6.4167, 'loss': 0.0271, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.9021, 'compress@10': 0.9045, 'time@10': 9.002}:  37%|███▋      | 11/30 [01:20<02:22,  7.49s/it] {'epoch': 30, 'num_users': 6.4167, 'loss': 0.0271, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.9021, 'compress@10': 0.9045, 'time@10': 9.002}:  40%|████      | 12/30 [01:20<02:03,  6.85s/it]{'epoch': 30, 'num_users': 6.6154, 'loss': 0.0272, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.9023, 'compress@10': 0.9045, 'time@10': 9.1954}:  40%|████      | 12/30 [01:26<02:03,  6.85s/it]{'epoch': 30, 'num_users': 6.6154, 'loss': 0.0272, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.9023, 'compress@10': 0.9045, 'time@10': 9.1954}:  43%|████▎     | 13/30 [01:26<01:51,  6.53s/it]{'epoch': 30, 'num_users': 6.3571, 'loss': 0.0254, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.8974, 'compress@10': 0.9054, 'time@10': 8.8889}:  43%|████▎     | 13/30 [01:30<01:51,  6.53s/it]{'epoch': 30, 'num_users': 6.3571, 'loss': 0.0254, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.8974, 'compress@10': 0.9054, 'time@10': 8.8889}:  47%|████▋     | 14/30 [01:30<01:36,  6.05s/it]{'epoch': 30, 'num_users': 6.2667, 'loss': 0.0257, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8979, 'compress@10': 0.9053, 'time@10': 9.2203}:  47%|████▋     | 14/30 [01:37<01:36,  6.05s/it]{'epoch': 30, 'num_users': 6.2667, 'loss': 0.0257, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8979, 'compress@10': 0.9053, 'time@10': 9.2203}:  50%|█████     | 15/30 [01:37<01:34,  6.33s/it]{'epoch': 30, 'num_users': 6.0625, 'loss': 0.0243, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8985, 'compress@10': 0.9055, 'time@10': 8.9788}:  50%|█████     | 15/30 [01:43<01:34,  6.33s/it]{'epoch': 30, 'num_users': 6.0625, 'loss': 0.0243, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8985, 'compress@10': 0.9055, 'time@10': 8.9788}:  53%|█████▎    | 16/30 [01:43<01:24,  6.05s/it]{'epoch': 30, 'num_users': 5.8235, 'loss': 0.023, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.891, 'compress@10': 0.9063, 'time@10': 8.8253}:  53%|█████▎    | 16/30 [01:46<01:24,  6.05s/it]  {'epoch': 30, 'num_users': 5.8235, 'loss': 0.023, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.891, 'compress@10': 0.9063, 'time@10': 8.8253}:  57%|█████▋    | 17/30 [01:46<01:07,  5.21s/it]{'epoch': 30, 'num_users': 6.0556, 'loss': 0.0229, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8927, 'compress@10': 0.9062, 'time@10': 8.7227}:  57%|█████▋    | 17/30 [01:53<01:07,  5.21s/it]{'epoch': 30, 'num_users': 6.0556, 'loss': 0.0229, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8927, 'compress@10': 0.9062, 'time@10': 8.7227}:  60%|██████    | 18/30 [01:53<01:09,  5.75s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 0.0221, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8936, 'compress@10': 0.9062, 'time@10': 8.5986}:  60%|██████    | 18/30 [01:56<01:09,  5.75s/it]   {'epoch': 30, 'num_users': 6.0, 'loss': 0.0221, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8936, 'compress@10': 0.9062, 'time@10': 8.5986}:  63%|██████▎   | 19/30 [01:56<00:54,  4.99s/it]{'epoch': 30, 'num_users': 6.15, 'loss': 0.0223, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8953, 'compress@10': 0.906, 'time@10': 8.8157}:  63%|██████▎   | 19/30 [02:09<00:54,  4.99s/it]{'epoch': 30, 'num_users': 6.15, 'loss': 0.0223, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8953, 'compress@10': 0.906, 'time@10': 8.8157}:  67%|██████▋   | 20/30 [02:09<01:13,  7.39s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8926, 'compress@10': 0.9058, 'time@10': 8.8657}:  67%|██████▋   | 20/30 [02:14<01:13,  7.39s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8926, 'compress@10': 0.9058, 'time@10': 8.8657}:  70%|███████   | 21/30 [02:14<00:59,  6.66s/it]{'epoch': 30, 'num_users': 6.1818, 'loss': 0.024, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8937, 'compress@10': 0.9058, 'time@10': 8.7266}:  70%|███████   | 21/30 [02:20<00:59,  6.66s/it] {'epoch': 30, 'num_users': 6.1818, 'loss': 0.024, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8937, 'compress@10': 0.9058, 'time@10': 8.7266}:  73%|███████▎  | 22/30 [02:20<00:51,  6.42s/it]{'epoch': 30, 'num_users': 6.1304, 'loss': 0.0236, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.8949, 'compress@10': 0.9057, 'time@10': 8.7596}:  73%|███████▎  | 22/30 [02:25<00:51,  6.42s/it]{'epoch': 30, 'num_users': 6.1304, 'loss': 0.0236, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.8949, 'compress@10': 0.9057, 'time@10': 8.7596}:  77%|███████▋  | 23/30 [02:25<00:41,  5.92s/it]{'epoch': 30, 'num_users': 5.9583, 'loss': 0.0227, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.891, 'compress@10': 0.9063, 'time@10': 8.5529}:  77%|███████▋  | 23/30 [02:29<00:41,  5.92s/it] {'epoch': 30, 'num_users': 5.9583, 'loss': 0.0227, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.891, 'compress@10': 0.9063, 'time@10': 8.5529}:  80%|████████  | 24/30 [02:29<00:31,  5.30s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0219, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8813, 'compress@10': 0.9074, 'time@10': 8.3676}:  80%|████████  | 24/30 [02:31<00:31,  5.30s/it]  {'epoch': 30, 'num_users': 5.8, 'loss': 0.0219, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8813, 'compress@10': 0.9074, 'time@10': 8.3676}:  83%|████████▎ | 25/30 [02:31<00:21,  4.31s/it]{'epoch': 30, 'num_users': 5.8077, 'loss': 0.0218, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8837, 'compress@10': 0.9072, 'time@10': 8.5062}:  83%|████████▎ | 25/30 [02:43<00:21,  4.31s/it]{'epoch': 30, 'num_users': 5.8077, 'loss': 0.0218, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8837, 'compress@10': 0.9072, 'time@10': 8.5062}:  87%|████████▋ | 26/30 [02:43<00:26,  6.62s/it]{'epoch': 30, 'num_users': 5.8889, 'loss': 0.0215, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.885, 'compress@10': 0.907, 'time@10': 8.601}:  87%|████████▋ | 26/30 [02:48<00:26,  6.62s/it]   {'epoch': 30, 'num_users': 5.8889, 'loss': 0.0215, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.885, 'compress@10': 0.907, 'time@10': 8.601}:  90%|█████████ | 27/30 [02:48<00:18,  6.30s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 0.0214, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.8877, 'compress@10': 0.9068, 'time@10': 8.7466}:  90%|█████████ | 27/30 [03:01<00:18,  6.30s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 0.0214, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.8877, 'compress@10': 0.9068, 'time@10': 8.7466}:  93%|█████████▎| 28/30 [03:01<00:16,  8.23s/it]{'epoch': 30, 'num_users': 5.8621, 'loss': 0.0211, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8895, 'compress@10': 0.9068, 'time@10': 8.8107}:  93%|█████████▎| 28/30 [03:06<00:16,  8.23s/it]{'epoch': 30, 'num_users': 5.8621, 'loss': 0.0211, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8895, 'compress@10': 0.9068, 'time@10': 8.8107}:  97%|█████████▋| 29/30 [03:06<00:07,  7.36s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.0213, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8902, 'compress@10': 0.9066, 'time@10': 8.829}:  97%|█████████▋| 29/30 [03:16<00:07,  7.36s/it] {'epoch': 30, 'num_users': 5.8667, 'loss': 0.0213, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8902, 'compress@10': 0.9066, 'time@10': 8.829}: 100%|██████████| 30/30 [03:16<00:00,  7.97s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.0213, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8902, 'compress@10': 0.9066, 'time@10': 8.829}: 100%|██████████| 30/30 [03:16<00:00,  6.54s/it]
Epoch: 30
Avg # of users: 5.866666666666666
Avg Loss: 0.02127272460443867
Avg hit ratio: 0.8440933479739826
Avg ndcg: 0.8901823021748447
Avg compression ratio: 0.9066299340722074
Avg train time: 8.829016947746277
Std train time: 2.8821884021284805
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 38, 8, 19, 26, 10, 10, 9, 5, 11, 10, 41, 40, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0311, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8842, 'compress@10': 0.9052, 'time@10': 9.1225}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0311, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8842, 'compress@10': 0.9052, 'time@10': 9.1225}:   3%|▎         | 1/30 [00:04<02:13,  4.60s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9036, 'compress@10': 0.9042, 'time@10': 8.3108}:   3%|▎         | 1/30 [00:12<02:13,  4.60s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9036, 'compress@10': 0.9042, 'time@10': 8.3108}:   7%|▋         | 2/30 [00:12<02:57,  6.33s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8881, 'compress@10': 0.9076, 'time@10': 7.2582}:   7%|▋         | 2/30 [00:14<02:57,  6.33s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8881, 'compress@10': 0.9076, 'time@10': 7.2582}:  10%|█         | 3/30 [00:14<02:05,  4.63s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.887, 'compress@10': 0.9066, 'time@10': 7.1421}:  10%|█         | 3/30 [00:21<02:05,  4.63s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.887, 'compress@10': 0.9066, 'time@10': 7.1421}:  13%|█▎        | 4/30 [00:21<02:22,  5.50s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.031, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.867, 'compress@10': 0.9057, 'time@10': 7.8557}:  13%|█▎        | 4/30 [00:26<02:22,  5.50s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.031, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.867, 'compress@10': 0.9057, 'time@10': 7.8557}:  17%|█▋        | 5/30 [00:26<02:16,  5.46s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0292, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8781, 'compress@10': 0.9051, 'time@10': 8.7197}:  17%|█▋        | 5/30 [00:40<02:16,  5.46s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0292, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8781, 'compress@10': 0.9051, 'time@10': 8.7197}:  20%|██        | 6/30 [00:40<03:13,  8.06s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0288, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.8786, 'compress@10': 0.9049, 'time@10': 8.8845}:  20%|██        | 6/30 [00:45<03:13,  8.06s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0288, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.8786, 'compress@10': 0.9049, 'time@10': 8.8845}:  23%|██▎       | 7/30 [00:45<02:42,  7.05s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0287, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.8923, 'compress@10': 0.9047, 'time@10': 8.8539}:  23%|██▎       | 7/30 [00:53<02:42,  7.05s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0287, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.8923, 'compress@10': 0.9047, 'time@10': 8.8539}:  27%|██▋       | 8/30 [00:53<02:46,  7.57s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8965, 'compress@10': 0.9045, 'time@10': 9.1914}:  27%|██▋       | 8/30 [00:59<02:46,  7.57s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8965, 'compress@10': 0.9045, 'time@10': 9.1914}:  30%|███       | 9/30 [00:59<02:28,  7.08s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.026, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9036, 'compress@10': 0.9042, 'time@10': 9.4052}:  30%|███       | 9/30 [01:11<02:28,  7.08s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 0.026, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9036, 'compress@10': 0.9042, 'time@10': 9.4052}:  33%|███▎      | 10/30 [01:11<02:48,  8.40s/it]{'epoch': 31, 'num_users': 6.6364, 'loss': 0.0269, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9033, 'compress@10': 0.9042, 'time@10': 9.6886}:  33%|███▎      | 10/30 [01:17<02:48,  8.40s/it]{'epoch': 31, 'num_users': 6.6364, 'loss': 0.0269, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9033, 'compress@10': 0.9042, 'time@10': 9.6886}:  37%|███▋      | 11/30 [01:17<02:27,  7.76s/it]{'epoch': 31, 'num_users': 6.4167, 'loss': 0.025, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9044, 'compress@10': 0.9045, 'time@10': 9.3187}:  37%|███▋      | 11/30 [01:22<02:27,  7.76s/it] {'epoch': 31, 'num_users': 6.4167, 'loss': 0.025, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9044, 'compress@10': 0.9045, 'time@10': 9.3187}:  40%|████      | 12/30 [01:22<02:06,  7.01s/it]{'epoch': 31, 'num_users': 6.6154, 'loss': 0.0253, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9044, 'compress@10': 0.9045, 'time@10': 9.3956}:  40%|████      | 12/30 [01:27<02:06,  7.01s/it]{'epoch': 31, 'num_users': 6.6154, 'loss': 0.0253, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9044, 'compress@10': 0.9045, 'time@10': 9.3956}:  43%|████▎     | 13/30 [01:27<01:49,  6.46s/it]{'epoch': 31, 'num_users': 6.3571, 'loss': 0.0236, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8994, 'compress@10': 0.9054, 'time@10': 9.0603}:  43%|████▎     | 13/30 [01:32<01:49,  6.46s/it]{'epoch': 31, 'num_users': 6.3571, 'loss': 0.0236, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8994, 'compress@10': 0.9054, 'time@10': 9.0603}:  47%|████▋     | 14/30 [01:32<01:35,  5.94s/it]{'epoch': 31, 'num_users': 6.2667, 'loss': 0.0239, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8993, 'compress@10': 0.9053, 'time@10': 9.241}:  47%|████▋     | 14/30 [01:38<01:35,  5.94s/it] {'epoch': 31, 'num_users': 6.2667, 'loss': 0.0239, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8993, 'compress@10': 0.9053, 'time@10': 9.241}:  50%|█████     | 15/30 [01:38<01:28,  5.93s/it]{'epoch': 31, 'num_users': 6.0625, 'loss': 0.0226, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9003, 'compress@10': 0.9055, 'time@10': 8.9939}:  50%|█████     | 15/30 [01:43<01:28,  5.93s/it]{'epoch': 31, 'num_users': 6.0625, 'loss': 0.0226, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9003, 'compress@10': 0.9055, 'time@10': 8.9939}:  53%|█████▎    | 16/30 [01:43<01:20,  5.75s/it]{'epoch': 31, 'num_users': 5.8235, 'loss': 0.0214, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8927, 'compress@10': 0.9063, 'time@10': 8.7542}:  53%|█████▎    | 16/30 [01:46<01:20,  5.75s/it]{'epoch': 31, 'num_users': 5.8235, 'loss': 0.0214, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8927, 'compress@10': 0.9063, 'time@10': 8.7542}:  57%|█████▋    | 17/30 [01:46<01:02,  4.77s/it]{'epoch': 31, 'num_users': 6.0556, 'loss': 0.0212, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8946, 'compress@10': 0.9062, 'time@10': 8.6781}:  57%|█████▋    | 17/30 [01:53<01:02,  4.77s/it]{'epoch': 31, 'num_users': 6.0556, 'loss': 0.0212, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8946, 'compress@10': 0.9062, 'time@10': 8.6781}:  60%|██████    | 18/30 [01:53<01:06,  5.57s/it]{'epoch': 31, 'num_users': 6.0, 'loss': 0.0208, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8954, 'compress@10': 0.9062, 'time@10': 8.5509}:  60%|██████    | 18/30 [01:56<01:06,  5.57s/it]    {'epoch': 31, 'num_users': 6.0, 'loss': 0.0208, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8954, 'compress@10': 0.9062, 'time@10': 8.5509}:  63%|██████▎   | 19/30 [01:56<00:53,  4.85s/it]{'epoch': 31, 'num_users': 6.15, 'loss': 0.0209, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8972, 'compress@10': 0.906, 'time@10': 8.7729}:  63%|██████▎   | 19/30 [02:09<00:53,  4.85s/it]{'epoch': 31, 'num_users': 6.15, 'loss': 0.0209, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8972, 'compress@10': 0.906, 'time@10': 8.7729}:  67%|██████▋   | 20/30 [02:09<01:13,  7.30s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0223, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8947, 'compress@10': 0.9058, 'time@10': 8.8549}:  67%|██████▋   | 20/30 [02:15<01:13,  7.30s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0223, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8947, 'compress@10': 0.9058, 'time@10': 8.8549}:  70%|███████   | 21/30 [02:15<01:00,  6.70s/it]{'epoch': 31, 'num_users': 6.1818, 'loss': 0.0225, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8955, 'compress@10': 0.9058, 'time@10': 8.7106}:  70%|███████   | 21/30 [02:20<01:00,  6.70s/it]{'epoch': 31, 'num_users': 6.1818, 'loss': 0.0225, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8955, 'compress@10': 0.9058, 'time@10': 8.7106}:  73%|███████▎  | 22/30 [02:20<00:51,  6.40s/it]{'epoch': 31, 'num_users': 6.1304, 'loss': 0.0221, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8967, 'compress@10': 0.9057, 'time@10': 8.7445}:  73%|███████▎  | 22/30 [02:25<00:51,  6.40s/it] {'epoch': 31, 'num_users': 6.1304, 'loss': 0.0221, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8967, 'compress@10': 0.9057, 'time@10': 8.7445}:  77%|███████▋  | 23/30 [02:25<00:41,  5.92s/it]{'epoch': 31, 'num_users': 5.9583, 'loss': 0.0213, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8927, 'compress@10': 0.9063, 'time@10': 8.5558}:  77%|███████▋  | 23/30 [02:29<00:41,  5.92s/it]{'epoch': 31, 'num_users': 5.9583, 'loss': 0.0213, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8927, 'compress@10': 0.9063, 'time@10': 8.5558}:  80%|████████  | 24/30 [02:29<00:32,  5.42s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8837, 'compress@10': 0.9074, 'time@10': 8.4294}:  80%|████████  | 24/30 [02:32<00:32,  5.42s/it]   {'epoch': 31, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8837, 'compress@10': 0.9074, 'time@10': 8.4294}:  83%|████████▎ | 25/30 [02:32<00:23,  4.62s/it]{'epoch': 31, 'num_users': 5.8077, 'loss': 0.0204, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.886, 'compress@10': 0.9072, 'time@10': 8.6081}:  83%|████████▎ | 25/30 [02:45<00:23,  4.62s/it]{'epoch': 31, 'num_users': 5.8077, 'loss': 0.0204, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.886, 'compress@10': 0.9072, 'time@10': 8.6081}:  87%|████████▋ | 26/30 [02:45<00:28,  7.17s/it]{'epoch': 31, 'num_users': 5.8889, 'loss': 0.0201, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8876, 'compress@10': 0.907, 'time@10': 8.6949}:  87%|████████▋ | 26/30 [02:51<00:28,  7.17s/it]{'epoch': 31, 'num_users': 5.8889, 'loss': 0.0201, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8876, 'compress@10': 0.907, 'time@10': 8.6949}:  90%|█████████ | 27/30 [02:51<00:20,  6.67s/it]{'epoch': 31, 'num_users': 6.0, 'loss': 0.0199, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8902, 'compress@10': 0.9068, 'time@10': 8.8815}:  90%|█████████ | 27/30 [03:05<00:20,  6.67s/it]  {'epoch': 31, 'num_users': 6.0, 'loss': 0.0199, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8902, 'compress@10': 0.9068, 'time@10': 8.8815}:  93%|█████████▎| 28/30 [03:05<00:17,  8.86s/it]{'epoch': 31, 'num_users': 5.8621, 'loss': 0.0196, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8921, 'compress@10': 0.9068, 'time@10': 8.9409}:  93%|█████████▎| 28/30 [03:10<00:17,  8.86s/it]{'epoch': 31, 'num_users': 5.8621, 'loss': 0.0196, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8921, 'compress@10': 0.9068, 'time@10': 8.9409}:  97%|█████████▋| 29/30 [03:10<00:07,  7.80s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0199, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8924, 'compress@10': 0.9066, 'time@10': 8.944}:  97%|█████████▋| 29/30 [03:19<00:07,  7.80s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0199, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8924, 'compress@10': 0.9066, 'time@10': 8.944}: 100%|██████████| 30/30 [03:19<00:00,  8.18s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0199, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8924, 'compress@10': 0.9066, 'time@10': 8.944}: 100%|██████████| 30/30 [03:19<00:00,  6.66s/it]
Epoch: 31
Avg # of users: 5.866666666666666
Avg Loss: 0.019894219201576826
Avg hit ratio: 0.8592319739949613
Avg ndcg: 0.8924319333444465
Avg compression ratio: 0.9066299422106507
Avg train time: 8.94401032924652
Std train time: 2.961793793506807
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 42, 40, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8842, 'compress@10': 0.9052, 'time@10': 9.2106}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8842, 'compress@10': 0.9052, 'time@10': 9.2106}:   3%|▎         | 1/30 [00:04<02:14,  4.64s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9029, 'compress@10': 0.9042, 'time@10': 8.4679}:   3%|▎         | 1/30 [00:12<02:14,  4.64s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9029, 'compress@10': 0.9042, 'time@10': 8.4679}:   7%|▋         | 2/30 [00:12<03:01,  6.48s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8876, 'compress@10': 0.9076, 'time@10': 7.353}:   7%|▋         | 2/30 [00:14<03:01,  6.48s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8876, 'compress@10': 0.9076, 'time@10': 7.353}:  10%|█         | 3/30 [00:14<02:07,  4.71s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9075, 'compress@10': 0.9066, 'time@10': 7.2081}:  10%|█         | 3/30 [00:21<02:07,  4.71s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9075, 'compress@10': 0.9066, 'time@10': 7.2081}:  13%|█▎        | 4/30 [00:21<02:23,  5.54s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0293, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8825, 'compress@10': 0.9057, 'time@10': 7.7341}:  13%|█▎        | 4/30 [00:26<02:23,  5.54s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0293, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8825, 'compress@10': 0.9057, 'time@10': 7.7341}:  17%|█▋        | 5/30 [00:26<02:13,  5.33s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0296, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8904, 'compress@10': 0.9051, 'time@10': 8.356}:  17%|█▋        | 5/30 [00:38<02:13,  5.33s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0296, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8904, 'compress@10': 0.9051, 'time@10': 8.356}:  20%|██        | 6/30 [00:38<02:58,  7.43s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0292, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.8892, 'compress@10': 0.9049, 'time@10': 8.4857}:  20%|██        | 6/30 [00:42<02:58,  7.43s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0292, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.8892, 'compress@10': 0.9049, 'time@10': 8.4857}:  23%|██▎       | 7/30 [00:42<02:30,  6.52s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.029, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.8993, 'compress@10': 0.9047, 'time@10': 8.4883}:  23%|██▎       | 7/30 [00:51<02:30,  6.52s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.029, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.8993, 'compress@10': 0.9047, 'time@10': 8.4883}:  27%|██▋       | 8/30 [00:51<02:37,  7.17s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0283, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9021, 'compress@10': 0.9045, 'time@10': 8.8805}:  27%|██▋       | 8/30 [00:57<02:37,  7.17s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0283, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9021, 'compress@10': 0.9045, 'time@10': 8.8805}:  30%|███       | 9/30 [00:57<02:23,  6.82s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0282, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9057, 'compress@10': 0.9042, 'time@10': 9.1962}:  30%|███       | 9/30 [01:09<02:23,  6.82s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0282, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9057, 'compress@10': 0.9042, 'time@10': 9.1962}:  33%|███▎      | 10/30 [01:09<02:48,  8.44s/it]{'epoch': 32, 'num_users': 6.6364, 'loss': 0.0287, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9052, 'compress@10': 0.9042, 'time@10': 9.5754}:  33%|███▎      | 10/30 [01:16<02:48,  8.44s/it]{'epoch': 32, 'num_users': 6.6364, 'loss': 0.0287, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9052, 'compress@10': 0.9042, 'time@10': 9.5754}:  37%|███▋      | 11/30 [01:16<02:30,  7.91s/it]{'epoch': 32, 'num_users': 6.4167, 'loss': 0.0267, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9061, 'compress@10': 0.9045, 'time@10': 9.2496}:  37%|███▋      | 11/30 [01:22<02:30,  7.91s/it]{'epoch': 32, 'num_users': 6.4167, 'loss': 0.0267, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9061, 'compress@10': 0.9045, 'time@10': 9.2496}:  40%|████      | 12/30 [01:22<02:10,  7.24s/it]{'epoch': 32, 'num_users': 6.6154, 'loss': 0.0268, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9062, 'compress@10': 0.9045, 'time@10': 9.4778}:  40%|████      | 12/30 [01:28<02:10,  7.24s/it]{'epoch': 32, 'num_users': 6.6154, 'loss': 0.0268, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9062, 'compress@10': 0.9045, 'time@10': 9.4778}:  43%|████▎     | 13/30 [01:28<01:57,  6.91s/it]{'epoch': 32, 'num_users': 6.3571, 'loss': 0.0249, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.901, 'compress@10': 0.9054, 'time@10': 9.1792}:  43%|████▎     | 13/30 [01:33<01:57,  6.91s/it] {'epoch': 32, 'num_users': 6.3571, 'loss': 0.0249, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.901, 'compress@10': 0.9054, 'time@10': 9.1792}:  47%|████▋     | 14/30 [01:33<01:43,  6.44s/it]{'epoch': 32, 'num_users': 6.2667, 'loss': 0.0247, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.9018, 'compress@10': 0.9053, 'time@10': 9.4821}:  47%|████▋     | 14/30 [01:40<01:43,  6.44s/it]{'epoch': 32, 'num_users': 6.2667, 'loss': 0.0247, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.9018, 'compress@10': 0.9053, 'time@10': 9.4821}:  50%|█████     | 15/30 [01:40<01:38,  6.58s/it]{'epoch': 32, 'num_users': 6.0625, 'loss': 0.0233, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9027, 'compress@10': 0.9055, 'time@10': 9.2596}:  50%|█████     | 15/30 [01:46<01:38,  6.58s/it]{'epoch': 32, 'num_users': 6.0625, 'loss': 0.0233, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9027, 'compress@10': 0.9055, 'time@10': 9.2596}:  53%|█████▎    | 16/30 [01:46<01:29,  6.39s/it]{'epoch': 32, 'num_users': 5.8235, 'loss': 0.0221, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.895, 'compress@10': 0.9063, 'time@10': 9.04}:  53%|█████▎    | 16/30 [01:49<01:29,  6.39s/it]   {'epoch': 32, 'num_users': 5.8235, 'loss': 0.0221, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.895, 'compress@10': 0.9063, 'time@10': 9.04}:  57%|█████▋    | 17/30 [01:49<01:09,  5.31s/it]{'epoch': 32, 'num_users': 6.0556, 'loss': 0.022, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8966, 'compress@10': 0.9062, 'time@10': 8.9114}:  57%|█████▋    | 17/30 [01:55<01:09,  5.31s/it]{'epoch': 32, 'num_users': 6.0556, 'loss': 0.022, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8966, 'compress@10': 0.9062, 'time@10': 8.9114}:  60%|██████    | 18/30 [01:55<01:08,  5.75s/it]{'epoch': 32, 'num_users': 6.0, 'loss': 0.0213, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8976, 'compress@10': 0.9062, 'time@10': 8.7739}:  60%|██████    | 18/30 [01:59<01:08,  5.75s/it]   {'epoch': 32, 'num_users': 6.0, 'loss': 0.0213, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8976, 'compress@10': 0.9062, 'time@10': 8.7739}:  63%|██████▎   | 19/30 [01:59<00:54,  4.98s/it]{'epoch': 32, 'num_users': 6.15, 'loss': 0.0214, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8994, 'compress@10': 0.906, 'time@10': 8.9764}:  63%|██████▎   | 19/30 [02:12<00:54,  4.98s/it]{'epoch': 32, 'num_users': 6.15, 'loss': 0.0214, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8994, 'compress@10': 0.906, 'time@10': 8.9764}:  67%|██████▋   | 20/30 [02:12<01:14,  7.43s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0227, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8968, 'compress@10': 0.9058, 'time@10': 8.9998}:  67%|██████▋   | 20/30 [02:17<01:14,  7.43s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0227, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8968, 'compress@10': 0.9058, 'time@10': 8.9998}:  70%|███████   | 21/30 [02:17<00:59,  6.63s/it]{'epoch': 32, 'num_users': 6.1818, 'loss': 0.0232, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8964, 'compress@10': 0.9058, 'time@10': 8.8524}:  70%|███████   | 21/30 [02:22<00:59,  6.63s/it]{'epoch': 32, 'num_users': 6.1818, 'loss': 0.0232, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8964, 'compress@10': 0.9058, 'time@10': 8.8524}:  73%|███████▎  | 22/30 [02:22<00:51,  6.38s/it]{'epoch': 32, 'num_users': 6.1304, 'loss': 0.0228, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8976, 'compress@10': 0.9057, 'time@10': 8.8863}:  73%|███████▎  | 22/30 [02:27<00:51,  6.38s/it] {'epoch': 32, 'num_users': 6.1304, 'loss': 0.0228, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8976, 'compress@10': 0.9057, 'time@10': 8.8863}:  77%|███████▋  | 23/30 [02:27<00:41,  5.92s/it]{'epoch': 32, 'num_users': 5.9583, 'loss': 0.0219, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8935, 'compress@10': 0.9063, 'time@10': 8.6907}:  77%|███████▋  | 23/30 [02:31<00:41,  5.92s/it]{'epoch': 32, 'num_users': 5.9583, 'loss': 0.0219, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8935, 'compress@10': 0.9063, 'time@10': 8.6907}:  80%|████████  | 24/30 [02:31<00:32,  5.41s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8844, 'compress@10': 0.9074, 'time@10': 8.4955}:  80%|████████  | 24/30 [02:33<00:32,  5.41s/it]   {'epoch': 32, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8844, 'compress@10': 0.9074, 'time@10': 8.4955}:  83%|████████▎ | 25/30 [02:33<00:21,  4.37s/it]{'epoch': 32, 'num_users': 5.8077, 'loss': 0.021, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8868, 'compress@10': 0.9072, 'time@10': 8.6325}:  83%|████████▎ | 25/30 [02:45<00:21,  4.37s/it]{'epoch': 32, 'num_users': 5.8077, 'loss': 0.021, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8868, 'compress@10': 0.9072, 'time@10': 8.6325}:  87%|████████▋ | 26/30 [02:45<00:26,  6.69s/it]{'epoch': 32, 'num_users': 5.8889, 'loss': 0.0207, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8886, 'compress@10': 0.907, 'time@10': 8.7259}:  87%|████████▋ | 26/30 [02:51<00:26,  6.69s/it]{'epoch': 32, 'num_users': 5.8889, 'loss': 0.0207, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8886, 'compress@10': 0.907, 'time@10': 8.7259}:  90%|█████████ | 27/30 [02:51<00:19,  6.37s/it]{'epoch': 32, 'num_users': 6.0, 'loss': 0.0207, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8904, 'compress@10': 0.9068, 'time@10': 8.8745}:  90%|█████████ | 27/30 [03:04<00:19,  6.37s/it]  {'epoch': 32, 'num_users': 6.0, 'loss': 0.0207, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8904, 'compress@10': 0.9068, 'time@10': 8.8745}:  93%|█████████▎| 28/30 [03:04<00:16,  8.33s/it]{'epoch': 32, 'num_users': 5.8621, 'loss': 0.0203, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8922, 'compress@10': 0.9068, 'time@10': 8.9536}:  93%|█████████▎| 28/30 [03:10<00:16,  8.33s/it]{'epoch': 32, 'num_users': 5.8621, 'loss': 0.0203, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8922, 'compress@10': 0.9068, 'time@10': 8.9536}:  97%|█████████▋| 29/30 [03:10<00:07,  7.52s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0206, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8931, 'compress@10': 0.9066, 'time@10': 8.9585}:  97%|█████████▋| 29/30 [03:19<00:07,  7.52s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0206, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8931, 'compress@10': 0.9066, 'time@10': 8.9585}: 100%|██████████| 30/30 [03:19<00:00,  8.01s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0206, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8931, 'compress@10': 0.9066, 'time@10': 8.9585}: 100%|██████████| 30/30 [03:19<00:00,  6.64s/it]
Epoch: 32
Avg # of users: 5.866666666666666
Avg Loss: 0.020587460299884685
Avg hit ratio: 0.8592319739949613
Avg ndcg: 0.8931260290821915
Avg compression ratio: 0.9066299277190223
Avg train time: 8.9584810256958
Std train time: 2.984477036241673
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 43, 41, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8865, 'compress@10': 0.9052, 'time@10': 9.3508}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8865, 'compress@10': 0.9052, 'time@10': 9.3508}:   3%|▎         | 1/30 [00:04<02:17,  4.73s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9041, 'compress@10': 0.9042, 'time@10': 8.6282}:   3%|▎         | 1/30 [00:12<02:17,  4.73s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9041, 'compress@10': 0.9042, 'time@10': 8.6282}:   7%|▋         | 2/30 [00:12<03:05,  6.62s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8885, 'compress@10': 0.9076, 'time@10': 7.5242}:   7%|▋         | 2/30 [00:15<03:05,  6.62s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8885, 'compress@10': 0.9076, 'time@10': 7.5242}:  10%|█         | 3/30 [00:15<02:10,  4.83s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9045, 'compress@10': 0.9066, 'time@10': 7.3884}:  10%|█         | 3/30 [00:22<02:10,  4.83s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9045, 'compress@10': 0.9066, 'time@10': 7.3884}:  13%|█▎        | 4/30 [00:22<02:27,  5.69s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0264, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8805, 'compress@10': 0.9057, 'time@10': 7.8939}:  13%|█▎        | 4/30 [00:27<02:27,  5.69s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0264, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8805, 'compress@10': 0.9057, 'time@10': 7.8939}:  17%|█▋        | 5/30 [00:27<02:16,  5.44s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0251, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8898, 'compress@10': 0.9051, 'time@10': 8.4935}:  17%|█▋        | 5/30 [00:38<02:16,  5.44s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0251, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8898, 'compress@10': 0.9051, 'time@10': 8.4935}:  20%|██        | 6/30 [00:38<03:00,  7.51s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0251, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.889, 'compress@10': 0.9049, 'time@10': 8.7404}:  20%|██        | 6/30 [00:44<03:00,  7.51s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0251, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.889, 'compress@10': 0.9049, 'time@10': 8.7404}:  23%|██▎       | 7/30 [00:44<02:34,  6.74s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0254, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9005, 'compress@10': 0.9047, 'time@10': 8.7204}:  23%|██▎       | 7/30 [00:52<02:34,  6.74s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0254, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9005, 'compress@10': 0.9047, 'time@10': 8.7204}:  27%|██▋       | 8/30 [00:52<02:41,  7.34s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.025, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9036, 'compress@10': 0.9045, 'time@10': 8.9419}:  27%|██▋       | 8/30 [00:58<02:41,  7.34s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.025, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9036, 'compress@10': 0.9045, 'time@10': 8.9419}:  30%|███       | 9/30 [00:58<02:21,  6.73s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9111, 'compress@10': 0.9042, 'time@10': 9.1523}:  30%|███       | 9/30 [01:09<02:21,  6.73s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9111, 'compress@10': 0.9042, 'time@10': 9.1523}:  33%|███▎      | 10/30 [01:09<02:41,  8.07s/it]{'epoch': 33, 'num_users': 6.6364, 'loss': 0.0257, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9103, 'compress@10': 0.9042, 'time@10': 9.526}:  33%|███▎      | 10/30 [01:15<02:41,  8.07s/it]{'epoch': 33, 'num_users': 6.6364, 'loss': 0.0257, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9103, 'compress@10': 0.9042, 'time@10': 9.526}:  37%|███▋      | 11/30 [01:15<02:25,  7.64s/it]{'epoch': 33, 'num_users': 6.4167, 'loss': 0.0239, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9108, 'compress@10': 0.9045, 'time@10': 9.1855}:  37%|███▋      | 11/30 [01:21<02:25,  7.64s/it]{'epoch': 33, 'num_users': 6.4167, 'loss': 0.0239, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9108, 'compress@10': 0.9045, 'time@10': 9.1855}:  40%|████      | 12/30 [01:21<02:05,  6.98s/it]{'epoch': 33, 'num_users': 6.6154, 'loss': 0.0241, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.9106, 'compress@10': 0.9045, 'time@10': 9.3281}:  40%|████      | 12/30 [01:26<02:05,  6.98s/it]{'epoch': 33, 'num_users': 6.6154, 'loss': 0.0241, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.9106, 'compress@10': 0.9045, 'time@10': 9.3281}:  43%|████▎     | 13/30 [01:26<01:51,  6.55s/it]{'epoch': 33, 'num_users': 6.3571, 'loss': 0.0224, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.9051, 'compress@10': 0.9054, 'time@10': 9.017}:  43%|████▎     | 13/30 [01:31<01:51,  6.55s/it] {'epoch': 33, 'num_users': 6.3571, 'loss': 0.0224, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.9051, 'compress@10': 0.9054, 'time@10': 9.017}:  47%|████▋     | 14/30 [01:31<01:37,  6.09s/it]{'epoch': 33, 'num_users': 6.2667, 'loss': 0.0223, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9062, 'compress@10': 0.9053, 'time@10': 9.2387}:  47%|████▋     | 14/30 [01:38<01:37,  6.09s/it]{'epoch': 33, 'num_users': 6.2667, 'loss': 0.0223, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9062, 'compress@10': 0.9053, 'time@10': 9.2387}:  50%|█████     | 15/30 [01:38<01:31,  6.12s/it]{'epoch': 33, 'num_users': 6.0625, 'loss': 0.0211, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.9068, 'compress@10': 0.9055, 'time@10': 9.0032}:  50%|█████     | 15/30 [01:43<01:31,  6.12s/it]{'epoch': 33, 'num_users': 6.0625, 'loss': 0.0211, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.9068, 'compress@10': 0.9055, 'time@10': 9.0032}:  53%|█████▎    | 16/30 [01:43<01:23,  5.94s/it]{'epoch': 33, 'num_users': 5.8235, 'loss': 0.0199, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8988, 'compress@10': 0.9063, 'time@10': 8.8053}:  53%|█████▎    | 16/30 [01:46<01:23,  5.94s/it]{'epoch': 33, 'num_users': 5.8235, 'loss': 0.0199, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8988, 'compress@10': 0.9063, 'time@10': 8.8053}:  57%|█████▋    | 17/30 [01:46<01:05,  5.02s/it]{'epoch': 33, 'num_users': 6.0556, 'loss': 0.0199, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.9008, 'compress@10': 0.9062, 'time@10': 8.7015}:  57%|█████▋    | 17/30 [01:53<01:05,  5.02s/it]{'epoch': 33, 'num_users': 6.0556, 'loss': 0.0199, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.9008, 'compress@10': 0.9062, 'time@10': 8.7015}:  60%|██████    | 18/30 [01:53<01:07,  5.60s/it]{'epoch': 33, 'num_users': 6.0, 'loss': 0.0196, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9013, 'compress@10': 0.9062, 'time@10': 8.6151}:  60%|██████    | 18/30 [01:56<01:07,  5.60s/it]   {'epoch': 33, 'num_users': 6.0, 'loss': 0.0196, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9013, 'compress@10': 0.9062, 'time@10': 8.6151}:  63%|██████▎   | 19/30 [01:56<00:54,  4.99s/it]{'epoch': 33, 'num_users': 6.15, 'loss': 0.0199, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9022, 'compress@10': 0.906, 'time@10': 8.8421}:  63%|██████▎   | 19/30 [02:10<00:54,  4.99s/it]{'epoch': 33, 'num_users': 6.15, 'loss': 0.0199, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9022, 'compress@10': 0.906, 'time@10': 8.8421}:  67%|██████▋   | 20/30 [02:10<01:14,  7.45s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8995, 'compress@10': 0.9058, 'time@10': 8.8982}:  67%|██████▋   | 20/30 [02:15<01:14,  7.45s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8995, 'compress@10': 0.9058, 'time@10': 8.8982}:  70%|███████   | 21/30 [02:15<01:00,  6.73s/it]{'epoch': 33, 'num_users': 6.1818, 'loss': 0.0216, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9003, 'compress@10': 0.9058, 'time@10': 8.7617}:  70%|███████   | 21/30 [02:21<01:00,  6.73s/it]{'epoch': 33, 'num_users': 6.1818, 'loss': 0.0216, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9003, 'compress@10': 0.9058, 'time@10': 8.7617}:  73%|███████▎  | 22/30 [02:21<00:51,  6.49s/it]{'epoch': 33, 'num_users': 6.1304, 'loss': 0.0212, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9013, 'compress@10': 0.9057, 'time@10': 8.7963}:  73%|███████▎  | 22/30 [02:25<00:51,  6.49s/it]{'epoch': 33, 'num_users': 6.1304, 'loss': 0.0212, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9013, 'compress@10': 0.9057, 'time@10': 8.7963}:  77%|███████▋  | 23/30 [02:25<00:41,  5.99s/it]{'epoch': 33, 'num_users': 5.9583, 'loss': 0.0204, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8971, 'compress@10': 0.9063, 'time@10': 8.6202}:  77%|███████▋  | 23/30 [02:30<00:41,  5.99s/it]{'epoch': 33, 'num_users': 5.9583, 'loss': 0.0204, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8971, 'compress@10': 0.9063, 'time@10': 8.6202}:  80%|████████  | 24/30 [02:30<00:33,  5.58s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8879, 'compress@10': 0.9074, 'time@10': 8.4463}:  80%|████████  | 24/30 [02:32<00:33,  5.58s/it]   {'epoch': 33, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8879, 'compress@10': 0.9074, 'time@10': 8.4463}:  83%|████████▎ | 25/30 [02:32<00:22,  4.55s/it]{'epoch': 33, 'num_users': 5.8077, 'loss': 0.0195, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8902, 'compress@10': 0.9072, 'time@10': 8.6023}:  83%|████████▎ | 25/30 [02:45<00:22,  4.55s/it]{'epoch': 33, 'num_users': 5.8077, 'loss': 0.0195, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8902, 'compress@10': 0.9072, 'time@10': 8.6023}:  87%|████████▋ | 26/30 [02:45<00:27,  6.95s/it]{'epoch': 33, 'num_users': 5.8889, 'loss': 0.0193, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8918, 'compress@10': 0.907, 'time@10': 8.7011}:  87%|████████▋ | 26/30 [02:50<00:27,  6.95s/it] {'epoch': 33, 'num_users': 5.8889, 'loss': 0.0193, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8918, 'compress@10': 0.907, 'time@10': 8.7011}:  90%|█████████ | 27/30 [02:50<00:19,  6.57s/it]{'epoch': 33, 'num_users': 6.0, 'loss': 0.0191, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8945, 'compress@10': 0.9068, 'time@10': 8.8572}:  90%|█████████ | 27/30 [03:04<00:19,  6.57s/it]  {'epoch': 33, 'num_users': 6.0, 'loss': 0.0191, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8945, 'compress@10': 0.9068, 'time@10': 8.8572}:  93%|█████████▎| 28/30 [03:04<00:17,  8.53s/it]{'epoch': 33, 'num_users': 5.8621, 'loss': 0.0187, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8963, 'compress@10': 0.9068, 'time@10': 8.9348}:  93%|█████████▎| 28/30 [03:09<00:17,  8.53s/it]{'epoch': 33, 'num_users': 5.8621, 'loss': 0.0187, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8963, 'compress@10': 0.9068, 'time@10': 8.9348}:  97%|█████████▋| 29/30 [03:09<00:07,  7.65s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.019, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8969, 'compress@10': 0.9066, 'time@10': 8.9465}:  97%|█████████▋| 29/30 [03:18<00:07,  7.65s/it] {'epoch': 33, 'num_users': 5.8667, 'loss': 0.019, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8969, 'compress@10': 0.9066, 'time@10': 8.9465}: 100%|██████████| 30/30 [03:18<00:00,  8.15s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.019, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8969, 'compress@10': 0.9066, 'time@10': 8.9465}: 100%|██████████| 30/30 [03:18<00:00,  6.63s/it]
Epoch: 33
Avg # of users: 5.866666666666666
Avg Loss: 0.018993531489752014
Avg hit ratio: 0.8627628430286695
Avg ndcg: 0.8969054768630556
Avg compression ratio: 0.9066299389829704
Avg train time: 8.946470149358113
Std train time: 2.8143489166818862
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 44, 42, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8865, 'compress@10': 0.9052, 'time@10': 9.3272}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8865, 'compress@10': 0.9052, 'time@10': 9.3272}:   3%|▎         | 1/30 [00:04<02:16,  4.70s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9039, 'compress@10': 0.9042, 'time@10': 8.5167}:   3%|▎         | 1/30 [00:12<02:16,  4.70s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9039, 'compress@10': 0.9042, 'time@10': 8.5167}:   7%|▋         | 2/30 [00:12<03:01,  6.49s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8883, 'compress@10': 0.9076, 'time@10': 7.3743}:   7%|▋         | 2/30 [00:15<03:01,  6.49s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8883, 'compress@10': 0.9076, 'time@10': 7.3743}:  10%|█         | 3/30 [00:15<02:07,  4.70s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9023, 'compress@10': 0.9066, 'time@10': 7.227}:  10%|█         | 3/30 [00:21<02:07,  4.70s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9023, 'compress@10': 0.9066, 'time@10': 7.227}:  13%|█▎        | 4/30 [00:21<02:24,  5.55s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0259, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8786, 'compress@10': 0.9057, 'time@10': 7.7451}:  13%|█▎        | 4/30 [00:26<02:24,  5.55s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0259, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8786, 'compress@10': 0.9057, 'time@10': 7.7451}:  17%|█▋        | 5/30 [00:26<02:13,  5.33s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0244, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8895, 'compress@10': 0.9051, 'time@10': 8.3884}:  17%|█▋        | 5/30 [00:38<02:13,  5.33s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0244, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8895, 'compress@10': 0.9051, 'time@10': 8.3884}:  20%|██        | 6/30 [00:38<02:59,  7.48s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0245, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8879, 'compress@10': 0.9049, 'time@10': 8.6369}:  20%|██        | 6/30 [00:43<02:59,  7.48s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0245, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8879, 'compress@10': 0.9049, 'time@10': 8.6369}:  23%|██▎       | 7/30 [00:43<02:34,  6.70s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0249, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.8989, 'compress@10': 0.9047, 'time@10': 8.649}:  23%|██▎       | 7/30 [00:52<02:34,  6.70s/it]  {'epoch': 34, 'num_users': 6.125, 'loss': 0.0249, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.8989, 'compress@10': 0.9047, 'time@10': 8.649}:  27%|██▋       | 8/30 [00:52<02:41,  7.36s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0245, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.9025, 'compress@10': 0.9045, 'time@10': 8.8884}:  27%|██▋       | 8/30 [00:57<02:41,  7.36s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0245, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.9025, 'compress@10': 0.9045, 'time@10': 8.8884}:  30%|███       | 9/30 [00:57<02:21,  6.76s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.9068, 'compress@10': 0.9042, 'time@10': 9.0934}:  30%|███       | 9/30 [01:08<02:21,  6.76s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.9068, 'compress@10': 0.9042, 'time@10': 9.0934}:  33%|███▎      | 10/30 [01:08<02:41,  8.06s/it]{'epoch': 34, 'num_users': 6.6364, 'loss': 0.0255, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9064, 'compress@10': 0.9042, 'time@10': 9.4373}:  33%|███▎      | 10/30 [01:15<02:41,  8.06s/it]{'epoch': 34, 'num_users': 6.6364, 'loss': 0.0255, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9064, 'compress@10': 0.9042, 'time@10': 9.4373}:  37%|███▋      | 11/30 [01:15<02:23,  7.58s/it]{'epoch': 34, 'num_users': 6.4167, 'loss': 0.0237, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9072, 'compress@10': 0.9045, 'time@10': 9.1053}:  37%|███▋      | 11/30 [01:20<02:23,  7.58s/it]{'epoch': 34, 'num_users': 6.4167, 'loss': 0.0237, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9072, 'compress@10': 0.9045, 'time@10': 9.1053}:  40%|████      | 12/30 [01:20<02:04,  6.94s/it]{'epoch': 34, 'num_users': 6.6154, 'loss': 0.0239, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.9074, 'compress@10': 0.9045, 'time@10': 9.2176}:  40%|████      | 12/30 [01:26<02:04,  6.94s/it]{'epoch': 34, 'num_users': 6.6154, 'loss': 0.0239, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.9074, 'compress@10': 0.9045, 'time@10': 9.2176}:  43%|████▎     | 13/30 [01:26<01:49,  6.45s/it]{'epoch': 34, 'num_users': 6.3571, 'loss': 0.0222, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.9021, 'compress@10': 0.9054, 'time@10': 8.9102}:  43%|████▎     | 13/30 [01:30<01:49,  6.45s/it]{'epoch': 34, 'num_users': 6.3571, 'loss': 0.0222, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.9021, 'compress@10': 0.9054, 'time@10': 8.9102}:  47%|████▋     | 14/30 [01:30<01:36,  6.00s/it]{'epoch': 34, 'num_users': 6.2667, 'loss': 0.0229, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.9032, 'compress@10': 0.9053, 'time@10': 9.1386}:  47%|████▋     | 14/30 [01:37<01:36,  6.00s/it]{'epoch': 34, 'num_users': 6.2667, 'loss': 0.0229, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.9032, 'compress@10': 0.9053, 'time@10': 9.1386}:  50%|█████     | 15/30 [01:37<01:30,  6.06s/it]{'epoch': 34, 'num_users': 6.0625, 'loss': 0.0216, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.9041, 'compress@10': 0.9055, 'time@10': 8.9018}:  50%|█████     | 15/30 [01:42<01:30,  6.06s/it]{'epoch': 34, 'num_users': 6.0625, 'loss': 0.0216, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.9041, 'compress@10': 0.9055, 'time@10': 8.9018}:  53%|█████▎    | 16/30 [01:42<01:22,  5.86s/it]{'epoch': 34, 'num_users': 5.8235, 'loss': 0.0204, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8962, 'compress@10': 0.9063, 'time@10': 8.6905}:  53%|█████▎    | 16/30 [01:45<01:22,  5.86s/it]{'epoch': 34, 'num_users': 5.8235, 'loss': 0.0204, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8962, 'compress@10': 0.9063, 'time@10': 8.6905}:  57%|█████▋    | 17/30 [01:45<01:03,  4.91s/it]{'epoch': 34, 'num_users': 6.0556, 'loss': 0.0202, 'hit_ratio@10': 0.8253, 'ndcg@10': 0.8982, 'compress@10': 0.9062, 'time@10': 8.5913}:  57%|█████▋    | 17/30 [01:52<01:03,  4.91s/it]{'epoch': 34, 'num_users': 6.0556, 'loss': 0.0202, 'hit_ratio@10': 0.8253, 'ndcg@10': 0.8982, 'compress@10': 0.9062, 'time@10': 8.5913}:  60%|██████    | 18/30 [01:52<01:06,  5.52s/it]{'epoch': 34, 'num_users': 6.0, 'loss': 0.0195, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8996, 'compress@10': 0.9062, 'time@10': 8.4941}:  60%|██████    | 18/30 [01:55<01:06,  5.52s/it]   {'epoch': 34, 'num_users': 6.0, 'loss': 0.0195, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8996, 'compress@10': 0.9062, 'time@10': 8.4941}:  63%|██████▎   | 19/30 [01:55<00:53,  4.88s/it]{'epoch': 34, 'num_users': 6.15, 'loss': 0.0196, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.9015, 'compress@10': 0.906, 'time@10': 8.7262}:  63%|██████▎   | 19/30 [02:08<00:53,  4.88s/it]{'epoch': 34, 'num_users': 6.15, 'loss': 0.0196, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.9015, 'compress@10': 0.906, 'time@10': 8.7262}:  67%|██████▋   | 20/30 [02:08<01:13,  7.37s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.021, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8988, 'compress@10': 0.9058, 'time@10': 8.7923}:  67%|██████▋   | 20/30 [02:13<01:13,  7.37s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.021, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8988, 'compress@10': 0.9058, 'time@10': 8.7923}:  70%|███████   | 21/30 [02:13<01:00,  6.69s/it]{'epoch': 34, 'num_users': 6.1818, 'loss': 0.021, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.8996, 'compress@10': 0.9058, 'time@10': 8.6645}:  70%|███████   | 21/30 [02:19<01:00,  6.69s/it]{'epoch': 34, 'num_users': 6.1818, 'loss': 0.021, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.8996, 'compress@10': 0.9058, 'time@10': 8.6645}:  73%|███████▎  | 22/30 [02:19<00:51,  6.49s/it]{'epoch': 34, 'num_users': 6.1304, 'loss': 0.0207, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.9006, 'compress@10': 0.9057, 'time@10': 8.7193}:  73%|███████▎  | 22/30 [02:24<00:51,  6.49s/it]{'epoch': 34, 'num_users': 6.1304, 'loss': 0.0207, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.9006, 'compress@10': 0.9057, 'time@10': 8.7193}:  77%|███████▋  | 23/30 [02:24<00:42,  6.04s/it]{'epoch': 34, 'num_users': 5.9583, 'loss': 0.0198, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8964, 'compress@10': 0.9063, 'time@10': 8.5434}:  77%|███████▋  | 23/30 [02:29<00:42,  6.04s/it]{'epoch': 34, 'num_users': 5.9583, 'loss': 0.0198, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8964, 'compress@10': 0.9063, 'time@10': 8.5434}:  80%|████████  | 24/30 [02:29<00:33,  5.59s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0191, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8872, 'compress@10': 0.9074, 'time@10': 8.3746}:  80%|████████  | 24/30 [02:31<00:33,  5.59s/it]   {'epoch': 34, 'num_users': 5.8, 'loss': 0.0191, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8872, 'compress@10': 0.9074, 'time@10': 8.3746}:  83%|████████▎ | 25/30 [02:31<00:22,  4.57s/it]{'epoch': 34, 'num_users': 5.8077, 'loss': 0.019, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8897, 'compress@10': 0.9072, 'time@10': 8.5257}:  83%|████████▎ | 25/30 [02:43<00:22,  4.57s/it]{'epoch': 34, 'num_users': 5.8077, 'loss': 0.019, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8897, 'compress@10': 0.9072, 'time@10': 8.5257}:  87%|████████▋ | 26/30 [02:43<00:27,  6.90s/it]{'epoch': 34, 'num_users': 5.8889, 'loss': 0.0187, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.8914, 'compress@10': 0.907, 'time@10': 8.6268}:  87%|████████▋ | 26/30 [02:49<00:27,  6.90s/it]{'epoch': 34, 'num_users': 5.8889, 'loss': 0.0187, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.8914, 'compress@10': 0.907, 'time@10': 8.6268}:  90%|█████████ | 27/30 [02:49<00:19,  6.53s/it]{'epoch': 34, 'num_users': 6.0, 'loss': 0.0192, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.8935, 'compress@10': 0.9068, 'time@10': 8.7848}:  90%|█████████ | 27/30 [03:02<00:19,  6.53s/it]  {'epoch': 34, 'num_users': 6.0, 'loss': 0.0192, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.8935, 'compress@10': 0.9068, 'time@10': 8.7848}:  93%|█████████▎| 28/30 [03:02<00:16,  8.50s/it]{'epoch': 34, 'num_users': 5.8621, 'loss': 0.0188, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8955, 'compress@10': 0.9068, 'time@10': 8.8529}:  93%|█████████▎| 28/30 [03:08<00:16,  8.50s/it]{'epoch': 34, 'num_users': 5.8621, 'loss': 0.0188, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8955, 'compress@10': 0.9068, 'time@10': 8.8529}:  97%|█████████▋| 29/30 [03:08<00:07,  7.57s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.0191, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8961, 'compress@10': 0.9066, 'time@10': 8.8689}:  97%|█████████▋| 29/30 [03:17<00:07,  7.57s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.0191, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8961, 'compress@10': 0.9066, 'time@10': 8.8689}: 100%|██████████| 30/30 [03:17<00:00,  8.11s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.0191, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8961, 'compress@10': 0.9066, 'time@10': 8.8689}: 100%|██████████| 30/30 [03:17<00:00,  6.58s/it]
Epoch: 34
Avg # of users: 5.866666666666666
Avg Loss: 0.019079028203311855
Avg hit ratio: 0.8525610941816739
Avg ndcg: 0.8961018859306137
Avg compression ratio: 0.9066299297861024
Avg train time: 8.86893651485443
Std train time: 2.814684760770441
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 45, 43, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8865, 'compress@10': 0.9052, 'time@10': 9.4269}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8865, 'compress@10': 0.9052, 'time@10': 9.4269}:   3%|▎         | 1/30 [00:04<02:17,  4.75s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9192, 'compress@10': 0.9042, 'time@10': 8.6445}:   3%|▎         | 1/30 [00:12<02:17,  4.75s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9192, 'compress@10': 0.9042, 'time@10': 8.6445}:   7%|▋         | 2/30 [00:12<03:04,  6.60s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.8985, 'compress@10': 0.9076, 'time@10': 7.4753}:   7%|▋         | 2/30 [00:15<03:04,  6.60s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.8985, 'compress@10': 0.9076, 'time@10': 7.4753}:  10%|█         | 3/30 [00:15<02:08,  4.78s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9154, 'compress@10': 0.9066, 'time@10': 7.2992}:  10%|█         | 3/30 [00:22<02:08,  4.78s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9154, 'compress@10': 0.9066, 'time@10': 7.2992}:  13%|█▎        | 4/30 [00:22<02:25,  5.58s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0256, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.89, 'compress@10': 0.9057, 'time@10': 7.8937}:  13%|█▎        | 4/30 [00:27<02:25,  5.58s/it]  {'epoch': 35, 'num_users': 5.8, 'loss': 0.0256, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.89, 'compress@10': 0.9057, 'time@10': 7.8937}:  17%|█▋        | 5/30 [00:27<02:15,  5.44s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0264, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8984, 'compress@10': 0.9051, 'time@10': 8.5147}:  17%|█▋        | 5/30 [00:38<02:15,  5.44s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0264, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8984, 'compress@10': 0.9051, 'time@10': 8.5147}:  20%|██        | 6/30 [00:38<03:01,  7.55s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0261, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8957, 'compress@10': 0.9049, 'time@10': 8.7399}:  20%|██        | 6/30 [00:43<03:01,  7.55s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0261, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8957, 'compress@10': 0.9049, 'time@10': 8.7399}:  23%|██▎       | 7/30 [00:43<02:35,  6.74s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0263, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9063, 'compress@10': 0.9047, 'time@10': 8.7442}:  23%|██▎       | 7/30 [00:52<02:35,  6.74s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0263, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9063, 'compress@10': 0.9047, 'time@10': 8.7442}:  27%|██▋       | 8/30 [00:52<02:42,  7.40s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0259, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9095, 'compress@10': 0.9045, 'time@10': 8.9919}:  27%|██▋       | 8/30 [00:58<02:42,  7.40s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0259, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9095, 'compress@10': 0.9045, 'time@10': 8.9919}:  30%|███       | 9/30 [00:58<02:23,  6.81s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9154, 'compress@10': 0.9042, 'time@10': 9.1761}:  30%|███       | 9/30 [01:09<02:23,  6.81s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9154, 'compress@10': 0.9042, 'time@10': 9.1761}:  33%|███▎      | 10/30 [01:09<02:41,  8.07s/it]{'epoch': 35, 'num_users': 6.6364, 'loss': 0.0244, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9147, 'compress@10': 0.9042, 'time@10': 9.4894}:  33%|███▎      | 10/30 [01:15<02:41,  8.07s/it]{'epoch': 35, 'num_users': 6.6364, 'loss': 0.0244, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9147, 'compress@10': 0.9042, 'time@10': 9.4894}:  37%|███▋      | 11/30 [01:15<02:23,  7.54s/it]{'epoch': 35, 'num_users': 6.4167, 'loss': 0.0226, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.9148, 'compress@10': 0.9045, 'time@10': 9.1467}:  37%|███▋      | 11/30 [01:20<02:23,  7.54s/it]{'epoch': 35, 'num_users': 6.4167, 'loss': 0.0226, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.9148, 'compress@10': 0.9045, 'time@10': 9.1467}:  40%|████      | 12/30 [01:20<02:04,  6.89s/it]{'epoch': 35, 'num_users': 6.6154, 'loss': 0.0228, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.9144, 'compress@10': 0.9045, 'time@10': 9.2733}:  40%|████      | 12/30 [01:26<02:04,  6.89s/it]{'epoch': 35, 'num_users': 6.6154, 'loss': 0.0228, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.9144, 'compress@10': 0.9045, 'time@10': 9.2733}:  43%|████▎     | 13/30 [01:26<01:49,  6.45s/it]{'epoch': 35, 'num_users': 6.3571, 'loss': 0.0213, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.9086, 'compress@10': 0.9054, 'time@10': 8.9743}:  43%|████▎     | 13/30 [01:31<01:49,  6.45s/it]{'epoch': 35, 'num_users': 6.3571, 'loss': 0.0213, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.9086, 'compress@10': 0.9054, 'time@10': 8.9743}:  47%|████▋     | 14/30 [01:31<01:36,  6.05s/it]{'epoch': 35, 'num_users': 6.2667, 'loss': 0.0216, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.9083, 'compress@10': 0.9053, 'time@10': 9.2001}:  47%|████▋     | 14/30 [01:37<01:36,  6.05s/it]{'epoch': 35, 'num_users': 6.2667, 'loss': 0.0216, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.9083, 'compress@10': 0.9053, 'time@10': 9.2001}:  50%|█████     | 15/30 [01:37<01:31,  6.10s/it]{'epoch': 35, 'num_users': 6.0625, 'loss': 0.0203, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.9088, 'compress@10': 0.9055, 'time@10': 8.9677}:  50%|█████     | 15/30 [01:43<01:31,  6.10s/it]{'epoch': 35, 'num_users': 6.0625, 'loss': 0.0203, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.9088, 'compress@10': 0.9055, 'time@10': 8.9677}:  53%|█████▎    | 16/30 [01:43<01:22,  5.92s/it]{'epoch': 35, 'num_users': 5.8235, 'loss': 0.0192, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.9007, 'compress@10': 0.9063, 'time@10': 8.7637}:  53%|█████▎    | 16/30 [01:46<01:22,  5.92s/it]{'epoch': 35, 'num_users': 5.8235, 'loss': 0.0192, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.9007, 'compress@10': 0.9063, 'time@10': 8.7637}:  57%|█████▋    | 17/30 [01:46<01:04,  4.98s/it]{'epoch': 35, 'num_users': 6.0556, 'loss': 0.0192, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.902, 'compress@10': 0.9062, 'time@10': 8.6631}:  57%|█████▋    | 17/30 [01:53<01:04,  4.98s/it] {'epoch': 35, 'num_users': 6.0556, 'loss': 0.0192, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.902, 'compress@10': 0.9062, 'time@10': 8.6631}:  60%|██████    | 18/30 [01:53<01:07,  5.58s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 0.0189, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.9025, 'compress@10': 0.9062, 'time@10': 8.563}:  60%|██████    | 18/30 [01:56<01:07,  5.58s/it]   {'epoch': 35, 'num_users': 6.0, 'loss': 0.0189, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.9025, 'compress@10': 0.9062, 'time@10': 8.563}:  63%|██████▎   | 19/30 [01:56<00:54,  4.93s/it]{'epoch': 35, 'num_users': 6.15, 'loss': 0.0192, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.9038, 'compress@10': 0.906, 'time@10': 8.7831}:  63%|██████▎   | 19/30 [02:09<00:54,  4.93s/it]{'epoch': 35, 'num_users': 6.15, 'loss': 0.0192, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.9038, 'compress@10': 0.906, 'time@10': 8.7831}:  67%|██████▋   | 20/30 [02:09<01:13,  7.36s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.9009, 'compress@10': 0.9058, 'time@10': 8.8459}:  67%|██████▋   | 20/30 [02:14<01:13,  7.36s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.9009, 'compress@10': 0.9058, 'time@10': 8.8459}:  70%|███████   | 21/30 [02:14<01:00,  6.67s/it]{'epoch': 35, 'num_users': 6.1818, 'loss': 0.0207, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.9011, 'compress@10': 0.9058, 'time@10': 8.7106}:  70%|███████   | 21/30 [02:20<01:00,  6.67s/it]{'epoch': 35, 'num_users': 6.1818, 'loss': 0.0207, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.9011, 'compress@10': 0.9058, 'time@10': 8.7106}:  73%|███████▎  | 22/30 [02:20<00:51,  6.44s/it]{'epoch': 35, 'num_users': 6.1304, 'loss': 0.0203, 'hit_ratio@10': 0.851, 'ndcg@10': 0.9021, 'compress@10': 0.9057, 'time@10': 8.7538}:  73%|███████▎  | 22/30 [02:25<00:51,  6.44s/it] {'epoch': 35, 'num_users': 6.1304, 'loss': 0.0203, 'hit_ratio@10': 0.851, 'ndcg@10': 0.9021, 'compress@10': 0.9057, 'time@10': 8.7538}:  77%|███████▋  | 23/30 [02:25<00:41,  5.98s/it]{'epoch': 35, 'num_users': 5.9583, 'loss': 0.0195, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.8978, 'compress@10': 0.9063, 'time@10': 8.5803}:  77%|███████▋  | 23/30 [02:29<00:41,  5.98s/it]{'epoch': 35, 'num_users': 5.9583, 'loss': 0.0195, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.8978, 'compress@10': 0.9063, 'time@10': 8.5803}:  80%|████████  | 24/30 [02:29<00:33,  5.57s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0188, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8886, 'compress@10': 0.9074, 'time@10': 8.4123}:  80%|████████  | 24/30 [02:32<00:33,  5.57s/it]   {'epoch': 35, 'num_users': 5.8, 'loss': 0.0188, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8886, 'compress@10': 0.9074, 'time@10': 8.4123}:  83%|████████▎ | 25/30 [02:32<00:22,  4.57s/it]{'epoch': 35, 'num_users': 5.8077, 'loss': 0.0187, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8912, 'compress@10': 0.9072, 'time@10': 8.5632}:  83%|████████▎ | 25/30 [02:44<00:22,  4.57s/it]{'epoch': 35, 'num_users': 5.8077, 'loss': 0.0187, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8912, 'compress@10': 0.9072, 'time@10': 8.5632}:  87%|████████▋ | 26/30 [02:44<00:27,  6.91s/it]{'epoch': 35, 'num_users': 5.8889, 'loss': 0.0185, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8927, 'compress@10': 0.907, 'time@10': 8.6619}:  87%|████████▋ | 26/30 [02:50<00:27,  6.91s/it] {'epoch': 35, 'num_users': 5.8889, 'loss': 0.0185, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8927, 'compress@10': 0.907, 'time@10': 8.6619}:  90%|█████████ | 27/30 [02:50<00:19,  6.53s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 0.0187, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8963, 'compress@10': 0.9068, 'time@10': 8.8209}:  90%|█████████ | 27/30 [03:03<00:19,  6.53s/it]  {'epoch': 35, 'num_users': 6.0, 'loss': 0.0187, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8963, 'compress@10': 0.9068, 'time@10': 8.8209}:  93%|█████████▎| 28/30 [03:03<00:17,  8.52s/it]{'epoch': 35, 'num_users': 5.8621, 'loss': 0.0183, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8982, 'compress@10': 0.9068, 'time@10': 8.8863}:  93%|█████████▎| 28/30 [03:08<00:17,  8.52s/it]{'epoch': 35, 'num_users': 5.8621, 'loss': 0.0183, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8982, 'compress@10': 0.9068, 'time@10': 8.8863}:  97%|█████████▋| 29/30 [03:08<00:07,  7.58s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0187, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8982, 'compress@10': 0.9066, 'time@10': 8.8951}:  97%|█████████▋| 29/30 [03:17<00:07,  7.58s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0187, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8982, 'compress@10': 0.9066, 'time@10': 8.8951}: 100%|██████████| 30/30 [03:17<00:00,  8.06s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0187, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8982, 'compress@10': 0.9066, 'time@10': 8.8951}: 100%|██████████| 30/30 [03:17<00:00,  6.60s/it]
Epoch: 35
Avg # of users: 5.866666666666666
Avg Loss: 0.018693863498071887
Avg hit ratio: 0.8581230080717612
Avg ndcg: 0.8982331762355275
Avg compression ratio: 0.9066299250683169
Avg train time: 8.895116400718688
Std train time: 2.7805089104495853
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 46, 44, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8895, 'compress@10': 0.9052, 'time@10': 9.4594}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8895, 'compress@10': 0.9052, 'time@10': 9.4594}:   3%|▎         | 1/30 [00:04<02:18,  4.77s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9173, 'compress@10': 0.9042, 'time@10': 8.6868}:   3%|▎         | 1/30 [00:12<02:18,  4.77s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9173, 'compress@10': 0.9042, 'time@10': 8.6868}:   7%|▋         | 2/30 [00:12<03:05,  6.64s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8972, 'compress@10': 0.9076, 'time@10': 7.5621}:   7%|▋         | 2/30 [00:15<03:05,  6.64s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8972, 'compress@10': 0.9076, 'time@10': 7.5621}:  10%|█         | 3/30 [00:15<02:10,  4.84s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9226, 'compress@10': 0.9066, 'time@10': 7.4014}:  10%|█         | 3/30 [00:22<02:10,  4.84s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9226, 'compress@10': 0.9066, 'time@10': 7.4014}:  13%|█▎        | 4/30 [00:22<02:27,  5.67s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0255, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8956, 'compress@10': 0.9057, 'time@10': 7.9508}:  13%|█▎        | 4/30 [00:27<02:27,  5.67s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0255, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8956, 'compress@10': 0.9057, 'time@10': 7.9508}:  17%|█▋        | 5/30 [00:27<02:16,  5.47s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.9039, 'compress@10': 0.9051, 'time@10': 8.5724}:  17%|█▋        | 5/30 [00:39<02:16,  5.47s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.9039, 'compress@10': 0.9051, 'time@10': 8.5724}:  20%|██        | 6/30 [00:39<03:02,  7.59s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.024, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9002, 'compress@10': 0.9049, 'time@10': 8.7629}:  20%|██        | 6/30 [00:44<03:02,  7.59s/it] {'epoch': 36, 'num_users': 6.2857, 'loss': 0.024, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9002, 'compress@10': 0.9049, 'time@10': 8.7629}:  23%|██▎       | 7/30 [00:44<02:35,  6.74s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0245, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9093, 'compress@10': 0.9047, 'time@10': 8.7825}:  23%|██▎       | 7/30 [00:53<02:35,  6.74s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0245, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9093, 'compress@10': 0.9047, 'time@10': 8.7825}:  27%|██▋       | 8/30 [00:53<02:43,  7.45s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9121, 'compress@10': 0.9045, 'time@10': 9.0108}:  27%|██▋       | 8/30 [00:58<02:43,  7.45s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9121, 'compress@10': 0.9045, 'time@10': 9.0108}:  30%|███       | 9/30 [00:58<02:23,  6.82s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.025, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9152, 'compress@10': 0.9042, 'time@10': 9.2019}:  30%|███       | 9/30 [01:09<02:23,  6.82s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 0.025, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9152, 'compress@10': 0.9042, 'time@10': 9.2019}:  33%|███▎      | 10/30 [01:09<02:42,  8.10s/it]{'epoch': 36, 'num_users': 6.6364, 'loss': 0.0256, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9145, 'compress@10': 0.9042, 'time@10': 9.5358}:  33%|███▎      | 10/30 [01:16<02:42,  8.10s/it]{'epoch': 36, 'num_users': 6.6364, 'loss': 0.0256, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9145, 'compress@10': 0.9042, 'time@10': 9.5358}:  37%|███▋      | 11/30 [01:16<02:24,  7.60s/it]{'epoch': 36, 'num_users': 6.4167, 'loss': 0.0238, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.9147, 'compress@10': 0.9045, 'time@10': 9.1835}:  37%|███▋      | 11/30 [01:21<02:24,  7.60s/it]{'epoch': 36, 'num_users': 6.4167, 'loss': 0.0238, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.9147, 'compress@10': 0.9045, 'time@10': 9.1835}:  40%|████      | 12/30 [01:21<02:04,  6.92s/it]{'epoch': 36, 'num_users': 6.6154, 'loss': 0.0238, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.9143, 'compress@10': 0.9045, 'time@10': 9.3189}:  40%|████      | 12/30 [01:26<02:04,  6.92s/it]{'epoch': 36, 'num_users': 6.6154, 'loss': 0.0238, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.9143, 'compress@10': 0.9045, 'time@10': 9.3189}:  43%|████▎     | 13/30 [01:26<01:50,  6.49s/it]{'epoch': 36, 'num_users': 6.3571, 'loss': 0.0222, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.9085, 'compress@10': 0.9054, 'time@10': 9.0139}:  43%|████▎     | 13/30 [01:31<01:50,  6.49s/it]{'epoch': 36, 'num_users': 6.3571, 'loss': 0.0222, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.9085, 'compress@10': 0.9054, 'time@10': 9.0139}:  47%|████▋     | 14/30 [01:31<01:37,  6.07s/it]{'epoch': 36, 'num_users': 6.2667, 'loss': 0.022, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.909, 'compress@10': 0.9053, 'time@10': 9.2421}:  47%|████▋     | 14/30 [01:38<01:37,  6.07s/it]  {'epoch': 36, 'num_users': 6.2667, 'loss': 0.022, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.909, 'compress@10': 0.9053, 'time@10': 9.2421}:  50%|█████     | 15/30 [01:38<01:31,  6.12s/it]{'epoch': 36, 'num_users': 6.0625, 'loss': 0.0207, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.9095, 'compress@10': 0.9055, 'time@10': 9.0148}:  50%|█████     | 15/30 [01:43<01:31,  6.12s/it]{'epoch': 36, 'num_users': 6.0625, 'loss': 0.0207, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.9095, 'compress@10': 0.9055, 'time@10': 9.0148}:  53%|█████▎    | 16/30 [01:43<01:23,  5.98s/it]{'epoch': 36, 'num_users': 5.8235, 'loss': 0.0196, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.9014, 'compress@10': 0.9063, 'time@10': 8.795}:  53%|█████▎    | 16/30 [01:46<01:23,  5.98s/it] {'epoch': 36, 'num_users': 5.8235, 'loss': 0.0196, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.9014, 'compress@10': 0.9063, 'time@10': 8.795}:  57%|█████▋    | 17/30 [01:46<01:04,  4.99s/it]{'epoch': 36, 'num_users': 6.0556, 'loss': 0.0193, 'hit_ratio@10': 0.83, 'ndcg@10': 0.9035, 'compress@10': 0.9062, 'time@10': 8.6955}:  57%|█████▋    | 17/30 [01:53<01:04,  4.99s/it] {'epoch': 36, 'num_users': 6.0556, 'loss': 0.0193, 'hit_ratio@10': 0.83, 'ndcg@10': 0.9035, 'compress@10': 0.9062, 'time@10': 8.6955}:  60%|██████    | 18/30 [01:53<01:07,  5.60s/it]{'epoch': 36, 'num_users': 6.0, 'loss': 0.0187, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.9045, 'compress@10': 0.9062, 'time@10': 8.5901}:  60%|██████    | 18/30 [01:56<01:07,  5.60s/it] {'epoch': 36, 'num_users': 6.0, 'loss': 0.0187, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.9045, 'compress@10': 0.9062, 'time@10': 8.5901}:  63%|██████▎   | 19/30 [01:56<00:54,  4.94s/it]{'epoch': 36, 'num_users': 6.15, 'loss': 0.0188, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.9065, 'compress@10': 0.906, 'time@10': 8.819}:  63%|██████▎   | 19/30 [02:10<00:54,  4.94s/it] {'epoch': 36, 'num_users': 6.15, 'loss': 0.0188, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.9065, 'compress@10': 0.906, 'time@10': 8.819}:  67%|██████▋   | 20/30 [02:10<01:14,  7.42s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.9038, 'compress@10': 0.9058, 'time@10': 8.8809}:  67%|██████▋   | 20/30 [02:15<01:14,  7.42s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.9038, 'compress@10': 0.9058, 'time@10': 8.8809}:  70%|███████   | 21/30 [02:15<01:00,  6.72s/it]{'epoch': 36, 'num_users': 6.1818, 'loss': 0.0205, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9043, 'compress@10': 0.9058, 'time@10': 8.7361}:  70%|███████   | 21/30 [02:21<01:00,  6.72s/it]{'epoch': 36, 'num_users': 6.1818, 'loss': 0.0205, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9043, 'compress@10': 0.9058, 'time@10': 8.7361}:  73%|███████▎  | 22/30 [02:21<00:51,  6.42s/it]{'epoch': 36, 'num_users': 6.1304, 'loss': 0.0201, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9053, 'compress@10': 0.9057, 'time@10': 8.7707}:  73%|███████▎  | 22/30 [02:25<00:51,  6.42s/it]{'epoch': 36, 'num_users': 6.1304, 'loss': 0.0201, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9053, 'compress@10': 0.9057, 'time@10': 8.7707}:  77%|███████▋  | 23/30 [02:25<00:41,  5.94s/it]{'epoch': 36, 'num_users': 5.9583, 'loss': 0.0193, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.9009, 'compress@10': 0.9063, 'time@10': 8.6067}:  77%|███████▋  | 23/30 [02:30<00:41,  5.94s/it]{'epoch': 36, 'num_users': 5.9583, 'loss': 0.0193, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.9009, 'compress@10': 0.9063, 'time@10': 8.6067}:  80%|████████  | 24/30 [02:30<00:33,  5.62s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0186, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8916, 'compress@10': 0.9074, 'time@10': 8.4481}:  80%|████████  | 24/30 [02:33<00:33,  5.62s/it]   {'epoch': 36, 'num_users': 5.8, 'loss': 0.0186, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8916, 'compress@10': 0.9074, 'time@10': 8.4481}:  83%|████████▎ | 25/30 [02:33<00:23,  4.64s/it]{'epoch': 36, 'num_users': 5.8077, 'loss': 0.0185, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8941, 'compress@10': 0.9072, 'time@10': 8.5978}:  83%|████████▎ | 25/30 [02:45<00:23,  4.64s/it]{'epoch': 36, 'num_users': 5.8077, 'loss': 0.0185, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8941, 'compress@10': 0.9072, 'time@10': 8.5978}:  87%|████████▋ | 26/30 [02:45<00:27,  6.96s/it]{'epoch': 36, 'num_users': 5.8889, 'loss': 0.0183, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8955, 'compress@10': 0.907, 'time@10': 8.6987}:  87%|████████▋ | 26/30 [02:51<00:27,  6.96s/it] {'epoch': 36, 'num_users': 5.8889, 'loss': 0.0183, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8955, 'compress@10': 0.907, 'time@10': 8.6987}:  90%|█████████ | 27/30 [02:51<00:19,  6.58s/it]{'epoch': 36, 'num_users': 6.0, 'loss': 0.0179, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8983, 'compress@10': 0.9068, 'time@10': 8.8542}:  90%|█████████ | 27/30 [03:04<00:19,  6.58s/it]  {'epoch': 36, 'num_users': 6.0, 'loss': 0.0179, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8983, 'compress@10': 0.9068, 'time@10': 8.8542}:  93%|█████████▎| 28/30 [03:04<00:17,  8.53s/it]{'epoch': 36, 'num_users': 5.8621, 'loss': 0.0176, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9001, 'compress@10': 0.9068, 'time@10': 8.9225}:  93%|█████████▎| 28/30 [03:09<00:17,  8.53s/it]{'epoch': 36, 'num_users': 5.8621, 'loss': 0.0176, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9001, 'compress@10': 0.9068, 'time@10': 8.9225}:  97%|█████████▋| 29/30 [03:09<00:07,  7.61s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0178, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.9008, 'compress@10': 0.9066, 'time@10': 8.9328}:  97%|█████████▋| 29/30 [03:18<00:07,  7.61s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0178, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.9008, 'compress@10': 0.9066, 'time@10': 8.9328}: 100%|██████████| 30/30 [03:18<00:00,  8.11s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0178, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.9008, 'compress@10': 0.9066, 'time@10': 8.9328}: 100%|██████████| 30/30 [03:18<00:00,  6.63s/it]
Epoch: 36
Avg # of users: 5.866666666666666
Avg Loss: 0.017813432623039787
Avg hit ratio: 0.8575605282987552
Avg ndcg: 0.9007882579750869
Avg compression ratio: 0.9066299176795816
Avg train time: 8.93276069164276
Std train time: 2.784816363372136
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 46, 45, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8865, 'compress@10': 0.9052, 'time@10': 9.5735}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8865, 'compress@10': 0.9052, 'time@10': 9.5735}:   3%|▎         | 1/30 [00:04<02:20,  4.83s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9115, 'compress@10': 0.9042, 'time@10': 8.7867}:   3%|▎         | 1/30 [00:12<02:20,  4.83s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9115, 'compress@10': 0.9042, 'time@10': 8.7867}:   7%|▋         | 2/30 [00:12<03:08,  6.72s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8934, 'compress@10': 0.9076, 'time@10': 7.6052}:   7%|▋         | 2/30 [00:15<03:08,  6.72s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8934, 'compress@10': 0.9076, 'time@10': 7.6052}:  10%|█         | 3/30 [00:15<02:11,  4.86s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9145, 'compress@10': 0.9066, 'time@10': 7.4253}:  10%|█         | 3/30 [00:22<02:11,  4.86s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9145, 'compress@10': 0.9066, 'time@10': 7.4253}:  13%|█▎        | 4/30 [00:22<02:27,  5.68s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0269, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8893, 'compress@10': 0.9057, 'time@10': 7.9374}:  13%|█▎        | 4/30 [00:27<02:27,  5.68s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0269, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8893, 'compress@10': 0.9057, 'time@10': 7.9374}:  17%|█▋        | 5/30 [00:27<02:16,  5.44s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0251, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8998, 'compress@10': 0.9051, 'time@10': 8.5661}:  17%|█▋        | 5/30 [00:39<02:16,  5.44s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0251, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8998, 'compress@10': 0.9051, 'time@10': 8.5661}:  20%|██        | 6/30 [00:39<03:02,  7.59s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0249, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8981, 'compress@10': 0.9049, 'time@10': 8.8038}:  20%|██        | 6/30 [00:44<03:02,  7.59s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0249, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8981, 'compress@10': 0.9049, 'time@10': 8.8038}:  23%|██▎       | 7/30 [00:44<02:36,  6.79s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0253, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9072, 'compress@10': 0.9047, 'time@10': 8.802}:  23%|██▎       | 7/30 [00:53<02:36,  6.79s/it]  {'epoch': 37, 'num_users': 6.125, 'loss': 0.0253, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9072, 'compress@10': 0.9047, 'time@10': 8.802}:  27%|██▋       | 8/30 [00:53<02:43,  7.44s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.9105, 'compress@10': 0.9045, 'time@10': 9.0037}:  27%|██▋       | 8/30 [00:58<02:43,  7.44s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.9105, 'compress@10': 0.9045, 'time@10': 9.0037}:  30%|███       | 9/30 [00:58<02:22,  6.78s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.9165, 'compress@10': 0.9042, 'time@10': 9.2077}:  30%|███       | 9/30 [01:09<02:22,  6.78s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.9165, 'compress@10': 0.9042, 'time@10': 9.2077}:  33%|███▎      | 10/30 [01:09<02:42,  8.11s/it]{'epoch': 37, 'num_users': 6.6364, 'loss': 0.0243, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.916, 'compress@10': 0.9042, 'time@10': 9.5317}:  33%|███▎      | 10/30 [01:16<02:42,  8.11s/it]{'epoch': 37, 'num_users': 6.6364, 'loss': 0.0243, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.916, 'compress@10': 0.9042, 'time@10': 9.5317}:  37%|███▋      | 11/30 [01:16<02:24,  7.59s/it]{'epoch': 37, 'num_users': 6.4167, 'loss': 0.0225, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.916, 'compress@10': 0.9045, 'time@10': 9.19}:  37%|███▋      | 11/30 [01:21<02:24,  7.59s/it]  {'epoch': 37, 'num_users': 6.4167, 'loss': 0.0225, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.916, 'compress@10': 0.9045, 'time@10': 9.19}:  40%|████      | 12/30 [01:21<02:05,  6.95s/it]{'epoch': 37, 'num_users': 6.6154, 'loss': 0.0226, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.9155, 'compress@10': 0.9045, 'time@10': 9.2943}:  40%|████      | 12/30 [01:26<02:05,  6.95s/it]{'epoch': 37, 'num_users': 6.6154, 'loss': 0.0226, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.9155, 'compress@10': 0.9045, 'time@10': 9.2943}:  43%|████▎     | 13/30 [01:26<01:49,  6.45s/it]{'epoch': 37, 'num_users': 6.3571, 'loss': 0.0211, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9096, 'compress@10': 0.9054, 'time@10': 8.9852}:  43%|████▎     | 13/30 [01:31<01:49,  6.45s/it]{'epoch': 37, 'num_users': 6.3571, 'loss': 0.0211, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9096, 'compress@10': 0.9054, 'time@10': 8.9852}:  47%|████▋     | 14/30 [01:31<01:36,  6.01s/it]{'epoch': 37, 'num_users': 6.2667, 'loss': 0.0216, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.9091, 'compress@10': 0.9053, 'time@10': 9.239}:  47%|████▋     | 14/30 [01:38<01:36,  6.01s/it] {'epoch': 37, 'num_users': 6.2667, 'loss': 0.0216, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.9091, 'compress@10': 0.9053, 'time@10': 9.239}:  50%|█████     | 15/30 [01:38<01:32,  6.14s/it]{'epoch': 37, 'num_users': 6.0625, 'loss': 0.0204, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9095, 'compress@10': 0.9055, 'time@10': 9.0027}:  50%|█████     | 15/30 [01:43<01:32,  6.14s/it]{'epoch': 37, 'num_users': 6.0625, 'loss': 0.0204, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9095, 'compress@10': 0.9055, 'time@10': 9.0027}:  53%|█████▎    | 16/30 [01:43<01:23,  5.95s/it]{'epoch': 37, 'num_users': 5.8235, 'loss': 0.0192, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.9014, 'compress@10': 0.9063, 'time@10': 8.7796}:  53%|█████▎    | 16/30 [01:46<01:23,  5.95s/it]{'epoch': 37, 'num_users': 5.8235, 'loss': 0.0192, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.9014, 'compress@10': 0.9063, 'time@10': 8.7796}:  57%|█████▋    | 17/30 [01:46<01:04,  4.95s/it]{'epoch': 37, 'num_users': 6.0556, 'loss': 0.019, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.9032, 'compress@10': 0.9062, 'time@10': 8.6931}:  57%|█████▋    | 17/30 [01:53<01:04,  4.95s/it] {'epoch': 37, 'num_users': 6.0556, 'loss': 0.019, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.9032, 'compress@10': 0.9062, 'time@10': 8.6931}:  60%|██████    | 18/30 [01:53<01:07,  5.65s/it]{'epoch': 37, 'num_users': 6.0, 'loss': 0.0186, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.904, 'compress@10': 0.9062, 'time@10': 8.5854}:  60%|██████    | 18/30 [01:57<01:07,  5.65s/it]   {'epoch': 37, 'num_users': 6.0, 'loss': 0.0186, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.904, 'compress@10': 0.9062, 'time@10': 8.5854}:  63%|██████▎   | 19/30 [01:57<00:54,  4.96s/it]{'epoch': 37, 'num_users': 6.15, 'loss': 0.0191, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9056, 'compress@10': 0.906, 'time@10': 8.8136}:  63%|██████▎   | 19/30 [02:10<00:54,  4.96s/it]{'epoch': 37, 'num_users': 6.15, 'loss': 0.0191, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9056, 'compress@10': 0.906, 'time@10': 8.8136}:  67%|██████▋   | 20/30 [02:10<01:14,  7.43s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9029, 'compress@10': 0.9058, 'time@10': 8.8618}:  67%|██████▋   | 20/30 [02:15<01:14,  7.43s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9029, 'compress@10': 0.9058, 'time@10': 8.8618}:  70%|███████   | 21/30 [02:15<01:00,  6.69s/it]{'epoch': 37, 'num_users': 6.1818, 'loss': 0.0205, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9041, 'compress@10': 0.9058, 'time@10': 8.7297}:  70%|███████   | 21/30 [02:21<01:00,  6.69s/it]{'epoch': 37, 'num_users': 6.1818, 'loss': 0.0205, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9041, 'compress@10': 0.9058, 'time@10': 8.7297}:  73%|███████▎  | 22/30 [02:21<00:51,  6.48s/it]{'epoch': 37, 'num_users': 6.1304, 'loss': 0.0201, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.9051, 'compress@10': 0.9057, 'time@10': 8.7671}:  73%|███████▎  | 22/30 [02:25<00:51,  6.48s/it]{'epoch': 37, 'num_users': 6.1304, 'loss': 0.0201, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.9051, 'compress@10': 0.9057, 'time@10': 8.7671}:  77%|███████▋  | 23/30 [02:25<00:41,  5.98s/it]{'epoch': 37, 'num_users': 5.9583, 'loss': 0.0193, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9007, 'compress@10': 0.9063, 'time@10': 8.5952}:  77%|███████▋  | 23/30 [02:30<00:41,  5.98s/it]{'epoch': 37, 'num_users': 5.9583, 'loss': 0.0193, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9007, 'compress@10': 0.9063, 'time@10': 8.5952}:  80%|████████  | 24/30 [02:30<00:33,  5.60s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0186, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8914, 'compress@10': 0.9074, 'time@10': 8.4486}:  80%|████████  | 24/30 [02:33<00:33,  5.60s/it]   {'epoch': 37, 'num_users': 5.8, 'loss': 0.0186, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8914, 'compress@10': 0.9074, 'time@10': 8.4486}:  83%|████████▎ | 25/30 [02:33<00:23,  4.67s/it]{'epoch': 37, 'num_users': 5.8077, 'loss': 0.0184, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.894, 'compress@10': 0.9072, 'time@10': 8.6152}:  83%|████████▎ | 25/30 [02:46<00:23,  4.67s/it]{'epoch': 37, 'num_users': 5.8077, 'loss': 0.0184, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.894, 'compress@10': 0.9072, 'time@10': 8.6152}:  87%|████████▋ | 26/30 [02:46<00:28,  7.12s/it]{'epoch': 37, 'num_users': 5.8889, 'loss': 0.0181, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8955, 'compress@10': 0.907, 'time@10': 8.7239}:  87%|████████▋ | 26/30 [02:51<00:28,  7.12s/it]{'epoch': 37, 'num_users': 5.8889, 'loss': 0.0181, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8955, 'compress@10': 0.907, 'time@10': 8.7239}:  90%|█████████ | 27/30 [02:51<00:20,  6.73s/it]{'epoch': 37, 'num_users': 6.0, 'loss': 0.0184, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8976, 'compress@10': 0.9068, 'time@10': 8.8861}:  90%|█████████ | 27/30 [03:05<00:20,  6.73s/it]   {'epoch': 37, 'num_users': 6.0, 'loss': 0.0184, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8976, 'compress@10': 0.9068, 'time@10': 8.8861}:  93%|█████████▎| 28/30 [03:05<00:17,  8.70s/it]{'epoch': 37, 'num_users': 5.8621, 'loss': 0.0181, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8995, 'compress@10': 0.9068, 'time@10': 8.958}:  93%|█████████▎| 28/30 [03:10<00:17,  8.70s/it]{'epoch': 37, 'num_users': 5.8621, 'loss': 0.0181, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8995, 'compress@10': 0.9068, 'time@10': 8.958}:  97%|█████████▋| 29/30 [03:10<00:07,  7.75s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0181, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.9006, 'compress@10': 0.9066, 'time@10': 8.9626}:  97%|█████████▋| 29/30 [03:19<00:07,  7.75s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0181, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.9006, 'compress@10': 0.9066, 'time@10': 8.9626}: 100%|██████████| 30/30 [03:19<00:00,  8.16s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0181, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.9006, 'compress@10': 0.9066, 'time@10': 8.9626}: 100%|██████████| 30/30 [03:19<00:00,  6.66s/it]
Epoch: 37
Avg # of users: 5.866666666666666
Avg Loss: 0.01812552679460085
Avg hit ratio: 0.8558455340837609
Avg ndcg: 0.900553621008919
Avg compression ratio: 0.9066299419868543
Avg train time: 8.962572010358175
Std train time: 2.8173620309067617
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 47, 45, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 0.9052, 'time@10': 9.5027}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 0.9052, 'time@10': 9.5027}:   3%|▎         | 1/30 [00:04<02:18,  4.79s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9108, 'compress@10': 0.9042, 'time@10': 8.6795}:   3%|▎         | 1/30 [00:12<02:18,  4.79s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9108, 'compress@10': 0.9042, 'time@10': 8.6795}:   7%|▋         | 2/30 [00:12<03:05,  6.61s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8929, 'compress@10': 0.9076, 'time@10': 7.5745}:   7%|▋         | 2/30 [00:15<03:05,  6.61s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8929, 'compress@10': 0.9076, 'time@10': 7.5745}:  10%|█         | 3/30 [00:15<02:10,  4.83s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9019, 'compress@10': 0.9066, 'time@10': 7.4044}:  10%|█         | 3/30 [00:22<02:10,  4.83s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9019, 'compress@10': 0.9066, 'time@10': 7.4044}:  13%|█▎        | 4/30 [00:22<02:27,  5.67s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0291, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8797, 'compress@10': 0.9057, 'time@10': 7.8778}:  13%|█▎        | 4/30 [00:27<02:27,  5.67s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0291, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8797, 'compress@10': 0.9057, 'time@10': 7.8778}:  17%|█▋        | 5/30 [00:27<02:14,  5.40s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0293, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8891, 'compress@10': 0.9051, 'time@10': 8.5199}:  17%|█▋        | 5/30 [00:39<02:14,  5.40s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0293, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8891, 'compress@10': 0.9051, 'time@10': 8.5199}:  20%|██        | 6/30 [00:39<03:01,  7.56s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0285, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8887, 'compress@10': 0.9049, 'time@10': 8.7567}:  20%|██        | 6/30 [00:44<03:01,  7.56s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0285, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8887, 'compress@10': 0.9049, 'time@10': 8.7567}:  23%|██▎       | 7/30 [00:44<02:35,  6.77s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0285, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9, 'compress@10': 0.9047, 'time@10': 8.7643}:  23%|██▎       | 7/30 [00:53<02:35,  6.77s/it]    {'epoch': 38, 'num_users': 6.125, 'loss': 0.0285, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9, 'compress@10': 0.9047, 'time@10': 8.7643}:  27%|██▋       | 8/30 [00:53<02:43,  7.43s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.9041, 'compress@10': 0.9045, 'time@10': 8.9619}:  27%|██▋       | 8/30 [00:58<02:43,  7.43s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.9041, 'compress@10': 0.9045, 'time@10': 8.9619}:  30%|███       | 9/30 [00:58<02:22,  6.77s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9108, 'compress@10': 0.9042, 'time@10': 9.175}:  30%|███       | 9/30 [01:09<02:22,  6.77s/it]     {'epoch': 38, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9108, 'compress@10': 0.9042, 'time@10': 9.175}:  33%|███▎      | 10/30 [01:09<02:42,  8.11s/it]{'epoch': 38, 'num_users': 6.6364, 'loss': 0.028, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9108, 'compress@10': 0.9042, 'time@10': 9.5108}:  33%|███▎      | 10/30 [01:15<02:42,  8.11s/it]{'epoch': 38, 'num_users': 6.6364, 'loss': 0.028, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9108, 'compress@10': 0.9042, 'time@10': 9.5108}:  37%|███▋      | 11/30 [01:15<02:24,  7.61s/it]{'epoch': 38, 'num_users': 6.4167, 'loss': 0.0259, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.9113, 'compress@10': 0.9045, 'time@10': 9.1611}:  37%|███▋      | 11/30 [01:21<02:24,  7.61s/it]{'epoch': 38, 'num_users': 6.4167, 'loss': 0.0259, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.9113, 'compress@10': 0.9045, 'time@10': 9.1611}:  40%|████      | 12/30 [01:21<02:04,  6.92s/it]{'epoch': 38, 'num_users': 6.6154, 'loss': 0.0258, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.9111, 'compress@10': 0.9045, 'time@10': 9.3033}:  40%|████      | 12/30 [01:26<02:04,  6.92s/it]{'epoch': 38, 'num_users': 6.6154, 'loss': 0.0258, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.9111, 'compress@10': 0.9045, 'time@10': 9.3033}:  43%|████▎     | 13/30 [01:26<01:50,  6.50s/it]{'epoch': 38, 'num_users': 6.3571, 'loss': 0.024, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9056, 'compress@10': 0.9054, 'time@10': 8.9833}:  43%|████▎     | 13/30 [01:31<01:50,  6.50s/it] {'epoch': 38, 'num_users': 6.3571, 'loss': 0.024, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9056, 'compress@10': 0.9054, 'time@10': 8.9833}:  47%|████▋     | 14/30 [01:31<01:36,  6.01s/it]{'epoch': 38, 'num_users': 6.2667, 'loss': 0.0234, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.9071, 'compress@10': 0.9053, 'time@10': 9.2052}:  47%|████▋     | 14/30 [01:37<01:36,  6.01s/it]{'epoch': 38, 'num_users': 6.2667, 'loss': 0.0234, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.9071, 'compress@10': 0.9053, 'time@10': 9.2052}:  50%|█████     | 15/30 [01:37<01:30,  6.06s/it]{'epoch': 38, 'num_users': 6.0625, 'loss': 0.022, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.9077, 'compress@10': 0.9055, 'time@10': 8.9655}:  50%|█████     | 15/30 [01:43<01:30,  6.06s/it] {'epoch': 38, 'num_users': 6.0625, 'loss': 0.022, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.9077, 'compress@10': 0.9055, 'time@10': 8.9655}:  53%|█████▎    | 16/30 [01:43<01:22,  5.87s/it]{'epoch': 38, 'num_users': 5.8235, 'loss': 0.0208, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8996, 'compress@10': 0.9063, 'time@10': 8.7589}:  53%|█████▎    | 16/30 [01:46<01:22,  5.87s/it]{'epoch': 38, 'num_users': 5.8235, 'loss': 0.0208, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8996, 'compress@10': 0.9063, 'time@10': 8.7589}:  57%|█████▋    | 17/30 [01:46<01:04,  4.93s/it]{'epoch': 38, 'num_users': 6.0556, 'loss': 0.0207, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.9019, 'compress@10': 0.9062, 'time@10': 8.6756}:  57%|█████▋    | 17/30 [01:53<01:04,  4.93s/it]{'epoch': 38, 'num_users': 6.0556, 'loss': 0.0207, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.9019, 'compress@10': 0.9062, 'time@10': 8.6756}:  60%|██████    | 18/30 [01:53<01:07,  5.64s/it]{'epoch': 38, 'num_users': 6.0, 'loss': 0.02, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.9031, 'compress@10': 0.9062, 'time@10': 8.5677}:  60%|██████    | 18/30 [01:56<01:07,  5.64s/it]     {'epoch': 38, 'num_users': 6.0, 'loss': 0.02, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.9031, 'compress@10': 0.9062, 'time@10': 8.5677}:  63%|██████▎   | 19/30 [01:56<00:54,  4.95s/it]{'epoch': 38, 'num_users': 6.15, 'loss': 0.0199, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9052, 'compress@10': 0.906, 'time@10': 8.8088}:  63%|██████▎   | 19/30 [02:10<00:54,  4.95s/it]{'epoch': 38, 'num_users': 6.15, 'loss': 0.0199, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9052, 'compress@10': 0.906, 'time@10': 8.8088}:  67%|██████▋   | 20/30 [02:10<01:15,  7.50s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0211, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.9025, 'compress@10': 0.9058, 'time@10': 8.8739}:  67%|██████▋   | 20/30 [02:15<01:15,  7.50s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0211, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.9025, 'compress@10': 0.9058, 'time@10': 8.8739}:  70%|███████   | 21/30 [02:15<01:01,  6.79s/it]{'epoch': 38, 'num_users': 6.1818, 'loss': 0.0212, 'hit_ratio@10': 0.854, 'ndcg@10': 0.9024, 'compress@10': 0.9058, 'time@10': 8.7286}:  70%|███████   | 21/30 [02:20<01:01,  6.79s/it] {'epoch': 38, 'num_users': 6.1818, 'loss': 0.0212, 'hit_ratio@10': 0.854, 'ndcg@10': 0.9024, 'compress@10': 0.9058, 'time@10': 8.7286}:  73%|███████▎  | 22/30 [02:20<00:51,  6.47s/it]{'epoch': 38, 'num_users': 6.1304, 'loss': 0.0208, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9034, 'compress@10': 0.9057, 'time@10': 8.7829}:  73%|███████▎  | 22/30 [02:25<00:51,  6.47s/it]{'epoch': 38, 'num_users': 6.1304, 'loss': 0.0208, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9034, 'compress@10': 0.9057, 'time@10': 8.7829}:  77%|███████▋  | 23/30 [02:25<00:42,  6.03s/it]{'epoch': 38, 'num_users': 5.9583, 'loss': 0.0199, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8991, 'compress@10': 0.9063, 'time@10': 8.62}:  77%|███████▋  | 23/30 [02:30<00:42,  6.03s/it] {'epoch': 38, 'num_users': 5.9583, 'loss': 0.0199, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8991, 'compress@10': 0.9063, 'time@10': 8.62}:  80%|████████  | 24/30 [02:30<00:34,  5.70s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0192, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8898, 'compress@10': 0.9074, 'time@10': 8.4593}:  80%|████████  | 24/30 [02:33<00:34,  5.70s/it] {'epoch': 38, 'num_users': 5.8, 'loss': 0.0192, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8898, 'compress@10': 0.9074, 'time@10': 8.4593}:  83%|████████▎ | 25/30 [02:33<00:23,  4.69s/it]{'epoch': 38, 'num_users': 5.8077, 'loss': 0.019, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8925, 'compress@10': 0.9072, 'time@10': 8.625}:  83%|████████▎ | 25/30 [02:46<00:23,  4.69s/it]{'epoch': 38, 'num_users': 5.8077, 'loss': 0.019, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8925, 'compress@10': 0.9072, 'time@10': 8.625}:  87%|████████▋ | 26/30 [02:46<00:28,  7.12s/it]{'epoch': 38, 'num_users': 5.8889, 'loss': 0.0186, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8945, 'compress@10': 0.907, 'time@10': 8.7237}:  87%|████████▋ | 26/30 [02:51<00:28,  7.12s/it]{'epoch': 38, 'num_users': 5.8889, 'loss': 0.0186, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8945, 'compress@10': 0.907, 'time@10': 8.7237}:  90%|█████████ | 27/30 [02:51<00:20,  6.69s/it]{'epoch': 38, 'num_users': 6.0, 'loss': 0.0192, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8962, 'compress@10': 0.9068, 'time@10': 8.8804}:  90%|█████████ | 27/30 [03:04<00:20,  6.69s/it]   {'epoch': 38, 'num_users': 6.0, 'loss': 0.0192, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8962, 'compress@10': 0.9068, 'time@10': 8.8804}:  93%|█████████▎| 28/30 [03:04<00:17,  8.63s/it]{'epoch': 38, 'num_users': 5.8621, 'loss': 0.0188, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.898, 'compress@10': 0.9068, 'time@10': 8.9416}:  93%|█████████▎| 28/30 [03:10<00:17,  8.63s/it]{'epoch': 38, 'num_users': 5.8621, 'loss': 0.0188, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.898, 'compress@10': 0.9068, 'time@10': 8.9416}:  97%|█████████▋| 29/30 [03:10<00:07,  7.65s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0192, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.898, 'compress@10': 0.9066, 'time@10': 8.9458}:  97%|█████████▋| 29/30 [03:19<00:07,  7.65s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0192, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.898, 'compress@10': 0.9066, 'time@10': 8.9458}: 100%|██████████| 30/30 [03:19<00:00,  8.08s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0192, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.898, 'compress@10': 0.9066, 'time@10': 8.9458}: 100%|██████████| 30/30 [03:19<00:00,  6.64s/it]
Epoch: 38
Avg # of users: 5.866666666666666
Avg Loss: 0.019162229063451577
Avg hit ratio: 0.8632633286600921
Avg ndcg: 0.8979599580257536
Avg compression ratio: 0.9066299380740731
Avg train time: 8.94575023651123
Std train time: 2.8215581999795942
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 47, 46, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8983, 'compress@10': 0.9052, 'time@10': 9.2556}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8983, 'compress@10': 0.9052, 'time@10': 9.2556}:   3%|▎         | 1/30 [00:04<02:15,  4.66s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9329, 'compress@10': 0.9042, 'time@10': 8.6462}:   3%|▎         | 1/30 [00:12<02:15,  4.66s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9329, 'compress@10': 0.9042, 'time@10': 8.6462}:   7%|▋         | 2/30 [00:12<03:06,  6.67s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9076, 'compress@10': 0.9076, 'time@10': 7.5077}:   7%|▋         | 2/30 [00:15<03:06,  6.67s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9076, 'compress@10': 0.9076, 'time@10': 7.5077}:  10%|█         | 3/30 [00:15<02:10,  4.83s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.8921, 'compress@10': 0.9066, 'time@10': 7.3734}:  10%|█         | 3/30 [00:22<02:10,  4.83s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.8921, 'compress@10': 0.9066, 'time@10': 7.3734}:  13%|█▎        | 4/30 [00:22<02:28,  5.69s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0263, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.872, 'compress@10': 0.9057, 'time@10': 7.9057}:  13%|█▎        | 4/30 [00:27<02:28,  5.69s/it] {'epoch': 39, 'num_users': 5.8, 'loss': 0.0263, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.872, 'compress@10': 0.9057, 'time@10': 7.9057}:  17%|█▋        | 5/30 [00:27<02:16,  5.46s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0241, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8859, 'compress@10': 0.9051, 'time@10': 8.5051}:  17%|█▋        | 5/30 [00:38<02:16,  5.46s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0241, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8859, 'compress@10': 0.9051, 'time@10': 8.5051}:  20%|██        | 6/30 [00:38<03:00,  7.53s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0239, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8867, 'compress@10': 0.9049, 'time@10': 8.7035}:  20%|██        | 6/30 [00:43<03:00,  7.53s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0239, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8867, 'compress@10': 0.9049, 'time@10': 8.7035}:  23%|██▎       | 7/30 [00:43<02:34,  6.70s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0243, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8971, 'compress@10': 0.9047, 'time@10': 8.7002}:  23%|██▎       | 7/30 [00:52<02:34,  6.70s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0243, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8971, 'compress@10': 0.9047, 'time@10': 8.7002}:  27%|██▋       | 8/30 [00:52<02:41,  7.35s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0239, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9015, 'compress@10': 0.9045, 'time@10': 8.9132}:  27%|██▋       | 8/30 [00:58<02:41,  7.35s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0239, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9015, 'compress@10': 0.9045, 'time@10': 8.9132}:  30%|███       | 9/30 [00:58<02:21,  6.72s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9083, 'compress@10': 0.9042, 'time@10': 9.1178}:  30%|███       | 9/30 [01:09<02:21,  6.72s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9083, 'compress@10': 0.9042, 'time@10': 9.1178}:  33%|███▎      | 10/30 [01:09<02:40,  8.04s/it]{'epoch': 39, 'num_users': 6.6364, 'loss': 0.0228, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9081, 'compress@10': 0.9042, 'time@10': 9.4714}:  33%|███▎      | 10/30 [01:15<02:40,  8.04s/it]{'epoch': 39, 'num_users': 6.6364, 'loss': 0.0228, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9081, 'compress@10': 0.9042, 'time@10': 9.4714}:  37%|███▋      | 11/30 [01:15<02:24,  7.58s/it]{'epoch': 39, 'num_users': 6.4167, 'loss': 0.0211, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.9088, 'compress@10': 0.9045, 'time@10': 9.1327}:  37%|███▋      | 11/30 [01:21<02:24,  7.58s/it]{'epoch': 39, 'num_users': 6.4167, 'loss': 0.0211, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.9088, 'compress@10': 0.9045, 'time@10': 9.1327}:  40%|████      | 12/30 [01:21<02:04,  6.93s/it]{'epoch': 39, 'num_users': 6.6154, 'loss': 0.0212, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.9089, 'compress@10': 0.9045, 'time@10': 9.2548}:  40%|████      | 12/30 [01:26<02:04,  6.93s/it]{'epoch': 39, 'num_users': 6.6154, 'loss': 0.0212, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.9089, 'compress@10': 0.9045, 'time@10': 9.2548}:  43%|████▎     | 13/30 [01:26<01:49,  6.47s/it]{'epoch': 39, 'num_users': 6.3571, 'loss': 0.0197, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.9035, 'compress@10': 0.9054, 'time@10': 8.9693}:  43%|████▎     | 13/30 [01:31<01:49,  6.47s/it]{'epoch': 39, 'num_users': 6.3571, 'loss': 0.0197, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.9035, 'compress@10': 0.9054, 'time@10': 8.9693}:  47%|████▋     | 14/30 [01:31<01:37,  6.11s/it]{'epoch': 39, 'num_users': 6.2667, 'loss': 0.0194, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.9053, 'compress@10': 0.9053, 'time@10': 9.2135}:  47%|████▋     | 14/30 [01:38<01:37,  6.11s/it]{'epoch': 39, 'num_users': 6.2667, 'loss': 0.0194, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.9053, 'compress@10': 0.9053, 'time@10': 9.2135}:  50%|█████     | 15/30 [01:38<01:32,  6.18s/it]{'epoch': 39, 'num_users': 6.0625, 'loss': 0.0183, 'hit_ratio@10': 0.835, 'ndcg@10': 0.906, 'compress@10': 0.9055, 'time@10': 8.9672}:  50%|█████     | 15/30 [01:43<01:32,  6.18s/it]  {'epoch': 39, 'num_users': 6.0625, 'loss': 0.0183, 'hit_ratio@10': 0.835, 'ndcg@10': 0.906, 'compress@10': 0.9055, 'time@10': 8.9672}:  53%|█████▎    | 16/30 [01:43<01:22,  5.92s/it]{'epoch': 39, 'num_users': 5.8235, 'loss': 0.0173, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.898, 'compress@10': 0.9063, 'time@10': 8.7512}:  53%|█████▎    | 16/30 [01:46<01:22,  5.92s/it]{'epoch': 39, 'num_users': 5.8235, 'loss': 0.0173, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.898, 'compress@10': 0.9063, 'time@10': 8.7512}:  57%|█████▋    | 17/30 [01:46<01:04,  4.95s/it]{'epoch': 39, 'num_users': 6.0556, 'loss': 0.0171, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.9003, 'compress@10': 0.9062, 'time@10': 8.6563}:  57%|█████▋    | 17/30 [01:53<01:04,  4.95s/it]{'epoch': 39, 'num_users': 6.0556, 'loss': 0.0171, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.9003, 'compress@10': 0.9062, 'time@10': 8.6563}:  60%|██████    | 18/30 [01:53<01:07,  5.59s/it]{'epoch': 39, 'num_users': 6.0, 'loss': 0.0167, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.9013, 'compress@10': 0.9062, 'time@10': 8.5557}:  60%|██████    | 18/30 [01:56<01:07,  5.59s/it]   {'epoch': 39, 'num_users': 6.0, 'loss': 0.0167, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.9013, 'compress@10': 0.9062, 'time@10': 8.5557}:  63%|██████▎   | 19/30 [01:56<00:54,  4.93s/it]{'epoch': 39, 'num_users': 6.15, 'loss': 0.0174, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.903, 'compress@10': 0.906, 'time@10': 8.7923}:  63%|██████▎   | 19/30 [02:09<00:54,  4.93s/it] {'epoch': 39, 'num_users': 6.15, 'loss': 0.0174, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.903, 'compress@10': 0.906, 'time@10': 8.7923}:  67%|██████▋   | 20/30 [02:09<01:14,  7.45s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.9008, 'compress@10': 0.9058, 'time@10': 8.8611}:  67%|██████▋   | 20/30 [02:15<01:14,  7.45s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.9008, 'compress@10': 0.9058, 'time@10': 8.8611}:  70%|███████   | 21/30 [02:15<01:00,  6.76s/it]{'epoch': 39, 'num_users': 6.1818, 'loss': 0.0189, 'hit_ratio@10': 0.844, 'ndcg@10': 0.9015, 'compress@10': 0.9058, 'time@10': 8.7306}:  70%|███████   | 21/30 [02:21<01:00,  6.76s/it] {'epoch': 39, 'num_users': 6.1818, 'loss': 0.0189, 'hit_ratio@10': 0.844, 'ndcg@10': 0.9015, 'compress@10': 0.9058, 'time@10': 8.7306}:  73%|███████▎  | 22/30 [02:21<00:52,  6.54s/it]{'epoch': 39, 'num_users': 6.1304, 'loss': 0.0185, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.9026, 'compress@10': 0.9057, 'time@10': 8.7661}:  73%|███████▎  | 22/30 [02:25<00:52,  6.54s/it]{'epoch': 39, 'num_users': 6.1304, 'loss': 0.0185, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.9026, 'compress@10': 0.9057, 'time@10': 8.7661}:  77%|███████▋  | 23/30 [02:25<00:42,  6.02s/it]{'epoch': 39, 'num_users': 5.9583, 'loss': 0.0177, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8983, 'compress@10': 0.9063, 'time@10': 8.5999}:  77%|███████▋  | 23/30 [02:30<00:42,  6.02s/it]{'epoch': 39, 'num_users': 5.9583, 'loss': 0.0177, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8983, 'compress@10': 0.9063, 'time@10': 8.5999}:  80%|████████  | 24/30 [02:30<00:33,  5.66s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8891, 'compress@10': 0.9074, 'time@10': 8.4502}:  80%|████████  | 24/30 [02:33<00:33,  5.66s/it]   {'epoch': 39, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8891, 'compress@10': 0.9074, 'time@10': 8.4502}:  83%|████████▎ | 25/30 [02:33<00:23,  4.70s/it]{'epoch': 39, 'num_users': 5.8077, 'loss': 0.017, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.8919, 'compress@10': 0.9072, 'time@10': 8.604}:  83%|████████▎ | 25/30 [02:45<00:23,  4.70s/it]{'epoch': 39, 'num_users': 5.8077, 'loss': 0.017, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.8919, 'compress@10': 0.9072, 'time@10': 8.604}:  87%|████████▋ | 26/30 [02:45<00:28,  7.04s/it]{'epoch': 39, 'num_users': 5.8889, 'loss': 0.0166, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8939, 'compress@10': 0.907, 'time@10': 8.7127}:  87%|████████▋ | 26/30 [02:51<00:28,  7.04s/it]{'epoch': 39, 'num_users': 5.8889, 'loss': 0.0166, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8939, 'compress@10': 0.907, 'time@10': 8.7127}:  90%|█████████ | 27/30 [02:51<00:20,  6.67s/it]{'epoch': 39, 'num_users': 6.0, 'loss': 0.0164, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8967, 'compress@10': 0.9068, 'time@10': 8.8747}:  90%|█████████ | 27/30 [03:04<00:20,  6.67s/it]  {'epoch': 39, 'num_users': 6.0, 'loss': 0.0164, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8967, 'compress@10': 0.9068, 'time@10': 8.8747}:  93%|█████████▎| 28/30 [03:04<00:17,  8.65s/it]{'epoch': 39, 'num_users': 5.8621, 'loss': 0.0161, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8985, 'compress@10': 0.9068, 'time@10': 8.9391}:  93%|█████████▎| 28/30 [03:10<00:17,  8.65s/it]{'epoch': 39, 'num_users': 5.8621, 'loss': 0.0161, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8985, 'compress@10': 0.9068, 'time@10': 8.9391}:  97%|█████████▋| 29/30 [03:10<00:07,  7.68s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0166, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9009, 'compress@10': 0.9066, 'time@10': 8.9422}:  97%|█████████▋| 29/30 [03:19<00:07,  7.68s/it] {'epoch': 39, 'num_users': 5.8667, 'loss': 0.0166, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9009, 'compress@10': 0.9066, 'time@10': 8.9422}: 100%|██████████| 30/30 [03:19<00:00,  8.10s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0166, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9009, 'compress@10': 0.9066, 'time@10': 8.9422}: 100%|██████████| 30/30 [03:19<00:00,  6.64s/it]
Epoch: 39
Avg # of users: 5.866666666666666
Avg Loss: 0.01664201257608456
Avg hit ratio: 0.8560119060148389
Avg ndcg: 0.9009047874722679
Avg compression ratio: 0.9066299354083394
Avg train time: 8.942249759038289
Std train time: 2.7885420764036692
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 47, 46, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8983, 'compress@10': 0.9052, 'time@10': 9.6535}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8983, 'compress@10': 0.9052, 'time@10': 9.6535}:   3%|▎         | 1/30 [00:04<02:21,  4.86s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9283, 'compress@10': 0.9042, 'time@10': 8.7526}:   3%|▎         | 1/30 [00:12<02:21,  4.86s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9283, 'compress@10': 0.9042, 'time@10': 8.7526}:   7%|▋         | 2/30 [00:12<03:06,  6.64s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9046, 'compress@10': 0.9076, 'time@10': 7.555}:   7%|▋         | 2/30 [00:15<03:06,  6.64s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9046, 'compress@10': 0.9076, 'time@10': 7.555}:  10%|█         | 3/30 [00:15<02:09,  4.80s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9171, 'compress@10': 0.9066, 'time@10': 7.4}:  10%|█         | 3/30 [00:22<02:09,  4.80s/it]  {'epoch': 40, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9171, 'compress@10': 0.9066, 'time@10': 7.4}:  13%|█▎        | 4/30 [00:22<02:27,  5.66s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.893, 'compress@10': 0.9057, 'time@10': 7.9466}:  13%|█▎        | 4/30 [00:27<02:27,  5.66s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.893, 'compress@10': 0.9057, 'time@10': 7.9466}:  17%|█▋        | 5/30 [00:27<02:16,  5.46s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0202, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.903, 'compress@10': 0.9051, 'time@10': 8.5541}:  17%|█▋        | 5/30 [00:39<02:16,  5.46s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0202, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.903, 'compress@10': 0.9051, 'time@10': 8.5541}:  20%|██        | 6/30 [00:39<03:01,  7.56s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0206, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.9016, 'compress@10': 0.9049, 'time@10': 8.7401}:  20%|██        | 6/30 [00:44<03:01,  7.56s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0206, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.9016, 'compress@10': 0.9049, 'time@10': 8.7401}:  23%|██▎       | 7/30 [00:44<02:34,  6.71s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0215, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.9103, 'compress@10': 0.9047, 'time@10': 8.7652}:  23%|██▎       | 7/30 [00:53<02:34,  6.71s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0215, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.9103, 'compress@10': 0.9047, 'time@10': 8.7652}:  27%|██▋       | 8/30 [00:53<02:43,  7.43s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9134, 'compress@10': 0.9045, 'time@10': 8.9897}:  27%|██▋       | 8/30 [00:58<02:43,  7.43s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9134, 'compress@10': 0.9045, 'time@10': 8.9897}:  30%|███       | 9/30 [00:58<02:22,  6.81s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.921, 'compress@10': 0.9042, 'time@10': 9.1955}:  30%|███       | 9/30 [01:09<02:22,  6.81s/it]    {'epoch': 40, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.921, 'compress@10': 0.9042, 'time@10': 9.1955}:  33%|███▎      | 10/30 [01:09<02:42,  8.13s/it]{'epoch': 40, 'num_users': 6.6364, 'loss': 0.0237, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9246, 'compress@10': 0.9042, 'time@10': 9.5139}:  33%|███▎      | 10/30 [01:15<02:42,  8.13s/it]{'epoch': 40, 'num_users': 6.6364, 'loss': 0.0237, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9246, 'compress@10': 0.9042, 'time@10': 9.5139}:  37%|███▋      | 11/30 [01:15<02:24,  7.60s/it]{'epoch': 40, 'num_users': 6.4167, 'loss': 0.0219, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9239, 'compress@10': 0.9045, 'time@10': 9.1745}:  37%|███▋      | 11/30 [01:21<02:24,  7.60s/it]{'epoch': 40, 'num_users': 6.4167, 'loss': 0.0219, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9239, 'compress@10': 0.9045, 'time@10': 9.1745}:  40%|████      | 12/30 [01:21<02:05,  6.95s/it]{'epoch': 40, 'num_users': 6.6154, 'loss': 0.022, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.9234, 'compress@10': 0.9045, 'time@10': 9.3137}:  40%|████      | 12/30 [01:26<02:05,  6.95s/it] {'epoch': 40, 'num_users': 6.6154, 'loss': 0.022, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.9234, 'compress@10': 0.9045, 'time@10': 9.3137}:  43%|████▎     | 13/30 [01:26<01:50,  6.53s/it]{'epoch': 40, 'num_users': 6.3571, 'loss': 0.0204, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.917, 'compress@10': 0.9054, 'time@10': 9.0036}:  43%|████▎     | 13/30 [01:31<01:50,  6.53s/it]{'epoch': 40, 'num_users': 6.3571, 'loss': 0.0204, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.917, 'compress@10': 0.9054, 'time@10': 9.0036}:  47%|████▋     | 14/30 [01:31<01:37,  6.07s/it]{'epoch': 40, 'num_users': 6.2667, 'loss': 0.0211, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.9164, 'compress@10': 0.9053, 'time@10': 9.2432}:  47%|████▋     | 14/30 [01:38<01:37,  6.07s/it]{'epoch': 40, 'num_users': 6.2667, 'loss': 0.0211, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.9164, 'compress@10': 0.9053, 'time@10': 9.2432}:  50%|█████     | 15/30 [01:38<01:32,  6.15s/it]{'epoch': 40, 'num_users': 6.0625, 'loss': 0.0199, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.9164, 'compress@10': 0.9055, 'time@10': 9.0067}:  50%|█████     | 15/30 [01:43<01:32,  6.15s/it]{'epoch': 40, 'num_users': 6.0625, 'loss': 0.0199, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.9164, 'compress@10': 0.9055, 'time@10': 9.0067}:  53%|█████▎    | 16/30 [01:43<01:23,  5.95s/it]{'epoch': 40, 'num_users': 5.8235, 'loss': 0.0187, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.9078, 'compress@10': 0.9063, 'time@10': 8.7851}:  53%|█████▎    | 16/30 [01:46<01:23,  5.95s/it]{'epoch': 40, 'num_users': 5.8235, 'loss': 0.0187, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.9078, 'compress@10': 0.9063, 'time@10': 8.7851}:  57%|█████▋    | 17/30 [01:46<01:04,  4.96s/it]{'epoch': 40, 'num_users': 6.0556, 'loss': 0.0184, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.9099, 'compress@10': 0.9062, 'time@10': 8.6853}:  57%|█████▋    | 17/30 [01:53<01:04,  4.96s/it]{'epoch': 40, 'num_users': 6.0556, 'loss': 0.0184, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.9099, 'compress@10': 0.9062, 'time@10': 8.6853}:  60%|██████    | 18/30 [01:53<01:06,  5.58s/it]{'epoch': 40, 'num_users': 6.0, 'loss': 0.0179, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.9106, 'compress@10': 0.9062, 'time@10': 8.5914}:  60%|██████    | 18/30 [01:57<01:06,  5.58s/it]   {'epoch': 40, 'num_users': 6.0, 'loss': 0.0179, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.9106, 'compress@10': 0.9062, 'time@10': 8.5914}:  63%|██████▎   | 19/30 [01:57<00:54,  4.98s/it]{'epoch': 40, 'num_users': 6.15, 'loss': 0.0178, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9128, 'compress@10': 0.906, 'time@10': 8.8138}:  63%|██████▎   | 19/30 [02:10<00:54,  4.98s/it]{'epoch': 40, 'num_users': 6.15, 'loss': 0.0178, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9128, 'compress@10': 0.906, 'time@10': 8.8138}:  67%|██████▋   | 20/30 [02:10<01:14,  7.41s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.9102, 'compress@10': 0.9058, 'time@10': 8.8667}:  67%|██████▋   | 20/30 [02:15<01:14,  7.41s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.9102, 'compress@10': 0.9058, 'time@10': 8.8667}:  70%|███████   | 21/30 [02:15<01:00,  6.69s/it]{'epoch': 40, 'num_users': 6.1818, 'loss': 0.0192, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.9113, 'compress@10': 0.9058, 'time@10': 8.7254}:  70%|███████   | 21/30 [02:20<01:00,  6.69s/it]{'epoch': 40, 'num_users': 6.1818, 'loss': 0.0192, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.9113, 'compress@10': 0.9058, 'time@10': 8.7254}:  73%|███████▎  | 22/30 [02:20<00:51,  6.42s/it]{'epoch': 40, 'num_users': 6.1304, 'loss': 0.0188, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.912, 'compress@10': 0.9057, 'time@10': 8.7789}:  73%|███████▎  | 22/30 [02:25<00:51,  6.42s/it] {'epoch': 40, 'num_users': 6.1304, 'loss': 0.0188, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.912, 'compress@10': 0.9057, 'time@10': 8.7789}:  77%|███████▋  | 23/30 [02:25<00:42,  6.01s/it]{'epoch': 40, 'num_users': 5.9583, 'loss': 0.018, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9073, 'compress@10': 0.9063, 'time@10': 8.6082}:  77%|███████▋  | 23/30 [02:30<00:42,  6.01s/it]{'epoch': 40, 'num_users': 5.9583, 'loss': 0.018, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9073, 'compress@10': 0.9063, 'time@10': 8.6082}:  80%|████████  | 24/30 [02:30<00:33,  5.62s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8977, 'compress@10': 0.9074, 'time@10': 8.4635}:  80%|████████  | 24/30 [02:33<00:33,  5.62s/it]  {'epoch': 40, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8977, 'compress@10': 0.9074, 'time@10': 8.4635}:  83%|████████▎ | 25/30 [02:33<00:23,  4.69s/it]{'epoch': 40, 'num_users': 5.8077, 'loss': 0.0172, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9002, 'compress@10': 0.9072, 'time@10': 8.6224}:  83%|████████▎ | 25/30 [02:45<00:23,  4.69s/it]{'epoch': 40, 'num_users': 5.8077, 'loss': 0.0172, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9002, 'compress@10': 0.9072, 'time@10': 8.6224}:  87%|████████▋ | 26/30 [02:45<00:28,  7.08s/it]{'epoch': 40, 'num_users': 5.8889, 'loss': 0.0169, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.9019, 'compress@10': 0.907, 'time@10': 8.7276}:  87%|████████▋ | 26/30 [02:51<00:28,  7.08s/it] {'epoch': 40, 'num_users': 5.8889, 'loss': 0.0169, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.9019, 'compress@10': 0.907, 'time@10': 8.7276}:  90%|█████████ | 27/30 [02:51<00:20,  6.68s/it]{'epoch': 40, 'num_users': 6.0, 'loss': 0.0166, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9044, 'compress@10': 0.9068, 'time@10': 8.8901}:  90%|█████████ | 27/30 [03:04<00:20,  6.68s/it]  {'epoch': 40, 'num_users': 6.0, 'loss': 0.0166, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9044, 'compress@10': 0.9068, 'time@10': 8.8901}:  93%|█████████▎| 28/30 [03:04<00:17,  8.67s/it]{'epoch': 40, 'num_users': 5.8621, 'loss': 0.0163, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9059, 'compress@10': 0.9068, 'time@10': 8.9524}:  93%|█████████▎| 28/30 [03:10<00:17,  8.67s/it]{'epoch': 40, 'num_users': 5.8621, 'loss': 0.0163, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9059, 'compress@10': 0.9068, 'time@10': 8.9524}:  97%|█████████▋| 29/30 [03:10<00:07,  7.69s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0163, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9076, 'compress@10': 0.9066, 'time@10': 8.9602}:  97%|█████████▋| 29/30 [03:19<00:07,  7.69s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0163, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9076, 'compress@10': 0.9066, 'time@10': 8.9602}: 100%|██████████| 30/30 [03:19<00:00,  8.15s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0163, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9076, 'compress@10': 0.9066, 'time@10': 8.9602}: 100%|██████████| 30/30 [03:19<00:00,  6.65s/it]
Epoch: 40
Avg # of users: 5.866666666666666
Avg Loss: 0.016324921107659287
Avg hit ratio: 0.8609473375679174
Avg ndcg: 0.9075808499552761
Avg compression ratio: 0.9066299325576328
Avg train time: 8.960236549377441
Std train time: 2.7983480839164003
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 48, 46, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9064, 'compress@10': 0.9052, 'time@10': 9.2779}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9064, 'compress@10': 0.9052, 'time@10': 9.2779}:   3%|▎         | 1/30 [00:04<02:15,  4.67s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.924, 'compress@10': 0.9042, 'time@10': 8.6595}:   3%|▎         | 1/30 [00:12<02:15,  4.67s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.924, 'compress@10': 0.9042, 'time@10': 8.6595}:   7%|▋         | 2/30 [00:12<03:06,  6.68s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9017, 'compress@10': 0.9076, 'time@10': 7.5159}:   7%|▋         | 2/30 [00:15<03:06,  6.68s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9017, 'compress@10': 0.9076, 'time@10': 7.5159}:  10%|█         | 3/30 [00:15<02:10,  4.84s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9166, 'compress@10': 0.9066, 'time@10': 7.3853}:  10%|█         | 3/30 [00:22<02:10,  4.84s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9166, 'compress@10': 0.9066, 'time@10': 7.3853}:  13%|█▎        | 4/30 [00:22<02:28,  5.70s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0229, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8936, 'compress@10': 0.9057, 'time@10': 7.9545}:  13%|█▎        | 4/30 [00:27<02:28,  5.70s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0229, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8936, 'compress@10': 0.9057, 'time@10': 7.9545}:  17%|█▋        | 5/30 [00:27<02:17,  5.50s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0219, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.9039, 'compress@10': 0.9051, 'time@10': 8.5227}:  17%|█▋        | 5/30 [00:38<02:17,  5.50s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0219, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.9039, 'compress@10': 0.9051, 'time@10': 8.5227}:  20%|██        | 6/30 [00:38<03:00,  7.51s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0219, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9027, 'compress@10': 0.9049, 'time@10': 8.7599}:  20%|██        | 6/30 [00:44<03:00,  7.51s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0219, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9027, 'compress@10': 0.9049, 'time@10': 8.7599}:  23%|██▎       | 7/30 [00:44<02:34,  6.73s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0229, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9108, 'compress@10': 0.9047, 'time@10': 8.765}:  23%|██▎       | 7/30 [00:52<02:34,  6.73s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.0229, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9108, 'compress@10': 0.9047, 'time@10': 8.765}:  27%|██▋       | 8/30 [00:52<02:42,  7.40s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9141, 'compress@10': 0.9045, 'time@10': 8.9897}:  27%|██▋       | 8/30 [00:58<02:42,  7.40s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9141, 'compress@10': 0.9045, 'time@10': 8.9897}:  30%|███       | 9/30 [00:58<02:22,  6.79s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9197, 'compress@10': 0.9042, 'time@10': 9.2026}:  30%|███       | 9/30 [01:09<02:22,  6.79s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9197, 'compress@10': 0.9042, 'time@10': 9.2026}:  33%|███▎      | 10/30 [01:09<02:42,  8.13s/it]{'epoch': 41, 'num_users': 6.6364, 'loss': 0.0205, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9203, 'compress@10': 0.9042, 'time@10': 9.5663}:  33%|███▎      | 10/30 [01:16<02:42,  8.13s/it]{'epoch': 41, 'num_users': 6.6364, 'loss': 0.0205, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9203, 'compress@10': 0.9042, 'time@10': 9.5663}:  37%|███▋      | 11/30 [01:16<02:25,  7.68s/it]{'epoch': 41, 'num_users': 6.4167, 'loss': 0.019, 'hit_ratio@10': 0.851, 'ndcg@10': 0.92, 'compress@10': 0.9045, 'time@10': 9.219}:  37%|███▋      | 11/30 [01:21<02:25,  7.68s/it]     {'epoch': 41, 'num_users': 6.4167, 'loss': 0.019, 'hit_ratio@10': 0.851, 'ndcg@10': 0.92, 'compress@10': 0.9045, 'time@10': 9.219}:  40%|████      | 12/30 [01:21<02:05,  6.99s/it]{'epoch': 41, 'num_users': 6.6154, 'loss': 0.0192, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9197, 'compress@10': 0.9045, 'time@10': 9.3591}:  40%|████      | 12/30 [01:27<02:05,  6.99s/it]{'epoch': 41, 'num_users': 6.6154, 'loss': 0.0192, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9197, 'compress@10': 0.9045, 'time@10': 9.3591}:  43%|████▎     | 13/30 [01:27<01:51,  6.56s/it]{'epoch': 41, 'num_users': 6.3571, 'loss': 0.0178, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9136, 'compress@10': 0.9054, 'time@10': 9.0582}:  43%|████▎     | 13/30 [01:32<01:51,  6.56s/it]{'epoch': 41, 'num_users': 6.3571, 'loss': 0.0178, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9136, 'compress@10': 0.9054, 'time@10': 9.0582}:  47%|████▋     | 14/30 [01:32<01:38,  6.14s/it]{'epoch': 41, 'num_users': 6.2667, 'loss': 0.018, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.9154, 'compress@10': 0.9053, 'time@10': 9.2997}:  47%|████▋     | 14/30 [01:38<01:38,  6.14s/it] {'epoch': 41, 'num_users': 6.2667, 'loss': 0.018, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.9154, 'compress@10': 0.9053, 'time@10': 9.2997}:  50%|█████     | 15/30 [01:38<01:33,  6.21s/it]{'epoch': 41, 'num_users': 6.0625, 'loss': 0.017, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.9155, 'compress@10': 0.9055, 'time@10': 9.0571}:  50%|█████     | 15/30 [01:44<01:33,  6.21s/it]{'epoch': 41, 'num_users': 6.0625, 'loss': 0.017, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.9155, 'compress@10': 0.9055, 'time@10': 9.0571}:  53%|█████▎    | 16/30 [01:44<01:23,  5.98s/it]{'epoch': 41, 'num_users': 5.8235, 'loss': 0.0161, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.907, 'compress@10': 0.9063, 'time@10': 8.8285}:  53%|█████▎    | 16/30 [01:46<01:23,  5.98s/it]{'epoch': 41, 'num_users': 5.8235, 'loss': 0.0161, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.907, 'compress@10': 0.9063, 'time@10': 8.8285}:  57%|█████▋    | 17/30 [01:46<01:04,  4.97s/it]{'epoch': 41, 'num_users': 6.0556, 'loss': 0.0162, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.9084, 'compress@10': 0.9062, 'time@10': 8.7513}:  57%|█████▋    | 17/30 [01:54<01:04,  4.97s/it]{'epoch': 41, 'num_users': 6.0556, 'loss': 0.0162, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.9084, 'compress@10': 0.9062, 'time@10': 8.7513}:  60%|██████    | 18/30 [01:54<01:08,  5.72s/it]{'epoch': 41, 'num_users': 6.0, 'loss': 0.0158, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.9092, 'compress@10': 0.9062, 'time@10': 8.6499}:  60%|██████    | 18/30 [01:57<01:08,  5.72s/it]   {'epoch': 41, 'num_users': 6.0, 'loss': 0.0158, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.9092, 'compress@10': 0.9062, 'time@10': 8.6499}:  63%|██████▎   | 19/30 [01:57<00:55,  5.04s/it]{'epoch': 41, 'num_users': 6.15, 'loss': 0.0166, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.9113, 'compress@10': 0.906, 'time@10': 8.8656}:  63%|██████▎   | 19/30 [02:10<00:55,  5.04s/it]{'epoch': 41, 'num_users': 6.15, 'loss': 0.0166, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.9113, 'compress@10': 0.906, 'time@10': 8.8656}:  67%|██████▋   | 20/30 [02:10<01:14,  7.43s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.9087, 'compress@10': 0.9058, 'time@10': 8.9402}:  67%|██████▋   | 20/30 [02:15<01:14,  7.43s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.9087, 'compress@10': 0.9058, 'time@10': 8.9402}:  70%|███████   | 21/30 [02:15<01:01,  6.78s/it]{'epoch': 41, 'num_users': 6.1818, 'loss': 0.0179, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.909, 'compress@10': 0.9058, 'time@10': 8.8008}:  70%|███████   | 21/30 [02:21<01:01,  6.78s/it] {'epoch': 41, 'num_users': 6.1818, 'loss': 0.0179, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.909, 'compress@10': 0.9058, 'time@10': 8.8008}:  73%|███████▎  | 22/30 [02:21<00:52,  6.52s/it]{'epoch': 41, 'num_users': 6.1304, 'loss': 0.0176, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.9098, 'compress@10': 0.9057, 'time@10': 8.8445}:  73%|███████▎  | 22/30 [02:26<00:52,  6.52s/it]{'epoch': 41, 'num_users': 6.1304, 'loss': 0.0176, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.9098, 'compress@10': 0.9057, 'time@10': 8.8445}:  77%|███████▋  | 23/30 [02:26<00:42,  6.04s/it]{'epoch': 41, 'num_users': 5.9583, 'loss': 0.0168, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9052, 'compress@10': 0.9063, 'time@10': 8.6804}:  77%|███████▋  | 23/30 [02:31<00:42,  6.04s/it]{'epoch': 41, 'num_users': 5.9583, 'loss': 0.0168, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9052, 'compress@10': 0.9063, 'time@10': 8.6804}:  80%|████████  | 24/30 [02:31<00:34,  5.72s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8957, 'compress@10': 0.9074, 'time@10': 8.5286}:  80%|████████  | 24/30 [02:34<00:34,  5.72s/it]   {'epoch': 41, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8957, 'compress@10': 0.9074, 'time@10': 8.5286}:  83%|████████▎ | 25/30 [02:34<00:23,  4.75s/it]{'epoch': 41, 'num_users': 5.8077, 'loss': 0.0161, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8984, 'compress@10': 0.9072, 'time@10': 8.6792}:  83%|████████▎ | 25/30 [02:46<00:23,  4.75s/it]{'epoch': 41, 'num_users': 5.8077, 'loss': 0.0161, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8984, 'compress@10': 0.9072, 'time@10': 8.6792}:  87%|████████▋ | 26/30 [02:46<00:28,  7.07s/it]{'epoch': 41, 'num_users': 5.8889, 'loss': 0.0159, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.9001, 'compress@10': 0.907, 'time@10': 8.7762}:  87%|████████▋ | 26/30 [02:52<00:28,  7.07s/it] {'epoch': 41, 'num_users': 5.8889, 'loss': 0.0159, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.9001, 'compress@10': 0.907, 'time@10': 8.7762}:  90%|█████████ | 27/30 [02:52<00:19,  6.65s/it]{'epoch': 41, 'num_users': 6.0, 'loss': 0.0167, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9044, 'compress@10': 0.9068, 'time@10': 8.9332}:  90%|█████████ | 27/30 [03:05<00:19,  6.65s/it]   {'epoch': 41, 'num_users': 6.0, 'loss': 0.0167, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9044, 'compress@10': 0.9068, 'time@10': 8.9332}:  93%|█████████▎| 28/30 [03:05<00:17,  8.62s/it]{'epoch': 41, 'num_users': 5.8621, 'loss': 0.0164, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.906, 'compress@10': 0.9068, 'time@10': 8.9866}:  93%|█████████▎| 28/30 [03:10<00:17,  8.62s/it]{'epoch': 41, 'num_users': 5.8621, 'loss': 0.0164, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.906, 'compress@10': 0.9068, 'time@10': 8.9866}:  97%|█████████▋| 29/30 [03:10<00:07,  7.62s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0166, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9063, 'compress@10': 0.9066, 'time@10': 8.994}:  97%|█████████▋| 29/30 [03:20<00:07,  7.62s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0166, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9063, 'compress@10': 0.9066, 'time@10': 8.994}: 100%|██████████| 30/30 [03:20<00:00,  8.11s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0166, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9063, 'compress@10': 0.9066, 'time@10': 8.994}: 100%|██████████| 30/30 [03:20<00:00,  6.67s/it]
Epoch: 41
Avg # of users: 5.866666666666666
Avg Loss: 0.016612470161498732
Avg hit ratio: 0.863293327932027
Avg ndcg: 0.9062848936476217
Avg compression ratio: 0.9066299453448488
Avg train time: 8.993985199928284
Std train time: 2.7808753766359784
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 48, 46, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9043, 'compress@10': 0.9052, 'time@10': 9.4912}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9043, 'compress@10': 0.9052, 'time@10': 9.4912}:   3%|▎         | 1/30 [00:04<02:18,  4.79s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9343, 'compress@10': 0.9042, 'time@10': 8.6856}:   3%|▎         | 1/30 [00:12<02:18,  4.79s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9343, 'compress@10': 0.9042, 'time@10': 8.6856}:   7%|▋         | 2/30 [00:12<03:05,  6.64s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9086, 'compress@10': 0.9076, 'time@10': 7.5957}:   7%|▋         | 2/30 [00:15<03:05,  6.64s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9086, 'compress@10': 0.9076, 'time@10': 7.5957}:  10%|█         | 3/30 [00:15<02:11,  4.86s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9198, 'compress@10': 0.9066, 'time@10': 7.4241}:  10%|█         | 3/30 [00:22<02:11,  4.86s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9198, 'compress@10': 0.9066, 'time@10': 7.4241}:  13%|█▎        | 4/30 [00:22<02:27,  5.68s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8973, 'compress@10': 0.9057, 'time@10': 7.9565}:  13%|█▎        | 4/30 [00:27<02:27,  5.68s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8973, 'compress@10': 0.9057, 'time@10': 7.9565}:  17%|█▋        | 5/30 [00:27<02:16,  5.47s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0216, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.908, 'compress@10': 0.9051, 'time@10': 8.5359}:  17%|█▋        | 5/30 [00:38<02:16,  5.47s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0216, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.908, 'compress@10': 0.9051, 'time@10': 8.5359}:  20%|██        | 6/30 [00:38<03:00,  7.51s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0218, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.9076, 'compress@10': 0.9049, 'time@10': 8.7381}:  20%|██        | 6/30 [00:43<03:00,  7.51s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0218, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.9076, 'compress@10': 0.9049, 'time@10': 8.7381}:  23%|██▎       | 7/30 [00:43<02:33,  6.69s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0226, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.917, 'compress@10': 0.9047, 'time@10': 8.7664}:  23%|██▎       | 7/30 [00:52<02:33,  6.69s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.0226, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.917, 'compress@10': 0.9047, 'time@10': 8.7664}:  27%|██▋       | 8/30 [00:52<02:43,  7.43s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0222, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.9199, 'compress@10': 0.9045, 'time@10': 9.0172}:  27%|██▋       | 8/30 [00:58<02:43,  7.43s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0222, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.9199, 'compress@10': 0.9045, 'time@10': 9.0172}:  30%|███       | 9/30 [00:58<02:23,  6.84s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9261, 'compress@10': 0.9042, 'time@10': 9.2245}:  30%|███       | 9/30 [01:09<02:23,  6.84s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9261, 'compress@10': 0.9042, 'time@10': 9.2245}:  33%|███▎      | 10/30 [01:09<02:43,  8.16s/it]{'epoch': 42, 'num_users': 6.6364, 'loss': 0.0229, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9251, 'compress@10': 0.9042, 'time@10': 9.5469}:  33%|███▎      | 10/30 [01:16<02:43,  8.16s/it]{'epoch': 42, 'num_users': 6.6364, 'loss': 0.0229, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9251, 'compress@10': 0.9042, 'time@10': 9.5469}:  37%|███▋      | 11/30 [01:16<02:25,  7.63s/it]{'epoch': 42, 'num_users': 6.4167, 'loss': 0.0212, 'hit_ratio@10': 0.844, 'ndcg@10': 0.9244, 'compress@10': 0.9045, 'time@10': 9.2064}:  37%|███▋      | 11/30 [01:21<02:25,  7.63s/it] {'epoch': 42, 'num_users': 6.4167, 'loss': 0.0212, 'hit_ratio@10': 0.844, 'ndcg@10': 0.9244, 'compress@10': 0.9045, 'time@10': 9.2064}:  40%|████      | 12/30 [01:21<02:05,  6.98s/it]{'epoch': 42, 'num_users': 6.6154, 'loss': 0.0213, 'hit_ratio@10': 0.842, 'ndcg@10': 0.9236, 'compress@10': 0.9045, 'time@10': 9.3597}:  40%|████      | 12/30 [01:27<02:05,  6.98s/it]{'epoch': 42, 'num_users': 6.6154, 'loss': 0.0213, 'hit_ratio@10': 0.842, 'ndcg@10': 0.9236, 'compress@10': 0.9045, 'time@10': 9.3597}:  43%|████▎     | 13/30 [01:27<01:51,  6.58s/it]{'epoch': 42, 'num_users': 6.3571, 'loss': 0.0198, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.9172, 'compress@10': 0.9054, 'time@10': 9.0486}:  43%|████▎     | 13/30 [01:32<01:51,  6.58s/it]{'epoch': 42, 'num_users': 6.3571, 'loss': 0.0198, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.9172, 'compress@10': 0.9054, 'time@10': 9.0486}:  47%|████▋     | 14/30 [01:32<01:37,  6.11s/it]{'epoch': 42, 'num_users': 6.2667, 'loss': 0.0195, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9181, 'compress@10': 0.9053, 'time@10': 9.2756}:  47%|████▋     | 14/30 [01:38<01:37,  6.11s/it]{'epoch': 42, 'num_users': 6.2667, 'loss': 0.0195, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9181, 'compress@10': 0.9053, 'time@10': 9.2756}:  50%|█████     | 15/30 [01:38<01:32,  6.16s/it]{'epoch': 42, 'num_users': 6.0625, 'loss': 0.0183, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.918, 'compress@10': 0.9055, 'time@10': 9.0312}:  50%|█████     | 15/30 [01:43<01:32,  6.16s/it] {'epoch': 42, 'num_users': 6.0625, 'loss': 0.0183, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.918, 'compress@10': 0.9055, 'time@10': 9.0312}:  53%|█████▎    | 16/30 [01:43<01:23,  5.93s/it]{'epoch': 42, 'num_users': 5.8235, 'loss': 0.0173, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.9094, 'compress@10': 0.9063, 'time@10': 8.8067}:  53%|█████▎    | 16/30 [01:46<01:23,  5.93s/it]{'epoch': 42, 'num_users': 5.8235, 'loss': 0.0173, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.9094, 'compress@10': 0.9063, 'time@10': 8.8067}:  57%|█████▋    | 17/30 [01:46<01:04,  4.94s/it]{'epoch': 42, 'num_users': 6.0556, 'loss': 0.0174, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.911, 'compress@10': 0.9062, 'time@10': 8.7257}:  57%|█████▋    | 17/30 [01:53<01:04,  4.94s/it] {'epoch': 42, 'num_users': 6.0556, 'loss': 0.0174, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.911, 'compress@10': 0.9062, 'time@10': 8.7257}:  60%|██████    | 18/30 [01:53<01:08,  5.68s/it]{'epoch': 42, 'num_users': 6.0, 'loss': 0.0168, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.9117, 'compress@10': 0.9062, 'time@10': 8.6237}:  60%|██████    | 18/30 [01:57<01:08,  5.68s/it]  {'epoch': 42, 'num_users': 6.0, 'loss': 0.0168, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.9117, 'compress@10': 0.9062, 'time@10': 8.6237}:  63%|██████▎   | 19/30 [01:57<00:55,  5.00s/it]{'epoch': 42, 'num_users': 6.15, 'loss': 0.0168, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.9139, 'compress@10': 0.906, 'time@10': 8.8451}:  63%|██████▎   | 19/30 [02:10<00:55,  5.00s/it]{'epoch': 42, 'num_users': 6.15, 'loss': 0.0168, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.9139, 'compress@10': 0.906, 'time@10': 8.8451}:  67%|██████▋   | 20/30 [02:10<01:14,  7.43s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0179, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.9114, 'compress@10': 0.9058, 'time@10': 8.9221}:  67%|██████▋   | 20/30 [02:15<01:14,  7.43s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0179, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.9114, 'compress@10': 0.9058, 'time@10': 8.9221}:  70%|███████   | 21/30 [02:15<01:01,  6.78s/it]{'epoch': 42, 'num_users': 6.1818, 'loss': 0.0181, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.9117, 'compress@10': 0.9058, 'time@10': 8.7925}:  70%|███████   | 21/30 [02:21<01:01,  6.78s/it]{'epoch': 42, 'num_users': 6.1818, 'loss': 0.0181, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.9117, 'compress@10': 0.9058, 'time@10': 8.7925}:  73%|███████▎  | 22/30 [02:21<00:52,  6.58s/it]{'epoch': 42, 'num_users': 6.1304, 'loss': 0.0177, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.9126, 'compress@10': 0.9057, 'time@10': 8.8409}:  73%|███████▎  | 22/30 [02:26<00:52,  6.58s/it]{'epoch': 42, 'num_users': 6.1304, 'loss': 0.0177, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.9126, 'compress@10': 0.9057, 'time@10': 8.8409}:  77%|███████▋  | 23/30 [02:26<00:42,  6.10s/it]{'epoch': 42, 'num_users': 5.9583, 'loss': 0.017, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.9079, 'compress@10': 0.9063, 'time@10': 8.6708}:  77%|███████▋  | 23/30 [02:31<00:42,  6.10s/it] {'epoch': 42, 'num_users': 5.9583, 'loss': 0.017, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.9079, 'compress@10': 0.9063, 'time@10': 8.6708}:  80%|████████  | 24/30 [02:31<00:34,  5.71s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0164, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8983, 'compress@10': 0.9074, 'time@10': 8.5113}:  80%|████████  | 24/30 [02:34<00:34,  5.71s/it]  {'epoch': 42, 'num_users': 5.8, 'loss': 0.0164, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8983, 'compress@10': 0.9074, 'time@10': 8.5113}:  83%|████████▎ | 25/30 [02:34<00:23,  4.72s/it]{'epoch': 42, 'num_users': 5.8077, 'loss': 0.0162, 'hit_ratio@10': 0.848, 'ndcg@10': 0.901, 'compress@10': 0.9072, 'time@10': 8.6595}:  83%|████████▎ | 25/30 [02:46<00:23,  4.72s/it]{'epoch': 42, 'num_users': 5.8077, 'loss': 0.0162, 'hit_ratio@10': 0.848, 'ndcg@10': 0.901, 'compress@10': 0.9072, 'time@10': 8.6595}:  87%|████████▋ | 26/30 [02:46<00:28,  7.02s/it]{'epoch': 42, 'num_users': 5.8889, 'loss': 0.0161, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.9018, 'compress@10': 0.907, 'time@10': 8.7639}:  87%|████████▋ | 26/30 [02:52<00:28,  7.02s/it]{'epoch': 42, 'num_users': 5.8889, 'loss': 0.0161, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.9018, 'compress@10': 0.907, 'time@10': 8.7639}:  90%|█████████ | 27/30 [02:52<00:19,  6.65s/it]{'epoch': 42, 'num_users': 6.0, 'loss': 0.0157, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9044, 'compress@10': 0.9068, 'time@10': 8.923}:  90%|█████████ | 27/30 [03:05<00:19,  6.65s/it]   {'epoch': 42, 'num_users': 6.0, 'loss': 0.0157, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9044, 'compress@10': 0.9068, 'time@10': 8.923}:  93%|█████████▎| 28/30 [03:05<00:17,  8.63s/it]{'epoch': 42, 'num_users': 5.8621, 'loss': 0.0154, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.906, 'compress@10': 0.9068, 'time@10': 8.9889}:  93%|█████████▎| 28/30 [03:10<00:17,  8.63s/it]{'epoch': 42, 'num_users': 5.8621, 'loss': 0.0154, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.906, 'compress@10': 0.9068, 'time@10': 8.9889}:  97%|█████████▋| 29/30 [03:10<00:07,  7.68s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0159, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9068, 'compress@10': 0.9066, 'time@10': 8.9898}:  97%|█████████▋| 29/30 [03:19<00:07,  7.68s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0159, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9068, 'compress@10': 0.9066, 'time@10': 8.9898}: 100%|██████████| 30/30 [03:19<00:00,  8.09s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0159, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9068, 'compress@10': 0.9066, 'time@10': 8.9898}: 100%|██████████| 30/30 [03:19<00:00,  6.67s/it]
Epoch: 42
Avg # of users: 5.866666666666666
Avg Loss: 0.015892127594290758
Avg hit ratio: 0.8609133170747864
Avg ndcg: 0.9068397846763268
Avg compression ratio: 0.9066299355362235
Avg train time: 8.989760518074036
Std train time: 2.7870322569228696
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 49, 47, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9043, 'compress@10': 0.9052, 'time@10': 9.616}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9043, 'compress@10': 0.9052, 'time@10': 9.616}:   3%|▎         | 1/30 [00:04<02:20,  4.85s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9295, 'compress@10': 0.9042, 'time@10': 8.8579}:   3%|▎         | 1/30 [00:12<02:20,  4.85s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9295, 'compress@10': 0.9042, 'time@10': 8.8579}:   7%|▋         | 2/30 [00:12<03:09,  6.78s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9053, 'compress@10': 0.9076, 'time@10': 7.6843}:   7%|▋         | 2/30 [00:15<03:09,  6.78s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9053, 'compress@10': 0.9076, 'time@10': 7.6843}:  10%|█         | 3/30 [00:15<02:12,  4.92s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9222, 'compress@10': 0.9066, 'time@10': 7.4452}:  10%|█         | 3/30 [00:22<02:12,  4.92s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9222, 'compress@10': 0.9066, 'time@10': 7.4452}:  13%|█▎        | 4/30 [00:22<02:26,  5.65s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8997, 'compress@10': 0.9057, 'time@10': 7.9522}:  13%|█▎        | 4/30 [00:27<02:26,  5.65s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8997, 'compress@10': 0.9057, 'time@10': 7.9522}:  17%|█▋        | 5/30 [00:27<02:15,  5.42s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0218, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.9103, 'compress@10': 0.9051, 'time@10': 8.5806}:  17%|█▋        | 5/30 [00:39<02:15,  5.42s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0218, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.9103, 'compress@10': 0.9051, 'time@10': 8.5806}:  20%|██        | 6/30 [00:39<03:01,  7.58s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0218, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.909, 'compress@10': 0.9049, 'time@10': 8.8067}:  20%|██        | 6/30 [00:44<03:01,  7.58s/it] {'epoch': 43, 'num_users': 6.2857, 'loss': 0.0218, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.909, 'compress@10': 0.9049, 'time@10': 8.8067}:  23%|██▎       | 7/30 [00:44<02:35,  6.77s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0226, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.916, 'compress@10': 0.9047, 'time@10': 8.8053}:  23%|██▎       | 7/30 [00:53<02:35,  6.77s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0226, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.916, 'compress@10': 0.9047, 'time@10': 8.8053}:  27%|██▋       | 8/30 [00:53<02:43,  7.43s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0222, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9192, 'compress@10': 0.9045, 'time@10': 9.0129}:  27%|██▋       | 8/30 [00:58<02:43,  7.43s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0222, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9192, 'compress@10': 0.9045, 'time@10': 9.0129}:  30%|███       | 9/30 [00:58<02:22,  6.79s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9243, 'compress@10': 0.9042, 'time@10': 9.2066}:  30%|███       | 9/30 [01:09<02:22,  6.79s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9243, 'compress@10': 0.9042, 'time@10': 9.2066}:  33%|███▎      | 10/30 [01:09<02:41,  8.08s/it]{'epoch': 43, 'num_users': 6.6364, 'loss': 0.0217, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9227, 'compress@10': 0.9042, 'time@10': 9.5343}:  33%|███▎      | 10/30 [01:15<02:41,  8.08s/it]{'epoch': 43, 'num_users': 6.6364, 'loss': 0.0217, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9227, 'compress@10': 0.9042, 'time@10': 9.5343}:  37%|███▋      | 11/30 [01:15<02:24,  7.58s/it]{'epoch': 43, 'num_users': 6.4167, 'loss': 0.02, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9222, 'compress@10': 0.9045, 'time@10': 9.185}:  37%|███▋      | 11/30 [01:21<02:24,  7.58s/it]   {'epoch': 43, 'num_users': 6.4167, 'loss': 0.02, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9222, 'compress@10': 0.9045, 'time@10': 9.185}:  40%|████      | 12/30 [01:21<02:04,  6.91s/it]{'epoch': 43, 'num_users': 6.6154, 'loss': 0.0201, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9221, 'compress@10': 0.9045, 'time@10': 9.2865}:  40%|████      | 12/30 [01:26<02:04,  6.91s/it]{'epoch': 43, 'num_users': 6.6154, 'loss': 0.0201, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9221, 'compress@10': 0.9045, 'time@10': 9.2865}:  43%|████▎     | 13/30 [01:26<01:49,  6.42s/it]{'epoch': 43, 'num_users': 6.3571, 'loss': 0.0187, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9158, 'compress@10': 0.9054, 'time@10': 8.9835}:  43%|████▎     | 13/30 [01:31<01:49,  6.42s/it]{'epoch': 43, 'num_users': 6.3571, 'loss': 0.0187, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9158, 'compress@10': 0.9054, 'time@10': 8.9835}:  47%|████▋     | 14/30 [01:31<01:36,  6.01s/it]{'epoch': 43, 'num_users': 6.2667, 'loss': 0.0195, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9127, 'compress@10': 0.9053, 'time@10': 9.2099}:  47%|████▋     | 14/30 [01:37<01:36,  6.01s/it] {'epoch': 43, 'num_users': 6.2667, 'loss': 0.0195, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9127, 'compress@10': 0.9053, 'time@10': 9.2099}:  50%|█████     | 15/30 [01:37<01:31,  6.08s/it]{'epoch': 43, 'num_users': 6.0625, 'loss': 0.0184, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.913, 'compress@10': 0.9055, 'time@10': 8.9818}:  50%|█████     | 15/30 [01:43<01:31,  6.08s/it]{'epoch': 43, 'num_users': 6.0625, 'loss': 0.0184, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.913, 'compress@10': 0.9055, 'time@10': 8.9818}:  53%|█████▎    | 16/30 [01:43<01:23,  5.93s/it]{'epoch': 43, 'num_users': 5.8235, 'loss': 0.0174, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9046, 'compress@10': 0.9063, 'time@10': 8.7634}:  53%|█████▎    | 16/30 [01:46<01:23,  5.93s/it]{'epoch': 43, 'num_users': 5.8235, 'loss': 0.0174, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9046, 'compress@10': 0.9063, 'time@10': 8.7634}:  57%|█████▋    | 17/30 [01:46<01:04,  4.95s/it]{'epoch': 43, 'num_users': 6.0556, 'loss': 0.0172, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.9062, 'compress@10': 0.9062, 'time@10': 8.668}:  57%|█████▋    | 17/30 [01:53<01:04,  4.95s/it] {'epoch': 43, 'num_users': 6.0556, 'loss': 0.0172, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.9062, 'compress@10': 0.9062, 'time@10': 8.668}:  60%|██████    | 18/30 [01:53<01:07,  5.59s/it]{'epoch': 43, 'num_users': 6.0, 'loss': 0.0168, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.9071, 'compress@10': 0.9062, 'time@10': 8.5702}:  60%|██████    | 18/30 [01:56<01:07,  5.59s/it]  {'epoch': 43, 'num_users': 6.0, 'loss': 0.0168, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.9071, 'compress@10': 0.9062, 'time@10': 8.5702}:  63%|██████▎   | 19/30 [01:56<00:54,  4.95s/it]{'epoch': 43, 'num_users': 6.15, 'loss': 0.0176, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9098, 'compress@10': 0.906, 'time@10': 8.7921}:  63%|██████▎   | 19/30 [02:09<00:54,  4.95s/it]{'epoch': 43, 'num_users': 6.15, 'loss': 0.0176, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9098, 'compress@10': 0.906, 'time@10': 8.7921}:  67%|██████▋   | 20/30 [02:09<01:13,  7.38s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9075, 'compress@10': 0.9058, 'time@10': 8.8327}:  67%|██████▋   | 20/30 [02:14<01:13,  7.38s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9075, 'compress@10': 0.9058, 'time@10': 8.8327}:  70%|███████   | 21/30 [02:14<00:59,  6.62s/it]{'epoch': 43, 'num_users': 6.1818, 'loss': 0.0187, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.9086, 'compress@10': 0.9058, 'time@10': 8.6946}:  70%|███████   | 21/30 [02:20<00:59,  6.62s/it]{'epoch': 43, 'num_users': 6.1818, 'loss': 0.0187, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.9086, 'compress@10': 0.9058, 'time@10': 8.6946}:  73%|███████▎  | 22/30 [02:20<00:51,  6.38s/it]{'epoch': 43, 'num_users': 6.1304, 'loss': 0.0183, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9099, 'compress@10': 0.9057, 'time@10': 8.7577}:  73%|███████▎  | 22/30 [02:25<00:51,  6.38s/it]{'epoch': 43, 'num_users': 6.1304, 'loss': 0.0183, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9099, 'compress@10': 0.9057, 'time@10': 8.7577}:  77%|███████▋  | 23/30 [02:25<00:42,  6.00s/it]{'epoch': 43, 'num_users': 5.9583, 'loss': 0.0175, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.9053, 'compress@10': 0.9063, 'time@10': 8.5972}:  77%|███████▋  | 23/30 [02:30<00:42,  6.00s/it]{'epoch': 43, 'num_users': 5.9583, 'loss': 0.0175, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.9053, 'compress@10': 0.9063, 'time@10': 8.5972}:  80%|████████  | 24/30 [02:30<00:34,  5.68s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8957, 'compress@10': 0.9074, 'time@10': 8.4471}:  80%|████████  | 24/30 [02:32<00:34,  5.68s/it]   {'epoch': 43, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8957, 'compress@10': 0.9074, 'time@10': 8.4471}:  83%|████████▎ | 25/30 [02:32<00:23,  4.72s/it]{'epoch': 43, 'num_users': 5.8077, 'loss': 0.0167, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8986, 'compress@10': 0.9072, 'time@10': 8.607}:  83%|████████▎ | 25/30 [02:45<00:23,  4.72s/it]{'epoch': 43, 'num_users': 5.8077, 'loss': 0.0167, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8986, 'compress@10': 0.9072, 'time@10': 8.607}:  87%|████████▋ | 26/30 [02:45<00:28,  7.09s/it]{'epoch': 43, 'num_users': 5.8889, 'loss': 0.0165, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.9004, 'compress@10': 0.907, 'time@10': 8.6985}:  87%|████████▋ | 26/30 [02:51<00:28,  7.09s/it]{'epoch': 43, 'num_users': 5.8889, 'loss': 0.0165, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.9004, 'compress@10': 0.907, 'time@10': 8.6985}:  90%|█████████ | 27/30 [02:51<00:19,  6.64s/it]{'epoch': 43, 'num_users': 6.0, 'loss': 0.0161, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.9031, 'compress@10': 0.9068, 'time@10': 8.854}:  90%|█████████ | 27/30 [03:04<00:19,  6.64s/it]   {'epoch': 43, 'num_users': 6.0, 'loss': 0.0161, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.9031, 'compress@10': 0.9068, 'time@10': 8.854}:  93%|█████████▎| 28/30 [03:04<00:17,  8.58s/it]{'epoch': 43, 'num_users': 5.8621, 'loss': 0.0158, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9048, 'compress@10': 0.9068, 'time@10': 8.901}:  93%|█████████▎| 28/30 [03:09<00:17,  8.58s/it]{'epoch': 43, 'num_users': 5.8621, 'loss': 0.0158, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9048, 'compress@10': 0.9068, 'time@10': 8.901}:  97%|█████████▋| 29/30 [03:09<00:07,  7.55s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0159, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9056, 'compress@10': 0.9066, 'time@10': 8.8992}:  97%|█████████▋| 29/30 [03:18<00:07,  7.55s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0159, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9056, 'compress@10': 0.9066, 'time@10': 8.8992}: 100%|██████████| 30/30 [03:18<00:00,  7.95s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0159, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9056, 'compress@10': 0.9066, 'time@10': 8.8992}: 100%|██████████| 30/30 [03:18<00:00,  6.61s/it]
Epoch: 43
Avg # of users: 5.866666666666666
Avg Loss: 0.015883968010664582
Avg hit ratio: 0.8701816813612699
Avg ndcg: 0.9056312774622981
Avg compression ratio: 0.9066299459516246
Avg train time: 8.89922604560852
Std train time: 2.7370572705336422
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 49, 47, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0217, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.907, 'compress@10': 0.9052, 'time@10': 9.6001}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0217, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.907, 'compress@10': 0.9052, 'time@10': 9.6001}:   3%|▎         | 1/30 [00:04<02:20,  4.84s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.932, 'compress@10': 0.9042, 'time@10': 8.7695}:   3%|▎         | 1/30 [00:12<02:20,  4.84s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.932, 'compress@10': 0.9042, 'time@10': 8.7695}:   7%|▋         | 2/30 [00:12<03:07,  6.68s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9071, 'compress@10': 0.9076, 'time@10': 7.5572}:   7%|▋         | 2/30 [00:15<03:07,  6.68s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9071, 'compress@10': 0.9076, 'time@10': 7.5572}:  10%|█         | 3/30 [00:15<02:10,  4.82s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9345, 'compress@10': 0.9066, 'time@10': 7.3836}:  10%|█         | 3/30 [00:22<02:10,  4.82s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9345, 'compress@10': 0.9066, 'time@10': 7.3836}:  13%|█▎        | 4/30 [00:22<02:26,  5.64s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9107, 'compress@10': 0.9057, 'time@10': 7.9591}:  13%|█▎        | 4/30 [00:27<02:26,  5.64s/it] {'epoch': 44, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9107, 'compress@10': 0.9057, 'time@10': 7.9591}:  17%|█▋        | 5/30 [00:27<02:16,  5.47s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0208, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9191, 'compress@10': 0.9051, 'time@10': 8.5748}:  17%|█▋        | 5/30 [00:39<02:16,  5.47s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0208, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9191, 'compress@10': 0.9051, 'time@10': 8.5748}:  20%|██        | 6/30 [00:39<03:02,  7.58s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9163, 'compress@10': 0.9049, 'time@10': 8.7933}:  20%|██        | 6/30 [00:44<03:02,  7.58s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9163, 'compress@10': 0.9049, 'time@10': 8.7933}:  23%|██▎       | 7/30 [00:44<02:35,  6.77s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0217, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9232, 'compress@10': 0.9047, 'time@10': 8.8107}:  23%|██▎       | 7/30 [00:53<02:35,  6.77s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0217, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9232, 'compress@10': 0.9047, 'time@10': 8.8107}:  27%|██▋       | 8/30 [00:53<02:44,  7.47s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0214, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9258, 'compress@10': 0.9045, 'time@10': 9.07}:  27%|██▋       | 8/30 [00:58<02:44,  7.47s/it] {'epoch': 44, 'num_users': 6.3333, 'loss': 0.0214, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9258, 'compress@10': 0.9045, 'time@10': 9.07}:  30%|███       | 9/30 [00:58<02:24,  6.89s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9326, 'compress@10': 0.9042, 'time@10': 9.273}:  30%|███       | 9/30 [01:09<02:24,  6.89s/it]  {'epoch': 44, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9326, 'compress@10': 0.9042, 'time@10': 9.273}:  33%|███▎      | 10/30 [01:09<02:43,  8.20s/it]{'epoch': 44, 'num_users': 6.6364, 'loss': 0.0246, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9437, 'compress@10': 0.9042, 'time@10': 9.6412}:  33%|███▎      | 10/30 [01:16<02:43,  8.20s/it]{'epoch': 44, 'num_users': 6.6364, 'loss': 0.0246, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9437, 'compress@10': 0.9042, 'time@10': 9.6412}:  37%|███▋      | 11/30 [01:16<02:27,  7.74s/it]{'epoch': 44, 'num_users': 6.4167, 'loss': 0.0226, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9415, 'compress@10': 0.9045, 'time@10': 9.2869}:  37%|███▋      | 11/30 [01:22<02:27,  7.74s/it]{'epoch': 44, 'num_users': 6.4167, 'loss': 0.0226, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9415, 'compress@10': 0.9045, 'time@10': 9.2869}:  40%|████      | 12/30 [01:22<02:06,  7.04s/it]{'epoch': 44, 'num_users': 6.6154, 'loss': 0.0225, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9398, 'compress@10': 0.9045, 'time@10': 9.3955}:  40%|████      | 12/30 [01:27<02:06,  7.04s/it]{'epoch': 44, 'num_users': 6.6154, 'loss': 0.0225, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9398, 'compress@10': 0.9045, 'time@10': 9.3955}:  43%|████▎     | 13/30 [01:27<01:51,  6.54s/it]{'epoch': 44, 'num_users': 6.3571, 'loss': 0.0209, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9322, 'compress@10': 0.9054, 'time@10': 9.0745}:  43%|████▎     | 13/30 [01:32<01:51,  6.54s/it] {'epoch': 44, 'num_users': 6.3571, 'loss': 0.0209, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9322, 'compress@10': 0.9054, 'time@10': 9.0745}:  47%|████▋     | 14/30 [01:32<01:36,  6.06s/it]{'epoch': 44, 'num_users': 6.2667, 'loss': 0.0202, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9326, 'compress@10': 0.9053, 'time@10': 9.3031}:  47%|████▋     | 14/30 [01:38<01:36,  6.06s/it]{'epoch': 44, 'num_users': 6.2667, 'loss': 0.0202, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9326, 'compress@10': 0.9053, 'time@10': 9.3031}:  50%|█████     | 15/30 [01:38<01:31,  6.13s/it]{'epoch': 44, 'num_users': 6.0625, 'loss': 0.019, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9316, 'compress@10': 0.9055, 'time@10': 9.0554}:  50%|█████     | 15/30 [01:44<01:31,  6.13s/it]  {'epoch': 44, 'num_users': 6.0625, 'loss': 0.019, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9316, 'compress@10': 0.9055, 'time@10': 9.0554}:  53%|█████▎    | 16/30 [01:44<01:22,  5.90s/it]{'epoch': 44, 'num_users': 5.8235, 'loss': 0.018, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.9239, 'compress@10': 0.9063, 'time@10': 8.8334}:  53%|█████▎    | 16/30 [01:46<01:22,  5.90s/it]{'epoch': 44, 'num_users': 5.8235, 'loss': 0.018, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.9239, 'compress@10': 0.9063, 'time@10': 8.8334}:  57%|█████▋    | 17/30 [01:46<01:04,  4.93s/it]{'epoch': 44, 'num_users': 6.0556, 'loss': 0.0187, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.9279, 'compress@10': 0.9062, 'time@10': 8.7293}:  57%|█████▋    | 17/30 [01:53<01:04,  4.93s/it]{'epoch': 44, 'num_users': 6.0556, 'loss': 0.0187, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.9279, 'compress@10': 0.9062, 'time@10': 8.7293}:  60%|██████    | 18/30 [01:53<01:06,  5.55s/it]{'epoch': 44, 'num_users': 6.0, 'loss': 0.0181, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.9277, 'compress@10': 0.9062, 'time@10': 8.6236}:  60%|██████    | 18/30 [01:57<01:06,  5.55s/it]   {'epoch': 44, 'num_users': 6.0, 'loss': 0.0181, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.9277, 'compress@10': 0.9062, 'time@10': 8.6236}:  63%|██████▎   | 19/30 [01:57<00:53,  4.90s/it]{'epoch': 44, 'num_users': 6.15, 'loss': 0.0179, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9292, 'compress@10': 0.906, 'time@10': 8.8697}:  63%|██████▎   | 19/30 [02:10<00:53,  4.90s/it]{'epoch': 44, 'num_users': 6.15, 'loss': 0.0179, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9292, 'compress@10': 0.906, 'time@10': 8.8697}:  67%|██████▋   | 20/30 [02:10<01:15,  7.51s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.9263, 'compress@10': 0.9058, 'time@10': 8.9095}:  67%|██████▋   | 20/30 [02:15<01:15,  7.51s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.9263, 'compress@10': 0.9058, 'time@10': 8.9095}:  70%|███████   | 21/30 [02:15<01:00,  6.72s/it]{'epoch': 44, 'num_users': 6.1818, 'loss': 0.0188, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9259, 'compress@10': 0.9058, 'time@10': 8.7652}:  70%|███████   | 21/30 [02:21<01:00,  6.72s/it]{'epoch': 44, 'num_users': 6.1818, 'loss': 0.0188, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9259, 'compress@10': 0.9058, 'time@10': 8.7652}:  73%|███████▎  | 22/30 [02:21<00:51,  6.44s/it]{'epoch': 44, 'num_users': 6.1304, 'loss': 0.0184, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9267, 'compress@10': 0.9057, 'time@10': 8.8108}:  73%|███████▎  | 22/30 [02:26<00:51,  6.44s/it]{'epoch': 44, 'num_users': 6.1304, 'loss': 0.0184, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9267, 'compress@10': 0.9057, 'time@10': 8.8108}:  77%|███████▋  | 23/30 [02:26<00:41,  5.99s/it]{'epoch': 44, 'num_users': 5.9583, 'loss': 0.0176, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9214, 'compress@10': 0.9063, 'time@10': 8.6452}:  77%|███████▋  | 23/30 [02:31<00:41,  5.99s/it] {'epoch': 44, 'num_users': 5.9583, 'loss': 0.0176, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9214, 'compress@10': 0.9063, 'time@10': 8.6452}:  80%|████████  | 24/30 [02:31<00:33,  5.65s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.9112, 'compress@10': 0.9074, 'time@10': 8.4886}:  80%|████████  | 24/30 [02:33<00:33,  5.65s/it]   {'epoch': 44, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.9112, 'compress@10': 0.9074, 'time@10': 8.4886}:  83%|████████▎ | 25/30 [02:33<00:23,  4.68s/it]{'epoch': 44, 'num_users': 5.8077, 'loss': 0.0168, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9134, 'compress@10': 0.9072, 'time@10': 8.646}:  83%|████████▎ | 25/30 [02:46<00:23,  4.68s/it]{'epoch': 44, 'num_users': 5.8077, 'loss': 0.0168, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9134, 'compress@10': 0.9072, 'time@10': 8.646}:  87%|████████▋ | 26/30 [02:46<00:28,  7.06s/it]{'epoch': 44, 'num_users': 5.8889, 'loss': 0.0165, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.9148, 'compress@10': 0.907, 'time@10': 8.7379}:  87%|████████▋ | 26/30 [02:51<00:28,  7.06s/it]{'epoch': 44, 'num_users': 5.8889, 'loss': 0.0165, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.9148, 'compress@10': 0.907, 'time@10': 8.7379}:  90%|█████████ | 27/30 [02:51<00:19,  6.62s/it]{'epoch': 44, 'num_users': 6.0, 'loss': 0.0175, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.9187, 'compress@10': 0.9068, 'time@10': 8.8981}:  90%|█████████ | 27/30 [03:05<00:19,  6.62s/it]  {'epoch': 44, 'num_users': 6.0, 'loss': 0.0175, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.9187, 'compress@10': 0.9068, 'time@10': 8.8981}:  93%|█████████▎| 28/30 [03:05<00:17,  8.61s/it]{'epoch': 44, 'num_users': 5.8621, 'loss': 0.0172, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9198, 'compress@10': 0.9068, 'time@10': 8.9427}:  93%|█████████▎| 28/30 [03:10<00:17,  8.61s/it]{'epoch': 44, 'num_users': 5.8621, 'loss': 0.0172, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9198, 'compress@10': 0.9068, 'time@10': 8.9427}:  97%|█████████▋| 29/30 [03:10<00:07,  7.57s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0174, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9193, 'compress@10': 0.9066, 'time@10': 8.9487}:  97%|█████████▋| 29/30 [03:19<00:07,  7.57s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0174, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9193, 'compress@10': 0.9066, 'time@10': 8.9487}: 100%|██████████| 30/30 [03:19<00:00,  8.05s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0174, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9193, 'compress@10': 0.9066, 'time@10': 8.9487}: 100%|██████████| 30/30 [03:19<00:00,  6.65s/it]
Epoch: 44
Avg # of users: 5.866666666666666
Avg Loss: 0.01740129089351699
Avg hit ratio: 0.8675338914306548
Avg ndcg: 0.9193177224613468
Avg compression ratio: 0.9066299415561528
Avg train time: 8.948688459396362
Std train time: 2.8561954360305832
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 49, 48, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.907, 'compress@10': 0.9052, 'time@10': 9.393}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.907, 'compress@10': 0.9052, 'time@10': 9.393}:   3%|▎         | 1/30 [00:04<02:17,  4.73s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9233, 'compress@10': 0.9042, 'time@10': 8.5678}:   3%|▎         | 1/30 [00:12<02:17,  4.73s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9233, 'compress@10': 0.9042, 'time@10': 8.5678}:   7%|▋         | 2/30 [00:12<03:02,  6.53s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9013, 'compress@10': 0.9076, 'time@10': 7.4619}:   7%|▋         | 2/30 [00:15<03:02,  6.53s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9013, 'compress@10': 0.9076, 'time@10': 7.4619}:  10%|█         | 3/30 [00:15<02:08,  4.76s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9349, 'compress@10': 0.9066, 'time@10': 7.3687}:  10%|█         | 3/30 [00:22<02:08,  4.76s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9349, 'compress@10': 0.9066, 'time@10': 7.3687}:  13%|█▎        | 4/30 [00:22<02:28,  5.70s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9107, 'compress@10': 0.9057, 'time@10': 7.8871}:  13%|█▎        | 4/30 [00:27<02:28,  5.70s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9107, 'compress@10': 0.9057, 'time@10': 7.8871}:  17%|█▋        | 5/30 [00:27<02:16,  5.46s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0226, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.9197, 'compress@10': 0.9051, 'time@10': 8.5024}:  17%|█▋        | 5/30 [00:38<02:16,  5.46s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0226, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.9197, 'compress@10': 0.9051, 'time@10': 8.5024}:  20%|██        | 6/30 [00:38<03:01,  7.55s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9173, 'compress@10': 0.9049, 'time@10': 8.7539}:  20%|██        | 6/30 [00:44<03:01,  7.55s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9173, 'compress@10': 0.9049, 'time@10': 8.7539}:  23%|██▎       | 7/30 [00:44<02:35,  6.77s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9234, 'compress@10': 0.9047, 'time@10': 8.7663}:  23%|██▎       | 7/30 [00:53<02:35,  6.77s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9234, 'compress@10': 0.9047, 'time@10': 8.7663}:  27%|██▋       | 8/30 [00:53<02:43,  7.45s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9261, 'compress@10': 0.9045, 'time@10': 8.9492}:  27%|██▋       | 8/30 [00:58<02:43,  7.45s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9261, 'compress@10': 0.9045, 'time@10': 8.9492}:  30%|███       | 9/30 [00:58<02:21,  6.76s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9306, 'compress@10': 0.9042, 'time@10': 9.1524}:  30%|███       | 9/30 [01:09<02:21,  6.76s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9306, 'compress@10': 0.9042, 'time@10': 9.1524}:  33%|███▎      | 10/30 [01:09<02:41,  8.07s/it]{'epoch': 45, 'num_users': 6.6364, 'loss': 0.0201, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9303, 'compress@10': 0.9042, 'time@10': 9.5075}:  33%|███▎      | 10/30 [01:15<02:41,  8.07s/it]{'epoch': 45, 'num_users': 6.6364, 'loss': 0.0201, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9303, 'compress@10': 0.9042, 'time@10': 9.5075}:  37%|███▋      | 11/30 [01:15<02:24,  7.61s/it]{'epoch': 45, 'num_users': 6.4167, 'loss': 0.0186, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.9292, 'compress@10': 0.9045, 'time@10': 9.1542}:  37%|███▋      | 11/30 [01:21<02:24,  7.61s/it]{'epoch': 45, 'num_users': 6.4167, 'loss': 0.0186, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.9292, 'compress@10': 0.9045, 'time@10': 9.1542}:  40%|████      | 12/30 [01:21<02:04,  6.91s/it]{'epoch': 45, 'num_users': 6.6154, 'loss': 0.0187, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9285, 'compress@10': 0.9045, 'time@10': 9.2926}:  40%|████      | 12/30 [01:26<02:04,  6.91s/it]{'epoch': 45, 'num_users': 6.6154, 'loss': 0.0187, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9285, 'compress@10': 0.9045, 'time@10': 9.2926}:  43%|████▎     | 13/30 [01:26<01:50,  6.49s/it]{'epoch': 45, 'num_users': 6.3571, 'loss': 0.0174, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.9217, 'compress@10': 0.9054, 'time@10': 8.9883}:  43%|████▎     | 13/30 [01:31<01:50,  6.49s/it]{'epoch': 45, 'num_users': 6.3571, 'loss': 0.0174, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.9217, 'compress@10': 0.9054, 'time@10': 8.9883}:  47%|████▋     | 14/30 [01:31<01:36,  6.06s/it]{'epoch': 45, 'num_users': 6.2667, 'loss': 0.0175, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.9237, 'compress@10': 0.9053, 'time@10': 9.2045}:  47%|████▋     | 14/30 [01:38<01:36,  6.06s/it]{'epoch': 45, 'num_users': 6.2667, 'loss': 0.0175, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.9237, 'compress@10': 0.9053, 'time@10': 9.2045}:  50%|█████     | 15/30 [01:38<01:32,  6.19s/it]{'epoch': 45, 'num_users': 6.0625, 'loss': 0.0165, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.9233, 'compress@10': 0.9055, 'time@10': 8.9624}:  50%|█████     | 15/30 [01:43<01:32,  6.19s/it]{'epoch': 45, 'num_users': 6.0625, 'loss': 0.0165, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.9233, 'compress@10': 0.9055, 'time@10': 8.9624}:  53%|█████▎    | 16/30 [01:43<01:23,  5.94s/it]{'epoch': 45, 'num_users': 5.8235, 'loss': 0.0156, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.916, 'compress@10': 0.9063, 'time@10': 8.7448}:  53%|█████▎    | 16/30 [01:46<01:23,  5.94s/it] {'epoch': 45, 'num_users': 5.8235, 'loss': 0.0156, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.916, 'compress@10': 0.9063, 'time@10': 8.7448}:  57%|█████▋    | 17/30 [01:46<01:04,  4.96s/it]{'epoch': 45, 'num_users': 6.0556, 'loss': 0.017, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.9256, 'compress@10': 0.9062, 'time@10': 8.6397}:  57%|█████▋    | 17/30 [01:53<01:04,  4.96s/it]{'epoch': 45, 'num_users': 6.0556, 'loss': 0.017, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.9256, 'compress@10': 0.9062, 'time@10': 8.6397}:  60%|██████    | 18/30 [01:53<01:06,  5.54s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 0.0165, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.9255, 'compress@10': 0.9062, 'time@10': 8.5526}:  60%|██████    | 18/30 [01:56<01:06,  5.54s/it]  {'epoch': 45, 'num_users': 6.0, 'loss': 0.0165, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.9255, 'compress@10': 0.9062, 'time@10': 8.5526}:  63%|██████▎   | 19/30 [01:56<00:54,  4.93s/it]{'epoch': 45, 'num_users': 6.15, 'loss': 0.0172, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9282, 'compress@10': 0.906, 'time@10': 8.7838}:  63%|██████▎   | 19/30 [02:09<00:54,  4.93s/it]{'epoch': 45, 'num_users': 6.15, 'loss': 0.0172, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9282, 'compress@10': 0.906, 'time@10': 8.7838}:  67%|██████▋   | 20/30 [02:09<01:14,  7.42s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9256, 'compress@10': 0.9058, 'time@10': 8.8408}:  67%|██████▋   | 20/30 [02:14<01:14,  7.42s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9256, 'compress@10': 0.9058, 'time@10': 8.8408}:  70%|███████   | 21/30 [02:14<01:00,  6.70s/it]{'epoch': 45, 'num_users': 6.1818, 'loss': 0.018, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.9262, 'compress@10': 0.9058, 'time@10': 8.7107}:  70%|███████   | 21/30 [02:20<01:00,  6.70s/it]{'epoch': 45, 'num_users': 6.1818, 'loss': 0.018, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.9262, 'compress@10': 0.9058, 'time@10': 8.7107}:  73%|███████▎  | 22/30 [02:20<00:51,  6.49s/it]{'epoch': 45, 'num_users': 6.1304, 'loss': 0.0176, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.9271, 'compress@10': 0.9057, 'time@10': 8.7457}:  73%|███████▎  | 22/30 [02:25<00:51,  6.49s/it]{'epoch': 45, 'num_users': 6.1304, 'loss': 0.0176, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.9271, 'compress@10': 0.9057, 'time@10': 8.7457}:  77%|███████▋  | 23/30 [02:25<00:41,  5.98s/it]{'epoch': 45, 'num_users': 5.9583, 'loss': 0.0168, 'hit_ratio@10': 0.857, 'ndcg@10': 0.9218, 'compress@10': 0.9063, 'time@10': 8.5856}:  77%|███████▋  | 23/30 [02:30<00:41,  5.98s/it] {'epoch': 45, 'num_users': 5.9583, 'loss': 0.0168, 'hit_ratio@10': 0.857, 'ndcg@10': 0.9218, 'compress@10': 0.9063, 'time@10': 8.5856}:  80%|████████  | 24/30 [02:30<00:34,  5.67s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.9116, 'compress@10': 0.9074, 'time@10': 8.4492}:  80%|████████  | 24/30 [02:33<00:34,  5.67s/it]  {'epoch': 45, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.9116, 'compress@10': 0.9074, 'time@10': 8.4492}:  83%|████████▎ | 25/30 [02:33<00:23,  4.76s/it]{'epoch': 45, 'num_users': 5.8077, 'loss': 0.016, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9138, 'compress@10': 0.9072, 'time@10': 8.6085}:  83%|████████▎ | 25/30 [02:45<00:23,  4.76s/it]{'epoch': 45, 'num_users': 5.8077, 'loss': 0.016, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9138, 'compress@10': 0.9072, 'time@10': 8.6085}:  87%|████████▋ | 26/30 [02:45<00:28,  7.12s/it]{'epoch': 45, 'num_users': 5.8889, 'loss': 0.0158, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9149, 'compress@10': 0.907, 'time@10': 8.6985}:  87%|████████▋ | 26/30 [02:51<00:28,  7.12s/it]{'epoch': 45, 'num_users': 5.8889, 'loss': 0.0158, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9149, 'compress@10': 0.907, 'time@10': 8.6985}:  90%|█████████ | 27/30 [02:51<00:19,  6.65s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 0.0158, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9167, 'compress@10': 0.9068, 'time@10': 8.8576}:  90%|█████████ | 27/30 [03:04<00:19,  6.65s/it]  {'epoch': 45, 'num_users': 6.0, 'loss': 0.0158, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9167, 'compress@10': 0.9068, 'time@10': 8.8576}:  93%|█████████▎| 28/30 [03:04<00:17,  8.61s/it]{'epoch': 45, 'num_users': 5.8621, 'loss': 0.0155, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9178, 'compress@10': 0.9068, 'time@10': 8.9089}:  93%|█████████▎| 28/30 [03:09<00:17,  8.61s/it]{'epoch': 45, 'num_users': 5.8621, 'loss': 0.0155, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9178, 'compress@10': 0.9068, 'time@10': 8.9089}:  97%|█████████▋| 29/30 [03:09<00:07,  7.59s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.0159, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9171, 'compress@10': 0.9066, 'time@10': 8.906}:  97%|█████████▋| 29/30 [03:18<00:07,  7.59s/it]  {'epoch': 45, 'num_users': 5.8667, 'loss': 0.0159, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9171, 'compress@10': 0.9066, 'time@10': 8.906}: 100%|██████████| 30/30 [03:18<00:00,  7.97s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.0159, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9171, 'compress@10': 0.9066, 'time@10': 8.906}: 100%|██████████| 30/30 [03:18<00:00,  6.62s/it]
Epoch: 45
Avg # of users: 5.866666666666666
Avg Loss: 0.015864626755204607
Avg hit ratio: 0.8650006748045518
Avg ndcg: 0.9171381775756389
Avg compression ratio: 0.9066299327026645
Avg train time: 8.905985697110493
Std train time: 2.7455062480143573
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 49, 48, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9112, 'compress@10': 0.9052, 'time@10': 9.1308}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9112, 'compress@10': 0.9052, 'time@10': 9.1308}:   3%|▎         | 1/30 [00:04<02:13,  4.60s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9855, 'compress@10': 0.9042, 'time@10': 8.3147}:   3%|▎         | 1/30 [00:12<02:13,  4.60s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9855, 'compress@10': 0.9042, 'time@10': 8.3147}:   7%|▋         | 2/30 [00:12<02:57,  6.33s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9427, 'compress@10': 0.9076, 'time@10': 7.4175}:   7%|▋         | 2/30 [00:14<02:57,  6.33s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9427, 'compress@10': 0.9076, 'time@10': 7.4175}:  10%|█         | 3/30 [00:14<02:07,  4.74s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9424, 'compress@10': 0.9066, 'time@10': 7.2767}:  10%|█         | 3/30 [00:21<02:07,  4.74s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9424, 'compress@10': 0.9066, 'time@10': 7.2767}:  13%|█▎        | 4/30 [00:21<02:25,  5.59s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0219, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.9185, 'compress@10': 0.9057, 'time@10': 7.8122}:  13%|█▎        | 4/30 [00:26<02:25,  5.59s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0219, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.9185, 'compress@10': 0.9057, 'time@10': 7.8122}:  17%|█▋        | 5/30 [00:26<02:14,  5.38s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0227, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.9292, 'compress@10': 0.9051, 'time@10': 8.4723}:  17%|█▋        | 5/30 [00:38<02:14,  5.38s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0227, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.9292, 'compress@10': 0.9051, 'time@10': 8.4723}:  20%|██        | 6/30 [00:38<03:01,  7.57s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9262, 'compress@10': 0.9049, 'time@10': 8.6666}:  20%|██        | 6/30 [00:43<03:01,  7.57s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9262, 'compress@10': 0.9049, 'time@10': 8.6666}:  23%|██▎       | 7/30 [00:43<02:34,  6.71s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9318, 'compress@10': 0.9047, 'time@10': 8.6609}:  23%|██▎       | 7/30 [00:52<02:34,  6.71s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9318, 'compress@10': 0.9047, 'time@10': 8.6609}:  27%|██▋       | 8/30 [00:52<02:41,  7.33s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9337, 'compress@10': 0.9045, 'time@10': 8.8686}:  27%|██▋       | 8/30 [00:57<02:41,  7.33s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9337, 'compress@10': 0.9045, 'time@10': 8.8686}:  30%|███       | 9/30 [00:57<02:20,  6.70s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9381, 'compress@10': 0.9042, 'time@10': 9.0954}:  30%|███       | 9/30 [01:08<02:20,  6.70s/it]  {'epoch': 46, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9381, 'compress@10': 0.9042, 'time@10': 9.0954}:  33%|███▎      | 10/30 [01:08<02:41,  8.08s/it]{'epoch': 46, 'num_users': 6.6364, 'loss': 0.0229, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9374, 'compress@10': 0.9042, 'time@10': 9.4441}:  33%|███▎      | 10/30 [01:15<02:41,  8.08s/it]{'epoch': 46, 'num_users': 6.6364, 'loss': 0.0229, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9374, 'compress@10': 0.9042, 'time@10': 9.4441}:  37%|███▋      | 11/30 [01:15<02:24,  7.60s/it]{'epoch': 46, 'num_users': 6.4167, 'loss': 0.0211, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.9356, 'compress@10': 0.9045, 'time@10': 9.1038}:  37%|███▋      | 11/30 [01:20<02:24,  7.60s/it]{'epoch': 46, 'num_users': 6.4167, 'loss': 0.0211, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.9356, 'compress@10': 0.9045, 'time@10': 9.1038}:  40%|████      | 12/30 [01:20<02:04,  6.93s/it]{'epoch': 46, 'num_users': 6.6154, 'loss': 0.021, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9345, 'compress@10': 0.9045, 'time@10': 9.2296}:  40%|████      | 12/30 [01:26<02:04,  6.93s/it] {'epoch': 46, 'num_users': 6.6154, 'loss': 0.021, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9345, 'compress@10': 0.9045, 'time@10': 9.2296}:  43%|████▎     | 13/30 [01:26<01:49,  6.47s/it]{'epoch': 46, 'num_users': 6.3571, 'loss': 0.0195, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.9272, 'compress@10': 0.9054, 'time@10': 8.9229}:  43%|████▎     | 13/30 [01:31<01:49,  6.47s/it]{'epoch': 46, 'num_users': 6.3571, 'loss': 0.0195, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.9272, 'compress@10': 0.9054, 'time@10': 8.9229}:  47%|████▋     | 14/30 [01:31<01:36,  6.01s/it]{'epoch': 46, 'num_users': 6.2667, 'loss': 0.0211, 'hit_ratio@10': 0.839, 'ndcg@10': 0.9222, 'compress@10': 0.9053, 'time@10': 9.1342}:  47%|████▋     | 14/30 [01:37<01:36,  6.01s/it] {'epoch': 46, 'num_users': 6.2667, 'loss': 0.0211, 'hit_ratio@10': 0.839, 'ndcg@10': 0.9222, 'compress@10': 0.9053, 'time@10': 9.1342}:  50%|█████     | 15/30 [01:37<01:30,  6.03s/it]{'epoch': 46, 'num_users': 6.0625, 'loss': 0.0199, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.9218, 'compress@10': 0.9055, 'time@10': 8.9006}:  50%|█████     | 15/30 [01:42<01:30,  6.03s/it]{'epoch': 46, 'num_users': 6.0625, 'loss': 0.0199, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.9218, 'compress@10': 0.9055, 'time@10': 8.9006}:  53%|█████▎    | 16/30 [01:42<01:21,  5.85s/it]{'epoch': 46, 'num_users': 5.8235, 'loss': 0.0187, 'hit_ratio@10': 0.8197, 'ndcg@10': 0.9147, 'compress@10': 0.9063, 'time@10': 8.6881}:  53%|█████▎    | 16/30 [01:45<01:21,  5.85s/it]{'epoch': 46, 'num_users': 5.8235, 'loss': 0.0187, 'hit_ratio@10': 0.8197, 'ndcg@10': 0.9147, 'compress@10': 0.9063, 'time@10': 8.6881}:  57%|█████▋    | 17/30 [01:45<01:03,  4.90s/it]{'epoch': 46, 'num_users': 6.0556, 'loss': 0.0188, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.9164, 'compress@10': 0.9062, 'time@10': 8.5987}:  57%|█████▋    | 17/30 [01:52<01:03,  4.90s/it]{'epoch': 46, 'num_users': 6.0556, 'loss': 0.0188, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.9164, 'compress@10': 0.9062, 'time@10': 8.5987}:  60%|██████    | 18/30 [01:52<01:06,  5.57s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 0.0182, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.9168, 'compress@10': 0.9062, 'time@10': 8.503}:  60%|██████    | 18/30 [01:55<01:06,  5.57s/it]    {'epoch': 46, 'num_users': 6.0, 'loss': 0.0182, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.9168, 'compress@10': 0.9062, 'time@10': 8.503}:  63%|██████▎   | 19/30 [01:55<00:54,  4.92s/it]{'epoch': 46, 'num_users': 6.15, 'loss': 0.0181, 'hit_ratio@10': 0.837, 'ndcg@10': 0.919, 'compress@10': 0.906, 'time@10': 8.7421}:  63%|██████▎   | 19/30 [02:09<00:54,  4.92s/it] {'epoch': 46, 'num_users': 6.15, 'loss': 0.0181, 'hit_ratio@10': 0.837, 'ndcg@10': 0.919, 'compress@10': 0.906, 'time@10': 8.7421}:  67%|██████▋   | 20/30 [02:09<01:14,  7.44s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.9167, 'compress@10': 0.9058, 'time@10': 8.8026}:  67%|██████▋   | 20/30 [02:14<01:14,  7.44s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.9167, 'compress@10': 0.9058, 'time@10': 8.8026}:  70%|███████   | 21/30 [02:14<01:00,  6.72s/it]{'epoch': 46, 'num_users': 6.1818, 'loss': 0.0191, 'hit_ratio@10': 0.844, 'ndcg@10': 0.9157, 'compress@10': 0.9058, 'time@10': 8.6739}:  70%|███████   | 21/30 [02:20<01:00,  6.72s/it]{'epoch': 46, 'num_users': 6.1818, 'loss': 0.0191, 'hit_ratio@10': 0.844, 'ndcg@10': 0.9157, 'compress@10': 0.9058, 'time@10': 8.6739}:  73%|███████▎  | 22/30 [02:20<00:52,  6.51s/it]{'epoch': 46, 'num_users': 6.1304, 'loss': 0.0187, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.917, 'compress@10': 0.9057, 'time@10': 8.721}:  73%|███████▎  | 22/30 [02:25<00:52,  6.51s/it] {'epoch': 46, 'num_users': 6.1304, 'loss': 0.0187, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.917, 'compress@10': 0.9057, 'time@10': 8.721}:  77%|███████▋  | 23/30 [02:25<00:42,  6.03s/it]{'epoch': 46, 'num_users': 5.9583, 'loss': 0.0179, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9121, 'compress@10': 0.9063, 'time@10': 8.5604}:  77%|███████▋  | 23/30 [02:29<00:42,  6.03s/it]{'epoch': 46, 'num_users': 5.9583, 'loss': 0.0179, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9121, 'compress@10': 0.9063, 'time@10': 8.5604}:  80%|████████  | 24/30 [02:29<00:34,  5.69s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9023, 'compress@10': 0.9074, 'time@10': 8.4213}:  80%|████████  | 24/30 [02:32<00:34,  5.69s/it]   {'epoch': 46, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9023, 'compress@10': 0.9074, 'time@10': 8.4213}:  83%|████████▎ | 25/30 [02:32<00:23,  4.76s/it]{'epoch': 46, 'num_users': 5.8077, 'loss': 0.017, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.905, 'compress@10': 0.9072, 'time@10': 8.5756}:  83%|████████▎ | 25/30 [02:45<00:23,  4.76s/it]{'epoch': 46, 'num_users': 5.8077, 'loss': 0.017, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.905, 'compress@10': 0.9072, 'time@10': 8.5756}:  87%|████████▋ | 26/30 [02:45<00:28,  7.07s/it]{'epoch': 46, 'num_users': 5.8889, 'loss': 0.0169, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.9061, 'compress@10': 0.907, 'time@10': 8.6641}:  87%|████████▋ | 26/30 [02:50<00:28,  7.07s/it]{'epoch': 46, 'num_users': 5.8889, 'loss': 0.0169, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.9061, 'compress@10': 0.907, 'time@10': 8.6641}:  90%|█████████ | 27/30 [02:50<00:19,  6.61s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 0.0166, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.9085, 'compress@10': 0.9068, 'time@10': 8.8167}:  90%|█████████ | 27/30 [03:03<00:19,  6.61s/it]  {'epoch': 46, 'num_users': 6.0, 'loss': 0.0166, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.9085, 'compress@10': 0.9068, 'time@10': 8.8167}:  93%|█████████▎| 28/30 [03:03<00:17,  8.52s/it]{'epoch': 46, 'num_users': 5.8621, 'loss': 0.0163, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.91, 'compress@10': 0.9068, 'time@10': 8.8748}:  93%|█████████▎| 28/30 [03:08<00:17,  8.52s/it]{'epoch': 46, 'num_users': 5.8621, 'loss': 0.0163, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.91, 'compress@10': 0.9068, 'time@10': 8.8748}:  97%|█████████▋| 29/30 [03:08<00:07,  7.55s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.0166, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.9099, 'compress@10': 0.9066, 'time@10': 8.874}:  97%|█████████▋| 29/30 [03:17<00:07,  7.55s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.0166, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.9099, 'compress@10': 0.9066, 'time@10': 8.874}: 100%|██████████| 30/30 [03:17<00:00,  7.95s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.0166, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.9099, 'compress@10': 0.9066, 'time@10': 8.874}: 100%|██████████| 30/30 [03:17<00:00,  6.59s/it]
Epoch: 46
Avg # of users: 5.866666666666666
Avg Loss: 0.016580409755876917
Avg hit ratio: 0.8566846652466068
Avg ndcg: 0.9098763721096067
Avg compression ratio: 0.9066299411203959
Avg train time: 8.87398738861084
Std train time: 2.722217482391796
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 49, 48, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9112, 'compress@10': 0.9052, 'time@10': 9.3823}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9112, 'compress@10': 0.9052, 'time@10': 9.3823}:   3%|▎         | 1/30 [00:04<02:17,  4.75s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9346, 'compress@10': 0.9042, 'time@10': 8.4713}:   3%|▎         | 1/30 [00:12<02:17,  4.75s/it] {'epoch': 47, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9346, 'compress@10': 0.9042, 'time@10': 8.4713}:   7%|▋         | 2/30 [00:12<02:59,  6.42s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9088, 'compress@10': 0.9076, 'time@10': 7.3948}:   7%|▋         | 2/30 [00:15<02:59,  6.42s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9088, 'compress@10': 0.9076, 'time@10': 7.3948}:  10%|█         | 3/30 [00:15<02:07,  4.70s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9133, 'compress@10': 0.9066, 'time@10': 7.2721}:  10%|█         | 3/30 [00:21<02:07,  4.70s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9133, 'compress@10': 0.9066, 'time@10': 7.2721}:  13%|█▎        | 4/30 [00:21<02:25,  5.59s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8948, 'compress@10': 0.9057, 'time@10': 7.8856}:  13%|█▎        | 4/30 [00:27<02:25,  5.59s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8948, 'compress@10': 0.9057, 'time@10': 7.8856}:  17%|█▋        | 5/30 [00:27<02:16,  5.45s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9065, 'compress@10': 0.9051, 'time@10': 8.5055}:  17%|█▋        | 5/30 [00:38<02:16,  5.45s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9065, 'compress@10': 0.9051, 'time@10': 8.5055}:  20%|██        | 6/30 [00:38<03:01,  7.56s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9064, 'compress@10': 0.9049, 'time@10': 8.7017}:  20%|██        | 6/30 [00:43<03:01,  7.56s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9064, 'compress@10': 0.9049, 'time@10': 8.7017}:  23%|██▎       | 7/30 [00:43<02:34,  6.71s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9151, 'compress@10': 0.9047, 'time@10': 8.7042}:  23%|██▎       | 7/30 [00:52<02:34,  6.71s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9151, 'compress@10': 0.9047, 'time@10': 8.7042}:  27%|██▋       | 8/30 [00:52<02:41,  7.36s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0198, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9191, 'compress@10': 0.9045, 'time@10': 8.9486}:  27%|██▋       | 8/30 [00:58<02:41,  7.36s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0198, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9191, 'compress@10': 0.9045, 'time@10': 8.9486}:  30%|███       | 9/30 [00:58<02:22,  6.78s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9243, 'compress@10': 0.9042, 'time@10': 9.1369}:  30%|███       | 9/30 [01:08<02:22,  6.78s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9243, 'compress@10': 0.9042, 'time@10': 9.1369}:  33%|███▎      | 10/30 [01:08<02:40,  8.04s/it]{'epoch': 47, 'num_users': 6.6364, 'loss': 0.0189, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9233, 'compress@10': 0.9042, 'time@10': 9.4512}:  33%|███▎      | 10/30 [01:15<02:40,  8.04s/it]{'epoch': 47, 'num_users': 6.6364, 'loss': 0.0189, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9233, 'compress@10': 0.9042, 'time@10': 9.4512}:  37%|███▋      | 11/30 [01:15<02:22,  7.52s/it]{'epoch': 47, 'num_users': 6.4167, 'loss': 0.0174, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9227, 'compress@10': 0.9045, 'time@10': 9.1043}:  37%|███▋      | 11/30 [01:20<02:22,  7.52s/it]{'epoch': 47, 'num_users': 6.4167, 'loss': 0.0174, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9227, 'compress@10': 0.9045, 'time@10': 9.1043}:  40%|████      | 12/30 [01:20<02:03,  6.85s/it]{'epoch': 47, 'num_users': 6.6154, 'loss': 0.0175, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.9227, 'compress@10': 0.9045, 'time@10': 9.2408}:  40%|████      | 12/30 [01:26<02:03,  6.85s/it]{'epoch': 47, 'num_users': 6.6154, 'loss': 0.0175, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.9227, 'compress@10': 0.9045, 'time@10': 9.2408}:  43%|████▎     | 13/30 [01:26<01:49,  6.43s/it]{'epoch': 47, 'num_users': 6.3571, 'loss': 0.0163, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.9163, 'compress@10': 0.9054, 'time@10': 8.9391}:  43%|████▎     | 13/30 [01:31<01:49,  6.43s/it]{'epoch': 47, 'num_users': 6.3571, 'loss': 0.0163, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.9163, 'compress@10': 0.9054, 'time@10': 8.9391}:  47%|████▋     | 14/30 [01:31<01:36,  6.02s/it]{'epoch': 47, 'num_users': 6.2667, 'loss': 0.0175, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.9163, 'compress@10': 0.9053, 'time@10': 9.1807}:  47%|████▋     | 14/30 [01:37<01:36,  6.02s/it]{'epoch': 47, 'num_users': 6.2667, 'loss': 0.0175, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.9163, 'compress@10': 0.9053, 'time@10': 9.1807}:  50%|█████     | 15/30 [01:37<01:31,  6.11s/it]{'epoch': 47, 'num_users': 6.0625, 'loss': 0.0165, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.9163, 'compress@10': 0.9055, 'time@10': 8.9406}:  50%|█████     | 15/30 [01:42<01:31,  6.11s/it]{'epoch': 47, 'num_users': 6.0625, 'loss': 0.0165, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.9163, 'compress@10': 0.9055, 'time@10': 8.9406}:  53%|█████▎    | 16/30 [01:42<01:22,  5.89s/it]{'epoch': 47, 'num_users': 5.8235, 'loss': 0.0155, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.9095, 'compress@10': 0.9063, 'time@10': 8.7089}:  53%|█████▎    | 16/30 [01:45<01:22,  5.89s/it]{'epoch': 47, 'num_users': 5.8235, 'loss': 0.0155, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.9095, 'compress@10': 0.9063, 'time@10': 8.7089}:  57%|█████▋    | 17/30 [01:45<01:03,  4.88s/it]{'epoch': 47, 'num_users': 6.0556, 'loss': 0.0161, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.9123, 'compress@10': 0.9062, 'time@10': 8.6169}:  57%|█████▋    | 17/30 [01:52<01:03,  4.88s/it]{'epoch': 47, 'num_users': 6.0556, 'loss': 0.0161, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.9123, 'compress@10': 0.9062, 'time@10': 8.6169}:  60%|██████    | 18/30 [01:52<01:06,  5.54s/it]{'epoch': 47, 'num_users': 6.0, 'loss': 0.0157, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.9132, 'compress@10': 0.9062, 'time@10': 8.5216}:  60%|██████    | 18/30 [01:55<01:06,  5.54s/it]   {'epoch': 47, 'num_users': 6.0, 'loss': 0.0157, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.9132, 'compress@10': 0.9062, 'time@10': 8.5216}:  63%|██████▎   | 19/30 [01:55<00:54,  4.91s/it]{'epoch': 47, 'num_users': 6.15, 'loss': 0.0164, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.9163, 'compress@10': 0.906, 'time@10': 8.76}:  63%|██████▎   | 19/30 [02:09<00:54,  4.91s/it]  {'epoch': 47, 'num_users': 6.15, 'loss': 0.0164, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.9163, 'compress@10': 0.906, 'time@10': 8.76}:  67%|██████▋   | 20/30 [02:09<01:14,  7.44s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.9146, 'compress@10': 0.9058, 'time@10': 8.8132}:  67%|██████▋   | 20/30 [02:14<01:14,  7.44s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.9146, 'compress@10': 0.9058, 'time@10': 8.8132}:  70%|███████   | 21/30 [02:14<01:00,  6.70s/it]{'epoch': 47, 'num_users': 6.1818, 'loss': 0.0171, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.9153, 'compress@10': 0.9058, 'time@10': 8.6866}:  70%|███████   | 21/30 [02:20<01:00,  6.70s/it]{'epoch': 47, 'num_users': 6.1818, 'loss': 0.0171, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.9153, 'compress@10': 0.9058, 'time@10': 8.6866}:  73%|███████▎  | 22/30 [02:20<00:52,  6.51s/it]{'epoch': 47, 'num_users': 6.1304, 'loss': 0.0167, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.9166, 'compress@10': 0.9057, 'time@10': 8.7472}:  73%|███████▎  | 22/30 [02:25<00:52,  6.51s/it]{'epoch': 47, 'num_users': 6.1304, 'loss': 0.0167, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.9166, 'compress@10': 0.9057, 'time@10': 8.7472}:  77%|███████▋  | 23/30 [02:25<00:42,  6.09s/it]{'epoch': 47, 'num_users': 5.9583, 'loss': 0.016, 'hit_ratio@10': 0.85, 'ndcg@10': 0.9118, 'compress@10': 0.9063, 'time@10': 8.5833}:  77%|███████▋  | 23/30 [02:30<00:42,  6.09s/it]   {'epoch': 47, 'num_users': 5.9583, 'loss': 0.016, 'hit_ratio@10': 0.85, 'ndcg@10': 0.9118, 'compress@10': 0.9063, 'time@10': 8.5833}:  80%|████████  | 24/30 [02:30<00:34,  5.73s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.902, 'compress@10': 0.9074, 'time@10': 8.4531}:  80%|████████  | 24/30 [02:32<00:34,  5.73s/it] {'epoch': 47, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.902, 'compress@10': 0.9074, 'time@10': 8.4531}:  83%|████████▎ | 25/30 [02:32<00:24,  4.82s/it]{'epoch': 47, 'num_users': 5.8077, 'loss': 0.0152, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9047, 'compress@10': 0.9072, 'time@10': 8.603}:  83%|████████▎ | 25/30 [02:45<00:24,  4.82s/it]{'epoch': 47, 'num_users': 5.8077, 'loss': 0.0152, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9047, 'compress@10': 0.9072, 'time@10': 8.603}:  87%|████████▋ | 26/30 [02:45<00:28,  7.09s/it]{'epoch': 47, 'num_users': 5.8889, 'loss': 0.0152, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.9062, 'compress@10': 0.907, 'time@10': 8.6782}:  87%|████████▋ | 26/30 [02:50<00:28,  7.09s/it]{'epoch': 47, 'num_users': 5.8889, 'loss': 0.0152, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.9062, 'compress@10': 0.907, 'time@10': 8.6782}:  90%|█████████ | 27/30 [02:50<00:19,  6.57s/it]{'epoch': 47, 'num_users': 6.0, 'loss': 0.0152, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.9095, 'compress@10': 0.9068, 'time@10': 8.8364}:  90%|█████████ | 27/30 [03:03<00:19,  6.57s/it]  {'epoch': 47, 'num_users': 6.0, 'loss': 0.0152, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.9095, 'compress@10': 0.9068, 'time@10': 8.8364}:  93%|█████████▎| 28/30 [03:03<00:17,  8.54s/it]{'epoch': 47, 'num_users': 5.8621, 'loss': 0.015, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9109, 'compress@10': 0.9068, 'time@10': 8.8913}:  93%|█████████▎| 28/30 [03:09<00:17,  8.54s/it]{'epoch': 47, 'num_users': 5.8621, 'loss': 0.015, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9109, 'compress@10': 0.9068, 'time@10': 8.8913}:  97%|█████████▋| 29/30 [03:09<00:07,  7.56s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0151, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9112, 'compress@10': 0.9066, 'time@10': 8.8928}:  97%|█████████▋| 29/30 [03:18<00:07,  7.56s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0151, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9112, 'compress@10': 0.9066, 'time@10': 8.8928}: 100%|██████████| 30/30 [03:18<00:00,  7.98s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0151, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9112, 'compress@10': 0.9066, 'time@10': 8.8928}: 100%|██████████| 30/30 [03:18<00:00,  6.60s/it]
Epoch: 47
Avg # of users: 5.866666666666666
Avg Loss: 0.01514766135764345
Avg hit ratio: 0.8605374160635613
Avg ndcg: 0.9112385619216803
Avg compression ratio: 0.9066299320961078
Avg train time: 8.892755889892578
Std train time: 2.7481228762337127
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 49, 48, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9133, 'compress@10': 0.9052, 'time@10': 9.0262}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9133, 'compress@10': 0.9052, 'time@10': 9.0262}:   3%|▎         | 1/30 [00:04<02:11,  4.55s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9339, 'compress@10': 0.9042, 'time@10': 8.3423}:   3%|▎         | 1/30 [00:12<02:11,  4.55s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9339, 'compress@10': 0.9042, 'time@10': 8.3423}:   7%|▋         | 2/30 [00:12<02:59,  6.40s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9083, 'compress@10': 0.9076, 'time@10': 7.3037}:   7%|▋         | 2/30 [00:14<02:59,  6.40s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9083, 'compress@10': 0.9076, 'time@10': 7.3037}:  10%|█         | 3/30 [00:14<02:06,  4.69s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.8869, 'compress@10': 0.9066, 'time@10': 7.1508}:  10%|█         | 3/30 [00:21<02:06,  4.69s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.8869, 'compress@10': 0.9066, 'time@10': 7.1508}:  13%|█▎        | 4/30 [00:21<02:22,  5.49s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.83, 'ndcg@10': 0.876, 'compress@10': 0.9057, 'time@10': 7.7431}:  13%|█▎        | 4/30 [00:26<02:22,  5.49s/it]   {'epoch': 48, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.83, 'ndcg@10': 0.876, 'compress@10': 0.9057, 'time@10': 7.7431}:  17%|█▋        | 5/30 [00:26<02:13,  5.35s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0223, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.894, 'compress@10': 0.9051, 'time@10': 8.3598}:  17%|█▋        | 5/30 [00:38<02:13,  5.35s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0223, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.894, 'compress@10': 0.9051, 'time@10': 8.3598}:  20%|██        | 6/30 [00:38<02:58,  7.43s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0222, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8957, 'compress@10': 0.9049, 'time@10': 8.5675}:  20%|██        | 6/30 [00:43<02:58,  7.43s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0222, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8957, 'compress@10': 0.9049, 'time@10': 8.5675}:  23%|██▎       | 7/30 [00:43<02:32,  6.62s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0228, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9059, 'compress@10': 0.9047, 'time@10': 8.5586}:  23%|██▎       | 7/30 [00:51<02:32,  6.62s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0228, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9059, 'compress@10': 0.9047, 'time@10': 8.5586}:  27%|██▋       | 8/30 [00:51<02:39,  7.23s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0222, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.911, 'compress@10': 0.9045, 'time@10': 8.7655}:  27%|██▋       | 8/30 [00:56<02:39,  7.23s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0222, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.911, 'compress@10': 0.9045, 'time@10': 8.7655}:  30%|███       | 9/30 [00:56<02:18,  6.61s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0227, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9178, 'compress@10': 0.9042, 'time@10': 8.9945}:  30%|███       | 9/30 [01:08<02:18,  6.61s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 0.0227, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9178, 'compress@10': 0.9042, 'time@10': 8.9945}:  33%|███▎      | 10/30 [01:08<02:39,  7.99s/it]{'epoch': 48, 'num_users': 6.6364, 'loss': 0.0251, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9336, 'compress@10': 0.9042, 'time@10': 9.3457}:  33%|███▎      | 10/30 [01:14<02:39,  7.99s/it]{'epoch': 48, 'num_users': 6.6364, 'loss': 0.0251, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9336, 'compress@10': 0.9042, 'time@10': 9.3457}:  37%|███▋      | 11/30 [01:14<02:22,  7.53s/it]{'epoch': 48, 'num_users': 6.4167, 'loss': 0.0232, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9322, 'compress@10': 0.9045, 'time@10': 9.0213}:  37%|███▋      | 11/30 [01:19<02:22,  7.53s/it]{'epoch': 48, 'num_users': 6.4167, 'loss': 0.0232, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9322, 'compress@10': 0.9045, 'time@10': 9.0213}:  40%|████      | 12/30 [01:19<02:04,  6.91s/it]{'epoch': 48, 'num_users': 6.6154, 'loss': 0.0229, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9316, 'compress@10': 0.9045, 'time@10': 9.1752}:  40%|████      | 12/30 [01:25<02:04,  6.91s/it] {'epoch': 48, 'num_users': 6.6154, 'loss': 0.0229, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9316, 'compress@10': 0.9045, 'time@10': 9.1752}:  43%|████▎     | 13/30 [01:25<01:50,  6.49s/it]{'epoch': 48, 'num_users': 6.3571, 'loss': 0.0212, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9246, 'compress@10': 0.9054, 'time@10': 8.8823}:  43%|████▎     | 13/30 [01:30<01:50,  6.49s/it]{'epoch': 48, 'num_users': 6.3571, 'loss': 0.0212, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9246, 'compress@10': 0.9054, 'time@10': 8.8823}:  47%|████▋     | 14/30 [01:30<01:37,  6.08s/it]{'epoch': 48, 'num_users': 6.2667, 'loss': 0.0212, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9261, 'compress@10': 0.9053, 'time@10': 9.131}:  47%|████▋     | 14/30 [01:36<01:37,  6.08s/it] {'epoch': 48, 'num_users': 6.2667, 'loss': 0.0212, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9261, 'compress@10': 0.9053, 'time@10': 9.131}:  50%|█████     | 15/30 [01:36<01:32,  6.16s/it]{'epoch': 48, 'num_users': 6.0625, 'loss': 0.02, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.9255, 'compress@10': 0.9055, 'time@10': 8.9063}:  50%|█████     | 15/30 [01:42<01:32,  6.16s/it] {'epoch': 48, 'num_users': 6.0625, 'loss': 0.02, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.9255, 'compress@10': 0.9055, 'time@10': 8.9063}:  53%|█████▎    | 16/30 [01:42<01:23,  5.98s/it]{'epoch': 48, 'num_users': 5.8235, 'loss': 0.0189, 'hit_ratio@10': 0.828, 'ndcg@10': 0.9181, 'compress@10': 0.9063, 'time@10': 8.6781}:  53%|█████▎    | 16/30 [01:45<01:23,  5.98s/it]{'epoch': 48, 'num_users': 5.8235, 'loss': 0.0189, 'hit_ratio@10': 0.828, 'ndcg@10': 0.9181, 'compress@10': 0.9063, 'time@10': 8.6781}:  57%|█████▋    | 17/30 [01:45<01:04,  4.95s/it]{'epoch': 48, 'num_users': 6.0556, 'loss': 0.0196, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.9229, 'compress@10': 0.9062, 'time@10': 8.588}:  57%|█████▋    | 17/30 [01:52<01:04,  4.95s/it]{'epoch': 48, 'num_users': 6.0556, 'loss': 0.0196, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.9229, 'compress@10': 0.9062, 'time@10': 8.588}:  60%|██████    | 18/30 [01:52<01:07,  5.59s/it]{'epoch': 48, 'num_users': 6.0, 'loss': 0.019, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.9232, 'compress@10': 0.9062, 'time@10': 8.4962}:  60%|██████    | 18/30 [01:55<01:07,  5.59s/it]   {'epoch': 48, 'num_users': 6.0, 'loss': 0.019, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.9232, 'compress@10': 0.9062, 'time@10': 8.4962}:  63%|██████▎   | 19/30 [01:55<00:54,  4.95s/it]{'epoch': 48, 'num_users': 6.15, 'loss': 0.019, 'hit_ratio@10': 0.844, 'ndcg@10': 0.9253, 'compress@10': 0.906, 'time@10': 8.7235}:  63%|██████▎   | 19/30 [02:08<00:54,  4.95s/it] {'epoch': 48, 'num_users': 6.15, 'loss': 0.019, 'hit_ratio@10': 0.844, 'ndcg@10': 0.9253, 'compress@10': 0.906, 'time@10': 8.7235}:  67%|██████▋   | 20/30 [02:08<01:13,  7.39s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0198, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9233, 'compress@10': 0.9058, 'time@10': 8.7871}:  67%|██████▋   | 20/30 [02:13<01:13,  7.39s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0198, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9233, 'compress@10': 0.9058, 'time@10': 8.7871}:  70%|███████   | 21/30 [02:13<01:00,  6.69s/it]{'epoch': 48, 'num_users': 6.1818, 'loss': 0.0197, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.9244, 'compress@10': 0.9058, 'time@10': 8.6585}:  70%|███████   | 21/30 [02:19<01:00,  6.69s/it]{'epoch': 48, 'num_users': 6.1818, 'loss': 0.0197, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.9244, 'compress@10': 0.9058, 'time@10': 8.6585}:  73%|███████▎  | 22/30 [02:19<00:51,  6.48s/it]{'epoch': 48, 'num_users': 6.1304, 'loss': 0.0193, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9253, 'compress@10': 0.9057, 'time@10': 8.7219}:  73%|███████▎  | 22/30 [02:24<00:51,  6.48s/it]{'epoch': 48, 'num_users': 6.1304, 'loss': 0.0193, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9253, 'compress@10': 0.9057, 'time@10': 8.7219}:  77%|███████▋  | 23/30 [02:24<00:42,  6.07s/it]{'epoch': 48, 'num_users': 5.9583, 'loss': 0.0185, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.9201, 'compress@10': 0.9063, 'time@10': 8.5707}:  77%|███████▋  | 23/30 [02:29<00:42,  6.07s/it]{'epoch': 48, 'num_users': 5.9583, 'loss': 0.0185, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.9201, 'compress@10': 0.9063, 'time@10': 8.5707}:  80%|████████  | 24/30 [02:29<00:34,  5.78s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.844, 'ndcg@10': 0.9099, 'compress@10': 0.9074, 'time@10': 8.4169}:  80%|████████  | 24/30 [02:32<00:34,  5.78s/it]    {'epoch': 48, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.844, 'ndcg@10': 0.9099, 'compress@10': 0.9074, 'time@10': 8.4169}:  83%|████████▎ | 25/30 [02:32<00:23,  4.77s/it]{'epoch': 48, 'num_users': 5.8077, 'loss': 0.0175, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.9124, 'compress@10': 0.9072, 'time@10': 8.5676}:  83%|████████▎ | 25/30 [02:44<00:23,  4.77s/it]{'epoch': 48, 'num_users': 5.8077, 'loss': 0.0175, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.9124, 'compress@10': 0.9072, 'time@10': 8.5676}:  87%|████████▋ | 26/30 [02:44<00:28,  7.05s/it]{'epoch': 48, 'num_users': 5.8889, 'loss': 0.0172, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9138, 'compress@10': 0.907, 'time@10': 8.6687}:  87%|████████▋ | 26/30 [02:50<00:28,  7.05s/it] {'epoch': 48, 'num_users': 5.8889, 'loss': 0.0172, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9138, 'compress@10': 0.907, 'time@10': 8.6687}:  90%|█████████ | 27/30 [02:50<00:19,  6.64s/it]{'epoch': 48, 'num_users': 6.0, 'loss': 0.0178, 'hit_ratio@10': 0.857, 'ndcg@10': 0.9164, 'compress@10': 0.9068, 'time@10': 8.8194}:  90%|█████████ | 27/30 [03:03<00:19,  6.64s/it]   {'epoch': 48, 'num_users': 6.0, 'loss': 0.0178, 'hit_ratio@10': 0.857, 'ndcg@10': 0.9164, 'compress@10': 0.9068, 'time@10': 8.8194}:  93%|█████████▎| 28/30 [03:03<00:17,  8.53s/it]{'epoch': 48, 'num_users': 5.8621, 'loss': 0.0175, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9175, 'compress@10': 0.9068, 'time@10': 8.8803}:  93%|█████████▎| 28/30 [03:08<00:17,  8.53s/it]{'epoch': 48, 'num_users': 5.8621, 'loss': 0.0175, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9175, 'compress@10': 0.9068, 'time@10': 8.8803}:  97%|█████████▋| 29/30 [03:08<00:07,  7.57s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0177, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9174, 'compress@10': 0.9066, 'time@10': 8.8873}:  97%|█████████▋| 29/30 [03:17<00:07,  7.57s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0177, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9174, 'compress@10': 0.9066, 'time@10': 8.8873}: 100%|██████████| 30/30 [03:17<00:00,  8.04s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0177, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9174, 'compress@10': 0.9066, 'time@10': 8.8873}: 100%|██████████| 30/30 [03:17<00:00,  6.59s/it]
Epoch: 48
Avg # of users: 5.866666666666666
Avg Loss: 0.017718348691919336
Avg hit ratio: 0.8614323848130193
Avg ndcg: 0.9174313864576752
Avg compression ratio: 0.9066299260277977
Avg train time: 8.88734211921692
Std train time: 2.7515436950660703
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 49, 49, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9112, 'compress@10': 0.9052, 'time@10': 8.7483}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9112, 'compress@10': 0.9052, 'time@10': 8.7483}:   3%|▎         | 1/30 [00:04<02:07,  4.41s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9504, 'compress@10': 0.9042, 'time@10': 8.0243}:   3%|▎         | 1/30 [00:11<02:07,  4.41s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9504, 'compress@10': 0.9042, 'time@10': 8.0243}:   7%|▋         | 2/30 [00:11<02:51,  6.13s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9193, 'compress@10': 0.9076, 'time@10': 7.0263}:   7%|▋         | 2/30 [00:14<02:51,  6.13s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9193, 'compress@10': 0.9076, 'time@10': 7.0263}:  10%|█         | 3/30 [00:14<02:01,  4.50s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9281, 'compress@10': 0.9066, 'time@10': 6.91}:  10%|█         | 3/30 [00:20<02:01,  4.50s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9281, 'compress@10': 0.9066, 'time@10': 6.91}:  13%|█▎        | 4/30 [00:20<02:18,  5.33s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9096, 'compress@10': 0.9057, 'time@10': 7.52}:  13%|█▎        | 4/30 [00:25<02:18,  5.33s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9096, 'compress@10': 0.9057, 'time@10': 7.52}:  17%|█▋        | 5/30 [00:25<02:10,  5.22s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0193, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9187, 'compress@10': 0.9051, 'time@10': 8.1572}:  17%|█▋        | 5/30 [00:37<02:10,  5.22s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0193, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9187, 'compress@10': 0.9051, 'time@10': 8.1572}:  20%|██        | 6/30 [00:37<02:55,  7.31s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0192, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9186, 'compress@10': 0.9049, 'time@10': 8.3331}:  20%|██        | 6/30 [00:42<02:55,  7.31s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0192, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9186, 'compress@10': 0.9049, 'time@10': 8.3331}:  23%|██▎       | 7/30 [00:42<02:28,  6.47s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0203, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9267, 'compress@10': 0.9047, 'time@10': 8.3268}:  23%|██▎       | 7/30 [00:50<02:28,  6.47s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0203, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9267, 'compress@10': 0.9047, 'time@10': 8.3268}:  27%|██▋       | 8/30 [00:50<02:35,  7.06s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9294, 'compress@10': 0.9045, 'time@10': 8.5489}:  27%|██▋       | 8/30 [00:55<02:35,  7.06s/it] {'epoch': 49, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9294, 'compress@10': 0.9045, 'time@10': 8.5489}:  30%|███       | 9/30 [00:55<02:16,  6.48s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9336, 'compress@10': 0.9042, 'time@10': 8.7842}:  30%|███       | 9/30 [01:06<02:16,  6.48s/it]  {'epoch': 49, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9336, 'compress@10': 0.9042, 'time@10': 8.7842}:  33%|███▎      | 10/30 [01:06<02:37,  7.85s/it]{'epoch': 49, 'num_users': 6.6364, 'loss': 0.0183, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9339, 'compress@10': 0.9042, 'time@10': 9.1066}:  33%|███▎      | 10/30 [01:12<02:37,  7.85s/it]{'epoch': 49, 'num_users': 6.6364, 'loss': 0.0183, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9339, 'compress@10': 0.9042, 'time@10': 9.1066}:  37%|███▋      | 11/30 [01:12<02:19,  7.36s/it]{'epoch': 49, 'num_users': 6.4167, 'loss': 0.0169, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9324, 'compress@10': 0.9045, 'time@10': 8.7736}:  37%|███▋      | 11/30 [01:17<02:19,  7.36s/it]{'epoch': 49, 'num_users': 6.4167, 'loss': 0.0169, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9324, 'compress@10': 0.9045, 'time@10': 8.7736}:  40%|████      | 12/30 [01:17<02:00,  6.69s/it]{'epoch': 49, 'num_users': 6.6154, 'loss': 0.017, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9315, 'compress@10': 0.9045, 'time@10': 8.9442}:  40%|████      | 12/30 [01:23<02:00,  6.69s/it] {'epoch': 49, 'num_users': 6.6154, 'loss': 0.017, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9315, 'compress@10': 0.9045, 'time@10': 8.9442}:  43%|████▎     | 13/30 [01:23<01:47,  6.34s/it]{'epoch': 49, 'num_users': 6.3571, 'loss': 0.0158, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.9245, 'compress@10': 0.9054, 'time@10': 8.6586}:  43%|████▎     | 13/30 [01:28<01:47,  6.34s/it]{'epoch': 49, 'num_users': 6.3571, 'loss': 0.0158, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.9245, 'compress@10': 0.9054, 'time@10': 8.6586}:  47%|████▋     | 14/30 [01:28<01:35,  5.95s/it]{'epoch': 49, 'num_users': 6.2667, 'loss': 0.0158, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9257, 'compress@10': 0.9053, 'time@10': 8.884}:  47%|████▋     | 14/30 [01:34<01:35,  5.95s/it] {'epoch': 49, 'num_users': 6.2667, 'loss': 0.0158, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9257, 'compress@10': 0.9053, 'time@10': 8.884}:  50%|█████     | 15/30 [01:34<01:29,  5.98s/it]{'epoch': 49, 'num_users': 6.0625, 'loss': 0.015, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9251, 'compress@10': 0.9055, 'time@10': 8.6531}:  50%|█████     | 15/30 [01:39<01:29,  5.98s/it]{'epoch': 49, 'num_users': 6.0625, 'loss': 0.015, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9251, 'compress@10': 0.9055, 'time@10': 8.6531}:  53%|█████▎    | 16/30 [01:39<01:20,  5.75s/it]{'epoch': 49, 'num_users': 5.8235, 'loss': 0.0141, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.9178, 'compress@10': 0.9063, 'time@10': 8.4423}:  53%|█████▎    | 16/30 [01:42<01:20,  5.75s/it]{'epoch': 49, 'num_users': 5.8235, 'loss': 0.0141, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.9178, 'compress@10': 0.9063, 'time@10': 8.4423}:  57%|█████▋    | 17/30 [01:42<01:02,  4.80s/it]{'epoch': 49, 'num_users': 6.0556, 'loss': 0.0144, 'hit_ratio@10': 0.837, 'ndcg@10': 0.9174, 'compress@10': 0.9062, 'time@10': 8.3383}:  57%|█████▋    | 17/30 [01:48<01:02,  4.80s/it] {'epoch': 49, 'num_users': 6.0556, 'loss': 0.0144, 'hit_ratio@10': 0.837, 'ndcg@10': 0.9174, 'compress@10': 0.9062, 'time@10': 8.3383}:  60%|██████    | 18/30 [01:48<01:04,  5.34s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 0.0141, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.918, 'compress@10': 0.9062, 'time@10': 8.2521}:  60%|██████    | 18/30 [01:52<01:04,  5.34s/it]   {'epoch': 49, 'num_users': 6.0, 'loss': 0.0141, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.918, 'compress@10': 0.9062, 'time@10': 8.2521}:  63%|██████▎   | 19/30 [01:52<00:52,  4.75s/it]{'epoch': 49, 'num_users': 6.15, 'loss': 0.0147, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.9206, 'compress@10': 0.906, 'time@10': 8.4776}:  63%|██████▎   | 19/30 [02:05<00:52,  4.75s/it]{'epoch': 49, 'num_users': 6.15, 'loss': 0.0147, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.9206, 'compress@10': 0.906, 'time@10': 8.4776}:  67%|██████▋   | 20/30 [02:05<01:11,  7.17s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9189, 'compress@10': 0.9058, 'time@10': 8.5271}:  67%|██████▋   | 20/30 [02:09<01:11,  7.17s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9189, 'compress@10': 0.9058, 'time@10': 8.5271}:  70%|███████   | 21/30 [02:09<00:58,  6.46s/it]{'epoch': 49, 'num_users': 6.1818, 'loss': 0.0155, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9188, 'compress@10': 0.9058, 'time@10': 8.3972}:  70%|███████   | 21/30 [02:15<00:58,  6.46s/it]{'epoch': 49, 'num_users': 6.1818, 'loss': 0.0155, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9188, 'compress@10': 0.9058, 'time@10': 8.3972}:  73%|███████▎  | 22/30 [02:15<00:49,  6.23s/it]{'epoch': 49, 'num_users': 6.1304, 'loss': 0.0152, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9199, 'compress@10': 0.9057, 'time@10': 8.4493}:  73%|███████▎  | 22/30 [02:20<00:49,  6.23s/it] {'epoch': 49, 'num_users': 6.1304, 'loss': 0.0152, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9199, 'compress@10': 0.9057, 'time@10': 8.4493}:  77%|███████▋  | 23/30 [02:20<00:40,  5.81s/it]{'epoch': 49, 'num_users': 5.9583, 'loss': 0.0146, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.915, 'compress@10': 0.9063, 'time@10': 8.2959}:  77%|███████▋  | 23/30 [02:25<00:40,  5.81s/it]{'epoch': 49, 'num_users': 5.9583, 'loss': 0.0146, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.915, 'compress@10': 0.9063, 'time@10': 8.2959}:  80%|████████  | 24/30 [02:25<00:33,  5.52s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.014, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.905, 'compress@10': 0.9074, 'time@10': 8.159}:  80%|████████  | 24/30 [02:27<00:33,  5.52s/it]     {'epoch': 49, 'num_users': 5.8, 'loss': 0.014, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.905, 'compress@10': 0.9074, 'time@10': 8.159}:  83%|████████▎ | 25/30 [02:27<00:23,  4.61s/it]{'epoch': 49, 'num_users': 5.8077, 'loss': 0.0138, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9078, 'compress@10': 0.9072, 'time@10': 8.3098}:  83%|████████▎ | 25/30 [02:39<00:23,  4.61s/it]{'epoch': 49, 'num_users': 5.8077, 'loss': 0.0138, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9078, 'compress@10': 0.9072, 'time@10': 8.3098}:  87%|████████▋ | 26/30 [02:39<00:27,  6.86s/it]{'epoch': 49, 'num_users': 5.8889, 'loss': 0.0137, 'hit_ratio@10': 0.854, 'ndcg@10': 0.9093, 'compress@10': 0.907, 'time@10': 8.399}:  87%|████████▋ | 26/30 [02:45<00:27,  6.86s/it]   {'epoch': 49, 'num_users': 5.8889, 'loss': 0.0137, 'hit_ratio@10': 0.854, 'ndcg@10': 0.9093, 'compress@10': 0.907, 'time@10': 8.399}:  90%|█████████ | 27/30 [02:45<00:19,  6.42s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 0.0133, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.9118, 'compress@10': 0.9068, 'time@10': 8.5351}:  90%|█████████ | 27/30 [02:57<00:19,  6.42s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 0.0133, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.9118, 'compress@10': 0.9068, 'time@10': 8.5351}:  93%|█████████▎| 28/30 [02:57<00:16,  8.17s/it]{'epoch': 49, 'num_users': 5.8621, 'loss': 0.0131, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9131, 'compress@10': 0.9068, 'time@10': 8.5849}:  93%|█████████▎| 28/30 [03:02<00:16,  8.17s/it]{'epoch': 49, 'num_users': 5.8621, 'loss': 0.0131, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9131, 'compress@10': 0.9068, 'time@10': 8.5849}:  97%|█████████▋| 29/30 [03:02<00:07,  7.23s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0134, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9133, 'compress@10': 0.9066, 'time@10': 8.5842}:  97%|█████████▋| 29/30 [03:11<00:07,  7.23s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0134, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9133, 'compress@10': 0.9066, 'time@10': 8.5842}: 100%|██████████| 30/30 [03:11<00:00,  7.64s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0134, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9133, 'compress@10': 0.9066, 'time@10': 8.5842}: 100%|██████████| 30/30 [03:11<00:00,  6.37s/it]
Epoch: 49
Avg # of users: 5.866666666666666
Avg Loss: 0.013353608150145321
Avg hit ratio: 0.8606271748771365
Avg ndcg: 0.9132581162853758
Avg compression ratio: 0.9066299445144835
Avg train time: 8.584159676233927
Std train time: 2.668814273930463
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 4, 10, 8, 10, 6, 10, 10, 19, 10, 39, 8, 19, 26, 10, 10, 9, 5, 11, 10, 49, 49, 6, 8, 10, 10, 10]
