  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2797, 'hit_ratio@10': 0.4211, 'ndcg@10': 0.3699, 'compress@10': 0.5263, 'time@10': 7.9053}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2797, 'hit_ratio@10': 0.4211, 'ndcg@10': 0.3699, 'compress@10': 0.5263, 'time@10': 7.9053}:   3%|▎         | 1/30 [00:03<01:55,  3.99s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1969, 'hit_ratio@10': 0.5331, 'ndcg@10': 0.4777, 'compress@10': 0.5212, 'time@10': 6.9619}:   3%|▎         | 1/30 [00:10<01:55,  3.99s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1969, 'hit_ratio@10': 0.5331, 'ndcg@10': 0.4777, 'compress@10': 0.5212, 'time@10': 6.9619}:   7%|▋         | 2/30 [00:10<02:25,  5.20s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9478, 'hit_ratio@10': 0.4983, 'ndcg@10': 0.3185, 'compress@10': 0.538, 'time@10': 5.4289}:   7%|▋         | 2/30 [00:11<02:25,  5.20s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.9478, 'hit_ratio@10': 0.4983, 'ndcg@10': 0.3185, 'compress@10': 0.538, 'time@10': 5.4289}:  10%|█         | 3/30 [00:11<01:31,  3.38s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7532, 'hit_ratio@10': 0.5523, 'ndcg@10': 0.373, 'compress@10': 0.5329, 'time@10': 5.386}:  10%|█         | 3/30 [00:16<01:31,  3.38s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.7532, 'hit_ratio@10': 0.5523, 'ndcg@10': 0.373, 'compress@10': 0.5329, 'time@10': 5.386}:  13%|█▎        | 4/30 [00:16<01:47,  4.14s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.6226, 'hit_ratio@10': 0.6058, 'ndcg@10': 0.4423, 'compress@10': 0.5283, 'time@10': 8.1915}:  13%|█▎        | 4/30 [00:26<01:47,  4.14s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.6226, 'hit_ratio@10': 0.6058, 'ndcg@10': 0.4423, 'compress@10': 0.5283, 'time@10': 8.1915}:  17%|█▋        | 5/30 [00:26<02:33,  6.16s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5353, 'hit_ratio@10': 0.6234, 'ndcg@10': 0.4905, 'compress@10': 0.5255, 'time@10': 8.4157}:  17%|█▋        | 5/30 [00:35<02:33,  6.16s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5353, 'hit_ratio@10': 0.6234, 'ndcg@10': 0.4905, 'compress@10': 0.5255, 'time@10': 8.4157}:  20%|██        | 6/30 [00:35<02:55,  7.32s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.483, 'hit_ratio@10': 0.6143, 'ndcg@10': 0.4947, 'compress@10': 0.5247, 'time@10': 8.5762}:  20%|██        | 6/30 [00:40<02:55,  7.32s/it] {'epoch': 0, 'num_users': 6.2857, 'loss': 0.483, 'hit_ratio@10': 0.6143, 'ndcg@10': 0.4947, 'compress@10': 0.5247, 'time@10': 8.5762}:  23%|██▎       | 7/30 [00:40<02:29,  6.50s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.4326, 'hit_ratio@10': 0.6554, 'ndcg@10': 0.5158, 'compress@10': 0.5234, 'time@10': 8.3357}:  23%|██▎       | 7/30 [00:47<02:29,  6.50s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.4326, 'hit_ratio@10': 0.6554, 'ndcg@10': 0.5158, 'compress@10': 0.5234, 'time@10': 8.3357}:  27%|██▋       | 8/30 [00:47<02:24,  6.56s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3947, 'hit_ratio@10': 0.6683, 'ndcg@10': 0.5538, 'compress@10': 0.5224, 'time@10': 8.9183}:  27%|██▋       | 8/30 [00:54<02:24,  6.56s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3947, 'hit_ratio@10': 0.6683, 'ndcg@10': 0.5538, 'compress@10': 0.5224, 'time@10': 8.9183}:  30%|███       | 9/30 [00:54<02:19,  6.64s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3621, 'hit_ratio@10': 0.6946, 'ndcg@10': 0.5723, 'compress@10': 0.5213, 'time@10': 8.8904}:  30%|███       | 9/30 [01:02<02:19,  6.64s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.3621, 'hit_ratio@10': 0.6946, 'ndcg@10': 0.5723, 'compress@10': 0.5213, 'time@10': 8.8904}:  33%|███▎      | 10/30 [01:02<02:25,  7.27s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.3451, 'hit_ratio@10': 0.6874, 'ndcg@10': 0.5686, 'compress@10': 0.5211, 'time@10': 8.9996}:  33%|███▎      | 10/30 [01:07<02:25,  7.27s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.3451, 'hit_ratio@10': 0.6874, 'ndcg@10': 0.5686, 'compress@10': 0.5211, 'time@10': 8.9996}:  37%|███▋      | 11/30 [01:07<02:05,  6.60s/it]{'epoch': 0, 'num_users': 6.4167, 'loss': 0.571, 'hit_ratio@10': 0.6649, 'ndcg@10': 0.5222, 'compress@10': 0.5228, 'time@10': 8.428}:  37%|███▋      | 11/30 [01:10<02:05,  6.60s/it]  {'epoch': 0, 'num_users': 6.4167, 'loss': 0.571, 'hit_ratio@10': 0.6649, 'ndcg@10': 0.5222, 'compress@10': 0.5228, 'time@10': 8.428}:  40%|████      | 12/30 [01:10<01:34,  5.26s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.5437, 'hit_ratio@10': 0.6732, 'ndcg@10': 0.5204, 'compress@10': 0.5228, 'time@10': 8.4218}:  40%|████      | 12/30 [01:14<01:34,  5.26s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.5437, 'hit_ratio@10': 0.6732, 'ndcg@10': 0.5204, 'compress@10': 0.5228, 'time@10': 8.4218}:  43%|████▎     | 13/30 [01:14<01:23,  4.94s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.7164, 'hit_ratio@10': 0.6727, 'ndcg@10': 0.4833, 'compress@10': 0.5271, 'time@10': 7.8918}:  43%|████▎     | 13/30 [01:15<01:23,  4.94s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.7164, 'hit_ratio@10': 0.6727, 'ndcg@10': 0.4833, 'compress@10': 0.5271, 'time@10': 7.8918}:  47%|████▋     | 14/30 [01:15<01:00,  3.76s/it]{'epoch': 0, 'num_users': 6.2667, 'loss': 0.6782, 'hit_ratio@10': 0.6752, 'ndcg@10': 0.486, 'compress@10': 0.5264, 'time@10': 8.1453}:  47%|████▋     | 14/30 [01:21<01:00,  3.76s/it] {'epoch': 0, 'num_users': 6.2667, 'loss': 0.6782, 'hit_ratio@10': 0.6752, 'ndcg@10': 0.486, 'compress@10': 0.5264, 'time@10': 8.1453}:  50%|█████     | 15/30 [01:21<01:05,  4.40s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.8226, 'hit_ratio@10': 0.6694, 'ndcg@10': 0.4566, 'compress@10': 0.5273, 'time@10': 7.77}:  50%|█████     | 15/30 [01:23<01:05,  4.40s/it] {'epoch': 0, 'num_users': 6.0625, 'loss': 0.8226, 'hit_ratio@10': 0.6694, 'ndcg@10': 0.4566, 'compress@10': 0.5273, 'time@10': 7.77}:  53%|█████▎    | 16/30 [01:23<00:52,  3.73s/it]{'epoch': 0, 'num_users': 5.8235, 'loss': 0.9205, 'hit_ratio@10': 0.6418, 'ndcg@10': 0.4297, 'compress@10': 0.5316, 'time@10': 7.4049}:  53%|█████▎    | 16/30 [01:24<00:52,  3.73s/it]{'epoch': 0, 'num_users': 5.8235, 'loss': 0.9205, 'hit_ratio@10': 0.6418, 'ndcg@10': 0.4297, 'compress@10': 0.5316, 'time@10': 7.4049}:  57%|█████▋    | 17/30 [01:24<00:37,  2.85s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 0.8775, 'hit_ratio@10': 0.6498, 'ndcg@10': 0.4419, 'compress@10': 0.5309, 'time@10': 7.2903}:  57%|█████▋    | 17/30 [01:29<00:37,  2.85s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 0.8775, 'hit_ratio@10': 0.6498, 'ndcg@10': 0.4419, 'compress@10': 0.5309, 'time@10': 7.2903}:  60%|██████    | 18/30 [01:29<00:43,  3.61s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.9353, 'hit_ratio@10': 0.6382, 'ndcg@10': 0.4204, 'compress@10': 0.5311, 'time@10': 7.1754}:  60%|██████    | 18/30 [01:32<00:43,  3.61s/it]   {'epoch': 0, 'num_users': 6.0, 'loss': 0.9353, 'hit_ratio@10': 0.6382, 'ndcg@10': 0.4204, 'compress@10': 0.5311, 'time@10': 7.1754}:  63%|██████▎   | 19/30 [01:32<00:36,  3.30s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.8923, 'hit_ratio@10': 0.6475, 'ndcg@10': 0.4367, 'compress@10': 0.53, 'time@10': 7.3678}:  63%|██████▎   | 19/30 [01:43<00:36,  3.30s/it] {'epoch': 0, 'num_users': 6.15, 'loss': 0.8923, 'hit_ratio@10': 0.6475, 'ndcg@10': 0.4367, 'compress@10': 0.53, 'time@10': 7.3678}:  67%|██████▋   | 20/30 [01:43<00:56,  5.63s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.8552, 'hit_ratio@10': 0.65, 'ndcg@10': 0.4479, 'compress@10': 0.5292, 'time@10': 7.8408}:  67%|██████▋   | 20/30 [01:51<00:56,  5.63s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.8552, 'hit_ratio@10': 0.65, 'ndcg@10': 0.4479, 'compress@10': 0.5292, 'time@10': 7.8408}:  70%|███████   | 21/30 [01:51<00:58,  6.55s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 0.8317, 'hit_ratio@10': 0.6556, 'ndcg@10': 0.4409, 'compress@10': 0.5289, 'time@10': 7.6681}:  70%|███████   | 21/30 [01:56<00:58,  6.55s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 0.8317, 'hit_ratio@10': 0.6556, 'ndcg@10': 0.4409, 'compress@10': 0.5289, 'time@10': 7.6681}:  73%|███████▎  | 22/30 [01:56<00:46,  5.80s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 0.8038, 'hit_ratio@10': 0.6553, 'ndcg@10': 0.4429, 'compress@10': 0.5287, 'time@10': 7.6644}:  73%|███████▎  | 22/30 [01:59<00:46,  5.80s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 0.8038, 'hit_ratio@10': 0.6553, 'ndcg@10': 0.4429, 'compress@10': 0.5287, 'time@10': 7.6644}:  77%|███████▋  | 23/30 [01:59<00:36,  5.21s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.8795, 'hit_ratio@10': 0.6447, 'ndcg@10': 0.4244, 'compress@10': 0.5317, 'time@10': 7.3784}:  77%|███████▋  | 23/30 [02:00<00:36,  5.21s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.8795, 'hit_ratio@10': 0.6447, 'ndcg@10': 0.4244, 'compress@10': 0.5317, 'time@10': 7.3784}:  80%|████████  | 24/30 [02:00<00:23,  3.90s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.9294, 'hit_ratio@10': 0.6189, 'ndcg@10': 0.4074, 'compress@10': 0.5371, 'time@10': 7.1164}:  80%|████████  | 24/30 [02:01<00:23,  3.90s/it]   {'epoch': 0, 'num_users': 5.8, 'loss': 0.9294, 'hit_ratio@10': 0.6189, 'ndcg@10': 0.4074, 'compress@10': 0.5371, 'time@10': 7.1164}:  83%|████████▎ | 25/30 [02:01<00:14,  2.86s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.8973, 'hit_ratio@10': 0.627, 'ndcg@10': 0.4214, 'compress@10': 0.5359, 'time@10': 7.4422}:  83%|████████▎ | 25/30 [02:16<00:14,  2.86s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.8973, 'hit_ratio@10': 0.627, 'ndcg@10': 0.4214, 'compress@10': 0.5359, 'time@10': 7.4422}:  87%|████████▋ | 26/30 [02:16<00:26,  6.69s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 0.8683, 'hit_ratio@10': 0.6302, 'ndcg@10': 0.4262, 'compress@10': 0.5352, 'time@10': 7.5554}:  87%|████████▋ | 26/30 [02:22<00:26,  6.69s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 0.8683, 'hit_ratio@10': 0.6302, 'ndcg@10': 0.4262, 'compress@10': 0.5352, 'time@10': 7.5554}:  90%|█████████ | 27/30 [02:22<00:18,  6.27s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.8396, 'hit_ratio@10': 0.6371, 'ndcg@10': 0.4424, 'compress@10': 0.5343, 'time@10': 7.6324}:  90%|█████████ | 27/30 [02:31<00:18,  6.27s/it]   {'epoch': 0, 'num_users': 6.0, 'loss': 0.8396, 'hit_ratio@10': 0.6371, 'ndcg@10': 0.4424, 'compress@10': 0.5343, 'time@10': 7.6324}:  93%|█████████▎| 28/30 [02:31<00:14,  7.31s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.8169, 'hit_ratio@10': 0.6418, 'ndcg@10': 0.4459, 'compress@10': 0.5339, 'time@10': 7.6479}:  93%|█████████▎| 28/30 [02:35<00:14,  7.31s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.8169, 'hit_ratio@10': 0.6418, 'ndcg@10': 0.4459, 'compress@10': 0.5339, 'time@10': 7.6479}:  97%|█████████▋| 29/30 [02:35<00:06,  6.34s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.7926, 'hit_ratio@10': 0.6456, 'ndcg@10': 0.451, 'compress@10': 0.5332, 'time@10': 7.6263}:  97%|█████████▋| 29/30 [02:42<00:06,  6.34s/it] {'epoch': 0, 'num_users': 5.8667, 'loss': 0.7926, 'hit_ratio@10': 0.6456, 'ndcg@10': 0.451, 'compress@10': 0.5332, 'time@10': 7.6263}: 100%|██████████| 30/30 [02:42<00:00,  6.55s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.7926, 'hit_ratio@10': 0.6456, 'ndcg@10': 0.451, 'compress@10': 0.5332, 'time@10': 7.6263}: 100%|██████████| 30/30 [02:42<00:00,  5.43s/it]
Epoch: 0
Avg # of users: 5.866666666666666
Avg Loss: 0.7926266049605135
Avg hit ratio: 0.645629462828207
Avg ndcg: 0.45095512955967243
Avg compression ratio: 0.5332220296238009
Avg train time: 7.626310316721598
Std train time: 4.7699144369972295
[0.75, 0.25, 0.75, 0.25, 0.25, 0.25, 0.75, 0.25, 0.25, 0.25, 0.75, 0.75, 0.75, 0.75, 0.25, 0.75, 0.75, 0.25, 0.75, 0.25, 0.25, 0.75, 0.75, 0.75, 0.75, 0.25, 0.25, 0.25, 0.75, 0.25]
[10, 10, 11, 10, 8, 10, 10, 10, 9, 10, 10, 11, 10, 11, 9, 11, 11, 10, 10, 10, 9, 10, 10, 11, 11, 9, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0589, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8196, 'compress@10': 0.7632, 'time@10': 6.7098}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0589, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8196, 'compress@10': 0.7632, 'time@10': 6.7098}:   3%|▎         | 1/30 [00:03<01:38,  3.39s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0563, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8357, 'compress@10': 0.5187, 'time@10': 6.3158}:   3%|▎         | 1/30 [00:09<01:38,  3.39s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0563, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8357, 'compress@10': 0.5187, 'time@10': 6.3158}:   7%|▋         | 2/30 [00:09<02:17,  4.90s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0576, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.8302, 'compress@10': 0.6077, 'time@10': 5.0067}:   7%|▋         | 2/30 [00:10<02:17,  4.90s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0576, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.8302, 'compress@10': 0.6077, 'time@10': 5.0067}:  10%|█         | 3/30 [00:10<01:26,  3.22s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0558, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.834, 'compress@10': 0.525, 'time@10': 5.0629}:  10%|█         | 3/30 [00:15<01:26,  3.22s/it]  {'epoch': 1, 'num_users': 5.0, 'loss': 0.0558, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.834, 'compress@10': 0.525, 'time@10': 5.0629}:  13%|█▎        | 4/30 [00:15<01:44,  4.03s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0628, 'hit_ratio@10': 0.7836, 'ndcg@10': 0.8226, 'compress@10': 0.473, 'time@10': 7.0718}:  13%|█▎        | 4/30 [00:23<01:44,  4.03s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0628, 'hit_ratio@10': 0.7836, 'ndcg@10': 0.8226, 'compress@10': 0.473, 'time@10': 7.0718}:  17%|█▋        | 5/30 [00:23<02:12,  5.31s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0654, 'hit_ratio@10': 0.7678, 'ndcg@10': 0.8206, 'compress@10': 0.4386, 'time@10': 7.2817}:  17%|█▋        | 5/30 [00:31<02:12,  5.31s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0654, 'hit_ratio@10': 0.7678, 'ndcg@10': 0.8206, 'compress@10': 0.4386, 'time@10': 7.2817}:  20%|██        | 6/30 [00:31<02:32,  6.35s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0624, 'hit_ratio@10': 0.7953, 'ndcg@10': 0.8276, 'compress@10': 0.4845, 'time@10': 7.5139}:  20%|██        | 6/30 [00:36<02:32,  6.35s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0624, 'hit_ratio@10': 0.7953, 'ndcg@10': 0.8276, 'compress@10': 0.4845, 'time@10': 7.5139}:  23%|██▎       | 7/30 [00:36<02:12,  5.74s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0593, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.8331, 'compress@10': 0.4579, 'time@10': 7.3996}:  23%|██▎       | 7/30 [00:42<02:12,  5.74s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0593, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.8331, 'compress@10': 0.4579, 'time@10': 7.3996}:  27%|██▋       | 8/30 [00:42<02:12,  6.02s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0566, 'hit_ratio@10': 0.7995, 'ndcg@10': 0.8425, 'compress@10': 0.4372, 'time@10': 7.8704}:  27%|██▋       | 8/30 [00:48<02:12,  6.02s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0566, 'hit_ratio@10': 0.7995, 'ndcg@10': 0.8425, 'compress@10': 0.4372, 'time@10': 7.8704}:  30%|███       | 9/30 [00:48<02:05,  5.97s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0557, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.8429, 'compress@10': 0.4201, 'time@10': 7.9535}:  30%|███       | 9/30 [00:57<02:05,  5.97s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0557, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.8429, 'compress@10': 0.4201, 'time@10': 7.9535}:  33%|███▎      | 10/30 [00:57<02:16,  6.82s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.0569, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8439, 'compress@10': 0.451, 'time@10': 8.0945}:  33%|███▎      | 10/30 [01:02<02:16,  6.82s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.0569, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8439, 'compress@10': 0.451, 'time@10': 8.0945}:  37%|███▋      | 11/30 [01:02<01:57,  6.20s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.0554, 'hit_ratio@10': 0.8076, 'ndcg@10': 0.843, 'compress@10': 0.4777, 'time@10': 7.6083}:  37%|███▋      | 11/30 [01:04<01:57,  6.20s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.0554, 'hit_ratio@10': 0.8076, 'ndcg@10': 0.843, 'compress@10': 0.4777, 'time@10': 7.6083}:  40%|████      | 12/30 [01:04<01:30,  5.01s/it]{'epoch': 1, 'num_users': 6.6154, 'loss': 0.0553, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.8445, 'compress@10': 0.4995, 'time@10': 7.6254}:  40%|████      | 12/30 [01:08<01:30,  5.01s/it]{'epoch': 1, 'num_users': 6.6154, 'loss': 0.0553, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.8445, 'compress@10': 0.4995, 'time@10': 7.6254}:  43%|████▎     | 13/30 [01:08<01:19,  4.69s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.07, 'hit_ratio@10': 0.7983, 'ndcg@10': 0.8104, 'compress@10': 0.5203, 'time@10': 7.1514}:  43%|████▎     | 13/30 [01:09<01:19,  4.69s/it]  {'epoch': 1, 'num_users': 6.3571, 'loss': 0.07, 'hit_ratio@10': 0.7983, 'ndcg@10': 0.8104, 'compress@10': 0.5203, 'time@10': 7.1514}:  47%|████▋     | 14/30 [01:09<00:57,  3.58s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.0692, 'hit_ratio@10': 0.8096, 'ndcg@10': 0.8142, 'compress@10': 0.5039, 'time@10': 7.365}:  47%|████▋     | 14/30 [01:14<00:57,  3.58s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.0692, 'hit_ratio@10': 0.8096, 'ndcg@10': 0.8142, 'compress@10': 0.5039, 'time@10': 7.365}:  50%|█████     | 15/30 [01:14<01:01,  4.07s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.0669, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.8169, 'compress@10': 0.5206, 'time@10': 7.0415}:  50%|█████     | 15/30 [01:16<01:01,  4.07s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.0669, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.8169, 'compress@10': 0.5206, 'time@10': 7.0415}:  53%|█████▎    | 16/30 [01:16<00:49,  3.51s/it]{'epoch': 1, 'num_users': 5.8235, 'loss': 0.0876, 'hit_ratio@10': 0.7585, 'ndcg@10': 0.7774, 'compress@10': 0.5371, 'time@10': 6.7194}:  53%|█████▎    | 16/30 [01:17<00:49,  3.51s/it]{'epoch': 1, 'num_users': 5.8235, 'loss': 0.0876, 'hit_ratio@10': 0.7585, 'ndcg@10': 0.7774, 'compress@10': 0.5371, 'time@10': 6.7194}:  57%|█████▋    | 17/30 [01:17<00:35,  2.70s/it]{'epoch': 1, 'num_users': 6.0556, 'loss': 0.0864, 'hit_ratio@10': 0.758, 'ndcg@10': 0.7811, 'compress@10': 0.5226, 'time@10': 6.6355}:  57%|█████▋    | 17/30 [01:23<00:35,  2.70s/it] {'epoch': 1, 'num_users': 6.0556, 'loss': 0.0864, 'hit_ratio@10': 0.758, 'ndcg@10': 0.7811, 'compress@10': 0.5226, 'time@10': 6.6355}:  60%|██████    | 18/30 [01:23<00:41,  3.47s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.0837, 'hit_ratio@10': 0.767, 'ndcg@10': 0.7805, 'compress@10': 0.5355, 'time@10': 6.5371}:  60%|██████    | 18/30 [01:25<00:41,  3.47s/it]   {'epoch': 1, 'num_users': 6.0, 'loss': 0.0837, 'hit_ratio@10': 0.767, 'ndcg@10': 0.7805, 'compress@10': 0.5355, 'time@10': 6.5371}:  63%|██████▎   | 19/30 [01:25<00:34,  3.15s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.0829, 'hit_ratio@10': 0.7725, 'ndcg@10': 0.7813, 'compress@10': 0.5219, 'time@10': 6.7473}:  63%|██████▎   | 19/30 [01:36<00:34,  3.15s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.0829, 'hit_ratio@10': 0.7725, 'ndcg@10': 0.7813, 'compress@10': 0.5219, 'time@10': 6.7473}:  67%|██████▋   | 20/30 [01:36<00:54,  5.44s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0825, 'hit_ratio@10': 0.7738, 'ndcg@10': 0.7828, 'compress@10': 0.5098, 'time@10': 7.0728}:  67%|██████▋   | 20/30 [01:43<00:54,  5.44s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0825, 'hit_ratio@10': 0.7738, 'ndcg@10': 0.7828, 'compress@10': 0.5098, 'time@10': 7.0728}:  70%|███████   | 21/30 [01:43<00:52,  5.85s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.0807, 'hit_ratio@10': 0.78, 'ndcg@10': 0.7882, 'compress@10': 0.5213, 'time@10': 6.9224}:  70%|███████   | 21/30 [01:46<00:52,  5.85s/it]  {'epoch': 1, 'num_users': 6.1818, 'loss': 0.0807, 'hit_ratio@10': 0.78, 'ndcg@10': 0.7882, 'compress@10': 0.5213, 'time@10': 6.9224}:  73%|███████▎  | 22/30 [01:46<00:41,  5.24s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.0785, 'hit_ratio@10': 0.783, 'ndcg@10': 0.7928, 'compress@10': 0.5318, 'time@10': 6.9209}:  73%|███████▎  | 22/30 [01:50<00:41,  5.24s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.0785, 'hit_ratio@10': 0.783, 'ndcg@10': 0.7928, 'compress@10': 0.5318, 'time@10': 6.9209}:  77%|███████▋  | 23/30 [01:50<00:32,  4.71s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.0893, 'hit_ratio@10': 0.767, 'ndcg@10': 0.7682, 'compress@10': 0.5429, 'time@10': 6.6656}:  77%|███████▋  | 23/30 [01:51<00:32,  4.71s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.0893, 'hit_ratio@10': 0.767, 'ndcg@10': 0.7682, 'compress@10': 0.5429, 'time@10': 6.6656}:  80%|████████  | 24/30 [01:51<00:21,  3.54s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.1284, 'hit_ratio@10': 0.7497, 'ndcg@10': 0.7386, 'compress@10': 0.5545, 'time@10': 6.4307}:  80%|████████  | 24/30 [01:51<00:21,  3.54s/it]  {'epoch': 1, 'num_users': 5.8, 'loss': 0.1284, 'hit_ratio@10': 0.7497, 'ndcg@10': 0.7386, 'compress@10': 0.5545, 'time@10': 6.4307}:  83%|████████▎ | 25/30 [01:51<00:13,  2.61s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.1268, 'hit_ratio@10': 0.7537, 'ndcg@10': 0.7397, 'compress@10': 0.5432, 'time@10': 6.7181}:  83%|████████▎ | 25/30 [02:05<00:13,  2.61s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.1268, 'hit_ratio@10': 0.7537, 'ndcg@10': 0.7397, 'compress@10': 0.5432, 'time@10': 6.7181}:  87%|████████▋ | 26/30 [02:05<00:24,  6.02s/it]{'epoch': 1, 'num_users': 5.8889, 'loss': 0.1233, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.7455, 'compress@10': 0.5333, 'time@10': 6.8572}:  87%|████████▋ | 26/30 [02:10<00:24,  6.02s/it]{'epoch': 1, 'num_users': 5.8889, 'loss': 0.1233, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.7455, 'compress@10': 0.5333, 'time@10': 6.8572}:  90%|█████████ | 27/30 [02:10<00:17,  5.79s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.1209, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.75, 'compress@10': 0.5237, 'time@10': 6.9589}:  90%|█████████ | 27/30 [02:20<00:17,  5.79s/it]     {'epoch': 1, 'num_users': 6.0, 'loss': 0.1209, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.75, 'compress@10': 0.5237, 'time@10': 6.9589}:  93%|█████████▎| 28/30 [02:20<00:13,  6.98s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.1174, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.7556, 'compress@10': 0.5319, 'time@10': 6.9799}:  93%|█████████▎| 28/30 [02:24<00:13,  6.98s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.1174, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.7556, 'compress@10': 0.5319, 'time@10': 6.9799}:  97%|█████████▋| 29/30 [02:24<00:06,  6.03s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.1148, 'hit_ratio@10': 0.7687, 'ndcg@10': 0.7604, 'compress@10': 0.5232, 'time@10': 6.9764}:  97%|█████████▋| 29/30 [02:31<00:06,  6.03s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.1148, 'hit_ratio@10': 0.7687, 'ndcg@10': 0.7604, 'compress@10': 0.5232, 'time@10': 6.9764}: 100%|██████████| 30/30 [02:31<00:00,  6.29s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.1148, 'hit_ratio@10': 0.7687, 'ndcg@10': 0.7604, 'compress@10': 0.5232, 'time@10': 6.9764}: 100%|██████████| 30/30 [02:31<00:00,  5.04s/it]
Epoch: 1
Avg # of users: 5.866666666666666
Avg Loss: 0.11478187868909263
Avg hit ratio: 0.7687282878563093
Avg ndcg: 0.7604231297754082
Avg compression ratio: 0.5231955442858068
Avg train time: 6.9763792753219604
Std train time: 3.963331965851935
Traceback (most recent call last):
  File "/slstore/shihongjian/Federated-Recommendation-Neural-Collaborative-Filtering/train_federated.py", line 204, in <module>
    fncf.train()
  File "/slstore/shihongjian/Federated-Recommendation-Neural-Collaborative-Filtering/train_federated.py", line 136, in train
    federate(self.utils)
  File "/slstore/shihongjian/Federated-Recommendation-Neural-Collaborative-Filtering/train_federated.py", line 37, in federate
    client_models = utils.get_user_models(utils.load_pytorch_client_model)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/slstore/shihongjian/Federated-Recommendation-Neural-Collaborative-Filtering/train_federated.py", line 26, in get_user_models
    models.append({'model':loader(self.local_path+"dp"+str(client_id)+".pt")})
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/slstore/shihongjian/Federated-Recommendation-Neural-Collaborative-Filtering/train_federated.py", line 21, in load_pytorch_client_model
    return torch.jit.load(path)
           ^^^^^^^^^^^^^^^^^^^^
  File "/slstore/shihongjian/anaconda3/envs/fl/lib/python3.11/site-packages/torch/jit/_serialization.py", line 162, in load
    cpp_module = torch._C.import_ir_module(cu, str(f), map_location, _extra_files, _restore_shapes)  # type: ignore[call-arg]
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: PytorchStreamReader failed reading file data/0: file read failed
