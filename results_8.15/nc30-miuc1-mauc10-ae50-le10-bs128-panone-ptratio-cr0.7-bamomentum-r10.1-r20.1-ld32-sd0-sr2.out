  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1749, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5116, 'compress@10': 0.9617, 'time@10': 7.1459}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1749, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5116, 'compress@10': 0.9617, 'time@10': 7.1459}:   3%|▎         | 1/30 [00:03<01:45,  3.62s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1304, 'hit_ratio@10': 0.618, 'ndcg@10': 0.6105, 'compress@10': 0.9654, 'time@10': 6.048}:   3%|▎         | 1/30 [00:08<01:45,  3.62s/it]  {'epoch': 0, 'num_users': 7.0, 'loss': 0.1304, 'hit_ratio@10': 0.618, 'ndcg@10': 0.6105, 'compress@10': 0.9654, 'time@10': 6.048}:   7%|▋         | 2/30 [00:08<02:04,  4.43s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7683, 'hit_ratio@10': 0.4596, 'ndcg@10': 0.407, 'compress@10': 0.9687, 'time@10': 4.6871}:   7%|▋         | 2/30 [00:09<02:04,  4.43s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7683, 'hit_ratio@10': 0.4596, 'ndcg@10': 0.407, 'compress@10': 0.9687, 'time@10': 4.6871}:  10%|█         | 3/30 [00:09<01:17,  2.88s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6043, 'hit_ratio@10': 0.5322, 'ndcg@10': 0.4535, 'compress@10': 0.9691, 'time@10': 4.6144}:  10%|█         | 3/30 [00:14<01:17,  2.88s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6043, 'hit_ratio@10': 0.5322, 'ndcg@10': 0.4535, 'compress@10': 0.9691, 'time@10': 4.6144}:  13%|█▎        | 4/30 [00:14<01:30,  3.50s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5022, 'hit_ratio@10': 0.5898, 'ndcg@10': 0.511, 'compress@10': 0.9701, 'time@10': 6.9205}:  13%|█▎        | 4/30 [00:22<01:30,  3.50s/it] {'epoch': 0, 'num_users': 5.8, 'loss': 0.5022, 'hit_ratio@10': 0.5898, 'ndcg@10': 0.511, 'compress@10': 0.9701, 'time@10': 6.9205}:  17%|█▋        | 5/30 [00:22<02:09,  5.16s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4331, 'hit_ratio@10': 0.6137, 'ndcg@10': 0.555, 'compress@10': 0.9713, 'time@10': 6.9853}:  17%|█▋        | 5/30 [00:29<02:09,  5.16s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4331, 'hit_ratio@10': 0.6137, 'ndcg@10': 0.555, 'compress@10': 0.9713, 'time@10': 6.9853}:  20%|██        | 6/30 [00:29<02:21,  5.91s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3881, 'hit_ratio@10': 0.6346, 'ndcg@10': 0.5578, 'compress@10': 0.9724, 'time@10': 7.1223}:  20%|██        | 6/30 [00:33<02:21,  5.91s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3881, 'hit_ratio@10': 0.6346, 'ndcg@10': 0.5578, 'compress@10': 0.9724, 'time@10': 7.1223}:  23%|██▎       | 7/30 [00:33<02:01,  5.29s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3466, 'hit_ratio@10': 0.6696, 'ndcg@10': 0.5838, 'compress@10': 0.9728, 'time@10': 6.9309}:  23%|██▎       | 7/30 [00:39<02:01,  5.29s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3466, 'hit_ratio@10': 0.6696, 'ndcg@10': 0.5838, 'compress@10': 0.9728, 'time@10': 6.9309}:  27%|██▋       | 8/30 [00:39<01:58,  5.40s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3149, 'hit_ratio@10': 0.6841, 'ndcg@10': 0.6184, 'compress@10': 0.9727, 'time@10': 7.4091}:  27%|██▋       | 8/30 [00:44<01:58,  5.40s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3149, 'hit_ratio@10': 0.6841, 'ndcg@10': 0.6184, 'compress@10': 0.9727, 'time@10': 7.4091}:  30%|███       | 9/30 [00:44<01:55,  5.48s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2887, 'hit_ratio@10': 0.7088, 'ndcg@10': 0.6404, 'compress@10': 0.9734, 'time@10': 7.3784}:  30%|███       | 9/30 [00:52<01:55,  5.48s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2887, 'hit_ratio@10': 0.7088, 'ndcg@10': 0.6404, 'compress@10': 0.9734, 'time@10': 7.3784}:  33%|███▎      | 10/30 [00:52<01:59,  5.99s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.2748, 'hit_ratio@10': 0.7073, 'ndcg@10': 0.6389, 'compress@10': 0.9731, 'time@10': 7.4602}:  33%|███▎      | 10/30 [00:56<01:59,  5.99s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.2748, 'hit_ratio@10': 0.7073, 'ndcg@10': 0.6389, 'compress@10': 0.9731, 'time@10': 7.4602}:  37%|███▋      | 11/30 [00:56<01:43,  5.44s/it]{'epoch': 0, 'num_users': 6.4167, 'loss': 0.3932, 'hit_ratio@10': 0.6831, 'ndcg@10': 0.5903, 'compress@10': 0.9729, 'time@10': 6.988}:  37%|███▋      | 11/30 [00:58<01:43,  5.44s/it] {'epoch': 0, 'num_users': 6.4167, 'loss': 0.3932, 'hit_ratio@10': 0.6831, 'ndcg@10': 0.5903, 'compress@10': 0.9729, 'time@10': 6.988}:  40%|████      | 12/30 [00:58<01:18,  4.34s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.3751, 'hit_ratio@10': 0.6865, 'ndcg@10': 0.5854, 'compress@10': 0.9736, 'time@10': 6.9828}:  40%|████      | 12/30 [01:01<01:18,  4.34s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.3751, 'hit_ratio@10': 0.6865, 'ndcg@10': 0.5854, 'compress@10': 0.9736, 'time@10': 6.9828}:  43%|████▎     | 13/30 [01:01<01:09,  4.09s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.5372, 'hit_ratio@10': 0.6613, 'ndcg@10': 0.5436, 'compress@10': 0.9725, 'time@10': 6.5423}:  43%|████▎     | 13/30 [01:02<01:09,  4.09s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.5372, 'hit_ratio@10': 0.6613, 'ndcg@10': 0.5436, 'compress@10': 0.9725, 'time@10': 6.5423}:  47%|████▋     | 14/30 [01:02<00:49,  3.11s/it]{'epoch': 0, 'num_users': 6.2667, 'loss': 0.5073, 'hit_ratio@10': 0.6796, 'ndcg@10': 0.553, 'compress@10': 0.9722, 'time@10': 6.7625}:  47%|████▋     | 14/30 [01:07<00:49,  3.11s/it] {'epoch': 0, 'num_users': 6.2667, 'loss': 0.5073, 'hit_ratio@10': 0.6796, 'ndcg@10': 0.553, 'compress@10': 0.9722, 'time@10': 6.7625}:  50%|█████     | 15/30 [01:07<00:55,  3.67s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.577, 'hit_ratio@10': 0.6631, 'ndcg@10': 0.5222, 'compress@10': 0.9728, 'time@10': 6.4523}:  50%|█████     | 15/30 [01:09<00:55,  3.67s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.577, 'hit_ratio@10': 0.6631, 'ndcg@10': 0.5222, 'compress@10': 0.9728, 'time@10': 6.4523}:  53%|█████▎    | 16/30 [01:09<00:43,  3.12s/it]{'epoch': 0, 'num_users': 5.8235, 'loss': 0.6742, 'hit_ratio@10': 0.6476, 'ndcg@10': 0.4915, 'compress@10': 0.9731, 'time@10': 6.1489}:  53%|█████▎    | 16/30 [01:09<00:43,  3.12s/it]{'epoch': 0, 'num_users': 5.8235, 'loss': 0.6742, 'hit_ratio@10': 0.6476, 'ndcg@10': 0.4915, 'compress@10': 0.9731, 'time@10': 6.1489}:  57%|█████▋    | 17/30 [01:09<00:31,  2.39s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 0.6429, 'hit_ratio@10': 0.6533, 'ndcg@10': 0.5028, 'compress@10': 0.9733, 'time@10': 6.0551}:  57%|█████▋    | 17/30 [01:14<00:31,  2.39s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 0.6429, 'hit_ratio@10': 0.6533, 'ndcg@10': 0.5028, 'compress@10': 0.9733, 'time@10': 6.0551}:  60%|██████    | 18/30 [01:14<00:36,  3.02s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.6394, 'hit_ratio@10': 0.6415, 'ndcg@10': 0.4849, 'compress@10': 0.9734, 'time@10': 5.9628}:  60%|██████    | 18/30 [01:16<00:36,  3.02s/it]   {'epoch': 0, 'num_users': 6.0, 'loss': 0.6394, 'hit_ratio@10': 0.6415, 'ndcg@10': 0.4849, 'compress@10': 0.9734, 'time@10': 5.9628}:  63%|██████▎   | 19/30 [01:16<00:30,  2.78s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.6109, 'hit_ratio@10': 0.6507, 'ndcg@10': 0.5005, 'compress@10': 0.9737, 'time@10': 6.1248}:  63%|██████▎   | 19/30 [01:25<00:30,  2.78s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.6109, 'hit_ratio@10': 0.6507, 'ndcg@10': 0.5005, 'compress@10': 0.9737, 'time@10': 6.1248}:  67%|██████▋   | 20/30 [01:25<00:47,  4.72s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.5861, 'hit_ratio@10': 0.6566, 'ndcg@10': 0.5142, 'compress@10': 0.9734, 'time@10': 6.4465}:  67%|██████▋   | 20/30 [01:32<00:47,  4.72s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.5861, 'hit_ratio@10': 0.6566, 'ndcg@10': 0.5142, 'compress@10': 0.9734, 'time@10': 6.4465}:  70%|███████   | 21/30 [01:32<00:47,  5.25s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 0.5703, 'hit_ratio@10': 0.6619, 'ndcg@10': 0.5115, 'compress@10': 0.9736, 'time@10': 6.3086}:  70%|███████   | 21/30 [01:35<00:47,  5.25s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 0.5703, 'hit_ratio@10': 0.6619, 'ndcg@10': 0.5115, 'compress@10': 0.9736, 'time@10': 6.3086}:  73%|███████▎  | 22/30 [01:35<00:37,  4.71s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 0.5511, 'hit_ratio@10': 0.6635, 'ndcg@10': 0.5115, 'compress@10': 0.974, 'time@10': 6.304}:  73%|███████▎  | 22/30 [01:38<00:37,  4.71s/it]  {'epoch': 0, 'num_users': 6.1304, 'loss': 0.5511, 'hit_ratio@10': 0.6635, 'ndcg@10': 0.5115, 'compress@10': 0.974, 'time@10': 6.304}:  77%|███████▋  | 23/30 [01:38<00:29,  4.24s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.6262, 'hit_ratio@10': 0.6525, 'ndcg@10': 0.4901, 'compress@10': 0.9737, 'time@10': 6.068}:  77%|███████▋  | 23/30 [01:39<00:29,  4.24s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.6262, 'hit_ratio@10': 0.6525, 'ndcg@10': 0.4901, 'compress@10': 0.9737, 'time@10': 6.068}:  80%|████████  | 24/30 [01:39<00:19,  3.17s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.6803, 'hit_ratio@10': 0.6264, 'ndcg@10': 0.4705, 'compress@10': 0.9736, 'time@10': 5.8511}:  80%|████████  | 24/30 [01:39<00:19,  3.17s/it]  {'epoch': 0, 'num_users': 5.8, 'loss': 0.6803, 'hit_ratio@10': 0.6264, 'ndcg@10': 0.4705, 'compress@10': 0.9736, 'time@10': 5.8511}:  83%|████████▎ | 25/30 [01:39<00:11,  2.33s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.6577, 'hit_ratio@10': 0.6342, 'ndcg@10': 0.4818, 'compress@10': 0.9735, 'time@10': 6.1354}:  83%|████████▎ | 25/30 [01:53<00:11,  2.33s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.6577, 'hit_ratio@10': 0.6342, 'ndcg@10': 0.4818, 'compress@10': 0.9735, 'time@10': 6.1354}:  87%|████████▋ | 26/30 [01:53<00:22,  5.62s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 0.6361, 'hit_ratio@10': 0.6425, 'ndcg@10': 0.4896, 'compress@10': 0.9736, 'time@10': 6.2391}:  87%|████████▋ | 26/30 [01:57<00:22,  5.62s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 0.6361, 'hit_ratio@10': 0.6425, 'ndcg@10': 0.4896, 'compress@10': 0.9736, 'time@10': 6.2391}:  90%|█████████ | 27/30 [01:57<00:15,  5.29s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.6155, 'hit_ratio@10': 0.649, 'ndcg@10': 0.5036, 'compress@10': 0.9737, 'time@10': 6.3093}:  90%|█████████ | 27/30 [02:06<00:15,  5.29s/it]    {'epoch': 0, 'num_users': 6.0, 'loss': 0.6155, 'hit_ratio@10': 0.649, 'ndcg@10': 0.5036, 'compress@10': 0.9737, 'time@10': 6.3093}:  93%|█████████▎| 28/30 [02:06<00:12,  6.18s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.5989, 'hit_ratio@10': 0.6595, 'ndcg@10': 0.5049, 'compress@10': 0.9737, 'time@10': 6.3298}:  93%|█████████▎| 28/30 [02:09<00:12,  6.18s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.5989, 'hit_ratio@10': 0.6595, 'ndcg@10': 0.5049, 'compress@10': 0.9737, 'time@10': 6.3298}:  97%|█████████▋| 29/30 [02:09<00:05,  5.37s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.5809, 'hit_ratio@10': 0.6636, 'ndcg@10': 0.5181, 'compress@10': 0.9738, 'time@10': 6.3126}:  97%|█████████▋| 29/30 [02:15<00:05,  5.37s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.5809, 'hit_ratio@10': 0.6636, 'ndcg@10': 0.5181, 'compress@10': 0.9738, 'time@10': 6.3126}: 100%|██████████| 30/30 [02:15<00:00,  5.52s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.5809, 'hit_ratio@10': 0.6636, 'ndcg@10': 0.5181, 'compress@10': 0.9738, 'time@10': 6.3126}: 100%|██████████| 30/30 [02:15<00:00,  4.51s/it]
Epoch: 0
Avg # of users: 5.866666666666666
Avg Loss: 0.5808661304505311
Avg hit ratio: 0.6636382814354975
Avg ndcg: 0.5181019955611832
Avg compression ratio: 0.9737569389843446
Avg train time: 6.312615815798441
Std train time: 3.892111393429747
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 11, 10, 8, 10, 10, 10, 9, 10, 10, 11, 10, 11, 9, 11, 11, 10, 10, 10, 9, 10, 10, 11, 11, 9, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0607, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8182, 'compress@10': 0.9886, 'time@10': 5.7701}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0607, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8182, 'compress@10': 0.9886, 'time@10': 5.7701}:   3%|▎         | 1/30 [00:02<01:24,  2.93s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0574, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8383, 'compress@10': 0.9873, 'time@10': 5.3501}:   3%|▎         | 1/30 [00:07<01:24,  2.93s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0574, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8383, 'compress@10': 0.9873, 'time@10': 5.3501}:   7%|▋         | 2/30 [00:07<01:55,  4.13s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0478, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.8078, 'compress@10': 0.9867, 'time@10': 4.2854}:   7%|▋         | 2/30 [00:09<01:55,  4.13s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0478, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.8078, 'compress@10': 0.9867, 'time@10': 4.2854}:  10%|█         | 3/30 [00:09<01:14,  2.76s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0487, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8185, 'compress@10': 0.9852, 'time@10': 4.3136}:  10%|█         | 3/30 [00:13<01:14,  2.76s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0487, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8185, 'compress@10': 0.9852, 'time@10': 4.3136}:  13%|█▎        | 4/30 [00:13<01:28,  3.42s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0569, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8083, 'compress@10': 0.9834, 'time@10': 6.0393}:  13%|█▎        | 4/30 [00:19<01:28,  3.42s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0569, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8083, 'compress@10': 0.9834, 'time@10': 6.0393}:  17%|█▋        | 5/30 [00:19<01:53,  4.54s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0604, 'hit_ratio@10': 0.7749, 'ndcg@10': 0.8086, 'compress@10': 0.982, 'time@10': 6.2425}:  17%|█▋        | 5/30 [00:27<01:53,  4.54s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0604, 'hit_ratio@10': 0.7749, 'ndcg@10': 0.8086, 'compress@10': 0.982, 'time@10': 6.2425}:  20%|██        | 6/30 [00:27<02:11,  5.48s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0582, 'hit_ratio@10': 0.8013, 'ndcg@10': 0.8174, 'compress@10': 0.9819, 'time@10': 6.4735}:  20%|██        | 6/30 [00:31<02:11,  5.48s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0582, 'hit_ratio@10': 0.8013, 'ndcg@10': 0.8174, 'compress@10': 0.9819, 'time@10': 6.4735}:  23%|██▎       | 7/30 [00:31<01:54,  4.98s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0557, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8244, 'compress@10': 0.9821, 'time@10': 6.3572}:  23%|██▎       | 7/30 [00:36<01:54,  4.98s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0557, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8244, 'compress@10': 0.9821, 'time@10': 6.3572}:  27%|██▋       | 8/30 [00:36<01:53,  5.18s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0535, 'hit_ratio@10': 0.8042, 'ndcg@10': 0.8344, 'compress@10': 0.9816, 'time@10': 6.7681}:  27%|██▋       | 8/30 [00:41<01:53,  5.18s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0535, 'hit_ratio@10': 0.8042, 'ndcg@10': 0.8344, 'compress@10': 0.9816, 'time@10': 6.7681}:  30%|███       | 9/30 [00:41<01:47,  5.14s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0528, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8355, 'compress@10': 0.9812, 'time@10': 6.7945}:  30%|███       | 9/30 [00:48<01:47,  5.14s/it]    {'epoch': 1, 'num_users': 6.3, 'loss': 0.0528, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8355, 'compress@10': 0.9812, 'time@10': 6.7945}:  33%|███▎      | 10/30 [00:48<01:54,  5.74s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.0544, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8365, 'compress@10': 0.9807, 'time@10': 6.9278}:  33%|███▎      | 10/30 [00:53<01:54,  5.74s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.0544, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8365, 'compress@10': 0.9807, 'time@10': 6.9278}:  37%|███▋      | 11/30 [00:53<01:39,  5.26s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.0529, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8398, 'compress@10': 0.9816, 'time@10': 6.5132}:  37%|███▋      | 11/30 [00:55<01:39,  5.26s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.0529, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8398, 'compress@10': 0.9816, 'time@10': 6.5132}:  40%|████      | 12/30 [00:55<01:16,  4.27s/it]{'epoch': 1, 'num_users': 6.6154, 'loss': 0.0532, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.8422, 'compress@10': 0.9813, 'time@10': 6.542}:  40%|████      | 12/30 [00:58<01:16,  4.27s/it] {'epoch': 1, 'num_users': 6.6154, 'loss': 0.0532, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.8422, 'compress@10': 0.9813, 'time@10': 6.542}:  43%|████▎     | 13/30 [00:58<01:08,  4.03s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.0598, 'hit_ratio@10': 0.7894, 'ndcg@10': 0.8244, 'compress@10': 0.9803, 'time@10': 6.1369}:  43%|████▎     | 13/30 [00:59<01:08,  4.03s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.0598, 'hit_ratio@10': 0.7894, 'ndcg@10': 0.8244, 'compress@10': 0.9803, 'time@10': 6.1369}:  47%|████▋     | 14/30 [00:59<00:49,  3.09s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.0598, 'hit_ratio@10': 0.7992, 'ndcg@10': 0.8273, 'compress@10': 0.98, 'time@10': 6.3147}:  47%|████▋     | 14/30 [01:03<00:49,  3.09s/it]  {'epoch': 1, 'num_users': 6.2667, 'loss': 0.0598, 'hit_ratio@10': 0.7992, 'ndcg@10': 0.8273, 'compress@10': 0.98, 'time@10': 6.3147}:  50%|█████     | 15/30 [01:03<00:52,  3.50s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.0578, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8284, 'compress@10': 0.9795, 'time@10': 6.0302}:  50%|█████     | 15/30 [01:05<00:52,  3.50s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.0578, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8284, 'compress@10': 0.9795, 'time@10': 6.0302}:  53%|█████▎    | 16/30 [01:05<00:41,  2.99s/it]{'epoch': 1, 'num_users': 5.8235, 'loss': 0.0646, 'hit_ratio@10': 0.761, 'ndcg@10': 0.8001, 'compress@10': 0.9795, 'time@10': 5.7449}:  53%|█████▎    | 16/30 [01:06<00:41,  2.99s/it] {'epoch': 1, 'num_users': 5.8235, 'loss': 0.0646, 'hit_ratio@10': 0.761, 'ndcg@10': 0.8001, 'compress@10': 0.9795, 'time@10': 5.7449}:  57%|█████▋    | 17/30 [01:06<00:29,  2.28s/it]{'epoch': 1, 'num_users': 6.0556, 'loss': 0.0647, 'hit_ratio@10': 0.7584, 'ndcg@10': 0.8018, 'compress@10': 0.9796, 'time@10': 5.6708}:  57%|█████▋    | 17/30 [01:10<00:29,  2.28s/it]{'epoch': 1, 'num_users': 6.0556, 'loss': 0.0647, 'hit_ratio@10': 0.7584, 'ndcg@10': 0.8018, 'compress@10': 0.9796, 'time@10': 5.6708}:  60%|██████    | 18/30 [01:10<00:35,  2.93s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.0631, 'hit_ratio@10': 0.7636, 'ndcg@10': 0.8028, 'compress@10': 0.9801, 'time@10': 5.6193}:  60%|██████    | 18/30 [01:13<00:35,  2.93s/it]   {'epoch': 1, 'num_users': 6.0, 'loss': 0.0631, 'hit_ratio@10': 0.7636, 'ndcg@10': 0.8028, 'compress@10': 0.9801, 'time@10': 5.6193}:  63%|██████▎   | 19/30 [01:13<00:30,  2.77s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.0632, 'hit_ratio@10': 0.7684, 'ndcg@10': 0.8027, 'compress@10': 0.9801, 'time@10': 5.832}:  63%|██████▎   | 19/30 [01:23<00:30,  2.77s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.0632, 'hit_ratio@10': 0.7684, 'ndcg@10': 0.8027, 'compress@10': 0.9801, 'time@10': 5.832}:  67%|██████▋   | 20/30 [01:23<00:49,  4.91s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0638, 'hit_ratio@10': 0.7699, 'ndcg@10': 0.8033, 'compress@10': 0.98, 'time@10': 6.1088}:  67%|██████▋   | 20/30 [01:29<00:49,  4.91s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0638, 'hit_ratio@10': 0.7699, 'ndcg@10': 0.8033, 'compress@10': 0.98, 'time@10': 6.1088}:  70%|███████   | 21/30 [01:29<00:46,  5.20s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.0628, 'hit_ratio@10': 0.7763, 'ndcg@10': 0.8078, 'compress@10': 0.98, 'time@10': 5.9869}:  70%|███████   | 21/30 [01:32<00:46,  5.20s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.0628, 'hit_ratio@10': 0.7763, 'ndcg@10': 0.8078, 'compress@10': 0.98, 'time@10': 5.9869}:  73%|███████▎  | 22/30 [01:32<00:37,  4.68s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.0614, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8116, 'compress@10': 0.98, 'time@10': 5.9963}:  73%|███████▎  | 22/30 [01:35<00:37,  4.68s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.0614, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8116, 'compress@10': 0.98, 'time@10': 5.9963}:  77%|███████▋  | 23/30 [01:35<00:29,  4.22s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.0655, 'hit_ratio@10': 0.7553, 'ndcg@10': 0.7937, 'compress@10': 0.9802, 'time@10': 5.7759}:  77%|███████▋  | 23/30 [01:36<00:29,  4.22s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.0655, 'hit_ratio@10': 0.7553, 'ndcg@10': 0.7937, 'compress@10': 0.9802, 'time@10': 5.7759}:  80%|████████  | 24/30 [01:36<00:19,  3.18s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0911, 'hit_ratio@10': 0.7384, 'ndcg@10': 0.7647, 'compress@10': 0.9802, 'time@10': 5.5733}:  80%|████████  | 24/30 [01:36<00:19,  3.18s/it]   {'epoch': 1, 'num_users': 5.8, 'loss': 0.0911, 'hit_ratio@10': 0.7384, 'ndcg@10': 0.7647, 'compress@10': 0.9802, 'time@10': 5.5733}:  83%|████████▎ | 25/30 [01:36<00:11,  2.34s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.0909, 'hit_ratio@10': 0.7424, 'ndcg@10': 0.7648, 'compress@10': 0.98, 'time@10': 5.8192}:  83%|████████▎ | 25/30 [01:48<00:11,  2.34s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.0909, 'hit_ratio@10': 0.7424, 'ndcg@10': 0.7648, 'compress@10': 0.98, 'time@10': 5.8192}:  87%|████████▋ | 26/30 [01:48<00:20,  5.24s/it]{'epoch': 1, 'num_users': 5.8889, 'loss': 0.0888, 'hit_ratio@10': 0.7506, 'ndcg@10': 0.7692, 'compress@10': 0.9799, 'time@10': 5.9327}:  87%|████████▋ | 26/30 [01:53<00:20,  5.24s/it]{'epoch': 1, 'num_users': 5.8889, 'loss': 0.0888, 'hit_ratio@10': 0.7506, 'ndcg@10': 0.7692, 'compress@10': 0.9799, 'time@10': 5.9327}:  90%|█████████ | 27/30 [01:53<00:15,  5.02s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.0876, 'hit_ratio@10': 0.7546, 'ndcg@10': 0.773, 'compress@10': 0.9799, 'time@10': 6.0168}:  90%|█████████ | 27/30 [02:01<00:15,  5.02s/it]    {'epoch': 1, 'num_users': 6.0, 'loss': 0.0876, 'hit_ratio@10': 0.7546, 'ndcg@10': 0.773, 'compress@10': 0.9799, 'time@10': 6.0168}:  93%|█████████▎| 28/30 [02:01<00:12,  6.01s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.0853, 'hit_ratio@10': 0.7599, 'ndcg@10': 0.7775, 'compress@10': 0.9802, 'time@10': 6.0451}:  93%|█████████▎| 28/30 [02:05<00:12,  6.01s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.0853, 'hit_ratio@10': 0.7599, 'ndcg@10': 0.7775, 'compress@10': 0.9802, 'time@10': 6.0451}:  97%|█████████▋| 29/30 [02:05<00:05,  5.24s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.0837, 'hit_ratio@10': 0.7589, 'ndcg@10': 0.7816, 'compress@10': 0.9802, 'time@10': 6.0343}:  97%|█████████▋| 29/30 [02:10<00:05,  5.24s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.0837, 'hit_ratio@10': 0.7589, 'ndcg@10': 0.7816, 'compress@10': 0.9802, 'time@10': 6.0343}: 100%|██████████| 30/30 [02:10<00:00,  5.40s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.0837, 'hit_ratio@10': 0.7589, 'ndcg@10': 0.7816, 'compress@10': 0.9802, 'time@10': 6.0343}: 100%|██████████| 30/30 [02:10<00:00,  4.36s/it]
Epoch: 1
Avg # of users: 5.866666666666666
Avg Loss: 0.08367746353370001
Avg hit ratio: 0.7589421429328502
Avg ndcg: 0.7815710594094651
Avg compression ratio: 0.9801758791241238
Avg train time: 6.034283018112182
Std train time: 3.41962339499572
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 12, 10, 7, 10, 10, 10, 8, 10, 10, 12, 10, 12, 9, 12, 12, 10, 10, 9, 8, 10, 10, 12, 12, 8, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8496, 'compress@10': 0.9907, 'time@10': 4.8728}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8496, 'compress@10': 0.9907, 'time@10': 4.8728}:   3%|▎         | 1/30 [00:02<01:11,  2.48s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0507, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8503, 'compress@10': 0.9882, 'time@10': 4.9111}:   3%|▎         | 1/30 [00:07<01:11,  2.48s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0507, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8503, 'compress@10': 0.9882, 'time@10': 4.9111}:   7%|▋         | 2/30 [00:07<01:50,  3.96s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8436, 'compress@10': 0.9833, 'time@10': 4.054}:   7%|▋         | 2/30 [00:08<01:50,  3.96s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8436, 'compress@10': 0.9833, 'time@10': 4.054}:  10%|█         | 3/30 [00:08<01:12,  2.70s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0387, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8444, 'compress@10': 0.9819, 'time@10': 4.1416}:  10%|█         | 3/30 [00:13<01:12,  2.70s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0387, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8444, 'compress@10': 0.9819, 'time@10': 4.1416}:  13%|█▎        | 4/30 [00:13<01:28,  3.39s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0491, 'hit_ratio@10': 0.8006, 'ndcg@10': 0.8318, 'compress@10': 0.9812, 'time@10': 5.593}:  13%|█▎        | 4/30 [00:18<01:28,  3.39s/it] {'epoch': 2, 'num_users': 5.8, 'loss': 0.0491, 'hit_ratio@10': 0.8006, 'ndcg@10': 0.8318, 'compress@10': 0.9812, 'time@10': 5.593}:  17%|█▋        | 5/30 [00:18<01:45,  4.24s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0536, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.829, 'compress@10': 0.9801, 'time@10': 5.8717}:  17%|█▋        | 5/30 [00:26<01:45,  4.24s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0536, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.829, 'compress@10': 0.9801, 'time@10': 5.8717}:  20%|██        | 6/30 [00:26<02:06,  5.28s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0519, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8325, 'compress@10': 0.9805, 'time@10': 6.1601}:  20%|██        | 6/30 [00:30<02:06,  5.28s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0519, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8325, 'compress@10': 0.9805, 'time@10': 6.1601}:  23%|██▎       | 7/30 [00:30<01:51,  4.86s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8383, 'compress@10': 0.9807, 'time@10': 6.0847}:  23%|██▎       | 7/30 [00:35<01:51,  4.86s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8383, 'compress@10': 0.9807, 'time@10': 6.0847}:  27%|██▋       | 8/30 [00:35<01:52,  5.09s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0488, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8465, 'compress@10': 0.9795, 'time@10': 6.3996}:  27%|██▋       | 8/30 [00:40<01:52,  5.09s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0488, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8465, 'compress@10': 0.9795, 'time@10': 6.3996}:  30%|███       | 9/30 [00:40<01:43,  4.91s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0484, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8463, 'compress@10': 0.9793, 'time@10': 6.4686}:  30%|███       | 9/30 [00:47<01:43,  4.91s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0484, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8463, 'compress@10': 0.9793, 'time@10': 6.4686}:  33%|███▎      | 10/30 [00:47<01:51,  5.59s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.0498, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.848, 'compress@10': 0.9797, 'time@10': 6.6332}:  33%|███▎      | 10/30 [00:51<01:51,  5.59s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.0498, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.848, 'compress@10': 0.9797, 'time@10': 6.6332}:  37%|███▋      | 11/30 [00:51<01:38,  5.16s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0474, 'hit_ratio@10': 0.8197, 'ndcg@10': 0.8545, 'compress@10': 0.9799, 'time@10': 6.2618}:  37%|███▋      | 11/30 [00:53<01:38,  5.16s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0474, 'hit_ratio@10': 0.8197, 'ndcg@10': 0.8545, 'compress@10': 0.9799, 'time@10': 6.2618}:  40%|████      | 12/30 [00:53<01:16,  4.27s/it]{'epoch': 2, 'num_users': 6.6154, 'loss': 0.0476, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8559, 'compress@10': 0.9798, 'time@10': 6.3105}:  40%|████      | 12/30 [00:57<01:16,  4.27s/it]{'epoch': 2, 'num_users': 6.6154, 'loss': 0.0476, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8559, 'compress@10': 0.9798, 'time@10': 6.3105}:  43%|████▎     | 13/30 [00:57<01:08,  4.03s/it]{'epoch': 2, 'num_users': 6.3571, 'loss': 0.0478, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.8464, 'compress@10': 0.9795, 'time@10': 5.9285}:  43%|████▎     | 13/30 [00:58<01:08,  4.03s/it]{'epoch': 2, 'num_users': 6.3571, 'loss': 0.0478, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.8464, 'compress@10': 0.9795, 'time@10': 5.9285}:  47%|████▋     | 14/30 [00:58<00:49,  3.12s/it]{'epoch': 2, 'num_users': 6.2667, 'loss': 0.0484, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8488, 'compress@10': 0.9796, 'time@10': 6.1194}:  47%|████▋     | 14/30 [01:02<00:49,  3.12s/it]{'epoch': 2, 'num_users': 6.2667, 'loss': 0.0484, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8488, 'compress@10': 0.9796, 'time@10': 6.1194}:  50%|█████     | 15/30 [01:02<00:52,  3.51s/it]{'epoch': 2, 'num_users': 6.0625, 'loss': 0.0464, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8513, 'compress@10': 0.9788, 'time@10': 5.8713}:  50%|█████     | 15/30 [01:04<00:52,  3.51s/it]{'epoch': 2, 'num_users': 6.0625, 'loss': 0.0464, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8513, 'compress@10': 0.9788, 'time@10': 5.8713}:  53%|█████▎    | 16/30 [01:04<00:43,  3.12s/it]{'epoch': 2, 'num_users': 5.8235, 'loss': 0.0468, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8353, 'compress@10': 0.9789, 'time@10': 5.6162}:  53%|█████▎    | 16/30 [01:05<00:43,  3.12s/it]{'epoch': 2, 'num_users': 5.8235, 'loss': 0.0468, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8353, 'compress@10': 0.9789, 'time@10': 5.6162}:  57%|█████▋    | 17/30 [01:05<00:31,  2.42s/it]{'epoch': 2, 'num_users': 6.0556, 'loss': 0.0477, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8363, 'compress@10': 0.9792, 'time@10': 5.5506}:  57%|█████▋    | 17/30 [01:10<00:31,  2.42s/it]{'epoch': 2, 'num_users': 6.0556, 'loss': 0.0477, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8363, 'compress@10': 0.9792, 'time@10': 5.5506}:  60%|██████    | 18/30 [01:10<00:36,  3.04s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.0463, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8396, 'compress@10': 0.9794, 'time@10': 5.4801}:  60%|██████    | 18/30 [01:12<00:36,  3.04s/it]   {'epoch': 2, 'num_users': 6.0, 'loss': 0.0463, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8396, 'compress@10': 0.9794, 'time@10': 5.4801}:  63%|██████▎   | 19/30 [01:12<00:30,  2.77s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.0472, 'hit_ratio@10': 0.8234, 'ndcg@10': 0.8375, 'compress@10': 0.9795, 'time@10': 5.6207}:  63%|██████▎   | 19/30 [01:20<00:30,  2.77s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.0472, 'hit_ratio@10': 0.8234, 'ndcg@10': 0.8375, 'compress@10': 0.9795, 'time@10': 5.6207}:  67%|██████▋   | 20/30 [01:20<00:44,  4.44s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0485, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8361, 'compress@10': 0.9796, 'time@10': 5.8413}:  67%|██████▋   | 20/30 [01:25<00:44,  4.44s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0485, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8361, 'compress@10': 0.9796, 'time@10': 5.8413}:  70%|███████   | 21/30 [01:25<00:41,  4.66s/it]{'epoch': 2, 'num_users': 6.1818, 'loss': 0.048, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8389, 'compress@10': 0.9797, 'time@10': 5.7304}:  70%|███████   | 21/30 [01:29<00:41,  4.66s/it] {'epoch': 2, 'num_users': 6.1818, 'loss': 0.048, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8389, 'compress@10': 0.9797, 'time@10': 5.7304}:  73%|███████▎  | 22/30 [01:29<00:34,  4.29s/it]{'epoch': 2, 'num_users': 6.1304, 'loss': 0.0469, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8415, 'compress@10': 0.9799, 'time@10': 5.7504}:  73%|███████▎  | 22/30 [01:32<00:34,  4.29s/it]{'epoch': 2, 'num_users': 6.1304, 'loss': 0.0469, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8415, 'compress@10': 0.9799, 'time@10': 5.7504}:  77%|███████▋  | 23/30 [01:32<00:27,  3.95s/it]{'epoch': 2, 'num_users': 5.9583, 'loss': 0.048, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8292, 'compress@10': 0.9795, 'time@10': 5.5425}:  77%|███████▋  | 23/30 [01:33<00:27,  3.95s/it] {'epoch': 2, 'num_users': 5.9583, 'loss': 0.048, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8292, 'compress@10': 0.9795, 'time@10': 5.5425}:  80%|████████  | 24/30 [01:33<00:18,  3.00s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0508, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.8107, 'compress@10': 0.9796, 'time@10': 5.351}:  80%|████████  | 24/30 [01:33<00:18,  3.00s/it]   {'epoch': 2, 'num_users': 5.8, 'loss': 0.0508, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.8107, 'compress@10': 0.9796, 'time@10': 5.351}:  83%|████████▎ | 25/30 [01:33<00:11,  2.23s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.0519, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.8094, 'compress@10': 0.9795, 'time@10': 5.5537}:  83%|████████▎ | 25/30 [01:44<00:11,  2.23s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.0519, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.8094, 'compress@10': 0.9795, 'time@10': 5.5537}:  87%|████████▋ | 26/30 [01:44<00:19,  4.76s/it]{'epoch': 2, 'num_users': 5.8889, 'loss': 0.0512, 'hit_ratio@10': 0.8131, 'ndcg@10': 0.8124, 'compress@10': 0.9797, 'time@10': 5.6793}:  87%|████████▋ | 26/30 [01:48<00:19,  4.76s/it]{'epoch': 2, 'num_users': 5.8889, 'loss': 0.0512, 'hit_ratio@10': 0.8131, 'ndcg@10': 0.8124, 'compress@10': 0.9797, 'time@10': 5.6793}:  90%|█████████ | 27/30 [01:48<00:14,  4.68s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.0513, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8146, 'compress@10': 0.9797, 'time@10': 5.7715}:  90%|█████████ | 27/30 [01:57<00:14,  4.68s/it]   {'epoch': 2, 'num_users': 6.0, 'loss': 0.0513, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8146, 'compress@10': 0.9797, 'time@10': 5.7715}:  93%|█████████▎| 28/30 [01:57<00:11,  5.77s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.0501, 'hit_ratio@10': 0.8174, 'ndcg@10': 0.8175, 'compress@10': 0.9801, 'time@10': 5.8077}:  93%|█████████▎| 28/30 [02:00<00:11,  5.77s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.0501, 'hit_ratio@10': 0.8174, 'ndcg@10': 0.8175, 'compress@10': 0.9801, 'time@10': 5.8077}:  97%|█████████▋| 29/30 [02:00<00:05,  5.07s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0497, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8202, 'compress@10': 0.9801, 'time@10': 5.8081}:  97%|█████████▋| 29/30 [02:06<00:05,  5.07s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0497, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8202, 'compress@10': 0.9801, 'time@10': 5.8081}: 100%|██████████| 30/30 [02:06<00:00,  5.31s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0497, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8202, 'compress@10': 0.9801, 'time@10': 5.8081}: 100%|██████████| 30/30 [02:06<00:00,  4.21s/it]
Epoch: 2
Avg # of users: 5.866666666666666
Avg Loss: 0.04966398884704955
Avg hit ratio: 0.8154253576725742
Avg ndcg: 0.8202031940807052
Avg compression ratio: 0.9800736233394673
Avg train time: 5.808054264386495
Std train time: 3.0360836979377117
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 13, 10, 6, 10, 10, 10, 8, 10, 10, 13, 10, 13, 9, 13, 13, 10, 10, 9, 7, 10, 10, 13, 13, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8501, 'compress@10': 0.989, 'time@10': 4.0704}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8501, 'compress@10': 0.989, 'time@10': 4.0704}:   3%|▎         | 1/30 [00:02<01:00,  2.07s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8509, 'compress@10': 0.987, 'time@10': 4.3449}:   3%|▎         | 1/30 [00:06<01:00,  2.07s/it] {'epoch': 3, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8509, 'compress@10': 0.987, 'time@10': 4.3449}:   7%|▋         | 2/30 [00:06<01:40,  3.60s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.853, 'compress@10': 0.983, 'time@10': 3.7022}:   7%|▋         | 2/30 [00:07<01:40,  3.60s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.853, 'compress@10': 0.983, 'time@10': 3.7022}:  10%|█         | 3/30 [00:07<01:08,  2.52s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0379, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8507, 'compress@10': 0.9808, 'time@10': 3.8307}:  10%|█         | 3/30 [00:12<01:08,  2.52s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0379, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8507, 'compress@10': 0.9808, 'time@10': 3.8307}:  13%|█▎        | 4/30 [00:12<01:23,  3.21s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0485, 'hit_ratio@10': 0.772, 'ndcg@10': 0.8352, 'compress@10': 0.9803, 'time@10': 4.9669}:  13%|█▎        | 4/30 [00:17<01:23,  3.21s/it] {'epoch': 3, 'num_users': 5.8, 'loss': 0.0485, 'hit_ratio@10': 0.772, 'ndcg@10': 0.8352, 'compress@10': 0.9803, 'time@10': 4.9669}:  17%|█▋        | 5/30 [00:17<01:34,  3.78s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0528, 'hit_ratio@10': 0.7619, 'ndcg@10': 0.8322, 'compress@10': 0.9789, 'time@10': 5.3962}:  17%|█▋        | 5/30 [00:24<01:34,  3.78s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0528, 'hit_ratio@10': 0.7619, 'ndcg@10': 0.8322, 'compress@10': 0.9789, 'time@10': 5.3962}:  20%|██        | 6/30 [00:24<02:01,  5.07s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0515, 'hit_ratio@10': 0.7902, 'ndcg@10': 0.835, 'compress@10': 0.9796, 'time@10': 5.8019}:  20%|██        | 6/30 [00:28<02:01,  5.07s/it] {'epoch': 3, 'num_users': 6.2857, 'loss': 0.0515, 'hit_ratio@10': 0.7902, 'ndcg@10': 0.835, 'compress@10': 0.9796, 'time@10': 5.8019}:  23%|██▎       | 7/30 [00:28<01:49,  4.77s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8057, 'ndcg@10': 0.8404, 'compress@10': 0.98, 'time@10': 5.7866}:  23%|██▎       | 7/30 [00:34<01:49,  4.77s/it]   {'epoch': 3, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8057, 'ndcg@10': 0.8404, 'compress@10': 0.98, 'time@10': 5.7866}:  27%|██▋       | 8/30 [00:34<01:51,  5.08s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0516, 'hit_ratio@10': 0.8051, 'ndcg@10': 0.8563, 'compress@10': 0.9796, 'time@10': 6.1442}:  27%|██▋       | 8/30 [00:39<01:51,  5.08s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0516, 'hit_ratio@10': 0.8051, 'ndcg@10': 0.8563, 'compress@10': 0.9796, 'time@10': 6.1442}:  30%|███       | 9/30 [00:39<01:43,  4.91s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0514, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.8545, 'compress@10': 0.9793, 'time@10': 6.2366}:  30%|███       | 9/30 [00:46<01:43,  4.91s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0514, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.8545, 'compress@10': 0.9793, 'time@10': 6.2366}:  33%|███▎      | 10/30 [00:46<01:51,  5.59s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.0523, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8556, 'compress@10': 0.9798, 'time@10': 6.422}:  33%|███▎      | 10/30 [00:50<01:51,  5.59s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.0523, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8556, 'compress@10': 0.9798, 'time@10': 6.422}:  37%|███▋      | 11/30 [00:50<01:37,  5.16s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.0495, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8607, 'compress@10': 0.9802, 'time@10': 6.0808}:  37%|███▋      | 11/30 [00:52<01:37,  5.16s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.0495, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8607, 'compress@10': 0.9802, 'time@10': 6.0808}:  40%|████      | 12/30 [00:52<01:17,  4.31s/it]{'epoch': 3, 'num_users': 6.6154, 'loss': 0.0496, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8622, 'compress@10': 0.98, 'time@10': 6.1385}:  40%|████      | 12/30 [00:56<01:17,  4.31s/it]  {'epoch': 3, 'num_users': 6.6154, 'loss': 0.0496, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8622, 'compress@10': 0.98, 'time@10': 6.1385}:  43%|████▎     | 13/30 [00:56<01:08,  4.05s/it]{'epoch': 3, 'num_users': 6.3571, 'loss': 0.048, 'hit_ratio@10': 0.803, 'ndcg@10': 0.8571, 'compress@10': 0.9804, 'time@10': 5.7753}:  43%|████▎     | 13/30 [00:57<01:08,  4.05s/it]{'epoch': 3, 'num_users': 6.3571, 'loss': 0.048, 'hit_ratio@10': 0.803, 'ndcg@10': 0.8571, 'compress@10': 0.9804, 'time@10': 5.7753}:  47%|████▋     | 14/30 [00:57<00:50,  3.16s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.0488, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8591, 'compress@10': 0.9802, 'time@10': 5.9747}:  47%|████▋     | 14/30 [01:01<00:50,  3.16s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.0488, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8591, 'compress@10': 0.9802, 'time@10': 5.9747}:  50%|█████     | 15/30 [01:01<00:53,  3.54s/it]{'epoch': 3, 'num_users': 6.0625, 'loss': 0.0467, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8606, 'compress@10': 0.98, 'time@10': 5.7457}:  50%|█████     | 15/30 [01:04<00:53,  3.54s/it] {'epoch': 3, 'num_users': 6.0625, 'loss': 0.0467, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8606, 'compress@10': 0.98, 'time@10': 5.7457}:  53%|█████▎    | 16/30 [01:04<00:44,  3.18s/it]{'epoch': 3, 'num_users': 5.8235, 'loss': 0.0457, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.8482, 'compress@10': 0.9805, 'time@10': 5.5055}:  53%|█████▎    | 16/30 [01:04<00:44,  3.18s/it]{'epoch': 3, 'num_users': 5.8235, 'loss': 0.0457, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.8482, 'compress@10': 0.9805, 'time@10': 5.5055}:  57%|█████▋    | 17/30 [01:04<00:32,  2.49s/it]{'epoch': 3, 'num_users': 6.0556, 'loss': 0.0467, 'hit_ratio@10': 0.8043, 'ndcg@10': 0.8489, 'compress@10': 0.9804, 'time@10': 5.4464}:  57%|█████▋    | 17/30 [01:09<00:32,  2.49s/it]{'epoch': 3, 'num_users': 6.0556, 'loss': 0.0467, 'hit_ratio@10': 0.8043, 'ndcg@10': 0.8489, 'compress@10': 0.9804, 'time@10': 5.4464}:  60%|██████    | 18/30 [01:09<00:37,  3.09s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.0452, 'hit_ratio@10': 0.8071, 'ndcg@10': 0.8516, 'compress@10': 0.9807, 'time@10': 5.3818}:  60%|██████    | 18/30 [01:11<00:37,  3.09s/it]   {'epoch': 3, 'num_users': 6.0, 'loss': 0.0452, 'hit_ratio@10': 0.8071, 'ndcg@10': 0.8516, 'compress@10': 0.9807, 'time@10': 5.3818}:  63%|██████▎   | 19/30 [01:11<00:30,  2.81s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.0461, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8496, 'compress@10': 0.9809, 'time@10': 5.5271}:  63%|██████▎   | 19/30 [01:19<00:30,  2.81s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.0461, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8496, 'compress@10': 0.9809, 'time@10': 5.5271}:  67%|██████▋   | 20/30 [01:19<00:44,  4.46s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0475, 'hit_ratio@10': 0.808, 'ndcg@10': 0.8475, 'compress@10': 0.981, 'time@10': 5.6923}:  67%|██████▋   | 20/30 [01:24<00:44,  4.46s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0475, 'hit_ratio@10': 0.808, 'ndcg@10': 0.8475, 'compress@10': 0.981, 'time@10': 5.6923}:  70%|███████   | 21/30 [01:24<00:40,  4.49s/it]{'epoch': 3, 'num_users': 6.1818, 'loss': 0.0471, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8499, 'compress@10': 0.9812, 'time@10': 5.5889}:  70%|███████   | 21/30 [01:27<00:40,  4.49s/it]{'epoch': 3, 'num_users': 6.1818, 'loss': 0.0471, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8499, 'compress@10': 0.9812, 'time@10': 5.5889}:  73%|███████▎  | 22/30 [01:27<00:33,  4.18s/it]{'epoch': 3, 'num_users': 6.1304, 'loss': 0.0461, 'hit_ratio@10': 0.8121, 'ndcg@10': 0.852, 'compress@10': 0.9814, 'time@10': 5.6137}:  73%|███████▎  | 22/30 [01:30<00:33,  4.18s/it] {'epoch': 3, 'num_users': 6.1304, 'loss': 0.0461, 'hit_ratio@10': 0.8121, 'ndcg@10': 0.852, 'compress@10': 0.9814, 'time@10': 5.6137}:  77%|███████▋  | 23/30 [01:30<00:27,  3.86s/it]{'epoch': 3, 'num_users': 5.9583, 'loss': 0.0465, 'hit_ratio@10': 0.8116, 'ndcg@10': 0.8411, 'compress@10': 0.9815, 'time@10': 5.4149}:  77%|███████▋  | 23/30 [01:31<00:27,  3.86s/it]{'epoch': 3, 'num_users': 5.9583, 'loss': 0.0465, 'hit_ratio@10': 0.8116, 'ndcg@10': 0.8411, 'compress@10': 0.9815, 'time@10': 5.4149}:  80%|████████  | 24/30 [01:31<00:17,  2.97s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0469, 'hit_ratio@10': 0.7925, 'ndcg@10': 0.8259, 'compress@10': 0.9816, 'time@10': 5.232}:  80%|████████  | 24/30 [01:32<00:17,  2.97s/it]    {'epoch': 3, 'num_users': 5.8, 'loss': 0.0469, 'hit_ratio@10': 0.7925, 'ndcg@10': 0.8259, 'compress@10': 0.9816, 'time@10': 5.232}:  83%|████████▎ | 25/30 [01:32<00:11,  2.21s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.0482, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.8241, 'compress@10': 0.9814, 'time@10': 5.3863}:  83%|████████▎ | 25/30 [01:41<00:11,  2.21s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.0482, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.8241, 'compress@10': 0.9814, 'time@10': 5.3863}:  87%|████████▋ | 26/30 [01:41<00:17,  4.34s/it]{'epoch': 3, 'num_users': 5.8889, 'loss': 0.0477, 'hit_ratio@10': 0.8011, 'ndcg@10': 0.8265, 'compress@10': 0.9815, 'time@10': 5.5171}:  87%|████████▋ | 26/30 [01:46<00:17,  4.34s/it]{'epoch': 3, 'num_users': 5.8889, 'loss': 0.0477, 'hit_ratio@10': 0.8011, 'ndcg@10': 0.8265, 'compress@10': 0.9815, 'time@10': 5.5171}:  90%|█████████ | 27/30 [01:46<00:13,  4.39s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.0479, 'hit_ratio@10': 0.8026, 'ndcg@10': 0.8285, 'compress@10': 0.9815, 'time@10': 5.6136}:  90%|█████████ | 27/30 [01:54<00:13,  4.39s/it]   {'epoch': 3, 'num_users': 6.0, 'loss': 0.0479, 'hit_ratio@10': 0.8026, 'ndcg@10': 0.8285, 'compress@10': 0.9815, 'time@10': 5.6136}:  93%|█████████▎| 28/30 [01:54<00:11,  5.55s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.0469, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.8304, 'compress@10': 0.9818, 'time@10': 5.6553}:  93%|█████████▎| 28/30 [01:57<00:11,  5.55s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.0469, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.8304, 'compress@10': 0.9818, 'time@10': 5.6553}:  97%|█████████▋| 29/30 [01:57<00:04,  4.92s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0468, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.8324, 'compress@10': 0.9817, 'time@10': 5.6651}:  97%|█████████▋| 29/30 [02:03<00:04,  4.92s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0468, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.8324, 'compress@10': 0.9817, 'time@10': 5.6651}: 100%|██████████| 30/30 [02:03<00:00,  5.24s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0468, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.8324, 'compress@10': 0.9817, 'time@10': 5.6651}: 100%|██████████| 30/30 [02:03<00:00,  4.13s/it]
Epoch: 3
Avg # of users: 5.866666666666666
Avg Loss: 0.04680373182008108
Avg hit ratio: 0.8037073684333625
Avg ndcg: 0.8324235685479737
Avg compression ratio: 0.981693112383567
Avg train time: 5.665107607841492
Std train time: 2.8080520588945164
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 14, 10, 5, 10, 10, 10, 8, 10, 10, 14, 10, 14, 9, 14, 14, 10, 10, 9, 7, 10, 10, 14, 14, 7, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8571, 'compress@10': 0.9866, 'time@10': 4.7141}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8571, 'compress@10': 0.9866, 'time@10': 4.7141}:   3%|▎         | 1/30 [00:02<01:10,  2.43s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8625, 'compress@10': 0.9847, 'time@10': 4.2409}:   3%|▎         | 1/30 [00:06<01:10,  2.43s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8625, 'compress@10': 0.9847, 'time@10': 4.2409}:   7%|▋         | 2/30 [00:06<01:30,  3.24s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0331, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8607, 'compress@10': 0.9826, 'time@10': 3.6402}:   7%|▋         | 2/30 [00:07<01:30,  3.24s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0331, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8607, 'compress@10': 0.9826, 'time@10': 3.6402}:  10%|█         | 3/30 [00:07<01:03,  2.33s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8512, 'compress@10': 0.9796, 'time@10': 3.8356}:  10%|█         | 3/30 [00:11<01:03,  2.33s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8512, 'compress@10': 0.9796, 'time@10': 3.8356}:  13%|█▎        | 4/30 [00:11<01:22,  3.17s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0494, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8328, 'compress@10': 0.98, 'time@10': 4.687}:  13%|█▎        | 4/30 [00:16<01:22,  3.17s/it]   {'epoch': 4, 'num_users': 5.8, 'loss': 0.0494, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8328, 'compress@10': 0.98, 'time@10': 4.687}:  17%|█▋        | 5/30 [00:16<01:27,  3.50s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0532, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8312, 'compress@10': 0.9788, 'time@10': 5.1205}:  17%|█▋        | 5/30 [00:23<01:27,  3.50s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0532, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8312, 'compress@10': 0.9788, 'time@10': 5.1205}:  20%|██        | 6/30 [00:23<01:55,  4.80s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0522, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8351, 'compress@10': 0.979, 'time@10': 5.5231}:  20%|██        | 6/30 [00:27<01:55,  4.80s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.0522, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8351, 'compress@10': 0.979, 'time@10': 5.5231}:  23%|██▎       | 7/30 [00:27<01:44,  4.54s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0538, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8493, 'compress@10': 0.9796, 'time@10': 5.5333}:  23%|██▎       | 7/30 [00:33<01:44,  4.54s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0538, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8493, 'compress@10': 0.9796, 'time@10': 5.5333}:  27%|██▋       | 8/30 [00:33<01:47,  4.90s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0528, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8554, 'compress@10': 0.9784, 'time@10': 5.9191}:  27%|██▋       | 8/30 [00:37<01:47,  4.90s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0528, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8554, 'compress@10': 0.9784, 'time@10': 5.9191}:  30%|███       | 9/30 [00:37<01:40,  4.79s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0523, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8539, 'compress@10': 0.9784, 'time@10': 6.0376}:  30%|███       | 9/30 [00:44<01:40,  4.79s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0523, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8539, 'compress@10': 0.9784, 'time@10': 6.0376}:  33%|███▎      | 10/30 [00:44<01:50,  5.51s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.0531, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8553, 'compress@10': 0.9792, 'time@10': 6.2503}:  33%|███▎      | 10/30 [00:48<01:50,  5.51s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.0531, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8553, 'compress@10': 0.9792, 'time@10': 6.2503}:  37%|███▋      | 11/30 [00:48<01:37,  5.12s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0501, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8604, 'compress@10': 0.9797, 'time@10': 5.9387}:  37%|███▋      | 11/30 [00:51<01:37,  5.12s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0501, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8604, 'compress@10': 0.9797, 'time@10': 5.9387}:  40%|████      | 12/30 [00:51<01:18,  4.34s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.0506, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8627, 'compress@10': 0.9795, 'time@10': 6.0187}:  40%|████      | 12/30 [00:55<01:18,  4.34s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.0506, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8627, 'compress@10': 0.9795, 'time@10': 6.0187}:  43%|████▎     | 13/30 [00:55<01:09,  4.10s/it]{'epoch': 4, 'num_users': 6.3571, 'loss': 0.0483, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8595, 'compress@10': 0.9799, 'time@10': 5.6712}:  43%|████▎     | 13/30 [00:56<01:09,  4.10s/it]{'epoch': 4, 'num_users': 6.3571, 'loss': 0.0483, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8595, 'compress@10': 0.9799, 'time@10': 5.6712}:  47%|████▋     | 14/30 [00:56<00:51,  3.22s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.0495, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8617, 'compress@10': 0.9797, 'time@10': 5.8772}:  47%|████▋     | 14/30 [01:00<00:51,  3.22s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.0495, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8617, 'compress@10': 0.9797, 'time@10': 5.8772}:  50%|█████     | 15/30 [01:00<00:53,  3.58s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.0474, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8623, 'compress@10': 0.9794, 'time@10': 5.6656}:  50%|█████     | 15/30 [01:03<00:53,  3.58s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.0474, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8623, 'compress@10': 0.9794, 'time@10': 5.6656}:  53%|█████▎    | 16/30 [01:03<00:45,  3.27s/it]{'epoch': 4, 'num_users': 5.8235, 'loss': 0.0457, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8545, 'compress@10': 0.9802, 'time@10': 5.4385}:  53%|█████▎    | 16/30 [01:04<00:45,  3.27s/it]{'epoch': 4, 'num_users': 5.8235, 'loss': 0.0457, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8545, 'compress@10': 0.9802, 'time@10': 5.4385}:  57%|█████▋    | 17/30 [01:04<00:33,  2.57s/it]{'epoch': 4, 'num_users': 6.0556, 'loss': 0.0467, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8545, 'compress@10': 0.9801, 'time@10': 5.3846}:  57%|█████▋    | 17/30 [01:08<00:33,  2.57s/it]{'epoch': 4, 'num_users': 6.0556, 'loss': 0.0467, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8545, 'compress@10': 0.9801, 'time@10': 5.3846}:  60%|██████    | 18/30 [01:08<00:37,  3.15s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.0451, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8569, 'compress@10': 0.9807, 'time@10': 5.3599}:  60%|██████    | 18/30 [01:11<00:37,  3.15s/it]   {'epoch': 4, 'num_users': 6.0, 'loss': 0.0451, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8569, 'compress@10': 0.9807, 'time@10': 5.3599}:  63%|██████▎   | 19/30 [01:11<00:32,  2.96s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.046, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8546, 'compress@10': 0.9808, 'time@10': 5.5091}:  63%|██████▎   | 19/30 [01:19<00:32,  2.96s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.046, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8546, 'compress@10': 0.9808, 'time@10': 5.5091}:  67%|██████▋   | 20/30 [01:19<00:45,  4.59s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0474, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8529, 'compress@10': 0.9809, 'time@10': 5.6833}:  67%|██████▋   | 20/30 [01:24<00:45,  4.59s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0474, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8529, 'compress@10': 0.9809, 'time@10': 5.6833}:  70%|███████   | 21/30 [01:24<00:41,  4.60s/it]{'epoch': 4, 'num_users': 6.1818, 'loss': 0.0474, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8549, 'compress@10': 0.9811, 'time@10': 5.5811}:  70%|███████   | 21/30 [01:27<00:41,  4.60s/it]{'epoch': 4, 'num_users': 6.1818, 'loss': 0.0474, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8549, 'compress@10': 0.9811, 'time@10': 5.5811}:  73%|███████▎  | 22/30 [01:27<00:34,  4.26s/it]{'epoch': 4, 'num_users': 6.1304, 'loss': 0.0465, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8564, 'compress@10': 0.9813, 'time@10': 5.5994}:  73%|███████▎  | 22/30 [01:30<00:34,  4.26s/it] {'epoch': 4, 'num_users': 6.1304, 'loss': 0.0465, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8564, 'compress@10': 0.9813, 'time@10': 5.5994}:  77%|███████▋  | 23/30 [01:30<00:27,  3.90s/it]{'epoch': 4, 'num_users': 5.9583, 'loss': 0.0465, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.849, 'compress@10': 0.9813, 'time@10': 5.4012}:  77%|███████▋  | 23/30 [01:31<00:27,  3.90s/it]{'epoch': 4, 'num_users': 5.9583, 'loss': 0.0465, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.849, 'compress@10': 0.9813, 'time@10': 5.4012}:  80%|████████  | 24/30 [01:31<00:17,  2.99s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0461, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8334, 'compress@10': 0.9816, 'time@10': 5.2191}:  80%|████████  | 24/30 [01:32<00:17,  2.99s/it]  {'epoch': 4, 'num_users': 5.8, 'loss': 0.0461, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8334, 'compress@10': 0.9816, 'time@10': 5.2191}:  83%|████████▎ | 25/30 [01:32<00:11,  2.23s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.0473, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8314, 'compress@10': 0.9813, 'time@10': 5.3561}:  83%|████████▎ | 25/30 [01:40<00:11,  2.23s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.0473, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8314, 'compress@10': 0.9813, 'time@10': 5.3561}:  87%|████████▋ | 26/30 [01:40<00:16,  4.21s/it]{'epoch': 4, 'num_users': 5.8889, 'loss': 0.0472, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8341, 'compress@10': 0.9814, 'time@10': 5.532}:  87%|████████▋ | 26/30 [01:45<00:16,  4.21s/it] {'epoch': 4, 'num_users': 5.8889, 'loss': 0.0472, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8341, 'compress@10': 0.9814, 'time@10': 5.532}:  90%|█████████ | 27/30 [01:45<00:13,  4.47s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.0474, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8358, 'compress@10': 0.9814, 'time@10': 5.6356}:  90%|█████████ | 27/30 [01:54<00:13,  4.47s/it]  {'epoch': 4, 'num_users': 6.0, 'loss': 0.0474, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8358, 'compress@10': 0.9814, 'time@10': 5.6356}:  93%|█████████▎| 28/30 [01:54<00:11,  5.67s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.0471, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8365, 'compress@10': 0.9817, 'time@10': 5.6776}:  93%|█████████▎| 28/30 [01:57<00:11,  5.67s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.0471, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8365, 'compress@10': 0.9817, 'time@10': 5.6776}:  97%|█████████▋| 29/30 [01:57<00:05,  5.01s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.047, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8382, 'compress@10': 0.9818, 'time@10': 5.6847}:  97%|█████████▋| 29/30 [02:03<00:05,  5.01s/it] {'epoch': 4, 'num_users': 5.8667, 'loss': 0.047, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8382, 'compress@10': 0.9818, 'time@10': 5.6847}: 100%|██████████| 30/30 [02:03<00:00,  5.29s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.047, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8382, 'compress@10': 0.9818, 'time@10': 5.6847}: 100%|██████████| 30/30 [02:03<00:00,  4.13s/it]
Epoch: 4
Avg # of users: 5.866666666666666
Avg Loss: 0.04702109269973013
Avg hit ratio: 0.8278885358498241
Avg ndcg: 0.8382223002129543
Avg compression ratio: 0.9817826945067364
Avg train time: 5.68469041188558
Std train time: 2.7620574569652736
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 15, 10, 5, 10, 10, 10, 8, 10, 10, 15, 10, 15, 9, 15, 15, 10, 10, 9, 7, 10, 10, 15, 15, 7, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8471, 'compress@10': 0.9851, 'time@10': 5.2478}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8471, 'compress@10': 0.9851, 'time@10': 5.2478}:   3%|▎         | 1/30 [00:02<01:17,  2.67s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.051, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8634, 'compress@10': 0.9839, 'time@10': 4.6726}:   3%|▎         | 1/30 [00:06<01:17,  2.67s/it]  {'epoch': 5, 'num_users': 7.0, 'loss': 0.051, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8634, 'compress@10': 0.9839, 'time@10': 4.6726}:   7%|▋         | 2/30 [00:06<01:38,  3.53s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8613, 'compress@10': 0.9824, 'time@10': 3.8288}:   7%|▋         | 2/30 [00:07<01:38,  3.53s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8613, 'compress@10': 0.9824, 'time@10': 3.8288}:  10%|█         | 3/30 [00:07<01:05,  2.43s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0391, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8507, 'compress@10': 0.9793, 'time@10': 3.9171}:  10%|█         | 3/30 [00:12<01:05,  2.43s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0391, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8507, 'compress@10': 0.9793, 'time@10': 3.9171}:  13%|█▎        | 4/30 [00:12<01:21,  3.14s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0499, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.835, 'compress@10': 0.9798, 'time@10': 4.7586}:  13%|█▎        | 4/30 [00:16<01:21,  3.14s/it] {'epoch': 5, 'num_users': 5.8, 'loss': 0.0499, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.835, 'compress@10': 0.9798, 'time@10': 4.7586}:  17%|█▋        | 5/30 [00:16<01:27,  3.48s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0533, 'hit_ratio@10': 0.8001, 'ndcg@10': 0.8327, 'compress@10': 0.9787, 'time@10': 5.169}:  17%|█▋        | 5/30 [00:23<01:27,  3.48s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0533, 'hit_ratio@10': 0.8001, 'ndcg@10': 0.8327, 'compress@10': 0.9787, 'time@10': 5.169}:  20%|██        | 6/30 [00:23<01:54,  4.77s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0518, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8394, 'compress@10': 0.979, 'time@10': 5.5521}:  20%|██        | 6/30 [00:27<01:54,  4.77s/it] {'epoch': 5, 'num_users': 6.2857, 'loss': 0.0518, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8394, 'compress@10': 0.979, 'time@10': 5.5521}:  23%|██▎       | 7/30 [00:27<01:43,  4.51s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0534, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8565, 'compress@10': 0.9795, 'time@10': 5.5541}:  23%|██▎       | 7/30 [00:33<01:43,  4.51s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0534, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8565, 'compress@10': 0.9795, 'time@10': 5.5541}:  27%|██▋       | 8/30 [00:33<01:46,  4.86s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0534, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8708, 'compress@10': 0.9795, 'time@10': 5.9282}:  27%|██▋       | 8/30 [00:37<01:46,  4.86s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0534, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8708, 'compress@10': 0.9795, 'time@10': 5.9282}:  30%|███       | 9/30 [00:37<01:39,  4.75s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0529, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8676, 'compress@10': 0.9796, 'time@10': 6.0418}:  30%|███       | 9/30 [00:44<01:39,  4.75s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0529, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8676, 'compress@10': 0.9796, 'time@10': 6.0418}:  33%|███▎      | 10/30 [00:44<01:49,  5.48s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0537, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8676, 'compress@10': 0.9804, 'time@10': 6.2476}:  33%|███▎      | 10/30 [00:48<01:49,  5.48s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0537, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8676, 'compress@10': 0.9804, 'time@10': 6.2476}:  37%|███▋      | 11/30 [00:48<01:36,  5.08s/it]{'epoch': 5, 'num_users': 6.4167, 'loss': 0.0506, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8717, 'compress@10': 0.9807, 'time@10': 5.951}:  37%|███▋      | 11/30 [00:51<01:36,  5.08s/it] {'epoch': 5, 'num_users': 6.4167, 'loss': 0.0506, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8717, 'compress@10': 0.9807, 'time@10': 5.951}:  40%|████      | 12/30 [00:51<01:18,  4.37s/it]{'epoch': 5, 'num_users': 6.6154, 'loss': 0.0513, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8728, 'compress@10': 0.9807, 'time@10': 6.0274}:  40%|████      | 12/30 [00:55<01:18,  4.37s/it]{'epoch': 5, 'num_users': 6.6154, 'loss': 0.0513, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8728, 'compress@10': 0.9807, 'time@10': 6.0274}:  43%|████▎     | 13/30 [00:55<01:09,  4.11s/it]{'epoch': 5, 'num_users': 6.3571, 'loss': 0.0486, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8679, 'compress@10': 0.981, 'time@10': 5.6849}:  43%|████▎     | 13/30 [00:56<01:09,  4.11s/it] {'epoch': 5, 'num_users': 6.3571, 'loss': 0.0486, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8679, 'compress@10': 0.981, 'time@10': 5.6849}:  47%|████▋     | 14/30 [00:56<00:52,  3.25s/it]{'epoch': 5, 'num_users': 6.2667, 'loss': 0.0503, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8669, 'compress@10': 0.9807, 'time@10': 5.8922}:  47%|████▋     | 14/30 [01:00<00:52,  3.25s/it]{'epoch': 5, 'num_users': 6.2667, 'loss': 0.0503, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8669, 'compress@10': 0.9807, 'time@10': 5.8922}:  50%|█████     | 15/30 [01:00<00:54,  3.61s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.0481, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8674, 'compress@10': 0.9803, 'time@10': 5.6895}:  50%|█████     | 15/30 [01:03<00:54,  3.61s/it] {'epoch': 5, 'num_users': 6.0625, 'loss': 0.0481, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8674, 'compress@10': 0.9803, 'time@10': 5.6895}:  53%|█████▎    | 16/30 [01:03<00:46,  3.33s/it]{'epoch': 5, 'num_users': 5.8235, 'loss': 0.0463, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8602, 'compress@10': 0.9811, 'time@10': 5.4679}:  53%|█████▎    | 16/30 [01:04<00:46,  3.33s/it]{'epoch': 5, 'num_users': 5.8235, 'loss': 0.0463, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8602, 'compress@10': 0.9811, 'time@10': 5.4679}:  57%|█████▋    | 17/30 [01:04<00:34,  2.63s/it]{'epoch': 5, 'num_users': 6.0556, 'loss': 0.0471, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8597, 'compress@10': 0.981, 'time@10': 5.4102}:  57%|█████▋    | 17/30 [01:08<00:34,  2.63s/it]{'epoch': 5, 'num_users': 6.0556, 'loss': 0.0471, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8597, 'compress@10': 0.981, 'time@10': 5.4102}:  60%|██████    | 18/30 [01:08<00:38,  3.18s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.0455, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8618, 'compress@10': 0.9815, 'time@10': 5.3469}:  60%|██████    | 18/30 [01:11<00:38,  3.18s/it]  {'epoch': 5, 'num_users': 6.0, 'loss': 0.0455, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8618, 'compress@10': 0.9815, 'time@10': 5.3469}:  63%|██████▎   | 19/30 [01:11<00:31,  2.87s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.0462, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8597, 'compress@10': 0.9816, 'time@10': 5.4925}:  63%|██████▎   | 19/30 [01:19<00:31,  2.87s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.0462, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8597, 'compress@10': 0.9816, 'time@10': 5.4925}:  67%|██████▋   | 20/30 [01:19<00:45,  4.50s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0476, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8576, 'compress@10': 0.9816, 'time@10': 5.6574}:  67%|██████▋   | 20/30 [01:23<00:45,  4.50s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0476, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8576, 'compress@10': 0.9816, 'time@10': 5.6574}:  70%|███████   | 21/30 [01:23<00:40,  4.51s/it]{'epoch': 5, 'num_users': 6.1818, 'loss': 0.0479, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8578, 'compress@10': 0.9818, 'time@10': 5.556}:  70%|███████   | 21/30 [01:27<00:40,  4.51s/it] {'epoch': 5, 'num_users': 6.1818, 'loss': 0.0479, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8578, 'compress@10': 0.9818, 'time@10': 5.556}:  73%|███████▎  | 22/30 [01:27<00:33,  4.19s/it]{'epoch': 5, 'num_users': 6.1304, 'loss': 0.0469, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8595, 'compress@10': 0.982, 'time@10': 5.5842}:  73%|███████▎  | 22/30 [01:30<00:33,  4.19s/it]{'epoch': 5, 'num_users': 6.1304, 'loss': 0.0469, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8595, 'compress@10': 0.982, 'time@10': 5.5842}:  77%|███████▋  | 23/30 [01:30<00:27,  3.88s/it]{'epoch': 5, 'num_users': 5.9583, 'loss': 0.0466, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8526, 'compress@10': 0.9819, 'time@10': 5.3927}:  77%|███████▋  | 23/30 [01:31<00:27,  3.88s/it]{'epoch': 5, 'num_users': 5.9583, 'loss': 0.0466, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8526, 'compress@10': 0.9819, 'time@10': 5.3927}:  80%|████████  | 24/30 [01:31<00:18,  3.02s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0458, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8398, 'compress@10': 0.9822, 'time@10': 5.2157}:  80%|████████  | 24/30 [01:32<00:18,  3.02s/it]  {'epoch': 5, 'num_users': 5.8, 'loss': 0.0458, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8398, 'compress@10': 0.9822, 'time@10': 5.2157}:  83%|████████▎ | 25/30 [01:32<00:11,  2.27s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.0469, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.8379, 'compress@10': 0.9819, 'time@10': 5.3708}:  83%|████████▎ | 25/30 [01:41<00:11,  2.27s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.0469, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.8379, 'compress@10': 0.9819, 'time@10': 5.3708}:  87%|████████▋ | 26/30 [01:41<00:17,  4.38s/it]{'epoch': 5, 'num_users': 5.8889, 'loss': 0.0469, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8386, 'compress@10': 0.982, 'time@10': 5.4674}:  87%|████████▋ | 26/30 [01:45<00:17,  4.38s/it] {'epoch': 5, 'num_users': 5.8889, 'loss': 0.0469, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8386, 'compress@10': 0.982, 'time@10': 5.4674}:  90%|█████████ | 27/30 [01:45<00:12,  4.27s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.047, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8394, 'compress@10': 0.9819, 'time@10': 5.567}:  90%|█████████ | 27/30 [01:53<00:12,  4.27s/it]     {'epoch': 5, 'num_users': 6.0, 'loss': 0.047, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8394, 'compress@10': 0.9819, 'time@10': 5.567}:  93%|█████████▎| 28/30 [01:53<00:10,  5.48s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.0463, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8413, 'compress@10': 0.9821, 'time@10': 5.6112}:  93%|█████████▎| 28/30 [01:57<00:10,  5.48s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.0463, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8413, 'compress@10': 0.9821, 'time@10': 5.6112}:  97%|█████████▋| 29/30 [01:57<00:04,  4.88s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0462, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8427, 'compress@10': 0.9821, 'time@10': 5.6205}:  97%|█████████▋| 29/30 [02:03<00:04,  4.88s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0462, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8427, 'compress@10': 0.9821, 'time@10': 5.6205}: 100%|██████████| 30/30 [02:03<00:00,  5.19s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0462, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8427, 'compress@10': 0.9821, 'time@10': 5.6205}: 100%|██████████| 30/30 [02:03<00:00,  4.10s/it]
Epoch: 5
Avg # of users: 5.866666666666666
Avg Loss: 0.046163303609951044
Avg hit ratio: 0.8255768179334848
Avg ndcg: 0.8427170806048196
Avg compression ratio: 0.9821192727438363
Avg train time: 5.6204949458440145
Std train time: 2.6448302062250595
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 16, 10, 5, 10, 10, 10, 8, 10, 10, 16, 10, 16, 9, 16, 16, 10, 10, 9, 7, 10, 10, 16, 16, 7, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0527, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8586, 'compress@10': 0.9839, 'time@10': 5.3575}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0527, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8586, 'compress@10': 0.9839, 'time@10': 5.3575}:   3%|▎         | 1/30 [00:02<01:18,  2.72s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0511, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8518, 'compress@10': 0.9838, 'time@10': 4.9255}:   3%|▎         | 1/30 [00:07<01:18,  2.72s/it] {'epoch': 6, 'num_users': 7.0, 'loss': 0.0511, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8518, 'compress@10': 0.9838, 'time@10': 4.9255}:   7%|▋         | 2/30 [00:07<01:46,  3.79s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8536, 'compress@10': 0.9823, 'time@10': 3.9322}:   7%|▋         | 2/30 [00:08<01:46,  3.79s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8536, 'compress@10': 0.9823, 'time@10': 3.9322}:  10%|█         | 3/30 [00:08<01:07,  2.52s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0403, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8428, 'compress@10': 0.9791, 'time@10': 3.7537}:  10%|█         | 3/30 [00:11<01:07,  2.52s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0403, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8428, 'compress@10': 0.9791, 'time@10': 3.7537}:  13%|█▎        | 4/30 [00:11<01:13,  2.81s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0507, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8265, 'compress@10': 0.9798, 'time@10': 4.3444}:  13%|█▎        | 4/30 [00:14<01:13,  2.81s/it] {'epoch': 6, 'num_users': 5.8, 'loss': 0.0507, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8265, 'compress@10': 0.9798, 'time@10': 4.3444}:  17%|█▋        | 5/30 [00:14<01:15,  3.02s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0533, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8264, 'compress@10': 0.9788, 'time@10': 4.8644}:  17%|█▋        | 5/30 [00:22<01:15,  3.02s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0533, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8264, 'compress@10': 0.9788, 'time@10': 4.8644}:  20%|██        | 6/30 [00:22<01:49,  4.54s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.053, 'hit_ratio@10': 0.8057, 'ndcg@10': 0.8254, 'compress@10': 0.9789, 'time@10': 5.2452}:  20%|██        | 6/30 [00:26<01:49,  4.54s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.053, 'hit_ratio@10': 0.8057, 'ndcg@10': 0.8254, 'compress@10': 0.9789, 'time@10': 5.2452}:  23%|██▎       | 7/30 [00:26<01:38,  4.30s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0534, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8438, 'compress@10': 0.979, 'time@10': 5.2836}:  23%|██▎       | 7/30 [00:31<01:38,  4.30s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0534, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8438, 'compress@10': 0.979, 'time@10': 5.2836}:  27%|██▋       | 8/30 [00:31<01:43,  4.71s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0531, 'hit_ratio@10': 0.814, 'ndcg@10': 0.855, 'compress@10': 0.9784, 'time@10': 5.664}:  27%|██▋       | 8/30 [00:36<01:43,  4.71s/it] {'epoch': 6, 'num_users': 6.3333, 'loss': 0.0531, 'hit_ratio@10': 0.814, 'ndcg@10': 0.855, 'compress@10': 0.9784, 'time@10': 5.664}:  30%|███       | 9/30 [00:36<01:36,  4.61s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0518, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8549, 'compress@10': 0.9787, 'time@10': 5.782}:  30%|███       | 9/30 [00:43<01:36,  4.61s/it] {'epoch': 6, 'num_users': 6.3, 'loss': 0.0518, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8549, 'compress@10': 0.9787, 'time@10': 5.782}:  33%|███▎      | 10/30 [00:43<01:46,  5.31s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.0528, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.8562, 'compress@10': 0.9795, 'time@10': 5.9811}:  33%|███▎      | 10/30 [00:47<01:46,  5.31s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.0528, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.8562, 'compress@10': 0.9795, 'time@10': 5.9811}:  37%|███▋      | 11/30 [00:47<01:33,  4.92s/it]{'epoch': 6, 'num_users': 6.4167, 'loss': 0.0497, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8612, 'compress@10': 0.98, 'time@10': 5.7337}:  37%|███▋      | 11/30 [00:50<01:33,  4.92s/it]  {'epoch': 6, 'num_users': 6.4167, 'loss': 0.0497, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8612, 'compress@10': 0.98, 'time@10': 5.7337}:  40%|████      | 12/30 [00:50<01:18,  4.35s/it]{'epoch': 6, 'num_users': 6.6154, 'loss': 0.0503, 'hit_ratio@10': 0.815, 'ndcg@10': 0.8637, 'compress@10': 0.9803, 'time@10': 5.8819}:  40%|████      | 12/30 [00:54<01:18,  4.35s/it]{'epoch': 6, 'num_users': 6.6154, 'loss': 0.0503, 'hit_ratio@10': 0.815, 'ndcg@10': 0.8637, 'compress@10': 0.9803, 'time@10': 5.8819}:  43%|████▎     | 13/30 [00:54<01:11,  4.21s/it]{'epoch': 6, 'num_users': 6.3571, 'loss': 0.0476, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.8598, 'compress@10': 0.9806, 'time@10': 5.5546}:  43%|████▎     | 13/30 [00:55<01:11,  4.21s/it]{'epoch': 6, 'num_users': 6.3571, 'loss': 0.0476, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.8598, 'compress@10': 0.9806, 'time@10': 5.5546}:  47%|████▋     | 14/30 [00:55<00:53,  3.34s/it]{'epoch': 6, 'num_users': 6.2667, 'loss': 0.0491, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8636, 'compress@10': 0.9805, 'time@10': 5.7746}:  47%|████▋     | 14/30 [00:59<00:53,  3.34s/it]{'epoch': 6, 'num_users': 6.2667, 'loss': 0.0491, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8636, 'compress@10': 0.9805, 'time@10': 5.7746}:  50%|█████     | 15/30 [00:59<00:55,  3.69s/it]{'epoch': 6, 'num_users': 6.0625, 'loss': 0.0469, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8643, 'compress@10': 0.98, 'time@10': 5.6037}:  50%|█████     | 15/30 [01:02<00:55,  3.69s/it]  {'epoch': 6, 'num_users': 6.0625, 'loss': 0.0469, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8643, 'compress@10': 0.98, 'time@10': 5.6037}:  53%|█████▎    | 16/30 [01:02<00:49,  3.51s/it]{'epoch': 6, 'num_users': 5.8235, 'loss': 0.045, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8573, 'compress@10': 0.9808, 'time@10': 5.4041}:  53%|█████▎    | 16/30 [01:04<00:49,  3.51s/it]{'epoch': 6, 'num_users': 5.8235, 'loss': 0.045, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8573, 'compress@10': 0.9808, 'time@10': 5.4041}:  57%|█████▋    | 17/30 [01:04<00:36,  2.81s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.0459, 'hit_ratio@10': 0.8009, 'ndcg@10': 0.8573, 'compress@10': 0.9807, 'time@10': 5.3634}:  57%|█████▋    | 17/30 [01:08<00:36,  2.81s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.0459, 'hit_ratio@10': 0.8009, 'ndcg@10': 0.8573, 'compress@10': 0.9807, 'time@10': 5.3634}:  60%|██████    | 18/30 [01:08<00:40,  3.38s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.0444, 'hit_ratio@10': 0.8039, 'ndcg@10': 0.8588, 'compress@10': 0.9812, 'time@10': 5.3057}:  60%|██████    | 18/30 [01:11<00:40,  3.38s/it]   {'epoch': 6, 'num_users': 6.0, 'loss': 0.0444, 'hit_ratio@10': 0.8039, 'ndcg@10': 0.8588, 'compress@10': 0.9812, 'time@10': 5.3057}:  63%|██████▎   | 19/30 [01:11<00:33,  3.02s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.045, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8566, 'compress@10': 0.9814, 'time@10': 5.4572}:  63%|██████▎   | 19/30 [01:19<00:33,  3.02s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.045, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8566, 'compress@10': 0.9814, 'time@10': 5.4572}:  67%|██████▋   | 20/30 [01:19<00:46,  4.63s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0464, 'hit_ratio@10': 0.8051, 'ndcg@10': 0.8544, 'compress@10': 0.9815, 'time@10': 5.6286}:  67%|██████▋   | 20/30 [01:23<00:46,  4.63s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0464, 'hit_ratio@10': 0.8051, 'ndcg@10': 0.8544, 'compress@10': 0.9815, 'time@10': 5.6286}:  70%|███████   | 21/30 [01:23<00:41,  4.61s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.0464, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8561, 'compress@10': 0.9816, 'time@10': 5.5285}:  70%|███████   | 21/30 [01:27<00:41,  4.61s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.0464, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8561, 'compress@10': 0.9816, 'time@10': 5.5285}:  73%|███████▎  | 22/30 [01:27<00:34,  4.27s/it]{'epoch': 6, 'num_users': 6.1304, 'loss': 0.0455, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8578, 'compress@10': 0.9817, 'time@10': 5.5582}:  73%|███████▎  | 22/30 [01:30<00:34,  4.27s/it]{'epoch': 6, 'num_users': 6.1304, 'loss': 0.0455, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8578, 'compress@10': 0.9817, 'time@10': 5.5582}:  77%|███████▋  | 23/30 [01:30<00:27,  3.93s/it]{'epoch': 6, 'num_users': 5.9583, 'loss': 0.0452, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8509, 'compress@10': 0.9817, 'time@10': 5.3707}:  77%|███████▋  | 23/30 [01:31<00:27,  3.93s/it]{'epoch': 6, 'num_users': 5.9583, 'loss': 0.0452, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8509, 'compress@10': 0.9817, 'time@10': 5.3707}:  80%|████████  | 24/30 [01:31<00:18,  3.08s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0441, 'hit_ratio@10': 0.8034, 'ndcg@10': 0.8407, 'compress@10': 0.982, 'time@10': 5.1964}:  80%|████████  | 24/30 [01:32<00:18,  3.08s/it]    {'epoch': 6, 'num_users': 5.8, 'loss': 0.0441, 'hit_ratio@10': 0.8034, 'ndcg@10': 0.8407, 'compress@10': 0.982, 'time@10': 5.1964}:  83%|████████▎ | 25/30 [01:32<00:11,  2.32s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.0452, 'hit_ratio@10': 0.8058, 'ndcg@10': 0.839, 'compress@10': 0.9818, 'time@10': 5.3543}:  83%|████████▎ | 25/30 [01:41<00:11,  2.32s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.0452, 'hit_ratio@10': 0.8058, 'ndcg@10': 0.839, 'compress@10': 0.9818, 'time@10': 5.3543}:  87%|████████▋ | 26/30 [01:41<00:17,  4.43s/it]{'epoch': 6, 'num_users': 5.8889, 'loss': 0.0457, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8375, 'compress@10': 0.9819, 'time@10': 5.4528}:  87%|████████▋ | 26/30 [01:45<00:17,  4.43s/it]{'epoch': 6, 'num_users': 5.8889, 'loss': 0.0457, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8375, 'compress@10': 0.9819, 'time@10': 5.4528}:  90%|█████████ | 27/30 [01:45<00:12,  4.31s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.046, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.838, 'compress@10': 0.9818, 'time@10': 5.5515}:  90%|█████████ | 27/30 [01:53<00:12,  4.31s/it]     {'epoch': 6, 'num_users': 6.0, 'loss': 0.046, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.838, 'compress@10': 0.9818, 'time@10': 5.5515}:  93%|█████████▎| 28/30 [01:53<00:10,  5.50s/it]{'epoch': 6, 'num_users': 5.8621, 'loss': 0.0458, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8418, 'compress@10': 0.982, 'time@10': 5.5969}:  93%|█████████▎| 28/30 [01:57<00:10,  5.50s/it]{'epoch': 6, 'num_users': 5.8621, 'loss': 0.0458, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8418, 'compress@10': 0.982, 'time@10': 5.5969}:  97%|█████████▋| 29/30 [01:57<00:04,  4.89s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0457, 'hit_ratio@10': 0.8137, 'ndcg@10': 0.8437, 'compress@10': 0.9821, 'time@10': 5.6076}:  97%|█████████▋| 29/30 [02:03<00:04,  4.89s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0457, 'hit_ratio@10': 0.8137, 'ndcg@10': 0.8437, 'compress@10': 0.9821, 'time@10': 5.6076}: 100%|██████████| 30/30 [02:03<00:00,  5.21s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0457, 'hit_ratio@10': 0.8137, 'ndcg@10': 0.8437, 'compress@10': 0.9821, 'time@10': 5.6076}: 100%|██████████| 30/30 [02:03<00:00,  4.11s/it]
Epoch: 6
Avg # of users: 5.866666666666666
Avg Loss: 0.045741205210191385
Avg hit ratio: 0.8137230368362203
Avg ndcg: 0.8436646294643981
Avg compression ratio: 0.9820640001504013
Avg train time: 5.60755209128062
Std train time: 2.5855742320103094
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 17, 10, 17, 9, 17, 17, 10, 10, 9, 7, 10, 10, 17, 17, 7, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8403, 'compress@10': 0.9846, 'time@10': 5.9694}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8403, 'compress@10': 0.9846, 'time@10': 5.9694}:   3%|▎         | 1/30 [00:03<01:27,  3.02s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8443, 'compress@10': 0.9843, 'time@10': 5.3232}:   3%|▎         | 1/30 [00:07<01:27,  3.02s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8443, 'compress@10': 0.9843, 'time@10': 5.3232}:   7%|▋         | 2/30 [00:07<01:53,  4.05s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8486, 'compress@10': 0.9826, 'time@10': 4.6664}:   7%|▋         | 2/30 [00:09<01:53,  4.05s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8486, 'compress@10': 0.9826, 'time@10': 4.6664}:  10%|█         | 3/30 [00:09<01:20,  2.98s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.04, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.8255, 'compress@10': 0.9794, 'time@10': 4.3162}:  10%|█         | 3/30 [00:12<01:20,  2.98s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.04, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.8255, 'compress@10': 0.9794, 'time@10': 4.3162}:  13%|█▎        | 4/30 [00:12<01:20,  3.11s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0502, 'hit_ratio@10': 0.7889, 'ndcg@10': 0.8131, 'compress@10': 0.9801, 'time@10': 4.7551}:  13%|█▎        | 4/30 [00:16<01:20,  3.11s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0502, 'hit_ratio@10': 0.7889, 'ndcg@10': 0.8131, 'compress@10': 0.9801, 'time@10': 4.7551}:  17%|█▋        | 5/30 [00:16<01:19,  3.18s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0525, 'hit_ratio@10': 0.7871, 'ndcg@10': 0.8155, 'compress@10': 0.9792, 'time@10': 5.1621}:  17%|█▋        | 5/30 [00:23<01:19,  3.18s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0525, 'hit_ratio@10': 0.7871, 'ndcg@10': 0.8155, 'compress@10': 0.9792, 'time@10': 5.1621}:  20%|██        | 6/30 [00:23<01:49,  4.56s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.053, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.8214, 'compress@10': 0.979, 'time@10': 5.5454}:  20%|██        | 6/30 [00:27<01:49,  4.56s/it]  {'epoch': 7, 'num_users': 6.2857, 'loss': 0.053, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.8214, 'compress@10': 0.979, 'time@10': 5.5454}:  23%|██▎       | 7/30 [00:27<01:40,  4.36s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0526, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8384, 'compress@10': 0.9789, 'time@10': 5.5509}:  23%|██▎       | 7/30 [00:32<01:40,  4.36s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0526, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8384, 'compress@10': 0.9789, 'time@10': 5.5509}:  27%|██▋       | 8/30 [00:32<01:44,  4.77s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0511, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8468, 'compress@10': 0.9781, 'time@10': 5.9229}:  27%|██▋       | 8/30 [00:37<01:44,  4.77s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0511, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8468, 'compress@10': 0.9781, 'time@10': 5.9229}:  30%|███       | 9/30 [00:37<01:38,  4.68s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.051, 'hit_ratio@10': 0.83, 'ndcg@10': 0.8483, 'compress@10': 0.9786, 'time@10': 6.0368}:  30%|███       | 9/30 [00:44<01:38,  4.68s/it]      {'epoch': 7, 'num_users': 6.3, 'loss': 0.051, 'hit_ratio@10': 0.83, 'ndcg@10': 0.8483, 'compress@10': 0.9786, 'time@10': 6.0368}:  33%|███▎      | 10/30 [00:44<01:48,  5.43s/it]{'epoch': 7, 'num_users': 6.6364, 'loss': 0.0516, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8502, 'compress@10': 0.9795, 'time@10': 6.2415}:  33%|███▎      | 10/30 [00:48<01:48,  5.43s/it]{'epoch': 7, 'num_users': 6.6364, 'loss': 0.0516, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8502, 'compress@10': 0.9795, 'time@10': 6.2415}:  37%|███▋      | 11/30 [00:48<01:35,  5.05s/it]{'epoch': 7, 'num_users': 6.4167, 'loss': 0.0486, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.8557, 'compress@10': 0.98, 'time@10': 5.975}:  37%|███▋      | 11/30 [00:51<01:35,  5.05s/it]  {'epoch': 7, 'num_users': 6.4167, 'loss': 0.0486, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.8557, 'compress@10': 0.98, 'time@10': 5.975}:  40%|████      | 12/30 [00:51<01:20,  4.45s/it]{'epoch': 7, 'num_users': 6.6154, 'loss': 0.0491, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8588, 'compress@10': 0.9804, 'time@10': 6.0504}:  40%|████      | 12/30 [00:55<01:20,  4.45s/it]{'epoch': 7, 'num_users': 6.6154, 'loss': 0.0491, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8588, 'compress@10': 0.9804, 'time@10': 6.0504}:  43%|████▎     | 13/30 [00:55<01:10,  4.17s/it]{'epoch': 7, 'num_users': 6.3571, 'loss': 0.0464, 'hit_ratio@10': 0.8042, 'ndcg@10': 0.8553, 'compress@10': 0.9807, 'time@10': 5.717}:  43%|████▎     | 13/30 [00:56<01:10,  4.17s/it] {'epoch': 7, 'num_users': 6.3571, 'loss': 0.0464, 'hit_ratio@10': 0.8042, 'ndcg@10': 0.8553, 'compress@10': 0.9807, 'time@10': 5.717}:  47%|████▋     | 14/30 [00:56<00:53,  3.34s/it]{'epoch': 7, 'num_users': 6.2667, 'loss': 0.0477, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8588, 'compress@10': 0.9806, 'time@10': 5.9238}:  47%|████▋     | 14/30 [01:01<00:53,  3.34s/it]{'epoch': 7, 'num_users': 6.2667, 'loss': 0.0477, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8588, 'compress@10': 0.9806, 'time@10': 5.9238}:  50%|█████     | 15/30 [01:01<00:55,  3.67s/it]{'epoch': 7, 'num_users': 6.0625, 'loss': 0.0456, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8598, 'compress@10': 0.9801, 'time@10': 5.7432}:  50%|█████     | 15/30 [01:04<00:55,  3.67s/it]{'epoch': 7, 'num_users': 6.0625, 'loss': 0.0456, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8598, 'compress@10': 0.9801, 'time@10': 5.7432}:  53%|█████▎    | 16/30 [01:04<00:48,  3.49s/it]{'epoch': 7, 'num_users': 5.8235, 'loss': 0.0437, 'hit_ratio@10': 0.8035, 'ndcg@10': 0.8531, 'compress@10': 0.9809, 'time@10': 5.5346}:  53%|█████▎    | 16/30 [01:05<00:48,  3.49s/it]{'epoch': 7, 'num_users': 5.8235, 'loss': 0.0437, 'hit_ratio@10': 0.8035, 'ndcg@10': 0.8531, 'compress@10': 0.9809, 'time@10': 5.5346}:  57%|█████▋    | 17/30 [01:05<00:36,  2.79s/it]{'epoch': 7, 'num_users': 6.0556, 'loss': 0.0445, 'hit_ratio@10': 0.8006, 'ndcg@10': 0.8533, 'compress@10': 0.9808, 'time@10': 5.4757}:  57%|█████▋    | 17/30 [01:09<00:36,  2.79s/it]{'epoch': 7, 'num_users': 6.0556, 'loss': 0.0445, 'hit_ratio@10': 0.8006, 'ndcg@10': 0.8533, 'compress@10': 0.9808, 'time@10': 5.4757}:  60%|██████    | 18/30 [01:09<00:39,  3.31s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.0431, 'hit_ratio@10': 0.8036, 'ndcg@10': 0.8556, 'compress@10': 0.9812, 'time@10': 5.4103}:  60%|██████    | 18/30 [01:12<00:39,  3.31s/it]   {'epoch': 7, 'num_users': 6.0, 'loss': 0.0431, 'hit_ratio@10': 0.8036, 'ndcg@10': 0.8556, 'compress@10': 0.9812, 'time@10': 5.4103}:  63%|██████▎   | 19/30 [01:12<00:32,  2.96s/it]{'epoch': 7, 'num_users': 6.15, 'loss': 0.0437, 'hit_ratio@10': 0.8064, 'ndcg@10': 0.8535, 'compress@10': 0.9815, 'time@10': 5.5522}:  63%|██████▎   | 19/30 [01:20<00:32,  2.96s/it]{'epoch': 7, 'num_users': 6.15, 'loss': 0.0437, 'hit_ratio@10': 0.8064, 'ndcg@10': 0.8535, 'compress@10': 0.9815, 'time@10': 5.5522}:  67%|██████▋   | 20/30 [01:20<00:45,  4.56s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.045, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8517, 'compress@10': 0.9816, 'time@10': 5.7046}:  67%|██████▋   | 20/30 [01:24<00:45,  4.56s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.045, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8517, 'compress@10': 0.9816, 'time@10': 5.7046}:  70%|███████   | 21/30 [01:24<00:40,  4.52s/it]{'epoch': 7, 'num_users': 6.1818, 'loss': 0.0457, 'hit_ratio@10': 0.8096, 'ndcg@10': 0.853, 'compress@10': 0.9816, 'time@10': 5.6051}:  70%|███████   | 21/30 [01:28<00:40,  4.52s/it]{'epoch': 7, 'num_users': 6.1818, 'loss': 0.0457, 'hit_ratio@10': 0.8096, 'ndcg@10': 0.853, 'compress@10': 0.9816, 'time@10': 5.6051}:  73%|███████▎  | 22/30 [01:28<00:33,  4.23s/it]{'epoch': 7, 'num_users': 6.1304, 'loss': 0.0448, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.8551, 'compress@10': 0.9818, 'time@10': 5.6178}:  73%|███████▎  | 22/30 [01:31<00:33,  4.23s/it]{'epoch': 7, 'num_users': 6.1304, 'loss': 0.0448, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.8551, 'compress@10': 0.9818, 'time@10': 5.6178}:  77%|███████▋  | 23/30 [01:31<00:27,  3.86s/it]{'epoch': 7, 'num_users': 5.9583, 'loss': 0.0444, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8483, 'compress@10': 0.9818, 'time@10': 5.4296}:  77%|███████▋  | 23/30 [01:32<00:27,  3.86s/it]{'epoch': 7, 'num_users': 5.9583, 'loss': 0.0444, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8483, 'compress@10': 0.9818, 'time@10': 5.4296}:  80%|████████  | 24/30 [01:32<00:18,  3.04s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0433, 'hit_ratio@10': 0.8031, 'ndcg@10': 0.8381, 'compress@10': 0.982, 'time@10': 5.2576}:  80%|████████  | 24/30 [01:33<00:18,  3.04s/it]    {'epoch': 7, 'num_users': 5.8, 'loss': 0.0433, 'hit_ratio@10': 0.8031, 'ndcg@10': 0.8381, 'compress@10': 0.982, 'time@10': 5.2576}:  83%|████████▎ | 25/30 [01:33<00:11,  2.31s/it]{'epoch': 7, 'num_users': 5.8077, 'loss': 0.0442, 'hit_ratio@10': 0.8065, 'ndcg@10': 0.8372, 'compress@10': 0.9819, 'time@10': 5.4111}:  83%|████████▎ | 25/30 [01:42<00:11,  2.31s/it]{'epoch': 7, 'num_users': 5.8077, 'loss': 0.0442, 'hit_ratio@10': 0.8065, 'ndcg@10': 0.8372, 'compress@10': 0.9819, 'time@10': 5.4111}:  87%|████████▋ | 26/30 [01:42<00:17,  4.41s/it]{'epoch': 7, 'num_users': 5.8889, 'loss': 0.0446, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.8376, 'compress@10': 0.982, 'time@10': 5.5049}:  87%|████████▋ | 26/30 [01:46<00:17,  4.41s/it] {'epoch': 7, 'num_users': 5.8889, 'loss': 0.0446, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.8376, 'compress@10': 0.982, 'time@10': 5.5049}:  90%|█████████ | 27/30 [01:46<00:12,  4.29s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.0449, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.8383, 'compress@10': 0.982, 'time@10': 5.5929}:  90%|█████████ | 27/30 [01:54<00:12,  4.29s/it]   {'epoch': 7, 'num_users': 6.0, 'loss': 0.0449, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.8383, 'compress@10': 0.982, 'time@10': 5.5929}:  93%|█████████▎| 28/30 [01:54<00:10,  5.40s/it]{'epoch': 7, 'num_users': 5.8621, 'loss': 0.0443, 'hit_ratio@10': 0.8194, 'ndcg@10': 0.8408, 'compress@10': 0.9821, 'time@10': 5.6222}:  93%|█████████▎| 28/30 [01:57<00:10,  5.40s/it]{'epoch': 7, 'num_users': 5.8621, 'loss': 0.0443, 'hit_ratio@10': 0.8194, 'ndcg@10': 0.8408, 'compress@10': 0.9821, 'time@10': 5.6222}:  97%|█████████▋| 29/30 [01:57<00:04,  4.76s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0442, 'hit_ratio@10': 0.8146, 'ndcg@10': 0.8428, 'compress@10': 0.9822, 'time@10': 5.6493}:  97%|█████████▋| 29/30 [02:04<00:04,  4.76s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0442, 'hit_ratio@10': 0.8146, 'ndcg@10': 0.8428, 'compress@10': 0.9822, 'time@10': 5.6493}: 100%|██████████| 30/30 [02:04<00:00,  5.28s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0442, 'hit_ratio@10': 0.8146, 'ndcg@10': 0.8428, 'compress@10': 0.9822, 'time@10': 5.6493}: 100%|██████████| 30/30 [02:04<00:00,  4.14s/it]
Epoch: 7
Avg # of users: 5.866666666666666
Avg Loss: 0.044166140817220804
Avg hit ratio: 0.8146244832805464
Avg ndcg: 0.8427556101147762
Avg compression ratio: 0.9821881908033312
Avg train time: 5.649302053451538
Std train time: 2.4852922863447042
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 17, 10, 5, 10, 10, 10, 8, 10, 10, 18, 10, 18, 9, 18, 18, 10, 10, 9, 7, 10, 10, 18, 18, 7, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0516, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8718, 'compress@10': 0.9845, 'time@10': 6.6819}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0516, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8718, 'compress@10': 0.9845, 'time@10': 6.6819}:   3%|▎         | 1/30 [00:03<01:38,  3.38s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8607, 'compress@10': 0.9845, 'time@10': 5.51}:   3%|▎         | 1/30 [00:07<01:38,  3.38s/it]    {'epoch': 8, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8607, 'compress@10': 0.9845, 'time@10': 5.51}:   7%|▋         | 2/30 [00:07<01:51,  3.98s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8595, 'compress@10': 0.9827, 'time@10': 4.5179}:   7%|▋         | 2/30 [00:09<01:51,  3.98s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8595, 'compress@10': 0.9827, 'time@10': 4.5179}:  10%|█         | 3/30 [00:09<01:14,  2.76s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.039, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8362, 'compress@10': 0.98, 'time@10': 4.2856}:  10%|█         | 3/30 [00:12<01:14,  2.76s/it]  {'epoch': 8, 'num_users': 5.0, 'loss': 0.039, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8362, 'compress@10': 0.98, 'time@10': 4.2856}:  13%|█▎        | 4/30 [00:12<01:20,  3.10s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0492, 'hit_ratio@10': 0.772, 'ndcg@10': 0.8217, 'compress@10': 0.9806, 'time@10': 4.8161}:  13%|█▎        | 4/30 [00:16<01:20,  3.10s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0492, 'hit_ratio@10': 0.772, 'ndcg@10': 0.8217, 'compress@10': 0.9806, 'time@10': 4.8161}:  17%|█▋        | 5/30 [00:16<01:21,  3.25s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0511, 'hit_ratio@10': 0.7804, 'ndcg@10': 0.823, 'compress@10': 0.9795, 'time@10': 5.1787}:  17%|█▋        | 5/30 [00:23<01:21,  3.25s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0511, 'hit_ratio@10': 0.7804, 'ndcg@10': 0.823, 'compress@10': 0.9795, 'time@10': 5.1787}:  20%|██        | 6/30 [00:23<01:48,  4.53s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0505, 'hit_ratio@10': 0.8061, 'ndcg@10': 0.8257, 'compress@10': 0.9795, 'time@10': 5.5654}:  20%|██        | 6/30 [00:27<01:48,  4.53s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0505, 'hit_ratio@10': 0.8061, 'ndcg@10': 0.8257, 'compress@10': 0.9795, 'time@10': 5.5654}:  23%|██▎       | 7/30 [00:27<01:40,  4.35s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0499, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.8366, 'compress@10': 0.9794, 'time@10': 5.5625}:  23%|██▎       | 7/30 [00:32<01:40,  4.35s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0499, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.8366, 'compress@10': 0.9794, 'time@10': 5.5625}:  27%|██▋       | 8/30 [00:32<01:44,  4.74s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0488, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.847, 'compress@10': 0.9789, 'time@10': 5.9378}:  27%|██▋       | 8/30 [00:37<01:44,  4.74s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0488, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.847, 'compress@10': 0.9789, 'time@10': 5.9378}:  30%|███       | 9/30 [00:37<01:38,  4.67s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8486, 'compress@10': 0.9793, 'time@10': 6.041}:  30%|███       | 9/30 [00:44<01:38,  4.67s/it]    {'epoch': 8, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8486, 'compress@10': 0.9793, 'time@10': 6.041}:  33%|███▎      | 10/30 [00:44<01:48,  5.42s/it]{'epoch': 8, 'num_users': 6.6364, 'loss': 0.0493, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8496, 'compress@10': 0.9801, 'time@10': 6.2402}:  33%|███▎      | 10/30 [00:48<01:48,  5.42s/it]{'epoch': 8, 'num_users': 6.6364, 'loss': 0.0493, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8496, 'compress@10': 0.9801, 'time@10': 6.2402}:  37%|███▋      | 11/30 [00:48<01:35,  5.04s/it]{'epoch': 8, 'num_users': 6.4167, 'loss': 0.0464, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8551, 'compress@10': 0.9805, 'time@10': 5.9964}:  37%|███▋      | 11/30 [00:51<01:35,  5.04s/it]{'epoch': 8, 'num_users': 6.4167, 'loss': 0.0464, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8551, 'compress@10': 0.9805, 'time@10': 5.9964}:  40%|████      | 12/30 [00:51<01:21,  4.53s/it]{'epoch': 8, 'num_users': 6.6154, 'loss': 0.047, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.8582, 'compress@10': 0.9809, 'time@10': 6.0738}:  40%|████      | 12/30 [00:55<01:21,  4.53s/it] {'epoch': 8, 'num_users': 6.6154, 'loss': 0.047, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.8582, 'compress@10': 0.9809, 'time@10': 6.0738}:  43%|████▎     | 13/30 [00:55<01:11,  4.23s/it]{'epoch': 8, 'num_users': 6.3571, 'loss': 0.0444, 'hit_ratio@10': 0.8014, 'ndcg@10': 0.8548, 'compress@10': 0.9812, 'time@10': 5.7464}:  43%|████▎     | 13/30 [00:57<01:11,  4.23s/it]{'epoch': 8, 'num_users': 6.3571, 'loss': 0.0444, 'hit_ratio@10': 0.8014, 'ndcg@10': 0.8548, 'compress@10': 0.9812, 'time@10': 5.7464}:  47%|████▋     | 14/30 [00:57<00:54,  3.41s/it]{'epoch': 8, 'num_users': 6.2667, 'loss': 0.0456, 'hit_ratio@10': 0.8125, 'ndcg@10': 0.8576, 'compress@10': 0.9811, 'time@10': 5.9553}:  47%|████▋     | 14/30 [01:01<00:54,  3.41s/it]{'epoch': 8, 'num_users': 6.2667, 'loss': 0.0456, 'hit_ratio@10': 0.8125, 'ndcg@10': 0.8576, 'compress@10': 0.9811, 'time@10': 5.9553}:  50%|█████     | 15/30 [01:01<00:56,  3.74s/it]{'epoch': 8, 'num_users': 6.0625, 'loss': 0.0435, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8587, 'compress@10': 0.9806, 'time@10': 5.7865}:  50%|█████     | 15/30 [01:04<00:56,  3.74s/it]{'epoch': 8, 'num_users': 6.0625, 'loss': 0.0435, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8587, 'compress@10': 0.9806, 'time@10': 5.7865}:  53%|█████▎    | 16/30 [01:04<00:50,  3.60s/it]{'epoch': 8, 'num_users': 5.8235, 'loss': 0.0417, 'hit_ratio@10': 0.8012, 'ndcg@10': 0.852, 'compress@10': 0.9814, 'time@10': 5.5844}:  53%|█████▎    | 16/30 [01:06<00:50,  3.60s/it] {'epoch': 8, 'num_users': 5.8235, 'loss': 0.0417, 'hit_ratio@10': 0.8012, 'ndcg@10': 0.852, 'compress@10': 0.9814, 'time@10': 5.5844}:  57%|█████▋    | 17/30 [01:06<00:37,  2.89s/it]{'epoch': 8, 'num_users': 6.0556, 'loss': 0.0425, 'hit_ratio@10': 0.7983, 'ndcg@10': 0.8523, 'compress@10': 0.9812, 'time@10': 5.5227}:  57%|█████▋    | 17/30 [01:10<00:37,  2.89s/it]{'epoch': 8, 'num_users': 6.0556, 'loss': 0.0425, 'hit_ratio@10': 0.7983, 'ndcg@10': 0.8523, 'compress@10': 0.9812, 'time@10': 5.5227}:  60%|██████    | 18/30 [01:10<00:40,  3.38s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.0413, 'hit_ratio@10': 0.8014, 'ndcg@10': 0.8537, 'compress@10': 0.9816, 'time@10': 5.4574}:  60%|██████    | 18/30 [01:12<00:40,  3.38s/it]   {'epoch': 8, 'num_users': 6.0, 'loss': 0.0413, 'hit_ratio@10': 0.8014, 'ndcg@10': 0.8537, 'compress@10': 0.9816, 'time@10': 5.4574}:  63%|██████▎   | 19/30 [01:12<00:33,  3.02s/it]{'epoch': 8, 'num_users': 6.15, 'loss': 0.0419, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8518, 'compress@10': 0.9819, 'time@10': 5.602}:  63%|██████▎   | 19/30 [01:21<00:33,  3.02s/it]{'epoch': 8, 'num_users': 6.15, 'loss': 0.0419, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8518, 'compress@10': 0.9819, 'time@10': 5.602}:  67%|██████▋   | 20/30 [01:21<00:46,  4.63s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0433, 'hit_ratio@10': 0.805, 'ndcg@10': 0.85, 'compress@10': 0.982, 'time@10': 5.7684}:  67%|██████▋   | 20/30 [01:25<00:46,  4.63s/it] {'epoch': 8, 'num_users': 6.3333, 'loss': 0.0433, 'hit_ratio@10': 0.805, 'ndcg@10': 0.85, 'compress@10': 0.982, 'time@10': 5.7684}:  70%|███████   | 21/30 [01:25<00:41,  4.62s/it]{'epoch': 8, 'num_users': 6.1818, 'loss': 0.0437, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.852, 'compress@10': 0.982, 'time@10': 5.6627}:  70%|███████   | 21/30 [01:29<00:41,  4.62s/it]{'epoch': 8, 'num_users': 6.1818, 'loss': 0.0437, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.852, 'compress@10': 0.982, 'time@10': 5.6627}:  73%|███████▎  | 22/30 [01:29<00:34,  4.28s/it]{'epoch': 8, 'num_users': 6.1304, 'loss': 0.0429, 'hit_ratio@10': 0.8115, 'ndcg@10': 0.8539, 'compress@10': 0.9822, 'time@10': 5.6886}:  73%|███████▎  | 22/30 [01:32<00:34,  4.28s/it]{'epoch': 8, 'num_users': 6.1304, 'loss': 0.0429, 'hit_ratio@10': 0.8115, 'ndcg@10': 0.8539, 'compress@10': 0.9822, 'time@10': 5.6886}:  77%|███████▋  | 23/30 [01:32<00:27,  3.95s/it]{'epoch': 8, 'num_users': 5.9583, 'loss': 0.0425, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8472, 'compress@10': 0.9821, 'time@10': 5.5004}:  77%|███████▋  | 23/30 [01:33<00:27,  3.95s/it] {'epoch': 8, 'num_users': 5.9583, 'loss': 0.0425, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8472, 'compress@10': 0.9821, 'time@10': 5.5004}:  80%|████████  | 24/30 [01:33<00:18,  3.13s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0413, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8371, 'compress@10': 0.9823, 'time@10': 5.327}:  80%|████████  | 24/30 [01:34<00:18,  3.13s/it]   {'epoch': 8, 'num_users': 5.8, 'loss': 0.0413, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8371, 'compress@10': 0.9823, 'time@10': 5.327}:  83%|████████▎ | 25/30 [01:34<00:11,  2.38s/it]{'epoch': 8, 'num_users': 5.8077, 'loss': 0.0422, 'hit_ratio@10': 0.808, 'ndcg@10': 0.8364, 'compress@10': 0.9823, 'time@10': 5.4795}:  83%|████████▎ | 25/30 [01:43<00:11,  2.38s/it]{'epoch': 8, 'num_users': 5.8077, 'loss': 0.0422, 'hit_ratio@10': 0.808, 'ndcg@10': 0.8364, 'compress@10': 0.9823, 'time@10': 5.4795}:  87%|████████▋ | 26/30 [01:43<00:17,  4.46s/it]{'epoch': 8, 'num_users': 5.8889, 'loss': 0.0423, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8379, 'compress@10': 0.9823, 'time@10': 5.57}:  87%|████████▋ | 26/30 [01:47<00:17,  4.46s/it] {'epoch': 8, 'num_users': 5.8889, 'loss': 0.0423, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8379, 'compress@10': 0.9823, 'time@10': 5.57}:  90%|█████████ | 27/30 [01:47<00:12,  4.32s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.0425, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8387, 'compress@10': 0.9823, 'time@10': 5.6664}:  90%|█████████ | 27/30 [01:55<00:12,  4.32s/it] {'epoch': 8, 'num_users': 6.0, 'loss': 0.0425, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8387, 'compress@10': 0.9823, 'time@10': 5.6664}:  93%|█████████▎| 28/30 [01:55<00:11,  5.52s/it]{'epoch': 8, 'num_users': 5.8621, 'loss': 0.042, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8404, 'compress@10': 0.9825, 'time@10': 5.7144}:  93%|█████████▎| 28/30 [01:59<00:11,  5.52s/it]{'epoch': 8, 'num_users': 5.8621, 'loss': 0.042, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8404, 'compress@10': 0.9825, 'time@10': 5.7144}:  97%|█████████▋| 29/30 [01:59<00:04,  4.93s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0421, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8423, 'compress@10': 0.9826, 'time@10': 5.7214}:  97%|█████████▋| 29/30 [02:05<00:04,  4.93s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0421, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8423, 'compress@10': 0.9826, 'time@10': 5.7214}: 100%|██████████| 30/30 [02:05<00:00,  5.24s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0421, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8423, 'compress@10': 0.9826, 'time@10': 5.7214}: 100%|██████████| 30/30 [02:05<00:00,  4.18s/it]
Epoch: 8
Avg # of users: 5.866666666666666
Avg Loss: 0.04206662535644476
Avg hit ratio: 0.8190760430618347
Avg ndcg: 0.8422817314115563
Avg compression ratio: 0.9825738627906999
Avg train time: 5.721392448743185
Std train time: 2.5239798742232087
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 18, 10, 5, 10, 10, 10, 8, 10, 10, 18, 10, 19, 9, 18, 19, 10, 10, 9, 7, 10, 10, 19, 19, 7, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0511, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.834, 'compress@10': 0.9852, 'time@10': 5.3151}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0511, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.834, 'compress@10': 0.9852, 'time@10': 5.3151}:   3%|▎         | 1/30 [00:02<01:18,  2.70s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0464, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8507, 'compress@10': 0.985, 'time@10': 4.9752}:   3%|▎         | 1/30 [00:07<01:18,  2.70s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0464, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8507, 'compress@10': 0.985, 'time@10': 4.9752}:   7%|▋         | 2/30 [00:07<01:48,  3.87s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8529, 'compress@10': 0.9832, 'time@10': 4.2646}:   7%|▋         | 2/30 [00:08<01:48,  3.87s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8529, 'compress@10': 0.9832, 'time@10': 4.2646}:  10%|█         | 3/30 [00:08<01:14,  2.77s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8464, 'compress@10': 0.9811, 'time@10': 4.0282}:  10%|█         | 3/30 [00:12<01:14,  2.77s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8464, 'compress@10': 0.9811, 'time@10': 4.0282}:  13%|█▎        | 4/30 [00:12<01:18,  3.01s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0464, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8303, 'compress@10': 0.9815, 'time@10': 4.6628}:  13%|█▎        | 4/30 [00:15<01:18,  3.01s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0464, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8303, 'compress@10': 0.9815, 'time@10': 4.6628}:  17%|█▋        | 5/30 [00:15<01:20,  3.24s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0482, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8312, 'compress@10': 0.9804, 'time@10': 4.7283}:  17%|█▋        | 5/30 [00:20<01:20,  3.24s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0482, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8312, 'compress@10': 0.9804, 'time@10': 4.7283}:  20%|██        | 6/30 [00:20<01:32,  3.87s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.048, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8364, 'compress@10': 0.9801, 'time@10': 5.2292}:  20%|██        | 6/30 [00:25<01:32,  3.87s/it] {'epoch': 9, 'num_users': 6.2857, 'loss': 0.048, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8364, 'compress@10': 0.9801, 'time@10': 5.2292}:  23%|██▎       | 7/30 [00:25<01:31,  3.96s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0477, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8485, 'compress@10': 0.98, 'time@10': 5.3009}:  23%|██▎       | 7/30 [00:30<01:31,  3.96s/it]   {'epoch': 9, 'num_users': 6.125, 'loss': 0.0477, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8485, 'compress@10': 0.98, 'time@10': 5.3009}:  27%|██▋       | 8/30 [00:30<01:40,  4.56s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0471, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8578, 'compress@10': 0.9795, 'time@10': 5.7134}:  27%|██▋       | 8/30 [00:35<01:40,  4.56s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0471, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8578, 'compress@10': 0.9795, 'time@10': 5.7134}:  30%|███       | 9/30 [00:35<01:35,  4.56s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0468, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8585, 'compress@10': 0.9802, 'time@10': 5.8512}:  30%|███       | 9/30 [00:42<01:35,  4.56s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0468, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8585, 'compress@10': 0.9802, 'time@10': 5.8512}:  33%|███▎      | 10/30 [00:42<01:47,  5.35s/it]{'epoch': 9, 'num_users': 6.6364, 'loss': 0.049, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8607, 'compress@10': 0.981, 'time@10': 6.0746}:  33%|███▎      | 10/30 [00:46<01:47,  5.35s/it]{'epoch': 9, 'num_users': 6.6364, 'loss': 0.049, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8607, 'compress@10': 0.981, 'time@10': 6.0746}:  37%|███▋      | 11/30 [00:46<01:34,  5.00s/it]{'epoch': 9, 'num_users': 6.4167, 'loss': 0.0461, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.8654, 'compress@10': 0.9813, 'time@10': 5.8415}:  37%|███▋      | 11/30 [00:50<01:34,  5.00s/it]{'epoch': 9, 'num_users': 6.4167, 'loss': 0.0461, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.8654, 'compress@10': 0.9813, 'time@10': 5.8415}:  40%|████      | 12/30 [00:50<01:20,  4.49s/it]{'epoch': 9, 'num_users': 6.6154, 'loss': 0.0465, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8675, 'compress@10': 0.9818, 'time@10': 5.9081}:  40%|████      | 12/30 [00:53<01:20,  4.49s/it]{'epoch': 9, 'num_users': 6.6154, 'loss': 0.0465, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8675, 'compress@10': 0.9818, 'time@10': 5.9081}:  43%|████▎     | 13/30 [00:53<01:10,  4.16s/it]{'epoch': 9, 'num_users': 6.3571, 'loss': 0.0439, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8634, 'compress@10': 0.982, 'time@10': 5.5951}:  43%|████▎     | 13/30 [00:55<01:10,  4.16s/it] {'epoch': 9, 'num_users': 6.3571, 'loss': 0.0439, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8634, 'compress@10': 0.982, 'time@10': 5.5951}:  47%|████▋     | 14/30 [00:55<00:53,  3.37s/it]{'epoch': 9, 'num_users': 6.2667, 'loss': 0.0451, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8655, 'compress@10': 0.9819, 'time@10': 5.7581}:  47%|████▋     | 14/30 [00:59<00:53,  3.37s/it]{'epoch': 9, 'num_users': 6.2667, 'loss': 0.0451, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8655, 'compress@10': 0.9819, 'time@10': 5.7581}:  50%|█████     | 15/30 [00:59<00:53,  3.58s/it]{'epoch': 9, 'num_users': 6.0625, 'loss': 0.0431, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8663, 'compress@10': 0.9814, 'time@10': 5.5902}:  50%|█████     | 15/30 [01:02<00:53,  3.58s/it] {'epoch': 9, 'num_users': 6.0625, 'loss': 0.0431, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8663, 'compress@10': 0.9814, 'time@10': 5.5902}:  53%|█████▎    | 16/30 [01:02<00:48,  3.44s/it]{'epoch': 9, 'num_users': 5.8235, 'loss': 0.0412, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8592, 'compress@10': 0.982, 'time@10': 5.4054}:  53%|█████▎    | 16/30 [01:03<00:48,  3.44s/it]{'epoch': 9, 'num_users': 5.8235, 'loss': 0.0412, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8592, 'compress@10': 0.982, 'time@10': 5.4054}:  57%|█████▋    | 17/30 [01:03<00:36,  2.79s/it]{'epoch': 9, 'num_users': 6.0556, 'loss': 0.042, 'hit_ratio@10': 0.8165, 'ndcg@10': 0.8586, 'compress@10': 0.9818, 'time@10': 5.3756}:  57%|█████▋    | 17/30 [01:08<00:36,  2.79s/it]{'epoch': 9, 'num_users': 6.0556, 'loss': 0.042, 'hit_ratio@10': 0.8165, 'ndcg@10': 0.8586, 'compress@10': 0.9818, 'time@10': 5.3756}:  60%|██████    | 18/30 [01:08<00:41,  3.43s/it]{'epoch': 9, 'num_users': 6.0, 'loss': 0.0408, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8599, 'compress@10': 0.9822, 'time@10': 5.3183}:  60%|██████    | 18/30 [01:10<00:41,  3.43s/it]  {'epoch': 9, 'num_users': 6.0, 'loss': 0.0408, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8599, 'compress@10': 0.9822, 'time@10': 5.3183}:  63%|██████▎   | 19/30 [01:10<00:33,  3.05s/it]{'epoch': 9, 'num_users': 6.15, 'loss': 0.0413, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.858, 'compress@10': 0.9825, 'time@10': 5.48}:  63%|██████▎   | 19/30 [01:19<00:33,  3.05s/it]  {'epoch': 9, 'num_users': 6.15, 'loss': 0.0413, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.858, 'compress@10': 0.9825, 'time@10': 5.48}:  67%|██████▋   | 20/30 [01:19<00:47,  4.72s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0428, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8559, 'compress@10': 0.9825, 'time@10': 5.656}:  67%|██████▋   | 20/30 [01:23<00:47,  4.72s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0428, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8559, 'compress@10': 0.9825, 'time@10': 5.656}:  70%|███████   | 21/30 [01:23<00:42,  4.69s/it]{'epoch': 9, 'num_users': 6.1818, 'loss': 0.0432, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8579, 'compress@10': 0.9826, 'time@10': 5.5549}:  70%|███████   | 21/30 [01:27<00:42,  4.69s/it]{'epoch': 9, 'num_users': 6.1818, 'loss': 0.0432, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8579, 'compress@10': 0.9826, 'time@10': 5.5549}:  73%|███████▎  | 22/30 [01:27<00:34,  4.33s/it]{'epoch': 9, 'num_users': 6.1304, 'loss': 0.0424, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8597, 'compress@10': 0.9827, 'time@10': 5.5996}:  73%|███████▎  | 22/30 [01:30<00:34,  4.33s/it]{'epoch': 9, 'num_users': 6.1304, 'loss': 0.0424, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8597, 'compress@10': 0.9827, 'time@10': 5.5996}:  77%|███████▋  | 23/30 [01:30<00:28,  4.10s/it]{'epoch': 9, 'num_users': 5.9583, 'loss': 0.0419, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8528, 'compress@10': 0.9826, 'time@10': 5.4215}:  77%|███████▋  | 23/30 [01:32<00:28,  4.10s/it]{'epoch': 9, 'num_users': 5.9583, 'loss': 0.0419, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8528, 'compress@10': 0.9826, 'time@10': 5.4215}:  80%|████████  | 24/30 [01:32<00:19,  3.29s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0407, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8435, 'compress@10': 0.9828, 'time@10': 5.2582}:  80%|████████  | 24/30 [01:33<00:19,  3.29s/it]     {'epoch': 9, 'num_users': 5.8, 'loss': 0.0407, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8435, 'compress@10': 0.9828, 'time@10': 5.2582}:  83%|████████▎ | 25/30 [01:33<00:12,  2.52s/it]{'epoch': 9, 'num_users': 5.8077, 'loss': 0.0415, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8429, 'compress@10': 0.9828, 'time@10': 5.4146}:  83%|████████▎ | 25/30 [01:42<00:12,  2.52s/it]{'epoch': 9, 'num_users': 5.8077, 'loss': 0.0415, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8429, 'compress@10': 0.9828, 'time@10': 5.4146}:  87%|████████▋ | 26/30 [01:42<00:18,  4.57s/it]{'epoch': 9, 'num_users': 5.8889, 'loss': 0.0415, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8443, 'compress@10': 0.9829, 'time@10': 5.5125}:  87%|████████▋ | 26/30 [01:46<00:18,  4.57s/it]{'epoch': 9, 'num_users': 5.8889, 'loss': 0.0415, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8443, 'compress@10': 0.9829, 'time@10': 5.5125}:  90%|█████████ | 27/30 [01:46<00:13,  4.42s/it]{'epoch': 9, 'num_users': 6.0, 'loss': 0.0417, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8449, 'compress@10': 0.9828, 'time@10': 5.6105}:  90%|█████████ | 27/30 [01:54<00:13,  4.42s/it]   {'epoch': 9, 'num_users': 6.0, 'loss': 0.0417, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8449, 'compress@10': 0.9828, 'time@10': 5.6105}:  93%|█████████▎| 28/30 [01:54<00:11,  5.58s/it]{'epoch': 9, 'num_users': 5.8621, 'loss': 0.0412, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8466, 'compress@10': 0.983, 'time@10': 5.6546}:  93%|█████████▎| 28/30 [01:58<00:11,  5.58s/it]{'epoch': 9, 'num_users': 5.8621, 'loss': 0.0412, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8466, 'compress@10': 0.983, 'time@10': 5.6546}:  97%|█████████▋| 29/30 [01:58<00:04,  4.95s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0411, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8483, 'compress@10': 0.983, 'time@10': 5.664}:  97%|█████████▋| 29/30 [02:04<00:04,  4.95s/it] {'epoch': 9, 'num_users': 5.8667, 'loss': 0.0411, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8483, 'compress@10': 0.983, 'time@10': 5.664}: 100%|██████████| 30/30 [02:04<00:00,  5.26s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0411, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8483, 'compress@10': 0.983, 'time@10': 5.664}: 100%|██████████| 30/30 [02:04<00:00,  4.14s/it]
Epoch: 9
Avg # of users: 5.866666666666666
Avg Loss: 0.04109383274120795
Avg hit ratio: 0.8308944835175894
Avg ndcg: 0.8482751385776468
Avg compression ratio: 0.9830141563779305
Avg train time: 5.664033238093058
Std train time: 2.4823965143136233
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 8, 10, 10, 18, 10, 20, 9, 19, 20, 10, 10, 9, 7, 10, 10, 20, 20, 7, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.9841, 'time@10': 5.9662}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.9841, 'time@10': 5.9662}:   3%|▎         | 1/30 [00:03<01:27,  3.03s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8628, 'compress@10': 0.9846, 'time@10': 5.4832}:   3%|▎         | 1/30 [00:08<01:27,  3.03s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8628, 'compress@10': 0.9846, 'time@10': 5.4832}:   7%|▋         | 2/30 [00:08<01:58,  4.21s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8609, 'compress@10': 0.9832, 'time@10': 4.713}:   7%|▋         | 2/30 [00:09<01:58,  4.21s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8609, 'compress@10': 0.9832, 'time@10': 4.713}:  10%|█         | 3/30 [00:09<01:21,  3.03s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8539, 'compress@10': 0.9815, 'time@10': 4.4118}:  10%|█         | 3/30 [00:13<01:21,  3.03s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8539, 'compress@10': 0.9815, 'time@10': 4.4118}:  13%|█▎        | 4/30 [00:13<01:24,  3.26s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0447, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.8361, 'compress@10': 0.9819, 'time@10': 5.0532}:  13%|█▎        | 4/30 [00:17<01:24,  3.26s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0447, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.8361, 'compress@10': 0.9819, 'time@10': 5.0532}:  17%|█▋        | 5/30 [00:17<01:26,  3.48s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0464, 'hit_ratio@10': 0.8209, 'ndcg@10': 0.8361, 'compress@10': 0.9806, 'time@10': 5.1983}:  17%|█▋        | 5/30 [00:23<01:26,  3.48s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0464, 'hit_ratio@10': 0.8209, 'ndcg@10': 0.8361, 'compress@10': 0.9806, 'time@10': 5.1983}:  20%|██        | 6/30 [00:23<01:43,  4.32s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0455, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.837, 'compress@10': 0.9805, 'time@10': 5.501}:  20%|██        | 6/30 [00:26<01:43,  4.32s/it]  {'epoch': 10, 'num_users': 6.2857, 'loss': 0.0455, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.837, 'compress@10': 0.9805, 'time@10': 5.501}:  23%|██▎       | 7/30 [00:26<01:34,  4.12s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0455, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8494, 'compress@10': 0.9803, 'time@10': 5.5111}:  23%|██▎       | 7/30 [00:32<01:34,  4.12s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0455, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8494, 'compress@10': 0.9803, 'time@10': 5.5111}:  27%|██▋       | 8/30 [00:32<01:41,  4.60s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.045, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8594, 'compress@10': 0.98, 'time@10': 5.8936}:  27%|██▋       | 8/30 [00:36<01:41,  4.60s/it]  {'epoch': 10, 'num_users': 6.3333, 'loss': 0.045, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8594, 'compress@10': 0.98, 'time@10': 5.8936}:  30%|███       | 9/30 [00:36<01:36,  4.57s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0437, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8616, 'compress@10': 0.9804, 'time@10': 6.0139}:  30%|███       | 9/30 [00:44<01:36,  4.57s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0437, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8616, 'compress@10': 0.9804, 'time@10': 6.0139}:  33%|███▎      | 10/30 [00:44<01:47,  5.36s/it]{'epoch': 10, 'num_users': 6.6364, 'loss': 0.0464, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.866, 'compress@10': 0.9812, 'time@10': 6.2199}:  33%|███▎      | 10/30 [00:48<01:47,  5.36s/it]{'epoch': 10, 'num_users': 6.6364, 'loss': 0.0464, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.866, 'compress@10': 0.9812, 'time@10': 6.2199}:  37%|███▋      | 11/30 [00:48<01:35,  5.00s/it]{'epoch': 10, 'num_users': 6.4167, 'loss': 0.0437, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8684, 'compress@10': 0.9816, 'time@10': 5.978}:  37%|███▋      | 11/30 [00:51<01:35,  5.00s/it] {'epoch': 10, 'num_users': 6.4167, 'loss': 0.0437, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8684, 'compress@10': 0.9816, 'time@10': 5.978}:  40%|████      | 12/30 [00:51<01:21,  4.50s/it]{'epoch': 10, 'num_users': 6.6154, 'loss': 0.044, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.87, 'compress@10': 0.982, 'time@10': 6.0551}:  40%|████      | 12/30 [00:55<01:21,  4.50s/it]  {'epoch': 10, 'num_users': 6.6154, 'loss': 0.044, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.87, 'compress@10': 0.982, 'time@10': 6.0551}:  43%|████▎     | 13/30 [00:55<01:11,  4.21s/it]{'epoch': 10, 'num_users': 6.3571, 'loss': 0.0415, 'hit_ratio@10': 0.819, 'ndcg@10': 0.8658, 'compress@10': 0.9822, 'time@10': 5.7413}:  43%|████▎     | 13/30 [00:56<01:11,  4.21s/it]{'epoch': 10, 'num_users': 6.3571, 'loss': 0.0415, 'hit_ratio@10': 0.819, 'ndcg@10': 0.8658, 'compress@10': 0.9822, 'time@10': 5.7413}:  47%|████▋     | 14/30 [00:56<00:55,  3.45s/it]{'epoch': 10, 'num_users': 6.2667, 'loss': 0.0428, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8677, 'compress@10': 0.9822, 'time@10': 5.9482}:  47%|████▋     | 14/30 [01:01<00:55,  3.45s/it]{'epoch': 10, 'num_users': 6.2667, 'loss': 0.0428, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8677, 'compress@10': 0.9822, 'time@10': 5.9482}:  50%|█████     | 15/30 [01:01<00:56,  3.76s/it]{'epoch': 10, 'num_users': 6.0625, 'loss': 0.0409, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8684, 'compress@10': 0.9816, 'time@10': 5.7911}:  50%|█████     | 15/30 [01:04<00:56,  3.76s/it]{'epoch': 10, 'num_users': 6.0625, 'loss': 0.0409, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8684, 'compress@10': 0.9816, 'time@10': 5.7911}:  53%|█████▎    | 16/30 [01:04<00:51,  3.67s/it]{'epoch': 10, 'num_users': 5.8235, 'loss': 0.039, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.8611, 'compress@10': 0.9823, 'time@10': 5.6017}:  53%|█████▎    | 16/30 [01:06<00:51,  3.67s/it] {'epoch': 10, 'num_users': 5.8235, 'loss': 0.039, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.8611, 'compress@10': 0.9823, 'time@10': 5.6017}:  57%|█████▋    | 17/30 [01:06<00:38,  2.97s/it]{'epoch': 10, 'num_users': 6.0556, 'loss': 0.0398, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8612, 'compress@10': 0.982, 'time@10': 5.5376}:  57%|█████▋    | 17/30 [01:10<00:38,  2.97s/it] {'epoch': 10, 'num_users': 6.0556, 'loss': 0.0398, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8612, 'compress@10': 0.982, 'time@10': 5.5376}:  60%|██████    | 18/30 [01:10<00:41,  3.42s/it]{'epoch': 10, 'num_users': 6.0, 'loss': 0.0387, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8622, 'compress@10': 0.9824, 'time@10': 5.4673}:  60%|██████    | 18/30 [01:12<00:41,  3.42s/it] {'epoch': 10, 'num_users': 6.0, 'loss': 0.0387, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8622, 'compress@10': 0.9824, 'time@10': 5.4673}:  63%|██████▎   | 19/30 [01:12<00:33,  3.04s/it]{'epoch': 10, 'num_users': 6.15, 'loss': 0.0391, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8603, 'compress@10': 0.9827, 'time@10': 5.612}:  63%|██████▎   | 19/30 [01:21<00:33,  3.04s/it]{'epoch': 10, 'num_users': 6.15, 'loss': 0.0391, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8603, 'compress@10': 0.9827, 'time@10': 5.612}:  67%|██████▋   | 20/30 [01:21<00:46,  4.65s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0408, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8582, 'compress@10': 0.9827, 'time@10': 5.7726}:  67%|██████▋   | 20/30 [01:25<00:46,  4.65s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0408, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8582, 'compress@10': 0.9827, 'time@10': 5.7726}:  70%|███████   | 21/30 [01:25<00:41,  4.61s/it]{'epoch': 10, 'num_users': 6.1818, 'loss': 0.0412, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.86, 'compress@10': 0.9827, 'time@10': 5.6581}:  70%|███████   | 21/30 [01:29<00:41,  4.61s/it]  {'epoch': 10, 'num_users': 6.1818, 'loss': 0.0412, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.86, 'compress@10': 0.9827, 'time@10': 5.6581}:  73%|███████▎  | 22/30 [01:29<00:33,  4.22s/it]{'epoch': 10, 'num_users': 6.1304, 'loss': 0.0405, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8617, 'compress@10': 0.9829, 'time@10': 5.6617}:  73%|███████▎  | 22/30 [01:31<00:33,  4.22s/it]{'epoch': 10, 'num_users': 6.1304, 'loss': 0.0405, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8617, 'compress@10': 0.9829, 'time@10': 5.6617}:  77%|███████▋  | 23/30 [01:31<00:26,  3.82s/it]{'epoch': 10, 'num_users': 5.9583, 'loss': 0.04, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8547, 'compress@10': 0.9828, 'time@10': 5.4814}:  77%|███████▋  | 23/30 [01:33<00:26,  3.82s/it]  {'epoch': 10, 'num_users': 5.9583, 'loss': 0.04, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8547, 'compress@10': 0.9828, 'time@10': 5.4814}:  80%|████████  | 24/30 [01:33<00:18,  3.09s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0388, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8454, 'compress@10': 0.983, 'time@10': 5.3125}:  80%|████████  | 24/30 [01:33<00:18,  3.09s/it]  {'epoch': 10, 'num_users': 5.8, 'loss': 0.0388, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8454, 'compress@10': 0.983, 'time@10': 5.3125}:  83%|████████▎ | 25/30 [01:33<00:11,  2.37s/it]{'epoch': 10, 'num_users': 5.8077, 'loss': 0.0395, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.845, 'compress@10': 0.983, 'time@10': 5.4721}:  83%|████████▎ | 25/30 [01:43<00:11,  2.37s/it]{'epoch': 10, 'num_users': 5.8077, 'loss': 0.0395, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.845, 'compress@10': 0.983, 'time@10': 5.4721}:  87%|████████▋ | 26/30 [01:43<00:18,  4.51s/it]{'epoch': 10, 'num_users': 5.8889, 'loss': 0.0396, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8464, 'compress@10': 0.9831, 'time@10': 5.5652}:  87%|████████▋ | 26/30 [01:47<00:18,  4.51s/it]{'epoch': 10, 'num_users': 5.8889, 'loss': 0.0396, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8464, 'compress@10': 0.9831, 'time@10': 5.5652}:  90%|█████████ | 27/30 [01:47<00:13,  4.37s/it]{'epoch': 10, 'num_users': 6.0, 'loss': 0.0396, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8475, 'compress@10': 0.9831, 'time@10': 5.6626}:  90%|█████████ | 27/30 [01:55<00:13,  4.37s/it]   {'epoch': 10, 'num_users': 6.0, 'loss': 0.0396, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8475, 'compress@10': 0.9831, 'time@10': 5.6626}:  93%|█████████▎| 28/30 [01:55<00:11,  5.56s/it]{'epoch': 10, 'num_users': 5.8621, 'loss': 0.0392, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8495, 'compress@10': 0.9832, 'time@10': 5.7061}:  93%|█████████▎| 28/30 [01:59<00:11,  5.56s/it]{'epoch': 10, 'num_users': 5.8621, 'loss': 0.0392, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8495, 'compress@10': 0.9832, 'time@10': 5.7061}:  97%|█████████▋| 29/30 [01:59<00:04,  4.94s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.0392, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8512, 'compress@10': 0.9833, 'time@10': 5.7061}:  97%|█████████▋| 29/30 [02:05<00:04,  4.94s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.0392, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8512, 'compress@10': 0.9833, 'time@10': 5.7061}: 100%|██████████| 30/30 [02:05<00:00,  5.18s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.0392, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.8512, 'compress@10': 0.9833, 'time@10': 5.7061}: 100%|██████████| 30/30 [02:05<00:00,  4.17s/it]
Epoch: 10
Avg # of users: 5.866666666666666
Avg Loss: 0.03921996870906655
Avg hit ratio: 0.8292092634858126
Avg ndcg: 0.8512132707431994
Avg compression ratio: 0.9832822559272429
Avg train time: 5.706108673413595
Std train time: 2.448082011148584
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 8, 10, 10, 18, 10, 21, 9, 19, 21, 10, 10, 9, 7, 10, 10, 21, 21, 7, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0456, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8494, 'compress@10': 0.9836, 'time@10': 5.0932}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0456, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8494, 'compress@10': 0.9836, 'time@10': 5.0932}:   3%|▎         | 1/30 [00:02<01:14,  2.58s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8613, 'compress@10': 0.9843, 'time@10': 4.9564}:   3%|▎         | 1/30 [00:07<01:14,  2.58s/it]  {'epoch': 11, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8613, 'compress@10': 0.9843, 'time@10': 4.9564}:   7%|▋         | 2/30 [00:07<01:49,  3.92s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8599, 'compress@10': 0.9833, 'time@10': 4.6824}:   7%|▋         | 2/30 [00:09<01:49,  3.92s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8599, 'compress@10': 0.9833, 'time@10': 4.6824}:  10%|█         | 3/30 [00:09<01:23,  3.10s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0349, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8468, 'compress@10': 0.9818, 'time@10': 4.6844}:  10%|█         | 3/30 [00:14<01:23,  3.10s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0349, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8468, 'compress@10': 0.9818, 'time@10': 4.6844}:  13%|█▎        | 4/30 [00:14<01:37,  3.74s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0452, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8312, 'compress@10': 0.9821, 'time@10': 5.3037}:  13%|█▎        | 4/30 [00:18<01:37,  3.74s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0452, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8312, 'compress@10': 0.9821, 'time@10': 5.3037}:  17%|█▋        | 5/30 [00:18<01:35,  3.82s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0464, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8326, 'compress@10': 0.9808, 'time@10': 5.5725}:  17%|█▋        | 5/30 [00:25<01:35,  3.82s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0464, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8326, 'compress@10': 0.9808, 'time@10': 5.5725}:  20%|██        | 6/30 [00:25<01:57,  4.89s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0463, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8395, 'compress@10': 0.9807, 'time@10': 5.6592}:  20%|██        | 6/30 [00:28<01:57,  4.89s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0463, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8395, 'compress@10': 0.9807, 'time@10': 5.6592}:  23%|██▎       | 7/30 [00:28<01:39,  4.31s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0459, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8502, 'compress@10': 0.9804, 'time@10': 5.6214}:  23%|██▎       | 7/30 [00:33<01:39,  4.31s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0459, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8502, 'compress@10': 0.9804, 'time@10': 5.6214}:  27%|██▋       | 8/30 [00:33<01:42,  4.66s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0455, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8599, 'compress@10': 0.9803, 'time@10': 6.0388}:  27%|██▋       | 8/30 [00:38<01:42,  4.66s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0455, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8599, 'compress@10': 0.9803, 'time@10': 6.0388}:  30%|███       | 9/30 [00:38<01:38,  4.68s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0455, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8606, 'compress@10': 0.9811, 'time@10': 6.1649}:  30%|███       | 9/30 [00:45<01:38,  4.68s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0455, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8606, 'compress@10': 0.9811, 'time@10': 6.1649}:  33%|███▎      | 10/30 [00:45<01:50,  5.50s/it]{'epoch': 11, 'num_users': 6.6364, 'loss': 0.0464, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8614, 'compress@10': 0.9817, 'time@10': 6.3628}:  33%|███▎      | 10/30 [00:50<01:50,  5.50s/it]{'epoch': 11, 'num_users': 6.6364, 'loss': 0.0464, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8614, 'compress@10': 0.9817, 'time@10': 6.3628}:  37%|███▋      | 11/30 [00:50<01:37,  5.11s/it]{'epoch': 11, 'num_users': 6.4167, 'loss': 0.0436, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.865, 'compress@10': 0.982, 'time@10': 6.104}:  37%|███▋      | 11/30 [00:53<01:37,  5.11s/it]   {'epoch': 11, 'num_users': 6.4167, 'loss': 0.0436, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.865, 'compress@10': 0.982, 'time@10': 6.104}:  40%|████      | 12/30 [00:53<01:22,  4.56s/it]{'epoch': 11, 'num_users': 6.6154, 'loss': 0.0438, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.8666, 'compress@10': 0.9825, 'time@10': 6.1728}:  40%|████      | 12/30 [00:56<01:22,  4.56s/it]{'epoch': 11, 'num_users': 6.6154, 'loss': 0.0438, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.8666, 'compress@10': 0.9825, 'time@10': 6.1728}:  43%|████▎     | 13/30 [00:56<01:12,  4.25s/it]{'epoch': 11, 'num_users': 6.3571, 'loss': 0.0413, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8626, 'compress@10': 0.9827, 'time@10': 5.8561}:  43%|████▎     | 13/30 [00:58<01:12,  4.25s/it]{'epoch': 11, 'num_users': 6.3571, 'loss': 0.0413, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8626, 'compress@10': 0.9827, 'time@10': 5.8561}:  47%|████▋     | 14/30 [00:58<00:56,  3.50s/it]{'epoch': 11, 'num_users': 6.2667, 'loss': 0.0426, 'hit_ratio@10': 0.8453, 'ndcg@10': 0.8646, 'compress@10': 0.9827, 'time@10': 6.0576}:  47%|████▋     | 14/30 [01:03<00:56,  3.50s/it]{'epoch': 11, 'num_users': 6.2667, 'loss': 0.0426, 'hit_ratio@10': 0.8453, 'ndcg@10': 0.8646, 'compress@10': 0.9827, 'time@10': 6.0576}:  50%|█████     | 15/30 [01:03<00:56,  3.80s/it]{'epoch': 11, 'num_users': 6.0625, 'loss': 0.0407, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8654, 'compress@10': 0.9821, 'time@10': 5.8929}:  50%|█████     | 15/30 [01:06<00:56,  3.80s/it]{'epoch': 11, 'num_users': 6.0625, 'loss': 0.0407, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8654, 'compress@10': 0.9821, 'time@10': 5.8929}:  53%|█████▎    | 16/30 [01:06<00:51,  3.70s/it]{'epoch': 11, 'num_users': 5.8235, 'loss': 0.0388, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8583, 'compress@10': 0.9828, 'time@10': 5.7073}:  53%|█████▎    | 16/30 [01:07<00:51,  3.70s/it]{'epoch': 11, 'num_users': 5.8235, 'loss': 0.0388, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8583, 'compress@10': 0.9828, 'time@10': 5.7073}:  57%|█████▋    | 17/30 [01:07<00:39,  3.01s/it]{'epoch': 11, 'num_users': 6.0556, 'loss': 0.0394, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8589, 'compress@10': 0.9825, 'time@10': 5.6377}:  57%|█████▋    | 17/30 [01:12<00:39,  3.01s/it]{'epoch': 11, 'num_users': 6.0556, 'loss': 0.0394, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8589, 'compress@10': 0.9825, 'time@10': 5.6377}:  60%|██████    | 18/30 [01:12<00:41,  3.46s/it]{'epoch': 11, 'num_users': 6.0, 'loss': 0.0384, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8595, 'compress@10': 0.9828, 'time@10': 5.5645}:  60%|██████    | 18/30 [01:14<00:41,  3.46s/it]   {'epoch': 11, 'num_users': 6.0, 'loss': 0.0384, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8595, 'compress@10': 0.9828, 'time@10': 5.5645}:  63%|██████▎   | 19/30 [01:14<00:33,  3.07s/it]{'epoch': 11, 'num_users': 6.15, 'loss': 0.0388, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.858, 'compress@10': 0.9832, 'time@10': 5.7078}:  63%|██████▎   | 19/30 [01:23<00:33,  3.07s/it]{'epoch': 11, 'num_users': 6.15, 'loss': 0.0388, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.858, 'compress@10': 0.9832, 'time@10': 5.7078}:  67%|██████▋   | 20/30 [01:23<00:46,  4.69s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8562, 'compress@10': 0.9832, 'time@10': 5.8706}:  67%|██████▋   | 20/30 [01:27<00:46,  4.69s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8562, 'compress@10': 0.9832, 'time@10': 5.8706}:  70%|███████   | 21/30 [01:27<00:42,  4.68s/it]{'epoch': 11, 'num_users': 6.1818, 'loss': 0.0408, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8581, 'compress@10': 0.9832, 'time@10': 5.76}:  70%|███████   | 21/30 [01:31<00:42,  4.68s/it]  {'epoch': 11, 'num_users': 6.1818, 'loss': 0.0408, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8581, 'compress@10': 0.9832, 'time@10': 5.76}:  73%|███████▎  | 22/30 [01:31<00:34,  4.32s/it]{'epoch': 11, 'num_users': 6.1304, 'loss': 0.0402, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.86, 'compress@10': 0.9833, 'time@10': 5.7796}:  73%|███████▎  | 22/30 [01:34<00:34,  4.32s/it]{'epoch': 11, 'num_users': 6.1304, 'loss': 0.0402, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.86, 'compress@10': 0.9833, 'time@10': 5.7796}:  77%|███████▋  | 23/30 [01:34<00:27,  3.97s/it]{'epoch': 11, 'num_users': 5.9583, 'loss': 0.0396, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8536, 'compress@10': 0.9831, 'time@10': 5.5964}:  77%|███████▋  | 23/30 [01:35<00:27,  3.97s/it]{'epoch': 11, 'num_users': 5.9583, 'loss': 0.0396, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8536, 'compress@10': 0.9831, 'time@10': 5.5964}:  80%|████████  | 24/30 [01:35<00:19,  3.20s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0384, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8444, 'compress@10': 0.9834, 'time@10': 5.4261}:  80%|████████  | 24/30 [01:36<00:19,  3.20s/it]  {'epoch': 11, 'num_users': 5.8, 'loss': 0.0384, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8444, 'compress@10': 0.9834, 'time@10': 5.4261}:  83%|████████▎ | 25/30 [01:36<00:12,  2.46s/it]{'epoch': 11, 'num_users': 5.8077, 'loss': 0.039, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8442, 'compress@10': 0.9834, 'time@10': 5.575}:  83%|████████▎ | 25/30 [01:45<00:12,  2.46s/it]{'epoch': 11, 'num_users': 5.8077, 'loss': 0.039, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8442, 'compress@10': 0.9834, 'time@10': 5.575}:  87%|████████▋ | 26/30 [01:45<00:18,  4.52s/it]{'epoch': 11, 'num_users': 5.8889, 'loss': 0.0391, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8455, 'compress@10': 0.9834, 'time@10': 5.6649}:  87%|████████▋ | 26/30 [01:49<00:18,  4.52s/it]{'epoch': 11, 'num_users': 5.8889, 'loss': 0.0391, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8455, 'compress@10': 0.9834, 'time@10': 5.6649}:  90%|█████████ | 27/30 [01:49<00:13,  4.38s/it]{'epoch': 11, 'num_users': 6.0, 'loss': 0.0391, 'hit_ratio@10': 0.8401, 'ndcg@10': 0.8464, 'compress@10': 0.9834, 'time@10': 5.7594}:  90%|█████████ | 27/30 [01:58<00:13,  4.38s/it]   {'epoch': 11, 'num_users': 6.0, 'loss': 0.0391, 'hit_ratio@10': 0.8401, 'ndcg@10': 0.8464, 'compress@10': 0.9834, 'time@10': 5.7594}:  93%|█████████▎| 28/30 [01:58<00:11,  5.57s/it]{'epoch': 11, 'num_users': 5.8621, 'loss': 0.0387, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8486, 'compress@10': 0.9836, 'time@10': 5.7988}:  93%|█████████▎| 28/30 [02:01<00:11,  5.57s/it]{'epoch': 11, 'num_users': 5.8621, 'loss': 0.0387, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8486, 'compress@10': 0.9836, 'time@10': 5.7988}:  97%|█████████▋| 29/30 [02:01<00:04,  4.95s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0386, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8504, 'compress@10': 0.9836, 'time@10': 5.8025}:  97%|█████████▋| 29/30 [02:07<00:04,  4.95s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0386, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8504, 'compress@10': 0.9836, 'time@10': 5.8025}: 100%|██████████| 30/30 [02:07<00:00,  5.25s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0386, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8504, 'compress@10': 0.9836, 'time@10': 5.8025}: 100%|██████████| 30/30 [02:07<00:00,  4.26s/it]
Epoch: 11
Avg # of users: 5.866666666666666
Avg Loss: 0.03862970598510217
Avg hit ratio: 0.8405317384668242
Avg ndcg: 0.8504171178519868
Avg compression ratio: 0.9836145313041943
Avg train time: 5.802458985646566
Std train time: 2.4039294120261556
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 8, 10, 10, 18, 10, 22, 9, 19, 22, 10, 10, 9, 7, 10, 10, 22, 22, 7, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0559, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.827, 'compress@10': 0.9838, 'time@10': 5.9425}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0559, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.827, 'compress@10': 0.9838, 'time@10': 5.9425}:   3%|▎         | 1/30 [00:03<01:27,  3.01s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8525, 'compress@10': 0.9845, 'time@10': 5.3834}:   3%|▎         | 1/30 [00:07<01:27,  3.01s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8525, 'compress@10': 0.9845, 'time@10': 5.3834}:   7%|▋         | 2/30 [00:07<01:54,  4.10s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.854, 'compress@10': 0.9837, 'time@10': 4.8421}:   7%|▋         | 2/30 [00:09<01:54,  4.10s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.854, 'compress@10': 0.9837, 'time@10': 4.8421}:  10%|█         | 3/30 [00:09<01:23,  3.11s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8289, 'compress@10': 0.9821, 'time@10': 4.663}:  10%|█         | 3/30 [00:13<01:23,  3.11s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8289, 'compress@10': 0.9821, 'time@10': 4.663}:  13%|█▎        | 4/30 [00:13<01:31,  3.52s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8173, 'compress@10': 0.9824, 'time@10': 5.1345}:  13%|█▎        | 4/30 [00:17<01:31,  3.52s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8173, 'compress@10': 0.9824, 'time@10': 5.1345}:  17%|█▋        | 5/30 [00:17<01:28,  3.53s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0477, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8221, 'compress@10': 0.9811, 'time@10': 5.3445}:  17%|█▋        | 5/30 [00:23<01:28,  3.53s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0477, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8221, 'compress@10': 0.9811, 'time@10': 5.3445}:  20%|██        | 6/30 [00:23<01:48,  4.52s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0463, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8257, 'compress@10': 0.9809, 'time@10': 5.398}:  20%|██        | 6/30 [00:26<01:48,  4.52s/it] {'epoch': 12, 'num_users': 6.2857, 'loss': 0.0463, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8257, 'compress@10': 0.9809, 'time@10': 5.398}:  23%|██▎       | 7/30 [00:26<01:31,  3.99s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0456, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8374, 'compress@10': 0.9806, 'time@10': 5.3814}:  23%|██▎       | 7/30 [00:32<01:31,  3.99s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0456, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8374, 'compress@10': 0.9806, 'time@10': 5.3814}:  27%|██▋       | 8/30 [00:32<01:37,  4.42s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0458, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8482, 'compress@10': 0.9806, 'time@10': 5.8758}:  27%|██▋       | 8/30 [00:37<01:37,  4.42s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0458, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8482, 'compress@10': 0.9806, 'time@10': 5.8758}:  30%|███       | 9/30 [00:37<01:36,  4.58s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0443, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.8524, 'compress@10': 0.9811, 'time@10': 5.9975}:  30%|███       | 9/30 [00:44<01:36,  4.58s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0443, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.8524, 'compress@10': 0.9811, 'time@10': 5.9975}:  33%|███▎      | 10/30 [00:44<01:47,  5.37s/it]{'epoch': 12, 'num_users': 6.6364, 'loss': 0.0452, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8545, 'compress@10': 0.9818, 'time@10': 6.2028}:  33%|███▎      | 10/30 [00:48<01:47,  5.37s/it]{'epoch': 12, 'num_users': 6.6364, 'loss': 0.0452, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8545, 'compress@10': 0.9818, 'time@10': 6.2028}:  37%|███▋      | 11/30 [00:48<01:35,  5.00s/it]{'epoch': 12, 'num_users': 6.4167, 'loss': 0.0425, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8586, 'compress@10': 0.9821, 'time@10': 5.9579}:  37%|███▋      | 11/30 [00:51<01:35,  5.00s/it]{'epoch': 12, 'num_users': 6.4167, 'loss': 0.0425, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8586, 'compress@10': 0.9821, 'time@10': 5.9579}:  40%|████      | 12/30 [00:51<01:20,  4.49s/it]{'epoch': 12, 'num_users': 6.6154, 'loss': 0.0428, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8609, 'compress@10': 0.9826, 'time@10': 6.0334}:  40%|████      | 12/30 [00:55<01:20,  4.49s/it]{'epoch': 12, 'num_users': 6.6154, 'loss': 0.0428, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8609, 'compress@10': 0.9826, 'time@10': 6.0334}:  43%|████▎     | 13/30 [00:55<01:11,  4.19s/it]{'epoch': 12, 'num_users': 6.3571, 'loss': 0.0403, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8573, 'compress@10': 0.9828, 'time@10': 5.731}:  43%|████▎     | 13/30 [00:57<01:11,  4.19s/it] {'epoch': 12, 'num_users': 6.3571, 'loss': 0.0403, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8573, 'compress@10': 0.9828, 'time@10': 5.731}:  47%|████▋     | 14/30 [00:57<00:55,  3.48s/it]{'epoch': 12, 'num_users': 6.2667, 'loss': 0.0416, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8585, 'compress@10': 0.9828, 'time@10': 5.9349}:  47%|████▋     | 14/30 [01:01<00:55,  3.48s/it]{'epoch': 12, 'num_users': 6.2667, 'loss': 0.0416, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8585, 'compress@10': 0.9828, 'time@10': 5.9349}:  50%|█████     | 15/30 [01:01<00:56,  3.77s/it]{'epoch': 12, 'num_users': 6.0625, 'loss': 0.0398, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8597, 'compress@10': 0.9824, 'time@10': 5.7634}:  50%|█████     | 15/30 [01:04<00:56,  3.77s/it]{'epoch': 12, 'num_users': 6.0625, 'loss': 0.0398, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8597, 'compress@10': 0.9824, 'time@10': 5.7634}:  53%|█████▎    | 16/30 [01:04<00:50,  3.61s/it]{'epoch': 12, 'num_users': 5.8235, 'loss': 0.0379, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8544, 'compress@10': 0.983, 'time@10': 5.5762}:  53%|█████▎    | 16/30 [01:06<00:50,  3.61s/it] {'epoch': 12, 'num_users': 5.8235, 'loss': 0.0379, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8544, 'compress@10': 0.983, 'time@10': 5.5762}:  57%|█████▋    | 17/30 [01:06<00:37,  2.92s/it]{'epoch': 12, 'num_users': 6.0556, 'loss': 0.0384, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8553, 'compress@10': 0.9827, 'time@10': 5.4938}:  57%|█████▋    | 17/30 [01:10<00:37,  2.92s/it]{'epoch': 12, 'num_users': 6.0556, 'loss': 0.0384, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8553, 'compress@10': 0.9827, 'time@10': 5.4938}:  60%|██████    | 18/30 [01:10<00:39,  3.29s/it]{'epoch': 12, 'num_users': 6.0, 'loss': 0.0373, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8575, 'compress@10': 0.9831, 'time@10': 5.4297}:  60%|██████    | 18/30 [01:12<00:39,  3.29s/it]   {'epoch': 12, 'num_users': 6.0, 'loss': 0.0373, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8575, 'compress@10': 0.9831, 'time@10': 5.4297}:  63%|██████▎   | 19/30 [01:12<00:32,  2.95s/it]{'epoch': 12, 'num_users': 6.15, 'loss': 0.0377, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8561, 'compress@10': 0.9835, 'time@10': 5.5745}:  63%|██████▎   | 19/30 [01:20<00:32,  2.95s/it]{'epoch': 12, 'num_users': 6.15, 'loss': 0.0377, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8561, 'compress@10': 0.9835, 'time@10': 5.5745}:  67%|██████▋   | 20/30 [01:20<00:46,  4.60s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0391, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8545, 'compress@10': 0.9835, 'time@10': 5.793}:  67%|██████▋   | 20/30 [01:25<00:46,  4.60s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0391, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8545, 'compress@10': 0.9835, 'time@10': 5.793}:  70%|███████   | 21/30 [01:25<00:42,  4.76s/it]{'epoch': 12, 'num_users': 6.1818, 'loss': 0.0397, 'hit_ratio@10': 0.843, 'ndcg@10': 0.856, 'compress@10': 0.9834, 'time@10': 5.706}:  70%|███████   | 21/30 [01:29<00:42,  4.76s/it]  {'epoch': 12, 'num_users': 6.1818, 'loss': 0.0397, 'hit_ratio@10': 0.843, 'ndcg@10': 0.856, 'compress@10': 0.9834, 'time@10': 5.706}:  73%|███████▎  | 22/30 [01:29<00:36,  4.51s/it]{'epoch': 12, 'num_users': 6.1304, 'loss': 0.039, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.858, 'compress@10': 0.9835, 'time@10': 5.7621}:  73%|███████▎  | 22/30 [01:33<00:36,  4.51s/it]{'epoch': 12, 'num_users': 6.1304, 'loss': 0.039, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.858, 'compress@10': 0.9835, 'time@10': 5.7621}:  77%|███████▋  | 23/30 [01:33<00:29,  4.22s/it]{'epoch': 12, 'num_users': 5.9583, 'loss': 0.0384, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8517, 'compress@10': 0.9834, 'time@10': 5.5824}:  77%|███████▋  | 23/30 [01:34<00:29,  4.22s/it]{'epoch': 12, 'num_users': 5.9583, 'loss': 0.0384, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8517, 'compress@10': 0.9834, 'time@10': 5.5824}:  80%|████████  | 24/30 [01:34<00:20,  3.40s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0372, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8425, 'compress@10': 0.9836, 'time@10': 5.417}:  80%|████████  | 24/30 [01:35<00:20,  3.40s/it]    {'epoch': 12, 'num_users': 5.8, 'loss': 0.0372, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8425, 'compress@10': 0.9836, 'time@10': 5.417}:  83%|████████▎ | 25/30 [01:35<00:13,  2.61s/it]{'epoch': 12, 'num_users': 5.8077, 'loss': 0.0377, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8426, 'compress@10': 0.9836, 'time@10': 5.5656}:  83%|████████▎ | 25/30 [01:45<00:13,  2.61s/it]{'epoch': 12, 'num_users': 5.8077, 'loss': 0.0377, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8426, 'compress@10': 0.9836, 'time@10': 5.5656}:  87%|████████▋ | 26/30 [01:45<00:18,  4.62s/it]{'epoch': 12, 'num_users': 5.8889, 'loss': 0.0378, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8435, 'compress@10': 0.9836, 'time@10': 5.6577}:  87%|████████▋ | 26/30 [01:49<00:18,  4.62s/it]{'epoch': 12, 'num_users': 5.8889, 'loss': 0.0378, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8435, 'compress@10': 0.9836, 'time@10': 5.6577}:  90%|█████████ | 27/30 [01:49<00:13,  4.46s/it]{'epoch': 12, 'num_users': 6.0, 'loss': 0.0379, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8445, 'compress@10': 0.9836, 'time@10': 5.7538}:  90%|█████████ | 27/30 [01:57<00:13,  4.46s/it]   {'epoch': 12, 'num_users': 6.0, 'loss': 0.0379, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8445, 'compress@10': 0.9836, 'time@10': 5.7538}:  93%|█████████▎| 28/30 [01:57<00:11,  5.64s/it]{'epoch': 12, 'num_users': 5.8621, 'loss': 0.0376, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8467, 'compress@10': 0.9838, 'time@10': 5.7941}:  93%|█████████▎| 28/30 [02:00<00:11,  5.64s/it]{'epoch': 12, 'num_users': 5.8621, 'loss': 0.0376, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8467, 'compress@10': 0.9838, 'time@10': 5.7941}:  97%|█████████▋| 29/30 [02:00<00:04,  5.00s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0375, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8487, 'compress@10': 0.9839, 'time@10': 5.7989}:  97%|█████████▋| 29/30 [02:06<00:04,  5.00s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0375, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8487, 'compress@10': 0.9839, 'time@10': 5.7989}: 100%|██████████| 30/30 [02:06<00:00,  5.29s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0375, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8487, 'compress@10': 0.9839, 'time@10': 5.7989}: 100%|██████████| 30/30 [02:06<00:00,  4.23s/it]
Epoch: 12
Avg # of users: 5.866666666666666
Avg Loss: 0.037540348044960856
Avg hit ratio: 0.8456348627804748
Avg ndcg: 0.8487169707667506
Avg compression ratio: 0.9838593707987938
Avg train time: 5.798922276496887
Std train time: 2.4662273470816993
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 18, 10, 23, 9, 19, 23, 10, 10, 9, 6, 10, 10, 23, 23, 7, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8586, 'compress@10': 0.9823, 'time@10': 6.4116}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8586, 'compress@10': 0.9823, 'time@10': 6.4116}:   3%|▎         | 1/30 [00:03<01:34,  3.25s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.044, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8699, 'compress@10': 0.9837, 'time@10': 5.8335}:   3%|▎         | 1/30 [00:08<01:34,  3.25s/it]  {'epoch': 13, 'num_users': 7.0, 'loss': 0.044, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8699, 'compress@10': 0.9837, 'time@10': 5.8335}:   7%|▋         | 2/30 [00:08<02:04,  4.45s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8657, 'compress@10': 0.9833, 'time@10': 5.1314}:   7%|▋         | 2/30 [00:10<02:04,  4.45s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8657, 'compress@10': 0.9833, 'time@10': 5.1314}:  10%|█         | 3/30 [00:10<01:28,  3.29s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0347, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8474, 'compress@10': 0.9822, 'time@10': 4.8248}:  10%|█         | 3/30 [00:14<01:28,  3.29s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0347, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8474, 'compress@10': 0.9822, 'time@10': 4.8248}:  13%|█▎        | 4/30 [00:14<01:32,  3.55s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0444, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8323, 'compress@10': 0.9824, 'time@10': 4.9884}:  13%|█▎        | 4/30 [00:17<01:32,  3.55s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0444, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8323, 'compress@10': 0.9824, 'time@10': 4.9884}:  17%|█▋        | 5/30 [00:17<01:22,  3.31s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0449, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8349, 'compress@10': 0.9811, 'time@10': 5.2422}:  17%|█▋        | 5/30 [00:23<01:22,  3.31s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0449, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8349, 'compress@10': 0.9811, 'time@10': 5.2422}:  20%|██        | 6/30 [00:23<01:45,  4.41s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0448, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.843, 'compress@10': 0.9809, 'time@10': 5.4207}:  20%|██        | 6/30 [00:27<01:45,  4.41s/it] {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0448, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.843, 'compress@10': 0.9809, 'time@10': 5.4207}:  23%|██▎       | 7/30 [00:27<01:32,  4.04s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0442, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8532, 'compress@10': 0.9807, 'time@10': 5.4406}:  23%|██▎       | 7/30 [00:32<01:32,  4.04s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0442, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8532, 'compress@10': 0.9807, 'time@10': 5.4406}:  27%|██▋       | 8/30 [00:32<01:39,  4.54s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0434, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8628, 'compress@10': 0.981, 'time@10': 5.7083}:  27%|██▋       | 8/30 [00:36<01:39,  4.54s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0434, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8628, 'compress@10': 0.981, 'time@10': 5.7083}:  30%|███       | 9/30 [00:36<01:31,  4.36s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0428, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8658, 'compress@10': 0.9817, 'time@10': 5.8502}:  30%|███       | 9/30 [00:43<01:31,  4.36s/it]  {'epoch': 13, 'num_users': 6.3, 'loss': 0.0428, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8658, 'compress@10': 0.9817, 'time@10': 5.8502}:  33%|███▎      | 10/30 [00:43<01:44,  5.23s/it]{'epoch': 13, 'num_users': 6.6364, 'loss': 0.045, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8685, 'compress@10': 0.9824, 'time@10': 6.0726}:  33%|███▎      | 10/30 [00:48<01:44,  5.23s/it]{'epoch': 13, 'num_users': 6.6364, 'loss': 0.045, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8685, 'compress@10': 0.9824, 'time@10': 6.0726}:  37%|███▋      | 11/30 [00:48<01:33,  4.91s/it]{'epoch': 13, 'num_users': 6.4167, 'loss': 0.0423, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8715, 'compress@10': 0.9826, 'time@10': 5.8394}:  37%|███▋      | 11/30 [00:51<01:33,  4.91s/it]{'epoch': 13, 'num_users': 6.4167, 'loss': 0.0423, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8715, 'compress@10': 0.9826, 'time@10': 5.8394}:  40%|████      | 12/30 [00:51<01:19,  4.42s/it]{'epoch': 13, 'num_users': 6.6154, 'loss': 0.0424, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.8731, 'compress@10': 0.9832, 'time@10': 5.9256}:  40%|████      | 12/30 [00:54<01:19,  4.42s/it]{'epoch': 13, 'num_users': 6.6154, 'loss': 0.0424, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.8731, 'compress@10': 0.9832, 'time@10': 5.9256}:  43%|████▎     | 13/30 [00:54<01:10,  4.15s/it]{'epoch': 13, 'num_users': 6.3571, 'loss': 0.0399, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8688, 'compress@10': 0.9833, 'time@10': 5.6358}:  43%|████▎     | 13/30 [00:56<01:10,  4.15s/it] {'epoch': 13, 'num_users': 6.3571, 'loss': 0.0399, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8688, 'compress@10': 0.9833, 'time@10': 5.6358}:  47%|████▋     | 14/30 [00:56<00:55,  3.47s/it]{'epoch': 13, 'num_users': 6.2667, 'loss': 0.0411, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8696, 'compress@10': 0.9833, 'time@10': 5.8504}:  47%|████▋     | 14/30 [01:01<00:55,  3.47s/it]{'epoch': 13, 'num_users': 6.2667, 'loss': 0.0411, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8696, 'compress@10': 0.9833, 'time@10': 5.8504}:  50%|█████     | 15/30 [01:01<00:56,  3.77s/it]{'epoch': 13, 'num_users': 6.0625, 'loss': 0.0393, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.871, 'compress@10': 0.9829, 'time@10': 5.6978}:  50%|█████     | 15/30 [01:04<00:56,  3.77s/it] {'epoch': 13, 'num_users': 6.0625, 'loss': 0.0393, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.871, 'compress@10': 0.9829, 'time@10': 5.6978}:  53%|█████▎    | 16/30 [01:04<00:51,  3.68s/it]{'epoch': 13, 'num_users': 5.8235, 'loss': 0.0373, 'hit_ratio@10': 0.833, 'ndcg@10': 0.8651, 'compress@10': 0.9835, 'time@10': 5.5388}:  53%|█████▎    | 16/30 [01:06<00:51,  3.68s/it]{'epoch': 13, 'num_users': 5.8235, 'loss': 0.0373, 'hit_ratio@10': 0.833, 'ndcg@10': 0.8651, 'compress@10': 0.9835, 'time@10': 5.5388}:  57%|█████▋    | 17/30 [01:06<00:39,  3.03s/it]{'epoch': 13, 'num_users': 6.0556, 'loss': 0.0378, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8657, 'compress@10': 0.9833, 'time@10': 5.4808}:  57%|█████▋    | 17/30 [01:10<00:39,  3.03s/it]{'epoch': 13, 'num_users': 6.0556, 'loss': 0.0378, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8657, 'compress@10': 0.9833, 'time@10': 5.4808}:  60%|██████    | 18/30 [01:10<00:41,  3.49s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 0.0367, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8673, 'compress@10': 0.9836, 'time@10': 5.4177}:  60%|██████    | 18/30 [01:12<00:41,  3.49s/it]   {'epoch': 13, 'num_users': 6.0, 'loss': 0.0367, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8673, 'compress@10': 0.9836, 'time@10': 5.4177}:  63%|██████▎   | 19/30 [01:12<00:34,  3.09s/it]{'epoch': 13, 'num_users': 6.15, 'loss': 0.0371, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.866, 'compress@10': 0.984, 'time@10': 5.5658}:  63%|██████▎   | 19/30 [01:21<00:34,  3.09s/it] {'epoch': 13, 'num_users': 6.15, 'loss': 0.0371, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.866, 'compress@10': 0.984, 'time@10': 5.5658}:  67%|██████▋   | 20/30 [01:21<00:46,  4.69s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0384, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8637, 'compress@10': 0.9839, 'time@10': 5.6692}:  67%|██████▋   | 20/30 [01:25<00:46,  4.69s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0384, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8637, 'compress@10': 0.9839, 'time@10': 5.6692}:  70%|███████   | 21/30 [01:25<00:40,  4.46s/it]{'epoch': 13, 'num_users': 6.1818, 'loss': 0.0389, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8649, 'compress@10': 0.9839, 'time@10': 5.5562}:  70%|███████   | 21/30 [01:28<00:40,  4.46s/it]{'epoch': 13, 'num_users': 6.1818, 'loss': 0.0389, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8649, 'compress@10': 0.9839, 'time@10': 5.5562}:  73%|███████▎  | 22/30 [01:28<00:32,  4.09s/it]{'epoch': 13, 'num_users': 6.1304, 'loss': 0.0383, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8667, 'compress@10': 0.984, 'time@10': 5.5777}:  73%|███████▎  | 22/30 [01:31<00:32,  4.09s/it] {'epoch': 13, 'num_users': 6.1304, 'loss': 0.0383, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8667, 'compress@10': 0.984, 'time@10': 5.5777}:  77%|███████▋  | 23/30 [01:31<00:26,  3.78s/it]{'epoch': 13, 'num_users': 5.9583, 'loss': 0.0375, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8607, 'compress@10': 0.9838, 'time@10': 5.4031}:  77%|███████▋  | 23/30 [01:33<00:26,  3.78s/it]{'epoch': 13, 'num_users': 5.9583, 'loss': 0.0375, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8607, 'compress@10': 0.9838, 'time@10': 5.4031}:  80%|████████  | 24/30 [01:33<00:18,  3.07s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0363, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8511, 'compress@10': 0.9841, 'time@10': 5.252}:  80%|████████  | 24/30 [01:33<00:18,  3.07s/it]   {'epoch': 13, 'num_users': 5.8, 'loss': 0.0363, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8511, 'compress@10': 0.9841, 'time@10': 5.252}:  83%|████████▎ | 25/30 [01:33<00:12,  2.41s/it]{'epoch': 13, 'num_users': 5.8077, 'loss': 0.0367, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.851, 'compress@10': 0.984, 'time@10': 5.41}:  83%|████████▎ | 25/30 [01:43<00:12,  2.41s/it]{'epoch': 13, 'num_users': 5.8077, 'loss': 0.0367, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.851, 'compress@10': 0.984, 'time@10': 5.41}:  87%|████████▋ | 26/30 [01:43<00:18,  4.51s/it]{'epoch': 13, 'num_users': 5.8889, 'loss': 0.0367, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8519, 'compress@10': 0.984, 'time@10': 5.5088}:  87%|████████▋ | 26/30 [01:47<00:18,  4.51s/it]{'epoch': 13, 'num_users': 5.8889, 'loss': 0.0367, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8519, 'compress@10': 0.984, 'time@10': 5.5088}:  90%|█████████ | 27/30 [01:47<00:13,  4.38s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 0.0367, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8528, 'compress@10': 0.984, 'time@10': 5.6076}:  90%|█████████ | 27/30 [01:55<00:13,  4.38s/it]   {'epoch': 13, 'num_users': 6.0, 'loss': 0.0367, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8528, 'compress@10': 0.984, 'time@10': 5.6076}:  93%|█████████▎| 28/30 [01:55<00:11,  5.56s/it]{'epoch': 13, 'num_users': 5.8621, 'loss': 0.0363, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8548, 'compress@10': 0.9842, 'time@10': 5.6516}:  93%|█████████▎| 28/30 [01:59<00:11,  5.56s/it]{'epoch': 13, 'num_users': 5.8621, 'loss': 0.0363, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8548, 'compress@10': 0.9842, 'time@10': 5.6516}:  97%|█████████▋| 29/30 [01:59<00:04,  4.94s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0362, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8565, 'compress@10': 0.9842, 'time@10': 5.6612}:  97%|█████████▋| 29/30 [02:05<00:04,  4.94s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0362, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8565, 'compress@10': 0.9842, 'time@10': 5.6612}: 100%|██████████| 30/30 [02:05<00:00,  5.25s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0362, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8565, 'compress@10': 0.9842, 'time@10': 5.6612}: 100%|██████████| 30/30 [02:05<00:00,  4.17s/it]
Epoch: 13
Avg # of users: 5.866666666666666
Avg Loss: 0.036209642384802156
Avg hit ratio: 0.8458060478733543
Avg ndcg: 0.8564546443521958
Avg compression ratio: 0.98422433218718
Avg train time: 5.661200030644735
Std train time: 2.2416961387556174
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 18, 10, 24, 9, 19, 24, 10, 10, 9, 6, 10, 10, 24, 24, 7, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8562, 'compress@10': 0.9819, 'time@10': 6.1948}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8562, 'compress@10': 0.9819, 'time@10': 6.1948}:   3%|▎         | 1/30 [00:03<01:30,  3.13s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0411, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8694, 'compress@10': 0.9835, 'time@10': 5.3403}:   3%|▎         | 1/30 [00:07<01:30,  3.13s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0411, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8694, 'compress@10': 0.9835, 'time@10': 5.3403}:   7%|▋         | 2/30 [00:07<01:50,  3.95s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8653, 'compress@10': 0.9834, 'time@10': 4.6296}:   7%|▋         | 2/30 [00:09<01:50,  3.95s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8653, 'compress@10': 0.9834, 'time@10': 4.6296}:  10%|█         | 3/30 [00:09<01:18,  2.90s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.864, 'compress@10': 0.9826, 'time@10': 4.5861}:  10%|█         | 3/30 [00:13<01:18,  2.90s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.864, 'compress@10': 0.9826, 'time@10': 4.5861}:  13%|█▎        | 4/30 [00:13<01:31,  3.53s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0416, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8461, 'compress@10': 0.9827, 'time@10': 5.0217}:  13%|█▎        | 4/30 [00:17<01:31,  3.53s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0416, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8461, 'compress@10': 0.9827, 'time@10': 5.0217}:  17%|█▋        | 5/30 [00:17<01:27,  3.49s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0425, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8466, 'compress@10': 0.9813, 'time@10': 5.1812}:  17%|█▋        | 5/30 [00:23<01:27,  3.49s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0425, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8466, 'compress@10': 0.9813, 'time@10': 5.1812}:  20%|██        | 6/30 [00:23<01:44,  4.35s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0417, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8458, 'compress@10': 0.981, 'time@10': 5.4597}:  20%|██        | 6/30 [00:26<01:44,  4.35s/it] {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0417, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8458, 'compress@10': 0.981, 'time@10': 5.4597}:  23%|██▎       | 7/30 [00:26<01:34,  4.11s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0413, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8559, 'compress@10': 0.9807, 'time@10': 5.384}:  23%|██▎       | 7/30 [00:31<01:34,  4.11s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0413, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8559, 'compress@10': 0.9807, 'time@10': 5.384}:  27%|██▋       | 8/30 [00:31<01:36,  4.37s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0411, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8652, 'compress@10': 0.9811, 'time@10': 5.8162}:  27%|██▋       | 8/30 [00:36<01:36,  4.37s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0411, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8652, 'compress@10': 0.9811, 'time@10': 5.8162}:  30%|███       | 9/30 [00:36<01:33,  4.46s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0392, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.8701, 'compress@10': 0.9817, 'time@10': 5.9452}:  30%|███       | 9/30 [00:43<01:33,  4.46s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0392, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.8701, 'compress@10': 0.9817, 'time@10': 5.9452}:  33%|███▎      | 10/30 [00:43<01:45,  5.29s/it]{'epoch': 14, 'num_users': 6.6364, 'loss': 0.041, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8711, 'compress@10': 0.9824, 'time@10': 6.1573}:  33%|███▎      | 10/30 [00:47<01:45,  5.29s/it]{'epoch': 14, 'num_users': 6.6364, 'loss': 0.041, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8711, 'compress@10': 0.9824, 'time@10': 6.1573}:  37%|███▋      | 11/30 [00:47<01:34,  4.95s/it]{'epoch': 14, 'num_users': 6.4167, 'loss': 0.0386, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8738, 'compress@10': 0.9826, 'time@10': 5.9148}:  37%|███▋      | 11/30 [00:51<01:34,  4.95s/it]{'epoch': 14, 'num_users': 6.4167, 'loss': 0.0386, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8738, 'compress@10': 0.9826, 'time@10': 5.9148}:  40%|████      | 12/30 [00:51<01:20,  4.45s/it]{'epoch': 14, 'num_users': 6.6154, 'loss': 0.039, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8752, 'compress@10': 0.9831, 'time@10': 5.9969}:  40%|████      | 12/30 [00:54<01:20,  4.45s/it] {'epoch': 14, 'num_users': 6.6154, 'loss': 0.039, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8752, 'compress@10': 0.9831, 'time@10': 5.9969}:  43%|████▎     | 13/30 [00:54<01:10,  4.17s/it]{'epoch': 14, 'num_users': 6.3571, 'loss': 0.0366, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8708, 'compress@10': 0.9833, 'time@10': 5.7108}:  43%|████▎     | 13/30 [00:56<01:10,  4.17s/it]{'epoch': 14, 'num_users': 6.3571, 'loss': 0.0366, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8708, 'compress@10': 0.9833, 'time@10': 5.7108}:  47%|████▋     | 14/30 [00:56<00:56,  3.52s/it]{'epoch': 14, 'num_users': 6.2667, 'loss': 0.038, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8721, 'compress@10': 0.9833, 'time@10': 5.9331}:  47%|████▋     | 14/30 [01:01<00:56,  3.52s/it] {'epoch': 14, 'num_users': 6.2667, 'loss': 0.038, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8721, 'compress@10': 0.9833, 'time@10': 5.9331}:  50%|█████     | 15/30 [01:01<00:57,  3.84s/it]{'epoch': 14, 'num_users': 6.0625, 'loss': 0.0363, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8733, 'compress@10': 0.983, 'time@10': 5.8184}:  50%|█████     | 15/30 [01:05<00:57,  3.84s/it] {'epoch': 14, 'num_users': 6.0625, 'loss': 0.0363, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8733, 'compress@10': 0.983, 'time@10': 5.8184}:  53%|█████▎    | 16/30 [01:05<00:54,  3.93s/it]{'epoch': 14, 'num_users': 5.8235, 'loss': 0.0345, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8672, 'compress@10': 0.9835, 'time@10': 5.66}:  53%|█████▎    | 16/30 [01:06<00:54,  3.93s/it]{'epoch': 14, 'num_users': 5.8235, 'loss': 0.0345, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8672, 'compress@10': 0.9835, 'time@10': 5.66}:  57%|█████▋    | 17/30 [01:06<00:41,  3.23s/it]{'epoch': 14, 'num_users': 6.0556, 'loss': 0.0349, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.868, 'compress@10': 0.9834, 'time@10': 5.595}:  57%|█████▋    | 17/30 [01:11<00:41,  3.23s/it]{'epoch': 14, 'num_users': 6.0556, 'loss': 0.0349, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.868, 'compress@10': 0.9834, 'time@10': 5.595}:  60%|██████    | 18/30 [01:11<00:43,  3.62s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 0.0339, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8699, 'compress@10': 0.9837, 'time@10': 5.5245}:  60%|██████    | 18/30 [01:13<00:43,  3.62s/it] {'epoch': 14, 'num_users': 6.0, 'loss': 0.0339, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8699, 'compress@10': 0.9837, 'time@10': 5.5245}:  63%|██████▎   | 19/30 [01:13<00:35,  3.18s/it]{'epoch': 14, 'num_users': 6.15, 'loss': 0.0343, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8684, 'compress@10': 0.9841, 'time@10': 5.6636}:  63%|██████▎   | 19/30 [01:21<00:35,  3.18s/it]{'epoch': 14, 'num_users': 6.15, 'loss': 0.0343, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8684, 'compress@10': 0.9841, 'time@10': 5.6636}:  67%|██████▋   | 20/30 [01:21<00:47,  4.74s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0359, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8664, 'compress@10': 0.984, 'time@10': 5.766}:  67%|██████▋   | 20/30 [01:25<00:47,  4.74s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0359, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8664, 'compress@10': 0.984, 'time@10': 5.766}:  70%|███████   | 21/30 [01:25<00:40,  4.50s/it]{'epoch': 14, 'num_users': 6.1818, 'loss': 0.0366, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8673, 'compress@10': 0.984, 'time@10': 5.6612}:  70%|███████   | 21/30 [01:29<00:40,  4.50s/it]{'epoch': 14, 'num_users': 6.1818, 'loss': 0.0366, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8673, 'compress@10': 0.984, 'time@10': 5.6612}:  73%|███████▎  | 22/30 [01:29<00:33,  4.20s/it]{'epoch': 14, 'num_users': 6.1304, 'loss': 0.0361, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8689, 'compress@10': 0.984, 'time@10': 5.6839}:  73%|███████▎  | 22/30 [01:32<00:33,  4.20s/it]{'epoch': 14, 'num_users': 6.1304, 'loss': 0.0361, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8689, 'compress@10': 0.984, 'time@10': 5.6839}:  77%|███████▋  | 23/30 [01:32<00:27,  3.88s/it]{'epoch': 14, 'num_users': 5.9583, 'loss': 0.0352, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8637, 'compress@10': 0.9839, 'time@10': 5.5121}:  77%|███████▋  | 23/30 [01:34<00:27,  3.88s/it]{'epoch': 14, 'num_users': 5.9583, 'loss': 0.0352, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8637, 'compress@10': 0.9839, 'time@10': 5.5121}:  80%|████████  | 24/30 [01:34<00:19,  3.20s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0341, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8541, 'compress@10': 0.9841, 'time@10': 5.3552}:  80%|████████  | 24/30 [01:35<00:19,  3.20s/it]    {'epoch': 14, 'num_users': 5.8, 'loss': 0.0341, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8541, 'compress@10': 0.9841, 'time@10': 5.3552}:  83%|████████▎ | 25/30 [01:35<00:12,  2.49s/it]{'epoch': 14, 'num_users': 5.8077, 'loss': 0.0345, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.854, 'compress@10': 0.9841, 'time@10': 5.5086}:  83%|████████▎ | 25/30 [01:44<00:12,  2.49s/it]{'epoch': 14, 'num_users': 5.8077, 'loss': 0.0345, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.854, 'compress@10': 0.9841, 'time@10': 5.5086}:  87%|████████▋ | 26/30 [01:44<00:18,  4.56s/it]{'epoch': 14, 'num_users': 5.8889, 'loss': 0.0344, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8544, 'compress@10': 0.984, 'time@10': 5.6003}:  87%|████████▋ | 26/30 [01:48<00:18,  4.56s/it]{'epoch': 14, 'num_users': 5.8889, 'loss': 0.0344, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8544, 'compress@10': 0.984, 'time@10': 5.6003}:  90%|█████████ | 27/30 [01:48<00:13,  4.40s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 0.0344, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8555, 'compress@10': 0.984, 'time@10': 5.697}:  90%|█████████ | 27/30 [01:56<00:13,  4.40s/it]      {'epoch': 14, 'num_users': 6.0, 'loss': 0.0344, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8555, 'compress@10': 0.984, 'time@10': 5.697}:  93%|█████████▎| 28/30 [01:56<00:11,  5.58s/it]{'epoch': 14, 'num_users': 5.8621, 'loss': 0.0341, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8578, 'compress@10': 0.9842, 'time@10': 5.7376}:  93%|█████████▎| 28/30 [02:00<00:11,  5.58s/it]{'epoch': 14, 'num_users': 5.8621, 'loss': 0.0341, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8578, 'compress@10': 0.9842, 'time@10': 5.7376}:  97%|█████████▋| 29/30 [02:00<00:04,  4.95s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.034, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8594, 'compress@10': 0.9842, 'time@10': 5.7445}:  97%|█████████▋| 29/30 [02:06<00:04,  4.95s/it] {'epoch': 14, 'num_users': 5.8667, 'loss': 0.034, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8594, 'compress@10': 0.9842, 'time@10': 5.7445}: 100%|██████████| 30/30 [02:06<00:00,  5.26s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.034, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8594, 'compress@10': 0.9842, 'time@10': 5.7445}: 100%|██████████| 30/30 [02:06<00:00,  4.21s/it]
Epoch: 14
Avg # of users: 5.866666666666666
Avg Loss: 0.03402332100286181
Avg hit ratio: 0.8413686070060223
Avg ndcg: 0.8594375480589207
Avg compression ratio: 0.9842444565106554
Avg train time: 5.744536503156026
Std train time: 2.290677192155977
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 18, 10, 25, 9, 19, 25, 10, 10, 9, 6, 10, 10, 25, 25, 7, 9, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.867, 'compress@10': 0.9806, 'time@10': 5.9794}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.867, 'compress@10': 0.9806, 'time@10': 5.9794}:   3%|▎         | 1/30 [00:03<01:27,  3.03s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8757, 'compress@10': 0.9828, 'time@10': 5.5179}:   3%|▎         | 1/30 [00:08<01:27,  3.03s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8757, 'compress@10': 0.9828, 'time@10': 5.5179}:   7%|▋         | 2/30 [00:08<01:59,  4.26s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8695, 'compress@10': 0.9831, 'time@10': 4.9231}:   7%|▋         | 2/30 [00:10<01:59,  4.26s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8695, 'compress@10': 0.9831, 'time@10': 4.9231}:  10%|█         | 3/30 [00:10<01:25,  3.18s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8682, 'compress@10': 0.9826, 'time@10': 4.7544}:  10%|█         | 3/30 [00:14<01:25,  3.18s/it]  {'epoch': 15, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8682, 'compress@10': 0.9826, 'time@10': 4.7544}:  13%|█▎        | 4/30 [00:14<01:34,  3.62s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0411, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8498, 'compress@10': 0.9826, 'time@10': 4.9896}:  13%|█▎        | 4/30 [00:17<01:34,  3.62s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0411, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8498, 'compress@10': 0.9826, 'time@10': 4.9896}:  17%|█▋        | 5/30 [00:17<01:25,  3.41s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0415, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8506, 'compress@10': 0.9811, 'time@10': 5.1634}:  17%|█▋        | 5/30 [00:23<01:25,  3.41s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0415, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8506, 'compress@10': 0.9811, 'time@10': 5.1634}:  20%|██        | 6/30 [00:23<01:43,  4.32s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0416, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8569, 'compress@10': 0.981, 'time@10': 5.3563}:  20%|██        | 6/30 [00:26<01:43,  4.32s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0416, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8569, 'compress@10': 0.981, 'time@10': 5.3563}:  23%|██▎       | 7/30 [00:26<01:31,  3.98s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.041, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8653, 'compress@10': 0.9808, 'time@10': 5.2457}:  23%|██▎       | 7/30 [00:31<01:31,  3.98s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.041, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8653, 'compress@10': 0.9808, 'time@10': 5.2457}:  27%|██▋       | 8/30 [00:31<01:31,  4.15s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0413, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8766, 'compress@10': 0.9811, 'time@10': 5.4853}:  27%|██▋       | 8/30 [00:35<01:31,  4.15s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0413, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8766, 'compress@10': 0.9811, 'time@10': 5.4853}:  30%|███       | 9/30 [00:35<01:24,  4.02s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8798, 'compress@10': 0.982, 'time@10': 5.6482}:  30%|███       | 9/30 [00:42<01:24,  4.02s/it]    {'epoch': 15, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8798, 'compress@10': 0.982, 'time@10': 5.6482}:  33%|███▎      | 10/30 [00:42<01:39,  4.99s/it]{'epoch': 15, 'num_users': 6.6364, 'loss': 0.0416, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8794, 'compress@10': 0.9825, 'time@10': 5.895}:  33%|███▎      | 10/30 [00:46<01:39,  4.99s/it]{'epoch': 15, 'num_users': 6.6364, 'loss': 0.0416, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8794, 'compress@10': 0.9825, 'time@10': 5.895}:  37%|███▋      | 11/30 [00:46<01:30,  4.76s/it]{'epoch': 15, 'num_users': 6.4167, 'loss': 0.0391, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8815, 'compress@10': 0.9828, 'time@10': 5.6749}:  37%|███▋      | 11/30 [00:50<01:30,  4.76s/it]{'epoch': 15, 'num_users': 6.4167, 'loss': 0.0391, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8815, 'compress@10': 0.9828, 'time@10': 5.6749}:  40%|████      | 12/30 [00:50<01:19,  4.43s/it]{'epoch': 15, 'num_users': 6.6154, 'loss': 0.0394, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8827, 'compress@10': 0.9833, 'time@10': 5.7803}:  40%|████      | 12/30 [00:53<01:19,  4.43s/it]{'epoch': 15, 'num_users': 6.6154, 'loss': 0.0394, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8827, 'compress@10': 0.9833, 'time@10': 5.7803}:  43%|████▎     | 13/30 [00:53<01:10,  4.16s/it]{'epoch': 15, 'num_users': 6.3571, 'loss': 0.037, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8778, 'compress@10': 0.9835, 'time@10': 5.513}:  43%|████▎     | 13/30 [00:55<01:10,  4.16s/it]  {'epoch': 15, 'num_users': 6.3571, 'loss': 0.037, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8778, 'compress@10': 0.9835, 'time@10': 5.513}:  47%|████▋     | 14/30 [00:55<00:56,  3.53s/it]{'epoch': 15, 'num_users': 6.2667, 'loss': 0.0382, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8791, 'compress@10': 0.9835, 'time@10': 5.7398}:  47%|████▋     | 14/30 [01:00<00:56,  3.53s/it]{'epoch': 15, 'num_users': 6.2667, 'loss': 0.0382, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8791, 'compress@10': 0.9835, 'time@10': 5.7398}:  50%|█████     | 15/30 [01:00<00:57,  3.83s/it]{'epoch': 15, 'num_users': 6.0625, 'loss': 0.0364, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8799, 'compress@10': 0.9832, 'time@10': 5.5962}:  50%|█████     | 15/30 [01:03<00:57,  3.83s/it]{'epoch': 15, 'num_users': 6.0625, 'loss': 0.0364, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8799, 'compress@10': 0.9832, 'time@10': 5.5962}:  53%|█████▎    | 16/30 [01:03<00:52,  3.72s/it]{'epoch': 15, 'num_users': 5.8235, 'loss': 0.0346, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8734, 'compress@10': 0.9838, 'time@10': 5.4598}:  53%|█████▎    | 16/30 [01:05<00:52,  3.72s/it]{'epoch': 15, 'num_users': 5.8235, 'loss': 0.0346, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8734, 'compress@10': 0.9838, 'time@10': 5.4598}:  57%|█████▋    | 17/30 [01:05<00:40,  3.11s/it]{'epoch': 15, 'num_users': 6.0556, 'loss': 0.035, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.8739, 'compress@10': 0.9836, 'time@10': 5.4035}:  57%|█████▋    | 17/30 [01:09<00:40,  3.11s/it] {'epoch': 15, 'num_users': 6.0556, 'loss': 0.035, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.8739, 'compress@10': 0.9836, 'time@10': 5.4035}:  60%|██████    | 18/30 [01:09<00:42,  3.52s/it]{'epoch': 15, 'num_users': 6.0, 'loss': 0.034, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8754, 'compress@10': 0.9839, 'time@10': 5.3433}:  60%|██████    | 18/30 [01:12<00:42,  3.52s/it]   {'epoch': 15, 'num_users': 6.0, 'loss': 0.034, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8754, 'compress@10': 0.9839, 'time@10': 5.3433}:  63%|██████▎   | 19/30 [01:12<00:34,  3.13s/it]{'epoch': 15, 'num_users': 6.15, 'loss': 0.0343, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8739, 'compress@10': 0.9843, 'time@10': 5.4648}:  63%|██████▎   | 19/30 [01:19<00:34,  3.13s/it]{'epoch': 15, 'num_users': 6.15, 'loss': 0.0343, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8739, 'compress@10': 0.9843, 'time@10': 5.4648}:  67%|██████▋   | 20/30 [01:19<00:45,  4.53s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0356, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8717, 'compress@10': 0.9842, 'time@10': 5.5749}:  67%|██████▋   | 20/30 [01:23<00:45,  4.53s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0356, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8717, 'compress@10': 0.9842, 'time@10': 5.5749}:  70%|███████   | 21/30 [01:23<00:39,  4.35s/it]{'epoch': 15, 'num_users': 6.1818, 'loss': 0.0363, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8724, 'compress@10': 0.9841, 'time@10': 5.4779}:  70%|███████   | 21/30 [01:27<00:39,  4.35s/it]{'epoch': 15, 'num_users': 6.1818, 'loss': 0.0363, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8724, 'compress@10': 0.9841, 'time@10': 5.4779}:  73%|███████▎  | 22/30 [01:27<00:32,  4.09s/it]{'epoch': 15, 'num_users': 6.1304, 'loss': 0.0357, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.8741, 'compress@10': 0.9842, 'time@10': 5.511}:  73%|███████▎  | 22/30 [01:30<00:32,  4.09s/it] {'epoch': 15, 'num_users': 6.1304, 'loss': 0.0357, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.8741, 'compress@10': 0.9842, 'time@10': 5.511}:  77%|███████▋  | 23/30 [01:30<00:26,  3.81s/it]{'epoch': 15, 'num_users': 5.9583, 'loss': 0.0348, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8687, 'compress@10': 0.984, 'time@10': 5.3492}:  77%|███████▋  | 23/30 [01:32<00:26,  3.81s/it]{'epoch': 15, 'num_users': 5.9583, 'loss': 0.0348, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8687, 'compress@10': 0.984, 'time@10': 5.3492}:  80%|████████  | 24/30 [01:32<00:19,  3.17s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0337, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8588, 'compress@10': 0.9843, 'time@10': 5.1996}:  80%|████████  | 24/30 [01:32<00:19,  3.17s/it]  {'epoch': 15, 'num_users': 5.8, 'loss': 0.0337, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8588, 'compress@10': 0.9843, 'time@10': 5.1996}:  83%|████████▎ | 25/30 [01:32<00:12,  2.47s/it]{'epoch': 15, 'num_users': 5.8077, 'loss': 0.0341, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8588, 'compress@10': 0.9843, 'time@10': 5.3775}:  83%|████████▎ | 25/30 [01:42<00:12,  2.47s/it]{'epoch': 15, 'num_users': 5.8077, 'loss': 0.0341, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8588, 'compress@10': 0.9843, 'time@10': 5.3775}:  87%|████████▋ | 26/30 [01:42<00:18,  4.70s/it]{'epoch': 15, 'num_users': 5.8889, 'loss': 0.0339, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8597, 'compress@10': 0.9841, 'time@10': 5.5449}:  87%|████████▋ | 26/30 [01:47<00:18,  4.70s/it]{'epoch': 15, 'num_users': 5.8889, 'loss': 0.0339, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8597, 'compress@10': 0.9841, 'time@10': 5.5449}:  90%|█████████ | 27/30 [01:47<00:14,  4.79s/it]{'epoch': 15, 'num_users': 6.0, 'loss': 0.034, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8603, 'compress@10': 0.9841, 'time@10': 5.6442}:  90%|█████████ | 27/30 [01:56<00:14,  4.79s/it]     {'epoch': 15, 'num_users': 6.0, 'loss': 0.034, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8603, 'compress@10': 0.9841, 'time@10': 5.6442}:  93%|█████████▎| 28/30 [01:56<00:11,  5.86s/it]{'epoch': 15, 'num_users': 5.8621, 'loss': 0.0337, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8624, 'compress@10': 0.9843, 'time@10': 5.6877}:  93%|█████████▎| 28/30 [01:59<00:11,  5.86s/it]{'epoch': 15, 'num_users': 5.8621, 'loss': 0.0337, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8624, 'compress@10': 0.9843, 'time@10': 5.6877}:  97%|█████████▋| 29/30 [01:59<00:05,  5.15s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0337, 'hit_ratio@10': 0.854, 'ndcg@10': 0.864, 'compress@10': 0.9844, 'time@10': 5.6959}:  97%|█████████▋| 29/30 [02:05<00:05,  5.15s/it]  {'epoch': 15, 'num_users': 5.8667, 'loss': 0.0337, 'hit_ratio@10': 0.854, 'ndcg@10': 0.864, 'compress@10': 0.9844, 'time@10': 5.6959}: 100%|██████████| 30/30 [02:05<00:00,  5.40s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0337, 'hit_ratio@10': 0.854, 'ndcg@10': 0.864, 'compress@10': 0.9844, 'time@10': 5.6959}: 100%|██████████| 30/30 [02:05<00:00,  4.19s/it]
Epoch: 15
Avg # of users: 5.866666666666666
Avg Loss: 0.03370974220183965
Avg hit ratio: 0.8540196333989841
Avg ndcg: 0.863999655751189
Avg compression ratio: 0.9843634737403467
Avg train time: 5.695874230066935
Std train time: 2.2898269330140453
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 18, 10, 26, 9, 19, 25, 10, 10, 9, 6, 10, 10, 26, 26, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8691, 'compress@10': 0.9797, 'time@10': 5.9866}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8691, 'compress@10': 0.9797, 'time@10': 5.9866}:   3%|▎         | 1/30 [00:03<01:27,  3.03s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8789, 'compress@10': 0.9822, 'time@10': 5.3502}:   3%|▎         | 1/30 [00:07<01:27,  3.03s/it] {'epoch': 16, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8789, 'compress@10': 0.9822, 'time@10': 5.3502}:   7%|▋         | 2/30 [00:07<01:53,  4.05s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8716, 'compress@10': 0.9829, 'time@10': 4.8932}:   7%|▋         | 2/30 [00:09<01:53,  4.05s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8716, 'compress@10': 0.9829, 'time@10': 4.8932}:  10%|█         | 3/30 [00:09<01:24,  3.13s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8691, 'compress@10': 0.9825, 'time@10': 4.8363}:  10%|█         | 3/30 [00:14<01:24,  3.13s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8691, 'compress@10': 0.9825, 'time@10': 4.8363}:  13%|█▎        | 4/30 [00:14<01:37,  3.75s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0407, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.8499, 'compress@10': 0.9825, 'time@10': 5.3428}:  13%|█▎        | 4/30 [00:18<01:37,  3.75s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0407, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.8499, 'compress@10': 0.9825, 'time@10': 5.3428}:  17%|█▋        | 5/30 [00:18<01:33,  3.74s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0411, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.8504, 'compress@10': 0.9811, 'time@10': 5.5102}:  17%|█▋        | 5/30 [00:24<01:33,  3.74s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0411, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.8504, 'compress@10': 0.9811, 'time@10': 5.5102}:  20%|██        | 6/30 [00:24<01:51,  4.64s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0402, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.8491, 'compress@10': 0.9808, 'time@10': 5.5973}:  20%|██        | 6/30 [00:27<01:51,  4.64s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0402, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.8491, 'compress@10': 0.9808, 'time@10': 5.5973}:  23%|██▎       | 7/30 [00:27<01:35,  4.14s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0397, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.8585, 'compress@10': 0.9807, 'time@10': 5.5038}:  23%|██▎       | 7/30 [00:32<01:35,  4.14s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0397, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.8585, 'compress@10': 0.9807, 'time@10': 5.5038}:  27%|██▋       | 8/30 [00:32<01:36,  4.38s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.8764, 'compress@10': 0.981, 'time@10': 5.7694}:  27%|██▋       | 8/30 [00:36<01:36,  4.38s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.8764, 'compress@10': 0.981, 'time@10': 5.7694}:  30%|███       | 9/30 [00:36<01:29,  4.25s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0391, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.8797, 'compress@10': 0.9816, 'time@10': 5.9034}:  30%|███       | 9/30 [00:43<01:29,  4.25s/it]  {'epoch': 16, 'num_users': 6.3, 'loss': 0.0391, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.8797, 'compress@10': 0.9816, 'time@10': 5.9034}:  33%|███▎      | 10/30 [00:43<01:42,  5.15s/it]{'epoch': 16, 'num_users': 6.6364, 'loss': 0.0402, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.8801, 'compress@10': 0.9823, 'time@10': 6.1234}:  33%|███▎      | 10/30 [00:47<01:42,  5.15s/it]{'epoch': 16, 'num_users': 6.6364, 'loss': 0.0402, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.8801, 'compress@10': 0.9823, 'time@10': 6.1234}:  37%|███▋      | 11/30 [00:47<01:32,  4.86s/it]{'epoch': 16, 'num_users': 6.4167, 'loss': 0.0378, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.882, 'compress@10': 0.9825, 'time@10': 5.8855}:  37%|███▋      | 11/30 [00:51<01:32,  4.86s/it] {'epoch': 16, 'num_users': 6.4167, 'loss': 0.0378, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.882, 'compress@10': 0.9825, 'time@10': 5.8855}:  40%|████      | 12/30 [00:51<01:18,  4.39s/it]{'epoch': 16, 'num_users': 6.6154, 'loss': 0.0382, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8832, 'compress@10': 0.9831, 'time@10': 5.9762}:  40%|████      | 12/30 [00:54<01:18,  4.39s/it]{'epoch': 16, 'num_users': 6.6154, 'loss': 0.0382, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8832, 'compress@10': 0.9831, 'time@10': 5.9762}:  43%|████▎     | 13/30 [00:54<01:10,  4.14s/it]{'epoch': 16, 'num_users': 6.3571, 'loss': 0.0359, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8783, 'compress@10': 0.9833, 'time@10': 5.7033}:  43%|████▎     | 13/30 [00:57<01:10,  4.14s/it] {'epoch': 16, 'num_users': 6.3571, 'loss': 0.0359, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8783, 'compress@10': 0.9833, 'time@10': 5.7033}:  47%|████▋     | 14/30 [00:57<00:56,  3.55s/it]{'epoch': 16, 'num_users': 6.2667, 'loss': 0.0369, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.879, 'compress@10': 0.9834, 'time@10': 5.9175}:  47%|████▋     | 14/30 [01:01<00:56,  3.55s/it]{'epoch': 16, 'num_users': 6.2667, 'loss': 0.0369, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.879, 'compress@10': 0.9834, 'time@10': 5.9175}:  50%|█████     | 15/30 [01:01<00:57,  3.84s/it]{'epoch': 16, 'num_users': 6.0625, 'loss': 0.0352, 'hit_ratio@10': 0.866, 'ndcg@10': 0.88, 'compress@10': 0.9831, 'time@10': 5.7615}:  50%|█████     | 15/30 [01:05<00:57,  3.84s/it]  {'epoch': 16, 'num_users': 6.0625, 'loss': 0.0352, 'hit_ratio@10': 0.866, 'ndcg@10': 0.88, 'compress@10': 0.9831, 'time@10': 5.7615}:  53%|█████▎    | 16/30 [01:05<00:52,  3.73s/it]{'epoch': 16, 'num_users': 5.8235, 'loss': 0.0334, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.873, 'compress@10': 0.9837, 'time@10': 5.615}:  53%|█████▎    | 16/30 [01:06<00:52,  3.73s/it]{'epoch': 16, 'num_users': 5.8235, 'loss': 0.0334, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.873, 'compress@10': 0.9837, 'time@10': 5.615}:  57%|█████▋    | 17/30 [01:06<00:40,  3.11s/it]{'epoch': 16, 'num_users': 6.0556, 'loss': 0.0338, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8735, 'compress@10': 0.9836, 'time@10': 5.553}:  57%|█████▋    | 17/30 [01:11<00:40,  3.11s/it]{'epoch': 16, 'num_users': 6.0556, 'loss': 0.0338, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8735, 'compress@10': 0.9836, 'time@10': 5.553}:  60%|██████    | 18/30 [01:11<00:42,  3.54s/it]{'epoch': 16, 'num_users': 6.0, 'loss': 0.0328, 'hit_ratio@10': 0.851, 'ndcg@10': 0.8748, 'compress@10': 0.9838, 'time@10': 5.486}:  60%|██████    | 18/30 [01:13<00:42,  3.54s/it]    {'epoch': 16, 'num_users': 6.0, 'loss': 0.0328, 'hit_ratio@10': 0.851, 'ndcg@10': 0.8748, 'compress@10': 0.9838, 'time@10': 5.486}:  63%|██████▎   | 19/30 [01:13<00:34,  3.13s/it]{'epoch': 16, 'num_users': 6.15, 'loss': 0.0331, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8738, 'compress@10': 0.9842, 'time@10': 5.6285}:  63%|██████▎   | 19/30 [01:21<00:34,  3.13s/it]{'epoch': 16, 'num_users': 6.15, 'loss': 0.0331, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8738, 'compress@10': 0.9842, 'time@10': 5.6285}:  67%|██████▋   | 20/30 [01:21<00:47,  4.71s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0346, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8716, 'compress@10': 0.9841, 'time@10': 5.7341}:  67%|██████▋   | 20/30 [01:25<00:47,  4.71s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0346, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8716, 'compress@10': 0.9841, 'time@10': 5.7341}:  70%|███████   | 21/30 [01:25<00:40,  4.48s/it]{'epoch': 16, 'num_users': 6.1818, 'loss': 0.0353, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8723, 'compress@10': 0.9841, 'time@10': 5.6294}:  70%|███████   | 21/30 [01:29<00:40,  4.48s/it]{'epoch': 16, 'num_users': 6.1818, 'loss': 0.0353, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8723, 'compress@10': 0.9841, 'time@10': 5.6294}:  73%|███████▎  | 22/30 [01:29<00:33,  4.18s/it]{'epoch': 16, 'num_users': 6.1304, 'loss': 0.0348, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8741, 'compress@10': 0.9841, 'time@10': 5.6567}:  73%|███████▎  | 22/30 [01:32<00:33,  4.18s/it]{'epoch': 16, 'num_users': 6.1304, 'loss': 0.0348, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8741, 'compress@10': 0.9841, 'time@10': 5.6567}:  77%|███████▋  | 23/30 [01:32<00:27,  3.88s/it]{'epoch': 16, 'num_users': 5.9583, 'loss': 0.0338, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8686, 'compress@10': 0.984, 'time@10': 5.4905}:  77%|███████▋  | 23/30 [01:34<00:27,  3.88s/it] {'epoch': 16, 'num_users': 5.9583, 'loss': 0.0338, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8686, 'compress@10': 0.984, 'time@10': 5.4905}:  80%|████████  | 24/30 [01:34<00:19,  3.23s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0327, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8588, 'compress@10': 0.9842, 'time@10': 5.3329}:  80%|████████  | 24/30 [01:34<00:19,  3.23s/it]  {'epoch': 16, 'num_users': 5.8, 'loss': 0.0327, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8588, 'compress@10': 0.9842, 'time@10': 5.3329}:  83%|████████▎ | 25/30 [01:34<00:12,  2.50s/it]{'epoch': 16, 'num_users': 5.8077, 'loss': 0.0332, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8585, 'compress@10': 0.9843, 'time@10': 5.4437}:  83%|████████▎ | 25/30 [01:43<00:12,  2.50s/it]{'epoch': 16, 'num_users': 5.8077, 'loss': 0.0332, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8585, 'compress@10': 0.9843, 'time@10': 5.4437}:  87%|████████▋ | 26/30 [01:43<00:16,  4.23s/it]{'epoch': 16, 'num_users': 5.8889, 'loss': 0.0331, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8608, 'compress@10': 0.9842, 'time@10': 5.4957}:  87%|████████▋ | 26/30 [01:46<00:16,  4.23s/it]{'epoch': 16, 'num_users': 5.8889, 'loss': 0.0331, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8608, 'compress@10': 0.9842, 'time@10': 5.4957}:  90%|█████████ | 27/30 [01:46<00:11,  4.00s/it]{'epoch': 16, 'num_users': 6.0, 'loss': 0.0332, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8616, 'compress@10': 0.9842, 'time@10': 5.5939}:  90%|█████████ | 27/30 [01:54<00:11,  4.00s/it]   {'epoch': 16, 'num_users': 6.0, 'loss': 0.0332, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8616, 'compress@10': 0.9842, 'time@10': 5.5939}:  93%|█████████▎| 28/30 [01:54<00:10,  5.29s/it]{'epoch': 16, 'num_users': 5.8621, 'loss': 0.0329, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8633, 'compress@10': 0.9844, 'time@10': 5.6376}:  93%|█████████▎| 28/30 [01:58<00:10,  5.29s/it]{'epoch': 16, 'num_users': 5.8621, 'loss': 0.0329, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8633, 'compress@10': 0.9844, 'time@10': 5.6376}:  97%|█████████▋| 29/30 [01:58<00:04,  4.74s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0329, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8649, 'compress@10': 0.9845, 'time@10': 5.6471}:  97%|█████████▋| 29/30 [02:04<00:04,  4.74s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0329, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8649, 'compress@10': 0.9845, 'time@10': 5.6471}: 100%|██████████| 30/30 [02:04<00:00,  5.11s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0329, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8649, 'compress@10': 0.9845, 'time@10': 5.6471}: 100%|██████████| 30/30 [02:04<00:00,  4.15s/it]
Epoch: 16
Avg # of users: 5.866666666666666
Avg Loss: 0.03291703921853244
Avg hit ratio: 0.8572339777718649
Avg ndcg: 0.8648634885066028
Avg compression ratio: 0.984452536987711
Avg train time: 5.64706871509552
Std train time: 2.113666693596474
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 18, 10, 27, 9, 19, 25, 10, 10, 9, 6, 10, 10, 27, 27, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8758, 'compress@10': 0.9797, 'time@10': 5.9198}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8758, 'compress@10': 0.9797, 'time@10': 5.9198}:   3%|▎         | 1/30 [00:03<01:27,  3.00s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8826, 'compress@10': 0.9821, 'time@10': 5.4346}:   3%|▎         | 1/30 [00:07<01:27,  3.00s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8826, 'compress@10': 0.9821, 'time@10': 5.4346}:   7%|▋         | 2/30 [00:07<01:56,  4.17s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8741, 'compress@10': 0.983, 'time@10': 4.6953}:   7%|▋         | 2/30 [00:09<01:56,  4.17s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8741, 'compress@10': 0.983, 'time@10': 4.6953}:  10%|█         | 3/30 [00:09<01:21,  3.02s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.875, 'compress@10': 0.9827, 'time@10': 4.459}:  10%|█         | 3/30 [00:13<01:21,  3.02s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.875, 'compress@10': 0.9827, 'time@10': 4.459}:  13%|█▎        | 4/30 [00:13<01:26,  3.33s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0394, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8556, 'compress@10': 0.9826, 'time@10': 5.1232}:  13%|█▎        | 4/30 [00:17<01:26,  3.33s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0394, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8556, 'compress@10': 0.9826, 'time@10': 5.1232}:  17%|█▋        | 5/30 [00:17<01:28,  3.54s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0399, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.8563, 'compress@10': 0.9813, 'time@10': 5.2413}:  17%|█▋        | 5/30 [00:23<01:28,  3.54s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0399, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.8563, 'compress@10': 0.9813, 'time@10': 5.2413}:  20%|██        | 6/30 [00:23<01:44,  4.33s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0396, 'hit_ratio@10': 0.904, 'ndcg@10': 0.8618, 'compress@10': 0.9812, 'time@10': 5.3684}:  20%|██        | 6/30 [00:26<01:44,  4.33s/it] {'epoch': 17, 'num_users': 6.2857, 'loss': 0.0396, 'hit_ratio@10': 0.904, 'ndcg@10': 0.8618, 'compress@10': 0.9812, 'time@10': 5.3684}:  23%|██▎       | 7/30 [00:26<01:30,  3.95s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.039, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.8699, 'compress@10': 0.981, 'time@10': 5.2864}:  23%|██▎       | 7/30 [00:31<01:30,  3.95s/it]  {'epoch': 17, 'num_users': 6.125, 'loss': 0.039, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.8699, 'compress@10': 0.981, 'time@10': 5.2864}:  27%|██▋       | 8/30 [00:31<01:32,  4.20s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0396, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.8862, 'compress@10': 0.9813, 'time@10': 5.3555}:  27%|██▋       | 8/30 [00:34<01:32,  4.20s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0396, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.8862, 'compress@10': 0.9813, 'time@10': 5.3555}:  30%|███       | 9/30 [00:34<01:20,  3.82s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0391, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8882, 'compress@10': 0.9821, 'time@10': 5.5002}:  30%|███       | 9/30 [00:40<01:20,  3.82s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0391, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8882, 'compress@10': 0.9821, 'time@10': 5.5002}:  33%|███▎      | 10/30 [00:40<01:35,  4.76s/it]{'epoch': 17, 'num_users': 6.6364, 'loss': 0.0407, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.8884, 'compress@10': 0.9827, 'time@10': 5.7723}:  33%|███▎      | 10/30 [00:45<01:35,  4.76s/it]{'epoch': 17, 'num_users': 6.6364, 'loss': 0.0407, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.8884, 'compress@10': 0.9827, 'time@10': 5.7723}:  37%|███▋      | 11/30 [00:45<01:27,  4.61s/it]{'epoch': 17, 'num_users': 6.4167, 'loss': 0.0382, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8897, 'compress@10': 0.983, 'time@10': 5.5741}:  37%|███▋      | 11/30 [00:48<01:27,  4.61s/it]  {'epoch': 17, 'num_users': 6.4167, 'loss': 0.0382, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8897, 'compress@10': 0.983, 'time@10': 5.5741}:  40%|████      | 12/30 [00:48<01:16,  4.25s/it]{'epoch': 17, 'num_users': 6.6154, 'loss': 0.0384, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8903, 'compress@10': 0.9836, 'time@10': 5.7319}:  40%|████      | 12/30 [00:52<01:16,  4.25s/it]{'epoch': 17, 'num_users': 6.6154, 'loss': 0.0384, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8903, 'compress@10': 0.9836, 'time@10': 5.7319}:  43%|████▎     | 13/30 [00:52<01:10,  4.13s/it]{'epoch': 17, 'num_users': 6.3571, 'loss': 0.0361, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8848, 'compress@10': 0.9838, 'time@10': 5.4718}:  43%|████▎     | 13/30 [00:54<01:10,  4.13s/it]{'epoch': 17, 'num_users': 6.3571, 'loss': 0.0361, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8848, 'compress@10': 0.9838, 'time@10': 5.4718}:  47%|████▋     | 14/30 [00:54<00:56,  3.53s/it]{'epoch': 17, 'num_users': 6.2667, 'loss': 0.0371, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8853, 'compress@10': 0.9838, 'time@10': 5.7006}:  47%|████▋     | 14/30 [00:59<00:56,  3.53s/it]{'epoch': 17, 'num_users': 6.2667, 'loss': 0.0371, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8853, 'compress@10': 0.9838, 'time@10': 5.7006}:  50%|█████     | 15/30 [00:59<00:57,  3.82s/it]{'epoch': 17, 'num_users': 6.0625, 'loss': 0.0353, 'hit_ratio@10': 0.866, 'ndcg@10': 0.8863, 'compress@10': 0.9836, 'time@10': 5.5577}:  50%|█████     | 15/30 [01:02<00:57,  3.82s/it] {'epoch': 17, 'num_users': 6.0625, 'loss': 0.0353, 'hit_ratio@10': 0.866, 'ndcg@10': 0.8863, 'compress@10': 0.9836, 'time@10': 5.5577}:  53%|█████▎    | 16/30 [01:02<00:51,  3.71s/it]{'epoch': 17, 'num_users': 5.8235, 'loss': 0.0335, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8789, 'compress@10': 0.9841, 'time@10': 5.4224}:  53%|█████▎    | 16/30 [01:04<00:51,  3.71s/it]{'epoch': 17, 'num_users': 5.8235, 'loss': 0.0335, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8789, 'compress@10': 0.9841, 'time@10': 5.4224}:  57%|█████▋    | 17/30 [01:04<00:40,  3.10s/it]{'epoch': 17, 'num_users': 6.0556, 'loss': 0.0338, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8792, 'compress@10': 0.984, 'time@10': 5.3675}:  57%|█████▋    | 17/30 [01:08<00:40,  3.10s/it] {'epoch': 17, 'num_users': 6.0556, 'loss': 0.0338, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8792, 'compress@10': 0.984, 'time@10': 5.3675}:  60%|██████    | 18/30 [01:08<00:42,  3.51s/it]{'epoch': 17, 'num_users': 6.0, 'loss': 0.0328, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8805, 'compress@10': 0.9842, 'time@10': 5.3108}:  60%|██████    | 18/30 [01:10<00:42,  3.51s/it]   {'epoch': 17, 'num_users': 6.0, 'loss': 0.0328, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8805, 'compress@10': 0.9842, 'time@10': 5.3108}:  63%|██████▎   | 19/30 [01:10<00:34,  3.11s/it]{'epoch': 17, 'num_users': 6.15, 'loss': 0.033, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8794, 'compress@10': 0.9846, 'time@10': 5.4637}:  63%|██████▎   | 19/30 [01:19<00:34,  3.11s/it]{'epoch': 17, 'num_users': 6.15, 'loss': 0.033, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8794, 'compress@10': 0.9846, 'time@10': 5.4637}:  67%|██████▋   | 20/30 [01:19<00:47,  4.70s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0344, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.877, 'compress@10': 0.9845, 'time@10': 5.572}:  67%|██████▋   | 20/30 [01:23<00:47,  4.70s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0344, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.877, 'compress@10': 0.9845, 'time@10': 5.572}:  70%|███████   | 21/30 [01:23<00:40,  4.46s/it]{'epoch': 17, 'num_users': 6.1818, 'loss': 0.0351, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8776, 'compress@10': 0.9845, 'time@10': 5.4746}:  70%|███████   | 21/30 [01:26<00:40,  4.46s/it]{'epoch': 17, 'num_users': 6.1818, 'loss': 0.0351, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8776, 'compress@10': 0.9845, 'time@10': 5.4746}:  73%|███████▎  | 22/30 [01:26<00:33,  4.17s/it]{'epoch': 17, 'num_users': 6.1304, 'loss': 0.0346, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8795, 'compress@10': 0.9845, 'time@10': 5.5126}:  73%|███████▎  | 22/30 [01:29<00:33,  4.17s/it]{'epoch': 17, 'num_users': 6.1304, 'loss': 0.0346, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8795, 'compress@10': 0.9845, 'time@10': 5.5126}:  77%|███████▋  | 23/30 [01:29<00:27,  3.88s/it]{'epoch': 17, 'num_users': 5.9583, 'loss': 0.0336, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8738, 'compress@10': 0.9844, 'time@10': 5.3651}:  77%|███████▋  | 23/30 [01:31<00:27,  3.88s/it]{'epoch': 17, 'num_users': 5.9583, 'loss': 0.0336, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8738, 'compress@10': 0.9844, 'time@10': 5.3651}:  80%|████████  | 24/30 [01:31<00:19,  3.32s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0324, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8637, 'compress@10': 0.9846, 'time@10': 5.2212}:  80%|████████  | 24/30 [01:32<00:19,  3.32s/it]   {'epoch': 17, 'num_users': 5.8, 'loss': 0.0324, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8637, 'compress@10': 0.9846, 'time@10': 5.2212}:  83%|████████▎ | 25/30 [01:32<00:13,  2.60s/it]{'epoch': 17, 'num_users': 5.8077, 'loss': 0.0328, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8634, 'compress@10': 0.9846, 'time@10': 5.3268}:  83%|████████▎ | 25/30 [01:40<00:13,  2.60s/it]{'epoch': 17, 'num_users': 5.8077, 'loss': 0.0328, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8634, 'compress@10': 0.9846, 'time@10': 5.3268}:  87%|████████▋ | 26/30 [01:40<00:16,  4.23s/it]{'epoch': 17, 'num_users': 5.8889, 'loss': 0.0325, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.8648, 'compress@10': 0.9846, 'time@10': 5.3929}:  87%|████████▋ | 26/30 [01:44<00:16,  4.23s/it]{'epoch': 17, 'num_users': 5.8889, 'loss': 0.0325, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.8648, 'compress@10': 0.9846, 'time@10': 5.3929}:  90%|█████████ | 27/30 [01:44<00:12,  4.04s/it]{'epoch': 17, 'num_users': 6.0, 'loss': 0.0323, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.866, 'compress@10': 0.9846, 'time@10': 5.4961}:  90%|█████████ | 27/30 [01:52<00:12,  4.04s/it]    {'epoch': 17, 'num_users': 6.0, 'loss': 0.0323, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.866, 'compress@10': 0.9846, 'time@10': 5.4961}:  93%|█████████▎| 28/30 [01:52<00:10,  5.32s/it]{'epoch': 17, 'num_users': 5.8621, 'loss': 0.0319, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8681, 'compress@10': 0.9848, 'time@10': 5.5436}:  93%|█████████▎| 28/30 [01:56<00:10,  5.32s/it]{'epoch': 17, 'num_users': 5.8621, 'loss': 0.0319, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8681, 'compress@10': 0.9848, 'time@10': 5.5436}:  97%|█████████▋| 29/30 [01:56<00:04,  4.77s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.032, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8696, 'compress@10': 0.9848, 'time@10': 5.5561}:  97%|█████████▋| 29/30 [02:02<00:04,  4.77s/it] {'epoch': 17, 'num_users': 5.8667, 'loss': 0.032, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8696, 'compress@10': 0.9848, 'time@10': 5.5561}: 100%|██████████| 30/30 [02:02<00:00,  5.13s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.032, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8696, 'compress@10': 0.9848, 'time@10': 5.5561}: 100%|██████████| 30/30 [02:02<00:00,  4.08s/it]
Epoch: 17
Avg # of users: 5.866666666666666
Avg Loss: 0.03198308159812909
Avg hit ratio: 0.8625351691776779
Avg ndcg: 0.86962587672909
Avg compression ratio: 0.9848053968433929
Avg train time: 5.556107306480408
Std train time: 2.1060257407296588
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 18, 10, 28, 9, 19, 25, 10, 10, 9, 6, 10, 10, 28, 28, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8758, 'compress@10': 0.9801, 'time@10': 6.0913}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8758, 'compress@10': 0.9801, 'time@10': 6.0913}:   3%|▎         | 1/30 [00:03<01:29,  3.08s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0359, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8826, 'compress@10': 0.9822, 'time@10': 5.5299}:   3%|▎         | 1/30 [00:08<01:29,  3.08s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0359, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8826, 'compress@10': 0.9822, 'time@10': 5.5299}:   7%|▋         | 2/30 [00:08<01:58,  4.22s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8741, 'compress@10': 0.9832, 'time@10': 4.9111}:   7%|▋         | 2/30 [00:09<01:58,  4.22s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8741, 'compress@10': 0.9832, 'time@10': 4.9111}:  10%|█         | 3/30 [00:09<01:25,  3.15s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8778, 'compress@10': 0.9829, 'time@10': 4.8303}:  10%|█         | 3/30 [00:14<01:25,  3.15s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8778, 'compress@10': 0.9829, 'time@10': 4.8303}:  13%|█▎        | 4/30 [00:14<01:37,  3.74s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0374, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8579, 'compress@10': 0.9827, 'time@10': 5.4594}:  13%|█▎        | 4/30 [00:18<01:37,  3.74s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0374, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8579, 'compress@10': 0.9827, 'time@10': 5.4594}:  17%|█▋        | 5/30 [00:18<01:36,  3.84s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0375, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.8585, 'compress@10': 0.9816, 'time@10': 5.619}:  17%|█▋        | 5/30 [00:25<01:36,  3.84s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0375, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.8585, 'compress@10': 0.9816, 'time@10': 5.619}:  20%|██        | 6/30 [00:25<01:53,  4.73s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0368, 'hit_ratio@10': 0.904, 'ndcg@10': 0.8579, 'compress@10': 0.9814, 'time@10': 5.8406}:  20%|██        | 6/30 [00:28<01:53,  4.73s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0368, 'hit_ratio@10': 0.904, 'ndcg@10': 0.8579, 'compress@10': 0.9814, 'time@10': 5.8406}:  23%|██▎       | 7/30 [00:28<01:40,  4.37s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0364, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.8666, 'compress@10': 0.9812, 'time@10': 5.6801}:  23%|██▎       | 7/30 [00:33<01:40,  4.37s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0364, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.8666, 'compress@10': 0.9812, 'time@10': 5.6801}:  27%|██▋       | 8/30 [00:33<01:37,  4.44s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0367, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.8759, 'compress@10': 0.9814, 'time@10': 5.8089}:  27%|██▋       | 8/30 [00:36<01:37,  4.44s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0367, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.8759, 'compress@10': 0.9814, 'time@10': 5.8089}:  30%|███       | 9/30 [00:36<01:26,  4.13s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0348, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.8809, 'compress@10': 0.9819, 'time@10': 5.798}:  30%|███       | 9/30 [00:42<01:26,  4.13s/it]    {'epoch': 18, 'num_users': 6.3, 'loss': 0.0348, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.8809, 'compress@10': 0.9819, 'time@10': 5.798}:  33%|███▎      | 10/30 [00:42<01:32,  4.63s/it]{'epoch': 18, 'num_users': 6.6364, 'loss': 0.0362, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.8811, 'compress@10': 0.9826, 'time@10': 6.0051}:  33%|███▎      | 10/30 [00:46<01:32,  4.63s/it]{'epoch': 18, 'num_users': 6.6364, 'loss': 0.0362, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.8811, 'compress@10': 0.9826, 'time@10': 6.0051}:  37%|███▋      | 11/30 [00:46<01:24,  4.46s/it]{'epoch': 18, 'num_users': 6.4167, 'loss': 0.0341, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.883, 'compress@10': 0.9828, 'time@10': 5.7758}:  37%|███▋      | 11/30 [00:49<01:24,  4.46s/it] {'epoch': 18, 'num_users': 6.4167, 'loss': 0.0341, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.883, 'compress@10': 0.9828, 'time@10': 5.7758}:  40%|████      | 12/30 [00:49<01:13,  4.11s/it]{'epoch': 18, 'num_users': 6.6154, 'loss': 0.0346, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8842, 'compress@10': 0.9834, 'time@10': 5.8455}:  40%|████      | 12/30 [00:53<01:13,  4.11s/it]{'epoch': 18, 'num_users': 6.6154, 'loss': 0.0346, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8842, 'compress@10': 0.9834, 'time@10': 5.8455}:  43%|████▎     | 13/30 [00:53<01:06,  3.89s/it]{'epoch': 18, 'num_users': 6.3571, 'loss': 0.0325, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8792, 'compress@10': 0.9836, 'time@10': 5.5842}:  43%|████▎     | 13/30 [00:55<01:06,  3.89s/it]{'epoch': 18, 'num_users': 6.3571, 'loss': 0.0325, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8792, 'compress@10': 0.9836, 'time@10': 5.5842}:  47%|████▋     | 14/30 [00:55<00:54,  3.39s/it]{'epoch': 18, 'num_users': 6.2667, 'loss': 0.0337, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8797, 'compress@10': 0.9837, 'time@10': 5.8038}:  47%|████▋     | 14/30 [00:59<00:54,  3.39s/it]{'epoch': 18, 'num_users': 6.2667, 'loss': 0.0337, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8797, 'compress@10': 0.9837, 'time@10': 5.8038}:  50%|█████     | 15/30 [00:59<00:55,  3.72s/it]{'epoch': 18, 'num_users': 6.0625, 'loss': 0.0321, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8811, 'compress@10': 0.9835, 'time@10': 5.6558}:  50%|█████     | 15/30 [01:03<00:55,  3.72s/it] {'epoch': 18, 'num_users': 6.0625, 'loss': 0.0321, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8811, 'compress@10': 0.9835, 'time@10': 5.6558}:  53%|█████▎    | 16/30 [01:03<00:51,  3.64s/it]{'epoch': 18, 'num_users': 5.8235, 'loss': 0.0305, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8739, 'compress@10': 0.9841, 'time@10': 5.5155}:  53%|█████▎    | 16/30 [01:05<00:51,  3.64s/it]{'epoch': 18, 'num_users': 5.8235, 'loss': 0.0305, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8739, 'compress@10': 0.9841, 'time@10': 5.5155}:  57%|█████▋    | 17/30 [01:05<00:39,  3.05s/it]{'epoch': 18, 'num_users': 6.0556, 'loss': 0.0309, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8746, 'compress@10': 0.984, 'time@10': 5.4592}:  57%|█████▋    | 17/30 [01:09<00:39,  3.05s/it] {'epoch': 18, 'num_users': 6.0556, 'loss': 0.0309, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8746, 'compress@10': 0.984, 'time@10': 5.4592}:  60%|██████    | 18/30 [01:09<00:42,  3.50s/it]{'epoch': 18, 'num_users': 6.0, 'loss': 0.0301, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8759, 'compress@10': 0.9841, 'time@10': 5.3974}:  60%|██████    | 18/30 [01:11<00:42,  3.50s/it]  {'epoch': 18, 'num_users': 6.0, 'loss': 0.0301, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8759, 'compress@10': 0.9841, 'time@10': 5.3974}:  63%|██████▎   | 19/30 [01:11<00:34,  3.10s/it]{'epoch': 18, 'num_users': 6.15, 'loss': 0.0303, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8757, 'compress@10': 0.9846, 'time@10': 5.5461}:  63%|██████▎   | 19/30 [01:20<00:34,  3.10s/it]{'epoch': 18, 'num_users': 6.15, 'loss': 0.0303, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8757, 'compress@10': 0.9846, 'time@10': 5.5461}:  67%|██████▋   | 20/30 [01:20<00:46,  4.70s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0319, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8733, 'compress@10': 0.9845, 'time@10': 5.6444}:  67%|██████▋   | 20/30 [01:24<00:46,  4.70s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0319, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8733, 'compress@10': 0.9845, 'time@10': 5.6444}:  70%|███████   | 21/30 [01:24<00:39,  4.44s/it]{'epoch': 18, 'num_users': 6.1818, 'loss': 0.0327, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8743, 'compress@10': 0.9844, 'time@10': 5.5326}:  70%|███████   | 21/30 [01:27<00:39,  4.44s/it]{'epoch': 18, 'num_users': 6.1818, 'loss': 0.0327, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8743, 'compress@10': 0.9844, 'time@10': 5.5326}:  73%|███████▎  | 22/30 [01:27<00:32,  4.08s/it]{'epoch': 18, 'num_users': 6.1304, 'loss': 0.0322, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8765, 'compress@10': 0.9844, 'time@10': 5.5547}:  73%|███████▎  | 22/30 [01:30<00:32,  4.08s/it]{'epoch': 18, 'num_users': 6.1304, 'loss': 0.0322, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8765, 'compress@10': 0.9844, 'time@10': 5.5547}:  77%|███████▋  | 23/30 [01:30<00:26,  3.77s/it]{'epoch': 18, 'num_users': 5.9583, 'loss': 0.0313, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8709, 'compress@10': 0.9843, 'time@10': 5.3965}:  77%|███████▋  | 23/30 [01:32<00:26,  3.77s/it]{'epoch': 18, 'num_users': 5.9583, 'loss': 0.0313, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8709, 'compress@10': 0.9843, 'time@10': 5.3965}:  80%|████████  | 24/30 [01:32<00:19,  3.18s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0302, 'hit_ratio@10': 0.85, 'ndcg@10': 0.861, 'compress@10': 0.9846, 'time@10': 5.2527}:  80%|████████  | 24/30 [01:33<00:19,  3.18s/it]      {'epoch': 18, 'num_users': 5.8, 'loss': 0.0302, 'hit_ratio@10': 0.85, 'ndcg@10': 0.861, 'compress@10': 0.9846, 'time@10': 5.2527}:  83%|████████▎ | 25/30 [01:33<00:12,  2.51s/it]{'epoch': 18, 'num_users': 5.8077, 'loss': 0.0306, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8609, 'compress@10': 0.9846, 'time@10': 5.3462}:  83%|████████▎ | 25/30 [01:40<00:12,  2.51s/it]{'epoch': 18, 'num_users': 5.8077, 'loss': 0.0306, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8609, 'compress@10': 0.9846, 'time@10': 5.3462}:  87%|████████▋ | 26/30 [01:40<00:16,  4.07s/it]{'epoch': 18, 'num_users': 5.8889, 'loss': 0.0303, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8627, 'compress@10': 0.9846, 'time@10': 5.4118}:  87%|████████▋ | 26/30 [01:44<00:16,  4.07s/it] {'epoch': 18, 'num_users': 5.8889, 'loss': 0.0303, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8627, 'compress@10': 0.9846, 'time@10': 5.4118}:  90%|█████████ | 27/30 [01:44<00:11,  3.93s/it]{'epoch': 18, 'num_users': 6.0, 'loss': 0.0304, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8637, 'compress@10': 0.9846, 'time@10': 5.514}:  90%|█████████ | 27/30 [01:52<00:11,  3.93s/it]   {'epoch': 18, 'num_users': 6.0, 'loss': 0.0304, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8637, 'compress@10': 0.9846, 'time@10': 5.514}:  93%|█████████▎| 28/30 [01:52<00:10,  5.25s/it]{'epoch': 18, 'num_users': 5.8621, 'loss': 0.0301, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8659, 'compress@10': 0.9847, 'time@10': 5.561}:  93%|█████████▎| 28/30 [01:56<00:10,  5.25s/it]{'epoch': 18, 'num_users': 5.8621, 'loss': 0.0301, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8659, 'compress@10': 0.9847, 'time@10': 5.561}:  97%|█████████▋| 29/30 [01:56<00:04,  4.72s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0301, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8673, 'compress@10': 0.9847, 'time@10': 5.5953}:  97%|█████████▋| 29/30 [02:02<00:04,  4.72s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0301, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8673, 'compress@10': 0.9847, 'time@10': 5.5953}: 100%|██████████| 30/30 [02:02<00:00,  5.29s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0301, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8673, 'compress@10': 0.9847, 'time@10': 5.5953}: 100%|██████████| 30/30 [02:02<00:00,  4.10s/it]
Epoch: 18
Avg # of users: 5.866666666666666
Avg Loss: 0.030104134770023203
Avg hit ratio: 0.8646593935387443
Avg ndcg: 0.8673316806021983
Avg compression ratio: 0.9847404689239126
Avg train time: 5.595250391960144
Std train time: 2.0687250370072765
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 18, 10, 29, 9, 19, 25, 10, 10, 9, 6, 10, 10, 29, 29, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8758, 'compress@10': 0.9804, 'time@10': 6.2067}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8758, 'compress@10': 0.9804, 'time@10': 6.2067}:   3%|▎         | 1/30 [00:03<01:31,  3.15s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0351, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8826, 'compress@10': 0.9823, 'time@10': 5.6095}:   3%|▎         | 1/30 [00:08<01:31,  3.15s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0351, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8826, 'compress@10': 0.9823, 'time@10': 5.6095}:   7%|▋         | 2/30 [00:08<01:59,  4.27s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8741, 'compress@10': 0.9833, 'time@10': 5.0005}:   7%|▋         | 2/30 [00:10<01:59,  4.27s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8741, 'compress@10': 0.9833, 'time@10': 5.0005}:  10%|█         | 3/30 [00:10<01:26,  3.21s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8782, 'compress@10': 0.9831, 'time@10': 4.9028}:  10%|█         | 3/30 [00:14<01:26,  3.21s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8782, 'compress@10': 0.9831, 'time@10': 4.9028}:  13%|█▎        | 4/30 [00:14<01:38,  3.78s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0361, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.8592, 'compress@10': 0.9829, 'time@10': 5.5228}:  13%|█▎        | 4/30 [00:18<01:38,  3.78s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0361, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.8592, 'compress@10': 0.9829, 'time@10': 5.5228}:  17%|█▋        | 5/30 [00:18<01:36,  3.87s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0366, 'hit_ratio@10': 0.888, 'ndcg@10': 0.8612, 'compress@10': 0.9817, 'time@10': 5.8195}:  17%|█▋        | 5/30 [00:26<01:36,  3.87s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0366, 'hit_ratio@10': 0.888, 'ndcg@10': 0.8612, 'compress@10': 0.9817, 'time@10': 5.8195}:  20%|██        | 6/30 [00:26<02:01,  5.05s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0368, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.8656, 'compress@10': 0.9817, 'time@10': 6.0661}:  20%|██        | 6/30 [00:30<02:01,  5.05s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0368, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.8656, 'compress@10': 0.9817, 'time@10': 6.0661}:  23%|██▎       | 7/30 [00:30<01:47,  4.65s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0362, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.8734, 'compress@10': 0.9815, 'time@10': 5.8817}:  23%|██▎       | 7/30 [00:34<01:47,  4.65s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0362, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.8734, 'compress@10': 0.9815, 'time@10': 5.8817}:  27%|██▋       | 8/30 [00:34<01:42,  4.65s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.037, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.8887, 'compress@10': 0.9816, 'time@10': 6.0531}:  27%|██▋       | 8/30 [00:38<01:42,  4.65s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.037, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.8887, 'compress@10': 0.9816, 'time@10': 6.0531}:  30%|███       | 9/30 [00:38<01:31,  4.37s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0372, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.8918, 'compress@10': 0.9824, 'time@10': 6.0556}:  30%|███       | 9/30 [00:44<01:31,  4.37s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 0.0372, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.8918, 'compress@10': 0.9824, 'time@10': 6.0556}:  33%|███▎      | 10/30 [00:44<01:38,  4.91s/it]{'epoch': 19, 'num_users': 6.6364, 'loss': 0.038, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.8909, 'compress@10': 0.983, 'time@10': 6.2637}:  33%|███▎      | 10/30 [00:48<01:38,  4.91s/it]{'epoch': 19, 'num_users': 6.6364, 'loss': 0.038, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.8909, 'compress@10': 0.983, 'time@10': 6.2637}:  37%|███▋      | 11/30 [00:48<01:29,  4.70s/it]{'epoch': 19, 'num_users': 6.4167, 'loss': 0.0357, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8923, 'compress@10': 0.9832, 'time@10': 6.0131}:  37%|███▋      | 11/30 [00:52<01:29,  4.70s/it]{'epoch': 19, 'num_users': 6.4167, 'loss': 0.0357, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8923, 'compress@10': 0.9832, 'time@10': 6.0131}:  40%|████      | 12/30 [00:52<01:16,  4.27s/it]{'epoch': 19, 'num_users': 6.6154, 'loss': 0.036, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8929, 'compress@10': 0.9838, 'time@10': 6.0896}:  40%|████      | 12/30 [00:55<01:16,  4.27s/it] {'epoch': 19, 'num_users': 6.6154, 'loss': 0.036, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8929, 'compress@10': 0.9838, 'time@10': 6.0896}:  43%|████▎     | 13/30 [00:55<01:08,  4.05s/it]{'epoch': 19, 'num_users': 6.3571, 'loss': 0.0337, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8872, 'compress@10': 0.984, 'time@10': 5.8247}:  43%|████▎     | 13/30 [00:58<01:08,  4.05s/it]{'epoch': 19, 'num_users': 6.3571, 'loss': 0.0337, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8872, 'compress@10': 0.984, 'time@10': 5.8247}:  47%|████▋     | 14/30 [00:58<00:56,  3.56s/it]{'epoch': 19, 'num_users': 6.2667, 'loss': 0.0348, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.8874, 'compress@10': 0.9841, 'time@10': 6.0309}:  47%|████▋     | 14/30 [01:02<00:56,  3.56s/it]{'epoch': 19, 'num_users': 6.2667, 'loss': 0.0348, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.8874, 'compress@10': 0.9841, 'time@10': 6.0309}:  50%|█████     | 15/30 [01:02<00:57,  3.84s/it]{'epoch': 19, 'num_users': 6.0625, 'loss': 0.0331, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8883, 'compress@10': 0.984, 'time@10': 5.8693}:  50%|█████     | 15/30 [01:06<00:57,  3.84s/it] {'epoch': 19, 'num_users': 6.0625, 'loss': 0.0331, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8883, 'compress@10': 0.984, 'time@10': 5.8693}:  53%|█████▎    | 16/30 [01:06<00:52,  3.74s/it]{'epoch': 19, 'num_users': 5.8235, 'loss': 0.0314, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8807, 'compress@10': 0.9844, 'time@10': 5.7176}:  53%|█████▎    | 16/30 [01:08<00:52,  3.74s/it]{'epoch': 19, 'num_users': 5.8235, 'loss': 0.0314, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8807, 'compress@10': 0.9844, 'time@10': 5.7176}:  57%|█████▋    | 17/30 [01:08<00:41,  3.23s/it]{'epoch': 19, 'num_users': 6.0556, 'loss': 0.0317, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8813, 'compress@10': 0.9844, 'time@10': 5.6493}:  57%|█████▋    | 17/30 [01:12<00:41,  3.23s/it]  {'epoch': 19, 'num_users': 6.0556, 'loss': 0.0317, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8813, 'compress@10': 0.9844, 'time@10': 5.6493}:  60%|██████    | 18/30 [01:12<00:43,  3.62s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 0.0309, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8819, 'compress@10': 0.9845, 'time@10': 5.5783}:  60%|██████    | 18/30 [01:14<00:43,  3.62s/it] {'epoch': 19, 'num_users': 6.0, 'loss': 0.0309, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8819, 'compress@10': 0.9845, 'time@10': 5.5783}:  63%|██████▎   | 19/30 [01:14<00:35,  3.19s/it]{'epoch': 19, 'num_users': 6.15, 'loss': 0.0311, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8813, 'compress@10': 0.9849, 'time@10': 5.7195}:  63%|██████▎   | 19/30 [01:23<00:35,  3.19s/it]{'epoch': 19, 'num_users': 6.15, 'loss': 0.0311, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8813, 'compress@10': 0.9849, 'time@10': 5.7195}:  67%|██████▋   | 20/30 [01:23<00:47,  4.77s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0324, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8788, 'compress@10': 0.9848, 'time@10': 5.8171}:  67%|██████▋   | 20/30 [01:27<00:47,  4.77s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0324, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8788, 'compress@10': 0.9848, 'time@10': 5.8171}:  70%|███████   | 21/30 [01:27<00:40,  4.52s/it]{'epoch': 19, 'num_users': 6.1818, 'loss': 0.0331, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8794, 'compress@10': 0.9848, 'time@10': 5.7087}:  70%|███████   | 21/30 [01:30<00:40,  4.52s/it]{'epoch': 19, 'num_users': 6.1818, 'loss': 0.0331, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8794, 'compress@10': 0.9848, 'time@10': 5.7087}:  73%|███████▎  | 22/30 [01:30<00:33,  4.20s/it]{'epoch': 19, 'num_users': 6.1304, 'loss': 0.0326, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8815, 'compress@10': 0.9847, 'time@10': 5.732}:  73%|███████▎  | 22/30 [01:33<00:33,  4.20s/it] {'epoch': 19, 'num_users': 6.1304, 'loss': 0.0326, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8815, 'compress@10': 0.9847, 'time@10': 5.732}:  77%|███████▋  | 23/30 [01:33<00:27,  3.89s/it]{'epoch': 19, 'num_users': 5.9583, 'loss': 0.0316, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8758, 'compress@10': 0.9847, 'time@10': 5.5718}:  77%|███████▋  | 23/30 [01:35<00:27,  3.89s/it]{'epoch': 19, 'num_users': 5.9583, 'loss': 0.0316, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8758, 'compress@10': 0.9847, 'time@10': 5.5718}:  80%|████████  | 24/30 [01:35<00:19,  3.30s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0305, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8656, 'compress@10': 0.9849, 'time@10': 5.4279}:  80%|████████  | 24/30 [01:36<00:19,  3.30s/it]     {'epoch': 19, 'num_users': 5.8, 'loss': 0.0305, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8656, 'compress@10': 0.9849, 'time@10': 5.4279}:  83%|████████▎ | 25/30 [01:36<00:13,  2.62s/it]{'epoch': 19, 'num_users': 5.8077, 'loss': 0.0308, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8658, 'compress@10': 0.9849, 'time@10': 5.5263}:  83%|████████▎ | 25/30 [01:44<00:13,  2.62s/it]{'epoch': 19, 'num_users': 5.8077, 'loss': 0.0308, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8658, 'compress@10': 0.9849, 'time@10': 5.5263}:  87%|████████▋ | 26/30 [01:44<00:16,  4.24s/it]{'epoch': 19, 'num_users': 5.8889, 'loss': 0.0305, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8672, 'compress@10': 0.9849, 'time@10': 5.5956}:  87%|████████▋ | 26/30 [01:48<00:16,  4.24s/it]{'epoch': 19, 'num_users': 5.8889, 'loss': 0.0305, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8672, 'compress@10': 0.9849, 'time@10': 5.5956}:  90%|█████████ | 27/30 [01:48<00:12,  4.09s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 0.0306, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.8685, 'compress@10': 0.9849, 'time@10': 5.6872}:  90%|█████████ | 27/30 [01:56<00:12,  4.09s/it]   {'epoch': 19, 'num_users': 6.0, 'loss': 0.0306, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.8685, 'compress@10': 0.9849, 'time@10': 5.6872}:  93%|█████████▎| 28/30 [01:56<00:10,  5.32s/it]{'epoch': 19, 'num_users': 5.8621, 'loss': 0.0303, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8705, 'compress@10': 0.985, 'time@10': 5.725}:  93%|█████████▎| 28/30 [02:00<00:10,  5.32s/it]{'epoch': 19, 'num_users': 5.8621, 'loss': 0.0303, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8705, 'compress@10': 0.985, 'time@10': 5.725}:  97%|█████████▋| 29/30 [02:00<00:04,  4.76s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0304, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8719, 'compress@10': 0.985, 'time@10': 5.7262}:  97%|█████████▋| 29/30 [02:05<00:04,  4.76s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0304, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8719, 'compress@10': 0.985, 'time@10': 5.7262}: 100%|██████████| 30/30 [02:05<00:00,  5.07s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0304, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8719, 'compress@10': 0.985, 'time@10': 5.7262}: 100%|██████████| 30/30 [02:05<00:00,  4.20s/it]
Epoch: 19
Avg # of users: 5.866666666666666
Avg Loss: 0.03036966282471293
Avg hit ratio: 0.8651336631715504
Avg ndcg: 0.8719064255935837
Avg compression ratio: 0.9850207181536574
Avg train time: 5.726177994410197
Std train time: 2.100344111981761
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 18, 10, 30, 9, 19, 25, 10, 10, 9, 6, 10, 10, 30, 30, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8758, 'compress@10': 0.9804, 'time@10': 5.9942}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8758, 'compress@10': 0.9804, 'time@10': 5.9942}:   3%|▎         | 1/30 [00:03<01:28,  3.04s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0344, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8839, 'compress@10': 0.9821, 'time@10': 5.4798}:   3%|▎         | 1/30 [00:08<01:28,  3.04s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0344, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8839, 'compress@10': 0.9821, 'time@10': 5.4798}:   7%|▋         | 2/30 [00:08<01:57,  4.19s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.875, 'compress@10': 0.9832, 'time@10': 4.9082}:   7%|▋         | 2/30 [00:09<01:57,  4.19s/it]  {'epoch': 20, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.875, 'compress@10': 0.9832, 'time@10': 4.9082}:  10%|█         | 3/30 [00:09<01:25,  3.16s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8762, 'compress@10': 0.983, 'time@10': 4.7899}:  10%|█         | 3/30 [00:14<01:25,  3.16s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8762, 'compress@10': 0.983, 'time@10': 4.7899}:  13%|█▎        | 4/30 [00:14<01:35,  3.68s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0362, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.857, 'compress@10': 0.9829, 'time@10': 5.5632}:  13%|█▎        | 4/30 [00:18<01:35,  3.68s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0362, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.857, 'compress@10': 0.9829, 'time@10': 5.5632}:  17%|█▋        | 5/30 [00:18<01:38,  3.93s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0365, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.8604, 'compress@10': 0.9818, 'time@10': 5.8346}:  17%|█▋        | 5/30 [00:26<01:38,  3.93s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0365, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.8604, 'compress@10': 0.9818, 'time@10': 5.8346}:  20%|██        | 6/30 [00:26<02:01,  5.05s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0358, 'hit_ratio@10': 0.904, 'ndcg@10': 0.8615, 'compress@10': 0.9816, 'time@10': 5.9593}:  20%|██        | 6/30 [00:29<02:01,  5.05s/it] {'epoch': 20, 'num_users': 6.2857, 'loss': 0.0358, 'hit_ratio@10': 0.904, 'ndcg@10': 0.8615, 'compress@10': 0.9816, 'time@10': 5.9593}:  23%|██▎       | 7/30 [00:29<01:43,  4.51s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0352, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.8695, 'compress@10': 0.9814, 'time@10': 5.8181}:  23%|██▎       | 7/30 [00:34<01:43,  4.51s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0352, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.8695, 'compress@10': 0.9814, 'time@10': 5.8181}:  27%|██▋       | 8/30 [00:34<01:41,  4.62s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0353, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.8778, 'compress@10': 0.9813, 'time@10': 5.8857}:  27%|██▋       | 8/30 [00:37<01:41,  4.62s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0353, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.8778, 'compress@10': 0.9813, 'time@10': 5.8857}:  30%|███       | 9/30 [00:37<01:28,  4.20s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0338, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.8824, 'compress@10': 0.9818, 'time@10': 5.9412}:  30%|███       | 9/30 [00:44<01:28,  4.20s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0338, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.8824, 'compress@10': 0.9818, 'time@10': 5.9412}:  33%|███▎      | 10/30 [00:44<01:38,  4.90s/it]{'epoch': 20, 'num_users': 6.6364, 'loss': 0.035, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.8826, 'compress@10': 0.9825, 'time@10': 6.0257}:  33%|███▎      | 10/30 [00:47<01:38,  4.90s/it]{'epoch': 20, 'num_users': 6.6364, 'loss': 0.035, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.8826, 'compress@10': 0.9825, 'time@10': 6.0257}:  37%|███▋      | 11/30 [00:47<01:24,  4.46s/it]{'epoch': 20, 'num_users': 6.4167, 'loss': 0.0329, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8847, 'compress@10': 0.9827, 'time@10': 5.7655}:  37%|███▋      | 11/30 [00:50<01:24,  4.46s/it]{'epoch': 20, 'num_users': 6.4167, 'loss': 0.0329, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8847, 'compress@10': 0.9827, 'time@10': 5.7655}:  40%|████      | 12/30 [00:50<01:12,  4.00s/it]{'epoch': 20, 'num_users': 6.6154, 'loss': 0.0333, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8859, 'compress@10': 0.9834, 'time@10': 5.8623}:  40%|████      | 12/30 [00:54<01:12,  4.00s/it]{'epoch': 20, 'num_users': 6.6154, 'loss': 0.0333, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8859, 'compress@10': 0.9834, 'time@10': 5.8623}:  43%|████▎     | 13/30 [00:54<01:05,  3.87s/it]{'epoch': 20, 'num_users': 6.3571, 'loss': 0.0313, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8807, 'compress@10': 0.9836, 'time@10': 5.6188}:  43%|████▎     | 13/30 [00:56<01:05,  3.87s/it]{'epoch': 20, 'num_users': 6.3571, 'loss': 0.0313, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8807, 'compress@10': 0.9836, 'time@10': 5.6188}:  47%|████▋     | 14/30 [00:56<00:55,  3.45s/it]{'epoch': 20, 'num_users': 6.2667, 'loss': 0.0324, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8812, 'compress@10': 0.9837, 'time@10': 5.8327}:  47%|████▋     | 14/30 [01:00<00:55,  3.45s/it]{'epoch': 20, 'num_users': 6.2667, 'loss': 0.0324, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8812, 'compress@10': 0.9837, 'time@10': 5.8327}:  50%|█████     | 15/30 [01:00<00:56,  3.76s/it]{'epoch': 20, 'num_users': 6.0625, 'loss': 0.0308, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8827, 'compress@10': 0.9837, 'time@10': 5.7036}:  50%|█████     | 15/30 [01:04<00:56,  3.76s/it]{'epoch': 20, 'num_users': 6.0625, 'loss': 0.0308, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8827, 'compress@10': 0.9837, 'time@10': 5.7036}:  53%|█████▎    | 16/30 [01:04<00:52,  3.77s/it]{'epoch': 20, 'num_users': 5.8235, 'loss': 0.0293, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8754, 'compress@10': 0.9841, 'time@10': 5.5607}:  53%|█████▎    | 16/30 [01:06<00:52,  3.77s/it]  {'epoch': 20, 'num_users': 5.8235, 'loss': 0.0293, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8754, 'compress@10': 0.9841, 'time@10': 5.5607}:  57%|█████▋    | 17/30 [01:06<00:40,  3.14s/it]{'epoch': 20, 'num_users': 6.0556, 'loss': 0.0295, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8756, 'compress@10': 0.9841, 'time@10': 5.5011}:  57%|█████▋    | 17/30 [01:11<00:40,  3.14s/it]{'epoch': 20, 'num_users': 6.0556, 'loss': 0.0295, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8756, 'compress@10': 0.9841, 'time@10': 5.5011}:  60%|██████    | 18/30 [01:11<00:42,  3.56s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 0.0288, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8768, 'compress@10': 0.9842, 'time@10': 5.4618}:  60%|██████    | 18/30 [01:13<00:42,  3.56s/it]   {'epoch': 20, 'num_users': 6.0, 'loss': 0.0288, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8768, 'compress@10': 0.9842, 'time@10': 5.4618}:  63%|██████▎   | 19/30 [01:13<00:35,  3.22s/it]{'epoch': 20, 'num_users': 6.15, 'loss': 0.029, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8768, 'compress@10': 0.9846, 'time@10': 5.6183}:  63%|██████▎   | 19/30 [01:22<00:35,  3.22s/it]{'epoch': 20, 'num_users': 6.15, 'loss': 0.029, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8768, 'compress@10': 0.9846, 'time@10': 5.6183}:  67%|██████▋   | 20/30 [01:22<00:48,  4.85s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0305, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8744, 'compress@10': 0.9845, 'time@10': 5.7236}:  67%|██████▋   | 20/30 [01:26<00:48,  4.85s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0305, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8744, 'compress@10': 0.9845, 'time@10': 5.7236}:  70%|███████   | 21/30 [01:26<00:41,  4.58s/it]{'epoch': 20, 'num_users': 6.1818, 'loss': 0.0311, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8763, 'compress@10': 0.9845, 'time@10': 5.6193}:  70%|███████   | 21/30 [01:29<00:41,  4.58s/it] {'epoch': 20, 'num_users': 6.1818, 'loss': 0.0311, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8763, 'compress@10': 0.9845, 'time@10': 5.6193}:  73%|███████▎  | 22/30 [01:29<00:33,  4.25s/it]{'epoch': 20, 'num_users': 6.1304, 'loss': 0.0306, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8785, 'compress@10': 0.9845, 'time@10': 5.6463}:  73%|███████▎  | 22/30 [01:32<00:33,  4.25s/it]{'epoch': 20, 'num_users': 6.1304, 'loss': 0.0306, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8785, 'compress@10': 0.9845, 'time@10': 5.6463}:  77%|███████▋  | 23/30 [01:32<00:27,  3.92s/it]{'epoch': 20, 'num_users': 5.9583, 'loss': 0.0296, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8729, 'compress@10': 0.9845, 'time@10': 5.4919}:  77%|███████▋  | 23/30 [01:34<00:27,  3.92s/it]{'epoch': 20, 'num_users': 5.9583, 'loss': 0.0296, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8729, 'compress@10': 0.9845, 'time@10': 5.4919}:  80%|████████  | 24/30 [01:34<00:20,  3.34s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0286, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8629, 'compress@10': 0.9847, 'time@10': 5.3493}:  80%|████████  | 24/30 [01:35<00:20,  3.34s/it]    {'epoch': 20, 'num_users': 5.8, 'loss': 0.0286, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8629, 'compress@10': 0.9847, 'time@10': 5.3493}:  83%|████████▎ | 25/30 [01:35<00:13,  2.64s/it]{'epoch': 20, 'num_users': 5.8077, 'loss': 0.0289, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8633, 'compress@10': 0.9847, 'time@10': 5.4506}:  83%|████████▎ | 25/30 [01:43<00:13,  2.64s/it]{'epoch': 20, 'num_users': 5.8077, 'loss': 0.0289, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8633, 'compress@10': 0.9847, 'time@10': 5.4506}:  87%|████████▋ | 26/30 [01:43<00:17,  4.25s/it]{'epoch': 20, 'num_users': 5.8889, 'loss': 0.0286, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8649, 'compress@10': 0.9848, 'time@10': 5.5133}:  87%|████████▋ | 26/30 [01:47<00:17,  4.25s/it]{'epoch': 20, 'num_users': 5.8889, 'loss': 0.0286, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8649, 'compress@10': 0.9848, 'time@10': 5.5133}:  90%|█████████ | 27/30 [01:47<00:12,  4.06s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 0.0285, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8662, 'compress@10': 0.9848, 'time@10': 5.6114}:  90%|█████████ | 27/30 [01:55<00:12,  4.06s/it]   {'epoch': 20, 'num_users': 6.0, 'loss': 0.0285, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8662, 'compress@10': 0.9848, 'time@10': 5.6114}:  93%|█████████▎| 28/30 [01:55<00:10,  5.33s/it]{'epoch': 20, 'num_users': 5.8621, 'loss': 0.0281, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8682, 'compress@10': 0.9849, 'time@10': 5.6549}:  93%|█████████▎| 28/30 [01:59<00:10,  5.33s/it]{'epoch': 20, 'num_users': 5.8621, 'loss': 0.0281, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8682, 'compress@10': 0.9849, 'time@10': 5.6549}:  97%|█████████▋| 29/30 [01:59<00:04,  4.78s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.0282, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8696, 'compress@10': 0.9849, 'time@10': 5.6616}:  97%|█████████▋| 29/30 [02:04<00:04,  4.78s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.0282, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8696, 'compress@10': 0.9849, 'time@10': 5.6616}: 100%|██████████| 30/30 [02:04<00:00,  5.11s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.0282, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8696, 'compress@10': 0.9849, 'time@10': 5.6616}: 100%|██████████| 30/30 [02:04<00:00,  4.17s/it]
Epoch: 20
Avg # of users: 5.866666666666666
Avg Loss: 0.028236068750717127
Avg hit ratio: 0.8627456361658763
Avg ndcg: 0.8696453051606855
Avg compression ratio: 0.9848867994754021
Avg train time: 5.661568069458008
Std train time: 2.0407673175770826
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 19, 10, 31, 9, 19, 25, 10, 10, 9, 6, 10, 10, 31, 31, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8782, 'compress@10': 0.9805, 'time@10': 5.963}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8782, 'compress@10': 0.9805, 'time@10': 5.963}:   3%|▎         | 1/30 [00:03<01:27,  3.02s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0328, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8858, 'compress@10': 0.9819, 'time@10': 5.4741}:   3%|▎         | 1/30 [00:08<01:27,  3.02s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0328, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8858, 'compress@10': 0.9819, 'time@10': 5.4741}:   7%|▋         | 2/30 [00:08<01:58,  4.22s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8763, 'compress@10': 0.9831, 'time@10': 4.9124}:   7%|▋         | 2/30 [00:10<01:58,  4.22s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8763, 'compress@10': 0.9831, 'time@10': 4.9124}:  10%|█         | 3/30 [00:10<01:25,  3.17s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8759, 'compress@10': 0.9828, 'time@10': 4.7981}:  10%|█         | 3/30 [00:14<01:25,  3.17s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8759, 'compress@10': 0.9828, 'time@10': 4.7981}:  13%|█▎        | 4/30 [00:14<01:39,  3.82s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0358, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8567, 'compress@10': 0.9828, 'time@10': 5.3269}:  13%|█▎        | 4/30 [00:18<01:39,  3.82s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0358, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8567, 'compress@10': 0.9828, 'time@10': 5.3269}:  17%|█▋        | 5/30 [00:18<01:35,  3.82s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0353, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.8628, 'compress@10': 0.9818, 'time@10': 5.6399}:  17%|█▋        | 5/30 [00:25<01:35,  3.82s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0353, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.8628, 'compress@10': 0.9818, 'time@10': 5.6399}:  20%|██        | 6/30 [00:25<01:59,  4.98s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0354, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.8675, 'compress@10': 0.9819, 'time@10': 5.9705}:  20%|██        | 6/30 [00:29<01:59,  4.98s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0354, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.8675, 'compress@10': 0.9819, 'time@10': 5.9705}:  23%|██▎       | 7/30 [00:29<01:47,  4.67s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0348, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.8758, 'compress@10': 0.9817, 'time@10': 5.8904}:  23%|██▎       | 7/30 [00:35<01:47,  4.67s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0348, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.8758, 'compress@10': 0.9817, 'time@10': 5.8904}:  27%|██▋       | 8/30 [00:35<01:47,  4.89s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0343, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8839, 'compress@10': 0.9814, 'time@10': 5.8895}:  27%|██▋       | 8/30 [00:38<01:47,  4.89s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0343, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8839, 'compress@10': 0.9814, 'time@10': 5.8895}:  30%|███       | 9/30 [00:38<01:30,  4.29s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0341, 'hit_ratio@10': 0.892, 'ndcg@10': 0.8867, 'compress@10': 0.9821, 'time@10': 5.9253}:  30%|███       | 9/30 [00:44<01:30,  4.29s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0341, 'hit_ratio@10': 0.892, 'ndcg@10': 0.8867, 'compress@10': 0.9821, 'time@10': 5.9253}:  33%|███▎      | 10/30 [00:44<01:38,  4.93s/it]{'epoch': 21, 'num_users': 6.6364, 'loss': 0.0353, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.8866, 'compress@10': 0.9827, 'time@10': 6.0366}:  33%|███▎      | 10/30 [00:48<01:38,  4.93s/it]{'epoch': 21, 'num_users': 6.6364, 'loss': 0.0353, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.8866, 'compress@10': 0.9827, 'time@10': 6.0366}:  37%|███▋      | 11/30 [00:48<01:25,  4.52s/it]{'epoch': 21, 'num_users': 6.4167, 'loss': 0.0331, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8884, 'compress@10': 0.9829, 'time@10': 5.7651}:  37%|███▋      | 11/30 [00:51<01:25,  4.52s/it] {'epoch': 21, 'num_users': 6.4167, 'loss': 0.0331, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8884, 'compress@10': 0.9829, 'time@10': 5.7651}:  40%|████      | 12/30 [00:51<01:12,  4.00s/it]{'epoch': 21, 'num_users': 6.6154, 'loss': 0.0335, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8893, 'compress@10': 0.9836, 'time@10': 5.8387}:  40%|████      | 12/30 [00:54<01:12,  4.00s/it]{'epoch': 21, 'num_users': 6.6154, 'loss': 0.0335, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8893, 'compress@10': 0.9836, 'time@10': 5.8387}:  43%|████▎     | 13/30 [00:54<01:04,  3.82s/it]{'epoch': 21, 'num_users': 6.3571, 'loss': 0.0314, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8839, 'compress@10': 0.9838, 'time@10': 5.5963}:  43%|████▎     | 13/30 [00:56<01:04,  3.82s/it]{'epoch': 21, 'num_users': 6.3571, 'loss': 0.0314, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8839, 'compress@10': 0.9838, 'time@10': 5.5963}:  47%|████▋     | 14/30 [00:56<00:54,  3.42s/it]{'epoch': 21, 'num_users': 6.2667, 'loss': 0.0325, 'hit_ratio@10': 0.865, 'ndcg@10': 0.885, 'compress@10': 0.9839, 'time@10': 5.7907}:  47%|████▋     | 14/30 [01:01<00:54,  3.42s/it]  {'epoch': 21, 'num_users': 6.2667, 'loss': 0.0325, 'hit_ratio@10': 0.865, 'ndcg@10': 0.885, 'compress@10': 0.9839, 'time@10': 5.7907}:  50%|█████     | 15/30 [01:01<00:55,  3.68s/it]{'epoch': 21, 'num_users': 6.0625, 'loss': 0.0308, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8862, 'compress@10': 0.9839, 'time@10': 5.6415}:  50%|█████     | 15/30 [01:04<00:55,  3.68s/it]{'epoch': 21, 'num_users': 6.0625, 'loss': 0.0308, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8862, 'compress@10': 0.9839, 'time@10': 5.6415}:  53%|█████▎    | 16/30 [01:04<00:50,  3.61s/it]{'epoch': 21, 'num_users': 5.8235, 'loss': 0.0292, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.8788, 'compress@10': 0.9843, 'time@10': 5.5031}:  53%|█████▎    | 16/30 [01:06<00:50,  3.61s/it]{'epoch': 21, 'num_users': 5.8235, 'loss': 0.0292, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.8788, 'compress@10': 0.9843, 'time@10': 5.5031}:  57%|█████▋    | 17/30 [01:06<00:39,  3.03s/it]{'epoch': 21, 'num_users': 6.0556, 'loss': 0.0294, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8796, 'compress@10': 0.9843, 'time@10': 5.4338}:  57%|█████▋    | 17/30 [01:10<00:39,  3.03s/it]{'epoch': 21, 'num_users': 6.0556, 'loss': 0.0294, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8796, 'compress@10': 0.9843, 'time@10': 5.4338}:  60%|██████    | 18/30 [01:10<00:40,  3.41s/it]{'epoch': 21, 'num_users': 6.0, 'loss': 0.0287, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8807, 'compress@10': 0.9844, 'time@10': 5.3725}:  60%|██████    | 18/30 [01:12<00:40,  3.41s/it]   {'epoch': 21, 'num_users': 6.0, 'loss': 0.0287, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8807, 'compress@10': 0.9844, 'time@10': 5.3725}:  63%|██████▎   | 19/30 [01:12<00:33,  3.04s/it]{'epoch': 21, 'num_users': 6.15, 'loss': 0.0289, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8806, 'compress@10': 0.9848, 'time@10': 5.5217}:  63%|██████▎   | 19/30 [01:21<00:33,  3.04s/it]{'epoch': 21, 'num_users': 6.15, 'loss': 0.0289, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8806, 'compress@10': 0.9848, 'time@10': 5.5217}:  67%|██████▋   | 20/30 [01:21<00:46,  4.65s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8784, 'compress@10': 0.9847, 'time@10': 5.628}:  67%|██████▋   | 20/30 [01:25<00:46,  4.65s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8784, 'compress@10': 0.9847, 'time@10': 5.628}:  70%|███████   | 21/30 [01:25<00:40,  4.49s/it]{'epoch': 21, 'num_users': 6.1818, 'loss': 0.0309, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8796, 'compress@10': 0.9847, 'time@10': 5.5283}:  70%|███████   | 21/30 [01:28<00:40,  4.49s/it]{'epoch': 21, 'num_users': 6.1818, 'loss': 0.0309, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8796, 'compress@10': 0.9847, 'time@10': 5.5283}:  73%|███████▎  | 22/30 [01:28<00:33,  4.18s/it]{'epoch': 21, 'num_users': 6.1304, 'loss': 0.0304, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8817, 'compress@10': 0.9847, 'time@10': 5.5574}:  73%|███████▎  | 22/30 [01:31<00:33,  4.18s/it]{'epoch': 21, 'num_users': 6.1304, 'loss': 0.0304, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8817, 'compress@10': 0.9847, 'time@10': 5.5574}:  77%|███████▋  | 23/30 [01:31<00:27,  3.87s/it]{'epoch': 21, 'num_users': 5.9583, 'loss': 0.0295, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.876, 'compress@10': 0.9846, 'time@10': 5.4107}:  77%|███████▋  | 23/30 [01:33<00:27,  3.87s/it] {'epoch': 21, 'num_users': 5.9583, 'loss': 0.0295, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.876, 'compress@10': 0.9846, 'time@10': 5.4107}:  80%|████████  | 24/30 [01:33<00:19,  3.33s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0284, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8658, 'compress@10': 0.9849, 'time@10': 5.2758}:  80%|████████  | 24/30 [01:35<00:19,  3.33s/it]  {'epoch': 21, 'num_users': 5.8, 'loss': 0.0284, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8658, 'compress@10': 0.9849, 'time@10': 5.2758}:  83%|████████▎ | 25/30 [01:35<00:13,  2.65s/it]{'epoch': 21, 'num_users': 5.8077, 'loss': 0.0287, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8664, 'compress@10': 0.9849, 'time@10': 5.358}:  83%|████████▎ | 25/30 [01:42<00:13,  2.65s/it]{'epoch': 21, 'num_users': 5.8077, 'loss': 0.0287, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8664, 'compress@10': 0.9849, 'time@10': 5.358}:  87%|████████▋ | 26/30 [01:42<00:16,  4.09s/it]{'epoch': 21, 'num_users': 5.8889, 'loss': 0.0284, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8678, 'compress@10': 0.9849, 'time@10': 5.4132}:  87%|████████▋ | 26/30 [01:45<00:16,  4.09s/it]{'epoch': 21, 'num_users': 5.8889, 'loss': 0.0284, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8678, 'compress@10': 0.9849, 'time@10': 5.4132}:  90%|█████████ | 27/30 [01:45<00:11,  3.90s/it]{'epoch': 21, 'num_users': 6.0, 'loss': 0.0282, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8697, 'compress@10': 0.9849, 'time@10': 5.5131}:  90%|█████████ | 27/30 [01:54<00:11,  3.90s/it]  {'epoch': 21, 'num_users': 6.0, 'loss': 0.0282, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8697, 'compress@10': 0.9849, 'time@10': 5.5131}:  93%|█████████▎| 28/30 [01:54<00:10,  5.21s/it]{'epoch': 21, 'num_users': 5.8621, 'loss': 0.0279, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8716, 'compress@10': 0.985, 'time@10': 5.5511}:  93%|█████████▎| 28/30 [01:57<00:10,  5.21s/it]{'epoch': 21, 'num_users': 5.8621, 'loss': 0.0279, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8716, 'compress@10': 0.985, 'time@10': 5.5511}:  97%|█████████▋| 29/30 [01:57<00:04,  4.65s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.028, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.873, 'compress@10': 0.985, 'time@10': 5.5627}:  97%|█████████▋| 29/30 [02:03<00:04,  4.65s/it]  {'epoch': 21, 'num_users': 5.8667, 'loss': 0.028, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.873, 'compress@10': 0.985, 'time@10': 5.5627}: 100%|██████████| 30/30 [02:03<00:00,  5.04s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.028, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.873, 'compress@10': 0.985, 'time@10': 5.5627}: 100%|██████████| 30/30 [02:03<00:00,  4.12s/it]
Epoch: 21
Avg # of users: 5.866666666666666
Avg Loss: 0.027978950552277018
Avg hit ratio: 0.8621547270749673
Avg ndcg: 0.8729526105446436
Avg compression ratio: 0.984956234048375
Avg train time: 5.562678567568461
Std train time: 1.9695032025678016
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 20, 10, 32, 9, 19, 25, 10, 10, 9, 6, 10, 10, 32, 32, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0395, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8782, 'compress@10': 0.9803, 'time@10': 5.9258}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0395, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8782, 'compress@10': 0.9803, 'time@10': 5.9258}:   3%|▎         | 1/30 [00:03<01:27,  3.00s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8885, 'compress@10': 0.9818, 'time@10': 5.6376}:   3%|▎         | 1/30 [00:08<01:27,  3.00s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8885, 'compress@10': 0.9818, 'time@10': 5.6376}:   7%|▋         | 2/30 [00:08<02:03,  4.41s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.878, 'compress@10': 0.9829, 'time@10': 5.01}:   7%|▋         | 2/30 [00:10<02:03,  4.41s/it]   {'epoch': 22, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.878, 'compress@10': 0.9829, 'time@10': 5.01}:  10%|█         | 3/30 [00:10<01:28,  3.27s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8896, 'compress@10': 0.9827, 'time@10': 4.8684}:  10%|█         | 3/30 [00:14<01:28,  3.27s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8896, 'compress@10': 0.9827, 'time@10': 4.8684}:  13%|█▎        | 4/30 [00:14<01:37,  3.75s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.035, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8682, 'compress@10': 0.9827, 'time@10': 5.5014}:  13%|█▎        | 4/30 [00:18<01:37,  3.75s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.035, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8682, 'compress@10': 0.9827, 'time@10': 5.5014}:  17%|█▋        | 5/30 [00:18<01:36,  3.86s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0354, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.8714, 'compress@10': 0.9817, 'time@10': 5.8351}:  17%|█▋        | 5/30 [00:26<01:36,  3.86s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0354, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.8714, 'compress@10': 0.9817, 'time@10': 5.8351}:  20%|██        | 6/30 [00:26<02:02,  5.11s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0346, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.8715, 'compress@10': 0.9816, 'time@10': 6.1806}:  20%|██        | 6/30 [00:30<02:02,  5.11s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0346, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.8715, 'compress@10': 0.9816, 'time@10': 6.1806}:  23%|██▎       | 7/30 [00:30<01:50,  4.81s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.034, 'hit_ratio@10': 0.908, 'ndcg@10': 0.8795, 'compress@10': 0.9814, 'time@10': 6.1057}:  23%|██▎       | 7/30 [00:36<01:50,  4.81s/it]   {'epoch': 22, 'num_users': 6.125, 'loss': 0.034, 'hit_ratio@10': 0.908, 'ndcg@10': 0.8795, 'compress@10': 0.9814, 'time@10': 6.1057}:  27%|██▋       | 8/30 [00:36<01:51,  5.08s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0334, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.8862, 'compress@10': 0.9813, 'time@10': 6.2161}:  27%|██▋       | 8/30 [00:39<01:51,  5.08s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0334, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.8862, 'compress@10': 0.9813, 'time@10': 6.2161}:  30%|███       | 9/30 [00:39<01:36,  4.61s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0315, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.8915, 'compress@10': 0.9817, 'time@10': 6.2018}:  30%|███       | 9/30 [00:45<01:36,  4.61s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0315, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.8915, 'compress@10': 0.9817, 'time@10': 6.2018}:  33%|███▎      | 10/30 [00:45<01:41,  5.08s/it]{'epoch': 22, 'num_users': 6.6364, 'loss': 0.0331, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.8909, 'compress@10': 0.9824, 'time@10': 6.3321}:  33%|███▎      | 10/30 [00:49<01:41,  5.08s/it]{'epoch': 22, 'num_users': 6.6364, 'loss': 0.0331, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.8909, 'compress@10': 0.9824, 'time@10': 6.3321}:  37%|███▋      | 11/30 [00:49<01:29,  4.72s/it]{'epoch': 22, 'num_users': 6.4167, 'loss': 0.0311, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8923, 'compress@10': 0.9826, 'time@10': 6.0704}:  37%|███▋      | 11/30 [00:53<01:29,  4.72s/it] {'epoch': 22, 'num_users': 6.4167, 'loss': 0.0311, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8923, 'compress@10': 0.9826, 'time@10': 6.0704}:  40%|████      | 12/30 [00:53<01:16,  4.26s/it]{'epoch': 22, 'num_users': 6.6154, 'loss': 0.0315, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.893, 'compress@10': 0.9833, 'time@10': 6.0133}:  40%|████      | 12/30 [00:55<01:16,  4.26s/it]{'epoch': 22, 'num_users': 6.6154, 'loss': 0.0315, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.893, 'compress@10': 0.9833, 'time@10': 6.0133}:  43%|████▎     | 13/30 [00:55<01:04,  3.79s/it]{'epoch': 22, 'num_users': 6.3571, 'loss': 0.0295, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8873, 'compress@10': 0.9836, 'time@10': 5.7536}:  43%|████▎     | 13/30 [00:58<01:04,  3.79s/it]{'epoch': 22, 'num_users': 6.3571, 'loss': 0.0295, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8873, 'compress@10': 0.9836, 'time@10': 5.7536}:  47%|████▋     | 14/30 [00:58<00:54,  3.38s/it]{'epoch': 22, 'num_users': 6.2667, 'loss': 0.0305, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.888, 'compress@10': 0.9837, 'time@10': 5.9647}:  47%|████▋     | 14/30 [01:02<00:54,  3.38s/it] {'epoch': 22, 'num_users': 6.2667, 'loss': 0.0305, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.888, 'compress@10': 0.9837, 'time@10': 5.9647}:  50%|█████     | 15/30 [01:02<00:55,  3.71s/it]{'epoch': 22, 'num_users': 6.0625, 'loss': 0.029, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.889, 'compress@10': 0.9837, 'time@10': 5.8053}:  50%|█████     | 15/30 [01:06<00:55,  3.71s/it] {'epoch': 22, 'num_users': 6.0625, 'loss': 0.029, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.889, 'compress@10': 0.9837, 'time@10': 5.8053}:  53%|█████▎    | 16/30 [01:06<00:50,  3.64s/it]{'epoch': 22, 'num_users': 5.8235, 'loss': 0.0275, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.882, 'compress@10': 0.9841, 'time@10': 5.6569}:  53%|█████▎    | 16/30 [01:07<00:50,  3.64s/it]{'epoch': 22, 'num_users': 5.8235, 'loss': 0.0275, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.882, 'compress@10': 0.9841, 'time@10': 5.6569}:  57%|█████▋    | 17/30 [01:07<00:39,  3.05s/it]{'epoch': 22, 'num_users': 6.0556, 'loss': 0.0277, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8826, 'compress@10': 0.9841, 'time@10': 5.5915}:  57%|█████▋    | 17/30 [01:12<00:39,  3.05s/it]{'epoch': 22, 'num_users': 6.0556, 'loss': 0.0277, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8826, 'compress@10': 0.9841, 'time@10': 5.5915}:  60%|██████    | 18/30 [01:12<00:41,  3.49s/it]{'epoch': 22, 'num_users': 6.0, 'loss': 0.0271, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8836, 'compress@10': 0.9842, 'time@10': 5.5259}:  60%|██████    | 18/30 [01:14<00:41,  3.49s/it]   {'epoch': 22, 'num_users': 6.0, 'loss': 0.0271, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8836, 'compress@10': 0.9842, 'time@10': 5.5259}:  63%|██████▎   | 19/30 [01:14<00:34,  3.11s/it]{'epoch': 22, 'num_users': 6.15, 'loss': 0.0273, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.8838, 'compress@10': 0.9846, 'time@10': 5.6811}:  63%|██████▎   | 19/30 [01:23<00:34,  3.11s/it]{'epoch': 22, 'num_users': 6.15, 'loss': 0.0273, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.8838, 'compress@10': 0.9846, 'time@10': 5.6811}:  67%|██████▋   | 20/30 [01:23<00:47,  4.78s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0288, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8811, 'compress@10': 0.9845, 'time@10': 5.7778}:  67%|██████▋   | 20/30 [01:27<00:47,  4.78s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0288, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8811, 'compress@10': 0.9845, 'time@10': 5.7778}:  70%|███████   | 21/30 [01:27<00:40,  4.51s/it]{'epoch': 22, 'num_users': 6.1818, 'loss': 0.0294, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8821, 'compress@10': 0.9845, 'time@10': 5.6725}:  70%|███████   | 21/30 [01:30<00:40,  4.51s/it]{'epoch': 22, 'num_users': 6.1818, 'loss': 0.0294, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8821, 'compress@10': 0.9845, 'time@10': 5.6725}:  73%|███████▎  | 22/30 [01:30<00:33,  4.21s/it]{'epoch': 22, 'num_users': 6.1304, 'loss': 0.0289, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8839, 'compress@10': 0.9845, 'time@10': 5.697}:  73%|███████▎  | 22/30 [01:33<00:33,  4.21s/it] {'epoch': 22, 'num_users': 6.1304, 'loss': 0.0289, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8839, 'compress@10': 0.9845, 'time@10': 5.697}:  77%|███████▋  | 23/30 [01:33<00:27,  3.90s/it]{'epoch': 22, 'num_users': 5.9583, 'loss': 0.028, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.878, 'compress@10': 0.9845, 'time@10': 5.5466}:  77%|███████▋  | 23/30 [01:35<00:27,  3.90s/it] {'epoch': 22, 'num_users': 5.9583, 'loss': 0.028, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.878, 'compress@10': 0.9845, 'time@10': 5.5466}:  80%|████████  | 24/30 [01:35<00:20,  3.36s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0271, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8678, 'compress@10': 0.9847, 'time@10': 5.4064}:  80%|████████  | 24/30 [01:36<00:20,  3.36s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.0271, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8678, 'compress@10': 0.9847, 'time@10': 5.4064}:  83%|████████▎ | 25/30 [01:36<00:13,  2.67s/it]{'epoch': 22, 'num_users': 5.8077, 'loss': 0.0273, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8685, 'compress@10': 0.9847, 'time@10': 5.504}:  83%|████████▎ | 25/30 [01:44<00:13,  2.67s/it]{'epoch': 22, 'num_users': 5.8077, 'loss': 0.0273, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8685, 'compress@10': 0.9847, 'time@10': 5.504}:  87%|████████▋ | 26/30 [01:44<00:17,  4.27s/it]{'epoch': 22, 'num_users': 5.8889, 'loss': 0.027, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8699, 'compress@10': 0.9847, 'time@10': 5.5656}:  87%|████████▋ | 26/30 [01:48<00:17,  4.27s/it]{'epoch': 22, 'num_users': 5.8889, 'loss': 0.027, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8699, 'compress@10': 0.9847, 'time@10': 5.5656}:  90%|█████████ | 27/30 [01:48<00:12,  4.08s/it]{'epoch': 22, 'num_users': 6.0, 'loss': 0.0274, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8724, 'compress@10': 0.9847, 'time@10': 5.6627}:  90%|█████████ | 27/30 [01:56<00:12,  4.08s/it]  {'epoch': 22, 'num_users': 6.0, 'loss': 0.0274, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8724, 'compress@10': 0.9847, 'time@10': 5.6627}:  93%|█████████▎| 28/30 [01:56<00:10,  5.35s/it]{'epoch': 22, 'num_users': 5.8621, 'loss': 0.0271, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8742, 'compress@10': 0.9848, 'time@10': 5.7037}:  93%|█████████▎| 28/30 [02:00<00:10,  5.35s/it]{'epoch': 22, 'num_users': 5.8621, 'loss': 0.0271, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8742, 'compress@10': 0.9848, 'time@10': 5.7037}:  97%|█████████▋| 29/30 [02:00<00:04,  4.79s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0272, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8754, 'compress@10': 0.9848, 'time@10': 5.7102}:  97%|█████████▋| 29/30 [02:06<00:04,  4.79s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0272, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8754, 'compress@10': 0.9848, 'time@10': 5.7102}: 100%|██████████| 30/30 [02:06<00:00,  5.13s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0272, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8754, 'compress@10': 0.9848, 'time@10': 5.7102}: 100%|██████████| 30/30 [02:06<00:00,  4.21s/it]
Epoch: 22
Avg # of users: 5.866666666666666
Avg Loss: 0.027213027900882692
Avg hit ratio: 0.8653359041121814
Avg ndcg: 0.8754102066049653
Avg compression ratio: 0.9847842248151569
Avg train time: 5.71022527217865
Std train time: 2.069222144133437
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 20, 10, 33, 9, 19, 25, 10, 10, 9, 6, 10, 10, 33, 33, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0394, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8782, 'compress@10': 0.9801, 'time@10': 5.5121}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0394, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8782, 'compress@10': 0.9801, 'time@10': 5.5121}:   3%|▎         | 1/30 [00:02<01:21,  2.80s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8885, 'compress@10': 0.9815, 'time@10': 5.2669}:   3%|▎         | 1/30 [00:07<01:21,  2.80s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8885, 'compress@10': 0.9815, 'time@10': 5.2669}:   7%|▋         | 2/30 [00:07<01:55,  4.13s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.878, 'compress@10': 0.9827, 'time@10': 4.7059}:   7%|▋         | 2/30 [00:09<01:55,  4.13s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.878, 'compress@10': 0.9827, 'time@10': 4.7059}:  10%|█         | 3/30 [00:09<01:23,  3.08s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8875, 'compress@10': 0.9827, 'time@10': 4.5936}:  10%|█         | 3/30 [00:13<01:23,  3.08s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8875, 'compress@10': 0.9827, 'time@10': 4.5936}:  13%|█▎        | 4/30 [00:13<01:32,  3.56s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0329, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8675, 'compress@10': 0.9827, 'time@10': 5.2885}:  13%|█▎        | 4/30 [00:18<01:32,  3.56s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0329, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8675, 'compress@10': 0.9827, 'time@10': 5.2885}:  17%|█▋        | 5/30 [00:18<01:33,  3.75s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0333, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.8724, 'compress@10': 0.9817, 'time@10': 5.6542}:  17%|█▋        | 5/30 [00:25<01:33,  3.75s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0333, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.8724, 'compress@10': 0.9817, 'time@10': 5.6542}:  20%|██        | 6/30 [00:25<02:00,  5.03s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0335, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.8758, 'compress@10': 0.9817, 'time@10': 5.9522}:  20%|██        | 6/30 [00:29<02:00,  5.03s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0335, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.8758, 'compress@10': 0.9817, 'time@10': 5.9522}:  23%|██▎       | 7/30 [00:29<01:47,  4.66s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0329, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.8832, 'compress@10': 0.9815, 'time@10': 5.9138}:  23%|██▎       | 7/30 [00:35<01:47,  4.66s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0329, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.8832, 'compress@10': 0.9815, 'time@10': 5.9138}:  27%|██▋       | 8/30 [00:35<01:49,  4.99s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0327, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.8894, 'compress@10': 0.9815, 'time@10': 6.0808}:  27%|██▋       | 8/30 [00:38<01:49,  4.99s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0327, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.8894, 'compress@10': 0.9815, 'time@10': 6.0808}:  30%|███       | 9/30 [00:38<01:36,  4.60s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.8929, 'compress@10': 0.9822, 'time@10': 6.1354}:  30%|███       | 9/30 [00:45<01:36,  4.60s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.8929, 'compress@10': 0.9822, 'time@10': 6.1354}:  33%|███▎      | 10/30 [00:45<01:44,  5.24s/it]{'epoch': 23, 'num_users': 6.6364, 'loss': 0.0342, 'hit_ratio@10': 0.889, 'ndcg@10': 0.8926, 'compress@10': 0.9829, 'time@10': 6.2083}:  33%|███▎      | 10/30 [00:49<01:44,  5.24s/it]{'epoch': 23, 'num_users': 6.6364, 'loss': 0.0342, 'hit_ratio@10': 0.889, 'ndcg@10': 0.8926, 'compress@10': 0.9829, 'time@10': 6.2083}:  37%|███▋      | 11/30 [00:49<01:29,  4.71s/it]{'epoch': 23, 'num_users': 6.4167, 'loss': 0.032, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.8938, 'compress@10': 0.983, 'time@10': 5.9632}:  37%|███▋      | 11/30 [00:52<01:29,  4.71s/it] {'epoch': 23, 'num_users': 6.4167, 'loss': 0.032, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.8938, 'compress@10': 0.983, 'time@10': 5.9632}:  40%|████      | 12/30 [00:52<01:17,  4.28s/it]{'epoch': 23, 'num_users': 6.6154, 'loss': 0.0324, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8943, 'compress@10': 0.9836, 'time@10': 5.9451}:  40%|████      | 12/30 [00:55<01:17,  4.28s/it]{'epoch': 23, 'num_users': 6.6154, 'loss': 0.0324, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8943, 'compress@10': 0.9836, 'time@10': 5.9451}:  43%|████▎     | 13/30 [00:55<01:05,  3.86s/it]{'epoch': 23, 'num_users': 6.3571, 'loss': 0.0303, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8886, 'compress@10': 0.9839, 'time@10': 5.6688}:  43%|████▎     | 13/30 [00:57<01:05,  3.86s/it] {'epoch': 23, 'num_users': 6.3571, 'loss': 0.0303, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8886, 'compress@10': 0.9839, 'time@10': 5.6688}:  47%|████▋     | 14/30 [00:57<00:53,  3.34s/it]{'epoch': 23, 'num_users': 6.2667, 'loss': 0.0311, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8893, 'compress@10': 0.984, 'time@10': 5.8536}:  47%|████▋     | 14/30 [01:01<00:53,  3.34s/it] {'epoch': 23, 'num_users': 6.2667, 'loss': 0.0311, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8893, 'compress@10': 0.984, 'time@10': 5.8536}:  50%|█████     | 15/30 [01:01<00:54,  3.61s/it]{'epoch': 23, 'num_users': 6.0625, 'loss': 0.0296, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8902, 'compress@10': 0.984, 'time@10': 5.6927}:  50%|█████     | 15/30 [01:05<00:54,  3.61s/it]{'epoch': 23, 'num_users': 6.0625, 'loss': 0.0296, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8902, 'compress@10': 0.984, 'time@10': 5.6927}:  53%|█████▎    | 16/30 [01:05<00:49,  3.53s/it]{'epoch': 23, 'num_users': 5.8235, 'loss': 0.028, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8832, 'compress@10': 0.9844, 'time@10': 5.5485}:  53%|█████▎    | 16/30 [01:06<00:49,  3.53s/it]{'epoch': 23, 'num_users': 5.8235, 'loss': 0.028, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8832, 'compress@10': 0.9844, 'time@10': 5.5485}:  57%|█████▋    | 17/30 [01:06<00:38,  2.96s/it]{'epoch': 23, 'num_users': 6.0556, 'loss': 0.0282, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8839, 'compress@10': 0.9843, 'time@10': 5.4895}:  57%|█████▋    | 17/30 [01:11<00:38,  2.96s/it]{'epoch': 23, 'num_users': 6.0556, 'loss': 0.0282, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8839, 'compress@10': 0.9843, 'time@10': 5.4895}:  60%|██████    | 18/30 [01:11<00:41,  3.43s/it]{'epoch': 23, 'num_users': 6.0, 'loss': 0.0275, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8848, 'compress@10': 0.9844, 'time@10': 5.4278}:  60%|██████    | 18/30 [01:13<00:41,  3.43s/it]   {'epoch': 23, 'num_users': 6.0, 'loss': 0.0275, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8848, 'compress@10': 0.9844, 'time@10': 5.4278}:  63%|██████▎   | 19/30 [01:13<00:33,  3.06s/it]{'epoch': 23, 'num_users': 6.15, 'loss': 0.0276, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8848, 'compress@10': 0.9849, 'time@10': 5.5841}:  63%|██████▎   | 19/30 [01:21<00:33,  3.06s/it]{'epoch': 23, 'num_users': 6.15, 'loss': 0.0276, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8848, 'compress@10': 0.9849, 'time@10': 5.5841}:  67%|██████▋   | 20/30 [01:21<00:47,  4.72s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0289, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8825, 'compress@10': 0.9847, 'time@10': 5.6853}:  67%|██████▋   | 20/30 [01:25<00:47,  4.72s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0289, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8825, 'compress@10': 0.9847, 'time@10': 5.6853}:  70%|███████   | 21/30 [01:25<00:40,  4.48s/it]{'epoch': 23, 'num_users': 6.1818, 'loss': 0.0295, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8832, 'compress@10': 0.9847, 'time@10': 5.5839}:  70%|███████   | 21/30 [01:29<00:40,  4.48s/it]{'epoch': 23, 'num_users': 6.1818, 'loss': 0.0295, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8832, 'compress@10': 0.9847, 'time@10': 5.5839}:  73%|███████▎  | 22/30 [01:29<00:33,  4.18s/it]{'epoch': 23, 'num_users': 6.1304, 'loss': 0.029, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.885, 'compress@10': 0.9847, 'time@10': 5.6277}:  73%|███████▎  | 22/30 [01:32<00:33,  4.18s/it]  {'epoch': 23, 'num_users': 6.1304, 'loss': 0.029, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.885, 'compress@10': 0.9847, 'time@10': 5.6277}:  77%|███████▋  | 23/30 [01:32<00:27,  3.93s/it]{'epoch': 23, 'num_users': 5.9583, 'loss': 0.0281, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8791, 'compress@10': 0.9847, 'time@10': 5.494}:  77%|███████▋  | 23/30 [01:35<00:27,  3.93s/it]{'epoch': 23, 'num_users': 5.9583, 'loss': 0.0281, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8791, 'compress@10': 0.9847, 'time@10': 5.494}:  80%|████████  | 24/30 [01:35<00:20,  3.49s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0271, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8688, 'compress@10': 0.985, 'time@10': 5.3609}:  80%|████████  | 24/30 [01:36<00:20,  3.49s/it]   {'epoch': 23, 'num_users': 5.8, 'loss': 0.0271, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8688, 'compress@10': 0.985, 'time@10': 5.3609}:  83%|████████▎ | 25/30 [01:36<00:13,  2.78s/it]{'epoch': 23, 'num_users': 5.8077, 'loss': 0.0272, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8697, 'compress@10': 0.985, 'time@10': 5.4623}:  83%|████████▎ | 25/30 [01:44<00:13,  2.78s/it]{'epoch': 23, 'num_users': 5.8077, 'loss': 0.0272, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8697, 'compress@10': 0.985, 'time@10': 5.4623}:  87%|████████▋ | 26/30 [01:44<00:17,  4.36s/it]{'epoch': 23, 'num_users': 5.8889, 'loss': 0.0269, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8711, 'compress@10': 0.985, 'time@10': 5.5736}:  87%|████████▋ | 26/30 [01:48<00:17,  4.36s/it]{'epoch': 23, 'num_users': 5.8889, 'loss': 0.0269, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8711, 'compress@10': 0.985, 'time@10': 5.5736}:  90%|█████████ | 27/30 [01:48<00:12,  4.33s/it]{'epoch': 23, 'num_users': 6.0, 'loss': 0.0269, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8723, 'compress@10': 0.9849, 'time@10': 5.67}:  90%|█████████ | 27/30 [01:56<00:12,  4.33s/it]    {'epoch': 23, 'num_users': 6.0, 'loss': 0.0269, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8723, 'compress@10': 0.9849, 'time@10': 5.67}:  93%|█████████▎| 28/30 [01:56<00:11,  5.53s/it]{'epoch': 23, 'num_users': 5.8621, 'loss': 0.0266, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8741, 'compress@10': 0.985, 'time@10': 5.7119}:  93%|█████████▎| 28/30 [02:00<00:11,  5.53s/it]{'epoch': 23, 'num_users': 5.8621, 'loss': 0.0266, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8741, 'compress@10': 0.985, 'time@10': 5.7119}:  97%|█████████▋| 29/30 [02:00<00:04,  4.91s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0268, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8751, 'compress@10': 0.985, 'time@10': 5.7196}:  97%|█████████▋| 29/30 [02:06<00:04,  4.91s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0268, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8751, 'compress@10': 0.985, 'time@10': 5.7196}: 100%|██████████| 30/30 [02:06<00:00,  5.24s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0268, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8751, 'compress@10': 0.985, 'time@10': 5.7196}: 100%|██████████| 30/30 [02:06<00:00,  4.21s/it]
Epoch: 23
Avg # of users: 5.866666666666666
Avg Loss: 0.02675835463823378
Avg hit ratio: 0.8654829923769168
Avg ndcg: 0.875113717157342
Avg compression ratio: 0.9849935163292903
Avg train time: 5.719634572664897
Std train time: 2.0774045837864397
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 20, 10, 34, 9, 19, 25, 10, 10, 9, 6, 10, 10, 34, 34, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8782, 'compress@10': 0.9802, 'time@10': 5.8931}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8782, 'compress@10': 0.9802, 'time@10': 5.8931}:   3%|▎         | 1/30 [00:02<01:26,  2.99s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0308, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8908, 'compress@10': 0.9813, 'time@10': 5.4444}:   3%|▎         | 1/30 [00:08<01:26,  2.99s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0308, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8908, 'compress@10': 0.9813, 'time@10': 5.4444}:   7%|▋         | 2/30 [00:08<01:57,  4.19s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8796, 'compress@10': 0.9826, 'time@10': 4.8932}:   7%|▋         | 2/30 [00:09<01:57,  4.19s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8796, 'compress@10': 0.9826, 'time@10': 4.8932}:  10%|█         | 3/30 [00:09<01:25,  3.16s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8917, 'compress@10': 0.9827, 'time@10': 4.7838}:  10%|█         | 3/30 [00:14<01:25,  3.16s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8917, 'compress@10': 0.9827, 'time@10': 4.7838}:  13%|█▎        | 4/30 [00:14<01:35,  3.69s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0307, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8712, 'compress@10': 0.9827, 'time@10': 5.4763}:  13%|█▎        | 4/30 [00:18<01:35,  3.69s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0307, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8712, 'compress@10': 0.9827, 'time@10': 5.4763}:  17%|█▋        | 5/30 [00:18<01:36,  3.86s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0299, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.8764, 'compress@10': 0.9819, 'time@10': 5.8252}:  17%|█▋        | 5/30 [00:26<01:36,  3.86s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0299, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.8764, 'compress@10': 0.9819, 'time@10': 5.8252}:  20%|██        | 6/30 [00:26<02:03,  5.14s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0297, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.876, 'compress@10': 0.9818, 'time@10': 6.1433}:  20%|██        | 6/30 [00:30<02:03,  5.14s/it] {'epoch': 24, 'num_users': 6.2857, 'loss': 0.0297, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.876, 'compress@10': 0.9818, 'time@10': 6.1433}:  23%|██▎       | 7/30 [00:30<01:50,  4.79s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0295, 'hit_ratio@10': 0.908, 'ndcg@10': 0.8851, 'compress@10': 0.9815, 'time@10': 6.037}:  23%|██▎       | 7/30 [00:35<01:50,  4.79s/it]  {'epoch': 24, 'num_users': 6.125, 'loss': 0.0295, 'hit_ratio@10': 0.908, 'ndcg@10': 0.8851, 'compress@10': 0.9815, 'time@10': 6.037}:  27%|██▋       | 8/30 [00:35<01:49,  4.96s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0298, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.891, 'compress@10': 0.9815, 'time@10': 6.1284}:  27%|██▋       | 8/30 [00:39<01:49,  4.96s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0298, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.891, 'compress@10': 0.9815, 'time@10': 6.1284}:  30%|███       | 9/30 [00:39<01:34,  4.50s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.8956, 'compress@10': 0.9818, 'time@10': 6.1607}:  30%|███       | 9/30 [00:45<01:34,  4.50s/it]  {'epoch': 24, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.8956, 'compress@10': 0.9818, 'time@10': 6.1607}:  33%|███▎      | 10/30 [00:45<01:42,  5.11s/it]{'epoch': 24, 'num_users': 6.6364, 'loss': 0.0297, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.8948, 'compress@10': 0.9825, 'time@10': 6.2391}:  33%|███▎      | 10/30 [00:49<01:42,  5.11s/it]{'epoch': 24, 'num_users': 6.6364, 'loss': 0.0297, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.8948, 'compress@10': 0.9825, 'time@10': 6.2391}:  37%|███▋      | 11/30 [00:49<01:28,  4.63s/it]{'epoch': 24, 'num_users': 6.4167, 'loss': 0.0279, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8961, 'compress@10': 0.9827, 'time@10': 6.0021}:  37%|███▋      | 11/30 [00:52<01:28,  4.63s/it] {'epoch': 24, 'num_users': 6.4167, 'loss': 0.0279, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8961, 'compress@10': 0.9827, 'time@10': 6.0021}:  40%|████      | 12/30 [00:52<01:16,  4.27s/it]{'epoch': 24, 'num_users': 6.6154, 'loss': 0.0285, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8965, 'compress@10': 0.9833, 'time@10': 5.9779}:  40%|████      | 12/30 [00:55<01:16,  4.27s/it]{'epoch': 24, 'num_users': 6.6154, 'loss': 0.0285, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8965, 'compress@10': 0.9833, 'time@10': 5.9779}:  43%|████▎     | 13/30 [00:55<01:05,  3.85s/it]{'epoch': 24, 'num_users': 6.3571, 'loss': 0.0267, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8906, 'compress@10': 0.9836, 'time@10': 5.7011}:  43%|████▎     | 13/30 [00:57<01:05,  3.85s/it]{'epoch': 24, 'num_users': 6.3571, 'loss': 0.0267, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8906, 'compress@10': 0.9836, 'time@10': 5.7011}:  47%|████▋     | 14/30 [00:57<00:53,  3.33s/it]{'epoch': 24, 'num_users': 6.2667, 'loss': 0.0278, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8909, 'compress@10': 0.9837, 'time@10': 5.9153}:  47%|████▋     | 14/30 [01:02<00:53,  3.33s/it]{'epoch': 24, 'num_users': 6.2667, 'loss': 0.0278, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8909, 'compress@10': 0.9837, 'time@10': 5.9153}:  50%|█████     | 15/30 [01:02<00:55,  3.68s/it]{'epoch': 24, 'num_users': 6.0625, 'loss': 0.0264, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8917, 'compress@10': 0.9837, 'time@10': 5.7603}:  50%|█████     | 15/30 [01:05<00:55,  3.68s/it]{'epoch': 24, 'num_users': 6.0625, 'loss': 0.0264, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8917, 'compress@10': 0.9837, 'time@10': 5.7603}:  53%|█████▎    | 16/30 [01:05<00:50,  3.62s/it]{'epoch': 24, 'num_users': 5.8235, 'loss': 0.025, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8846, 'compress@10': 0.9842, 'time@10': 5.6149}:  53%|█████▎    | 16/30 [01:07<00:50,  3.62s/it] {'epoch': 24, 'num_users': 5.8235, 'loss': 0.025, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8846, 'compress@10': 0.9842, 'time@10': 5.6149}:  57%|█████▋    | 17/30 [01:07<00:39,  3.04s/it]{'epoch': 24, 'num_users': 6.0556, 'loss': 0.0253, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8855, 'compress@10': 0.9841, 'time@10': 5.547}:  57%|█████▋    | 17/30 [01:11<00:39,  3.04s/it]{'epoch': 24, 'num_users': 6.0556, 'loss': 0.0253, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8855, 'compress@10': 0.9841, 'time@10': 5.547}:  60%|██████    | 18/30 [01:11<00:41,  3.46s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 0.0247, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8864, 'compress@10': 0.9842, 'time@10': 5.4647}:  60%|██████    | 18/30 [01:13<00:41,  3.46s/it]  {'epoch': 24, 'num_users': 6.0, 'loss': 0.0247, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8864, 'compress@10': 0.9842, 'time@10': 5.4647}:  63%|██████▎   | 19/30 [01:13<00:33,  3.03s/it]{'epoch': 24, 'num_users': 6.15, 'loss': 0.0249, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.8869, 'compress@10': 0.9847, 'time@10': 5.6064}:  63%|██████▎   | 19/30 [01:22<00:33,  3.03s/it]{'epoch': 24, 'num_users': 6.15, 'loss': 0.0249, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.8869, 'compress@10': 0.9847, 'time@10': 5.6064}:  67%|██████▋   | 20/30 [01:22<00:46,  4.62s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0264, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8843, 'compress@10': 0.9845, 'time@10': 5.7038}:  67%|██████▋   | 20/30 [01:25<00:46,  4.62s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0264, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8843, 'compress@10': 0.9845, 'time@10': 5.7038}:  70%|███████   | 21/30 [01:25<00:39,  4.40s/it]{'epoch': 24, 'num_users': 6.1818, 'loss': 0.0271, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.885, 'compress@10': 0.9845, 'time@10': 5.5923}:  70%|███████   | 21/30 [01:29<00:39,  4.40s/it] {'epoch': 24, 'num_users': 6.1818, 'loss': 0.0271, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.885, 'compress@10': 0.9845, 'time@10': 5.5923}:  73%|███████▎  | 22/30 [01:29<00:32,  4.07s/it]{'epoch': 24, 'num_users': 6.1304, 'loss': 0.0266, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8869, 'compress@10': 0.9846, 'time@10': 5.6211}:  73%|███████▎  | 22/30 [01:32<00:32,  4.07s/it]{'epoch': 24, 'num_users': 6.1304, 'loss': 0.0266, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8869, 'compress@10': 0.9846, 'time@10': 5.6211}:  77%|███████▋  | 23/30 [01:32<00:26,  3.80s/it]{'epoch': 24, 'num_users': 5.9583, 'loss': 0.0258, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.881, 'compress@10': 0.9847, 'time@10': 5.4792}:  77%|███████▋  | 23/30 [01:34<00:26,  3.80s/it] {'epoch': 24, 'num_users': 5.9583, 'loss': 0.0258, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.881, 'compress@10': 0.9847, 'time@10': 5.4792}:  80%|████████  | 24/30 [01:34<00:20,  3.33s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0249, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8706, 'compress@10': 0.985, 'time@10': 5.3481}:  80%|████████  | 24/30 [01:35<00:20,  3.33s/it]   {'epoch': 24, 'num_users': 5.8, 'loss': 0.0249, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8706, 'compress@10': 0.985, 'time@10': 5.3481}:  83%|████████▎ | 25/30 [01:35<00:13,  2.68s/it]{'epoch': 24, 'num_users': 5.8077, 'loss': 0.0251, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8718, 'compress@10': 0.985, 'time@10': 5.4498}:  83%|████████▎ | 25/30 [01:43<00:13,  2.68s/it]{'epoch': 24, 'num_users': 5.8077, 'loss': 0.0251, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8718, 'compress@10': 0.985, 'time@10': 5.4498}:  87%|████████▋ | 26/30 [01:43<00:17,  4.28s/it]{'epoch': 24, 'num_users': 5.8889, 'loss': 0.0248, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8732, 'compress@10': 0.985, 'time@10': 5.5085}:  87%|████████▋ | 26/30 [01:47<00:17,  4.28s/it]{'epoch': 24, 'num_users': 5.8889, 'loss': 0.0248, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8732, 'compress@10': 0.985, 'time@10': 5.5085}:  90%|█████████ | 27/30 [01:47<00:12,  4.07s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 0.0246, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8748, 'compress@10': 0.985, 'time@10': 5.5909}:  90%|█████████ | 27/30 [01:55<00:12,  4.07s/it]   {'epoch': 24, 'num_users': 6.0, 'loss': 0.0246, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8748, 'compress@10': 0.985, 'time@10': 5.5909}:  93%|█████████▎| 28/30 [01:55<00:10,  5.20s/it]{'epoch': 24, 'num_users': 5.8621, 'loss': 0.0243, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8766, 'compress@10': 0.9851, 'time@10': 5.635}:  93%|█████████▎| 28/30 [01:58<00:10,  5.20s/it]{'epoch': 24, 'num_users': 5.8621, 'loss': 0.0243, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8766, 'compress@10': 0.9851, 'time@10': 5.635}:  97%|█████████▋| 29/30 [01:58<00:04,  4.73s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0245, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8778, 'compress@10': 0.985, 'time@10': 5.6448}:  97%|█████████▋| 29/30 [02:04<00:04,  4.73s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0245, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8778, 'compress@10': 0.985, 'time@10': 5.6448}: 100%|██████████| 30/30 [02:04<00:00,  5.10s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0245, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8778, 'compress@10': 0.985, 'time@10': 5.6448}: 100%|██████████| 30/30 [02:04<00:00,  4.16s/it]
Epoch: 24
Avg # of users: 5.866666666666666
Avg Loss: 0.024511851538710123
Avg hit ratio: 0.8685570664509911
Avg ndcg: 0.8778442734862714
Avg compression ratio: 0.9850194358657939
Avg train time: 5.6447544892628985
Std train time: 2.0275024815176708
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 20, 10, 35, 9, 19, 25, 10, 10, 9, 6, 10, 10, 35, 35, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8806, 'compress@10': 0.9803, 'time@10': 5.8808}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8806, 'compress@10': 0.9803, 'time@10': 5.8808}:   3%|▎         | 1/30 [00:02<01:26,  2.98s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0299, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8926, 'compress@10': 0.9809, 'time@10': 5.3198}:   3%|▎         | 1/30 [00:07<01:26,  2.98s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0299, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8926, 'compress@10': 0.9809, 'time@10': 5.3198}:   7%|▋         | 2/30 [00:07<01:53,  4.05s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8808, 'compress@10': 0.9824, 'time@10': 4.8021}:   7%|▋         | 2/30 [00:09<01:53,  4.05s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8808, 'compress@10': 0.9824, 'time@10': 4.8021}:  10%|█         | 3/30 [00:09<01:23,  3.08s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8907, 'compress@10': 0.9825, 'time@10': 4.7138}:  10%|█         | 3/30 [00:14<01:23,  3.08s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8907, 'compress@10': 0.9825, 'time@10': 4.7138}:  13%|█▎        | 4/30 [00:14<01:34,  3.64s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0303, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8712, 'compress@10': 0.9826, 'time@10': 5.4074}:  13%|█▎        | 4/30 [00:18<01:34,  3.64s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0303, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8712, 'compress@10': 0.9826, 'time@10': 5.4074}:  17%|█▋        | 5/30 [00:18<01:35,  3.81s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0306, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.8754, 'compress@10': 0.9823, 'time@10': 5.8547}:  17%|█▋        | 5/30 [00:26<01:35,  3.81s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0306, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.8754, 'compress@10': 0.9823, 'time@10': 5.8547}:  20%|██        | 6/30 [00:26<02:06,  5.28s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.031, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.8786, 'compress@10': 0.9823, 'time@10': 6.1526}:  20%|██        | 6/30 [00:30<02:06,  5.28s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.031, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.8786, 'compress@10': 0.9823, 'time@10': 6.1526}:  23%|██▎       | 7/30 [00:30<01:51,  4.87s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0306, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.8874, 'compress@10': 0.982, 'time@10': 6.0901}:  23%|██▎       | 7/30 [00:36<01:51,  4.87s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0306, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.8874, 'compress@10': 0.982, 'time@10': 6.0901}:  27%|██▋       | 8/30 [00:36<01:52,  5.13s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0309, 'hit_ratio@10': 0.896, 'ndcg@10': 0.8926, 'compress@10': 0.9819, 'time@10': 6.1774}:  27%|██▋       | 8/30 [00:39<01:52,  5.13s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0309, 'hit_ratio@10': 0.896, 'ndcg@10': 0.8926, 'compress@10': 0.9819, 'time@10': 6.1774}:  30%|███       | 9/30 [00:39<01:36,  4.61s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0309, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.896, 'compress@10': 0.9824, 'time@10': 6.1939}:  30%|███       | 9/30 [00:46<01:36,  4.61s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0309, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.896, 'compress@10': 0.9824, 'time@10': 6.1939}:  33%|███▎      | 10/30 [00:46<01:43,  5.16s/it]{'epoch': 25, 'num_users': 6.6364, 'loss': 0.032, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.8952, 'compress@10': 0.9831, 'time@10': 6.3762}:  33%|███▎      | 10/30 [00:50<01:43,  5.16s/it]{'epoch': 25, 'num_users': 6.6364, 'loss': 0.032, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.8952, 'compress@10': 0.9831, 'time@10': 6.3762}:  37%|███▋      | 11/30 [00:50<01:32,  4.85s/it]{'epoch': 25, 'num_users': 6.4167, 'loss': 0.0299, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8964, 'compress@10': 0.9832, 'time@10': 6.1012}:  37%|███▋      | 11/30 [00:53<01:32,  4.85s/it]{'epoch': 25, 'num_users': 6.4167, 'loss': 0.0299, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8964, 'compress@10': 0.9832, 'time@10': 6.1012}:  40%|████      | 12/30 [00:53<01:17,  4.32s/it]{'epoch': 25, 'num_users': 6.6154, 'loss': 0.0302, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.897, 'compress@10': 0.9838, 'time@10': 6.118}:  40%|████      | 12/30 [00:56<01:17,  4.32s/it]  {'epoch': 25, 'num_users': 6.6154, 'loss': 0.0302, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.897, 'compress@10': 0.9838, 'time@10': 6.118}:  43%|████▎     | 13/30 [00:56<01:07,  3.98s/it]{'epoch': 25, 'num_users': 6.3571, 'loss': 0.0283, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.8911, 'compress@10': 0.984, 'time@10': 5.8521}:  43%|████▎     | 13/30 [00:58<01:07,  3.98s/it]{'epoch': 25, 'num_users': 6.3571, 'loss': 0.0283, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.8911, 'compress@10': 0.984, 'time@10': 5.8521}:  47%|████▋     | 14/30 [00:58<00:56,  3.51s/it]{'epoch': 25, 'num_users': 6.2667, 'loss': 0.0292, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.891, 'compress@10': 0.9841, 'time@10': 5.9484}:  47%|████▋     | 14/30 [01:02<00:56,  3.51s/it]{'epoch': 25, 'num_users': 6.2667, 'loss': 0.0292, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.891, 'compress@10': 0.9841, 'time@10': 5.9484}:  50%|█████     | 15/30 [01:02<00:53,  3.57s/it]{'epoch': 25, 'num_users': 6.0625, 'loss': 0.0277, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8919, 'compress@10': 0.9842, 'time@10': 5.7891}:  50%|█████     | 15/30 [01:06<00:53,  3.57s/it]{'epoch': 25, 'num_users': 6.0625, 'loss': 0.0277, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8919, 'compress@10': 0.9842, 'time@10': 5.7891}:  53%|█████▎    | 16/30 [01:06<00:49,  3.53s/it]{'epoch': 25, 'num_users': 5.8235, 'loss': 0.0262, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8847, 'compress@10': 0.9846, 'time@10': 5.6416}:  53%|█████▎    | 16/30 [01:07<00:49,  3.53s/it]{'epoch': 25, 'num_users': 5.8235, 'loss': 0.0262, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8847, 'compress@10': 0.9846, 'time@10': 5.6416}:  57%|█████▋    | 17/30 [01:07<00:38,  2.97s/it]{'epoch': 25, 'num_users': 6.0556, 'loss': 0.0264, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8851, 'compress@10': 0.9845, 'time@10': 5.5782}:  57%|█████▋    | 17/30 [01:12<00:38,  2.97s/it]{'epoch': 25, 'num_users': 6.0556, 'loss': 0.0264, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8851, 'compress@10': 0.9845, 'time@10': 5.5782}:  60%|██████    | 18/30 [01:12<00:41,  3.44s/it]{'epoch': 25, 'num_users': 6.0, 'loss': 0.0257, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8859, 'compress@10': 0.9846, 'time@10': 5.5098}:  60%|██████    | 18/30 [01:14<00:41,  3.44s/it]  {'epoch': 25, 'num_users': 6.0, 'loss': 0.0257, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8859, 'compress@10': 0.9846, 'time@10': 5.5098}:  63%|██████▎   | 19/30 [01:14<00:33,  3.07s/it]{'epoch': 25, 'num_users': 6.15, 'loss': 0.0259, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8868, 'compress@10': 0.985, 'time@10': 5.6522}:  63%|██████▎   | 19/30 [01:22<00:33,  3.07s/it]{'epoch': 25, 'num_users': 6.15, 'loss': 0.0259, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8868, 'compress@10': 0.985, 'time@10': 5.6522}:  67%|██████▋   | 20/30 [01:22<00:46,  4.67s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0271, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8846, 'compress@10': 0.9849, 'time@10': 5.7525}:  67%|██████▋   | 20/30 [01:26<00:46,  4.67s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0271, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8846, 'compress@10': 0.9849, 'time@10': 5.7525}:  70%|███████   | 21/30 [01:26<00:39,  4.44s/it]{'epoch': 25, 'num_users': 6.1818, 'loss': 0.0278, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.885, 'compress@10': 0.9849, 'time@10': 5.647}:  70%|███████   | 21/30 [01:30<00:39,  4.44s/it]  {'epoch': 25, 'num_users': 6.1818, 'loss': 0.0278, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.885, 'compress@10': 0.9849, 'time@10': 5.647}:  73%|███████▎  | 22/30 [01:30<00:33,  4.15s/it]{'epoch': 25, 'num_users': 6.1304, 'loss': 0.0273, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8867, 'compress@10': 0.9851, 'time@10': 5.6735}:  73%|███████▎  | 22/30 [01:33<00:33,  4.15s/it]{'epoch': 25, 'num_users': 6.1304, 'loss': 0.0273, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8867, 'compress@10': 0.9851, 'time@10': 5.6735}:  77%|███████▋  | 23/30 [01:33<00:26,  3.86s/it]{'epoch': 25, 'num_users': 5.9583, 'loss': 0.0264, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8808, 'compress@10': 0.9852, 'time@10': 5.5327}:  77%|███████▋  | 23/30 [01:35<00:26,  3.86s/it] {'epoch': 25, 'num_users': 5.9583, 'loss': 0.0264, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8808, 'compress@10': 0.9852, 'time@10': 5.5327}:  80%|████████  | 24/30 [01:35<00:20,  3.40s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0255, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8704, 'compress@10': 0.9854, 'time@10': 5.402}:  80%|████████  | 24/30 [01:36<00:20,  3.40s/it]   {'epoch': 25, 'num_users': 5.8, 'loss': 0.0255, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8704, 'compress@10': 0.9854, 'time@10': 5.402}:  83%|████████▎ | 25/30 [01:36<00:13,  2.73s/it]{'epoch': 25, 'num_users': 5.8077, 'loss': 0.0256, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8717, 'compress@10': 0.9854, 'time@10': 5.5035}:  83%|████████▎ | 25/30 [01:44<00:13,  2.73s/it]{'epoch': 25, 'num_users': 5.8077, 'loss': 0.0256, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8717, 'compress@10': 0.9854, 'time@10': 5.5035}:  87%|████████▋ | 26/30 [01:44<00:17,  4.34s/it]{'epoch': 25, 'num_users': 5.8889, 'loss': 0.0253, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8732, 'compress@10': 0.9854, 'time@10': 5.5692}:  87%|████████▋ | 26/30 [01:48<00:17,  4.34s/it]{'epoch': 25, 'num_users': 5.8889, 'loss': 0.0253, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8732, 'compress@10': 0.9854, 'time@10': 5.5692}:  90%|█████████ | 27/30 [01:48<00:12,  4.15s/it]{'epoch': 25, 'num_users': 6.0, 'loss': 0.0254, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8752, 'compress@10': 0.9853, 'time@10': 5.6775}:  90%|█████████ | 27/30 [01:57<00:12,  4.15s/it]   {'epoch': 25, 'num_users': 6.0, 'loss': 0.0254, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8752, 'compress@10': 0.9853, 'time@10': 5.6775}:  93%|█████████▎| 28/30 [01:57<00:10,  5.50s/it]{'epoch': 25, 'num_users': 5.8621, 'loss': 0.0251, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.877, 'compress@10': 0.9854, 'time@10': 5.7167}:  93%|█████████▎| 28/30 [02:00<00:10,  5.50s/it]{'epoch': 25, 'num_users': 5.8621, 'loss': 0.0251, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.877, 'compress@10': 0.9854, 'time@10': 5.7167}:  97%|█████████▋| 29/30 [02:00<00:04,  4.88s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.0253, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8782, 'compress@10': 0.9853, 'time@10': 5.7253}:  97%|█████████▋| 29/30 [02:06<00:04,  4.88s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.0253, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8782, 'compress@10': 0.9853, 'time@10': 5.7253}: 100%|██████████| 30/30 [02:06<00:00,  5.22s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.0253, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8782, 'compress@10': 0.9853, 'time@10': 5.7253}: 100%|██████████| 30/30 [02:06<00:00,  4.23s/it]
Epoch: 25
Avg # of users: 5.866666666666666
Avg Loss: 0.025270633340189218
Avg hit ratio: 0.8695094474033719
Avg ndcg: 0.8781917262602271
Avg compression ratio: 0.9853332576578863
Avg train time: 5.725264016787211
Std train time: 2.035715106434924
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 21, 10, 36, 9, 19, 25, 10, 10, 9, 6, 10, 10, 36, 36, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0367, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8806, 'compress@10': 0.9846, 'time@10': 5.9673}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0367, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8806, 'compress@10': 0.9846, 'time@10': 5.9673}:   3%|▎         | 1/30 [00:03<01:27,  3.02s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8926, 'compress@10': 0.9832, 'time@10': 5.454}:   3%|▎         | 1/30 [00:08<01:27,  3.02s/it] {'epoch': 26, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8926, 'compress@10': 0.9832, 'time@10': 5.454}:   7%|▋         | 2/30 [00:08<01:56,  4.17s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8808, 'compress@10': 0.9838, 'time@10': 4.8907}:   7%|▋         | 2/30 [00:09<01:56,  4.17s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8808, 'compress@10': 0.9838, 'time@10': 4.8907}:  10%|█         | 3/30 [00:09<01:24,  3.15s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8829, 'compress@10': 0.9833, 'time@10': 4.7425}:  10%|█         | 3/30 [00:14<01:24,  3.15s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8829, 'compress@10': 0.9833, 'time@10': 4.7425}:  13%|█▎        | 4/30 [00:14<01:34,  3.62s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0316, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8655, 'compress@10': 0.9831, 'time@10': 5.3685}:  13%|█▎        | 4/30 [00:18<01:34,  3.62s/it] {'epoch': 26, 'num_users': 5.8, 'loss': 0.0316, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8655, 'compress@10': 0.9831, 'time@10': 5.3685}:  17%|█▋        | 5/30 [00:18<01:33,  3.75s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.8736, 'compress@10': 0.984, 'time@10': 5.683}:  17%|█▋        | 5/30 [00:25<01:33,  3.75s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.8736, 'compress@10': 0.984, 'time@10': 5.683}:  20%|██        | 6/30 [00:25<01:58,  4.95s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0315, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.8746, 'compress@10': 0.9835, 'time@10': 5.956}:  20%|██        | 6/30 [00:29<01:58,  4.95s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0315, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.8746, 'compress@10': 0.9835, 'time@10': 5.956}:  23%|██▎       | 7/30 [00:29<01:45,  4.59s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0309, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.884, 'compress@10': 0.9831, 'time@10': 5.8785}:  23%|██▎       | 7/30 [00:34<01:45,  4.59s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0309, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.884, 'compress@10': 0.9831, 'time@10': 5.8785}:  27%|██▋       | 8/30 [00:34<01:46,  4.84s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0311, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.8896, 'compress@10': 0.9829, 'time@10': 6.1556}:  27%|██▋       | 8/30 [00:38<01:46,  4.84s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0311, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.8896, 'compress@10': 0.9829, 'time@10': 6.1556}:  30%|███       | 9/30 [00:38<01:37,  4.65s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.8956, 'compress@10': 0.983, 'time@10': 6.128}:  30%|███       | 9/30 [00:44<01:37,  4.65s/it]     {'epoch': 26, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.8956, 'compress@10': 0.983, 'time@10': 6.128}:  33%|███▎      | 10/30 [00:44<01:40,  5.04s/it]{'epoch': 26, 'num_users': 6.6364, 'loss': 0.0308, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8948, 'compress@10': 0.9835, 'time@10': 6.2457}:  33%|███▎      | 10/30 [00:48<01:40,  5.04s/it]{'epoch': 26, 'num_users': 6.6364, 'loss': 0.0308, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8948, 'compress@10': 0.9835, 'time@10': 6.2457}:  37%|███▋      | 11/30 [00:48<01:28,  4.65s/it]{'epoch': 26, 'num_users': 6.4167, 'loss': 0.0288, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8966, 'compress@10': 0.9836, 'time@10': 6.014}:  37%|███▋      | 11/30 [00:52<01:28,  4.65s/it] {'epoch': 26, 'num_users': 6.4167, 'loss': 0.0288, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8966, 'compress@10': 0.9836, 'time@10': 6.014}:  40%|████      | 12/30 [00:52<01:17,  4.30s/it]{'epoch': 26, 'num_users': 6.6154, 'loss': 0.0291, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8971, 'compress@10': 0.9842, 'time@10': 6.0192}:  40%|████      | 12/30 [00:55<01:17,  4.30s/it]{'epoch': 26, 'num_users': 6.6154, 'loss': 0.0291, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8971, 'compress@10': 0.9842, 'time@10': 6.0192}:  43%|████▎     | 13/30 [00:55<01:06,  3.93s/it]{'epoch': 26, 'num_users': 6.3571, 'loss': 0.0272, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8911, 'compress@10': 0.9844, 'time@10': 5.7879}:  43%|████▎     | 13/30 [00:58<01:06,  3.93s/it]{'epoch': 26, 'num_users': 6.3571, 'loss': 0.0272, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8911, 'compress@10': 0.9844, 'time@10': 5.7879}:  47%|████▋     | 14/30 [00:58<00:57,  3.59s/it]{'epoch': 26, 'num_users': 6.2667, 'loss': 0.0282, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8923, 'compress@10': 0.9845, 'time@10': 5.8658}:  47%|████▋     | 14/30 [01:01<00:57,  3.59s/it]{'epoch': 26, 'num_users': 6.2667, 'loss': 0.0282, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8923, 'compress@10': 0.9845, 'time@10': 5.8658}:  50%|█████     | 15/30 [01:01<00:53,  3.57s/it]{'epoch': 26, 'num_users': 6.0625, 'loss': 0.0268, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8932, 'compress@10': 0.9845, 'time@10': 5.6899}:  50%|█████     | 15/30 [01:04<00:53,  3.57s/it] {'epoch': 26, 'num_users': 6.0625, 'loss': 0.0268, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8932, 'compress@10': 0.9845, 'time@10': 5.6899}:  53%|█████▎    | 16/30 [01:04<00:47,  3.43s/it]{'epoch': 26, 'num_users': 5.8235, 'loss': 0.0254, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.886, 'compress@10': 0.9849, 'time@10': 5.5488}:  53%|█████▎    | 16/30 [01:06<00:47,  3.43s/it]{'epoch': 26, 'num_users': 5.8235, 'loss': 0.0254, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.886, 'compress@10': 0.9849, 'time@10': 5.5488}:  57%|█████▋    | 17/30 [01:06<00:37,  2.90s/it]{'epoch': 26, 'num_users': 6.0556, 'loss': 0.0255, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8867, 'compress@10': 0.9848, 'time@10': 5.4922}:  57%|█████▋    | 17/30 [01:10<00:37,  2.90s/it]{'epoch': 26, 'num_users': 6.0556, 'loss': 0.0255, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8867, 'compress@10': 0.9848, 'time@10': 5.4922}:  60%|██████    | 18/30 [01:10<00:40,  3.40s/it]{'epoch': 26, 'num_users': 6.0, 'loss': 0.0249, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8878, 'compress@10': 0.9849, 'time@10': 5.4295}:  60%|██████    | 18/30 [01:13<00:40,  3.40s/it]   {'epoch': 26, 'num_users': 6.0, 'loss': 0.0249, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8878, 'compress@10': 0.9849, 'time@10': 5.4295}:  63%|██████▎   | 19/30 [01:13<00:33,  3.04s/it]{'epoch': 26, 'num_users': 6.15, 'loss': 0.025, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8887, 'compress@10': 0.9853, 'time@10': 5.5673}:  63%|██████▎   | 19/30 [01:21<00:33,  3.04s/it] {'epoch': 26, 'num_users': 6.15, 'loss': 0.025, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8887, 'compress@10': 0.9853, 'time@10': 5.5673}:  67%|██████▋   | 20/30 [01:21<00:45,  4.60s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0264, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8858, 'compress@10': 0.9852, 'time@10': 5.6726}:  67%|██████▋   | 20/30 [01:25<00:45,  4.60s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0264, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8858, 'compress@10': 0.9852, 'time@10': 5.6726}:  70%|███████   | 21/30 [01:25<00:39,  4.40s/it]{'epoch': 26, 'num_users': 6.1818, 'loss': 0.027, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8863, 'compress@10': 0.9851, 'time@10': 5.5718}:  70%|███████   | 21/30 [01:28<00:39,  4.40s/it] {'epoch': 26, 'num_users': 6.1818, 'loss': 0.027, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8863, 'compress@10': 0.9851, 'time@10': 5.5718}:  73%|███████▎  | 22/30 [01:28<00:33,  4.13s/it]{'epoch': 26, 'num_users': 6.1304, 'loss': 0.0266, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.888, 'compress@10': 0.9854, 'time@10': 5.6019}:  73%|███████▎  | 22/30 [01:31<00:33,  4.13s/it]{'epoch': 26, 'num_users': 6.1304, 'loss': 0.0266, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.888, 'compress@10': 0.9854, 'time@10': 5.6019}:  77%|███████▋  | 23/30 [01:31<00:26,  3.84s/it]{'epoch': 26, 'num_users': 5.9583, 'loss': 0.0257, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.882, 'compress@10': 0.9856, 'time@10': 5.4702}:  77%|███████▋  | 23/30 [01:34<00:26,  3.84s/it]{'epoch': 26, 'num_users': 5.9583, 'loss': 0.0257, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.882, 'compress@10': 0.9856, 'time@10': 5.4702}:  80%|████████  | 24/30 [01:34<00:20,  3.43s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8734, 'compress@10': 0.9858, 'time@10': 5.3508}:  80%|████████  | 24/30 [01:35<00:20,  3.43s/it]  {'epoch': 26, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8734, 'compress@10': 0.9858, 'time@10': 5.3508}:  83%|████████▎ | 25/30 [01:35<00:13,  2.79s/it]{'epoch': 26, 'num_users': 5.8077, 'loss': 0.0249, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8746, 'compress@10': 0.9858, 'time@10': 5.4529}:  83%|████████▎ | 25/30 [01:43<00:13,  2.79s/it]{'epoch': 26, 'num_users': 5.8077, 'loss': 0.0249, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8746, 'compress@10': 0.9858, 'time@10': 5.4529}:  87%|████████▋ | 26/30 [01:43<00:17,  4.37s/it]{'epoch': 26, 'num_users': 5.8889, 'loss': 0.0246, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.876, 'compress@10': 0.9857, 'time@10': 5.5317}:  87%|████████▋ | 26/30 [01:47<00:17,  4.37s/it] {'epoch': 26, 'num_users': 5.8889, 'loss': 0.0246, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.876, 'compress@10': 0.9857, 'time@10': 5.5317}:  90%|█████████ | 27/30 [01:47<00:12,  4.22s/it]{'epoch': 26, 'num_users': 6.0, 'loss': 0.0249, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.878, 'compress@10': 0.9857, 'time@10': 5.6413}:  90%|█████████ | 27/30 [01:56<00:12,  4.22s/it]   {'epoch': 26, 'num_users': 6.0, 'loss': 0.0249, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.878, 'compress@10': 0.9857, 'time@10': 5.6413}:  93%|█████████▎| 28/30 [01:56<00:11,  5.54s/it]{'epoch': 26, 'num_users': 5.8621, 'loss': 0.0247, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8797, 'compress@10': 0.9858, 'time@10': 5.6836}:  93%|█████████▎| 28/30 [01:59<00:11,  5.54s/it]{'epoch': 26, 'num_users': 5.8621, 'loss': 0.0247, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8797, 'compress@10': 0.9858, 'time@10': 5.6836}:  97%|█████████▋| 29/30 [01:59<00:04,  4.94s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0248, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8808, 'compress@10': 0.9857, 'time@10': 5.6913}:  97%|█████████▋| 29/30 [02:05<00:04,  4.94s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0248, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8808, 'compress@10': 0.9857, 'time@10': 5.6913}: 100%|██████████| 30/30 [02:05<00:00,  5.24s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0248, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8808, 'compress@10': 0.9857, 'time@10': 5.6913}: 100%|██████████| 30/30 [02:05<00:00,  4.19s/it]
Epoch: 26
Avg # of users: 5.866666666666666
Avg Loss: 0.024791859253224535
Avg hit ratio: 0.8641656324580389
Avg ndcg: 0.8807874505071444
Avg compression ratio: 0.9857045659293228
Avg train time: 5.691311224301656
Std train time: 1.951434822189622
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 21, 10, 37, 9, 20, 25, 10, 10, 9, 6, 10, 10, 37, 37, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8806, 'compress@10': 0.9883, 'time@10': 6.1031}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8806, 'compress@10': 0.9883, 'time@10': 6.1031}:   3%|▎         | 1/30 [00:03<01:29,  3.09s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8926, 'compress@10': 0.9864, 'time@10': 5.6935}:   3%|▎         | 1/30 [00:08<01:29,  3.09s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8926, 'compress@10': 0.9864, 'time@10': 5.6935}:   7%|▋         | 2/30 [00:08<02:03,  4.40s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8808, 'compress@10': 0.9859, 'time@10': 5.0455}:   7%|▋         | 2/30 [00:10<02:03,  4.40s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8808, 'compress@10': 0.9859, 'time@10': 5.0455}:  10%|█         | 3/30 [00:10<01:28,  3.27s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8983, 'compress@10': 0.9847, 'time@10': 4.8975}:  10%|█         | 3/30 [00:14<01:28,  3.27s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8983, 'compress@10': 0.9847, 'time@10': 4.8975}:  13%|█▎        | 4/30 [00:14<01:37,  3.75s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.033, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8775, 'compress@10': 0.9842, 'time@10': 5.5477}:  13%|█▎        | 4/30 [00:18<01:37,  3.75s/it] {'epoch': 27, 'num_users': 5.8, 'loss': 0.033, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8775, 'compress@10': 0.9842, 'time@10': 5.5477}:  17%|█▋        | 5/30 [00:18<01:37,  3.88s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0314, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.8834, 'compress@10': 0.9857, 'time@10': 5.805}:  17%|█▋        | 5/30 [00:26<01:37,  3.88s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0314, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.8834, 'compress@10': 0.9857, 'time@10': 5.805}:  20%|██        | 6/30 [00:26<01:59,  4.99s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0314, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.8865, 'compress@10': 0.9853, 'time@10': 6.1014}:  20%|██        | 6/30 [00:30<01:59,  4.99s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0314, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.8865, 'compress@10': 0.9853, 'time@10': 6.1014}:  23%|██▎       | 7/30 [00:30<01:47,  4.66s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0308, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.8946, 'compress@10': 0.9849, 'time@10': 6.0383}:  23%|██▎       | 7/30 [00:35<01:47,  4.66s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0308, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.8946, 'compress@10': 0.9849, 'time@10': 6.0383}:  27%|██▋       | 8/30 [00:35<01:49,  4.97s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0307, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9001, 'compress@10': 0.9844, 'time@10': 6.381}:  27%|██▋       | 8/30 [00:40<01:49,  4.97s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0307, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9001, 'compress@10': 0.9844, 'time@10': 6.381}:  30%|███       | 9/30 [00:40<01:41,  4.86s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9048, 'compress@10': 0.9848, 'time@10': 6.3836}:  30%|███       | 9/30 [00:46<01:41,  4.86s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9048, 'compress@10': 0.9848, 'time@10': 6.3836}:  33%|███▎      | 10/30 [00:46<01:47,  5.36s/it]{'epoch': 27, 'num_users': 6.6364, 'loss': 0.0316, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9035, 'compress@10': 0.9851, 'time@10': 6.5373}:  33%|███▎      | 10/30 [00:50<01:47,  5.36s/it]{'epoch': 27, 'num_users': 6.6364, 'loss': 0.0316, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9035, 'compress@10': 0.9851, 'time@10': 6.5373}:  37%|███▋      | 11/30 [00:50<01:34,  4.97s/it]{'epoch': 27, 'num_users': 6.4167, 'loss': 0.0295, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9046, 'compress@10': 0.985, 'time@10': 6.2846}:  37%|███▋      | 11/30 [00:54<01:34,  4.97s/it] {'epoch': 27, 'num_users': 6.4167, 'loss': 0.0295, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9046, 'compress@10': 0.985, 'time@10': 6.2846}:  40%|████      | 12/30 [00:54<01:21,  4.53s/it]{'epoch': 27, 'num_users': 6.6154, 'loss': 0.0297, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9046, 'compress@10': 0.9854, 'time@10': 6.2819}:  40%|████      | 12/30 [00:57<01:21,  4.53s/it]{'epoch': 27, 'num_users': 6.6154, 'loss': 0.0297, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9046, 'compress@10': 0.9854, 'time@10': 6.2819}:  43%|████▎     | 13/30 [00:57<01:10,  4.12s/it]{'epoch': 27, 'num_users': 6.3571, 'loss': 0.0277, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8987, 'compress@10': 0.9855, 'time@10': 6.0378}:  43%|████▎     | 13/30 [01:00<01:10,  4.12s/it]{'epoch': 27, 'num_users': 6.3571, 'loss': 0.0277, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8987, 'compress@10': 0.9855, 'time@10': 6.0378}:  47%|████▋     | 14/30 [01:00<01:00,  3.76s/it]{'epoch': 27, 'num_users': 6.2667, 'loss': 0.0285, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8983, 'compress@10': 0.9855, 'time@10': 6.1149}:  47%|████▋     | 14/30 [01:04<01:00,  3.76s/it]{'epoch': 27, 'num_users': 6.2667, 'loss': 0.0285, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8983, 'compress@10': 0.9855, 'time@10': 6.1149}:  50%|█████     | 15/30 [01:04<00:55,  3.72s/it]{'epoch': 27, 'num_users': 6.0625, 'loss': 0.0269, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.8988, 'compress@10': 0.9855, 'time@10': 5.9308}:  50%|█████     | 15/30 [01:07<00:55,  3.72s/it]{'epoch': 27, 'num_users': 6.0625, 'loss': 0.0269, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.8988, 'compress@10': 0.9855, 'time@10': 5.9308}:  53%|█████▎    | 16/30 [01:07<00:49,  3.57s/it]{'epoch': 27, 'num_users': 5.8235, 'loss': 0.0255, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8913, 'compress@10': 0.9858, 'time@10': 5.7733}:  53%|█████▎    | 16/30 [01:09<00:49,  3.57s/it]{'epoch': 27, 'num_users': 5.8235, 'loss': 0.0255, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8913, 'compress@10': 0.9858, 'time@10': 5.7733}:  57%|█████▋    | 17/30 [01:09<00:38,  3.00s/it]{'epoch': 27, 'num_users': 6.0556, 'loss': 0.0255, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.892, 'compress@10': 0.9856, 'time@10': 5.7016}:  57%|█████▋    | 17/30 [01:13<00:38,  3.00s/it] {'epoch': 27, 'num_users': 6.0556, 'loss': 0.0255, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.892, 'compress@10': 0.9856, 'time@10': 5.7016}:  60%|██████    | 18/30 [01:13<00:41,  3.45s/it]{'epoch': 27, 'num_users': 6.0, 'loss': 0.0248, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8924, 'compress@10': 0.9856, 'time@10': 5.6261}:  60%|██████    | 18/30 [01:15<00:41,  3.45s/it]  {'epoch': 27, 'num_users': 6.0, 'loss': 0.0248, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8924, 'compress@10': 0.9856, 'time@10': 5.6261}:  63%|██████▎   | 19/30 [01:15<00:33,  3.07s/it]{'epoch': 27, 'num_users': 6.15, 'loss': 0.0249, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8934, 'compress@10': 0.9861, 'time@10': 5.7635}:  63%|██████▎   | 19/30 [01:24<00:33,  3.07s/it]{'epoch': 27, 'num_users': 6.15, 'loss': 0.0249, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8934, 'compress@10': 0.9861, 'time@10': 5.7635}:  67%|██████▋   | 20/30 [01:24<00:46,  4.67s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.026, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8911, 'compress@10': 0.9859, 'time@10': 5.8496}:  67%|██████▋   | 20/30 [01:27<00:46,  4.67s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.026, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8911, 'compress@10': 0.9859, 'time@10': 5.8496}:  70%|███████   | 21/30 [01:27<00:39,  4.42s/it]{'epoch': 27, 'num_users': 6.1818, 'loss': 0.0266, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8912, 'compress@10': 0.9858, 'time@10': 5.7319}:  70%|███████   | 21/30 [01:31<00:39,  4.42s/it]{'epoch': 27, 'num_users': 6.1818, 'loss': 0.0266, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8912, 'compress@10': 0.9858, 'time@10': 5.7319}:  73%|███████▎  | 22/30 [01:31<00:32,  4.08s/it]{'epoch': 27, 'num_users': 6.1304, 'loss': 0.0261, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.8929, 'compress@10': 0.9862, 'time@10': 5.7549}:  73%|███████▎  | 22/30 [01:34<00:32,  4.08s/it]{'epoch': 27, 'num_users': 6.1304, 'loss': 0.0261, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.8929, 'compress@10': 0.9862, 'time@10': 5.7549}:  77%|███████▋  | 23/30 [01:34<00:26,  3.81s/it]{'epoch': 27, 'num_users': 5.9583, 'loss': 0.0252, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8867, 'compress@10': 0.9864, 'time@10': 5.6157}:  77%|███████▋  | 23/30 [01:36<00:26,  3.81s/it]{'epoch': 27, 'num_users': 5.9583, 'loss': 0.0252, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8867, 'compress@10': 0.9864, 'time@10': 5.6157}:  80%|████████  | 24/30 [01:36<00:20,  3.40s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8779, 'compress@10': 0.9866, 'time@10': 5.4881}:  80%|████████  | 24/30 [01:38<00:20,  3.40s/it]   {'epoch': 27, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8779, 'compress@10': 0.9866, 'time@10': 5.4881}:  83%|████████▎ | 25/30 [01:38<00:13,  2.76s/it]{'epoch': 27, 'num_users': 5.8077, 'loss': 0.0244, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8794, 'compress@10': 0.9865, 'time@10': 5.572}:  83%|████████▎ | 25/30 [01:45<00:13,  2.76s/it]{'epoch': 27, 'num_users': 5.8077, 'loss': 0.0244, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8794, 'compress@10': 0.9865, 'time@10': 5.572}:  87%|████████▋ | 26/30 [01:45<00:16,  4.24s/it]{'epoch': 27, 'num_users': 5.8889, 'loss': 0.0241, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8807, 'compress@10': 0.9865, 'time@10': 5.6289}:  87%|████████▋ | 26/30 [01:49<00:16,  4.24s/it]{'epoch': 27, 'num_users': 5.8889, 'loss': 0.0241, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8807, 'compress@10': 0.9865, 'time@10': 5.6289}:  90%|█████████ | 27/30 [01:49<00:12,  4.05s/it]{'epoch': 27, 'num_users': 6.0, 'loss': 0.0238, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8827, 'compress@10': 0.9865, 'time@10': 5.7239}:  90%|█████████ | 27/30 [01:57<00:12,  4.05s/it]   {'epoch': 27, 'num_users': 6.0, 'loss': 0.0238, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8827, 'compress@10': 0.9865, 'time@10': 5.7239}:  93%|█████████▎| 28/30 [01:57<00:10,  5.33s/it]{'epoch': 27, 'num_users': 5.8621, 'loss': 0.0236, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8845, 'compress@10': 0.9866, 'time@10': 5.7539}:  93%|█████████▎| 28/30 [02:01<00:10,  5.33s/it]{'epoch': 27, 'num_users': 5.8621, 'loss': 0.0236, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8845, 'compress@10': 0.9866, 'time@10': 5.7539}:  97%|█████████▋| 29/30 [02:01<00:04,  4.73s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.0237, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8856, 'compress@10': 0.9864, 'time@10': 5.7441}:  97%|█████████▋| 29/30 [02:06<00:04,  4.73s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.0237, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8856, 'compress@10': 0.9864, 'time@10': 5.7441}: 100%|██████████| 30/30 [02:06<00:00,  4.97s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.0237, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8856, 'compress@10': 0.9864, 'time@10': 5.7441}: 100%|██████████| 30/30 [02:06<00:00,  4.22s/it]
Epoch: 27
Avg # of users: 5.866666666666666
Avg Loss: 0.02371031005921735
Avg hit ratio: 0.8724835397940655
Avg ndcg: 0.8855738079285677
Avg compression ratio: 0.986420032273608
Avg train time: 5.744133377075196
Std train time: 1.9946662667426707
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 21, 10, 38, 9, 20, 25, 10, 10, 9, 6, 10, 10, 38, 38, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8806, 'compress@10': 0.9918, 'time@10': 5.9588}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8806, 'compress@10': 0.9918, 'time@10': 5.9588}:   3%|▎         | 1/30 [00:03<01:27,  3.02s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8948, 'compress@10': 0.9898, 'time@10': 5.467}:   3%|▎         | 1/30 [00:08<01:27,  3.02s/it] {'epoch': 28, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8948, 'compress@10': 0.9898, 'time@10': 5.467}:   7%|▋         | 2/30 [00:08<01:57,  4.19s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8823, 'compress@10': 0.9882, 'time@10': 4.9029}:   7%|▋         | 2/30 [00:09<01:57,  4.19s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8823, 'compress@10': 0.9882, 'time@10': 4.9029}:  10%|█         | 3/30 [00:09<01:25,  3.16s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9017, 'compress@10': 0.9867, 'time@10': 4.7927}:  10%|█         | 3/30 [00:14<01:25,  3.16s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9017, 'compress@10': 0.9867, 'time@10': 4.7927}:  13%|█▎        | 4/30 [00:14<01:35,  3.69s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.03, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.8808, 'compress@10': 0.9858, 'time@10': 5.3862}:  13%|█▎        | 4/30 [00:18<01:35,  3.69s/it]  {'epoch': 28, 'num_users': 5.8, 'loss': 0.03, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.8808, 'compress@10': 0.9858, 'time@10': 5.3862}:  17%|█▋        | 5/30 [00:18<01:34,  3.78s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0289, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.887, 'compress@10': 0.9874, 'time@10': 5.6907}:  17%|█▋        | 5/30 [00:25<01:34,  3.78s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0289, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.887, 'compress@10': 0.9874, 'time@10': 5.6907}:  20%|██        | 6/30 [00:25<01:59,  4.96s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0283, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.8874, 'compress@10': 0.9868, 'time@10': 5.9054}:  20%|██        | 6/30 [00:29<01:59,  4.96s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0283, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.8874, 'compress@10': 0.9868, 'time@10': 5.9054}:  23%|██▎       | 7/30 [00:29<01:44,  4.53s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.028, 'hit_ratio@10': 0.9207, 'ndcg@10': 0.8955, 'compress@10': 0.9865, 'time@10': 5.862}:  23%|██▎       | 7/30 [00:34<01:44,  4.53s/it]   {'epoch': 28, 'num_users': 6.125, 'loss': 0.028, 'hit_ratio@10': 0.9207, 'ndcg@10': 0.8955, 'compress@10': 0.9865, 'time@10': 5.862}:  27%|██▋       | 8/30 [00:34<01:47,  4.87s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9011, 'compress@10': 0.9858, 'time@10': 6.0838}:  27%|██▋       | 8/30 [00:38<01:47,  4.87s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9011, 'compress@10': 0.9858, 'time@10': 6.0838}:  30%|███       | 9/30 [00:38<01:36,  4.59s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.906, 'compress@10': 0.9855, 'time@10': 6.1469}:  30%|███       | 9/30 [00:45<01:36,  4.59s/it]    {'epoch': 28, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.906, 'compress@10': 0.9855, 'time@10': 6.1469}:  33%|███▎      | 10/30 [00:45<01:45,  5.26s/it]{'epoch': 28, 'num_users': 6.6364, 'loss': 0.0275, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9052, 'compress@10': 0.9857, 'time@10': 6.3774}:  33%|███▎      | 10/30 [00:50<01:45,  5.26s/it]{'epoch': 28, 'num_users': 6.6364, 'loss': 0.0275, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9052, 'compress@10': 0.9857, 'time@10': 6.3774}:  37%|███▋      | 11/30 [00:50<01:34,  4.99s/it]{'epoch': 28, 'num_users': 6.4167, 'loss': 0.0257, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9062, 'compress@10': 0.9854, 'time@10': 6.1123}:  37%|███▋      | 11/30 [00:53<01:34,  4.99s/it]{'epoch': 28, 'num_users': 6.4167, 'loss': 0.0257, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9062, 'compress@10': 0.9854, 'time@10': 6.1123}:  40%|████      | 12/30 [00:53<01:20,  4.46s/it]{'epoch': 28, 'num_users': 6.6154, 'loss': 0.0261, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9062, 'compress@10': 0.9858, 'time@10': 6.2227}:  40%|████      | 12/30 [00:57<01:20,  4.46s/it]{'epoch': 28, 'num_users': 6.6154, 'loss': 0.0261, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9062, 'compress@10': 0.9858, 'time@10': 6.2227}:  43%|████▎     | 13/30 [00:57<01:12,  4.26s/it]{'epoch': 28, 'num_users': 6.3571, 'loss': 0.0244, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9001, 'compress@10': 0.9859, 'time@10': 5.975}:  43%|████▎     | 13/30 [00:59<01:12,  4.26s/it] {'epoch': 28, 'num_users': 6.3571, 'loss': 0.0244, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9001, 'compress@10': 0.9859, 'time@10': 5.975}:  47%|████▋     | 14/30 [00:59<01:01,  3.82s/it]{'epoch': 28, 'num_users': 6.2667, 'loss': 0.0253, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9, 'compress@10': 0.9859, 'time@10': 6.1167}:  47%|████▋     | 14/30 [01:03<01:01,  3.82s/it]  {'epoch': 28, 'num_users': 6.2667, 'loss': 0.0253, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9, 'compress@10': 0.9859, 'time@10': 6.1167}:  50%|█████     | 15/30 [01:03<00:58,  3.90s/it]{'epoch': 28, 'num_users': 6.0625, 'loss': 0.0239, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9004, 'compress@10': 0.9859, 'time@10': 5.931}:  50%|█████     | 15/30 [01:07<00:58,  3.90s/it]{'epoch': 28, 'num_users': 6.0625, 'loss': 0.0239, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9004, 'compress@10': 0.9859, 'time@10': 5.931}:  53%|█████▎    | 16/30 [01:07<00:51,  3.69s/it]{'epoch': 28, 'num_users': 5.8235, 'loss': 0.0227, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8928, 'compress@10': 0.9861, 'time@10': 5.7667}:  53%|█████▎    | 16/30 [01:08<00:51,  3.69s/it]{'epoch': 28, 'num_users': 5.8235, 'loss': 0.0227, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8928, 'compress@10': 0.9861, 'time@10': 5.7667}:  57%|█████▋    | 17/30 [01:08<00:39,  3.06s/it]{'epoch': 28, 'num_users': 6.0556, 'loss': 0.0228, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8934, 'compress@10': 0.9858, 'time@10': 5.6886}:  57%|█████▋    | 17/30 [01:13<00:39,  3.06s/it]{'epoch': 28, 'num_users': 6.0556, 'loss': 0.0228, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8934, 'compress@10': 0.9858, 'time@10': 5.6886}:  60%|██████    | 18/30 [01:13<00:41,  3.47s/it]{'epoch': 28, 'num_users': 6.0, 'loss': 0.0222, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.8943, 'compress@10': 0.9858, 'time@10': 5.6137}:  60%|██████    | 18/30 [01:15<00:41,  3.47s/it]   {'epoch': 28, 'num_users': 6.0, 'loss': 0.0222, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.8943, 'compress@10': 0.9858, 'time@10': 5.6137}:  63%|██████▎   | 19/30 [01:15<00:33,  3.08s/it]{'epoch': 28, 'num_users': 6.15, 'loss': 0.0224, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8955, 'compress@10': 0.9863, 'time@10': 5.7616}:  63%|██████▎   | 19/30 [01:23<00:33,  3.08s/it]{'epoch': 28, 'num_users': 6.15, 'loss': 0.0224, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8955, 'compress@10': 0.9863, 'time@10': 5.7616}:  67%|██████▋   | 20/30 [01:23<00:47,  4.74s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8925, 'compress@10': 0.9861, 'time@10': 5.8678}:  67%|██████▋   | 20/30 [01:27<00:47,  4.74s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8925, 'compress@10': 0.9861, 'time@10': 5.8678}:  70%|███████   | 21/30 [01:27<00:40,  4.53s/it]{'epoch': 28, 'num_users': 6.1818, 'loss': 0.0245, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8927, 'compress@10': 0.986, 'time@10': 5.7579}:  70%|███████   | 21/30 [01:31<00:40,  4.53s/it] {'epoch': 28, 'num_users': 6.1818, 'loss': 0.0245, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8927, 'compress@10': 0.986, 'time@10': 5.7579}:  73%|███████▎  | 22/30 [01:31<00:33,  4.25s/it]{'epoch': 28, 'num_users': 6.1304, 'loss': 0.0241, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8946, 'compress@10': 0.9864, 'time@10': 5.7813}:  73%|███████▎  | 22/30 [01:34<00:33,  4.25s/it]{'epoch': 28, 'num_users': 6.1304, 'loss': 0.0241, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8946, 'compress@10': 0.9864, 'time@10': 5.7813}:  77%|███████▋  | 23/30 [01:34<00:27,  3.93s/it]{'epoch': 28, 'num_users': 5.9583, 'loss': 0.0233, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8883, 'compress@10': 0.9866, 'time@10': 5.6436}:  77%|███████▋  | 23/30 [01:37<00:27,  3.93s/it]{'epoch': 28, 'num_users': 5.9583, 'loss': 0.0233, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8883, 'compress@10': 0.9866, 'time@10': 5.6436}:  80%|████████  | 24/30 [01:37<00:21,  3.51s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8794, 'compress@10': 0.9868, 'time@10': 5.516}:  80%|████████  | 24/30 [01:38<00:21,  3.51s/it]    {'epoch': 28, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8794, 'compress@10': 0.9868, 'time@10': 5.516}:  83%|████████▎ | 25/30 [01:38<00:14,  2.84s/it]{'epoch': 28, 'num_users': 5.8077, 'loss': 0.0225, 'hit_ratio@10': 0.865, 'ndcg@10': 0.881, 'compress@10': 0.9867, 'time@10': 5.6114}:  83%|████████▎ | 25/30 [01:46<00:14,  2.84s/it]{'epoch': 28, 'num_users': 5.8077, 'loss': 0.0225, 'hit_ratio@10': 0.865, 'ndcg@10': 0.881, 'compress@10': 0.9867, 'time@10': 5.6114}:  87%|████████▋ | 26/30 [01:46<00:17,  4.40s/it]{'epoch': 28, 'num_users': 5.8889, 'loss': 0.0223, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8822, 'compress@10': 0.9867, 'time@10': 5.6771}:  87%|████████▋ | 26/30 [01:50<00:17,  4.40s/it]{'epoch': 28, 'num_users': 5.8889, 'loss': 0.0223, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8822, 'compress@10': 0.9867, 'time@10': 5.6771}:  90%|█████████ | 27/30 [01:50<00:12,  4.20s/it]{'epoch': 28, 'num_users': 6.0, 'loss': 0.022, 'hit_ratio@10': 0.872, 'ndcg@10': 0.8842, 'compress@10': 0.9869, 'time@10': 5.777}:  90%|█████████ | 27/30 [01:58<00:12,  4.20s/it]      {'epoch': 28, 'num_users': 6.0, 'loss': 0.022, 'hit_ratio@10': 0.872, 'ndcg@10': 0.8842, 'compress@10': 0.9869, 'time@10': 5.777}:  93%|█████████▎| 28/30 [01:58<00:10,  5.50s/it]{'epoch': 28, 'num_users': 5.8621, 'loss': 0.0218, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.8859, 'compress@10': 0.9869, 'time@10': 5.8128}:  93%|█████████▎| 28/30 [02:02<00:10,  5.50s/it]{'epoch': 28, 'num_users': 5.8621, 'loss': 0.0218, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.8859, 'compress@10': 0.9869, 'time@10': 5.8128}:  97%|█████████▋| 29/30 [02:02<00:04,  4.88s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.022, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8868, 'compress@10': 0.9867, 'time@10': 5.8162}:  97%|█████████▋| 29/30 [02:08<00:04,  4.88s/it] {'epoch': 28, 'num_users': 5.8667, 'loss': 0.022, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8868, 'compress@10': 0.9867, 'time@10': 5.8162}: 100%|██████████| 30/30 [02:08<00:00,  5.20s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.022, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8868, 'compress@10': 0.9867, 'time@10': 5.8162}: 100%|██████████| 30/30 [02:08<00:00,  4.28s/it]
Epoch: 28
Avg # of users: 5.866666666666666
Avg Loss: 0.021994165686673502
Avg hit ratio: 0.8753807621437494
Avg ndcg: 0.88682948105329
Avg compression ratio: 0.9867352004661659
Avg train time: 5.8161756038665775
Std train time: 2.0558335836540143
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 21, 10, 39, 9, 21, 26, 10, 10, 9, 6, 10, 10, 39, 39, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0342, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8829, 'compress@10': 0.9936, 'time@10': 5.9102}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0342, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8829, 'compress@10': 0.9936, 'time@10': 5.9102}:   3%|▎         | 1/30 [00:03<01:27,  3.01s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8974, 'compress@10': 0.9919, 'time@10': 5.5215}:   3%|▎         | 1/30 [00:08<01:27,  3.01s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8974, 'compress@10': 0.9919, 'time@10': 5.5215}:   7%|▋         | 2/30 [00:08<01:59,  4.28s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.884, 'compress@10': 0.9895, 'time@10': 4.9251}:   7%|▋         | 2/30 [00:10<01:59,  4.28s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.884, 'compress@10': 0.9895, 'time@10': 4.9251}:  10%|█         | 3/30 [00:10<01:26,  3.20s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.896, 'compress@10': 0.9871, 'time@10': 4.7948}:  10%|█         | 3/30 [00:14<01:26,  3.20s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.896, 'compress@10': 0.9871, 'time@10': 4.7948}:  13%|█▎        | 4/30 [00:14<01:35,  3.69s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.8772, 'compress@10': 0.9863, 'time@10': 5.4494}:  13%|█▎        | 4/30 [00:18<01:35,  3.69s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.8772, 'compress@10': 0.9863, 'time@10': 5.4494}:  17%|█▋        | 5/30 [00:18<01:35,  3.83s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0274, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.884, 'compress@10': 0.9879, 'time@10': 5.7396}:  17%|█▋        | 5/30 [00:25<01:35,  3.83s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0274, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.884, 'compress@10': 0.9879, 'time@10': 5.7396}:  20%|██        | 6/30 [00:25<01:59,  4.99s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.028, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.887, 'compress@10': 0.9879, 'time@10': 6.04}:  20%|██        | 6/30 [00:29<01:59,  4.99s/it]   {'epoch': 29, 'num_users': 6.2857, 'loss': 0.028, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.887, 'compress@10': 0.9879, 'time@10': 6.04}:  23%|██▎       | 7/30 [00:29<01:47,  4.65s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0277, 'hit_ratio@10': 0.9207, 'ndcg@10': 0.8954, 'compress@10': 0.9876, 'time@10': 5.9834}:  23%|██▎       | 7/30 [00:35<01:47,  4.65s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0277, 'hit_ratio@10': 0.9207, 'ndcg@10': 0.8954, 'compress@10': 0.9876, 'time@10': 5.9834}:  27%|██▋       | 8/30 [00:35<01:49,  4.97s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0277, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.9011, 'compress@10': 0.9868, 'time@10': 6.1866}:  27%|██▋       | 8/30 [00:39<01:49,  4.97s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0277, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.9011, 'compress@10': 0.9868, 'time@10': 6.1866}:  30%|███       | 9/30 [00:39<01:37,  4.65s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0279, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.9042, 'compress@10': 0.9865, 'time@10': 6.2125}:  30%|███       | 9/30 [00:45<01:37,  4.65s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0279, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.9042, 'compress@10': 0.9865, 'time@10': 6.2125}:  33%|███▎      | 10/30 [00:45<01:44,  5.22s/it]{'epoch': 29, 'num_users': 6.6364, 'loss': 0.0287, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9031, 'compress@10': 0.9869, 'time@10': 6.3345}:  33%|███▎      | 10/30 [00:49<01:44,  5.22s/it]{'epoch': 29, 'num_users': 6.6364, 'loss': 0.0287, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9031, 'compress@10': 0.9869, 'time@10': 6.3345}:  37%|███▋      | 11/30 [00:49<01:31,  4.80s/it]{'epoch': 29, 'num_users': 6.4167, 'loss': 0.0267, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9042, 'compress@10': 0.9864, 'time@10': 6.1111}:  37%|███▋      | 11/30 [00:53<01:31,  4.80s/it]{'epoch': 29, 'num_users': 6.4167, 'loss': 0.0267, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9042, 'compress@10': 0.9864, 'time@10': 6.1111}:  40%|████      | 12/30 [00:53<01:20,  4.46s/it]{'epoch': 29, 'num_users': 6.6154, 'loss': 0.027, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9043, 'compress@10': 0.9866, 'time@10': 6.1665}:  40%|████      | 12/30 [00:56<01:20,  4.46s/it] {'epoch': 29, 'num_users': 6.6154, 'loss': 0.027, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9043, 'compress@10': 0.9866, 'time@10': 6.1665}:  43%|████▎     | 13/30 [00:56<01:10,  4.16s/it]{'epoch': 29, 'num_users': 6.3571, 'loss': 0.0252, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8984, 'compress@10': 0.9866, 'time@10': 5.9357}:  43%|████▎     | 13/30 [00:59<01:10,  4.16s/it]{'epoch': 29, 'num_users': 6.3571, 'loss': 0.0252, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8984, 'compress@10': 0.9866, 'time@10': 5.9357}:  47%|████▋     | 14/30 [00:59<01:00,  3.80s/it]{'epoch': 29, 'num_users': 6.2667, 'loss': 0.0261, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.8992, 'compress@10': 0.9866, 'time@10': 6.0492}:  47%|████▋     | 14/30 [01:03<01:00,  3.80s/it]{'epoch': 29, 'num_users': 6.2667, 'loss': 0.0261, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.8992, 'compress@10': 0.9866, 'time@10': 6.0492}:  50%|█████     | 15/30 [01:03<00:57,  3.82s/it]{'epoch': 29, 'num_users': 6.0625, 'loss': 0.0246, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8997, 'compress@10': 0.9866, 'time@10': 5.8706}:  50%|█████     | 15/30 [01:06<00:57,  3.82s/it]{'epoch': 29, 'num_users': 6.0625, 'loss': 0.0246, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8997, 'compress@10': 0.9866, 'time@10': 5.8706}:  53%|█████▎    | 16/30 [01:06<00:50,  3.64s/it]{'epoch': 29, 'num_users': 5.8235, 'loss': 0.0233, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8921, 'compress@10': 0.9868, 'time@10': 5.687}:  53%|█████▎    | 16/30 [01:08<00:50,  3.64s/it] {'epoch': 29, 'num_users': 5.8235, 'loss': 0.0233, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8921, 'compress@10': 0.9868, 'time@10': 5.687}:  57%|█████▋    | 17/30 [01:08<00:38,  2.97s/it]{'epoch': 29, 'num_users': 6.0556, 'loss': 0.0233, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.893, 'compress@10': 0.9863, 'time@10': 5.5965}:  57%|█████▋    | 17/30 [01:12<00:38,  2.97s/it]{'epoch': 29, 'num_users': 6.0556, 'loss': 0.0233, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.893, 'compress@10': 0.9863, 'time@10': 5.5965}:  60%|██████    | 18/30 [01:12<00:39,  3.31s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 0.0227, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8936, 'compress@10': 0.9863, 'time@10': 5.5278}:  60%|██████    | 18/30 [01:14<00:39,  3.31s/it]  {'epoch': 29, 'num_users': 6.0, 'loss': 0.0227, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8936, 'compress@10': 0.9863, 'time@10': 5.5278}:  63%|██████▎   | 19/30 [01:14<00:32,  2.97s/it]{'epoch': 29, 'num_users': 6.15, 'loss': 0.0229, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.895, 'compress@10': 0.9868, 'time@10': 5.6707}:  63%|██████▎   | 19/30 [01:23<00:32,  2.97s/it]{'epoch': 29, 'num_users': 6.15, 'loss': 0.0229, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.895, 'compress@10': 0.9868, 'time@10': 5.6707}:  67%|██████▋   | 20/30 [01:23<00:46,  4.61s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0239, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8925, 'compress@10': 0.9868, 'time@10': 5.7703}:  67%|██████▋   | 20/30 [01:26<00:46,  4.61s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0239, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8925, 'compress@10': 0.9868, 'time@10': 5.7703}:  70%|███████   | 21/30 [01:26<00:39,  4.40s/it]{'epoch': 29, 'num_users': 6.1818, 'loss': 0.0245, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8927, 'compress@10': 0.9867, 'time@10': 5.6542}:  70%|███████   | 21/30 [01:30<00:39,  4.40s/it]{'epoch': 29, 'num_users': 6.1818, 'loss': 0.0245, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8927, 'compress@10': 0.9867, 'time@10': 5.6542}:  73%|███████▎  | 22/30 [01:30<00:32,  4.06s/it]{'epoch': 29, 'num_users': 6.1304, 'loss': 0.0241, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8946, 'compress@10': 0.9871, 'time@10': 5.6802}:  73%|███████▎  | 22/30 [01:33<00:32,  4.06s/it]{'epoch': 29, 'num_users': 6.1304, 'loss': 0.0241, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8946, 'compress@10': 0.9871, 'time@10': 5.6802}:  77%|███████▋  | 23/30 [01:33<00:26,  3.79s/it]{'epoch': 29, 'num_users': 5.9583, 'loss': 0.0232, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8883, 'compress@10': 0.9872, 'time@10': 5.55}:  77%|███████▋  | 23/30 [01:36<00:26,  3.79s/it]  {'epoch': 29, 'num_users': 5.9583, 'loss': 0.0232, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8883, 'compress@10': 0.9872, 'time@10': 5.55}:  80%|████████  | 24/30 [01:36<00:20,  3.43s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8794, 'compress@10': 0.9874, 'time@10': 5.4306}:  80%|████████  | 24/30 [01:37<00:20,  3.43s/it] {'epoch': 29, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8794, 'compress@10': 0.9874, 'time@10': 5.4306}:  83%|████████▎ | 25/30 [01:37<00:13,  2.80s/it]{'epoch': 29, 'num_users': 5.8077, 'loss': 0.0224, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8813, 'compress@10': 0.9873, 'time@10': 5.5282}:  83%|████████▎ | 25/30 [01:45<00:13,  2.80s/it]{'epoch': 29, 'num_users': 5.8077, 'loss': 0.0224, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8813, 'compress@10': 0.9873, 'time@10': 5.5282}:  87%|████████▋ | 26/30 [01:45<00:17,  4.36s/it]{'epoch': 29, 'num_users': 5.8889, 'loss': 0.0222, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8826, 'compress@10': 0.9874, 'time@10': 5.5887}:  87%|████████▋ | 26/30 [01:48<00:17,  4.36s/it]{'epoch': 29, 'num_users': 5.8889, 'loss': 0.0222, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8826, 'compress@10': 0.9874, 'time@10': 5.5887}:  90%|█████████ | 27/30 [01:48<00:12,  4.14s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 0.0226, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.8863, 'compress@10': 0.9875, 'time@10': 5.6985}:  90%|█████████ | 27/30 [01:57<00:12,  4.14s/it]   {'epoch': 29, 'num_users': 6.0, 'loss': 0.0226, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.8863, 'compress@10': 0.9875, 'time@10': 5.6985}:  93%|█████████▎| 28/30 [01:57<00:11,  5.51s/it]{'epoch': 29, 'num_users': 5.8621, 'loss': 0.0223, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.8879, 'compress@10': 0.9875, 'time@10': 5.7374}:  93%|█████████▎| 28/30 [02:01<00:11,  5.51s/it]{'epoch': 29, 'num_users': 5.8621, 'loss': 0.0223, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.8879, 'compress@10': 0.9875, 'time@10': 5.7374}:  97%|█████████▋| 29/30 [02:01<00:04,  4.90s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.0225, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.889, 'compress@10': 0.9873, 'time@10': 5.7509}:  97%|█████████▋| 29/30 [02:07<00:04,  4.90s/it] {'epoch': 29, 'num_users': 5.8667, 'loss': 0.0225, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.889, 'compress@10': 0.9873, 'time@10': 5.7509}: 100%|██████████| 30/30 [02:07<00:00,  5.28s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.0225, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.889, 'compress@10': 0.9873, 'time@10': 5.7509}: 100%|██████████| 30/30 [02:07<00:00,  4.24s/it]
Epoch: 29
Avg # of users: 5.866666666666666
Avg Loss: 0.02249089697865334
Avg hit ratio: 0.8721943614573487
Avg ndcg: 0.8889907149058408
Avg compression ratio: 0.9873156876538913
Avg train time: 5.750896358489991
Std train time: 1.9872244430334887
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 21, 10, 40, 9, 21, 27, 10, 10, 9, 6, 10, 10, 40, 40, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8842, 'compress@10': 0.9949, 'time@10': 5.9098}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8842, 'compress@10': 0.9949, 'time@10': 5.9098}:   3%|▎         | 1/30 [00:03<01:28,  3.04s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8979, 'compress@10': 0.9935, 'time@10': 5.444}:   3%|▎         | 1/30 [00:08<01:28,  3.04s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8979, 'compress@10': 0.9935, 'time@10': 5.444}:   7%|▋         | 2/30 [00:08<01:57,  4.20s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8843, 'compress@10': 0.9905, 'time@10': 4.8844}:   7%|▋         | 2/30 [00:09<01:57,  4.20s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8843, 'compress@10': 0.9905, 'time@10': 4.8844}:  10%|█         | 3/30 [00:09<01:25,  3.16s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8952, 'compress@10': 0.9875, 'time@10': 4.7698}:  10%|█         | 3/30 [00:14<01:25,  3.16s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8952, 'compress@10': 0.9875, 'time@10': 4.7698}:  13%|█▎        | 4/30 [00:14<01:35,  3.68s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0261, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.8778, 'compress@10': 0.9869, 'time@10': 5.4515}:  13%|█▎        | 4/30 [00:18<01:35,  3.68s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0261, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.8778, 'compress@10': 0.9869, 'time@10': 5.4515}:  17%|█▋        | 5/30 [00:18<01:36,  3.84s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0255, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.8846, 'compress@10': 0.9886, 'time@10': 5.7675}:  17%|█▋        | 5/30 [00:25<01:36,  3.84s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0255, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.8846, 'compress@10': 0.9886, 'time@10': 5.7675}:  20%|██        | 6/30 [00:25<02:01,  5.05s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0253, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.8861, 'compress@10': 0.9886, 'time@10': 6.1521}:  20%|██        | 6/30 [00:30<02:01,  5.05s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0253, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.8861, 'compress@10': 0.9886, 'time@10': 6.1521}:  23%|██▎       | 7/30 [00:30<01:50,  4.80s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0252, 'hit_ratio@10': 0.9207, 'ndcg@10': 0.8949, 'compress@10': 0.9885, 'time@10': 6.0857}:  23%|██▎       | 7/30 [00:35<01:50,  4.80s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0252, 'hit_ratio@10': 0.9207, 'ndcg@10': 0.8949, 'compress@10': 0.9885, 'time@10': 6.0857}:  27%|██▋       | 8/30 [00:35<01:51,  5.07s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0256, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9006, 'compress@10': 0.9875, 'time@10': 6.2862}:  27%|██▋       | 8/30 [00:39<01:51,  5.07s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0256, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9006, 'compress@10': 0.9875, 'time@10': 6.2862}:  30%|███       | 9/30 [00:39<01:39,  4.73s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0242, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9063, 'compress@10': 0.9869, 'time@10': 6.3862}:  30%|███       | 9/30 [00:47<01:39,  4.73s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0242, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9063, 'compress@10': 0.9869, 'time@10': 6.3862}:  33%|███▎      | 10/30 [00:47<01:50,  5.53s/it]{'epoch': 30, 'num_users': 6.6364, 'loss': 0.0255, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9043, 'compress@10': 0.9876, 'time@10': 6.3753}:  33%|███▎      | 10/30 [00:50<01:50,  5.53s/it]{'epoch': 30, 'num_users': 6.6364, 'loss': 0.0255, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9043, 'compress@10': 0.9876, 'time@10': 6.3753}:  37%|███▋      | 11/30 [00:50<01:31,  4.81s/it]{'epoch': 30, 'num_users': 6.4167, 'loss': 0.0237, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9054, 'compress@10': 0.9867, 'time@10': 6.1303}:  37%|███▋      | 11/30 [00:53<01:31,  4.81s/it]{'epoch': 30, 'num_users': 6.4167, 'loss': 0.0237, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9054, 'compress@10': 0.9867, 'time@10': 6.1303}:  40%|████      | 12/30 [00:53<01:19,  4.40s/it]{'epoch': 30, 'num_users': 6.6154, 'loss': 0.0242, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9055, 'compress@10': 0.9869, 'time@10': 6.2157}:  40%|████      | 12/30 [00:57<01:19,  4.40s/it]{'epoch': 30, 'num_users': 6.6154, 'loss': 0.0242, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9055, 'compress@10': 0.9869, 'time@10': 6.2157}:  43%|████▎     | 13/30 [00:57<01:11,  4.19s/it]{'epoch': 30, 'num_users': 6.3571, 'loss': 0.0225, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.8995, 'compress@10': 0.9869, 'time@10': 5.9855}:  43%|████▎     | 13/30 [01:00<01:11,  4.19s/it]{'epoch': 30, 'num_users': 6.3571, 'loss': 0.0225, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.8995, 'compress@10': 0.9869, 'time@10': 5.9855}:  47%|████▋     | 14/30 [01:00<01:01,  3.84s/it]{'epoch': 30, 'num_users': 6.2667, 'loss': 0.0234, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9003, 'compress@10': 0.9868, 'time@10': 6.1209}:  47%|████▋     | 14/30 [01:04<01:01,  3.84s/it]{'epoch': 30, 'num_users': 6.2667, 'loss': 0.0234, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9003, 'compress@10': 0.9868, 'time@10': 6.1209}:  50%|█████     | 15/30 [01:04<00:58,  3.90s/it]{'epoch': 30, 'num_users': 6.0625, 'loss': 0.0221, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.901, 'compress@10': 0.9869, 'time@10': 5.9377}:  50%|█████     | 15/30 [01:07<00:58,  3.90s/it] {'epoch': 30, 'num_users': 6.0625, 'loss': 0.0221, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.901, 'compress@10': 0.9869, 'time@10': 5.9377}:  53%|█████▎    | 16/30 [01:07<00:51,  3.70s/it]{'epoch': 30, 'num_users': 5.8235, 'loss': 0.0209, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.8933, 'compress@10': 0.9872, 'time@10': 5.771}:  53%|█████▎    | 16/30 [01:09<00:51,  3.70s/it]{'epoch': 30, 'num_users': 5.8235, 'loss': 0.0209, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.8933, 'compress@10': 0.9872, 'time@10': 5.771}:  57%|█████▋    | 17/30 [01:09<00:39,  3.07s/it]{'epoch': 30, 'num_users': 6.0556, 'loss': 0.021, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8945, 'compress@10': 0.9866, 'time@10': 5.682}:  57%|█████▋    | 17/30 [01:13<00:39,  3.07s/it] {'epoch': 30, 'num_users': 6.0556, 'loss': 0.021, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8945, 'compress@10': 0.9866, 'time@10': 5.682}:  60%|██████    | 18/30 [01:13<00:40,  3.41s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 0.0205, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8953, 'compress@10': 0.9866, 'time@10': 5.6065}:  60%|██████    | 18/30 [01:15<00:40,  3.41s/it] {'epoch': 30, 'num_users': 6.0, 'loss': 0.0205, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8953, 'compress@10': 0.9866, 'time@10': 5.6065}:  63%|██████▎   | 19/30 [01:15<00:33,  3.04s/it]{'epoch': 30, 'num_users': 6.15, 'loss': 0.0207, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.8967, 'compress@10': 0.987, 'time@10': 5.7485}:  63%|██████▎   | 19/30 [01:24<00:33,  3.04s/it]{'epoch': 30, 'num_users': 6.15, 'loss': 0.0207, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.8967, 'compress@10': 0.987, 'time@10': 5.7485}:  67%|██████▋   | 20/30 [01:24<00:46,  4.67s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0219, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8944, 'compress@10': 0.9872, 'time@10': 5.8635}:  67%|██████▋   | 20/30 [01:28<00:46,  4.67s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0219, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8944, 'compress@10': 0.9872, 'time@10': 5.8635}:  70%|███████   | 21/30 [01:28<00:40,  4.51s/it]{'epoch': 30, 'num_users': 6.1818, 'loss': 0.0226, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8946, 'compress@10': 0.987, 'time@10': 5.7536}:  70%|███████   | 21/30 [01:31<00:40,  4.51s/it]  {'epoch': 30, 'num_users': 6.1818, 'loss': 0.0226, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8946, 'compress@10': 0.987, 'time@10': 5.7536}:  73%|███████▎  | 22/30 [01:31<00:33,  4.20s/it]{'epoch': 30, 'num_users': 6.1304, 'loss': 0.0222, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8964, 'compress@10': 0.9874, 'time@10': 5.7736}:  73%|███████▎  | 22/30 [01:35<00:33,  4.20s/it]{'epoch': 30, 'num_users': 6.1304, 'loss': 0.0222, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8964, 'compress@10': 0.9874, 'time@10': 5.7736}:  77%|███████▋  | 23/30 [01:35<00:27,  3.88s/it]{'epoch': 30, 'num_users': 5.9583, 'loss': 0.0214, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8924, 'compress@10': 0.9877, 'time@10': 5.6374}:  77%|███████▋  | 23/30 [01:37<00:27,  3.88s/it]{'epoch': 30, 'num_users': 5.9583, 'loss': 0.0214, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8924, 'compress@10': 0.9877, 'time@10': 5.6374}:  80%|████████  | 24/30 [01:37<00:20,  3.48s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0206, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8834, 'compress@10': 0.9879, 'time@10': 5.51}:  80%|████████  | 24/30 [01:38<00:20,  3.48s/it]     {'epoch': 30, 'num_users': 5.8, 'loss': 0.0206, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8834, 'compress@10': 0.9879, 'time@10': 5.51}:  83%|████████▎ | 25/30 [01:38<00:14,  2.82s/it]{'epoch': 30, 'num_users': 5.8077, 'loss': 0.0207, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8852, 'compress@10': 0.9878, 'time@10': 5.6001}:  83%|████████▎ | 25/30 [01:46<00:14,  2.82s/it]{'epoch': 30, 'num_users': 5.8077, 'loss': 0.0207, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8852, 'compress@10': 0.9878, 'time@10': 5.6001}:  87%|████████▋ | 26/30 [01:46<00:17,  4.34s/it]{'epoch': 30, 'num_users': 5.8889, 'loss': 0.0205, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8864, 'compress@10': 0.9878, 'time@10': 5.6562}:  87%|████████▋ | 26/30 [01:50<00:17,  4.34s/it]{'epoch': 30, 'num_users': 5.8889, 'loss': 0.0205, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8864, 'compress@10': 0.9878, 'time@10': 5.6562}:  90%|█████████ | 27/30 [01:50<00:12,  4.12s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 0.0204, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8883, 'compress@10': 0.9879, 'time@10': 5.7372}:  90%|█████████ | 27/30 [01:58<00:12,  4.12s/it]   {'epoch': 30, 'num_users': 6.0, 'loss': 0.0204, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8883, 'compress@10': 0.9879, 'time@10': 5.7372}:  93%|█████████▎| 28/30 [01:58<00:10,  5.27s/it]{'epoch': 30, 'num_users': 5.8621, 'loss': 0.0202, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8903, 'compress@10': 0.9879, 'time@10': 5.7758}:  93%|█████████▎| 28/30 [02:01<00:10,  5.27s/it]{'epoch': 30, 'num_users': 5.8621, 'loss': 0.0202, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8903, 'compress@10': 0.9879, 'time@10': 5.7758}:  97%|█████████▋| 29/30 [02:01<00:04,  4.73s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.0204, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8913, 'compress@10': 0.9877, 'time@10': 5.7802}:  97%|█████████▋| 29/30 [02:07<00:04,  4.73s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.0204, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8913, 'compress@10': 0.9877, 'time@10': 5.7802}: 100%|██████████| 30/30 [02:07<00:00,  5.10s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.0204, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8913, 'compress@10': 0.9877, 'time@10': 5.7802}: 100%|██████████| 30/30 [02:07<00:00,  4.26s/it]
Epoch: 30
Avg # of users: 5.866666666666666
Avg Loss: 0.020408424167661907
Avg hit ratio: 0.8706585399215272
Avg ndcg: 0.8912513995306257
Avg compression ratio: 0.9877148794817995
Avg train time: 5.780187813440959
Std train time: 2.002023447222678
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 21, 10, 41, 9, 21, 28, 10, 10, 9, 6, 10, 10, 41, 41, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0318, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8842, 'compress@10': 0.9955, 'time@10': 5.4287}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0318, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8842, 'compress@10': 0.9955, 'time@10': 5.4287}:   3%|▎         | 1/30 [00:02<01:19,  2.76s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9004, 'compress@10': 0.9939, 'time@10': 5.2061}:   3%|▎         | 1/30 [00:07<01:19,  2.76s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9004, 'compress@10': 0.9939, 'time@10': 5.2061}:   7%|▋         | 2/30 [00:07<01:54,  4.09s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.886, 'compress@10': 0.9906, 'time@10': 4.7154}:   7%|▋         | 2/30 [00:09<01:54,  4.09s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.886, 'compress@10': 0.9906, 'time@10': 4.7154}:  10%|█         | 3/30 [00:09<01:23,  3.10s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8998, 'compress@10': 0.9875, 'time@10': 4.6365}:  10%|█         | 3/30 [00:14<01:23,  3.10s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8998, 'compress@10': 0.9875, 'time@10': 4.6365}:  13%|█▎        | 4/30 [00:14<01:34,  3.63s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0259, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.8822, 'compress@10': 0.9868, 'time@10': 5.3298}:  13%|█▎        | 4/30 [00:18<01:34,  3.63s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0259, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.8822, 'compress@10': 0.9868, 'time@10': 5.3298}:  17%|█▋        | 5/30 [00:18<01:34,  3.80s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0247, 'hit_ratio@10': 0.9142, 'ndcg@10': 0.8907, 'compress@10': 0.9886, 'time@10': 5.6347}:  17%|█▋        | 5/30 [00:25<01:34,  3.80s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0247, 'hit_ratio@10': 0.9142, 'ndcg@10': 0.8907, 'compress@10': 0.9886, 'time@10': 5.6347}:  20%|██        | 6/30 [00:25<01:58,  4.95s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0255, 'hit_ratio@10': 0.9207, 'ndcg@10': 0.894, 'compress@10': 0.9889, 'time@10': 5.9046}:  20%|██        | 6/30 [00:29<01:58,  4.95s/it] {'epoch': 31, 'num_users': 6.2857, 'loss': 0.0255, 'hit_ratio@10': 0.9207, 'ndcg@10': 0.894, 'compress@10': 0.9889, 'time@10': 5.9046}:  23%|██▎       | 7/30 [00:29<01:45,  4.58s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0255, 'hit_ratio@10': 0.9235, 'ndcg@10': 0.9021, 'compress@10': 0.9889, 'time@10': 5.8613}:  23%|██▎       | 7/30 [00:34<01:45,  4.58s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0255, 'hit_ratio@10': 0.9235, 'ndcg@10': 0.9021, 'compress@10': 0.9889, 'time@10': 5.8613}:  27%|██▋       | 8/30 [00:34<01:47,  4.90s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0258, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.9071, 'compress@10': 0.9879, 'time@10': 6.0811}:  27%|██▋       | 8/30 [00:38<01:47,  4.90s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0258, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.9071, 'compress@10': 0.9879, 'time@10': 6.0811}:  30%|███       | 9/30 [00:38<01:36,  4.61s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.9222, 'ndcg@10': 0.9107, 'compress@10': 0.9877, 'time@10': 6.1918}:  30%|███       | 9/30 [00:46<01:36,  4.61s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.9222, 'ndcg@10': 0.9107, 'compress@10': 0.9877, 'time@10': 6.1918}:  33%|███▎      | 10/30 [00:46<01:48,  5.42s/it]{'epoch': 31, 'num_users': 6.6364, 'loss': 0.0281, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9117, 'compress@10': 0.9883, 'time@10': 6.2335}:  33%|███▎      | 10/30 [00:49<01:48,  5.42s/it]{'epoch': 31, 'num_users': 6.6364, 'loss': 0.0281, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9117, 'compress@10': 0.9883, 'time@10': 6.2335}:  37%|███▋      | 11/30 [00:49<01:30,  4.79s/it]{'epoch': 31, 'num_users': 6.4167, 'loss': 0.0261, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9121, 'compress@10': 0.9872, 'time@10': 5.9866}:  37%|███▋      | 11/30 [00:52<01:30,  4.79s/it]{'epoch': 31, 'num_users': 6.4167, 'loss': 0.0261, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9121, 'compress@10': 0.9872, 'time@10': 5.9866}:  40%|████      | 12/30 [00:52<01:18,  4.34s/it]{'epoch': 31, 'num_users': 6.6154, 'loss': 0.0263, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9117, 'compress@10': 0.9873, 'time@10': 6.0743}:  40%|████      | 12/30 [00:56<01:18,  4.34s/it]{'epoch': 31, 'num_users': 6.6154, 'loss': 0.0263, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9117, 'compress@10': 0.9873, 'time@10': 6.0743}:  43%|████▎     | 13/30 [00:56<01:09,  4.12s/it]{'epoch': 31, 'num_users': 6.3571, 'loss': 0.0246, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9061, 'compress@10': 0.9873, 'time@10': 5.8753}:  43%|████▎     | 13/30 [00:59<01:09,  4.12s/it]{'epoch': 31, 'num_users': 6.3571, 'loss': 0.0246, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9061, 'compress@10': 0.9873, 'time@10': 5.8753}:  47%|████▋     | 14/30 [00:59<01:02,  3.88s/it]{'epoch': 31, 'num_users': 6.2667, 'loss': 0.0254, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9066, 'compress@10': 0.9873, 'time@10': 5.9972}:  47%|████▋     | 14/30 [01:03<01:02,  3.88s/it]{'epoch': 31, 'num_users': 6.2667, 'loss': 0.0254, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9066, 'compress@10': 0.9873, 'time@10': 5.9972}:  50%|█████     | 15/30 [01:03<00:58,  3.89s/it]{'epoch': 31, 'num_users': 6.0625, 'loss': 0.024, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.907, 'compress@10': 0.9873, 'time@10': 5.8556}:  50%|█████     | 15/30 [01:07<00:58,  3.89s/it]  {'epoch': 31, 'num_users': 6.0625, 'loss': 0.024, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.907, 'compress@10': 0.9873, 'time@10': 5.8556}:  53%|█████▎    | 16/30 [01:07<00:53,  3.85s/it]{'epoch': 31, 'num_users': 5.8235, 'loss': 0.0227, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8989, 'compress@10': 0.9877, 'time@10': 5.6902}:  53%|█████▎    | 16/30 [01:08<00:53,  3.85s/it]{'epoch': 31, 'num_users': 5.8235, 'loss': 0.0227, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8989, 'compress@10': 0.9877, 'time@10': 5.6902}:  57%|█████▋    | 17/30 [01:08<00:41,  3.16s/it]{'epoch': 31, 'num_users': 6.0556, 'loss': 0.0226, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8994, 'compress@10': 0.987, 'time@10': 5.5864}:  57%|█████▋    | 17/30 [01:12<00:41,  3.16s/it]{'epoch': 31, 'num_users': 6.0556, 'loss': 0.0226, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8994, 'compress@10': 0.987, 'time@10': 5.5864}:  60%|██████    | 18/30 [01:12<00:40,  3.37s/it]{'epoch': 31, 'num_users': 6.0, 'loss': 0.0221, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8998, 'compress@10': 0.987, 'time@10': 5.5082}:  60%|██████    | 18/30 [01:14<00:40,  3.37s/it]   {'epoch': 31, 'num_users': 6.0, 'loss': 0.0221, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8998, 'compress@10': 0.987, 'time@10': 5.5082}:  63%|██████▎   | 19/30 [01:14<00:32,  2.99s/it]{'epoch': 31, 'num_users': 6.15, 'loss': 0.0222, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.901, 'compress@10': 0.9874, 'time@10': 5.6499}:  63%|██████▎   | 19/30 [01:23<00:32,  2.99s/it]{'epoch': 31, 'num_users': 6.15, 'loss': 0.0222, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.901, 'compress@10': 0.9874, 'time@10': 5.6499}:  67%|██████▋   | 20/30 [01:23<00:46,  4.61s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8982, 'compress@10': 0.9877, 'time@10': 5.7527}:  67%|██████▋   | 20/30 [01:27<00:46,  4.61s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8982, 'compress@10': 0.9877, 'time@10': 5.7527}:  70%|███████   | 21/30 [01:27<00:39,  4.41s/it]{'epoch': 31, 'num_users': 6.1818, 'loss': 0.024, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8983, 'compress@10': 0.9875, 'time@10': 5.6478}:  70%|███████   | 21/30 [01:30<00:39,  4.41s/it]  {'epoch': 31, 'num_users': 6.1818, 'loss': 0.024, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8983, 'compress@10': 0.9875, 'time@10': 5.6478}:  73%|███████▎  | 22/30 [01:30<00:33,  4.13s/it]{'epoch': 31, 'num_users': 6.1304, 'loss': 0.0235, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9, 'compress@10': 0.9879, 'time@10': 5.6725}:  73%|███████▎  | 22/30 [01:33<00:33,  4.13s/it] {'epoch': 31, 'num_users': 6.1304, 'loss': 0.0235, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9, 'compress@10': 0.9879, 'time@10': 5.6725}:  77%|███████▋  | 23/30 [01:33<00:26,  3.84s/it]{'epoch': 31, 'num_users': 5.9583, 'loss': 0.0226, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8958, 'compress@10': 0.9882, 'time@10': 5.5478}:  77%|███████▋  | 23/30 [01:36<00:26,  3.84s/it]{'epoch': 31, 'num_users': 5.9583, 'loss': 0.0226, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8958, 'compress@10': 0.9882, 'time@10': 5.5478}:  80%|████████  | 24/30 [01:36<00:21,  3.50s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0218, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8866, 'compress@10': 0.9883, 'time@10': 5.4338}:  80%|████████  | 24/30 [01:37<00:21,  3.50s/it]   {'epoch': 31, 'num_users': 5.8, 'loss': 0.0218, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8866, 'compress@10': 0.9883, 'time@10': 5.4338}:  83%|████████▎ | 25/30 [01:37<00:14,  2.87s/it]{'epoch': 31, 'num_users': 5.8077, 'loss': 0.0218, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8885, 'compress@10': 0.9882, 'time@10': 5.5452}:  83%|████████▎ | 25/30 [01:46<00:14,  2.87s/it]{'epoch': 31, 'num_users': 5.8077, 'loss': 0.0218, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8885, 'compress@10': 0.9882, 'time@10': 5.5452}:  87%|████████▋ | 26/30 [01:46<00:18,  4.53s/it]{'epoch': 31, 'num_users': 5.8889, 'loss': 0.0215, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8898, 'compress@10': 0.9883, 'time@10': 5.6233}:  87%|████████▋ | 26/30 [01:50<00:18,  4.53s/it]{'epoch': 31, 'num_users': 5.8889, 'loss': 0.0215, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8898, 'compress@10': 0.9883, 'time@10': 5.6233}:  90%|█████████ | 27/30 [01:50<00:12,  4.33s/it]{'epoch': 31, 'num_users': 6.0, 'loss': 0.0213, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.892, 'compress@10': 0.9882, 'time@10': 5.7182}:  90%|█████████ | 27/30 [01:58<00:12,  4.33s/it]    {'epoch': 31, 'num_users': 6.0, 'loss': 0.0213, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.892, 'compress@10': 0.9882, 'time@10': 5.7182}:  93%|█████████▎| 28/30 [01:58<00:11,  5.53s/it]{'epoch': 31, 'num_users': 5.8621, 'loss': 0.021, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8939, 'compress@10': 0.9882, 'time@10': 5.7565}:  93%|█████████▎| 28/30 [02:01<00:11,  5.53s/it]{'epoch': 31, 'num_users': 5.8621, 'loss': 0.021, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8939, 'compress@10': 0.9882, 'time@10': 5.7565}:  97%|█████████▋| 29/30 [02:01<00:04,  4.91s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0211, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.8947, 'compress@10': 0.9881, 'time@10': 5.761}:  97%|█████████▋| 29/30 [02:07<00:04,  4.91s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0211, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.8947, 'compress@10': 0.9881, 'time@10': 5.761}: 100%|██████████| 30/30 [02:07<00:00,  5.22s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0211, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.8947, 'compress@10': 0.9881, 'time@10': 5.761}: 100%|██████████| 30/30 [02:07<00:00,  4.26s/it]
Epoch: 31
Avg # of users: 5.866666666666666
Avg Loss: 0.02114176792644991
Avg hit ratio: 0.869055891977416
Avg ndcg: 0.8946954840818172
Avg compression ratio: 0.9881002015448854
Avg train time: 5.76103515625
Std train time: 1.944056009364175
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 21, 10, 41, 9, 21, 29, 10, 10, 9, 6, 10, 10, 42, 42, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8864, 'compress@10': 0.9958, 'time@10': 5.969}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8864, 'compress@10': 0.9958, 'time@10': 5.969}:   3%|▎         | 1/30 [00:03<01:27,  3.03s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9028, 'compress@10': 0.9938, 'time@10': 5.459}:   3%|▎         | 1/30 [00:08<01:27,  3.03s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9028, 'compress@10': 0.9938, 'time@10': 5.459}:   7%|▋         | 2/30 [00:08<01:57,  4.18s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8876, 'compress@10': 0.9905, 'time@10': 4.8896}:   7%|▋         | 2/30 [00:09<01:57,  4.18s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8876, 'compress@10': 0.9905, 'time@10': 4.8896}:  10%|█         | 3/30 [00:09<01:24,  3.15s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8967, 'compress@10': 0.9867, 'time@10': 4.7726}:  10%|█         | 3/30 [00:14<01:24,  3.15s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8967, 'compress@10': 0.9867, 'time@10': 4.7726}:  13%|█▎        | 4/30 [00:14<01:35,  3.67s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.8797, 'compress@10': 0.9865, 'time@10': 5.4502}:  13%|█▎        | 4/30 [00:18<01:35,  3.67s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.8797, 'compress@10': 0.9865, 'time@10': 5.4502}:  17%|█▋        | 5/30 [00:18<01:35,  3.83s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0267, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.8888, 'compress@10': 0.9883, 'time@10': 5.7639}:  17%|█▋        | 5/30 [00:25<01:35,  3.83s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0267, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.8888, 'compress@10': 0.9883, 'time@10': 5.7639}:  20%|██        | 6/30 [00:25<02:01,  5.04s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.026, 'hit_ratio@10': 0.9147, 'ndcg@10': 0.8898, 'compress@10': 0.9888, 'time@10': 6.0952}:  20%|██        | 6/30 [00:29<02:01,  5.04s/it] {'epoch': 32, 'num_users': 6.2857, 'loss': 0.026, 'hit_ratio@10': 0.9147, 'ndcg@10': 0.8898, 'compress@10': 0.9888, 'time@10': 6.0952}:  23%|██▎       | 7/30 [00:29<01:48,  4.73s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0259, 'hit_ratio@10': 0.9182, 'ndcg@10': 0.8985, 'compress@10': 0.9889, 'time@10': 6.0624}:  23%|██▎       | 7/30 [00:35<01:48,  4.73s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0259, 'hit_ratio@10': 0.9182, 'ndcg@10': 0.8985, 'compress@10': 0.9889, 'time@10': 6.0624}:  27%|██▋       | 8/30 [00:35<01:52,  5.09s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0261, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.9042, 'compress@10': 0.9878, 'time@10': 6.2202}:  27%|██▋       | 8/30 [00:39<01:52,  5.09s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0261, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.9042, 'compress@10': 0.9878, 'time@10': 6.2202}:  30%|███       | 9/30 [00:39<01:38,  4.68s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9099, 'compress@10': 0.9873, 'time@10': 6.3158}:  30%|███       | 9/30 [00:46<01:38,  4.68s/it]    {'epoch': 32, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9099, 'compress@10': 0.9873, 'time@10': 6.3158}:  33%|███▎      | 10/30 [00:46<01:49,  5.47s/it]{'epoch': 32, 'num_users': 6.6364, 'loss': 0.0256, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9096, 'compress@10': 0.988, 'time@10': 6.3451}:  33%|███▎      | 10/30 [00:50<01:49,  5.47s/it]{'epoch': 32, 'num_users': 6.6364, 'loss': 0.0256, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9096, 'compress@10': 0.988, 'time@10': 6.3451}:  37%|███▋      | 11/30 [00:50<01:31,  4.82s/it]{'epoch': 32, 'num_users': 6.4167, 'loss': 0.0237, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9102, 'compress@10': 0.9868, 'time@10': 6.0793}:  37%|███▋      | 11/30 [00:53<01:31,  4.82s/it]{'epoch': 32, 'num_users': 6.4167, 'loss': 0.0237, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9102, 'compress@10': 0.9868, 'time@10': 6.0793}:  40%|████      | 12/30 [00:53<01:17,  4.33s/it]{'epoch': 32, 'num_users': 6.6154, 'loss': 0.0241, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9099, 'compress@10': 0.987, 'time@10': 6.1539}:  40%|████      | 12/30 [00:56<01:17,  4.33s/it]{'epoch': 32, 'num_users': 6.6154, 'loss': 0.0241, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9099, 'compress@10': 0.987, 'time@10': 6.1539}:  43%|████▎     | 13/30 [00:56<01:09,  4.10s/it]{'epoch': 32, 'num_users': 6.3571, 'loss': 0.0225, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9045, 'compress@10': 0.987, 'time@10': 5.9419}:  43%|████▎     | 13/30 [01:00<01:09,  4.10s/it]{'epoch': 32, 'num_users': 6.3571, 'loss': 0.0225, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9045, 'compress@10': 0.987, 'time@10': 5.9419}:  47%|████▋     | 14/30 [01:00<01:01,  3.83s/it]{'epoch': 32, 'num_users': 6.2667, 'loss': 0.0233, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.905, 'compress@10': 0.9873, 'time@10': 6.0629}:  47%|████▋     | 14/30 [01:04<01:01,  3.83s/it]{'epoch': 32, 'num_users': 6.2667, 'loss': 0.0233, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.905, 'compress@10': 0.9873, 'time@10': 6.0629}:  50%|█████     | 15/30 [01:04<00:57,  3.86s/it]{'epoch': 32, 'num_users': 6.0625, 'loss': 0.0219, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9057, 'compress@10': 0.9873, 'time@10': 5.8997}:  50%|█████     | 15/30 [01:07<00:57,  3.86s/it]{'epoch': 32, 'num_users': 6.0625, 'loss': 0.0219, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9057, 'compress@10': 0.9873, 'time@10': 5.8997}:  53%|█████▎    | 16/30 [01:07<00:52,  3.75s/it]{'epoch': 32, 'num_users': 5.8235, 'loss': 0.0207, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8978, 'compress@10': 0.9878, 'time@10': 5.7374}:  53%|█████▎    | 16/30 [01:09<00:52,  3.75s/it]{'epoch': 32, 'num_users': 5.8235, 'loss': 0.0207, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8978, 'compress@10': 0.9878, 'time@10': 5.7374}:  57%|█████▋    | 17/30 [01:09<00:40,  3.10s/it]{'epoch': 32, 'num_users': 6.0556, 'loss': 0.0207, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8989, 'compress@10': 0.9872, 'time@10': 5.6161}:  57%|█████▋    | 17/30 [01:12<00:40,  3.10s/it]{'epoch': 32, 'num_users': 6.0556, 'loss': 0.0207, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8989, 'compress@10': 0.9872, 'time@10': 5.6161}:  60%|██████    | 18/30 [01:12<00:39,  3.25s/it]{'epoch': 32, 'num_users': 6.0, 'loss': 0.0202, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.9, 'compress@10': 0.9871, 'time@10': 5.5187}:  60%|██████    | 18/30 [01:14<00:39,  3.25s/it]      {'epoch': 32, 'num_users': 6.0, 'loss': 0.0202, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.9, 'compress@10': 0.9871, 'time@10': 5.5187}:  63%|██████▎   | 19/30 [01:14<00:31,  2.85s/it]{'epoch': 32, 'num_users': 6.15, 'loss': 0.0204, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.9016, 'compress@10': 0.9876, 'time@10': 5.6514}:  63%|██████▎   | 19/30 [01:22<00:31,  2.85s/it]{'epoch': 32, 'num_users': 6.15, 'loss': 0.0204, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.9016, 'compress@10': 0.9876, 'time@10': 5.6514}:  67%|██████▋   | 20/30 [01:22<00:44,  4.46s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8995, 'compress@10': 0.988, 'time@10': 5.754}:  67%|██████▋   | 20/30 [01:26<00:44,  4.46s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8995, 'compress@10': 0.988, 'time@10': 5.754}:  70%|███████   | 21/30 [01:26<00:38,  4.31s/it]{'epoch': 32, 'num_users': 6.1818, 'loss': 0.0219, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8995, 'compress@10': 0.9878, 'time@10': 5.65}:  70%|███████   | 21/30 [01:30<00:38,  4.31s/it]{'epoch': 32, 'num_users': 6.1818, 'loss': 0.0219, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8995, 'compress@10': 0.9878, 'time@10': 5.65}:  73%|███████▎  | 22/30 [01:30<00:32,  4.07s/it]{'epoch': 32, 'num_users': 6.1304, 'loss': 0.0216, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.9012, 'compress@10': 0.9882, 'time@10': 5.6782}:  73%|███████▎  | 22/30 [01:33<00:32,  4.07s/it]{'epoch': 32, 'num_users': 6.1304, 'loss': 0.0216, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.9012, 'compress@10': 0.9882, 'time@10': 5.6782}:  77%|███████▋  | 23/30 [01:33<00:26,  3.80s/it]{'epoch': 32, 'num_users': 5.9583, 'loss': 0.0208, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.897, 'compress@10': 0.9885, 'time@10': 5.5548}:  77%|███████▋  | 23/30 [01:36<00:26,  3.80s/it] {'epoch': 32, 'num_users': 5.9583, 'loss': 0.0208, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.897, 'compress@10': 0.9885, 'time@10': 5.5548}:  80%|████████  | 24/30 [01:36<00:20,  3.49s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8878, 'compress@10': 0.9886, 'time@10': 5.4364}:  80%|████████  | 24/30 [01:37<00:20,  3.49s/it]    {'epoch': 32, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8878, 'compress@10': 0.9886, 'time@10': 5.4364}:  83%|████████▎ | 25/30 [01:37<00:14,  2.84s/it]{'epoch': 32, 'num_users': 5.8077, 'loss': 0.02, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8896, 'compress@10': 0.9884, 'time@10': 5.529}:  83%|████████▎ | 25/30 [01:45<00:14,  2.84s/it]{'epoch': 32, 'num_users': 5.8077, 'loss': 0.02, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8896, 'compress@10': 0.9884, 'time@10': 5.529}:  87%|████████▋ | 26/30 [01:45<00:17,  4.36s/it]{'epoch': 32, 'num_users': 5.8889, 'loss': 0.0198, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8913, 'compress@10': 0.9886, 'time@10': 5.5895}:  87%|████████▋ | 26/30 [01:49<00:17,  4.36s/it]{'epoch': 32, 'num_users': 5.8889, 'loss': 0.0198, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8913, 'compress@10': 0.9886, 'time@10': 5.5895}:  90%|█████████ | 27/30 [01:49<00:12,  4.14s/it]{'epoch': 32, 'num_users': 6.0, 'loss': 0.0201, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.8953, 'compress@10': 0.9886, 'time@10': 5.6867}:  90%|█████████ | 27/30 [01:57<00:12,  4.14s/it]   {'epoch': 32, 'num_users': 6.0, 'loss': 0.0201, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.8953, 'compress@10': 0.9886, 'time@10': 5.6867}:  93%|█████████▎| 28/30 [01:57<00:10,  5.40s/it]{'epoch': 32, 'num_users': 5.8621, 'loss': 0.0199, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.897, 'compress@10': 0.9885, 'time@10': 5.7258}:  93%|█████████▎| 28/30 [02:01<00:10,  5.40s/it]{'epoch': 32, 'num_users': 5.8621, 'loss': 0.0199, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.897, 'compress@10': 0.9885, 'time@10': 5.7258}:  97%|█████████▋| 29/30 [02:01<00:04,  4.82s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0201, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8978, 'compress@10': 0.9886, 'time@10': 5.7363}:  97%|█████████▋| 29/30 [02:07<00:04,  4.82s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0201, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8978, 'compress@10': 0.9886, 'time@10': 5.7363}: 100%|██████████| 30/30 [02:07<00:00,  5.20s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.0201, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8978, 'compress@10': 0.9886, 'time@10': 5.7363}: 100%|██████████| 30/30 [02:07<00:00,  4.24s/it]
Epoch: 32
Avg # of users: 5.866666666666666
Avg Loss: 0.02010711657977678
Avg hit ratio: 0.86537736891654
Avg ndcg: 0.8978007530555997
Avg compression ratio: 0.9885909805737144
Avg train time: 5.73629203637441
Std train time: 1.956461510482491
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 41, 9, 21, 30, 10, 10, 9, 6, 10, 10, 43, 43, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0292, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.9959, 'time@10': 6.027}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0292, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.9959, 'time@10': 6.027}:   3%|▎         | 1/30 [00:03<01:28,  3.05s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9107, 'compress@10': 0.9935, 'time@10': 5.6782}:   3%|▎         | 1/30 [00:08<01:28,  3.05s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9107, 'compress@10': 0.9935, 'time@10': 5.6782}:   7%|▋         | 2/30 [00:08<02:03,  4.42s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8928, 'compress@10': 0.9902, 'time@10': 5.0531}:   7%|▋         | 2/30 [00:10<02:03,  4.42s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8928, 'compress@10': 0.9902, 'time@10': 5.0531}:  10%|█         | 3/30 [00:10<01:28,  3.29s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9049, 'compress@10': 0.9865, 'time@10': 4.9078}:  10%|█         | 3/30 [00:14<01:28,  3.29s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9049, 'compress@10': 0.9865, 'time@10': 4.9078}:  13%|█▎        | 4/30 [00:14<01:38,  3.77s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0282, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8863, 'compress@10': 0.9867, 'time@10': 5.5549}:  13%|█▎        | 4/30 [00:18<01:38,  3.77s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0282, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8863, 'compress@10': 0.9867, 'time@10': 5.5549}:  17%|█▋        | 5/30 [00:18<01:37,  3.90s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0266, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.8939, 'compress@10': 0.9885, 'time@10': 5.8469}:  17%|█▋        | 5/30 [00:26<01:37,  3.90s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0266, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.8939, 'compress@10': 0.9885, 'time@10': 5.8469}:  20%|██        | 6/30 [00:26<02:01,  5.07s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0267, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.8965, 'compress@10': 0.989, 'time@10': 6.1787}:  20%|██        | 6/30 [00:30<02:01,  5.07s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.0267, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.8965, 'compress@10': 0.989, 'time@10': 6.1787}:  23%|██▎       | 7/30 [00:30<01:49,  4.76s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0264, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9041, 'compress@10': 0.9894, 'time@10': 6.1068}:  23%|██▎       | 7/30 [00:36<01:49,  4.76s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0264, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9041, 'compress@10': 0.9894, 'time@10': 6.1068}:  27%|██▋       | 8/30 [00:36<01:50,  5.04s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9091, 'compress@10': 0.9882, 'time@10': 6.2898}:  27%|██▋       | 8/30 [00:40<01:50,  5.04s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9091, 'compress@10': 0.9882, 'time@10': 6.2898}:  30%|███       | 9/30 [00:40<01:38,  4.69s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0267, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.9133, 'compress@10': 0.9879, 'time@10': 6.3806}:  30%|███       | 9/30 [00:47<01:38,  4.69s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0267, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.9133, 'compress@10': 0.9879, 'time@10': 6.3806}:  33%|███▎      | 10/30 [00:47<01:49,  5.48s/it]{'epoch': 33, 'num_users': 6.6364, 'loss': 0.0268, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.9129, 'compress@10': 0.9886, 'time@10': 6.5668}:  33%|███▎      | 10/30 [00:51<01:49,  5.48s/it]{'epoch': 33, 'num_users': 6.6364, 'loss': 0.0268, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.9129, 'compress@10': 0.9886, 'time@10': 6.5668}:  37%|███▋      | 11/30 [00:51<01:37,  5.11s/it]{'epoch': 33, 'num_users': 6.4167, 'loss': 0.0248, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9132, 'compress@10': 0.9877, 'time@10': 6.3038}:  37%|███▋      | 11/30 [00:55<01:37,  5.11s/it]{'epoch': 33, 'num_users': 6.4167, 'loss': 0.0248, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9132, 'compress@10': 0.9877, 'time@10': 6.3038}:  40%|████      | 12/30 [00:55<01:23,  4.61s/it]{'epoch': 33, 'num_users': 6.6154, 'loss': 0.0251, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9127, 'compress@10': 0.9879, 'time@10': 6.3654}:  40%|████      | 12/30 [00:58<01:23,  4.61s/it]{'epoch': 33, 'num_users': 6.6154, 'loss': 0.0251, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9127, 'compress@10': 0.9879, 'time@10': 6.3654}:  43%|████▎     | 13/30 [00:58<01:13,  4.30s/it]{'epoch': 33, 'num_users': 6.3571, 'loss': 0.0234, 'hit_ratio@10': 0.87, 'ndcg@10': 0.907, 'compress@10': 0.9878, 'time@10': 6.1477}:  43%|████▎     | 13/30 [01:01<01:13,  4.30s/it]   {'epoch': 33, 'num_users': 6.3571, 'loss': 0.0234, 'hit_ratio@10': 0.87, 'ndcg@10': 0.907, 'compress@10': 0.9878, 'time@10': 6.1477}:  47%|████▋     | 14/30 [01:01<01:04,  4.02s/it]{'epoch': 33, 'num_users': 6.2667, 'loss': 0.0239, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9068, 'compress@10': 0.9881, 'time@10': 6.2524}:  47%|████▋     | 14/30 [01:05<01:04,  4.02s/it]{'epoch': 33, 'num_users': 6.2667, 'loss': 0.0239, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9068, 'compress@10': 0.9881, 'time@10': 6.2524}:  50%|█████     | 15/30 [01:05<00:59,  3.98s/it]{'epoch': 33, 'num_users': 6.0625, 'loss': 0.0225, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9074, 'compress@10': 0.9881, 'time@10': 6.0799}:  50%|█████     | 15/30 [01:09<00:59,  3.98s/it]{'epoch': 33, 'num_users': 6.0625, 'loss': 0.0225, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9074, 'compress@10': 0.9881, 'time@10': 6.0799}:  53%|█████▎    | 16/30 [01:09<00:53,  3.85s/it]{'epoch': 33, 'num_users': 5.8235, 'loss': 0.0213, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8994, 'compress@10': 0.9886, 'time@10': 5.9202}:  53%|█████▎    | 16/30 [01:11<00:53,  3.85s/it]{'epoch': 33, 'num_users': 5.8235, 'loss': 0.0213, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8994, 'compress@10': 0.9886, 'time@10': 5.9202}:  57%|█████▋    | 17/30 [01:11<00:41,  3.21s/it]{'epoch': 33, 'num_users': 6.0556, 'loss': 0.0213, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8999, 'compress@10': 0.9877, 'time@10': 5.8062}:  57%|█████▋    | 17/30 [01:15<00:41,  3.21s/it]{'epoch': 33, 'num_users': 6.0556, 'loss': 0.0213, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8999, 'compress@10': 0.9877, 'time@10': 5.8062}:  60%|██████    | 18/30 [01:15<00:41,  3.42s/it]{'epoch': 33, 'num_users': 6.0, 'loss': 0.0208, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9009, 'compress@10': 0.9878, 'time@10': 5.7213}:  60%|██████    | 18/30 [01:17<00:41,  3.42s/it]   {'epoch': 33, 'num_users': 6.0, 'loss': 0.0208, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9009, 'compress@10': 0.9878, 'time@10': 5.7213}:  63%|██████▎   | 19/30 [01:17<00:33,  3.03s/it]{'epoch': 33, 'num_users': 6.15, 'loss': 0.0209, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9027, 'compress@10': 0.9882, 'time@10': 5.8524}:  63%|██████▎   | 19/30 [01:25<00:33,  3.03s/it]{'epoch': 33, 'num_users': 6.15, 'loss': 0.0209, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9027, 'compress@10': 0.9882, 'time@10': 5.8524}:  67%|██████▋   | 20/30 [01:25<00:46,  4.64s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9003, 'compress@10': 0.9886, 'time@10': 5.943}:  67%|██████▋   | 20/30 [01:29<00:46,  4.64s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9003, 'compress@10': 0.9886, 'time@10': 5.943}:  70%|███████   | 21/30 [01:29<00:39,  4.42s/it]{'epoch': 33, 'num_users': 6.1818, 'loss': 0.0227, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9002, 'compress@10': 0.9884, 'time@10': 5.8302}:  70%|███████   | 21/30 [01:32<00:39,  4.42s/it]{'epoch': 33, 'num_users': 6.1818, 'loss': 0.0227, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9002, 'compress@10': 0.9884, 'time@10': 5.8302}:  73%|███████▎  | 22/30 [01:32<00:33,  4.15s/it]{'epoch': 33, 'num_users': 6.1304, 'loss': 0.0222, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.902, 'compress@10': 0.9888, 'time@10': 5.849}:  73%|███████▎  | 22/30 [01:36<00:33,  4.15s/it]  {'epoch': 33, 'num_users': 6.1304, 'loss': 0.0222, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.902, 'compress@10': 0.9888, 'time@10': 5.849}:  77%|███████▋  | 23/30 [01:36<00:26,  3.85s/it]{'epoch': 33, 'num_users': 5.9583, 'loss': 0.0214, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8978, 'compress@10': 0.9892, 'time@10': 5.7228}:  77%|███████▋  | 23/30 [01:39<00:26,  3.85s/it]{'epoch': 33, 'num_users': 5.9583, 'loss': 0.0214, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8978, 'compress@10': 0.9892, 'time@10': 5.7228}:  80%|████████  | 24/30 [01:39<00:21,  3.56s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0206, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8885, 'compress@10': 0.9893, 'time@10': 5.6062}:  80%|████████  | 24/30 [01:40<00:21,  3.56s/it]   {'epoch': 33, 'num_users': 5.8, 'loss': 0.0206, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8885, 'compress@10': 0.9893, 'time@10': 5.6062}:  83%|████████▎ | 25/30 [01:40<00:14,  2.92s/it]{'epoch': 33, 'num_users': 5.8077, 'loss': 0.0205, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8905, 'compress@10': 0.9892, 'time@10': 5.6869}:  83%|████████▎ | 25/30 [01:48<00:14,  2.92s/it]{'epoch': 33, 'num_users': 5.8077, 'loss': 0.0205, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8905, 'compress@10': 0.9892, 'time@10': 5.6869}:  87%|████████▋ | 26/30 [01:48<00:17,  4.37s/it]{'epoch': 33, 'num_users': 5.8889, 'loss': 0.0203, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8919, 'compress@10': 0.9893, 'time@10': 5.761}:  87%|████████▋ | 26/30 [01:52<00:17,  4.37s/it]{'epoch': 33, 'num_users': 5.8889, 'loss': 0.0203, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8919, 'compress@10': 0.9893, 'time@10': 5.761}:  90%|█████████ | 27/30 [01:52<00:12,  4.23s/it]{'epoch': 33, 'num_users': 6.0, 'loss': 0.0202, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.8941, 'compress@10': 0.9894, 'time@10': 5.8532}:  90%|█████████ | 27/30 [02:00<00:12,  4.23s/it]  {'epoch': 33, 'num_users': 6.0, 'loss': 0.0202, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.8941, 'compress@10': 0.9894, 'time@10': 5.8532}:  93%|█████████▎| 28/30 [02:00<00:10,  5.47s/it]{'epoch': 33, 'num_users': 5.8621, 'loss': 0.02, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8959, 'compress@10': 0.9893, 'time@10': 5.8883}:  93%|█████████▎| 28/30 [02:03<00:10,  5.47s/it]{'epoch': 33, 'num_users': 5.8621, 'loss': 0.02, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8959, 'compress@10': 0.9893, 'time@10': 5.8883}:  97%|█████████▋| 29/30 [02:03<00:04,  4.87s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0201, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8969, 'compress@10': 0.9895, 'time@10': 5.8818}:  97%|█████████▋| 29/30 [02:09<00:04,  4.87s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0201, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8969, 'compress@10': 0.9895, 'time@10': 5.8818}: 100%|██████████| 30/30 [02:09<00:00,  5.13s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0201, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8969, 'compress@10': 0.9895, 'time@10': 5.8818}: 100%|██████████| 30/30 [02:09<00:00,  4.32s/it]
Epoch: 33
Avg # of users: 5.866666666666666
Avg Loss: 0.02010174033657178
Avg hit ratio: 0.8736788006003245
Avg ndcg: 0.8969161806933778
Avg compression ratio: 0.9894501108371655
Avg train time: 5.881815512975057
Std train time: 1.9607695840179402
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 41, 9, 21, 30, 10, 10, 9, 6, 10, 10, 44, 44, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.9958, 'time@10': 5.5043}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.9958, 'time@10': 5.5043}:   3%|▎         | 1/30 [00:02<01:20,  2.79s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.906, 'compress@10': 0.9935, 'time@10': 5.1685}:   3%|▎         | 1/30 [00:07<01:20,  2.79s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.906, 'compress@10': 0.9935, 'time@10': 5.1685}:   7%|▋         | 2/30 [00:07<01:52,  4.01s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8897, 'compress@10': 0.99, 'time@10': 4.6111}:   7%|▋         | 2/30 [00:09<01:52,  4.01s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8897, 'compress@10': 0.99, 'time@10': 4.6111}:  10%|█         | 3/30 [00:09<01:20,  3.00s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9206, 'compress@10': 0.986, 'time@10': 4.5738}:  10%|█         | 3/30 [00:13<01:20,  3.00s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9206, 'compress@10': 0.986, 'time@10': 4.5738}:  13%|█▎        | 4/30 [00:13<01:33,  3.59s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0259, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.8995, 'compress@10': 0.9865, 'time@10': 5.3031}:  13%|█▎        | 4/30 [00:18<01:33,  3.59s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0259, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.8995, 'compress@10': 0.9865, 'time@10': 5.3031}:  17%|█▋        | 5/30 [00:18<01:34,  3.79s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0249, 'hit_ratio@10': 0.9142, 'ndcg@10': 0.9063, 'compress@10': 0.9884, 'time@10': 5.6246}:  17%|█▋        | 5/30 [00:25<01:34,  3.79s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0249, 'hit_ratio@10': 0.9142, 'ndcg@10': 0.9063, 'compress@10': 0.9884, 'time@10': 5.6246}:  20%|██        | 6/30 [00:25<01:59,  4.98s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0243, 'hit_ratio@10': 0.9207, 'ndcg@10': 0.9058, 'compress@10': 0.989, 'time@10': 5.9143}:  20%|██        | 6/30 [00:29<01:59,  4.98s/it] {'epoch': 34, 'num_users': 6.2857, 'loss': 0.0243, 'hit_ratio@10': 0.9207, 'ndcg@10': 0.9058, 'compress@10': 0.989, 'time@10': 5.9143}:  23%|██▎       | 7/30 [00:29<01:46,  4.61s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0243, 'hit_ratio@10': 0.9235, 'ndcg@10': 0.9122, 'compress@10': 0.9894, 'time@10': 5.8711}:  23%|██▎       | 7/30 [00:34<01:46,  4.61s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0243, 'hit_ratio@10': 0.9235, 'ndcg@10': 0.9122, 'compress@10': 0.9894, 'time@10': 5.8711}:  27%|██▋       | 8/30 [00:34<01:48,  4.93s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0244, 'hit_ratio@10': 0.9129, 'ndcg@10': 0.917, 'compress@10': 0.9882, 'time@10': 6.071}:  27%|██▋       | 8/30 [00:38<01:48,  4.93s/it] {'epoch': 34, 'num_users': 6.3333, 'loss': 0.0244, 'hit_ratio@10': 0.9129, 'ndcg@10': 0.917, 'compress@10': 0.9882, 'time@10': 6.071}:  30%|███       | 9/30 [00:38<01:36,  4.60s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.9194, 'ndcg@10': 0.922, 'compress@10': 0.9877, 'time@10': 6.1374}:  30%|███       | 9/30 [00:45<01:36,  4.60s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.9194, 'ndcg@10': 0.922, 'compress@10': 0.9877, 'time@10': 6.1374}:  33%|███▎      | 10/30 [00:45<01:45,  5.27s/it]{'epoch': 34, 'num_users': 6.6364, 'loss': 0.0233, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9209, 'compress@10': 0.9884, 'time@10': 6.2891}:  33%|███▎      | 10/30 [00:49<01:45,  5.27s/it]{'epoch': 34, 'num_users': 6.6364, 'loss': 0.0233, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9209, 'compress@10': 0.9884, 'time@10': 6.2891}:  37%|███▋      | 11/30 [00:49<01:32,  4.87s/it]{'epoch': 34, 'num_users': 6.4167, 'loss': 0.0216, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9206, 'compress@10': 0.9878, 'time@10': 6.0391}:  37%|███▋      | 11/30 [00:52<01:32,  4.87s/it] {'epoch': 34, 'num_users': 6.4167, 'loss': 0.0216, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9206, 'compress@10': 0.9878, 'time@10': 6.0391}:  40%|████      | 12/30 [00:52<01:19,  4.41s/it]{'epoch': 34, 'num_users': 6.6154, 'loss': 0.022, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9196, 'compress@10': 0.9881, 'time@10': 6.0918}:  40%|████      | 12/30 [00:56<01:19,  4.41s/it] {'epoch': 34, 'num_users': 6.6154, 'loss': 0.022, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9196, 'compress@10': 0.9881, 'time@10': 6.0918}:  43%|████▎     | 13/30 [00:56<01:09,  4.10s/it]{'epoch': 34, 'num_users': 6.3571, 'loss': 0.0205, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9135, 'compress@10': 0.9879, 'time@10': 5.8971}:  43%|████▎     | 13/30 [00:59<01:09,  4.10s/it]{'epoch': 34, 'num_users': 6.3571, 'loss': 0.0205, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9135, 'compress@10': 0.9879, 'time@10': 5.8971}:  47%|████▋     | 14/30 [00:59<01:02,  3.89s/it]{'epoch': 34, 'num_users': 6.2667, 'loss': 0.0213, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9151, 'compress@10': 0.9883, 'time@10': 6.0977}:  47%|████▋     | 14/30 [01:04<01:02,  3.89s/it]{'epoch': 34, 'num_users': 6.2667, 'loss': 0.0213, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9151, 'compress@10': 0.9883, 'time@10': 6.0977}:  50%|█████     | 15/30 [01:04<01:01,  4.07s/it]{'epoch': 34, 'num_users': 6.0625, 'loss': 0.02, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9152, 'compress@10': 0.9883, 'time@10': 5.9133}:  50%|█████     | 15/30 [01:07<01:01,  4.07s/it]   {'epoch': 34, 'num_users': 6.0625, 'loss': 0.02, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9152, 'compress@10': 0.9883, 'time@10': 5.9133}:  53%|█████▎    | 16/30 [01:07<00:53,  3.81s/it]{'epoch': 34, 'num_users': 5.8235, 'loss': 0.0189, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.9067, 'compress@10': 0.9888, 'time@10': 5.7643}:  53%|█████▎    | 16/30 [01:09<00:53,  3.81s/it]{'epoch': 34, 'num_users': 5.8235, 'loss': 0.0189, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.9067, 'compress@10': 0.9888, 'time@10': 5.7643}:  57%|█████▋    | 17/30 [01:09<00:41,  3.18s/it]{'epoch': 34, 'num_users': 6.0556, 'loss': 0.019, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.9075, 'compress@10': 0.9883, 'time@10': 5.663}:  57%|█████▋    | 17/30 [01:13<00:41,  3.18s/it]  {'epoch': 34, 'num_users': 6.0556, 'loss': 0.019, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.9075, 'compress@10': 0.9883, 'time@10': 5.663}:  60%|██████    | 18/30 [01:13<00:41,  3.43s/it]{'epoch': 34, 'num_users': 6.0, 'loss': 0.0186, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9081, 'compress@10': 0.9884, 'time@10': 5.5692}:  60%|██████    | 18/30 [01:15<00:41,  3.43s/it] {'epoch': 34, 'num_users': 6.0, 'loss': 0.0186, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9081, 'compress@10': 0.9884, 'time@10': 5.5692}:  63%|██████▎   | 19/30 [01:15<00:32,  2.99s/it]{'epoch': 34, 'num_users': 6.15, 'loss': 0.0188, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9099, 'compress@10': 0.9888, 'time@10': 5.7092}:  63%|██████▎   | 19/30 [01:23<00:32,  2.99s/it]{'epoch': 34, 'num_users': 6.15, 'loss': 0.0188, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9099, 'compress@10': 0.9888, 'time@10': 5.7092}:  67%|██████▋   | 20/30 [01:23<00:46,  4.62s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.907, 'compress@10': 0.9892, 'time@10': 5.812}:  67%|██████▋   | 20/30 [01:27<00:46,  4.62s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.907, 'compress@10': 0.9892, 'time@10': 5.812}:  70%|███████   | 21/30 [01:27<00:39,  4.43s/it]{'epoch': 34, 'num_users': 6.1818, 'loss': 0.0208, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9066, 'compress@10': 0.989, 'time@10': 5.7038}:  70%|███████   | 21/30 [01:30<00:39,  4.43s/it]{'epoch': 34, 'num_users': 6.1818, 'loss': 0.0208, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9066, 'compress@10': 0.989, 'time@10': 5.7038}:  73%|███████▎  | 22/30 [01:30<00:33,  4.14s/it]{'epoch': 34, 'num_users': 6.1304, 'loss': 0.0204, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9081, 'compress@10': 0.9894, 'time@10': 5.7276}:  73%|███████▎  | 22/30 [01:34<00:33,  4.14s/it]{'epoch': 34, 'num_users': 6.1304, 'loss': 0.0204, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9081, 'compress@10': 0.9894, 'time@10': 5.7276}:  77%|███████▋  | 23/30 [01:34<00:26,  3.85s/it]{'epoch': 34, 'num_users': 5.9583, 'loss': 0.0196, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9036, 'compress@10': 0.9898, 'time@10': 5.6095}:  77%|███████▋  | 23/30 [01:36<00:26,  3.85s/it]{'epoch': 34, 'num_users': 5.9583, 'loss': 0.0196, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9036, 'compress@10': 0.9898, 'time@10': 5.6095}:  80%|████████  | 24/30 [01:36<00:21,  3.57s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0189, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8941, 'compress@10': 0.9899, 'time@10': 5.5007}:  80%|████████  | 24/30 [01:38<00:21,  3.57s/it]   {'epoch': 34, 'num_users': 5.8, 'loss': 0.0189, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8941, 'compress@10': 0.9899, 'time@10': 5.5007}:  83%|████████▎ | 25/30 [01:38<00:14,  2.95s/it]{'epoch': 34, 'num_users': 5.8077, 'loss': 0.0189, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8961, 'compress@10': 0.9898, 'time@10': 5.6159}:  83%|████████▎ | 25/30 [01:46<00:14,  2.95s/it]{'epoch': 34, 'num_users': 5.8077, 'loss': 0.0189, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8961, 'compress@10': 0.9898, 'time@10': 5.6159}:  87%|████████▋ | 26/30 [01:46<00:18,  4.62s/it]{'epoch': 34, 'num_users': 5.8889, 'loss': 0.0187, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8974, 'compress@10': 0.99, 'time@10': 5.6728}:  87%|████████▋ | 26/30 [01:50<00:18,  4.62s/it]  {'epoch': 34, 'num_users': 5.8889, 'loss': 0.0187, 'hit_ratio@10': 0.8674, 'ndcg@10': 0.8974, 'compress@10': 0.99, 'time@10': 5.6728}:  90%|█████████ | 27/30 [01:50<00:12,  4.33s/it]{'epoch': 34, 'num_users': 6.0, 'loss': 0.0186, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8997, 'compress@10': 0.9901, 'time@10': 5.7676}:  90%|█████████ | 27/30 [01:58<00:12,  4.33s/it] {'epoch': 34, 'num_users': 6.0, 'loss': 0.0186, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8997, 'compress@10': 0.9901, 'time@10': 5.7676}:  93%|█████████▎| 28/30 [01:58<00:11,  5.54s/it]{'epoch': 34, 'num_users': 5.8621, 'loss': 0.0184, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9013, 'compress@10': 0.99, 'time@10': 5.8056}:  93%|█████████▎| 28/30 [02:02<00:11,  5.54s/it]{'epoch': 34, 'num_users': 5.8621, 'loss': 0.0184, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9013, 'compress@10': 0.99, 'time@10': 5.8056}:  97%|█████████▋| 29/30 [02:02<00:04,  4.92s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.0186, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9022, 'compress@10': 0.9902, 'time@10': 5.8179}:  97%|█████████▋| 29/30 [02:08<00:04,  4.92s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.0186, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9022, 'compress@10': 0.9902, 'time@10': 5.8179}: 100%|██████████| 30/30 [02:08<00:00,  5.31s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.0186, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9022, 'compress@10': 0.9902, 'time@10': 5.8179}: 100%|██████████| 30/30 [02:08<00:00,  4.29s/it]
Epoch: 34
Avg # of users: 5.866666666666666
Avg Loss: 0.018647105864890677
Avg hit ratio: 0.8749269119660831
Avg ndcg: 0.9021825898888521
Avg compression ratio: 0.9901818436664076
Avg train time: 5.817873581250509
Std train time: 2.008891858699062
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 41, 9, 22, 30, 10, 10, 9, 6, 10, 10, 45, 45, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.9957, 'time@10': 5.9396}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.9957, 'time@10': 5.9396}:   3%|▎         | 1/30 [00:03<01:27,  3.01s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9086, 'compress@10': 0.9927, 'time@10': 5.4364}:   3%|▎         | 1/30 [00:07<01:27,  3.01s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9086, 'compress@10': 0.9927, 'time@10': 5.4364}:   7%|▋         | 2/30 [00:07<01:56,  4.17s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8915, 'compress@10': 0.9909, 'time@10': 4.8853}:   7%|▋         | 2/30 [00:09<01:56,  4.17s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8915, 'compress@10': 0.9909, 'time@10': 4.8853}:  10%|█         | 3/30 [00:09<01:24,  3.15s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9049, 'compress@10': 0.9862, 'time@10': 4.7676}:  10%|█         | 3/30 [00:14<01:24,  3.15s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9049, 'compress@10': 0.9862, 'time@10': 4.7676}:  13%|█▎        | 4/30 [00:14<01:35,  3.66s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0219, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.8871, 'compress@10': 0.987, 'time@10': 5.4385}:  13%|█▎        | 4/30 [00:18<01:35,  3.66s/it] {'epoch': 35, 'num_users': 5.8, 'loss': 0.0219, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.8871, 'compress@10': 0.987, 'time@10': 5.4385}:  17%|█▋        | 5/30 [00:18<01:35,  3.82s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.023, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.8956, 'compress@10': 0.9887, 'time@10': 5.7411}:  17%|█▋        | 5/30 [00:25<01:35,  3.82s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.023, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.8956, 'compress@10': 0.9887, 'time@10': 5.7411}:  20%|██        | 6/30 [00:25<02:00,  5.00s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0239, 'hit_ratio@10': 0.9156, 'ndcg@10': 0.8991, 'compress@10': 0.9893, 'time@10': 5.9724}:  20%|██        | 6/30 [00:29<02:00,  5.00s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0239, 'hit_ratio@10': 0.9156, 'ndcg@10': 0.8991, 'compress@10': 0.9893, 'time@10': 5.9724}:  23%|██▎       | 7/30 [00:29<01:45,  4.58s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.024, 'hit_ratio@10': 0.919, 'ndcg@10': 0.9064, 'compress@10': 0.9898, 'time@10': 5.9268}:  23%|██▎       | 7/30 [00:35<01:45,  4.58s/it]   {'epoch': 35, 'num_users': 6.125, 'loss': 0.024, 'hit_ratio@10': 0.919, 'ndcg@10': 0.9064, 'compress@10': 0.9898, 'time@10': 5.9268}:  27%|██▋       | 8/30 [00:35<01:48,  4.92s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.024, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.912, 'compress@10': 0.9884, 'time@10': 6.1152}:  27%|██▋       | 8/30 [00:38<01:48,  4.92s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.024, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.912, 'compress@10': 0.9884, 'time@10': 6.1152}:  30%|███       | 9/30 [00:38<01:36,  4.59s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.917, 'compress@10': 0.9883, 'time@10': 6.2032}:  30%|███       | 9/30 [00:46<01:36,  4.59s/it]  {'epoch': 35, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.917, 'compress@10': 0.9883, 'time@10': 6.2032}:  33%|███▎      | 10/30 [00:46<01:46,  5.34s/it]{'epoch': 35, 'num_users': 6.6364, 'loss': 0.0246, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9164, 'compress@10': 0.9889, 'time@10': 6.325}:  33%|███▎      | 10/30 [00:49<01:46,  5.34s/it]{'epoch': 35, 'num_users': 6.6364, 'loss': 0.0246, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9164, 'compress@10': 0.9889, 'time@10': 6.325}:  37%|███▋      | 11/30 [00:49<01:32,  4.87s/it]{'epoch': 35, 'num_users': 6.4167, 'loss': 0.0227, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9164, 'compress@10': 0.9886, 'time@10': 6.0664}:  37%|███▋      | 11/30 [00:53<01:32,  4.87s/it]{'epoch': 35, 'num_users': 6.4167, 'loss': 0.0227, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9164, 'compress@10': 0.9886, 'time@10': 6.0664}:  40%|████      | 12/30 [00:53<01:18,  4.38s/it]{'epoch': 35, 'num_users': 6.6154, 'loss': 0.023, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9162, 'compress@10': 0.9888, 'time@10': 6.1329}:  40%|████      | 12/30 [00:56<01:18,  4.38s/it] {'epoch': 35, 'num_users': 6.6154, 'loss': 0.023, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9162, 'compress@10': 0.9888, 'time@10': 6.1329}:  43%|████▎     | 13/30 [00:56<01:09,  4.12s/it]{'epoch': 35, 'num_users': 6.3571, 'loss': 0.0214, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9103, 'compress@10': 0.9886, 'time@10': 5.9291}:  43%|████▎     | 13/30 [00:59<01:09,  4.12s/it]{'epoch': 35, 'num_users': 6.3571, 'loss': 0.0214, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9103, 'compress@10': 0.9886, 'time@10': 5.9291}:  47%|████▋     | 14/30 [00:59<01:02,  3.88s/it]{'epoch': 35, 'num_users': 6.2667, 'loss': 0.0225, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9115, 'compress@10': 0.989, 'time@10': 6.098}:  47%|████▋     | 14/30 [01:04<01:02,  3.88s/it]  {'epoch': 35, 'num_users': 6.2667, 'loss': 0.0225, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9115, 'compress@10': 0.989, 'time@10': 6.098}:  50%|█████     | 15/30 [01:04<00:59,  4.00s/it]{'epoch': 35, 'num_users': 6.0625, 'loss': 0.0211, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9118, 'compress@10': 0.9889, 'time@10': 5.9115}:  50%|█████     | 15/30 [01:07<00:59,  4.00s/it]{'epoch': 35, 'num_users': 6.0625, 'loss': 0.0211, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9118, 'compress@10': 0.9889, 'time@10': 5.9115}:  53%|█████▎    | 16/30 [01:07<00:52,  3.74s/it]{'epoch': 35, 'num_users': 5.8235, 'loss': 0.02, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9035, 'compress@10': 0.9894, 'time@10': 5.7571}:  53%|█████▎    | 16/30 [01:09<00:52,  3.74s/it]  {'epoch': 35, 'num_users': 5.8235, 'loss': 0.02, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9035, 'compress@10': 0.9894, 'time@10': 5.7571}:  57%|█████▋    | 17/30 [01:09<00:40,  3.12s/it]{'epoch': 35, 'num_users': 6.0556, 'loss': 0.02, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.9039, 'compress@10': 0.9886, 'time@10': 5.6556}:  57%|█████▋    | 17/30 [01:12<00:40,  3.12s/it]{'epoch': 35, 'num_users': 6.0556, 'loss': 0.02, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.9039, 'compress@10': 0.9886, 'time@10': 5.6556}:  60%|██████    | 18/30 [01:12<00:40,  3.38s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 0.0195, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.9047, 'compress@10': 0.9887, 'time@10': 5.5558}:  60%|██████    | 18/30 [01:14<00:40,  3.38s/it] {'epoch': 35, 'num_users': 6.0, 'loss': 0.0195, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.9047, 'compress@10': 0.9887, 'time@10': 5.5558}:  63%|██████▎   | 19/30 [01:14<00:32,  2.94s/it]{'epoch': 35, 'num_users': 6.15, 'loss': 0.0197, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9066, 'compress@10': 0.989, 'time@10': 5.6697}:  63%|██████▎   | 19/30 [01:22<00:32,  2.94s/it]{'epoch': 35, 'num_users': 6.15, 'loss': 0.0197, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9066, 'compress@10': 0.989, 'time@10': 5.6697}:  67%|██████▋   | 20/30 [01:22<00:44,  4.42s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.9045, 'compress@10': 0.9894, 'time@10': 5.77}:  67%|██████▋   | 20/30 [01:26<00:44,  4.42s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.9045, 'compress@10': 0.9894, 'time@10': 5.77}:  70%|███████   | 21/30 [01:26<00:38,  4.27s/it]{'epoch': 35, 'num_users': 6.1818, 'loss': 0.021, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9046, 'compress@10': 0.9896, 'time@10': 5.6648}:  70%|███████   | 21/30 [01:30<00:38,  4.27s/it]{'epoch': 35, 'num_users': 6.1818, 'loss': 0.021, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9046, 'compress@10': 0.9896, 'time@10': 5.6648}:  73%|███████▎  | 22/30 [01:30<00:32,  4.04s/it]{'epoch': 35, 'num_users': 6.1304, 'loss': 0.0206, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9062, 'compress@10': 0.9899, 'time@10': 5.6915}:  73%|███████▎  | 22/30 [01:33<00:32,  4.04s/it]{'epoch': 35, 'num_users': 6.1304, 'loss': 0.0206, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9062, 'compress@10': 0.9899, 'time@10': 5.6915}:  77%|███████▋  | 23/30 [01:33<00:26,  3.78s/it]{'epoch': 35, 'num_users': 5.9583, 'loss': 0.0197, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9018, 'compress@10': 0.9903, 'time@10': 5.5773}:  77%|███████▋  | 23/30 [01:36<00:26,  3.78s/it]{'epoch': 35, 'num_users': 5.9583, 'loss': 0.0197, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9018, 'compress@10': 0.9903, 'time@10': 5.5773}:  80%|████████  | 24/30 [01:36<00:21,  3.55s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8924, 'compress@10': 0.9904, 'time@10': 5.4716}:  80%|████████  | 24/30 [01:37<00:21,  3.55s/it]    {'epoch': 35, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8924, 'compress@10': 0.9904, 'time@10': 5.4716}:  83%|████████▎ | 25/30 [01:37<00:14,  2.94s/it]{'epoch': 35, 'num_users': 5.8077, 'loss': 0.019, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8945, 'compress@10': 0.9904, 'time@10': 5.5673}:  83%|████████▎ | 25/30 [01:45<00:14,  2.94s/it]{'epoch': 35, 'num_users': 5.8077, 'loss': 0.019, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8945, 'compress@10': 0.9904, 'time@10': 5.5673}:  87%|████████▋ | 26/30 [01:45<00:17,  4.46s/it]{'epoch': 35, 'num_users': 5.8889, 'loss': 0.0188, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8961, 'compress@10': 0.9905, 'time@10': 5.6242}:  87%|████████▋ | 26/30 [01:49<00:17,  4.46s/it]{'epoch': 35, 'num_users': 5.8889, 'loss': 0.0188, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8961, 'compress@10': 0.9905, 'time@10': 5.6242}:  90%|█████████ | 27/30 [01:49<00:12,  4.20s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 0.0188, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.8987, 'compress@10': 0.9907, 'time@10': 5.7101}:  90%|█████████ | 27/30 [01:57<00:12,  4.20s/it]  {'epoch': 35, 'num_users': 6.0, 'loss': 0.0188, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.8987, 'compress@10': 0.9907, 'time@10': 5.7101}:  93%|█████████▎| 28/30 [01:57<00:10,  5.36s/it]{'epoch': 35, 'num_users': 5.8621, 'loss': 0.0186, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9003, 'compress@10': 0.9906, 'time@10': 5.7515}:  93%|█████████▎| 28/30 [02:01<00:10,  5.36s/it]{'epoch': 35, 'num_users': 5.8621, 'loss': 0.0186, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9003, 'compress@10': 0.9906, 'time@10': 5.7515}:  97%|█████████▋| 29/30 [02:01<00:04,  4.80s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0188, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9013, 'compress@10': 0.9908, 'time@10': 5.7567}:  97%|█████████▋| 29/30 [02:07<00:04,  4.80s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0188, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9013, 'compress@10': 0.9908, 'time@10': 5.7567}: 100%|██████████| 30/30 [02:07<00:00,  5.15s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0188, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9013, 'compress@10': 0.9908, 'time@10': 5.7567}: 100%|██████████| 30/30 [02:07<00:00,  4.23s/it]
Epoch: 35
Avg # of users: 5.866666666666666
Avg Loss: 0.01875489989225842
Avg hit ratio: 0.8747398290028164
Avg ndcg: 0.9013113406328978
Avg compression ratio: 0.9907887295743244
Avg train time: 5.756744170188904
Std train time: 1.9122416036037373
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 41, 9, 23, 30, 10, 10, 9, 6, 10, 10, 46, 46, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.9955, 'time@10': 6.6499}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.9955, 'time@10': 6.6499}:   3%|▎         | 1/30 [00:03<01:38,  3.41s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.906, 'compress@10': 0.9931, 'time@10': 6.0051}:   3%|▎         | 1/30 [00:08<01:38,  3.41s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.906, 'compress@10': 0.9931, 'time@10': 6.0051}:   7%|▋         | 2/30 [00:08<02:08,  4.58s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8897, 'compress@10': 0.9908, 'time@10': 5.2497}:   7%|▋         | 2/30 [00:10<02:08,  4.58s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8897, 'compress@10': 0.9908, 'time@10': 5.2497}:  10%|█         | 3/30 [00:10<01:30,  3.36s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8967, 'compress@10': 0.9862, 'time@10': 5.0464}:  10%|█         | 3/30 [00:15<01:30,  3.36s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8967, 'compress@10': 0.9862, 'time@10': 5.0464}:  13%|█▎        | 4/30 [00:15<01:38,  3.80s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0229, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.882, 'compress@10': 0.9869, 'time@10': 5.6544}:  13%|█▎        | 4/30 [00:19<01:38,  3.80s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 0.0229, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.882, 'compress@10': 0.9869, 'time@10': 5.6544}:  17%|█▋        | 5/30 [00:19<01:37,  3.90s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0215, 'hit_ratio@10': 0.9142, 'ndcg@10': 0.8931, 'compress@10': 0.9887, 'time@10': 5.9304}:  17%|█▋        | 5/30 [00:26<01:37,  3.90s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0215, 'hit_ratio@10': 0.9142, 'ndcg@10': 0.8931, 'compress@10': 0.9887, 'time@10': 5.9304}:  20%|██        | 6/30 [00:26<02:01,  5.08s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0214, 'hit_ratio@10': 0.9207, 'ndcg@10': 0.894, 'compress@10': 0.9893, 'time@10': 6.3158}:  20%|██        | 6/30 [00:30<02:01,  5.08s/it] {'epoch': 36, 'num_users': 6.2857, 'loss': 0.0214, 'hit_ratio@10': 0.9207, 'ndcg@10': 0.894, 'compress@10': 0.9893, 'time@10': 6.3158}:  23%|██▎       | 7/30 [00:30<01:51,  4.84s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0218, 'hit_ratio@10': 0.9235, 'ndcg@10': 0.9024, 'compress@10': 0.9899, 'time@10': 6.2841}:  23%|██▎       | 7/30 [00:37<01:51,  4.84s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0218, 'hit_ratio@10': 0.9235, 'ndcg@10': 0.9024, 'compress@10': 0.9899, 'time@10': 6.2841}:  27%|██▋       | 8/30 [00:37<01:55,  5.24s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.9084, 'compress@10': 0.9885, 'time@10': 6.4601}:  27%|██▋       | 8/30 [00:41<01:55,  5.24s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.9084, 'compress@10': 0.9885, 'time@10': 6.4601}:  30%|███       | 9/30 [00:41<01:41,  4.85s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9126, 'compress@10': 0.988, 'time@10': 6.5379}:  30%|███       | 9/30 [00:48<01:41,  4.85s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9126, 'compress@10': 0.988, 'time@10': 6.5379}:  33%|███▎      | 10/30 [00:48<01:51,  5.60s/it]{'epoch': 36, 'num_users': 6.6364, 'loss': 0.0226, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9127, 'compress@10': 0.9886, 'time@10': 6.6143}:  33%|███▎      | 10/30 [00:52<01:51,  5.60s/it]{'epoch': 36, 'num_users': 6.6364, 'loss': 0.0226, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9127, 'compress@10': 0.9886, 'time@10': 6.6143}:  37%|███▋      | 11/30 [00:52<01:35,  5.03s/it]{'epoch': 36, 'num_users': 6.4167, 'loss': 0.0208, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.913, 'compress@10': 0.9884, 'time@10': 6.3392}:  37%|███▋      | 11/30 [00:55<01:35,  5.03s/it] {'epoch': 36, 'num_users': 6.4167, 'loss': 0.0208, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.913, 'compress@10': 0.9884, 'time@10': 6.3392}:  40%|████      | 12/30 [00:55<01:21,  4.52s/it]{'epoch': 36, 'num_users': 6.6154, 'loss': 0.0212, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9128, 'compress@10': 0.9888, 'time@10': 6.384}:  40%|████      | 12/30 [00:58<01:21,  4.52s/it]{'epoch': 36, 'num_users': 6.6154, 'loss': 0.0212, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9128, 'compress@10': 0.9888, 'time@10': 6.384}:  43%|████▎     | 13/30 [00:58<01:11,  4.22s/it]{'epoch': 36, 'num_users': 6.3571, 'loss': 0.0197, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9071, 'compress@10': 0.9886, 'time@10': 6.1712}:  43%|████▎     | 13/30 [01:02<01:11,  4.22s/it]{'epoch': 36, 'num_users': 6.3571, 'loss': 0.0197, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9071, 'compress@10': 0.9886, 'time@10': 6.1712}:  47%|████▋     | 14/30 [01:02<01:03,  3.99s/it]{'epoch': 36, 'num_users': 6.2667, 'loss': 0.0206, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.9091, 'compress@10': 0.989, 'time@10': 6.3225}:  47%|████▋     | 14/30 [01:06<01:03,  3.99s/it] {'epoch': 36, 'num_users': 6.2667, 'loss': 0.0206, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.9091, 'compress@10': 0.989, 'time@10': 6.3225}:  50%|█████     | 15/30 [01:06<01:01,  4.07s/it]{'epoch': 36, 'num_users': 6.0625, 'loss': 0.0195, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9096, 'compress@10': 0.989, 'time@10': 6.1327}:  50%|█████     | 15/30 [01:10<01:01,  4.07s/it]{'epoch': 36, 'num_users': 6.0625, 'loss': 0.0195, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9096, 'compress@10': 0.989, 'time@10': 6.1327}:  53%|█████▎    | 16/30 [01:10<00:53,  3.85s/it]{'epoch': 36, 'num_users': 5.8235, 'loss': 0.0184, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9014, 'compress@10': 0.9895, 'time@10': 5.9741}:  53%|█████▎    | 16/30 [01:11<00:53,  3.85s/it]{'epoch': 36, 'num_users': 5.8235, 'loss': 0.0184, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9014, 'compress@10': 0.9895, 'time@10': 5.9741}:  57%|█████▋    | 17/30 [01:11<00:41,  3.22s/it]{'epoch': 36, 'num_users': 6.0556, 'loss': 0.0185, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.903, 'compress@10': 0.989, 'time@10': 5.8894}:  57%|█████▋    | 17/30 [01:16<00:41,  3.22s/it]  {'epoch': 36, 'num_users': 6.0556, 'loss': 0.0185, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.903, 'compress@10': 0.989, 'time@10': 5.8894}:  60%|██████    | 18/30 [01:16<00:43,  3.60s/it]{'epoch': 36, 'num_users': 6.0, 'loss': 0.0182, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9039, 'compress@10': 0.9891, 'time@10': 5.7753}:  60%|██████    | 18/30 [01:18<00:43,  3.60s/it] {'epoch': 36, 'num_users': 6.0, 'loss': 0.0182, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9039, 'compress@10': 0.9891, 'time@10': 5.7753}:  63%|██████▎   | 19/30 [01:18<00:34,  3.09s/it]{'epoch': 36, 'num_users': 6.15, 'loss': 0.0184, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9063, 'compress@10': 0.9894, 'time@10': 5.9074}:  63%|██████▎   | 19/30 [01:26<00:34,  3.09s/it]{'epoch': 36, 'num_users': 6.15, 'loss': 0.0184, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9063, 'compress@10': 0.9894, 'time@10': 5.9074}:  67%|██████▋   | 20/30 [01:26<00:47,  4.70s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0194, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9039, 'compress@10': 0.9898, 'time@10': 5.9914}:  67%|██████▋   | 20/30 [01:30<00:47,  4.70s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0194, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9039, 'compress@10': 0.9898, 'time@10': 5.9914}:  70%|███████   | 21/30 [01:30<00:40,  4.45s/it]{'epoch': 36, 'num_users': 6.1818, 'loss': 0.02, 'hit_ratio@10': 0.874, 'ndcg@10': 0.904, 'compress@10': 0.9899, 'time@10': 5.8755}:  70%|███████   | 21/30 [01:33<00:40,  4.45s/it]    {'epoch': 36, 'num_users': 6.1818, 'loss': 0.02, 'hit_ratio@10': 0.874, 'ndcg@10': 0.904, 'compress@10': 0.9899, 'time@10': 5.8755}:  73%|███████▎  | 22/30 [01:33<00:33,  4.16s/it]{'epoch': 36, 'num_users': 6.1304, 'loss': 0.0196, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.9056, 'compress@10': 0.9903, 'time@10': 5.8918}:  73%|███████▎  | 22/30 [01:37<00:33,  4.16s/it]{'epoch': 36, 'num_users': 6.1304, 'loss': 0.0196, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.9056, 'compress@10': 0.9903, 'time@10': 5.8918}:  77%|███████▋  | 23/30 [01:37<00:27,  3.86s/it]{'epoch': 36, 'num_users': 5.9583, 'loss': 0.0188, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9012, 'compress@10': 0.9906, 'time@10': 5.7727}:  77%|███████▋  | 23/30 [01:40<00:27,  3.86s/it] {'epoch': 36, 'num_users': 5.9583, 'loss': 0.0188, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9012, 'compress@10': 0.9906, 'time@10': 5.7727}:  80%|████████  | 24/30 [01:40<00:21,  3.63s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8918, 'compress@10': 0.9908, 'time@10': 5.6611}:  80%|████████  | 24/30 [01:41<00:21,  3.63s/it]  {'epoch': 36, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8918, 'compress@10': 0.9908, 'time@10': 5.6611}:  83%|████████▎ | 25/30 [01:41<00:14,  3.00s/it]{'epoch': 36, 'num_users': 5.8077, 'loss': 0.018, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8941, 'compress@10': 0.9908, 'time@10': 5.7483}:  83%|████████▎ | 25/30 [01:49<00:14,  3.00s/it]{'epoch': 36, 'num_users': 5.8077, 'loss': 0.018, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8941, 'compress@10': 0.9908, 'time@10': 5.7483}:  87%|████████▋ | 26/30 [01:49<00:17,  4.49s/it]{'epoch': 36, 'num_users': 5.8889, 'loss': 0.0179, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8955, 'compress@10': 0.9909, 'time@10': 5.7879}:  87%|████████▋ | 26/30 [01:53<00:17,  4.49s/it]{'epoch': 36, 'num_users': 5.8889, 'loss': 0.0179, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8955, 'compress@10': 0.9909, 'time@10': 5.7879}:  90%|█████████ | 27/30 [01:53<00:12,  4.18s/it]{'epoch': 36, 'num_users': 6.0, 'loss': 0.0179, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8982, 'compress@10': 0.9911, 'time@10': 5.8773}:  90%|█████████ | 27/30 [02:01<00:12,  4.18s/it]   {'epoch': 36, 'num_users': 6.0, 'loss': 0.0179, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8982, 'compress@10': 0.9911, 'time@10': 5.8773}:  93%|█████████▎| 28/30 [02:01<00:10,  5.42s/it]{'epoch': 36, 'num_users': 5.8621, 'loss': 0.0177, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9, 'compress@10': 0.991, 'time@10': 5.9128}:  93%|█████████▎| 28/30 [02:05<00:10,  5.42s/it]  {'epoch': 36, 'num_users': 5.8621, 'loss': 0.0177, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9, 'compress@10': 0.991, 'time@10': 5.9128}:  97%|█████████▋| 29/30 [02:05<00:04,  4.85s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0179, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9016, 'compress@10': 0.9912, 'time@10': 5.9132}:  97%|█████████▋| 29/30 [02:10<00:04,  4.85s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0179, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9016, 'compress@10': 0.9912, 'time@10': 5.9132}: 100%|██████████| 30/30 [02:10<00:00,  5.18s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0179, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9016, 'compress@10': 0.9912, 'time@10': 5.9132}: 100%|██████████| 30/30 [02:10<00:00,  4.37s/it]
Epoch: 36
Avg # of users: 5.866666666666666
Avg Loss: 0.01789333705630601
Avg hit ratio: 0.8775266022487
Avg ndcg: 0.9015664760475555
Avg compression ratio: 0.9912072234500507
Avg train time: 5.913229012489319
Std train time: 1.9490235669100517
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 41, 9, 23, 30, 10, 10, 9, 6, 10, 10, 47, 47, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8911, 'compress@10': 0.9951, 'time@10': 6.5574}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8911, 'compress@10': 0.9951, 'time@10': 6.5574}:   3%|▎         | 1/30 [00:03<01:36,  3.33s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9161, 'compress@10': 0.9932, 'time@10': 5.5936}:   3%|▎         | 1/30 [00:07<01:36,  3.33s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9161, 'compress@10': 0.9932, 'time@10': 5.5936}:   7%|▋         | 2/30 [00:07<01:55,  4.12s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8964, 'compress@10': 0.9913, 'time@10': 4.7875}:   7%|▋         | 2/30 [00:09<01:55,  4.12s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8964, 'compress@10': 0.9913, 'time@10': 4.7875}:  10%|█         | 3/30 [00:09<01:20,  2.98s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.905, 'compress@10': 0.9879, 'time@10': 4.6289}:  10%|█         | 3/30 [00:13<01:20,  2.98s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.905, 'compress@10': 0.9879, 'time@10': 4.6289}:  13%|█▎        | 4/30 [00:13<01:29,  3.46s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0244, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8882, 'compress@10': 0.9884, 'time@10': 5.3382}:  13%|█▎        | 4/30 [00:17<01:29,  3.46s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0244, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8882, 'compress@10': 0.9884, 'time@10': 5.3382}:  17%|█▋        | 5/30 [00:17<01:32,  3.70s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0233, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8978, 'compress@10': 0.9899, 'time@10': 5.6695}:  17%|█▋        | 5/30 [00:25<01:32,  3.70s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0233, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8978, 'compress@10': 0.9899, 'time@10': 5.6695}:  20%|██        | 6/30 [00:25<01:58,  4.95s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9004, 'compress@10': 0.9902, 'time@10': 6.0}:  20%|██        | 6/30 [00:29<01:58,  4.95s/it]   {'epoch': 37, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9004, 'compress@10': 0.9902, 'time@10': 6.0}:  23%|██▎       | 7/30 [00:29<01:46,  4.65s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0236, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9081, 'compress@10': 0.9908, 'time@10': 5.9511}:  23%|██▎       | 7/30 [00:34<01:46,  4.65s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0236, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9081, 'compress@10': 0.9908, 'time@10': 5.9511}:  27%|██▋       | 8/30 [00:34<01:49,  4.97s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9143, 'compress@10': 0.9894, 'time@10': 6.1673}:  27%|██▋       | 8/30 [00:38<01:49,  4.97s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9143, 'compress@10': 0.9894, 'time@10': 6.1673}:  30%|███       | 9/30 [00:38<01:37,  4.66s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0227, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9196, 'compress@10': 0.9888, 'time@10': 6.2663}:  30%|███       | 9/30 [00:46<01:37,  4.66s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0227, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9196, 'compress@10': 0.9888, 'time@10': 6.2663}:  33%|███▎      | 10/30 [00:46<01:48,  5.44s/it]{'epoch': 37, 'num_users': 6.6364, 'loss': 0.0232, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9193, 'compress@10': 0.9893, 'time@10': 6.3548}:  33%|███▎      | 10/30 [00:49<01:48,  5.44s/it]{'epoch': 37, 'num_users': 6.6364, 'loss': 0.0232, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9193, 'compress@10': 0.9893, 'time@10': 6.3548}:  37%|███▋      | 11/30 [00:49<01:33,  4.90s/it]{'epoch': 37, 'num_users': 6.4167, 'loss': 0.0213, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9191, 'compress@10': 0.9893, 'time@10': 6.0999}:  37%|███▋      | 11/30 [00:53<01:33,  4.90s/it]{'epoch': 37, 'num_users': 6.4167, 'loss': 0.0213, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9191, 'compress@10': 0.9893, 'time@10': 6.0999}:  40%|████      | 12/30 [00:53<01:19,  4.43s/it]{'epoch': 37, 'num_users': 6.6154, 'loss': 0.0216, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9184, 'compress@10': 0.9896, 'time@10': 6.1143}:  40%|████      | 12/30 [00:56<01:19,  4.43s/it]{'epoch': 37, 'num_users': 6.6154, 'loss': 0.0216, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9184, 'compress@10': 0.9896, 'time@10': 6.1143}:  43%|████▎     | 13/30 [00:56<01:08,  4.05s/it]{'epoch': 37, 'num_users': 6.3571, 'loss': 0.0201, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9123, 'compress@10': 0.9893, 'time@10': 5.9177}:  43%|████▎     | 13/30 [00:59<01:08,  4.05s/it] {'epoch': 37, 'num_users': 6.3571, 'loss': 0.0201, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9123, 'compress@10': 0.9893, 'time@10': 5.9177}:  47%|████▋     | 14/30 [00:59<01:01,  3.85s/it]{'epoch': 37, 'num_users': 6.2667, 'loss': 0.0207, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9122, 'compress@10': 0.9897, 'time@10': 6.1138}:  47%|████▋     | 14/30 [01:04<01:01,  3.85s/it]{'epoch': 37, 'num_users': 6.2667, 'loss': 0.0207, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9122, 'compress@10': 0.9897, 'time@10': 6.1138}:  50%|█████     | 15/30 [01:04<01:00,  4.04s/it]{'epoch': 37, 'num_users': 6.0625, 'loss': 0.0196, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9125, 'compress@10': 0.9897, 'time@10': 5.9427}:  50%|█████     | 15/30 [01:07<01:00,  4.04s/it]{'epoch': 37, 'num_users': 6.0625, 'loss': 0.0196, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9125, 'compress@10': 0.9897, 'time@10': 5.9427}:  53%|█████▎    | 16/30 [01:07<00:53,  3.85s/it]{'epoch': 37, 'num_users': 5.8235, 'loss': 0.0185, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9042, 'compress@10': 0.9902, 'time@10': 5.7948}:  53%|█████▎    | 16/30 [01:09<00:53,  3.85s/it]{'epoch': 37, 'num_users': 5.8235, 'loss': 0.0185, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9042, 'compress@10': 0.9902, 'time@10': 5.7948}:  57%|█████▋    | 17/30 [01:09<00:41,  3.22s/it]{'epoch': 37, 'num_users': 6.0556, 'loss': 0.019, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9043, 'compress@10': 0.9894, 'time@10': 5.7067}:  57%|█████▋    | 17/30 [01:13<00:41,  3.22s/it] {'epoch': 37, 'num_users': 6.0556, 'loss': 0.019, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9043, 'compress@10': 0.9894, 'time@10': 5.7067}:  60%|██████    | 18/30 [01:13<00:42,  3.53s/it]{'epoch': 37, 'num_users': 6.0, 'loss': 0.0185, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9053, 'compress@10': 0.9895, 'time@10': 5.6152}:  60%|██████    | 18/30 [01:15<00:42,  3.53s/it]   {'epoch': 37, 'num_users': 6.0, 'loss': 0.0185, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9053, 'compress@10': 0.9895, 'time@10': 5.6152}:  63%|██████▎   | 19/30 [01:15<00:33,  3.08s/it]{'epoch': 37, 'num_users': 6.15, 'loss': 0.0187, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9076, 'compress@10': 0.9897, 'time@10': 5.7347}:  63%|██████▎   | 19/30 [01:23<00:33,  3.08s/it]{'epoch': 37, 'num_users': 6.15, 'loss': 0.0187, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9076, 'compress@10': 0.9897, 'time@10': 5.7347}:  67%|██████▋   | 20/30 [01:23<00:45,  4.57s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0197, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9052, 'compress@10': 0.9901, 'time@10': 5.8515}:  67%|██████▋   | 20/30 [01:27<00:45,  4.57s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0197, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9052, 'compress@10': 0.9901, 'time@10': 5.8515}:  70%|███████   | 21/30 [01:27<00:39,  4.44s/it]{'epoch': 37, 'num_users': 6.1818, 'loss': 0.0204, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.905, 'compress@10': 0.9902, 'time@10': 5.7522}:  70%|███████   | 21/30 [01:31<00:39,  4.44s/it]{'epoch': 37, 'num_users': 6.1818, 'loss': 0.0204, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.905, 'compress@10': 0.9902, 'time@10': 5.7522}:  73%|███████▎  | 22/30 [01:31<00:33,  4.22s/it]{'epoch': 37, 'num_users': 6.1304, 'loss': 0.02, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9065, 'compress@10': 0.9906, 'time@10': 5.7797}:  73%|███████▎  | 22/30 [01:34<00:33,  4.22s/it] {'epoch': 37, 'num_users': 6.1304, 'loss': 0.02, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9065, 'compress@10': 0.9906, 'time@10': 5.7797}:  77%|███████▋  | 23/30 [01:34<00:27,  3.93s/it]{'epoch': 37, 'num_users': 5.9583, 'loss': 0.0192, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.9021, 'compress@10': 0.9908, 'time@10': 5.676}:  77%|███████▋  | 23/30 [01:38<00:27,  3.93s/it]{'epoch': 37, 'num_users': 5.9583, 'loss': 0.0192, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.9021, 'compress@10': 0.9908, 'time@10': 5.676}:  80%|████████  | 24/30 [01:38<00:22,  3.75s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0184, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8927, 'compress@10': 0.991, 'time@10': 5.5724}:  80%|████████  | 24/30 [01:39<00:22,  3.75s/it]    {'epoch': 37, 'num_users': 5.8, 'loss': 0.0184, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8927, 'compress@10': 0.991, 'time@10': 5.5724}:  83%|████████▎ | 25/30 [01:39<00:15,  3.10s/it]{'epoch': 37, 'num_users': 5.8077, 'loss': 0.0183, 'hit_ratio@10': 0.864, 'ndcg@10': 0.895, 'compress@10': 0.991, 'time@10': 5.6658}:  83%|████████▎ | 25/30 [01:47<00:15,  3.10s/it]{'epoch': 37, 'num_users': 5.8077, 'loss': 0.0183, 'hit_ratio@10': 0.864, 'ndcg@10': 0.895, 'compress@10': 0.991, 'time@10': 5.6658}:  87%|████████▋ | 26/30 [01:47<00:18,  4.58s/it]{'epoch': 37, 'num_users': 5.8889, 'loss': 0.0181, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8967, 'compress@10': 0.9912, 'time@10': 5.7222}:  87%|████████▋ | 26/30 [01:51<00:18,  4.58s/it]{'epoch': 37, 'num_users': 5.8889, 'loss': 0.0181, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8967, 'compress@10': 0.9912, 'time@10': 5.7222}:  90%|█████████ | 27/30 [01:51<00:12,  4.30s/it]{'epoch': 37, 'num_users': 6.0, 'loss': 0.018, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8994, 'compress@10': 0.9914, 'time@10': 5.8146}:  90%|█████████ | 27/30 [01:59<00:12,  4.30s/it]     {'epoch': 37, 'num_users': 6.0, 'loss': 0.018, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8994, 'compress@10': 0.9914, 'time@10': 5.8146}:  93%|█████████▎| 28/30 [01:59<00:11,  5.51s/it]{'epoch': 37, 'num_users': 5.8621, 'loss': 0.0178, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9011, 'compress@10': 0.9912, 'time@10': 5.8518}:  93%|█████████▎| 28/30 [02:03<00:11,  5.51s/it]{'epoch': 37, 'num_users': 5.8621, 'loss': 0.0178, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9011, 'compress@10': 0.9912, 'time@10': 5.8518}:  97%|█████████▋| 29/30 [02:03<00:04,  4.91s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0179, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9023, 'compress@10': 0.9915, 'time@10': 5.855}:  97%|█████████▋| 29/30 [02:09<00:04,  4.91s/it] {'epoch': 37, 'num_users': 5.8667, 'loss': 0.0179, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9023, 'compress@10': 0.9915, 'time@10': 5.855}: 100%|██████████| 30/30 [02:09<00:00,  5.23s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0179, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9023, 'compress@10': 0.9915, 'time@10': 5.855}: 100%|██████████| 30/30 [02:09<00:00,  4.31s/it]
Epoch: 37
Avg # of users: 5.866666666666666
Avg Loss: 0.017900230372918307
Avg hit ratio: 0.8744920550965057
Avg ndcg: 0.9023012991420066
Avg compression ratio: 0.9914607638045745
Avg train time: 5.854985133806864
Std train time: 1.9591098604431485
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 41, 9, 23, 30, 10, 10, 9, 6, 10, 10, 47, 48, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.898, 'compress@10': 0.9943, 'time@10': 5.9658}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.898, 'compress@10': 0.9943, 'time@10': 5.9658}:   3%|▎         | 1/30 [00:03<01:27,  3.02s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0237, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9037, 'compress@10': 0.9932, 'time@10': 5.4645}:   3%|▎         | 1/30 [00:08<01:27,  3.02s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0237, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9037, 'compress@10': 0.9932, 'time@10': 5.4645}:   7%|▋         | 2/30 [00:08<01:57,  4.19s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8882, 'compress@10': 0.9905, 'time@10': 4.8909}:   7%|▋         | 2/30 [00:09<01:57,  4.19s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8882, 'compress@10': 0.9905, 'time@10': 4.8909}:  10%|█         | 3/30 [00:09<01:25,  3.15s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8784, 'compress@10': 0.9878, 'time@10': 4.8767}:  10%|█         | 3/30 [00:14<01:25,  3.15s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8784, 'compress@10': 0.9878, 'time@10': 4.8767}:  13%|█▎        | 4/30 [00:14<01:39,  3.83s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.87, 'compress@10': 0.9883, 'time@10': 5.5338}:  13%|█▎        | 4/30 [00:18<01:39,  3.83s/it]  {'epoch': 38, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.87, 'compress@10': 0.9883, 'time@10': 5.5338}:  17%|█▋        | 5/30 [00:18<01:38,  3.94s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0252, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.8834, 'compress@10': 0.9897, 'time@10': 5.8871}:  17%|█▋        | 5/30 [00:26<01:38,  3.94s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0252, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.8834, 'compress@10': 0.9897, 'time@10': 5.8871}:  20%|██        | 6/30 [00:26<02:05,  5.22s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0245, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.8872, 'compress@10': 0.9901, 'time@10': 6.1829}:  20%|██        | 6/30 [00:30<02:05,  5.22s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0245, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.8872, 'compress@10': 0.9901, 'time@10': 6.1829}:  23%|██▎       | 7/30 [00:30<01:50,  4.82s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0244, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.8967, 'compress@10': 0.9907, 'time@10': 6.1056}:  23%|██▎       | 7/30 [00:36<01:50,  4.82s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0244, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.8967, 'compress@10': 0.9907, 'time@10': 6.1056}:  27%|██▋       | 8/30 [00:36<01:51,  5.07s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0244, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9041, 'compress@10': 0.9893, 'time@10': 6.2582}:  27%|██▋       | 8/30 [00:40<01:51,  5.07s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0244, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9041, 'compress@10': 0.9893, 'time@10': 6.2582}:  30%|███       | 9/30 [00:40<01:38,  4.67s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9093, 'compress@10': 0.989, 'time@10': 6.3061}:  30%|███       | 9/30 [00:46<01:38,  4.67s/it]    {'epoch': 38, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9093, 'compress@10': 0.989, 'time@10': 6.3061}:  33%|███▎      | 10/30 [00:46<01:46,  5.32s/it]{'epoch': 38, 'num_users': 6.6364, 'loss': 0.0249, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9086, 'compress@10': 0.9893, 'time@10': 6.518}:  33%|███▎      | 10/30 [00:51<01:46,  5.32s/it]{'epoch': 38, 'num_users': 6.6364, 'loss': 0.0249, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9086, 'compress@10': 0.9893, 'time@10': 6.518}:  37%|███▋      | 11/30 [00:51<01:35,  5.03s/it]{'epoch': 38, 'num_users': 6.4167, 'loss': 0.0229, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9093, 'compress@10': 0.9893, 'time@10': 6.2743}:  37%|███▋      | 11/30 [00:54<01:35,  5.03s/it]{'epoch': 38, 'num_users': 6.4167, 'loss': 0.0229, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9093, 'compress@10': 0.9893, 'time@10': 6.2743}:  40%|████      | 12/30 [00:54<01:22,  4.60s/it]{'epoch': 38, 'num_users': 6.6154, 'loss': 0.023, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9096, 'compress@10': 0.9897, 'time@10': 6.2603}:  40%|████      | 12/30 [00:57<01:22,  4.60s/it]{'epoch': 38, 'num_users': 6.6154, 'loss': 0.023, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9096, 'compress@10': 0.9897, 'time@10': 6.2603}:  43%|████▎     | 13/30 [00:57<01:10,  4.14s/it]{'epoch': 38, 'num_users': 6.3571, 'loss': 0.0214, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9042, 'compress@10': 0.9894, 'time@10': 6.0546}:  43%|████▎     | 13/30 [01:01<01:10,  4.14s/it]{'epoch': 38, 'num_users': 6.3571, 'loss': 0.0214, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9042, 'compress@10': 0.9894, 'time@10': 6.0546}:  47%|████▋     | 14/30 [01:01<01:02,  3.92s/it]{'epoch': 38, 'num_users': 6.2667, 'loss': 0.022, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9047, 'compress@10': 0.9898, 'time@10': 6.2293}:  47%|████▋     | 14/30 [01:05<01:02,  3.92s/it] {'epoch': 38, 'num_users': 6.2667, 'loss': 0.022, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9047, 'compress@10': 0.9898, 'time@10': 6.2293}:  50%|█████     | 15/30 [01:05<01:00,  4.06s/it]{'epoch': 38, 'num_users': 6.0625, 'loss': 0.0209, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.9055, 'compress@10': 0.9898, 'time@10': 6.0328}:  50%|█████     | 15/30 [01:08<01:00,  4.06s/it]{'epoch': 38, 'num_users': 6.0625, 'loss': 0.0209, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.9055, 'compress@10': 0.9898, 'time@10': 6.0328}:  53%|█████▎    | 16/30 [01:08<00:52,  3.78s/it]{'epoch': 38, 'num_users': 5.8235, 'loss': 0.0197, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8975, 'compress@10': 0.9903, 'time@10': 5.8553}:  53%|█████▎    | 16/30 [01:10<00:52,  3.78s/it]{'epoch': 38, 'num_users': 5.8235, 'loss': 0.0197, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8975, 'compress@10': 0.9903, 'time@10': 5.8553}:  57%|█████▋    | 17/30 [01:10<00:40,  3.11s/it]{'epoch': 38, 'num_users': 6.0556, 'loss': 0.0201, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8973, 'compress@10': 0.9898, 'time@10': 5.7738}:  57%|█████▋    | 17/30 [01:14<00:40,  3.11s/it]{'epoch': 38, 'num_users': 6.0556, 'loss': 0.0201, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8973, 'compress@10': 0.9898, 'time@10': 5.7738}:  60%|██████    | 18/30 [01:14<00:42,  3.50s/it]{'epoch': 38, 'num_users': 6.0, 'loss': 0.0198, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8985, 'compress@10': 0.9899, 'time@10': 5.6651}:  60%|██████    | 18/30 [01:16<00:42,  3.50s/it]   {'epoch': 38, 'num_users': 6.0, 'loss': 0.0198, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8985, 'compress@10': 0.9899, 'time@10': 5.6651}:  63%|██████▎   | 19/30 [01:16<00:33,  3.02s/it]{'epoch': 38, 'num_users': 6.15, 'loss': 0.0198, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9013, 'compress@10': 0.9902, 'time@10': 5.7832}:  63%|██████▎   | 19/30 [01:24<00:33,  3.02s/it]{'epoch': 38, 'num_users': 6.15, 'loss': 0.0198, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9013, 'compress@10': 0.9902, 'time@10': 5.7832}:  67%|██████▋   | 20/30 [01:24<00:45,  4.54s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0204, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8999, 'compress@10': 0.9905, 'time@10': 5.8604}:  67%|██████▋   | 20/30 [01:28<00:45,  4.54s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0204, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8999, 'compress@10': 0.9905, 'time@10': 5.8604}:  70%|███████   | 21/30 [01:28<00:38,  4.30s/it]{'epoch': 38, 'num_users': 6.1818, 'loss': 0.0209, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9001, 'compress@10': 0.9906, 'time@10': 5.7515}:  70%|███████   | 21/30 [01:32<00:38,  4.30s/it]{'epoch': 38, 'num_users': 6.1818, 'loss': 0.0209, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9001, 'compress@10': 0.9906, 'time@10': 5.7515}:  73%|███████▎  | 22/30 [01:32<00:32,  4.06s/it]{'epoch': 38, 'num_users': 6.1304, 'loss': 0.0204, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9019, 'compress@10': 0.991, 'time@10': 5.773}:  73%|███████▎  | 22/30 [01:35<00:32,  4.06s/it]  {'epoch': 38, 'num_users': 6.1304, 'loss': 0.0204, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9019, 'compress@10': 0.991, 'time@10': 5.773}:  77%|███████▋  | 23/30 [01:35<00:26,  3.79s/it]{'epoch': 38, 'num_users': 5.9583, 'loss': 0.0196, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8977, 'compress@10': 0.9912, 'time@10': 5.6611}:  77%|███████▋  | 23/30 [01:38<00:26,  3.79s/it]{'epoch': 38, 'num_users': 5.9583, 'loss': 0.0196, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8977, 'compress@10': 0.9912, 'time@10': 5.6611}:  80%|████████  | 24/30 [01:38<00:21,  3.59s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0188, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8884, 'compress@10': 0.9914, 'time@10': 5.5602}:  80%|████████  | 24/30 [01:39<00:21,  3.59s/it]   {'epoch': 38, 'num_users': 5.8, 'loss': 0.0188, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8884, 'compress@10': 0.9914, 'time@10': 5.5602}:  83%|████████▎ | 25/30 [01:39<00:14,  3.00s/it]{'epoch': 38, 'num_users': 5.8077, 'loss': 0.0187, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8909, 'compress@10': 0.9914, 'time@10': 5.6525}:  83%|████████▎ | 25/30 [01:47<00:14,  3.00s/it]{'epoch': 38, 'num_users': 5.8077, 'loss': 0.0187, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8909, 'compress@10': 0.9914, 'time@10': 5.6525}:  87%|████████▋ | 26/30 [01:47<00:17,  4.50s/it]{'epoch': 38, 'num_users': 5.8889, 'loss': 0.0185, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8925, 'compress@10': 0.9916, 'time@10': 5.7068}:  87%|████████▋ | 26/30 [01:51<00:17,  4.50s/it]{'epoch': 38, 'num_users': 5.8889, 'loss': 0.0185, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8925, 'compress@10': 0.9916, 'time@10': 5.7068}:  90%|█████████ | 27/30 [01:51<00:12,  4.23s/it]{'epoch': 38, 'num_users': 6.0, 'loss': 0.0184, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8953, 'compress@10': 0.9917, 'time@10': 5.7973}:  90%|█████████ | 27/30 [01:59<00:12,  4.23s/it]   {'epoch': 38, 'num_users': 6.0, 'loss': 0.0184, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8953, 'compress@10': 0.9917, 'time@10': 5.7973}:  93%|█████████▎| 28/30 [01:59<00:10,  5.45s/it]{'epoch': 38, 'num_users': 5.8621, 'loss': 0.0181, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8972, 'compress@10': 0.9916, 'time@10': 5.8146}:  93%|█████████▎| 28/30 [02:02<00:10,  5.45s/it]{'epoch': 38, 'num_users': 5.8621, 'loss': 0.0181, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8972, 'compress@10': 0.9916, 'time@10': 5.8146}:  97%|█████████▋| 29/30 [02:02<00:04,  4.77s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0183, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8989, 'compress@10': 0.9918, 'time@10': 5.8183}:  97%|█████████▋| 29/30 [02:08<00:04,  4.77s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0183, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8989, 'compress@10': 0.9918, 'time@10': 5.8183}: 100%|██████████| 30/30 [02:08<00:00,  5.13s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0183, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8989, 'compress@10': 0.9918, 'time@10': 5.8183}: 100%|██████████| 30/30 [02:08<00:00,  4.30s/it]
Epoch: 38
Avg # of users: 5.866666666666666
Avg Loss: 0.01828842435017103
Avg hit ratio: 0.8705324375125998
Avg ndcg: 0.8988555507556651
Avg compression ratio: 0.9918031130559763
Avg train time: 5.818347001075745
Std train time: 1.9338351061067556
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 41, 9, 24, 31, 10, 10, 9, 6, 10, 10, 48, 49, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9082, 'compress@10': 0.9938, 'time@10': 5.8609}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9082, 'compress@10': 0.9938, 'time@10': 5.8609}:   3%|▎         | 1/30 [00:02<01:26,  2.97s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9258, 'compress@10': 0.9928, 'time@10': 5.4062}:   3%|▎         | 1/30 [00:07<01:26,  2.97s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9258, 'compress@10': 0.9928, 'time@10': 5.4062}:   7%|▋         | 2/30 [00:07<01:56,  4.16s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9029, 'compress@10': 0.9908, 'time@10': 4.857}:   7%|▋         | 2/30 [00:09<01:56,  4.16s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9029, 'compress@10': 0.9908, 'time@10': 4.857}:  10%|█         | 3/30 [00:09<01:24,  3.14s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.9076, 'compress@10': 0.9874, 'time@10': 4.7817}:  10%|█         | 3/30 [00:14<01:24,  3.14s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.9076, 'compress@10': 0.9874, 'time@10': 4.7817}:  13%|█▎        | 4/30 [00:14<01:36,  3.71s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0226, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8931, 'compress@10': 0.9877, 'time@10': 5.4553}:  13%|█▎        | 4/30 [00:18<01:36,  3.71s/it] {'epoch': 39, 'num_users': 5.8, 'loss': 0.0226, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8931, 'compress@10': 0.9877, 'time@10': 5.4553}:  17%|█▋        | 5/30 [00:18<01:36,  3.86s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9035, 'compress@10': 0.9892, 'time@10': 5.7483}:  17%|█▋        | 5/30 [00:25<01:36,  3.86s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9035, 'compress@10': 0.9892, 'time@10': 5.7483}:  20%|██        | 6/30 [00:25<02:00,  5.01s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0213, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9063, 'compress@10': 0.9896, 'time@10': 6.2398}:  20%|██        | 6/30 [00:30<02:00,  5.01s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0213, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9063, 'compress@10': 0.9896, 'time@10': 6.2398}:  23%|██▎       | 7/30 [00:30<01:52,  4.89s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0216, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9136, 'compress@10': 0.9902, 'time@10': 6.1577}:  23%|██▎       | 7/30 [00:36<01:52,  4.89s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0216, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9136, 'compress@10': 0.9902, 'time@10': 6.1577}:  27%|██▋       | 8/30 [00:36<01:52,  5.12s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9189, 'compress@10': 0.989, 'time@10': 6.3447}:  27%|██▋       | 8/30 [00:40<01:52,  5.12s/it] {'epoch': 39, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9189, 'compress@10': 0.989, 'time@10': 6.3447}:  30%|███       | 9/30 [00:40<01:39,  4.76s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9227, 'compress@10': 0.9883, 'time@10': 6.3585}:  30%|███       | 9/30 [00:46<01:39,  4.76s/it] {'epoch': 39, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9227, 'compress@10': 0.9883, 'time@10': 6.3585}:  33%|███▎      | 10/30 [00:46<01:46,  5.30s/it]{'epoch': 39, 'num_users': 6.6364, 'loss': 0.0239, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9227, 'compress@10': 0.9887, 'time@10': 6.4927}:  33%|███▎      | 10/30 [00:50<01:46,  5.30s/it]{'epoch': 39, 'num_users': 6.6364, 'loss': 0.0239, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9227, 'compress@10': 0.9887, 'time@10': 6.4927}:  37%|███▋      | 11/30 [00:50<01:32,  4.89s/it]{'epoch': 39, 'num_users': 6.4167, 'loss': 0.022, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9222, 'compress@10': 0.9889, 'time@10': 6.2817}:  37%|███▋      | 11/30 [00:54<01:32,  4.89s/it] {'epoch': 39, 'num_users': 6.4167, 'loss': 0.022, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9222, 'compress@10': 0.9889, 'time@10': 6.2817}:  40%|████      | 12/30 [00:54<01:23,  4.63s/it]{'epoch': 39, 'num_users': 6.6154, 'loss': 0.0222, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9216, 'compress@10': 0.9894, 'time@10': 6.2799}:  40%|████      | 12/30 [00:57<01:23,  4.63s/it]{'epoch': 39, 'num_users': 6.6154, 'loss': 0.0222, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9216, 'compress@10': 0.9894, 'time@10': 6.2799}:  43%|████▎     | 13/30 [00:57<01:11,  4.19s/it]{'epoch': 39, 'num_users': 6.3571, 'loss': 0.0206, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.9153, 'compress@10': 0.9891, 'time@10': 6.061}:  43%|████▎     | 13/30 [01:00<01:11,  4.19s/it] {'epoch': 39, 'num_users': 6.3571, 'loss': 0.0206, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.9153, 'compress@10': 0.9891, 'time@10': 6.061}:  47%|████▋     | 14/30 [01:00<01:02,  3.91s/it]{'epoch': 39, 'num_users': 6.2667, 'loss': 0.0213, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9163, 'compress@10': 0.9895, 'time@10': 6.2505}:  47%|████▋     | 14/30 [01:05<01:02,  3.91s/it]{'epoch': 39, 'num_users': 6.2667, 'loss': 0.0213, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9163, 'compress@10': 0.9895, 'time@10': 6.2505}:  50%|█████     | 15/30 [01:05<01:01,  4.08s/it]{'epoch': 39, 'num_users': 6.0625, 'loss': 0.0203, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.9164, 'compress@10': 0.9896, 'time@10': 6.0927}:  50%|█████     | 15/30 [01:09<01:01,  4.08s/it]{'epoch': 39, 'num_users': 6.0625, 'loss': 0.0203, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.9164, 'compress@10': 0.9896, 'time@10': 6.0927}:  53%|█████▎    | 16/30 [01:09<00:55,  3.99s/it]{'epoch': 39, 'num_users': 5.8235, 'loss': 0.0191, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.9095, 'compress@10': 0.9902, 'time@10': 5.9125}:  53%|█████▎    | 16/30 [01:10<00:55,  3.99s/it]{'epoch': 39, 'num_users': 5.8235, 'loss': 0.0191, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.9095, 'compress@10': 0.9902, 'time@10': 5.9125}:  57%|█████▋    | 17/30 [01:10<00:42,  3.25s/it]{'epoch': 39, 'num_users': 6.0556, 'loss': 0.0197, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.911, 'compress@10': 0.9896, 'time@10': 5.8125}:  57%|█████▋    | 17/30 [01:14<00:42,  3.25s/it] {'epoch': 39, 'num_users': 6.0556, 'loss': 0.0197, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.911, 'compress@10': 0.9896, 'time@10': 5.8125}:  60%|██████    | 18/30 [01:14<00:42,  3.52s/it]{'epoch': 39, 'num_users': 6.0, 'loss': 0.0191, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9117, 'compress@10': 0.9897, 'time@10': 5.7207}:  60%|██████    | 18/30 [01:17<00:42,  3.52s/it]  {'epoch': 39, 'num_users': 6.0, 'loss': 0.0191, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9117, 'compress@10': 0.9897, 'time@10': 5.7207}:  63%|██████▎   | 19/30 [01:17<00:33,  3.09s/it]{'epoch': 39, 'num_users': 6.15, 'loss': 0.0192, 'hit_ratio@10': 0.867, 'ndcg@10': 0.9139, 'compress@10': 0.99, 'time@10': 5.8247}:  63%|██████▎   | 19/30 [01:24<00:33,  3.09s/it]  {'epoch': 39, 'num_users': 6.15, 'loss': 0.0192, 'hit_ratio@10': 0.867, 'ndcg@10': 0.9139, 'compress@10': 0.99, 'time@10': 5.8247}:  67%|██████▋   | 20/30 [01:24<00:45,  4.52s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9121, 'compress@10': 0.9903, 'time@10': 5.9199}:  67%|██████▋   | 20/30 [01:28<00:45,  4.52s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9121, 'compress@10': 0.9903, 'time@10': 5.9199}:  70%|███████   | 21/30 [01:28<00:39,  4.35s/it]{'epoch': 39, 'num_users': 6.1818, 'loss': 0.0205, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9117, 'compress@10': 0.9904, 'time@10': 5.8156}:  70%|███████   | 21/30 [01:32<00:39,  4.35s/it]{'epoch': 39, 'num_users': 6.1818, 'loss': 0.0205, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9117, 'compress@10': 0.9904, 'time@10': 5.8156}:  73%|███████▎  | 22/30 [01:32<00:33,  4.15s/it]{'epoch': 39, 'num_users': 6.1304, 'loss': 0.02, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.913, 'compress@10': 0.9907, 'time@10': 5.8383}:  73%|███████▎  | 22/30 [01:35<00:33,  4.15s/it]   {'epoch': 39, 'num_users': 6.1304, 'loss': 0.02, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.913, 'compress@10': 0.9907, 'time@10': 5.8383}:  77%|███████▋  | 23/30 [01:35<00:27,  3.87s/it]{'epoch': 39, 'num_users': 5.9583, 'loss': 0.0192, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9083, 'compress@10': 0.991, 'time@10': 5.7267}:  77%|███████▋  | 23/30 [01:38<00:27,  3.87s/it]{'epoch': 39, 'num_users': 5.9583, 'loss': 0.0192, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9083, 'compress@10': 0.991, 'time@10': 5.7267}:  80%|████████  | 24/30 [01:38<00:22,  3.67s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0185, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8986, 'compress@10': 0.9912, 'time@10': 5.6256}:  80%|████████  | 24/30 [01:40<00:22,  3.67s/it]  {'epoch': 39, 'num_users': 5.8, 'loss': 0.0185, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8986, 'compress@10': 0.9912, 'time@10': 5.6256}:  83%|████████▎ | 25/30 [01:40<00:15,  3.06s/it]{'epoch': 39, 'num_users': 5.8077, 'loss': 0.0183, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.9008, 'compress@10': 0.9912, 'time@10': 5.7158}:  83%|████████▎ | 25/30 [01:48<00:15,  3.06s/it]{'epoch': 39, 'num_users': 5.8077, 'loss': 0.0183, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.9008, 'compress@10': 0.9912, 'time@10': 5.7158}:  87%|████████▋ | 26/30 [01:48<00:18,  4.55s/it]{'epoch': 39, 'num_users': 5.8889, 'loss': 0.0181, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.9023, 'compress@10': 0.9913, 'time@10': 5.7516}:  87%|████████▋ | 26/30 [01:51<00:18,  4.55s/it]{'epoch': 39, 'num_users': 5.8889, 'loss': 0.0181, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.9023, 'compress@10': 0.9913, 'time@10': 5.7516}:  90%|█████████ | 27/30 [01:51<00:12,  4.20s/it]{'epoch': 39, 'num_users': 6.0, 'loss': 0.018, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9048, 'compress@10': 0.9916, 'time@10': 5.8415}:  90%|█████████ | 27/30 [02:00<00:12,  4.20s/it]    {'epoch': 39, 'num_users': 6.0, 'loss': 0.018, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9048, 'compress@10': 0.9916, 'time@10': 5.8415}:  93%|█████████▎| 28/30 [02:00<00:10,  5.43s/it]{'epoch': 39, 'num_users': 5.8621, 'loss': 0.0177, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9064, 'compress@10': 0.9914, 'time@10': 5.8795}:  93%|█████████▎| 28/30 [02:03<00:10,  5.43s/it]{'epoch': 39, 'num_users': 5.8621, 'loss': 0.0177, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9064, 'compress@10': 0.9914, 'time@10': 5.8795}:  97%|█████████▋| 29/30 [02:03<00:04,  4.86s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0178, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9074, 'compress@10': 0.9916, 'time@10': 5.8809}:  97%|█████████▋| 29/30 [02:09<00:04,  4.86s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0178, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9074, 'compress@10': 0.9916, 'time@10': 5.8809}: 100%|██████████| 30/30 [02:09<00:00,  5.19s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0178, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9074, 'compress@10': 0.9916, 'time@10': 5.8809}: 100%|██████████| 30/30 [02:09<00:00,  4.33s/it]
Epoch: 39
Avg # of users: 5.866666666666666
Avg Loss: 0.017809852082020985
Avg hit ratio: 0.8713833533635158
Avg ndcg: 0.9073775466888916
Avg compression ratio: 0.9916203116206675
Avg train time: 5.880878845850627
Std train time: 1.9284148308590188
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 41, 9, 24, 32, 10, 10, 9, 6, 10, 10, 48, 49, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9082, 'compress@10': 0.9935, 'time@10': 5.9454}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9082, 'compress@10': 0.9935, 'time@10': 5.9454}:   3%|▎         | 1/30 [00:03<01:27,  3.01s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9302, 'compress@10': 0.9925, 'time@10': 5.4062}:   3%|▎         | 1/30 [00:07<01:27,  3.01s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9302, 'compress@10': 0.9925, 'time@10': 5.4062}:   7%|▋         | 2/30 [00:07<01:55,  4.13s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9058, 'compress@10': 0.9915, 'time@10': 4.7761}:   7%|▋         | 2/30 [00:09<01:55,  4.13s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9058, 'compress@10': 0.9915, 'time@10': 4.7761}:  10%|█         | 3/30 [00:09<01:22,  3.06s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9097, 'compress@10': 0.9887, 'time@10': 4.6222}:  10%|█         | 3/30 [00:13<01:22,  3.06s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9097, 'compress@10': 0.9887, 'time@10': 4.6222}:  13%|█▎        | 4/30 [00:13<01:31,  3.51s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0209, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.8952, 'compress@10': 0.9887, 'time@10': 5.2621}:  13%|█▎        | 4/30 [00:17<01:31,  3.51s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0209, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.8952, 'compress@10': 0.9887, 'time@10': 5.2621}:  17%|█▋        | 5/30 [00:17<01:31,  3.67s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9041, 'compress@10': 0.9899, 'time@10': 5.5447}:  17%|█▋        | 5/30 [00:24<01:31,  3.67s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9041, 'compress@10': 0.9899, 'time@10': 5.5447}:  20%|██        | 6/30 [00:24<01:55,  4.80s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0199, 'hit_ratio@10': 0.9156, 'ndcg@10': 0.9058, 'compress@10': 0.9902, 'time@10': 5.9661}:  20%|██        | 6/30 [00:29<01:55,  4.80s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0199, 'hit_ratio@10': 0.9156, 'ndcg@10': 0.9058, 'compress@10': 0.9902, 'time@10': 5.9661}:  23%|██▎       | 7/30 [00:29<01:46,  4.63s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0204, 'hit_ratio@10': 0.919, 'ndcg@10': 0.9123, 'compress@10': 0.9908, 'time@10': 5.9153}:  23%|██▎       | 7/30 [00:34<01:46,  4.63s/it]  {'epoch': 40, 'num_users': 6.125, 'loss': 0.0204, 'hit_ratio@10': 0.919, 'ndcg@10': 0.9123, 'compress@10': 0.9908, 'time@10': 5.9153}:  27%|██▋       | 8/30 [00:34<01:48,  4.94s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.909, 'ndcg@10': 0.918, 'compress@10': 0.9893, 'time@10': 6.1305}:  27%|██▋       | 8/30 [00:38<01:48,  4.94s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.909, 'ndcg@10': 0.918, 'compress@10': 0.9893, 'time@10': 6.1305}:  30%|███       | 9/30 [00:38<01:37,  4.64s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.9158, 'ndcg@10': 0.9236, 'compress@10': 0.989, 'time@10': 6.193}:  30%|███       | 9/30 [00:45<01:37,  4.64s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.9158, 'ndcg@10': 0.9236, 'compress@10': 0.989, 'time@10': 6.193}:  33%|███▎      | 10/30 [00:45<01:46,  5.30s/it]{'epoch': 40, 'num_users': 6.6364, 'loss': 0.0235, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9248, 'compress@10': 0.9892, 'time@10': 6.3534}:  33%|███▎      | 10/30 [00:49<01:46,  5.30s/it]{'epoch': 40, 'num_users': 6.6364, 'loss': 0.0235, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9248, 'compress@10': 0.9892, 'time@10': 6.3534}:  37%|███▋      | 11/30 [00:49<01:33,  4.91s/it]{'epoch': 40, 'num_users': 6.4167, 'loss': 0.0216, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9241, 'compress@10': 0.9894, 'time@10': 6.1202}:  37%|███▋      | 11/30 [00:53<01:33,  4.91s/it]{'epoch': 40, 'num_users': 6.4167, 'loss': 0.0216, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9241, 'compress@10': 0.9894, 'time@10': 6.1202}:  40%|████      | 12/30 [00:53<01:21,  4.51s/it]{'epoch': 40, 'num_users': 6.6154, 'loss': 0.0217, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9234, 'compress@10': 0.9898, 'time@10': 6.1827}:  40%|████      | 12/30 [00:56<01:21,  4.51s/it]{'epoch': 40, 'num_users': 6.6154, 'loss': 0.0217, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9234, 'compress@10': 0.9898, 'time@10': 6.1827}:  43%|████▎     | 13/30 [00:56<01:11,  4.21s/it]{'epoch': 40, 'num_users': 6.3571, 'loss': 0.0202, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9169, 'compress@10': 0.9894, 'time@10': 5.9605}:  43%|████▎     | 13/30 [00:59<01:11,  4.21s/it]{'epoch': 40, 'num_users': 6.3571, 'loss': 0.0202, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9169, 'compress@10': 0.9894, 'time@10': 5.9605}:  47%|████▋     | 14/30 [00:59<01:02,  3.88s/it]{'epoch': 40, 'num_users': 6.2667, 'loss': 0.0208, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9184, 'compress@10': 0.9898, 'time@10': 6.126}:  47%|████▋     | 14/30 [01:04<01:02,  3.88s/it] {'epoch': 40, 'num_users': 6.2667, 'loss': 0.0208, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9184, 'compress@10': 0.9898, 'time@10': 6.126}:  50%|█████     | 15/30 [01:04<00:59,  3.99s/it]{'epoch': 40, 'num_users': 6.0625, 'loss': 0.0196, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9183, 'compress@10': 0.9899, 'time@10': 5.9974}:  50%|█████     | 15/30 [01:08<00:59,  3.99s/it]{'epoch': 40, 'num_users': 6.0625, 'loss': 0.0196, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9183, 'compress@10': 0.9899, 'time@10': 5.9974}:  53%|█████▎    | 16/30 [01:08<00:56,  4.03s/it]{'epoch': 40, 'num_users': 5.8235, 'loss': 0.0184, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9114, 'compress@10': 0.9904, 'time@10': 5.8314}:  53%|█████▎    | 16/30 [01:09<00:56,  4.03s/it]{'epoch': 40, 'num_users': 5.8235, 'loss': 0.0184, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9114, 'compress@10': 0.9904, 'time@10': 5.8314}:  57%|█████▋    | 17/30 [01:09<00:42,  3.31s/it]{'epoch': 40, 'num_users': 6.0556, 'loss': 0.0184, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9125, 'compress@10': 0.9899, 'time@10': 5.7135}:  57%|█████▋    | 17/30 [01:13<00:42,  3.31s/it]{'epoch': 40, 'num_users': 6.0556, 'loss': 0.0184, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9125, 'compress@10': 0.9899, 'time@10': 5.7135}:  60%|██████    | 18/30 [01:13<00:41,  3.44s/it]{'epoch': 40, 'num_users': 6.0, 'loss': 0.0181, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9129, 'compress@10': 0.99, 'time@10': 5.6384}:  60%|██████    | 18/30 [01:15<00:41,  3.44s/it]      {'epoch': 40, 'num_users': 6.0, 'loss': 0.0181, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9129, 'compress@10': 0.99, 'time@10': 5.6384}:  63%|██████▎   | 19/30 [01:15<00:33,  3.09s/it]{'epoch': 40, 'num_users': 6.15, 'loss': 0.0183, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9152, 'compress@10': 0.9903, 'time@10': 5.7853}:  63%|██████▎   | 19/30 [01:24<00:33,  3.09s/it]{'epoch': 40, 'num_users': 6.15, 'loss': 0.0183, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9152, 'compress@10': 0.9903, 'time@10': 5.7853}:  67%|██████▋   | 20/30 [01:24<00:47,  4.75s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9127, 'compress@10': 0.9906, 'time@10': 5.9187}:  67%|██████▋   | 20/30 [01:28<00:47,  4.75s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9127, 'compress@10': 0.9906, 'time@10': 5.9187}:  70%|███████   | 21/30 [01:28<00:41,  4.63s/it]{'epoch': 40, 'num_users': 6.1818, 'loss': 0.0199, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9123, 'compress@10': 0.9908, 'time@10': 5.8093}:  70%|███████   | 21/30 [01:32<00:41,  4.63s/it]{'epoch': 40, 'num_users': 6.1818, 'loss': 0.0199, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9123, 'compress@10': 0.9908, 'time@10': 5.8093}:  73%|███████▎  | 22/30 [01:32<00:34,  4.31s/it]{'epoch': 40, 'num_users': 6.1304, 'loss': 0.0195, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9136, 'compress@10': 0.9911, 'time@10': 5.8272}:  73%|███████▎  | 22/30 [01:35<00:34,  4.31s/it]{'epoch': 40, 'num_users': 6.1304, 'loss': 0.0195, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9136, 'compress@10': 0.9911, 'time@10': 5.8272}:  77%|███████▋  | 23/30 [01:35<00:27,  3.96s/it]{'epoch': 40, 'num_users': 5.9583, 'loss': 0.0187, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9089, 'compress@10': 0.9914, 'time@10': 5.7253}:  77%|███████▋  | 23/30 [01:38<00:27,  3.96s/it]{'epoch': 40, 'num_users': 5.9583, 'loss': 0.0187, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9089, 'compress@10': 0.9914, 'time@10': 5.7253}:  80%|████████  | 24/30 [01:38<00:22,  3.80s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8992, 'compress@10': 0.9916, 'time@10': 5.6561}:  80%|████████  | 24/30 [01:40<00:22,  3.80s/it]    {'epoch': 40, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8992, 'compress@10': 0.9916, 'time@10': 5.6561}:  83%|████████▎ | 25/30 [01:40<00:16,  3.27s/it]{'epoch': 40, 'num_users': 5.8077, 'loss': 0.0178, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9013, 'compress@10': 0.9915, 'time@10': 5.7449}:  83%|████████▎ | 25/30 [01:48<00:16,  3.27s/it]{'epoch': 40, 'num_users': 5.8077, 'loss': 0.0178, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9013, 'compress@10': 0.9915, 'time@10': 5.7449}:  87%|████████▋ | 26/30 [01:48<00:18,  4.69s/it]{'epoch': 40, 'num_users': 5.8889, 'loss': 0.0176, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9027, 'compress@10': 0.9917, 'time@10': 5.7954}:  87%|████████▋ | 26/30 [01:52<00:18,  4.69s/it] {'epoch': 40, 'num_users': 5.8889, 'loss': 0.0176, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9027, 'compress@10': 0.9917, 'time@10': 5.7954}:  90%|█████████ | 27/30 [01:52<00:13,  4.36s/it]{'epoch': 40, 'num_users': 6.0, 'loss': 0.0175, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9053, 'compress@10': 0.9919, 'time@10': 5.8851}:  90%|█████████ | 27/30 [02:00<00:13,  4.36s/it]  {'epoch': 40, 'num_users': 6.0, 'loss': 0.0175, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9053, 'compress@10': 0.9919, 'time@10': 5.8851}:  93%|█████████▎| 28/30 [02:00<00:11,  5.56s/it]{'epoch': 40, 'num_users': 5.8621, 'loss': 0.0173, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9069, 'compress@10': 0.9917, 'time@10': 5.9192}:  93%|█████████▎| 28/30 [02:04<00:11,  5.56s/it]{'epoch': 40, 'num_users': 5.8621, 'loss': 0.0173, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9069, 'compress@10': 0.9917, 'time@10': 5.9192}:  97%|█████████▋| 29/30 [02:04<00:04,  4.93s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0174, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9079, 'compress@10': 0.9919, 'time@10': 5.9186}:  97%|█████████▋| 29/30 [02:10<00:04,  4.93s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0174, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9079, 'compress@10': 0.9919, 'time@10': 5.9186}: 100%|██████████| 30/30 [02:10<00:00,  5.24s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0174, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9079, 'compress@10': 0.9919, 'time@10': 5.9186}: 100%|██████████| 30/30 [02:10<00:00,  4.34s/it]
Epoch: 40
Avg # of users: 5.866666666666666
Avg Loss: 0.017421683341743908
Avg hit ratio: 0.8781572328793306
Avg ndcg: 0.9079382249166486
Avg compression ratio: 0.9919253705753188
Avg train time: 5.918573753039042
Std train time: 1.9323374494823748
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 42, 9, 24, 32, 10, 10, 9, 6, 10, 10, 48, 49, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0237, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9083, 'compress@10': 0.9929, 'time@10': 5.976}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0237, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9083, 'compress@10': 0.9929, 'time@10': 5.976}:   3%|▎         | 1/30 [00:03<01:27,  3.03s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9222, 'compress@10': 0.9921, 'time@10': 5.464}:   3%|▎         | 1/30 [00:08<01:27,  3.03s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9222, 'compress@10': 0.9921, 'time@10': 5.464}:   7%|▋         | 2/30 [00:08<01:57,  4.18s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9005, 'compress@10': 0.9903, 'time@10': 4.8896}:   7%|▋         | 2/30 [00:09<01:57,  4.18s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9005, 'compress@10': 0.9903, 'time@10': 4.8896}:  10%|█         | 3/30 [00:09<01:24,  3.15s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9161, 'compress@10': 0.9875, 'time@10': 4.7697}:  10%|█         | 3/30 [00:14<01:24,  3.15s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9161, 'compress@10': 0.9875, 'time@10': 4.7697}:  13%|█▎        | 4/30 [00:14<01:35,  3.66s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0213, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9002, 'compress@10': 0.9875, 'time@10': 5.4379}:  13%|█▎        | 4/30 [00:18<01:35,  3.66s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 0.0213, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9002, 'compress@10': 0.9875, 'time@10': 5.4379}:  17%|█▋        | 5/30 [00:18<01:35,  3.82s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0206, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.908, 'compress@10': 0.989, 'time@10': 5.7723}:  17%|█▋        | 5/30 [00:25<01:35,  3.82s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0206, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.908, 'compress@10': 0.989, 'time@10': 5.7723}:  20%|██        | 6/30 [00:25<02:01,  5.07s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0207, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.9108, 'compress@10': 0.9894, 'time@10': 6.0827}:  20%|██        | 6/30 [00:29<02:01,  5.07s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0207, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.9108, 'compress@10': 0.9894, 'time@10': 6.0827}:  23%|██▎       | 7/30 [00:29<01:48,  4.73s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.021, 'hit_ratio@10': 0.9194, 'ndcg@10': 0.9156, 'compress@10': 0.99, 'time@10': 6.0594}:  23%|██▎       | 7/30 [00:35<01:48,  4.73s/it]    {'epoch': 41, 'num_users': 6.125, 'loss': 0.021, 'hit_ratio@10': 0.9194, 'ndcg@10': 0.9156, 'compress@10': 0.99, 'time@10': 6.0594}:  27%|██▋       | 8/30 [00:35<01:52,  5.11s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.9093, 'ndcg@10': 0.9202, 'compress@10': 0.9884, 'time@10': 6.2219}:  27%|██▋       | 8/30 [00:39<01:52,  5.11s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.9093, 'ndcg@10': 0.9202, 'compress@10': 0.9884, 'time@10': 6.2219}:  30%|███       | 9/30 [00:39<01:38,  4.70s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.9254, 'compress@10': 0.988, 'time@10': 6.223}:  30%|███       | 9/30 [00:46<01:38,  4.70s/it]     {'epoch': 41, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.9254, 'compress@10': 0.988, 'time@10': 6.223}:  33%|███▎      | 10/30 [00:46<01:43,  5.19s/it]{'epoch': 41, 'num_users': 6.6364, 'loss': 0.0206, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9232, 'compress@10': 0.9886, 'time@10': 6.408}:  33%|███▎      | 10/30 [00:50<01:43,  5.19s/it]{'epoch': 41, 'num_users': 6.6364, 'loss': 0.0206, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9232, 'compress@10': 0.9886, 'time@10': 6.408}:  37%|███▋      | 11/30 [00:50<01:32,  4.88s/it]{'epoch': 41, 'num_users': 6.4167, 'loss': 0.019, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9227, 'compress@10': 0.9889, 'time@10': 6.1792}:  37%|███▋      | 11/30 [00:53<01:32,  4.88s/it]{'epoch': 41, 'num_users': 6.4167, 'loss': 0.019, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9227, 'compress@10': 0.9889, 'time@10': 6.1792}:  40%|████      | 12/30 [00:53<01:21,  4.52s/it]{'epoch': 41, 'num_users': 6.6154, 'loss': 0.0192, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9223, 'compress@10': 0.9893, 'time@10': 6.1997}:  40%|████      | 12/30 [00:57<01:21,  4.52s/it]{'epoch': 41, 'num_users': 6.6154, 'loss': 0.0192, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9223, 'compress@10': 0.9893, 'time@10': 6.1997}:  43%|████▎     | 13/30 [00:57<01:10,  4.14s/it]{'epoch': 41, 'num_users': 6.3571, 'loss': 0.0178, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9159, 'compress@10': 0.9889, 'time@10': 5.9909}:  43%|████▎     | 13/30 [01:00<01:10,  4.14s/it]{'epoch': 41, 'num_users': 6.3571, 'loss': 0.0178, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9159, 'compress@10': 0.9889, 'time@10': 5.9909}:  47%|████▋     | 14/30 [01:00<01:02,  3.89s/it]{'epoch': 41, 'num_users': 6.2667, 'loss': 0.0185, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9169, 'compress@10': 0.9893, 'time@10': 6.1651}:  47%|████▋     | 14/30 [01:04<01:02,  3.89s/it]{'epoch': 41, 'num_users': 6.2667, 'loss': 0.0185, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9169, 'compress@10': 0.9893, 'time@10': 6.1651}:  50%|█████     | 15/30 [01:04<01:00,  4.03s/it]{'epoch': 41, 'num_users': 6.0625, 'loss': 0.0174, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9169, 'compress@10': 0.9895, 'time@10': 6.0111}:  50%|█████     | 15/30 [01:08<01:00,  4.03s/it]{'epoch': 41, 'num_users': 6.0625, 'loss': 0.0174, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9169, 'compress@10': 0.9895, 'time@10': 6.0111}:  53%|█████▎    | 16/30 [01:08<00:55,  3.94s/it]{'epoch': 41, 'num_users': 5.8235, 'loss': 0.0164, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.91, 'compress@10': 0.99, 'time@10': 5.87}:  53%|█████▎    | 16/30 [01:10<00:55,  3.94s/it]      {'epoch': 41, 'num_users': 5.8235, 'loss': 0.0164, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.91, 'compress@10': 0.99, 'time@10': 5.87}:  57%|█████▋    | 17/30 [01:10<00:43,  3.31s/it]{'epoch': 41, 'num_users': 6.0556, 'loss': 0.0164, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.9111, 'compress@10': 0.9897, 'time@10': 5.776}:  57%|█████▋    | 17/30 [01:14<00:43,  3.31s/it]{'epoch': 41, 'num_users': 6.0556, 'loss': 0.0164, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.9111, 'compress@10': 0.9897, 'time@10': 5.776}:  60%|██████    | 18/30 [01:14<00:42,  3.58s/it]{'epoch': 41, 'num_users': 6.0, 'loss': 0.016, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9118, 'compress@10': 0.9899, 'time@10': 5.6941}:  60%|██████    | 18/30 [01:16<00:42,  3.58s/it]   {'epoch': 41, 'num_users': 6.0, 'loss': 0.016, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9118, 'compress@10': 0.9899, 'time@10': 5.6941}:  63%|██████▎   | 19/30 [01:16<00:34,  3.15s/it]{'epoch': 41, 'num_users': 6.15, 'loss': 0.0163, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9139, 'compress@10': 0.9901, 'time@10': 5.7932}:  63%|██████▎   | 19/30 [01:24<00:34,  3.15s/it]{'epoch': 41, 'num_users': 6.15, 'loss': 0.0163, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9139, 'compress@10': 0.9901, 'time@10': 5.7932}:  67%|██████▋   | 20/30 [01:24<00:45,  4.52s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.912, 'compress@10': 0.9904, 'time@10': 5.8623}:  67%|██████▋   | 20/30 [01:28<00:45,  4.52s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.912, 'compress@10': 0.9904, 'time@10': 5.8623}:  70%|███████   | 21/30 [01:28<00:38,  4.26s/it]{'epoch': 41, 'num_users': 6.1818, 'loss': 0.0174, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9121, 'compress@10': 0.9905, 'time@10': 5.7461}:  70%|███████   | 21/30 [01:31<00:38,  4.26s/it]{'epoch': 41, 'num_users': 6.1818, 'loss': 0.0174, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9121, 'compress@10': 0.9905, 'time@10': 5.7461}:  73%|███████▎  | 22/30 [01:31<00:31,  3.99s/it]{'epoch': 41, 'num_users': 6.1304, 'loss': 0.017, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9134, 'compress@10': 0.9908, 'time@10': 5.7685}:  73%|███████▎  | 22/30 [01:34<00:31,  3.99s/it] {'epoch': 41, 'num_users': 6.1304, 'loss': 0.017, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9134, 'compress@10': 0.9908, 'time@10': 5.7685}:  77%|███████▋  | 23/30 [01:34<00:26,  3.74s/it]{'epoch': 41, 'num_users': 5.9583, 'loss': 0.0163, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9087, 'compress@10': 0.9911, 'time@10': 5.6598}:  77%|███████▋  | 23/30 [01:37<00:26,  3.74s/it]{'epoch': 41, 'num_users': 5.9583, 'loss': 0.0163, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9087, 'compress@10': 0.9911, 'time@10': 5.6598}:  80%|████████  | 24/30 [01:37<00:21,  3.58s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0157, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.899, 'compress@10': 0.9913, 'time@10': 5.5622}:  80%|████████  | 24/30 [01:39<00:21,  3.58s/it]    {'epoch': 41, 'num_users': 5.8, 'loss': 0.0157, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.899, 'compress@10': 0.9913, 'time@10': 5.5622}:  83%|████████▎ | 25/30 [01:39<00:15,  3.00s/it]{'epoch': 41, 'num_users': 5.8077, 'loss': 0.0156, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9012, 'compress@10': 0.9913, 'time@10': 5.6553}:  83%|████████▎ | 25/30 [01:47<00:15,  3.00s/it]{'epoch': 41, 'num_users': 5.8077, 'loss': 0.0156, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9012, 'compress@10': 0.9913, 'time@10': 5.6553}:  87%|████████▋ | 26/30 [01:47<00:18,  4.51s/it]{'epoch': 41, 'num_users': 5.8889, 'loss': 0.0155, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9026, 'compress@10': 0.9914, 'time@10': 5.7078}:  87%|████████▋ | 26/30 [01:51<00:18,  4.51s/it]{'epoch': 41, 'num_users': 5.8889, 'loss': 0.0155, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9026, 'compress@10': 0.9914, 'time@10': 5.7078}:  90%|█████████ | 27/30 [01:51<00:12,  4.23s/it]{'epoch': 41, 'num_users': 6.0, 'loss': 0.0155, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.905, 'compress@10': 0.9917, 'time@10': 5.7983}:  90%|█████████ | 27/30 [01:59<00:12,  4.23s/it]    {'epoch': 41, 'num_users': 6.0, 'loss': 0.0155, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.905, 'compress@10': 0.9917, 'time@10': 5.7983}:  93%|█████████▎| 28/30 [01:59<00:10,  5.45s/it]{'epoch': 41, 'num_users': 5.8621, 'loss': 0.0153, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9066, 'compress@10': 0.9915, 'time@10': 5.8341}:  93%|█████████▎| 28/30 [02:02<00:10,  5.45s/it]{'epoch': 41, 'num_users': 5.8621, 'loss': 0.0153, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9066, 'compress@10': 0.9915, 'time@10': 5.8341}:  97%|█████████▋| 29/30 [02:02<00:04,  4.85s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0161, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9096, 'compress@10': 0.9917, 'time@10': 5.8365}:  97%|█████████▋| 29/30 [02:08<00:04,  4.85s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0161, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9096, 'compress@10': 0.9917, 'time@10': 5.8365}: 100%|██████████| 30/30 [02:08<00:00,  5.18s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0161, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9096, 'compress@10': 0.9917, 'time@10': 5.8365}: 100%|██████████| 30/30 [02:08<00:00,  4.29s/it]
Epoch: 41
Avg # of users: 5.866666666666666
Avg Loss: 0.016067558412188213
Avg hit ratio: 0.8767261673648664
Avg ndcg: 0.9096351042563917
Avg compression ratio: 0.991713636204493
Avg train time: 5.8364721775054935
Std train time: 1.8381223671799298
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 42, 9, 24, 32, 10, 10, 9, 6, 10, 10, 48, 49, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9109, 'compress@10': 0.9925, 'time@10': 5.7515}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9109, 'compress@10': 0.9925, 'time@10': 5.7515}:   3%|▎         | 1/30 [00:02<01:24,  2.92s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9374, 'compress@10': 0.9922, 'time@10': 5.3002}:   3%|▎         | 1/30 [00:07<01:24,  2.92s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9374, 'compress@10': 0.9922, 'time@10': 5.3002}:   7%|▋         | 2/30 [00:07<01:54,  4.08s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9106, 'compress@10': 0.9905, 'time@10': 4.7797}:   7%|▋         | 2/30 [00:09<01:54,  4.08s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9106, 'compress@10': 0.9905, 'time@10': 4.7797}:  10%|█         | 3/30 [00:09<01:23,  3.09s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9241, 'compress@10': 0.9877, 'time@10': 4.6968}:  10%|█         | 3/30 [00:14<01:23,  3.09s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9241, 'compress@10': 0.9877, 'time@10': 4.6968}:  13%|█▎        | 4/30 [00:14<01:34,  3.64s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0202, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9067, 'compress@10': 0.9871, 'time@10': 5.5193}:  13%|█▎        | 4/30 [00:18<01:34,  3.64s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0202, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9067, 'compress@10': 0.9871, 'time@10': 5.5193}:  17%|█▋        | 5/30 [00:18<01:38,  3.93s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9146, 'compress@10': 0.9887, 'time@10': 5.8535}:  17%|█▋        | 5/30 [00:26<01:38,  3.93s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9146, 'compress@10': 0.9887, 'time@10': 5.8535}:  20%|██        | 6/30 [00:26<02:04,  5.18s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9146, 'compress@10': 0.9891, 'time@10': 6.1485}:  20%|██        | 6/30 [00:30<02:04,  5.18s/it] {'epoch': 42, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9146, 'compress@10': 0.9891, 'time@10': 6.1485}:  23%|██▎       | 7/30 [00:30<01:50,  4.79s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0208, 'hit_ratio@10': 0.915, 'ndcg@10': 0.9204, 'compress@10': 0.9898, 'time@10': 6.0849}:  23%|██▎       | 7/30 [00:35<01:50,  4.79s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0208, 'hit_ratio@10': 0.915, 'ndcg@10': 0.9204, 'compress@10': 0.9898, 'time@10': 6.0849}:  27%|██▋       | 8/30 [00:35<01:51,  5.08s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.925, 'compress@10': 0.9879, 'time@10': 6.3052}:  27%|██▋       | 8/30 [00:40<01:51,  5.08s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.925, 'compress@10': 0.9879, 'time@10': 6.3052}:  30%|███       | 9/30 [00:40<01:40,  4.77s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.9126, 'ndcg@10': 0.9306, 'compress@10': 0.9878, 'time@10': 6.3169}:  30%|███       | 9/30 [00:46<01:40,  4.77s/it]  {'epoch': 42, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.9126, 'ndcg@10': 0.9306, 'compress@10': 0.9878, 'time@10': 6.3169}:  33%|███▎      | 10/30 [00:46<01:45,  5.30s/it]{'epoch': 42, 'num_users': 6.6364, 'loss': 0.0216, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9297, 'compress@10': 0.9881, 'time@10': 6.4952}:  33%|███▎      | 10/30 [00:50<01:45,  5.30s/it]{'epoch': 42, 'num_users': 6.6364, 'loss': 0.0216, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9297, 'compress@10': 0.9881, 'time@10': 6.4952}:  37%|███▋      | 11/30 [00:50<01:34,  4.96s/it]{'epoch': 42, 'num_users': 6.4167, 'loss': 0.0199, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9287, 'compress@10': 0.9885, 'time@10': 6.2633}:  37%|███▋      | 11/30 [00:54<01:34,  4.96s/it]{'epoch': 42, 'num_users': 6.4167, 'loss': 0.0199, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9287, 'compress@10': 0.9885, 'time@10': 6.2633}:  40%|████      | 12/30 [00:54<01:22,  4.59s/it]{'epoch': 42, 'num_users': 6.6154, 'loss': 0.02, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9279, 'compress@10': 0.9889, 'time@10': 6.2664}:  40%|████      | 12/30 [00:57<01:22,  4.59s/it]  {'epoch': 42, 'num_users': 6.6154, 'loss': 0.02, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9279, 'compress@10': 0.9889, 'time@10': 6.2664}:  43%|████▎     | 13/30 [00:57<01:10,  4.17s/it]{'epoch': 42, 'num_users': 6.3571, 'loss': 0.0186, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9212, 'compress@10': 0.9884, 'time@10': 6.047}:  43%|████▎     | 13/30 [01:00<01:10,  4.17s/it]{'epoch': 42, 'num_users': 6.3571, 'loss': 0.0186, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9212, 'compress@10': 0.9884, 'time@10': 6.047}:  47%|████▋     | 14/30 [01:00<01:02,  3.88s/it]{'epoch': 42, 'num_users': 6.2667, 'loss': 0.0192, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9226, 'compress@10': 0.9889, 'time@10': 6.2188}:  47%|████▋     | 14/30 [01:05<01:02,  3.88s/it]{'epoch': 42, 'num_users': 6.2667, 'loss': 0.0192, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9226, 'compress@10': 0.9889, 'time@10': 6.2188}:  50%|█████     | 15/30 [01:05<01:00,  4.03s/it]{'epoch': 42, 'num_users': 6.0625, 'loss': 0.018, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9222, 'compress@10': 0.9891, 'time@10': 6.0587}:  50%|█████     | 15/30 [01:08<01:00,  4.03s/it] {'epoch': 42, 'num_users': 6.0625, 'loss': 0.018, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9222, 'compress@10': 0.9891, 'time@10': 6.0587}:  53%|█████▎    | 16/30 [01:08<00:54,  3.93s/it]{'epoch': 42, 'num_users': 5.8235, 'loss': 0.017, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.915, 'compress@10': 0.9896, 'time@10': 5.9126}:  53%|█████▎    | 16/30 [01:10<00:54,  3.93s/it] {'epoch': 42, 'num_users': 5.8235, 'loss': 0.017, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.915, 'compress@10': 0.9896, 'time@10': 5.9126}:  57%|█████▋    | 17/30 [01:10<00:42,  3.30s/it]{'epoch': 42, 'num_users': 6.0556, 'loss': 0.017, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9149, 'compress@10': 0.9894, 'time@10': 5.8199}:  57%|█████▋    | 17/30 [01:15<00:42,  3.30s/it]{'epoch': 42, 'num_users': 6.0556, 'loss': 0.017, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9149, 'compress@10': 0.9894, 'time@10': 5.8199}:  60%|██████    | 18/30 [01:15<00:43,  3.59s/it]{'epoch': 42, 'num_users': 6.0, 'loss': 0.0167, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9154, 'compress@10': 0.9896, 'time@10': 5.74}:  60%|██████    | 18/30 [01:17<00:43,  3.59s/it]    {'epoch': 42, 'num_users': 6.0, 'loss': 0.0167, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9154, 'compress@10': 0.9896, 'time@10': 5.74}:  63%|██████▎   | 19/30 [01:17<00:34,  3.17s/it]{'epoch': 42, 'num_users': 6.15, 'loss': 0.0169, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9172, 'compress@10': 0.9898, 'time@10': 5.839}:  63%|██████▎   | 19/30 [01:24<00:34,  3.17s/it]{'epoch': 42, 'num_users': 6.15, 'loss': 0.0169, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9172, 'compress@10': 0.9898, 'time@10': 5.839}:  67%|██████▋   | 20/30 [01:24<00:45,  4.55s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.916, 'compress@10': 0.9901, 'time@10': 5.9314}:  67%|██████▋   | 20/30 [01:28<00:45,  4.55s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.916, 'compress@10': 0.9901, 'time@10': 5.9314}:  70%|███████   | 21/30 [01:28<00:39,  4.36s/it]{'epoch': 42, 'num_users': 6.1818, 'loss': 0.0179, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9158, 'compress@10': 0.9902, 'time@10': 5.8184}:  70%|███████   | 21/30 [01:32<00:39,  4.36s/it]{'epoch': 42, 'num_users': 6.1818, 'loss': 0.0179, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9158, 'compress@10': 0.9902, 'time@10': 5.8184}:  73%|███████▎  | 22/30 [01:32<00:32,  4.10s/it]{'epoch': 42, 'num_users': 6.1304, 'loss': 0.0176, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.917, 'compress@10': 0.9905, 'time@10': 5.8367}:  73%|███████▎  | 22/30 [01:35<00:32,  4.10s/it] {'epoch': 42, 'num_users': 6.1304, 'loss': 0.0176, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.917, 'compress@10': 0.9905, 'time@10': 5.8367}:  77%|███████▋  | 23/30 [01:35<00:26,  3.82s/it]{'epoch': 42, 'num_users': 5.9583, 'loss': 0.0168, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9121, 'compress@10': 0.9908, 'time@10': 5.725}:  77%|███████▋  | 23/30 [01:38<00:26,  3.82s/it]{'epoch': 42, 'num_users': 5.9583, 'loss': 0.0168, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9121, 'compress@10': 0.9908, 'time@10': 5.725}:  80%|████████  | 24/30 [01:38<00:21,  3.63s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.9023, 'compress@10': 0.991, 'time@10': 5.6257}:  80%|████████  | 24/30 [01:40<00:21,  3.63s/it]   {'epoch': 42, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.9023, 'compress@10': 0.991, 'time@10': 5.6257}:  83%|████████▎ | 25/30 [01:40<00:15,  3.04s/it]{'epoch': 42, 'num_users': 5.8077, 'loss': 0.0161, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9046, 'compress@10': 0.991, 'time@10': 5.7176}:  83%|████████▎ | 25/30 [01:48<00:15,  3.04s/it]{'epoch': 42, 'num_users': 5.8077, 'loss': 0.0161, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9046, 'compress@10': 0.991, 'time@10': 5.7176}:  87%|████████▋ | 26/30 [01:48<00:18,  4.55s/it]{'epoch': 42, 'num_users': 5.8889, 'loss': 0.0158, 'hit_ratio@10': 0.872, 'ndcg@10': 0.906, 'compress@10': 0.9912, 'time@10': 5.7885}:  87%|████████▋ | 26/30 [01:52<00:18,  4.55s/it] {'epoch': 42, 'num_users': 5.8889, 'loss': 0.0158, 'hit_ratio@10': 0.872, 'ndcg@10': 0.906, 'compress@10': 0.9912, 'time@10': 5.7885}:  90%|█████████ | 27/30 [01:52<00:13,  4.34s/it]{'epoch': 42, 'num_users': 6.0, 'loss': 0.0159, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9086, 'compress@10': 0.9914, 'time@10': 5.8844}:  90%|█████████ | 27/30 [02:00<00:13,  4.34s/it] {'epoch': 42, 'num_users': 6.0, 'loss': 0.0159, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9086, 'compress@10': 0.9914, 'time@10': 5.8844}:  93%|█████████▎| 28/30 [02:00<00:11,  5.59s/it]{'epoch': 42, 'num_users': 5.8621, 'loss': 0.0157, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.91, 'compress@10': 0.9913, 'time@10': 5.9186}:  93%|█████████▎| 28/30 [02:04<00:11,  5.59s/it]{'epoch': 42, 'num_users': 5.8621, 'loss': 0.0157, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.91, 'compress@10': 0.9913, 'time@10': 5.9186}:  97%|█████████▋| 29/30 [02:04<00:04,  4.96s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0154, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.912, 'compress@10': 0.9915, 'time@10': 5.9182}:  97%|█████████▋| 29/30 [02:10<00:04,  4.96s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0154, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.912, 'compress@10': 0.9915, 'time@10': 5.9182}: 100%|██████████| 30/30 [02:10<00:00,  5.26s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0154, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.912, 'compress@10': 0.9915, 'time@10': 5.9182}: 100%|██████████| 30/30 [02:10<00:00,  4.34s/it]
Epoch: 42
Avg # of users: 5.866666666666666
Avg Loss: 0.015439016079275773
Avg hit ratio: 0.8780997937384927
Avg ndcg: 0.911954976435564
Avg compression ratio: 0.9915010339600427
Avg train time: 5.918229254086812
Std train time: 1.9305626953667039
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 42, 9, 24, 32, 10, 10, 9, 6, 10, 10, 48, 49, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9104, 'compress@10': 0.9922, 'time@10': 5.9435}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9104, 'compress@10': 0.9922, 'time@10': 5.9435}:   3%|▎         | 1/30 [00:03<01:27,  3.01s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9332, 'compress@10': 0.9917, 'time@10': 5.3864}:   3%|▎         | 1/30 [00:07<01:27,  3.01s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9332, 'compress@10': 0.9917, 'time@10': 5.3864}:   7%|▋         | 2/30 [00:07<01:54,  4.10s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9078, 'compress@10': 0.9902, 'time@10': 4.7481}:   7%|▋         | 2/30 [00:09<01:54,  4.10s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9078, 'compress@10': 0.9902, 'time@10': 4.7481}:  10%|█         | 3/30 [00:09<01:22,  3.04s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9195, 'compress@10': 0.9873, 'time@10': 4.6628}:  10%|█         | 3/30 [00:14<01:22,  3.04s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9195, 'compress@10': 0.9873, 'time@10': 4.6628}:  13%|█▎        | 4/30 [00:14<01:33,  3.60s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9039, 'compress@10': 0.9865, 'time@10': 5.3243}:  13%|█▎        | 4/30 [00:18<01:33,  3.60s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9039, 'compress@10': 0.9865, 'time@10': 5.3243}:  17%|█▋        | 5/30 [00:18<01:33,  3.75s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0154, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9136, 'compress@10': 0.9882, 'time@10': 5.5559}:  17%|█▋        | 5/30 [00:24<01:33,  3.75s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0154, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9136, 'compress@10': 0.9882, 'time@10': 5.5559}:  20%|██        | 6/30 [00:24<01:54,  4.77s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9159, 'compress@10': 0.9889, 'time@10': 5.8683}:  20%|██        | 6/30 [00:28<01:54,  4.77s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9159, 'compress@10': 0.9889, 'time@10': 5.8683}:  23%|██▎       | 7/30 [00:28<01:43,  4.49s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.9105, 'ndcg@10': 0.9218, 'compress@10': 0.9896, 'time@10': 5.8324}:  23%|██▎       | 7/30 [00:34<01:43,  4.49s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.9105, 'ndcg@10': 0.9218, 'compress@10': 0.9896, 'time@10': 5.8324}:  27%|██▋       | 8/30 [00:34<01:48,  4.91s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9273, 'compress@10': 0.9875, 'time@10': 6.0512}:  27%|██▋       | 8/30 [00:38<01:48,  4.91s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9273, 'compress@10': 0.9875, 'time@10': 6.0512}:  30%|███       | 9/30 [00:38<01:36,  4.61s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.909, 'ndcg@10': 0.9319, 'compress@10': 0.9873, 'time@10': 6.1058}:  30%|███       | 9/30 [00:45<01:36,  4.61s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.909, 'ndcg@10': 0.9319, 'compress@10': 0.9873, 'time@10': 6.1058}:  33%|███▎      | 10/30 [00:45<01:44,  5.24s/it]{'epoch': 43, 'num_users': 6.6364, 'loss': 0.0179, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9318, 'compress@10': 0.9879, 'time@10': 6.2757}:  33%|███▎      | 10/30 [00:49<01:44,  5.24s/it]{'epoch': 43, 'num_users': 6.6364, 'loss': 0.0179, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9318, 'compress@10': 0.9879, 'time@10': 6.2757}:  37%|███▋      | 11/30 [00:49<01:32,  4.87s/it]{'epoch': 43, 'num_users': 6.4167, 'loss': 0.0165, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9305, 'compress@10': 0.9883, 'time@10': 6.0448}:  37%|███▋      | 11/30 [00:52<01:32,  4.87s/it]{'epoch': 43, 'num_users': 6.4167, 'loss': 0.0165, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9305, 'compress@10': 0.9883, 'time@10': 6.0448}:  40%|████      | 12/30 [00:52<01:20,  4.46s/it]{'epoch': 43, 'num_users': 6.6154, 'loss': 0.0169, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9295, 'compress@10': 0.9886, 'time@10': 6.1411}:  40%|████      | 12/30 [00:56<01:20,  4.46s/it]{'epoch': 43, 'num_users': 6.6154, 'loss': 0.0169, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9295, 'compress@10': 0.9886, 'time@10': 6.1411}:  43%|████▎     | 13/30 [00:56<01:11,  4.23s/it]{'epoch': 43, 'num_users': 6.3571, 'loss': 0.0157, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9226, 'compress@10': 0.9882, 'time@10': 5.9182}:  43%|████▎     | 13/30 [00:59<01:11,  4.23s/it]{'epoch': 43, 'num_users': 6.3571, 'loss': 0.0157, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9226, 'compress@10': 0.9882, 'time@10': 5.9182}:  47%|████▋     | 14/30 [00:59<01:02,  3.88s/it]{'epoch': 43, 'num_users': 6.2667, 'loss': 0.0165, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9233, 'compress@10': 0.9887, 'time@10': 6.1121}:  47%|████▋     | 14/30 [01:03<01:02,  3.88s/it]{'epoch': 43, 'num_users': 6.2667, 'loss': 0.0165, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9233, 'compress@10': 0.9887, 'time@10': 6.1121}:  50%|█████     | 15/30 [01:03<01:00,  4.05s/it]{'epoch': 43, 'num_users': 6.0625, 'loss': 0.0155, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9229, 'compress@10': 0.9889, 'time@10': 5.9693}:  50%|█████     | 15/30 [01:07<01:00,  4.05s/it]{'epoch': 43, 'num_users': 6.0625, 'loss': 0.0155, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9229, 'compress@10': 0.9889, 'time@10': 5.9693}:  53%|█████▎    | 16/30 [01:07<00:55,  4.00s/it]{'epoch': 43, 'num_users': 5.8235, 'loss': 0.0146, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9157, 'compress@10': 0.9895, 'time@10': 5.7951}:  53%|█████▎    | 16/30 [01:09<00:55,  4.00s/it] {'epoch': 43, 'num_users': 5.8235, 'loss': 0.0146, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9157, 'compress@10': 0.9895, 'time@10': 5.7951}:  57%|█████▋    | 17/30 [01:09<00:42,  3.26s/it]{'epoch': 43, 'num_users': 6.0556, 'loss': 0.0144, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9168, 'compress@10': 0.9893, 'time@10': 5.6912}:  57%|█████▋    | 17/30 [01:13<00:42,  3.26s/it]{'epoch': 43, 'num_users': 6.0556, 'loss': 0.0144, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9168, 'compress@10': 0.9893, 'time@10': 5.6912}:  60%|██████    | 18/30 [01:13<00:41,  3.47s/it]{'epoch': 43, 'num_users': 6.0, 'loss': 0.014, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9172, 'compress@10': 0.9895, 'time@10': 5.6243}:  60%|██████    | 18/30 [01:15<00:41,  3.47s/it]    {'epoch': 43, 'num_users': 6.0, 'loss': 0.014, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9172, 'compress@10': 0.9895, 'time@10': 5.6243}:  63%|██████▎   | 19/30 [01:15<00:34,  3.11s/it]{'epoch': 43, 'num_users': 6.15, 'loss': 0.0143, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9197, 'compress@10': 0.9897, 'time@10': 5.7345}:  63%|██████▎   | 19/30 [01:23<00:34,  3.11s/it]{'epoch': 43, 'num_users': 6.15, 'loss': 0.0143, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9197, 'compress@10': 0.9897, 'time@10': 5.7345}:  67%|██████▋   | 20/30 [01:23<00:45,  4.54s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0155, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9175, 'compress@10': 0.99, 'time@10': 5.8323}:  67%|██████▋   | 20/30 [01:27<00:45,  4.54s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0155, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9175, 'compress@10': 0.99, 'time@10': 5.8323}:  70%|███████   | 21/30 [01:27<00:39,  4.36s/it]{'epoch': 43, 'num_users': 6.1818, 'loss': 0.0159, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9174, 'compress@10': 0.99, 'time@10': 5.7164}:  70%|███████   | 21/30 [01:30<00:39,  4.36s/it]{'epoch': 43, 'num_users': 6.1818, 'loss': 0.0159, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9174, 'compress@10': 0.99, 'time@10': 5.7164}:  73%|███████▎  | 22/30 [01:30<00:32,  4.05s/it]{'epoch': 43, 'num_users': 6.1304, 'loss': 0.0156, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9185, 'compress@10': 0.9903, 'time@10': 5.7398}:  73%|███████▎  | 22/30 [01:33<00:32,  4.05s/it]{'epoch': 43, 'num_users': 6.1304, 'loss': 0.0156, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9185, 'compress@10': 0.9903, 'time@10': 5.7398}:  77%|███████▋  | 23/30 [01:33<00:26,  3.78s/it]{'epoch': 43, 'num_users': 5.9583, 'loss': 0.015, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.9136, 'compress@10': 0.9906, 'time@10': 5.6322}:  77%|███████▋  | 23/30 [01:37<00:26,  3.78s/it] {'epoch': 43, 'num_users': 5.9583, 'loss': 0.015, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.9136, 'compress@10': 0.9906, 'time@10': 5.6322}:  80%|████████  | 24/30 [01:37<00:21,  3.61s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0144, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9037, 'compress@10': 0.9908, 'time@10': 5.5357}:  80%|████████  | 24/30 [01:38<00:21,  3.61s/it]  {'epoch': 43, 'num_users': 5.8, 'loss': 0.0144, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9037, 'compress@10': 0.9908, 'time@10': 5.5357}:  83%|████████▎ | 25/30 [01:38<00:15,  3.02s/it]{'epoch': 43, 'num_users': 5.8077, 'loss': 0.0143, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9059, 'compress@10': 0.9908, 'time@10': 5.6306}:  83%|████████▎ | 25/30 [01:46<00:15,  3.02s/it]{'epoch': 43, 'num_users': 5.8077, 'loss': 0.0143, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9059, 'compress@10': 0.9908, 'time@10': 5.6306}:  87%|████████▋ | 26/30 [01:46<00:18,  4.53s/it]{'epoch': 43, 'num_users': 5.8889, 'loss': 0.0142, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9073, 'compress@10': 0.991, 'time@10': 5.6813}:  87%|████████▋ | 26/30 [01:50<00:18,  4.53s/it] {'epoch': 43, 'num_users': 5.8889, 'loss': 0.0142, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9073, 'compress@10': 0.991, 'time@10': 5.6813}:  90%|█████████ | 27/30 [01:50<00:12,  4.23s/it]{'epoch': 43, 'num_users': 6.0, 'loss': 0.0145, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9111, 'compress@10': 0.9912, 'time@10': 5.7776}:  90%|█████████ | 27/30 [01:58<00:12,  4.23s/it]  {'epoch': 43, 'num_users': 6.0, 'loss': 0.0145, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9111, 'compress@10': 0.9912, 'time@10': 5.7776}:  93%|█████████▎| 28/30 [01:58<00:10,  5.49s/it]{'epoch': 43, 'num_users': 5.8621, 'loss': 0.0144, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9125, 'compress@10': 0.9911, 'time@10': 5.8145}:  93%|█████████▎| 28/30 [02:02<00:10,  5.49s/it]{'epoch': 43, 'num_users': 5.8621, 'loss': 0.0144, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9125, 'compress@10': 0.9911, 'time@10': 5.8145}:  97%|█████████▋| 29/30 [02:02<00:04,  4.88s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0149, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9142, 'compress@10': 0.9913, 'time@10': 5.818}:  97%|█████████▋| 29/30 [02:08<00:04,  4.88s/it] {'epoch': 43, 'num_users': 5.8667, 'loss': 0.0149, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9142, 'compress@10': 0.9913, 'time@10': 5.818}: 100%|██████████| 30/30 [02:08<00:00,  5.21s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0149, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9142, 'compress@10': 0.9913, 'time@10': 5.818}: 100%|██████████| 30/30 [02:08<00:00,  4.27s/it]
Epoch: 43
Avg # of users: 5.866666666666666
Avg Loss: 0.014916774732701515
Avg hit ratio: 0.8734443140830132
Avg ndcg: 0.9142215760884718
Avg compression ratio: 0.9913003056594877
Avg train time: 5.818012229601542
Std train time: 1.922160872833295
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 43, 9, 24, 33, 10, 10, 9, 6, 10, 10, 48, 49, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9104, 'compress@10': 0.9917, 'time@10': 5.9313}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9104, 'compress@10': 0.9917, 'time@10': 5.9313}:   3%|▎         | 1/30 [00:03<01:27,  3.01s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9218, 'compress@10': 0.9914, 'time@10': 5.4308}:   3%|▎         | 1/30 [00:07<01:27,  3.01s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9218, 'compress@10': 0.9914, 'time@10': 5.4308}:   7%|▋         | 2/30 [00:07<01:56,  4.16s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9002, 'compress@10': 0.9893, 'time@10': 4.8789}:   7%|▋         | 2/30 [00:09<01:56,  4.16s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9002, 'compress@10': 0.9893, 'time@10': 4.8789}:  10%|█         | 3/30 [00:09<01:24,  3.14s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.9148, 'compress@10': 0.9869, 'time@10': 4.7639}:  10%|█         | 3/30 [00:14<01:24,  3.14s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.9148, 'compress@10': 0.9869, 'time@10': 4.7639}:  13%|█▎        | 4/30 [00:14<01:35,  3.66s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0182, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.901, 'compress@10': 0.9861, 'time@10': 5.4492}:  13%|█▎        | 4/30 [00:18<01:35,  3.66s/it] {'epoch': 44, 'num_users': 5.8, 'loss': 0.0182, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.901, 'compress@10': 0.9861, 'time@10': 5.4492}:  17%|█▋        | 5/30 [00:18<01:35,  3.83s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0189, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9105, 'compress@10': 0.9879, 'time@10': 5.7403}:  17%|█▋        | 5/30 [00:25<01:35,  3.83s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0189, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9105, 'compress@10': 0.9879, 'time@10': 5.7403}:  20%|██        | 6/30 [00:25<01:59,  4.99s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.019, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9114, 'compress@10': 0.9885, 'time@10': 6.053}:  20%|██        | 6/30 [00:29<01:59,  4.99s/it]  {'epoch': 44, 'num_users': 6.2857, 'loss': 0.019, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9114, 'compress@10': 0.9885, 'time@10': 6.053}:  23%|██▎       | 7/30 [00:29<01:47,  4.67s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0196, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9176, 'compress@10': 0.9893, 'time@10': 5.9962}:  23%|██▎       | 7/30 [00:35<01:47,  4.67s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0196, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9176, 'compress@10': 0.9893, 'time@10': 5.9962}:  27%|██▋       | 8/30 [00:35<01:49,  4.98s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9238, 'compress@10': 0.9871, 'time@10': 6.1987}:  27%|██▋       | 8/30 [00:39<01:49,  4.98s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9238, 'compress@10': 0.9871, 'time@10': 6.1987}:  30%|███       | 9/30 [00:39<01:37,  4.66s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9288, 'compress@10': 0.9871, 'time@10': 6.183}:  30%|███       | 9/30 [00:45<01:37,  4.66s/it]    {'epoch': 44, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9288, 'compress@10': 0.9871, 'time@10': 6.183}:  33%|███▎      | 10/30 [00:45<01:42,  5.11s/it]{'epoch': 44, 'num_users': 6.6364, 'loss': 0.0206, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9284, 'compress@10': 0.9876, 'time@10': 6.3041}:  33%|███▎      | 10/30 [00:49<01:42,  5.11s/it]{'epoch': 44, 'num_users': 6.6364, 'loss': 0.0206, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9284, 'compress@10': 0.9876, 'time@10': 6.3041}:  37%|███▋      | 11/30 [00:49<01:29,  4.71s/it]{'epoch': 44, 'num_users': 6.4167, 'loss': 0.019, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9274, 'compress@10': 0.9879, 'time@10': 6.1106}:  37%|███▋      | 11/30 [00:53<01:29,  4.71s/it] {'epoch': 44, 'num_users': 6.4167, 'loss': 0.019, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9274, 'compress@10': 0.9879, 'time@10': 6.1106}:  40%|████      | 12/30 [00:53<01:20,  4.50s/it]{'epoch': 44, 'num_users': 6.6154, 'loss': 0.0191, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9269, 'compress@10': 0.9883, 'time@10': 6.1908}:  40%|████      | 12/30 [00:56<01:20,  4.50s/it]{'epoch': 44, 'num_users': 6.6154, 'loss': 0.0191, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9269, 'compress@10': 0.9883, 'time@10': 6.1908}:  43%|████▎     | 13/30 [00:56<01:11,  4.23s/it]{'epoch': 44, 'num_users': 6.3571, 'loss': 0.0177, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9202, 'compress@10': 0.9879, 'time@10': 6.0312}:  43%|████▎     | 13/30 [01:00<01:11,  4.23s/it]{'epoch': 44, 'num_users': 6.3571, 'loss': 0.0177, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9202, 'compress@10': 0.9879, 'time@10': 6.0312}:  47%|████▋     | 14/30 [01:00<01:06,  4.16s/it]{'epoch': 44, 'num_users': 6.2667, 'loss': 0.0184, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9219, 'compress@10': 0.9884, 'time@10': 6.194}:  47%|████▋     | 14/30 [01:05<01:06,  4.16s/it] {'epoch': 44, 'num_users': 6.2667, 'loss': 0.0184, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9219, 'compress@10': 0.9884, 'time@10': 6.194}:  50%|█████     | 15/30 [01:05<01:02,  4.20s/it]{'epoch': 44, 'num_users': 6.0625, 'loss': 0.0173, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9215, 'compress@10': 0.9886, 'time@10': 6.0459}:  50%|█████     | 15/30 [01:09<01:02,  4.20s/it]{'epoch': 44, 'num_users': 6.0625, 'loss': 0.0173, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9215, 'compress@10': 0.9886, 'time@10': 6.0459}:  53%|█████▎    | 16/30 [01:09<00:57,  4.10s/it]{'epoch': 44, 'num_users': 5.8235, 'loss': 0.0162, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.9144, 'compress@10': 0.9892, 'time@10': 5.8759}:  53%|█████▎    | 16/30 [01:10<00:57,  4.10s/it]{'epoch': 44, 'num_users': 5.8235, 'loss': 0.0162, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.9144, 'compress@10': 0.9892, 'time@10': 5.8759}:  57%|█████▋    | 17/30 [01:10<00:43,  3.35s/it]{'epoch': 44, 'num_users': 6.0556, 'loss': 0.0162, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.9154, 'compress@10': 0.9889, 'time@10': 5.7689}:  57%|█████▋    | 17/30 [01:14<00:43,  3.35s/it]{'epoch': 44, 'num_users': 6.0556, 'loss': 0.0162, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.9154, 'compress@10': 0.9889, 'time@10': 5.7689}:  60%|██████    | 18/30 [01:14<00:42,  3.54s/it]{'epoch': 44, 'num_users': 6.0, 'loss': 0.0159, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.9159, 'compress@10': 0.9891, 'time@10': 5.6759}:  60%|██████    | 18/30 [01:16<00:42,  3.54s/it]   {'epoch': 44, 'num_users': 6.0, 'loss': 0.0159, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.9159, 'compress@10': 0.9891, 'time@10': 5.6759}:  63%|██████▎   | 19/30 [01:16<00:34,  3.09s/it]{'epoch': 44, 'num_users': 6.15, 'loss': 0.0161, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.918, 'compress@10': 0.9894, 'time@10': 5.7931}:  63%|██████▎   | 19/30 [01:24<00:34,  3.09s/it]{'epoch': 44, 'num_users': 6.15, 'loss': 0.0161, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.918, 'compress@10': 0.9894, 'time@10': 5.7931}:  67%|██████▋   | 20/30 [01:24<00:45,  4.58s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9158, 'compress@10': 0.9897, 'time@10': 5.8875}:  67%|██████▋   | 20/30 [01:28<00:45,  4.58s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9158, 'compress@10': 0.9897, 'time@10': 5.8875}:  70%|███████   | 21/30 [01:28<00:39,  4.39s/it]{'epoch': 44, 'num_users': 6.1818, 'loss': 0.0173, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.9158, 'compress@10': 0.9897, 'time@10': 5.7772}:  70%|███████   | 21/30 [01:32<00:39,  4.39s/it]{'epoch': 44, 'num_users': 6.1818, 'loss': 0.0173, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.9158, 'compress@10': 0.9897, 'time@10': 5.7772}:  73%|███████▎  | 22/30 [01:32<00:32,  4.12s/it]{'epoch': 44, 'num_users': 6.1304, 'loss': 0.017, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.917, 'compress@10': 0.9901, 'time@10': 5.7786}:  73%|███████▎  | 22/30 [01:35<00:32,  4.12s/it]  {'epoch': 44, 'num_users': 6.1304, 'loss': 0.017, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.917, 'compress@10': 0.9901, 'time@10': 5.7786}:  77%|███████▋  | 23/30 [01:35<00:26,  3.77s/it]{'epoch': 44, 'num_users': 5.9583, 'loss': 0.0163, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.9122, 'compress@10': 0.9904, 'time@10': 5.6477}:  77%|███████▋  | 23/30 [01:37<00:26,  3.77s/it]{'epoch': 44, 'num_users': 5.9583, 'loss': 0.0163, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.9122, 'compress@10': 0.9904, 'time@10': 5.6477}:  80%|████████  | 24/30 [01:37<00:20,  3.44s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9023, 'compress@10': 0.9906, 'time@10': 5.5496}:  80%|████████  | 24/30 [01:39<00:20,  3.44s/it]    {'epoch': 44, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9023, 'compress@10': 0.9906, 'time@10': 5.5496}:  83%|████████▎ | 25/30 [01:39<00:14,  2.90s/it]{'epoch': 44, 'num_users': 5.8077, 'loss': 0.0155, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.9047, 'compress@10': 0.9905, 'time@10': 5.6427}:  83%|████████▎ | 25/30 [01:47<00:14,  2.90s/it]{'epoch': 44, 'num_users': 5.8077, 'loss': 0.0155, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.9047, 'compress@10': 0.9905, 'time@10': 5.6427}:  87%|████████▋ | 26/30 [01:47<00:17,  4.43s/it]{'epoch': 44, 'num_users': 5.8889, 'loss': 0.0153, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9061, 'compress@10': 0.9907, 'time@10': 5.6993}:  87%|████████▋ | 26/30 [01:51<00:17,  4.43s/it]{'epoch': 44, 'num_users': 5.8889, 'loss': 0.0153, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9061, 'compress@10': 0.9907, 'time@10': 5.6993}:  90%|█████████ | 27/30 [01:51<00:12,  4.19s/it]{'epoch': 44, 'num_users': 6.0, 'loss': 0.0152, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9083, 'compress@10': 0.991, 'time@10': 5.7914}:  90%|█████████ | 27/30 [01:59<00:12,  4.19s/it]    {'epoch': 44, 'num_users': 6.0, 'loss': 0.0152, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9083, 'compress@10': 0.991, 'time@10': 5.7914}:  93%|█████████▎| 28/30 [01:59<00:10,  5.43s/it]{'epoch': 44, 'num_users': 5.8621, 'loss': 0.0151, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9098, 'compress@10': 0.9908, 'time@10': 5.8283}:  93%|█████████▎| 28/30 [02:02<00:10,  5.43s/it]{'epoch': 44, 'num_users': 5.8621, 'loss': 0.0151, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9098, 'compress@10': 0.9908, 'time@10': 5.8283}:  97%|█████████▋| 29/30 [02:02<00:04,  4.84s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0153, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9122, 'compress@10': 0.9911, 'time@10': 5.8324}:  97%|█████████▋| 29/30 [02:08<00:04,  4.84s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0153, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9122, 'compress@10': 0.9911, 'time@10': 5.8324}: 100%|██████████| 30/30 [02:08<00:00,  5.19s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0153, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9122, 'compress@10': 0.9911, 'time@10': 5.8324}: 100%|██████████| 30/30 [02:08<00:00,  4.29s/it]
Epoch: 44
Avg # of users: 5.866666666666666
Avg Loss: 0.015343451728612756
Avg hit ratio: 0.8712773941399095
Avg ndcg: 0.9121839194974007
Avg compression ratio: 0.9910861903178305
Avg train time: 5.832374040285746
Std train time: 1.8644369899208135
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 43, 9, 24, 34, 10, 10, 9, 6, 10, 10, 49, 49, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9104, 'compress@10': 0.9912, 'time@10': 5.928}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9104, 'compress@10': 0.9912, 'time@10': 5.928}:   3%|▎         | 1/30 [00:03<01:27,  3.00s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9473, 'compress@10': 0.9915, 'time@10': 5.7509}:   3%|▎         | 1/30 [00:08<01:27,  3.00s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9473, 'compress@10': 0.9915, 'time@10': 5.7509}:   7%|▋         | 2/30 [00:08<02:07,  4.54s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.842, 'ndcg@10': 0.9173, 'compress@10': 0.9904, 'time@10': 5.0824}:   7%|▋         | 2/30 [00:10<02:07,  4.54s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.842, 'ndcg@10': 0.9173, 'compress@10': 0.9904, 'time@10': 5.0824}:  10%|█         | 3/30 [00:10<01:30,  3.34s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9285, 'compress@10': 0.9885, 'time@10': 4.9115}:  10%|█         | 3/30 [00:14<01:30,  3.34s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9285, 'compress@10': 0.9885, 'time@10': 4.9115}:  13%|█▎        | 4/30 [00:14<01:38,  3.78s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9125, 'compress@10': 0.9875, 'time@10': 5.5969}:  13%|█▎        | 4/30 [00:19<01:38,  3.78s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9125, 'compress@10': 0.9875, 'time@10': 5.5969}:  17%|█▋        | 5/30 [00:19<01:38,  3.93s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0201, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9193, 'compress@10': 0.9889, 'time@10': 5.9801}:  17%|█▋        | 5/30 [00:27<01:38,  3.93s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0201, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9193, 'compress@10': 0.9889, 'time@10': 5.9801}:  20%|██        | 6/30 [00:27<02:07,  5.30s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.02, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9217, 'compress@10': 0.9894, 'time@10': 6.2781}:  20%|██        | 6/30 [00:31<02:07,  5.30s/it]  {'epoch': 45, 'num_users': 6.2857, 'loss': 0.02, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9217, 'compress@10': 0.9894, 'time@10': 6.2781}:  23%|██▎       | 7/30 [00:31<01:52,  4.90s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0205, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9264, 'compress@10': 0.99, 'time@10': 6.1932}:  23%|██▎       | 7/30 [00:36<01:52,  4.90s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0205, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9264, 'compress@10': 0.99, 'time@10': 6.1932}:  27%|██▋       | 8/30 [00:36<01:52,  5.13s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9311, 'compress@10': 0.9877, 'time@10': 6.3763}:  27%|██▋       | 8/30 [00:40<01:52,  5.13s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9311, 'compress@10': 0.9877, 'time@10': 6.3763}:  30%|███       | 9/30 [00:40<01:40,  4.77s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.935, 'compress@10': 0.9874, 'time@10': 6.4067}:  30%|███       | 9/30 [00:47<01:40,  4.77s/it]    {'epoch': 45, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.935, 'compress@10': 0.9874, 'time@10': 6.4067}:  33%|███▎      | 10/30 [00:47<01:47,  5.37s/it]{'epoch': 45, 'num_users': 6.6364, 'loss': 0.0203, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9338, 'compress@10': 0.9878, 'time@10': 6.5645}:  33%|███▎      | 10/30 [00:51<01:47,  5.37s/it]{'epoch': 45, 'num_users': 6.6364, 'loss': 0.0203, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9338, 'compress@10': 0.9878, 'time@10': 6.5645}:  37%|███▋      | 11/30 [00:51<01:34,  4.98s/it]{'epoch': 45, 'num_users': 6.4167, 'loss': 0.0186, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9323, 'compress@10': 0.9881, 'time@10': 6.3496}:  37%|███▋      | 11/30 [00:55<01:34,  4.98s/it]{'epoch': 45, 'num_users': 6.4167, 'loss': 0.0186, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9323, 'compress@10': 0.9881, 'time@10': 6.3496}:  40%|████      | 12/30 [00:55<01:24,  4.69s/it]{'epoch': 45, 'num_users': 6.6154, 'loss': 0.0187, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9317, 'compress@10': 0.9884, 'time@10': 6.3507}:  40%|████      | 12/30 [00:58<01:24,  4.69s/it]{'epoch': 45, 'num_users': 6.6154, 'loss': 0.0187, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9317, 'compress@10': 0.9884, 'time@10': 6.3507}:  43%|████▎     | 13/30 [00:58<01:12,  4.25s/it]{'epoch': 45, 'num_users': 6.3571, 'loss': 0.0174, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9247, 'compress@10': 0.988, 'time@10': 6.1237}:  43%|████▎     | 13/30 [01:02<01:12,  4.25s/it] {'epoch': 45, 'num_users': 6.3571, 'loss': 0.0174, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9247, 'compress@10': 0.988, 'time@10': 6.1237}:  47%|████▋     | 14/30 [01:02<01:02,  3.93s/it]{'epoch': 45, 'num_users': 6.2667, 'loss': 0.018, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9263, 'compress@10': 0.9885, 'time@10': 6.2625}:  47%|████▋     | 14/30 [01:06<01:02,  3.93s/it]{'epoch': 45, 'num_users': 6.2667, 'loss': 0.018, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9263, 'compress@10': 0.9885, 'time@10': 6.2625}:  50%|█████     | 15/30 [01:06<00:59,  4.00s/it]{'epoch': 45, 'num_users': 6.0625, 'loss': 0.0169, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9257, 'compress@10': 0.9887, 'time@10': 6.1276}:  50%|█████     | 15/30 [01:10<00:59,  4.00s/it]{'epoch': 45, 'num_users': 6.0625, 'loss': 0.0169, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9257, 'compress@10': 0.9887, 'time@10': 6.1276}:  53%|█████▎    | 16/30 [01:10<00:56,  4.04s/it]{'epoch': 45, 'num_users': 5.8235, 'loss': 0.0159, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9183, 'compress@10': 0.9893, 'time@10': 5.9801}:  53%|█████▎    | 16/30 [01:12<00:56,  4.04s/it]{'epoch': 45, 'num_users': 5.8235, 'loss': 0.0159, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9183, 'compress@10': 0.9893, 'time@10': 5.9801}:  57%|█████▋    | 17/30 [01:12<00:43,  3.38s/it]{'epoch': 45, 'num_users': 6.0556, 'loss': 0.0158, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9188, 'compress@10': 0.989, 'time@10': 5.8593}:  57%|█████▋    | 17/30 [01:16<00:43,  3.38s/it] {'epoch': 45, 'num_users': 6.0556, 'loss': 0.0158, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9188, 'compress@10': 0.989, 'time@10': 5.8593}:  60%|██████    | 18/30 [01:16<00:42,  3.52s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 0.0155, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9191, 'compress@10': 0.9892, 'time@10': 5.7785}:  60%|██████    | 18/30 [01:18<00:42,  3.52s/it]  {'epoch': 45, 'num_users': 6.0, 'loss': 0.0155, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9191, 'compress@10': 0.9892, 'time@10': 5.7785}:  63%|██████▎   | 19/30 [01:18<00:34,  3.13s/it]{'epoch': 45, 'num_users': 6.15, 'loss': 0.0156, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9212, 'compress@10': 0.9894, 'time@10': 5.874}:  63%|██████▎   | 19/30 [01:26<00:34,  3.13s/it]{'epoch': 45, 'num_users': 6.15, 'loss': 0.0156, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9212, 'compress@10': 0.9894, 'time@10': 5.874}:  67%|██████▋   | 20/30 [01:26<00:45,  4.51s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9203, 'compress@10': 0.9897, 'time@10': 5.9728}:  67%|██████▋   | 20/30 [01:30<00:45,  4.51s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9203, 'compress@10': 0.9897, 'time@10': 5.9728}:  70%|███████   | 21/30 [01:30<00:39,  4.36s/it]{'epoch': 45, 'num_users': 6.1818, 'loss': 0.0166, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9202, 'compress@10': 0.9898, 'time@10': 5.858}:  70%|███████   | 21/30 [01:33<00:39,  4.36s/it] {'epoch': 45, 'num_users': 6.1818, 'loss': 0.0166, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9202, 'compress@10': 0.9898, 'time@10': 5.858}:  73%|███████▎  | 22/30 [01:33<00:32,  4.10s/it]{'epoch': 45, 'num_users': 6.1304, 'loss': 0.0162, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9212, 'compress@10': 0.9901, 'time@10': 5.8746}:  73%|███████▎  | 22/30 [01:36<00:32,  4.10s/it]{'epoch': 45, 'num_users': 6.1304, 'loss': 0.0162, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9212, 'compress@10': 0.9901, 'time@10': 5.8746}:  77%|███████▋  | 23/30 [01:36<00:26,  3.82s/it]{'epoch': 45, 'num_users': 5.9583, 'loss': 0.0155, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9161, 'compress@10': 0.9904, 'time@10': 5.7632}:  77%|███████▋  | 23/30 [01:39<00:26,  3.82s/it]{'epoch': 45, 'num_users': 5.9583, 'loss': 0.0155, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9161, 'compress@10': 0.9904, 'time@10': 5.7632}:  80%|████████  | 24/30 [01:39<00:21,  3.64s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9062, 'compress@10': 0.9906, 'time@10': 5.6597}:  80%|████████  | 24/30 [01:41<00:21,  3.64s/it]   {'epoch': 45, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9062, 'compress@10': 0.9906, 'time@10': 5.6597}:  83%|████████▎ | 25/30 [01:41<00:15,  3.04s/it]{'epoch': 45, 'num_users': 5.8077, 'loss': 0.0148, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9083, 'compress@10': 0.9905, 'time@10': 5.7479}:  83%|████████▎ | 25/30 [01:49<00:15,  3.04s/it]{'epoch': 45, 'num_users': 5.8077, 'loss': 0.0148, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9083, 'compress@10': 0.9905, 'time@10': 5.7479}:  87%|████████▋ | 26/30 [01:49<00:18,  4.53s/it]{'epoch': 45, 'num_users': 5.8889, 'loss': 0.0146, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9097, 'compress@10': 0.9908, 'time@10': 5.7907}:  87%|████████▋ | 26/30 [01:53<00:18,  4.53s/it] {'epoch': 45, 'num_users': 5.8889, 'loss': 0.0146, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9097, 'compress@10': 0.9908, 'time@10': 5.7907}:  90%|█████████ | 27/30 [01:53<00:12,  4.21s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 0.0147, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9124, 'compress@10': 0.991, 'time@10': 5.8749}:  90%|█████████ | 27/30 [02:01<00:12,  4.21s/it]   {'epoch': 45, 'num_users': 6.0, 'loss': 0.0147, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9124, 'compress@10': 0.991, 'time@10': 5.8749}:  93%|█████████▎| 28/30 [02:01<00:10,  5.41s/it]{'epoch': 45, 'num_users': 5.8621, 'loss': 0.0145, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9137, 'compress@10': 0.9909, 'time@10': 5.9099}:  93%|█████████▎| 28/30 [02:04<00:10,  5.41s/it]{'epoch': 45, 'num_users': 5.8621, 'loss': 0.0145, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9137, 'compress@10': 0.9909, 'time@10': 5.9099}:  97%|█████████▋| 29/30 [02:04<00:04,  4.83s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.0142, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9154, 'compress@10': 0.9911, 'time@10': 5.9107}:  97%|█████████▋| 29/30 [02:10<00:04,  4.83s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.0142, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9154, 'compress@10': 0.9911, 'time@10': 5.9107}: 100%|██████████| 30/30 [02:10<00:00,  5.17s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.0142, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9154, 'compress@10': 0.9911, 'time@10': 5.9107}: 100%|██████████| 30/30 [02:10<00:00,  4.36s/it]
Epoch: 45
Avg # of users: 5.866666666666666
Avg Loss: 0.014230254671031166
Avg hit ratio: 0.8753972493935407
Avg ndcg: 0.9154432627391473
Avg compression ratio: 0.991098938881977
Avg train time: 5.910735336939494
Std train time: 1.8488420163808472
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 43, 9, 24, 34, 10, 10, 9, 6, 10, 10, 49, 49, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.916, 'compress@10': 0.9906, 'time@10': 6.3787}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.916, 'compress@10': 0.9906, 'time@10': 6.3787}:   3%|▎         | 1/30 [00:03<01:33,  3.23s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9384, 'compress@10': 0.9909, 'time@10': 5.659}:   3%|▎         | 1/30 [00:08<01:33,  3.23s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9384, 'compress@10': 0.9909, 'time@10': 5.659}:   7%|▋         | 2/30 [00:08<01:59,  4.26s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9113, 'compress@10': 0.9895, 'time@10': 4.9689}:   7%|▋         | 2/30 [00:10<01:59,  4.26s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9113, 'compress@10': 0.9895, 'time@10': 4.9689}:  10%|█         | 3/30 [00:10<01:25,  3.15s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9378, 'compress@10': 0.9883, 'time@10': 4.8077}:  10%|█         | 3/30 [00:14<01:25,  3.15s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9378, 'compress@10': 0.9883, 'time@10': 4.8077}:  13%|█▎        | 4/30 [00:14<01:34,  3.63s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9196, 'compress@10': 0.9876, 'time@10': 5.4875}:  13%|█▎        | 4/30 [00:18<01:34,  3.63s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9196, 'compress@10': 0.9876, 'time@10': 5.4875}:  17%|█▋        | 5/30 [00:18<01:35,  3.82s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0197, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9266, 'compress@10': 0.9891, 'time@10': 5.7874}:  17%|█▋        | 5/30 [00:25<01:35,  3.82s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0197, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9266, 'compress@10': 0.9891, 'time@10': 5.7874}:  20%|██        | 6/30 [00:25<02:00,  5.01s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0193, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9254, 'compress@10': 0.9896, 'time@10': 6.0516}:  20%|██        | 6/30 [00:29<02:00,  5.01s/it] {'epoch': 46, 'num_users': 6.2857, 'loss': 0.0193, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9254, 'compress@10': 0.9896, 'time@10': 6.0516}:  23%|██▎       | 7/30 [00:29<01:46,  4.64s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.93, 'compress@10': 0.9901, 'time@10': 5.9803}:  23%|██▎       | 7/30 [00:35<01:46,  4.64s/it]  {'epoch': 46, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.93, 'compress@10': 0.9901, 'time@10': 5.9803}:  27%|██▋       | 8/30 [00:35<01:48,  4.92s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9343, 'compress@10': 0.988, 'time@10': 6.1908}:  27%|██▋       | 8/30 [00:39<01:48,  4.92s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9343, 'compress@10': 0.988, 'time@10': 6.1908}:  30%|███       | 9/30 [00:39<01:37,  4.62s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0205, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9401, 'compress@10': 0.9876, 'time@10': 6.218}:  30%|███       | 9/30 [00:45<01:37,  4.62s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0205, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9401, 'compress@10': 0.9876, 'time@10': 6.218}:  33%|███▎      | 10/30 [00:45<01:44,  5.20s/it]{'epoch': 46, 'num_users': 6.6364, 'loss': 0.0211, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9383, 'compress@10': 0.9878, 'time@10': 6.4151}:  33%|███▎      | 10/30 [00:49<01:44,  5.20s/it]{'epoch': 46, 'num_users': 6.6364, 'loss': 0.0211, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9383, 'compress@10': 0.9878, 'time@10': 6.4151}:  37%|███▋      | 11/30 [00:49<01:33,  4.91s/it]{'epoch': 46, 'num_users': 6.4167, 'loss': 0.0194, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9365, 'compress@10': 0.9881, 'time@10': 6.1975}:  37%|███▋      | 11/30 [00:53<01:33,  4.91s/it]{'epoch': 46, 'num_users': 6.4167, 'loss': 0.0194, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9365, 'compress@10': 0.9881, 'time@10': 6.1975}:  40%|████      | 12/30 [00:53<01:22,  4.58s/it]{'epoch': 46, 'num_users': 6.6154, 'loss': 0.0194, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9356, 'compress@10': 0.9883, 'time@10': 6.2258}:  40%|████      | 12/30 [00:57<01:22,  4.58s/it]{'epoch': 46, 'num_users': 6.6154, 'loss': 0.0194, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9356, 'compress@10': 0.9883, 'time@10': 6.2258}:  43%|████▎     | 13/30 [00:57<01:11,  4.21s/it]{'epoch': 46, 'num_users': 6.3571, 'loss': 0.018, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9283, 'compress@10': 0.9881, 'time@10': 6.0279}:  43%|████▎     | 13/30 [01:00<01:11,  4.21s/it] {'epoch': 46, 'num_users': 6.3571, 'loss': 0.018, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9283, 'compress@10': 0.9881, 'time@10': 6.0279}:  47%|████▋     | 14/30 [01:00<01:03,  3.99s/it]{'epoch': 46, 'num_users': 6.2667, 'loss': 0.0184, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9299, 'compress@10': 0.9885, 'time@10': 6.1322}:  47%|████▋     | 14/30 [01:04<01:03,  3.99s/it]{'epoch': 46, 'num_users': 6.2667, 'loss': 0.0184, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9299, 'compress@10': 0.9885, 'time@10': 6.1322}:  50%|█████     | 15/30 [01:04<00:59,  3.95s/it]{'epoch': 46, 'num_users': 6.0625, 'loss': 0.0173, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9291, 'compress@10': 0.9887, 'time@10': 6.0196}:  50%|█████     | 15/30 [01:08<00:59,  3.95s/it]{'epoch': 46, 'num_users': 6.0625, 'loss': 0.0173, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9291, 'compress@10': 0.9887, 'time@10': 6.0196}:  53%|█████▎    | 16/30 [01:08<00:57,  4.07s/it]{'epoch': 46, 'num_users': 5.8235, 'loss': 0.0163, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9215, 'compress@10': 0.9892, 'time@10': 5.9044}:  53%|█████▎    | 16/30 [01:10<00:57,  4.07s/it]{'epoch': 46, 'num_users': 5.8235, 'loss': 0.0163, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9215, 'compress@10': 0.9892, 'time@10': 5.9044}:  57%|█████▋    | 17/30 [01:10<00:45,  3.47s/it]{'epoch': 46, 'num_users': 6.0556, 'loss': 0.0173, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9211, 'compress@10': 0.9887, 'time@10': 5.7655}:  57%|█████▋    | 17/30 [01:14<00:45,  3.47s/it]{'epoch': 46, 'num_users': 6.0556, 'loss': 0.0173, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9211, 'compress@10': 0.9887, 'time@10': 5.7655}:  60%|██████    | 18/30 [01:14<00:41,  3.46s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 0.0168, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9212, 'compress@10': 0.989, 'time@10': 5.6553}:  60%|██████    | 18/30 [01:16<00:41,  3.46s/it]    {'epoch': 46, 'num_users': 6.0, 'loss': 0.0168, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9212, 'compress@10': 0.989, 'time@10': 5.6553}:  63%|██████▎   | 19/30 [01:16<00:32,  2.99s/it]{'epoch': 46, 'num_users': 6.15, 'loss': 0.017, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9227, 'compress@10': 0.9892, 'time@10': 5.7908}:  63%|██████▎   | 19/30 [01:24<00:32,  2.99s/it]{'epoch': 46, 'num_users': 6.15, 'loss': 0.017, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9227, 'compress@10': 0.9892, 'time@10': 5.7908}:  67%|██████▋   | 20/30 [01:24<00:46,  4.61s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9207, 'compress@10': 0.9895, 'time@10': 5.8881}:  67%|██████▋   | 20/30 [01:28<00:46,  4.61s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9207, 'compress@10': 0.9895, 'time@10': 5.8881}:  70%|███████   | 21/30 [01:28<00:39,  4.42s/it]{'epoch': 46, 'num_users': 6.1818, 'loss': 0.018, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9206, 'compress@10': 0.9895, 'time@10': 5.783}:  70%|███████   | 21/30 [01:32<00:39,  4.42s/it]  {'epoch': 46, 'num_users': 6.1818, 'loss': 0.018, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9206, 'compress@10': 0.9895, 'time@10': 5.783}:  73%|███████▎  | 22/30 [01:32<00:33,  4.18s/it]{'epoch': 46, 'num_users': 6.1304, 'loss': 0.0176, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9216, 'compress@10': 0.9899, 'time@10': 5.821}:  73%|███████▎  | 22/30 [01:35<00:33,  4.18s/it]{'epoch': 46, 'num_users': 6.1304, 'loss': 0.0176, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9216, 'compress@10': 0.9899, 'time@10': 5.821}:  77%|███████▋  | 23/30 [01:35<00:27,  3.93s/it]{'epoch': 46, 'num_users': 5.9583, 'loss': 0.0169, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9165, 'compress@10': 0.9902, 'time@10': 5.7123}:  77%|███████▋  | 23/30 [01:38<00:27,  3.93s/it]{'epoch': 46, 'num_users': 5.9583, 'loss': 0.0169, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9165, 'compress@10': 0.9902, 'time@10': 5.7123}:  80%|████████  | 24/30 [01:38<00:22,  3.73s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9065, 'compress@10': 0.9903, 'time@10': 5.6116}:  80%|████████  | 24/30 [01:40<00:22,  3.73s/it]   {'epoch': 46, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9065, 'compress@10': 0.9903, 'time@10': 5.6116}:  83%|████████▎ | 25/30 [01:40<00:15,  3.10s/it]{'epoch': 46, 'num_users': 5.8077, 'loss': 0.016, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9087, 'compress@10': 0.9903, 'time@10': 5.7016}:  83%|████████▎ | 25/30 [01:48<00:15,  3.10s/it]{'epoch': 46, 'num_users': 5.8077, 'loss': 0.016, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9087, 'compress@10': 0.9903, 'time@10': 5.7016}:  87%|████████▋ | 26/30 [01:48<00:18,  4.57s/it]{'epoch': 46, 'num_users': 5.8889, 'loss': 0.0158, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.91, 'compress@10': 0.9905, 'time@10': 5.754}:  87%|████████▋ | 26/30 [01:52<00:18,  4.57s/it]  {'epoch': 46, 'num_users': 5.8889, 'loss': 0.0158, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.91, 'compress@10': 0.9905, 'time@10': 5.754}:  90%|█████████ | 27/30 [01:52<00:12,  4.28s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 0.0163, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9146, 'compress@10': 0.9908, 'time@10': 5.8423}:  90%|█████████ | 27/30 [02:00<00:12,  4.28s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 0.0163, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9146, 'compress@10': 0.9908, 'time@10': 5.8423}:  93%|█████████▎| 28/30 [02:00<00:10,  5.48s/it]{'epoch': 46, 'num_users': 5.8621, 'loss': 0.0161, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9159, 'compress@10': 0.9906, 'time@10': 5.8773}:  93%|█████████▎| 28/30 [02:03<00:10,  5.48s/it]{'epoch': 46, 'num_users': 5.8621, 'loss': 0.0161, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9159, 'compress@10': 0.9906, 'time@10': 5.8773}:  97%|█████████▋| 29/30 [02:03<00:04,  4.88s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.0161, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9167, 'compress@10': 0.9909, 'time@10': 5.8859}:  97%|█████████▋| 29/30 [02:10<00:04,  4.88s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.0161, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9167, 'compress@10': 0.9909, 'time@10': 5.8859}: 100%|██████████| 30/30 [02:10<00:00,  5.27s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.0161, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9167, 'compress@10': 0.9909, 'time@10': 5.8859}: 100%|██████████| 30/30 [02:10<00:00,  4.33s/it]
Epoch: 46
Avg # of users: 5.866666666666666
Avg Loss: 0.01614727432194189
Avg hit ratio: 0.8872359887570406
Avg ndcg: 0.9167107147940688
Avg compression ratio: 0.9908545629932235
Avg train time: 5.885943857828776
Std train time: 1.8520800752956805
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 43, 9, 24, 34, 10, 10, 9, 6, 10, 10, 49, 49, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9187, 'compress@10': 0.9904, 'time@10': 5.9737}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9187, 'compress@10': 0.9904, 'time@10': 5.9737}:   3%|▎         | 1/30 [00:03<01:27,  3.03s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9386, 'compress@10': 0.9908, 'time@10': 5.4625}:   3%|▎         | 1/30 [00:08<01:27,  3.03s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9386, 'compress@10': 0.9908, 'time@10': 5.4625}:   7%|▋         | 2/30 [00:08<01:57,  4.18s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9114, 'compress@10': 0.9893, 'time@10': 4.891}:   7%|▋         | 2/30 [00:09<01:57,  4.18s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9114, 'compress@10': 0.9893, 'time@10': 4.891}:  10%|█         | 3/30 [00:09<01:24,  3.15s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9318, 'compress@10': 0.9881, 'time@10': 4.7726}:  10%|█         | 3/30 [00:14<01:24,  3.15s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9318, 'compress@10': 0.9881, 'time@10': 4.7726}:  13%|█▎        | 4/30 [00:14<01:35,  3.66s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0197, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9163, 'compress@10': 0.9877, 'time@10': 5.4508}:  13%|█▎        | 4/30 [00:18<01:35,  3.66s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0197, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9163, 'compress@10': 0.9877, 'time@10': 5.4508}:  17%|█▋        | 5/30 [00:18<01:35,  3.83s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9231, 'compress@10': 0.989, 'time@10': 5.7965}:  17%|█▋        | 5/30 [00:26<01:35,  3.83s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9231, 'compress@10': 0.989, 'time@10': 5.7965}:  20%|██        | 6/30 [00:26<02:02,  5.10s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0188, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9254, 'compress@10': 0.9895, 'time@10': 6.0947}:  20%|██        | 6/30 [00:30<02:02,  5.10s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0188, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9254, 'compress@10': 0.9895, 'time@10': 6.0947}:  23%|██▎       | 7/30 [00:30<01:48,  4.74s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0193, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9295, 'compress@10': 0.99, 'time@10': 6.0321}:  23%|██▎       | 7/30 [00:35<01:48,  4.74s/it]   {'epoch': 47, 'num_users': 6.125, 'loss': 0.0193, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9295, 'compress@10': 0.99, 'time@10': 6.0321}:  27%|██▋       | 8/30 [00:35<01:50,  5.02s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9328, 'compress@10': 0.9874, 'time@10': 6.2062}:  27%|██▋       | 8/30 [00:39<01:50,  5.02s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9328, 'compress@10': 0.9874, 'time@10': 6.2062}:  30%|███       | 9/30 [00:39<01:37,  4.65s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.937, 'compress@10': 0.9872, 'time@10': 6.1876}:  30%|███       | 9/30 [00:45<01:37,  4.65s/it]    {'epoch': 47, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.937, 'compress@10': 0.9872, 'time@10': 6.1876}:  33%|███▎      | 10/30 [00:45<01:41,  5.09s/it]{'epoch': 47, 'num_users': 6.6364, 'loss': 0.0195, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9363, 'compress@10': 0.9873, 'time@10': 6.3297}:  33%|███▎      | 10/30 [00:49<01:41,  5.09s/it]{'epoch': 47, 'num_users': 6.6364, 'loss': 0.0195, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9363, 'compress@10': 0.9873, 'time@10': 6.3297}:  37%|███▋      | 11/30 [00:49<01:29,  4.73s/it]{'epoch': 47, 'num_users': 6.4167, 'loss': 0.0179, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9346, 'compress@10': 0.9876, 'time@10': 6.1079}:  37%|███▋      | 11/30 [00:53<01:29,  4.73s/it] {'epoch': 47, 'num_users': 6.4167, 'loss': 0.0179, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9346, 'compress@10': 0.9876, 'time@10': 6.1079}:  40%|████      | 12/30 [00:53<01:19,  4.42s/it]{'epoch': 47, 'num_users': 6.6154, 'loss': 0.018, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.934, 'compress@10': 0.9878, 'time@10': 6.1756}:  40%|████      | 12/30 [00:56<01:19,  4.42s/it] {'epoch': 47, 'num_users': 6.6154, 'loss': 0.018, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.934, 'compress@10': 0.9878, 'time@10': 6.1756}:  43%|████▎     | 13/30 [00:56<01:10,  4.15s/it]{'epoch': 47, 'num_users': 6.3571, 'loss': 0.0167, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9268, 'compress@10': 0.9877, 'time@10': 5.9852}:  43%|████▎     | 13/30 [01:00<01:10,  4.15s/it]{'epoch': 47, 'num_users': 6.3571, 'loss': 0.0167, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9268, 'compress@10': 0.9877, 'time@10': 5.9852}:  47%|████▋     | 14/30 [01:00<01:03,  3.97s/it]{'epoch': 47, 'num_users': 6.2667, 'loss': 0.0171, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.9286, 'compress@10': 0.9881, 'time@10': 6.0964}:  47%|████▋     | 14/30 [01:04<01:03,  3.97s/it]{'epoch': 47, 'num_users': 6.2667, 'loss': 0.0171, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.9286, 'compress@10': 0.9881, 'time@10': 6.0964}:  50%|█████     | 15/30 [01:04<00:59,  3.94s/it]{'epoch': 47, 'num_users': 6.0625, 'loss': 0.0161, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9278, 'compress@10': 0.9883, 'time@10': 5.9829}:  50%|█████     | 15/30 [01:08<00:59,  3.94s/it]{'epoch': 47, 'num_users': 6.0625, 'loss': 0.0161, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9278, 'compress@10': 0.9883, 'time@10': 5.9829}:  53%|█████▎    | 16/30 [01:08<00:56,  4.06s/it]{'epoch': 47, 'num_users': 5.8235, 'loss': 0.0151, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9203, 'compress@10': 0.9889, 'time@10': 5.8681}:  53%|█████▎    | 16/30 [01:10<00:56,  4.06s/it]{'epoch': 47, 'num_users': 5.8235, 'loss': 0.0151, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9203, 'compress@10': 0.9889, 'time@10': 5.8681}:  57%|█████▋    | 17/30 [01:10<00:44,  3.45s/it]{'epoch': 47, 'num_users': 6.0556, 'loss': 0.016, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9187, 'compress@10': 0.9886, 'time@10': 5.732}:  57%|█████▋    | 17/30 [01:14<00:44,  3.45s/it]  {'epoch': 47, 'num_users': 6.0556, 'loss': 0.016, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9187, 'compress@10': 0.9886, 'time@10': 5.732}:  60%|██████    | 18/30 [01:14<00:41,  3.45s/it]{'epoch': 47, 'num_users': 6.0, 'loss': 0.0156, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9192, 'compress@10': 0.9888, 'time@10': 5.6133}:  60%|██████    | 18/30 [01:15<00:41,  3.45s/it]  {'epoch': 47, 'num_users': 6.0, 'loss': 0.0156, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9192, 'compress@10': 0.9888, 'time@10': 5.6133}:  63%|██████▎   | 19/30 [01:15<00:32,  2.95s/it]{'epoch': 47, 'num_users': 6.15, 'loss': 0.0158, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9211, 'compress@10': 0.9891, 'time@10': 5.7474}:  63%|██████▎   | 19/30 [01:24<00:32,  2.95s/it]{'epoch': 47, 'num_users': 6.15, 'loss': 0.0158, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9211, 'compress@10': 0.9891, 'time@10': 5.7474}:  67%|██████▋   | 20/30 [01:24<00:45,  4.57s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9195, 'compress@10': 0.9894, 'time@10': 5.8073}:  67%|██████▋   | 20/30 [01:27<00:45,  4.57s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9195, 'compress@10': 0.9894, 'time@10': 5.8073}:  70%|███████   | 21/30 [01:27<00:38,  4.26s/it]{'epoch': 47, 'num_users': 6.1818, 'loss': 0.0165, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9195, 'compress@10': 0.9894, 'time@10': 5.7007}:  70%|███████   | 21/30 [01:31<00:38,  4.26s/it]{'epoch': 47, 'num_users': 6.1818, 'loss': 0.0165, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9195, 'compress@10': 0.9894, 'time@10': 5.7007}:  73%|███████▎  | 22/30 [01:31<00:32,  4.05s/it]{'epoch': 47, 'num_users': 6.1304, 'loss': 0.0161, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9205, 'compress@10': 0.9897, 'time@10': 5.7248}:  73%|███████▎  | 22/30 [01:34<00:32,  4.05s/it]{'epoch': 47, 'num_users': 6.1304, 'loss': 0.0161, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9205, 'compress@10': 0.9897, 'time@10': 5.7248}:  77%|███████▋  | 23/30 [01:34<00:26,  3.78s/it]{'epoch': 47, 'num_users': 5.9583, 'loss': 0.0155, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9155, 'compress@10': 0.99, 'time@10': 5.6189}:  77%|███████▋  | 23/30 [01:37<00:26,  3.78s/it]  {'epoch': 47, 'num_users': 5.9583, 'loss': 0.0155, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9155, 'compress@10': 0.99, 'time@10': 5.6189}:  80%|████████  | 24/30 [01:37<00:21,  3.62s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9055, 'compress@10': 0.9902, 'time@10': 5.5129}:  80%|████████  | 24/30 [01:39<00:21,  3.62s/it] {'epoch': 47, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9055, 'compress@10': 0.9902, 'time@10': 5.5129}:  83%|████████▎ | 25/30 [01:39<00:14,  2.99s/it]{'epoch': 47, 'num_users': 5.8077, 'loss': 0.0147, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9078, 'compress@10': 0.9901, 'time@10': 5.5945}:  83%|████████▎ | 25/30 [01:46<00:14,  2.99s/it]{'epoch': 47, 'num_users': 5.8077, 'loss': 0.0147, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9078, 'compress@10': 0.9901, 'time@10': 5.5945}:  87%|████████▋ | 26/30 [01:46<00:17,  4.39s/it]{'epoch': 47, 'num_users': 5.8889, 'loss': 0.0145, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9093, 'compress@10': 0.9903, 'time@10': 5.6408}:  87%|████████▋ | 26/30 [01:50<00:17,  4.39s/it]{'epoch': 47, 'num_users': 5.8889, 'loss': 0.0145, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9093, 'compress@10': 0.9903, 'time@10': 5.6408}:  90%|█████████ | 27/30 [01:50<00:12,  4.12s/it]{'epoch': 47, 'num_users': 6.0, 'loss': 0.0142, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9116, 'compress@10': 0.9906, 'time@10': 5.7346}:  90%|█████████ | 27/30 [01:58<00:12,  4.12s/it]   {'epoch': 47, 'num_users': 6.0, 'loss': 0.0142, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9116, 'compress@10': 0.9906, 'time@10': 5.7346}:  93%|█████████▎| 28/30 [01:58<00:10,  5.37s/it]{'epoch': 47, 'num_users': 5.8621, 'loss': 0.014, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.913, 'compress@10': 0.9904, 'time@10': 5.773}:  93%|█████████▎| 28/30 [02:02<00:10,  5.37s/it]{'epoch': 47, 'num_users': 5.8621, 'loss': 0.014, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.913, 'compress@10': 0.9904, 'time@10': 5.773}:  97%|█████████▋| 29/30 [02:02<00:04,  4.80s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0145, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9136, 'compress@10': 0.9907, 'time@10': 5.7773}:  97%|█████████▋| 29/30 [02:08<00:04,  4.80s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0145, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9136, 'compress@10': 0.9907, 'time@10': 5.7773}: 100%|██████████| 30/30 [02:08<00:00,  5.15s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0145, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9136, 'compress@10': 0.9907, 'time@10': 5.7773}: 100%|██████████| 30/30 [02:08<00:00,  4.27s/it]
Epoch: 47
Avg # of users: 5.866666666666666
Avg Loss: 0.014506030114422126
Avg hit ratio: 0.8867749867126399
Avg ndcg: 0.9136457075995824
Avg compression ratio: 0.9906601174271114
Avg train time: 5.777254668871562
Std train time: 1.806232035767254
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 43, 9, 24, 34, 10, 10, 9, 6, 10, 10, 49, 50, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9187, 'compress@10': 0.9897, 'time@10': 5.8655}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9187, 'compress@10': 0.9897, 'time@10': 5.8655}:   3%|▎         | 1/30 [00:02<01:26,  2.97s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9396, 'compress@10': 0.99, 'time@10': 5.4015}:   3%|▎         | 1/30 [00:07<01:26,  2.97s/it]  {'epoch': 48, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9396, 'compress@10': 0.99, 'time@10': 5.4015}:   7%|▋         | 2/30 [00:07<01:56,  4.15s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.842, 'ndcg@10': 0.9121, 'compress@10': 0.9888, 'time@10': 4.8593}:   7%|▋         | 2/30 [00:09<01:56,  4.15s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.842, 'ndcg@10': 0.9121, 'compress@10': 0.9888, 'time@10': 4.8593}:  10%|█         | 3/30 [00:09<01:24,  3.14s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.9201, 'compress@10': 0.9871, 'time@10': 4.7791}:  10%|█         | 3/30 [00:14<01:24,  3.14s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.9201, 'compress@10': 0.9871, 'time@10': 4.7791}:  13%|█▎        | 4/30 [00:14<01:36,  3.71s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.015, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9074, 'compress@10': 0.9869, 'time@10': 5.3931}:  13%|█▎        | 4/30 [00:18<01:36,  3.71s/it] {'epoch': 48, 'num_users': 5.8, 'loss': 0.015, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9074, 'compress@10': 0.9869, 'time@10': 5.3931}:  17%|█▋        | 5/30 [00:18<01:35,  3.80s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9199, 'compress@10': 0.9884, 'time@10': 5.6785}:  17%|█▋        | 5/30 [00:25<01:35,  3.80s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9199, 'compress@10': 0.9884, 'time@10': 5.6785}:  20%|██        | 6/30 [00:25<01:58,  4.94s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0162, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9201, 'compress@10': 0.9889, 'time@10': 6.0803}:  20%|██        | 6/30 [00:29<01:58,  4.94s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0162, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9201, 'compress@10': 0.9889, 'time@10': 6.0803}:  23%|██▎       | 7/30 [00:29<01:48,  4.73s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0171, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9254, 'compress@10': 0.9895, 'time@10': 6.0534}:  23%|██▎       | 7/30 [00:35<01:48,  4.73s/it]  {'epoch': 48, 'num_users': 6.125, 'loss': 0.0171, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9254, 'compress@10': 0.9895, 'time@10': 6.0534}:  27%|██▋       | 8/30 [00:35<01:52,  5.12s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9291, 'compress@10': 0.987, 'time@10': 6.2517}:  27%|██▋       | 8/30 [00:39<01:52,  5.12s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9291, 'compress@10': 0.987, 'time@10': 6.2517}:  30%|███       | 9/30 [00:39<01:39,  4.76s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9313, 'compress@10': 0.9866, 'time@10': 6.2843}:  30%|███       | 9/30 [00:46<01:39,  4.76s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9313, 'compress@10': 0.9866, 'time@10': 6.2843}:  33%|███▎      | 10/30 [00:46<01:46,  5.33s/it]{'epoch': 48, 'num_users': 6.6364, 'loss': 0.0193, 'hit_ratio@10': 0.9, 'ndcg@10': 0.932, 'compress@10': 0.9867, 'time@10': 6.4565}:  33%|███▎      | 10/30 [00:50<01:46,  5.33s/it] {'epoch': 48, 'num_users': 6.6364, 'loss': 0.0193, 'hit_ratio@10': 0.9, 'ndcg@10': 0.932, 'compress@10': 0.9867, 'time@10': 6.4565}:  37%|███▋      | 11/30 [00:50<01:34,  4.97s/it]{'epoch': 48, 'num_users': 6.4167, 'loss': 0.0177, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9307, 'compress@10': 0.987, 'time@10': 6.226}:  37%|███▋      | 11/30 [00:54<01:34,  4.97s/it]{'epoch': 48, 'num_users': 6.4167, 'loss': 0.0177, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9307, 'compress@10': 0.987, 'time@10': 6.226}:  40%|████      | 12/30 [00:54<01:22,  4.59s/it]{'epoch': 48, 'num_users': 6.6154, 'loss': 0.0177, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9305, 'compress@10': 0.9872, 'time@10': 6.2859}:  40%|████      | 12/30 [00:57<01:22,  4.59s/it]{'epoch': 48, 'num_users': 6.6154, 'loss': 0.0177, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9305, 'compress@10': 0.9872, 'time@10': 6.2859}:  43%|████▎     | 13/30 [00:57<01:12,  4.27s/it]{'epoch': 48, 'num_users': 6.3571, 'loss': 0.0165, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9235, 'compress@10': 0.9871, 'time@10': 6.0902}:  43%|████▎     | 13/30 [01:01<01:12,  4.27s/it] {'epoch': 48, 'num_users': 6.3571, 'loss': 0.0165, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9235, 'compress@10': 0.9871, 'time@10': 6.0902}:  47%|████▋     | 14/30 [01:01<01:05,  4.07s/it]{'epoch': 48, 'num_users': 6.2667, 'loss': 0.0171, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9251, 'compress@10': 0.9875, 'time@10': 6.2244}:  47%|████▋     | 14/30 [01:05<01:05,  4.07s/it]{'epoch': 48, 'num_users': 6.2667, 'loss': 0.0171, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9251, 'compress@10': 0.9875, 'time@10': 6.2244}:  50%|█████     | 15/30 [01:05<01:01,  4.08s/it]{'epoch': 48, 'num_users': 6.0625, 'loss': 0.016, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9246, 'compress@10': 0.9877, 'time@10': 6.1199}:  50%|█████     | 15/30 [01:10<01:01,  4.08s/it] {'epoch': 48, 'num_users': 6.0625, 'loss': 0.016, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9246, 'compress@10': 0.9877, 'time@10': 6.1199}:  53%|█████▎    | 16/30 [01:10<00:59,  4.23s/it]{'epoch': 48, 'num_users': 5.8235, 'loss': 0.0151, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9173, 'compress@10': 0.9883, 'time@10': 6.0177}:  53%|█████▎    | 16/30 [01:12<00:59,  4.23s/it]{'epoch': 48, 'num_users': 5.8235, 'loss': 0.0151, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9173, 'compress@10': 0.9883, 'time@10': 6.0177}:  57%|█████▋    | 17/30 [01:12<00:47,  3.63s/it]{'epoch': 48, 'num_users': 6.0556, 'loss': 0.0156, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.917, 'compress@10': 0.9879, 'time@10': 5.878}:  57%|█████▋    | 17/30 [01:15<00:47,  3.63s/it]  {'epoch': 48, 'num_users': 6.0556, 'loss': 0.0156, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.917, 'compress@10': 0.9879, 'time@10': 5.878}:  60%|██████    | 18/30 [01:15<00:43,  3.60s/it]{'epoch': 48, 'num_users': 6.0, 'loss': 0.0152, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9176, 'compress@10': 0.9882, 'time@10': 5.7366}:  60%|██████    | 18/30 [01:17<00:43,  3.60s/it] {'epoch': 48, 'num_users': 6.0, 'loss': 0.0152, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9176, 'compress@10': 0.9882, 'time@10': 5.7366}:  63%|██████▎   | 19/30 [01:17<00:33,  3.01s/it]{'epoch': 48, 'num_users': 6.15, 'loss': 0.0152, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9201, 'compress@10': 0.9885, 'time@10': 5.8649}:  63%|██████▎   | 19/30 [01:25<00:33,  3.01s/it]{'epoch': 48, 'num_users': 6.15, 'loss': 0.0152, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9201, 'compress@10': 0.9885, 'time@10': 5.8649}:  67%|██████▋   | 20/30 [01:25<00:46,  4.61s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9194, 'compress@10': 0.9888, 'time@10': 5.909}:  67%|██████▋   | 20/30 [01:29<00:46,  4.61s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9194, 'compress@10': 0.9888, 'time@10': 5.909}:  70%|███████   | 21/30 [01:29<00:38,  4.26s/it]{'epoch': 48, 'num_users': 6.1818, 'loss': 0.016, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9194, 'compress@10': 0.9889, 'time@10': 5.7966}:  70%|███████   | 21/30 [01:32<00:38,  4.26s/it]{'epoch': 48, 'num_users': 6.1818, 'loss': 0.016, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9194, 'compress@10': 0.9889, 'time@10': 5.7966}:  73%|███████▎  | 22/30 [01:32<00:32,  4.02s/it]{'epoch': 48, 'num_users': 6.1304, 'loss': 0.0156, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9204, 'compress@10': 0.9893, 'time@10': 5.8165}:  73%|███████▎  | 22/30 [01:35<00:32,  4.02s/it]{'epoch': 48, 'num_users': 6.1304, 'loss': 0.0156, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9204, 'compress@10': 0.9893, 'time@10': 5.8165}:  77%|███████▋  | 23/30 [01:35<00:26,  3.77s/it]{'epoch': 48, 'num_users': 5.9583, 'loss': 0.015, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9154, 'compress@10': 0.9896, 'time@10': 5.7078}:  77%|███████▋  | 23/30 [01:39<00:26,  3.77s/it] {'epoch': 48, 'num_users': 5.9583, 'loss': 0.015, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9154, 'compress@10': 0.9896, 'time@10': 5.7078}:  80%|████████  | 24/30 [01:39<00:21,  3.61s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0144, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9055, 'compress@10': 0.9897, 'time@10': 5.6107}:  80%|████████  | 24/30 [01:40<00:21,  3.61s/it]  {'epoch': 48, 'num_users': 5.8, 'loss': 0.0144, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9055, 'compress@10': 0.9897, 'time@10': 5.6107}:  83%|████████▎ | 25/30 [01:40<00:15,  3.03s/it]{'epoch': 48, 'num_users': 5.8077, 'loss': 0.0143, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9078, 'compress@10': 0.9896, 'time@10': 5.7032}:  83%|████████▎ | 25/30 [01:48<00:15,  3.03s/it]{'epoch': 48, 'num_users': 5.8077, 'loss': 0.0143, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9078, 'compress@10': 0.9896, 'time@10': 5.7032}:  87%|████████▋ | 26/30 [01:48<00:18,  4.54s/it]{'epoch': 48, 'num_users': 5.8889, 'loss': 0.014, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9094, 'compress@10': 0.9899, 'time@10': 5.7572}:  87%|████████▋ | 26/30 [01:52<00:18,  4.54s/it] {'epoch': 48, 'num_users': 5.8889, 'loss': 0.014, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9094, 'compress@10': 0.9899, 'time@10': 5.7572}:  90%|█████████ | 27/30 [01:52<00:12,  4.26s/it]{'epoch': 48, 'num_users': 6.0, 'loss': 0.0137, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9119, 'compress@10': 0.9902, 'time@10': 5.836}:  90%|█████████ | 27/30 [02:00<00:12,  4.26s/it]   {'epoch': 48, 'num_users': 6.0, 'loss': 0.0137, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9119, 'compress@10': 0.9902, 'time@10': 5.836}:  93%|█████████▎| 28/30 [02:00<00:10,  5.39s/it]{'epoch': 48, 'num_users': 5.8621, 'loss': 0.0135, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9132, 'compress@10': 0.99, 'time@10': 5.8725}:  93%|█████████▎| 28/30 [02:04<00:10,  5.39s/it]{'epoch': 48, 'num_users': 5.8621, 'loss': 0.0135, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9132, 'compress@10': 0.99, 'time@10': 5.8725}:  97%|█████████▋| 29/30 [02:04<00:04,  4.82s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0145, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9174, 'compress@10': 0.9903, 'time@10': 5.8755}:  97%|█████████▋| 29/30 [02:10<00:04,  4.82s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0145, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9174, 'compress@10': 0.9903, 'time@10': 5.8755}: 100%|██████████| 30/30 [02:10<00:00,  5.17s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0145, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9174, 'compress@10': 0.9903, 'time@10': 5.8755}: 100%|██████████| 30/30 [02:10<00:00,  4.33s/it]
Epoch: 48
Avg # of users: 5.866666666666666
Avg Loss: 0.014511020394028297
Avg hit ratio: 0.8858006171139817
Avg ndcg: 0.9174240247118505
Avg compression ratio: 0.9902695907321236
Avg train time: 5.875549777348836
Std train time: 1.8309036296504264
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 43, 9, 24, 34, 10, 10, 9, 6, 10, 10, 49, 50, 6, 8, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9187, 'compress@10': 0.9894, 'time@10': 6.0261}:   0%|          | 0/30 [00:03<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9187, 'compress@10': 0.9894, 'time@10': 6.0261}:   3%|▎         | 1/30 [00:03<01:28,  3.05s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9397, 'compress@10': 0.9903, 'time@10': 5.4783}:   3%|▎         | 1/30 [00:08<01:28,  3.05s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9397, 'compress@10': 0.9903, 'time@10': 5.4783}:   7%|▋         | 2/30 [00:08<02:01,  4.32s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9122, 'compress@10': 0.9889, 'time@10': 4.8729}:   7%|▋         | 2/30 [00:10<02:01,  4.32s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9122, 'compress@10': 0.9889, 'time@10': 4.8729}:  10%|█         | 3/30 [00:10<01:26,  3.20s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.9238, 'compress@10': 0.9875, 'time@10': 4.7101}:  10%|█         | 3/30 [00:14<01:26,  3.20s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.9238, 'compress@10': 0.9875, 'time@10': 4.7101}:  13%|█▎        | 4/30 [00:14<01:34,  3.62s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9107, 'compress@10': 0.9872, 'time@10': 5.4492}:  13%|█▎        | 4/30 [00:18<01:34,  3.62s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9107, 'compress@10': 0.9872, 'time@10': 5.4492}:  17%|█▋        | 5/30 [00:18<01:36,  3.85s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9188, 'compress@10': 0.9885, 'time@10': 5.8222}:  17%|█▋        | 5/30 [00:26<01:36,  3.85s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9188, 'compress@10': 0.9885, 'time@10': 5.8222}:  20%|██        | 6/30 [00:26<02:03,  5.17s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.9221, 'compress@10': 0.9891, 'time@10': 6.1232}:  20%|██        | 6/30 [00:30<02:03,  5.17s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.9221, 'compress@10': 0.9891, 'time@10': 6.1232}:  23%|██▎       | 7/30 [00:30<01:50,  4.79s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9271, 'compress@10': 0.9897, 'time@10': 6.0427}:  23%|██▎       | 7/30 [00:35<01:50,  4.79s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9271, 'compress@10': 0.9897, 'time@10': 6.0427}:  27%|██▋       | 8/30 [00:35<01:50,  5.02s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0155, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9318, 'compress@10': 0.9873, 'time@10': 6.2054}:  27%|██▋       | 8/30 [00:39<01:50,  5.02s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0155, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9318, 'compress@10': 0.9873, 'time@10': 6.2054}:  30%|███       | 9/30 [00:39<01:37,  4.64s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9343, 'compress@10': 0.9868, 'time@10': 6.2004}:  30%|███       | 9/30 [00:45<01:37,  4.64s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9343, 'compress@10': 0.9868, 'time@10': 6.2004}:  33%|███▎      | 10/30 [00:45<01:42,  5.12s/it]{'epoch': 49, 'num_users': 6.6364, 'loss': 0.0164, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9348, 'compress@10': 0.9872, 'time@10': 6.4067}:  33%|███▎      | 10/30 [00:50<01:42,  5.12s/it]{'epoch': 49, 'num_users': 6.6364, 'loss': 0.0164, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9348, 'compress@10': 0.9872, 'time@10': 6.4067}:  37%|███▋      | 11/30 [00:50<01:32,  4.86s/it]{'epoch': 49, 'num_users': 6.4167, 'loss': 0.015, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9333, 'compress@10': 0.9874, 'time@10': 6.2235}:  37%|███▋      | 11/30 [00:54<01:32,  4.86s/it] {'epoch': 49, 'num_users': 6.4167, 'loss': 0.015, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9333, 'compress@10': 0.9874, 'time@10': 6.2235}:  40%|████      | 12/30 [00:54<01:24,  4.68s/it]{'epoch': 49, 'num_users': 6.6154, 'loss': 0.0152, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9329, 'compress@10': 0.9875, 'time@10': 6.2899}:  40%|████      | 12/30 [00:58<01:24,  4.68s/it]{'epoch': 49, 'num_users': 6.6154, 'loss': 0.0152, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9329, 'compress@10': 0.9875, 'time@10': 6.2899}:  43%|████▎     | 13/30 [00:58<01:13,  4.35s/it]{'epoch': 49, 'num_users': 6.3571, 'loss': 0.0141, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9257, 'compress@10': 0.9873, 'time@10': 6.0935}:  43%|████▎     | 13/30 [01:01<01:13,  4.35s/it]{'epoch': 49, 'num_users': 6.3571, 'loss': 0.0141, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9257, 'compress@10': 0.9873, 'time@10': 6.0935}:  47%|████▋     | 14/30 [01:01<01:05,  4.12s/it]{'epoch': 49, 'num_users': 6.2667, 'loss': 0.0148, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9283, 'compress@10': 0.9876, 'time@10': 6.2612}:  47%|████▋     | 14/30 [01:05<01:05,  4.12s/it]{'epoch': 49, 'num_users': 6.2667, 'loss': 0.0148, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9283, 'compress@10': 0.9876, 'time@10': 6.2612}:  50%|█████     | 15/30 [01:05<01:02,  4.18s/it]{'epoch': 49, 'num_users': 6.0625, 'loss': 0.0139, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.9275, 'compress@10': 0.9879, 'time@10': 6.1043}:  50%|█████     | 15/30 [01:09<01:02,  4.18s/it]{'epoch': 49, 'num_users': 6.0625, 'loss': 0.0139, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.9275, 'compress@10': 0.9879, 'time@10': 6.1043}:  53%|█████▎    | 16/30 [01:09<00:56,  4.07s/it]{'epoch': 49, 'num_users': 5.8235, 'loss': 0.0131, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.92, 'compress@10': 0.9884, 'time@10': 6.0088}:  53%|█████▎    | 16/30 [01:11<00:56,  4.07s/it]  {'epoch': 49, 'num_users': 5.8235, 'loss': 0.0131, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.92, 'compress@10': 0.9884, 'time@10': 6.0088}:  57%|█████▋    | 17/30 [01:11<00:45,  3.53s/it]{'epoch': 49, 'num_users': 6.0556, 'loss': 0.0134, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.9209, 'compress@10': 0.9881, 'time@10': 5.9327}:  57%|█████▋    | 17/30 [01:16<00:45,  3.53s/it]{'epoch': 49, 'num_users': 6.0556, 'loss': 0.0134, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.9209, 'compress@10': 0.9881, 'time@10': 5.9327}:  60%|██████    | 18/30 [01:16<00:46,  3.87s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 0.0131, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9213, 'compress@10': 0.9881, 'time@10': 5.788}:  60%|██████    | 18/30 [01:18<00:46,  3.87s/it]    {'epoch': 49, 'num_users': 6.0, 'loss': 0.0131, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9213, 'compress@10': 0.9881, 'time@10': 5.788}:  63%|██████▎   | 19/30 [01:18<00:35,  3.20s/it]{'epoch': 49, 'num_users': 6.15, 'loss': 0.0134, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9232, 'compress@10': 0.9884, 'time@10': 5.9003}:  63%|██████▎   | 19/30 [01:26<00:35,  3.20s/it]{'epoch': 49, 'num_users': 6.15, 'loss': 0.0134, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9232, 'compress@10': 0.9884, 'time@10': 5.9003}:  67%|██████▋   | 20/30 [01:26<00:46,  4.67s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.922, 'compress@10': 0.9886, 'time@10': 5.9419}:  67%|██████▋   | 20/30 [01:29<00:46,  4.67s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.922, 'compress@10': 0.9886, 'time@10': 5.9419}:  70%|███████   | 21/30 [01:29<00:38,  4.29s/it]{'epoch': 49, 'num_users': 6.1818, 'loss': 0.0146, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9219, 'compress@10': 0.9888, 'time@10': 5.8236}:  70%|███████   | 21/30 [01:33<00:38,  4.29s/it]{'epoch': 49, 'num_users': 6.1818, 'loss': 0.0146, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9219, 'compress@10': 0.9888, 'time@10': 5.8236}:  73%|███████▎  | 22/30 [01:33<00:32,  4.02s/it]{'epoch': 49, 'num_users': 6.1304, 'loss': 0.0143, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9229, 'compress@10': 0.9891, 'time@10': 5.8441}:  73%|███████▎  | 22/30 [01:36<00:32,  4.02s/it] {'epoch': 49, 'num_users': 6.1304, 'loss': 0.0143, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9229, 'compress@10': 0.9891, 'time@10': 5.8441}:  77%|███████▋  | 23/30 [01:36<00:26,  3.77s/it]{'epoch': 49, 'num_users': 5.9583, 'loss': 0.0137, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9178, 'compress@10': 0.9894, 'time@10': 5.744}:  77%|███████▋  | 23/30 [01:39<00:26,  3.77s/it]{'epoch': 49, 'num_users': 5.9583, 'loss': 0.0137, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9178, 'compress@10': 0.9894, 'time@10': 5.744}:  80%|████████  | 24/30 [01:39<00:22,  3.69s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9077, 'compress@10': 0.9896, 'time@10': 5.6465}:  80%|████████  | 24/30 [01:41<00:22,  3.69s/it]  {'epoch': 49, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9077, 'compress@10': 0.9896, 'time@10': 5.6465}:  83%|████████▎ | 25/30 [01:41<00:15,  3.09s/it]{'epoch': 49, 'num_users': 5.8077, 'loss': 0.0131, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.91, 'compress@10': 0.9895, 'time@10': 5.7375}:  83%|████████▎ | 25/30 [01:49<00:15,  3.09s/it]{'epoch': 49, 'num_users': 5.8077, 'loss': 0.0131, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.91, 'compress@10': 0.9895, 'time@10': 5.7375}:  87%|████████▋ | 26/30 [01:49<00:18,  4.58s/it]{'epoch': 49, 'num_users': 5.8889, 'loss': 0.0129, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9117, 'compress@10': 0.9897, 'time@10': 5.7907}:  87%|████████▋ | 26/30 [01:53<00:18,  4.58s/it]{'epoch': 49, 'num_users': 5.8889, 'loss': 0.0129, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9117, 'compress@10': 0.9897, 'time@10': 5.7907}:  90%|█████████ | 27/30 [01:53<00:12,  4.30s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 0.0138, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9173, 'compress@10': 0.99, 'time@10': 5.8846}:  90%|█████████ | 27/30 [02:01<00:12,  4.30s/it]     {'epoch': 49, 'num_users': 6.0, 'loss': 0.0138, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9173, 'compress@10': 0.99, 'time@10': 5.8846}:  93%|█████████▎| 28/30 [02:01<00:11,  5.55s/it]{'epoch': 49, 'num_users': 5.8621, 'loss': 0.0136, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9184, 'compress@10': 0.9898, 'time@10': 5.9185}:  93%|█████████▎| 28/30 [02:05<00:11,  5.55s/it]{'epoch': 49, 'num_users': 5.8621, 'loss': 0.0136, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9184, 'compress@10': 0.9898, 'time@10': 5.9185}:  97%|█████████▋| 29/30 [02:05<00:04,  4.92s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0133, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9201, 'compress@10': 0.9901, 'time@10': 5.9182}:  97%|█████████▋| 29/30 [02:11<00:04,  4.92s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0133, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9201, 'compress@10': 0.9901, 'time@10': 5.9182}: 100%|██████████| 30/30 [02:11<00:00,  5.23s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0133, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9201, 'compress@10': 0.9901, 'time@10': 5.9182}: 100%|██████████| 30/30 [02:11<00:00,  4.37s/it]
Epoch: 49
Avg # of users: 5.866666666666666
Avg Loss: 0.013307829627535671
Avg hit ratio: 0.8780817396618004
Avg ndcg: 0.9200983435152289
Avg compression ratio: 0.9900538111179961
Avg train time: 5.918221275011699
Std train time: 1.8507303438618292
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 5, 10, 10, 10, 7, 10, 10, 22, 10, 43, 9, 24, 34, 10, 10, 9, 6, 10, 10, 49, 50, 6, 8, 10, 10, 10]
